var ofe=Object.defineProperty;var lfe=(t,e,r)=>e in t?ofe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Rr=(t,e,r)=>lfe(t,typeof e!="symbol"?e+"":e,r);function cfe(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in t)){const s=Object.getOwnPropertyDescriptor(n,a);s&&Object.defineProperty(t,a,s.get?s:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var aot=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function kA(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var CW={exports:{}},iI={},_W={exports:{}},_a={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pw=Symbol.for("react.element"),dfe=Symbol.for("react.portal"),ufe=Symbol.for("react.fragment"),ffe=Symbol.for("react.strict_mode"),hfe=Symbol.for("react.profiler"),Afe=Symbol.for("react.provider"),mfe=Symbol.for("react.context"),pfe=Symbol.for("react.forward_ref"),gfe=Symbol.for("react.suspense"),xfe=Symbol.for("react.memo"),vfe=Symbol.for("react.lazy"),ML=Symbol.iterator;function yfe(t){return t===null||typeof t!="object"?null:(t=ML&&t[ML]||t["@@iterator"],typeof t=="function"?t:null)}var EW={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},SW=Object.assign,jW={};function s1(t,e,r){this.props=t,this.context=e,this.refs=jW,this.updater=r||EW}s1.prototype.isReactComponent={};s1.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};s1.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function IW(){}IW.prototype=s1.prototype;function FO(t,e,r){this.props=t,this.context=e,this.refs=jW,this.updater=r||EW}var OO=FO.prototype=new IW;OO.constructor=FO;SW(OO,s1.prototype);OO.isPureReactComponent=!0;var LL=Array.isArray,PW=Object.prototype.hasOwnProperty,DO={current:null},TW={key:!0,ref:!0,__self:!0,__source:!0};function BW(t,e,r){var n,a={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)PW.call(e,n)&&!TW.hasOwnProperty(n)&&(a[n]=e[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];a.children=c}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:pw,type:t,key:s,ref:o,props:a,_owner:DO.current}}function bfe(t,e){return{$$typeof:pw,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function RO(t){return typeof t=="object"&&t!==null&&t.$$typeof===pw}function wfe(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var UL=/\/+/g;function J3(t,e){return typeof t=="object"&&t!==null&&t.key!=null?wfe(""+t.key):e.toString(36)}function G_(t,e,r,n,a){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case pw:case dfe:o=!0}}if(o)return o=t,a=a(o),t=n===""?"."+J3(o,0):n,LL(a)?(r="",t!=null&&(r=t.replace(UL,"$&/")+"/"),G_(a,e,r,"",function(d){return d})):a!=null&&(RO(a)&&(a=bfe(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(UL,"$&/")+"/")+t)),e.push(a)),1;if(o=0,n=n===""?".":n+":",LL(t))for(var l=0;l<t.length;l++){s=t[l];var c=n+J3(s,l);o+=G_(s,e,r,c,a)}else if(c=yfe(t),typeof c=="function")for(t=c.call(t),l=0;!(s=t.next()).done;)s=s.value,c=n+J3(s,l++),o+=G_(s,e,r,c,a);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function UN(t,e,r){if(t==null)return t;var n=[],a=0;return G_(t,n,"","",function(s){return e.call(r,s,a++)}),n}function Nfe(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Kc={current:null},K_={transition:null},Cfe={ReactCurrentDispatcher:Kc,ReactCurrentBatchConfig:K_,ReactCurrentOwner:DO};function kW(){throw Error("act(...) is not supported in production builds of React.")}_a.Children={map:UN,forEach:function(t,e,r){UN(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return UN(t,function(){e++}),e},toArray:function(t){return UN(t,function(e){return e})||[]},only:function(t){if(!RO(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};_a.Component=s1;_a.Fragment=ufe;_a.Profiler=hfe;_a.PureComponent=FO;_a.StrictMode=ffe;_a.Suspense=gfe;_a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Cfe;_a.act=kW;_a.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=SW({},t.props),a=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=DO.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)PW.call(e,c)&&!TW.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:pw,type:t.type,key:a,ref:s,props:n,_owner:o}};_a.createContext=function(t){return t={$$typeof:mfe,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Afe,_context:t},t.Consumer=t};_a.createElement=BW;_a.createFactory=function(t){var e=BW.bind(null,t);return e.type=t,e};_a.createRef=function(){return{current:null}};_a.forwardRef=function(t){return{$$typeof:pfe,render:t}};_a.isValidElement=RO;_a.lazy=function(t){return{$$typeof:vfe,_payload:{_status:-1,_result:t},_init:Nfe}};_a.memo=function(t,e){return{$$typeof:xfe,type:t,compare:e===void 0?null:e}};_a.startTransition=function(t){var e=K_.transition;K_.transition={};try{t()}finally{K_.transition=e}};_a.unstable_act=kW;_a.useCallback=function(t,e){return Kc.current.useCallback(t,e)};_a.useContext=function(t){return Kc.current.useContext(t)};_a.useDebugValue=function(){};_a.useDeferredValue=function(t){return Kc.current.useDeferredValue(t)};_a.useEffect=function(t,e){return Kc.current.useEffect(t,e)};_a.useId=function(){return Kc.current.useId()};_a.useImperativeHandle=function(t,e,r){return Kc.current.useImperativeHandle(t,e,r)};_a.useInsertionEffect=function(t,e){return Kc.current.useInsertionEffect(t,e)};_a.useLayoutEffect=function(t,e){return Kc.current.useLayoutEffect(t,e)};_a.useMemo=function(t,e){return Kc.current.useMemo(t,e)};_a.useReducer=function(t,e,r){return Kc.current.useReducer(t,e,r)};_a.useRef=function(t){return Kc.current.useRef(t)};_a.useState=function(t){return Kc.current.useState(t)};_a.useSyncExternalStore=function(t,e,r){return Kc.current.useSyncExternalStore(t,e,r)};_a.useTransition=function(){return Kc.current.useTransition()};_a.version="18.3.1";_W.exports=_a;var g=_W.exports;const wi=kA(g),_fe=cfe({__proto__:null,default:wi},[g]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Efe=g,Sfe=Symbol.for("react.element"),jfe=Symbol.for("react.fragment"),Ife=Object.prototype.hasOwnProperty,Pfe=Efe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Tfe={key:!0,ref:!0,__self:!0,__source:!0};function FW(t,e,r){var n,a={},s=null,o=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)Ife.call(e,n)&&!Tfe.hasOwnProperty(n)&&(a[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)a[n]===void 0&&(a[n]=e[n]);return{$$typeof:Sfe,type:t,key:s,ref:o,props:a,_owner:Pfe.current}}iI.Fragment=jfe;iI.jsx=FW;iI.jsxs=FW;CW.exports=iI;var i=CW.exports,qT={},OW={exports:{}},Yd={},DW={exports:{}},RW={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(he,ae){var Ce=he.length;he.push(ae);e:for(;0<Ce;){var De=Ce-1>>>1,O=he[De];if(0<a(O,ae))he[De]=ae,he[Ce]=O,Ce=De;else break e}}function r(he){return he.length===0?null:he[0]}function n(he){if(he.length===0)return null;var ae=he[0],Ce=he.pop();if(Ce!==ae){he[0]=Ce;e:for(var De=0,O=he.length,R=O>>>1;De<R;){var G=2*(De+1)-1,M=he[G],K=G+1,Y=he[K];if(0>a(M,Ce))K<O&&0>a(Y,M)?(he[De]=Y,he[K]=Ce,De=K):(he[De]=M,he[G]=Ce,De=G);else if(K<O&&0>a(Y,Ce))he[De]=Y,he[K]=Ce,De=K;else break e}}return ae}function a(he,ae){var Ce=he.sortIndex-ae.sortIndex;return Ce!==0?Ce:he.id-ae.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,f=null,A=3,h=!1,m=!1,p=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(he){for(var ae=r(d);ae!==null;){if(ae.callback===null)n(d);else if(ae.startTime<=he)n(d),ae.sortIndex=ae.expirationTime,e(c,ae);else break;ae=r(d)}}function w(he){if(p=!1,b(he),!m)if(r(c)!==null)m=!0,ce(I);else{var ae=r(d);ae!==null&&le(w,ae.startTime-he)}}function I(he,ae){m=!1,p&&(p=!1,v(S),S=-1),h=!0;var Ce=A;try{for(b(ae),f=r(c);f!==null&&(!(f.expirationTime>ae)||he&&!k());){var De=f.callback;if(typeof De=="function"){f.callback=null,A=f.priorityLevel;var O=De(f.expirationTime<=ae);ae=t.unstable_now(),typeof O=="function"?f.callback=O:f===r(c)&&n(c),b(ae)}else n(c);f=r(c)}if(f!==null)var R=!0;else{var G=r(d);G!==null&&le(w,G.startTime-ae),R=!1}return R}finally{f=null,A=Ce,h=!1}}var j=!1,N=null,S=-1,E=5,B=-1;function k(){return!(t.unstable_now()-B<E)}function T(){if(N!==null){var he=t.unstable_now();B=he;var ae=!0;try{ae=N(!0,he)}finally{ae?P():(j=!1,N=null)}}else j=!1}var P;if(typeof y=="function")P=function(){y(T)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,de=q.port2;q.port1.onmessage=T,P=function(){de.postMessage(null)}}else P=function(){x(T,0)};function ce(he){N=he,j||(j=!0,P())}function le(he,ae){S=x(function(){he(t.unstable_now())},ae)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(he){he.callback=null},t.unstable_continueExecution=function(){m||h||(m=!0,ce(I))},t.unstable_forceFrameRate=function(he){0>he||125<he?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<he?Math.floor(1e3/he):5},t.unstable_getCurrentPriorityLevel=function(){return A},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(he){switch(A){case 1:case 2:case 3:var ae=3;break;default:ae=A}var Ce=A;A=ae;try{return he()}finally{A=Ce}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(he,ae){switch(he){case 1:case 2:case 3:case 4:case 5:break;default:he=3}var Ce=A;A=he;try{return ae()}finally{A=Ce}},t.unstable_scheduleCallback=function(he,ae,Ce){var De=t.unstable_now();switch(typeof Ce=="object"&&Ce!==null?(Ce=Ce.delay,Ce=typeof Ce=="number"&&0<Ce?De+Ce:De):Ce=De,he){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=Ce+O,he={id:u++,callback:ae,priorityLevel:he,startTime:Ce,expirationTime:O,sortIndex:-1},Ce>De?(he.sortIndex=Ce,e(d,he),r(c)===null&&he===r(d)&&(p?(v(S),S=-1):p=!0,le(w,Ce-De))):(he.sortIndex=O,e(c,he),m||h||(m=!0,ce(I))),he},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(he){var ae=A;return function(){var Ce=A;A=ae;try{return he.apply(this,arguments)}finally{A=Ce}}}})(RW);DW.exports=RW;var Bfe=DW.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kfe=g,Kd=Bfe;function Qr(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var MW=new Set,Xb={};function kg(t,e){_v(t,e),_v(t+"Capture",e)}function _v(t,e){for(Xb[t]=e,t=0;t<e.length;t++)MW.add(e[t])}var mA=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zT=Object.prototype.hasOwnProperty,Ffe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,QL={},VL={};function Ofe(t){return zT.call(VL,t)?!0:zT.call(QL,t)?!1:Ffe.test(t)?VL[t]=!0:(QL[t]=!0,!1)}function Dfe(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Rfe(t,e,r,n){if(e===null||typeof e>"u"||Dfe(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function qc(t,e,r,n,a,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Gl={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Gl[t]=new qc(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Gl[e]=new qc(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Gl[t]=new qc(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Gl[t]=new qc(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Gl[t]=new qc(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Gl[t]=new qc(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Gl[t]=new qc(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Gl[t]=new qc(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Gl[t]=new qc(t,5,!1,t.toLowerCase(),null,!1,!1)});var MO=/[\-:]([a-z])/g;function LO(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(MO,LO);Gl[e]=new qc(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(MO,LO);Gl[e]=new qc(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(MO,LO);Gl[e]=new qc(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Gl[t]=new qc(t,1,!1,t.toLowerCase(),null,!1,!1)});Gl.xlinkHref=new qc("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Gl[t]=new qc(t,1,!1,t.toLowerCase(),null,!0,!0)});function UO(t,e,r,n){var a=Gl.hasOwnProperty(e)?Gl[e]:null;(a!==null?a.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Rfe(e,r,a,n)&&(r=null),n||a===null?Ofe(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):a.mustUseProperty?t[a.propertyName]=r===null?a.type===3?!1:"":r:(e=a.attributeName,n=a.attributeNamespace,r===null?t.removeAttribute(e):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var FA=kfe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,QN=Symbol.for("react.element"),Lx=Symbol.for("react.portal"),Ux=Symbol.for("react.fragment"),QO=Symbol.for("react.strict_mode"),WT=Symbol.for("react.profiler"),LW=Symbol.for("react.provider"),UW=Symbol.for("react.context"),VO=Symbol.for("react.forward_ref"),XT=Symbol.for("react.suspense"),YT=Symbol.for("react.suspense_list"),HO=Symbol.for("react.memo"),I0=Symbol.for("react.lazy"),QW=Symbol.for("react.offscreen"),HL=Symbol.iterator;function ty(t){return t===null||typeof t!="object"?null:(t=HL&&t[HL]||t["@@iterator"],typeof t=="function"?t:null)}var ji=Object.assign,Z3;function Ly(t){if(Z3===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Z3=e&&e[1]||""}return`
`+Z3+t}var e4=!1;function t4(t,e){if(!t||e4)return"";e4=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var n=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){n=d}t.call(e.prototype)}else{try{throw Error()}catch(d){n=d}t()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var a=d.stack.split(`
`),s=n.stack.split(`
`),o=a.length-1,l=s.length-1;1<=o&&0<=l&&a[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==s[l]){var c=`
`+a[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{e4=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Ly(t):""}function Mfe(t){switch(t.tag){case 5:return Ly(t.type);case 16:return Ly("Lazy");case 13:return Ly("Suspense");case 19:return Ly("SuspenseList");case 0:case 2:case 15:return t=t4(t.type,!1),t;case 11:return t=t4(t.type.render,!1),t;case 1:return t=t4(t.type,!0),t;default:return""}}function JT(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ux:return"Fragment";case Lx:return"Portal";case WT:return"Profiler";case QO:return"StrictMode";case XT:return"Suspense";case YT:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case UW:return(t.displayName||"Context")+".Consumer";case LW:return(t._context.displayName||"Context")+".Provider";case VO:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case HO:return e=t.displayName||null,e!==null?e:JT(t.type)||"Memo";case I0:e=t._payload,t=t._init;try{return JT(t(e))}catch{}}return null}function Lfe(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return JT(e);case 8:return e===QO?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ym(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function VW(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ufe(t){var e=VW(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function VN(t){t._valueTracker||(t._valueTracker=Ufe(t))}function HW(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=VW(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function OE(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ZT(t,e){var r=e.checked;return ji({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function $L(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=ym(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function $W(t,e){e=e.checked,e!=null&&UO(t,"checked",e,!1)}function eB(t,e){$W(t,e);var r=ym(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?tB(t,e.type,r):e.hasOwnProperty("defaultValue")&&tB(t,e.type,ym(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function GL(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function tB(t,e,r){(e!=="number"||OE(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Uy=Array.isArray;function ov(t,e,r,n){if(t=t.options,e){e={};for(var a=0;a<r.length;a++)e["$"+r[a]]=!0;for(r=0;r<t.length;r++)a=e.hasOwnProperty("$"+t[r].value),t[r].selected!==a&&(t[r].selected=a),a&&n&&(t[r].defaultSelected=!0)}else{for(r=""+ym(r),e=null,a=0;a<t.length;a++){if(t[a].value===r){t[a].selected=!0,n&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function rB(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Qr(91));return ji({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function KL(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Qr(92));if(Uy(r)){if(1<r.length)throw Error(Qr(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:ym(r)}}function GW(t,e){var r=ym(e.value),n=ym(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function qL(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function KW(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function nB(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?KW(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var HN,qW=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,a){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(HN=HN||document.createElement("div"),HN.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=HN.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Yb(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var ub={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Qfe=["Webkit","ms","Moz","O"];Object.keys(ub).forEach(function(t){Qfe.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ub[e]=ub[t]})});function zW(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||ub.hasOwnProperty(t)&&ub[t]?(""+e).trim():e+"px"}function WW(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=zW(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,a):t[r]=a}}var Vfe=ji({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function aB(t,e){if(e){if(Vfe[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Qr(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Qr(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Qr(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Qr(62))}}function sB(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var iB=null;function $O(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var oB=null,lv=null,cv=null;function zL(t){if(t=vw(t)){if(typeof oB!="function")throw Error(Qr(280));var e=t.stateNode;e&&(e=uI(e),oB(t.stateNode,t.type,e))}}function XW(t){lv?cv?cv.push(t):cv=[t]:lv=t}function YW(){if(lv){var t=lv,e=cv;if(cv=lv=null,zL(t),e)for(t=0;t<e.length;t++)zL(e[t])}}function JW(t,e){return t(e)}function ZW(){}var r4=!1;function eX(t,e,r){if(r4)return t(e,r);r4=!0;try{return JW(t,e,r)}finally{r4=!1,(lv!==null||cv!==null)&&(ZW(),YW())}}function Jb(t,e){var r=t.stateNode;if(r===null)return null;var n=uI(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Qr(231,e,typeof r));return r}var lB=!1;if(mA)try{var ry={};Object.defineProperty(ry,"passive",{get:function(){lB=!0}}),window.addEventListener("test",ry,ry),window.removeEventListener("test",ry,ry)}catch{lB=!1}function Hfe(t,e,r,n,a,s,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(r,d)}catch(u){this.onError(u)}}var fb=!1,DE=null,RE=!1,cB=null,$fe={onError:function(t){fb=!0,DE=t}};function Gfe(t,e,r,n,a,s,o,l,c){fb=!1,DE=null,Hfe.apply($fe,arguments)}function Kfe(t,e,r,n,a,s,o,l,c){if(Gfe.apply(this,arguments),fb){if(fb){var d=DE;fb=!1,DE=null}else throw Error(Qr(198));RE||(RE=!0,cB=d)}}function Fg(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function tX(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function WL(t){if(Fg(t)!==t)throw Error(Qr(188))}function qfe(t){var e=t.alternate;if(!e){if(e=Fg(t),e===null)throw Error(Qr(188));return e!==t?null:t}for(var r=t,n=e;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return WL(a),t;if(s===n)return WL(a),e;s=s.sibling}throw Error(Qr(188))}if(r.return!==n.return)r=a,n=s;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=s;break}if(l===n){o=!0,n=a,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=a;break}if(l===n){o=!0,n=s,r=a;break}l=l.sibling}if(!o)throw Error(Qr(189))}}if(r.alternate!==n)throw Error(Qr(190))}if(r.tag!==3)throw Error(Qr(188));return r.stateNode.current===r?t:e}function rX(t){return t=qfe(t),t!==null?nX(t):null}function nX(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=nX(t);if(e!==null)return e;t=t.sibling}return null}var aX=Kd.unstable_scheduleCallback,XL=Kd.unstable_cancelCallback,zfe=Kd.unstable_shouldYield,Wfe=Kd.unstable_requestPaint,ao=Kd.unstable_now,Xfe=Kd.unstable_getCurrentPriorityLevel,GO=Kd.unstable_ImmediatePriority,sX=Kd.unstable_UserBlockingPriority,ME=Kd.unstable_NormalPriority,Yfe=Kd.unstable_LowPriority,iX=Kd.unstable_IdlePriority,oI=null,ih=null;function Jfe(t){if(ih&&typeof ih.onCommitFiberRoot=="function")try{ih.onCommitFiberRoot(oI,t,void 0,(t.current.flags&128)===128)}catch{}}var yf=Math.clz32?Math.clz32:the,Zfe=Math.log,ehe=Math.LN2;function the(t){return t>>>=0,t===0?32:31-(Zfe(t)/ehe|0)|0}var $N=64,GN=4194304;function Qy(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function LE(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,a=t.suspendedLanes,s=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~a;l!==0?n=Qy(l):(s&=o,s!==0&&(n=Qy(s)))}else o=r&~a,o!==0?n=Qy(o):s!==0&&(n=Qy(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&a)&&(a=n&-n,s=e&-e,a>=s||a===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-yf(e),a=1<<r,n|=t[r],e&=~a;return n}function rhe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nhe(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,a=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-yf(s),l=1<<o,c=a[o];c===-1?(!(l&r)||l&n)&&(a[o]=rhe(l,e)):c<=e&&(t.expiredLanes|=l),s&=~l}}function dB(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function oX(){var t=$N;return $N<<=1,!($N&4194240)&&($N=64),t}function n4(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function gw(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-yf(e),t[e]=r}function ahe(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var a=31-yf(r),s=1<<a;e[a]=0,n[a]=-1,t[a]=-1,r&=~s}}function KO(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-yf(r),a=1<<n;a&e|t[n]&e&&(t[n]|=e),r&=~a}}var xs=0;function lX(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var cX,qO,dX,uX,fX,uB=!1,KN=[],rm=null,nm=null,am=null,Zb=new Map,e2=new Map,O0=[],she="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function YL(t,e){switch(t){case"focusin":case"focusout":rm=null;break;case"dragenter":case"dragleave":nm=null;break;case"mouseover":case"mouseout":am=null;break;case"pointerover":case"pointerout":Zb.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":e2.delete(e.pointerId)}}function ny(t,e,r,n,a,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},e!==null&&(e=vw(e),e!==null&&qO(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function ihe(t,e,r,n,a){switch(e){case"focusin":return rm=ny(rm,t,e,r,n,a),!0;case"dragenter":return nm=ny(nm,t,e,r,n,a),!0;case"mouseover":return am=ny(am,t,e,r,n,a),!0;case"pointerover":var s=a.pointerId;return Zb.set(s,ny(Zb.get(s)||null,t,e,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,e2.set(s,ny(e2.get(s)||null,t,e,r,n,a)),!0}return!1}function hX(t){var e=Ep(t.target);if(e!==null){var r=Fg(e);if(r!==null){if(e=r.tag,e===13){if(e=tX(r),e!==null){t.blockedOn=e,fX(t.priority,function(){dX(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function q_(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=fB(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);iB=n,r.target.dispatchEvent(n),iB=null}else return e=vw(r),e!==null&&qO(e),t.blockedOn=r,!1;e.shift()}return!0}function JL(t,e,r){q_(t)&&r.delete(e)}function ohe(){uB=!1,rm!==null&&q_(rm)&&(rm=null),nm!==null&&q_(nm)&&(nm=null),am!==null&&q_(am)&&(am=null),Zb.forEach(JL),e2.forEach(JL)}function ay(t,e){t.blockedOn===e&&(t.blockedOn=null,uB||(uB=!0,Kd.unstable_scheduleCallback(Kd.unstable_NormalPriority,ohe)))}function t2(t){function e(a){return ay(a,t)}if(0<KN.length){ay(KN[0],t);for(var r=1;r<KN.length;r++){var n=KN[r];n.blockedOn===t&&(n.blockedOn=null)}}for(rm!==null&&ay(rm,t),nm!==null&&ay(nm,t),am!==null&&ay(am,t),Zb.forEach(e),e2.forEach(e),r=0;r<O0.length;r++)n=O0[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<O0.length&&(r=O0[0],r.blockedOn===null);)hX(r),r.blockedOn===null&&O0.shift()}var dv=FA.ReactCurrentBatchConfig,UE=!0;function lhe(t,e,r,n){var a=xs,s=dv.transition;dv.transition=null;try{xs=1,zO(t,e,r,n)}finally{xs=a,dv.transition=s}}function che(t,e,r,n){var a=xs,s=dv.transition;dv.transition=null;try{xs=4,zO(t,e,r,n)}finally{xs=a,dv.transition=s}}function zO(t,e,r,n){if(UE){var a=fB(t,e,r,n);if(a===null)h4(t,e,n,QE,r),YL(t,n);else if(ihe(a,t,e,r,n))n.stopPropagation();else if(YL(t,n),e&4&&-1<she.indexOf(t)){for(;a!==null;){var s=vw(a);if(s!==null&&cX(s),s=fB(t,e,r,n),s===null&&h4(t,e,n,QE,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else h4(t,e,n,null,r)}}var QE=null;function fB(t,e,r,n){if(QE=null,t=$O(n),t=Ep(t),t!==null)if(e=Fg(t),e===null)t=null;else if(r=e.tag,r===13){if(t=tX(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return QE=t,null}function AX(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xfe()){case GO:return 1;case sX:return 4;case ME:case Yfe:return 16;case iX:return 536870912;default:return 16}default:return 16}}var K0=null,WO=null,z_=null;function mX(){if(z_)return z_;var t,e=WO,r=e.length,n,a="value"in K0?K0.value:K0.textContent,s=a.length;for(t=0;t<r&&e[t]===a[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===a[s-n];n++);return z_=a.slice(t,1<n?1-n:void 0)}function W_(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function qN(){return!0}function ZL(){return!1}function Jd(t){function e(r,n,a,s,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?qN:ZL,this.isPropagationStopped=ZL,this}return ji(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=qN)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=qN)},persist:function(){},isPersistent:qN}),e}var i1={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},XO=Jd(i1),xw=ji({},i1,{view:0,detail:0}),dhe=Jd(xw),a4,s4,sy,lI=ji({},xw,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:YO,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==sy&&(sy&&t.type==="mousemove"?(a4=t.screenX-sy.screenX,s4=t.screenY-sy.screenY):s4=a4=0,sy=t),a4)},movementY:function(t){return"movementY"in t?t.movementY:s4}}),eU=Jd(lI),uhe=ji({},lI,{dataTransfer:0}),fhe=Jd(uhe),hhe=ji({},xw,{relatedTarget:0}),i4=Jd(hhe),Ahe=ji({},i1,{animationName:0,elapsedTime:0,pseudoElement:0}),mhe=Jd(Ahe),phe=ji({},i1,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ghe=Jd(phe),xhe=ji({},i1,{data:0}),tU=Jd(xhe),vhe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yhe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bhe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function whe(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=bhe[t])?!!e[t]:!1}function YO(){return whe}var Nhe=ji({},xw,{key:function(t){if(t.key){var e=vhe[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=W_(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?yhe[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:YO,charCode:function(t){return t.type==="keypress"?W_(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?W_(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Che=Jd(Nhe),_he=ji({},lI,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rU=Jd(_he),Ehe=ji({},xw,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:YO}),She=Jd(Ehe),jhe=ji({},i1,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ihe=Jd(jhe),Phe=ji({},lI,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),The=Jd(Phe),Bhe=[9,13,27,32],JO=mA&&"CompositionEvent"in window,hb=null;mA&&"documentMode"in document&&(hb=document.documentMode);var khe=mA&&"TextEvent"in window&&!hb,pX=mA&&(!JO||hb&&8<hb&&11>=hb),nU=" ",aU=!1;function gX(t,e){switch(t){case"keyup":return Bhe.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xX(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Qx=!1;function Fhe(t,e){switch(t){case"compositionend":return xX(e);case"keypress":return e.which!==32?null:(aU=!0,nU);case"textInput":return t=e.data,t===nU&&aU?null:t;default:return null}}function Ohe(t,e){if(Qx)return t==="compositionend"||!JO&&gX(t,e)?(t=mX(),z_=WO=K0=null,Qx=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return pX&&e.locale!=="ko"?null:e.data;default:return null}}var Dhe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sU(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Dhe[t.type]:e==="textarea"}function vX(t,e,r,n){XW(n),e=VE(e,"onChange"),0<e.length&&(r=new XO("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Ab=null,r2=null;function Rhe(t){PX(t,0)}function cI(t){var e=$x(t);if(HW(e))return t}function Mhe(t,e){if(t==="change")return e}var yX=!1;if(mA){var o4;if(mA){var l4="oninput"in document;if(!l4){var iU=document.createElement("div");iU.setAttribute("oninput","return;"),l4=typeof iU.oninput=="function"}o4=l4}else o4=!1;yX=o4&&(!document.documentMode||9<document.documentMode)}function oU(){Ab&&(Ab.detachEvent("onpropertychange",bX),r2=Ab=null)}function bX(t){if(t.propertyName==="value"&&cI(r2)){var e=[];vX(e,r2,t,$O(t)),eX(Rhe,e)}}function Lhe(t,e,r){t==="focusin"?(oU(),Ab=e,r2=r,Ab.attachEvent("onpropertychange",bX)):t==="focusout"&&oU()}function Uhe(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return cI(r2)}function Qhe(t,e){if(t==="click")return cI(e)}function Vhe(t,e){if(t==="input"||t==="change")return cI(e)}function Hhe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ef=typeof Object.is=="function"?Object.is:Hhe;function n2(t,e){if(Ef(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!zT.call(e,a)||!Ef(t[a],e[a]))return!1}return!0}function lU(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function cU(t,e){var r=lU(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lU(r)}}function wX(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?wX(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function NX(){for(var t=window,e=OE();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=OE(t.document)}return e}function ZO(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function $he(t){var e=NX(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&wX(r.ownerDocument.documentElement,r)){if(n!==null&&ZO(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!t.extend&&s>n&&(a=n,n=s,s=a),a=cU(r,s);var o=cU(r,n);a&&o&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Ghe=mA&&"documentMode"in document&&11>=document.documentMode,Vx=null,hB=null,mb=null,AB=!1;function dU(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;AB||Vx==null||Vx!==OE(n)||(n=Vx,"selectionStart"in n&&ZO(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),mb&&n2(mb,n)||(mb=n,n=VE(hB,"onSelect"),0<n.length&&(e=new XO("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Vx)))}function zN(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Hx={animationend:zN("Animation","AnimationEnd"),animationiteration:zN("Animation","AnimationIteration"),animationstart:zN("Animation","AnimationStart"),transitionend:zN("Transition","TransitionEnd")},c4={},CX={};mA&&(CX=document.createElement("div").style,"AnimationEvent"in window||(delete Hx.animationend.animation,delete Hx.animationiteration.animation,delete Hx.animationstart.animation),"TransitionEvent"in window||delete Hx.transitionend.transition);function dI(t){if(c4[t])return c4[t];if(!Hx[t])return t;var e=Hx[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in CX)return c4[t]=e[r];return t}var _X=dI("animationend"),EX=dI("animationiteration"),SX=dI("animationstart"),jX=dI("transitionend"),IX=new Map,uU="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Mm(t,e){IX.set(t,e),kg(e,[t])}for(var d4=0;d4<uU.length;d4++){var u4=uU[d4],Khe=u4.toLowerCase(),qhe=u4[0].toUpperCase()+u4.slice(1);Mm(Khe,"on"+qhe)}Mm(_X,"onAnimationEnd");Mm(EX,"onAnimationIteration");Mm(SX,"onAnimationStart");Mm("dblclick","onDoubleClick");Mm("focusin","onFocus");Mm("focusout","onBlur");Mm(jX,"onTransitionEnd");_v("onMouseEnter",["mouseout","mouseover"]);_v("onMouseLeave",["mouseout","mouseover"]);_v("onPointerEnter",["pointerout","pointerover"]);_v("onPointerLeave",["pointerout","pointerover"]);kg("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));kg("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));kg("onBeforeInput",["compositionend","keypress","textInput","paste"]);kg("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));kg("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));kg("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vy="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zhe=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vy));function fU(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,Kfe(n,e,void 0,t),t.currentTarget=null}function PX(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],a=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==s&&a.isPropagationStopped())break e;fU(a,l,d),s=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==s&&a.isPropagationStopped())break e;fU(a,l,d),s=c}}}if(RE)throw t=cB,RE=!1,cB=null,t}function Gs(t,e){var r=e[vB];r===void 0&&(r=e[vB]=new Set);var n=t+"__bubble";r.has(n)||(TX(e,t,2,!1),r.add(n))}function f4(t,e,r){var n=0;e&&(n|=4),TX(r,t,n,e)}var WN="_reactListening"+Math.random().toString(36).slice(2);function a2(t){if(!t[WN]){t[WN]=!0,MW.forEach(function(r){r!=="selectionchange"&&(zhe.has(r)||f4(r,!1,t),f4(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[WN]||(e[WN]=!0,f4("selectionchange",!1,e))}}function TX(t,e,r,n){switch(AX(e)){case 1:var a=lhe;break;case 4:a=che;break;default:a=zO}r=a.bind(null,e,r,t),a=void 0,!lB||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),n?a!==void 0?t.addEventListener(e,r,{capture:!0,passive:a}):t.addEventListener(e,r,!0):a!==void 0?t.addEventListener(e,r,{passive:a}):t.addEventListener(e,r,!1)}function h4(t,e,r,n,a){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;o=o.return}for(;l!==null;){if(o=Ep(l),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}l=l.parentNode}}n=n.return}eX(function(){var d=s,u=$O(r),f=[];e:{var A=IX.get(t);if(A!==void 0){var h=XO,m=t;switch(t){case"keypress":if(W_(r)===0)break e;case"keydown":case"keyup":h=Che;break;case"focusin":m="focus",h=i4;break;case"focusout":m="blur",h=i4;break;case"beforeblur":case"afterblur":h=i4;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=eU;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=fhe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=She;break;case _X:case EX:case SX:h=mhe;break;case jX:h=Ihe;break;case"scroll":h=dhe;break;case"wheel":h=The;break;case"copy":case"cut":case"paste":h=ghe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=rU}var p=(e&4)!==0,x=!p&&t==="scroll",v=p?A!==null?A+"Capture":null:A;p=[];for(var y=d,b;y!==null;){b=y;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,v!==null&&(w=Jb(y,v),w!=null&&p.push(s2(y,w,b)))),x)break;y=y.return}0<p.length&&(A=new h(A,m,null,r,u),f.push({event:A,listeners:p}))}}if(!(e&7)){e:{if(A=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",A&&r!==iB&&(m=r.relatedTarget||r.fromElement)&&(Ep(m)||m[pA]))break e;if((h||A)&&(A=u.window===u?u:(A=u.ownerDocument)?A.defaultView||A.parentWindow:window,h?(m=r.relatedTarget||r.toElement,h=d,m=m?Ep(m):null,m!==null&&(x=Fg(m),m!==x||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=d),h!==m)){if(p=eU,w="onMouseLeave",v="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(p=rU,w="onPointerLeave",v="onPointerEnter",y="pointer"),x=h==null?A:$x(h),b=m==null?A:$x(m),A=new p(w,y+"leave",h,r,u),A.target=x,A.relatedTarget=b,w=null,Ep(u)===d&&(p=new p(v,y+"enter",m,r,u),p.target=b,p.relatedTarget=x,w=p),x=w,h&&m)t:{for(p=h,v=m,y=0,b=p;b;b=rx(b))y++;for(b=0,w=v;w;w=rx(w))b++;for(;0<y-b;)p=rx(p),y--;for(;0<b-y;)v=rx(v),b--;for(;y--;){if(p===v||v!==null&&p===v.alternate)break t;p=rx(p),v=rx(v)}p=null}else p=null;h!==null&&hU(f,A,h,p,!1),m!==null&&x!==null&&hU(f,x,m,p,!0)}}e:{if(A=d?$x(d):window,h=A.nodeName&&A.nodeName.toLowerCase(),h==="select"||h==="input"&&A.type==="file")var I=Mhe;else if(sU(A))if(yX)I=Vhe;else{I=Uhe;var j=Lhe}else(h=A.nodeName)&&h.toLowerCase()==="input"&&(A.type==="checkbox"||A.type==="radio")&&(I=Qhe);if(I&&(I=I(t,d))){vX(f,I,r,u);break e}j&&j(t,A,d),t==="focusout"&&(j=A._wrapperState)&&j.controlled&&A.type==="number"&&tB(A,"number",A.value)}switch(j=d?$x(d):window,t){case"focusin":(sU(j)||j.contentEditable==="true")&&(Vx=j,hB=d,mb=null);break;case"focusout":mb=hB=Vx=null;break;case"mousedown":AB=!0;break;case"contextmenu":case"mouseup":case"dragend":AB=!1,dU(f,r,u);break;case"selectionchange":if(Ghe)break;case"keydown":case"keyup":dU(f,r,u)}var N;if(JO)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Qx?gX(t,r)&&(S="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(pX&&r.locale!=="ko"&&(Qx||S!=="onCompositionStart"?S==="onCompositionEnd"&&Qx&&(N=mX()):(K0=u,WO="value"in K0?K0.value:K0.textContent,Qx=!0)),j=VE(d,S),0<j.length&&(S=new tU(S,t,null,r,u),f.push({event:S,listeners:j}),N?S.data=N:(N=xX(r),N!==null&&(S.data=N)))),(N=khe?Fhe(t,r):Ohe(t,r))&&(d=VE(d,"onBeforeInput"),0<d.length&&(u=new tU("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:d}),u.data=N))}PX(f,e)})}function s2(t,e,r){return{instance:t,listener:e,currentTarget:r}}function VE(t,e){for(var r=e+"Capture",n=[];t!==null;){var a=t,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=Jb(t,r),s!=null&&n.unshift(s2(t,s,a)),s=Jb(t,e),s!=null&&n.push(s2(t,s,a))),t=t.return}return n}function rx(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function hU(t,e,r,n,a){for(var s=e._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,a?(c=Jb(r,s),c!=null&&o.unshift(s2(r,c,l))):a||(c=Jb(r,s),c!=null&&o.push(s2(r,c,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var Whe=/\r\n?/g,Xhe=/\u0000|\uFFFD/g;function AU(t){return(typeof t=="string"?t:""+t).replace(Whe,`
`).replace(Xhe,"")}function XN(t,e,r){if(e=AU(e),AU(t)!==e&&r)throw Error(Qr(425))}function HE(){}var mB=null,pB=null;function gB(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var xB=typeof setTimeout=="function"?setTimeout:void 0,Yhe=typeof clearTimeout=="function"?clearTimeout:void 0,mU=typeof Promise=="function"?Promise:void 0,Jhe=typeof queueMicrotask=="function"?queueMicrotask:typeof mU<"u"?function(t){return mU.resolve(null).then(t).catch(Zhe)}:xB;function Zhe(t){setTimeout(function(){throw t})}function A4(t,e){var r=e,n=0;do{var a=r.nextSibling;if(t.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){t.removeChild(a),t2(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);t2(e)}function sm(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function pU(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var o1=Math.random().toString(36).slice(2),Xf="__reactFiber$"+o1,i2="__reactProps$"+o1,pA="__reactContainer$"+o1,vB="__reactEvents$"+o1,eAe="__reactListeners$"+o1,tAe="__reactHandles$"+o1;function Ep(t){var e=t[Xf];if(e)return e;for(var r=t.parentNode;r;){if(e=r[pA]||r[Xf]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=pU(t);t!==null;){if(r=t[Xf])return r;t=pU(t)}return e}t=r,r=t.parentNode}return null}function vw(t){return t=t[Xf]||t[pA],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function $x(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Qr(33))}function uI(t){return t[i2]||null}var yB=[],Gx=-1;function Lm(t){return{current:t}}function Ys(t){0>Gx||(t.current=yB[Gx],yB[Gx]=null,Gx--)}function Rs(t,e){Gx++,yB[Gx]=t.current,t.current=e}var bm={},xc=Lm(bm),ud=Lm(!1),tg=bm;function Ev(t,e){var r=t.type.contextTypes;if(!r)return bm;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function fd(t){return t=t.childContextTypes,t!=null}function $E(){Ys(ud),Ys(xc)}function gU(t,e,r){if(xc.current!==bm)throw Error(Qr(168));Rs(xc,e),Rs(ud,r)}function BX(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in e))throw Error(Qr(108,Lfe(t)||"Unknown",a));return ji({},r,n)}function GE(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||bm,tg=xc.current,Rs(xc,t),Rs(ud,ud.current),!0}function xU(t,e,r){var n=t.stateNode;if(!n)throw Error(Qr(169));r?(t=BX(t,e,tg),n.__reactInternalMemoizedMergedChildContext=t,Ys(ud),Ys(xc),Rs(xc,t)):Ys(ud),Rs(ud,r)}var Hh=null,fI=!1,m4=!1;function kX(t){Hh===null?Hh=[t]:Hh.push(t)}function rAe(t){fI=!0,kX(t)}function Um(){if(!m4&&Hh!==null){m4=!0;var t=0,e=xs;try{var r=Hh;for(xs=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Hh=null,fI=!1}catch(a){throw Hh!==null&&(Hh=Hh.slice(t+1)),aX(GO,Um),a}finally{xs=e,m4=!1}}return null}var Kx=[],qx=0,KE=null,qE=0,Nu=[],Cu=0,rg=null,zh=1,Wh="";function dp(t,e){Kx[qx++]=qE,Kx[qx++]=KE,KE=t,qE=e}function FX(t,e,r){Nu[Cu++]=zh,Nu[Cu++]=Wh,Nu[Cu++]=rg,rg=t;var n=zh;t=Wh;var a=32-yf(n)-1;n&=~(1<<a),r+=1;var s=32-yf(e)+a;if(30<s){var o=a-a%5;s=(n&(1<<o)-1).toString(32),n>>=o,a-=o,zh=1<<32-yf(e)+a|r<<a|n,Wh=s+t}else zh=1<<s|r<<a|n,Wh=t}function eD(t){t.return!==null&&(dp(t,1),FX(t,1,0))}function tD(t){for(;t===KE;)KE=Kx[--qx],Kx[qx]=null,qE=Kx[--qx],Kx[qx]=null;for(;t===rg;)rg=Nu[--Cu],Nu[Cu]=null,Wh=Nu[--Cu],Nu[Cu]=null,zh=Nu[--Cu],Nu[Cu]=null}var Hd=null,Ld=null,li=!1,ff=null;function OX(t,e){var r=Eu(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function vU(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Hd=t,Ld=sm(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Hd=t,Ld=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=rg!==null?{id:zh,overflow:Wh}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Eu(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Hd=t,Ld=null,!0):!1;default:return!1}}function bB(t){return(t.mode&1)!==0&&(t.flags&128)===0}function wB(t){if(li){var e=Ld;if(e){var r=e;if(!vU(t,e)){if(bB(t))throw Error(Qr(418));e=sm(r.nextSibling);var n=Hd;e&&vU(t,e)?OX(n,r):(t.flags=t.flags&-4097|2,li=!1,Hd=t)}}else{if(bB(t))throw Error(Qr(418));t.flags=t.flags&-4097|2,li=!1,Hd=t}}}function yU(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Hd=t}function YN(t){if(t!==Hd)return!1;if(!li)return yU(t),li=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!gB(t.type,t.memoizedProps)),e&&(e=Ld)){if(bB(t))throw DX(),Error(Qr(418));for(;e;)OX(t,e),e=sm(e.nextSibling)}if(yU(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Qr(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Ld=sm(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Ld=null}}else Ld=Hd?sm(t.stateNode.nextSibling):null;return!0}function DX(){for(var t=Ld;t;)t=sm(t.nextSibling)}function Sv(){Ld=Hd=null,li=!1}function rD(t){ff===null?ff=[t]:ff.push(t)}var nAe=FA.ReactCurrentBatchConfig;function iy(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Qr(309));var n=r.stateNode}if(!n)throw Error(Qr(147,t));var a=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=a.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Qr(284));if(!r._owner)throw Error(Qr(290,t))}return t}function JN(t,e){throw t=Object.prototype.toString.call(e),Error(Qr(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function bU(t){var e=t._init;return e(t._payload)}function RX(t){function e(v,y){if(t){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function r(v,y){if(!t)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function n(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function a(v,y){return v=cm(v,y),v.index=0,v.sibling=null,v}function s(v,y,b){return v.index=b,t?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function l(v,y,b,w){return y===null||y.tag!==6?(y=w4(b,v.mode,w),y.return=v,y):(y=a(y,b),y.return=v,y)}function c(v,y,b,w){var I=b.type;return I===Ux?u(v,y,b.props.children,w,b.key):y!==null&&(y.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===I0&&bU(I)===y.type)?(w=a(y,b.props),w.ref=iy(v,y,b),w.return=v,w):(w=rE(b.type,b.key,b.props,null,v.mode,w),w.ref=iy(v,y,b),w.return=v,w)}function d(v,y,b,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=N4(b,v.mode,w),y.return=v,y):(y=a(y,b.children||[]),y.return=v,y)}function u(v,y,b,w,I){return y===null||y.tag!==7?(y=Mp(b,v.mode,w,I),y.return=v,y):(y=a(y,b),y.return=v,y)}function f(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=w4(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case QN:return b=rE(y.type,y.key,y.props,null,v.mode,b),b.ref=iy(v,null,y),b.return=v,b;case Lx:return y=N4(y,v.mode,b),y.return=v,y;case I0:var w=y._init;return f(v,w(y._payload),b)}if(Uy(y)||ty(y))return y=Mp(y,v.mode,b,null),y.return=v,y;JN(v,y)}return null}function A(v,y,b,w){var I=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return I!==null?null:l(v,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case QN:return b.key===I?c(v,y,b,w):null;case Lx:return b.key===I?d(v,y,b,w):null;case I0:return I=b._init,A(v,y,I(b._payload),w)}if(Uy(b)||ty(b))return I!==null?null:u(v,y,b,w,null);JN(v,b)}return null}function h(v,y,b,w,I){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(b)||null,l(y,v,""+w,I);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case QN:return v=v.get(w.key===null?b:w.key)||null,c(y,v,w,I);case Lx:return v=v.get(w.key===null?b:w.key)||null,d(y,v,w,I);case I0:var j=w._init;return h(v,y,b,j(w._payload),I)}if(Uy(w)||ty(w))return v=v.get(b)||null,u(y,v,w,I,null);JN(y,w)}return null}function m(v,y,b,w){for(var I=null,j=null,N=y,S=y=0,E=null;N!==null&&S<b.length;S++){N.index>S?(E=N,N=null):E=N.sibling;var B=A(v,N,b[S],w);if(B===null){N===null&&(N=E);break}t&&N&&B.alternate===null&&e(v,N),y=s(B,y,S),j===null?I=B:j.sibling=B,j=B,N=E}if(S===b.length)return r(v,N),li&&dp(v,S),I;if(N===null){for(;S<b.length;S++)N=f(v,b[S],w),N!==null&&(y=s(N,y,S),j===null?I=N:j.sibling=N,j=N);return li&&dp(v,S),I}for(N=n(v,N);S<b.length;S++)E=h(N,v,S,b[S],w),E!==null&&(t&&E.alternate!==null&&N.delete(E.key===null?S:E.key),y=s(E,y,S),j===null?I=E:j.sibling=E,j=E);return t&&N.forEach(function(k){return e(v,k)}),li&&dp(v,S),I}function p(v,y,b,w){var I=ty(b);if(typeof I!="function")throw Error(Qr(150));if(b=I.call(b),b==null)throw Error(Qr(151));for(var j=I=null,N=y,S=y=0,E=null,B=b.next();N!==null&&!B.done;S++,B=b.next()){N.index>S?(E=N,N=null):E=N.sibling;var k=A(v,N,B.value,w);if(k===null){N===null&&(N=E);break}t&&N&&k.alternate===null&&e(v,N),y=s(k,y,S),j===null?I=k:j.sibling=k,j=k,N=E}if(B.done)return r(v,N),li&&dp(v,S),I;if(N===null){for(;!B.done;S++,B=b.next())B=f(v,B.value,w),B!==null&&(y=s(B,y,S),j===null?I=B:j.sibling=B,j=B);return li&&dp(v,S),I}for(N=n(v,N);!B.done;S++,B=b.next())B=h(N,v,S,B.value,w),B!==null&&(t&&B.alternate!==null&&N.delete(B.key===null?S:B.key),y=s(B,y,S),j===null?I=B:j.sibling=B,j=B);return t&&N.forEach(function(T){return e(v,T)}),li&&dp(v,S),I}function x(v,y,b,w){if(typeof b=="object"&&b!==null&&b.type===Ux&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case QN:e:{for(var I=b.key,j=y;j!==null;){if(j.key===I){if(I=b.type,I===Ux){if(j.tag===7){r(v,j.sibling),y=a(j,b.props.children),y.return=v,v=y;break e}}else if(j.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===I0&&bU(I)===j.type){r(v,j.sibling),y=a(j,b.props),y.ref=iy(v,j,b),y.return=v,v=y;break e}r(v,j);break}else e(v,j);j=j.sibling}b.type===Ux?(y=Mp(b.props.children,v.mode,w,b.key),y.return=v,v=y):(w=rE(b.type,b.key,b.props,null,v.mode,w),w.ref=iy(v,y,b),w.return=v,v=w)}return o(v);case Lx:e:{for(j=b.key;y!==null;){if(y.key===j)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(v,y.sibling),y=a(y,b.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else e(v,y);y=y.sibling}y=N4(b,v.mode,w),y.return=v,v=y}return o(v);case I0:return j=b._init,x(v,y,j(b._payload),w)}if(Uy(b))return m(v,y,b,w);if(ty(b))return p(v,y,b,w);JN(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(v,y.sibling),y=a(y,b),y.return=v,v=y):(r(v,y),y=w4(b,v.mode,w),y.return=v,v=y),o(v)):r(v,y)}return x}var jv=RX(!0),MX=RX(!1),zE=Lm(null),WE=null,zx=null,nD=null;function aD(){nD=zx=WE=null}function sD(t){var e=zE.current;Ys(zE),t._currentValue=e}function NB(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function uv(t,e){WE=t,nD=zx=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ld=!0),t.firstContext=null)}function Ru(t){var e=t._currentValue;if(nD!==t)if(t={context:t,memoizedValue:e,next:null},zx===null){if(WE===null)throw Error(Qr(308));zx=t,WE.dependencies={lanes:0,firstContext:t}}else zx=zx.next=t;return e}var Sp=null;function iD(t){Sp===null?Sp=[t]:Sp.push(t)}function LX(t,e,r,n){var a=e.interleaved;return a===null?(r.next=r,iD(e)):(r.next=a.next,a.next=r),e.interleaved=r,gA(t,n)}function gA(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var P0=!1;function oD(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function UX(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function aA(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function im(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,La&2){var a=n.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),n.pending=e,gA(t,r)}return a=n.interleaved,a===null?(e.next=e,iD(n)):(e.next=a.next,a.next=e),n.interleaved=e,gA(t,r)}function X_(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,KO(t,r)}}function wU(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?a=s=e:s=s.next=e}else a=s=e;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function XE(t,e,r,n){var a=t.updateQueue;P0=!1;var s=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?s=d:o.next=d,o=c;var u=t.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(s!==null){var f=a.baseState;o=0,u=d=c=null,l=s;do{var A=l.lane,h=l.eventTime;if((n&A)===A){u!==null&&(u=u.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=t,p=l;switch(A=e,h=r,p.tag){case 1:if(m=p.payload,typeof m=="function"){f=m.call(h,f,A);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,A=typeof m=="function"?m.call(h,f,A):m,A==null)break e;f=ji({},f,A);break e;case 2:P0=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,A=a.effects,A===null?a.effects=[l]:A.push(l))}else h={eventTime:h,lane:A,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=h,c=f):u=u.next=h,o|=A;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;A=l,l=A.next,A.next=null,a.lastBaseUpdate=A,a.shared.pending=null}}while(!0);if(u===null&&(c=f),a.baseState=c,a.firstBaseUpdate=d,a.lastBaseUpdate=u,e=a.shared.interleaved,e!==null){a=e;do o|=a.lane,a=a.next;while(a!==e)}else s===null&&(a.shared.lanes=0);ag|=o,t.lanes=o,t.memoizedState=f}}function NU(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Qr(191,a));a.call(n)}}}var yw={},oh=Lm(yw),o2=Lm(yw),l2=Lm(yw);function jp(t){if(t===yw)throw Error(Qr(174));return t}function lD(t,e){switch(Rs(l2,e),Rs(o2,t),Rs(oh,yw),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:nB(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=nB(e,t)}Ys(oh),Rs(oh,e)}function Iv(){Ys(oh),Ys(o2),Ys(l2)}function QX(t){jp(l2.current);var e=jp(oh.current),r=nB(e,t.type);e!==r&&(Rs(o2,t),Rs(oh,r))}function cD(t){o2.current===t&&(Ys(oh),Ys(o2))}var Ni=Lm(0);function YE(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var p4=[];function dD(){for(var t=0;t<p4.length;t++)p4[t]._workInProgressVersionPrimary=null;p4.length=0}var Y_=FA.ReactCurrentDispatcher,g4=FA.ReactCurrentBatchConfig,ng=0,Si=null,Oo=null,ul=null,JE=!1,pb=!1,c2=0,aAe=0;function Wl(){throw Error(Qr(321))}function uD(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Ef(t[r],e[r]))return!1;return!0}function fD(t,e,r,n,a,s){if(ng=s,Si=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Y_.current=t===null||t.memoizedState===null?lAe:cAe,t=r(n,a),pb){s=0;do{if(pb=!1,c2=0,25<=s)throw Error(Qr(301));s+=1,ul=Oo=null,e.updateQueue=null,Y_.current=dAe,t=r(n,a)}while(pb)}if(Y_.current=ZE,e=Oo!==null&&Oo.next!==null,ng=0,ul=Oo=Si=null,JE=!1,e)throw Error(Qr(300));return t}function hD(){var t=c2!==0;return c2=0,t}function Wf(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ul===null?Si.memoizedState=ul=t:ul=ul.next=t,ul}function Mu(){if(Oo===null){var t=Si.alternate;t=t!==null?t.memoizedState:null}else t=Oo.next;var e=ul===null?Si.memoizedState:ul.next;if(e!==null)ul=e,Oo=t;else{if(t===null)throw Error(Qr(310));Oo=t,t={memoizedState:Oo.memoizedState,baseState:Oo.baseState,baseQueue:Oo.baseQueue,queue:Oo.queue,next:null},ul===null?Si.memoizedState=ul=t:ul=ul.next=t}return ul}function d2(t,e){return typeof e=="function"?e(t):e}function x4(t){var e=Mu(),r=e.queue;if(r===null)throw Error(Qr(311));r.lastRenderedReducer=t;var n=Oo,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var o=a.next;a.next=s.next,s.next=o}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var l=o=null,c=null,d=s;do{var u=d.lane;if((ng&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:t(n,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,Si.lanes|=u,ag|=u}d=d.next}while(d!==null&&d!==s);c===null?o=n:c.next=l,Ef(n,e.memoizedState)||(ld=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){a=t;do s=a.lane,Si.lanes|=s,ag|=s,a=a.next;while(a!==t)}else a===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function v4(t){var e=Mu(),r=e.queue;if(r===null)throw Error(Qr(311));r.lastRenderedReducer=t;var n=r.dispatch,a=r.pending,s=e.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do s=t(s,o.action),o=o.next;while(o!==a);Ef(s,e.memoizedState)||(ld=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function VX(){}function HX(t,e){var r=Si,n=Mu(),a=e(),s=!Ef(n.memoizedState,a);if(s&&(n.memoizedState=a,ld=!0),n=n.queue,AD(KX.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||ul!==null&&ul.memoizedState.tag&1){if(r.flags|=2048,u2(9,GX.bind(null,r,n,a,e),void 0,null),ml===null)throw Error(Qr(349));ng&30||$X(r,e,a)}return a}function $X(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Si.updateQueue,e===null?(e={lastEffect:null,stores:null},Si.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function GX(t,e,r,n){e.value=r,e.getSnapshot=n,qX(e)&&zX(t)}function KX(t,e,r){return r(function(){qX(e)&&zX(t)})}function qX(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Ef(t,r)}catch{return!0}}function zX(t){var e=gA(t,1);e!==null&&bf(e,t,1,-1)}function CU(t){var e=Wf();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d2,lastRenderedState:t},e.queue=t,t=t.dispatch=oAe.bind(null,Si,t),[e.memoizedState,t]}function u2(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Si.updateQueue,e===null?(e={lastEffect:null,stores:null},Si.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function WX(){return Mu().memoizedState}function J_(t,e,r,n){var a=Wf();Si.flags|=t,a.memoizedState=u2(1|e,r,void 0,n===void 0?null:n)}function hI(t,e,r,n){var a=Mu();n=n===void 0?null:n;var s=void 0;if(Oo!==null){var o=Oo.memoizedState;if(s=o.destroy,n!==null&&uD(n,o.deps)){a.memoizedState=u2(e,r,s,n);return}}Si.flags|=t,a.memoizedState=u2(1|e,r,s,n)}function _U(t,e){return J_(8390656,8,t,e)}function AD(t,e){return hI(2048,8,t,e)}function XX(t,e){return hI(4,2,t,e)}function YX(t,e){return hI(4,4,t,e)}function JX(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function ZX(t,e,r){return r=r!=null?r.concat([t]):null,hI(4,4,JX.bind(null,e,t),r)}function mD(){}function eY(t,e){var r=Mu();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&uD(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function tY(t,e){var r=Mu();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&uD(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function rY(t,e,r){return ng&21?(Ef(r,e)||(r=oX(),Si.lanes|=r,ag|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ld=!0),t.memoizedState=r)}function sAe(t,e){var r=xs;xs=r!==0&&4>r?r:4,t(!0);var n=g4.transition;g4.transition={};try{t(!1),e()}finally{xs=r,g4.transition=n}}function nY(){return Mu().memoizedState}function iAe(t,e,r){var n=lm(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},aY(t))sY(e,r);else if(r=LX(t,e,r,n),r!==null){var a=Qc();bf(r,t,n,a),iY(r,e,n)}}function oAe(t,e,r){var n=lm(t),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(aY(t))sY(e,a);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,r);if(a.hasEagerState=!0,a.eagerState=l,Ef(l,o)){var c=e.interleaved;c===null?(a.next=a,iD(e)):(a.next=c.next,c.next=a),e.interleaved=a;return}}catch{}finally{}r=LX(t,e,a,n),r!==null&&(a=Qc(),bf(r,t,n,a),iY(r,e,n))}}function aY(t){var e=t.alternate;return t===Si||e!==null&&e===Si}function sY(t,e){pb=JE=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function iY(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,KO(t,r)}}var ZE={readContext:Ru,useCallback:Wl,useContext:Wl,useEffect:Wl,useImperativeHandle:Wl,useInsertionEffect:Wl,useLayoutEffect:Wl,useMemo:Wl,useReducer:Wl,useRef:Wl,useState:Wl,useDebugValue:Wl,useDeferredValue:Wl,useTransition:Wl,useMutableSource:Wl,useSyncExternalStore:Wl,useId:Wl,unstable_isNewReconciler:!1},lAe={readContext:Ru,useCallback:function(t,e){return Wf().memoizedState=[t,e===void 0?null:e],t},useContext:Ru,useEffect:_U,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,J_(4194308,4,JX.bind(null,e,t),r)},useLayoutEffect:function(t,e){return J_(4194308,4,t,e)},useInsertionEffect:function(t,e){return J_(4,2,t,e)},useMemo:function(t,e){var r=Wf();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Wf();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=iAe.bind(null,Si,t),[n.memoizedState,t]},useRef:function(t){var e=Wf();return t={current:t},e.memoizedState=t},useState:CU,useDebugValue:mD,useDeferredValue:function(t){return Wf().memoizedState=t},useTransition:function(){var t=CU(!1),e=t[0];return t=sAe.bind(null,t[1]),Wf().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Si,a=Wf();if(li){if(r===void 0)throw Error(Qr(407));r=r()}else{if(r=e(),ml===null)throw Error(Qr(349));ng&30||$X(n,e,r)}a.memoizedState=r;var s={value:r,getSnapshot:e};return a.queue=s,_U(KX.bind(null,n,s,t),[t]),n.flags|=2048,u2(9,GX.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=Wf(),e=ml.identifierPrefix;if(li){var r=Wh,n=zh;r=(n&~(1<<32-yf(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=c2++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=aAe++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},cAe={readContext:Ru,useCallback:eY,useContext:Ru,useEffect:AD,useImperativeHandle:ZX,useInsertionEffect:XX,useLayoutEffect:YX,useMemo:tY,useReducer:x4,useRef:WX,useState:function(){return x4(d2)},useDebugValue:mD,useDeferredValue:function(t){var e=Mu();return rY(e,Oo.memoizedState,t)},useTransition:function(){var t=x4(d2)[0],e=Mu().memoizedState;return[t,e]},useMutableSource:VX,useSyncExternalStore:HX,useId:nY,unstable_isNewReconciler:!1},dAe={readContext:Ru,useCallback:eY,useContext:Ru,useEffect:AD,useImperativeHandle:ZX,useInsertionEffect:XX,useLayoutEffect:YX,useMemo:tY,useReducer:v4,useRef:WX,useState:function(){return v4(d2)},useDebugValue:mD,useDeferredValue:function(t){var e=Mu();return Oo===null?e.memoizedState=t:rY(e,Oo.memoizedState,t)},useTransition:function(){var t=v4(d2)[0],e=Mu().memoizedState;return[t,e]},useMutableSource:VX,useSyncExternalStore:HX,useId:nY,unstable_isNewReconciler:!1};function df(t,e){if(t&&t.defaultProps){e=ji({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function CB(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:ji({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var AI={isMounted:function(t){return(t=t._reactInternals)?Fg(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Qc(),a=lm(t),s=aA(n,a);s.payload=e,r!=null&&(s.callback=r),e=im(t,s,a),e!==null&&(bf(e,t,a,n),X_(e,t,a))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Qc(),a=lm(t),s=aA(n,a);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=im(t,s,a),e!==null&&(bf(e,t,a,n),X_(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Qc(),n=lm(t),a=aA(r,n);a.tag=2,e!=null&&(a.callback=e),e=im(t,a,n),e!==null&&(bf(e,t,n,r),X_(e,t,n))}};function EU(t,e,r,n,a,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!n2(r,n)||!n2(a,s):!0}function oY(t,e,r){var n=!1,a=bm,s=e.contextType;return typeof s=="object"&&s!==null?s=Ru(s):(a=fd(e)?tg:xc.current,n=e.contextTypes,s=(n=n!=null)?Ev(t,a):bm),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=AI,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=s),e}function SU(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&AI.enqueueReplaceState(e,e.state,null)}function _B(t,e,r,n){var a=t.stateNode;a.props=r,a.state=t.memoizedState,a.refs={},oD(t);var s=e.contextType;typeof s=="object"&&s!==null?a.context=Ru(s):(s=fd(e)?tg:xc.current,a.context=Ev(t,s)),a.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(CB(t,e,s,r),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&AI.enqueueReplaceState(a,a.state,null),XE(t,r,a,n),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function Pv(t,e){try{var r="",n=e;do r+=Mfe(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:a,digest:null}}function y4(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function EB(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var uAe=typeof WeakMap=="function"?WeakMap:Map;function lY(t,e,r){r=aA(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){tS||(tS=!0,DB=n),EB(t,e)},r}function cY(t,e,r){r=aA(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var a=e.value;r.payload=function(){return n(a)},r.callback=function(){EB(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){EB(t,e),typeof n!="function"&&(om===null?om=new Set([this]):om.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function jU(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new uAe;var a=new Set;n.set(e,a)}else a=n.get(e),a===void 0&&(a=new Set,n.set(e,a));a.has(r)||(a.add(r),t=_Ae.bind(null,t,e,r),e.then(t,t))}function IU(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function PU(t,e,r,n,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=aA(-1,1),e.tag=2,im(r,e,1))),r.lanes|=1),t)}var fAe=FA.ReactCurrentOwner,ld=!1;function Fc(t,e,r,n){e.child=t===null?MX(e,null,r,n):jv(e,t.child,r,n)}function TU(t,e,r,n,a){r=r.render;var s=e.ref;return uv(e,a),n=fD(t,e,r,n,s,a),r=hD(),t!==null&&!ld?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,xA(t,e,a)):(li&&r&&eD(e),e.flags|=1,Fc(t,e,n,a),e.child)}function BU(t,e,r,n,a){if(t===null){var s=r.type;return typeof s=="function"&&!ND(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,dY(t,e,s,n,a)):(t=rE(r.type,null,n,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&a)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:n2,r(o,n)&&t.ref===e.ref)return xA(t,e,a)}return e.flags|=1,t=cm(s,n),t.ref=e.ref,t.return=e,e.child=t}function dY(t,e,r,n,a){if(t!==null){var s=t.memoizedProps;if(n2(s,n)&&t.ref===e.ref)if(ld=!1,e.pendingProps=n=s,(t.lanes&a)!==0)t.flags&131072&&(ld=!0);else return e.lanes=t.lanes,xA(t,e,a)}return SB(t,e,r,n,a)}function uY(t,e,r){var n=e.pendingProps,a=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Rs(Xx,Bd),Bd|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Rs(Xx,Bd),Bd|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Rs(Xx,Bd),Bd|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,Rs(Xx,Bd),Bd|=n;return Fc(t,e,a,r),e.child}function fY(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function SB(t,e,r,n,a){var s=fd(r)?tg:xc.current;return s=Ev(e,s),uv(e,a),r=fD(t,e,r,n,s,a),n=hD(),t!==null&&!ld?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,xA(t,e,a)):(li&&n&&eD(e),e.flags|=1,Fc(t,e,r,a),e.child)}function kU(t,e,r,n,a){if(fd(r)){var s=!0;GE(e)}else s=!1;if(uv(e,a),e.stateNode===null)Z_(t,e),oY(e,r,n),_B(e,r,n,a),n=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=Ru(d):(d=fd(r)?tg:xc.current,d=Ev(e,d));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==d)&&SU(e,o,n,d),P0=!1;var A=e.memoizedState;o.state=A,XE(e,n,o,a),c=e.memoizedState,l!==n||A!==c||ud.current||P0?(typeof u=="function"&&(CB(e,r,u,n),c=e.memoizedState),(l=P0||EU(e,r,l,n,A,c,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=d,n=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,UX(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:df(e.type,l),o.props=d,f=e.pendingProps,A=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Ru(c):(c=fd(r)?tg:xc.current,c=Ev(e,c));var h=r.getDerivedStateFromProps;(u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||A!==c)&&SU(e,o,n,c),P0=!1,A=e.memoizedState,o.state=A,XE(e,n,o,a);var m=e.memoizedState;l!==f||A!==m||ud.current||P0?(typeof h=="function"&&(CB(e,r,h,n),m=e.memoizedState),(d=P0||EU(e,r,d,n,A,m,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=m),o.props=n,o.state=m,o.context=c,n=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=1024),n=!1)}return jB(t,e,r,n,s,a)}function jB(t,e,r,n,a,s){fY(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return a&&xU(e,r,!1),xA(t,e,s);n=e.stateNode,fAe.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=jv(e,t.child,null,s),e.child=jv(e,null,l,s)):Fc(t,e,l,s),e.memoizedState=n.state,a&&xU(e,r,!0),e.child}function hY(t){var e=t.stateNode;e.pendingContext?gU(t,e.pendingContext,e.pendingContext!==e.context):e.context&&gU(t,e.context,!1),lD(t,e.containerInfo)}function FU(t,e,r,n,a){return Sv(),rD(a),e.flags|=256,Fc(t,e,r,n),e.child}var IB={dehydrated:null,treeContext:null,retryLane:0};function PB(t){return{baseLanes:t,cachePool:null,transitions:null}}function AY(t,e,r){var n=e.pendingProps,a=Ni.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(a&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),Rs(Ni,a&1),t===null)return wB(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=gI(o,n,0,null),t=Mp(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=PB(r),e.memoizedState=IB,t):pD(e,o));if(a=t.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return hAe(t,e,o,n,l,a,r);if(s){s=n.fallback,o=e.mode,a=t.child,l=a.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==a?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=cm(a,c),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?s=cm(l,s):(s=Mp(s,o,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?PB(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~r,e.memoizedState=IB,n}return s=t.child,t=s.sibling,n=cm(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function pD(t,e){return e=gI({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ZN(t,e,r,n){return n!==null&&rD(n),jv(e,t.child,null,r),t=pD(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function hAe(t,e,r,n,a,s,o){if(r)return e.flags&256?(e.flags&=-257,n=y4(Error(Qr(422))),ZN(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,a=e.mode,n=gI({mode:"visible",children:n.children},a,0,null),s=Mp(s,a,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&jv(e,t.child,null,o),e.child.memoizedState=PB(o),e.memoizedState=IB,s);if(!(e.mode&1))return ZN(t,e,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(Qr(419)),n=y4(s,n,void 0),ZN(t,e,o,n)}if(l=(o&t.childLanes)!==0,ld||l){if(n=ml,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,gA(t,a),bf(n,t,a,-1))}return wD(),n=y4(Error(Qr(421))),ZN(t,e,o,n)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=EAe.bind(null,t),a._reactRetry=e,null):(t=s.treeContext,Ld=sm(a.nextSibling),Hd=e,li=!0,ff=null,t!==null&&(Nu[Cu++]=zh,Nu[Cu++]=Wh,Nu[Cu++]=rg,zh=t.id,Wh=t.overflow,rg=e),e=pD(e,n.children),e.flags|=4096,e)}function OU(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),NB(t.return,e,r)}function b4(t,e,r,n,a){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function mY(t,e,r){var n=e.pendingProps,a=n.revealOrder,s=n.tail;if(Fc(t,e,n.children,r),n=Ni.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&OU(t,r,e);else if(t.tag===19)OU(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Rs(Ni,n),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(r=e.child,a=null;r!==null;)t=r.alternate,t!==null&&YE(t)===null&&(a=r),r=r.sibling;r=a,r===null?(a=e.child,e.child=null):(a=r.sibling,r.sibling=null),b4(e,!1,a,r,s);break;case"backwards":for(r=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&YE(t)===null){e.child=a;break}t=a.sibling,a.sibling=r,r=a,a=t}b4(e,!0,r,null,s);break;case"together":b4(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Z_(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function xA(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),ag|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Qr(153));if(e.child!==null){for(t=e.child,r=cm(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=cm(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function AAe(t,e,r){switch(e.tag){case 3:hY(e),Sv();break;case 5:QX(e);break;case 1:fd(e.type)&&GE(e);break;case 4:lD(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,a=e.memoizedProps.value;Rs(zE,n._currentValue),n._currentValue=a;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Rs(Ni,Ni.current&1),e.flags|=128,null):r&e.child.childLanes?AY(t,e,r):(Rs(Ni,Ni.current&1),t=xA(t,e,r),t!==null?t.sibling:null);Rs(Ni,Ni.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return mY(t,e,r);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Rs(Ni,Ni.current),n)break;return null;case 22:case 23:return e.lanes=0,uY(t,e,r)}return xA(t,e,r)}var pY,TB,gY,xY;pY=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};TB=function(){};gY=function(t,e,r,n){var a=t.memoizedProps;if(a!==n){t=e.stateNode,jp(oh.current);var s=null;switch(r){case"input":a=ZT(t,a),n=ZT(t,n),s=[];break;case"select":a=ji({},a,{value:void 0}),n=ji({},n,{value:void 0}),s=[];break;case"textarea":a=rB(t,a),n=rB(t,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=HE)}aB(r,n);var o;r=null;for(d in a)if(!n.hasOwnProperty(d)&&a.hasOwnProperty(d)&&a[d]!=null)if(d==="style"){var l=a[d];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Xb.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in n){var c=n[d];if(l=a!=null?a[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Xb.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Gs("scroll",t),s||l===c||(s=[])):(s=s||[]).push(d,c))}r&&(s=s||[]).push("style",r);var d=s;(e.updateQueue=d)&&(e.flags|=4)}};xY=function(t,e,r,n){r!==n&&(e.flags|=4)};function oy(t,e){if(!li)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Xl(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var a=t.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function mAe(t,e,r){var n=e.pendingProps;switch(tD(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xl(e),null;case 1:return fd(e.type)&&$E(),Xl(e),null;case 3:return n=e.stateNode,Iv(),Ys(ud),Ys(xc),dD(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(YN(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ff!==null&&(LB(ff),ff=null))),TB(t,e),Xl(e),null;case 5:cD(e);var a=jp(l2.current);if(r=e.type,t!==null&&e.stateNode!=null)gY(t,e,r,n,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Qr(166));return Xl(e),null}if(t=jp(oh.current),YN(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Xf]=e,n[i2]=s,t=(e.mode&1)!==0,r){case"dialog":Gs("cancel",n),Gs("close",n);break;case"iframe":case"object":case"embed":Gs("load",n);break;case"video":case"audio":for(a=0;a<Vy.length;a++)Gs(Vy[a],n);break;case"source":Gs("error",n);break;case"img":case"image":case"link":Gs("error",n),Gs("load",n);break;case"details":Gs("toggle",n);break;case"input":$L(n,s),Gs("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Gs("invalid",n);break;case"textarea":KL(n,s),Gs("invalid",n)}aB(r,s),a=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&XN(n.textContent,l,t),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&XN(n.textContent,l,t),a=["children",""+l]):Xb.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Gs("scroll",n)}switch(r){case"input":VN(n),GL(n,s,!0);break;case"textarea":VN(n),qL(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=HE)}n=a,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=KW(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[Xf]=e,t[i2]=n,pY(t,e,!1,!1),e.stateNode=t;e:{switch(o=sB(r,n),r){case"dialog":Gs("cancel",t),Gs("close",t),a=n;break;case"iframe":case"object":case"embed":Gs("load",t),a=n;break;case"video":case"audio":for(a=0;a<Vy.length;a++)Gs(Vy[a],t);a=n;break;case"source":Gs("error",t),a=n;break;case"img":case"image":case"link":Gs("error",t),Gs("load",t),a=n;break;case"details":Gs("toggle",t),a=n;break;case"input":$L(t,n),a=ZT(t,n),Gs("invalid",t);break;case"option":a=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},a=ji({},n,{value:void 0}),Gs("invalid",t);break;case"textarea":KL(t,n),a=rB(t,n),Gs("invalid",t);break;default:a=n}aB(r,a),l=a;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?WW(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&qW(t,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Yb(t,c):typeof c=="number"&&Yb(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Xb.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Gs("scroll",t):c!=null&&UO(t,s,c,o))}switch(r){case"input":VN(t),GL(t,n,!1);break;case"textarea":VN(t),qL(t);break;case"option":n.value!=null&&t.setAttribute("value",""+ym(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?ov(t,!!n.multiple,s,!1):n.defaultValue!=null&&ov(t,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=HE)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Xl(e),null;case 6:if(t&&e.stateNode!=null)xY(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Qr(166));if(r=jp(l2.current),jp(oh.current),YN(e)){if(n=e.stateNode,r=e.memoizedProps,n[Xf]=e,(s=n.nodeValue!==r)&&(t=Hd,t!==null))switch(t.tag){case 3:XN(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&XN(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Xf]=e,e.stateNode=n}return Xl(e),null;case 13:if(Ys(Ni),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(li&&Ld!==null&&e.mode&1&&!(e.flags&128))DX(),Sv(),e.flags|=98560,s=!1;else if(s=YN(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Qr(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Qr(317));s[Xf]=e}else Sv(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Xl(e),s=!1}else ff!==null&&(LB(ff),ff=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Ni.current&1?$o===0&&($o=3):wD())),e.updateQueue!==null&&(e.flags|=4),Xl(e),null);case 4:return Iv(),TB(t,e),t===null&&a2(e.stateNode.containerInfo),Xl(e),null;case 10:return sD(e.type._context),Xl(e),null;case 17:return fd(e.type)&&$E(),Xl(e),null;case 19:if(Ys(Ni),s=e.memoizedState,s===null)return Xl(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)oy(s,!1);else{if($o!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=YE(t),o!==null){for(e.flags|=128,oy(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Rs(Ni,Ni.current&1|2),e.child}t=t.sibling}s.tail!==null&&ao()>Tv&&(e.flags|=128,n=!0,oy(s,!1),e.lanes=4194304)}else{if(!n)if(t=YE(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),oy(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!li)return Xl(e),null}else 2*ao()-s.renderingStartTime>Tv&&r!==1073741824&&(e.flags|=128,n=!0,oy(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(r=s.last,r!==null?r.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ao(),e.sibling=null,r=Ni.current,Rs(Ni,n?r&1|2:r&1),e):(Xl(e),null);case 22:case 23:return bD(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Bd&1073741824&&(Xl(e),e.subtreeFlags&6&&(e.flags|=8192)):Xl(e),null;case 24:return null;case 25:return null}throw Error(Qr(156,e.tag))}function pAe(t,e){switch(tD(e),e.tag){case 1:return fd(e.type)&&$E(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Iv(),Ys(ud),Ys(xc),dD(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return cD(e),null;case 13:if(Ys(Ni),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Qr(340));Sv()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ys(Ni),null;case 4:return Iv(),null;case 10:return sD(e.type._context),null;case 22:case 23:return bD(),null;case 24:return null;default:return null}}var eC=!1,fc=!1,gAe=typeof WeakSet=="function"?WeakSet:Set,pn=null;function Wx(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Li(t,e,n)}else r.current=null}function BB(t,e,r){try{r()}catch(n){Li(t,e,n)}}var DU=!1;function xAe(t,e){if(mB=UE,t=NX(),ZO(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,d=0,u=0,f=t,A=null;t:for(;;){for(var h;f!==r||a!==0&&f.nodeType!==3||(l=o+a),f!==s||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(h=f.firstChild)!==null;)A=f,f=h;for(;;){if(f===t)break t;if(A===r&&++d===a&&(l=o),A===s&&++u===n&&(c=o),(h=f.nextSibling)!==null)break;f=A,A=f.parentNode}f=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(pB={focusedElem:t,selectionRange:r},UE=!1,pn=e;pn!==null;)if(e=pn,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,pn=t;else for(;pn!==null;){e=pn;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var p=m.memoizedProps,x=m.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?p:df(e.type,p),x);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Qr(163))}}catch(w){Li(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,pn=t;break}pn=e.return}return m=DU,DU=!1,m}function gb(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&t)===t){var s=a.destroy;a.destroy=void 0,s!==void 0&&BB(e,r,s)}a=a.next}while(a!==n)}}function mI(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function kB(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function vY(t){var e=t.alternate;e!==null&&(t.alternate=null,vY(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Xf],delete e[i2],delete e[vB],delete e[eAe],delete e[tAe])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function yY(t){return t.tag===5||t.tag===3||t.tag===4}function RU(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||yY(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function FB(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=HE));else if(n!==4&&(t=t.child,t!==null))for(FB(t,e,r),t=t.sibling;t!==null;)FB(t,e,r),t=t.sibling}function OB(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(OB(t,e,r),t=t.sibling;t!==null;)OB(t,e,r),t=t.sibling}var kl=null,uf=!1;function c0(t,e,r){for(r=r.child;r!==null;)bY(t,e,r),r=r.sibling}function bY(t,e,r){if(ih&&typeof ih.onCommitFiberUnmount=="function")try{ih.onCommitFiberUnmount(oI,r)}catch{}switch(r.tag){case 5:fc||Wx(r,e);case 6:var n=kl,a=uf;kl=null,c0(t,e,r),kl=n,uf=a,kl!==null&&(uf?(t=kl,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):kl.removeChild(r.stateNode));break;case 18:kl!==null&&(uf?(t=kl,r=r.stateNode,t.nodeType===8?A4(t.parentNode,r):t.nodeType===1&&A4(t,r),t2(t)):A4(kl,r.stateNode));break;case 4:n=kl,a=uf,kl=r.stateNode.containerInfo,uf=!0,c0(t,e,r),kl=n,uf=a;break;case 0:case 11:case 14:case 15:if(!fc&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&BB(r,e,o),a=a.next}while(a!==n)}c0(t,e,r);break;case 1:if(!fc&&(Wx(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Li(r,e,l)}c0(t,e,r);break;case 21:c0(t,e,r);break;case 22:r.mode&1?(fc=(n=fc)||r.memoizedState!==null,c0(t,e,r),fc=n):c0(t,e,r);break;default:c0(t,e,r)}}function MU(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new gAe),e.forEach(function(n){var a=SAe.bind(null,t,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Zu(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:kl=l.stateNode,uf=!1;break e;case 3:kl=l.stateNode.containerInfo,uf=!0;break e;case 4:kl=l.stateNode.containerInfo,uf=!0;break e}l=l.return}if(kl===null)throw Error(Qr(160));bY(s,o,a),kl=null,uf=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(d){Li(a,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)wY(e,t),e=e.sibling}function wY(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Zu(e,t),Uf(t),n&4){try{gb(3,t,t.return),mI(3,t)}catch(p){Li(t,t.return,p)}try{gb(5,t,t.return)}catch(p){Li(t,t.return,p)}}break;case 1:Zu(e,t),Uf(t),n&512&&r!==null&&Wx(r,r.return);break;case 5:if(Zu(e,t),Uf(t),n&512&&r!==null&&Wx(r,r.return),t.flags&32){var a=t.stateNode;try{Yb(a,"")}catch(p){Li(t,t.return,p)}}if(n&4&&(a=t.stateNode,a!=null)){var s=t.memoizedProps,o=r!==null?r.memoizedProps:s,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&$W(a,s),sB(l,o);var d=sB(l,s);for(o=0;o<c.length;o+=2){var u=c[o],f=c[o+1];u==="style"?WW(a,f):u==="dangerouslySetInnerHTML"?qW(a,f):u==="children"?Yb(a,f):UO(a,u,f,d)}switch(l){case"input":eB(a,s);break;case"textarea":GW(a,s);break;case"select":var A=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?ov(a,!!s.multiple,h,!1):A!==!!s.multiple&&(s.defaultValue!=null?ov(a,!!s.multiple,s.defaultValue,!0):ov(a,!!s.multiple,s.multiple?[]:"",!1))}a[i2]=s}catch(p){Li(t,t.return,p)}}break;case 6:if(Zu(e,t),Uf(t),n&4){if(t.stateNode===null)throw Error(Qr(162));a=t.stateNode,s=t.memoizedProps;try{a.nodeValue=s}catch(p){Li(t,t.return,p)}}break;case 3:if(Zu(e,t),Uf(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{t2(e.containerInfo)}catch(p){Li(t,t.return,p)}break;case 4:Zu(e,t),Uf(t);break;case 13:Zu(e,t),Uf(t),a=t.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(vD=ao())),n&4&&MU(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(fc=(d=fc)||u,Zu(e,t),fc=d):Zu(e,t),Uf(t),n&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!u&&t.mode&1)for(pn=t,u=t.child;u!==null;){for(f=pn=u;pn!==null;){switch(A=pn,h=A.child,A.tag){case 0:case 11:case 14:case 15:gb(4,A,A.return);break;case 1:Wx(A,A.return);var m=A.stateNode;if(typeof m.componentWillUnmount=="function"){n=A,r=A.return;try{e=n,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(p){Li(n,r,p)}}break;case 5:Wx(A,A.return);break;case 22:if(A.memoizedState!==null){UU(f);continue}}h!==null?(h.return=A,pn=h):UU(f)}u=u.sibling}e:for(u=null,f=t;;){if(f.tag===5){if(u===null){u=f;try{a=f.stateNode,d?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=zW("display",o))}catch(p){Li(t,t.return,p)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(p){Li(t,t.return,p)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Zu(e,t),Uf(t),n&4&&MU(t);break;case 21:break;default:Zu(e,t),Uf(t)}}function Uf(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(yY(r)){var n=r;break e}r=r.return}throw Error(Qr(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Yb(a,""),n.flags&=-33);var s=RU(t);OB(t,s,a);break;case 3:case 4:var o=n.stateNode.containerInfo,l=RU(t);FB(t,l,o);break;default:throw Error(Qr(161))}}catch(c){Li(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function vAe(t,e,r){pn=t,NY(t)}function NY(t,e,r){for(var n=(t.mode&1)!==0;pn!==null;){var a=pn,s=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||eC;if(!o){var l=a.alternate,c=l!==null&&l.memoizedState!==null||fc;l=eC;var d=fc;if(eC=o,(fc=c)&&!d)for(pn=a;pn!==null;)o=pn,c=o.child,o.tag===22&&o.memoizedState!==null?QU(a):c!==null?(c.return=o,pn=c):QU(a);for(;s!==null;)pn=s,NY(s),s=s.sibling;pn=a,eC=l,fc=d}LU(t)}else a.subtreeFlags&8772&&s!==null?(s.return=a,pn=s):LU(t)}}function LU(t){for(;pn!==null;){var e=pn;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:fc||mI(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!fc)if(r===null)n.componentDidMount();else{var a=e.elementType===e.type?r.memoizedProps:df(e.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&NU(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}NU(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&t2(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Qr(163))}fc||e.flags&512&&kB(e)}catch(A){Li(e,e.return,A)}}if(e===t){pn=null;break}if(r=e.sibling,r!==null){r.return=e.return,pn=r;break}pn=e.return}}function UU(t){for(;pn!==null;){var e=pn;if(e===t){pn=null;break}var r=e.sibling;if(r!==null){r.return=e.return,pn=r;break}pn=e.return}}function QU(t){for(;pn!==null;){var e=pn;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{mI(4,e)}catch(c){Li(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var a=e.return;try{n.componentDidMount()}catch(c){Li(e,a,c)}}var s=e.return;try{kB(e)}catch(c){Li(e,s,c)}break;case 5:var o=e.return;try{kB(e)}catch(c){Li(e,o,c)}}}catch(c){Li(e,e.return,c)}if(e===t){pn=null;break}var l=e.sibling;if(l!==null){l.return=e.return,pn=l;break}pn=e.return}}var yAe=Math.ceil,eS=FA.ReactCurrentDispatcher,gD=FA.ReactCurrentOwner,Bu=FA.ReactCurrentBatchConfig,La=0,ml=null,bo=null,$l=0,Bd=0,Xx=Lm(0),$o=0,f2=null,ag=0,pI=0,xD=0,xb=null,id=null,vD=0,Tv=1/0,Vh=null,tS=!1,DB=null,om=null,tC=!1,q0=null,rS=0,vb=0,RB=null,eE=-1,tE=0;function Qc(){return La&6?ao():eE!==-1?eE:eE=ao()}function lm(t){return t.mode&1?La&2&&$l!==0?$l&-$l:nAe.transition!==null?(tE===0&&(tE=oX()),tE):(t=xs,t!==0||(t=window.event,t=t===void 0?16:AX(t.type)),t):1}function bf(t,e,r,n){if(50<vb)throw vb=0,RB=null,Error(Qr(185));gw(t,r,n),(!(La&2)||t!==ml)&&(t===ml&&(!(La&2)&&(pI|=r),$o===4&&D0(t,$l)),hd(t,n),r===1&&La===0&&!(e.mode&1)&&(Tv=ao()+500,fI&&Um()))}function hd(t,e){var r=t.callbackNode;nhe(t,e);var n=LE(t,t===ml?$l:0);if(n===0)r!==null&&XL(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&XL(r),e===1)t.tag===0?rAe(VU.bind(null,t)):kX(VU.bind(null,t)),Jhe(function(){!(La&6)&&Um()}),r=null;else{switch(lX(n)){case 1:r=GO;break;case 4:r=sX;break;case 16:r=ME;break;case 536870912:r=iX;break;default:r=ME}r=TY(r,CY.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function CY(t,e){if(eE=-1,tE=0,La&6)throw Error(Qr(327));var r=t.callbackNode;if(fv()&&t.callbackNode!==r)return null;var n=LE(t,t===ml?$l:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=nS(t,n);else{e=n;var a=La;La|=2;var s=EY();(ml!==t||$l!==e)&&(Vh=null,Tv=ao()+500,Rp(t,e));do try{NAe();break}catch(l){_Y(t,l)}while(!0);aD(),eS.current=s,La=a,bo!==null?e=0:(ml=null,$l=0,e=$o)}if(e!==0){if(e===2&&(a=dB(t),a!==0&&(n=a,e=MB(t,a))),e===1)throw r=f2,Rp(t,0),D0(t,n),hd(t,ao()),r;if(e===6)D0(t,n);else{if(a=t.current.alternate,!(n&30)&&!bAe(a)&&(e=nS(t,n),e===2&&(s=dB(t),s!==0&&(n=s,e=MB(t,s))),e===1))throw r=f2,Rp(t,0),D0(t,n),hd(t,ao()),r;switch(t.finishedWork=a,t.finishedLanes=n,e){case 0:case 1:throw Error(Qr(345));case 2:up(t,id,Vh);break;case 3:if(D0(t,n),(n&130023424)===n&&(e=vD+500-ao(),10<e)){if(LE(t,0)!==0)break;if(a=t.suspendedLanes,(a&n)!==n){Qc(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=xB(up.bind(null,t,id,Vh),e);break}up(t,id,Vh);break;case 4:if(D0(t,n),(n&4194240)===n)break;for(e=t.eventTimes,a=-1;0<n;){var o=31-yf(n);s=1<<o,o=e[o],o>a&&(a=o),n&=~s}if(n=a,n=ao()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*yAe(n/1960))-n,10<n){t.timeoutHandle=xB(up.bind(null,t,id,Vh),n);break}up(t,id,Vh);break;case 5:up(t,id,Vh);break;default:throw Error(Qr(329))}}}return hd(t,ao()),t.callbackNode===r?CY.bind(null,t):null}function MB(t,e){var r=xb;return t.current.memoizedState.isDehydrated&&(Rp(t,e).flags|=256),t=nS(t,e),t!==2&&(e=id,id=r,e!==null&&LB(e)),t}function LB(t){id===null?id=t:id.push.apply(id,t)}function bAe(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!Ef(s(),a))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function D0(t,e){for(e&=~xD,e&=~pI,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-yf(e),n=1<<r;t[r]=-1,e&=~n}}function VU(t){if(La&6)throw Error(Qr(327));fv();var e=LE(t,0);if(!(e&1))return hd(t,ao()),null;var r=nS(t,e);if(t.tag!==0&&r===2){var n=dB(t);n!==0&&(e=n,r=MB(t,n))}if(r===1)throw r=f2,Rp(t,0),D0(t,e),hd(t,ao()),r;if(r===6)throw Error(Qr(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,up(t,id,Vh),hd(t,ao()),null}function yD(t,e){var r=La;La|=1;try{return t(e)}finally{La=r,La===0&&(Tv=ao()+500,fI&&Um())}}function sg(t){q0!==null&&q0.tag===0&&!(La&6)&&fv();var e=La;La|=1;var r=Bu.transition,n=xs;try{if(Bu.transition=null,xs=1,t)return t()}finally{xs=n,Bu.transition=r,La=e,!(La&6)&&Um()}}function bD(){Bd=Xx.current,Ys(Xx)}function Rp(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,Yhe(r)),bo!==null)for(r=bo.return;r!==null;){var n=r;switch(tD(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&$E();break;case 3:Iv(),Ys(ud),Ys(xc),dD();break;case 5:cD(n);break;case 4:Iv();break;case 13:Ys(Ni);break;case 19:Ys(Ni);break;case 10:sD(n.type._context);break;case 22:case 23:bD()}r=r.return}if(ml=t,bo=t=cm(t.current,null),$l=Bd=e,$o=0,f2=null,xD=pI=ag=0,id=xb=null,Sp!==null){for(e=0;e<Sp.length;e++)if(r=Sp[e],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=a,n.next=o}r.pending=n}Sp=null}return t}function _Y(t,e){do{var r=bo;try{if(aD(),Y_.current=ZE,JE){for(var n=Si.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}JE=!1}if(ng=0,ul=Oo=Si=null,pb=!1,c2=0,gD.current=null,r===null||r.return===null){$o=1,f2=e,bo=null;break}e:{var s=t,o=r.return,l=r,c=e;if(e=$l,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var A=u.alternate;A?(u.updateQueue=A.updateQueue,u.memoizedState=A.memoizedState,u.lanes=A.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=IU(o);if(h!==null){h.flags&=-257,PU(h,o,l,s,e),h.mode&1&&jU(s,d,e),e=h,c=d;var m=e.updateQueue;if(m===null){var p=new Set;p.add(c),e.updateQueue=p}else m.add(c);break e}else{if(!(e&1)){jU(s,d,e),wD();break e}c=Error(Qr(426))}}else if(li&&l.mode&1){var x=IU(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),PU(x,o,l,s,e),rD(Pv(c,l));break e}}s=c=Pv(c,l),$o!==4&&($o=2),xb===null?xb=[s]:xb.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=lY(s,c,e);wU(s,v);break e;case 1:l=c;var y=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(om===null||!om.has(b)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=cY(s,l,e);wU(s,w);break e}}s=s.return}while(s!==null)}jY(r)}catch(I){e=I,bo===r&&r!==null&&(bo=r=r.return);continue}break}while(!0)}function EY(){var t=eS.current;return eS.current=ZE,t===null?ZE:t}function wD(){($o===0||$o===3||$o===2)&&($o=4),ml===null||!(ag&268435455)&&!(pI&268435455)||D0(ml,$l)}function nS(t,e){var r=La;La|=2;var n=EY();(ml!==t||$l!==e)&&(Vh=null,Rp(t,e));do try{wAe();break}catch(a){_Y(t,a)}while(!0);if(aD(),La=r,eS.current=n,bo!==null)throw Error(Qr(261));return ml=null,$l=0,$o}function wAe(){for(;bo!==null;)SY(bo)}function NAe(){for(;bo!==null&&!zfe();)SY(bo)}function SY(t){var e=PY(t.alternate,t,Bd);t.memoizedProps=t.pendingProps,e===null?jY(t):bo=e,gD.current=null}function jY(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=pAe(r,e),r!==null){r.flags&=32767,bo=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{$o=6,bo=null;return}}else if(r=mAe(r,e,Bd),r!==null){bo=r;return}if(e=e.sibling,e!==null){bo=e;return}bo=e=t}while(e!==null);$o===0&&($o=5)}function up(t,e,r){var n=xs,a=Bu.transition;try{Bu.transition=null,xs=1,CAe(t,e,r,n)}finally{Bu.transition=a,xs=n}return null}function CAe(t,e,r,n){do fv();while(q0!==null);if(La&6)throw Error(Qr(327));r=t.finishedWork;var a=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Qr(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(ahe(t,s),t===ml&&(bo=ml=null,$l=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||tC||(tC=!0,TY(ME,function(){return fv(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Bu.transition,Bu.transition=null;var o=xs;xs=1;var l=La;La|=4,gD.current=null,xAe(t,r),wY(r,t),$he(pB),UE=!!mB,pB=mB=null,t.current=r,vAe(r),Wfe(),La=l,xs=o,Bu.transition=s}else t.current=r;if(tC&&(tC=!1,q0=t,rS=a),s=t.pendingLanes,s===0&&(om=null),Jfe(r.stateNode),hd(t,ao()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)a=e[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(tS)throw tS=!1,t=DB,DB=null,t;return rS&1&&t.tag!==0&&fv(),s=t.pendingLanes,s&1?t===RB?vb++:(vb=0,RB=t):vb=0,Um(),null}function fv(){if(q0!==null){var t=lX(rS),e=Bu.transition,r=xs;try{if(Bu.transition=null,xs=16>t?16:t,q0===null)var n=!1;else{if(t=q0,q0=null,rS=0,La&6)throw Error(Qr(331));var a=La;for(La|=4,pn=t.current;pn!==null;){var s=pn,o=s.child;if(pn.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(pn=d;pn!==null;){var u=pn;switch(u.tag){case 0:case 11:case 15:gb(8,u,s)}var f=u.child;if(f!==null)f.return=u,pn=f;else for(;pn!==null;){u=pn;var A=u.sibling,h=u.return;if(vY(u),u===d){pn=null;break}if(A!==null){A.return=h,pn=A;break}pn=h}}}var m=s.alternate;if(m!==null){var p=m.child;if(p!==null){m.child=null;do{var x=p.sibling;p.sibling=null,p=x}while(p!==null)}}pn=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,pn=o;else e:for(;pn!==null;){if(s=pn,s.flags&2048)switch(s.tag){case 0:case 11:case 15:gb(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,pn=v;break e}pn=s.return}}var y=t.current;for(pn=y;pn!==null;){o=pn;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,pn=b;else e:for(o=y;pn!==null;){if(l=pn,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:mI(9,l)}}catch(I){Li(l,l.return,I)}if(l===o){pn=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,pn=w;break e}pn=l.return}}if(La=a,Um(),ih&&typeof ih.onPostCommitFiberRoot=="function")try{ih.onPostCommitFiberRoot(oI,t)}catch{}n=!0}return n}finally{xs=r,Bu.transition=e}}return!1}function HU(t,e,r){e=Pv(r,e),e=lY(t,e,1),t=im(t,e,1),e=Qc(),t!==null&&(gw(t,1,e),hd(t,e))}function Li(t,e,r){if(t.tag===3)HU(t,t,r);else for(;e!==null;){if(e.tag===3){HU(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(om===null||!om.has(n))){t=Pv(r,t),t=cY(e,t,1),e=im(e,t,1),t=Qc(),e!==null&&(gw(e,1,t),hd(e,t));break}}e=e.return}}function _Ae(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Qc(),t.pingedLanes|=t.suspendedLanes&r,ml===t&&($l&r)===r&&($o===4||$o===3&&($l&130023424)===$l&&500>ao()-vD?Rp(t,0):xD|=r),hd(t,e)}function IY(t,e){e===0&&(t.mode&1?(e=GN,GN<<=1,!(GN&130023424)&&(GN=4194304)):e=1);var r=Qc();t=gA(t,e),t!==null&&(gw(t,e,r),hd(t,r))}function EAe(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),IY(t,r)}function SAe(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,a=t.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Qr(314))}n!==null&&n.delete(e),IY(t,r)}var PY;PY=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||ud.current)ld=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return ld=!1,AAe(t,e,r);ld=!!(t.flags&131072)}else ld=!1,li&&e.flags&1048576&&FX(e,qE,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Z_(t,e),t=e.pendingProps;var a=Ev(e,xc.current);uv(e,r),a=fD(null,e,n,t,a,r);var s=hD();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,fd(n)?(s=!0,GE(e)):s=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,oD(e),a.updater=AI,e.stateNode=a,a._reactInternals=e,_B(e,n,t,r),e=jB(null,e,n,!0,s,r)):(e.tag=0,li&&s&&eD(e),Fc(null,e,a,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Z_(t,e),t=e.pendingProps,a=n._init,n=a(n._payload),e.type=n,a=e.tag=IAe(n),t=df(n,t),a){case 0:e=SB(null,e,n,t,r);break e;case 1:e=kU(null,e,n,t,r);break e;case 11:e=TU(null,e,n,t,r);break e;case 14:e=BU(null,e,n,df(n.type,t),r);break e}throw Error(Qr(306,n,""))}return e;case 0:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:df(n,a),SB(t,e,n,a,r);case 1:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:df(n,a),kU(t,e,n,a,r);case 3:e:{if(hY(e),t===null)throw Error(Qr(387));n=e.pendingProps,s=e.memoizedState,a=s.element,UX(t,e),XE(e,n,null,r);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){a=Pv(Error(Qr(423)),e),e=FU(t,e,n,r,a);break e}else if(n!==a){a=Pv(Error(Qr(424)),e),e=FU(t,e,n,r,a);break e}else for(Ld=sm(e.stateNode.containerInfo.firstChild),Hd=e,li=!0,ff=null,r=MX(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Sv(),n===a){e=xA(t,e,r);break e}Fc(t,e,n,r)}e=e.child}return e;case 5:return QX(e),t===null&&wB(e),n=e.type,a=e.pendingProps,s=t!==null?t.memoizedProps:null,o=a.children,gB(n,a)?o=null:s!==null&&gB(n,s)&&(e.flags|=32),fY(t,e),Fc(t,e,o,r),e.child;case 6:return t===null&&wB(e),null;case 13:return AY(t,e,r);case 4:return lD(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=jv(e,null,n,r):Fc(t,e,n,r),e.child;case 11:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:df(n,a),TU(t,e,n,a,r);case 7:return Fc(t,e,e.pendingProps,r),e.child;case 8:return Fc(t,e,e.pendingProps.children,r),e.child;case 12:return Fc(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,a=e.pendingProps,s=e.memoizedProps,o=a.value,Rs(zE,n._currentValue),n._currentValue=o,s!==null)if(Ef(s.value,o)){if(s.children===a.children&&!ud.current){e=xA(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=aA(-1,r&-r),c.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),NB(s.return,r,e),l.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Qr(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),NB(o,r,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Fc(t,e,a.children,r),e=e.child}return e;case 9:return a=e.type,n=e.pendingProps.children,uv(e,r),a=Ru(a),n=n(a),e.flags|=1,Fc(t,e,n,r),e.child;case 14:return n=e.type,a=df(n,e.pendingProps),a=df(n.type,a),BU(t,e,n,a,r);case 15:return dY(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:df(n,a),Z_(t,e),e.tag=1,fd(n)?(t=!0,GE(e)):t=!1,uv(e,r),oY(e,n,a),_B(e,n,a,r),jB(null,e,n,!0,t,r);case 19:return mY(t,e,r);case 22:return uY(t,e,r)}throw Error(Qr(156,e.tag))};function TY(t,e){return aX(t,e)}function jAe(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Eu(t,e,r,n){return new jAe(t,e,r,n)}function ND(t){return t=t.prototype,!(!t||!t.isReactComponent)}function IAe(t){if(typeof t=="function")return ND(t)?1:0;if(t!=null){if(t=t.$$typeof,t===VO)return 11;if(t===HO)return 14}return 2}function cm(t,e){var r=t.alternate;return r===null?(r=Eu(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function rE(t,e,r,n,a,s){var o=2;if(n=t,typeof t=="function")ND(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ux:return Mp(r.children,a,s,e);case QO:o=8,a|=8;break;case WT:return t=Eu(12,r,e,a|2),t.elementType=WT,t.lanes=s,t;case XT:return t=Eu(13,r,e,a),t.elementType=XT,t.lanes=s,t;case YT:return t=Eu(19,r,e,a),t.elementType=YT,t.lanes=s,t;case QW:return gI(r,a,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case LW:o=10;break e;case UW:o=9;break e;case VO:o=11;break e;case HO:o=14;break e;case I0:o=16,n=null;break e}throw Error(Qr(130,t==null?t:typeof t,""))}return e=Eu(o,r,e,a),e.elementType=t,e.type=n,e.lanes=s,e}function Mp(t,e,r,n){return t=Eu(7,t,n,e),t.lanes=r,t}function gI(t,e,r,n){return t=Eu(22,t,n,e),t.elementType=QW,t.lanes=r,t.stateNode={isHidden:!1},t}function w4(t,e,r){return t=Eu(6,t,null,e),t.lanes=r,t}function N4(t,e,r){return e=Eu(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function PAe(t,e,r,n,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=n4(0),this.expirationTimes=n4(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=n4(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function CD(t,e,r,n,a,s,o,l,c){return t=new PAe(t,e,r,l,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Eu(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},oD(s),t}function TAe(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Lx,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function BY(t){if(!t)return bm;t=t._reactInternals;e:{if(Fg(t)!==t||t.tag!==1)throw Error(Qr(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(fd(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Qr(171))}if(t.tag===1){var r=t.type;if(fd(r))return BX(t,r,e)}return e}function kY(t,e,r,n,a,s,o,l,c){return t=CD(r,n,!0,t,a,s,o,l,c),t.context=BY(null),r=t.current,n=Qc(),a=lm(r),s=aA(n,a),s.callback=e??null,im(r,s,a),t.current.lanes=a,gw(t,a,n),hd(t,n),t}function xI(t,e,r,n){var a=e.current,s=Qc(),o=lm(a);return r=BY(r),e.context===null?e.context=r:e.pendingContext=r,e=aA(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=im(a,e,o),t!==null&&(bf(t,a,o,s),X_(t,a,o)),o}function aS(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function $U(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function _D(t,e){$U(t,e),(t=t.alternate)&&$U(t,e)}function BAe(){return null}var FY=typeof reportError=="function"?reportError:function(t){console.error(t)};function ED(t){this._internalRoot=t}vI.prototype.render=ED.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Qr(409));xI(t,e,null,null)};vI.prototype.unmount=ED.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;sg(function(){xI(null,t,null,null)}),e[pA]=null}};function vI(t){this._internalRoot=t}vI.prototype.unstable_scheduleHydration=function(t){if(t){var e=uX();t={blockedOn:null,target:t,priority:e};for(var r=0;r<O0.length&&e!==0&&e<O0[r].priority;r++);O0.splice(r,0,t),r===0&&hX(t)}};function SD(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function yI(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function GU(){}function kAe(t,e,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var d=aS(o);s.call(d)}}var o=kY(e,n,t,0,null,!1,!1,"",GU);return t._reactRootContainer=o,t[pA]=o.current,a2(t.nodeType===8?t.parentNode:t),sg(),o}for(;a=t.lastChild;)t.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var d=aS(c);l.call(d)}}var c=CD(t,0,!1,null,null,!1,!1,"",GU);return t._reactRootContainer=c,t[pA]=c.current,a2(t.nodeType===8?t.parentNode:t),sg(function(){xI(e,c,r,n)}),c}function bI(t,e,r,n,a){var s=r._reactRootContainer;if(s){var o=s;if(typeof a=="function"){var l=a;a=function(){var c=aS(o);l.call(c)}}xI(e,o,t,a)}else o=kAe(r,e,t,a,n);return aS(o)}cX=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Qy(e.pendingLanes);r!==0&&(KO(e,r|1),hd(e,ao()),!(La&6)&&(Tv=ao()+500,Um()))}break;case 13:sg(function(){var n=gA(t,1);if(n!==null){var a=Qc();bf(n,t,1,a)}}),_D(t,1)}};qO=function(t){if(t.tag===13){var e=gA(t,134217728);if(e!==null){var r=Qc();bf(e,t,134217728,r)}_D(t,134217728)}};dX=function(t){if(t.tag===13){var e=lm(t),r=gA(t,e);if(r!==null){var n=Qc();bf(r,t,e,n)}_D(t,e)}};uX=function(){return xs};fX=function(t,e){var r=xs;try{return xs=t,e()}finally{xs=r}};oB=function(t,e,r){switch(e){case"input":if(eB(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var a=uI(n);if(!a)throw Error(Qr(90));HW(n),eB(n,a)}}}break;case"textarea":GW(t,r);break;case"select":e=r.value,e!=null&&ov(t,!!r.multiple,e,!1)}};JW=yD;ZW=sg;var FAe={usingClientEntryPoint:!1,Events:[vw,$x,uI,XW,YW,yD]},ly={findFiberByHostInstance:Ep,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},OAe={bundleType:ly.bundleType,version:ly.version,rendererPackageName:ly.rendererPackageName,rendererConfig:ly.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:FA.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=rX(t),t===null?null:t.stateNode},findFiberByHostInstance:ly.findFiberByHostInstance||BAe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var rC=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rC.isDisabled&&rC.supportsFiber)try{oI=rC.inject(OAe),ih=rC}catch{}}Yd.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FAe;Yd.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!SD(e))throw Error(Qr(200));return TAe(t,e,null,r)};Yd.createRoot=function(t,e){if(!SD(t))throw Error(Qr(299));var r=!1,n="",a=FY;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=CD(t,1,!1,null,null,r,!1,n,a),t[pA]=e.current,a2(t.nodeType===8?t.parentNode:t),new ED(e)};Yd.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Qr(188)):(t=Object.keys(t).join(","),Error(Qr(268,t)));return t=rX(e),t=t===null?null:t.stateNode,t};Yd.flushSync=function(t){return sg(t)};Yd.hydrate=function(t,e,r){if(!yI(e))throw Error(Qr(200));return bI(null,t,e,!0,r)};Yd.hydrateRoot=function(t,e,r){if(!SD(t))throw Error(Qr(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",o=FY;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=kY(e,null,t,1,r??null,a,!1,s,o),t[pA]=e.current,a2(t),n)for(t=0;t<n.length;t++)r=n[t],a=r._getVersion,a=a(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,a]:e.mutableSourceEagerHydrationData.push(r,a);return new vI(e)};Yd.render=function(t,e,r){if(!yI(e))throw Error(Qr(200));return bI(null,t,e,!1,r)};Yd.unmountComponentAtNode=function(t){if(!yI(t))throw Error(Qr(40));return t._reactRootContainer?(sg(function(){bI(null,null,t,!1,function(){t._reactRootContainer=null,t[pA]=null})}),!0):!1};Yd.unstable_batchedUpdates=yD;Yd.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!yI(r))throw Error(Qr(200));if(t==null||t._reactInternals===void 0)throw Error(Qr(38));return bI(t,e,r,!1,n)};Yd.version="18.3.1-next-f1338f8080-20240426";function OY(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(OY)}catch(t){console.error(t)}}OY(),OW.exports=Yd;var $d=OW.exports,KU=$d;qT.createRoot=KU.createRoot,qT.hydrateRoot=KU.hydrateRoot;/**
 * react-router v7.8.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var qU="popstate";function DAe(t={}){function e(n,a){let{pathname:s,search:o,hash:l}=n.location;return UB("",{pathname:s,search:o,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:h2(a)}return MAe(e,r,null,t)}function Ai(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Sf(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function RAe(){return Math.random().toString(36).substring(2,10)}function zU(t,e){return{usr:t.state,key:t.key,idx:e}}function UB(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?l1(e):e,state:r,key:e&&e.key||n||RAe()}}function h2({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function l1(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function MAe(t,e,r,n={}){let{window:a=document.defaultView,v5Compat:s=!1}=n,o=a.history,l="POP",c=null,d=u();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function u(){return(o.state||{idx:null}).idx}function f(){l="POP";let x=u(),v=x==null?null:x-d;d=x,c&&c({action:l,location:p.location,delta:v})}function A(x,v){l="PUSH";let y=UB(p.location,x,v);d=u()+1;let b=zU(y,d),w=p.createHref(y);try{o.pushState(b,"",w)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;a.location.assign(w)}s&&c&&c({action:l,location:p.location,delta:1})}function h(x,v){l="REPLACE";let y=UB(p.location,x,v);d=u();let b=zU(y,d),w=p.createHref(y);o.replaceState(b,"",w),s&&c&&c({action:l,location:p.location,delta:0})}function m(x){return LAe(x)}let p={get action(){return l},get location(){return t(a,o)},listen(x){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(qU,f),c=x,()=>{a.removeEventListener(qU,f),c=null}},createHref(x){return e(a,x)},createURL:m,encodeLocation(x){let v=m(x);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:A,replace:h,go(x){return o.go(x)}};return p}function LAe(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Ai(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:h2(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function DY(t,e,r="/"){return UAe(t,e,r,!1)}function UAe(t,e,r,n){let a=typeof e=="string"?l1(e):e,s=vA(a.pathname||"/",r);if(s==null)return null;let o=RY(t);QAe(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=JAe(s);l=XAe(o[c],d,n)}return l}function RY(t,e=[],r=[],n="",a=!1){let s=(o,l,c=a,d)=>{let u={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(u.relativePath.startsWith("/")){if(!u.relativePath.startsWith(n)&&c)return;Ai(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length)}let f=sA([n,u.relativePath]),A=r.concat(u);o.children&&o.children.length>0&&(Ai(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),RY(o.children,e,A,f,c)),!(o.path==null&&!o.index)&&e.push({path:f,score:zAe(f,o.index),routesMeta:A})};return t.forEach((o,l)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))s(o,l);else for(let d of MY(o.path))s(o,l,!0,d)}),e}function MY(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let o=MY(n.join("/")),l=[];return l.push(...o.map(c=>c===""?s:[s,c].join("/"))),a&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function QAe(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:WAe(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var VAe=/^:[\w-]+$/,HAe=3,$Ae=2,GAe=1,KAe=10,qAe=-2,WU=t=>t==="*";function zAe(t,e){let r=t.split("/"),n=r.length;return r.some(WU)&&(n+=qAe),e&&(n+=$Ae),r.filter(a=>!WU(a)).reduce((a,s)=>a+(VAe.test(s)?HAe:s===""?GAe:KAe),n)}function WAe(t,e){return t.length===e.length&&t.slice(0,-1).every((n,a)=>n===e[a])?t[t.length-1]-e[e.length-1]:0}function XAe(t,e,r=!1){let{routesMeta:n}=t,a={},s="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],d=l===n.length-1,u=s==="/"?e:e.slice(s.length)||"/",f=sS({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),A=c.route;if(!f&&d&&r&&!n[n.length-1].route.index&&(f=sS({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!f)return null;Object.assign(a,f.params),o.push({params:a,pathname:sA([s,f.pathname]),pathnameBase:r0e(sA([s,f.pathnameBase])),route:A}),f.pathnameBase!=="/"&&(s=sA([s,f.pathnameBase]))}return o}function sS(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=YAe(t.path,t.caseSensitive,t.end),a=e.match(r);if(!a)return null;let s=a[0],o=s.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((d,{paramName:u,isOptional:f},A)=>{if(u==="*"){let m=l[A]||"";o=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const h=l[A];return f&&!h?d[u]=void 0:d[u]=(h||"").replace(/%2F/g,"/"),d},{}),pathname:s,pathnameBase:o,pattern:t}}function YAe(t,e=!1,r=!0){Sf(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function JAe(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Sf(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function vA(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function ZAe(t,e="/"){let{pathname:r,search:n="",hash:a=""}=typeof t=="string"?l1(t):t;return{pathname:r?r.startsWith("/")?r:e0e(r,e):e,search:n0e(n),hash:a0e(a)}}function e0e(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function C4(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function t0e(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function jD(t){let e=t0e(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function ID(t,e,r,n=!1){let a;typeof t=="string"?a=l1(t):(a={...t},Ai(!a.pathname||!a.pathname.includes("?"),C4("?","pathname","search",a)),Ai(!a.pathname||!a.pathname.includes("#"),C4("#","pathname","hash",a)),Ai(!a.search||!a.search.includes("#"),C4("#","search","hash",a)));let s=t===""||a.pathname==="",o=s?"/":a.pathname,l;if(o==null)l=r;else{let f=e.length-1;if(!n&&o.startsWith("..")){let A=o.split("/");for(;A[0]==="..";)A.shift(),f-=1;a.pathname=A.join("/")}l=f>=0?e[f]:"/"}let c=ZAe(a,l),d=o&&o!=="/"&&o.endsWith("/"),u=(s||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}var sA=t=>t.join("/").replace(/\/\/+/g,"/"),r0e=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),n0e=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,a0e=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function s0e(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var LY=["POST","PUT","PATCH","DELETE"];new Set(LY);var i0e=["GET",...LY];new Set(i0e);var c1=g.createContext(null);c1.displayName="DataRouter";var wI=g.createContext(null);wI.displayName="DataRouterState";g.createContext(!1);var UY=g.createContext({isTransitioning:!1});UY.displayName="ViewTransition";var o0e=g.createContext(new Map);o0e.displayName="Fetchers";var l0e=g.createContext(null);l0e.displayName="Await";var Tf=g.createContext(null);Tf.displayName="Navigation";var bw=g.createContext(null);bw.displayName="Location";var Bf=g.createContext({outlet:null,matches:[],isDataRoute:!1});Bf.displayName="Route";var PD=g.createContext(null);PD.displayName="RouteError";function c0e(t,{relative:e}={}){Ai(d1(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=g.useContext(Tf),{hash:a,pathname:s,search:o}=Nw(t,{relative:e}),l=s;return r!=="/"&&(l=s==="/"?r:sA([r,s])),n.createHref({pathname:l,search:o,hash:a})}function d1(){return g.useContext(bw)!=null}function OA(){return Ai(d1(),"useLocation() may be used only in the context of a <Router> component."),g.useContext(bw).location}var QY="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function VY(t){g.useContext(Tf).static||g.useLayoutEffect(t)}function ww(){let{isDataRoute:t}=g.useContext(Bf);return t?C0e():d0e()}function d0e(){Ai(d1(),"useNavigate() may be used only in the context of a <Router> component.");let t=g.useContext(c1),{basename:e,navigator:r}=g.useContext(Tf),{matches:n}=g.useContext(Bf),{pathname:a}=OA(),s=JSON.stringify(jD(n)),o=g.useRef(!1);return VY(()=>{o.current=!0}),g.useCallback((c,d={})=>{if(Sf(o.current,QY),!o.current)return;if(typeof c=="number"){r.go(c);return}let u=ID(c,JSON.parse(s),a,d.relative==="path");t==null&&e!=="/"&&(u.pathname=u.pathname==="/"?e:sA([e,u.pathname])),(d.replace?r.replace:r.push)(u,d.state,d)},[e,r,s,a,t])}var u0e=g.createContext(null);function f0e(t){let e=g.useContext(Bf).outlet;return e&&g.createElement(u0e.Provider,{value:t},e)}function Nw(t,{relative:e}={}){let{matches:r}=g.useContext(Bf),{pathname:n}=OA(),a=JSON.stringify(jD(r));return g.useMemo(()=>ID(t,JSON.parse(a),n,e==="path"),[t,a,n,e])}function h0e(t,e){return HY(t,e)}function HY(t,e,r,n){var v;Ai(d1(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=g.useContext(Tf),{matches:s}=g.useContext(Bf),o=s[s.length-1],l=o?o.params:{},c=o?o.pathname:"/",d=o?o.pathnameBase:"/",u=o&&o.route;{let y=u&&u.path||"";$Y(c,!u||y.endsWith("*")||y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${y}"> to <Route path="${y==="/"?"*":`${y}/*`}">.`)}let f=OA(),A;if(e){let y=typeof e=="string"?l1(e):e;Ai(d==="/"||((v=y.pathname)==null?void 0:v.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${y.pathname}" was given in the \`location\` prop.`),A=y}else A=f;let h=A.pathname||"/",m=h;if(d!=="/"){let y=d.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let p=DY(t,{pathname:m});Sf(u||p!=null,`No routes matched location "${A.pathname}${A.search}${A.hash}" `),Sf(p==null||p[p.length-1].route.element!==void 0||p[p.length-1].route.Component!==void 0||p[p.length-1].route.lazy!==void 0,`Matched leaf route at location "${A.pathname}${A.search}${A.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=x0e(p&&p.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:sA([d,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?d:sA([d,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,r,n);return e&&x?g.createElement(bw.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...A},navigationType:"POP"}},x):x}function A0e(){let t=N0e(),e=s0e(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=g.createElement(g.Fragment,null,g.createElement("p",null," Hey developer "),g.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",g.createElement("code",{style:s},"ErrorBoundary")," or"," ",g.createElement("code",{style:s},"errorElement")," prop on your route.")),g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},e),r?g.createElement("pre",{style:a},r):null,o)}var m0e=g.createElement(A0e,null),p0e=class extends g.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?g.createElement(Bf.Provider,{value:this.props.routeContext},g.createElement(PD.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function g0e({routeContext:t,match:e,children:r}){let n=g.useContext(c1);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),g.createElement(Bf.Provider,{value:t},r)}function x0e(t,e=[],r=null,n=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,s=r==null?void 0:r.errors;if(s!=null){let c=a.findIndex(d=>d.route.id&&(s==null?void 0:s[d.route.id])!==void 0);Ai(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let o=!1,l=-1;if(r)for(let c=0;c<a.length;c++){let d=a[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=c),d.route.id){let{loaderData:u,errors:f}=r,A=d.route.loader&&!u.hasOwnProperty(d.route.id)&&(!f||f[d.route.id]===void 0);if(d.route.lazy||A){o=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((c,d,u)=>{let f,A=!1,h=null,m=null;r&&(f=s&&d.route.id?s[d.route.id]:void 0,h=d.route.errorElement||m0e,o&&(l<0&&u===0?($Y("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),A=!0,m=null):l===u&&(A=!0,m=d.route.hydrateFallbackElement||null)));let p=e.concat(a.slice(0,u+1)),x=()=>{let v;return f?v=h:A?v=m:d.route.Component?v=g.createElement(d.route.Component,null):d.route.element?v=d.route.element:v=c,g.createElement(g0e,{match:d,routeContext:{outlet:c,matches:p,isDataRoute:r!=null},children:v})};return r&&(d.route.ErrorBoundary||d.route.errorElement||u===0)?g.createElement(p0e,{location:r.location,revalidation:r.revalidation,component:h,error:f,children:x(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):x()},null)}function TD(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function v0e(t){let e=g.useContext(c1);return Ai(e,TD(t)),e}function y0e(t){let e=g.useContext(wI);return Ai(e,TD(t)),e}function b0e(t){let e=g.useContext(Bf);return Ai(e,TD(t)),e}function BD(t){let e=b0e(t),r=e.matches[e.matches.length-1];return Ai(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function w0e(){return BD("useRouteId")}function N0e(){var n;let t=g.useContext(PD),e=y0e("useRouteError"),r=BD("useRouteError");return t!==void 0?t:(n=e.errors)==null?void 0:n[r]}function C0e(){let{router:t}=v0e("useNavigate"),e=BD("useNavigate"),r=g.useRef(!1);return VY(()=>{r.current=!0}),g.useCallback(async(a,s={})=>{Sf(r.current,QY),r.current&&(typeof a=="number"?t.navigate(a):await t.navigate(a,{fromRouteId:e,...s}))},[t,e])}var XU={};function $Y(t,e,r){!e&&!XU[t]&&(XU[t]=!0,Sf(!1,r))}g.memo(_0e);function _0e({routes:t,future:e,state:r}){return HY(t,void 0,r,e)}function Uh({to:t,replace:e,state:r,relative:n}){Ai(d1(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=g.useContext(Tf);Sf(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=g.useContext(Bf),{pathname:o}=OA(),l=ww(),c=ID(t,jD(s),o,n==="path"),d=JSON.stringify(c);return g.useEffect(()=>{l(JSON.parse(d),{replace:e,state:r,relative:n})},[l,d,n,e,r]),null}function GY(t){return f0e(t.context)}function qn(t){Ai(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function E0e({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:a,static:s=!1}){Ai(!d1(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),l=g.useMemo(()=>({basename:o,navigator:a,static:s,future:{}}),[o,a,s]);typeof r=="string"&&(r=l1(r));let{pathname:c="/",search:d="",hash:u="",state:f=null,key:A="default"}=r,h=g.useMemo(()=>{let m=vA(c,o);return m==null?null:{location:{pathname:m,search:d,hash:u,state:f,key:A},navigationType:n}},[o,c,d,u,f,A,n]);return Sf(h!=null,`<Router basename="${o}"> is not able to match the URL "${c}${d}${u}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:g.createElement(Tf.Provider,{value:l},g.createElement(bw.Provider,{children:e,value:h}))}function S0e({children:t,location:e}){return h0e(QB(t),e)}function QB(t,e=[]){let r=[];return g.Children.forEach(t,(n,a)=>{if(!g.isValidElement(n))return;let s=[...e,a];if(n.type===g.Fragment){r.push.apply(r,QB(n.props.children,s));return}Ai(n.type===qn,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ai(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=QB(n.props.children,s)),r.push(o)}),r}var nE="get",aE="application/x-www-form-urlencoded";function NI(t){return t!=null&&typeof t.tagName=="string"}function j0e(t){return NI(t)&&t.tagName.toLowerCase()==="button"}function I0e(t){return NI(t)&&t.tagName.toLowerCase()==="form"}function P0e(t){return NI(t)&&t.tagName.toLowerCase()==="input"}function T0e(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function B0e(t,e){return t.button===0&&(!e||e==="_self")&&!T0e(t)}var nC=null;function k0e(){if(nC===null)try{new FormData(document.createElement("form"),0),nC=!1}catch{nC=!0}return nC}var F0e=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function _4(t){return t!=null&&!F0e.has(t)?(Sf(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${aE}"`),null):t}function O0e(t,e){let r,n,a,s,o;if(I0e(t)){let l=t.getAttribute("action");n=l?vA(l,e):null,r=t.getAttribute("method")||nE,a=_4(t.getAttribute("enctype"))||aE,s=new FormData(t)}else if(j0e(t)||P0e(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||l.getAttribute("action");if(n=c?vA(c,e):null,r=t.getAttribute("formmethod")||l.getAttribute("method")||nE,a=_4(t.getAttribute("formenctype"))||_4(l.getAttribute("enctype"))||aE,s=new FormData(l,t),!k0e()){let{name:d,type:u,value:f}=t;if(u==="image"){let A=d?`${d}.`:"";s.append(`${A}x`,"0"),s.append(`${A}y`,"0")}else d&&s.append(d,f)}}else{if(NI(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=nE,n=null,a=aE,o=t}return s&&a==="text/plain"&&(o=s,s=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:s,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function kD(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function D0e(t,e,r){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${r}`:e&&vA(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function R0e(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function M0e(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function L0e(t,e,r){let n=await Promise.all(t.map(async a=>{let s=e.routes[a.route.id];if(s){let o=await R0e(s,r);return o.links?o.links():[]}return[]}));return H0e(n.flat(1).filter(M0e).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function YU(t,e,r,n,a,s){let o=(c,d)=>r[d]?c.route.id!==r[d].route.id:!0,l=(c,d)=>{var u;return r[d].pathname!==c.pathname||((u=r[d].route.path)==null?void 0:u.endsWith("*"))&&r[d].params["*"]!==c.params["*"]};return s==="assets"?e.filter((c,d)=>o(c,d)||l(c,d)):s==="data"?e.filter((c,d)=>{var f;let u=n.routes[c.route.id];if(!u||!u.hasLoader)return!1;if(o(c,d)||l(c,d))return!0;if(c.route.shouldRevalidate){let A=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((f=r[0])==null?void 0:f.params)||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof A=="boolean")return A}return!0}):[]}function U0e(t,e,{includeHydrateFallback:r}={}){return Q0e(t.map(n=>{let a=e.routes[n.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1))}function Q0e(t){return[...new Set(t)]}function V0e(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function H0e(t,e){let r=new Set;return new Set(e),t.reduce((n,a)=>{let s=JSON.stringify(V0e(a));return r.has(s)||(r.add(s),n.push({key:s,link:a})),n},[])}function KY(){let t=g.useContext(c1);return kD(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function $0e(){let t=g.useContext(wI);return kD(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var FD=g.createContext(void 0);FD.displayName="FrameworkContext";function qY(){let t=g.useContext(FD);return kD(t,"You must render this element inside a <HydratedRouter> element"),t}function G0e(t,e){let r=g.useContext(FD),[n,a]=g.useState(!1),[s,o]=g.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:d,onMouseLeave:u,onTouchStart:f}=e,A=g.useRef(null);g.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let p=v=>{v.forEach(y=>{o(y.isIntersecting)})},x=new IntersectionObserver(p,{threshold:.5});return A.current&&x.observe(A.current),()=>{x.disconnect()}}},[t]),g.useEffect(()=>{if(n){let p=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(p)}}},[n]);let h=()=>{a(!0)},m=()=>{a(!1),o(!1)};return r?t!=="intent"?[s,A,{}]:[s,A,{onFocus:cy(l,h),onBlur:cy(c,m),onMouseEnter:cy(d,h),onMouseLeave:cy(u,m),onTouchStart:cy(f,h)}]:[!1,A,{}]}function cy(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function K0e({page:t,...e}){let{router:r}=KY(),n=g.useMemo(()=>DY(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?g.createElement(z0e,{page:t,matches:n,...e}):null}function q0e(t){let{manifest:e,routeModules:r}=qY(),[n,a]=g.useState([]);return g.useEffect(()=>{let s=!1;return L0e(t,e,r).then(o=>{s||a(o)}),()=>{s=!0}},[t,e,r]),n}function z0e({page:t,matches:e,...r}){let n=OA(),{manifest:a,routeModules:s}=qY(),{basename:o}=KY(),{loaderData:l,matches:c}=$0e(),d=g.useMemo(()=>YU(t,e,c,a,n,"data"),[t,e,c,a,n]),u=g.useMemo(()=>YU(t,e,c,a,n,"assets"),[t,e,c,a,n]),f=g.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let m=new Set,p=!1;if(e.forEach(v=>{var b;let y=a.routes[v.route.id];!y||!y.hasLoader||(!d.some(w=>w.route.id===v.route.id)&&v.route.id in l&&((b=s[v.route.id])!=null&&b.shouldRevalidate)||y.hasClientLoader?p=!0:m.add(v.route.id))}),m.size===0)return[];let x=D0e(t,o,"data");return p&&m.size>0&&x.searchParams.set("_routes",e.filter(v=>m.has(v.route.id)).map(v=>v.route.id).join(",")),[x.pathname+x.search]},[o,l,n,a,d,e,t,s]),A=g.useMemo(()=>U0e(u,a),[u,a]),h=q0e(u);return g.createElement(g.Fragment,null,f.map(m=>g.createElement("link",{key:m,rel:"prefetch",as:"fetch",href:m,...r})),A.map(m=>g.createElement("link",{key:m,rel:"modulepreload",href:m,...r})),h.map(({key:m,link:p})=>g.createElement("link",{key:m,nonce:r.nonce,...p})))}function W0e(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var zY=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{zY&&(window.__reactRouterVersion="7.8.1")}catch{}function X0e({basename:t,children:e,window:r}){let n=g.useRef();n.current==null&&(n.current=DAe({window:r,v5Compat:!0}));let a=n.current,[s,o]=g.useState({action:a.action,location:a.location}),l=g.useCallback(c=>{g.startTransition(()=>o(c))},[o]);return g.useLayoutEffect(()=>a.listen(l),[a,l]),g.createElement(E0e,{basename:t,children:e,location:s.location,navigationType:s.action,navigator:a})}var WY=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,XY=g.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:a,reloadDocument:s,replace:o,state:l,target:c,to:d,preventScrollReset:u,viewTransition:f,...A},h){let{basename:m}=g.useContext(Tf),p=typeof d=="string"&&WY.test(d),x,v=!1;if(typeof d=="string"&&p&&(x=d,zY))try{let E=new URL(window.location.href),B=d.startsWith("//")?new URL(E.protocol+d):new URL(d),k=vA(B.pathname,m);B.origin===E.origin&&k!=null?d=k+B.search+B.hash:v=!0}catch{Sf(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let y=c0e(d,{relative:a}),[b,w,I]=G0e(n,A),j=Z0e(d,{replace:o,state:l,target:c,preventScrollReset:u,relative:a,viewTransition:f});function N(E){e&&e(E),E.defaultPrevented||j(E)}let S=g.createElement("a",{...A,...I,href:x||y,onClick:v||s?e:N,ref:W0e(h,w),target:c,"data-discover":!p&&r==="render"?"true":void 0});return b&&!p?g.createElement(g.Fragment,null,S,g.createElement(K0e,{page:y})):S});XY.displayName="Link";var Sn=g.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:a=!1,style:s,to:o,viewTransition:l,children:c,...d},u){let f=Nw(o,{relative:d.relative}),A=OA(),h=g.useContext(wI),{navigator:m,basename:p}=g.useContext(Tf),x=h!=null&&ame(f)&&l===!0,v=m.encodeLocation?m.encodeLocation(f).pathname:f.pathname,y=A.pathname,b=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;r||(y=y.toLowerCase(),b=b?b.toLowerCase():null,v=v.toLowerCase()),b&&p&&(b=vA(b,p)||b);const w=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let I=y===v||!a&&y.startsWith(v)&&y.charAt(w)==="/",j=b!=null&&(b===v||!a&&b.startsWith(v)&&b.charAt(v.length)==="/"),N={isActive:I,isPending:j,isTransitioning:x},S=I?e:void 0,E;typeof n=="function"?E=n(N):E=[n,I?"active":null,j?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let B=typeof s=="function"?s(N):s;return g.createElement(XY,{...d,"aria-current":S,className:E,ref:u,style:B,to:o,viewTransition:l},typeof c=="function"?c(N):c)});Sn.displayName="NavLink";var Y0e=g.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:a,state:s,method:o=nE,action:l,onSubmit:c,relative:d,preventScrollReset:u,viewTransition:f,...A},h)=>{let m=rme(),p=nme(l,{relative:d}),x=o.toLowerCase()==="get"?"get":"post",v=typeof l=="string"&&WY.test(l),y=b=>{if(c&&c(b),b.defaultPrevented)return;b.preventDefault();let w=b.nativeEvent.submitter,I=(w==null?void 0:w.getAttribute("formmethod"))||o;m(w||b.currentTarget,{fetcherKey:e,method:I,navigate:r,replace:a,state:s,relative:d,preventScrollReset:u,viewTransition:f})};return g.createElement("form",{ref:h,method:x,action:p,onSubmit:n?c:y,...A,"data-discover":!v&&t==="render"?"true":void 0})});Y0e.displayName="Form";function J0e(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function YY(t){let e=g.useContext(c1);return Ai(e,J0e(t)),e}function Z0e(t,{target:e,replace:r,state:n,preventScrollReset:a,relative:s,viewTransition:o}={}){let l=ww(),c=OA(),d=Nw(t,{relative:s});return g.useCallback(u=>{if(B0e(u,e)){u.preventDefault();let f=r!==void 0?r:h2(c)===h2(d);l(t,{replace:f,state:n,preventScrollReset:a,relative:s,viewTransition:o})}},[c,l,d,r,n,e,t,a,s,o])}var eme=0,tme=()=>`__${String(++eme)}__`;function rme(){let{router:t}=YY("useSubmit"),{basename:e}=g.useContext(Tf),r=w0e();return g.useCallback(async(n,a={})=>{let{action:s,method:o,encType:l,formData:c,body:d}=O0e(n,e);if(a.navigate===!1){let u=a.fetcherKey||tme();await t.fetch(u,r,a.action||s,{preventScrollReset:a.preventScrollReset,formData:c,body:d,formMethod:a.method||o,formEncType:a.encType||l,flushSync:a.flushSync})}else await t.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:c,body:d,formMethod:a.method||o,formEncType:a.encType||l,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,e,r])}function nme(t,{relative:e}={}){let{basename:r}=g.useContext(Tf),n=g.useContext(Bf);Ai(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),s={...Nw(t||".",{relative:e})},o=OA();if(t==null){s.search=o.search;let l=new URLSearchParams(s.search),c=l.getAll("index");if(c.some(u=>u==="")){l.delete("index"),c.filter(f=>f).forEach(f=>l.append("index",f));let u=l.toString();s.search=u?`?${u}`:""}}return(!t||t===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(s.pathname=s.pathname==="/"?r:sA([r,s.pathname])),h2(s)}function ame(t,{relative:e}={}){let r=g.useContext(UY);Ai(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=YY("useViewTransitionState"),a=Nw(t,{relative:e});if(!r.isTransitioning)return!1;let s=vA(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=vA(r.nextLocation.pathname,n)||r.nextLocation.pathname;return sS(a.pathname,o)!=null||sS(a.pathname,s)!=null}function Rn(t,e){if(!t)return!1;const r=String(e);if(Array.isArray(t))return t.map(String).includes(r);const n=String(t);return n===r||n==="vendedor"&&r==="vendedor_pollo"}var JU={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JY=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},sme=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const s=t[r++];e[n++]=String.fromCharCode((a&31)<<6|s&63)}else if(a>239&&a<365){const s=t[r++],o=t[r++],l=t[r++],c=((a&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const s=t[r++],o=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(s&63)<<6|o&63)}}return e.join("")},ZY={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<t.length;a+=3){const s=t[a],o=a+1<t.length,l=o?t[a+1]:0,c=a+2<t.length,d=c?t[a+2]:0,u=s>>2,f=(s&3)<<4|l>>4;let A=(l&15)<<2|d>>6,h=d&63;c||(h=64,o||(A=64)),n.push(r[u],r[f],r[A],r[h])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(JY(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):sme(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<t.length;){const s=r[t.charAt(a++)],l=a<t.length?r[t.charAt(a)]:0;++a;const d=a<t.length?r[t.charAt(a)]:64;++a;const f=a<t.length?r[t.charAt(a)]:64;if(++a,s==null||l==null||d==null||f==null)throw new ime;const A=s<<2|l>>4;if(n.push(A),d!==64){const h=l<<4&240|d>>2;if(n.push(h),f!==64){const m=d<<6&192|f;n.push(m)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class ime extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ome=function(t){const e=JY(t);return ZY.encodeByteArray(e,!0)},iS=function(t){return ome(t).replace(/\./g,"")},eJ=function(t){try{return ZY.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lme(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cme=()=>lme().__FIREBASE_DEFAULTS__,dme=()=>{if(typeof process>"u"||typeof JU>"u")return;const t=JU.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},ume=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&eJ(t[1]);return e&&JSON.parse(e)},CI=()=>{try{return cme()||dme()||ume()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},tJ=t=>{var e,r;return(r=(e=CI())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},fme=t=>{const e=tJ(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},rJ=()=>{var t;return(t=CI())===null||t===void 0?void 0:t.config},nJ=t=>{var e;return(e=CI())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hme{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ame(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",a=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[iS(JSON.stringify(r)),iS(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ko(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function mme(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ko())}function pme(){var t;const e=(t=CI())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function gme(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function xme(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function vme(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function yme(){const t=Ko();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function aJ(){return!pme()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function sJ(){try{return typeof indexedDB=="object"}catch{return!1}}function bme(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{var s;e(((s=a.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wme="FirebaseError";class DA extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=wme,Object.setPrototypeOf(this,DA.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Cw.prototype.create)}}class Cw{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},a=`${this.service}/${e}`,s=this.errors[e],o=s?Nme(s,n):"Error",l=`${this.serviceName}: ${o} (${a}).`;return new DA(a,l,n)}}function Nme(t,e){return t.replace(Cme,(r,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const Cme=/\{\$([^}]+)}/g;function _me(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function A2(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const a of r){if(!n.includes(a))return!1;const s=t[a],o=e[a];if(ZU(s)&&ZU(o)){if(!A2(s,o))return!1}else if(s!==o)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function ZU(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _w(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Hy(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[a,s]=n.split("=");e[decodeURIComponent(a)]=decodeURIComponent(s)}}),e}function $y(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function Eme(t,e){const r=new Sme(t,e);return r.subscribe.bind(r)}class Sme{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let a;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");jme(e,["next","error","complete"])?a=e:a={next:e,error:r,complete:n},a.next===void 0&&(a.next=E4),a.error===void 0&&(a.error=E4),a.complete===void 0&&(a.complete=E4);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function jme(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function E4(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ii(t){return t&&t._delegate?t._delegate:t}class ig{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fp="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ime=class{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new hme;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(a)return null;throw s}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Tme(e))try{this.getOrInitializeService({instanceIdentifier:fp})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:a});n.resolve(s)}catch{}}}}clearInstance(e=fp){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=fp){return this.instances.has(e)}getOptions(e=fp){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);n===l&&o.resolve(a)}return a}onInit(e,r){var n;const a=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(a))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(a,s);const o=this.instances.get(a);return o&&e(o,a),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const a of n)try{a(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Pme(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=fp){return this.component?this.component.multipleInstances?e:fp:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Pme(t){return t===fp?void 0:t}function Tme(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bme{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new Ime(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ja;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ja||(ja={}));const kme={debug:ja.DEBUG,verbose:ja.VERBOSE,info:ja.INFO,warn:ja.WARN,error:ja.ERROR,silent:ja.SILENT},Fme=ja.INFO,Ome={[ja.DEBUG]:"log",[ja.VERBOSE]:"log",[ja.INFO]:"info",[ja.WARN]:"warn",[ja.ERROR]:"error"},Dme=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),a=Ome[e];if(a)console[a](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let OD=class{constructor(e){this.name=e,this._logLevel=Fme,this._logHandler=Dme,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ja))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?kme[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ja.DEBUG,...e),this._logHandler(this,ja.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ja.VERBOSE,...e),this._logHandler(this,ja.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ja.INFO,...e),this._logHandler(this,ja.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ja.WARN,...e),this._logHandler(this,ja.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ja.ERROR,...e),this._logHandler(this,ja.ERROR,...e)}};const Rme=(t,e)=>e.some(r=>t instanceof r);let e7,t7;function Mme(){return e7||(e7=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Lme(){return t7||(t7=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const iJ=new WeakMap,VB=new WeakMap,oJ=new WeakMap,S4=new WeakMap,DD=new WeakMap;function Ume(t){const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{r(dm(t.result)),a()},o=()=>{n(t.error),a()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&iJ.set(r,t)}).catch(()=>{}),DD.set(e,t),e}function Qme(t){if(VB.has(t))return;const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{r(),a()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});VB.set(t,e)}let HB={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return VB.get(t);if(e==="objectStoreNames")return t.objectStoreNames||oJ.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return dm(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Vme(t){HB=t(HB)}function Hme(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(j4(this),e,...r);return oJ.set(n,e.sort?e.sort():[e]),dm(n)}:Lme().includes(t)?function(...e){return t.apply(j4(this),e),dm(iJ.get(this))}:function(...e){return dm(t.apply(j4(this),e))}}function $me(t){return typeof t=="function"?Hme(t):(t instanceof IDBTransaction&&Qme(t),Rme(t,Mme())?new Proxy(t,HB):t)}function dm(t){if(t instanceof IDBRequest)return Ume(t);if(S4.has(t))return S4.get(t);const e=$me(t);return e!==t&&(S4.set(t,e),DD.set(e,t)),e}const j4=t=>DD.get(t);function Gme(t,e,{blocked:r,upgrade:n,blocking:a,terminated:s}={}){const o=indexedDB.open(t,e),l=dm(o);return n&&o.addEventListener("upgradeneeded",c=>{n(dm(o.result),c.oldVersion,c.newVersion,dm(o.transaction),c)}),r&&o.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{s&&c.addEventListener("close",()=>s()),a&&c.addEventListener("versionchange",d=>a(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const Kme=["get","getKey","getAll","getAllKeys","count"],qme=["put","add","delete","clear"],I4=new Map;function r7(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(I4.get(e))return I4.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,a=qme.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||Kme.includes(r)))return;const s=async function(o,...l){const c=this.transaction(o,a?"readwrite":"readonly");let d=c.store;return n&&(d=d.index(l.shift())),(await Promise.all([d[r](...l),a&&c.done]))[0]};return I4.set(e,s),s}Vme(t=>({...t,get:(e,r,n)=>r7(e,r)||t.get(e,r,n),has:(e,r)=>!!r7(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zme{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Wme(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function Wme(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const $B="@firebase/app",n7="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yA=new OD("@firebase/app"),Xme="@firebase/app-compat",Yme="@firebase/analytics-compat",Jme="@firebase/analytics",Zme="@firebase/app-check-compat",epe="@firebase/app-check",tpe="@firebase/auth",rpe="@firebase/auth-compat",npe="@firebase/database",ape="@firebase/data-connect",spe="@firebase/database-compat",ipe="@firebase/functions",ope="@firebase/functions-compat",lpe="@firebase/installations",cpe="@firebase/installations-compat",dpe="@firebase/messaging",upe="@firebase/messaging-compat",fpe="@firebase/performance",hpe="@firebase/performance-compat",Ape="@firebase/remote-config",mpe="@firebase/remote-config-compat",ppe="@firebase/storage",gpe="@firebase/storage-compat",xpe="@firebase/firestore",vpe="@firebase/vertexai-preview",ype="@firebase/firestore-compat",bpe="firebase",wpe="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GB="[DEFAULT]",Npe={[$B]:"fire-core",[Xme]:"fire-core-compat",[Jme]:"fire-analytics",[Yme]:"fire-analytics-compat",[epe]:"fire-app-check",[Zme]:"fire-app-check-compat",[tpe]:"fire-auth",[rpe]:"fire-auth-compat",[npe]:"fire-rtdb",[ape]:"fire-data-connect",[spe]:"fire-rtdb-compat",[ipe]:"fire-fn",[ope]:"fire-fn-compat",[lpe]:"fire-iid",[cpe]:"fire-iid-compat",[dpe]:"fire-fcm",[upe]:"fire-fcm-compat",[fpe]:"fire-perf",[hpe]:"fire-perf-compat",[Ape]:"fire-rc",[mpe]:"fire-rc-compat",[ppe]:"fire-gcs",[gpe]:"fire-gcs-compat",[xpe]:"fire-fst",[ype]:"fire-fst-compat",[vpe]:"fire-vertex","fire-js":"fire-js",[bpe]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bv=new Map,KB=new Map,qB=new Map;function a7(t,e){try{t.container.addComponent(e)}catch(r){yA.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function kv(t){const e=t.name;if(qB.has(e))return yA.debug(`There were multiple attempts to register component ${e}.`),!1;qB.set(e,t);for(const r of Bv.values())a7(r,t);for(const r of KB.values())a7(r,t);return!0}function RD(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Zf(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cpe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},um=new Cw("app","Firebase",Cpe);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _pe{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ig("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw um.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u1=wpe;function MD(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:GB,automaticDataCollectionEnabled:!1},e),a=n.name;if(typeof a!="string"||!a)throw um.create("bad-app-name",{appName:String(a)});if(r||(r=rJ()),!r)throw um.create("no-options");const s=Bv.get(a);if(s){if(A2(r,s.options)&&A2(n,s.config))return s;throw um.create("duplicate-app",{appName:a})}const o=new Bme(a);for(const c of qB.values())o.addComponent(c);const l=new _pe(r,n,o);return Bv.set(a,l),l}function LD(t=GB){const e=Bv.get(t);if(!e&&t===GB&&rJ())return MD();if(!e)throw um.create("no-app",{appName:t});return e}async function Epe(t){let e=!1;const r=t.name;Bv.has(r)?(e=!0,Bv.delete(r)):KB.has(r)&&t.decRefCount()<=0&&(KB.delete(r),e=!0),e&&(await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function fm(t,e,r){var n;let a=(n=Npe[t])!==null&&n!==void 0?n:t;r&&(a+=`-${r}`);const s=a.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${a}" with version "${e}":`];s&&l.push(`library name "${a}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),yA.warn(l.join(" "));return}kv(new ig(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Spe="firebase-heartbeat-database",jpe=1,m2="firebase-heartbeat-store";let P4=null;function lJ(){return P4||(P4=Gme(Spe,jpe,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(m2)}catch(r){console.warn(r)}}}}).catch(t=>{throw um.create("idb-open",{originalErrorMessage:t.message})})),P4}async function Ipe(t){try{const r=(await lJ()).transaction(m2),n=await r.objectStore(m2).get(cJ(t));return await r.done,n}catch(e){if(e instanceof DA)yA.warn(e.message);else{const r=um.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});yA.warn(r.message)}}}async function s7(t,e){try{const n=(await lJ()).transaction(m2,"readwrite");await n.objectStore(m2).put(e,cJ(t)),await n.done}catch(r){if(r instanceof DA)yA.warn(r.message);else{const n=um.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});yA.warn(n.message)}}}function cJ(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ppe=1024,Tpe=30*24*60*60*1e3;class Bpe{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Fpe(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=i7();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:a}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=Tpe}),this._storage.overwrite(this._heartbeatsCache))}catch(n){yA.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=i7(),{heartbeatsToSend:n,unsentEntries:a}=kpe(this._heartbeatsCache.heartbeats),s=iS(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return yA.warn(r),""}}}function i7(){return new Date().toISOString().substring(0,10)}function kpe(t,e=Ppe){const r=[];let n=t.slice();for(const a of t){const s=r.find(o=>o.agent===a.agent);if(s){if(s.dates.push(a.date),o7(r)>e){s.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),o7(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class Fpe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return sJ()?bme().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Ipe(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return s7(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return s7(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function o7(t){return iS(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ope(t){kv(new ig("platform-logger",e=>new zme(e),"PRIVATE")),kv(new ig("heartbeat",e=>new Bpe(e),"PRIVATE")),fm($B,n7,t),fm($B,n7,"esm2017"),fm("fire-js","")}Ope("");function UD(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r}function dJ(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Dpe=dJ,uJ=new Cw("auth","Firebase",dJ());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oS=new OD("@firebase/auth");function Rpe(t,...e){oS.logLevel<=ja.WARN&&oS.warn(`Auth (${u1}): ${t}`,...e)}function sE(t,...e){oS.logLevel<=ja.ERROR&&oS.error(`Auth (${u1}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jf(t,...e){throw QD(t,...e)}function lh(t,...e){return QD(t,...e)}function fJ(t,e,r){const n=Object.assign(Object.assign({},Dpe()),{[e]:r});return new Cw("auth","Firebase",n).create(e,{appName:t.name})}function iA(t){return fJ(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function QD(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return uJ.create(t,...e)}function Wn(t,e,...r){if(!t)throw QD(e,...r)}function Xh(t){const e="INTERNAL ASSERTION FAILED: "+t;throw sE(e),new Error(e)}function bA(t,e){t||Xh(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zB(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Mpe(){return l7()==="http:"||l7()==="https:"}function l7(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lpe(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Mpe()||xme()||"connection"in navigator)?navigator.onLine:!0}function Upe(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ew{constructor(e,r){this.shortDelay=e,this.longDelay=r,bA(r>e,"Short delay should be less than long delay!"),this.isMobile=mme()||vme()}get(){return Lpe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VD(t,e){bA(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hJ{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Xh("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Xh("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Xh("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qpe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vpe=new Ew(3e4,6e4);function RA(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function MA(t,e,r,n,a={}){return AJ(t,a,async()=>{let s={},o={};n&&(e==="GET"?o=n:s={body:JSON.stringify(n)});const l=_w(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:c},s);return gme()||(d.referrerPolicy="no-referrer"),hJ.fetch()(mJ(t,t.config.apiHost,r,l),d)})}async function AJ(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},Qpe),e);try{const a=new $pe(t),s=await Promise.race([r(),a.promise]);a.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw aC(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[c,d]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw aC(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw aC(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw aC(t,"user-disabled",o);const u=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw fJ(t,u,d);jf(t,u)}}catch(a){if(a instanceof DA)throw a;jf(t,"network-request-failed",{message:String(a)})}}async function Sw(t,e,r,n,a={}){const s=await MA(t,e,r,n,a);return"mfaPendingCredential"in s&&jf(t,"multi-factor-auth-required",{_serverResponse:s}),s}function mJ(t,e,r,n){const a=`${e}${r}?${n}`;return t.config.emulator?VD(t.config,a):`${t.config.apiScheme}://${a}`}function Hpe(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class $pe{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(lh(this.auth,"network-request-failed")),Vpe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function aC(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=lh(t,e,n);return a.customData._tokenResponse=r,a}function c7(t){return t!==void 0&&t.enterprise!==void 0}class Gpe{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return Hpe(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function Kpe(t,e){return MA(t,"GET","/v2/recaptchaConfig",RA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qpe(t,e){return MA(t,"POST","/v1/accounts:delete",e)}async function pJ(t,e){return MA(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yb(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function zpe(t,e=!1){const r=Ii(t),n=await r.getIdToken(e),a=HD(n);Wn(a&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error");const s=typeof a.firebase=="object"?a.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:a,token:n,authTime:yb(T4(a.auth_time)),issuedAtTime:yb(T4(a.iat)),expirationTime:yb(T4(a.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function T4(t){return Number(t)*1e3}function HD(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return sE("JWT malformed, contained fewer than 3 sections"),null;try{const a=eJ(r);return a?JSON.parse(a):(sE("Failed to decode base64 JWT payload"),null)}catch(a){return sE("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function d7(t){const e=HD(t);return Wn(e,"internal-error"),Wn(typeof e.exp<"u","internal-error"),Wn(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p2(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof DA&&Wpe(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Wpe({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xpe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const a=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WB{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=yb(this.lastLoginAt),this.creationTime=yb(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lS(t){var e;const r=t.auth,n=await t.getIdToken(),a=await p2(t,pJ(r,{idToken:n}));Wn(a==null?void 0:a.users.length,r,"internal-error");const s=a.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?gJ(s.providerUserInfo):[],l=Jpe(t.providerData,o),c=t.isAnonymous,d=!(t.email&&s.passwordHash)&&!(l!=null&&l.length),u=c?d:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new WB(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(t,f)}async function Ype(t){const e=Ii(t);await lS(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Jpe(t,e){return[...t.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function gJ(t){return t.map(e=>{var{providerId:r}=e,n=UD(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zpe(t,e){const r=await AJ(t,{},async()=>{const n=_w({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:s}=t.config,o=mJ(t,a,"/v1/token",`key=${s}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",hJ.fetch()(o,{method:"POST",headers:l,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function ege(t,e){return MA(t,"POST","/v2/accounts:revokeToken",RA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Wn(e.idToken,"internal-error"),Wn(typeof e.idToken<"u","internal-error"),Wn(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):d7(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Wn(e.length!==0,"internal-error");const r=d7(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Wn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:a,expiresIn:s}=await Zpe(e,r);this.updateTokensAndExpiration(n,a,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:a,expirationTime:s}=r,o=new hv;return n&&(Wn(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),a&&(Wn(typeof a=="string","internal-error",{appName:e}),o.accessToken=a),s&&(Wn(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new hv,this.toJSON())}_performRefresh(){return Xh("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d0(t,e){Wn(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Yh{constructor(e){var{uid:r,auth:n,stsTokenManager:a}=e,s=UD(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Xpe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new WB(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await p2(this,this.stsTokenManager.getToken(this.auth,e));return Wn(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return zpe(this,e)}reload(){return Ype(this)}_assign(e){this!==e&&(Wn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Yh(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){Wn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await lS(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Zf(this.auth.app))return Promise.reject(iA(this.auth));const e=await this.getIdToken();return await p2(this,qpe(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,a,s,o,l,c,d,u;const f=(n=r.displayName)!==null&&n!==void 0?n:void 0,A=(a=r.email)!==null&&a!==void 0?a:void 0,h=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,m=(o=r.photoURL)!==null&&o!==void 0?o:void 0,p=(l=r.tenantId)!==null&&l!==void 0?l:void 0,x=(c=r._redirectEventId)!==null&&c!==void 0?c:void 0,v=(d=r.createdAt)!==null&&d!==void 0?d:void 0,y=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:b,emailVerified:w,isAnonymous:I,providerData:j,stsTokenManager:N}=r;Wn(b&&N,e,"internal-error");const S=hv.fromJSON(this.name,N);Wn(typeof b=="string",e,"internal-error"),d0(f,e.name),d0(A,e.name),Wn(typeof w=="boolean",e,"internal-error"),Wn(typeof I=="boolean",e,"internal-error"),d0(h,e.name),d0(m,e.name),d0(p,e.name),d0(x,e.name),d0(v,e.name),d0(y,e.name);const E=new Yh({uid:b,auth:e,email:A,emailVerified:w,displayName:f,isAnonymous:I,photoURL:m,phoneNumber:h,tenantId:p,stsTokenManager:S,createdAt:v,lastLoginAt:y});return j&&Array.isArray(j)&&(E.providerData=j.map(B=>Object.assign({},B))),x&&(E._redirectEventId=x),E}static async _fromIdTokenResponse(e,r,n=!1){const a=new hv;a.updateFromServerResponse(r);const s=new Yh({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await lS(s),s}static async _fromGetAccountInfoResponse(e,r,n){const a=r.users[0];Wn(a.localId!==void 0,"internal-error");const s=a.providerUserInfo!==void 0?gJ(a.providerUserInfo):[],o=!(a.email&&a.passwordHash)&&!(s!=null&&s.length),l=new hv;l.updateFromIdToken(n);const c=new Yh({uid:a.localId,auth:e,stsTokenManager:l,isAnonymous:o}),d={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:s,metadata:new WB(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u7=new Map;function Jh(t){bA(t instanceof Function,"Expected a class definition");let e=u7.get(t);return e?(bA(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,u7.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xJ{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}xJ.type="NONE";const f7=xJ;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iE(t,e,r){return`firebase:${t}:${e}:${r}`}class Av{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:a,name:s}=this.auth;this.fullUserKey=iE(this.userKey,a.apiKey,s),this.fullPersistenceKey=iE("persistence",a.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Yh._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Av(Jh(f7),e,n);const a=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let s=a[0]||Jh(f7);const o=iE(n,e.config.apiKey,e.name);let l=null;for(const d of r)try{const u=await d._get(o);if(u){const f=Yh._fromJSON(e,u);d!==s&&(l=f),s=d;break}}catch{}const c=a.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new Av(s,e,n):(s=c[0],l&&await s._set(o,l.toJSON()),await Promise.all(r.map(async d=>{if(d!==s)try{await d._remove(o)}catch{}})),new Av(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h7(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(wJ(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(vJ(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(CJ(e))return"Blackberry";if(_J(e))return"Webos";if(yJ(e))return"Safari";if((e.includes("chrome/")||bJ(e))&&!e.includes("edge/"))return"Chrome";if(NJ(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function vJ(t=Ko()){return/firefox\//i.test(t)}function yJ(t=Ko()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function bJ(t=Ko()){return/crios\//i.test(t)}function wJ(t=Ko()){return/iemobile/i.test(t)}function NJ(t=Ko()){return/android/i.test(t)}function CJ(t=Ko()){return/blackberry/i.test(t)}function _J(t=Ko()){return/webos/i.test(t)}function $D(t=Ko()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function tge(t=Ko()){var e;return $D(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function rge(){return yme()&&document.documentMode===10}function EJ(t=Ko()){return $D(t)||NJ(t)||_J(t)||CJ(t)||/windows phone/i.test(t)||wJ(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SJ(t,e=[]){let r;switch(t){case"Browser":r=h7(Ko());break;case"Worker":r=`${h7(Ko())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${u1}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nge{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((o,l)=>{try{const c=e(s);o(c)}catch(c){l(c)}});n.onAbort=r,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const a of r)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function age(t,e={}){return MA(t,"GET","/v2/passwordPolicy",RA(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sge=6;class ige{constructor(e){var r,n,a,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=o.minPasswordLength)!==null&&r!==void 0?r:sge,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,a,s,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(r=c.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(n=c.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(a=c.containsLowercaseLetter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),a&&(r.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,a,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oge{constructor(e,r,n,a){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new A7(this),this.idTokenSubscription=new A7(this),this.beforeStateQueue=new nge(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=uJ,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Jh(r)),this._initializationPromise=this.queue(async()=>{var n,a;if(!this._deleted&&(this.persistenceManager=await Av.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await pJ(this,{idToken:e}),n=await Yh._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Zf(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let a=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,l=a==null?void 0:a._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(a=c.user,s=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(a)}catch(o){a=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return Wn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await lS(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Upe()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Zf(this.app))return Promise.reject(iA(this));const r=e?Ii(e):null;return r&&Wn(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Wn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Zf(this.app)?Promise.reject(iA(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Zf(this.app)?Promise.reject(iA(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Jh(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await age(this),r=new ige(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Cw("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await ege(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Jh(e)||this._popupRedirectResolver;Wn(r,this,"argument-error"),this.redirectPersistenceManager=await Av.create(this,[Jh(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,a){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Wn(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,a);return()=>{o=!0,c()}}else{const c=e.addObserver(r);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Wn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=SJ(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const a=await this._getAppCheckToken();return a&&(r["X-Firebase-AppCheck"]=a),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&Rpe(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Qm(t){return Ii(t)}class A7{constructor(e){this.auth=e,this.observer=null,this.addObserver=Eme(r=>this.observer=r)}get next(){return Wn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _I={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function lge(t){_I=t}function jJ(t){return _I.loadJS(t)}function cge(){return _I.recaptchaEnterpriseScript}function dge(){return _I.gapiScript}function uge(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const fge="recaptcha-enterprise",hge="NO_RECAPTCHA";class Age{constructor(e){this.type=fge,this.auth=Qm(e)}async verify(e="verify",r=!1){async function n(s){if(!r){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,l)=>{Kpe(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new Gpe(c);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,o(d.siteKey)}}).catch(c=>{l(c)})})}function a(s,o,l){const c=window.grecaptcha;c7(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(d=>{o(d)}).catch(()=>{o(hge)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{n(this.auth).then(l=>{if(!r&&c7(window.grecaptcha))a(l,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=cge();c.length!==0&&(c+=l),jJ(c).then(()=>{a(l,s,o)}).catch(d=>{o(d)})}}).catch(l=>{o(l)})})}}async function m7(t,e,r,n=!1){const a=new Age(t);let s;try{s=await a.verify(r)}catch{s=await a.verify(r,!0)}const o=Object.assign({},e);return n?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function cS(t,e,r,n){var a;if(!((a=t._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await m7(t,e,r,r==="getOobCode");return n(t,s)}else return n(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await m7(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mge(t,e){const r=RD(t,"auth");if(r.isInitialized()){const a=r.getImmediate(),s=r.getOptions();if(A2(s,e??{}))return a;jf(a,"already-initialized")}return r.initialize({options:e})}function pge(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Jh);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function gge(t,e,r){const n=Qm(t);Wn(n._canInitEmulator,n,"emulator-config-failed"),Wn(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,s=IJ(e),{host:o,port:l}=xge(e),c=l===null?"":`:${l}`;n.config.emulator={url:`${s}//${o}${c}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:a})}),vge()}function IJ(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function xge(t){const e=IJ(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const s=a[1];return{host:s,port:p7(n.substr(s.length+1))}}else{const[s,o]=n.split(":");return{host:s,port:p7(o)}}}function p7(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function vge(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Xh("not implemented")}_getIdTokenResponse(e){return Xh("not implemented")}_linkToIdToken(e,r){return Xh("not implemented")}_getReauthenticationResolver(e){return Xh("not implemented")}}async function yge(t,e){return MA(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bge(t,e){return Sw(t,"POST","/v1/accounts:signInWithPassword",RA(t,e))}async function wge(t,e){return MA(t,"POST","/v1/accounts:sendOobCode",RA(t,e))}async function Nge(t,e){return wge(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cge(t,e){return Sw(t,"POST","/v1/accounts:signInWithEmailLink",RA(t,e))}async function _ge(t,e){return Sw(t,"POST","/v1/accounts:signInWithEmailLink",RA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g2 extends GD{constructor(e,r,n,a=null){super("password",n),this._email=e,this._password=r,this._tenantId=a}static _fromEmailAndPassword(e,r){return new g2(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new g2(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return cS(e,r,"signInWithPassword",bge);case"emailLink":return Cge(e,{email:this._email,oobCode:this._password});default:jf(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return cS(e,n,"signUpPassword",yge);case"emailLink":return _ge(e,{idToken:r,email:this._email,oobCode:this._password});default:jf(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mv(t,e){return Sw(t,"POST","/v1/accounts:signInWithIdp",RA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ege="http://localhost";class og extends GD{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new og(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):jf("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a}=r,s=UD(r,["providerId","signInMethod"]);if(!n||!a)return null;const o=new og(n,a);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return mv(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,mv(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,mv(e,r)}buildRequest(){const e={requestUri:Ege,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=_w(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sge(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function jge(t){const e=Hy($y(t)).link,r=e?Hy($y(e)).deep_link_id:null,n=Hy($y(t)).deep_link_id;return(n?Hy($y(n)).link:null)||n||r||e||t}class KD{constructor(e){var r,n,a,s,o,l;const c=Hy($y(e)),d=(r=c.apiKey)!==null&&r!==void 0?r:null,u=(n=c.oobCode)!==null&&n!==void 0?n:null,f=Sge((a=c.mode)!==null&&a!==void 0?a:null);Wn(d&&u&&f,"argument-error"),this.apiKey=d,this.operation=f,this.code=u,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const r=jge(e);try{return new KD(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f1{constructor(){this.providerId=f1.PROVIDER_ID}static credential(e,r){return g2._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=KD.parseLink(r);return Wn(n,"argument-error"),g2._fromEmailAndCode(e,n.code,n.tenantId)}}f1.PROVIDER_ID="password";f1.EMAIL_PASSWORD_SIGN_IN_METHOD="password";f1.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PJ{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw extends PJ{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0 extends jw{constructor(){super("facebook.com")}static credential(e){return og._fromParams({providerId:R0.PROVIDER_ID,signInMethod:R0.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return R0.credentialFromTaggedObject(e)}static credentialFromError(e){return R0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return R0.credential(e.oauthAccessToken)}catch{return null}}}R0.FACEBOOK_SIGN_IN_METHOD="facebook.com";R0.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0 extends jw{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return og._fromParams({providerId:M0.PROVIDER_ID,signInMethod:M0.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return M0.credentialFromTaggedObject(e)}static credentialFromError(e){return M0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return M0.credential(r,n)}catch{return null}}}M0.GOOGLE_SIGN_IN_METHOD="google.com";M0.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0 extends jw{constructor(){super("github.com")}static credential(e){return og._fromParams({providerId:L0.PROVIDER_ID,signInMethod:L0.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return L0.credentialFromTaggedObject(e)}static credentialFromError(e){return L0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return L0.credential(e.oauthAccessToken)}catch{return null}}}L0.GITHUB_SIGN_IN_METHOD="github.com";L0.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U0 extends jw{constructor(){super("twitter.com")}static credential(e,r){return og._fromParams({providerId:U0.PROVIDER_ID,signInMethod:U0.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return U0.credentialFromTaggedObject(e)}static credentialFromError(e){return U0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return U0.credential(r,n)}catch{return null}}}U0.TWITTER_SIGN_IN_METHOD="twitter.com";U0.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ige(t,e){return Sw(t,"POST","/v1/accounts:signUp",RA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lg{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,a=!1){const s=await Yh._fromIdTokenResponse(e,n,a),o=g7(n);return new lg({user:s,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const a=g7(n);return new lg({user:e,providerId:a,_tokenResponse:n,operationType:r})}}function g7(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS extends DA{constructor(e,r,n,a){var s;super(r.code,r.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,dS.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,a){return new dS(e,r,n,a)}}function TJ(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?dS._fromErrorAndOperation(t,s,e,n):s})}async function Pge(t,e,r=!1){const n=await p2(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return lg._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tge(t,e,r=!1){const{auth:n}=t;if(Zf(n.app))return Promise.reject(iA(n));const a="reauthenticate";try{const s=await p2(t,TJ(n,a,e,t),r);Wn(s.idToken,n,"internal-error");const o=HD(s.idToken);Wn(o,n,"internal-error");const{sub:l}=o;return Wn(t.uid===l,n,"user-mismatch"),lg._forOperation(t,a,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&jf(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BJ(t,e,r=!1){if(Zf(t.app))return Promise.reject(iA(t));const n="signIn",a=await TJ(t,n,e),s=await lg._fromIdTokenResponse(t,n,a);return r||await t._updateCurrentUser(s.user),s}async function Bge(t,e){return BJ(Qm(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kJ(t){const e=Qm(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function kge(t,e,r){const n=Qm(t);await cS(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",Nge)}async function Fge(t,e,r){if(Zf(t.app))return Promise.reject(iA(t));const n=Qm(t),o=await cS(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ige).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&kJ(t),c}),l=await lg._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(l.user),l}function Oge(t,e,r){return Zf(t.app)?Promise.reject(iA(t)):Bge(Ii(t),f1.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&kJ(t),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oE(t,e){return Ii(t).setPersistence(e)}function Dge(t,e,r,n){return Ii(t).onIdTokenChanged(e,r,n)}function Rge(t,e,r){return Ii(t).beforeAuthStateChanged(e,r)}function EI(t,e,r,n){return Ii(t).onAuthStateChanged(e,r,n)}function qD(t){return Ii(t).signOut()}const uS="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FJ{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(uS,"1"),this.storage.removeItem(uS),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mge=1e3,Lge=10;class OJ extends FJ{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=EJ(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),a=this.localCache[r];n!==a&&e(r,a,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const a=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},s=this.storage.getItem(n);rge()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,Lge):a()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},Mge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}OJ.type="LOCAL";const zD=OJ;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DJ extends FJ{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}DJ.type="SESSION";const WD=DJ;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uge(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(a=>a.isListeningto(e));if(r)return r;const n=new SI(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:a,data:s}=r.data,o=this.handlersMap[a];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const l=Array.from(o).map(async d=>d(r.origin,s)),c=await Uge(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}SI.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XD(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qge{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let s,o;return new Promise((l,c)=>{const d=XD("",20);a.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},n);o={messageChannel:a,onMessage(f){const A=f;if(A.data.eventId===d)switch(A.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(A.data.response);break;default:clearTimeout(u),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),a.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[a.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ch(){return window}function Vge(t){ch().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RJ(){return typeof ch().WorkerGlobalScope<"u"&&typeof ch().importScripts=="function"}async function Hge(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function $ge(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Gge(){return RJ()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MJ="firebaseLocalStorageDb",Kge=1,fS="firebaseLocalStorage",LJ="fbase_key";class Iw{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function jI(t,e){return t.transaction([fS],e?"readwrite":"readonly").objectStore(fS)}function qge(){const t=indexedDB.deleteDatabase(MJ);return new Iw(t).toPromise()}function XB(){const t=indexedDB.open(MJ,Kge);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(fS,{keyPath:LJ})}catch(a){r(a)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(fS)?e(n):(n.close(),await qge(),e(await XB()))})})}async function x7(t,e,r){const n=jI(t,!0).put({[LJ]:e,value:r});return new Iw(n).toPromise()}async function zge(t,e){const r=jI(t,!1).get(e),n=await new Iw(r).toPromise();return n===void 0?null:n.value}function v7(t,e){const r=jI(t,!0).delete(e);return new Iw(r).toPromise()}const Wge=800,Xge=3;class UJ{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await XB(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>Xge)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return RJ()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=SI._getInstance(Gge()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await Hge(),!this.activeServiceWorker)return;this.sender=new Qge(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||$ge()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await XB();return await x7(e,uS,"1"),await v7(e,uS),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>x7(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>zge(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>v7(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const s=jI(a,!1).getAll();return new Iw(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:s}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(s)&&(this.notifyListeners(a,s),r.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),r.push(a));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Wge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}UJ.type="LOCAL";const QJ=UJ;new Ew(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yge(t,e){return e?Jh(e):(Wn(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YD extends GD{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return mv(e,this._buildIdpRequest())}_linkToIdToken(e,r){return mv(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return mv(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function Jge(t){return BJ(t.auth,new YD(t),t.bypassAuthState)}function Zge(t){const{auth:e,user:r}=t;return Wn(r,e,"internal-error"),Tge(r,new YD(t),t.bypassAuthState)}async function exe(t){const{auth:e,user:r}=t;return Wn(r,e,"internal-error"),Pge(r,new YD(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VJ{constructor(e,r,n,a,s=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:a,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Jge;case"linkViaPopup":case"linkViaRedirect":return exe;case"reauthViaPopup":case"reauthViaRedirect":return Zge;default:jf(this.auth,"internal-error")}}resolve(e){bA(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){bA(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const txe=new Ew(2e3,1e4);class Yx extends VJ{constructor(e,r,n,a,s){super(e,r,a,s),this.provider=n,this.authWindow=null,this.pollId=null,Yx.currentPopupAction&&Yx.currentPopupAction.cancel(),Yx.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Wn(e,this.auth,"internal-error"),e}async onExecution(){bA(this.filter.length===1,"Popup operations only handle one event");const e=XD();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(lh(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(lh(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Yx.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(lh(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,txe.get())};e()}}Yx.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rxe="pendingRedirect",lE=new Map;class nxe extends VJ{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=lE.get(this.auth._key());if(!e){try{const n=await axe(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}lE.set(this.auth._key(),e)}return this.bypassAuthState||lE.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function axe(t,e){const r=oxe(e),n=ixe(t);if(!await n._isAvailable())return!1;const a=await n._get(r)==="true";return await n._remove(r),a}function sxe(t,e){lE.set(t._key(),e)}function ixe(t){return Jh(t._redirectPersistence)}function oxe(t){return iE(rxe,t.config.apiKey,t.name)}async function lxe(t,e,r=!1){if(Zf(t.app))return Promise.reject(iA(t));const n=Qm(t),a=Yge(n,e),o=await new nxe(n,a,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cxe=10*60*1e3;class dxe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!uxe(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!HJ(e)){const a=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(lh(this.auth,a))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=cxe&&this.cachedEventUids.clear(),this.cachedEventUids.has(y7(e))}saveEventToCache(e){this.cachedEventUids.add(y7(e)),this.lastProcessedEventTime=Date.now()}}function y7(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function HJ({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function uxe(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return HJ(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fxe(t,e={}){return MA(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hxe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Axe=/^https?/;async function mxe(t){if(t.config.emulator)return;const{authorizedDomains:e}=await fxe(t);for(const r of e)try{if(pxe(r))return}catch{}jf(t,"unauthorized-domain")}function pxe(t){const e=zB(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!Axe.test(r))return!1;if(hxe.test(t))return n===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gxe=new Ew(3e4,6e4);function b7(){const t=ch().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function xxe(t){return new Promise((e,r)=>{var n,a,s;function o(){b7(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{b7(),r(lh(t,"network-request-failed"))},timeout:gxe.get()})}if(!((a=(n=ch().gapi)===null||n===void 0?void 0:n.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((s=ch().gapi)===null||s===void 0)&&s.load)o();else{const l=uge("iframefcb");return ch()[l]=()=>{gapi.load?o():r(lh(t,"network-request-failed"))},jJ(`${dge()}?onload=${l}`).catch(c=>r(c))}}).catch(e=>{throw cE=null,e})}let cE=null;function vxe(t){return cE=cE||xxe(t),cE}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yxe=new Ew(5e3,15e3),bxe="__/auth/iframe",wxe="emulator/auth/iframe",Nxe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Cxe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function _xe(t){const e=t.config;Wn(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?VD(e,wxe):`https://${t.config.authDomain}/${bxe}`,n={apiKey:e.apiKey,appName:t.name,v:u1},a=Cxe.get(t.config.apiHost);a&&(n.eid=a);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${_w(n).slice(1)}`}async function Exe(t){const e=await vxe(t),r=ch().gapi;return Wn(r,t,"internal-error"),e.open({where:document.body,url:_xe(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Nxe,dontclear:!0},n=>new Promise(async(a,s)=>{await n.restyle({setHideOnLeave:!1});const o=lh(t,"network-request-failed"),l=ch().setTimeout(()=>{s(o)},yxe.get());function c(){ch().clearTimeout(l),a(n)}n.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sxe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},jxe=500,Ixe=600,Pxe="_blank",Txe="http://localhost";class w7{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Bxe(t,e,r,n=jxe,a=Ixe){const s=Math.max((window.screen.availHeight-a)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c=Object.assign(Object.assign({},Sxe),{width:n.toString(),height:a.toString(),top:s,left:o}),d=Ko().toLowerCase();r&&(l=bJ(d)?Pxe:r),vJ(d)&&(e=e||Txe,c.scrollbars="yes");const u=Object.entries(c).reduce((A,[h,m])=>`${A}${h}=${m},`,"");if(tge(d)&&l!=="_self")return kxe(e||"",l),new w7(null);const f=window.open(e||"",l,u);Wn(f,t,"popup-blocked");try{f.focus()}catch{}return new w7(f)}function kxe(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fxe="__/auth/handler",Oxe="emulator/auth/handler",Dxe=encodeURIComponent("fac");async function N7(t,e,r,n,a,s){Wn(t.config.authDomain,t,"auth-domain-config-required"),Wn(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:u1,eventId:a};if(e instanceof PJ){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",_me(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,f]of Object.entries({}))o[u]=f}if(e instanceof jw){const u=e.getScopes().filter(f=>f!=="");u.length>0&&(o.scopes=u.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const u of Object.keys(l))l[u]===void 0&&delete l[u];const c=await t._getAppCheckToken(),d=c?`#${Dxe}=${encodeURIComponent(c)}`:"";return`${Rxe(t)}?${_w(l).slice(1)}${d}`}function Rxe({config:t}){return t.emulator?VD(t,Oxe):`https://${t.authDomain}/${Fxe}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B4="webStorageSupport";class Mxe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=WD,this._completeRedirectFn=lxe,this._overrideRedirectResult=sxe}async _openPopup(e,r,n,a){var s;bA((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await N7(e,r,n,zB(),a);return Bxe(e,o,XD())}async _openRedirect(e,r,n,a){await this._originValidation(e);const s=await N7(e,r,n,zB(),a);return Vge(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:a,promise:s}=this.eventManagers[r];return a?Promise.resolve(a):(bA(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await Exe(e),n=new dxe(e);return r.register("authEvent",a=>(Wn(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(B4,{type:B4},a=>{var s;const o=(s=a==null?void 0:a[0])===null||s===void 0?void 0:s[B4];o!==void 0&&r(!!o),jf(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=mxe(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return EJ()||yJ()||$D()}}const Lxe=Mxe;var C7="@firebase/auth",_7="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uxe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Wn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qxe(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Vxe(t){kv(new ig("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=n.options;Wn(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:SJ(t)},d=new oge(n,a,s,c);return pge(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),kv(new ig("auth-internal",e=>{const r=Qm(e.getProvider("auth").getImmediate());return(n=>new Uxe(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),fm(C7,_7,Qxe(t)),fm(C7,_7,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hxe=5*60,$xe=nJ("authIdTokenMaxAge")||Hxe;let E7=null;const Gxe=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>$xe)return;const a=r==null?void 0:r.token;E7!==a&&(E7=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function YB(t=LD()){const e=RD(t,"auth");if(e.isInitialized())return e.getImmediate();const r=mge(t,{popupRedirectResolver:Lxe,persistence:[QJ,zD,WD]}),n=nJ("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const o=Gxe(s.toString());Rge(r,o,()=>o(r.currentUser)),Dge(r,l=>o(l))}}const a=tJ("auth");return a&&gge(r,`http://${a}`),r}function Kxe(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}lge({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=a=>{const s=lh("internal-error");s.customData=a,r(s)},n.type="text/javascript",n.charset="UTF-8",Kxe().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Vxe("Browser");var qxe="firebase",zxe="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fm(qxe,zxe,"app");var S7=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Lp,$J;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,S){function E(){}E.prototype=S.prototype,N.D=S.prototype,N.prototype=new E,N.prototype.constructor=N,N.C=function(B,k,T){for(var P=Array(arguments.length-2),q=2;q<arguments.length;q++)P[q-2]=arguments[q];return S.prototype[k].apply(B,P)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(N,S,E){E||(E=0);var B=Array(16);if(typeof S=="string")for(var k=0;16>k;++k)B[k]=S.charCodeAt(E++)|S.charCodeAt(E++)<<8|S.charCodeAt(E++)<<16|S.charCodeAt(E++)<<24;else for(k=0;16>k;++k)B[k]=S[E++]|S[E++]<<8|S[E++]<<16|S[E++]<<24;S=N.g[0],E=N.g[1],k=N.g[2];var T=N.g[3],P=S+(T^E&(k^T))+B[0]+3614090360&4294967295;S=E+(P<<7&4294967295|P>>>25),P=T+(k^S&(E^k))+B[1]+3905402710&4294967295,T=S+(P<<12&4294967295|P>>>20),P=k+(E^T&(S^E))+B[2]+606105819&4294967295,k=T+(P<<17&4294967295|P>>>15),P=E+(S^k&(T^S))+B[3]+3250441966&4294967295,E=k+(P<<22&4294967295|P>>>10),P=S+(T^E&(k^T))+B[4]+4118548399&4294967295,S=E+(P<<7&4294967295|P>>>25),P=T+(k^S&(E^k))+B[5]+1200080426&4294967295,T=S+(P<<12&4294967295|P>>>20),P=k+(E^T&(S^E))+B[6]+2821735955&4294967295,k=T+(P<<17&4294967295|P>>>15),P=E+(S^k&(T^S))+B[7]+4249261313&4294967295,E=k+(P<<22&4294967295|P>>>10),P=S+(T^E&(k^T))+B[8]+1770035416&4294967295,S=E+(P<<7&4294967295|P>>>25),P=T+(k^S&(E^k))+B[9]+2336552879&4294967295,T=S+(P<<12&4294967295|P>>>20),P=k+(E^T&(S^E))+B[10]+4294925233&4294967295,k=T+(P<<17&4294967295|P>>>15),P=E+(S^k&(T^S))+B[11]+2304563134&4294967295,E=k+(P<<22&4294967295|P>>>10),P=S+(T^E&(k^T))+B[12]+1804603682&4294967295,S=E+(P<<7&4294967295|P>>>25),P=T+(k^S&(E^k))+B[13]+4254626195&4294967295,T=S+(P<<12&4294967295|P>>>20),P=k+(E^T&(S^E))+B[14]+2792965006&4294967295,k=T+(P<<17&4294967295|P>>>15),P=E+(S^k&(T^S))+B[15]+1236535329&4294967295,E=k+(P<<22&4294967295|P>>>10),P=S+(k^T&(E^k))+B[1]+4129170786&4294967295,S=E+(P<<5&4294967295|P>>>27),P=T+(E^k&(S^E))+B[6]+3225465664&4294967295,T=S+(P<<9&4294967295|P>>>23),P=k+(S^E&(T^S))+B[11]+643717713&4294967295,k=T+(P<<14&4294967295|P>>>18),P=E+(T^S&(k^T))+B[0]+3921069994&4294967295,E=k+(P<<20&4294967295|P>>>12),P=S+(k^T&(E^k))+B[5]+3593408605&4294967295,S=E+(P<<5&4294967295|P>>>27),P=T+(E^k&(S^E))+B[10]+38016083&4294967295,T=S+(P<<9&4294967295|P>>>23),P=k+(S^E&(T^S))+B[15]+3634488961&4294967295,k=T+(P<<14&4294967295|P>>>18),P=E+(T^S&(k^T))+B[4]+3889429448&4294967295,E=k+(P<<20&4294967295|P>>>12),P=S+(k^T&(E^k))+B[9]+568446438&4294967295,S=E+(P<<5&4294967295|P>>>27),P=T+(E^k&(S^E))+B[14]+3275163606&4294967295,T=S+(P<<9&4294967295|P>>>23),P=k+(S^E&(T^S))+B[3]+4107603335&4294967295,k=T+(P<<14&4294967295|P>>>18),P=E+(T^S&(k^T))+B[8]+1163531501&4294967295,E=k+(P<<20&4294967295|P>>>12),P=S+(k^T&(E^k))+B[13]+2850285829&4294967295,S=E+(P<<5&4294967295|P>>>27),P=T+(E^k&(S^E))+B[2]+4243563512&4294967295,T=S+(P<<9&4294967295|P>>>23),P=k+(S^E&(T^S))+B[7]+1735328473&4294967295,k=T+(P<<14&4294967295|P>>>18),P=E+(T^S&(k^T))+B[12]+2368359562&4294967295,E=k+(P<<20&4294967295|P>>>12),P=S+(E^k^T)+B[5]+4294588738&4294967295,S=E+(P<<4&4294967295|P>>>28),P=T+(S^E^k)+B[8]+2272392833&4294967295,T=S+(P<<11&4294967295|P>>>21),P=k+(T^S^E)+B[11]+1839030562&4294967295,k=T+(P<<16&4294967295|P>>>16),P=E+(k^T^S)+B[14]+4259657740&4294967295,E=k+(P<<23&4294967295|P>>>9),P=S+(E^k^T)+B[1]+2763975236&4294967295,S=E+(P<<4&4294967295|P>>>28),P=T+(S^E^k)+B[4]+1272893353&4294967295,T=S+(P<<11&4294967295|P>>>21),P=k+(T^S^E)+B[7]+4139469664&4294967295,k=T+(P<<16&4294967295|P>>>16),P=E+(k^T^S)+B[10]+3200236656&4294967295,E=k+(P<<23&4294967295|P>>>9),P=S+(E^k^T)+B[13]+681279174&4294967295,S=E+(P<<4&4294967295|P>>>28),P=T+(S^E^k)+B[0]+3936430074&4294967295,T=S+(P<<11&4294967295|P>>>21),P=k+(T^S^E)+B[3]+3572445317&4294967295,k=T+(P<<16&4294967295|P>>>16),P=E+(k^T^S)+B[6]+76029189&4294967295,E=k+(P<<23&4294967295|P>>>9),P=S+(E^k^T)+B[9]+3654602809&4294967295,S=E+(P<<4&4294967295|P>>>28),P=T+(S^E^k)+B[12]+3873151461&4294967295,T=S+(P<<11&4294967295|P>>>21),P=k+(T^S^E)+B[15]+530742520&4294967295,k=T+(P<<16&4294967295|P>>>16),P=E+(k^T^S)+B[2]+3299628645&4294967295,E=k+(P<<23&4294967295|P>>>9),P=S+(k^(E|~T))+B[0]+4096336452&4294967295,S=E+(P<<6&4294967295|P>>>26),P=T+(E^(S|~k))+B[7]+1126891415&4294967295,T=S+(P<<10&4294967295|P>>>22),P=k+(S^(T|~E))+B[14]+2878612391&4294967295,k=T+(P<<15&4294967295|P>>>17),P=E+(T^(k|~S))+B[5]+4237533241&4294967295,E=k+(P<<21&4294967295|P>>>11),P=S+(k^(E|~T))+B[12]+1700485571&4294967295,S=E+(P<<6&4294967295|P>>>26),P=T+(E^(S|~k))+B[3]+2399980690&4294967295,T=S+(P<<10&4294967295|P>>>22),P=k+(S^(T|~E))+B[10]+4293915773&4294967295,k=T+(P<<15&4294967295|P>>>17),P=E+(T^(k|~S))+B[1]+2240044497&4294967295,E=k+(P<<21&4294967295|P>>>11),P=S+(k^(E|~T))+B[8]+1873313359&4294967295,S=E+(P<<6&4294967295|P>>>26),P=T+(E^(S|~k))+B[15]+4264355552&4294967295,T=S+(P<<10&4294967295|P>>>22),P=k+(S^(T|~E))+B[6]+2734768916&4294967295,k=T+(P<<15&4294967295|P>>>17),P=E+(T^(k|~S))+B[13]+1309151649&4294967295,E=k+(P<<21&4294967295|P>>>11),P=S+(k^(E|~T))+B[4]+4149444226&4294967295,S=E+(P<<6&4294967295|P>>>26),P=T+(E^(S|~k))+B[11]+3174756917&4294967295,T=S+(P<<10&4294967295|P>>>22),P=k+(S^(T|~E))+B[2]+718787259&4294967295,k=T+(P<<15&4294967295|P>>>17),P=E+(T^(k|~S))+B[9]+3951481745&4294967295,N.g[0]=N.g[0]+S&4294967295,N.g[1]=N.g[1]+(k+(P<<21&4294967295|P>>>11))&4294967295,N.g[2]=N.g[2]+k&4294967295,N.g[3]=N.g[3]+T&4294967295}n.prototype.u=function(N,S){S===void 0&&(S=N.length);for(var E=S-this.blockSize,B=this.B,k=this.h,T=0;T<S;){if(k==0)for(;T<=E;)a(this,N,T),T+=this.blockSize;if(typeof N=="string"){for(;T<S;)if(B[k++]=N.charCodeAt(T++),k==this.blockSize){a(this,B),k=0;break}}else for(;T<S;)if(B[k++]=N[T++],k==this.blockSize){a(this,B),k=0;break}}this.h=k,this.o+=S},n.prototype.v=function(){var N=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);N[0]=128;for(var S=1;S<N.length-8;++S)N[S]=0;var E=8*this.o;for(S=N.length-8;S<N.length;++S)N[S]=E&255,E/=256;for(this.u(N),N=Array(16),S=E=0;4>S;++S)for(var B=0;32>B;B+=8)N[E++]=this.g[S]>>>B&255;return N};function s(N,S){var E=l;return Object.prototype.hasOwnProperty.call(E,N)?E[N]:E[N]=S(N)}function o(N,S){this.h=S;for(var E=[],B=!0,k=N.length-1;0<=k;k--){var T=N[k]|0;B&&T==S||(E[k]=T,B=!1)}this.g=E}var l={};function c(N){return-128<=N&&128>N?s(N,function(S){return new o([S|0],0>S?-1:0)}):new o([N|0],0>N?-1:0)}function d(N){if(isNaN(N)||!isFinite(N))return f;if(0>N)return x(d(-N));for(var S=[],E=1,B=0;N>=E;B++)S[B]=N/E|0,E*=4294967296;return new o(S,0)}function u(N,S){if(N.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(N.charAt(0)=="-")return x(u(N.substring(1),S));if(0<=N.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=d(Math.pow(S,8)),B=f,k=0;k<N.length;k+=8){var T=Math.min(8,N.length-k),P=parseInt(N.substring(k,k+T),S);8>T?(T=d(Math.pow(S,T)),B=B.j(T).add(d(P))):(B=B.j(E),B=B.add(d(P)))}return B}var f=c(0),A=c(1),h=c(16777216);t=o.prototype,t.m=function(){if(p(this))return-x(this).m();for(var N=0,S=1,E=0;E<this.g.length;E++){var B=this.i(E);N+=(0<=B?B:4294967296+B)*S,S*=4294967296}return N},t.toString=function(N){if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(m(this))return"0";if(p(this))return"-"+x(this).toString(N);for(var S=d(Math.pow(N,6)),E=this,B="";;){var k=w(E,S).g;E=v(E,k.j(S));var T=((0<E.g.length?E.g[0]:E.h)>>>0).toString(N);if(E=k,m(E))return T+B;for(;6>T.length;)T="0"+T;B=T+B}},t.i=function(N){return 0>N?0:N<this.g.length?this.g[N]:this.h};function m(N){if(N.h!=0)return!1;for(var S=0;S<N.g.length;S++)if(N.g[S]!=0)return!1;return!0}function p(N){return N.h==-1}t.l=function(N){return N=v(this,N),p(N)?-1:m(N)?0:1};function x(N){for(var S=N.g.length,E=[],B=0;B<S;B++)E[B]=~N.g[B];return new o(E,~N.h).add(A)}t.abs=function(){return p(this)?x(this):this},t.add=function(N){for(var S=Math.max(this.g.length,N.g.length),E=[],B=0,k=0;k<=S;k++){var T=B+(this.i(k)&65535)+(N.i(k)&65535),P=(T>>>16)+(this.i(k)>>>16)+(N.i(k)>>>16);B=P>>>16,T&=65535,P&=65535,E[k]=P<<16|T}return new o(E,E[E.length-1]&-2147483648?-1:0)};function v(N,S){return N.add(x(S))}t.j=function(N){if(m(this)||m(N))return f;if(p(this))return p(N)?x(this).j(x(N)):x(x(this).j(N));if(p(N))return x(this.j(x(N)));if(0>this.l(h)&&0>N.l(h))return d(this.m()*N.m());for(var S=this.g.length+N.g.length,E=[],B=0;B<2*S;B++)E[B]=0;for(B=0;B<this.g.length;B++)for(var k=0;k<N.g.length;k++){var T=this.i(B)>>>16,P=this.i(B)&65535,q=N.i(k)>>>16,de=N.i(k)&65535;E[2*B+2*k]+=P*de,y(E,2*B+2*k),E[2*B+2*k+1]+=T*de,y(E,2*B+2*k+1),E[2*B+2*k+1]+=P*q,y(E,2*B+2*k+1),E[2*B+2*k+2]+=T*q,y(E,2*B+2*k+2)}for(B=0;B<S;B++)E[B]=E[2*B+1]<<16|E[2*B];for(B=S;B<2*S;B++)E[B]=0;return new o(E,0)};function y(N,S){for(;(N[S]&65535)!=N[S];)N[S+1]+=N[S]>>>16,N[S]&=65535,S++}function b(N,S){this.g=N,this.h=S}function w(N,S){if(m(S))throw Error("division by zero");if(m(N))return new b(f,f);if(p(N))return S=w(x(N),S),new b(x(S.g),x(S.h));if(p(S))return S=w(N,x(S)),new b(x(S.g),S.h);if(30<N.g.length){if(p(N)||p(S))throw Error("slowDivide_ only works with positive integers.");for(var E=A,B=S;0>=B.l(N);)E=I(E),B=I(B);var k=j(E,1),T=j(B,1);for(B=j(B,2),E=j(E,2);!m(B);){var P=T.add(B);0>=P.l(N)&&(k=k.add(E),T=P),B=j(B,1),E=j(E,1)}return S=v(N,k.j(S)),new b(k,S)}for(k=f;0<=N.l(S);){for(E=Math.max(1,Math.floor(N.m()/S.m())),B=Math.ceil(Math.log(E)/Math.LN2),B=48>=B?1:Math.pow(2,B-48),T=d(E),P=T.j(S);p(P)||0<P.l(N);)E-=B,T=d(E),P=T.j(S);m(T)&&(T=A),k=k.add(T),N=v(N,P)}return new b(k,N)}t.A=function(N){return w(this,N).h},t.and=function(N){for(var S=Math.max(this.g.length,N.g.length),E=[],B=0;B<S;B++)E[B]=this.i(B)&N.i(B);return new o(E,this.h&N.h)},t.or=function(N){for(var S=Math.max(this.g.length,N.g.length),E=[],B=0;B<S;B++)E[B]=this.i(B)|N.i(B);return new o(E,this.h|N.h)},t.xor=function(N){for(var S=Math.max(this.g.length,N.g.length),E=[],B=0;B<S;B++)E[B]=this.i(B)^N.i(B);return new o(E,this.h^N.h)};function I(N){for(var S=N.g.length+1,E=[],B=0;B<S;B++)E[B]=N.i(B)<<1|N.i(B-1)>>>31;return new o(E,N.h)}function j(N,S){var E=S>>5;S%=32;for(var B=N.g.length-E,k=[],T=0;T<B;T++)k[T]=0<S?N.i(T+E)>>>S|N.i(T+E+1)<<32-S:N.i(T+E);return new o(k,N.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,$J=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=u,Lp=o}).apply(typeof S7<"u"?S7:typeof self<"u"?self:typeof window<"u"?window:{});var sC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var GJ,Gy,KJ,dE,JB,qJ,zJ,WJ;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(_,J,ge){return _==Array.prototype||_==Object.prototype||(_[J]=ge.value),_};function r(_){_=[typeof globalThis=="object"&&globalThis,_,typeof window=="object"&&window,typeof self=="object"&&self,typeof sC=="object"&&sC];for(var J=0;J<_.length;++J){var ge=_[J];if(ge&&ge.Math==Math)return ge}throw Error("Cannot find global object")}var n=r(this);function a(_,J){if(J)e:{var ge=n;_=_.split(".");for(var et=0;et<_.length-1;et++){var Ht=_[et];if(!(Ht in ge))break e;ge=ge[Ht]}_=_[_.length-1],et=ge[_],J=J(et),J!=et&&J!=null&&e(ge,_,{configurable:!0,writable:!0,value:J})}}function s(_,J){_ instanceof String&&(_+="");var ge=0,et=!1,Ht={next:function(){if(!et&&ge<_.length){var er=ge++;return{value:J(er,_[er]),done:!1}}return et=!0,{done:!0,value:void 0}}};return Ht[Symbol.iterator]=function(){return Ht},Ht}a("Array.prototype.values",function(_){return _||function(){return s(this,function(J,ge){return ge})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(_){var J=typeof _;return J=J!="object"?J:_?Array.isArray(_)?"array":J:"null",J=="array"||J=="object"&&typeof _.length=="number"}function d(_){var J=typeof _;return J=="object"&&_!=null||J=="function"}function u(_,J,ge){return _.call.apply(_.bind,arguments)}function f(_,J,ge){if(!_)throw Error();if(2<arguments.length){var et=Array.prototype.slice.call(arguments,2);return function(){var Ht=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Ht,et),_.apply(J,Ht)}}return function(){return _.apply(J,arguments)}}function A(_,J,ge){return A=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:f,A.apply(null,arguments)}function h(_,J){var ge=Array.prototype.slice.call(arguments,1);return function(){var et=ge.slice();return et.push.apply(et,arguments),_.apply(this,et)}}function m(_,J){function ge(){}ge.prototype=J.prototype,_.aa=J.prototype,_.prototype=new ge,_.prototype.constructor=_,_.Qb=function(et,Ht,er){for(var qr=Array(arguments.length-2),Pa=2;Pa<arguments.length;Pa++)qr[Pa-2]=arguments[Pa];return J.prototype[Ht].apply(et,qr)}}function p(_){const J=_.length;if(0<J){const ge=Array(J);for(let et=0;et<J;et++)ge[et]=_[et];return ge}return[]}function x(_,J){for(let ge=1;ge<arguments.length;ge++){const et=arguments[ge];if(c(et)){const Ht=_.length||0,er=et.length||0;_.length=Ht+er;for(let qr=0;qr<er;qr++)_[Ht+qr]=et[qr]}else _.push(et)}}class v{constructor(J,ge){this.i=J,this.j=ge,this.h=0,this.g=null}get(){let J;return 0<this.h?(this.h--,J=this.g,this.g=J.next,J.next=null):J=this.i(),J}}function y(_){return/^[\s\xa0]*$/.test(_)}function b(){var _=l.navigator;return _&&(_=_.userAgent)?_:""}function w(_){return w[" "](_),_}w[" "]=function(){};var I=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function j(_,J,ge){for(const et in _)J.call(ge,_[et],et,_)}function N(_,J){for(const ge in _)J.call(void 0,_[ge],ge,_)}function S(_){const J={};for(const ge in _)J[ge]=_[ge];return J}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function B(_,J){let ge,et;for(let Ht=1;Ht<arguments.length;Ht++){et=arguments[Ht];for(ge in et)_[ge]=et[ge];for(let er=0;er<E.length;er++)ge=E[er],Object.prototype.hasOwnProperty.call(et,ge)&&(_[ge]=et[ge])}}function k(_){var J=1;_=_.split(":");const ge=[];for(;0<J&&_.length;)ge.push(_.shift()),J--;return _.length&&ge.push(_.join(":")),ge}function T(_){l.setTimeout(()=>{throw _},0)}function P(){var _=ae;let J=null;return _.g&&(J=_.g,_.g=_.g.next,_.g||(_.h=null),J.next=null),J}class q{constructor(){this.h=this.g=null}add(J,ge){const et=de.get();et.set(J,ge),this.h?this.h.next=et:this.g=et,this.h=et}}var de=new v(()=>new ce,_=>_.reset());class ce{constructor(){this.next=this.g=this.h=null}set(J,ge){this.h=J,this.g=ge,this.next=null}reset(){this.next=this.g=this.h=null}}let le,he=!1,ae=new q,Ce=()=>{const _=l.Promise.resolve(void 0);le=()=>{_.then(De)}};var De=()=>{for(var _;_=P();){try{_.h.call(_.g)}catch(ge){T(ge)}var J=de;J.j(_),100>J.h&&(J.h++,_.next=J.g,J.g=_)}he=!1};function O(){this.s=this.s,this.C=this.C}O.prototype.s=!1,O.prototype.ma=function(){this.s||(this.s=!0,this.N())},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function R(_,J){this.type=_,this.g=this.target=J,this.defaultPrevented=!1}R.prototype.h=function(){this.defaultPrevented=!0};var G=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var _=!1,J=Object.defineProperty({},"passive",{get:function(){_=!0}});try{const ge=()=>{};l.addEventListener("test",ge,J),l.removeEventListener("test",ge,J)}catch{}return _}();function M(_,J){if(R.call(this,_?_.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,_){var ge=this.type=_.type,et=_.changedTouches&&_.changedTouches.length?_.changedTouches[0]:null;if(this.target=_.target||_.srcElement,this.g=J,J=_.relatedTarget){if(I){e:{try{w(J.nodeName);var Ht=!0;break e}catch{}Ht=!1}Ht||(J=null)}}else ge=="mouseover"?J=_.fromElement:ge=="mouseout"&&(J=_.toElement);this.relatedTarget=J,et?(this.clientX=et.clientX!==void 0?et.clientX:et.pageX,this.clientY=et.clientY!==void 0?et.clientY:et.pageY,this.screenX=et.screenX||0,this.screenY=et.screenY||0):(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0),this.button=_.button,this.key=_.key||"",this.ctrlKey=_.ctrlKey,this.altKey=_.altKey,this.shiftKey=_.shiftKey,this.metaKey=_.metaKey,this.pointerId=_.pointerId||0,this.pointerType=typeof _.pointerType=="string"?_.pointerType:K[_.pointerType]||"",this.state=_.state,this.i=_,_.defaultPrevented&&M.aa.h.call(this)}}m(M,R);var K={2:"touch",3:"pen",4:"mouse"};M.prototype.h=function(){M.aa.h.call(this);var _=this.i;_.preventDefault?_.preventDefault():_.returnValue=!1};var Y="closure_listenable_"+(1e6*Math.random()|0),D=0;function V(_,J,ge,et,Ht){this.listener=_,this.proxy=null,this.src=J,this.type=ge,this.capture=!!et,this.ha=Ht,this.key=++D,this.da=this.fa=!1}function te(_){_.da=!0,_.listener=null,_.proxy=null,_.src=null,_.ha=null}function ve(_){this.src=_,this.g={},this.h=0}ve.prototype.add=function(_,J,ge,et,Ht){var er=_.toString();_=this.g[er],_||(_=this.g[er]=[],this.h++);var qr=Xe(_,J,et,Ht);return-1<qr?(J=_[qr],ge||(J.fa=!1)):(J=new V(J,this.src,er,!!et,Ht),J.fa=ge,_.push(J)),J};function Q(_,J){var ge=J.type;if(ge in _.g){var et=_.g[ge],Ht=Array.prototype.indexOf.call(et,J,void 0),er;(er=0<=Ht)&&Array.prototype.splice.call(et,Ht,1),er&&(te(J),_.g[ge].length==0&&(delete _.g[ge],_.h--))}}function Xe(_,J,ge,et){for(var Ht=0;Ht<_.length;++Ht){var er=_[Ht];if(!er.da&&er.listener==J&&er.capture==!!ge&&er.ha==et)return Ht}return-1}var se="closure_lm_"+(1e6*Math.random()|0),Z={};function ke(_,J,ge,et,Ht){if(Array.isArray(J)){for(var er=0;er<J.length;er++)ke(_,J[er],ge,et,Ht);return null}return ge=Rt(ge),_&&_[Y]?_.K(J,ge,d(et)?!!et.capture:!1,Ht):Se(_,J,ge,!1,et,Ht)}function Se(_,J,ge,et,Ht,er){if(!J)throw Error("Invalid event type");var qr=d(Ht)?!!Ht.capture:!!Ht,Pa=Tt(_);if(Pa||(_[se]=Pa=new ve(_)),ge=Pa.add(J,ge,et,qr,er),ge.proxy)return ge;if(et=Ee(),ge.proxy=et,et.src=_,et.listener=ge,_.addEventListener)G||(Ht=qr),Ht===void 0&&(Ht=!1),_.addEventListener(J.toString(),et,Ht);else if(_.attachEvent)_.attachEvent(vt(J.toString()),et);else if(_.addListener&&_.removeListener)_.addListener(et);else throw Error("addEventListener and attachEvent are unavailable.");return ge}function Ee(){function _(ge){return J.call(_.src,_.listener,ge)}const J=_t;return _}function Ze(_,J,ge,et,Ht){if(Array.isArray(J))for(var er=0;er<J.length;er++)Ze(_,J[er],ge,et,Ht);else et=d(et)?!!et.capture:!!et,ge=Rt(ge),_&&_[Y]?(_=_.i,J=String(J).toString(),J in _.g&&(er=_.g[J],ge=Xe(er,ge,et,Ht),-1<ge&&(te(er[ge]),Array.prototype.splice.call(er,ge,1),er.length==0&&(delete _.g[J],_.h--)))):_&&(_=Tt(_))&&(J=_.g[J.toString()],_=-1,J&&(_=Xe(J,ge,et,Ht)),(ge=-1<_?J[_]:null)&&ot(ge))}function ot(_){if(typeof _!="number"&&_&&!_.da){var J=_.src;if(J&&J[Y])Q(J.i,_);else{var ge=_.type,et=_.proxy;J.removeEventListener?J.removeEventListener(ge,et,_.capture):J.detachEvent?J.detachEvent(vt(ge),et):J.addListener&&J.removeListener&&J.removeListener(et),(ge=Tt(J))?(Q(ge,_),ge.h==0&&(ge.src=null,J[se]=null)):te(_)}}}function vt(_){return _ in Z?Z[_]:Z[_]="on"+_}function _t(_,J){if(_.da)_=!0;else{J=new M(J,this);var ge=_.listener,et=_.ha||_.src;_.fa&&ot(_),_=ge.call(et,J)}return _}function Tt(_){return _=_[se],_ instanceof ve?_:null}var Lt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Rt(_){return typeof _=="function"?_:(_[Lt]||(_[Lt]=function(J){return _.handleEvent(J)}),_[Lt])}function Et(){O.call(this),this.i=new ve(this),this.M=this,this.F=null}m(Et,O),Et.prototype[Y]=!0,Et.prototype.removeEventListener=function(_,J,ge,et){Ze(this,_,J,ge,et)};function Re(_,J){var ge,et=_.F;if(et)for(ge=[];et;et=et.F)ge.push(et);if(_=_.M,et=J.type||J,typeof J=="string")J=new R(J,_);else if(J instanceof R)J.target=J.target||_;else{var Ht=J;J=new R(et,_),B(J,Ht)}if(Ht=!0,ge)for(var er=ge.length-1;0<=er;er--){var qr=J.g=ge[er];Ht=Te(qr,et,!0,J)&&Ht}if(qr=J.g=_,Ht=Te(qr,et,!0,J)&&Ht,Ht=Te(qr,et,!1,J)&&Ht,ge)for(er=0;er<ge.length;er++)qr=J.g=ge[er],Ht=Te(qr,et,!1,J)&&Ht}Et.prototype.N=function(){if(Et.aa.N.call(this),this.i){var _=this.i,J;for(J in _.g){for(var ge=_.g[J],et=0;et<ge.length;et++)te(ge[et]);delete _.g[J],_.h--}}this.F=null},Et.prototype.K=function(_,J,ge,et){return this.i.add(String(_),J,!1,ge,et)},Et.prototype.L=function(_,J,ge,et){return this.i.add(String(_),J,!0,ge,et)};function Te(_,J,ge,et){if(J=_.i.g[String(J)],!J)return!0;J=J.concat();for(var Ht=!0,er=0;er<J.length;++er){var qr=J[er];if(qr&&!qr.da&&qr.capture==ge){var Pa=qr.listener,gi=qr.ha||qr.src;qr.fa&&Q(_.i,qr),Ht=Pa.call(gi,et)!==!1&&Ht}}return Ht&&!et.defaultPrevented}function Ye(_,J,ge){if(typeof _=="function")ge&&(_=A(_,ge));else if(_&&typeof _.handleEvent=="function")_=A(_.handleEvent,_);else throw Error("Invalid listener argument");return 2147483647<Number(J)?-1:l.setTimeout(_,J||0)}function dt(_){_.g=Ye(()=>{_.g=null,_.i&&(_.i=!1,dt(_))},_.l);const J=_.h;_.h=null,_.m.apply(null,J)}class Fe extends O{constructor(J,ge){super(),this.m=J,this.l=ge,this.h=null,this.i=!1,this.g=null}j(J){this.h=arguments,this.g?this.i=!0:dt(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function je(_){O.call(this),this.h=_,this.g={}}m(je,O);var We=[];function ee(_){j(_.g,function(J,ge){this.g.hasOwnProperty(ge)&&ot(J)},_),_.g={}}je.prototype.N=function(){je.aa.N.call(this),ee(this)},je.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ve=l.JSON.stringify,rt=l.JSON.parse,$e=class{stringify(_){return l.JSON.stringify(_,void 0)}parse(_){return l.JSON.parse(_,void 0)}};function ie(){}ie.prototype.h=null;function pe(_){return _.h||(_.h=_.i())}function fe(){}var Me={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function me(){R.call(this,"d")}m(me,R);function ye(){R.call(this,"c")}m(ye,R);var mt={},gt=null;function yt(){return gt=gt||new Et}mt.La="serverreachability";function Pt(_){R.call(this,mt.La,_)}m(Pt,R);function Ft(_){const J=yt();Re(J,new Pt(J))}mt.STAT_EVENT="statevent";function Oe(_,J){R.call(this,mt.STAT_EVENT,_),this.stat=J}m(Oe,R);function be(_){const J=yt();Re(J,new Oe(J,_))}mt.Ma="timingevent";function Ae(_,J){R.call(this,mt.Ma,_),this.size=J}m(Ae,R);function Le(_,J){if(typeof _!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){_()},J)}function ut(){this.g=!0}ut.prototype.xa=function(){this.g=!1};function ct(_,J,ge,et,Ht,er){_.info(function(){if(_.g)if(er)for(var qr="",Pa=er.split("&"),gi=0;gi<Pa.length;gi++){var ya=Pa[gi].split("=");if(1<ya.length){var Ha=ya[0];ya=ya[1];var ks=Ha.split("_");qr=2<=ks.length&&ks[1]=="type"?qr+(Ha+"="+ya+"&"):qr+(Ha+"=redacted&")}}else qr=null;else qr=er;return"XMLHTTP REQ ("+et+") [attempt "+Ht+"]: "+J+`
`+ge+`
`+qr})}function st(_,J,ge,et,Ht,er,qr){_.info(function(){return"XMLHTTP RESP ("+et+") [ attempt "+Ht+"]: "+J+`
`+ge+`
`+er+" "+qr})}function z(_,J,ge,et){_.info(function(){return"XMLHTTP TEXT ("+J+"): "+re(_,ge)+(et?" "+et:"")})}function X(_,J){_.info(function(){return"TIMEOUT: "+J})}ut.prototype.info=function(){};function re(_,J){if(!_.g)return J;if(!J)return null;try{var ge=JSON.parse(J);if(ge){for(_=0;_<ge.length;_++)if(Array.isArray(ge[_])){var et=ge[_];if(!(2>et.length)){var Ht=et[1];if(Array.isArray(Ht)&&!(1>Ht.length)){var er=Ht[0];if(er!="noop"&&er!="stop"&&er!="close")for(var qr=1;qr<Ht.length;qr++)Ht[qr]=""}}}}return Ve(ge)}catch{return J}}var H={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},L={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ue;function Pe(){}m(Pe,ie),Pe.prototype.g=function(){return new XMLHttpRequest},Pe.prototype.i=function(){return{}},ue=new Pe;function xe(_,J,ge,et){this.j=_,this.i=J,this.l=ge,this.R=et||1,this.U=new je(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ge}function Ge(){this.i=null,this.g="",this.h=!1}var ze={},Ke={};function pt(_,J,ge){_.L=1,_.v=$t(Er(J)),_.m=ge,_.P=!0,ne(_,null)}function ne(_,J){_.F=Date.now(),nt(_),_.A=Er(_.v);var ge=_.A,et=_.R;Array.isArray(et)||(et=[String(et)]),St(ge.i,"t",et),_.C=0,ge=_.j.J,_.h=new Ge,_.g=ti(_.j,ge?J:null,!_.m),0<_.O&&(_.M=new Fe(A(_.Y,_,_.g),_.O)),J=_.U,ge=_.g,et=_.ca;var Ht="readystatechange";Array.isArray(Ht)||(Ht&&(We[0]=Ht.toString()),Ht=We);for(var er=0;er<Ht.length;er++){var qr=ke(ge,Ht[er],et||J.handleEvent,!1,J.h||J);if(!qr)break;J.g[qr.key]=qr}J=_.H?S(_.H):{},_.m?(_.u||(_.u="POST"),J["Content-Type"]="application/x-www-form-urlencoded",_.g.ea(_.A,_.u,_.m,J)):(_.u="GET",_.g.ea(_.A,_.u,null,J)),Ft(),ct(_.i,_.u,_.A,_.l,_.R,_.m)}xe.prototype.ca=function(_){_=_.target;const J=this.M;J&&aa(_)==3?J.j():this.Y(_)},xe.prototype.Y=function(_){try{if(_==this.g)e:{const ks=aa(this.g);var J=this.g.Ba();const vd=this.g.Z();if(!(3>ks)&&(ks!=3||this.g&&(this.h.h||this.g.oa()||Wa(this.g)))){this.J||ks!=4||J==7||(J==8||0>=vd?Ft(3):Ft(2)),Bt(this);var ge=this.g.Z();this.X=ge;t:if(Ue(this)){var et=Wa(this.g);_="";var Ht=et.length,er=aa(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Or(this),tr(this);var qr="";break t}this.h.i=new l.TextDecoder}for(J=0;J<Ht;J++)this.h.h=!0,_+=this.h.i.decode(et[J],{stream:!(er&&J==Ht-1)});et.length=0,this.h.g+=_,this.C=0,qr=this.h.g}else qr=this.g.oa();if(this.o=ge==200,st(this.i,this.u,this.A,this.l,this.R,ks,ge),this.o){if(this.T&&!this.K){t:{if(this.g){var Pa,gi=this.g;if((Pa=gi.g?gi.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(Pa)){var ya=Pa;break t}}ya=null}if(ge=ya)z(this.i,this.l,ge,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,zr(this,ge);else{this.o=!1,this.s=3,be(12),Or(this),tr(this);break e}}if(this.P){ge=!0;let ql;for(;!this.J&&this.C<qr.length;)if(ql=tt(this,qr),ql==Ke){ks==4&&(this.s=4,be(14),ge=!1),z(this.i,this.l,null,"[Incomplete Response]");break}else if(ql==ze){this.s=4,be(15),z(this.i,this.l,qr,"[Invalid Chunk]"),ge=!1;break}else z(this.i,this.l,ql,null),zr(this,ql);if(Ue(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ks!=4||qr.length!=0||this.h.h||(this.s=1,be(16),ge=!1),this.o=this.o&&ge,!ge)z(this.i,this.l,qr,"[Invalid Chunked Response]"),Or(this),tr(this);else if(0<qr.length&&!this.W){this.W=!0;var Ha=this.j;Ha.g==this&&Ha.ba&&!Ha.M&&(Ha.j.info("Great, no buffering proxy detected. Bytes received: "+qr.length),fn(Ha),Ha.M=!0,be(11))}}else z(this.i,this.l,qr,null),zr(this,qr);ks==4&&Or(this),this.o&&!this.J&&(ks==4?Xn(this.j,this):(this.o=!1,nt(this)))}else Zo(this.g),ge==400&&0<qr.indexOf("Unknown SID")?(this.s=3,be(12)):(this.s=0,be(13)),Or(this),tr(this)}}}catch{}finally{}};function Ue(_){return _.g?_.u=="GET"&&_.L!=2&&_.j.Ca:!1}function tt(_,J){var ge=_.C,et=J.indexOf(`
`,ge);return et==-1?Ke:(ge=Number(J.substring(ge,et)),isNaN(ge)?ze:(et+=1,et+ge>J.length?Ke:(J=J.slice(et,et+ge),_.C=et+ge,J)))}xe.prototype.cancel=function(){this.J=!0,Or(this)};function nt(_){_.S=Date.now()+_.I,wt(_,_.I)}function wt(_,J){if(_.B!=null)throw Error("WatchDog timer not null");_.B=Le(A(_.ba,_),J)}function Bt(_){_.B&&(l.clearTimeout(_.B),_.B=null)}xe.prototype.ba=function(){this.B=null;const _=Date.now();0<=_-this.S?(X(this.i,this.A),this.L!=2&&(Ft(),be(17)),Or(this),this.s=2,tr(this)):wt(this,this.S-_)};function tr(_){_.j.G==0||_.J||Xn(_.j,_)}function Or(_){Bt(_);var J=_.M;J&&typeof J.ma=="function"&&J.ma(),_.M=null,ee(_.U),_.g&&(J=_.g,_.g=null,J.abort(),J.ma())}function zr(_,J){try{var ge=_.j;if(ge.G!=0&&(ge.g==_||kr(ge.h,_))){if(!_.K&&kr(ge.h,_)&&ge.G==3){try{var et=ge.Da.g.parse(J)}catch{et=null}if(Array.isArray(et)&&et.length==3){var Ht=et;if(Ht[0]==0){e:if(!ge.u){if(ge.g)if(ge.g.F+3e3<_.F)Un(ge),ea(ge);else break e;jr(ge),be(18)}}else ge.za=Ht[1],0<ge.za-ge.T&&37500>Ht[2]&&ge.F&&ge.v==0&&!ge.C&&(ge.C=Le(A(ge.Za,ge),6e3));if(1>=mn(ge.h)&&ge.ca){try{ge.ca()}catch{}ge.ca=void 0}}else Ea(ge,11)}else if((_.K||ge.g==_)&&Un(ge),!y(J))for(Ht=ge.Da.g.parse(J),J=0;J<Ht.length;J++){let ya=Ht[J];if(ge.T=ya[0],ya=ya[1],ge.G==2)if(ya[0]=="c"){ge.K=ya[1],ge.ia=ya[2];const Ha=ya[3];Ha!=null&&(ge.la=Ha,ge.j.info("VER="+ge.la));const ks=ya[4];ks!=null&&(ge.Aa=ks,ge.j.info("SVER="+ge.Aa));const vd=ya[5];vd!=null&&typeof vd=="number"&&0<vd&&(et=1.5*vd,ge.L=et,ge.j.info("backChannelRequestTimeoutMs_="+et)),et=ge;const ql=_.g;if(ql){const bl=ql.g?ql.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(bl){var er=et.h;er.g||bl.indexOf("spdy")==-1&&bl.indexOf("quic")==-1&&bl.indexOf("h2")==-1||(er.j=er.l,er.g=new Set,er.h&&(Qe(er,er.h),er.h=null))}if(et.D){const Wu=ql.g?ql.g.getResponseHeader("X-HTTP-Session-Id"):null;Wu&&(et.ya=Wu,nr(et.I,et.D,Wu))}}ge.G=3,ge.l&&ge.l.ua(),ge.ba&&(ge.R=Date.now()-_.F,ge.j.info("Handshake RTT: "+ge.R+"ms")),et=ge;var qr=_;if(et.qa=Va(et,et.J?et.ia:null,et.W),qr.K){jt(et.h,qr);var Pa=qr,gi=et.L;gi&&(Pa.I=gi),Pa.B&&(Bt(Pa),nt(Pa)),et.g=qr}else cr(et);0<ge.i.length&&U(ge)}else ya[0]!="stop"&&ya[0]!="close"||Ea(ge,7);else ge.G==3&&(ya[0]=="stop"||ya[0]=="close"?ya[0]=="stop"?Ea(ge,7):Cc(ge):ya[0]!="noop"&&ge.l&&ge.l.ta(ya),ge.v=0)}}Ft(4)}catch{}}var ur=class{constructor(_,J){this.g=_,this.map=J}};function Dr(_){this.l=_||10,l.PerformanceNavigationTiming?(_=l.performance.getEntriesByType("navigation"),_=0<_.length&&(_[0].nextHopProtocol=="hq"||_[0].nextHopProtocol=="h2")):_=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=_?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function dn(_){return _.h?!0:_.g?_.g.size>=_.j:!1}function mn(_){return _.h?1:_.g?_.g.size:0}function kr(_,J){return _.h?_.h==J:_.g?_.g.has(J):!1}function Qe(_,J){_.g?_.g.add(J):_.h=J}function jt(_,J){_.h&&_.h==J?_.h=null:_.g&&_.g.has(J)&&_.g.delete(J)}Dr.prototype.cancel=function(){if(this.i=wr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const _ of this.g.values())_.cancel();this.g.clear()}};function wr(_){if(_.h!=null)return _.i.concat(_.h.D);if(_.g!=null&&_.g.size!==0){let J=_.i;for(const ge of _.g.values())J=J.concat(ge.D);return J}return p(_.i)}function ln(_){if(_.V&&typeof _.V=="function")return _.V();if(typeof Map<"u"&&_ instanceof Map||typeof Set<"u"&&_ instanceof Set)return Array.from(_.values());if(typeof _=="string")return _.split("");if(c(_)){for(var J=[],ge=_.length,et=0;et<ge;et++)J.push(_[et]);return J}J=[],ge=0;for(et in _)J[ge++]=_[et];return J}function cn(_){if(_.na&&typeof _.na=="function")return _.na();if(!_.V||typeof _.V!="function"){if(typeof Map<"u"&&_ instanceof Map)return Array.from(_.keys());if(!(typeof Set<"u"&&_ instanceof Set)){if(c(_)||typeof _=="string"){var J=[];_=_.length;for(var ge=0;ge<_;ge++)J.push(ge);return J}J=[],ge=0;for(const et in _)J[ge++]=et;return J}}}function _r(_,J){if(_.forEach&&typeof _.forEach=="function")_.forEach(J,void 0);else if(c(_)||typeof _=="string")Array.prototype.forEach.call(_,J,void 0);else for(var ge=cn(_),et=ln(_),Ht=et.length,er=0;er<Ht;er++)J.call(void 0,et[er],ge&&ge[er],_)}var Jt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ir(_,J){if(_){_=_.split("&");for(var ge=0;ge<_.length;ge++){var et=_[ge].indexOf("="),Ht=null;if(0<=et){var er=_[ge].substring(0,et);Ht=_[ge].substring(et+1)}else er=_[ge];J(er,Ht?decodeURIComponent(Ht.replace(/\+/g," ")):"")}}}function Fr(_){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,_ instanceof Fr){this.h=_.h,Lr(this,_.j),this.o=_.o,this.g=_.g,Ln(this,_.s),this.l=_.l;var J=_.i,ge=new rr;ge.i=J.i,J.g&&(ge.g=new Map(J.g),ge.h=J.h),Nt(this,ge),this.m=_.m}else _&&(J=String(_).match(Jt))?(this.h=!1,Lr(this,J[1]||"",!0),this.o=Mt(J[2]||""),this.g=Mt(J[3]||"",!0),Ln(this,J[4]),this.l=Mt(J[5]||"",!0),Nt(this,J[6]||"",!0),this.m=Mt(J[7]||"")):(this.h=!1,this.i=new rr(null,this.h))}Fr.prototype.toString=function(){var _=[],J=this.j;J&&_.push(Be(J,Vt,!0),":");var ge=this.g;return(ge||J=="file")&&(_.push("//"),(J=this.o)&&_.push(Be(J,Vt,!0),"@"),_.push(encodeURIComponent(String(ge)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),ge=this.s,ge!=null&&_.push(":",String(ge))),(ge=this.l)&&(this.g&&ge.charAt(0)!="/"&&_.push("/"),_.push(Be(ge,ge.charAt(0)=="/"?qt:Ot,!0))),(ge=this.i.toString())&&_.push("?",ge),(ge=this.m)&&_.push("#",Be(ge,vr)),_.join("")};function Er(_){return new Fr(_)}function Lr(_,J,ge){_.j=ge?Mt(J,!0):J,_.j&&(_.j=_.j.replace(/:$/,""))}function Ln(_,J){if(J){if(J=Number(J),isNaN(J)||0>J)throw Error("Bad port number "+J);_.s=J}else _.s=null}function Nt(_,J,ge){J instanceof rr?(_.i=J,fr(_.i,_.h)):(ge||(J=Be(J,sr)),_.i=new rr(J,_.h))}function nr(_,J,ge){_.i.set(J,ge)}function $t(_){return nr(_,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),_}function Mt(_,J){return _?J?decodeURI(_.replace(/%25/g,"%2525")):decodeURIComponent(_):""}function Be(_,J,ge){return typeof _=="string"?(_=encodeURI(_).replace(J,It),ge&&(_=_.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_):null}function It(_){return _=_.charCodeAt(0),"%"+(_>>4&15).toString(16)+(_&15).toString(16)}var Vt=/[#\/\?@]/g,Ot=/[#\?:]/g,qt=/[#\?]/g,sr=/[#\?@]/g,vr=/#/g;function rr(_,J){this.h=this.g=null,this.i=_||null,this.j=!!J}function dr(_){_.g||(_.g=new Map,_.h=0,_.i&&ir(_.i,function(J,ge){_.add(decodeURIComponent(J.replace(/\+/g," ")),ge)}))}t=rr.prototype,t.add=function(_,J){dr(this),this.i=null,_=Ct(this,_);var ge=this.g.get(_);return ge||this.g.set(_,ge=[]),ge.push(J),this.h+=1,this};function we(_,J){dr(_),J=Ct(_,J),_.g.has(J)&&(_.i=null,_.h-=_.g.get(J).length,_.g.delete(J))}function ft(_,J){return dr(_),J=Ct(_,J),_.g.has(J)}t.forEach=function(_,J){dr(this),this.g.forEach(function(ge,et){ge.forEach(function(Ht){_.call(J,Ht,et,this)},this)},this)},t.na=function(){dr(this);const _=Array.from(this.g.values()),J=Array.from(this.g.keys()),ge=[];for(let et=0;et<J.length;et++){const Ht=_[et];for(let er=0;er<Ht.length;er++)ge.push(J[et])}return ge},t.V=function(_){dr(this);let J=[];if(typeof _=="string")ft(this,_)&&(J=J.concat(this.g.get(Ct(this,_))));else{_=Array.from(this.g.values());for(let ge=0;ge<_.length;ge++)J=J.concat(_[ge])}return J},t.set=function(_,J){return dr(this),this.i=null,_=Ct(this,_),ft(this,_)&&(this.h-=this.g.get(_).length),this.g.set(_,[J]),this.h+=1,this},t.get=function(_,J){return _?(_=this.V(_),0<_.length?String(_[0]):J):J};function St(_,J,ge){we(_,J),0<ge.length&&(_.i=null,_.g.set(Ct(_,J),p(ge)),_.h+=ge.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const _=[],J=Array.from(this.g.keys());for(var ge=0;ge<J.length;ge++){var et=J[ge];const er=encodeURIComponent(String(et)),qr=this.V(et);for(et=0;et<qr.length;et++){var Ht=er;qr[et]!==""&&(Ht+="="+encodeURIComponent(String(qr[et]))),_.push(Ht)}}return this.i=_.join("&")};function Ct(_,J){return J=String(J),_.j&&(J=J.toLowerCase()),J}function fr(_,J){J&&!_.j&&(dr(_),_.i=null,_.g.forEach(function(ge,et){var Ht=et.toLowerCase();et!=Ht&&(we(this,et),St(this,Ht,ge))},_)),_.j=J}function or(_,J){const ge=new ut;if(l.Image){const et=new Image;et.onload=h(br,ge,"TestLoadImage: loaded",!0,J,et),et.onerror=h(br,ge,"TestLoadImage: error",!1,J,et),et.onabort=h(br,ge,"TestLoadImage: abort",!1,J,et),et.ontimeout=h(br,ge,"TestLoadImage: timeout",!1,J,et),l.setTimeout(function(){et.ontimeout&&et.ontimeout()},1e4),et.src=_}else J(!1)}function Hr(_,J){const ge=new ut,et=new AbortController,Ht=setTimeout(()=>{et.abort(),br(ge,"TestPingServer: timeout",!1,J)},1e4);fetch(_,{signal:et.signal}).then(er=>{clearTimeout(Ht),er.ok?br(ge,"TestPingServer: ok",!0,J):br(ge,"TestPingServer: server error",!1,J)}).catch(()=>{clearTimeout(Ht),br(ge,"TestPingServer: error",!1,J)})}function br(_,J,ge,et,Ht){try{Ht&&(Ht.onload=null,Ht.onerror=null,Ht.onabort=null,Ht.ontimeout=null),et(ge)}catch{}}function hr(){this.g=new $e}function Ir(_,J,ge){const et=ge||"";try{_r(_,function(Ht,er){let qr=Ht;d(Ht)&&(qr=Ve(Ht)),J.push(et+er+"="+encodeURIComponent(qr))})}catch(Ht){throw J.push(et+"type="+encodeURIComponent("_badmap")),Ht}}function en(_){this.l=_.Ub||null,this.j=_.eb||!1}m(en,ie),en.prototype.g=function(){return new sn(this.l,this.j)},en.prototype.i=function(_){return function(){return _}}({});function sn(_,J){Et.call(this),this.D=_,this.o=J,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}m(sn,Et),t=sn.prototype,t.open=function(_,J){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=_,this.A=J,this.readyState=1,wn(this)},t.send=function(_){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const J={headers:this.u,method:this.B,credentials:this.m,cache:void 0};_&&(J.body=_),(this.D||l).fetch(new Request(this.A,J)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Zn(this)),this.readyState=0},t.Sa=function(_){if(this.g&&(this.l=_,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=_.headers,this.readyState=2,wn(this)),this.g&&(this.readyState=3,wn(this),this.g)))if(this.responseType==="arraybuffer")_.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in _){if(this.j=_.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;da(this)}else _.text().then(this.Ra.bind(this),this.ga.bind(this))};function da(_){_.j.read().then(_.Pa.bind(_)).catch(_.ga.bind(_))}t.Pa=function(_){if(this.g){if(this.o&&_.value)this.response.push(_.value);else if(!this.o){var J=_.value?_.value:new Uint8Array(0);(J=this.v.decode(J,{stream:!_.done}))&&(this.response=this.responseText+=J)}_.done?Zn(this):wn(this),this.readyState==3&&da(this)}},t.Ra=function(_){this.g&&(this.response=this.responseText=_,Zn(this))},t.Qa=function(_){this.g&&(this.response=_,Zn(this))},t.ga=function(){this.g&&Zn(this)};function Zn(_){_.readyState=4,_.l=null,_.j=null,_.v=null,wn(_)}t.setRequestHeader=function(_,J){this.u.append(_,J)},t.getResponseHeader=function(_){return this.h&&this.h.get(_.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const _=[],J=this.h.entries();for(var ge=J.next();!ge.done;)ge=ge.value,_.push(ge[0]+": "+ge[1]),ge=J.next();return _.join(`\r
`)};function wn(_){_.onreadystatechange&&_.onreadystatechange.call(_)}Object.defineProperty(sn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(_){this.m=_?"include":"same-origin"}});function rn(_){let J="";return j(_,function(ge,et){J+=et,J+=":",J+=ge,J+=`\r
`}),J}function pr(_,J,ge){e:{for(et in ge){var et=!1;break e}et=!0}et||(ge=rn(ge),typeof _=="string"?ge!=null&&encodeURIComponent(String(ge)):nr(_,J,ge))}function Sr(_){Et.call(this),this.headers=new Map,this.o=_||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}m(Sr,Et);var Hn=/^https?$/i,$r=["POST","PUT"];t=Sr.prototype,t.Ha=function(_){this.J=_},t.ea=function(_,J,ge,et){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+_);J=J?J.toUpperCase():"GET",this.D=_,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ue.g(),this.v=this.o?pe(this.o):pe(ue),this.g.onreadystatechange=A(this.Ea,this);try{this.B=!0,this.g.open(J,String(_),!0),this.B=!1}catch(er){Pr(this,er);return}if(_=ge||"",ge=new Map(this.headers),et)if(Object.getPrototypeOf(et)===Object.prototype)for(var Ht in et)ge.set(Ht,et[Ht]);else if(typeof et.keys=="function"&&typeof et.get=="function")for(const er of et.keys())ge.set(er,et.get(er));else throw Error("Unknown input type for opt_headers: "+String(et));et=Array.from(ge.keys()).find(er=>er.toLowerCase()=="content-type"),Ht=l.FormData&&_ instanceof l.FormData,!(0<=Array.prototype.indexOf.call($r,J,void 0))||et||Ht||ge.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[er,qr]of ge)this.g.setRequestHeader(er,qr);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Fn(this),this.u=!0,this.g.send(_),this.u=!1}catch(er){Pr(this,er)}};function Pr(_,J){_.h=!1,_.g&&(_.j=!0,_.g.abort(),_.j=!1),_.l=J,_.m=5,Gr(_),Nn(_)}function Gr(_){_.A||(_.A=!0,Re(_,"complete"),Re(_,"error"))}t.abort=function(_){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=_||7,Re(this,"complete"),Re(this,"abort"),Nn(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Nn(this,!0)),Sr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?$n(this):this.bb())},t.bb=function(){$n(this)};function $n(_){if(_.h&&typeof o<"u"&&(!_.v[1]||aa(_)!=4||_.Z()!=2)){if(_.u&&aa(_)==4)Ye(_.Ea,0,_);else if(Re(_,"readystatechange"),aa(_)==4){_.h=!1;try{const qr=_.Z();e:switch(qr){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var J=!0;break e;default:J=!1}var ge;if(!(ge=J)){var et;if(et=qr===0){var Ht=String(_.D).match(Jt)[1]||null;!Ht&&l.self&&l.self.location&&(Ht=l.self.location.protocol.slice(0,-1)),et=!Hn.test(Ht?Ht.toLowerCase():"")}ge=et}if(ge)Re(_,"complete"),Re(_,"success");else{_.m=6;try{var er=2<aa(_)?_.g.statusText:""}catch{er=""}_.l=er+" ["+_.Z()+"]",Gr(_)}}finally{Nn(_)}}}}function Nn(_,J){if(_.g){Fn(_);const ge=_.g,et=_.v[0]?()=>{}:null;_.g=null,_.v=null,J||Re(_,"ready");try{ge.onreadystatechange=et}catch{}}}function Fn(_){_.I&&(l.clearTimeout(_.I),_.I=null)}t.isActive=function(){return!!this.g};function aa(_){return _.g?_.g.readyState:0}t.Z=function(){try{return 2<aa(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(_){if(this.g){var J=this.g.responseText;return _&&J.indexOf(_)==0&&(J=J.substring(_.length)),rt(J)}};function Wa(_){try{if(!_.g)return null;if("response"in _.g)return _.g.response;switch(_.H){case"":case"text":return _.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in _.g)return _.g.mozResponseArrayBuffer}return null}catch{return null}}function Zo(_){const J={};_=(_.g&&2<=aa(_)&&_.g.getAllResponseHeaders()||"").split(`\r
`);for(let et=0;et<_.length;et++){if(y(_[et]))continue;var ge=k(_[et]);const Ht=ge[0];if(ge=ge[1],typeof ge!="string")continue;ge=ge.trim();const er=J[Ht]||[];J[Ht]=er,er.push(ge)}N(J,function(et){return et.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ki(_,J,ge){return ge&&ge.internalChannelParams&&ge.internalChannelParams[_]||J}function el(_){this.Aa=0,this.i=[],this.j=new ut,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ki("failFast",!1,_),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ki("baseRetryDelayMs",5e3,_),this.cb=ki("retryDelaySeedMs",1e4,_),this.Wa=ki("forwardChannelMaxRetries",2,_),this.wa=ki("forwardChannelRequestTimeoutMs",2e4,_),this.pa=_&&_.xmlHttpFactory||void 0,this.Xa=_&&_.Tb||void 0,this.Ca=_&&_.useFetchStreams||!1,this.L=void 0,this.J=_&&_.supportsCrossDomainXhr||!1,this.K="",this.h=new Dr(_&&_.concurrentRequestLimit),this.Da=new hr,this.P=_&&_.fastHandshake||!1,this.O=_&&_.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=_&&_.Rb||!1,_&&_.xa&&this.j.xa(),_&&_.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&_&&_.detectBufferingProxy||!1,this.ja=void 0,_&&_.longPollingTimeout&&0<_.longPollingTimeout&&(this.ja=_.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=el.prototype,t.la=8,t.G=1,t.connect=function(_,J,ge,et){be(0),this.W=_,this.H=J||{},ge&&et!==void 0&&(this.H.OSID=ge,this.H.OAID=et),this.F=this.X,this.I=Va(this,null,this.W),U(this)};function Cc(_){if(zc(_),_.G==3){var J=_.U++,ge=Er(_.I);if(nr(ge,"SID",_.K),nr(ge,"RID",J),nr(ge,"TYPE","terminate"),bt(_,ge),J=new xe(_,_.j,J),J.L=2,J.v=$t(Er(ge)),ge=!1,l.navigator&&l.navigator.sendBeacon)try{ge=l.navigator.sendBeacon(J.v.toString(),"")}catch{}!ge&&l.Image&&(new Image().src=J.v,ge=!0),ge||(J.g=ti(J.j,null),J.g.ea(J.v)),J.F=Date.now(),nt(J)}Da(_)}function ea(_){_.g&&(fn(_),_.g.cancel(),_.g=null)}function zc(_){ea(_),_.u&&(l.clearTimeout(_.u),_.u=null),Un(_),_.h.cancel(),_.s&&(typeof _.s=="number"&&l.clearTimeout(_.s),_.s=null)}function U(_){if(!dn(_.h)&&!_.s){_.s=!0;var J=_.Ga;le||Ce(),he||(le(),he=!0),ae.add(J,_),_.B=0}}function _e(_,J){return mn(_.h)>=_.h.j-(_.s?1:0)?!1:_.s?(_.i=J.D.concat(_.i),!0):_.G==1||_.G==2||_.B>=(_.Va?0:_.Wa)?!1:(_.s=Le(A(_.Ga,_,J),oa(_,_.B)),_.B++,!0)}t.Ga=function(_){if(this.s)if(this.s=null,this.G==1){if(!_){this.U=Math.floor(1e5*Math.random()),_=this.U++;const Ht=new xe(this,this.j,_);let er=this.o;if(this.S&&(er?(er=S(er),B(er,this.S)):er=this.S),this.m!==null||this.O||(Ht.H=er,er=null),this.P)e:{for(var J=0,ge=0;ge<this.i.length;ge++){t:{var et=this.i[ge];if("__data__"in et.map&&(et=et.map.__data__,typeof et=="string")){et=et.length;break t}et=void 0}if(et===void 0)break;if(J+=et,4096<J){J=ge;break e}if(J===4096||ge===this.i.length-1){J=ge+1;break e}}J=1e3}else J=1e3;J=Qt(this,Ht,J),ge=Er(this.I),nr(ge,"RID",_),nr(ge,"CVER",22),this.D&&nr(ge,"X-HTTP-Session-Id",this.D),bt(this,ge),er&&(this.O?J="headers="+encodeURIComponent(String(rn(er)))+"&"+J:this.m&&pr(ge,this.m,er)),Qe(this.h,Ht),this.Ua&&nr(ge,"TYPE","init"),this.P?(nr(ge,"$req",J),nr(ge,"SID","null"),Ht.T=!0,pt(Ht,ge,null)):pt(Ht,ge,J),this.G=2}}else this.G==3&&(_?it(this,_):this.i.length==0||dn(this.h)||it(this))};function it(_,J){var ge;J?ge=J.l:ge=_.U++;const et=Er(_.I);nr(et,"SID",_.K),nr(et,"RID",ge),nr(et,"AID",_.T),bt(_,et),_.m&&_.o&&pr(et,_.m,_.o),ge=new xe(_,_.j,ge,_.B+1),_.m===null&&(ge.H=_.o),J&&(_.i=J.D.concat(_.i)),J=Qt(_,ge,1e3),ge.I=Math.round(.5*_.wa)+Math.round(.5*_.wa*Math.random()),Qe(_.h,ge),pt(ge,et,J)}function bt(_,J){_.H&&j(_.H,function(ge,et){nr(J,et,ge)}),_.l&&_r({},function(ge,et){nr(J,et,ge)})}function Qt(_,J,ge){ge=Math.min(_.i.length,ge);var et=_.l?A(_.l.Na,_.l,_):null;e:{var Ht=_.i;let er=-1;for(;;){const qr=["count="+ge];er==-1?0<ge?(er=Ht[0].g,qr.push("ofs="+er)):er=0:qr.push("ofs="+er);let Pa=!0;for(let gi=0;gi<ge;gi++){let ya=Ht[gi].g;const Ha=Ht[gi].map;if(ya-=er,0>ya)er=Math.max(0,Ht[gi].g-100),Pa=!1;else try{Ir(Ha,qr,"req"+ya+"_")}catch{et&&et(Ha)}}if(Pa){et=qr.join("&");break e}}}return _=_.i.splice(0,ge),J.D=_,et}function cr(_){if(!_.g&&!_.u){_.Y=1;var J=_.Fa;le||Ce(),he||(le(),he=!0),ae.add(J,_),_.v=0}}function jr(_){return _.g||_.u||3<=_.v?!1:(_.Y++,_.u=Le(A(_.Fa,_),oa(_,_.v)),_.v++,!0)}t.Fa=function(){if(this.u=null,bn(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var _=2*this.R;this.j.info("BP detection timer enabled: "+_),this.A=Le(A(this.ab,this),_)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,be(10),ea(this),bn(this))};function fn(_){_.A!=null&&(l.clearTimeout(_.A),_.A=null)}function bn(_){_.g=new xe(_,_.j,"rpc",_.Y),_.m===null&&(_.g.H=_.o),_.g.O=0;var J=Er(_.qa);nr(J,"RID","rpc"),nr(J,"SID",_.K),nr(J,"AID",_.T),nr(J,"CI",_.F?"0":"1"),!_.F&&_.ja&&nr(J,"TO",_.ja),nr(J,"TYPE","xmlhttp"),bt(_,J),_.m&&_.o&&pr(J,_.m,_.o),_.L&&(_.g.I=_.L);var ge=_.g;_=_.ia,ge.L=1,ge.v=$t(Er(J)),ge.m=null,ge.P=!0,ne(ge,_)}t.Za=function(){this.C!=null&&(this.C=null,ea(this),jr(this),be(19))};function Un(_){_.C!=null&&(l.clearTimeout(_.C),_.C=null)}function Xn(_,J){var ge=null;if(_.g==J){Un(_),fn(_),_.g=null;var et=2}else if(kr(_.h,J))ge=J.D,jt(_.h,J),et=1;else return;if(_.G!=0){if(J.o)if(et==1){ge=J.m?J.m.length:0,J=Date.now()-J.F;var Ht=_.B;et=yt(),Re(et,new Ae(et,ge)),U(_)}else cr(_);else if(Ht=J.s,Ht==3||Ht==0&&0<J.X||!(et==1&&_e(_,J)||et==2&&jr(_)))switch(ge&&0<ge.length&&(J=_.h,J.i=J.i.concat(ge)),Ht){case 1:Ea(_,5);break;case 4:Ea(_,10);break;case 3:Ea(_,6);break;default:Ea(_,2)}}}function oa(_,J){let ge=_.Ta+Math.floor(Math.random()*_.cb);return _.isActive()||(ge*=2),ge*J}function Ea(_,J){if(_.j.info("Error code "+J),J==2){var ge=A(_.fb,_),et=_.Xa;const Ht=!et;et=new Fr(et||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Lr(et,"https"),$t(et),Ht?or(et.toString(),ge):Hr(et.toString(),ge)}else be(2);_.G=0,_.l&&_.l.sa(J),Da(_),zc(_)}t.fb=function(_){_?(this.j.info("Successfully pinged google.com"),be(2)):(this.j.info("Failed to ping google.com"),be(1))};function Da(_){if(_.G=0,_.ka=[],_.l){const J=wr(_.h);(J.length!=0||_.i.length!=0)&&(x(_.ka,J),x(_.ka,_.i),_.h.i.length=0,p(_.i),_.i.length=0),_.l.ra()}}function Va(_,J,ge){var et=ge instanceof Fr?Er(ge):new Fr(ge);if(et.g!="")J&&(et.g=J+"."+et.g),Ln(et,et.s);else{var Ht=l.location;et=Ht.protocol,J=J?J+"."+Ht.hostname:Ht.hostname,Ht=+Ht.port;var er=new Fr(null);et&&Lr(er,et),J&&(er.g=J),Ht&&Ln(er,Ht),ge&&(er.l=ge),et=er}return ge=_.D,J=_.ya,ge&&J&&nr(et,ge,J),nr(et,"VER",_.la),bt(_,et),et}function ti(_,J,ge){if(J&&!_.J)throw Error("Can't create secondary domain capable XhrIo object.");return J=_.Ca&&!_.pa?new Sr(new en({eb:ge})):new Sr(_.pa),J.Ha(_.J),J}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function as(){}t=as.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ri(){}ri.prototype.g=function(_,J){return new Qs(_,J)};function Qs(_,J){Et.call(this),this.g=new el(J),this.l=_,this.h=J&&J.messageUrlParams||null,_=J&&J.messageHeaders||null,J&&J.clientProtocolHeaderRequired&&(_?_["X-Client-Protocol"]="webchannel":_={"X-Client-Protocol":"webchannel"}),this.g.o=_,_=J&&J.initMessageHeaders||null,J&&J.messageContentType&&(_?_["X-WebChannel-Content-Type"]=J.messageContentType:_={"X-WebChannel-Content-Type":J.messageContentType}),J&&J.va&&(_?_["X-WebChannel-Client-Profile"]=J.va:_={"X-WebChannel-Client-Profile":J.va}),this.g.S=_,(_=J&&J.Sb)&&!y(_)&&(this.g.m=_),this.v=J&&J.supportsCrossDomainXhr||!1,this.u=J&&J.sendRawJson||!1,(J=J&&J.httpSessionIdParam)&&!y(J)&&(this.g.D=J,_=this.h,_!==null&&J in _&&(_=this.h,J in _&&delete _[J])),this.j=new tu(this)}m(Qs,Et),Qs.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Qs.prototype.close=function(){Cc(this.g)},Qs.prototype.o=function(_){var J=this.g;if(typeof _=="string"){var ge={};ge.__data__=_,_=ge}else this.u&&(ge={},ge.__data__=Ve(_),_=ge);J.i.push(new ur(J.Ya++,_)),J.G==3&&U(J)},Qs.prototype.N=function(){this.g.l=null,delete this.j,Cc(this.g),delete this.g,Qs.aa.N.call(this)};function Wc(_){me.call(this),_.__headers__&&(this.headers=_.__headers__,this.statusCode=_.__status__,delete _.__headers__,delete _.__status__);var J=_.__sm__;if(J){e:{for(const ge in J){_=ge;break e}_=void 0}(this.i=_)&&(_=this.i,J=J!==null&&_ in J?J[_]:void 0),this.data=J}else this.data=_}m(Wc,me);function eu(){ye.call(this),this.status=1}m(eu,ye);function tu(_){this.g=_}m(tu,as),tu.prototype.ua=function(){Re(this.g,"a")},tu.prototype.ta=function(_){Re(this.g,new Wc(_))},tu.prototype.sa=function(_){Re(this.g,new eu)},tu.prototype.ra=function(){Re(this.g,"b")},ri.prototype.createWebChannel=ri.prototype.g,Qs.prototype.send=Qs.prototype.o,Qs.prototype.open=Qs.prototype.m,Qs.prototype.close=Qs.prototype.close,WJ=function(){return new ri},zJ=function(){return yt()},qJ=mt,JB={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},H.NO_ERROR=0,H.TIMEOUT=8,H.HTTP_ERROR=6,dE=H,L.COMPLETE="complete",KJ=L,fe.EventType=Me,Me.OPEN="a",Me.CLOSE="b",Me.ERROR="c",Me.MESSAGE="d",Et.prototype.listen=Et.prototype.K,Gy=fe,Sr.prototype.listenOnce=Sr.prototype.L,Sr.prototype.getLastError=Sr.prototype.Ka,Sr.prototype.getLastErrorCode=Sr.prototype.Ba,Sr.prototype.getStatus=Sr.prototype.Z,Sr.prototype.getResponseJson=Sr.prototype.Oa,Sr.prototype.getResponseText=Sr.prototype.oa,Sr.prototype.send=Sr.prototype.ea,Sr.prototype.setWithCredentials=Sr.prototype.Ha,GJ=Sr}).apply(typeof sC<"u"?sC:typeof self<"u"?self:typeof window<"u"?window:{});const j7="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Dl.UNAUTHENTICATED=new Dl(null),Dl.GOOGLE_CREDENTIALS=new Dl("google-credentials-uid"),Dl.FIRST_PARTY=new Dl("first-party-uid"),Dl.MOCK_USER=new Dl("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let h1="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cg=new OD("@firebase/firestore");function jx(){return cg.logLevel}function Ur(t,...e){if(cg.logLevel<=ja.DEBUG){const r=e.map(JD);cg.debug(`Firestore (${h1}): ${t}`,...r)}}function Mc(t,...e){if(cg.logLevel<=ja.ERROR){const r=e.map(JD);cg.error(`Firestore (${h1}): ${t}`,...r)}}function wm(t,...e){if(cg.logLevel<=ja.WARN){const r=e.map(JD);cg.warn(`Firestore (${h1}): ${t}`,...r)}}function JD(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yn(t="Unexpected state"){const e=`FIRESTORE (${h1}) INTERNAL ASSERTION FAILED: `+t;throw Mc(e),new Error(e)}function jn(t,e){t||yn()}function Jn(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Xr extends DA{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XJ{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class YJ{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Dl.UNAUTHENTICATED))}shutdown(){}}class Wxe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Xxe{constructor(e){this.t=e,this.currentUser=Dl.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){jn(this.o===void 0);let n=this.i;const a=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let s=new wf;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new wf,e.enqueueRetryable(()=>a(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await a(this.currentUser)})},l=c=>{Ur("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Ur("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new wf)}},0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ur("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(jn(typeof n.accessToken=="string"),new XJ(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return jn(e===null||typeof e=="string"),new Dl(e)}}class Yxe{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Dl.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Jxe{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new Yxe(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Dl.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Zxe{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class eve{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){jn(this.o===void 0);const n=s=>{s.error!=null&&Ur("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,Ur("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const a=s=>{Ur("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>a(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?a(s):Ur("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(jn(typeof r.token=="string"),this.R=r.token,new Zxe(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tve(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const a=tve(40);for(let s=0;s<a.length;++s)n.length<20&&a[s]<r&&(n+=e.charAt(a[s]%e.length))}return n}}function ca(t,e){return t<e?-1:t>e?1:0}function Fv(t,e,r){return t.length===e.length&&t.every((n,a)=>r(n,e[a]))}function JJ(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Xr(xr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Xr(xr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Xr(xr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Xr(xr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Nr.fromMillis(Date.now())}static fromDate(e){return Nr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new Nr(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ca(this.nanoseconds,e.nanoseconds):ca(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Bn(e)}static min(){return new Bn(new Nr(0,0))}static max(){return new Bn(new Nr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x2{constructor(e,r,n){r===void 0?r=0:r>e.length&&yn(),n===void 0?n=e.length-r:n>e.length-r&&yn(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return x2.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof x2?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let a=0;a<n;a++){const s=e.get(a),o=r.get(a);if(s<o)return-1;if(s>o)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Ka extends x2{construct(e,r,n){return new Ka(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Xr(xr.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(a=>a.length>0))}return new Ka(r)}static emptyPath(){return new Ka([])}}const rve=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class di extends x2{construct(e,r,n){return new di(e,r,n)}static isValidIdentifier(e){return rve.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),di.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new di(["__name__"])}static fromServerFormat(e){const r=[];let n="",a=0;const s=()=>{if(n.length===0)throw new Xr(xr.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;a<e.length;){const l=e[a];if(l==="\\"){if(a+1===e.length)throw new Xr(xr.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[a+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Xr(xr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,a+=2}else l==="`"?(o=!o,a++):l!=="."||o?(n+=l,a++):(s(),a++)}if(s(),o)throw new Xr(xr.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new di(r)}static emptyPath(){return new di([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this.path=e}static fromPath(e){return new an(Ka.fromString(e))}static fromName(e){return new an(Ka.fromString(e).popFirst(5))}static empty(){return new an(Ka.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ka.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Ka.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new an(new Ka(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{constructor(e,r,n,a){this.indexId=e,this.collectionGroup=r,this.fields=n,this.indexState=a}}function ZB(t){return t.fields.find(e=>e.kind===2)}function hp(t){return t.fields.filter(e=>e.kind!==2)}hS.UNKNOWN_ID=-1;class uE{constructor(e,r){this.fieldPath=e,this.kind=r}}class v2{constructor(e,r){this.sequenceNumber=e,this.offset=r}static empty(){return new v2(0,qd.min())}}function nve(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,a=Bn.fromTimestamp(n===1e9?new Nr(r+1,0):new Nr(r,n));return new qd(a,an.empty(),e)}function ZJ(t){return new qd(t.readTime,t.key,-1)}class qd{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new qd(Bn.min(),an.empty(),-1)}static max(){return new qd(Bn.max(),an.empty(),-1)}}function e6(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=an.comparator(t.documentKey,e.documentKey),r!==0?r:ca(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eZ="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class tZ{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Og(t){if(t.code!==xr.FAILED_PRECONDITION||t.message!==eZ)throw t;Ur("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&yn(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Yt((n,a)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,a)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,a)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Yt?r:Yt.resolve(r)}catch(r){return Yt.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Yt.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Yt.reject(r)}static resolve(e){return new Yt((r,n)=>{r(e)})}static reject(e){return new Yt((r,n)=>{n(e)})}static waitFor(e){return new Yt((r,n)=>{let a=0,s=0,o=!1;e.forEach(l=>{++a,l.next(()=>{++s,o&&s===a&&r()},c=>n(c))}),o=!0,s===a&&r()})}static or(e){let r=Yt.resolve(!1);for(const n of e)r=r.next(a=>a?Yt.resolve(a):n());return r}static forEach(e,r){const n=[];return e.forEach((a,s)=>{n.push(r.call(this,a,s))}),this.waitFor(n)}static mapArray(e,r){return new Yt((n,a)=>{const s=e.length,o=new Array(s);let l=0;for(let c=0;c<s;c++){const d=c;r(e[d]).next(u=>{o[d]=u,++l,l===s&&n(o)},u=>a(u))}})}static doWhile(e,r){return new Yt((n,a)=>{const s=()=>{e()===!0?r().next(()=>{s()},a):n()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{constructor(e,r){this.action=e,this.transaction=r,this.aborted=!1,this.V=new wf,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{r.error?this.V.reject(new bb(e,r.error)):this.V.resolve()},this.transaction.onerror=n=>{const a=t6(n.target.error);this.V.reject(new bb(e,a))}}static open(e,r,n,a){try{return new II(r,e.transaction(a,n))}catch(s){throw new bb(r,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(Ur("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const r=this.transaction.objectStore(e);return new sve(r)}}class hm{constructor(e,r,n){this.name=e,this.version=r,this.p=n,hm.S(Ko())===12.2&&Mc("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Ur("SimpleDb","Removing database:",e),yp(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!sJ())return!1;if(hm.v())return!0;const e=Ko(),r=hm.S(e),n=0<r&&r<10,a=rZ(e),s=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,r){return e.store(r)}static S(e){const r=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=r?r[1].split("_").slice(0,2).join("."):"-1";return Number(n)}async M(e){return this.db||(Ur("SimpleDb","Opening database:",this.name),this.db=await new Promise((r,n)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=s=>{const o=s.target.result;r(o)},a.onblocked=()=>{n(new bb(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=s=>{const o=s.target.error;o.name==="VersionError"?n(new Xr(xr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?n(new Xr(xr.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):n(new bb(e,o))},a.onupgradeneeded=s=>{Ur("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.p.O(o,a.transaction,s.oldVersion,this.version).next(()=>{Ur("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=r=>this.N(r)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=r=>e(r))}async runTransaction(e,r,n,a){const s=r==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const l=II.open(this.db,e,s?"readonly":"readwrite",n),c=a(l).next(d=>(l.g(),d)).catch(d=>(l.abort(d),Yt.reject(d))).toPromise();return c.catch(()=>{}),await l.m,c}catch(l){const c=l,d=c.name!=="FirebaseError"&&o<3;if(Ur("SimpleDb","Transaction failed with error:",c.message,"Retrying:",d),this.close(),!d)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function rZ(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}class ave{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return yp(this.B.delete())}}class bb extends Xr{constructor(e,r){super(xr.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${r}`),this.name="IndexedDbTransactionError"}}function Vm(t){return t.name==="IndexedDbTransactionError"}class sve{constructor(e){this.store=e}put(e,r){let n;return r!==void 0?(Ur("SimpleDb","PUT",this.store.name,e,r),n=this.store.put(r,e)):(Ur("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),yp(n)}add(e){return Ur("SimpleDb","ADD",this.store.name,e,e),yp(this.store.add(e))}get(e){return yp(this.store.get(e)).next(r=>(r===void 0&&(r=null),Ur("SimpleDb","GET",this.store.name,e,r),r))}delete(e){return Ur("SimpleDb","DELETE",this.store.name,e),yp(this.store.delete(e))}count(){return Ur("SimpleDb","COUNT",this.store.name),yp(this.store.count())}U(e,r){const n=this.options(e,r),a=n.index?this.store.index(n.index):this.store;if(typeof a.getAll=="function"){const s=a.getAll(n.range);return new Yt((o,l)=>{s.onerror=c=>{l(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{const s=this.cursor(n),o=[];return this.W(s,(l,c)=>{o.push(c)}).next(()=>o)}}G(e,r){const n=this.store.getAll(e,r===null?void 0:r);return new Yt((a,s)=>{n.onerror=o=>{s(o.target.error)},n.onsuccess=o=>{a(o.target.result)}})}j(e,r){Ur("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,r);n.H=!1;const a=this.cursor(n);return this.W(a,(s,o,l)=>l.delete())}J(e,r){let n;r?n=e:(n={},r=e);const a=this.cursor(n);return this.W(a,r)}Y(e){const r=this.cursor({});return new Yt((n,a)=>{r.onerror=s=>{const o=t6(s.target.error);a(o)},r.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():n()}):n()}})}W(e,r){const n=[];return new Yt((a,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void a();const c=new ave(l),d=r(l.primaryKey,l.value,c);if(d instanceof Yt){const u=d.catch(f=>(c.done(),Yt.reject(f)));n.push(u)}c.isDone?a():c.K===null?l.continue():l.continue(c.K)}}).next(()=>Yt.waitFor(n))}options(e,r){let n;return e!==void 0&&(typeof e=="string"?n=e:r=e),{index:n,range:r}}cursor(e){let r="next";if(e.reverse&&(r="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,r):n.openCursor(e.range,r)}return this.store.openCursor(e.range,r)}}function yp(t){return new Yt((e,r)=>{t.onsuccess=n=>{const a=n.target.result;e(a)},t.onerror=n=>{const a=t6(n.target.error);r(a)}})}let I7=!1;function t6(t){const e=hm.S(Ko());if(e>=12.2&&e<13){const r="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(r)>=0){const n=new Xr("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${r}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return I7||(I7=!0,setTimeout(()=>{throw n},0)),n}}return t}class ive{constructor(e,r){this.asyncQueue=e,this.Z=r,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){Ur("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{Ur("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(r){Vm(r)?Ur("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",r):await Og(r)}await this.X(6e4)})}}class ove{constructor(e,r){this.localStore=e,this.persistence=r}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>this.te(r,e))}te(e,r){const n=new Set;let a=r,s=!0;return Yt.doWhile(()=>s===!0&&a>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!n.has(o))return Ur("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,a).next(l=>{a-=l,n.add(o)});s=!1})).next(()=>r-a)}ne(e,r,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,r).next(a=>this.localStore.localDocuments.getNextDocuments(e,r,a,n).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(a,s)).next(l=>(Ur("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,r,l))).next(()=>o.size)}))}re(e,r){let n=e;return r.changes.forEach((a,s)=>{const o=ZJ(s);e6(o,n)>0&&(n=o)}),new qd(n.readTime,n.documentKey,Math.max(r.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Su.oe=-1;function Pw(t){return t==null}function y2(t){return t===0&&1/t==-1/0}function lve(t){return typeof t=="number"&&Number.isInteger(t)&&!y2(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vc(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=P7(e)),e=cve(t.get(r),e);return P7(e)}function cve(t,e){let r=e;const n=t.length;for(let a=0;a<n;a++){const s=t.charAt(a);switch(s){case"\0":r+="";break;case"":r+="";break;default:r+=s}}return r}function P7(t){return t+""}function eh(t){const e=t.length;if(jn(e>=2),e===2)return jn(t.charAt(0)===""&&t.charAt(1)===""),Ka.emptyPath();const r=e-2,n=[];let a="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>r)&&yn(),t.charAt(o+1)){case"":const l=t.substring(s,o);let c;a.length===0?c=l:(a+=l,c=a,a=""),n.push(c);break;case"":a+=t.substring(s,o),a+="\0";break;case"":a+=t.substring(s,o+1);break;default:yn()}s=o+2}return new Ka(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T7=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fE(t,e){return[t,Vc(e)]}function nZ(t,e,r){return[t,Vc(e),r]}const dve={},uve=["prefixPath","collectionGroup","readTime","documentId"],fve=["prefixPath","collectionGroup","documentId"],hve=["collectionGroup","readTime","prefixPath","documentId"],Ave=["canonicalId","targetId"],mve=["targetId","path"],pve=["path","targetId"],gve=["collectionId","parent"],xve=["indexId","uid"],vve=["uid","sequenceNumber"],yve=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],bve=["indexId","uid","orderedDocumentKey"],wve=["userId","collectionPath","documentId"],Nve=["userId","collectionPath","largestBatchId"],Cve=["userId","collectionGroup","largestBatchId"],aZ=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],_ve=[...aZ,"documentOverlays"],sZ=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],iZ=sZ,r6=[...iZ,"indexConfiguration","indexState","indexEntries"],Eve=r6,Sve=[...r6,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek extends tZ{constructor(e,r){super(),this._e=e,this.currentSequenceNumber=r}}function zo(t,e){const r=Jn(t);return hm.F(r._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B7(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Dg(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function oZ(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e,r){this.comparator=e,this.root=r||Rl.EMPTY}insert(e,r){return new mi(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Rl.BLACK,null,null))}remove(e){return new mi(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Rl.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return r+n.left.size;a<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new iC(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new iC(this.root,e,this.comparator,!1)}getReverseIterator(){return new iC(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new iC(this.root,e,this.comparator,!0)}}class iC{constructor(e,r,n,a){this.isReverse=a,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&a&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Rl{constructor(e,r,n,a,s){this.key=e,this.value=r,this.color=n??Rl.RED,this.left=a??Rl.EMPTY,this.right=s??Rl.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,a,s){return new Rl(e??this.key,r??this.value,n??this.color,a??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let a=this;const s=n(e,a.key);return a=s<0?a.copy(null,null,null,a.left.insert(e,r,n),null):s===0?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(e,r,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Rl.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,a=this;if(r(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),r(e,a.key)===0){if(a.right.isEmpty())return Rl.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Rl.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Rl.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw yn();const e=this.left.check();if(e!==this.right.check())throw yn();return e+(this.isRed()?0:1)}}Rl.EMPTY=null,Rl.RED=!0,Rl.BLACK=!1;Rl.EMPTY=new class{constructor(){this.size=0}get key(){throw yn()}get value(){throw yn()}get color(){throw yn()}get left(){throw yn()}get right(){throw yn()}copy(e,r,n,a,s){return this}insert(e,r,n){return new Rl(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e){this.comparator=e,this.data=new mi(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;r(a.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new k7(this.data.getIterator())}getIteratorFrom(e){return new k7(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof _s)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,s=n.getNext().key;if(this.comparator(a,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new _s(this.comparator);return r.data=e,r}}class k7{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function nx(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(e){this.fields=e,e.sort(di.comparator)}static empty(){return new cd([])}unionWith(e){let r=new _s(di.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new cd(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Fv(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lZ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(a){try{return atob(a)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new lZ("Invalid base64 string: "+s):s}}(e);return new fo(r)}static fromUint8Array(e){const r=function(a){let s="";for(let o=0;o<a.length;++o)s+=String.fromCharCode(a[o]);return s}(e);return new fo(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ca(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}fo.EMPTY_BYTE_STRING=new fo("");const jve=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wA(t){if(jn(!!t),typeof t=="string"){let e=0;const r=jve.exec(t);if(jn(!!r),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:oi(t.seconds),nanos:oi(t.nanos)}}function oi(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Nm(t){return typeof t=="string"?fo.fromBase64String(t):fo.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n6(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function a6(t){const e=t.mapValue.fields.__previous_value__;return n6(e)?a6(e):e}function b2(t){const e=wA(t.mapValue.fields.__local_write_time__.timestampValue);return new Nr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ive{constructor(e,r,n,a,s,o,l,c,d){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=a,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=d}}class Cm{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Cm("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Cm&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z0={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},hE={nullValue:"NULL_VALUE"};function dg(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?n6(t)?4:cZ(t)?9007199254740991:PI(t)?10:11:yn()}function uh(t,e){if(t===e)return!0;const r=dg(t);if(r!==dg(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return b2(t).isEqual(b2(e));case 3:return function(a,s){if(typeof a.timestampValue=="string"&&typeof s.timestampValue=="string"&&a.timestampValue.length===s.timestampValue.length)return a.timestampValue===s.timestampValue;const o=wA(a.timestampValue),l=wA(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(a,s){return Nm(a.bytesValue).isEqual(Nm(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(a,s){return oi(a.geoPointValue.latitude)===oi(s.geoPointValue.latitude)&&oi(a.geoPointValue.longitude)===oi(s.geoPointValue.longitude)}(t,e);case 2:return function(a,s){if("integerValue"in a&&"integerValue"in s)return oi(a.integerValue)===oi(s.integerValue);if("doubleValue"in a&&"doubleValue"in s){const o=oi(a.doubleValue),l=oi(s.doubleValue);return o===l?y2(o)===y2(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Fv(t.arrayValue.values||[],e.arrayValue.values||[],uh);case 10:case 11:return function(a,s){const o=a.mapValue.fields||{},l=s.mapValue.fields||{};if(B7(o)!==B7(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!uh(o[c],l[c])))return!1;return!0}(t,e);default:return yn()}}function w2(t,e){return(t.values||[]).find(r=>uh(r,e))!==void 0}function _m(t,e){if(t===e)return 0;const r=dg(t),n=dg(e);if(r!==n)return ca(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return ca(t.booleanValue,e.booleanValue);case 2:return function(s,o){const l=oi(s.integerValue||s.doubleValue),c=oi(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return F7(t.timestampValue,e.timestampValue);case 4:return F7(b2(t),b2(e));case 5:return ca(t.stringValue,e.stringValue);case 6:return function(s,o){const l=Nm(s),c=Nm(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),c=o.split("/");for(let d=0;d<l.length&&d<c.length;d++){const u=ca(l[d],c[d]);if(u!==0)return u}return ca(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const l=ca(oi(s.latitude),oi(o.latitude));return l!==0?l:ca(oi(s.longitude),oi(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return O7(t.arrayValue,e.arrayValue);case 10:return function(s,o){var l,c,d,u;const f=s.fields||{},A=o.fields||{},h=(l=f.value)===null||l===void 0?void 0:l.arrayValue,m=(c=A.value)===null||c===void 0?void 0:c.arrayValue,p=ca(((d=h==null?void 0:h.values)===null||d===void 0?void 0:d.length)||0,((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0);return p!==0?p:O7(h,m)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===z0.mapValue&&o===z0.mapValue)return 0;if(s===z0.mapValue)return 1;if(o===z0.mapValue)return-1;const l=s.fields||{},c=Object.keys(l),d=o.fields||{},u=Object.keys(d);c.sort(),u.sort();for(let f=0;f<c.length&&f<u.length;++f){const A=ca(c[f],u[f]);if(A!==0)return A;const h=_m(l[c[f]],d[u[f]]);if(h!==0)return h}return ca(c.length,u.length)}(t.mapValue,e.mapValue);default:throw yn()}}function F7(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ca(t,e);const r=wA(t),n=wA(e),a=ca(r.seconds,n.seconds);return a!==0?a:ca(r.nanos,n.nanos)}function O7(t,e){const r=t.values||[],n=e.values||[];for(let a=0;a<r.length&&a<n.length;++a){const s=_m(r[a],n[a]);if(s)return s}return ca(r.length,n.length)}function Ov(t){return tk(t)}function tk(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=wA(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Nm(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return an.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",a=!0;for(const s of r.values||[])a?a=!1:n+=",",n+=tk(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let a="{",s=!0;for(const o of n)s?s=!1:a+=",",a+=`${o}:${tk(r.fields[o])}`;return a+"}"}(t.mapValue):yn()}function N2(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function rk(t){return!!t&&"integerValue"in t}function C2(t){return!!t&&"arrayValue"in t}function D7(t){return!!t&&"nullValue"in t}function R7(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function AE(t){return!!t&&"mapValue"in t}function PI(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function wb(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Dg(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=wb(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=wb(t.arrayValue.values[r]);return e}return Object.assign({},t)}function cZ(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const dZ={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function Pve(t){return"nullValue"in t?hE:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?N2(Cm.empty(),an.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?PI(t)?dZ:{mapValue:{}}:yn()}function Tve(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?N2(Cm.empty(),an.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?dZ:"mapValue"in t?PI(t)?{mapValue:{}}:z0:yn()}function M7(t,e){const r=_m(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function L7(t,e){const r=_m(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e){this.value=e}static empty(){return new Ll({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!AE(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=wb(r)}setAll(e){let r=di.emptyPath(),n={},a=[];e.forEach((o,l)=>{if(!r.isImmediateParentOf(l)){const c=this.getFieldsMap(r);this.applyChanges(c,n,a),n={},a=[],r=l.popLast()}o?n[l.lastSegment()]=wb(o):a.push(l.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,a)}delete(e){const r=this.field(e.popLast());AE(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return uh(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=r.mapValue.fields[e.get(n)];AE(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=a),r=a}return r.mapValue.fields}applyChanges(e,r,n){Dg(r,(a,s)=>e[a]=s);for(const a of n)delete e[a]}clone(){return new Ll(wb(this.value))}}function uZ(t){const e=[];return Dg(t.fields,(r,n)=>{const a=new di([r]);if(AE(n)){const s=uZ(n.mapValue).fields;if(s.length===0)e.push(a);else for(const o of s)e.push(a.child(o))}else e.push(a)}),new cd(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(e,r,n,a,s,o,l){this.key=e,this.documentType=r,this.version=n,this.readTime=a,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new ci(e,0,Bn.min(),Bn.min(),Bn.min(),Ll.empty(),0)}static newFoundDocument(e,r,n,a){return new ci(e,1,r,Bn.min(),n,a,0)}static newNoDocument(e,r){return new ci(e,2,r,Bn.min(),Bn.min(),Ll.empty(),0)}static newUnknownDocument(e,r){return new ci(e,3,r,Bn.min(),Bn.min(),Ll.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Bn.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ll.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ll.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Bn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ci&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ci(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(e,r){this.position=e,this.inclusive=r}}function U7(t,e,r){let n=0;for(let a=0;a<t.position.length;a++){const s=e[a],o=t.position[a];if(s.field.isKeyField()?n=an.comparator(an.fromName(o.referenceValue),r.key):n=_m(o,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function Q7(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!uh(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _2{constructor(e,r="asc"){this.field=e,this.dir=r}}function Bve(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fZ{}class Ia extends fZ{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new kve(e,r,n):r==="array-contains"?new Dve(e,n):r==="in"?new xZ(e,n):r==="not-in"?new Rve(e,n):r==="array-contains-any"?new Mve(e,n):new Ia(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new Fve(e,n):new Ove(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(_m(r,this.value)):r!==null&&dg(this.value)===dg(r)&&this.matchesComparison(_m(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return yn()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ps extends fZ{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new ps(e,r)}matches(e){return Rv(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Rv(t){return t.op==="and"}function nk(t){return t.op==="or"}function s6(t){return hZ(t)&&Rv(t)}function hZ(t){for(const e of t.filters)if(e instanceof ps)return!1;return!0}function ak(t){if(t instanceof Ia)return t.field.canonicalString()+t.op.toString()+Ov(t.value);if(s6(t))return t.filters.map(e=>ak(e)).join(",");{const e=t.filters.map(r=>ak(r)).join(",");return`${t.op}(${e})`}}function AZ(t,e){return t instanceof Ia?function(n,a){return a instanceof Ia&&n.op===a.op&&n.field.isEqual(a.field)&&uh(n.value,a.value)}(t,e):t instanceof ps?function(n,a){return a instanceof ps&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce((s,o,l)=>s&&AZ(o,a.filters[l]),!0):!1}(t,e):void yn()}function mZ(t,e){const r=t.filters.concat(e);return ps.create(r,t.op)}function pZ(t){return t instanceof Ia?function(r){return`${r.field.canonicalString()} ${r.op} ${Ov(r.value)}`}(t):t instanceof ps?function(r){return r.op.toString()+" {"+r.getFilters().map(pZ).join(" ,")+"}"}(t):"Filter"}class kve extends Ia{constructor(e,r,n){super(e,r,n),this.key=an.fromName(n.referenceValue)}matches(e){const r=an.comparator(e.key,this.key);return this.matchesComparison(r)}}class Fve extends Ia{constructor(e,r){super(e,"in",r),this.keys=gZ("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class Ove extends Ia{constructor(e,r){super(e,"not-in",r),this.keys=gZ("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function gZ(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>an.fromName(n.referenceValue))}class Dve extends Ia{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return C2(r)&&w2(r.arrayValue,this.value)}}class xZ extends Ia{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&w2(this.value.arrayValue,r)}}class Rve extends Ia{constructor(e,r){super(e,"not-in",r)}matches(e){if(w2(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!w2(this.value.arrayValue,r)}}class Mve extends Ia{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!C2(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>w2(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lve{constructor(e,r=null,n=[],a=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=a,this.limit=s,this.startAt=o,this.endAt=l,this.ue=null}}function sk(t,e=null,r=[],n=[],a=null,s=null,o=null){return new Lve(t,e,r,n,a,s,o)}function ug(t){const e=Jn(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>ak(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Pw(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Ov(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Ov(n)).join(",")),e.ue=r}return e.ue}function Tw(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!Bve(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!AZ(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Q7(t.startAt,e.startAt)&&Q7(t.endAt,e.endAt)}function AS(t){return an.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function mS(t,e){return t.filters.filter(r=>r instanceof Ia&&r.field.isEqual(e))}function V7(t,e,r){let n=hE,a=!0;for(const s of mS(t,e)){let o=hE,l=!0;switch(s.op){case"<":case"<=":o=Pve(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=hE}M7({value:n,inclusive:a},{value:o,inclusive:l})<0&&(n=o,a=l)}if(r!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=r.position[s];M7({value:n,inclusive:a},{value:o,inclusive:r.inclusive})<0&&(n=o,a=r.inclusive);break}}return{value:n,inclusive:a}}function H7(t,e,r){let n=z0,a=!0;for(const s of mS(t,e)){let o=z0,l=!0;switch(s.op){case">=":case">":o=Tve(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=z0}L7({value:n,inclusive:a},{value:o,inclusive:l})>0&&(n=o,a=l)}if(r!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=r.position[s];L7({value:n,inclusive:a},{value:o,inclusive:r.inclusive})>0&&(n=o,a=r.inclusive);break}}return{value:n,inclusive:a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1{constructor(e,r=null,n=[],a=[],s=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=a,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Uve(t,e,r,n,a,s,o,l){return new A1(t,e,r,n,a,s,o,l)}function Bw(t){return new A1(t)}function $7(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function vZ(t){return t.collectionGroup!==null}function Nb(t){const e=Jn(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new _s(di.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new _2(s,n))}),r.has(di.keyField().canonicalString())||e.ce.push(new _2(di.keyField(),n))}return e.ce}function ku(t){const e=Jn(t);return e.le||(e.le=Qve(e,Nb(t))),e.le}function Qve(t,e){if(t.limitType==="F")return sk(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(a=>{const s=a.dir==="desc"?"asc":"desc";return new _2(a.field,s)});const r=t.endAt?new Dv(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Dv(t.startAt.position,t.startAt.inclusive):null;return sk(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function ik(t,e){const r=t.filters.concat([e]);return new A1(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function pS(t,e,r){return new A1(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function TI(t,e){return Tw(ku(t),ku(e))&&t.limitType===e.limitType}function yZ(t){return`${ug(ku(t))}|lt:${t.limitType}`}function Ix(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(a=>pZ(a)).join(", ")}]`),Pw(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(a=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(a)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(a=>Ov(a)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(a=>Ov(a)).join(",")),`Target(${n})`}(ku(t))}; limitType=${t.limitType})`}function kw(t,e){return e.isFoundDocument()&&function(n,a){const s=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):an.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,a){for(const s of Nb(n))if(!s.field.isKeyField()&&a.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,a){for(const s of n.filters)if(!s.matches(a))return!1;return!0}(t,e)&&function(n,a){return!(n.startAt&&!function(o,l,c){const d=U7(o,l,c);return o.inclusive?d<=0:d<0}(n.startAt,Nb(n),a)||n.endAt&&!function(o,l,c){const d=U7(o,l,c);return o.inclusive?d>=0:d>0}(n.endAt,Nb(n),a))}(t,e)}function Vve(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function bZ(t){return(e,r)=>{let n=!1;for(const a of Nb(t)){const s=Hve(a,e,r);if(s!==0)return s;n=n||a.field.isKeyField()}return 0}}function Hve(t,e,r){const n=t.field.isKeyField()?an.comparator(e.key,r.key):function(s,o,l){const c=o.data.field(s),d=l.data.field(s);return c!==null&&d!==null?_m(c,d):yn()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return yn()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hm{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[a,s]of n)if(this.equalsFn(a,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<a.length;s++)if(this.equalsFn(a[s][0],e))return void(a[s]=[e,r]);a.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[r]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Dg(this.inner,(r,n)=>{for(const[a,s]of n)e(a,s)})}isEmpty(){return oZ(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $ve=new mi(an.comparator);function Ud(){return $ve}const wZ=new mi(an.comparator);function Ky(...t){let e=wZ;for(const r of t)e=e.insert(r.key,r);return e}function NZ(t){let e=wZ;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function th(){return Cb()}function CZ(){return Cb()}function Cb(){return new Hm(t=>t.toString(),(t,e)=>t.isEqual(e))}const Gve=new mi(an.comparator),Kve=new _s(an.comparator);function va(...t){let e=Kve;for(const r of t)e=e.add(r);return e}const qve=new _s(ca);function zve(){return qve}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i6(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:y2(e)?"-0":e}}function _Z(t){return{integerValue:""+t}}function Wve(t,e){return lve(e)?_Z(e):i6(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BI{constructor(){this._=void 0}}function Xve(t,e,r){return t instanceof Mv?function(a,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return s&&n6(s)&&(s=a6(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(r,e):t instanceof fg?SZ(t,e):t instanceof Lv?jZ(t,e):function(a,s){const o=EZ(a,s),l=G7(o)+G7(a.Pe);return rk(o)&&rk(a.Pe)?_Z(l):i6(a.serializer,l)}(t,e)}function Yve(t,e,r){return t instanceof fg?SZ(t,e):t instanceof Lv?jZ(t,e):r}function EZ(t,e){return t instanceof E2?function(n){return rk(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class Mv extends BI{}class fg extends BI{constructor(e){super(),this.elements=e}}function SZ(t,e){const r=IZ(e);for(const n of t.elements)r.some(a=>uh(a,n))||r.push(n);return{arrayValue:{values:r}}}class Lv extends BI{constructor(e){super(),this.elements=e}}function jZ(t,e){let r=IZ(e);for(const n of t.elements)r=r.filter(a=>!uh(a,n));return{arrayValue:{values:r}}}class E2 extends BI{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function G7(t){return oi(t.integerValue||t.doubleValue)}function IZ(t){return C2(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o6{constructor(e,r){this.field=e,this.transform=r}}function Jve(t,e){return t.field.isEqual(e.field)&&function(n,a){return n instanceof fg&&a instanceof fg||n instanceof Lv&&a instanceof Lv?Fv(n.elements,a.elements,uh):n instanceof E2&&a instanceof E2?uh(n.Pe,a.Pe):n instanceof Mv&&a instanceof Mv}(t.transform,e.transform)}class Zve{constructor(e,r){this.version=e,this.transformResults=r}}class ui{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new ui}static exists(e){return new ui(void 0,e)}static updateTime(e){return new ui(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function mE(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class kI{}function PZ(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new p1(t.key,ui.none()):new m1(t.key,t.data,ui.none());{const r=t.data,n=Ll.empty();let a=new _s(di.comparator);for(let s of e.fields)if(!a.has(s)){let o=r.field(s);o===null&&s.length>1&&(s=s.popLast(),o=r.field(s)),o===null?n.delete(s):n.set(s,o),a=a.add(s)}return new LA(t.key,n,new cd(a.toArray()),ui.none())}}function e1e(t,e,r){t instanceof m1?function(a,s,o){const l=a.value.clone(),c=q7(a.fieldTransforms,s,o.transformResults);l.setAll(c),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,r):t instanceof LA?function(a,s,o){if(!mE(a.precondition,s))return void s.convertToUnknownDocument(o.version);const l=q7(a.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(TZ(a)),c.setAll(l),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,r):function(a,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,r)}function _b(t,e,r,n){return t instanceof m1?function(s,o,l,c){if(!mE(s.precondition,o))return l;const d=s.value.clone(),u=z7(s.fieldTransforms,c,o);return d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,r,n):t instanceof LA?function(s,o,l,c){if(!mE(s.precondition,o))return l;const d=z7(s.fieldTransforms,c,o),u=o.data;return u.setAll(TZ(s)),u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,r,n):function(s,o,l){return mE(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,r)}function t1e(t,e){let r=null;for(const n of t.fieldTransforms){const a=e.data.field(n.field),s=EZ(n.transform,a||null);s!=null&&(r===null&&(r=Ll.empty()),r.set(n.field,s))}return r||null}function K7(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&Fv(n,a,(s,o)=>Jve(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class m1 extends kI{constructor(e,r,n,a=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class LA extends kI{constructor(e,r,n,a,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=a,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function TZ(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function q7(t,e,r){const n=new Map;jn(t.length===r.length);for(let a=0;a<r.length;a++){const s=t[a],o=s.transform,l=e.data.field(s.field);n.set(s.field,Yve(o,l,r[a]))}return n}function z7(t,e,r){const n=new Map;for(const a of t){const s=a.transform,o=r.data.field(a.field);n.set(a.field,Xve(s,o,e))}return n}class p1 extends kI{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class l6 extends kI{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c6{constructor(e,r,n,a){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const s=this.mutations[a];s.key.isEqual(e.key)&&e1e(s,e,n[a])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=_b(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=_b(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=CZ();return this.mutations.forEach(a=>{const s=e.get(a.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=r.has(a.key)?null:l;const c=PZ(o,l);c!==null&&n.set(a.key,c),o.isValidDocument()||o.convertToNoDocument(Bn.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),va())}isEqual(e){return this.batchId===e.batchId&&Fv(this.mutations,e.mutations,(r,n)=>K7(r,n))&&Fv(this.baseMutations,e.baseMutations,(r,n)=>K7(r,n))}}class d6{constructor(e,r,n,a){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=a}static from(e,r,n){jn(e.mutations.length===n.length);let a=function(){return Gve}();const s=e.mutations;for(let o=0;o<s.length;o++)a=a.insert(s[o].key,n[o].version);return new d6(e,r,n,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u6{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r1e{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var po,ka;function BZ(t){switch(t){default:return yn();case xr.CANCELLED:case xr.UNKNOWN:case xr.DEADLINE_EXCEEDED:case xr.RESOURCE_EXHAUSTED:case xr.INTERNAL:case xr.UNAVAILABLE:case xr.UNAUTHENTICATED:return!1;case xr.INVALID_ARGUMENT:case xr.NOT_FOUND:case xr.ALREADY_EXISTS:case xr.PERMISSION_DENIED:case xr.FAILED_PRECONDITION:case xr.ABORTED:case xr.OUT_OF_RANGE:case xr.UNIMPLEMENTED:case xr.DATA_LOSS:return!0}}function kZ(t){if(t===void 0)return Mc("GRPC error has no .code"),xr.UNKNOWN;switch(t){case po.OK:return xr.OK;case po.CANCELLED:return xr.CANCELLED;case po.UNKNOWN:return xr.UNKNOWN;case po.DEADLINE_EXCEEDED:return xr.DEADLINE_EXCEEDED;case po.RESOURCE_EXHAUSTED:return xr.RESOURCE_EXHAUSTED;case po.INTERNAL:return xr.INTERNAL;case po.UNAVAILABLE:return xr.UNAVAILABLE;case po.UNAUTHENTICATED:return xr.UNAUTHENTICATED;case po.INVALID_ARGUMENT:return xr.INVALID_ARGUMENT;case po.NOT_FOUND:return xr.NOT_FOUND;case po.ALREADY_EXISTS:return xr.ALREADY_EXISTS;case po.PERMISSION_DENIED:return xr.PERMISSION_DENIED;case po.FAILED_PRECONDITION:return xr.FAILED_PRECONDITION;case po.ABORTED:return xr.ABORTED;case po.OUT_OF_RANGE:return xr.OUT_OF_RANGE;case po.UNIMPLEMENTED:return xr.UNIMPLEMENTED;case po.DATA_LOSS:return xr.DATA_LOSS;default:return yn()}}(ka=po||(po={}))[ka.OK=0]="OK",ka[ka.CANCELLED=1]="CANCELLED",ka[ka.UNKNOWN=2]="UNKNOWN",ka[ka.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ka[ka.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ka[ka.NOT_FOUND=5]="NOT_FOUND",ka[ka.ALREADY_EXISTS=6]="ALREADY_EXISTS",ka[ka.PERMISSION_DENIED=7]="PERMISSION_DENIED",ka[ka.UNAUTHENTICATED=16]="UNAUTHENTICATED",ka[ka.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ka[ka.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ka[ka.ABORTED=10]="ABORTED",ka[ka.OUT_OF_RANGE=11]="OUT_OF_RANGE",ka[ka.UNIMPLEMENTED=12]="UNIMPLEMENTED",ka[ka.INTERNAL=13]="INTERNAL",ka[ka.UNAVAILABLE=14]="UNAVAILABLE",ka[ka.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n1e(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a1e=new Lp([4294967295,4294967295],0);function W7(t){const e=n1e().encode(t),r=new $J;return r.update(e),new Uint8Array(r.digest())}function X7(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Lp([r,n],0),new Lp([a,s],0)]}class f6{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new qy(`Invalid padding: ${r}`);if(n<0)throw new qy(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new qy(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new qy(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Lp.fromNumber(this.Ie)}Ee(e,r,n){let a=e.add(r.multiply(Lp.fromNumber(n)));return a.compare(a1e)===1&&(a=new Lp([a.getBits(0),a.getBits(1)],0)),a.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=W7(e),[n,a]=X7(r);for(let s=0;s<this.hashCount;s++){const o=this.Ee(n,a,s);if(!this.de(o))return!1}return!0}static create(e,r,n){const a=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new f6(s,a,r);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const r=W7(e),[n,a]=X7(r);for(let s=0;s<this.hashCount;s++){const o=this.Ee(n,a,s);this.Ae(o)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class qy extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FI{constructor(e,r,n,a,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const a=new Map;return a.set(e,Fw.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new FI(Bn.min(),a,new mi(ca),Ud(),va())}}class Fw{constructor(e,r,n,a,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Fw(n,r,va(),va(),va())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pE{constructor(e,r,n,a){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=a}}class FZ{constructor(e,r){this.targetId=e,this.me=r}}class OZ{constructor(e,r,n=fo.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=a}}class Y7{constructor(){this.fe=0,this.ge=Z7(),this.pe=fo.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=va(),r=va(),n=va();return this.ge.forEach((a,s)=>{switch(s){case 0:e=e.add(a);break;case 2:r=r.add(a);break;case 1:n=n.add(a);break;default:yn()}}),new Fw(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=Z7()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,jn(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class s1e{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ud(),this.qe=J7(),this.Qe=new mi(ca)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:yn()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,a)=>{this.ze(a)&&r(a)})}He(e){const r=e.targetId,n=e.me.count,a=this.Je(r);if(a){const s=a.target;if(AS(s))if(n===0){const o=new an(s.path);this.Ue(r,o,ci.newNoDocument(o,Bn.min()))}else jn(n===1);else{const o=this.Ye(r);if(o!==n){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(r);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,d)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:s=0}=r;let o,l;try{o=Nm(n).toUint8Array()}catch(c){if(c instanceof lZ)return wm("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new f6(o,a,s)}catch(c){return wm(c instanceof qy?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let a=0;return n.forEach(s=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(r,s,null),a++)}),a}rt(e){const r=new Map;this.Be.forEach((s,o)=>{const l=this.Je(o);if(l){if(s.current&&AS(l.target)){const c=new an(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,ci.newNoDocument(c,e))}s.be&&(r.set(o,s.ve()),s.Ce())}});let n=va();this.qe.forEach((s,o)=>{let l=!0;o.forEachWhile(c=>{const d=this.Je(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const a=new FI(e,r,this.Qe,this.ke,n);return this.ke=Ud(),this.qe=J7(),this.Qe=new mi(ca),a}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const a=this.Ge(e);this.it(e,r)?a.Fe(r,1):a.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new Y7,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new _s(ca),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Ur("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Y7),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function J7(){return new mi(an.comparator)}function Z7(){return new mi(an.comparator)}const i1e={asc:"ASCENDING",desc:"DESCENDING"},o1e={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},l1e={and:"AND",or:"OR"};class c1e{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function ok(t,e){return t.useProto3Json||Pw(e)?e:{value:e}}function Uv(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function DZ(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function d1e(t,e){return Uv(t,e.toTimestamp())}function pl(t){return jn(!!t),Bn.fromTimestamp(function(r){const n=wA(r);return new Nr(n.seconds,n.nanos)}(t))}function h6(t,e){return lk(t,e).canonicalString()}function lk(t,e){const r=function(a){return new Ka(["projects",a.projectId,"databases",a.database])}(t).child("documents");return e===void 0?r:r.child(e)}function RZ(t){const e=Ka.fromString(t);return jn(KZ(e)),e}function S2(t,e){return h6(t.databaseId,e.path)}function oA(t,e){const r=RZ(e);if(r.get(1)!==t.databaseId.projectId)throw new Xr(xr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Xr(xr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new an(UZ(r))}function MZ(t,e){return h6(t.databaseId,e)}function LZ(t){const e=RZ(t);return e.length===4?Ka.emptyPath():UZ(e)}function ck(t){return new Ka(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function UZ(t){return jn(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function e9(t,e,r){return{name:S2(t,e),fields:r.value.mapValue.fields}}function u1e(t,e,r){const n=oA(t,e.name),a=pl(e.updateTime),s=e.createTime?pl(e.createTime):Bn.min(),o=new Ll({mapValue:{fields:e.fields}}),l=ci.newFoundDocument(n,a,s,o);return r&&l.setHasCommittedMutations(),r?l.setHasCommittedMutations():l}function f1e(t,e){return"found"in e?function(n,a){jn(!!a.found),a.found.name,a.found.updateTime;const s=oA(n,a.found.name),o=pl(a.found.updateTime),l=a.found.createTime?pl(a.found.createTime):Bn.min(),c=new Ll({mapValue:{fields:a.found.fields}});return ci.newFoundDocument(s,o,l,c)}(t,e):"missing"in e?function(n,a){jn(!!a.missing),jn(!!a.readTime);const s=oA(n,a.missing),o=pl(a.readTime);return ci.newNoDocument(s,o)}(t,e):yn()}function h1e(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:yn()}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],s=function(d,u){return d.useProto3Json?(jn(u===void 0||typeof u=="string"),fo.fromBase64String(u||"")):(jn(u===void 0||u instanceof Buffer||u instanceof Uint8Array),fo.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(d){const u=d.code===void 0?xr.UNKNOWN:kZ(d.code);return new Xr(u,d.message||"")}(o);r=new OZ(n,a,s,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=oA(t,n.document.name),s=pl(n.document.updateTime),o=n.document.createTime?pl(n.document.createTime):Bn.min(),l=new Ll({mapValue:{fields:n.document.fields}}),c=ci.newFoundDocument(a,s,o,l),d=n.targetIds||[],u=n.removedTargetIds||[];r=new pE(d,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=oA(t,n.document),s=n.readTime?pl(n.readTime):Bn.min(),o=ci.newNoDocument(a,s),l=n.removedTargetIds||[];r=new pE([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=oA(t,n.document),s=n.removedTargetIds||[];r=new pE([],s,a,null)}else{if(!("filter"in e))return yn();{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:s}=n,o=new r1e(a,s),l=n.targetId;r=new FZ(l,o)}}return r}function j2(t,e){let r;if(e instanceof m1)r={update:e9(t,e.key,e.value)};else if(e instanceof p1)r={delete:S2(t,e.key)};else if(e instanceof LA)r={update:e9(t,e.key,e.data),updateMask:v1e(e.fieldMask)};else{if(!(e instanceof l6))return yn();r={verify:S2(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,o){const l=o.transform;if(l instanceof Mv)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof fg)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Lv)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof E2)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw yn()}(0,n))),e.precondition.isNone||(r.currentDocument=function(a,s){return s.updateTime!==void 0?{updateTime:d1e(a,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:yn()}(t,e.precondition)),r}function dk(t,e){const r=e.currentDocument?function(s){return s.updateTime!==void 0?ui.updateTime(pl(s.updateTime)):s.exists!==void 0?ui.exists(s.exists):ui.none()}(e.currentDocument):ui.none(),n=e.updateTransforms?e.updateTransforms.map(a=>function(o,l){let c=null;if("setToServerValue"in l)jn(l.setToServerValue==="REQUEST_TIME"),c=new Mv;else if("appendMissingElements"in l){const u=l.appendMissingElements.values||[];c=new fg(u)}else if("removeAllFromArray"in l){const u=l.removeAllFromArray.values||[];c=new Lv(u)}else"increment"in l?c=new E2(o,l.increment):yn();const d=di.fromServerFormat(l.fieldPath);return new o6(d,c)}(t,a)):[];if(e.update){e.update.name;const a=oA(t,e.update.name),s=new Ll({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const d=c.fieldPaths||[];return new cd(d.map(u=>di.fromServerFormat(u)))}(e.updateMask);return new LA(a,s,o,r,n)}return new m1(a,s,r,n)}if(e.delete){const a=oA(t,e.delete);return new p1(a,r)}if(e.verify){const a=oA(t,e.verify);return new l6(a,r)}return yn()}function A1e(t,e){return t&&t.length>0?(jn(e!==void 0),t.map(r=>function(a,s){let o=a.updateTime?pl(a.updateTime):pl(s);return o.isEqual(Bn.min())&&(o=pl(s)),new Zve(o,a.transformResults||[])}(r,e))):[]}function QZ(t,e){return{documents:[MZ(t,e.path)]}}function VZ(t,e){const r={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=MZ(t,a);const s=function(d){if(d.length!==0)return GZ(ps.create(d,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const o=function(d){if(d.length!==0)return d.map(u=>function(A){return{field:Px(A.field),direction:p1e(A.dir)}}(u))}(e.orderBy);o&&(r.structuredQuery.orderBy=o);const l=ok(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:r,parent:a}}function HZ(t){let e=LZ(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){jn(n===1);const u=r.from[0];u.allDescendants?a=u.collectionId:e=e.child(u.collectionId)}let s=[];r.where&&(s=function(f){const A=$Z(f);return A instanceof ps&&s6(A)?A.getFilters():[A]}(r.where));let o=[];r.orderBy&&(o=function(f){return f.map(A=>function(m){return new _2(Tx(m.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(A))}(r.orderBy));let l=null;r.limit&&(l=function(f){let A;return A=typeof f=="object"?f.value:f,Pw(A)?null:A}(r.limit));let c=null;r.startAt&&(c=function(f){const A=!!f.before,h=f.values||[];return new Dv(h,A)}(r.startAt));let d=null;return r.endAt&&(d=function(f){const A=!f.before,h=f.values||[];return new Dv(h,A)}(r.endAt)),Uve(e,a,o,s,l,"F",c,d)}function m1e(t,e){const r=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return yn()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function $Z(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Tx(r.unaryFilter.field);return Ia.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=Tx(r.unaryFilter.field);return Ia.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Tx(r.unaryFilter.field);return Ia.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Tx(r.unaryFilter.field);return Ia.create(o,"!=",{nullValue:"NULL_VALUE"});default:return yn()}}(t):t.fieldFilter!==void 0?function(r){return Ia.create(Tx(r.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return yn()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return ps.create(r.compositeFilter.filters.map(n=>$Z(n)),function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return yn()}}(r.compositeFilter.op))}(t):yn()}function p1e(t){return i1e[t]}function g1e(t){return o1e[t]}function x1e(t){return l1e[t]}function Px(t){return{fieldPath:t.canonicalString()}}function Tx(t){return di.fromServerFormat(t.fieldPath)}function GZ(t){return t instanceof Ia?function(r){if(r.op==="=="){if(R7(r.value))return{unaryFilter:{field:Px(r.field),op:"IS_NAN"}};if(D7(r.value))return{unaryFilter:{field:Px(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(R7(r.value))return{unaryFilter:{field:Px(r.field),op:"IS_NOT_NAN"}};if(D7(r.value))return{unaryFilter:{field:Px(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Px(r.field),op:g1e(r.op),value:r.value}}}(t):t instanceof ps?function(r){const n=r.getFilters().map(a=>GZ(a));return n.length===1?n[0]:{compositeFilter:{op:x1e(r.op),filters:n}}}(t):yn()}function v1e(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function KZ(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(e,r,n,a,s=Bn.min(),o=Bn.min(),l=fo.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Zh(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Zh(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Zh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Zh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qZ{constructor(e){this.ct=e}}function y1e(t,e){let r;if(e.document)r=u1e(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=an.fromSegments(e.noDocument.path),a=Ag(e.noDocument.readTime);r=ci.newNoDocument(n,a),e.hasCommittedMutations&&r.setHasCommittedMutations()}else{if(!e.unknownDocument)return yn();{const n=an.fromSegments(e.unknownDocument.path),a=Ag(e.unknownDocument.version);r=ci.newUnknownDocument(n,a)}}return e.readTime&&r.setReadTime(function(a){const s=new Nr(a[0],a[1]);return Bn.fromTimestamp(s)}(e.readTime)),r}function t9(t,e){const r=e.key,n={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:gS(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(s,o){return{name:S2(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Uv(s,o.version.toTimestamp()),createTime:Uv(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())n.noDocument={path:r.path.toArray(),readTime:hg(e.version)};else{if(!e.isUnknownDocument())return yn();n.unknownDocument={path:r.path.toArray(),version:hg(e.version)}}return n}function gS(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function hg(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ag(t){const e=new Nr(t.seconds,t.nanoseconds);return Bn.fromTimestamp(e)}function bp(t,e){const r=(e.baseMutations||[]).map(s=>dk(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const n=e.mutations.map(s=>dk(t.ct,s)),a=Nr.fromMillis(e.localWriteTimeMs);return new c6(e.batchId,a,r,n)}function zy(t){const e=Ag(t.readTime),r=t.lastLimboFreeSnapshotVersion!==void 0?Ag(t.lastLimboFreeSnapshotVersion):Bn.min();let n;return n=function(s){return s.documents!==void 0}(t.query)?function(s){return jn(s.documents.length===1),ku(Bw(LZ(s.documents[0])))}(t.query):function(s){return ku(HZ(s))}(t.query),new Zh(n,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,r,fo.fromBase64String(t.resumeToken))}function zZ(t,e){const r=hg(e.snapshotVersion),n=hg(e.lastLimboFreeSnapshotVersion);let a;a=AS(e.target)?QZ(t.ct,e.target):VZ(t.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ug(e.target),readTime:r,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:a}}function WZ(t){const e=HZ({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?pS(e,e.limit,"L"):e}function k4(t,e){return new u6(e.largestBatchId,dk(t.ct,e.overlayMutation))}function r9(t,e){const r=e.path.lastSegment();return[t,Vc(e.path.popLast()),r]}function n9(t,e,r,n){return{indexId:t,uid:e,sequenceNumber:r,readTime:hg(n.readTime),documentKey:Vc(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1e{getBundleMetadata(e,r){return a9(e).get(r).next(n=>{if(n)return function(s){return{id:s.bundleId,createTime:Ag(s.createTime),version:s.version}}(n)})}saveBundleMetadata(e,r){return a9(e).put(function(a){return{bundleId:a.id,createTime:hg(pl(a.createTime)),version:a.version}}(r))}getNamedQuery(e,r){return s9(e).get(r).next(n=>{if(n)return function(s){return{name:s.name,query:WZ(s.bundledQuery),readTime:Ag(s.readTime)}}(n)})}saveNamedQuery(e,r){return s9(e).put(function(a){return{name:a.name,readTime:hg(pl(a.readTime)),bundledQuery:a.bundledQuery}}(r))}}function a9(t){return zo(t,"bundles")}function s9(t){return zo(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OI{constructor(e,r){this.serializer=e,this.userId=r}static lt(e,r){const n=r.uid||"";return new OI(e,n)}getOverlay(e,r){return dy(e).get(r9(this.userId,r)).next(n=>n?k4(this.serializer,n):null)}getOverlays(e,r){const n=th();return Yt.forEach(r,a=>this.getOverlay(e,a).next(s=>{s!==null&&n.set(a,s)})).next(()=>n)}saveOverlays(e,r,n){const a=[];return n.forEach((s,o)=>{const l=new u6(r,o);a.push(this.ht(e,l))}),Yt.waitFor(a)}removeOverlaysForBatchId(e,r,n){const a=new Set;r.forEach(o=>a.add(Vc(o.getCollectionPath())));const s=[];return a.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,n+1],!1,!0);s.push(dy(e).j("collectionPathOverlayIndex",l))}),Yt.waitFor(s)}getOverlaysForCollection(e,r,n){const a=th(),s=Vc(r),o=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return dy(e).U("collectionPathOverlayIndex",o).next(l=>{for(const c of l){const d=k4(this.serializer,c);a.set(d.getKey(),d)}return a})}getOverlaysForCollectionGroup(e,r,n,a){const s=th();let o;const l=IDBKeyRange.bound([this.userId,r,n],[this.userId,r,Number.POSITIVE_INFINITY],!0);return dy(e).J({index:"collectionGroupOverlayIndex",range:l},(c,d,u)=>{const f=k4(this.serializer,d);s.size()<a||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):u.done()}).next(()=>s)}ht(e,r){return dy(e).put(function(a,s,o){const[l,c,d]=r9(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:j2(a.ct,o.mutation)}}(this.serializer,this.userId,r))}}function dy(t){return zo(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1e{Pt(e){return zo(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(r=>{const n=r==null?void 0:r.value;return n?fo.fromUint8Array(n):fo.EMPTY_BYTE_STRING})}setSessionToken(e,r){return this.Pt(e).put({name:"sessionToken",value:r.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(){}It(e,r){this.Tt(e,r),r.Et()}Tt(e,r){if("nullValue"in e)this.dt(r,5);else if("booleanValue"in e)this.dt(r,10),r.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(r,15),r.At(oi(e.integerValue));else if("doubleValue"in e){const n=oi(e.doubleValue);isNaN(n)?this.dt(r,13):(this.dt(r,15),y2(n)?r.At(0):r.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(r,20),typeof n=="string"&&(n=wA(n)),r.Rt(`${n.seconds||""}`),r.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,r),this.ft(r);else if("bytesValue"in e)this.dt(r,30),r.gt(Nm(e.bytesValue)),this.ft(r);else if("referenceValue"in e)this.yt(e.referenceValue,r);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(r,45),r.At(n.latitude||0),r.At(n.longitude||0)}else"mapValue"in e?cZ(e)?this.dt(r,Number.MAX_SAFE_INTEGER):PI(e)?this.wt(e.mapValue,r):(this.St(e.mapValue,r),this.ft(r)):"arrayValue"in e?(this.bt(e.arrayValue,r),this.ft(r)):yn()}Vt(e,r){this.dt(r,25),this.Dt(e,r)}Dt(e,r){r.Rt(e)}St(e,r){const n=e.fields||{};this.dt(r,55);for(const a of Object.keys(n))this.Vt(a,r),this.Tt(n[a],r)}wt(e,r){var n,a;const s=e.fields||{};this.dt(r,53);const o="value",l=((a=(n=s[o].arrayValue)===null||n===void 0?void 0:n.values)===null||a===void 0?void 0:a.length)||0;this.dt(r,15),r.At(oi(l)),this.Vt(o,r),this.Tt(s[o],r)}bt(e,r){const n=e.values||[];this.dt(r,50);for(const a of n)this.Tt(a,r)}yt(e,r){this.dt(r,37),an.fromName(e).path.forEach(n=>{this.dt(r,60),this.Dt(n,r)})}dt(e,r){e.At(r)}ft(e){e.At(2)}}wp.vt=new wp;function N1e(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function i9(t){const e=64-function(n){let a=0;for(let s=0;s<8;++s){const o=N1e(255&n[s]);if(a+=o,o!==8)break}return a}(t);return Math.ceil(e/8)}class C1e{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ft(n.value),n=r.next();this.Mt()}xt(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ot(n.value),n=r.next();this.Nt()}Lt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ft(n);else if(n<2048)this.Ft(960|n>>>6),this.Ft(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ft(480|n>>>12),this.Ft(128|63&n>>>6),this.Ft(128|63&n);else{const a=r.codePointAt(0);this.Ft(240|a>>>18),this.Ft(128|63&a>>>12),this.Ft(128|63&a>>>6),this.Ft(128|63&a)}}this.Mt()}Bt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ot(n);else if(n<2048)this.Ot(960|n>>>6),this.Ot(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ot(480|n>>>12),this.Ot(128|63&n>>>6),this.Ot(128|63&n);else{const a=r.codePointAt(0);this.Ot(240|a>>>18),this.Ot(128|63&a>>>12),this.Ot(128|63&a>>>6),this.Ot(128|63&a)}}this.Nt()}kt(e){const r=this.qt(e),n=i9(r);this.Qt(1+n),this.buffer[this.position++]=255&n;for(let a=r.length-n;a<r.length;++a)this.buffer[this.position++]=255&r[a]}Kt(e){const r=this.qt(e),n=i9(r);this.Qt(1+n),this.buffer[this.position++]=~(255&n);for(let a=r.length-n;a<r.length;++a)this.buffer[this.position++]=~(255&r[a])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const r=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),n=(128&r[0])!=0;r[0]^=n?255:128;for(let a=1;a<r.length;++a)r[a]^=n?255:0;return r}Ft(e){const r=255&e;r===0?(this.Ut(0),this.Ut(255)):r===255?(this.Ut(255),this.Ut(0)):this.Ut(r)}Ot(e){const r=255&e;r===0?(this.Gt(0),this.Gt(255)):r===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const r=e+this.position;if(r<=this.buffer.length)return;let n=2*this.buffer.length;n<r&&(n=r);const a=new Uint8Array(n);a.set(this.buffer),this.buffer=a}}class _1e{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class E1e{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class uy{constructor(){this.jt=new C1e,this.Ht=new _1e(this.jt),this.Jt=new E1e(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Np{constructor(e,r,n,a){this.indexId=e,this.documentKey=r,this.arrayValue=n,this.directionalValue=a}Zt(){const e=this.directionalValue.length,r=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(r);return n.set(this.directionalValue,0),r!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new Np(this.indexId,this.documentKey,this.arrayValue,n)}}function u0(t,e){let r=t.indexId-e.indexId;return r!==0?r:(r=o9(t.arrayValue,e.arrayValue),r!==0?r:(r=o9(t.directionalValue,e.directionalValue),r!==0?r:an.comparator(t.documentKey,e.documentKey)))}function o9(t,e){for(let r=0;r<t.length&&r<e.length;++r){const n=t[r]-e[r];if(n!==0)return n}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l9{constructor(e){this.Xt=new _s((r,n)=>di.comparator(r.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const r of e.filters){const n=r;n.isInequality()?this.Xt=this.Xt.add(n):this.tn.push(n)}}get nn(){return this.Xt.size>1}rn(e){if(jn(e.collectionGroup===this.collectionId),this.nn)return!1;const r=ZB(e);if(r!==void 0&&!this.sn(r))return!1;const n=hp(e);let a=new Set,s=0,o=0;for(;s<n.length&&this.sn(n[s]);++s)a=a.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.Xt.size>0){const l=this.Xt.getIterator().getNext();if(!a.has(l.field.canonicalString())){const c=n[s];if(!this.on(l,c)||!this._n(this.en[o++],c))return!1}++s}for(;s<n.length;++s){const l=n[s];if(o>=this.en.length||!this._n(this.en[o++],l))return!1}return!0}an(){if(this.nn)return null;let e=new _s(di.comparator);const r=[];for(const n of this.tn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")r.push(new uE(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),r.push(new uE(n.field,0))}for(const n of this.en)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),r.push(new uE(n.field,n.dir==="asc"?0:1)));return new hS(hS.UNKNOWN_ID,this.collectionId,r,v2.empty())}sn(e){for(const r of this.tn)if(this.on(r,e))return!0;return!1}on(e,r){if(e===void 0||!e.field.isEqual(r.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return r.kind===2===n}_n(e,r){return!!e.field.isEqual(r.fieldPath)&&(r.kind===0&&e.dir==="asc"||r.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XZ(t){var e,r;if(jn(t instanceof Ia||t instanceof ps),t instanceof Ia){if(t instanceof xZ){const a=((r=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||r===void 0?void 0:r.map(s=>Ia.create(t.field,"==",s)))||[];return ps.create(a,"or")}return t}const n=t.filters.map(a=>XZ(a));return ps.create(n,t.op)}function S1e(t){if(t.getFilters().length===0)return[];const e=hk(XZ(t));return jn(YZ(e)),uk(e)||fk(e)?[e]:e.getFilters()}function uk(t){return t instanceof Ia}function fk(t){return t instanceof ps&&s6(t)}function YZ(t){return uk(t)||fk(t)||function(r){if(r instanceof ps&&nk(r)){for(const n of r.getFilters())if(!uk(n)&&!fk(n))return!1;return!0}return!1}(t)}function hk(t){if(jn(t instanceof Ia||t instanceof ps),t instanceof Ia)return t;if(t.filters.length===1)return hk(t.filters[0]);const e=t.filters.map(n=>hk(n));let r=ps.create(e,t.op);return r=xS(r),YZ(r)?r:(jn(r instanceof ps),jn(Rv(r)),jn(r.filters.length>1),r.filters.reduce((n,a)=>A6(n,a)))}function A6(t,e){let r;return jn(t instanceof Ia||t instanceof ps),jn(e instanceof Ia||e instanceof ps),r=t instanceof Ia?e instanceof Ia?function(a,s){return ps.create([a,s],"and")}(t,e):c9(t,e):e instanceof Ia?c9(e,t):function(a,s){if(jn(a.filters.length>0&&s.filters.length>0),Rv(a)&&Rv(s))return mZ(a,s.getFilters());const o=nk(a)?a:s,l=nk(a)?s:a,c=o.filters.map(d=>A6(d,l));return ps.create(c,"or")}(t,e),xS(r)}function c9(t,e){if(Rv(e))return mZ(e,t.getFilters());{const r=e.filters.map(n=>A6(t,n));return ps.create(r,"or")}}function xS(t){if(jn(t instanceof Ia||t instanceof ps),t instanceof Ia)return t;const e=t.getFilters();if(e.length===1)return xS(e[0]);if(hZ(t))return t;const r=e.map(a=>xS(a)),n=[];return r.forEach(a=>{a instanceof Ia?n.push(a):a instanceof ps&&(a.op===t.op?n.push(...a.filters):n.push(a))}),n.length===1?n[0]:ps.create(n,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1e{constructor(){this.un=new m6}addToCollectionParentIndex(e,r){return this.un.add(r),Yt.resolve()}getCollectionParents(e,r){return Yt.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Yt.resolve()}deleteFieldIndex(e,r){return Yt.resolve()}deleteAllFieldIndexes(e){return Yt.resolve()}createTargetIndexes(e,r){return Yt.resolve()}getDocumentsMatchingTarget(e,r){return Yt.resolve(null)}getIndexType(e,r){return Yt.resolve(0)}getFieldIndexes(e,r){return Yt.resolve([])}getNextCollectionGroupToUpdate(e){return Yt.resolve(null)}getMinOffset(e,r){return Yt.resolve(qd.min())}getMinOffsetFromCollectionGroup(e,r){return Yt.resolve(qd.min())}updateCollectionGroup(e,r,n){return Yt.resolve()}updateIndexEntries(e,r){return Yt.resolve()}}class m6{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r]||new _s(Ka.comparator),s=!a.has(n);return this.index[r]=a.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r];return a&&a.has(n)}getEntries(e){return(this.index[e]||new _s(Ka.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oC=new Uint8Array(0);class I1e{constructor(e,r){this.databaseId=r,this.cn=new m6,this.ln=new Hm(n=>ug(n),(n,a)=>Tw(n,a)),this.uid=e.uid||""}addToCollectionParentIndex(e,r){if(!this.cn.has(r)){const n=r.lastSegment(),a=r.popLast();e.addOnCommittedListener(()=>{this.cn.add(r)});const s={collectionId:n,parent:Vc(a)};return d9(e).put(s)}return Yt.resolve()}getCollectionParents(e,r){const n=[],a=IDBKeyRange.bound([r,""],[JJ(r),""],!1,!0);return d9(e).U(a).next(s=>{for(const o of s){if(o.collectionId!==r)break;n.push(eh(o.parent))}return n})}addFieldIndex(e,r){const n=fy(e),a=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(r);delete a.indexId;const s=n.add(a);if(r.indexState){const o=sx(e);return s.next(l=>{o.put(n9(l,this.uid,r.indexState.sequenceNumber,r.indexState.offset))})}return s.next()}deleteFieldIndex(e,r){const n=fy(e),a=sx(e),s=ax(e);return n.delete(r.indexId).next(()=>a.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const r=fy(e),n=ax(e),a=sx(e);return r.j().next(()=>n.j()).next(()=>a.j())}createTargetIndexes(e,r){return Yt.forEach(this.hn(r),n=>this.getIndexType(e,n).next(a=>{if(a===0||a===1){const s=new l9(n).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,r){const n=ax(e);let a=!0;const s=new Map;return Yt.forEach(this.hn(r),o=>this.Pn(e,o).next(l=>{a&&(a=!!l),s.set(o,l)})).next(()=>{if(a){let o=va();const l=[];return Yt.forEach(s,(c,d)=>{Ur("IndexedDbIndexManager",`Using index ${function(b){return`id=${b.indexId}|cg=${b.collectionGroup}|f=${b.fields.map(w=>`${w.fieldPath}:${w.kind}`).join(",")}`}(c)} to execute ${ug(r)}`);const u=function(b,w){const I=ZB(w);if(I===void 0)return null;for(const j of mS(b,I.fieldPath))switch(j.op){case"array-contains-any":return j.value.arrayValue.values||[];case"array-contains":return[j.value]}return null}(d,c),f=function(b,w){const I=new Map;for(const j of hp(w))for(const N of mS(b,j.fieldPath))switch(N.op){case"==":case"in":I.set(j.fieldPath.canonicalString(),N.value);break;case"not-in":case"!=":return I.set(j.fieldPath.canonicalString(),N.value),Array.from(I.values())}return null}(d,c),A=function(b,w){const I=[];let j=!0;for(const N of hp(w)){const S=N.kind===0?V7(b,N.fieldPath,b.startAt):H7(b,N.fieldPath,b.startAt);I.push(S.value),j&&(j=S.inclusive)}return new Dv(I,j)}(d,c),h=function(b,w){const I=[];let j=!0;for(const N of hp(w)){const S=N.kind===0?H7(b,N.fieldPath,b.endAt):V7(b,N.fieldPath,b.endAt);I.push(S.value),j&&(j=S.inclusive)}return new Dv(I,j)}(d,c),m=this.In(c,d,A),p=this.In(c,d,h),x=this.Tn(c,d,f),v=this.En(c.indexId,u,m,A.inclusive,p,h.inclusive,x);return Yt.forEach(v,y=>n.G(y,r.limit).next(b=>{b.forEach(w=>{const I=an.fromSegments(w.documentKey);o.has(I)||(o=o.add(I),l.push(I))})}))}).next(()=>l)}return Yt.resolve(null)})}hn(e){let r=this.ln.get(e);return r||(e.filters.length===0?r=[e]:r=S1e(ps.create(e.filters,"and")).map(n=>sk(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,r),r)}En(e,r,n,a,s,o,l){const c=(r!=null?r.length:1)*Math.max(n.length,s.length),d=c/(r!=null?r.length:1),u=[];for(let f=0;f<c;++f){const A=r?this.dn(r[f/d]):oC,h=this.An(e,A,n[f%d],a),m=this.Rn(e,A,s[f%d],o),p=l.map(x=>this.An(e,A,x,!0));u.push(...this.createRange(h,m,p))}return u}An(e,r,n,a){const s=new Np(e,an.empty(),r,n);return a?s:s.Zt()}Rn(e,r,n,a){const s=new Np(e,an.empty(),r,n);return a?s.Zt():s}Pn(e,r){const n=new l9(r),a=r.collectionGroup!=null?r.collectionGroup:r.path.lastSegment();return this.getFieldIndexes(e,a).next(s=>{let o=null;for(const l of s)n.rn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,r){let n=2;const a=this.hn(r);return Yt.forEach(a,s=>this.Pn(e,s).next(o=>{o?n!==0&&o.fields.length<function(c){let d=new _s(di.comparator),u=!1;for(const f of c.filters)for(const A of f.getFlattenedFilters())A.field.isKeyField()||(A.op==="array-contains"||A.op==="array-contains-any"?u=!0:d=d.add(A.field));for(const f of c.orderBy)f.field.isKeyField()||(d=d.add(f.field));return d.size+(u?1:0)}(s)&&(n=1):n=0})).next(()=>function(o){return o.limit!==null}(r)&&a.length>1&&n===2?1:n)}Vn(e,r){const n=new uy;for(const a of hp(e)){const s=r.data.field(a.fieldPath);if(s==null)return null;const o=n.Yt(a.kind);wp.vt.It(s,o)}return n.zt()}dn(e){const r=new uy;return wp.vt.It(e,r.Yt(0)),r.zt()}mn(e,r){const n=new uy;return wp.vt.It(N2(this.databaseId,r),n.Yt(function(s){const o=hp(s);return o.length===0?0:o[o.length-1].kind}(e))),n.zt()}Tn(e,r,n){if(n===null)return[];let a=[];a.push(new uy);let s=0;for(const o of hp(e)){const l=n[s++];for(const c of a)if(this.fn(r,o.fieldPath)&&C2(l))a=this.gn(a,o,l);else{const d=c.Yt(o.kind);wp.vt.It(l,d)}}return this.pn(a)}In(e,r,n){return this.Tn(e,r,n.position)}pn(e){const r=[];for(let n=0;n<e.length;++n)r[n]=e[n].zt();return r}gn(e,r,n){const a=[...e],s=[];for(const o of n.arrayValue.values||[])for(const l of a){const c=new uy;c.seed(l.zt()),wp.vt.It(o,c.Yt(r.kind)),s.push(c)}return s}fn(e,r){return!!e.filters.find(n=>n instanceof Ia&&n.field.isEqual(r)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,r){const n=fy(e),a=sx(e);return(r?n.U("collectionGroupIndex",IDBKeyRange.bound(r,r)):n.U()).next(s=>{const o=[];return Yt.forEach(s,l=>a.get([l.indexId,this.uid]).next(c=>{o.push(function(u,f){const A=f?new v2(f.sequenceNumber,new qd(Ag(f.readTime),new an(eh(f.documentKey)),f.largestBatchId)):v2.empty(),h=u.fields.map(([m,p])=>new uE(di.fromServerFormat(m),p));return new hS(u.indexId,u.collectionGroup,h,A)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(r=>r.length===0?null:(r.sort((n,a)=>{const s=n.indexState.sequenceNumber-a.indexState.sequenceNumber;return s!==0?s:ca(n.collectionGroup,a.collectionGroup)}),r[0].collectionGroup))}updateCollectionGroup(e,r,n){const a=fy(e),s=sx(e);return this.yn(e).next(o=>a.U("collectionGroupIndex",IDBKeyRange.bound(r,r)).next(l=>Yt.forEach(l,c=>s.put(n9(c.indexId,this.uid,o,n)))))}updateIndexEntries(e,r){const n=new Map;return Yt.forEach(r,(a,s)=>{const o=n.get(a.collectionGroup);return(o?Yt.resolve(o):this.getFieldIndexes(e,a.collectionGroup)).next(l=>(n.set(a.collectionGroup,l),Yt.forEach(l,c=>this.wn(e,a,c).next(d=>{const u=this.Sn(s,c);return d.isEqual(u)?Yt.resolve():this.bn(e,s,c,d,u)}))))})}Dn(e,r,n,a){return ax(e).put({indexId:a.indexId,uid:this.uid,arrayValue:a.arrayValue,directionalValue:a.directionalValue,orderedDocumentKey:this.mn(n,r.key),documentKey:r.key.path.toArray()})}vn(e,r,n,a){return ax(e).delete([a.indexId,this.uid,a.arrayValue,a.directionalValue,this.mn(n,r.key),r.key.path.toArray()])}wn(e,r,n){const a=ax(e);let s=new _s(u0);return a.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,r)])},(o,l)=>{s=s.add(new Np(n.indexId,r,l.arrayValue,l.directionalValue))}).next(()=>s)}Sn(e,r){let n=new _s(u0);const a=this.Vn(r,e);if(a==null)return n;const s=ZB(r);if(s!=null){const o=e.data.field(s.fieldPath);if(C2(o))for(const l of o.arrayValue.values||[])n=n.add(new Np(r.indexId,e.key,this.dn(l),a))}else n=n.add(new Np(r.indexId,e.key,oC,a));return n}bn(e,r,n,a,s){Ur("IndexedDbIndexManager","Updating index entries for document '%s'",r.key);const o=[];return function(c,d,u,f,A){const h=c.getIterator(),m=d.getIterator();let p=nx(h),x=nx(m);for(;p||x;){let v=!1,y=!1;if(p&&x){const b=u(p,x);b<0?y=!0:b>0&&(v=!0)}else p!=null?y=!0:v=!0;v?(f(x),x=nx(m)):y?(A(p),p=nx(h)):(p=nx(h),x=nx(m))}}(a,s,u0,l=>{o.push(this.Dn(e,r,n,l))},l=>{o.push(this.vn(e,r,n,l))}),Yt.waitFor(o)}yn(e){let r=1;return sx(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,a,s)=>{s.done(),r=a.sequenceNumber+1}).next(()=>r)}createRange(e,r,n){n=n.sort((o,l)=>u0(o,l)).filter((o,l,c)=>!l||u0(o,c[l-1])!==0);const a=[];a.push(e);for(const o of n){const l=u0(o,e),c=u0(o,r);if(l===0)a[0]=e.Zt();else if(l>0&&c<0)a.push(o),a.push(o.Zt());else if(c>0)break}a.push(r);const s=[];for(let o=0;o<a.length;o+=2){if(this.Cn(a[o],a[o+1]))return[];const l=[a[o].indexId,this.uid,a[o].arrayValue,a[o].directionalValue,oC,[]],c=[a[o+1].indexId,this.uid,a[o+1].arrayValue,a[o+1].directionalValue,oC,[]];s.push(IDBKeyRange.bound(l,c))}return s}Cn(e,r){return u0(e,r)>0}getMinOffsetFromCollectionGroup(e,r){return this.getFieldIndexes(e,r).next(u9)}getMinOffset(e,r){return Yt.mapArray(this.hn(r),n=>this.Pn(e,n).next(a=>a||yn())).next(u9)}}function d9(t){return zo(t,"collectionParents")}function ax(t){return zo(t,"indexEntries")}function fy(t){return zo(t,"indexConfiguration")}function sx(t){return zo(t,"indexState")}function u9(t){jn(t.length!==0);let e=t[0].indexState.offset,r=e.largestBatchId;for(let n=1;n<t.length;n++){const a=t[n].indexState.offset;e6(a,e)<0&&(e=a),r<a.largestBatchId&&(r=a.largestBatchId)}return new qd(e.readTime,e.documentKey,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f9={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class ad{constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new ad(e,ad.DEFAULT_COLLECTION_PERCENTILE,ad.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JZ(t,e,r){const n=t.store("mutations"),a=t.store("documentMutations"),s=[],o=IDBKeyRange.only(r.batchId);let l=0;const c=n.J({range:o},(u,f,A)=>(l++,A.delete()));s.push(c.next(()=>{jn(l===1)}));const d=[];for(const u of r.mutations){const f=nZ(e,u.key.path,r.batchId);s.push(a.delete(f)),d.push(u.key)}return Yt.waitFor(s).next(()=>d)}function vS(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw yn();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ad.DEFAULT_COLLECTION_PERCENTILE=10,ad.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ad.DEFAULT=new ad(41943040,ad.DEFAULT_COLLECTION_PERCENTILE,ad.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ad.DISABLED=new ad(-1,0,0);class DI{constructor(e,r,n,a){this.userId=e,this.serializer=r,this.indexManager=n,this.referenceDelegate=a,this.Fn={}}static lt(e,r,n,a){jn(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new DI(s,r,n,a)}checkEmpty(e){let r=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return f0(e).J({index:"userMutationsIndex",range:n},(a,s,o)=>{r=!1,o.done()}).next(()=>r)}addMutationBatch(e,r,n,a){const s=Bx(e),o=f0(e);return o.add({}).next(l=>{jn(typeof l=="number");const c=new c6(l,r,n,a),d=function(h,m,p){const x=p.baseMutations.map(y=>j2(h.ct,y)),v=p.mutations.map(y=>j2(h.ct,y));return{userId:m,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:x,mutations:v}}(this.serializer,this.userId,c),u=[];let f=new _s((A,h)=>ca(A.canonicalString(),h.canonicalString()));for(const A of a){const h=nZ(this.userId,A.key.path,l);f=f.add(A.key.path.popLast()),u.push(o.put(d)),u.push(s.put(h,dve))}return f.forEach(A=>{u.push(this.indexManager.addToCollectionParentIndex(e,A))}),e.addOnCommittedListener(()=>{this.Fn[l]=c.keys()}),Yt.waitFor(u).next(()=>c)})}lookupMutationBatch(e,r){return f0(e).get(r).next(n=>n?(jn(n.userId===this.userId),bp(this.serializer,n)):null)}Mn(e,r){return this.Fn[r]?Yt.resolve(this.Fn[r]):this.lookupMutationBatch(e,r).next(n=>{if(n){const a=n.keys();return this.Fn[r]=a,a}return null})}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return f0(e).J({index:"userMutationsIndex",range:a},(o,l,c)=>{l.userId===this.userId&&(jn(l.batchId>=n),s=bp(this.serializer,l)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const r=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return f0(e).J({index:"userMutationsIndex",range:r,reverse:!0},(a,s,o)=>{n=s.batchId,o.done()}).next(()=>n)}getAllMutationBatches(e){const r=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return f0(e).U("userMutationsIndex",r).next(n=>n.map(a=>bp(this.serializer,a)))}getAllMutationBatchesAffectingDocumentKey(e,r){const n=fE(this.userId,r.path),a=IDBKeyRange.lowerBound(n),s=[];return Bx(e).J({range:a},(o,l,c)=>{const[d,u,f]=o,A=eh(u);if(d===this.userId&&r.path.isEqual(A))return f0(e).get(f).next(h=>{if(!h)throw yn();jn(h.userId===this.userId),s.push(bp(this.serializer,h))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new _s(ca);const a=[];return r.forEach(s=>{const o=fE(this.userId,s.path),l=IDBKeyRange.lowerBound(o),c=Bx(e).J({range:l},(d,u,f)=>{const[A,h,m]=d,p=eh(h);A===this.userId&&s.path.isEqual(p)?n=n.add(m):f.done()});a.push(c)}),Yt.waitFor(a).next(()=>this.xn(e,n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1,s=fE(this.userId,n),o=IDBKeyRange.lowerBound(s);let l=new _s(ca);return Bx(e).J({range:o},(c,d,u)=>{const[f,A,h]=c,m=eh(A);f===this.userId&&n.isPrefixOf(m)?m.length===a&&(l=l.add(h)):u.done()}).next(()=>this.xn(e,l))}xn(e,r){const n=[],a=[];return r.forEach(s=>{a.push(f0(e).get(s).next(o=>{if(o===null)throw yn();jn(o.userId===this.userId),n.push(bp(this.serializer,o))}))}),Yt.waitFor(a).next(()=>n)}removeMutationBatch(e,r){return JZ(e._e,this.userId,r).next(n=>(e.addOnCommittedListener(()=>{this.On(r.batchId)}),Yt.forEach(n,a=>this.referenceDelegate.markPotentiallyOrphaned(e,a))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(r=>{if(!r)return Yt.resolve();const n=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),a=[];return Bx(e).J({range:n},(s,o,l)=>{if(s[0]===this.userId){const c=eh(s[1]);a.push(c)}else l.done()}).next(()=>{jn(a.length===0)})})}containsKey(e,r){return ZZ(e,this.userId,r)}Nn(e){return eee(e).get(this.userId).next(r=>r||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function ZZ(t,e,r){const n=fE(e,r.path),a=n[1],s=IDBKeyRange.lowerBound(n);let o=!1;return Bx(t).J({range:s,H:!0},(l,c,d)=>{const[u,f,A]=l;u===e&&f===a&&(o=!0),d.done()}).next(()=>o)}function f0(t){return zo(t,"mutations")}function Bx(t){return zo(t,"documentMutations")}function eee(t){return zo(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mg{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new mg(0)}static kn(){return new mg(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P1e{constructor(e,r){this.referenceDelegate=e,this.serializer=r}allocateTargetId(e){return this.qn(e).next(r=>{const n=new mg(r.highestTargetId);return r.highestTargetId=n.next(),this.Qn(e,r).next(()=>r.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(r=>Bn.fromTimestamp(new Nr(r.lastRemoteSnapshotVersion.seconds,r.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(r=>r.highestListenSequenceNumber)}setTargetsMetadata(e,r,n){return this.qn(e).next(a=>(a.highestListenSequenceNumber=r,n&&(a.lastRemoteSnapshotVersion=n.toTimestamp()),r>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=r),this.Qn(e,a)))}addTargetData(e,r){return this.Kn(e,r).next(()=>this.qn(e).next(n=>(n.targetCount+=1,this.$n(r,n),this.Qn(e,n))))}updateTargetData(e,r){return this.Kn(e,r)}removeTargetData(e,r){return this.removeMatchingKeysForTargetId(e,r.targetId).next(()=>ix(e).delete(r.targetId)).next(()=>this.qn(e)).next(n=>(jn(n.targetCount>0),n.targetCount-=1,this.Qn(e,n)))}removeTargets(e,r,n){let a=0;const s=[];return ix(e).J((o,l)=>{const c=zy(l);c.sequenceNumber<=r&&n.get(c.targetId)===null&&(a++,s.push(this.removeTargetData(e,c)))}).next(()=>Yt.waitFor(s)).next(()=>a)}forEachTarget(e,r){return ix(e).J((n,a)=>{const s=zy(a);r(s)})}qn(e){return h9(e).get("targetGlobalKey").next(r=>(jn(r!==null),r))}Qn(e,r){return h9(e).put("targetGlobalKey",r)}Kn(e,r){return ix(e).put(zZ(this.serializer,r))}$n(e,r){let n=!1;return e.targetId>r.highestTargetId&&(r.highestTargetId=e.targetId,n=!0),e.sequenceNumber>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.qn(e).next(r=>r.targetCount)}getTargetData(e,r){const n=ug(r),a=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return ix(e).J({range:a,index:"queryTargetsIndex"},(o,l,c)=>{const d=zy(l);Tw(r,d.target)&&(s=d,c.done())}).next(()=>s)}addMatchingKeys(e,r,n){const a=[],s=Q0(e);return r.forEach(o=>{const l=Vc(o.path);a.push(s.put({targetId:n,path:l})),a.push(this.referenceDelegate.addReference(e,n,o))}),Yt.waitFor(a)}removeMatchingKeys(e,r,n){const a=Q0(e);return Yt.forEach(r,s=>{const o=Vc(s.path);return Yt.waitFor([a.delete([n,o]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,r){const n=Q0(e),a=IDBKeyRange.bound([r],[r+1],!1,!0);return n.delete(a)}getMatchingKeysForTargetId(e,r){const n=IDBKeyRange.bound([r],[r+1],!1,!0),a=Q0(e);let s=va();return a.J({range:n,H:!0},(o,l,c)=>{const d=eh(o[1]),u=new an(d);s=s.add(u)}).next(()=>s)}containsKey(e,r){const n=Vc(r.path),a=IDBKeyRange.bound([n],[JJ(n)],!1,!0);let s=0;return Q0(e).J({index:"documentTargetsIndex",H:!0,range:a},([o,l],c,d)=>{o!==0&&(s++,d.done())}).next(()=>s>0)}ot(e,r){return ix(e).get(r).next(n=>n?zy(n):null)}}function ix(t){return zo(t,"targets")}function h9(t){return zo(t,"targetGlobal")}function Q0(t){return zo(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A9([t,e],[r,n]){const a=ca(t,r);return a===0?ca(e,n):a}class T1e{constructor(e){this.Un=e,this.buffer=new _s(A9),this.Wn=0}Gn(){return++this.Wn}zn(e){const r=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();A9(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class B1e{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){Ur("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Vm(r)?Ur("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):await Og(r)}await this.Hn(3e5)})}}class k1e{constructor(e,r){this.Jn=e,this.params=r}calculateTargetCount(e,r){return this.Jn.Yn(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Yt.resolve(Su.oe);const n=new T1e(r);return this.Jn.forEachTarget(e,a=>n.zn(a.sequenceNumber)).next(()=>this.Jn.Zn(e,a=>n.zn(a))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Jn.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Jn.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ur("LruGarbageCollector","Garbage collection skipped; disabled"),Yt.resolve(f9)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ur("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),f9):this.Xn(e,r))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,r){let n,a,s,o,l,c,d;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(Ur("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),a=this.params.maximumSequenceNumbersToCollect):a=f,o=Date.now(),this.nthSequenceNumber(e,a))).next(f=>(n=f,l=Date.now(),this.removeTargets(e,n,r))).next(f=>(s=f,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(f=>(d=Date.now(),jx()<=ja.DEBUG&&Ur("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${a} in `+(l-o)+`ms
	Removed ${s} targets in `+(c-l)+`ms
	Removed ${f} documents in `+(d-c)+`ms
Total Duration: ${d-u}ms`),Yt.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:s,documentsRemoved:f})))}}function F1e(t,e){return new k1e(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1e{constructor(e,r){this.db=e,this.garbageCollector=F1e(this,r)}Yn(e){const r=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(n=>r.next(a=>n+a))}er(e){let r=0;return this.Zn(e,n=>{r++}).next(()=>r)}forEachTarget(e,r){return this.db.getTargetCache().forEachTarget(e,r)}Zn(e,r){return this.tr(e,(n,a)=>r(a))}addReference(e,r,n){return lC(e,n)}removeReference(e,r,n){return lC(e,n)}removeTargets(e,r,n){return this.db.getTargetCache().removeTargets(e,r,n)}markPotentiallyOrphaned(e,r){return lC(e,r)}nr(e,r){return function(a,s){let o=!1;return eee(a).Y(l=>ZZ(a,l,s).next(c=>(c&&(o=!0),Yt.resolve(!c)))).next(()=>o)}(e,r)}removeOrphanedDocuments(e,r){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let s=0;return this.tr(e,(o,l)=>{if(l<=r){const c=this.nr(e,o).next(d=>{if(!d)return s++,n.getEntry(e,o).next(()=>(n.removeEntry(o,Bn.min()),Q0(e).delete(function(f){return[0,Vc(f.path)]}(o))))});a.push(c)}}).next(()=>Yt.waitFor(a)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,r){return lC(e,r)}tr(e,r){const n=Q0(e);let a,s=Su.oe;return n.J({index:"documentTargetsIndex"},([o,l],{path:c,sequenceNumber:d})=>{o===0?(s!==Su.oe&&r(new an(eh(a)),s),s=d,a=c):s=Su.oe}).next(()=>{s!==Su.oe&&r(new an(eh(a)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function lC(t,e){return Q0(t).put(function(n,a){return{targetId:0,path:Vc(n.path),sequenceNumber:a}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tee{constructor(){this.changes=new Hm(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,ci.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Yt.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1e{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,r,n){return ep(e).put(n)}removeEntry(e,r,n){return ep(e).delete(function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],gS(o),l[l.length-1]]}(r,n))}updateMetadata(e,r){return this.getMetadata(e).next(n=>(n.byteSize+=r,this.rr(e,n)))}getEntry(e,r){let n=ci.newInvalidDocument(r);return ep(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(hy(r))},(a,s)=>{n=this.ir(r,s)}).next(()=>n)}sr(e,r){let n={size:0,document:ci.newInvalidDocument(r)};return ep(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(hy(r))},(a,s)=>{n={document:this.ir(r,s),size:vS(s)}}).next(()=>n)}getEntries(e,r){let n=Ud();return this._r(e,r,(a,s)=>{const o=this.ir(a,s);n=n.insert(a,o)}).next(()=>n)}ar(e,r){let n=Ud(),a=new mi(an.comparator);return this._r(e,r,(s,o)=>{const l=this.ir(s,o);n=n.insert(s,l),a=a.insert(s,vS(o))}).next(()=>({documents:n,ur:a}))}_r(e,r,n){if(r.isEmpty())return Yt.resolve();let a=new _s(g9);r.forEach(c=>a=a.add(c));const s=IDBKeyRange.bound(hy(a.first()),hy(a.last())),o=a.getIterator();let l=o.getNext();return ep(e).J({index:"documentKeyIndex",range:s},(c,d,u)=>{const f=an.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;l&&g9(l,f)<0;)n(l,null),l=o.getNext();l&&l.isEqual(f)&&(n(l,d),l=o.hasNext()?o.getNext():null),l?u.$(hy(l)):u.done()}).next(()=>{for(;l;)n(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,r,n,a,s){const o=r.path,l=[o.popLast().toArray(),o.lastSegment(),gS(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ep(e).U(IDBKeyRange.bound(l,c,!0)).next(d=>{s==null||s.incrementDocumentReadCount(d.length);let u=Ud();for(const f of d){const A=this.ir(an.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);A.isFoundDocument()&&(kw(r,A)||a.has(A.key))&&(u=u.insert(A.key,A))}return u})}getAllFromCollectionGroup(e,r,n,a){let s=Ud();const o=p9(r,n),l=p9(r,qd.max());return ep(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,l,!0)},(c,d,u)=>{const f=this.ir(an.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);s=s.insert(f.key,f),s.size===a&&u.done()}).next(()=>s)}newChangeBuffer(e){return new R1e(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(r=>r.byteSize)}getMetadata(e){return m9(e).get("remoteDocumentGlobalKey").next(r=>(jn(!!r),r))}rr(e,r){return m9(e).put("remoteDocumentGlobalKey",r)}ir(e,r){if(r){const n=y1e(this.serializer,r);if(!(n.isNoDocument()&&n.version.isEqual(Bn.min())))return n}return ci.newInvalidDocument(e)}}function ree(t){return new D1e(t)}class R1e extends tee{constructor(e,r){super(),this.cr=e,this.trackRemovals=r,this.lr=new Hm(n=>n.toString(),(n,a)=>n.isEqual(a))}applyChanges(e){const r=[];let n=0,a=new _s((s,o)=>ca(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const l=this.lr.get(s);if(r.push(this.cr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const c=t9(this.cr.serializer,o);a=a.add(s.path.popLast());const d=vS(c);n+=d-l.size,r.push(this.cr.addEntry(e,s,c))}else if(n-=l.size,this.trackRemovals){const c=t9(this.cr.serializer,o.convertToNoDocument(Bn.min()));r.push(this.cr.addEntry(e,s,c))}}),a.forEach(s=>{r.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),r.push(this.cr.updateMetadata(e,n)),Yt.waitFor(r)}getFromCache(e,r){return this.cr.sr(e,r).next(n=>(this.lr.set(r,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,r){return this.cr.ar(e,r).next(({documents:n,ur:a})=>(a.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:n.get(s).readTime})}),n))}}function m9(t){return zo(t,"remoteDocumentGlobal")}function ep(t){return zo(t,"remoteDocumentsV14")}function hy(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function p9(t,e){const r=e.documentKey.path.toArray();return[t,gS(e.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function g9(t,e){const r=t.path.toArray(),n=e.path.toArray();let a=0;for(let s=0;s<r.length-2&&s<n.length-2;++s)if(a=ca(r[s],n[s]),a)return a;return a=ca(r.length,n.length),a||(a=ca(r[r.length-2],n[n.length-2]),a||ca(r[r.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M1e{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nee{constructor(e,r,n,a){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(a=>(n=a,this.remoteDocumentCache.getEntry(e,r))).next(a=>(n!==null&&_b(n.mutation,a,cd.empty(),Nr.now()),a))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,va()).next(()=>n))}getLocalViewOfDocuments(e,r,n=va()){const a=th();return this.populateOverlays(e,a,r).next(()=>this.computeViews(e,r,a,n).next(s=>{let o=Ky();return s.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,r){const n=th();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,va()))}populateOverlays(e,r,n){const a=[];return n.forEach(s=>{r.has(s)||a.push(s)}),this.documentOverlayCache.getOverlays(e,a).next(s=>{s.forEach((o,l)=>{r.set(o,l)})})}computeViews(e,r,n,a){let s=Ud();const o=Cb(),l=function(){return Cb()}();return r.forEach((c,d)=>{const u=n.get(d.key);a.has(d.key)&&(u===void 0||u.mutation instanceof LA)?s=s.insert(d.key,d):u!==void 0?(o.set(d.key,u.mutation.getFieldMask()),_b(u.mutation,d,u.mutation.getFieldMask(),Nr.now())):o.set(d.key,cd.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((d,u)=>o.set(d,u)),r.forEach((d,u)=>{var f;return l.set(d,new M1e(u,(f=o.get(d))!==null&&f!==void 0?f:null))}),l))}recalculateAndSaveOverlays(e,r){const n=Cb();let a=new mi((o,l)=>o-l),s=va();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(o=>{for(const l of o)l.keys().forEach(c=>{const d=r.get(c);if(d===null)return;let u=n.get(c)||cd.empty();u=l.applyToLocalView(d,u),n.set(c,u);const f=(a.get(l.batchId)||va()).add(c);a=a.insert(l.batchId,f)})}).next(()=>{const o=[],l=a.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),d=c.key,u=c.value,f=CZ();u.forEach(A=>{if(!s.has(A)){const h=PZ(r.get(A),n.get(A));h!==null&&f.set(A,h),s=s.add(A)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return Yt.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,a){return function(o){return an.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):vZ(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,a):this.getDocumentsMatchingCollectionQuery(e,r,n,a)}getNextDocuments(e,r,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,a).next(s=>{const o=a-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,a-s.size):Yt.resolve(th());let l=-1,c=s;return o.next(d=>Yt.forEach(d,(u,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),s.get(u)?Yt.resolve():this.remoteDocumentCache.getEntry(e,u).next(A=>{c=c.insert(u,A)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,c,d,va())).next(u=>({batchId:l,changes:NZ(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new an(r)).next(n=>{let a=Ky();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a})}getDocumentsMatchingCollectionGroupQuery(e,r,n,a){const s=r.collectionGroup;let o=Ky();return this.indexManager.getCollectionParents(e,s).next(l=>Yt.forEach(l,c=>{const d=function(f,A){return new A1(A,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(r,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,n,a).next(u=>{u.forEach((f,A)=>{o=o.insert(f,A)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,r,n,a){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,a))).next(o=>{s.forEach((c,d)=>{const u=d.getKey();o.get(u)===null&&(o=o.insert(u,ci.newInvalidDocument(u)))});let l=Ky();return o.forEach((c,d)=>{const u=s.get(c);u!==void 0&&_b(u.mutation,d,cd.empty(),Nr.now()),kw(r,d)&&(l=l.insert(c,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L1e{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Yt.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(a){return{id:a.id,version:a.version,createTime:pl(a.createTime)}}(r)),Yt.resolve()}getNamedQuery(e,r){return Yt.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(a){return{name:a.name,query:WZ(a.bundledQuery),readTime:pl(a.readTime)}}(r)),Yt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1e{constructor(){this.overlays=new mi(an.comparator),this.Ir=new Map}getOverlay(e,r){return Yt.resolve(this.overlays.get(r))}getOverlays(e,r){const n=th();return Yt.forEach(r,a=>this.getOverlay(e,a).next(s=>{s!==null&&n.set(a,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((a,s)=>{this.ht(e,r,s)}),Yt.resolve()}removeOverlaysForBatchId(e,r,n){const a=this.Ir.get(n);return a!==void 0&&(a.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),Yt.resolve()}getOverlaysForCollection(e,r,n){const a=th(),s=r.length+1,o=new an(r.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,d=c.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===s&&c.largestBatchId>n&&a.set(c.getKey(),c)}return Yt.resolve(a)}getOverlaysForCollectionGroup(e,r,n,a){let s=new mi((d,u)=>d-u);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let u=s.get(d.largestBatchId);u===null&&(u=th(),s=s.insert(d.largestBatchId,u)),u.set(d.getKey(),d)}}const l=th(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,u)=>l.set(d,u)),!(l.size()>=a)););return Yt.resolve(l)}ht(e,r,n){const a=this.overlays.get(n.key);if(a!==null){const o=this.Ir.get(a.largestBatchId).delete(n.key);this.Ir.set(a.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new u6(r,n));let s=this.Ir.get(r);s===void 0&&(s=va(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q1e{constructor(){this.sessionToken=fo.EMPTY_BYTE_STRING}getSessionToken(e){return Yt.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Yt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6{constructor(){this.Tr=new _s(ll.Er),this.dr=new _s(ll.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new ll(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new ll(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new an(new Ka([])),n=new ll(r,e),a=new ll(r,e+1),s=[];return this.dr.forEachInRange([n,a],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new an(new Ka([])),n=new ll(r,e),a=new ll(r,e+1);let s=va();return this.dr.forEachInRange([n,a],o=>{s=s.add(o.key)}),s}containsKey(e){const r=new ll(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class ll{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return an.comparator(e.key,r.key)||ca(e.wr,r.wr)}static Ar(e,r){return ca(e.wr,r.wr)||an.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1e{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new _s(ll.Er)}checkEmpty(e){return Yt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,a){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new c6(s,r,n,a);this.mutationQueue.push(o);for(const l of a)this.br=this.br.add(new ll(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Yt.resolve(o)}lookupMutationBatch(e,r){return Yt.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=this.vr(n),s=a<0?0:a;return Yt.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Yt.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Yt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new ll(r,0),a=new ll(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,a],o=>{const l=this.Dr(o.wr);s.push(l)}),Yt.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new _s(ca);return r.forEach(a=>{const s=new ll(a,0),o=new ll(a,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],l=>{n=n.add(l.wr)})}),Yt.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1;let s=n;an.isDocumentKey(s)||(s=s.child(""));const o=new ll(new an(s),0);let l=new _s(ca);return this.br.forEachWhile(c=>{const d=c.key.path;return!!n.isPrefixOf(d)&&(d.length===a&&(l=l.add(c.wr)),!0)},o),Yt.resolve(this.Cr(l))}Cr(e){const r=[];return e.forEach(n=>{const a=this.Dr(n);a!==null&&r.push(a)}),r}removeMutationBatch(e,r){jn(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Yt.forEach(r.mutations,a=>{const s=new ll(a.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new ll(r,0),a=this.br.firstAfterOrEqual(n);return Yt.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,Yt.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H1e{constructor(e){this.Mr=e,this.docs=function(){return new mi(an.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,a=this.docs.get(n),s=a?a.size:0,o=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Yt.resolve(n?n.document.mutableCopy():ci.newInvalidDocument(r))}getEntries(e,r){let n=Ud();return r.forEach(a=>{const s=this.docs.get(a);n=n.insert(a,s?s.document.mutableCopy():ci.newInvalidDocument(a))}),Yt.resolve(n)}getDocumentsMatchingQuery(e,r,n,a){let s=Ud();const o=r.path,l=new an(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:d,value:{document:u}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||e6(ZJ(u),n)<=0||(a.has(u.key)||kw(r,u))&&(s=s.insert(u.key,u.mutableCopy()))}return Yt.resolve(s)}getAllFromCollectionGroup(e,r,n,a){yn()}Or(e,r){return Yt.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new $1e(this)}getSize(e){return Yt.resolve(this.size)}}class $1e extends tee{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,a)=>{a.isValidDocument()?r.push(this.cr.addEntry(e,a)):this.cr.removeEntry(n)}),Yt.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1e{constructor(e){this.persistence=e,this.Nr=new Hm(r=>ug(r),Tw),this.lastRemoteSnapshotVersion=Bn.min(),this.highestTargetId=0,this.Lr=0,this.Br=new p6,this.targetCount=0,this.kr=mg.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,a)=>r(a)),Yt.resolve()}getLastRemoteSnapshotVersion(e){return Yt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Yt.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Yt.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Yt.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new mg(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Yt.resolve()}updateTargetData(e,r){return this.Kn(r),Yt.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Yt.resolve()}removeTargets(e,r,n){let a=0;const s=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),a++)}),Yt.waitFor(s).next(()=>a)}getTargetCount(e){return Yt.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Yt.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Yt.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const a=this.persistence.referenceDelegate,s=[];return a&&r.forEach(o=>{s.push(a.markPotentiallyOrphaned(e,o))}),Yt.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Yt.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Yt.resolve(n)}containsKey(e,r){return Yt.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aee{constructor(e,r){this.qr={},this.overlays={},this.Qr=new Su(0),this.Kr=!1,this.Kr=!0,this.$r=new Q1e,this.referenceDelegate=e(this),this.Ur=new G1e(this),this.indexManager=new j1e,this.remoteDocumentCache=function(a){return new H1e(a)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new qZ(r),this.Gr=new L1e(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new U1e,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new V1e(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Ur("MemoryPersistence","Starting transaction:",e);const a=new K1e(this.Qr.next());return this.referenceDelegate.zr(),n(a).next(s=>this.referenceDelegate.jr(a).next(()=>s)).toPromise().then(s=>(a.raiseOnCommittedEvent(),s))}Hr(e,r){return Yt.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class K1e extends tZ{constructor(e){super(),this.currentSequenceNumber=e}}class RI{constructor(e){this.persistence=e,this.Jr=new p6,this.Yr=null}static Zr(e){return new RI(e)}get Xr(){if(this.Yr)return this.Yr;throw yn()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Yt.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Yt.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Yt.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(a=>this.Xr.add(a.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(a=>{a.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Yt.forEach(this.Xr,n=>{const a=an.fromPath(n);return this.ei(e,a).next(s=>{s||r.removeEntry(a,Bn.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Yt.or([()=>Yt.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q1e{constructor(e){this.serializer=e}O(e,r,n,a){const s=new II("createOrUpgrade",r);n<1&&a>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",T7,{unique:!0}),c.createObjectStore("documentMutations")}(e),x9(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=Yt.resolve();return n<3&&a>=3&&(n!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),x9(e)),o=o.next(()=>function(c){const d=c.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Bn.min().toTimestamp(),targetCount:0};return d.put("targetGlobalKey",u)}(s))),n<4&&a>=4&&(n!==0&&(o=o.next(()=>function(c,d){return d.store("mutations").U().next(u=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",T7,{unique:!0});const f=d.store("mutations"),A=u.map(h=>f.put(h));return Yt.waitFor(A)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),n<5&&a>=5&&(o=o.next(()=>this.ni(s))),n<6&&a>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),n<7&&a>=7&&(o=o.next(()=>this.ii(s))),n<8&&a>=8&&(o=o.next(()=>this.si(e,s))),n<9&&a>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&a>=10&&(o=o.next(()=>this.oi(s))),n<11&&a>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&a>=12&&(o=o.next(()=>{(function(c){const d=c.createObjectStore("documentOverlays",{keyPath:wve});d.createIndex("collectionPathOverlayIndex",Nve,{unique:!1}),d.createIndex("collectionGroupOverlayIndex",Cve,{unique:!1})})(e)})),n<13&&a>=13&&(o=o.next(()=>function(c){const d=c.createObjectStore("remoteDocumentsV14",{keyPath:uve});d.createIndex("documentKeyIndex",fve),d.createIndex("collectionGroupIndex",hve)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&a>=14&&(o=o.next(()=>this.ai(e,s))),n<15&&a>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:xve}).createIndex("sequenceNumberIndex",vve,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:yve}).createIndex("documentKeyIndex",bve,{unique:!1})}(e))),n<16&&a>=16&&(o=o.next(()=>{r.objectStore("indexState").clear()}).next(()=>{r.objectStore("indexEntries").clear()})),n<17&&a>=17&&(o=o.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let r=0;return e.store("remoteDocuments").J((n,a)=>{r+=vS(a)}).next(()=>{const n={byteSize:r};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}ni(e){const r=e.store("mutationQueues"),n=e.store("mutations");return r.U().next(a=>Yt.forEach(a,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",o).next(l=>Yt.forEach(l,c=>{jn(c.userId===s.userId);const d=bp(this.serializer,c);return JZ(e,s.userId,d).next(()=>{})}))}))}ii(e){const r=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(a=>{const s=[];return n.J((o,l)=>{const c=new Ka(o),d=function(f){return[0,Vc(f)]}(c);s.push(r.get(d).next(u=>u?Yt.resolve():(f=>r.put({targetId:0,path:Vc(f),sequenceNumber:a.highestListenSequenceNumber}))(c)))}).next(()=>Yt.waitFor(s))})}si(e,r){e.createObjectStore("collectionParents",{keyPath:gve});const n=r.store("collectionParents"),a=new m6,s=o=>{if(a.add(o)){const l=o.lastSegment(),c=o.popLast();return n.put({collectionId:l,parent:Vc(c)})}};return r.store("remoteDocuments").J({H:!0},(o,l)=>{const c=new Ka(o);return s(c.popLast())}).next(()=>r.store("documentMutations").J({H:!0},([o,l,c],d)=>{const u=eh(l);return s(u.popLast())}))}oi(e){const r=e.store("targets");return r.J((n,a)=>{const s=zy(a),o=zZ(this.serializer,s);return r.put(o)})}_i(e,r){const n=r.store("remoteDocuments"),a=[];return n.J((s,o)=>{const l=r.store("remoteDocumentsV14"),c=function(f){return f.document?new an(Ka.fromString(f.document.name).popFirst(5)):f.noDocument?an.fromSegments(f.noDocument.path):f.unknownDocument?an.fromSegments(f.unknownDocument.path):yn()}(o).path.toArray(),d={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};a.push(l.put(d))}).next(()=>Yt.waitFor(a))}ai(e,r){const n=r.store("mutations"),a=ree(this.serializer),s=new aee(RI.Zr,this.serializer.ct);return n.U().next(o=>{const l=new Map;return o.forEach(c=>{var d;let u=(d=l.get(c.userId))!==null&&d!==void 0?d:va();bp(this.serializer,c).keys().forEach(f=>u=u.add(f)),l.set(c.userId,u)}),Yt.forEach(l,(c,d)=>{const u=new Dl(d),f=OI.lt(this.serializer,u),A=s.getIndexManager(u),h=DI.lt(u,this.serializer,A,s.referenceDelegate);return new nee(a,h,f,A).recalculateAndSaveOverlaysForDocumentKeys(new ek(r,Su.oe),c).next()})})}}function x9(t){t.createObjectStore("targetDocuments",{keyPath:mve}).createIndex("documentTargetsIndex",pve,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Ave,{unique:!0}),t.createObjectStore("targetGlobal")}const F4="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class g6{constructor(e,r,n,a,s,o,l,c,d,u,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=r,this.clientId=n,this.ui=s,this.window=o,this.document=l,this.ci=d,this.li=u,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=A=>Promise.resolve(),!g6.D())throw new Xr(xr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new O1e(this,a),this.Ai=r+"main",this.serializer=new qZ(c),this.Ri=new hm(this.Ai,this.hi,new q1e(this.serializer)),this.$r=new w1e,this.Ur=new P1e(this.referenceDelegate,this.serializer),this.remoteDocumentCache=ree(this.serializer),this.Gr=new b1e,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,u===!1&&Mc("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Xr(xr.FAILED_PRECONDITION,F4);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Su(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async r=>{if(this.started)return e(r)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async r=>{r.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>cC(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(r=>{r||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(r=>this.isPrimary&&!r?this.bi(e).next(()=>!1):!!r&&this.Di(e).next(()=>!0))).catch(e=>{if(Vm(e))return Ur("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ur("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Ay(e).get("owner").next(r=>Yt.resolve(this.vi(r)))}Ci(e){return cC(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const n=zo(r,"clientMetadata");return n.U().next(a=>{const s=this.xi(a,18e5),o=a.filter(l=>s.indexOf(l)===-1);return Yt.forEach(o,l=>n.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const r of e)this.Vi.removeItem(this.Oi(r.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?Yt.resolve(!0):Ay(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)){if(this.vi(r)&&this.networkEnabled)return!0;if(!this.vi(r)){if(!r.allowTabSynchronization)throw new Xr(xr.FAILED_PRECONDITION,F4);return!1}}return!(!this.networkEnabled||!this.inForeground)||cC(e).U().next(n=>this.xi(n,5e3).find(a=>{if(this.clientId!==a.clientId){const s=!this.networkEnabled&&a.networkEnabled,o=!this.inForeground&&a.inForeground,l=this.networkEnabled===a.networkEnabled;if(s||o&&l)return!0}return!1})===void 0)}).next(r=>(this.isPrimary!==r&&Ur("IndexedDbPersistence",`Client ${r?"is":"is not"} eligible for a primary lease.`),r))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const r=new ek(e,Su.oe);return this.bi(r).next(()=>this.Ci(r))}),this.Ri.close(),this.qi()}xi(e,r){return e.filter(n=>this.Mi(n.updateTimeMs,r)&&!this.Ni(n.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>cC(e).U().next(r=>this.xi(r,18e5).map(n=>n.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,r){return DI.lt(e,this.serializer,r,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new I1e(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return OI.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,r,n){Ur("IndexedDbPersistence","Starting transaction:",e);const a=r==="readonly"?"readonly":"readwrite",s=function(c){return c===17?Sve:c===16?Eve:c===15?r6:c===14?iZ:c===13?sZ:c===12?_ve:c===11?aZ:void yn()}(this.hi);let o;return this.Ri.runTransaction(e,a,s,l=>(o=new ek(l,this.Qr?this.Qr.next():Su.oe),r==="readwrite-primary"?this.wi(o).next(c=>!!c||this.Si(o)).next(c=>{if(!c)throw Mc(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new Xr(xr.FAILED_PRECONDITION,eZ);return n(o)}).next(c=>this.Di(o).next(()=>c)):this.Ki(o).next(()=>n(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Ki(e){return Ay(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)&&!this.vi(r)&&!(this.li||this.allowTabSynchronization&&r.allowTabSynchronization))throw new Xr(xr.FAILED_PRECONDITION,F4)})}Di(e){const r={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ay(e).put("owner",r)}static D(){return hm.D()}bi(e){const r=Ay(e);return r.get("owner").next(n=>this.vi(n)?(Ur("IndexedDbPersistence","Releasing primary lease."),r.delete("owner")):Yt.resolve())}Mi(e,r){const n=Date.now();return!(e<n-r)&&(!(e>n)||(Mc(`Detected an update time that is in the future: ${e} > ${n}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const r=/(?:Version|Mobile)\/1[456]/;aJ()&&(navigator.appVersion.match(r)||navigator.userAgent.match(r))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var r;try{const n=((r=this.Vi)===null||r===void 0?void 0:r.getItem(this.Oi(e)))!==null;return Ur("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Mc("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Mc("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ay(t){return zo(t,"owner")}function cC(t){return zo(t,"clientMetadata")}function z1e(t,e){let r=t.projectId;return t.isDefaultDatabase||(r+="."+t.database),"firestore/"+e+"/"+r+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x6{constructor(e,r,n,a){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=a}static Wi(e,r){let n=va(),a=va();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}return new x6(e,r.fromCache,n,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1e{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class see{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return aJ()?8:rZ(Ko())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,a){const s={result:null};return this.Yi(e,r).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,r,a,n).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new W1e;return this.Xi(e,r,o).next(l=>{if(s.result=l,this.zi)return this.es(e,r,o,l.size)})}).next(()=>s.result)}es(e,r,n,a){return n.documentReadCount<this.ji?(jx()<=ja.DEBUG&&Ur("QueryEngine","SDK will not create cache indexes for query:",Ix(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Yt.resolve()):(jx()<=ja.DEBUG&&Ur("QueryEngine","Query:",Ix(r),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.Hi*a?(jx()<=ja.DEBUG&&Ur("QueryEngine","The SDK decides to create cache indexes for query:",Ix(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ku(r))):Yt.resolve())}Yi(e,r){if($7(r))return Yt.resolve(null);let n=ku(r);return this.indexManager.getIndexType(e,n).next(a=>a===0?null:(r.limit!==null&&a===1&&(r=pS(r,null,"F"),n=ku(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=va(...s);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(c=>{const d=this.ts(r,l);return this.ns(r,d,o,c.readTime)?this.Yi(e,pS(r,null,"F")):this.rs(e,d,r,c)}))})))}Zi(e,r,n,a){return $7(r)||a.isEqual(Bn.min())?Yt.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const o=this.ts(r,s);return this.ns(r,o,n,a)?Yt.resolve(null):(jx()<=ja.DEBUG&&Ur("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Ix(r)),this.rs(e,o,r,nve(a,-1)).next(l=>l))})}ts(e,r){let n=new _s(bZ(e));return r.forEach((a,s)=>{kw(e,s)&&(n=n.add(s))}),n}ns(e,r,n,a){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(a)>0)}Xi(e,r,n){return jx()<=ja.DEBUG&&Ur("QueryEngine","Using full collection scan to execute query:",Ix(r)),this.Ji.getDocumentsMatchingQuery(e,r,qd.min(),n)}rs(e,r,n,a){return this.Ji.getDocumentsMatchingQuery(e,n,a).next(s=>(r.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1e{constructor(e,r,n,a){this.persistence=e,this.ss=r,this.serializer=a,this.os=new mi(ca),this._s=new Hm(s=>ug(s),Tw),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new nee(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function iee(t,e,r,n){return new X1e(t,e,r,n)}async function oee(t,e){const r=Jn(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let a;return r.mutationQueue.getAllMutationBatches(n).next(s=>(a=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],l=[];let c=va();for(const d of a){o.push(d.batchId);for(const u of d.mutations)c=c.add(u.key)}for(const d of s){l.push(d.batchId);for(const u of d.mutations)c=c.add(u.key)}return r.localDocuments.getDocuments(n,c).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:l}))})})}function Y1e(t,e){const r=Jn(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const a=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,d,u){const f=d.batch,A=f.keys();let h=Yt.resolve();return A.forEach(m=>{h=h.next(()=>u.getEntry(c,m)).next(p=>{const x=d.docVersions.get(m);jn(x!==null),p.version.compareTo(x)<0&&(f.applyToRemoteDocument(p,d),p.isValidDocument()&&(p.setReadTime(d.commitVersion),u.addEntry(p)))})}),h.next(()=>l.mutationQueue.removeMutationBatch(c,f))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let c=va();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(c=c.add(l.batch.mutations[d].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,a))})}function lee(t){const e=Jn(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function J1e(t,e){const r=Jn(t),n=e.snapshotVersion;let a=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=r.cs.newChangeBuffer({trackRemovals:!0});a=r.os;const l=[];e.targetChanges.forEach((u,f)=>{const A=a.get(f);if(!A)return;l.push(r.Ur.removeMatchingKeys(s,u.removedDocuments,f).next(()=>r.Ur.addMatchingKeys(s,u.addedDocuments,f)));let h=A.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?h=h.withResumeToken(fo.EMPTY_BYTE_STRING,Bn.min()).withLastLimboFreeSnapshotVersion(Bn.min()):u.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(u.resumeToken,n)),a=a.insert(f,h),function(p,x,v){return p.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(A,h,u)&&l.push(r.Ur.updateTargetData(s,h))});let c=Ud(),d=va();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(s,u))}),l.push(Z1e(s,o,e.documentUpdates).next(u=>{c=u.Ps,d=u.Is})),!n.isEqual(Bn.min())){const u=r.Ur.getLastRemoteSnapshotVersion(s).next(f=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));l.push(u)}return Yt.waitFor(l).next(()=>o.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,c,d)).next(()=>c)}).then(s=>(r.os=a,s))}function Z1e(t,e,r){let n=va(),a=va();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let o=Ud();return r.forEach((l,c)=>{const d=s.get(l);c.isFoundDocument()!==d.isFoundDocument()&&(a=a.add(l)),c.isNoDocument()&&c.version.isEqual(Bn.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):Ur("LocalStore","Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",c.version)}),{Ps:o,Is:a}})}function eye(t,e){const r=Jn(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function tye(t,e){const r=Jn(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let a;return r.Ur.getTargetData(n,e).next(s=>s?(a=s,Yt.resolve(a)):r.Ur.allocateTargetId(n).next(o=>(a=new Zh(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,a).next(()=>a))))}).then(n=>{const a=r.os.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function Ak(t,e,r){const n=Jn(t),a=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,a))}catch(o){if(!Vm(o))throw o;Ur("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.os=n.os.remove(e),n._s.delete(a.target)}function v9(t,e,r){const n=Jn(t);let a=Bn.min(),s=va();return n.persistence.runTransaction("Execute query","readwrite",o=>function(c,d,u){const f=Jn(c),A=f._s.get(u);return A!==void 0?Yt.resolve(f.os.get(A)):f.Ur.getTargetData(d,u)}(n,o,ku(e)).next(l=>{if(l)return a=l.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{s=c})}).next(()=>n.ss.getDocumentsMatchingQuery(o,e,r?a:Bn.min(),r?s:va())).next(l=>(rye(n,Vve(e),l),{documents:l,Ts:s})))}function rye(t,e,r){let n=t.us.get(e)||Bn.min();r.forEach((a,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class y9{constructor(){this.activeTargetIds=zve()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class cee{constructor(){this.so=new y9,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new y9,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nye{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b9{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Ur("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Ur("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dC=null;function O4(){return dC===null?dC=function(){return 268435456+Math.round(2147483648*Math.random())}():dC++,"0x"+dC.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aye={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sye{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yl="WebChannelConnection";class iye extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${a}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${a}`:`project_id=${a}&database_id=${s}`}get Fo(){return!1}Mo(r,n,a,s,o){const l=O4(),c=this.xo(r,n.toUriEncodedString());Ur("RestConnection",`Sending RPC '${r}' ${l}:`,c,a);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,s,o),this.No(r,c,d,a).then(u=>(Ur("RestConnection",`Received RPC '${r}' ${l}: `,u),u),u=>{throw wm("RestConnection",`RPC '${r}' ${l} failed with error: `,u,"url: ",c,"request:",a),u})}Lo(r,n,a,s,o,l){return this.Mo(r,n,a,s,o)}Oo(r,n,a){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+h1}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,o)=>r[o]=s),a&&a.headers.forEach((s,o)=>r[o]=s)}xo(r,n){const a=aye[r];return`${this.Do}/v1/${n}:${a}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,a){const s=O4();return new Promise((o,l)=>{const c=new GJ;c.setWithCredentials(!0),c.listenOnce(KJ.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case dE.NO_ERROR:const u=c.getResponseJson();Ur(Yl,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(u)),o(u);break;case dE.TIMEOUT:Ur(Yl,`RPC '${e}' ${s} timed out`),l(new Xr(xr.DEADLINE_EXCEEDED,"Request time out"));break;case dE.HTTP_ERROR:const f=c.getStatus();if(Ur(Yl,`RPC '${e}' ${s} failed with status:`,f,"response text:",c.getResponseText()),f>0){let A=c.getResponseJson();Array.isArray(A)&&(A=A[0]);const h=A==null?void 0:A.error;if(h&&h.status&&h.message){const m=function(x){const v=x.toLowerCase().replace(/_/g,"-");return Object.values(xr).indexOf(v)>=0?v:xr.UNKNOWN}(h.status);l(new Xr(m,h.message))}else l(new Xr(xr.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Xr(xr.UNAVAILABLE,"Connection failed."));break;default:yn()}}finally{Ur(Yl,`RPC '${e}' ${s} completed.`)}});const d=JSON.stringify(a);Ur(Yl,`RPC '${e}' ${s} sending request:`,a),c.send(r,"POST",d,n,15)})}Bo(e,r,n){const a=O4(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=WJ(),l=zJ(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const u=s.join("");Ur(Yl,`Creating RPC '${e}' stream ${a}: ${u}`,c);const f=o.createWebChannel(u,c);let A=!1,h=!1;const m=new sye({Io:x=>{h?Ur(Yl,`Not sending because RPC '${e}' stream ${a} is closed:`,x):(A||(Ur(Yl,`Opening RPC '${e}' stream ${a} transport.`),f.open(),A=!0),Ur(Yl,`RPC '${e}' stream ${a} sending:`,x),f.send(x))},To:()=>f.close()}),p=(x,v,y)=>{x.listen(v,b=>{try{y(b)}catch(w){setTimeout(()=>{throw w},0)}})};return p(f,Gy.EventType.OPEN,()=>{h||(Ur(Yl,`RPC '${e}' stream ${a} transport opened.`),m.yo())}),p(f,Gy.EventType.CLOSE,()=>{h||(h=!0,Ur(Yl,`RPC '${e}' stream ${a} transport closed`),m.So())}),p(f,Gy.EventType.ERROR,x=>{h||(h=!0,wm(Yl,`RPC '${e}' stream ${a} transport errored:`,x),m.So(new Xr(xr.UNAVAILABLE,"The operation could not be completed")))}),p(f,Gy.EventType.MESSAGE,x=>{var v;if(!h){const y=x.data[0];jn(!!y);const b=y,w=b.error||((v=b[0])===null||v===void 0?void 0:v.error);if(w){Ur(Yl,`RPC '${e}' stream ${a} received error:`,w);const I=w.status;let j=function(E){const B=po[E];if(B!==void 0)return kZ(B)}(I),N=w.message;j===void 0&&(j=xr.INTERNAL,N="Unknown error status: "+I+" with message "+w.message),h=!0,m.So(new Xr(j,N)),f.close()}else Ur(Yl,`RPC '${e}' stream ${a} received:`,y),m.bo(y)}}),p(l,qJ.STAT_EVENT,x=>{x.stat===JB.PROXY?Ur(Yl,`RPC '${e}' stream ${a} detected buffering proxy`):x.stat===JB.NOPROXY&&Ur(Yl,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{m.wo()},0),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oye(){return typeof window<"u"?window:null}function gE(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MI(t){return new c1e(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v6{constructor(e,r,n=1e3,a=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=a,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),a=Math.max(0,r-n);a>0&&Ur("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,a,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dee{constructor(e,r,n,a,s,o,l,c){this.ui=e,this.Ho=n,this.Jo=a,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new v6(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===xr.RESOURCE_EXHAUSTED?(Mc(r.toString()),Mc("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===xr.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,a])=>{this.Yo===r&&this.P_(n,a)},n=>{e(()=>{const a=new Xr(xr.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(a)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(a=>{n(()=>this.I_(a))}),this.stream.onMessage(a=>{n(()=>++this.e_==1?this.E_(a):this.onNext(a))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Ur("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Ur("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class lye extends dee{constructor(e,r,n,a,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,a,o),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=h1e(this.serializer,e),n=function(s){if(!("targetChange"in s))return Bn.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Bn.min():o.readTime?pl(o.readTime):Bn.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=ck(this.serializer),r.addTarget=function(s,o){let l;const c=o.target;if(l=AS(c)?{documents:QZ(s,c)}:{query:VZ(s,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=DZ(s,o.resumeToken);const d=ok(s,o.expectedCount);d!==null&&(l.expectedCount=d)}else if(o.snapshotVersion.compareTo(Bn.min())>0){l.readTime=Uv(s,o.snapshotVersion.toTimestamp());const d=ok(s,o.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const n=m1e(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=ck(this.serializer),r.removeTarget=e,this.a_(r)}}class cye extends dee{constructor(e,r,n,a,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,a,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return jn(!!e.streamToken),this.lastStreamToken=e.streamToken,jn(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){jn(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=A1e(e.writeResults,e.commitTime),n=pl(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=ck(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>j2(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dye extends class{}{constructor(e,r,n,a){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=a,this.y_=!1}w_(){if(this.y_)throw new Xr(xr.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,lk(r,n),a,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===xr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Xr(xr.UNKNOWN,s.toString())})}Lo(e,r,n,a,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,lk(r,n),a,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===xr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Xr(xr.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class uye{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Mc(r),this.D_=!1):Ur("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fye{constructor(e,r,n,a,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{n.enqueueAndForget(async()=>{Rg(this)&&(Ur("RemoteStore","Restarting streams for network reachability change."),await async function(c){const d=Jn(c);d.L_.add(4),await Ow(d),d.q_.set("Unknown"),d.L_.delete(4),await LI(d)}(this))})}),this.q_=new uye(n,a)}}async function LI(t){if(Rg(t))for(const e of t.B_)await e(!0)}async function Ow(t){for(const e of t.B_)await e(!1)}function uee(t,e){const r=Jn(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),N6(r)?w6(r):g1(r).r_()&&b6(r,e))}function y6(t,e){const r=Jn(t),n=g1(r);r.N_.delete(e),n.r_()&&fee(r,e),r.N_.size===0&&(n.r_()?n.o_():Rg(r)&&r.q_.set("Unknown"))}function b6(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Bn.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}g1(t).A_(e)}function fee(t,e){t.Q_.xe(e),g1(t).R_(e)}function w6(t){t.Q_=new s1e({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),g1(t).start(),t.q_.v_()}function N6(t){return Rg(t)&&!g1(t).n_()&&t.N_.size>0}function Rg(t){return Jn(t).L_.size===0}function hee(t){t.Q_=void 0}async function hye(t){t.q_.set("Online")}async function Aye(t){t.N_.forEach((e,r)=>{b6(t,e)})}async function mye(t,e){hee(t),N6(t)?(t.q_.M_(e),w6(t)):t.q_.set("Unknown")}async function pye(t,e,r){if(t.q_.set("Online"),e instanceof OZ&&e.state===2&&e.cause)try{await async function(a,s){const o=s.cause;for(const l of s.targetIds)a.N_.has(l)&&(await a.remoteSyncer.rejectListen(l,o),a.N_.delete(l),a.Q_.removeTarget(l))}(t,e)}catch(n){Ur("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await yS(t,n)}else if(e instanceof pE?t.Q_.Ke(e):e instanceof FZ?t.Q_.He(e):t.Q_.We(e),!r.isEqual(Bn.min()))try{const n=await lee(t.localStore);r.compareTo(n)>=0&&await function(s,o){const l=s.Q_.rt(o);return l.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const u=s.N_.get(d);u&&s.N_.set(d,u.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,d)=>{const u=s.N_.get(c);if(!u)return;s.N_.set(c,u.withResumeToken(fo.EMPTY_BYTE_STRING,u.snapshotVersion)),fee(s,c);const f=new Zh(u.target,c,d,u.sequenceNumber);b6(s,f)}),s.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(n){Ur("RemoteStore","Failed to raise snapshot:",n),await yS(t,n)}}async function yS(t,e,r){if(!Vm(e))throw e;t.L_.add(1),await Ow(t),t.q_.set("Offline"),r||(r=()=>lee(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ur("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await LI(t)})}function Aee(t,e){return e().catch(r=>yS(t,r,e))}async function Dw(t){const e=Jn(t),r=Em(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;gye(e);)try{const a=await eye(e.localStore,n);if(a===null){e.O_.length===0&&r.o_();break}n=a.batchId,xye(e,a)}catch(a){await yS(e,a)}mee(e)&&pee(e)}function gye(t){return Rg(t)&&t.O_.length<10}function xye(t,e){t.O_.push(e);const r=Em(t);r.r_()&&r.V_&&r.m_(e.mutations)}function mee(t){return Rg(t)&&!Em(t).n_()&&t.O_.length>0}function pee(t){Em(t).start()}async function vye(t){Em(t).p_()}async function yye(t){const e=Em(t);for(const r of t.O_)e.m_(r.mutations)}async function bye(t,e,r){const n=t.O_.shift(),a=d6.from(n,e,r);await Aee(t,()=>t.remoteSyncer.applySuccessfulWrite(a)),await Dw(t)}async function wye(t,e){e&&Em(t).V_&&await async function(n,a){if(function(o){return BZ(o)&&o!==xr.ABORTED}(a.code)){const s=n.O_.shift();Em(n).s_(),await Aee(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,a)),await Dw(n)}}(t,e),mee(t)&&pee(t)}async function w9(t,e){const r=Jn(t);r.asyncQueue.verifyOperationInProgress(),Ur("RemoteStore","RemoteStore received new credentials");const n=Rg(r);r.L_.add(3),await Ow(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await LI(r)}async function Nye(t,e){const r=Jn(t);e?(r.L_.delete(2),await LI(r)):e||(r.L_.add(2),await Ow(r),r.q_.set("Unknown"))}function g1(t){return t.K_||(t.K_=function(r,n,a){const s=Jn(r);return s.w_(),new lye(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,a)}(t.datastore,t.asyncQueue,{Eo:hye.bind(null,t),Ro:Aye.bind(null,t),mo:mye.bind(null,t),d_:pye.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),N6(t)?w6(t):t.q_.set("Unknown")):(await t.K_.stop(),hee(t))})),t.K_}function Em(t){return t.U_||(t.U_=function(r,n,a){const s=Jn(r);return s.w_(),new cye(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,a)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:vye.bind(null,t),mo:wye.bind(null,t),f_:yye.bind(null,t),g_:bye.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Dw(t)):(await t.U_.stop(),t.O_.length>0&&(Ur("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C6{constructor(e,r,n,a,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=a,this.removalCallback=s,this.deferred=new wf,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,a,s){const o=Date.now()+n,l=new C6(e,r,o,a,s);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Xr(xr.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function _6(t,e){if(Mc("AsyncQueue",`${e}: ${t}`),Vm(t))return new Xr(xr.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv{constructor(e){this.comparator=e?(r,n)=>e(r,n)||an.comparator(r.key,n.key):(r,n)=>an.comparator(r.key,n.key),this.keyedMap=Ky(),this.sortedSet=new mi(this.comparator)}static emptySet(e){return new pv(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof pv)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,s=n.getNext().key;if(!a.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new pv;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N9{constructor(){this.W_=new mi(an.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):yn():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class Qv{constructor(e,r,n,a,s,o,l,c,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,a,s){const o=[];return r.forEach(l=>{o.push({type:0,doc:l})}),new Qv(e,r,pv.emptySet(r),o,n,a,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&TI(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==n[a].type||!r[a].doc.isEqual(n[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cye{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class _ye{constructor(){this.queries=C9(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const a=Jn(r),s=a.queries;a.queries=C9(),s.forEach((o,l)=>{for(const c of l.j_)c.onError(n)})})(this,new Xr(xr.ABORTED,"Firestore shutting down"))}}function C9(){return new Hm(t=>yZ(t),TI)}async function E6(t,e){const r=Jn(t);let n=3;const a=e.query;let s=r.queries.get(a);s?!s.H_()&&e.J_()&&(n=2):(s=new Cye,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(a,!0);break;case 1:s.z_=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(o){const l=_6(o,`Initialization of query '${Ix(e.query)}' failed`);return void e.onError(l)}r.queries.set(a,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&j6(r)}async function S6(t,e){const r=Jn(t),n=e.query;let a=3;const s=r.queries.get(n);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?a=e.J_()?0:1:!s.H_()&&e.J_()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function Eye(t,e){const r=Jn(t);let n=!1;for(const a of e){const s=a.query,o=r.queries.get(s);if(o){for(const l of o.j_)l.X_(a)&&(n=!0);o.z_=a}}n&&j6(r)}function Sye(t,e,r){const n=Jn(t),a=n.queries.get(e);if(a)for(const s of a.j_)s.onError(r);n.queries.delete(e)}function j6(t){t.Y_.forEach(e=>{e.next()})}var mk,_9;(_9=mk||(mk={})).ea="default",_9.Cache="cache";class I6{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new Qv(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=Qv.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==mk.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gee{constructor(e){this.key=e}}class xee{constructor(e){this.key=e}}class jye{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=va(),this.mutatedKeys=va(),this.Aa=bZ(e),this.Ra=new pv(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new N9,a=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,o=a,l=!1;const c=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,d=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((u,f)=>{const A=a.get(u),h=kw(this.query,f)?f:null,m=!!A&&this.mutatedKeys.has(A.key),p=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let x=!1;A&&h?A.data.isEqual(h.data)?m!==p&&(n.track({type:3,doc:h}),x=!0):this.ga(A,h)||(n.track({type:2,doc:h}),x=!0,(c&&this.Aa(h,c)>0||d&&this.Aa(h,d)<0)&&(l=!0)):!A&&h?(n.track({type:0,doc:h}),x=!0):A&&!h&&(n.track({type:1,doc:A}),x=!0,(c||d)&&(l=!0)),x&&(h?(o=o.add(h),s=p?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),n.track({type:1,doc:u})}return{Ra:o,fa:n,ns:l,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,a){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((u,f)=>function(h,m){const p=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return yn()}};return p(h)-p(m)}(u.type,f.type)||this.Aa(u.doc,f.doc)),this.pa(n),a=a!=null&&a;const l=r&&!a?this.ya():[],c=this.da.size===0&&this.current&&!a?1:0,d=c!==this.Ea;return this.Ea=c,o.length!==0||d?{snapshot:new Qv(this.query,e.Ra,s,o,e.mutatedKeys,c===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new N9,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=va(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new xee(n))}),this.da.forEach(n=>{e.has(n)||r.push(new gee(n))}),r}ba(e){this.Ta=e.Ts,this.da=va();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return Qv.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class Iye{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class Pye{constructor(e){this.key=e,this.va=!1}}class Tye{constructor(e,r,n,a,s,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=a,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Hm(l=>yZ(l),TI),this.Ma=new Map,this.xa=new Set,this.Oa=new mi(an.comparator),this.Na=new Map,this.La=new p6,this.Ba={},this.ka=new Map,this.qa=mg.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function Bye(t,e,r=!0){const n=Cee(t);let a;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),a=s.view.Da()):a=await vee(n,e,r,!0),a}async function kye(t,e){const r=Cee(t);await vee(r,e,!0,!1)}async function vee(t,e,r,n){const a=await tye(t.localStore,ku(e)),s=a.targetId,o=t.sharedClientState.addLocalQueryTarget(s,r);let l;return n&&(l=await Fye(t,e,s,o==="current",a.resumeToken)),t.isPrimaryClient&&r&&uee(t.remoteStore,a),l}async function Fye(t,e,r,n,a){t.Ka=(f,A,h)=>async function(p,x,v,y){let b=x.view.ma(v);b.ns&&(b=await v9(p.localStore,x.query,!1).then(({documents:N})=>x.view.ma(N,b)));const w=y&&y.targetChanges.get(x.targetId),I=y&&y.targetMismatches.get(x.targetId)!=null,j=x.view.applyChanges(b,p.isPrimaryClient,w,I);return S9(p,x.targetId,j.wa),j.snapshot}(t,f,A,h);const s=await v9(t.localStore,e,!0),o=new jye(e,s.Ts),l=o.ma(s.documents),c=Fw.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",a),d=o.applyChanges(l,t.isPrimaryClient,c);S9(t,r,d.wa);const u=new Iye(e,r,o);return t.Fa.set(e,u),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),d.snapshot}async function Oye(t,e,r){const n=Jn(t),a=n.Fa.get(e),s=n.Ma.get(a.targetId);if(s.length>1)return n.Ma.set(a.targetId,s.filter(o=>!TI(o,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await Ak(n.localStore,a.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(a.targetId),r&&y6(n.remoteStore,a.targetId),pk(n,a.targetId)}).catch(Og)):(pk(n,a.targetId),await Ak(n.localStore,a.targetId,!0))}async function Dye(t,e){const r=Jn(t),n=r.Fa.get(e),a=r.Ma.get(n.targetId);r.isPrimaryClient&&a.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),y6(r.remoteStore,n.targetId))}async function Rye(t,e,r){const n=_ee(t);try{const a=await function(o,l){const c=Jn(o),d=Nr.now(),u=l.reduce((h,m)=>h.add(m.key),va());let f,A;return c.persistence.runTransaction("Locally write mutations","readwrite",h=>{let m=Ud(),p=va();return c.cs.getEntries(h,u).next(x=>{m=x,m.forEach((v,y)=>{y.isValidDocument()||(p=p.add(v))})}).next(()=>c.localDocuments.getOverlayedDocuments(h,m)).next(x=>{f=x;const v=[];for(const y of l){const b=t1e(y,f.get(y.key).overlayedDocument);b!=null&&v.push(new LA(y.key,b,uZ(b.value.mapValue),ui.exists(!0)))}return c.mutationQueue.addMutationBatch(h,d,v,l)}).next(x=>{A=x;const v=x.applyToLocalDocumentSet(f,p);return c.documentOverlayCache.saveOverlays(h,x.batchId,v)})}).then(()=>({batchId:A.batchId,changes:NZ(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),function(o,l,c){let d=o.Ba[o.currentUser.toKey()];d||(d=new mi(ca)),d=d.insert(l,c),o.Ba[o.currentUser.toKey()]=d}(n,a.batchId,r),await Rw(n,a.changes),await Dw(n.remoteStore)}catch(a){const s=_6(a,"Failed to persist write");r.reject(s)}}async function yee(t,e){const r=Jn(t);try{const n=await J1e(r.localStore,e);e.targetChanges.forEach((a,s)=>{const o=r.Na.get(s);o&&(jn(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1),a.addedDocuments.size>0?o.va=!0:a.modifiedDocuments.size>0?jn(o.va):a.removedDocuments.size>0&&(jn(o.va),o.va=!1))}),await Rw(r,n,e)}catch(n){await Og(n)}}function E9(t,e,r){const n=Jn(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const a=[];n.Fa.forEach((s,o)=>{const l=o.view.Z_(e);l.snapshot&&a.push(l.snapshot)}),function(o,l){const c=Jn(o);c.onlineState=l;let d=!1;c.queries.forEach((u,f)=>{for(const A of f.j_)A.Z_(l)&&(d=!0)}),d&&j6(c)}(n.eventManager,e),a.length&&n.Ca.d_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function Mye(t,e,r){const n=Jn(t);n.sharedClientState.updateQueryState(e,"rejected",r);const a=n.Na.get(e),s=a&&a.key;if(s){let o=new mi(an.comparator);o=o.insert(s,ci.newNoDocument(s,Bn.min()));const l=va().add(s),c=new FI(Bn.min(),new Map,new mi(ca),o,l);await yee(n,c),n.Oa=n.Oa.remove(s),n.Na.delete(e),P6(n)}else await Ak(n.localStore,e,!1).then(()=>pk(n,e,r)).catch(Og)}async function Lye(t,e){const r=Jn(t),n=e.batch.batchId;try{const a=await Y1e(r.localStore,e);wee(r,n,null),bee(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Rw(r,a)}catch(a){await Og(a)}}async function Uye(t,e,r){const n=Jn(t);try{const a=await function(o,l){const c=Jn(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let u;return c.mutationQueue.lookupMutationBatch(d,l).next(f=>(jn(f!==null),u=f.keys(),c.mutationQueue.removeMutationBatch(d,f))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,u,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,u)).next(()=>c.localDocuments.getDocuments(d,u))})}(n.localStore,e);wee(n,e,r),bee(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Rw(n,a)}catch(a){await Og(a)}}function bee(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function wee(t,e,r){const n=Jn(t);let a=n.Ba[n.currentUser.toKey()];if(a){const s=a.get(e);s&&(r?s.reject(r):s.resolve(),a=a.remove(e)),n.Ba[n.currentUser.toKey()]=a}}function pk(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||Nee(t,n)})}function Nee(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(y6(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),P6(t))}function S9(t,e,r){for(const n of r)n instanceof gee?(t.La.addReference(n.key,e),Qye(t,n)):n instanceof xee?(Ur("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||Nee(t,n.key)):yn()}function Qye(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Ur("SyncEngine","New document in limbo: "+r),t.xa.add(n),P6(t))}function P6(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new an(Ka.fromString(e)),n=t.qa.next();t.Na.set(n,new Pye(r)),t.Oa=t.Oa.insert(r,n),uee(t.remoteStore,new Zh(ku(Bw(r.path)),n,"TargetPurposeLimboResolution",Su.oe))}}async function Rw(t,e,r){const n=Jn(t),a=[],s=[],o=[];n.Fa.isEmpty()||(n.Fa.forEach((l,c)=>{o.push(n.Ka(c,e,r).then(d=>{var u;if((d||r)&&n.isPrimaryClient){const f=d?!d.fromCache:(u=r==null?void 0:r.targetChanges.get(c.targetId))===null||u===void 0?void 0:u.current;n.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(d){a.push(d);const f=x6.Wi(c.targetId,d);s.push(f)}}))}),await Promise.all(o),n.Ca.d_(a),await async function(c,d){const u=Jn(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>Yt.forEach(d,A=>Yt.forEach(A.$i,h=>u.persistence.referenceDelegate.addReference(f,A.targetId,h)).next(()=>Yt.forEach(A.Ui,h=>u.persistence.referenceDelegate.removeReference(f,A.targetId,h)))))}catch(f){if(!Vm(f))throw f;Ur("LocalStore","Failed to update sequence numbers: "+f)}for(const f of d){const A=f.targetId;if(!f.fromCache){const h=u.os.get(A),m=h.snapshotVersion,p=h.withLastLimboFreeSnapshotVersion(m);u.os=u.os.insert(A,p)}}}(n.localStore,s))}async function Vye(t,e){const r=Jn(t);if(!r.currentUser.isEqual(e)){Ur("SyncEngine","User change. New user:",e.toKey());const n=await oee(r.localStore,e);r.currentUser=e,function(s,o){s.ka.forEach(l=>{l.forEach(c=>{c.reject(new Xr(xr.CANCELLED,o))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Rw(r,n.hs)}}function Hye(t,e){const r=Jn(t),n=r.Na.get(e);if(n&&n.va)return va().add(n.key);{let a=va();const s=r.Ma.get(e);if(!s)return a;for(const o of s){const l=r.Fa.get(o);a=a.unionWith(l.view.Va)}return a}}function Cee(t){const e=Jn(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=yee.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Hye.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Mye.bind(null,e),e.Ca.d_=Eye.bind(null,e.eventManager),e.Ca.$a=Sye.bind(null,e.eventManager),e}function _ee(t){const e=Jn(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Lye.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Uye.bind(null,e),e}class I2{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=MI(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return iee(this.persistence,new see,e.initialUser,this.serializer)}Ga(e){return new aee(RI.Zr,this.serializer)}Wa(e){return new cee}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}I2.provider={build:()=>new I2};class $ye extends I2{constructor(e,r,n){super(),this.Ja=e,this.cacheSizeBytes=r,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await _ee(this.Ja.syncEngine),await Dw(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return iee(this.persistence,new see,e.initialUser,this.serializer)}ja(e,r){const n=this.persistence.referenceDelegate.garbageCollector;return new B1e(n,e.asyncQueue,r)}Ha(e,r){const n=new ove(r,this.persistence);return new ive(e.asyncQueue,n)}Ga(e){const r=z1e(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?ad.withCacheSize(this.cacheSizeBytes):ad.DEFAULT;return new g6(this.synchronizeTabs,r,e.clientId,n,e.asyncQueue,oye(),gE(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new cee}}class bS{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>E9(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=Vye.bind(null,this.syncEngine),await Nye(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new _ye}()}createDatastore(e){const r=MI(e.databaseInfo.databaseId),n=function(s){return new iye(s)}(e.databaseInfo);return function(s,o,l,c){return new dye(s,o,l,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,a,s,o,l){return new fye(n,a,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,r=>E9(this.syncEngine,r,0),function(){return b9.D()?new b9:new nye}())}createSyncEngine(e,r){return function(a,s,o,l,c,d,u){const f=new Tye(a,s,o,l,c,d);return u&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(a){const s=Jn(a);Ur("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Ow(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}bS.provider={build:()=>new bS};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T6{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Mc("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gye{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Xr(xr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const r=await async function(a,s){const o=Jn(a),l={documents:s.map(f=>S2(o.serializer,f))},c=await o.Lo("BatchGetDocuments",o.serializer.databaseId,Ka.emptyPath(),l,s.length),d=new Map;c.forEach(f=>{const A=f1e(o.serializer,f);d.set(A.key.toString(),A)});const u=[];return s.forEach(f=>{const A=d.get(f.toString());jn(!!A),u.push(A)}),u}(this.datastore,e);return r.forEach(n=>this.recordVersion(n)),r}set(e,r){this.write(r.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,r){try{this.write(r.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new p1(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(r=>{e.delete(r.key.toString())}),e.forEach((r,n)=>{const a=an.fromPath(n);this.mutations.push(new l6(a,this.precondition(a)))}),await async function(n,a){const s=Jn(n),o={writes:a.map(l=>j2(s.serializer,l))};await s.Mo("Commit",s.serializer.databaseId,Ka.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let r;if(e.isFoundDocument())r=e.version;else{if(!e.isNoDocument())throw yn();r=Bn.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!r.isEqual(n))throw new Xr(xr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),r)}precondition(e){const r=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&r?r.isEqual(Bn.min())?ui.exists(!1):ui.updateTime(r):ui.none()}preconditionForUpdate(e){const r=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&r){if(r.isEqual(Bn.min()))throw new Xr(xr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ui.updateTime(r)}return ui.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kye{constructor(e,r,n,a,s){this.asyncQueue=e,this.datastore=r,this.options=n,this.updateFunction=a,this.deferred=s,this._u=n.maxAttempts,this.t_=new v6(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new Gye(this.datastore),r=this.cu(e);r&&r.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(a=>{this.lu(a)}))}).catch(n=>{this.lu(n)})})}cu(e){try{const r=this.updateFunction(e);return!Pw(r)&&r.catch&&r.then?r:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(r){return this.deferred.reject(r),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const r=e.code;return r==="aborted"||r==="failed-precondition"||r==="already-exists"||!BZ(r)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qye{constructor(e,r,n,a,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=a,this.user=Dl.UNAUTHENTICATED,this.clientId=ZD.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async o=>{Ur("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(Ur("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new wf;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=_6(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function D4(t,e){t.asyncQueue.verifyOperationInProgress(),Ur("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async a=>{n.isEqual(a)||(await oee(e.localStore,a),n=a)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function j9(t,e){t.asyncQueue.verifyOperationInProgress();const r=await zye(t);Ur("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>w9(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,a)=>w9(e.remoteStore,a)),t._onlineComponents=e}async function zye(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ur("FirestoreClient","Using user provided OfflineComponentProvider");try{await D4(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(a){return a.name==="FirebaseError"?a.code===xr.FAILED_PRECONDITION||a.code===xr.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11}(r))throw r;wm("Error using user provided cache. Falling back to memory cache: "+r),await D4(t,new I2)}}else Ur("FirestoreClient","Using default OfflineComponentProvider"),await D4(t,new I2);return t._offlineComponents}async function B6(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ur("FirestoreClient","Using user provided OnlineComponentProvider"),await j9(t,t._uninitializedComponentsProvider._online)):(Ur("FirestoreClient","Using default OnlineComponentProvider"),await j9(t,new bS))),t._onlineComponents}function Wye(t){return B6(t).then(e=>e.syncEngine)}function Xye(t){return B6(t).then(e=>e.datastore)}async function wS(t){const e=await B6(t),r=e.eventManager;return r.onListen=Bye.bind(null,e.syncEngine),r.onUnlisten=Oye.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=kye.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=Dye.bind(null,e.syncEngine),r}function Yye(t,e,r={}){const n=new wf;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,d){const u=new T6({next:A=>{u.Za(),o.enqueueAndForget(()=>S6(s,f));const h=A.docs.has(l);!h&&A.fromCache?d.reject(new Xr(xr.UNAVAILABLE,"Failed to get document because the client is offline.")):h&&A.fromCache&&c&&c.source==="server"?d.reject(new Xr(xr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(A)},error:A=>d.reject(A)}),f=new I6(Bw(l.path),u,{includeMetadataChanges:!0,_a:!0});return E6(s,f)}(await wS(t),t.asyncQueue,e,r,n)),n.promise}function Jye(t,e,r={}){const n=new wf;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,d){const u=new T6({next:A=>{u.Za(),o.enqueueAndForget(()=>S6(s,f)),A.fromCache&&c.source==="server"?d.reject(new Xr(xr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(A)},error:A=>d.reject(A)}),f=new I6(l,u,{includeMetadataChanges:!0,_a:!0});return E6(s,f)}(await wS(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eee(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I9=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function See(t,e,r){if(!r)throw new Xr(xr.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function jee(t,e,r,n){if(e===!0&&n===!0)throw new Xr(xr.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function P9(t){if(!an.isDocumentKey(t))throw new Xr(xr.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function T9(t){if(an.isDocumentKey(t))throw new Xr(xr.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function UI(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":yn()}function gl(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Xr(xr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=UI(t);throw new Xr(xr.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B9{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Xr(xr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Xr(xr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}jee("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Eee((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Xr(xr.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Xr(xr.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Xr(xr.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,a){return n.timeoutSeconds===a.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class QI{constructor(e,r,n,a){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new B9({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Xr(xr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Xr(xr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new B9(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new YJ;switch(n.type){case"firstParty":return new Jxe(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Xr(xr.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=I9.get(r);n&&(Ur("ComponentProvider","Removing Datastore"),I9.delete(r),n.terminate())}(this),Promise.resolve()}}function Iee(t,e,r,n={}){var a;const s=(t=gl(t,QI))._getSettings(),o=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&wm("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),n.mockUserToken){let l,c;if(typeof n.mockUserToken=="string")l=n.mockUserToken,c=Dl.MOCK_USER;else{l=Ame(n.mockUserToken,(a=t._app)===null||a===void 0?void 0:a.options.projectId);const d=n.mockUserToken.sub||n.mockUserToken.user_id;if(!d)throw new Xr(xr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Dl(d)}t._authCredentials=new Wxe(new XJ(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gh{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new gh(this.firestore,e,this._query)}}class xl{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new lA(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new xl(this.firestore,e,this._key)}}class lA extends gh{constructor(e,r,n){super(e,r,Bw(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new xl(this.firestore,null,new an(e))}withConverter(e){return new lA(this.firestore,e,this._path)}}function xt(t,e,...r){if(t=Ii(t),See("collection","path",e),t instanceof QI){const n=Ka.fromString(e,...r);return T9(n),new lA(t,null,n)}{if(!(t instanceof xl||t instanceof lA))throw new Xr(xr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Ka.fromString(e,...r));return T9(n),new lA(t.firestore,null,n)}}function Kt(t,e,...r){if(t=Ii(t),arguments.length===1&&(e=ZD.newId()),See("doc","path",e),t instanceof QI){const n=Ka.fromString(e,...r);return P9(n),new xl(t,null,new an(n))}{if(!(t instanceof xl||t instanceof lA))throw new Xr(xr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Ka.fromString(e,...r));return P9(n),new xl(t.firestore,t instanceof lA?t.converter:null,new an(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k9{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new v6(this,"async_queue_retry"),this.Vu=()=>{const n=gE();n&&Ur("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=gE();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=gE();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new wf;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Vm(e))throw e;Ur("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const a=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(n);throw Mc("INTERNAL UNHANDLED ERROR: ",a),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const a=C6.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(a),a}fu(){this.Eu&&yn()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function F9(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const a=r;for(const s of n)if(s in a&&typeof a[s]=="function")return!0;return!1}(t,["next","error","complete"])}class zd extends QI{constructor(e,r,n,a){super(e,r,n,a),this.type="firestore",this._queue=new k9,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new k9(e),this._firestoreClient=void 0,await e}}}function Pee(t,e){const r=typeof t=="object"?t:LD(),n=typeof t=="string"?t:"(default)",a=RD(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const s=fme("firestore");s&&Iee(a,...s)}return a}function Mg(t){if(t._terminated)throw new Xr(xr.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Tee(t),t._firestoreClient}function Tee(t){var e,r,n;const a=t._freezeSettings(),s=function(l,c,d,u){return new Ive(l,c,d,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,Eee(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,a);t._componentsProvider||!((r=a.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=a.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),t._firestoreClient=new qye(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}function Bee(t,e){wm("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings();return Zye(t,bS.provider,{build:n=>new $ye(n,r.cacheSizeBytes,void 0)}),Promise.resolve()}function Zye(t,e,r){if((t=gl(t,zd))._firestoreClient||t._terminated)throw new Xr(xr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new Xr(xr.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:r},Tee(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Sm(fo.fromBase64String(e))}catch(r){throw new Xr(xr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Sm(fo.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lg{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Xr(xr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new di(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VI{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Xr(xr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Xr(xr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ca(this._lat,e._lat)||ca(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HI{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,a){if(n.length!==a.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==a[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ebe=/^__.*__$/;class tbe{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new LA(e,this.data,this.fieldMask,r,this.fieldTransforms):new m1(e,this.data,r,this.fieldTransforms)}}class kee{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new LA(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function Fee(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw yn()}}class $I{constructor(e,r,n,a,s,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=a,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new $I(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.Fu({path:n,xu:!1});return a.Ou(e),a}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.Fu({path:n,xu:!1});return a.vu(),a}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return NS(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Fee(this.Cu)&&ebe.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class rbe{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||MI(e)}Qu(e,r,n,a=!1){return new $I({Cu:e,methodName:r,qu:n,path:di.emptyPath(),xu:!1,ku:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function v1(t){const e=t._freezeSettings(),r=MI(t._databaseId);return new rbe(t._databaseId,!!e.ignoreUndefinedProperties,r)}function GI(t,e,r,n,a,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,r,a);R6("Data must be an object, but it was:",o,n);const l=Oee(n,o);let c,d;if(s.merge)c=new cd(o.fieldMask),d=o.fieldTransforms;else if(s.mergeFields){const u=[];for(const f of s.mergeFields){const A=gk(e,f,r);if(!o.contains(A))throw new Xr(xr.INVALID_ARGUMENT,`Field '${A}' is specified in your field mask but missing from your input data.`);Ree(u,A)||u.push(A)}c=new cd(u),d=o.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,d=o.fieldTransforms;return new tbe(new Ll(l),c,d)}class KI extends x1{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof KI}}function nbe(t,e,r){return new $I({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:r},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class k6 extends x1{_toFieldTransform(e){return new o6(e.path,new Mv)}isEqual(e){return e instanceof k6}}class F6 extends x1{constructor(e,r){super(e),this.Ku=r}_toFieldTransform(e){const r=nbe(this,e,!0),n=this.Ku.map(s=>y1(s,r)),a=new fg(n);return new o6(e.path,a)}isEqual(e){return e instanceof F6&&A2(this.Ku,e.Ku)}}function O6(t,e,r,n){const a=t.Qu(1,e,r);R6("Data must be an object, but it was:",a,n);const s=[],o=Ll.empty();Dg(n,(c,d)=>{const u=M6(e,c,r);d=Ii(d);const f=a.Nu(u);if(d instanceof KI)s.push(u);else{const A=y1(d,f);A!=null&&(s.push(u),o.set(u,A))}});const l=new cd(s);return new kee(o,l,a.fieldTransforms)}function D6(t,e,r,n,a,s){const o=t.Qu(1,e,r),l=[gk(e,n,r)],c=[a];if(s.length%2!=0)throw new Xr(xr.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let A=0;A<s.length;A+=2)l.push(gk(e,s[A])),c.push(s[A+1]);const d=[],u=Ll.empty();for(let A=l.length-1;A>=0;--A)if(!Ree(d,l[A])){const h=l[A];let m=c[A];m=Ii(m);const p=o.Nu(h);if(m instanceof KI)d.push(h);else{const x=y1(m,p);x!=null&&(d.push(h),u.set(h,x))}}const f=new cd(d);return new kee(u,f,o.fieldTransforms)}function abe(t,e,r,n=!1){return y1(r,t.Qu(n?4:3,e))}function y1(t,e){if(Dee(t=Ii(t)))return R6("Unsupported field value:",e,t),Oee(t,e);if(t instanceof x1)return function(n,a){if(!Fee(a.Cu))throw a.Bu(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(a);s&&a.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,a){const s=[];let o=0;for(const l of n){let c=y1(l,a.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(n,a){if((n=Ii(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Wve(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Nr.fromDate(n);return{timestampValue:Uv(a.serializer,s)}}if(n instanceof Nr){const s=new Nr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Uv(a.serializer,s)}}if(n instanceof VI)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Sm)return{bytesValue:DZ(a.serializer,n._byteString)};if(n instanceof xl){const s=a.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw a.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:h6(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof HI)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return i6(l.serializer,c)})}}}}}}(n,a);throw a.Bu(`Unsupported field value: ${UI(n)}`)}(t,e)}function Oee(t,e){const r={};return oZ(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Dg(t,(n,a)=>{const s=y1(a,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function Dee(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Nr||t instanceof VI||t instanceof Sm||t instanceof xl||t instanceof x1||t instanceof HI)}function R6(t,e,r){if(!Dee(r)||!function(a){return typeof a=="object"&&a!==null&&(Object.getPrototypeOf(a)===Object.prototype||Object.getPrototypeOf(a)===null)}(r)){const n=UI(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function gk(t,e,r){if((e=Ii(e))instanceof Lg)return e._internalPath;if(typeof e=="string")return M6(t,e);throw NS("Field path arguments must be of type string or ",t,!1,void 0,r)}const sbe=new RegExp("[~\\*/\\[\\]]");function M6(t,e,r){if(e.search(sbe)>=0)throw NS(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Lg(...e.split("."))._internalPath}catch{throw NS(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function NS(t,e,r,n,a){const s=n&&!n.isEmpty(),o=a!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${n}`),o&&(c+=` in document ${a}`),c+=")"),new Xr(xr.INVALID_ARGUMENT,l+t+c)}function Ree(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CS{constructor(e,r,n,a,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=a,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new xl(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new ibe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(qI("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class ibe extends CS{data(){return super.data()}}function qI(t,e){return typeof e=="string"?M6(t,e):e instanceof Lg?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mee(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Xr(xr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class L6{}class zI extends L6{}function ar(t,e,...r){let n=[];e instanceof L6&&n.push(e),n=n.concat(r),function(s){const o=s.filter(c=>c instanceof WI).length,l=s.filter(c=>c instanceof Mw).length;if(o>1||o>0&&l>0)throw new Xr(xr.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const a of n)t=a._apply(t);return t}class Mw extends zI{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Mw(e,r,n)}_apply(e){const r=this._parse(e);return Lee(e._query,r),new gh(e.firestore,e.converter,ik(e._query,r))}_parse(e){const r=v1(e.firestore);return function(s,o,l,c,d,u,f){let A;if(d.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Xr(xr.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){D9(f,u);const h=[];for(const m of f)h.push(O9(c,s,m));A={arrayValue:{values:h}}}else A=O9(c,s,f)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||D9(f,u),A=abe(l,o,f,u==="in"||u==="not-in");return Ia.create(d,u,A)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function lr(t,e,r){const n=e,a=qI("where",t);return Mw._create(a,n,r)}class WI extends L6{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new WI(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:ps.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(a,s){let o=a;const l=s.getFlattenedFilters();for(const c of l)Lee(o,c),o=ik(o,c)}(e._query,r),new gh(e.firestore,e.converter,ik(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class XI extends zI{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new XI(e,r)}_apply(e){const r=function(a,s,o){if(a.startAt!==null)throw new Xr(xr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new Xr(xr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new _2(s,o)}(e._query,this._field,this._direction);return new gh(e.firestore,e.converter,function(a,s){const o=a.explicitOrderBy.concat([s]);return new A1(a.path,a.collectionGroup,o,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)}(e._query,r))}}function kn(t,e="asc"){const r=e,n=qI("orderBy",t);return XI._create(n,r)}class YI extends zI{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new YI(e,r,n)}_apply(e){return new gh(e.firestore,e.converter,pS(e._query,this._limit,this._limitType))}}function _S(t){return YI._create("limit",t,"F")}function O9(t,e,r){if(typeof(r=Ii(r))=="string"){if(r==="")throw new Xr(xr.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!vZ(e)&&r.indexOf("/")!==-1)throw new Xr(xr.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Ka.fromString(r));if(!an.isDocumentKey(n))throw new Xr(xr.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return N2(t,new an(n))}if(r instanceof xl)return N2(t,r._key);throw new Xr(xr.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${UI(r)}.`)}function D9(t,e){if(!Array.isArray(t)||t.length===0)throw new Xr(xr.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Lee(t,e){const r=function(a,s){for(const o of a)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Xr(xr.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Xr(xr.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class U6{convertValue(e,r="none"){switch(dg(e)){case 0:return null;case 1:return e.booleanValue;case 2:return oi(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Nm(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw yn()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Dg(e,(a,s)=>{n[a]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,a;const s=(a=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||a===void 0?void 0:a.map(o=>oi(o.doubleValue));return new HI(s)}convertGeoPoint(e){return new VI(oi(e.latitude),oi(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=a6(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(b2(e));default:return null}}convertTimestamp(e){const r=wA(e);return new Nr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Ka.fromString(e);jn(KZ(n));const a=new Cm(n.get(1),n.get(3)),s=new an(n.popFirst(5));return a.isEqual(r)||Mc(`Document ${s} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JI(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class obe extends U6{constructor(e){super(),this.firestore=e}convertBytes(e){return new Sm(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new xl(this.firestore,null,r)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ZI extends CS{constructor(e,r,n,a,s,o){super(e,r,n,a,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Eb(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(qI("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class Eb extends ZI{data(e={}){return super.data(e)}}class Q6{constructor(e,r,n,a){this._firestore=e,this._userDataWriter=r,this._snapshot=a,this.metadata=new Ip(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Eb(this._firestore,this._userDataWriter,n.key,n,new Ip(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Xr(xr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(a,s){if(a._snapshot.oldDocs.isEmpty()){let o=0;return a._snapshot.docChanges.map(l=>{const c=new Eb(a._firestore,a._userDataWriter,l.doc.key,l.doc,new Ip(a._snapshot.mutatedKeys.has(l.doc.key),a._snapshot.fromCache),a.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const c=new Eb(a._firestore,a._userDataWriter,l.doc.key,l.doc,new Ip(a._snapshot.mutatedKeys.has(l.doc.key),a._snapshot.fromCache),a.query.converter);let d=-1,u=-1;return l.type!==0&&(d=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),u=o.indexOf(l.doc.key)),{type:lbe(l.type),doc:c,oldIndex:d,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function lbe(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return yn()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Es(t){t=gl(t,xl);const e=gl(t.firestore,zd);return Yye(Mg(e),t._key).then(r=>Qee(e,t,r))}class eP extends U6{constructor(e){super(),this.firestore=e}convertBytes(e){return new Sm(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new xl(this.firestore,null,r)}}function Ut(t){t=gl(t,gh);const e=gl(t.firestore,zd),r=Mg(e),n=new eP(e);return Mee(t._query),Jye(r,t._query).then(a=>new Q6(e,n,t,a))}function Uee(t,e,r){t=gl(t,xl);const n=gl(t.firestore,zd),a=JI(t.converter,e,r);return b1(n,[GI(v1(n),"setDoc",t._key,a,t.converter!==null,r).toMutation(t._key,ui.none())])}function Mn(t,e,r,...n){t=gl(t,xl);const a=gl(t.firestore,zd),s=v1(a);let o;return o=typeof(e=Ii(e))=="string"||e instanceof Lg?D6(s,"updateDoc",t._key,e,r,n):O6(s,"updateDoc",t._key,e),b1(a,[o.toMutation(t._key,ui.exists(!0))])}function na(t){return b1(gl(t.firestore,zd),[new p1(t._key,ui.none())])}function ta(t,e){const r=gl(t.firestore,zd),n=Kt(t),a=JI(t.converter,e);return b1(r,[GI(v1(t.firestore),"addDoc",n._key,a,t.converter!==null,{}).toMutation(n._key,ui.exists(!1))]).then(()=>n)}function Fu(t,...e){var r,n,a;t=Ii(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||F9(e[o])||(s=e[o],o++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(F9(e[o])){const f=e[o];e[o]=(r=f.next)===null||r===void 0?void 0:r.bind(f),e[o+1]=(n=f.error)===null||n===void 0?void 0:n.bind(f),e[o+2]=(a=f.complete)===null||a===void 0?void 0:a.bind(f)}let c,d,u;if(t instanceof xl)d=gl(t.firestore,zd),u=Bw(t._key.path),c={next:f=>{e[o]&&e[o](Qee(d,t,f))},error:e[o+1],complete:e[o+2]};else{const f=gl(t,gh);d=gl(f.firestore,zd),u=f._query;const A=new eP(d);c={next:h=>{e[o]&&e[o](new Q6(d,A,f,h))},error:e[o+1],complete:e[o+2]},Mee(t._query)}return function(A,h,m,p){const x=new T6(p),v=new I6(h,x,m);return A.asyncQueue.enqueueAndForget(async()=>E6(await wS(A),v)),()=>{x.Za(),A.asyncQueue.enqueueAndForget(async()=>S6(await wS(A),v))}}(Mg(d),u,l,c)}function b1(t,e){return function(n,a){const s=new wf;return n.asyncQueue.enqueueAndForget(async()=>Rye(await Wye(n),a,s)),s.promise}(Mg(t),e)}function Qee(t,e,r){const n=r.docs.get(e._key),a=new eP(t);return new ZI(t,a,e._key,n,new Ip(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cbe={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vee{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=v1(e)}set(e,r,n){this._verifyNotCommitted();const a=V0(e,this._firestore),s=JI(a.converter,r,n),o=GI(this._dataReader,"WriteBatch.set",a._key,s,a.converter!==null,n);return this._mutations.push(o.toMutation(a._key,ui.none())),this}update(e,r,n,...a){this._verifyNotCommitted();const s=V0(e,this._firestore);let o;return o=typeof(r=Ii(r))=="string"||r instanceof Lg?D6(this._dataReader,"WriteBatch.update",s._key,r,n,a):O6(this._dataReader,"WriteBatch.update",s._key,r),this._mutations.push(o.toMutation(s._key,ui.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=V0(e,this._firestore);return this._mutations=this._mutations.concat(new p1(r._key,ui.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Xr(xr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function V0(t,e){if((t=Ii(t)).firestore!==e)throw new Xr(xr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hee extends class{constructor(r,n){this._firestore=r,this._transaction=n,this._dataReader=v1(r)}get(r){const n=V0(r,this._firestore),a=new obe(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return yn();const o=s[0];if(o.isFoundDocument())return new CS(this._firestore,a,o.key,o,n.converter);if(o.isNoDocument())return new CS(this._firestore,a,n._key,null,n.converter);throw yn()})}set(r,n,a){const s=V0(r,this._firestore),o=JI(s.converter,n,a),l=GI(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,a);return this._transaction.set(s._key,l),this}update(r,n,a,...s){const o=V0(r,this._firestore);let l;return l=typeof(n=Ii(n))=="string"||n instanceof Lg?D6(this._dataReader,"Transaction.update",o._key,n,a,s):O6(this._dataReader,"Transaction.update",o._key,n),this._transaction.update(o._key,l),this}delete(r){const n=V0(r,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,r){super(e,r),this._firestore=e}get(e){const r=V0(e,this._firestore),n=new eP(this._firestore);return super.get(e).then(a=>new ZI(this._firestore,n,r._key,a._document,new Ip(!1,!1),r.converter))}}function fi(t,e,r){t=gl(t,zd);const n=Object.assign(Object.assign({},cbe),r);return function(s){if(s.maxAttempts<1)throw new Xr(xr.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(s,o,l){const c=new wf;return s.asyncQueue.enqueueAndForget(async()=>{const d=await Xye(s);new Kye(s.asyncQueue,d,l,o,c).au()}),c.promise}(Mg(t),a=>e(new Hee(t,a)),n)}function tP(){return new k6("serverTimestamp")}function $ee(...t){return new F6("arrayUnion",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lc(t){return Mg(t=gl(t,zd)),new Vee(t,e=>b1(t,e))}(function(e,r=!0){(function(a){h1=a})(u1),kv(new ig("firestore",(n,{instanceIdentifier:a,options:s})=>{const o=n.getProvider("app").getImmediate(),l=new zd(new Xxe(n.getProvider("auth-internal")),new eve(n.getProvider("app-check-internal")),function(d,u){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Xr(xr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Cm(d.options.projectId,u)}(o,a),o);return s=Object.assign({useFetchStreams:r},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),fm(j7,"4.7.3",e),fm(j7,"4.7.3","esm2017")})();const dbe=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:U6,Bytes:Sm,CollectionReference:lA,DocumentReference:xl,DocumentSnapshot:ZI,FieldPath:Lg,FieldValue:x1,Firestore:zd,FirestoreError:Xr,GeoPoint:VI,Query:gh,QueryCompositeFilterConstraint:WI,QueryConstraint:zI,QueryDocumentSnapshot:Eb,QueryFieldFilterConstraint:Mw,QueryLimitConstraint:YI,QueryOrderByConstraint:XI,QuerySnapshot:Q6,SnapshotMetadata:Ip,Timestamp:Nr,Transaction:Hee,VectorValue:HI,WriteBatch:Vee,_AutoId:ZD,_ByteString:fo,_DatabaseId:Cm,_DocumentKey:an,_EmptyAuthCredentialsProvider:YJ,_FieldPath:di,_cast:gl,_logWarn:wm,_validateIsNotUsedTogether:jee,addDoc:ta,arrayUnion:$ee,collection:xt,connectFirestoreEmulator:Iee,deleteDoc:na,doc:Kt,enableIndexedDbPersistence:Bee,ensureFirestoreConfigured:Mg,executeWrite:b1,getDoc:Es,getDocs:Ut,getFirestore:Pee,limit:_S,onSnapshot:Fu,orderBy:kn,query:ar,runTransaction:fi,serverTimestamp:tP,setDoc:Uee,updateDoc:Mn,where:lr,writeBatch:Lc},Symbol.toStringTag,{value:"Module"})),ube={apiKey:"AIzaSyA_ZzeP_DAoXeRuallrOaJ4xFaxjnuhw-8",authDomain:"posys-103de.firebaseapp.com",projectId:"posys-103de",storageBucket:"posys-103de.firebasestorage.app",messagingSenderId:"401054148688",appId:"1:401054148688:web:1c2aea9e8b40958b514955",measurementId:"G-Q2GWQXMFLX"},Gee=MD(ube),Ne=Pee(Gee),Vi=YB(Gee),fbe=(async()=>{try{return await oE(Vi,zD),console.info(" Auth persistence: browserLocalPersistence enabled"),"local"}catch(t){console.warn(" browserLocalPersistence failed:",(t==null?void 0:t.code)||t)}try{return await oE(Vi,QJ),console.info(" Auth persistence: indexedDBLocalPersistence enabled"),"indexeddb"}catch(t){console.warn(" indexedDBLocalPersistence failed:",(t==null?void 0:t.code)||t)}try{return await oE(Vi,WD),console.info(" Auth persistence: browserSessionPersistence enabled (session only)"),"session"}catch(t){console.warn(" browserSessionPersistence failed:",(t==null?void 0:t.code)||t)}return console.warn(" No se pudo establecer ninguna persistencia para Auth."),"none"})();Bee(Ne).catch(t=>{t.code==="failed-precondition"?console.warn(" Ya hay otra pestaa usando persistencia."):t.code==="unimplemented"?console.warn(" El navegador no soporta persistencia offline."):console.error(" Error en persistencia offline:",t)});function hbe(){const[t,e]=g.useState(""),[r,n]=g.useState(""),[a,s]=g.useState(!1),[o,l]=g.useState(""),[c,d]=g.useState(!1),u=ww();g.useEffect(()=>{let h=!0;const m=EI(Vi,async p=>{if(!(!p||!h))try{const x=await Es(Kt(Ne,"users",p.uid));if(!x.exists())return;const v=x.data(),y=Array.isArray(v.roles)?v.roles:v.role?[v.role]:[],b=y[0]||"",w=v.name||"";localStorage.setItem("user_email",p.email||""),w&&localStorage.setItem("user_name",w),localStorage.setItem("roles",JSON.stringify(y)),y.length===1?f(b):u("/admin",{replace:!0})}catch{}});return()=>{h=!1,m()}},[u]);const f=h=>{if(Array.isArray(h)){if(h.length!==1)return localStorage.setItem("role",h[0]||""),u("/admin");h=h[0]||""}const m=String(h||"");if(localStorage.setItem("role",m),Rn(m,"admin"))return u("/admin");if(Rn(m,"vendedor_pollo"))return u("/admin/salesV2");if(Rn(m,"vendedor_ropa"))return u("/admin/salesClothes");if(Rn(m,"vendedor_dulces"))return u("/admin/salesCandies");if(Rn(m,"supervisor_pollo")||Rn(m,"contador"))return u("/admin/batches")},A=async h=>{if(h.preventDefault(),l(""),!t.trim()){l("Ingresa el correo.");return}if(r.length<6){l("La contrasea debe tener al menos 6 caracteres.");return}try{d(!0),console.info&&console.info("[Login] attempting signIn",{email:t}),await oE(Vi,zD);const m=await Oge(Vi,t,r);console.info&&console.info("[Login] signInWithEmailAndPassword success",{uid:m.user.uid,email:m.user.email});const p=m.user.uid;localStorage.setItem("POSYS_LOGIN_AT",String(Date.now()));const x=await Es(Kt(Ne,"users",p));if(console.info&&console.info("[Login] firestore users doc snap: exists=",x.exists()),!x.exists()){console.warn&&console.warn("[Login] user doc missing for uid",p),l("Tu usuario no tiene perfil en la base de datos.");return}const v=x.data();console.info&&console.info("[Login] user profile:",v);const y=Array.isArray(v.roles)?v.roles:v.role?[v.role]:[],b=y[0]||"",w=v.name||"",I=["admin","vendedor_pollo","vendedor_ropa","vendedor_dulces","supervisor_pollo","contador"];if(!y.some(j=>I.includes(j))){l("Rol no vlido. Consulta al administrador.");return}localStorage.setItem("user_email",m.user.email||""),w&&localStorage.setItem("user_name",w),localStorage.setItem("roles",JSON.stringify(y)),y.length===1?f(b):u("/admin")}catch(m){console.error&&console.error("[Login] sign-in error:",m);const p=String((m==null?void 0:m.code)||"");l(p==="auth/invalid-credential"||p==="auth/wrong-password"?"Credenciales incorrectas. ("+p+")":p==="auth/user-not-found"?"Usuario no encontrado. ("+p+")":p==="auth/too-many-requests"?"Demasiados intentos. Intenta ms tarde. ("+p+")":((m==null?void 0:m.message)||"Error al iniciar sesin.")+(p?` (${p})`:""))}finally{d(!1)}};return i.jsx("div",{className:"min-h-screen grid place-items-center ",children:i.jsxs("form",{onSubmit:A,className:"w-[92%] max-w-md bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-2xl font-bold text-center mb-4",children:"Iniciar Sesin"}),i.jsx("label",{className:"block text-sm font-semibold",children:"Correo electrnico"}),i.jsx("input",{type:"email",className:"w-full border rounded-2xl px-3 py-2 mb-3 shadow-2xl",value:t,onChange:h=>e(h.target.value),autoComplete:"username"}),i.jsx("label",{className:"block text-sm font-semibold",children:"Contrasea"}),i.jsxs("div",{className:"flex gap-2 mb-2",children:[i.jsx("input",{type:a?"text":"password",className:"flex-1 border rounded-2xl px-3 py-2 shadow-2xl",value:r,onChange:h=>n(h.target.value),minLength:6,autoComplete:"current-password"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded-2xl shadow-2xl bg-gray-200 hover:bg-gray-300",onClick:()=>s(h=>!h),children:a?"Ocultar":"Mostrar"})]}),i.jsx("div",{className:"text-xs text-gray-600 mb-3",children:"Mnimo 6 caracteres (requisito de Firebase)."}),i.jsx("button",{className:"w-full bg-blue-600 text-white px-4 py-2 rounded-2xl shadow-2xl hover:bg-blue-700 disabled:opacity-60",disabled:c,children:c?"Entrando...":"Entrar"}),o&&i.jsx("p",{className:`mt-3 text-sm ${o.startsWith("Error")||o.includes("no vlido")?"text-red-600":"text-gray-700"}`,children:o})]})})}function sa({children:t,allowedRoles:e}){const[r,n]=g.useState(!0),[a,s]=g.useState(!1);return g.useEffect(()=>{const o=EI(Vi,async l=>{if(l){const c=Kt(Ne,"users",l.uid),d=await Es(c);if(d.exists()){const u=d.data(),f=Array.isArray(u.roles)?u.roles:u.role?[u.role]:[];try{typeof window<"u"&&window.location&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?console.info&&console.info("[PrivateRoute] uid:",l.uid,"roleFromDoc:",role,"allowedRoles:",e):console.debug&&console.debug("[PrivateRoute] uid:",l.uid,"roleFromDoc:",role,"allowedRoles:",e)}catch{}let A=!1;for(const h of e)if(Rn(f,h)){A=!0;break}s(A)}else try{typeof window<"u"&&window.location&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?console.info&&console.info("[PrivateRoute] no user doc for uid:",l.uid):console.debug&&console.debug("[PrivateRoute] no user doc for uid:",l.uid)}catch{}}n(!1)});return()=>o()},[e]),r?i.jsx("div",{className:"p-4",children:"Cargando..."}):a?t:i.jsx(Uh,{to:"/"})}const Abe={admin:{billing:{view:!0,edit:!0}},supervisor_pollo:{bills:{view:!0,edit:!1},expenses:{view:!0,edit:!1},customersPollo:{view:!0,edit:!1},transactionsPollo:{view:!0,edit:!1},batches:{view:!0,edit:!1},statusAccount:{view:!0,edit:!0}},contador:{billing:{view:!0,edit:!0},salesV2:{view:!0,edit:!0},customersPollo:{view:!0,edit:!0},batches:{view:!0,edit:!0},transactionsPollo:{view:!0,edit:!1},bills:{view:!0,edit:!1},expenses:{view:!0,edit:!0},financialDashboard:{view:!0,edit:!1},statusAccount:{view:!0,edit:!0}},vendedor_pollo:{salesV2:{view:!0,edit:!0},transactionsPollo:{view:!0,edit:!1},bills:{view:!0,edit:!1},customersPollo:{view:!0,edit:!0}},vendedor_dulces:{salesCandies:{view:!0,edit:!0},productsVendorsCandies:{view:!0,edit:!1},productsPricesCandies:{view:!0,edit:!1},transactionCandies:{view:!0,edit:!1},cierreVentasCandies:{view:!0,edit:!1},customersCandies:{view:!0,edit:!0}},vendedor_ropa:{}};function Kee(t){return t?Array.isArray(t)?t.filter(Boolean):[t].filter(Boolean):[]}function ua(t,e,r="view"){const n=Kee(t);return n.some(a=>a==="admin")?!0:n.some(a=>{var s,o;return!!((o=(s=Abe[a])==null?void 0:s[e])!=null&&o[r])})}const mbe={admin:{},supervisor_pollo:{bills:{cerrarVentas:!1},batches:{create:!1,update:!1,delete:!1,export:!1},statusAccount:{update:!1}},contador:{batches:{create:!0,update:!1,delete:!1,export:!0},bills:{cerrarVentas:!1},statusAccount:{update:!0}},vendedor_pollo:{salesV2:{create:!0,update:!0},customersPollo:{update:!0},bills:{cerrarVentas:!0}},vendedor_dulces:{salesCandies:{create:!0,update:!0},productsVendorsCandies:{create:!0,update:!1,delete:!1},customersCandies:{update:!0},productsPricesCandies:{price_edit:!1}},vendedor_ropa:{}};function pbe(t,e,r){const n=Kee(t);return n.some(a=>a==="admin")?!0:ua(t,e,"view")?n.some(a=>{var o;const s=(o=mbe[a])==null?void 0:o[e];return!!(s!=null&&s[r])}):!1}function gbe({role:t,roles:e}){const r="/admin",n=({isActive:se})=>`block rounded px-3 py-2 text-sm ${se?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"}`,a=ww(),[s,o]=g.useState(!1),[l,c]=g.useState(!1),[d,u]=g.useState(!1),[f,A]=g.useState(!1),[h,m]=g.useState(!1),[p,x]=g.useState(!1),[v,y]=g.useState(!1),[b,w]=g.useState(!1),[I,j]=g.useState(!1),[N,S]=g.useState(!1),[E,B]=g.useState(!1),[k,T]=g.useState(!1),[P,q]=g.useState(!1),[de,ce]=g.useState(!1),[le,he]=g.useState(!1),[ae,Ce]=g.useState(!1),[De,O]=g.useState(!1),[R,G]=g.useState(!1),M=async()=>{G(!0)},K=async()=>{try{await qD(Vi)}catch(se){console.error("signOut error:",se)}finally{try{localStorage.removeItem("user_name"),localStorage.removeItem("user_email"),localStorage.removeItem("roles"),localStorage.removeItem("role")}catch{}G(!1),a("/")}},Y=({open:se,onClick:Z,children:ke})=>i.jsxs("button",{type:"button",onClick:Z,className:"w-full flex items-center justify-between px-3 py-2 text-left text-sm font-semibold rounded hover:bg-gray-100",children:[i.jsx("span",{children:ke}),i.jsx("span",{className:"text-xs",children:se?"":""})]}),D=({open:se,onClick:Z,title:ke})=>i.jsxs("button",{type:"button",onClick:Z,className:"ml-2 w-[calc(100%-0.5rem)] flex items-center justify-between px-3 py-2 text-left text-sm rounded hover:bg-gray-100",children:[i.jsx("span",{className:"text-blue-500 font-medium ",children:ke}),i.jsx("span",{className:"text-xs",children:se?"":""})]}),V=e&&e.length?e:t,te=Rn(V,"admin");Rn(V,"vendedor_pollo");const ve=Rn(V,"vendedor_ropa");Rn(V,"vendedor_dulces"),Rn(V,"supervisor_pollo")||Rn(V,"contador"),Rn(V,"contador");const Q=ua(V,"salesV2","view")||ua(V,"customersPollo","view")||ua(V,"transactionsPollo","view")||ua(V,"bills","view")||ua(V,"expenses","view")||ua(V,"batches","view")||ua(V,"statusAccount","view"),Xe=ua(V,"salesCandies","view")||ua(V,"productsVendorsCandies","view")||ua(V,"customersCandies","view")||ua(V,"productsPricesCandies","view")||ua(V,"transactionCandies","view")||ua(V,"cierreVentasCandies","view");return i.jsxs("div",{className:"min-h-screen flex",children:[i.jsxs("aside",{className:`${s?"w-15 bg-gray-50 border-r p-3 transition-all duration-300 flex flex-col items-center":"w-55"} bg-[#f1f3f7] border-r p-3 transition-all duration-300 flex flex-col`,children:[i.jsx("button",{onClick:()=>o(!s),className:"mb-2 p-2 rounded-2xl shadow-2xl bg-gray-300 hover:bg-gray-400","aria-label":s?"Expandir men":"Colapsar men",children:s?i.jsx("span",{title:"Expandir men",children:"Menu "}):i.jsx("span",{title:"Colapsar men",children:"Cerrar "})}),!s&&i.jsxs(i.Fragment,{children:[i.jsxs("nav",{className:"space-y-1",children:[te&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Y,{open:l,onClick:()=>c(se=>!se),children:"Pollos Bea"}),l&&i.jsxs("div",{className:"pb-2",children:[i.jsx(D,{open:p,onClick:()=>x(se=>!se),title:"Operaciones"}),p&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(Sn,{to:`${r}/salesV2`,className:n,children:"Vender"}),i.jsx(Sn,{to:`${r}/customersPollo`,className:n,children:"Saldo Pendientes"}),i.jsx(Sn,{to:`${r}/transactionsPollo`,className:n,children:"Transacciones"}),i.jsx(Sn,{to:`${r}/bills`,className:n,children:"Cierre Ventas"}),i.jsx(Sn,{to:`${r}/statusAccount`,className:n,children:"Estado de Cuenta"})]}),i.jsx(D,{open:d,onClick:()=>u(se=>!se),title:"Inventarios"}),d&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(Sn,{to:`${r}/batches`,className:n,children:"Inventario Pollo"}),i.jsx(Sn,{to:`${r}/paidBatches`,className:n,children:"Inventarios Pagados"}),i.jsx(Sn,{to:`${r}/billing`,className:n,children:"Facturacion"})]}),i.jsx(D,{open:f,onClick:()=>A(se=>!se),title:"Finanzas"}),f&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(Sn,{to:`${r}/financialDashboard`,className:n,children:"Dashboard"}),i.jsx(Sn,{to:`${r}/billing`,className:n,children:"Facturacion"}),i.jsx(Sn,{to:`${r}/expenses`,className:n,children:"Gastos"}),i.jsx(Sn,{to:`${r}/polloCashAudits`,className:n,children:"Arqueos Caja"}),i.jsx(Sn,{to:`${r}/salesV2`,className:n,children:"Venta"}),i.jsx(Sn,{to:`${r}/bills`,className:n,children:"Cierre Ventas"}),i.jsx(Sn,{to:`${r}/billhistoric`,className:n,children:"Historial de Cierres"})]}),i.jsx(D,{open:h,onClick:()=>m(se=>!se),title:"Productos"}),h&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/products`,className:n,children:"Productos"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Y,{open:v,onClick:()=>y(se=>!se),children:"Gonper"}),v&&i.jsxs("div",{className:"pb-2",children:[i.jsx(D,{open:b,onClick:()=>w(se=>!se),title:"Inventarios"}),b&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/notebooksInventory`,className:n,children:"Productos y Precios"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Y,{open:P,onClick:()=>q(se=>!se),children:"CandyShop"}),P&&i.jsxs("div",{className:"pb-2",children:[i.jsx(D,{open:le,onClick:()=>he(se=>!se),title:"Vendedores"}),le&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/salesCandies`,className:n,children:"Venta"})}),le&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/productsVendorsCandies`,className:n,children:"Sub ordenes"})}),le&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/productsPricesCandies`,className:n,children:"Precios Venta"})}),i.jsx(D,{open:de,onClick:()=>ce(se=>!se),title:"Inventario"}),de&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/mainordersCandies`,className:n,children:"Ordenes Maestras"})}),de&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/inventoryMainOrderCandies`,className:n,children:"Lista de Ordenes"})}),de&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/inventoryCandies`,className:n,children:"Lista Productos"})}),de&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/productsCandies`,className:n,children:"Productos"})}),i.jsx(D,{open:ae,onClick:()=>Ce(se=>!se),title:"Finanzas"}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/datacenter`,className:n,children:"Data Center"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/cashDeliveries`,className:n,children:"Entregas Cash"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/transactionCandies`,className:n,children:"Transacciones"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/cierreVentasCandies`,className:n,children:"Cierres"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/reporteCierresCandies`,className:n,children:"Reporte Cierres"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/billingsCandies`,className:n,children:"Facturas"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/consolidatedVendors`,className:n,children:"Consolidado Vendedores"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/dashboardCandies`,className:n,children:"Dashboard"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/customersCandies`,className:n,children:"Clientes"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/vendorsCandies`,className:n,children:"Vendedores"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/expensesCandies`,className:n,children:"Gastos"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Y,{open:De,onClick:()=>O(se=>!se),children:"Operaciones Otras"}),De&&i.jsxs("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:[i.jsx(Sn,{to:`${r}/users`,className:n,children:"Usuarios"}),i.jsx(Sn,{to:`${r}/fix`,className:n,children:"Fix de lotes"}),i.jsx(Sn,{to:`${r}/transactionclose`,className:n,children:"Liquidaciones"})]})]})]}),!te&&Q&&i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(Y,{open:l,onClick:()=>c(se=>!se),children:"Pollos Bea"}),l&&i.jsxs("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:[ua(V,"salesV2")&&i.jsx(Sn,{to:`${r}/salesV2`,className:n,children:"Vender"}),ua(V,"financialDashboard")&&i.jsx(Sn,{to:`${r}/financialDashboard`,className:n,children:"Dashboard"}),ua(V,"batches")&&i.jsx(Sn,{to:`${r}/batches`,className:n,children:"Inventario Pollo"}),ua(V,"bills")&&i.jsx(Sn,{to:`${r}/bills`,className:n,children:"Cierre Ventas"}),ua(V,"transactionsPollo")&&i.jsx(Sn,{to:`${r}/transactionsPollo`,className:n,children:"Transacciones"}),ua(V,"billing")&&i.jsx(Sn,{to:`${r}/billing`,className:n,children:"Facturacion"}),ua(V,"statusAccount")&&i.jsx(Sn,{to:`${r}/statusAccount`,className:n,children:"Estado de Cuenta"}),ua(V,"expenses")&&i.jsx(Sn,{to:`${r}/expenses`,className:n,children:"Gastos"}),Rn(V,"contador")&&i.jsx(Sn,{to:`${r}/polloCashAudits`,className:n,children:"Arqueos Caja"}),ua(V,"customersPollo")&&i.jsx(Sn,{to:`${r}/customersPollo`,className:n,children:"Saldos Pendientes"})]})]}),!te&&Xe&&i.jsxs("div",{className:"border rounded",children:[i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:ua(V,"salesCandies")&&i.jsx(Sn,{to:`${r}/salesCandies`,className:n,children:"Venta"})}),i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:ua(V,"transactionCandies")&&i.jsx(Sn,{to:`${r}/transactionCandies`,className:n,children:"Ventas del dia"})}),i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:ua(V,"cierreVentasCandies")&&i.jsx(Sn,{to:`${r}/cierreVentasCandies`,className:n,children:"Cierre de Ventas"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:ua(V,"productsVendorsCandies")&&i.jsx(Sn,{to:`${r}/productsVendorsCandies`,className:n,children:"Pedidos"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:ua(V,"customersCandies")&&i.jsx(Sn,{to:`${r}/customersCandies`,className:n,children:"Clientes"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:ua(V,"productsPricesCandies")&&i.jsx(Sn,{to:`${r}/productsPricesCandies`,className:n,children:"Precios Venta"})})]}),ve&&i.jsxs("div",{className:"border rounded",children:[i.jsx(Y,{open:v,onClick:()=>y(se=>!se),children:"Operaciones Ropa"}),v&&i.jsxs("div",{className:"pb-2",children:[i.jsx(D,{open:E,onClick:()=>B(se=>!se),title:"Ventas"}),E&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(Sn,{to:`${r}/salesClothes`,className:n,children:"Venta Ropa"}),i.jsx(Sn,{to:`${r}/TransactionsReportClothes`,className:n,children:"Transacciones"})]}),i.jsx(D,{open:I,onClick:()=>j(se=>!se),title:"Productos"}),I&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/productsClothes`,className:n,children:"Agregar Productos"})}),i.jsx(D,{open:N,onClick:()=>S(se=>!se),title:"Clientes"}),N&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(Sn,{to:`${r}/CustomersClothes`,className:n,children:"Listado de Clientes"})})]})]})]}),i.jsx("button",{onClick:M,className:"mt-4 bg-red-500 text-white px-3 py-2 rounded-2xl shadow-2xl hover:bg-red-600",children:"Cerrar sesin"}),i.jsx("div",{className:"mt-2 text-[20px] text-gray-700",children:typeof window<"u"&&(localStorage.getItem("user_name")||localStorage.getItem("user_email"))}),R&&i.jsxs("div",{className:"fixed inset-0 z-[120] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/20",onClick:()=>G(!1)}),i.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-lg z-[130] w-[90%] max-w-sm",children:[i.jsx("div",{className:"font-semibold mb-3",children:"Ests seguro de cerrar sesin?"}),i.jsxs("div",{className:"flex gap-2 justify-end",children:[i.jsx("button",{onClick:()=>G(!1),className:"px-3 py-2 rounded bg-gray-200",children:"No"}),i.jsx("button",{onClick:K,className:"px-3 py-2 rounded bg-red-500 text-white",children:"SI"})]})]})]})]})]}),i.jsx("main",{className:"flex-1 p-6",children:i.jsx(GY,{})})]})}function my(...t){return t.filter(Boolean).join(" ")}function xbe({role:t,roles:e}){const r=ww(),n=OA(),a="/admin",s=e&&e.length?e:t,o=Rn(s,"admin"),l=Rn(s,"vendedor_pollo"),c=Rn(s,"vendedor_dulces"),d=Rn(s,"supervisor_pollo")||Rn(s,"contador"),u=Rn(s,"contador"),f=ua(s,"salesV2","view")||ua(s,"batches","view")||ua(s,"bills","view")||ua(s,"transactionsPollo","view")||ua(s,"customersPollo","view");ua(s,"billing","view");const A=ua(s,"salesCandies","view")||ua(s,"productsVendorsCandies","view")||ua(s,"customersCandies","view")||ua(s,"productsPricesCandies","view")||ua(s,"transactionCandies","view")||ua(s,"cierreVentasCandies","view"),h=f&&A,[m,p]=g.useState(()=>{try{const B=typeof window<"u"?localStorage.getItem("rubro"):null;if(B==="POLLO"||B==="DULCES")return B}catch{}return f?"POLLO":A?"DULCES":"POLLO"}),[x,v]=g.useState(!1),[y,b]=g.useState(!1),w=g.useMemo(()=>{let B=[];if(o||h){if(m==="POLLO")if(o)B=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos pendientes",to:`${a}/customersPollo`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"statusAccount",label:"Estado de Cuenta",to:`${a}/statusAccount`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`},{key:"inv",label:"Inventario",to:`${a}/batches`},{key:"invPag",label:"Factura",to:`${a}/paidBatches`},{key:"gastos",label:"Gastos",to:`${a}/expenses`},{key:"arqueos",label:"Arqueos Caja",to:`${a}/polloCashAudits`}];else if(d){const P=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos pendientes",to:`${a}/customersPollo`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"statusAccount",label:"Estado de Cuenta",to:`${a}/statusAccount`},{key:"inv",label:"Inventario",to:`${a}/batches`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`},{key:"facturacion",label:"Facturacin",to:`${a}/billing`}];Rn(s,"contador")&&(B=P)}else l?B=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos Pendientes",to:`${a}/customersPollo`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`}]:u?B=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos Pendientes",to:`${a}/customersPollo`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"statusAccount",label:"Estado de Cuenta",to:`${a}/statusAccount`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`},{key:"bills",label:"Facturacin",to:`${a}/billing`}]:B=[{key:"home",label:"Inicio",to:`${a}`}];m==="DULCES"&&(o?B=[{key:"dc",label:"Data Center Reporte",to:`${a}/datacenter`},{key:"maes",label:"Inventario Maestro",to:`${a}/mainordersCandies`},{key:"ord",label:"Inventario Vendedor",to:`${a}/productsVendorsCandies`},{key:"cli",label:"Saldos Pendientes",to:`${a}/customersCandies`},{key:"trx",label:"Ventas del dia",to:`${a}/transactionCandies`},{key:"cier",label:"Cierre de ventas",to:`${a}/cierreVentasCandies`},{key:"cash",label:"Entregas Efectivo ",to:`${a}/cashDeliveries`},{key:"items",label:"Productos",to:`${a}/productsCandies`},{key:"precios",label:"Precio Ventas",to:`${a}/productsPricesCandies`},{key:"gonper",label:"Productos Gonper",to:`${a}/notebooksInventory`}]:c?B=[{key:"venta",label:"Vender",to:`${a}/salesCandies`},{key:"precios",label:"Precios",to:`${a}/productsPricesCandies`},{key:"ped",label:"Inventario",to:`${a}/productsVendorsCandies`},{key:"cli",label:"Saldos Pendientes",to:`${a}/customersCandies`},{key:"trx",label:"Ventas",to:`${a}/transactionCandies`},{key:"cier",label:"Cierre",to:`${a}/cierreVentasCandies`}]:B=[{key:"home",label:"Inicio",to:`${a}`}])}else if(d){const P=[{key:"venta",label:"Venta",to:`${a}/salesV2`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"statusAccount",label:"Estado de Cuenta",to:`${a}/statusAccount`},{key:"inv",label:"Inventario",to:`${a}/batches`},{key:"clientes",label:"Saldos Pendientes",to:`${a}/customersPollo`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`},{key:"cierre",label:"Cierre",to:`${a}/bills`},{key:"facturacion",label:"Facturacin",to:`${a}/billing`}];Rn(s,"contador")?B=[...P,{key:"arqueos",label:"Arqueos Caja",to:`${a}/polloCashAudits`},{key:"statusAccount",label:"Estado de Cuenta",to:`${a}/statusAccount`}]:B=P}else l?B=[{key:"venta",label:"Venta",to:`${a}/salesV2`},{key:"cierre",label:"Cierre",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`}]:c?B=[{key:"venta",label:"Vender",to:`${a}/salesCandies`},{key:"precios",label:"Precios",to:`${a}/productsPricesCandies`},{key:"ped",label:"Inventario",to:`${a}/productsVendorsCandies`},{key:"cli",label:"Saldos Pendientes",to:`${a}/customersCandies`},{key:"trx",label:"Ventas",to:`${a}/transactionCandies`},{key:"cier",label:"Cierre",to:`${a}/cierreVentasCandies`}]:B=[{key:"home",label:"Inicio",to:`${a}`}];const k=new Set(["bills","customersPollo","transactionsPollo","batches","salesV2","financialDashboard","polloCashAudits","billing","statusAccount","polloCashAudits","salesCandies","productsVendorsCandies","productsPricesCandies","transactionCandies","cierreVentasCandies","customersCandies"]);return B.filter(P=>{const de=P.to.replace(`${a}/`,"");return k.has(de)?ua(s,de,"view"):!0})},[a,m,o,h,d,l,c,u,s]);g.useEffect(()=>{if((o||h)&&w.length){try{localStorage.setItem("rubro",m)}catch{}r(w[0].to,{replace:!0})}},[m]),g.useEffect(()=>{x&&v(!1)},[n.pathname]),g.useEffect(()=>{const B=k=>{k.key==="Escape"&&v(!1)};return x&&window.addEventListener("keydown",B),()=>window.removeEventListener("keydown",B)},[x]);const I=async()=>{b(!0)},j=async()=>{try{await qD(Vi)}catch(B){console.error("signOut error:",B)}finally{try{localStorage.removeItem("user_name"),localStorage.removeItem("user_email"),localStorage.removeItem("roles"),localStorage.removeItem("role")}catch{}b(!1),v(!1),r("/")}},N=({isActive:B})=>my("flex-1 text-center text-[11px] py-1.5 rounded-lg","leading-none select-none",B?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),S=w.length<=2,E=({isActive:B})=>my("w-full flex items-center justify-between px-4 py-3 rounded-xl border",B?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-800 border-gray-200 hover:bg-gray-50");return i.jsxs("div",{className:"min-h-screen bg-[#f1f3f7] flex flex-col",children:[i.jsx("header",{className:"sticky top-0 z-50 bg-white border-b shadow-sm",children:i.jsxs("div",{className:"px-3 py-3 flex items-center gap-2",children:[o||h?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",onClick:()=>p("POLLO"),className:my("px-3 py-2 rounded-2xl text-sm font-semibold",m==="POLLO"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:"Carniceria"}),i.jsx("button",{type:"button",onClick:()=>p("DULCES"),className:my("px-3 py-2 rounded-2xl text-sm font-semibold",m==="DULCES"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:"Mr. Candy"})]}):i.jsx("div",{className:"text-sm font-semibold text-gray-800",children:l?"Pollos Bea":c?"CandyShop":"Posys"}),i.jsx("div",{className:"ml-auto flex items-center gap-2",children:i.jsx("button",{type:"button",onClick:()=>v(!0),className:"px-3 py-2 rounded-2xl bg-gray-100 text-gray-800 text-sm font-bold shadow hover:bg-gray-200","aria-label":"Abrir men",title:"Men",children:""})})]})}),x&&i.jsxs("div",{className:"fixed inset-0 z-[80]",children:[i.jsx("button",{type:"button",className:"absolute inset-0 bg-black/40",onClick:()=>v(!1),"aria-label":"Cerrar men"}),i.jsxs("aside",{className:"absolute right-0 top-0 h-full w-[86%] max-w-sm bg-white shadow-2xl border-l flex flex-col",children:[i.jsxs("div",{className:"p-4 border-b",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"font-bold text-gray-900",children:"Men"}),i.jsx("button",{type:"button",onClick:()=>v(!1),className:"px-3 py-2 rounded-xl bg-gray-100 hover:bg-gray-200",children:""})]}),i.jsx("div",{className:"mt-2 text-[20px] text-gray-600",children:typeof window<"u"&&(localStorage.getItem("user_name")||localStorage.getItem("user_email"))})]}),i.jsx("div",{className:"p-3 flex-1 overflow-y-auto space-y-2",children:w.map(B=>i.jsxs(Sn,{to:B.to,className:E,children:[i.jsx("span",{className:"font-semibold",children:B.label}),i.jsx("span",{className:"text-sm opacity-80",children:""})]},B.key))}),i.jsxs("div",{className:"p-3 border-t space-y-2 pb-[calc(12px+env(safe-area-inset-bottom))]",children:[i.jsx("button",{onClick:I,className:"w-full px-4 py-3 rounded-xl bg-red-500 text-white font-semibold shadow hover:bg-red-600",children:"Cerrar sesin"}),y&&i.jsxs("div",{className:"fixed inset-0 z-[120] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/20",onClick:()=>b(!1)}),i.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-lg z-[130] w-[90%] max-w-sm",children:[i.jsx("div",{className:"font-semibold mb-3",children:"Ests seguro de cerrar sesin?"}),i.jsxs("div",{className:"flex gap-2 justify-end",children:[i.jsx("button",{onClick:()=>b(!1),className:"px-3 py-2 rounded bg-gray-200",children:"No"}),i.jsx("button",{onClick:j,className:"px-3 py-2 rounded bg-red-500 text-white",children:"SI"})]})]})]})]})]})]}),i.jsx("main",{className:my("flex-1 overflow-y-auto px-3 pt-3",S?"pb-[calc(92px+env(safe-area-inset-bottom))]":"pb-[calc(16px+env(safe-area-inset-bottom))]"),children:i.jsx(GY,{})}),S&&i.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-50 bg-white border-t shadow-md pb-[env(safe-area-inset-bottom)]",children:i.jsx("div",{className:"max-w-3xl mx-auto px-2 py-1.5 flex gap-1.5",children:w.map(B=>i.jsx(Sn,{to:B.to,className:N,children:B.label},B.key))})})]})}const qee=6048e5,vbe=864e5,ybe=6e4,bbe=36e5,wbe=1e3,R9=Symbol.for("constructDateFrom");function _o(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&R9 in t?t[R9](e):t instanceof Date?new t.constructor(e):new Date(e)}function Pi(t,e){return _o(e||t,t)}function V6(t,e,r){const n=Pi(t,r==null?void 0:r.in);return isNaN(e)?_o((r==null?void 0:r.in)||t,NaN):(e&&n.setDate(n.getDate()+e),n)}function Nbe(t,e,r){const n=Pi(t,r==null?void 0:r.in);if(isNaN(e))return _o(t,NaN);const a=n.getDate(),s=_o(t,n.getTime());s.setMonth(n.getMonth()+e+1,0);const o=s.getDate();return a>=o?s:(n.setFullYear(s.getFullYear(),s.getMonth(),a),n)}let Cbe={};function w1(){return Cbe}function jm(t,e){var l,c,d,u;const r=w1(),n=(e==null?void 0:e.weekStartsOn)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((u=(d=r.locale)==null?void 0:d.options)==null?void 0:u.weekStartsOn)??0,a=Pi(t,e==null?void 0:e.in),s=a.getDay(),o=(s<n?7:0)+s-n;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function Vv(t,e){return jm(t,{...e,weekStartsOn:1})}function zee(t,e){const r=Pi(t,e==null?void 0:e.in),n=r.getFullYear(),a=_o(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const s=Vv(a),o=_o(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=Vv(o);return r.getTime()>=s.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function ES(t){const e=Pi(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function _be(t,...e){const r=_o.bind(null,e.find(n=>typeof n=="object"));return e.map(r)}function M9(t,e){const r=Pi(t,e==null?void 0:e.in);return r.setHours(0,0,0,0),r}function Ebe(t,e,r){const[n,a]=_be(r==null?void 0:r.in,t,e),s=M9(n),o=M9(a),l=+s-ES(s),c=+o-ES(o);return Math.round((l-c)/vbe)}function Sbe(t,e){const r=zee(t,e),n=_o(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),Vv(n)}function jbe(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function H6(t){return!(!jbe(t)&&typeof t!="number"||isNaN(+Pi(t)))}function $u(t,e){const r=Pi(t,e==null?void 0:e.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function Gu(t,e){const r=Pi(t,e==null?void 0:e.in);return r.setDate(1),r.setHours(0,0,0,0),r}function Ibe(t,e){const r=Pi(t,e==null?void 0:e.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const Pbe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Tbe=(t,e,r)=>{let n;const a=Pbe[t];return typeof a=="string"?n=a:e===1?n=a.one:n=a.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function R4(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const Bbe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},kbe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Fbe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Obe={date:R4({formats:Bbe,defaultWidth:"full"}),time:R4({formats:kbe,defaultWidth:"full"}),dateTime:R4({formats:Fbe,defaultWidth:"full"})},Dbe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Rbe=(t,e,r,n)=>Dbe[t];function py(t){return(e,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=r!=null&&r.width?String(r.width):o;a=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;a=t.values[l]||t.values[o]}const s=t.argumentCallback?t.argumentCallback(e):e;return a[s]}}const Mbe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Lbe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Ube={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Qbe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Vbe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Hbe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},$be=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Gbe={ordinalNumber:$be,era:py({values:Mbe,defaultWidth:"wide"}),quarter:py({values:Lbe,defaultWidth:"wide",argumentCallback:t=>t-1}),month:py({values:Ube,defaultWidth:"wide"}),day:py({values:Qbe,defaultWidth:"wide"}),dayPeriod:py({values:Vbe,defaultWidth:"wide",formattingValues:Hbe,defaultFormattingWidth:"wide"})};function gy(t){return(e,r={})=>{const n=r.width,a=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],s=e.match(a);if(!s)return null;const o=s[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?qbe(l,f=>f.test(o)):Kbe(l,f=>f.test(o));let d;d=t.valueCallback?t.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;const u=e.slice(o.length);return{value:d,rest:u}}}function Kbe(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function qbe(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function zbe(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const a=n[0],s=e.match(t.parsePattern);if(!s)return null;let o=t.valueCallback?t.valueCallback(s[0]):s[0];o=r.valueCallback?r.valueCallback(o):o;const l=e.slice(a.length);return{value:o,rest:l}}}const Wbe=/^(\d+)(th|st|nd|rd)?/i,Xbe=/\d+/i,Ybe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Jbe={any:[/^b/i,/^(a|c)/i]},Zbe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},e2e={any:[/1/i,/2/i,/3/i,/4/i]},t2e={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},r2e={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},n2e={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},a2e={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},s2e={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},i2e={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},o2e={ordinalNumber:zbe({matchPattern:Wbe,parsePattern:Xbe,valueCallback:t=>parseInt(t,10)}),era:gy({matchPatterns:Ybe,defaultMatchWidth:"wide",parsePatterns:Jbe,defaultParseWidth:"any"}),quarter:gy({matchPatterns:Zbe,defaultMatchWidth:"wide",parsePatterns:e2e,defaultParseWidth:"any",valueCallback:t=>t+1}),month:gy({matchPatterns:t2e,defaultMatchWidth:"wide",parsePatterns:r2e,defaultParseWidth:"any"}),day:gy({matchPatterns:n2e,defaultMatchWidth:"wide",parsePatterns:a2e,defaultParseWidth:"any"}),dayPeriod:gy({matchPatterns:s2e,defaultMatchWidth:"any",parsePatterns:i2e,defaultParseWidth:"any"})},Wee={code:"en-US",formatDistance:Tbe,formatLong:Obe,formatRelative:Rbe,localize:Gbe,match:o2e,options:{weekStartsOn:0,firstWeekContainsDate:1}};function l2e(t,e){const r=Pi(t,e==null?void 0:e.in);return Ebe(r,Ibe(r))+1}function Xee(t,e){const r=Pi(t,e==null?void 0:e.in),n=+Vv(r)-+Sbe(r);return Math.round(n/qee)+1}function $6(t,e){var u,f,A,h;const r=Pi(t,e==null?void 0:e.in),n=r.getFullYear(),a=w1(),s=(e==null?void 0:e.firstWeekContainsDate)??((f=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:f.firstWeekContainsDate)??a.firstWeekContainsDate??((h=(A=a.locale)==null?void 0:A.options)==null?void 0:h.firstWeekContainsDate)??1,o=_o((e==null?void 0:e.in)||t,0);o.setFullYear(n+1,0,s),o.setHours(0,0,0,0);const l=jm(o,e),c=_o((e==null?void 0:e.in)||t,0);c.setFullYear(n,0,s),c.setHours(0,0,0,0);const d=jm(c,e);return+r>=+l?n+1:+r>=+d?n:n-1}function c2e(t,e){var l,c,d,u;const r=w1(),n=(e==null?void 0:e.firstWeekContainsDate)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((u=(d=r.locale)==null?void 0:d.options)==null?void 0:u.firstWeekContainsDate)??1,a=$6(t,e),s=_o((e==null?void 0:e.in)||t,0);return s.setFullYear(a,0,n),s.setHours(0,0,0,0),jm(s,e)}function Yee(t,e){const r=Pi(t,e==null?void 0:e.in),n=+jm(r,e)-+c2e(r,e);return Math.round(n/qee)+1}function fs(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const h0={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return fs(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):fs(r+1,2)},d(t,e){return fs(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return fs(t.getHours()%12||12,e.length)},H(t,e){return fs(t.getHours(),e.length)},m(t,e){return fs(t.getMinutes(),e.length)},s(t,e){return fs(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return fs(a,e.length)}},ox={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},L9={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return h0.y(t,e)},Y:function(t,e,r,n){const a=$6(t,n),s=a>0?a:1-a;if(e==="YY"){const o=s%100;return fs(o,2)}return e==="Yo"?r.ordinalNumber(s,{unit:"year"}):fs(s,e.length)},R:function(t,e){const r=zee(t);return fs(r,e.length)},u:function(t,e){const r=t.getFullYear();return fs(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return fs(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return fs(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return h0.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return fs(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const a=Yee(t,n);return e==="wo"?r.ordinalNumber(a,{unit:"week"}):fs(a,e.length)},I:function(t,e,r){const n=Xee(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):fs(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):h0.d(t,e)},D:function(t,e,r){const n=l2e(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):fs(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const a=t.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(s);case"ee":return fs(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const a=t.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(s);case"cc":return fs(s,e.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),a=n===0?7:n;switch(e){case"i":return String(a);case"ii":return fs(a,e.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const a=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let a;switch(n===12?a=ox.noon:n===0?a=ox.midnight:a=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let a;switch(n>=17?a=ox.evening:n>=12?a=ox.afternoon:n>=4?a=ox.morning:a=ox.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return h0.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):h0.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):fs(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):fs(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):h0.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):h0.s(t,e)},S:function(t,e){return h0.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return Q9(n);case"XXXX":case"XX":return Ap(n);case"XXXXX":case"XXX":default:return Ap(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return Q9(n);case"xxxx":case"xx":return Ap(n);case"xxxxx":case"xxx":default:return Ap(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+U9(n,":");case"OOOO":default:return"GMT"+Ap(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+U9(n,":");case"zzzz":default:return"GMT"+Ap(n,":")}},t:function(t,e,r){const n=Math.trunc(+t/1e3);return fs(n,e.length)},T:function(t,e,r){return fs(+t,e.length)}};function U9(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),a=Math.trunc(n/60),s=n%60;return s===0?r+String(a):r+String(a)+e+fs(s,2)}function Q9(t,e){return t%60===0?(t>0?"-":"+")+fs(Math.abs(t)/60,2):Ap(t,e)}function Ap(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),a=fs(Math.trunc(n/60),2),s=fs(n%60,2);return r+a+e+s}const V9=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Jee=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},d2e=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return V9(t,e);let s;switch(n){case"P":s=e.dateTime({width:"short"});break;case"PP":s=e.dateTime({width:"medium"});break;case"PPP":s=e.dateTime({width:"long"});break;case"PPPP":default:s=e.dateTime({width:"full"});break}return s.replace("{{date}}",V9(n,e)).replace("{{time}}",Jee(a,e))},xk={p:Jee,P:d2e},u2e=/^D+$/,f2e=/^Y+$/,h2e=["D","DD","YY","YYYY"];function Zee(t){return u2e.test(t)}function ete(t){return f2e.test(t)}function vk(t,e,r){const n=A2e(t,e,r);if(console.warn(n),h2e.includes(t))throw new RangeError(n)}function A2e(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const m2e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,p2e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,g2e=/^'([^]*?)'?$/,x2e=/''/g,v2e=/[a-zA-Z]/;function Kr(t,e,r){var u,f,A,h;const n=w1(),a=n.locale??Wee,s=n.firstWeekContainsDate??((f=(u=n.locale)==null?void 0:u.options)==null?void 0:f.firstWeekContainsDate)??1,o=n.weekStartsOn??((h=(A=n.locale)==null?void 0:A.options)==null?void 0:h.weekStartsOn)??0,l=Pi(t,r==null?void 0:r.in);if(!H6(l))throw new RangeError("Invalid time value");let c=e.match(p2e).map(m=>{const p=m[0];if(p==="p"||p==="P"){const x=xk[p];return x(m,a.formatLong)}return m}).join("").match(m2e).map(m=>{if(m==="''")return{isToken:!1,value:"'"};const p=m[0];if(p==="'")return{isToken:!1,value:y2e(m)};if(L9[p])return{isToken:!0,value:m};if(p.match(v2e))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:m}});a.localize.preprocessor&&(c=a.localize.preprocessor(l,c));const d={firstWeekContainsDate:s,weekStartsOn:o,locale:a};return c.map(m=>{if(!m.isToken)return m.value;const p=m.value;(ete(p)||Zee(p))&&vk(p,e,String(t));const x=L9[p[0]];return x(l,p,a.localize,d)}).join("")}function y2e(t){const e=t.match(g2e);return e?e[1].replace(x2e,"'"):t}function b2e(){return Object.assign({},w1())}function w2e(t,e){const r=Pi(t,e==null?void 0:e.in).getDay();return r===0?7:r}function N2e(t,e){const r=C2e(e)?new e(0):_o(e,0);return r.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),r.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),r}function C2e(t){var e;return typeof t=="function"&&((e=t.prototype)==null?void 0:e.constructor)===t}const _2e=10;class tte{constructor(){Rr(this,"subPriority",0)}validate(e,r){return!0}}class E2e extends tte{constructor(e,r,n,a,s){super(),this.value=e,this.validateValue=r,this.setValue=n,this.priority=a,s&&(this.subPriority=s)}validate(e,r){return this.validateValue(e,this.value,r)}set(e,r,n){return this.setValue(e,r,this.value,n)}}class S2e extends tte{constructor(r,n){super();Rr(this,"priority",_2e);Rr(this,"subPriority",-1);this.context=r||(a=>_o(n,a))}set(r,n){return n.timestampIsSet?r:_o(r,N2e(r,this.context))}}let es=class{run(e,r,n,a){const s=this.parse(e,r,n,a);return s?{setter:new E2e(s.value,this.validate,this.set,this.priority,this.subPriority),rest:s.rest}:null}validate(e,r,n){return!0}};class j2e extends es{constructor(){super(...arguments);Rr(this,"priority",140);Rr(this,"incompatibleTokens",["R","u","t","T"])}parse(r,n,a){switch(n){case"G":case"GG":case"GGG":return a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"});case"GGGGG":return a.era(r,{width:"narrow"});case"GGGG":default:return a.era(r,{width:"wide"})||a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"})}}set(r,n,a){return n.era=a,r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}}const lo={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Yf={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function co(t,e){return t&&{value:e(t.value),rest:t.rest}}function Ci(t,e){const r=e.match(t);return r?{value:parseInt(r[0],10),rest:e.slice(r[0].length)}:null}function Jf(t,e){const r=e.match(t);if(!r)return null;if(r[0]==="Z")return{value:0,rest:e.slice(1)};const n=r[1]==="+"?1:-1,a=r[2]?parseInt(r[2],10):0,s=r[3]?parseInt(r[3],10):0,o=r[5]?parseInt(r[5],10):0;return{value:n*(a*bbe+s*ybe+o*wbe),rest:e.slice(r[0].length)}}function rte(t){return Ci(lo.anyDigitsSigned,t)}function $i(t,e){switch(t){case 1:return Ci(lo.singleDigit,e);case 2:return Ci(lo.twoDigits,e);case 3:return Ci(lo.threeDigits,e);case 4:return Ci(lo.fourDigits,e);default:return Ci(new RegExp("^\\d{1,"+t+"}"),e)}}function SS(t,e){switch(t){case 1:return Ci(lo.singleDigitSigned,e);case 2:return Ci(lo.twoDigitsSigned,e);case 3:return Ci(lo.threeDigitsSigned,e);case 4:return Ci(lo.fourDigitsSigned,e);default:return Ci(new RegExp("^-?\\d{1,"+t+"}"),e)}}function G6(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function nte(t,e){const r=e>0,n=r?e:1-e;let a;if(n<=50)a=t||100;else{const s=n+50,o=Math.trunc(s/100)*100,l=t>=s%100;a=t+o-(l?100:0)}return r?a:1-a}function ate(t){return t%400===0||t%4===0&&t%100!==0}class I2e extends es{constructor(){super(...arguments);Rr(this,"priority",130);Rr(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(r,n,a){const s=o=>({year:o,isTwoDigitYear:n==="yy"});switch(n){case"y":return co($i(4,r),s);case"yo":return co(a.ordinalNumber(r,{unit:"year"}),s);default:return co($i(n.length,r),s)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,a){const s=r.getFullYear();if(a.isTwoDigitYear){const l=nte(a.year,s);return r.setFullYear(l,0,1),r.setHours(0,0,0,0),r}const o=!("era"in n)||n.era===1?a.year:1-a.year;return r.setFullYear(o,0,1),r.setHours(0,0,0,0),r}}class P2e extends es{constructor(){super(...arguments);Rr(this,"priority",130);Rr(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(r,n,a){const s=o=>({year:o,isTwoDigitYear:n==="YY"});switch(n){case"Y":return co($i(4,r),s);case"Yo":return co(a.ordinalNumber(r,{unit:"year"}),s);default:return co($i(n.length,r),s)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,a,s){const o=$6(r,s);if(a.isTwoDigitYear){const c=nte(a.year,o);return r.setFullYear(c,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),jm(r,s)}const l=!("era"in n)||n.era===1?a.year:1-a.year;return r.setFullYear(l,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),jm(r,s)}}class T2e extends es{constructor(){super(...arguments);Rr(this,"priority",130);Rr(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(r,n){return SS(n==="R"?4:n.length,r)}set(r,n,a){const s=_o(r,0);return s.setFullYear(a,0,4),s.setHours(0,0,0,0),Vv(s)}}class B2e extends es{constructor(){super(...arguments);Rr(this,"priority",130);Rr(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(r,n){return SS(n==="u"?4:n.length,r)}set(r,n,a){return r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}}class k2e extends es{constructor(){super(...arguments);Rr(this,"priority",120);Rr(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"Q":case"QQ":return $i(n.length,r);case"Qo":return a.ordinalNumber(r,{unit:"quarter"});case"QQQ":return a.quarter(r,{width:"abbreviated",context:"formatting"})||a.quarter(r,{width:"narrow",context:"formatting"});case"QQQQQ":return a.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(r,{width:"wide",context:"formatting"})||a.quarter(r,{width:"abbreviated",context:"formatting"})||a.quarter(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=1&&n<=4}set(r,n,a){return r.setMonth((a-1)*3,1),r.setHours(0,0,0,0),r}}class F2e extends es{constructor(){super(...arguments);Rr(this,"priority",120);Rr(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"q":case"qq":return $i(n.length,r);case"qo":return a.ordinalNumber(r,{unit:"quarter"});case"qqq":return a.quarter(r,{width:"abbreviated",context:"standalone"})||a.quarter(r,{width:"narrow",context:"standalone"});case"qqqqq":return a.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(r,{width:"wide",context:"standalone"})||a.quarter(r,{width:"abbreviated",context:"standalone"})||a.quarter(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=1&&n<=4}set(r,n,a){return r.setMonth((a-1)*3,1),r.setHours(0,0,0,0),r}}class O2e extends es{constructor(){super(...arguments);Rr(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);Rr(this,"priority",110)}parse(r,n,a){const s=o=>o-1;switch(n){case"M":return co(Ci(lo.month,r),s);case"MM":return co($i(2,r),s);case"Mo":return co(a.ordinalNumber(r,{unit:"month"}),s);case"MMM":return a.month(r,{width:"abbreviated",context:"formatting"})||a.month(r,{width:"narrow",context:"formatting"});case"MMMMM":return a.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(r,{width:"wide",context:"formatting"})||a.month(r,{width:"abbreviated",context:"formatting"})||a.month(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=11}set(r,n,a){return r.setMonth(a,1),r.setHours(0,0,0,0),r}}class D2e extends es{constructor(){super(...arguments);Rr(this,"priority",110);Rr(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(r,n,a){const s=o=>o-1;switch(n){case"L":return co(Ci(lo.month,r),s);case"LL":return co($i(2,r),s);case"Lo":return co(a.ordinalNumber(r,{unit:"month"}),s);case"LLL":return a.month(r,{width:"abbreviated",context:"standalone"})||a.month(r,{width:"narrow",context:"standalone"});case"LLLLL":return a.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(r,{width:"wide",context:"standalone"})||a.month(r,{width:"abbreviated",context:"standalone"})||a.month(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=11}set(r,n,a){return r.setMonth(a,1),r.setHours(0,0,0,0),r}}function R2e(t,e,r){const n=Pi(t,r==null?void 0:r.in),a=Yee(n,r)-e;return n.setDate(n.getDate()-a*7),Pi(n,r==null?void 0:r.in)}class M2e extends es{constructor(){super(...arguments);Rr(this,"priority",100);Rr(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(r,n,a){switch(n){case"w":return Ci(lo.week,r);case"wo":return a.ordinalNumber(r,{unit:"week"});default:return $i(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,a,s){return jm(R2e(r,a,s),s)}}function L2e(t,e,r){const n=Pi(t,r==null?void 0:r.in),a=Xee(n,r)-e;return n.setDate(n.getDate()-a*7),n}class U2e extends es{constructor(){super(...arguments);Rr(this,"priority",100);Rr(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(r,n,a){switch(n){case"I":return Ci(lo.week,r);case"Io":return a.ordinalNumber(r,{unit:"week"});default:return $i(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,a){return Vv(L2e(r,a))}}const Q2e=[31,28,31,30,31,30,31,31,30,31,30,31],V2e=[31,29,31,30,31,30,31,31,30,31,30,31];class H2e extends es{constructor(){super(...arguments);Rr(this,"priority",90);Rr(this,"subPriority",1);Rr(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"d":return Ci(lo.date,r);case"do":return a.ordinalNumber(r,{unit:"date"});default:return $i(n.length,r)}}validate(r,n){const a=r.getFullYear(),s=ate(a),o=r.getMonth();return s?n>=1&&n<=V2e[o]:n>=1&&n<=Q2e[o]}set(r,n,a){return r.setDate(a),r.setHours(0,0,0,0),r}}class $2e extends es{constructor(){super(...arguments);Rr(this,"priority",90);Rr(this,"subpriority",1);Rr(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(r,n,a){switch(n){case"D":case"DD":return Ci(lo.dayOfYear,r);case"Do":return a.ordinalNumber(r,{unit:"date"});default:return $i(n.length,r)}}validate(r,n){const a=r.getFullYear();return ate(a)?n>=1&&n<=366:n>=1&&n<=365}set(r,n,a){return r.setMonth(0,a),r.setHours(0,0,0,0),r}}function K6(t,e,r){var f,A,h,m;const n=w1(),a=(r==null?void 0:r.weekStartsOn)??((A=(f=r==null?void 0:r.locale)==null?void 0:f.options)==null?void 0:A.weekStartsOn)??n.weekStartsOn??((m=(h=n.locale)==null?void 0:h.options)==null?void 0:m.weekStartsOn)??0,s=Pi(t,r==null?void 0:r.in),o=s.getDay(),c=(e%7+7)%7,d=7-a,u=e<0||e>6?e-(o+d)%7:(c+d)%7-(o+d)%7;return V6(s,u,r)}class G2e extends es{constructor(){super(...arguments);Rr(this,"priority",90);Rr(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"E":case"EE":case"EEE":return a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"EEEEE":return a.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"EEEE":default:return a.day(r,{width:"wide",context:"formatting"})||a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,a,s){return r=K6(r,a,s),r.setHours(0,0,0,0),r}}class K2e extends es{constructor(){super(...arguments);Rr(this,"priority",90);Rr(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(r,n,a,s){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+s.weekStartsOn+6)%7+c};switch(n){case"e":case"ee":return co($i(n.length,r),o);case"eo":return co(a.ordinalNumber(r,{unit:"day"}),o);case"eee":return a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"eeeee":return a.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"eeee":default:return a.day(r,{width:"wide",context:"formatting"})||a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,a,s){return r=K6(r,a,s),r.setHours(0,0,0,0),r}}class q2e extends es{constructor(){super(...arguments);Rr(this,"priority",90);Rr(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(r,n,a,s){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+s.weekStartsOn+6)%7+c};switch(n){case"c":case"cc":return co($i(n.length,r),o);case"co":return co(a.ordinalNumber(r,{unit:"day"}),o);case"ccc":return a.day(r,{width:"abbreviated",context:"standalone"})||a.day(r,{width:"short",context:"standalone"})||a.day(r,{width:"narrow",context:"standalone"});case"ccccc":return a.day(r,{width:"narrow",context:"standalone"});case"cccccc":return a.day(r,{width:"short",context:"standalone"})||a.day(r,{width:"narrow",context:"standalone"});case"cccc":default:return a.day(r,{width:"wide",context:"standalone"})||a.day(r,{width:"abbreviated",context:"standalone"})||a.day(r,{width:"short",context:"standalone"})||a.day(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=6}set(r,n,a,s){return r=K6(r,a,s),r.setHours(0,0,0,0),r}}function z2e(t,e,r){const n=Pi(t,r==null?void 0:r.in),a=w2e(n,r),s=e-a;return V6(n,s,r)}class W2e extends es{constructor(){super(...arguments);Rr(this,"priority",90);Rr(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(r,n,a){const s=o=>o===0?7:o;switch(n){case"i":case"ii":return $i(n.length,r);case"io":return a.ordinalNumber(r,{unit:"day"});case"iii":return co(a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"}),s);case"iiiii":return co(a.day(r,{width:"narrow",context:"formatting"}),s);case"iiiiii":return co(a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"}),s);case"iiii":default:return co(a.day(r,{width:"wide",context:"formatting"})||a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"}),s)}}validate(r,n){return n>=1&&n<=7}set(r,n,a){return r=z2e(r,a),r.setHours(0,0,0,0),r}}class X2e extends es{constructor(){super(...arguments);Rr(this,"priority",80);Rr(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(r,n,a){switch(n){case"a":case"aa":case"aaa":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaaa":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})||a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,a){return r.setHours(G6(a),0,0,0),r}}class Y2e extends es{constructor(){super(...arguments);Rr(this,"priority",80);Rr(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(r,n,a){switch(n){case"b":case"bb":case"bbb":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbbb":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})||a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,a){return r.setHours(G6(a),0,0,0),r}}class J2e extends es{constructor(){super(...arguments);Rr(this,"priority",80);Rr(this,"incompatibleTokens",["a","b","t","T"])}parse(r,n,a){switch(n){case"B":case"BB":case"BBB":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBBB":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})||a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,a){return r.setHours(G6(a),0,0,0),r}}class Z2e extends es{constructor(){super(...arguments);Rr(this,"priority",70);Rr(this,"incompatibleTokens",["H","K","k","t","T"])}parse(r,n,a){switch(n){case"h":return Ci(lo.hour12h,r);case"ho":return a.ordinalNumber(r,{unit:"hour"});default:return $i(n.length,r)}}validate(r,n){return n>=1&&n<=12}set(r,n,a){const s=r.getHours()>=12;return s&&a<12?r.setHours(a+12,0,0,0):!s&&a===12?r.setHours(0,0,0,0):r.setHours(a,0,0,0),r}}class ewe extends es{constructor(){super(...arguments);Rr(this,"priority",70);Rr(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(r,n,a){switch(n){case"H":return Ci(lo.hour23h,r);case"Ho":return a.ordinalNumber(r,{unit:"hour"});default:return $i(n.length,r)}}validate(r,n){return n>=0&&n<=23}set(r,n,a){return r.setHours(a,0,0,0),r}}class twe extends es{constructor(){super(...arguments);Rr(this,"priority",70);Rr(this,"incompatibleTokens",["h","H","k","t","T"])}parse(r,n,a){switch(n){case"K":return Ci(lo.hour11h,r);case"Ko":return a.ordinalNumber(r,{unit:"hour"});default:return $i(n.length,r)}}validate(r,n){return n>=0&&n<=11}set(r,n,a){return r.getHours()>=12&&a<12?r.setHours(a+12,0,0,0):r.setHours(a,0,0,0),r}}class rwe extends es{constructor(){super(...arguments);Rr(this,"priority",70);Rr(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(r,n,a){switch(n){case"k":return Ci(lo.hour24h,r);case"ko":return a.ordinalNumber(r,{unit:"hour"});default:return $i(n.length,r)}}validate(r,n){return n>=1&&n<=24}set(r,n,a){const s=a<=24?a%24:a;return r.setHours(s,0,0,0),r}}class nwe extends es{constructor(){super(...arguments);Rr(this,"priority",60);Rr(this,"incompatibleTokens",["t","T"])}parse(r,n,a){switch(n){case"m":return Ci(lo.minute,r);case"mo":return a.ordinalNumber(r,{unit:"minute"});default:return $i(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,a){return r.setMinutes(a,0,0),r}}class awe extends es{constructor(){super(...arguments);Rr(this,"priority",50);Rr(this,"incompatibleTokens",["t","T"])}parse(r,n,a){switch(n){case"s":return Ci(lo.second,r);case"so":return a.ordinalNumber(r,{unit:"second"});default:return $i(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,a){return r.setSeconds(a,0),r}}class swe extends es{constructor(){super(...arguments);Rr(this,"priority",30);Rr(this,"incompatibleTokens",["t","T"])}parse(r,n){const a=s=>Math.trunc(s*Math.pow(10,-n.length+3));return co($i(n.length,r),a)}set(r,n,a){return r.setMilliseconds(a),r}}class iwe extends es{constructor(){super(...arguments);Rr(this,"priority",10);Rr(this,"incompatibleTokens",["t","T","x"])}parse(r,n){switch(n){case"X":return Jf(Yf.basicOptionalMinutes,r);case"XX":return Jf(Yf.basic,r);case"XXXX":return Jf(Yf.basicOptionalSeconds,r);case"XXXXX":return Jf(Yf.extendedOptionalSeconds,r);case"XXX":default:return Jf(Yf.extended,r)}}set(r,n,a){return n.timestampIsSet?r:_o(r,r.getTime()-ES(r)-a)}}class owe extends es{constructor(){super(...arguments);Rr(this,"priority",10);Rr(this,"incompatibleTokens",["t","T","X"])}parse(r,n){switch(n){case"x":return Jf(Yf.basicOptionalMinutes,r);case"xx":return Jf(Yf.basic,r);case"xxxx":return Jf(Yf.basicOptionalSeconds,r);case"xxxxx":return Jf(Yf.extendedOptionalSeconds,r);case"xxx":default:return Jf(Yf.extended,r)}}set(r,n,a){return n.timestampIsSet?r:_o(r,r.getTime()-ES(r)-a)}}class lwe extends es{constructor(){super(...arguments);Rr(this,"priority",40);Rr(this,"incompatibleTokens","*")}parse(r){return rte(r)}set(r,n,a){return[_o(r,a*1e3),{timestampIsSet:!0}]}}class cwe extends es{constructor(){super(...arguments);Rr(this,"priority",20);Rr(this,"incompatibleTokens","*")}parse(r){return rte(r)}set(r,n,a){return[_o(r,a),{timestampIsSet:!0}]}}const dwe={G:new j2e,y:new I2e,Y:new P2e,R:new T2e,u:new B2e,Q:new k2e,q:new F2e,M:new O2e,L:new D2e,w:new M2e,I:new U2e,d:new H2e,D:new $2e,E:new G2e,e:new K2e,c:new q2e,i:new W2e,a:new X2e,b:new Y2e,B:new J2e,h:new Z2e,H:new ewe,K:new twe,k:new rwe,m:new nwe,s:new awe,S:new swe,X:new iwe,x:new owe,t:new lwe,T:new cwe},uwe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,fwe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,hwe=/^'([^]*?)'?$/,Awe=/''/g,mwe=/\S/,pwe=/[a-zA-Z]/;function jS(t,e,r,n){var x,v,y,b;const a=()=>_o(r,NaN),s=b2e(),o=s.locale??Wee,l=s.firstWeekContainsDate??((v=(x=s.locale)==null?void 0:x.options)==null?void 0:v.firstWeekContainsDate)??1,c=s.weekStartsOn??((b=(y=s.locale)==null?void 0:y.options)==null?void 0:b.weekStartsOn)??0;if(!e)return t?a():Pi(r,n==null?void 0:n.in);const d={firstWeekContainsDate:l,weekStartsOn:c,locale:o},u=[new S2e(n==null?void 0:n.in,r)],f=e.match(fwe).map(w=>{const I=w[0];if(I in xk){const j=xk[I];return j(w,o.formatLong)}return w}).join("").match(uwe),A=[];for(let w of f){ete(w)&&vk(w,e,t),Zee(w)&&vk(w,e,t);const I=w[0],j=dwe[I];if(j){const{incompatibleTokens:N}=j;if(Array.isArray(N)){const E=A.find(B=>N.includes(B.token)||B.token===I);if(E)throw new RangeError(`The format string mustn't contain \`${E.fullToken}\` and \`${w}\` at the same time`)}else if(j.incompatibleTokens==="*"&&A.length>0)throw new RangeError(`The format string mustn't contain \`${w}\` and any other token at the same time`);A.push({token:I,fullToken:w});const S=j.run(t,w,o.match,d);if(!S)return a();u.push(S.setter),t=S.rest}else{if(I.match(pwe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+I+"`");if(w==="''"?w="'":I==="'"&&(w=gwe(w)),t.indexOf(w)===0)t=t.slice(w.length);else return a()}}if(t.length>0&&mwe.test(t))return a();const h=u.map(w=>w.priority).sort((w,I)=>I-w).filter((w,I,j)=>j.indexOf(w)===I).map(w=>u.filter(I=>I.priority===w).sort((I,j)=>j.subPriority-I.subPriority)).map(w=>w[0]);let m=Pi(r,n==null?void 0:n.in);if(isNaN(+m))return a();const p={};for(const w of h){if(!w.validate(m,d))return a();const I=w.set(m,p,d);Array.isArray(I)?(m=I[0],Object.assign(p,I[1])):m=I}return m}function gwe(t){return t.match(hwe)[1].replace(Awe,"'")}function ste(t,e,r){return V6(t,-14,r)}function xwe(t,e,r){return Nbe(t,-1,r)}/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var yk=function(t,e){return yk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},yk(t,e)};function kf(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");yk(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var bk=function(){return bk=Object.assign||function(e){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},bk.apply(this,arguments)};function Bc(t,e,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(u){try{d(n.next(u))}catch(f){o(f)}}function c(u){try{d(n.throw(u))}catch(f){o(f)}}function d(u){u.done?s(u.value):a(u.value).then(l,c)}d((n=n.apply(t,[])).next())})}function oc(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(u){return c([d,u])}}function c(d){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=d[0]&2?a.return:d[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,d[1])).done)return s;switch(a=0,s&&(d=[d[0]&2,s.value]),d[0]){case 0:case 1:s=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,a=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!s||d[1]>s[0]&&d[1]<s[3])){r.label=d[1];break}if(d[0]===6&&r.label<s[1]){r.label=s[1],s=d;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(d);break}s[2]&&r.ops.pop(),r.trys.pop();continue}d=e.call(t,r)}catch(u){d=[6,u],a=0}finally{n=s=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function uC(t,e,r){if(arguments.length===2)for(var n=0,a=e.length,s;n<a;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||e)}var NA=function(){function t(e,r,n,a){this.left=e,this.top=r,this.width=n,this.height=a}return t.prototype.add=function(e,r,n,a){return new t(this.left+e,this.top+r,this.width+n,this.height+a)},t.fromClientRect=function(e,r){return new t(r.left+e.windowBounds.left,r.top+e.windowBounds.top,r.width,r.height)},t.fromDOMRectList=function(e,r){var n=Array.from(r).find(function(a){return a.width!==0});return n?new t(n.left+e.windowBounds.left,n.top+e.windowBounds.top,n.width,n.height):t.EMPTY},t.EMPTY=new t(0,0,0,0),t}(),rP=function(t,e){return NA.fromClientRect(t,e.getBoundingClientRect())},vwe=function(t){var e=t.body,r=t.documentElement;if(!e||!r)throw new Error("Unable to get document size");var n=Math.max(Math.max(e.scrollWidth,r.scrollWidth),Math.max(e.offsetWidth,r.offsetWidth),Math.max(e.clientWidth,r.clientWidth)),a=Math.max(Math.max(e.scrollHeight,r.scrollHeight),Math.max(e.offsetHeight,r.offsetHeight),Math.max(e.clientHeight,r.clientHeight));return new NA(0,0,n,a)},nP=function(t){for(var e=[],r=0,n=t.length;r<n;){var a=t.charCodeAt(r++);if(a>=55296&&a<=56319&&r<n){var s=t.charCodeAt(r++);(s&64512)===56320?e.push(((a&1023)<<10)+(s&1023)+65536):(e.push(a),r--)}else e.push(a)}return e},ro=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var n=[],a=-1,s="";++a<r;){var o=t[a];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(a+1===r||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},H9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ywe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var fC=0;fC<H9.length;fC++)ywe[H9.charCodeAt(fC)]=fC;var $9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Wy=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var hC=0;hC<$9.length;hC++)Wy[$9.charCodeAt(hC)]=hC;var bwe=function(t){var e=t.length*.75,r=t.length,n,a=0,s,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var d=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),u=Array.isArray(d)?d:new Uint8Array(d);for(n=0;n<r;n+=4)s=Wy[t.charCodeAt(n)],o=Wy[t.charCodeAt(n+1)],l=Wy[t.charCodeAt(n+2)],c=Wy[t.charCodeAt(n+3)],u[a++]=s<<2|o>>4,u[a++]=(o&15)<<4|l>>2,u[a++]=(l&3)<<6|c&63;return d},wwe=function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r.push(t[n+1]<<8|t[n]);return r},Nwe=function(t){for(var e=t.length,r=[],n=0;n<e;n+=4)r.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return r},Up=5,q6=11,M4=2,Cwe=q6-Up,ite=65536>>Up,_we=1<<Up,L4=_we-1,Ewe=1024>>Up,Swe=ite+Ewe,jwe=Swe,Iwe=32,Pwe=jwe+Iwe,Twe=65536>>q6,Bwe=1<<Cwe,kwe=Bwe-1,G9=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},Fwe=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},Owe=function(t,e){var r=bwe(t),n=Array.isArray(r)?Nwe(r):new Uint32Array(r),a=Array.isArray(r)?wwe(r):new Uint16Array(r),s=24,o=G9(a,s/2,n[4]/2),l=n[5]===2?G9(a,(s+n[4])/2):Fwe(n,Math.ceil((s+n[4])/4));return new Dwe(n[0],n[1],n[2],n[3],o,l)},Dwe=function(){function t(e,r,n,a,s,o){this.initialValue=e,this.errorValue=r,this.highStart=n,this.highValueIndex=a,this.index=s,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>Up],r=(r<<M4)+(e&L4),this.data[r];if(e<=65535)return r=this.index[ite+(e-55296>>Up)],r=(r<<M4)+(e&L4),this.data[r];if(e<this.highStart)return r=Pwe-Twe+(e>>q6),r=this.index[r],r+=e>>Up&kwe,r=this.index[r],r=(r<<M4)+(e&L4),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),K9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Rwe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var AC=0;AC<K9.length;AC++)Rwe[K9.charCodeAt(AC)]=AC;var Mwe="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",q9=50,Lwe=1,ote=2,lte=3,Uwe=4,Qwe=5,z9=7,cte=8,W9=9,W0=10,wk=11,X9=12,Nk=13,Vwe=14,Xy=15,Ck=16,mC=17,xy=18,Hwe=19,Y9=20,_k=21,vy=22,U4=23,lx=24,Td=25,Yy=26,Jy=27,cx=28,$we=29,Cp=30,Gwe=31,pC=32,gC=33,Ek=34,Sk=35,jk=36,P2=37,Ik=38,xE=39,vE=40,Q4=41,dte=42,Kwe=43,qwe=[9001,65288],ute="!",Sa="",xC="",Pk=Owe(Mwe),Ih=[Cp,jk],Tk=[Lwe,ote,lte,Qwe],fte=[W0,cte],J9=[Jy,Yy],zwe=Tk.concat(fte),Z9=[Ik,xE,vE,Ek,Sk],Wwe=[Xy,Nk],Xwe=function(t,e){e===void 0&&(e="strict");var r=[],n=[],a=[];return t.forEach(function(s,o){var l=Pk.get(s);if(l>q9?(a.push(!0),l-=q9):a.push(!1),["normal","auto","loose"].indexOf(e)!==-1&&[8208,8211,12316,12448].indexOf(s)!==-1)return n.push(o),r.push(Ck);if(l===Uwe||l===wk){if(o===0)return n.push(o),r.push(Cp);var c=r[o-1];return zwe.indexOf(c)===-1?(n.push(n[o-1]),r.push(c)):(n.push(o),r.push(Cp))}if(n.push(o),l===Gwe)return r.push(e==="strict"?_k:P2);if(l===dte||l===$we)return r.push(Cp);if(l===Kwe)return s>=131072&&s<=196605||s>=196608&&s<=262141?r.push(P2):r.push(Cp);r.push(l)}),[n,r,a]},V4=function(t,e,r,n){var a=n[r];if(Array.isArray(t)?t.indexOf(a)!==-1:t===a)for(var s=r;s<=n.length;){s++;var o=n[s];if(o===e)return!0;if(o!==W0)break}if(a===W0)for(var s=r;s>0;){s--;var l=n[s];if(Array.isArray(t)?t.indexOf(l)!==-1:t===l)for(var c=r;c<=n.length;){c++;var o=n[c];if(o===e)return!0;if(o!==W0)break}if(l!==W0)break}return!1},eQ=function(t,e){for(var r=t;r>=0;){var n=e[r];if(n===W0)r--;else return n}return 0},Ywe=function(t,e,r,n,a){if(r[n]===0)return Sa;var s=n-1;if(Array.isArray(a)&&a[s]===!0)return Sa;var o=s-1,l=s+1,c=e[s],d=o>=0?e[o]:0,u=e[l];if(c===ote&&u===lte)return Sa;if(Tk.indexOf(c)!==-1)return ute;if(Tk.indexOf(u)!==-1||fte.indexOf(u)!==-1)return Sa;if(eQ(s,e)===cte)return xC;if(Pk.get(t[s])===wk||(c===pC||c===gC)&&Pk.get(t[l])===wk||c===z9||u===z9||c===W9||[W0,Nk,Xy].indexOf(c)===-1&&u===W9||[mC,xy,Hwe,lx,cx].indexOf(u)!==-1||eQ(s,e)===vy||V4(U4,vy,s,e)||V4([mC,xy],_k,s,e)||V4(X9,X9,s,e))return Sa;if(c===W0)return xC;if(c===U4||u===U4)return Sa;if(u===Ck||c===Ck)return xC;if([Nk,Xy,_k].indexOf(u)!==-1||c===Vwe||d===jk&&Wwe.indexOf(c)!==-1||c===cx&&u===jk||u===Y9||Ih.indexOf(u)!==-1&&c===Td||Ih.indexOf(c)!==-1&&u===Td||c===Jy&&[P2,pC,gC].indexOf(u)!==-1||[P2,pC,gC].indexOf(c)!==-1&&u===Yy||Ih.indexOf(c)!==-1&&J9.indexOf(u)!==-1||J9.indexOf(c)!==-1&&Ih.indexOf(u)!==-1||[Jy,Yy].indexOf(c)!==-1&&(u===Td||[vy,Xy].indexOf(u)!==-1&&e[l+1]===Td)||[vy,Xy].indexOf(c)!==-1&&u===Td||c===Td&&[Td,cx,lx].indexOf(u)!==-1)return Sa;if([Td,cx,lx,mC,xy].indexOf(u)!==-1)for(var f=s;f>=0;){var A=e[f];if(A===Td)return Sa;if([cx,lx].indexOf(A)!==-1)f--;else break}if([Jy,Yy].indexOf(u)!==-1)for(var f=[mC,xy].indexOf(c)!==-1?o:s;f>=0;){var A=e[f];if(A===Td)return Sa;if([cx,lx].indexOf(A)!==-1)f--;else break}if(Ik===c&&[Ik,xE,Ek,Sk].indexOf(u)!==-1||[xE,Ek].indexOf(c)!==-1&&[xE,vE].indexOf(u)!==-1||[vE,Sk].indexOf(c)!==-1&&u===vE||Z9.indexOf(c)!==-1&&[Y9,Yy].indexOf(u)!==-1||Z9.indexOf(u)!==-1&&c===Jy||Ih.indexOf(c)!==-1&&Ih.indexOf(u)!==-1||c===lx&&Ih.indexOf(u)!==-1||Ih.concat(Td).indexOf(c)!==-1&&u===vy&&qwe.indexOf(t[l])===-1||Ih.concat(Td).indexOf(u)!==-1&&c===xy)return Sa;if(c===Q4&&u===Q4){for(var h=r[s],m=1;h>0&&(h--,e[h]===Q4);)m++;if(m%2!==0)return Sa}return c===pC&&u===gC?Sa:xC},Jwe=function(t,e){e||(e={lineBreak:"normal",wordBreak:"normal"});var r=Xwe(t,e.lineBreak),n=r[0],a=r[1],s=r[2];(e.wordBreak==="break-all"||e.wordBreak==="break-word")&&(a=a.map(function(l){return[Td,Cp,dte].indexOf(l)!==-1?P2:l}));var o=e.wordBreak==="keep-all"?s.map(function(l,c){return l&&t[c]>=19968&&t[c]<=40959}):void 0;return[n,a,o]},Zwe=function(){function t(e,r,n,a){this.codePoints=e,this.required=r===ute,this.start=n,this.end=a}return t.prototype.slice=function(){return ro.apply(void 0,this.codePoints.slice(this.start,this.end))},t}(),eNe=function(t,e){var r=nP(t),n=Jwe(r,e),a=n[0],s=n[1],o=n[2],l=r.length,c=0,d=0;return{next:function(){if(d>=l)return{done:!0,value:null};for(var u=Sa;d<l&&(u=Ywe(r,s,a,++d,o))===Sa;);if(u!==Sa||d===l){var f=new Zwe(r,u,c,d);return c=d,{value:f,done:!1}}return{done:!0,value:null}}}},tNe=1,rNe=2,Lw=4,tQ=8,IS=10,rQ=47,Sb=92,nNe=9,aNe=32,vC=34,yy=61,sNe=35,iNe=36,oNe=37,yC=39,bC=40,by=41,lNe=95,sd=45,cNe=33,dNe=60,uNe=62,fNe=64,hNe=91,ANe=93,mNe=61,pNe=123,wC=63,gNe=125,nQ=124,xNe=126,vNe=128,aQ=65533,H4=42,Pp=43,yNe=44,bNe=58,wNe=59,T2=46,NNe=0,CNe=8,_Ne=11,ENe=14,SNe=31,jNe=127,Qf=-1,hte=48,Ate=97,mte=101,INe=102,PNe=117,TNe=122,pte=65,gte=69,xte=70,BNe=85,kNe=90,dc=function(t){return t>=hte&&t<=57},FNe=function(t){return t>=55296&&t<=57343},dx=function(t){return dc(t)||t>=pte&&t<=xte||t>=Ate&&t<=INe},ONe=function(t){return t>=Ate&&t<=TNe},DNe=function(t){return t>=pte&&t<=kNe},RNe=function(t){return ONe(t)||DNe(t)},MNe=function(t){return t>=vNe},NC=function(t){return t===IS||t===nNe||t===aNe},PS=function(t){return RNe(t)||MNe(t)||t===lNe},sQ=function(t){return PS(t)||dc(t)||t===sd},LNe=function(t){return t>=NNe&&t<=CNe||t===_Ne||t>=ENe&&t<=SNe||t===jNe},T0=function(t,e){return t!==Sb?!1:e!==IS},CC=function(t,e,r){return t===sd?PS(e)||T0(e,r):PS(t)?!0:!!(t===Sb&&T0(t,e))},$4=function(t,e,r){return t===Pp||t===sd?dc(e)?!0:e===T2&&dc(r):dc(t===T2?e:t)},UNe=function(t){var e=0,r=1;(t[e]===Pp||t[e]===sd)&&(t[e]===sd&&(r=-1),e++);for(var n=[];dc(t[e]);)n.push(t[e++]);var a=n.length?parseInt(ro.apply(void 0,n),10):0;t[e]===T2&&e++;for(var s=[];dc(t[e]);)s.push(t[e++]);var o=s.length,l=o?parseInt(ro.apply(void 0,s),10):0;(t[e]===gte||t[e]===mte)&&e++;var c=1;(t[e]===Pp||t[e]===sd)&&(t[e]===sd&&(c=-1),e++);for(var d=[];dc(t[e]);)d.push(t[e++]);var u=d.length?parseInt(ro.apply(void 0,d),10):0;return r*(a+l*Math.pow(10,-o))*Math.pow(10,c*u)},QNe={type:2},VNe={type:3},HNe={type:4},$Ne={type:13},GNe={type:8},KNe={type:21},qNe={type:9},zNe={type:10},WNe={type:11},XNe={type:12},YNe={type:14},_C={type:23},JNe={type:1},ZNe={type:25},eCe={type:24},tCe={type:26},rCe={type:27},nCe={type:28},aCe={type:29},sCe={type:31},Bk={type:32},vte=function(){function t(){this._value=[]}return t.prototype.write=function(e){this._value=this._value.concat(nP(e))},t.prototype.read=function(){for(var e=[],r=this.consumeToken();r!==Bk;)e.push(r),r=this.consumeToken();return e},t.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case vC:return this.consumeStringToken(vC);case sNe:var r=this.peekCodePoint(0),n=this.peekCodePoint(1),a=this.peekCodePoint(2);if(sQ(r)||T0(n,a)){var s=CC(r,n,a)?rNe:tNe,o=this.consumeName();return{type:5,value:o,flags:s}}break;case iNe:if(this.peekCodePoint(0)===yy)return this.consumeCodePoint(),$Ne;break;case yC:return this.consumeStringToken(yC);case bC:return QNe;case by:return VNe;case H4:if(this.peekCodePoint(0)===yy)return this.consumeCodePoint(),YNe;break;case Pp:if($4(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case yNe:return HNe;case sd:var l=e,c=this.peekCodePoint(0),d=this.peekCodePoint(1);if($4(l,c,d))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(CC(l,c,d))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(c===sd&&d===uNe)return this.consumeCodePoint(),this.consumeCodePoint(),eCe;break;case T2:if($4(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case rQ:if(this.peekCodePoint(0)===H4)for(this.consumeCodePoint();;){var u=this.consumeCodePoint();if(u===H4&&(u=this.consumeCodePoint(),u===rQ))return this.consumeToken();if(u===Qf)return this.consumeToken()}break;case bNe:return tCe;case wNe:return rCe;case dNe:if(this.peekCodePoint(0)===cNe&&this.peekCodePoint(1)===sd&&this.peekCodePoint(2)===sd)return this.consumeCodePoint(),this.consumeCodePoint(),ZNe;break;case fNe:var f=this.peekCodePoint(0),A=this.peekCodePoint(1),h=this.peekCodePoint(2);if(CC(f,A,h)){var o=this.consumeName();return{type:7,value:o}}break;case hNe:return nCe;case Sb:if(T0(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case ANe:return aCe;case mNe:if(this.peekCodePoint(0)===yy)return this.consumeCodePoint(),GNe;break;case pNe:return WNe;case gNe:return XNe;case PNe:case BNe:var m=this.peekCodePoint(0),p=this.peekCodePoint(1);return m===Pp&&(dx(p)||p===wC)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case nQ:if(this.peekCodePoint(0)===yy)return this.consumeCodePoint(),qNe;if(this.peekCodePoint(0)===nQ)return this.consumeCodePoint(),KNe;break;case xNe:if(this.peekCodePoint(0)===yy)return this.consumeCodePoint(),zNe;break;case Qf:return Bk}return NC(e)?(this.consumeWhiteSpace(),sCe):dc(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):PS(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:ro(e)}},t.prototype.consumeCodePoint=function(){var e=this._value.shift();return typeof e>"u"?-1:e},t.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},t.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},t.prototype.consumeUnicodeRangeToken=function(){for(var e=[],r=this.consumeCodePoint();dx(r)&&e.length<6;)e.push(r),r=this.consumeCodePoint();for(var n=!1;r===wC&&e.length<6;)e.push(r),r=this.consumeCodePoint(),n=!0;if(n){var a=parseInt(ro.apply(void 0,e.map(function(c){return c===wC?hte:c})),16),s=parseInt(ro.apply(void 0,e.map(function(c){return c===wC?xte:c})),16);return{type:30,start:a,end:s}}var o=parseInt(ro.apply(void 0,e),16);if(this.peekCodePoint(0)===sd&&dx(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var l=[];dx(r)&&l.length<6;)l.push(r),r=this.consumeCodePoint();var s=parseInt(ro.apply(void 0,l),16);return{type:30,start:o,end:s}}else return{type:30,start:o,end:o}},t.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return e.toLowerCase()==="url"&&this.peekCodePoint(0)===bC?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===bC?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},t.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Qf)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===yC||r===vC){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Qf||this.peekCodePoint(0)===by)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),_C)}for(;;){var a=this.consumeCodePoint();if(a===Qf||a===by)return{type:22,value:ro.apply(void 0,e)};if(NC(a))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Qf||this.peekCodePoint(0)===by?(this.consumeCodePoint(),{type:22,value:ro.apply(void 0,e)}):(this.consumeBadUrlRemnants(),_C);if(a===vC||a===yC||a===bC||LNe(a))return this.consumeBadUrlRemnants(),_C;if(a===Sb)if(T0(a,this.peekCodePoint(0)))e.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),_C;else e.push(a)}},t.prototype.consumeWhiteSpace=function(){for(;NC(this.peekCodePoint(0));)this.consumeCodePoint()},t.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===by||e===Qf)return;T0(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},t.prototype.consumeStringSlice=function(e){for(var r=5e4,n="";e>0;){var a=Math.min(r,e);n+=ro.apply(void 0,this._value.splice(0,a)),e-=a}return this._value.shift(),n},t.prototype.consumeStringToken=function(e){var r="",n=0;do{var a=this._value[n];if(a===Qf||a===void 0||a===e)return r+=this.consumeStringSlice(n),{type:0,value:r};if(a===IS)return this._value.splice(0,n),JNe;if(a===Sb){var s=this._value[n+1];s!==Qf&&s!==void 0&&(s===IS?(r+=this.consumeStringSlice(n),n=-1,this._value.shift()):T0(a,s)&&(r+=this.consumeStringSlice(n),r+=ro(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},t.prototype.consumeNumber=function(){var e=[],r=Lw,n=this.peekCodePoint(0);for((n===Pp||n===sd)&&e.push(this.consumeCodePoint());dc(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0);var a=this.peekCodePoint(1);if(n===T2&&dc(a))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=tQ;dc(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0),a=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((n===gte||n===mte)&&((a===Pp||a===sd)&&dc(s)||dc(a)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=tQ;dc(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[UNe(e),r]},t.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),r=e[0],n=e[1],a=this.peekCodePoint(0),s=this.peekCodePoint(1),o=this.peekCodePoint(2);if(CC(a,s,o)){var l=this.consumeName();return{type:15,number:r,flags:n,unit:l}}return a===oNe?(this.consumeCodePoint(),{type:16,number:r,flags:n}):{type:17,number:r,flags:n}},t.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(dx(e)){for(var r=ro(e);dx(this.peekCodePoint(0))&&r.length<6;)r+=ro(this.consumeCodePoint());NC(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(r,16);return n===0||FNe(n)||n>1114111?aQ:n}return e===Qf?aQ:e},t.prototype.consumeName=function(){for(var e="";;){var r=this.consumeCodePoint();if(sQ(r))e+=ro(r);else if(T0(r,this.peekCodePoint(0)))e+=ro(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),e}},t}(),yte=function(){function t(e){this._tokens=e}return t.create=function(e){var r=new vte;return r.write(e),new t(r.read())},t.parseValue=function(e){return t.create(e).parseComponentValue()},t.parseValues=function(e){return t.create(e).parseComponentValues()},t.prototype.parseComponentValue=function(){for(var e=this.consumeToken();e.type===31;)e=this.consumeToken();if(e.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var r=this.consumeComponentValue();do e=this.consumeToken();while(e.type===31);if(e.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},t.prototype.parseComponentValues=function(){for(var e=[];;){var r=this.consumeComponentValue();if(r.type===32)return e;e.push(r),e.push()}},t.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},t.prototype.consumeSimpleBlock=function(e){for(var r={type:e,values:[]},n=this.consumeToken();;){if(n.type===32||oCe(n,e))return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue()),n=this.consumeToken()}},t.prototype.consumeFunction=function(e){for(var r={name:e.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue())}},t.prototype.consumeToken=function(){var e=this._tokens.shift();return typeof e>"u"?Bk:e},t.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},t}(),Uw=function(t){return t.type===15},N1=function(t){return t.type===17},Ns=function(t){return t.type===20},iCe=function(t){return t.type===0},kk=function(t,e){return Ns(t)&&t.value===e},bte=function(t){return t.type!==31},Hv=function(t){return t.type!==31&&t.type!==4},xh=function(t){var e=[],r=[];return t.forEach(function(n){if(n.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");e.push(r),r=[];return}n.type!==31&&r.push(n)}),r.length&&e.push(r),e},oCe=function(t,e){return e===11&&t.type===12||e===28&&t.type===29?!0:e===2&&t.type===3},Im=function(t){return t.type===17||t.type===15},yo=function(t){return t.type===16||Im(t)},wte=function(t){return t.length>1?[t[0],t[1]]:[t[0]]},Ql={type:17,number:0,flags:Lw},z6={type:16,number:50,flags:Lw},X0={type:16,number:100,flags:Lw},Zy=function(t,e,r){var n=t[0],a=t[1];return[Ds(n,e),Ds(typeof a<"u"?a:n,r)]},Ds=function(t,e){if(t.type===16)return t.number/100*e;if(Uw(t))switch(t.unit){case"rem":case"em":return 16*t.number;case"px":default:return t.number}return t.number},Nte="deg",Cte="grad",_te="rad",Ete="turn",aP={name:"angle",parse:function(t,e){if(e.type===15)switch(e.unit){case Nte:return Math.PI*e.number/180;case Cte:return Math.PI/200*e.number;case _te:return e.number;case Ete:return Math.PI*2*e.number}throw new Error("Unsupported angle type")}},Ste=function(t){return t.type===15&&(t.unit===Nte||t.unit===Cte||t.unit===_te||t.unit===Ete)},jte=function(t){var e=t.filter(Ns).map(function(r){return r.value}).join(" ");switch(e){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Ql,Ql];case"to top":case"bottom":return ju(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Ql,X0];case"to right":case"left":return ju(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[X0,X0];case"to bottom":case"top":return ju(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[X0,Ql];case"to left":case"right":return ju(270)}return 0},ju=function(t){return Math.PI*t/180},Am={name:"color",parse:function(t,e){if(e.type===18){var r=lCe[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return r(t,e.values)}if(e.type===5){if(e.value.length===3){var n=e.value.substring(0,1),a=e.value.substring(1,2),s=e.value.substring(2,3);return Y0(parseInt(n+n,16),parseInt(a+a,16),parseInt(s+s,16),1)}if(e.value.length===4){var n=e.value.substring(0,1),a=e.value.substring(1,2),s=e.value.substring(2,3),o=e.value.substring(3,4);return Y0(parseInt(n+n,16),parseInt(a+a,16),parseInt(s+s,16),parseInt(o+o,16)/255)}if(e.value.length===6){var n=e.value.substring(0,2),a=e.value.substring(2,4),s=e.value.substring(4,6);return Y0(parseInt(n,16),parseInt(a,16),parseInt(s,16),1)}if(e.value.length===8){var n=e.value.substring(0,2),a=e.value.substring(2,4),s=e.value.substring(4,6),o=e.value.substring(6,8);return Y0(parseInt(n,16),parseInt(a,16),parseInt(s,16),parseInt(o,16)/255)}}if(e.type===20){var l=cA[e.value.toUpperCase()];if(typeof l<"u")return l}return cA.TRANSPARENT}},mm=function(t){return(255&t)===0},nl=function(t){var e=255&t,r=255&t>>8,n=255&t>>16,a=255&t>>24;return e<255?"rgba("+a+","+n+","+r+","+e/255+")":"rgb("+a+","+n+","+r+")"},Y0=function(t,e,r,n){return(t<<24|e<<16|r<<8|Math.round(n*255)<<0)>>>0},iQ=function(t,e){if(t.type===17)return t.number;if(t.type===16){var r=e===3?1:255;return e===3?t.number/100*r:Math.round(t.number/100*r)}return 0},oQ=function(t,e){var r=e.filter(Hv);if(r.length===3){var n=r.map(iQ),a=n[0],s=n[1],o=n[2];return Y0(a,s,o,1)}if(r.length===4){var l=r.map(iQ),a=l[0],s=l[1],o=l[2],c=l[3];return Y0(a,s,o,c)}return 0};function G4(t,e,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(e-t)*r*6+t:r<1/2?e:r<2/3?(e-t)*6*(2/3-r)+t:t}var lQ=function(t,e){var r=e.filter(Hv),n=r[0],a=r[1],s=r[2],o=r[3],l=(n.type===17?ju(n.number):aP.parse(t,n))/(Math.PI*2),c=yo(a)?a.number/100:0,d=yo(s)?s.number/100:0,u=typeof o<"u"&&yo(o)?Ds(o,1):1;if(c===0)return Y0(d*255,d*255,d*255,1);var f=d<=.5?d*(c+1):d+c-d*c,A=d*2-f,h=G4(A,f,l+1/3),m=G4(A,f,l),p=G4(A,f,l-1/3);return Y0(h*255,m*255,p*255,u)},lCe={hsl:lQ,hsla:lQ,rgb:oQ,rgba:oQ},jb=function(t,e){return Am.parse(t,yte.create(e).parseComponentValue())},cA={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},cCe={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if(Ns(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},dCe={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},sP=function(t,e){var r=Am.parse(t,e[0]),n=e[1];return n&&yo(n)?{color:r,stop:n}:{color:r,stop:null}},cQ=function(t,e){var r=t[0],n=t[t.length-1];r.stop===null&&(r.stop=Ql),n.stop===null&&(n.stop=X0);for(var a=[],s=0,o=0;o<t.length;o++){var l=t[o].stop;if(l!==null){var c=Ds(l,e);c>s?a.push(c):a.push(s),s=c}else a.push(null)}for(var d=null,o=0;o<a.length;o++){var u=a[o];if(u===null)d===null&&(d=o);else if(d!==null){for(var f=o-d,A=a[d-1],h=(u-A)/(f+1),m=1;m<=f;m++)a[d+m-1]=h*m;d=null}}return t.map(function(p,x){var v=p.color;return{color:v,stop:Math.max(Math.min(1,a[x]/e),0)}})},uCe=function(t,e,r){var n=e/2,a=r/2,s=Ds(t[0],e)-n,o=a-Ds(t[1],r);return(Math.atan2(o,s)+Math.PI*2)%(Math.PI*2)},fCe=function(t,e,r){var n=typeof t=="number"?t:uCe(t,e,r),a=Math.abs(e*Math.sin(n))+Math.abs(r*Math.cos(n)),s=e/2,o=r/2,l=a/2,c=Math.sin(n-Math.PI/2)*l,d=Math.cos(n-Math.PI/2)*l;return[a,s-d,s+d,o-c,o+c]},cf=function(t,e){return Math.sqrt(t*t+e*e)},dQ=function(t,e,r,n,a){var s=[[0,0],[0,e],[t,0],[t,e]];return s.reduce(function(o,l){var c=l[0],d=l[1],u=cf(r-c,n-d);return(a?u<o.optimumDistance:u>o.optimumDistance)?{optimumCorner:l,optimumDistance:u}:o},{optimumDistance:a?1/0:-1/0,optimumCorner:null}).optimumCorner},hCe=function(t,e,r,n,a){var s=0,o=0;switch(t.size){case 0:t.shape===0?s=o=Math.min(Math.abs(e),Math.abs(e-n),Math.abs(r),Math.abs(r-a)):t.shape===1&&(s=Math.min(Math.abs(e),Math.abs(e-n)),o=Math.min(Math.abs(r),Math.abs(r-a)));break;case 2:if(t.shape===0)s=o=Math.min(cf(e,r),cf(e,r-a),cf(e-n,r),cf(e-n,r-a));else if(t.shape===1){var l=Math.min(Math.abs(r),Math.abs(r-a))/Math.min(Math.abs(e),Math.abs(e-n)),c=dQ(n,a,e,r,!0),d=c[0],u=c[1];s=cf(d-e,(u-r)/l),o=l*s}break;case 1:t.shape===0?s=o=Math.max(Math.abs(e),Math.abs(e-n),Math.abs(r),Math.abs(r-a)):t.shape===1&&(s=Math.max(Math.abs(e),Math.abs(e-n)),o=Math.max(Math.abs(r),Math.abs(r-a)));break;case 3:if(t.shape===0)s=o=Math.max(cf(e,r),cf(e,r-a),cf(e-n,r),cf(e-n,r-a));else if(t.shape===1){var l=Math.max(Math.abs(r),Math.abs(r-a))/Math.max(Math.abs(e),Math.abs(e-n)),f=dQ(n,a,e,r,!1),d=f[0],u=f[1];s=cf(d-e,(u-r)/l),o=l*s}break}return Array.isArray(t.size)&&(s=Ds(t.size[0],n),o=t.size.length===2?Ds(t.size[1],a):s),[s,o]},ACe=function(t,e){var r=ju(180),n=[];return xh(e).forEach(function(a,s){if(s===0){var o=a[0];if(o.type===20&&o.value==="to"){r=jte(a);return}else if(Ste(o)){r=aP.parse(t,o);return}}var l=sP(t,a);n.push(l)}),{angle:r,stops:n,type:1}},EC=function(t,e){var r=ju(180),n=[];return xh(e).forEach(function(a,s){if(s===0){var o=a[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){r=jte(a);return}else if(Ste(o)){r=(aP.parse(t,o)+ju(270))%ju(360);return}}var l=sP(t,a);n.push(l)}),{angle:r,stops:n,type:1}},mCe=function(t,e){var r=ju(180),n=[],a=1,s=0,o=3,l=[];return xh(e).forEach(function(c,d){var u=c[0];if(d===0){if(Ns(u)&&u.value==="linear"){a=1;return}else if(Ns(u)&&u.value==="radial"){a=2;return}}if(u.type===18){if(u.name==="from"){var f=Am.parse(t,u.values[0]);n.push({stop:Ql,color:f})}else if(u.name==="to"){var f=Am.parse(t,u.values[0]);n.push({stop:X0,color:f})}else if(u.name==="color-stop"){var A=u.values.filter(Hv);if(A.length===2){var f=Am.parse(t,A[1]),h=A[0];N1(h)&&n.push({stop:{type:16,number:h.number*100,flags:h.flags},color:f})}}}}),a===1?{angle:(r+ju(180))%ju(360),stops:n,type:a}:{size:o,shape:s,stops:n,position:l,type:a}},Ite="closest-side",Pte="farthest-side",Tte="closest-corner",Bte="farthest-corner",kte="circle",Fte="ellipse",Ote="cover",Dte="contain",pCe=function(t,e){var r=0,n=3,a=[],s=[];return xh(e).forEach(function(o,l){var c=!0;if(l===0){var d=!1;c=o.reduce(function(f,A){if(d)if(Ns(A))switch(A.value){case"center":return s.push(z6),f;case"top":case"left":return s.push(Ql),f;case"right":case"bottom":return s.push(X0),f}else(yo(A)||Im(A))&&s.push(A);else if(Ns(A))switch(A.value){case kte:return r=0,!1;case Fte:return r=1,!1;case"at":return d=!0,!1;case Ite:return n=0,!1;case Ote:case Pte:return n=1,!1;case Dte:case Tte:return n=2,!1;case Bte:return n=3,!1}else if(Im(A)||yo(A))return Array.isArray(n)||(n=[]),n.push(A),!1;return f},c)}if(c){var u=sP(t,o);a.push(u)}}),{size:n,shape:r,stops:a,position:s,type:2}},SC=function(t,e){var r=0,n=3,a=[],s=[];return xh(e).forEach(function(o,l){var c=!0;if(l===0?c=o.reduce(function(u,f){if(Ns(f))switch(f.value){case"center":return s.push(z6),!1;case"top":case"left":return s.push(Ql),!1;case"right":case"bottom":return s.push(X0),!1}else if(yo(f)||Im(f))return s.push(f),!1;return u},c):l===1&&(c=o.reduce(function(u,f){if(Ns(f))switch(f.value){case kte:return r=0,!1;case Fte:return r=1,!1;case Dte:case Ite:return n=0,!1;case Pte:return n=1,!1;case Tte:return n=2,!1;case Ote:case Bte:return n=3,!1}else if(Im(f)||yo(f))return Array.isArray(n)||(n=[]),n.push(f),!1;return u},c)),c){var d=sP(t,o);a.push(d)}}),{size:n,shape:r,stops:a,position:s,type:2}},gCe=function(t){return t.type===1},xCe=function(t){return t.type===2},W6={name:"image",parse:function(t,e){if(e.type===22){var r={url:e.value,type:0};return t.cache.addImage(e.value),r}if(e.type===18){var n=Rte[e.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return n(t,e.values)}throw new Error("Unsupported image type "+e.type)}};function vCe(t){return!(t.type===20&&t.value==="none")&&(t.type!==18||!!Rte[t.name])}var Rte={"linear-gradient":ACe,"-moz-linear-gradient":EC,"-ms-linear-gradient":EC,"-o-linear-gradient":EC,"-webkit-linear-gradient":EC,"radial-gradient":pCe,"-moz-radial-gradient":SC,"-ms-radial-gradient":SC,"-o-radial-gradient":SC,"-webkit-radial-gradient":SC,"-webkit-gradient":mCe},yCe={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e.filter(function(n){return Hv(n)&&vCe(n)}).map(function(n){return W6.parse(t,n)})}},bCe={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if(Ns(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},wCe={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(t,e){return xh(e).map(function(r){return r.filter(yo)}).map(wte)}},NCe={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(t,e){return xh(e).map(function(r){return r.filter(Ns).map(function(n){return n.value}).join(" ")}).map(CCe)}},CCe=function(t){switch(t){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},gv;(function(t){t.AUTO="auto",t.CONTAIN="contain",t.COVER="cover"})(gv||(gv={}));var _Ce={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(t,e){return xh(e).map(function(r){return r.filter(ECe)})}},ECe=function(t){return Ns(t)||yo(t)},iP=function(t){return{name:"border-"+t+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},SCe=iP("top"),jCe=iP("right"),ICe=iP("bottom"),PCe=iP("left"),oP=function(t){return{name:"border-radius-"+t,initialValue:"0 0",prefix:!1,type:1,parse:function(e,r){return wte(r.filter(yo))}}},TCe=oP("top-left"),BCe=oP("top-right"),kCe=oP("bottom-right"),FCe=oP("bottom-left"),lP=function(t){return{name:"border-"+t+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(e,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},OCe=lP("top"),DCe=lP("right"),RCe=lP("bottom"),MCe=lP("left"),cP=function(t){return{name:"border-"+t+"-width",initialValue:"0",type:0,prefix:!1,parse:function(e,r){return Uw(r)?r.number:0}}},LCe=cP("top"),UCe=cP("right"),QCe=cP("bottom"),VCe=cP("left"),HCe={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},$Ce={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(t,e){switch(e){case"rtl":return 1;case"ltr":default:return 0}}},GCe={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(t,e){return e.filter(Ns).reduce(function(r,n){return r|KCe(n.value)},0)}},KCe=function(t){switch(t){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},qCe={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},zCe={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(t,e){return e.type===20&&e.value==="normal"?0:e.type===17||e.type===15?e.number:0}},TS;(function(t){t.NORMAL="normal",t.STRICT="strict"})(TS||(TS={}));var WCe={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"strict":return TS.STRICT;case"normal":default:return TS.NORMAL}}},XCe={name:"line-height",initialValue:"normal",prefix:!1,type:4},uQ=function(t,e){return Ns(t)&&t.value==="normal"?1.2*e:t.type===17?e*t.number:yo(t)?Ds(t,e):e},YCe={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(t,e){return e.type===20&&e.value==="none"?null:W6.parse(t,e)}},JCe={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(t,e){switch(e){case"inside":return 0;case"outside":default:return 1}}},Fk={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},dP=function(t){return{name:"margin-"+t,initialValue:"0",prefix:!1,type:4}},ZCe=dP("top"),e_e=dP("right"),t_e=dP("bottom"),r_e=dP("left"),n_e={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(t,e){return e.filter(Ns).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},a_e={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-word":return"break-word";case"normal":default:return"normal"}}},uP=function(t){return{name:"padding-"+t,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},s_e=uP("top"),i_e=uP("right"),o_e=uP("bottom"),l_e=uP("left"),c_e={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(t,e){switch(e){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},d_e={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(t,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},u_e={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&kk(e[0],"none")?[]:xh(e).map(function(r){for(var n={color:cA.TRANSPARENT,offsetX:Ql,offsetY:Ql,blur:Ql},a=0,s=0;s<r.length;s++){var o=r[s];Im(o)?(a===0?n.offsetX=o:a===1?n.offsetY=o:n.blur=o,a++):n.color=Am.parse(t,o)}return n})}},f_e={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},h_e={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(t,e){if(e.type===20&&e.value==="none")return null;if(e.type===18){var r=p_e[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return r(e.values)}return null}},A_e=function(t){var e=t.filter(function(r){return r.type===17}).map(function(r){return r.number});return e.length===6?e:null},m_e=function(t){var e=t.filter(function(c){return c.type===17}).map(function(c){return c.number}),r=e[0],n=e[1];e[2],e[3];var a=e[4],s=e[5];e[6],e[7],e[8],e[9],e[10],e[11];var o=e[12],l=e[13];return e[14],e[15],e.length===16?[r,n,a,s,o,l]:null},p_e={matrix:A_e,matrix3d:m_e},fQ={type:16,number:50,flags:Lw},g_e=[fQ,fQ],x_e={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(t,e){var r=e.filter(yo);return r.length!==2?g_e:[r[0],r[1]]}},v_e={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},Ib;(function(t){t.NORMAL="normal",t.BREAK_ALL="break-all",t.KEEP_ALL="keep-all"})(Ib||(Ib={}));var y_e={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-all":return Ib.BREAK_ALL;case"keep-all":return Ib.KEEP_ALL;case"normal":default:return Ib.NORMAL}}},b_e={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(t,e){if(e.type===20)return{auto:!0,order:0};if(N1(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},Mte={name:"time",parse:function(t,e){if(e.type===15)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")}},w_e={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(t,e){return N1(e)?e.number:1}},N_e={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},C_e={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(t,e){return e.filter(Ns).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},__e={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(t,e){var r=[],n=[];return e.forEach(function(a){switch(a.type){case 20:case 0:r.push(a.value);break;case 17:r.push(a.number.toString());break;case 4:n.push(r.join(" ")),r.length=0;break}}),r.length&&n.push(r.join(" ")),n.map(function(a){return a.indexOf(" ")===-1?a:"'"+a+"'"})}},E_e={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},S_e={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(t,e){if(N1(e))return e.number;if(Ns(e))switch(e.value){case"bold":return 700;case"normal":default:return 400}return 400}},j_e={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.filter(Ns).map(function(r){return r.value})}},I_e={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},Uo=function(t,e){return(t&e)!==0},P_e={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e}},T_e={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;for(var n=[],a=e.filter(bte),s=0;s<a.length;s++){var o=a[s],l=a[s+1];if(o.type===20){var c=l&&N1(l)?l.number:1;n.push({counter:o.value,increment:c})}}return n}},B_e={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return[];for(var r=[],n=e.filter(bte),a=0;a<n.length;a++){var s=n[a],o=n[a+1];if(Ns(s)&&s.value!=="none"){var l=o&&N1(o)?o.number:0;r.push({counter:s.value,reset:l})}}return r}},k_e={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(t,e){return e.filter(Uw).map(function(r){return Mte.parse(t,r)})}},F_e={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;var n=[],a=e.filter(iCe);if(a.length%2!==0)return null;for(var s=0;s<a.length;s+=2){var o=a[s].value,l=a[s+1].value;n.push({open:o,close:l})}return n}},hQ=function(t,e,r){if(!t)return"";var n=t[Math.min(e,t.length-1)];return n?r?n.open:n.close:""},O_e={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&kk(e[0],"none")?[]:xh(e).map(function(r){for(var n={color:255,offsetX:Ql,offsetY:Ql,blur:Ql,spread:Ql,inset:!1},a=0,s=0;s<r.length;s++){var o=r[s];kk(o,"inset")?n.inset=!0:Im(o)?(a===0?n.offsetX=o:a===1?n.offsetY=o:a===2?n.blur=o:n.spread=o,a++):n.color=Am.parse(t,o)}return n})}},D_e={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(t,e){var r=[0,1,2],n=[];return e.filter(Ns).forEach(function(a){switch(a.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),r.forEach(function(a){n.indexOf(a)===-1&&n.push(a)}),n}},R_e={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},M_e={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return Uw(e)?e.number:0}},L_e=function(){function t(e,r){var n,a;this.animationDuration=hn(e,k_e,r.animationDuration),this.backgroundClip=hn(e,cCe,r.backgroundClip),this.backgroundColor=hn(e,dCe,r.backgroundColor),this.backgroundImage=hn(e,yCe,r.backgroundImage),this.backgroundOrigin=hn(e,bCe,r.backgroundOrigin),this.backgroundPosition=hn(e,wCe,r.backgroundPosition),this.backgroundRepeat=hn(e,NCe,r.backgroundRepeat),this.backgroundSize=hn(e,_Ce,r.backgroundSize),this.borderTopColor=hn(e,SCe,r.borderTopColor),this.borderRightColor=hn(e,jCe,r.borderRightColor),this.borderBottomColor=hn(e,ICe,r.borderBottomColor),this.borderLeftColor=hn(e,PCe,r.borderLeftColor),this.borderTopLeftRadius=hn(e,TCe,r.borderTopLeftRadius),this.borderTopRightRadius=hn(e,BCe,r.borderTopRightRadius),this.borderBottomRightRadius=hn(e,kCe,r.borderBottomRightRadius),this.borderBottomLeftRadius=hn(e,FCe,r.borderBottomLeftRadius),this.borderTopStyle=hn(e,OCe,r.borderTopStyle),this.borderRightStyle=hn(e,DCe,r.borderRightStyle),this.borderBottomStyle=hn(e,RCe,r.borderBottomStyle),this.borderLeftStyle=hn(e,MCe,r.borderLeftStyle),this.borderTopWidth=hn(e,LCe,r.borderTopWidth),this.borderRightWidth=hn(e,UCe,r.borderRightWidth),this.borderBottomWidth=hn(e,QCe,r.borderBottomWidth),this.borderLeftWidth=hn(e,VCe,r.borderLeftWidth),this.boxShadow=hn(e,O_e,r.boxShadow),this.color=hn(e,HCe,r.color),this.direction=hn(e,$Ce,r.direction),this.display=hn(e,GCe,r.display),this.float=hn(e,qCe,r.cssFloat),this.fontFamily=hn(e,__e,r.fontFamily),this.fontSize=hn(e,E_e,r.fontSize),this.fontStyle=hn(e,I_e,r.fontStyle),this.fontVariant=hn(e,j_e,r.fontVariant),this.fontWeight=hn(e,S_e,r.fontWeight),this.letterSpacing=hn(e,zCe,r.letterSpacing),this.lineBreak=hn(e,WCe,r.lineBreak),this.lineHeight=hn(e,XCe,r.lineHeight),this.listStyleImage=hn(e,YCe,r.listStyleImage),this.listStylePosition=hn(e,JCe,r.listStylePosition),this.listStyleType=hn(e,Fk,r.listStyleType),this.marginTop=hn(e,ZCe,r.marginTop),this.marginRight=hn(e,e_e,r.marginRight),this.marginBottom=hn(e,t_e,r.marginBottom),this.marginLeft=hn(e,r_e,r.marginLeft),this.opacity=hn(e,w_e,r.opacity);var s=hn(e,n_e,r.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=hn(e,a_e,r.overflowWrap),this.paddingTop=hn(e,s_e,r.paddingTop),this.paddingRight=hn(e,i_e,r.paddingRight),this.paddingBottom=hn(e,o_e,r.paddingBottom),this.paddingLeft=hn(e,l_e,r.paddingLeft),this.paintOrder=hn(e,D_e,r.paintOrder),this.position=hn(e,d_e,r.position),this.textAlign=hn(e,c_e,r.textAlign),this.textDecorationColor=hn(e,N_e,(n=r.textDecorationColor)!==null&&n!==void 0?n:r.color),this.textDecorationLine=hn(e,C_e,(a=r.textDecorationLine)!==null&&a!==void 0?a:r.textDecoration),this.textShadow=hn(e,u_e,r.textShadow),this.textTransform=hn(e,f_e,r.textTransform),this.transform=hn(e,h_e,r.transform),this.transformOrigin=hn(e,x_e,r.transformOrigin),this.visibility=hn(e,v_e,r.visibility),this.webkitTextStrokeColor=hn(e,R_e,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=hn(e,M_e,r.webkitTextStrokeWidth),this.wordBreak=hn(e,y_e,r.wordBreak),this.zIndex=hn(e,b_e,r.zIndex)}return t.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},t.prototype.isTransparent=function(){return mm(this.backgroundColor)},t.prototype.isTransformed=function(){return this.transform!==null},t.prototype.isPositioned=function(){return this.position!==0},t.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},t.prototype.isFloating=function(){return this.float!==0},t.prototype.isInlineLevel=function(){return Uo(this.display,4)||Uo(this.display,33554432)||Uo(this.display,268435456)||Uo(this.display,536870912)||Uo(this.display,67108864)||Uo(this.display,134217728)},t}(),U_e=function(){function t(e,r){this.content=hn(e,P_e,r.content),this.quotes=hn(e,F_e,r.quotes)}return t}(),AQ=function(){function t(e,r){this.counterIncrement=hn(e,T_e,r.counterIncrement),this.counterReset=hn(e,B_e,r.counterReset)}return t}(),hn=function(t,e,r){var n=new vte,a=r!==null&&typeof r<"u"?r.toString():e.initialValue;n.write(a);var s=new yte(n.read());switch(e.type){case 2:var o=s.parseComponentValue();return e.parse(t,Ns(o)?o.value:e.initialValue);case 0:return e.parse(t,s.parseComponentValue());case 1:return e.parse(t,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(e.format){case"angle":return aP.parse(t,s.parseComponentValue());case"color":return Am.parse(t,s.parseComponentValue());case"image":return W6.parse(t,s.parseComponentValue());case"length":var l=s.parseComponentValue();return Im(l)?l:Ql;case"length-percentage":var c=s.parseComponentValue();return yo(c)?c:Ql;case"time":return Mte.parse(t,s.parseComponentValue())}break}},Q_e="data-html2canvas-debug",V_e=function(t){var e=t.getAttribute(Q_e);switch(e){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Ok=function(t,e){var r=V_e(t);return r===1||e===r},vh=function(){function t(e,r){if(this.context=e,this.textNodes=[],this.elements=[],this.flags=0,Ok(r,3))debugger;this.styles=new L_e(e,window.getComputedStyle(r,null)),Mk(r)&&(this.styles.animationDuration.some(function(n){return n>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=rP(this.context,r),Ok(r,4)&&(this.flags|=16)}return t}(),H_e="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",mQ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",eb=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var jC=0;jC<mQ.length;jC++)eb[mQ.charCodeAt(jC)]=jC;var $_e=function(t){var e=t.length*.75,r=t.length,n,a=0,s,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var d=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),u=Array.isArray(d)?d:new Uint8Array(d);for(n=0;n<r;n+=4)s=eb[t.charCodeAt(n)],o=eb[t.charCodeAt(n+1)],l=eb[t.charCodeAt(n+2)],c=eb[t.charCodeAt(n+3)],u[a++]=s<<2|o>>4,u[a++]=(o&15)<<4|l>>2,u[a++]=(l&3)<<6|c&63;return d},G_e=function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r.push(t[n+1]<<8|t[n]);return r},K_e=function(t){for(var e=t.length,r=[],n=0;n<e;n+=4)r.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return r},Qp=5,X6=11,K4=2,q_e=X6-Qp,Lte=65536>>Qp,z_e=1<<Qp,q4=z_e-1,W_e=1024>>Qp,X_e=Lte+W_e,Y_e=X_e,J_e=32,Z_e=Y_e+J_e,eEe=65536>>X6,tEe=1<<q_e,rEe=tEe-1,pQ=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},nEe=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},aEe=function(t,e){var r=$_e(t),n=Array.isArray(r)?K_e(r):new Uint32Array(r),a=Array.isArray(r)?G_e(r):new Uint16Array(r),s=24,o=pQ(a,s/2,n[4]/2),l=n[5]===2?pQ(a,(s+n[4])/2):nEe(n,Math.ceil((s+n[4])/4));return new sEe(n[0],n[1],n[2],n[3],o,l)},sEe=function(){function t(e,r,n,a,s,o){this.initialValue=e,this.errorValue=r,this.highStart=n,this.highValueIndex=a,this.index=s,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>Qp],r=(r<<K4)+(e&q4),this.data[r];if(e<=65535)return r=this.index[Lte+(e-55296>>Qp)],r=(r<<K4)+(e&q4),this.data[r];if(e<this.highStart)return r=Z_e-eEe+(e>>X6),r=this.index[r],r+=e>>Qp&rEe,r=this.index[r],r=(r<<K4)+(e&q4),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),gQ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",iEe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var IC=0;IC<gQ.length;IC++)iEe[gQ.charCodeAt(IC)]=IC;var oEe=1,z4=2,W4=3,xQ=4,vQ=5,lEe=7,yQ=8,X4=9,Y4=10,bQ=11,wQ=12,NQ=13,CQ=14,J4=15,cEe=function(t){for(var e=[],r=0,n=t.length;r<n;){var a=t.charCodeAt(r++);if(a>=55296&&a<=56319&&r<n){var s=t.charCodeAt(r++);(s&64512)===56320?e.push(((a&1023)<<10)+(s&1023)+65536):(e.push(a),r--)}else e.push(a)}return e},dEe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var n=[],a=-1,s="";++a<r;){var o=t[a];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(a+1===r||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},uEe=aEe(H_e),yu="",Z4="",fEe=function(t){return uEe.get(t)},hEe=function(t,e,r){var n=r-2,a=e[n],s=e[r-1],o=e[r];if(s===z4&&o===W4)return yu;if(s===z4||s===W4||s===xQ||o===z4||o===W4||o===xQ)return Z4;if(s===yQ&&[yQ,X4,bQ,wQ].indexOf(o)!==-1||(s===bQ||s===X4)&&(o===X4||o===Y4)||(s===wQ||s===Y4)&&o===Y4||o===NQ||o===vQ||o===lEe||s===oEe)return yu;if(s===NQ&&o===CQ){for(;a===vQ;)a=e[--n];if(a===CQ)return yu}if(s===J4&&o===J4){for(var l=0;a===J4;)l++,a=e[--n];if(l%2===0)return yu}return Z4},AEe=function(t){var e=cEe(t),r=e.length,n=0,a=0,s=e.map(fEe);return{next:function(){if(n>=r)return{done:!0,value:null};for(var o=yu;n<r&&(o=hEe(e,s,++n))===yu;);if(o!==yu||n===r){var l=dEe.apply(null,e.slice(a,n));return a=n,{value:l,done:!1}}return{done:!0,value:null}}}},mEe=function(t){for(var e=AEe(t),r=[],n;!(n=e.next()).done;)n.value&&r.push(n.value.slice());return r},pEe=function(t){var e=123;if(t.createRange){var r=t.createRange();if(r.getBoundingClientRect){var n=t.createElement("boundtest");n.style.height=e+"px",n.style.display="block",t.body.appendChild(n),r.selectNode(n);var a=r.getBoundingClientRect(),s=Math.round(a.height);if(t.body.removeChild(n),s===e)return!0}}return!1},gEe=function(t){var e=t.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",t.body.appendChild(e);var r=t.createRange();e.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=e.firstChild,a=nP(n.data).map(function(c){return ro(c)}),s=0,o={},l=a.every(function(c,d){r.setStart(n,s),r.setEnd(n,s+c.length);var u=r.getBoundingClientRect();s+=c.length;var f=u.x>o.x||u.y>o.y;return o=u,d===0?!0:f});return t.body.removeChild(e),l},xEe=function(){return typeof new Image().crossOrigin<"u"},vEe=function(){return typeof new XMLHttpRequest().responseType=="string"},yEe=function(t){var e=new Image,r=t.createElement("canvas"),n=r.getContext("2d");if(!n)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(e,0,0),r.toDataURL()}catch{return!1}return!0},_Q=function(t){return t[0]===0&&t[1]===255&&t[2]===0&&t[3]===255},bEe=function(t){var e=t.createElement("canvas"),r=100;e.width=r,e.height=r;var n=e.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,r,r);var a=new Image,s=e.toDataURL();a.src=s;var o=Dk(r,r,0,0,a);return n.fillStyle="red",n.fillRect(0,0,r,r),EQ(o).then(function(l){n.drawImage(l,0,0);var c=n.getImageData(0,0,r,r).data;n.fillStyle="red",n.fillRect(0,0,r,r);var d=t.createElement("div");return d.style.backgroundImage="url("+s+")",d.style.height=r+"px",_Q(c)?EQ(Dk(r,r,0,0,d)):Promise.reject(!1)}).then(function(l){return n.drawImage(l,0,0),_Q(n.getImageData(0,0,r,r).data)}).catch(function(){return!1})},Dk=function(t,e,r,n,a){var s="http://www.w3.org/2000/svg",o=document.createElementNS(s,"svg"),l=document.createElementNS(s,"foreignObject");return o.setAttributeNS(null,"width",t.toString()),o.setAttributeNS(null,"height",e.toString()),l.setAttributeNS(null,"width","100%"),l.setAttributeNS(null,"height","100%"),l.setAttributeNS(null,"x",r.toString()),l.setAttributeNS(null,"y",n.toString()),l.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(l),l.appendChild(a),o},EQ=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){return e(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},Ol={get SUPPORT_RANGE_BOUNDS(){var t=pEe(document);return Object.defineProperty(Ol,"SUPPORT_RANGE_BOUNDS",{value:t}),t},get SUPPORT_WORD_BREAKING(){var t=Ol.SUPPORT_RANGE_BOUNDS&&gEe(document);return Object.defineProperty(Ol,"SUPPORT_WORD_BREAKING",{value:t}),t},get SUPPORT_SVG_DRAWING(){var t=yEe(document);return Object.defineProperty(Ol,"SUPPORT_SVG_DRAWING",{value:t}),t},get SUPPORT_FOREIGNOBJECT_DRAWING(){var t=typeof Array.from=="function"&&typeof window.fetch=="function"?bEe(document):Promise.resolve(!1);return Object.defineProperty(Ol,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:t}),t},get SUPPORT_CORS_IMAGES(){var t=xEe();return Object.defineProperty(Ol,"SUPPORT_CORS_IMAGES",{value:t}),t},get SUPPORT_RESPONSE_TYPE(){var t=vEe();return Object.defineProperty(Ol,"SUPPORT_RESPONSE_TYPE",{value:t}),t},get SUPPORT_CORS_XHR(){var t="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Ol,"SUPPORT_CORS_XHR",{value:t}),t},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var t=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Ol,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:t}),t}},Pb=function(){function t(e,r){this.text=e,this.bounds=r}return t}(),wEe=function(t,e,r,n){var a=_Ee(e,r),s=[],o=0;return a.forEach(function(l){if(r.textDecorationLine.length||l.trim().length>0)if(Ol.SUPPORT_RANGE_BOUNDS){var c=SQ(n,o,l.length).getClientRects();if(c.length>1){var d=Y6(l),u=0;d.forEach(function(A){s.push(new Pb(A,NA.fromDOMRectList(t,SQ(n,u+o,A.length).getClientRects()))),u+=A.length})}else s.push(new Pb(l,NA.fromDOMRectList(t,c)))}else{var f=n.splitText(l.length);s.push(new Pb(l,NEe(t,n))),n=f}else Ol.SUPPORT_RANGE_BOUNDS||(n=n.splitText(l.length));o+=l.length}),s},NEe=function(t,e){var r=e.ownerDocument;if(r){var n=r.createElement("html2canvaswrapper");n.appendChild(e.cloneNode(!0));var a=e.parentNode;if(a){a.replaceChild(n,e);var s=rP(t,n);return n.firstChild&&a.replaceChild(n.firstChild,n),s}}return NA.EMPTY},SQ=function(t,e,r){var n=t.ownerDocument;if(!n)throw new Error("Node has no owner document");var a=n.createRange();return a.setStart(t,e),a.setEnd(t,e+r),a},Y6=function(t){if(Ol.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(t)).map(function(r){return r.segment})}return mEe(t)},CEe=function(t,e){if(Ol.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(t)).map(function(n){return n.segment})}return SEe(t,e)},_Ee=function(t,e){return e.letterSpacing!==0?Y6(t):CEe(t,e)},EEe=[32,160,4961,65792,65793,4153,4241],SEe=function(t,e){for(var r=eNe(t,{lineBreak:e.lineBreak,wordBreak:e.overflowWrap==="break-word"?"break-word":e.wordBreak}),n=[],a,s=function(){if(a.value){var o=a.value.slice(),l=nP(o),c="";l.forEach(function(d){EEe.indexOf(d)===-1?c+=ro(d):(c.length&&n.push(c),n.push(ro(d)),c="")}),c.length&&n.push(c)}};!(a=r.next()).done;)s();return n},jEe=function(){function t(e,r,n){this.text=IEe(r.data,n.textTransform),this.textBounds=wEe(e,this.text,n,r)}return t}(),IEe=function(t,e){switch(e){case 1:return t.toLowerCase();case 3:return t.replace(PEe,TEe);case 2:return t.toUpperCase();default:return t}},PEe=/(^|\s|:|-|\(|\))([a-z])/g,TEe=function(t,e,r){return t.length>0?e+r.toUpperCase():t},Ute=function(t){kf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.src=n.currentSrc||n.src,a.intrinsicWidth=n.naturalWidth,a.intrinsicHeight=n.naturalHeight,a.context.cache.addImage(a.src),a}return e}(vh),Qte=function(t){kf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.canvas=n,a.intrinsicWidth=n.width,a.intrinsicHeight=n.height,a}return e}(vh),Vte=function(t){kf(e,t);function e(r,n){var a=t.call(this,r,n)||this,s=new XMLSerializer,o=rP(r,n);return n.setAttribute("width",o.width+"px"),n.setAttribute("height",o.height+"px"),a.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(n)),a.intrinsicWidth=n.width.baseVal.value,a.intrinsicHeight=n.height.baseVal.value,a.context.cache.addImage(a.svg),a}return e}(vh),Hte=function(t){kf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.value=n.value,a}return e}(vh),Rk=function(t){kf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.start=n.start,a.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,a}return e}(vh),BEe=[{type:15,flags:0,unit:"px",number:3}],kEe=[{type:16,flags:0,number:50}],FEe=function(t){return t.width>t.height?new NA(t.left+(t.width-t.height)/2,t.top,t.height,t.height):t.width<t.height?new NA(t.left,t.top+(t.height-t.width)/2,t.width,t.width):t},OEe=function(t){var e=t.type===DEe?new Array(t.value.length+1).join(""):t.value;return e.length===0?t.placeholder||"":e},BS="checkbox",kS="radio",DEe="password",jQ=707406591,J6=function(t){kf(e,t);function e(r,n){var a=t.call(this,r,n)||this;switch(a.type=n.type.toLowerCase(),a.checked=n.checked,a.value=OEe(n),(a.type===BS||a.type===kS)&&(a.styles.backgroundColor=3739148031,a.styles.borderTopColor=a.styles.borderRightColor=a.styles.borderBottomColor=a.styles.borderLeftColor=2779096575,a.styles.borderTopWidth=a.styles.borderRightWidth=a.styles.borderBottomWidth=a.styles.borderLeftWidth=1,a.styles.borderTopStyle=a.styles.borderRightStyle=a.styles.borderBottomStyle=a.styles.borderLeftStyle=1,a.styles.backgroundClip=[0],a.styles.backgroundOrigin=[0],a.bounds=FEe(a.bounds)),a.type){case BS:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=BEe;break;case kS:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=kEe;break}return a}return e}(vh),$te=function(t){kf(e,t);function e(r,n){var a=t.call(this,r,n)||this,s=n.options[n.selectedIndex||0];return a.value=s&&s.text||"",a}return e}(vh),Gte=function(t){kf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.value=n.value,a}return e}(vh),Kte=function(t){kf(e,t);function e(r,n){var a=t.call(this,r,n)||this;a.src=n.src,a.width=parseInt(n.width,10)||0,a.height=parseInt(n.height,10)||0,a.backgroundColor=a.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){a.tree=zte(r,n.contentWindow.document.documentElement);var s=n.contentWindow.document.documentElement?jb(r,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):cA.TRANSPARENT,o=n.contentWindow.document.body?jb(r,getComputedStyle(n.contentWindow.document.body).backgroundColor):cA.TRANSPARENT;a.backgroundColor=mm(s)?mm(o)?a.styles.backgroundColor:o:s}}catch{}return a}return e}(vh),REe=["OL","UL","MENU"],yE=function(t,e,r,n){for(var a=e.firstChild,s=void 0;a;a=s)if(s=a.nextSibling,Wte(a)&&a.data.trim().length>0)r.textNodes.push(new jEe(t,a,r.styles));else if(Jx(a))if(Zte(a)&&a.assignedNodes)a.assignedNodes().forEach(function(l){return yE(t,l,r,n)});else{var o=qte(t,a);o.styles.isVisible()&&(MEe(a,o,n)?o.flags|=4:LEe(o.styles)&&(o.flags|=2),REe.indexOf(a.tagName)!==-1&&(o.flags|=8),r.elements.push(o),a.slot,a.shadowRoot?yE(t,a.shadowRoot,o,n):!FS(a)&&!Xte(a)&&!OS(a)&&yE(t,a,o,n))}},qte=function(t,e){return Lk(e)?new Ute(t,e):Yte(e)?new Qte(t,e):Xte(e)?new Vte(t,e):UEe(e)?new Hte(t,e):QEe(e)?new Rk(t,e):VEe(e)?new J6(t,e):OS(e)?new $te(t,e):FS(e)?new Gte(t,e):Jte(e)?new Kte(t,e):new vh(t,e)},zte=function(t,e){var r=qte(t,e);return r.flags|=4,yE(t,e,r,r),r},MEe=function(t,e,r){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||Z6(t)&&r.styles.isTransparent()},LEe=function(t){return t.isPositioned()||t.isFloating()},Wte=function(t){return t.nodeType===Node.TEXT_NODE},Jx=function(t){return t.nodeType===Node.ELEMENT_NODE},Mk=function(t){return Jx(t)&&typeof t.style<"u"&&!bE(t)},bE=function(t){return typeof t.className=="object"},UEe=function(t){return t.tagName==="LI"},QEe=function(t){return t.tagName==="OL"},VEe=function(t){return t.tagName==="INPUT"},HEe=function(t){return t.tagName==="HTML"},Xte=function(t){return t.tagName==="svg"},Z6=function(t){return t.tagName==="BODY"},Yte=function(t){return t.tagName==="CANVAS"},IQ=function(t){return t.tagName==="VIDEO"},Lk=function(t){return t.tagName==="IMG"},Jte=function(t){return t.tagName==="IFRAME"},PQ=function(t){return t.tagName==="STYLE"},$Ee=function(t){return t.tagName==="SCRIPT"},FS=function(t){return t.tagName==="TEXTAREA"},OS=function(t){return t.tagName==="SELECT"},Zte=function(t){return t.tagName==="SLOT"},TQ=function(t){return t.tagName.indexOf("-")>0},GEe=function(){function t(){this.counters={}}return t.prototype.getCounterValue=function(e){var r=this.counters[e];return r&&r.length?r[r.length-1]:1},t.prototype.getCounterValues=function(e){var r=this.counters[e];return r||[]},t.prototype.pop=function(e){var r=this;e.forEach(function(n){return r.counters[n].pop()})},t.prototype.parse=function(e){var r=this,n=e.counterIncrement,a=e.counterReset,s=!0;n!==null&&n.forEach(function(l){var c=r.counters[l.counter];c&&l.increment!==0&&(s=!1,c.length||c.push(1),c[Math.max(0,c.length-1)]+=l.increment)});var o=[];return s&&a.forEach(function(l){var c=r.counters[l.counter];o.push(l.counter),c||(c=r.counters[l.counter]=[]),c.push(l.reset)}),o},t}(),BQ={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},kQ={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},KEe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},qEe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},ux=function(t,e,r,n,a,s){return t<e||t>r?B2(t,a,s.length>0):n.integers.reduce(function(o,l,c){for(;t>=l;)t-=l,o+=n.values[c];return o},"")+s},ere=function(t,e,r,n){var a="";do r||t--,a=n(t)+a,t/=e;while(t*e>=e);return a},Xi=function(t,e,r,n,a){var s=r-e+1;return(t<0?"-":"")+(ere(Math.abs(t),s,n,function(o){return ro(Math.floor(o%s)+e)})+a)},tp=function(t,e,r){r===void 0&&(r=". ");var n=e.length;return ere(Math.abs(t),n,!1,function(a){return e[Math.floor(a%n)]})+r},kx=1,S0=2,j0=4,tb=8,Ph=function(t,e,r,n,a,s){if(t<-9999||t>9999)return B2(t,4,a.length>0);var o=Math.abs(t),l=a;if(o===0)return e[0]+l;for(var c=0;o>0&&c<=4;c++){var d=o%10;d===0&&Uo(s,kx)&&l!==""?l=e[d]+l:d>1||d===1&&c===0||d===1&&c===1&&Uo(s,S0)||d===1&&c===1&&Uo(s,j0)&&t>100||d===1&&c>1&&Uo(s,tb)?l=e[d]+(c>0?r[c-1]:"")+l:d===1&&c>0&&(l=r[c-1]+l),o=Math.floor(o/10)}return(t<0?n:"")+l},FQ="",OQ="",DQ="",e5="",B2=function(t,e,r){var n=r?". ":"",a=r?"":"",s=r?", ":"",o=r?" ":"";switch(e){case 0:return""+o;case 1:return""+o;case 2:return""+o;case 5:var l=Xi(t,48,57,!0,n);return l.length<4?"0"+l:l;case 4:return tp(t,"",a);case 6:return ux(t,1,3999,BQ,3,n).toLowerCase();case 7:return ux(t,1,3999,BQ,3,n);case 8:return Xi(t,945,969,!1,n);case 9:return Xi(t,97,122,!1,n);case 10:return Xi(t,65,90,!1,n);case 11:return Xi(t,1632,1641,!0,n);case 12:case 49:return ux(t,1,9999,kQ,3,n);case 35:return ux(t,1,9999,kQ,3,n).toLowerCase();case 13:return Xi(t,2534,2543,!0,n);case 14:case 30:return Xi(t,6112,6121,!0,n);case 15:return tp(t,"",a);case 16:return tp(t,"",a);case 17:case 48:return Ph(t,"",FQ,"",a,S0|j0|tb);case 47:return Ph(t,"",OQ,"",a,kx|S0|j0|tb);case 42:return Ph(t,"",FQ,"",a,S0|j0|tb);case 41:return Ph(t,"",OQ,"",a,kx|S0|j0|tb);case 26:return Ph(t,"","",DQ,a,0);case 25:return Ph(t,"","",DQ,a,kx|S0|j0);case 31:return Ph(t,"","",e5,s,kx|S0|j0);case 33:return Ph(t,"","",e5,s,0);case 32:return Ph(t,"","",e5,s,kx|S0|j0);case 18:return Xi(t,2406,2415,!0,n);case 20:return ux(t,1,19999,qEe,3,n);case 21:return Xi(t,2790,2799,!0,n);case 22:return Xi(t,2662,2671,!0,n);case 22:return ux(t,1,10999,KEe,3,n);case 23:return tp(t,"");case 24:return tp(t,"");case 27:return Xi(t,3302,3311,!0,n);case 28:return tp(t,"",a);case 29:return tp(t,"",a);case 34:return Xi(t,3792,3801,!0,n);case 37:return Xi(t,6160,6169,!0,n);case 38:return Xi(t,4160,4169,!0,n);case 39:return Xi(t,2918,2927,!0,n);case 40:return Xi(t,1776,1785,!0,n);case 43:return Xi(t,3046,3055,!0,n);case 44:return Xi(t,3174,3183,!0,n);case 45:return Xi(t,3664,3673,!0,n);case 46:return Xi(t,3872,3881,!0,n);case 3:default:return Xi(t,48,57,!0,n)}},tre="data-html2canvas-ignore",RQ=function(){function t(e,r,n){if(this.context=e,this.options=n,this.scrolledElements=[],this.referenceElement=r,this.counters=new GEe,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return t.prototype.toIFrame=function(e,r){var n=this,a=zEe(e,r);if(!a.contentWindow)return Promise.reject("Unable to find iframe window");var s=e.defaultView.pageXOffset,o=e.defaultView.pageYOffset,l=a.contentWindow,c=l.document,d=YEe(a).then(function(){return Bc(n,void 0,void 0,function(){var u,f;return oc(this,function(A){switch(A.label){case 0:return this.scrolledElements.forEach(tSe),l&&(l.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(l.scrollY!==r.top||l.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(l.scrollX-r.left,l.scrollY-r.top,0,0))),u=this.options.onclone,f=this.clonedReferenceElement,typeof f>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:c.fonts&&c.fonts.ready?[4,c.fonts.ready]:[3,2];case 1:A.sent(),A.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,XEe(c)]:[3,4];case 3:A.sent(),A.label=4;case 4:return typeof u=="function"?[2,Promise.resolve().then(function(){return u(c,f)}).then(function(){return a})]:[2,a]}})})});return c.open(),c.write(ZEe(document.doctype)+"<html></html>"),eSe(this.referenceElement.ownerDocument,s,o),c.replaceChild(c.adoptNode(this.documentElement),c.documentElement),c.close(),d},t.prototype.createElementClone=function(e){if(Ok(e,2))debugger;if(Yte(e))return this.createCanvasClone(e);if(IQ(e))return this.createVideoClone(e);if(PQ(e))return this.createStyleClone(e);var r=e.cloneNode(!1);return Lk(r)&&(Lk(e)&&e.currentSrc&&e.currentSrc!==e.src&&(r.src=e.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),TQ(r)?this.createCustomElementClone(r):r},t.prototype.createCustomElementClone=function(e){var r=document.createElement("html2canvascustomelement");return t5(e.style,r),r},t.prototype.createStyleClone=function(e){try{var r=e.sheet;if(r&&r.cssRules){var n=[].slice.call(r.cssRules,0).reduce(function(s,o){return o&&typeof o.cssText=="string"?s+o.cssText:s},""),a=e.cloneNode(!1);return a.textContent=n,a}}catch(s){if(this.context.logger.error("Unable to access cssRules property",s),s.name!=="SecurityError")throw s}return e.cloneNode(!1)},t.prototype.createCanvasClone=function(e){var r;if(this.options.inlineImages&&e.ownerDocument){var n=e.ownerDocument.createElement("img");try{return n.src=e.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var a=e.cloneNode(!1);try{a.width=e.width,a.height=e.height;var s=e.getContext("2d"),o=a.getContext("2d");if(o)if(!this.options.allowTaint&&s)o.putImageData(s.getImageData(0,0,e.width,e.height),0,0);else{var l=(r=e.getContext("webgl2"))!==null&&r!==void 0?r:e.getContext("webgl");if(l){var c=l.getContextAttributes();(c==null?void 0:c.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}o.drawImage(e,0,0)}return a}catch{this.context.logger.info("Unable to clone canvas as it is tainted",e)}return a},t.prototype.createVideoClone=function(e){var r=e.ownerDocument.createElement("canvas");r.width=e.offsetWidth,r.height=e.offsetHeight;var n=r.getContext("2d");try{return n&&(n.drawImage(e,0,0,r.width,r.height),this.options.allowTaint||n.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",e)}var a=e.ownerDocument.createElement("canvas");return a.width=e.offsetWidth,a.height=e.offsetHeight,a},t.prototype.appendChildNode=function(e,r,n){(!Jx(r)||!$Ee(r)&&!r.hasAttribute(tre)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!Jx(r)||!PQ(r))&&e.appendChild(this.cloneNode(r,n))},t.prototype.cloneChildNodes=function(e,r,n){for(var a=this,s=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;s;s=s.nextSibling)if(Jx(s)&&Zte(s)&&typeof s.assignedNodes=="function"){var o=s.assignedNodes();o.length&&o.forEach(function(l){return a.appendChildNode(r,l,n)})}else this.appendChildNode(r,s,n)},t.prototype.cloneNode=function(e,r){if(Wte(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var n=e.ownerDocument.defaultView;if(n&&Jx(e)&&(Mk(e)||bE(e))){var a=this.createElementClone(e);a.style.transitionProperty="none";var s=n.getComputedStyle(e),o=n.getComputedStyle(e,":before"),l=n.getComputedStyle(e,":after");this.referenceElement===e&&Mk(a)&&(this.clonedReferenceElement=a),Z6(a)&&aSe(a);var c=this.counters.parse(new AQ(this.context,s)),d=this.resolvePseudoContent(e,a,o,Tb.BEFORE);TQ(e)&&(r=!0),IQ(e)||this.cloneChildNodes(e,a,r),d&&a.insertBefore(d,a.firstChild);var u=this.resolvePseudoContent(e,a,l,Tb.AFTER);return u&&a.appendChild(u),this.counters.pop(c),(s&&(this.options.copyStyles||bE(e))&&!Jte(e)||r)&&t5(s,a),(e.scrollTop!==0||e.scrollLeft!==0)&&this.scrolledElements.push([a,e.scrollLeft,e.scrollTop]),(FS(e)||OS(e))&&(FS(a)||OS(a))&&(a.value=e.value),a}return e.cloneNode(!1)},t.prototype.resolvePseudoContent=function(e,r,n,a){var s=this;if(n){var o=n.content,l=r.ownerDocument;if(!(!l||!o||o==="none"||o==="-moz-alt-content"||n.display==="none")){this.counters.parse(new AQ(this.context,n));var c=new U_e(this.context,n),d=l.createElement("html2canvaspseudoelement");t5(n,d),c.content.forEach(function(f){if(f.type===0)d.appendChild(l.createTextNode(f.value));else if(f.type===22){var A=l.createElement("img");A.src=f.value,A.style.opacity="1",d.appendChild(A)}else if(f.type===18){if(f.name==="attr"){var h=f.values.filter(Ns);h.length&&d.appendChild(l.createTextNode(e.getAttribute(h[0].value)||""))}else if(f.name==="counter"){var m=f.values.filter(Hv),p=m[0],x=m[1];if(p&&Ns(p)){var v=s.counters.getCounterValue(p.value),y=x&&Ns(x)?Fk.parse(s.context,x.value):3;d.appendChild(l.createTextNode(B2(v,y,!1)))}}else if(f.name==="counters"){var b=f.values.filter(Hv),p=b[0],w=b[1],x=b[2];if(p&&Ns(p)){var I=s.counters.getCounterValues(p.value),j=x&&Ns(x)?Fk.parse(s.context,x.value):3,N=w&&w.type===0?w.value:"",S=I.map(function(k){return B2(k,j,!1)}).join(N);d.appendChild(l.createTextNode(S))}}}else if(f.type===20)switch(f.value){case"open-quote":d.appendChild(l.createTextNode(hQ(c.quotes,s.quoteDepth++,!0)));break;case"close-quote":d.appendChild(l.createTextNode(hQ(c.quotes,--s.quoteDepth,!1)));break;default:d.appendChild(l.createTextNode(f.value))}}),d.className=Uk+" "+Qk;var u=a===Tb.BEFORE?" "+Uk:" "+Qk;return bE(r)?r.className.baseValue+=u:r.className+=u,d}}},t.destroy=function(e){return e.parentNode?(e.parentNode.removeChild(e),!0):!1},t}(),Tb;(function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER"})(Tb||(Tb={}));var zEe=function(t,e){var r=t.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=e.width.toString(),r.height=e.height.toString(),r.scrolling="no",r.setAttribute(tre,"true"),t.body.appendChild(r),r},WEe=function(t){return new Promise(function(e){if(t.complete){e();return}if(!t.src){e();return}t.onload=e,t.onerror=e})},XEe=function(t){return Promise.all([].slice.call(t.images,0).map(WEe))},YEe=function(t){return new Promise(function(e,r){var n=t.contentWindow;if(!n)return r("No window assigned for iframe");var a=n.document;n.onload=t.onload=function(){n.onload=t.onload=null;var s=setInterval(function(){a.body.childNodes.length>0&&a.readyState==="complete"&&(clearInterval(s),e(t))},50)}})},JEe=["all","d","content"],t5=function(t,e){for(var r=t.length-1;r>=0;r--){var n=t.item(r);JEe.indexOf(n)===-1&&e.style.setProperty(n,t.getPropertyValue(n))}return e},ZEe=function(t){var e="";return t&&(e+="<!DOCTYPE ",t.name&&(e+=t.name),t.internalSubset&&(e+=t.internalSubset),t.publicId&&(e+='"'+t.publicId+'"'),t.systemId&&(e+='"'+t.systemId+'"'),e+=">"),e},eSe=function(t,e,r){t&&t.defaultView&&(e!==t.defaultView.pageXOffset||r!==t.defaultView.pageYOffset)&&t.defaultView.scrollTo(e,r)},tSe=function(t){var e=t[0],r=t[1],n=t[2];e.scrollLeft=r,e.scrollTop=n},rSe=":before",nSe=":after",Uk="___html2canvas___pseudoelement_before",Qk="___html2canvas___pseudoelement_after",MQ=`{
    content: "" !important;
    display: none !important;
}`,aSe=function(t){sSe(t,"."+Uk+rSe+MQ+`
         .`+Qk+nSe+MQ)},sSe=function(t,e){var r=t.ownerDocument;if(r){var n=r.createElement("style");n.textContent=e,t.appendChild(n)}},rre=function(){function t(){}return t.getOrigin=function(e){var r=t._link;return r?(r.href=e,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},t.isSameOrigin=function(e){return t.getOrigin(e)===t._origin},t.setContext=function(e){t._link=e.document.createElement("a"),t._origin=t.getOrigin(e.location.href)},t._origin="about:blank",t}(),iSe=function(){function t(e,r){this.context=e,this._options=r,this._cache={}}return t.prototype.addImage=function(e){var r=Promise.resolve();return this.has(e)||(n5(e)||dSe(e))&&(this._cache[e]=this.loadImage(e)).catch(function(){}),r},t.prototype.match=function(e){return this._cache[e]},t.prototype.loadImage=function(e){return Bc(this,void 0,void 0,function(){var r,n,a,s,o=this;return oc(this,function(l){switch(l.label){case 0:return r=rre.isSameOrigin(e),n=!r5(e)&&this._options.useCORS===!0&&Ol.SUPPORT_CORS_IMAGES&&!r,a=!r5(e)&&!r&&!n5(e)&&typeof this._options.proxy=="string"&&Ol.SUPPORT_CORS_XHR&&!n,!r&&this._options.allowTaint===!1&&!r5(e)&&!n5(e)&&!a&&!n?[2]:(s=e,a?[4,this.proxy(s)]:[3,2]);case 1:s=l.sent(),l.label=2;case 2:return this.context.logger.debug("Added image "+e.substring(0,256)),[4,new Promise(function(c,d){var u=new Image;u.onload=function(){return c(u)},u.onerror=d,(uSe(s)||n)&&(u.crossOrigin="anonymous"),u.src=s,u.complete===!0&&setTimeout(function(){return c(u)},500),o._options.imageTimeout>0&&setTimeout(function(){return d("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,l.sent()]}})})},t.prototype.has=function(e){return typeof this._cache[e]<"u"},t.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},t.prototype.proxy=function(e){var r=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var a=e.substring(0,256);return new Promise(function(s,o){var l=Ol.SUPPORT_RESPONSE_TYPE?"blob":"text",c=new XMLHttpRequest;c.onload=function(){if(c.status===200)if(l==="text")s(c.response);else{var f=new FileReader;f.addEventListener("load",function(){return s(f.result)},!1),f.addEventListener("error",function(A){return o(A)},!1),f.readAsDataURL(c.response)}else o("Failed to proxy resource "+a+" with status code "+c.status)},c.onerror=o;var d=n.indexOf("?")>-1?"&":"?";if(c.open("GET",""+n+d+"url="+encodeURIComponent(e)+"&responseType="+l),l!=="text"&&c instanceof XMLHttpRequest&&(c.responseType=l),r._options.imageTimeout){var u=r._options.imageTimeout;c.timeout=u,c.ontimeout=function(){return o("Timed out ("+u+"ms) proxying "+a)}}c.send()})},t}(),oSe=/^data:image\/svg\+xml/i,lSe=/^data:image\/.*;base64,/i,cSe=/^data:image\/.*/i,dSe=function(t){return Ol.SUPPORT_SVG_DRAWING||!fSe(t)},r5=function(t){return cSe.test(t)},uSe=function(t){return lSe.test(t)},n5=function(t){return t.substr(0,4)==="blob"},fSe=function(t){return t.substr(-3).toLowerCase()==="svg"||oSe.test(t)},un=function(){function t(e,r){this.type=0,this.x=e,this.y=r}return t.prototype.add=function(e,r){return new t(this.x+e,this.y+r)},t}(),fx=function(t,e,r){return new un(t.x+(e.x-t.x)*r,t.y+(e.y-t.y)*r)},PC=function(){function t(e,r,n,a){this.type=1,this.start=e,this.startControl=r,this.endControl=n,this.end=a}return t.prototype.subdivide=function(e,r){var n=fx(this.start,this.startControl,e),a=fx(this.startControl,this.endControl,e),s=fx(this.endControl,this.end,e),o=fx(n,a,e),l=fx(a,s,e),c=fx(o,l,e);return r?new t(this.start,n,o,c):new t(c,l,s,this.end)},t.prototype.add=function(e,r){return new t(this.start.add(e,r),this.startControl.add(e,r),this.endControl.add(e,r),this.end.add(e,r))},t.prototype.reverse=function(){return new t(this.end,this.endControl,this.startControl,this.start)},t}(),_u=function(t){return t.type===1},hSe=function(){function t(e){var r=e.styles,n=e.bounds,a=Zy(r.borderTopLeftRadius,n.width,n.height),s=a[0],o=a[1],l=Zy(r.borderTopRightRadius,n.width,n.height),c=l[0],d=l[1],u=Zy(r.borderBottomRightRadius,n.width,n.height),f=u[0],A=u[1],h=Zy(r.borderBottomLeftRadius,n.width,n.height),m=h[0],p=h[1],x=[];x.push((s+c)/n.width),x.push((m+f)/n.width),x.push((o+p)/n.height),x.push((d+A)/n.height);var v=Math.max.apply(Math,x);v>1&&(s/=v,o/=v,c/=v,d/=v,f/=v,A/=v,m/=v,p/=v);var y=n.width-c,b=n.height-A,w=n.width-f,I=n.height-p,j=r.borderTopWidth,N=r.borderRightWidth,S=r.borderBottomWidth,E=r.borderLeftWidth,B=Ds(r.paddingTop,e.bounds.width),k=Ds(r.paddingRight,e.bounds.width),T=Ds(r.paddingBottom,e.bounds.width),P=Ds(r.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||o>0?ni(n.left+E/3,n.top+j/3,s-E/3,o-j/3,ns.TOP_LEFT):new un(n.left+E/3,n.top+j/3),this.topRightBorderDoubleOuterBox=s>0||o>0?ni(n.left+y,n.top+j/3,c-N/3,d-j/3,ns.TOP_RIGHT):new un(n.left+n.width-N/3,n.top+j/3),this.bottomRightBorderDoubleOuterBox=f>0||A>0?ni(n.left+w,n.top+b,f-N/3,A-S/3,ns.BOTTOM_RIGHT):new un(n.left+n.width-N/3,n.top+n.height-S/3),this.bottomLeftBorderDoubleOuterBox=m>0||p>0?ni(n.left+E/3,n.top+I,m-E/3,p-S/3,ns.BOTTOM_LEFT):new un(n.left+E/3,n.top+n.height-S/3),this.topLeftBorderDoubleInnerBox=s>0||o>0?ni(n.left+E*2/3,n.top+j*2/3,s-E*2/3,o-j*2/3,ns.TOP_LEFT):new un(n.left+E*2/3,n.top+j*2/3),this.topRightBorderDoubleInnerBox=s>0||o>0?ni(n.left+y,n.top+j*2/3,c-N*2/3,d-j*2/3,ns.TOP_RIGHT):new un(n.left+n.width-N*2/3,n.top+j*2/3),this.bottomRightBorderDoubleInnerBox=f>0||A>0?ni(n.left+w,n.top+b,f-N*2/3,A-S*2/3,ns.BOTTOM_RIGHT):new un(n.left+n.width-N*2/3,n.top+n.height-S*2/3),this.bottomLeftBorderDoubleInnerBox=m>0||p>0?ni(n.left+E*2/3,n.top+I,m-E*2/3,p-S*2/3,ns.BOTTOM_LEFT):new un(n.left+E*2/3,n.top+n.height-S*2/3),this.topLeftBorderStroke=s>0||o>0?ni(n.left+E/2,n.top+j/2,s-E/2,o-j/2,ns.TOP_LEFT):new un(n.left+E/2,n.top+j/2),this.topRightBorderStroke=s>0||o>0?ni(n.left+y,n.top+j/2,c-N/2,d-j/2,ns.TOP_RIGHT):new un(n.left+n.width-N/2,n.top+j/2),this.bottomRightBorderStroke=f>0||A>0?ni(n.left+w,n.top+b,f-N/2,A-S/2,ns.BOTTOM_RIGHT):new un(n.left+n.width-N/2,n.top+n.height-S/2),this.bottomLeftBorderStroke=m>0||p>0?ni(n.left+E/2,n.top+I,m-E/2,p-S/2,ns.BOTTOM_LEFT):new un(n.left+E/2,n.top+n.height-S/2),this.topLeftBorderBox=s>0||o>0?ni(n.left,n.top,s,o,ns.TOP_LEFT):new un(n.left,n.top),this.topRightBorderBox=c>0||d>0?ni(n.left+y,n.top,c,d,ns.TOP_RIGHT):new un(n.left+n.width,n.top),this.bottomRightBorderBox=f>0||A>0?ni(n.left+w,n.top+b,f,A,ns.BOTTOM_RIGHT):new un(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=m>0||p>0?ni(n.left,n.top+I,m,p,ns.BOTTOM_LEFT):new un(n.left,n.top+n.height),this.topLeftPaddingBox=s>0||o>0?ni(n.left+E,n.top+j,Math.max(0,s-E),Math.max(0,o-j),ns.TOP_LEFT):new un(n.left+E,n.top+j),this.topRightPaddingBox=c>0||d>0?ni(n.left+Math.min(y,n.width-N),n.top+j,y>n.width+N?0:Math.max(0,c-N),Math.max(0,d-j),ns.TOP_RIGHT):new un(n.left+n.width-N,n.top+j),this.bottomRightPaddingBox=f>0||A>0?ni(n.left+Math.min(w,n.width-E),n.top+Math.min(b,n.height-S),Math.max(0,f-N),Math.max(0,A-S),ns.BOTTOM_RIGHT):new un(n.left+n.width-N,n.top+n.height-S),this.bottomLeftPaddingBox=m>0||p>0?ni(n.left+E,n.top+Math.min(I,n.height-S),Math.max(0,m-E),Math.max(0,p-S),ns.BOTTOM_LEFT):new un(n.left+E,n.top+n.height-S),this.topLeftContentBox=s>0||o>0?ni(n.left+E+P,n.top+j+B,Math.max(0,s-(E+P)),Math.max(0,o-(j+B)),ns.TOP_LEFT):new un(n.left+E+P,n.top+j+B),this.topRightContentBox=c>0||d>0?ni(n.left+Math.min(y,n.width+E+P),n.top+j+B,y>n.width+E+P?0:c-E+P,d-(j+B),ns.TOP_RIGHT):new un(n.left+n.width-(N+k),n.top+j+B),this.bottomRightContentBox=f>0||A>0?ni(n.left+Math.min(w,n.width-(E+P)),n.top+Math.min(b,n.height+j+B),Math.max(0,f-(N+k)),A-(S+T),ns.BOTTOM_RIGHT):new un(n.left+n.width-(N+k),n.top+n.height-(S+T)),this.bottomLeftContentBox=m>0||p>0?ni(n.left+E+P,n.top+I,Math.max(0,m-(E+P)),p-(S+T),ns.BOTTOM_LEFT):new un(n.left+E+P,n.top+n.height-(S+T))}return t}(),ns;(function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",t[t.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(ns||(ns={}));var ni=function(t,e,r,n,a){var s=4*((Math.sqrt(2)-1)/3),o=r*s,l=n*s,c=t+r,d=e+n;switch(a){case ns.TOP_LEFT:return new PC(new un(t,d),new un(t,d-l),new un(c-o,e),new un(c,e));case ns.TOP_RIGHT:return new PC(new un(t,e),new un(t+o,e),new un(c,d-l),new un(c,d));case ns.BOTTOM_RIGHT:return new PC(new un(c,e),new un(c,e+l),new un(t+o,d),new un(t,d));case ns.BOTTOM_LEFT:default:return new PC(new un(c,d),new un(c-o,d),new un(t,e+l),new un(t,e))}},DS=function(t){return[t.topLeftBorderBox,t.topRightBorderBox,t.bottomRightBorderBox,t.bottomLeftBorderBox]},ASe=function(t){return[t.topLeftContentBox,t.topRightContentBox,t.bottomRightContentBox,t.bottomLeftContentBox]},RS=function(t){return[t.topLeftPaddingBox,t.topRightPaddingBox,t.bottomRightPaddingBox,t.bottomLeftPaddingBox]},mSe=function(){function t(e,r,n){this.offsetX=e,this.offsetY=r,this.matrix=n,this.type=0,this.target=6}return t}(),TC=function(){function t(e,r){this.path=e,this.target=r,this.type=1}return t}(),pSe=function(){function t(e){this.opacity=e,this.type=2,this.target=6}return t}(),gSe=function(t){return t.type===0},nre=function(t){return t.type===1},xSe=function(t){return t.type===2},LQ=function(t,e){return t.length===e.length?t.some(function(r,n){return r===e[n]}):!1},vSe=function(t,e,r,n,a){return t.map(function(s,o){switch(o){case 0:return s.add(e,r);case 1:return s.add(e+n,r);case 2:return s.add(e+n,r+a);case 3:return s.add(e,r+a)}return s})},are=function(){function t(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return t}(),sre=function(){function t(e,r){if(this.container=e,this.parent=r,this.effects=[],this.curves=new hSe(this.container),this.container.styles.opacity<1&&this.effects.push(new pSe(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,a=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new mSe(n,a,s))}if(this.container.styles.overflowX!==0){var o=DS(this.curves),l=RS(this.curves);LQ(o,l)?this.effects.push(new TC(o,6)):(this.effects.push(new TC(o,2)),this.effects.push(new TC(l,4)))}}return t.prototype.getEffects=function(e){for(var r=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,a=this.effects.slice(0);n;){var s=n.effects.filter(function(c){return!nre(c)});if(r||n.container.styles.position!==0||!n.parent){if(a.unshift.apply(a,s),r=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var o=DS(n.curves),l=RS(n.curves);LQ(o,l)||a.unshift(new TC(l,6))}}else a.unshift.apply(a,s);n=n.parent}return a.filter(function(c){return Uo(c.target,e)})},t}(),Vk=function(t,e,r,n){t.container.elements.forEach(function(a){var s=Uo(a.flags,4),o=Uo(a.flags,2),l=new sre(a,t);Uo(a.styles.display,2048)&&n.push(l);var c=Uo(a.flags,8)?[]:n;if(s||o){var d=s||a.styles.isPositioned()?r:e,u=new are(l);if(a.styles.isPositioned()||a.styles.opacity<1||a.styles.isTransformed()){var f=a.styles.zIndex.order;if(f<0){var A=0;d.negativeZIndex.some(function(m,p){return f>m.element.container.styles.zIndex.order?(A=p,!1):A>0}),d.negativeZIndex.splice(A,0,u)}else if(f>0){var h=0;d.positiveZIndex.some(function(m,p){return f>=m.element.container.styles.zIndex.order?(h=p+1,!1):h>0}),d.positiveZIndex.splice(h,0,u)}else d.zeroOrAutoZIndexOrTransformedOrOpacity.push(u)}else a.styles.isFloating()?d.nonPositionedFloats.push(u):d.nonPositionedInlineLevel.push(u);Vk(l,u,s?u:r,c)}else a.styles.isInlineLevel()?e.inlineLevel.push(l):e.nonInlineLevel.push(l),Vk(l,e,r,c);Uo(a.flags,8)&&ire(a,c)})},ire=function(t,e){for(var r=t instanceof Rk?t.start:1,n=t instanceof Rk?t.reversed:!1,a=0;a<e.length;a++){var s=e[a];s.container instanceof Hte&&typeof s.container.value=="number"&&s.container.value!==0&&(r=s.container.value),s.listValue=B2(r,s.container.styles.listStyleType,!0),r+=n?-1:1}},ySe=function(t){var e=new sre(t,null),r=new are(e),n=[];return Vk(e,r,r,n),ire(e.container,n),r},UQ=function(t,e){switch(e){case 0:return Iu(t.topLeftBorderBox,t.topLeftPaddingBox,t.topRightBorderBox,t.topRightPaddingBox);case 1:return Iu(t.topRightBorderBox,t.topRightPaddingBox,t.bottomRightBorderBox,t.bottomRightPaddingBox);case 2:return Iu(t.bottomRightBorderBox,t.bottomRightPaddingBox,t.bottomLeftBorderBox,t.bottomLeftPaddingBox);case 3:default:return Iu(t.bottomLeftBorderBox,t.bottomLeftPaddingBox,t.topLeftBorderBox,t.topLeftPaddingBox)}},bSe=function(t,e){switch(e){case 0:return Iu(t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox,t.topRightBorderBox,t.topRightBorderDoubleOuterBox);case 1:return Iu(t.topRightBorderBox,t.topRightBorderDoubleOuterBox,t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox);case 2:return Iu(t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox,t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox);case 3:default:return Iu(t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox,t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox)}},wSe=function(t,e){switch(e){case 0:return Iu(t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox,t.topRightBorderDoubleInnerBox,t.topRightPaddingBox);case 1:return Iu(t.topRightBorderDoubleInnerBox,t.topRightPaddingBox,t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox);case 2:return Iu(t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox,t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox);case 3:default:return Iu(t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox,t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox)}},NSe=function(t,e){switch(e){case 0:return BC(t.topLeftBorderStroke,t.topRightBorderStroke);case 1:return BC(t.topRightBorderStroke,t.bottomRightBorderStroke);case 2:return BC(t.bottomRightBorderStroke,t.bottomLeftBorderStroke);case 3:default:return BC(t.bottomLeftBorderStroke,t.topLeftBorderStroke)}},BC=function(t,e){var r=[];return _u(t)?r.push(t.subdivide(.5,!1)):r.push(t),_u(e)?r.push(e.subdivide(.5,!0)):r.push(e),r},Iu=function(t,e,r,n){var a=[];return _u(t)?a.push(t.subdivide(.5,!1)):a.push(t),_u(r)?a.push(r.subdivide(.5,!0)):a.push(r),_u(n)?a.push(n.subdivide(.5,!0).reverse()):a.push(n),_u(e)?a.push(e.subdivide(.5,!1).reverse()):a.push(e),a},ore=function(t){var e=t.bounds,r=t.styles;return e.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},MS=function(t){var e=t.styles,r=t.bounds,n=Ds(e.paddingLeft,r.width),a=Ds(e.paddingRight,r.width),s=Ds(e.paddingTop,r.width),o=Ds(e.paddingBottom,r.width);return r.add(n+e.borderLeftWidth,s+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+n+a),-(e.borderTopWidth+e.borderBottomWidth+s+o))},CSe=function(t,e){return t===0?e.bounds:t===2?MS(e):ore(e)},_Se=function(t,e){return t===0?e.bounds:t===2?MS(e):ore(e)},a5=function(t,e,r){var n=CSe(Fx(t.styles.backgroundOrigin,e),t),a=_Se(Fx(t.styles.backgroundClip,e),t),s=ESe(Fx(t.styles.backgroundSize,e),r,n),o=s[0],l=s[1],c=Zy(Fx(t.styles.backgroundPosition,e),n.width-o,n.height-l),d=SSe(Fx(t.styles.backgroundRepeat,e),c,s,n,a),u=Math.round(n.left+c[0]),f=Math.round(n.top+c[1]);return[d,u,f,o,l]},hx=function(t){return Ns(t)&&t.value===gv.AUTO},kC=function(t){return typeof t=="number"},ESe=function(t,e,r){var n=e[0],a=e[1],s=e[2],o=t[0],l=t[1];if(!o)return[0,0];if(yo(o)&&l&&yo(l))return[Ds(o,r.width),Ds(l,r.height)];var c=kC(s);if(Ns(o)&&(o.value===gv.CONTAIN||o.value===gv.COVER)){if(kC(s)){var d=r.width/r.height;return d<s!=(o.value===gv.COVER)?[r.width,r.width/s]:[r.height*s,r.height]}return[r.width,r.height]}var u=kC(n),f=kC(a),A=u||f;if(hx(o)&&(!l||hx(l))){if(u&&f)return[n,a];if(!c&&!A)return[r.width,r.height];if(A&&c){var h=u?n:a*s,m=f?a:n/s;return[h,m]}var p=u?n:r.width,x=f?a:r.height;return[p,x]}if(c){var v=0,y=0;return yo(o)?v=Ds(o,r.width):yo(l)&&(y=Ds(l,r.height)),hx(o)?v=y*s:(!l||hx(l))&&(y=v/s),[v,y]}var b=null,w=null;if(yo(o)?b=Ds(o,r.width):l&&yo(l)&&(w=Ds(l,r.height)),b!==null&&(!l||hx(l))&&(w=u&&f?b/n*a:r.height),w!==null&&hx(o)&&(b=u&&f?w/a*n:r.width),b!==null&&w!==null)return[b,w];throw new Error("Unable to calculate background-size for element")},Fx=function(t,e){var r=t[e];return typeof r>"u"?t[0]:r},SSe=function(t,e,r,n,a){var s=e[0],o=e[1],l=r[0],c=r[1];switch(t){case 2:return[new un(Math.round(n.left),Math.round(n.top+o)),new un(Math.round(n.left+n.width),Math.round(n.top+o)),new un(Math.round(n.left+n.width),Math.round(c+n.top+o)),new un(Math.round(n.left),Math.round(c+n.top+o))];case 3:return[new un(Math.round(n.left+s),Math.round(n.top)),new un(Math.round(n.left+s+l),Math.round(n.top)),new un(Math.round(n.left+s+l),Math.round(n.height+n.top)),new un(Math.round(n.left+s),Math.round(n.height+n.top))];case 1:return[new un(Math.round(n.left+s),Math.round(n.top+o)),new un(Math.round(n.left+s+l),Math.round(n.top+o)),new un(Math.round(n.left+s+l),Math.round(n.top+o+c)),new un(Math.round(n.left+s),Math.round(n.top+o+c))];default:return[new un(Math.round(a.left),Math.round(a.top)),new un(Math.round(a.left+a.width),Math.round(a.top)),new un(Math.round(a.left+a.width),Math.round(a.height+a.top)),new un(Math.round(a.left),Math.round(a.height+a.top))]}},jSe="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",QQ="Hidden Text",ISe=function(){function t(e){this._data={},this._document=e}return t.prototype.parseMetrics=function(e,r){var n=this._document.createElement("div"),a=this._document.createElement("img"),s=this._document.createElement("span"),o=this._document.body;n.style.visibility="hidden",n.style.fontFamily=e,n.style.fontSize=r,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",o.appendChild(n),a.src=jSe,a.width=1,a.height=1,a.style.margin="0",a.style.padding="0",a.style.verticalAlign="baseline",s.style.fontFamily=e,s.style.fontSize=r,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(QQ)),n.appendChild(s),n.appendChild(a);var l=a.offsetTop-s.offsetTop+2;n.removeChild(s),n.appendChild(this._document.createTextNode(QQ)),n.style.lineHeight="normal",a.style.verticalAlign="super";var c=a.offsetTop-n.offsetTop+2;return o.removeChild(n),{baseline:l,middle:c}},t.prototype.getMetrics=function(e,r){var n=e+" "+r;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(e,r)),this._data[n]},t}(),lre=function(){function t(e,r){this.context=e,this.options=r}return t}(),PSe=1e4,TSe=function(t){kf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a._activeEffects=[],a.canvas=n.canvas?n.canvas:document.createElement("canvas"),a.ctx=a.canvas.getContext("2d"),n.canvas||(a.canvas.width=Math.floor(n.width*n.scale),a.canvas.height=Math.floor(n.height*n.scale),a.canvas.style.width=n.width+"px",a.canvas.style.height=n.height+"px"),a.fontMetrics=new ISe(document),a.ctx.scale(a.options.scale,a.options.scale),a.ctx.translate(-n.x,-n.y),a.ctx.textBaseline="bottom",a._activeEffects=[],a.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),a}return e.prototype.applyEffects=function(r){for(var n=this;this._activeEffects.length;)this.popEffect();r.forEach(function(a){return n.applyEffect(a)})},e.prototype.applyEffect=function(r){this.ctx.save(),xSe(r)&&(this.ctx.globalAlpha=r.opacity),gSe(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),nre(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(r){return Bc(this,void 0,void 0,function(){var n;return oc(this,function(a){switch(a.label){case 0:return n=r.element.container.styles,n.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},e.prototype.renderNode=function(r){return Bc(this,void 0,void 0,function(){return oc(this,function(n){switch(n.label){case 0:if(Uo(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(r)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.renderTextWithLetterSpacing=function(r,n,a){var s=this;if(n===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+a);else{var o=Y6(r.text);o.reduce(function(l,c){return s.ctx.fillText(c,l,r.bounds.top+a),l+s.ctx.measureText(c).width},r.bounds.left)}},e.prototype.createFontStyle=function(r){var n=r.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),a=DSe(r.fontFamily).join(", "),s=Uw(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,n,r.fontWeight,s,a].join(" "),a,s]},e.prototype.renderTextNode=function(r,n){return Bc(this,void 0,void 0,function(){var a,s,o,l,c,d,u,f,A=this;return oc(this,function(h){return a=this.createFontStyle(n),s=a[0],o=a[1],l=a[2],this.ctx.font=s,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",c=this.fontMetrics.getMetrics(o,l),d=c.baseline,u=c.middle,f=n.paintOrder,r.textBounds.forEach(function(m){f.forEach(function(p){switch(p){case 0:A.ctx.fillStyle=nl(n.color),A.renderTextWithLetterSpacing(m,n.letterSpacing,d);var x=n.textShadow;x.length&&m.text.trim().length&&(x.slice(0).reverse().forEach(function(v){A.ctx.shadowColor=nl(v.color),A.ctx.shadowOffsetX=v.offsetX.number*A.options.scale,A.ctx.shadowOffsetY=v.offsetY.number*A.options.scale,A.ctx.shadowBlur=v.blur.number,A.renderTextWithLetterSpacing(m,n.letterSpacing,d)}),A.ctx.shadowColor="",A.ctx.shadowOffsetX=0,A.ctx.shadowOffsetY=0,A.ctx.shadowBlur=0),n.textDecorationLine.length&&(A.ctx.fillStyle=nl(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(v){switch(v){case 1:A.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top+d),m.bounds.width,1);break;case 2:A.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top),m.bounds.width,1);break;case 3:A.ctx.fillRect(m.bounds.left,Math.ceil(m.bounds.top+u),m.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&m.text.trim().length&&(A.ctx.strokeStyle=nl(n.webkitTextStrokeColor),A.ctx.lineWidth=n.webkitTextStrokeWidth,A.ctx.lineJoin=window.chrome?"miter":"round",A.ctx.strokeText(m.text,m.bounds.left,m.bounds.top+d)),A.ctx.strokeStyle="",A.ctx.lineWidth=0,A.ctx.lineJoin="miter";break}})}),[2]})})},e.prototype.renderReplacedElement=function(r,n,a){if(a&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var s=MS(r),o=RS(n);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(a,0,0,r.intrinsicWidth,r.intrinsicHeight,s.left,s.top,s.width,s.height),this.ctx.restore()}},e.prototype.renderNodeContent=function(r){return Bc(this,void 0,void 0,function(){var n,a,s,o,l,c,y,y,d,u,f,A,w,h,m,I,p,x,v,y,b,w,I;return oc(this,function(j){switch(j.label){case 0:this.applyEffects(r.getEffects(4)),n=r.container,a=r.curves,s=n.styles,o=0,l=n.textNodes,j.label=1;case 1:return o<l.length?(c=l[o],[4,this.renderTextNode(c,s)]):[3,4];case 2:j.sent(),j.label=3;case 3:return o++,[3,1];case 4:if(!(n instanceof Ute))return[3,8];j.label=5;case 5:return j.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return y=j.sent(),this.renderReplacedElement(n,a,y),[3,8];case 7:return j.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof Qte&&this.renderReplacedElement(n,a,n.canvas),!(n instanceof Vte))return[3,12];j.label=9;case 9:return j.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return y=j.sent(),this.renderReplacedElement(n,a,y),[3,12];case 11:return j.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof Kte&&n.tree?(d=new e(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,d.render(n.tree)]):[3,14];case 13:u=j.sent(),n.width&&n.height&&this.ctx.drawImage(u,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),j.label=14;case 14:if(n instanceof J6&&(f=Math.min(n.bounds.width,n.bounds.height),n.type===BS?n.checked&&(this.ctx.save(),this.path([new un(n.bounds.left+f*.39363,n.bounds.top+f*.79),new un(n.bounds.left+f*.16,n.bounds.top+f*.5549),new un(n.bounds.left+f*.27347,n.bounds.top+f*.44071),new un(n.bounds.left+f*.39694,n.bounds.top+f*.5649),new un(n.bounds.left+f*.72983,n.bounds.top+f*.23),new un(n.bounds.left+f*.84,n.bounds.top+f*.34085),new un(n.bounds.left+f*.39363,n.bounds.top+f*.79)]),this.ctx.fillStyle=nl(jQ),this.ctx.fill(),this.ctx.restore()):n.type===kS&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+f/2,n.bounds.top+f/2,f/4,0,Math.PI*2,!0),this.ctx.fillStyle=nl(jQ),this.ctx.fill(),this.ctx.restore())),BSe(n)&&n.value.length){switch(A=this.createFontStyle(s),w=A[0],h=A[1],m=this.fontMetrics.getMetrics(w,h).baseline,this.ctx.font=w,this.ctx.fillStyle=nl(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=FSe(n.styles.textAlign),I=MS(n),p=0,n.styles.textAlign){case 1:p+=I.width/2;break;case 2:p+=I.width;break}x=I.add(p,0,0,-I.height/2+1),this.ctx.save(),this.path([new un(I.left,I.top),new un(I.left+I.width,I.top),new un(I.left+I.width,I.top+I.height),new un(I.left,I.top+I.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Pb(n.value,x),s.letterSpacing,m),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Uo(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(v=n.styles.listStyleImage,v.type!==0)return[3,18];y=void 0,b=v.url,j.label=15;case 15:return j.trys.push([15,17,,18]),[4,this.context.cache.match(b)];case 16:return y=j.sent(),this.ctx.drawImage(y,n.bounds.left-(y.width+10),n.bounds.top),[3,18];case 17:return j.sent(),this.context.logger.error("Error loading list-style-image "+b),[3,18];case 18:return[3,20];case 19:r.listValue&&n.styles.listStyleType!==-1&&(w=this.createFontStyle(s)[0],this.ctx.font=w,this.ctx.fillStyle=nl(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",I=new NA(n.bounds.left,n.bounds.top+Ds(n.styles.paddingTop,n.bounds.width),n.bounds.width,uQ(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Pb(r.listValue,I),s.letterSpacing,uQ(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),j.label=20;case 20:return[2]}})})},e.prototype.renderStackContent=function(r){return Bc(this,void 0,void 0,function(){var n,a,v,s,o,v,l,c,v,d,u,v,f,A,v,h,m,v,p,x,v;return oc(this,function(y){switch(y.label){case 0:if(Uo(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:y.sent(),n=0,a=r.negativeZIndex,y.label=2;case 2:return n<a.length?(v=a[n],[4,this.renderStack(v)]):[3,5];case 3:y.sent(),y.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:y.sent(),s=0,o=r.nonInlineLevel,y.label=7;case 7:return s<o.length?(v=o[s],[4,this.renderNode(v)]):[3,10];case 8:y.sent(),y.label=9;case 9:return s++,[3,7];case 10:l=0,c=r.nonPositionedFloats,y.label=11;case 11:return l<c.length?(v=c[l],[4,this.renderStack(v)]):[3,14];case 12:y.sent(),y.label=13;case 13:return l++,[3,11];case 14:d=0,u=r.nonPositionedInlineLevel,y.label=15;case 15:return d<u.length?(v=u[d],[4,this.renderStack(v)]):[3,18];case 16:y.sent(),y.label=17;case 17:return d++,[3,15];case 18:f=0,A=r.inlineLevel,y.label=19;case 19:return f<A.length?(v=A[f],[4,this.renderNode(v)]):[3,22];case 20:y.sent(),y.label=21;case 21:return f++,[3,19];case 22:h=0,m=r.zeroOrAutoZIndexOrTransformedOrOpacity,y.label=23;case 23:return h<m.length?(v=m[h],[4,this.renderStack(v)]):[3,26];case 24:y.sent(),y.label=25;case 25:return h++,[3,23];case 26:p=0,x=r.positiveZIndex,y.label=27;case 27:return p<x.length?(v=x[p],[4,this.renderStack(v)]):[3,30];case 28:y.sent(),y.label=29;case 29:return p++,[3,27];case 30:return[2]}})})},e.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},e.prototype.formatPath=function(r){var n=this;r.forEach(function(a,s){var o=_u(a)?a.start:a;s===0?n.ctx.moveTo(o.x,o.y):n.ctx.lineTo(o.x,o.y),_u(a)&&n.ctx.bezierCurveTo(a.startControl.x,a.startControl.y,a.endControl.x,a.endControl.y,a.end.x,a.end.y)})},e.prototype.renderRepeat=function(r,n,a,s){this.path(r),this.ctx.fillStyle=n,this.ctx.translate(a,s),this.ctx.fill(),this.ctx.translate(-a,-s)},e.prototype.resizeImage=function(r,n,a){var s;if(r.width===n&&r.height===a)return r;var o=(s=this.canvas.ownerDocument)!==null&&s!==void 0?s:document,l=o.createElement("canvas");l.width=Math.max(1,n),l.height=Math.max(1,a);var c=l.getContext("2d");return c.drawImage(r,0,0,r.width,r.height,0,0,n,a),l},e.prototype.renderBackgroundImage=function(r){return Bc(this,void 0,void 0,function(){var n,a,s,o,l,c;return oc(this,function(d){switch(d.label){case 0:n=r.styles.backgroundImage.length-1,a=function(u){var f,A,h,B,ce,le,P,q,S,m,B,ce,le,P,q,p,x,v,y,b,w,I,j,N,S,E,B,k,T,P,q,de,ce,le,he,ae,Ce,De,O,R,G,M;return oc(this,function(K){switch(K.label){case 0:if(u.type!==0)return[3,5];f=void 0,A=u.url,K.label=1;case 1:return K.trys.push([1,3,,4]),[4,s.context.cache.match(A)];case 2:return f=K.sent(),[3,4];case 3:return K.sent(),s.context.logger.error("Error loading background-image "+A),[3,4];case 4:return f&&(h=a5(r,n,[f.width,f.height,f.width/f.height]),B=h[0],ce=h[1],le=h[2],P=h[3],q=h[4],S=s.ctx.createPattern(s.resizeImage(f,P,q),"repeat"),s.renderRepeat(B,S,ce,le)),[3,6];case 5:gCe(u)?(m=a5(r,n,[null,null,null]),B=m[0],ce=m[1],le=m[2],P=m[3],q=m[4],p=fCe(u.angle,P,q),x=p[0],v=p[1],y=p[2],b=p[3],w=p[4],I=document.createElement("canvas"),I.width=P,I.height=q,j=I.getContext("2d"),N=j.createLinearGradient(v,b,y,w),cQ(u.stops,x).forEach(function(Y){return N.addColorStop(Y.stop,nl(Y.color))}),j.fillStyle=N,j.fillRect(0,0,P,q),P>0&&q>0&&(S=s.ctx.createPattern(I,"repeat"),s.renderRepeat(B,S,ce,le))):xCe(u)&&(E=a5(r,n,[null,null,null]),B=E[0],k=E[1],T=E[2],P=E[3],q=E[4],de=u.position.length===0?[z6]:u.position,ce=Ds(de[0],P),le=Ds(de[de.length-1],q),he=hCe(u,ce,le,P,q),ae=he[0],Ce=he[1],ae>0&&Ce>0&&(De=s.ctx.createRadialGradient(k+ce,T+le,0,k+ce,T+le,ae),cQ(u.stops,ae*2).forEach(function(Y){return De.addColorStop(Y.stop,nl(Y.color))}),s.path(B),s.ctx.fillStyle=De,ae!==Ce?(O=r.bounds.left+.5*r.bounds.width,R=r.bounds.top+.5*r.bounds.height,G=Ce/ae,M=1/G,s.ctx.save(),s.ctx.translate(O,R),s.ctx.transform(1,0,0,G,0,0),s.ctx.translate(-O,-R),s.ctx.fillRect(k,M*(T-R)+R,P,q*M),s.ctx.restore()):s.ctx.fill())),K.label=6;case 6:return n--,[2]}})},s=this,o=0,l=r.styles.backgroundImage.slice(0).reverse(),d.label=1;case 1:return o<l.length?(c=l[o],[5,a(c)]):[3,4];case 2:d.sent(),d.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},e.prototype.renderSolidBorder=function(r,n,a){return Bc(this,void 0,void 0,function(){return oc(this,function(s){return this.path(UQ(a,n)),this.ctx.fillStyle=nl(r),this.ctx.fill(),[2]})})},e.prototype.renderDoubleBorder=function(r,n,a,s){return Bc(this,void 0,void 0,function(){var o,l;return oc(this,function(c){switch(c.label){case 0:return n<3?[4,this.renderSolidBorder(r,a,s)]:[3,2];case 1:return c.sent(),[2];case 2:return o=bSe(s,a),this.path(o),this.ctx.fillStyle=nl(r),this.ctx.fill(),l=wSe(s,a),this.path(l),this.ctx.fill(),[2]}})})},e.prototype.renderNodeBackgroundAndBorders=function(r){return Bc(this,void 0,void 0,function(){var n,a,s,o,l,c,d,u,f=this;return oc(this,function(A){switch(A.label){case 0:return this.applyEffects(r.getEffects(2)),n=r.container.styles,a=!mm(n.backgroundColor)||n.backgroundImage.length,s=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],o=kSe(Fx(n.backgroundClip,0),r.curves),a||n.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),mm(n.backgroundColor)||(this.ctx.fillStyle=nl(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:A.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(h){f.ctx.save();var m=DS(r.curves),p=h.inset?0:PSe,x=vSe(m,-p+(h.inset?1:-1)*h.spread.number,(h.inset?1:-1)*h.spread.number,h.spread.number*(h.inset?-2:2),h.spread.number*(h.inset?-2:2));h.inset?(f.path(m),f.ctx.clip(),f.mask(x)):(f.mask(m),f.ctx.clip(),f.path(x)),f.ctx.shadowOffsetX=h.offsetX.number+p,f.ctx.shadowOffsetY=h.offsetY.number,f.ctx.shadowColor=nl(h.color),f.ctx.shadowBlur=h.blur.number,f.ctx.fillStyle=h.inset?nl(h.color):"rgba(0,0,0,1)",f.ctx.fill(),f.ctx.restore()}),A.label=2;case 2:l=0,c=0,d=s,A.label=3;case 3:return c<d.length?(u=d[c],u.style!==0&&!mm(u.color)&&u.width>0?u.style!==2?[3,5]:[4,this.renderDashedDottedBorder(u.color,u.width,l,r.curves,2)]:[3,11]):[3,13];case 4:return A.sent(),[3,11];case 5:return u.style!==3?[3,7]:[4,this.renderDashedDottedBorder(u.color,u.width,l,r.curves,3)];case 6:return A.sent(),[3,11];case 7:return u.style!==4?[3,9]:[4,this.renderDoubleBorder(u.color,u.width,l,r.curves)];case 8:return A.sent(),[3,11];case 9:return[4,this.renderSolidBorder(u.color,l,r.curves)];case 10:A.sent(),A.label=11;case 11:l++,A.label=12;case 12:return c++,[3,3];case 13:return[2]}})})},e.prototype.renderDashedDottedBorder=function(r,n,a,s,o){return Bc(this,void 0,void 0,function(){var l,c,d,u,f,A,h,m,p,x,v,y,b,w,I,j,I,j;return oc(this,function(N){return this.ctx.save(),l=NSe(s,a),c=UQ(s,a),o===2&&(this.path(c),this.ctx.clip()),_u(c[0])?(d=c[0].start.x,u=c[0].start.y):(d=c[0].x,u=c[0].y),_u(c[1])?(f=c[1].end.x,A=c[1].end.y):(f=c[1].x,A=c[1].y),a===0||a===2?h=Math.abs(d-f):h=Math.abs(u-A),this.ctx.beginPath(),o===3?this.formatPath(l):this.formatPath(c.slice(0,2)),m=n<3?n*3:n*2,p=n<3?n*2:n,o===3&&(m=n,p=n),x=!0,h<=m*2?x=!1:h<=m*2+p?(v=h/(2*m+p),m*=v,p*=v):(y=Math.floor((h+p)/(m+p)),b=(h-y*m)/(y-1),w=(h-(y+1)*m)/y,p=w<=0||Math.abs(p-b)<Math.abs(p-w)?b:w),x&&(o===3?this.ctx.setLineDash([0,m+p]):this.ctx.setLineDash([m,p])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=nl(r),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(_u(c[0])&&(I=c[3],j=c[0],this.ctx.beginPath(),this.formatPath([new un(I.end.x,I.end.y),new un(j.start.x,j.start.y)]),this.ctx.stroke()),_u(c[1])&&(I=c[1],j=c[2],this.ctx.beginPath(),this.formatPath([new un(I.end.x,I.end.y),new un(j.start.x,j.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},e.prototype.render=function(r){return Bc(this,void 0,void 0,function(){var n;return oc(this,function(a){switch(a.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=nl(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=ySe(r),[4,this.renderStack(n)];case 1:return a.sent(),this.applyEffects([]),[2,this.canvas]}})})},e}(lre),BSe=function(t){return t instanceof Gte||t instanceof $te?!0:t instanceof J6&&t.type!==kS&&t.type!==BS},kSe=function(t,e){switch(t){case 0:return DS(e);case 2:return ASe(e);case 1:default:return RS(e)}},FSe=function(t){switch(t){case 1:return"center";case 2:return"right";case 0:default:return"left"}},OSe=["-apple-system","system-ui"],DSe=function(t){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?t.filter(function(e){return OSe.indexOf(e)===-1}):t},RSe=function(t){kf(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.canvas=n.canvas?n.canvas:document.createElement("canvas"),a.ctx=a.canvas.getContext("2d"),a.options=n,a.canvas.width=Math.floor(n.width*n.scale),a.canvas.height=Math.floor(n.height*n.scale),a.canvas.style.width=n.width+"px",a.canvas.style.height=n.height+"px",a.ctx.scale(a.options.scale,a.options.scale),a.ctx.translate(-n.x,-n.y),a.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),a}return e.prototype.render=function(r){return Bc(this,void 0,void 0,function(){var n,a;return oc(this,function(s){switch(s.label){case 0:return n=Dk(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,MSe(n)];case 1:return a=s.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=nl(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(a,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},e}(lre),MSe=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){e(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},LSe=function(){function t(e){var r=e.id,n=e.enabled;this.id=r,this.enabled=n,this.start=Date.now()}return t.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,uC([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.getTime=function(){return Date.now()-this.start},t.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,uC([this.id,this.getTime()+"ms"],e))},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,uC([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,uC([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.instances={},t}(),USe=function(){function t(e,r){var n;this.windowBounds=r,this.instanceName="#"+t.instanceCount++,this.logger=new LSe({id:this.instanceName,enabled:e.logging}),this.cache=(n=e.cache)!==null&&n!==void 0?n:new iSe(this,e)}return t.instanceCount=1,t}(),$m=function(t,e){return e===void 0&&(e={}),QSe(t,e)};typeof window<"u"&&rre.setContext(window);var QSe=function(t,e){return Bc(void 0,void 0,void 0,function(){var r,n,a,s,o,l,c,d,u,f,A,h,m,p,x,v,y,b,w,I,N,j,N,S,E,B,k,T,P,q,de,ce,le,he,ae,Ce,De,O,R,G;return oc(this,function(M){switch(M.label){case 0:if(!t||typeof t!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=t.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(n=r.defaultView,!n)throw new Error("Document is not attached to a Window");return a={allowTaint:(S=e.allowTaint)!==null&&S!==void 0?S:!1,imageTimeout:(E=e.imageTimeout)!==null&&E!==void 0?E:15e3,proxy:e.proxy,useCORS:(B=e.useCORS)!==null&&B!==void 0?B:!1},s=bk({logging:(k=e.logging)!==null&&k!==void 0?k:!0,cache:e.cache},a),o={windowWidth:(T=e.windowWidth)!==null&&T!==void 0?T:n.innerWidth,windowHeight:(P=e.windowHeight)!==null&&P!==void 0?P:n.innerHeight,scrollX:(q=e.scrollX)!==null&&q!==void 0?q:n.pageXOffset,scrollY:(de=e.scrollY)!==null&&de!==void 0?de:n.pageYOffset},l=new NA(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),c=new USe(s,l),d=(ce=e.foreignObjectRendering)!==null&&ce!==void 0?ce:!1,u={allowTaint:(le=e.allowTaint)!==null&&le!==void 0?le:!1,onclone:e.onclone,ignoreElements:e.ignoreElements,inlineImages:d,copyStyles:d},c.logger.debug("Starting document clone with size "+l.width+"x"+l.height+" scrolled to "+-l.left+","+-l.top),f=new RQ(c,t,u),A=f.clonedReferenceElement,A?[4,f.toIFrame(r,l)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return h=M.sent(),m=Z6(A)||HEe(A)?vwe(A.ownerDocument):rP(c,A),p=m.width,x=m.height,v=m.left,y=m.top,b=VSe(c,A,e.backgroundColor),w={canvas:e.canvas,backgroundColor:b,scale:(ae=(he=e.scale)!==null&&he!==void 0?he:n.devicePixelRatio)!==null&&ae!==void 0?ae:1,x:((Ce=e.x)!==null&&Ce!==void 0?Ce:0)+v,y:((De=e.y)!==null&&De!==void 0?De:0)+y,width:(O=e.width)!==null&&O!==void 0?O:Math.ceil(p),height:(R=e.height)!==null&&R!==void 0?R:Math.ceil(x)},d?(c.logger.debug("Document cloned, using foreign object rendering"),N=new RSe(c,w),[4,N.render(A)]):[3,3];case 2:return I=M.sent(),[3,5];case 3:return c.logger.debug("Document cloned, element located at "+v+","+y+" with size "+p+"x"+x+" using computed rendering"),c.logger.debug("Starting DOM parsing"),j=zte(c,A),b===j.styles.backgroundColor&&(j.styles.backgroundColor=cA.TRANSPARENT),c.logger.debug("Starting renderer for element at "+w.x+","+w.y+" with size "+w.width+"x"+w.height),N=new TSe(c,w),[4,N.render(j)];case 4:I=M.sent(),M.label=5;case 5:return(!((G=e.removeContainer)!==null&&G!==void 0)||G)&&(RQ.destroy(h)||c.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.logger.debug("Finished rendering"),[2,I]}})})},VSe=function(t,e,r){var n=e.ownerDocument,a=n.documentElement?jb(t,getComputedStyle(n.documentElement).backgroundColor):cA.TRANSPARENT,s=n.body?jb(t,getComputedStyle(n.body).backgroundColor):cA.TRANSPARENT,o=typeof r=="string"?jb(t,r):r===null?cA.TRANSPARENT:4294967295;return e===n.documentElement?mm(a)?mm(s)?o:s:a:o};const eR=Object.freeze(Object.defineProperty({__proto__:null,default:$m},Symbol.toStringTag,{value:"Module"})),HSe="modulepreload",$Se=function(t){return"/"+t},VQ={},dA=function(e,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=$Se(c),c in VQ)return;VQ[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":HSe,d||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),d)return new Promise((A,h)=>{f.addEventListener("load",A),f.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};function ms(t){"@babel/helpers - typeof";return ms=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ms(t)}var If=Uint8Array,Qd=Uint16Array,tR=Int32Array,rR=new If([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),nR=new If([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),HQ=new If([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),cre=function(t,e){for(var r=new Qd(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var a=new tR(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)a[s]=s-r[n]<<5|n;return{b:r,r:a}},dre=cre(rR,2),GSe=dre.b,Hk=dre.r;GSe[28]=258,Hk[258]=28;var KSe=cre(nR,0),$Q=KSe.r,$k=new Qd(32768);for(var Xs=0;Xs<32768;++Xs){var A0=(Xs&43690)>>1|(Xs&21845)<<1;A0=(A0&52428)>>2|(A0&13107)<<2,A0=(A0&61680)>>4|(A0&3855)<<4,$k[Xs]=((A0&65280)>>8|(A0&255)<<8)>>1}var Bb=function(t,e,r){for(var n=t.length,a=0,s=new Qd(e);a<n;++a)t[a]&&++s[t[a]-1];var o=new Qd(e);for(a=1;a<e;++a)o[a]=o[a-1]+s[a-1]<<1;var l;if(r){l=new Qd(1<<e);var c=15-e;for(a=0;a<n;++a)if(t[a])for(var d=a<<4|t[a],u=e-t[a],f=o[t[a]-1]++<<u,A=f|(1<<u)-1;f<=A;++f)l[$k[f]>>c]=d}else for(l=new Qd(n),a=0;a<n;++a)t[a]&&(l[a]=$k[o[t[a]-1]++]>>15-t[a]);return l},pg=new If(288);for(var Xs=0;Xs<144;++Xs)pg[Xs]=8;for(var Xs=144;Xs<256;++Xs)pg[Xs]=9;for(var Xs=256;Xs<280;++Xs)pg[Xs]=7;for(var Xs=280;Xs<288;++Xs)pg[Xs]=8;var LS=new If(32);for(var Xs=0;Xs<32;++Xs)LS[Xs]=5;var qSe=Bb(pg,9,0),zSe=Bb(LS,5,0),ure=function(t){return(t+7)/8|0},WSe=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new If(t.subarray(e,r))},Th=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},wy=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},s5=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var a=r.length,s=r.slice();if(!a)return{t:hre,l:0};if(a==1){var o=new If(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(I,j){return I.f-j.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],d=0,u=1,f=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};u!=a-1;)l=r[r[d].f<r[f].f?d++:f++],c=r[d!=u&&r[d].f<r[f].f?d++:f++],r[u++]={s:-1,f:l.f+c.f,l,r:c};for(var A=s[0].s,n=1;n<a;++n)s[n].s>A&&(A=s[n].s);var h=new Qd(A+1),m=Gk(r[u-1],h,0);if(m>e){var n=0,p=0,x=m-e,v=1<<x;for(s.sort(function(j,N){return h[N.s]-h[j.s]||j.f-N.f});n<a;++n){var y=s[n].s;if(h[y]>e)p+=v-(1<<m-h[y]),h[y]=e;else break}for(p>>=x;p>0;){var b=s[n].s;h[b]<e?p-=1<<e-h[b]++-1:++n}for(;n>=0&&p;--n){var w=s[n].s;h[w]==e&&(--h[w],++p)}m=e}return{t:new If(h),l:m}},Gk=function(t,e,r){return t.s==-1?Math.max(Gk(t.l,e,r+1),Gk(t.r,e,r+1)):e[t.s]=r},GQ=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Qd(++e),n=0,a=t[0],s=1,o=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==a&&l!=e)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=t[l]}return{c:r.subarray(0,n),n:e}},Ny=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},fre=function(t,e,r){var n=r.length,a=ure(e+2);t[a]=n&255,t[a+1]=n>>8,t[a+2]=t[a]^255,t[a+3]=t[a+1]^255;for(var s=0;s<n;++s)t[a+s+4]=r[s];return(a+4+n)*8},KQ=function(t,e,r,n,a,s,o,l,c,d,u){Th(e,u++,r),++a[256];for(var f=s5(a,15),A=f.t,h=f.l,m=s5(s,15),p=m.t,x=m.l,v=GQ(A),y=v.c,b=v.n,w=GQ(p),I=w.c,j=w.n,N=new Qd(19),S=0;S<y.length;++S)++N[y[S]&31];for(var S=0;S<I.length;++S)++N[I[S]&31];for(var E=s5(N,7),B=E.t,k=E.l,T=19;T>4&&!B[HQ[T-1]];--T);var P=d+5<<3,q=Ny(a,pg)+Ny(s,LS)+o,de=Ny(a,A)+Ny(s,p)+o+14+3*T+Ny(N,B)+2*N[16]+3*N[17]+7*N[18];if(c>=0&&P<=q&&P<=de)return fre(e,u,t.subarray(c,c+d));var ce,le,he,ae;if(Th(e,u,1+(de<q)),u+=2,de<q){ce=Bb(A,h,0),le=A,he=Bb(p,x,0),ae=p;var Ce=Bb(B,k,0);Th(e,u,b-257),Th(e,u+5,j-1),Th(e,u+10,T-4),u+=14;for(var S=0;S<T;++S)Th(e,u+3*S,B[HQ[S]]);u+=3*T;for(var De=[y,I],O=0;O<2;++O)for(var R=De[O],S=0;S<R.length;++S){var G=R[S]&31;Th(e,u,Ce[G]),u+=B[G],G>15&&(Th(e,u,R[S]>>5&127),u+=R[S]>>12)}}else ce=qSe,le=pg,he=zSe,ae=LS;for(var S=0;S<l;++S){var M=n[S];if(M>255){var G=M>>18&31;wy(e,u,ce[G+257]),u+=le[G+257],G>7&&(Th(e,u,M>>23&31),u+=rR[G]);var K=M&31;wy(e,u,he[K]),u+=ae[K],K>3&&(wy(e,u,M>>5&8191),u+=nR[K])}else wy(e,u,ce[M]),u+=le[M]}return wy(e,u,ce[256]),u+le[256]},XSe=new tR([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),hre=new If(0),YSe=function(t,e,r,n,a,s){var o=s.z||t.length,l=new If(n+o+5*(1+Math.ceil(o/7e3))+a),c=l.subarray(n,l.length-a),d=s.l,u=(s.r||0)&7;if(e){u&&(c[0]=s.r>>3);for(var f=XSe[e-1],A=f>>13,h=f&8191,m=(1<<r)-1,p=s.p||new Qd(32768),x=s.h||new Qd(m+1),v=Math.ceil(r/3),y=2*v,b=function(se){return(t[se]^t[se+1]<<v^t[se+2]<<y)&m},w=new tR(25e3),I=new Qd(288),j=new Qd(32),N=0,S=0,E=s.i||0,B=0,k=s.w||0,T=0;E+2<o;++E){var P=b(E),q=E&32767,de=x[P];if(p[q]=de,x[P]=q,k<=E){var ce=o-E;if((N>7e3||B>24576)&&(ce>423||!d)){u=KQ(t,c,0,w,I,j,S,B,T,E-T,u),B=N=S=0,T=E;for(var le=0;le<286;++le)I[le]=0;for(var le=0;le<30;++le)j[le]=0}var he=2,ae=0,Ce=h,De=q-de&32767;if(ce>2&&P==b(E-De))for(var O=Math.min(A,ce)-1,R=Math.min(32767,E),G=Math.min(258,ce);De<=R&&--Ce&&q!=de;){if(t[E+he]==t[E+he-De]){for(var M=0;M<G&&t[E+M]==t[E+M-De];++M);if(M>he){if(he=M,ae=De,M>O)break;for(var K=Math.min(De,M-2),Y=0,le=0;le<K;++le){var D=E-De+le&32767,V=p[D],te=D-V&32767;te>Y&&(Y=te,de=D)}}}q=de,de=p[q],De+=q-de&32767}if(ae){w[B++]=268435456|Hk[he]<<18|$Q[ae];var ve=Hk[he]&31,Q=$Q[ae]&31;S+=rR[ve]+nR[Q],++I[257+ve],++j[Q],k=E+he,++N}else w[B++]=t[E],++I[t[E]]}}for(E=Math.max(E,k);E<o;++E)w[B++]=t[E],++I[t[E]];u=KQ(t,c,d,w,I,j,S,B,T,E-T,u),d||(s.r=u&7|c[u/8|0]<<3,u-=7,s.h=x,s.p=p,s.i=E,s.w=k)}else{for(var E=s.w||0;E<o+d;E+=65535){var Xe=E+65535;Xe>=o&&(c[u/8|0]=d,Xe=o),u=fre(c,u+1,t.subarray(E,Xe))}s.i=o}return WSe(l,0,n+ure(u)+a)},Are=function(){var t=1,e=0;return{p:function(r){for(var n=t,a=e,s=r.length|0,o=0;o!=s;){for(var l=Math.min(o+2655,s);o<l;++o)a+=n+=r[o];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}t=n,e=a},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},JSe=function(t,e,r,n,a){if(!a&&(a={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),o=new If(s.length+t.length);o.set(s),o.set(t,s.length),t=o,a.w=s.length}return YSe(t,e.level==null?6:e.level,e.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,a)},mre=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},ZSe=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var a=Are();a.p(e.dictionary),mre(t,2,a.d())}};function Kk(t,e){e||(e={});var r=Are();r.p(t);var n=JSe(t,e,e.dictionary?6:2,4);return ZSe(n,e),mre(n,n.length-4,r.d()),n}var eje=typeof TextDecoder<"u"&&new TextDecoder,tje=0;try{eje.decode(hre,{stream:!0}),tje=1}catch{}function rje(t){if(Array.isArray(t))return t}function nje(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,a,s,o,l=[],c=!0,d=!1;try{if(s=(r=r.call(t)).next,e!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function qQ(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function aje(t,e){if(t){if(typeof t=="string")return qQ(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?qQ(t,e):void 0}}function sje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zQ(t,e){return rje(t)||nje(t,e)||aje(t,e)||sje()}function WQ(t,e="utf8"){return new TextDecoder(e).decode(t)}const ije=new TextEncoder;function oje(t){return ije.encode(t)}const lje=1024*8,cje=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),i5={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class aR{constructor(e=lje,r={}){Rr(this,"buffer");Rr(this,"byteLength");Rr(this,"byteOffset");Rr(this,"length");Rr(this,"offset");Rr(this,"lastWrittenByte");Rr(this,"littleEndian");Rr(this,"_data");Rr(this,"_mark");Rr(this,"_marks");let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const a=r.offset?r.offset>>>0:0,s=e.byteLength-a;let o=a;(ArrayBuffer.isView(e)||e instanceof aR)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+a),e=e.buffer),n?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,a=new Uint8Array(n);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const n=i5[r].BYTES_PER_ELEMENT*e,a=this.byteOffset+this.offset,s=this.buffer.slice(a,a+n);if(this.littleEndian===cje&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(a,a+n));l.reverse();const c=new i5[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new i5[r](s);return this.offset+=n,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let n=0;n<e;n++)r+=this.readChar();return r}readUtf8(e=1){return WQ(this.readBytes(e))}decodeText(e=1,r="utf8"){return WQ(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(oje(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function C1(t){let e=t.length;for(;--e>=0;)t[e]=0}const dje=3,uje=258,pre=29,fje=256,hje=fje+1+pre,gre=30,Aje=512,mje=new Array((hje+2)*2);C1(mje);const pje=new Array(gre*2);C1(pje);const gje=new Array(Aje);C1(gje);const xje=new Array(uje-dje+1);C1(xje);const vje=new Array(pre);C1(vje);const yje=new Array(gre);C1(yje);const bje=(t,e,r,n)=>{let a=t&65535|0,s=t>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do a=a+e[n++]|0,s=s+a|0;while(--o);a%=65521,s%=65521}return a|s<<16|0};var qk=bje;const wje=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},Nje=new Uint32Array(wje()),Cje=(t,e,r,n)=>{const a=Nje,s=n+r;t^=-1;for(let o=n;o<s;o++)t=t>>>8^a[(t^e[o])&255];return t^-1};var Vf=Cje,zk={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},xre={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const _je=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var Eje=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)_je(r,n)&&(t[n]=r[n])}}return t},Sje=t=>{let e=0;for(let n=0,a=t.length;n<a;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,a=0,s=t.length;n<s;n++){let o=t[n];r.set(o,a),a+=o.length}return r},vre={assign:Eje,flattenChunks:Sje};let yre=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{yre=!1}const k2=new Uint8Array(256);for(let t=0;t<256;t++)k2[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;k2[254]=k2[254]=1;var jje=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,a,s,o=t.length,l=0;for(a=0;a<o;a++)r=t.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=t.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(l),s=0,a=0;s<l;a++)r=t.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=t.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|r&63):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|r&63):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|r&63);return e};const Ije=(t,e)=>{if(e<65534&&t.subarray&&yre)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r};var Pje=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,a;const s=new Array(r*2);for(a=0,n=0;n<r;){let o=t[n++];if(o<128){s[a++]=o;continue}let l=k2[o];if(l>4){s[a++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|t[n++]&63,l--;if(l>1){s[a++]=65533;continue}o<65536?s[a++]=o:(o-=65536,s[a++]=55296|o>>10&1023,s[a++]=56320|o&1023)}return Ije(s,a)},Tje=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+k2[t[r]]>e?r:e},Wk={string2buf:jje,buf2string:Pje,utf8border:Tje};function Bje(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var kje=Bje;const FC=16209,Fje=16191;var Oje=function(e,r){let n,a,s,o,l,c,d,u,f,A,h,m,p,x,v,y,b,w,I,j,N,S,E,B;const k=e.state;n=e.next_in,E=e.input,a=n+(e.avail_in-5),s=e.next_out,B=e.output,o=s-(r-e.avail_out),l=s+(e.avail_out-257),c=k.dmax,d=k.wsize,u=k.whave,f=k.wnext,A=k.window,h=k.hold,m=k.bits,p=k.lencode,x=k.distcode,v=(1<<k.lenbits)-1,y=(1<<k.distbits)-1;e:do{m<15&&(h+=E[n++]<<m,m+=8,h+=E[n++]<<m,m+=8),b=p[h&v];t:for(;;){if(w=b>>>24,h>>>=w,m-=w,w=b>>>16&255,w===0)B[s++]=b&65535;else if(w&16){I=b&65535,w&=15,w&&(m<w&&(h+=E[n++]<<m,m+=8),I+=h&(1<<w)-1,h>>>=w,m-=w),m<15&&(h+=E[n++]<<m,m+=8,h+=E[n++]<<m,m+=8),b=x[h&y];r:for(;;){if(w=b>>>24,h>>>=w,m-=w,w=b>>>16&255,w&16){if(j=b&65535,w&=15,m<w&&(h+=E[n++]<<m,m+=8,m<w&&(h+=E[n++]<<m,m+=8)),j+=h&(1<<w)-1,j>c){e.msg="invalid distance too far back",k.mode=FC;break e}if(h>>>=w,m-=w,w=s-o,j>w){if(w=j-w,w>u&&k.sane){e.msg="invalid distance too far back",k.mode=FC;break e}if(N=0,S=A,f===0){if(N+=d-w,w<I){I-=w;do B[s++]=A[N++];while(--w);N=s-j,S=B}}else if(f<w){if(N+=d+f-w,w-=f,w<I){I-=w;do B[s++]=A[N++];while(--w);if(N=0,f<I){w=f,I-=w;do B[s++]=A[N++];while(--w);N=s-j,S=B}}}else if(N+=f-w,w<I){I-=w;do B[s++]=A[N++];while(--w);N=s-j,S=B}for(;I>2;)B[s++]=S[N++],B[s++]=S[N++],B[s++]=S[N++],I-=3;I&&(B[s++]=S[N++],I>1&&(B[s++]=S[N++]))}else{N=s-j;do B[s++]=B[N++],B[s++]=B[N++],B[s++]=B[N++],I-=3;while(I>2);I&&(B[s++]=B[N++],I>1&&(B[s++]=B[N++]))}}else if(w&64){e.msg="invalid distance code",k.mode=FC;break e}else{b=x[(b&65535)+(h&(1<<w)-1)];continue r}break}}else if(w&64)if(w&32){k.mode=Fje;break e}else{e.msg="invalid literal/length code",k.mode=FC;break e}else{b=p[(b&65535)+(h&(1<<w)-1)];continue t}break}}while(n<a&&s<l);I=m>>3,n-=I,m-=I<<3,h&=(1<<m)-1,e.next_in=n,e.next_out=s,e.avail_in=n<a?5+(a-n):5-(n-a),e.avail_out=s<l?257+(l-s):257-(s-l),k.hold=h,k.bits=m};const Ax=15,XQ=852,YQ=592,JQ=0,o5=1,ZQ=2,Dje=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Rje=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Mje=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Lje=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Uje=(t,e,r,n,a,s,o,l)=>{const c=l.bits;let d=0,u=0,f=0,A=0,h=0,m=0,p=0,x=0,v=0,y=0,b,w,I,j,N,S=null,E;const B=new Uint16Array(Ax+1),k=new Uint16Array(Ax+1);let T=null,P,q,de;for(d=0;d<=Ax;d++)B[d]=0;for(u=0;u<n;u++)B[e[r+u]]++;for(h=c,A=Ax;A>=1&&B[A]===0;A--);if(h>A&&(h=A),A===0)return a[s++]=1<<24|64<<16|0,a[s++]=1<<24|64<<16|0,l.bits=1,0;for(f=1;f<A&&B[f]===0;f++);for(h<f&&(h=f),x=1,d=1;d<=Ax;d++)if(x<<=1,x-=B[d],x<0)return-1;if(x>0&&(t===JQ||A!==1))return-1;for(k[1]=0,d=1;d<Ax;d++)k[d+1]=k[d]+B[d];for(u=0;u<n;u++)e[r+u]!==0&&(o[k[e[r+u]]++]=u);if(t===JQ?(S=T=o,E=20):t===o5?(S=Dje,T=Rje,E=257):(S=Mje,T=Lje,E=0),y=0,u=0,d=f,N=s,m=h,p=0,I=-1,v=1<<h,j=v-1,t===o5&&v>XQ||t===ZQ&&v>YQ)return 1;for(;;){P=d-p,o[u]+1<E?(q=0,de=o[u]):o[u]>=E?(q=T[o[u]-E],de=S[o[u]-E]):(q=96,de=0),b=1<<d-p,w=1<<m,f=w;do w-=b,a[N+(y>>p)+w]=P<<24|q<<16|de|0;while(w!==0);for(b=1<<d-1;y&b;)b>>=1;if(b!==0?(y&=b-1,y+=b):y=0,u++,--B[d]===0){if(d===A)break;d=e[r+o[u]]}if(d>h&&(y&j)!==I){for(p===0&&(p=h),N+=f,m=d-p,x=1<<m;m+p<A&&(x-=B[m+p],!(x<=0));)m++,x<<=1;if(v+=1<<m,t===o5&&v>XQ||t===ZQ&&v>YQ)return 1;I=y&j,a[I]=h<<24|m<<16|N-s|0}}return y!==0&&(a[N+y]=d-p<<24|64<<16|0),l.bits=h,0};var kb=Uje;const Qje=0,bre=1,wre=2,{Z_FINISH:eV,Z_BLOCK:Vje,Z_TREES:OC,Z_OK:gg,Z_STREAM_END:Hje,Z_NEED_DICT:$je,Z_STREAM_ERROR:Lu,Z_DATA_ERROR:Nre,Z_MEM_ERROR:Cre,Z_BUF_ERROR:Gje,Z_DEFLATED:tV}=xre,fP=16180,rV=16181,nV=16182,aV=16183,sV=16184,iV=16185,oV=16186,lV=16187,cV=16188,dV=16189,US=16190,Bh=16191,l5=16192,uV=16193,c5=16194,fV=16195,hV=16196,AV=16197,mV=16198,DC=16199,RC=16200,pV=16201,gV=16202,xV=16203,vV=16204,yV=16205,d5=16206,bV=16207,wV=16208,ai=16209,_re=16210,Ere=16211,Kje=852,qje=592,zje=15,Wje=zje,NV=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function Xje(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ug=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<fP||e.mode>Ere?1:0},Sre=t=>{if(Ug(t))return Lu;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=fP,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(Kje),e.distcode=e.distdyn=new Int32Array(qje),e.sane=1,e.back=-1,gg},jre=t=>{if(Ug(t))return Lu;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Sre(t)},Ire=(t,e)=>{let r;if(Ug(t))return Lu;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Lu:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,jre(t))},Pre=(t,e)=>{if(!t)return Lu;const r=new Xje;t.state=r,r.strm=t,r.window=null,r.mode=fP;const n=Ire(t,e);return n!==gg&&(t.state=null),n},Yje=t=>Pre(t,Wje);let CV=!0,u5,f5;const Jje=t=>{if(CV){u5=new Int32Array(512),f5=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(kb(bre,t.lens,0,288,u5,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;kb(wre,t.lens,0,32,f5,0,t.work,{bits:5}),CV=!1}t.lencode=u5,t.lenbits=9,t.distcode=f5,t.distbits=5},Tre=(t,e,r,n)=>{let a;const s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(e.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(a=s.wsize-s.wnext,a>n&&(a=n),s.window.set(e.subarray(r-n,r-n+a),s.wnext),n-=a,n?(s.window.set(e.subarray(r-n,r),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0},Zje=(t,e)=>{let r,n,a,s,o,l,c,d,u,f,A,h,m,p,x=0,v,y,b,w,I,j,N,S;const E=new Uint8Array(4);let B,k;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ug(t)||!t.output||!t.input&&t.avail_in!==0)return Lu;r=t.state,r.mode===Bh&&(r.mode=l5),o=t.next_out,a=t.output,c=t.avail_out,s=t.next_in,n=t.input,l=t.avail_in,d=r.hold,u=r.bits,f=l,A=c,S=gg;e:for(;;)switch(r.mode){case fP:if(r.wrap===0){r.mode=l5;break}for(;u<16;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(r.wrap&2&&d===35615){r.wbits===0&&(r.wbits=15),r.check=0,E[0]=d&255,E[1]=d>>>8&255,r.check=Vf(r.check,E,2,0),d=0,u=0,r.mode=rV;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((d&255)<<8)+(d>>8))%31){t.msg="incorrect header check",r.mode=ai;break}if((d&15)!==tV){t.msg="unknown compression method",r.mode=ai;break}if(d>>>=4,u-=4,N=(d&15)+8,r.wbits===0&&(r.wbits=N),N>15||N>r.wbits){t.msg="invalid window size",r.mode=ai;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=d&512?dV:Bh,d=0,u=0;break;case rV:for(;u<16;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(r.flags=d,(r.flags&255)!==tV){t.msg="unknown compression method",r.mode=ai;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=ai;break}r.head&&(r.head.text=d>>8&1),r.flags&512&&r.wrap&4&&(E[0]=d&255,E[1]=d>>>8&255,r.check=Vf(r.check,E,2,0)),d=0,u=0,r.mode=nV;case nV:for(;u<32;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}r.head&&(r.head.time=d),r.flags&512&&r.wrap&4&&(E[0]=d&255,E[1]=d>>>8&255,E[2]=d>>>16&255,E[3]=d>>>24&255,r.check=Vf(r.check,E,4,0)),d=0,u=0,r.mode=aV;case aV:for(;u<16;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}r.head&&(r.head.xflags=d&255,r.head.os=d>>8),r.flags&512&&r.wrap&4&&(E[0]=d&255,E[1]=d>>>8&255,r.check=Vf(r.check,E,2,0)),d=0,u=0,r.mode=sV;case sV:if(r.flags&1024){for(;u<16;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}r.length=d,r.head&&(r.head.extra_len=d),r.flags&512&&r.wrap&4&&(E[0]=d&255,E[1]=d>>>8&255,r.check=Vf(r.check,E,2,0)),d=0,u=0}else r.head&&(r.head.extra=null);r.mode=iV;case iV:if(r.flags&1024&&(h=r.length,h>l&&(h=l),h&&(r.head&&(N=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(s,s+h),N)),r.flags&512&&r.wrap&4&&(r.check=Vf(r.check,n,h,s)),l-=h,s+=h,r.length-=h),r.length))break e;r.length=0,r.mode=oV;case oV:if(r.flags&2048){if(l===0)break e;h=0;do N=n[s+h++],r.head&&N&&r.length<65536&&(r.head.name+=String.fromCharCode(N));while(N&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=Vf(r.check,n,h,s)),l-=h,s+=h,N)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=lV;case lV:if(r.flags&4096){if(l===0)break e;h=0;do N=n[s+h++],r.head&&N&&r.length<65536&&(r.head.comment+=String.fromCharCode(N));while(N&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=Vf(r.check,n,h,s)),l-=h,s+=h,N)break e}else r.head&&(r.head.comment=null);r.mode=cV;case cV:if(r.flags&512){for(;u<16;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(r.wrap&4&&d!==(r.check&65535)){t.msg="header crc mismatch",r.mode=ai;break}d=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Bh;break;case dV:for(;u<32;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}t.adler=r.check=NV(d),d=0,u=0,r.mode=US;case US:if(r.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,r.hold=d,r.bits=u,$je;t.adler=r.check=1,r.mode=Bh;case Bh:if(e===Vje||e===OC)break e;case l5:if(r.last){d>>>=u&7,u-=u&7,r.mode=d5;break}for(;u<3;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}switch(r.last=d&1,d>>>=1,u-=1,d&3){case 0:r.mode=uV;break;case 1:if(Jje(r),r.mode=DC,e===OC){d>>>=2,u-=2;break e}break;case 2:r.mode=hV;break;case 3:t.msg="invalid block type",r.mode=ai}d>>>=2,u-=2;break;case uV:for(d>>>=u&7,u-=u&7;u<32;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if((d&65535)!==(d>>>16^65535)){t.msg="invalid stored block lengths",r.mode=ai;break}if(r.length=d&65535,d=0,u=0,r.mode=c5,e===OC)break e;case c5:r.mode=fV;case fV:if(h=r.length,h){if(h>l&&(h=l),h>c&&(h=c),h===0)break e;a.set(n.subarray(s,s+h),o),l-=h,s+=h,c-=h,o+=h,r.length-=h;break}r.mode=Bh;break;case hV:for(;u<14;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(r.nlen=(d&31)+257,d>>>=5,u-=5,r.ndist=(d&31)+1,d>>>=5,u-=5,r.ncode=(d&15)+4,d>>>=4,u-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=ai;break}r.have=0,r.mode=AV;case AV:for(;r.have<r.ncode;){for(;u<3;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}r.lens[T[r.have++]]=d&7,d>>>=3,u-=3}for(;r.have<19;)r.lens[T[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,B={bits:r.lenbits},S=kb(Qje,r.lens,0,19,r.lencode,0,r.work,B),r.lenbits=B.bits,S){t.msg="invalid code lengths set",r.mode=ai;break}r.have=0,r.mode=mV;case mV:for(;r.have<r.nlen+r.ndist;){for(;x=r.lencode[d&(1<<r.lenbits)-1],v=x>>>24,y=x>>>16&255,b=x&65535,!(v<=u);){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(b<16)d>>>=v,u-=v,r.lens[r.have++]=b;else{if(b===16){for(k=v+2;u<k;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(d>>>=v,u-=v,r.have===0){t.msg="invalid bit length repeat",r.mode=ai;break}N=r.lens[r.have-1],h=3+(d&3),d>>>=2,u-=2}else if(b===17){for(k=v+3;u<k;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}d>>>=v,u-=v,N=0,h=3+(d&7),d>>>=3,u-=3}else{for(k=v+7;u<k;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}d>>>=v,u-=v,N=0,h=11+(d&127),d>>>=7,u-=7}if(r.have+h>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=ai;break}for(;h--;)r.lens[r.have++]=N}}if(r.mode===ai)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=ai;break}if(r.lenbits=9,B={bits:r.lenbits},S=kb(bre,r.lens,0,r.nlen,r.lencode,0,r.work,B),r.lenbits=B.bits,S){t.msg="invalid literal/lengths set",r.mode=ai;break}if(r.distbits=6,r.distcode=r.distdyn,B={bits:r.distbits},S=kb(wre,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,B),r.distbits=B.bits,S){t.msg="invalid distances set",r.mode=ai;break}if(r.mode=DC,e===OC)break e;case DC:r.mode=RC;case RC:if(l>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,r.hold=d,r.bits=u,Oje(t,A),o=t.next_out,a=t.output,c=t.avail_out,s=t.next_in,n=t.input,l=t.avail_in,d=r.hold,u=r.bits,r.mode===Bh&&(r.back=-1);break}for(r.back=0;x=r.lencode[d&(1<<r.lenbits)-1],v=x>>>24,y=x>>>16&255,b=x&65535,!(v<=u);){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(y&&!(y&240)){for(w=v,I=y,j=b;x=r.lencode[j+((d&(1<<w+I)-1)>>w)],v=x>>>24,y=x>>>16&255,b=x&65535,!(w+v<=u);){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}d>>>=w,u-=w,r.back+=w}if(d>>>=v,u-=v,r.back+=v,r.length=b,y===0){r.mode=yV;break}if(y&32){r.back=-1,r.mode=Bh;break}if(y&64){t.msg="invalid literal/length code",r.mode=ai;break}r.extra=y&15,r.mode=pV;case pV:if(r.extra){for(k=r.extra;u<k;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}r.length+=d&(1<<r.extra)-1,d>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=gV;case gV:for(;x=r.distcode[d&(1<<r.distbits)-1],v=x>>>24,y=x>>>16&255,b=x&65535,!(v<=u);){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(!(y&240)){for(w=v,I=y,j=b;x=r.distcode[j+((d&(1<<w+I)-1)>>w)],v=x>>>24,y=x>>>16&255,b=x&65535,!(w+v<=u);){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}d>>>=w,u-=w,r.back+=w}if(d>>>=v,u-=v,r.back+=v,y&64){t.msg="invalid distance code",r.mode=ai;break}r.offset=b,r.extra=y&15,r.mode=xV;case xV:if(r.extra){for(k=r.extra;u<k;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}r.offset+=d&(1<<r.extra)-1,d>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=ai;break}r.mode=vV;case vV:if(c===0)break e;if(h=A-c,r.offset>h){if(h=r.offset-h,h>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=ai;break}h>r.wnext?(h-=r.wnext,m=r.wsize-h):m=r.wnext-h,h>r.length&&(h=r.length),p=r.window}else p=a,m=o-r.offset,h=r.length;h>c&&(h=c),c-=h,r.length-=h;do a[o++]=p[m++];while(--h);r.length===0&&(r.mode=RC);break;case yV:if(c===0)break e;a[o++]=r.length,c--,r.mode=RC;break;case d5:if(r.wrap){for(;u<32;){if(l===0)break e;l--,d|=n[s++]<<u,u+=8}if(A-=c,t.total_out+=A,r.total+=A,r.wrap&4&&A&&(t.adler=r.check=r.flags?Vf(r.check,a,A,o-A):qk(r.check,a,A,o-A)),A=c,r.wrap&4&&(r.flags?d:NV(d))!==r.check){t.msg="incorrect data check",r.mode=ai;break}d=0,u=0}r.mode=bV;case bV:if(r.wrap&&r.flags){for(;u<32;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(r.wrap&4&&d!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=ai;break}d=0,u=0}r.mode=wV;case wV:S=Hje;break e;case ai:S=Nre;break e;case _re:return Cre;case Ere:default:return Lu}return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,r.hold=d,r.bits=u,(r.wsize||A!==t.avail_out&&r.mode<ai&&(r.mode<d5||e!==eV))&&Tre(t,t.output,t.next_out,A-t.avail_out),f-=t.avail_in,A-=t.avail_out,t.total_in+=f,t.total_out+=A,r.total+=A,r.wrap&4&&A&&(t.adler=r.check=r.flags?Vf(r.check,a,A,t.next_out-A):qk(r.check,a,A,t.next_out-A)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Bh?128:0)+(r.mode===DC||r.mode===c5?256:0),(f===0&&A===0||e===eV)&&S===gg&&(S=Gje),S},eIe=t=>{if(Ug(t))return Lu;let e=t.state;return e.window&&(e.window=null),t.state=null,gg},tIe=(t,e)=>{if(Ug(t))return Lu;const r=t.state;return r.wrap&2?(r.head=e,e.done=!1,gg):Lu},rIe=(t,e)=>{const r=e.length;let n,a,s;return Ug(t)||(n=t.state,n.wrap!==0&&n.mode!==US)?Lu:n.mode===US&&(a=1,a=qk(a,e,r,0),a!==n.check)?Nre:(s=Tre(t,e,r,r),s?(n.mode=_re,Cre):(n.havedict=1,gg))};var nIe=jre,aIe=Ire,sIe=Sre,iIe=Yje,oIe=Pre,lIe=Zje,cIe=eIe,dIe=tIe,uIe=rIe,fIe="pako inflate (from Nodeca project)",$h={inflateReset:nIe,inflateReset2:aIe,inflateResetKeep:sIe,inflateInit:iIe,inflateInit2:oIe,inflate:lIe,inflateEnd:cIe,inflateGetHeader:dIe,inflateSetDictionary:uIe,inflateInfo:fIe};function hIe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var AIe=hIe;const Bre=Object.prototype.toString,{Z_NO_FLUSH:mIe,Z_FINISH:pIe,Z_OK:F2,Z_STREAM_END:h5,Z_NEED_DICT:A5,Z_STREAM_ERROR:gIe,Z_DATA_ERROR:_V,Z_MEM_ERROR:xIe}=xre;function Qw(t){this.options=vre.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new kje,this.strm.avail_out=0;let r=$h.inflateInit2(this.strm,e.windowBits);if(r!==F2)throw new Error(zk[r]);if(this.header=new AIe,$h.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Wk.string2buf(e.dictionary):Bre.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=$h.inflateSetDictionary(this.strm,e.dictionary),r!==F2)))throw new Error(zk[r])}Qw.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,a=this.options.dictionary;let s,o,l;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?pIe:mIe,Bre.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),s=$h.inflate(r,o),s===A5&&a&&(s=$h.inflateSetDictionary(r,a),s===F2?s=$h.inflate(r,o):s===_V&&(s=A5));r.avail_in>0&&s===h5&&r.state.wrap>0&&t[r.next_in]!==0;)$h.inflateReset(r),s=$h.inflate(r,o);switch(s){case gIe:case _V:case A5:case xIe:return this.onEnd(s),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||s===h5))if(this.options.to==="string"){let c=Wk.utf8border(r.output,r.next_out),d=r.next_out-c,u=Wk.buf2string(r.output,c);r.next_out=d,r.avail_out=n-d,d&&r.output.set(r.output.subarray(c,c+d),0),this.onData(u)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===F2&&l===0)){if(s===h5)return s=$h.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Qw.prototype.onData=function(t){this.chunks.push(t)};Qw.prototype.onEnd=function(t){t===F2&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=vre.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function vIe(t,e){const r=new Qw(e);if(r.push(t),r.err)throw r.msg||zk[r.err];return r.result}var yIe=Qw,bIe=vIe,wIe={Inflate:yIe,inflate:bIe};const{Inflate:NIe,inflate:CIe}=wIe;var EV=NIe,_Ie=CIe;const kre=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;kre[t]=e}const SV=4294967295;function EIe(t,e,r){let n=t;for(let a=0;a<r;a++)n=kre[(n^e[a])&255]^n>>>8;return n}function SIe(t,e){return(EIe(SV,t,e)^SV)>>>0}function jV(t,e,r){const n=t.readUint32(),a=SIe(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(a!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${a}`)}function Fre(t,e,r){for(let n=0;n<r;n++)e[n]=t[n]}function Ore(t,e,r,n){let a=0;for(;a<n;a++)e[a]=t[a];for(;a<r;a++)e[a]=t[a]+e[a-n]&255}function Dre(t,e,r,n){let a=0;if(r.length===0)for(;a<n;a++)e[a]=t[a];else for(;a<n;a++)e[a]=t[a]+r[a]&255}function Rre(t,e,r,n,a){let s=0;if(r.length===0){for(;s<a;s++)e[s]=t[s];for(;s<n;s++)e[s]=t[s]+(e[s-a]>>1)&255}else{for(;s<a;s++)e[s]=t[s]+(r[s]>>1)&255;for(;s<n;s++)e[s]=t[s]+(e[s-a]+r[s]>>1)&255}}function Mre(t,e,r,n,a){let s=0;if(r.length===0){for(;s<a;s++)e[s]=t[s];for(;s<n;s++)e[s]=t[s]+e[s-a]&255}else{for(;s<a;s++)e[s]=t[s]+r[s]&255;for(;s<n;s++)e[s]=t[s]+jIe(e[s-a],r[s],r[s-a])&255}}function jIe(t,e,r){const n=t+e-r,a=Math.abs(n-t),s=Math.abs(n-e),o=Math.abs(n-r);return a<=s&&a<=o?t:s<=o?e:r}function IIe(t,e,r,n,a,s){switch(t){case 0:Fre(e,r,a);break;case 1:Ore(e,r,a,s);break;case 2:Dre(e,r,n,a);break;case 3:Rre(e,r,n,a,s);break;case 4:Mre(e,r,n,a,s);break;default:throw new Error(`Unsupported filter: ${t}`)}}const PIe=new Uint16Array([255]),TIe=new Uint8Array(PIe.buffer),BIe=TIe[0]===255;function kIe(t){const{data:e,width:r,height:n,channels:a,depth:s}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(s/8)*a,c=new Uint8Array(n*r*l);let d=0;for(let u=0;u<7;u++){const f=o[u],A=Math.ceil((r-f.x)/f.xStep),h=Math.ceil((n-f.y)/f.yStep);if(A<=0||h<=0)continue;const m=A*l,p=new Uint8Array(m);for(let x=0;x<h;x++){const v=e[d++],y=e.subarray(d,d+m);d+=m;const b=new Uint8Array(m);IIe(v,y,b,p,m,l),p.set(b);for(let w=0;w<A;w++){const I=f.x+w*f.xStep,j=f.y+x*f.yStep;if(!(I>=r||j>=n))for(let N=0;N<l;N++)c[(j*r+I)*l+N]=b[w*l+N]}}}if(s===16){const u=new Uint16Array(c.buffer);if(BIe)for(let f=0;f<u.length;f++)u[f]=FIe(u[f]);return u}else return c}function FIe(t){return(t&255)<<8|t>>8&255}const OIe=new Uint16Array([255]),DIe=new Uint8Array(OIe.buffer),RIe=DIe[0]===255,MIe=new Uint8Array(0);function IV(t){const{data:e,width:r,height:n,channels:a,depth:s}=t,o=Math.ceil(s/8)*a,l=Math.ceil(s/8*a*r),c=new Uint8Array(n*l);let d=MIe,u=0,f,A;for(let h=0;h<n;h++){switch(f=e.subarray(u+1,u+1+l),A=c.subarray(h*l,(h+1)*l),e[u]){case 0:Fre(f,A,l);break;case 1:Ore(f,A,l,o);break;case 2:Dre(f,A,d,l);break;case 3:Rre(f,A,d,l,o);break;case 4:Mre(f,A,d,l,o);break;default:throw new Error(`Unsupported filter: ${e[u]}`)}d=A,u+=l+1}if(s===16){const h=new Uint16Array(c.buffer);if(RIe)for(let m=0;m<h.length;m++)h[m]=LIe(h[m]);return h}else return c}function LIe(t){return(t&255)<<8|t>>8&255}const wE=Uint8Array.of(137,80,78,71,13,10,26,10);function PV(t){if(!UIe(t.readBytes(wE.length)))throw new Error("wrong PNG signature")}function UIe(t){if(t.length<wE.length)return!1;for(let e=0;e<wE.length;e++)if(t[e]!==wE[e])return!1;return!0}const QIe="tEXt",VIe=0,Lre=new TextDecoder("latin1");function HIe(t){if(GIe(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const $Ie=/^[\u0000-\u00FF]*$/;function GIe(t){if(!$Ie.test(t))throw new Error("invalid latin1 text")}function KIe(t,e,r){const n=Ure(e);t[n]=qIe(e,r-n.length-1)}function Ure(t){for(t.mark();t.readByte()!==VIe;);const e=t.offset;t.reset();const r=Lre.decode(t.readBytes(e-t.offset-1));return t.skip(1),HIe(r),r}function qIe(t,e){return Lre.decode(t.readBytes(e))}const jd={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},m5={UNKNOWN:-1,DEFLATE:0},TV={UNKNOWN:-1,ADAPTIVE:0},p5={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},MC={NONE:0,BACKGROUND:1,PREVIOUS:2},g5={SOURCE:0,OVER:1};class zIe extends aR{constructor(r,n={}){super(r);Rr(this,"_checkCrc");Rr(this,"_inflator");Rr(this,"_png");Rr(this,"_apng");Rr(this,"_end");Rr(this,"_hasPalette");Rr(this,"_palette");Rr(this,"_hasTransparency");Rr(this,"_transparency");Rr(this,"_compressionMethod");Rr(this,"_filterMethod");Rr(this,"_interlaceMethod");Rr(this,"_colorType");Rr(this,"_isAnimated");Rr(this,"_numberOfFrames");Rr(this,"_numberOfPlays");Rr(this,"_frames");Rr(this,"_writingDataChunks");const{checkCrc:a=!1}=n;this._checkCrc=a,this._inflator=new EV,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=m5.UNKNOWN,this._filterMethod=TV.UNKNOWN,this._interlaceMethod=p5.UNKNOWN,this._colorType=jd.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(PV(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(PV(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const a=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case QIe:KIe(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?jV(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const a=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=a+r;break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?jV(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=WIe(this.readUint8());const n=this.readUint8();this._colorType=n;let a;switch(n){case jd.GREYSCALE:a=1;break;case jd.TRUECOLOUR:a=3;break;case jd.INDEXED_COLOUR:a=1;break;case jd.GREYSCALE_ALPHA:a=2;break;case jd.TRUECOLOUR_ALPHA:a=4;break;case jd.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==m5.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const a=[];this._palette=a;for(let s=0;s<n;s++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,a=this.offset+this.byteOffset;if(a+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case jd.GREYSCALE:case jd.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case jd.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const a=this.readByte();this._palette[n].push(a)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case jd.UNKNOWN:case jd.GREYSCALE_ALPHA:case jd.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=Ure(this),a=this.readUint8();if(a!==m5.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const s=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:_Ie(s)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),a=this.readByte();this._png.resolution={x:r,y:n,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(r);if(a){if(a.data=IV({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)n.data=a.data;else{const s=this._apng.frames.at(r-1);this.disposeFrame(a,s,n),this.addFrameDataToCanvas(n,a)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,a){switch(r.disposeOp){case MC.NONE:break;case MC.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const l=(s*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)a.data[l+c]=0}break;case MC.PREVIOUS:a.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const a=1<<this._png.depth,s=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,d=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:d}};switch(n.blendOp){case g5.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:d}=s(o,l);for(let u=0;u<this._png.channels;u++)r.data[c+u]=n.data[d+u]}break;case g5.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:d}=s(o,l);for(let u=0;u<this._png.channels;u++){const f=n.data[d+this._png.channels-1]/a,A=u%(this._png.channels-1)===0?1:n.data[d+u],h=Math.floor(f*A+(1-f)*r.data[c+u]);r.data[c+u]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==TV.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===p5.NO_INTERLACE)this._png.data=IV({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===p5.ADAM7)this._png.data=kIe({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:MC.NONE,blendOp:g5.SOURCE,data:r}),this._inflator=new EV,this._writingDataChunks=!1}}function WIe(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var BV;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(BV||(BV={}));function XIe(t,e){return new zIe(t,e).decode()}var Yn=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function x5(){Yn.console&&typeof Yn.console.log=="function"&&Yn.console.log.apply(Yn.console,arguments)}var Is={log:x5,warn:function(t){Yn.console&&(typeof Yn.console.warn=="function"?Yn.console.warn.apply(Yn.console,arguments):x5.call(null,arguments))},error:function(t){Yn.console&&(typeof Yn.console.error=="function"?Yn.console.error.apply(Yn.console,arguments):x5(t))}};function v5(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){mp(n.response,e,r)},n.onerror=function(){Is.error("could not download file")},n.send()}function kV(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function LC(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var mp=Yn.saveAs||((typeof window>"u"?"undefined":ms(window))!=="object"||window!==Yn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=Yn.URL||Yn.webkitURL,a=document.createElement("a");e=e||t.name||"download",a.download=e,a.rel="noopener",typeof t=="string"?(a.href=t,a.origin!==location.origin?kV(a.href)?v5(t,e,r):LC(a,a.target="_blank"):LC(a)):(a.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){LC(a)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(kV(t))v5(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){LC(n)})}else navigator.msSaveOrOpenBlob(function(a,s){return s===void 0?s={autoBom:!1}:ms(s)!=="object"&&(Is.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return v5(t,e,r);var a=t.type==="application/octet-stream",s=/constructor/i.test(Yn.HTMLElement)||Yn.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||a&&s)&&(typeof FileReader>"u"?"undefined":ms(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var u=l.result;u=o?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},l.readAsDataURL(t)}else{var c=Yn.URL||Yn.webkitURL,d=c.createObjectURL(t);n?n.location=d:location.href=d,n=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Qre(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,s=r[n].process,o=a.exec(t);o&&(e=s(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),"#"+l+c+d}}var NE=Yn.atob.bind(Yn),FV=Yn.btoa.bind(Yn);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function y5(t,e){var r=t[0],n=t[1],a=t[2],s=t[3];r=Jl(r,n,a,s,e[0],7,-680876936),s=Jl(s,r,n,a,e[1],12,-389564586),a=Jl(a,s,r,n,e[2],17,606105819),n=Jl(n,a,s,r,e[3],22,-1044525330),r=Jl(r,n,a,s,e[4],7,-176418897),s=Jl(s,r,n,a,e[5],12,1200080426),a=Jl(a,s,r,n,e[6],17,-1473231341),n=Jl(n,a,s,r,e[7],22,-45705983),r=Jl(r,n,a,s,e[8],7,1770035416),s=Jl(s,r,n,a,e[9],12,-1958414417),a=Jl(a,s,r,n,e[10],17,-42063),n=Jl(n,a,s,r,e[11],22,-1990404162),r=Jl(r,n,a,s,e[12],7,1804603682),s=Jl(s,r,n,a,e[13],12,-40341101),a=Jl(a,s,r,n,e[14],17,-1502002290),r=Zl(r,n=Jl(n,a,s,r,e[15],22,1236535329),a,s,e[1],5,-165796510),s=Zl(s,r,n,a,e[6],9,-1069501632),a=Zl(a,s,r,n,e[11],14,643717713),n=Zl(n,a,s,r,e[0],20,-373897302),r=Zl(r,n,a,s,e[5],5,-701558691),s=Zl(s,r,n,a,e[10],9,38016083),a=Zl(a,s,r,n,e[15],14,-660478335),n=Zl(n,a,s,r,e[4],20,-405537848),r=Zl(r,n,a,s,e[9],5,568446438),s=Zl(s,r,n,a,e[14],9,-1019803690),a=Zl(a,s,r,n,e[3],14,-187363961),n=Zl(n,a,s,r,e[8],20,1163531501),r=Zl(r,n,a,s,e[13],5,-1444681467),s=Zl(s,r,n,a,e[2],9,-51403784),a=Zl(a,s,r,n,e[7],14,1735328473),r=ec(r,n=Zl(n,a,s,r,e[12],20,-1926607734),a,s,e[5],4,-378558),s=ec(s,r,n,a,e[8],11,-2022574463),a=ec(a,s,r,n,e[11],16,1839030562),n=ec(n,a,s,r,e[14],23,-35309556),r=ec(r,n,a,s,e[1],4,-1530992060),s=ec(s,r,n,a,e[4],11,1272893353),a=ec(a,s,r,n,e[7],16,-155497632),n=ec(n,a,s,r,e[10],23,-1094730640),r=ec(r,n,a,s,e[13],4,681279174),s=ec(s,r,n,a,e[0],11,-358537222),a=ec(a,s,r,n,e[3],16,-722521979),n=ec(n,a,s,r,e[6],23,76029189),r=ec(r,n,a,s,e[9],4,-640364487),s=ec(s,r,n,a,e[12],11,-421815835),a=ec(a,s,r,n,e[15],16,530742520),r=tc(r,n=ec(n,a,s,r,e[2],23,-995338651),a,s,e[0],6,-198630844),s=tc(s,r,n,a,e[7],10,1126891415),a=tc(a,s,r,n,e[14],15,-1416354905),n=tc(n,a,s,r,e[5],21,-57434055),r=tc(r,n,a,s,e[12],6,1700485571),s=tc(s,r,n,a,e[3],10,-1894986606),a=tc(a,s,r,n,e[10],15,-1051523),n=tc(n,a,s,r,e[1],21,-2054922799),r=tc(r,n,a,s,e[8],6,1873313359),s=tc(s,r,n,a,e[15],10,-30611744),a=tc(a,s,r,n,e[6],15,-1560198380),n=tc(n,a,s,r,e[13],21,1309151649),r=tc(r,n,a,s,e[4],6,-145523070),s=tc(s,r,n,a,e[11],10,-1120210379),a=tc(a,s,r,n,e[2],15,718787259),n=tc(n,a,s,r,e[9],21,-343485551),t[0]=J0(r,t[0]),t[1]=J0(n,t[1]),t[2]=J0(a,t[2]),t[3]=J0(s,t[3])}function hP(t,e,r,n,a,s){return e=J0(J0(e,t),J0(n,s)),J0(e<<a|e>>>32-a,r)}function Jl(t,e,r,n,a,s,o){return hP(e&r|~e&n,t,e,a,s,o)}function Zl(t,e,r,n,a,s,o){return hP(e&n|r&~n,t,e,a,s,o)}function ec(t,e,r,n,a,s,o){return hP(e^r^n,t,e,a,s,o)}function tc(t,e,r,n,a,s,o){return hP(r^(e|~n),t,e,a,s,o)}function Vre(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)y5(n,YIe(t.substring(e-64,e)));t=t.substring(e-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)a[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(a[e>>2]|=128<<(e%4<<3),e>55)for(y5(n,a),e=0;e<16;e++)a[e]=0;return a[14]=8*r,y5(n,a),n}function YIe(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var OV="0123456789abcdef".split("");function JIe(t){for(var e="",r=0;r<4;r++)e+=OV[t>>8*r+4&15]+OV[t>>8*r&15];return e}function ZIe(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Xk(t){return Vre(t).map(ZIe).join("")}var ePe=function(t){for(var e=0;e<t.length;e++)t[e]=JIe(t[e]);return t.join("")}(Vre("hello"))!="5d41402abc4b2a76b9719d911017c592";function J0(t,e){if(ePe){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Yk(t,e){var r,n,a,s;if(t!==r){for(var o=(a=t,s=1+(256/t.length|0),new Array(s+1).join(a)),l=[],c=0;c<256;c++)l[c]=c;var d=0;for(c=0;c<256;c++){var u=l[c];d=(d+u+o.charCodeAt(c))%256,l[c]=l[d],l[d]=u}r=t,n=l}else l=n;var f=e.length,A=0,h=0,m="";for(c=0;c<f;c++)h=(h+(u=l[A=(A+1)%256]))%256,l[A]=l[h],l[h]=u,o=l[(l[A]+l[h])%256],m+=String.fromCharCode(e.charCodeAt(c)^o);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var DV={print:4,modify:8,copy:16,"annot-forms":32};function Ox(t,e,r,n){this.v=1,this.r=2;var a=192;t.forEach(function(l){if(DV.perm!==void 0)throw new Error("Invalid permission: "+l);a+=DV[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(e+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^a)),this.encryptionKey=Xk(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Yk(this.encryptionKey,this.padding)}function Dx(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var a=t.charCodeAt(n);e+=a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?"#"+("0"+a.toString(16)).slice(-2):t[n]}return e}function RV(t){if(ms(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var s=Math.random().toString(35);return e[r][s]=[n,!!a],s},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var s in e[r]){var o=e[r][s];try{o[0].apply(t,n)}catch(l){Yn.console&&Is.error("jsPDF PubSub Error",l.message,l)}o[1]&&a.push(s)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function O2(t){if(!(this instanceof O2))return new O2(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function Hre(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function H0(t,e,r,n,a){if(!(this instanceof H0))return new H0(t,e,r,n,a);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,Hre.call(this,n,a)}function Tp(t,e,r,n,a){if(!(this instanceof Tp))return new Tp(t,e,r,n,a);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,Hre.call(this,n,a)}function An(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],s=arguments[3],o=[],l=1,c=16,d="S",u=null;ms(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,a=t.format||a,s=t.compress||t.compressPdf||s,(u=t.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),d=t.defaultPathOperation||"S"),o=t.filters||(s===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=t.putOnlyUsedFonts||!1,A={},h={internal:{},__private__:{}};h.__private__.PubSub=RV;var m="1.3",p=h.__private__.getPdfVersion=function(){return m};h.__private__.setPdfVersion=function(U){m=U};var x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return x};var v=h.__private__.getPageFormat=function(U){return x[U]};a=a||"a4";var y="compat",b="advanced",w=y;function I(){this.saveGraphicsState(),Z(new Oe(dt,0,0,-dt,0,ea()*dt).toString()+" cm"),this.setFontSize(this.getFontSize()/dt),d="n",w=b}function j(){this.restoreGraphicsState(),d="S",w=y}var N=h.__private__.combineFontStyleAndFontWeight=function(U,_e){if(U=="bold"&&_e=="normal"||U=="bold"&&_e==400||U=="normal"&&_e=="italic"||U=="bold"&&_e=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return _e&&(U=_e==400||_e==="normal"?U==="italic"?"italic":"normal":_e!=700&&_e!=="bold"||U!=="normal"?(_e==700?"bold":_e)+""+U:"bold"),U};h.advancedAPI=function(U){var _e=w===y;return _e&&I.call(this),typeof U!="function"||(U(this),_e&&j.call(this)),this},h.compatAPI=function(U){var _e=w===b;return _e&&j.call(this),typeof U!="function"||(U(this),_e&&I.call(this)),this},h.isAdvancedAPI=function(){return w===b};var S,E=function(U){if(w!==b)throw new Error(U+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},B=h.roundToPrecision=h.__private__.roundToPrecision=function(U,_e){var it=e||_e;if(isNaN(U)||isNaN(it))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return U.toFixed(it).replace(/0+$/,"")};S=h.hpf=h.__private__.hpf=typeof c=="number"?function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.hpf");return B(U,c)}:c==="smart"?function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.hpf");return B(U,U>-1&&U<1?16:5)}:function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.hpf");return B(U,16)};var k=h.f2=h.__private__.f2=function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.f2");return B(U,2)},T=h.__private__.f3=function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.f3");return B(U,3)},P=h.scale=h.__private__.scale=function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.scale");return w===y?U*dt:w===b?U:void 0},q=function(U){return P(function(_e){return w===y?ea()-_e:w===b?_e:void 0}(U))};h.__private__.setPrecision=h.setPrecision=function(U){typeof parseInt(U,10)=="number"&&(e=parseInt(U,10))};var de,ce="00000000000000000000000000000000",le=h.__private__.getFileId=function(){return ce},he=h.__private__.setFileId=function(U){return ce=U!==void 0&&/^[a-fA-F0-9]{32}$/.test(U)?U.toUpperCase():ce.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(Fr=new Ox(u.userPermissions,u.userPassword,u.ownerPassword,ce)),ce};h.setFileId=function(U){return he(U),this},h.getFileId=function(){return le()};var ae=h.__private__.convertDateToPDFDate=function(U){var _e=U.getTimezoneOffset(),it=_e<0?"+":"-",bt=Math.floor(Math.abs(_e/60)),Qt=Math.abs(_e%60),cr=[it,G(bt),"'",G(Qt),"'"].join("");return["D:",U.getFullYear(),G(U.getMonth()+1),G(U.getDate()),G(U.getHours()),G(U.getMinutes()),G(U.getSeconds()),cr].join("")},Ce=h.__private__.convertPDFDateToDate=function(U){var _e=parseInt(U.substr(2,4),10),it=parseInt(U.substr(6,2),10)-1,bt=parseInt(U.substr(8,2),10),Qt=parseInt(U.substr(10,2),10),cr=parseInt(U.substr(12,2),10),jr=parseInt(U.substr(14,2),10);return new Date(_e,it,bt,Qt,cr,jr,0)},De=h.__private__.setCreationDate=function(U){var _e;if(U===void 0&&(U=new Date),U instanceof Date)_e=ae(U);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(U))throw new Error("Invalid argument passed to jsPDF.setCreationDate");_e=U}return de=_e},O=h.__private__.getCreationDate=function(U){var _e=de;return U==="jsDate"&&(_e=Ce(de)),_e};h.setCreationDate=function(U){return De(U),this},h.getCreationDate=function(U){return O(U)};var R,G=h.__private__.padd2=function(U){return("0"+parseInt(U)).slice(-2)},M=h.__private__.padd2Hex=function(U){return("00"+(U=U.toString())).substr(U.length)},K=0,Y=[],D=[],V=0,te=[],ve=[],Q=!1,Xe=D;h.__private__.setCustomOutputDestination=function(U){Q=!0,Xe=U};var se=function(U){Q||(Xe=U)};h.__private__.resetCustomOutputDestination=function(){Q=!1,Xe=D};var Z=h.__private__.out=function(U){return U=U.toString(),V+=U.length+1,Xe.push(U),Xe},ke=h.__private__.write=function(U){return Z(arguments.length===1?U.toString():Array.prototype.join.call(arguments," "))},Se=h.__private__.getArrayBuffer=function(U){for(var _e=U.length,it=new ArrayBuffer(_e),bt=new Uint8Array(it);_e--;)bt[_e]=U.charCodeAt(_e);return it},Ee=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return Ee};var Ze=t.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(U){return Ze=w===b?U/dt:U,this};var ot,vt=h.__private__.getFontSize=h.getFontSize=function(){return w===y?Ze:Ze*dt},_t=t.R2L||!1;h.__private__.setR2L=h.setR2L=function(U){return _t=U,this},h.__private__.getR2L=h.getR2L=function(){return _t};var Tt,Lt=h.__private__.setZoomMode=function(U){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(U))ot=U;else if(isNaN(U)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(U)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+U+'" is not recognized.');ot=U}else ot=parseInt(U,10)};h.__private__.getZoomMode=function(){return ot};var Rt,Et=h.__private__.setPageMode=function(U){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(U)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+U+'" is not recognized.');Tt=U};h.__private__.getPageMode=function(){return Tt};var Re=h.__private__.setLayoutMode=function(U){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(U)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+U+'" is not recognized.');Rt=U};h.__private__.getLayoutMode=function(){return Rt},h.__private__.setDisplayMode=h.setDisplayMode=function(U,_e,it){return Lt(U),Re(_e),Et(it),this};var Te={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(U){if(Object.keys(Te).indexOf(U)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Te[U]},h.__private__.getDocumentProperties=function(){return Te},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(U){for(var _e in Te)Te.hasOwnProperty(_e)&&U[_e]&&(Te[_e]=U[_e]);return this},h.__private__.setDocumentProperty=function(U,_e){if(Object.keys(Te).indexOf(U)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Te[U]=_e};var Ye,dt,Fe,je,We,ee={},Ve={},rt=[],$e={},ie={},pe={},fe={},Me=null,me=0,ye=[],mt=new RV(h),gt=t.hotfixes||[],yt={},Pt={},Ft=[],Oe=function U(_e,it,bt,Qt,cr,jr){if(!(this instanceof U))return new U(_e,it,bt,Qt,cr,jr);isNaN(_e)&&(_e=1),isNaN(it)&&(it=0),isNaN(bt)&&(bt=0),isNaN(Qt)&&(Qt=1),isNaN(cr)&&(cr=0),isNaN(jr)&&(jr=0),this._matrix=[_e,it,bt,Qt,cr,jr]};Object.defineProperty(Oe.prototype,"sx",{get:function(){return this._matrix[0]},set:function(U){this._matrix[0]=U}}),Object.defineProperty(Oe.prototype,"shy",{get:function(){return this._matrix[1]},set:function(U){this._matrix[1]=U}}),Object.defineProperty(Oe.prototype,"shx",{get:function(){return this._matrix[2]},set:function(U){this._matrix[2]=U}}),Object.defineProperty(Oe.prototype,"sy",{get:function(){return this._matrix[3]},set:function(U){this._matrix[3]=U}}),Object.defineProperty(Oe.prototype,"tx",{get:function(){return this._matrix[4]},set:function(U){this._matrix[4]=U}}),Object.defineProperty(Oe.prototype,"ty",{get:function(){return this._matrix[5]},set:function(U){this._matrix[5]=U}}),Object.defineProperty(Oe.prototype,"a",{get:function(){return this._matrix[0]},set:function(U){this._matrix[0]=U}}),Object.defineProperty(Oe.prototype,"b",{get:function(){return this._matrix[1]},set:function(U){this._matrix[1]=U}}),Object.defineProperty(Oe.prototype,"c",{get:function(){return this._matrix[2]},set:function(U){this._matrix[2]=U}}),Object.defineProperty(Oe.prototype,"d",{get:function(){return this._matrix[3]},set:function(U){this._matrix[3]=U}}),Object.defineProperty(Oe.prototype,"e",{get:function(){return this._matrix[4]},set:function(U){this._matrix[4]=U}}),Object.defineProperty(Oe.prototype,"f",{get:function(){return this._matrix[5]},set:function(U){this._matrix[5]=U}}),Object.defineProperty(Oe.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Oe.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Oe.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Oe.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Oe.prototype.join=function(U){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(S).join(U)},Oe.prototype.multiply=function(U){var _e=U.sx*this.sx+U.shy*this.shx,it=U.sx*this.shy+U.shy*this.sy,bt=U.shx*this.sx+U.sy*this.shx,Qt=U.shx*this.shy+U.sy*this.sy,cr=U.tx*this.sx+U.ty*this.shx+this.tx,jr=U.tx*this.shy+U.ty*this.sy+this.ty;return new Oe(_e,it,bt,Qt,cr,jr)},Oe.prototype.decompose=function(){var U=this.sx,_e=this.shy,it=this.shx,bt=this.sy,Qt=this.tx,cr=this.ty,jr=Math.sqrt(U*U+_e*_e),fn=(U/=jr)*it+(_e/=jr)*bt;it-=U*fn,bt-=_e*fn;var bn=Math.sqrt(it*it+bt*bt);return fn/=bn,U*(bt/=bn)<_e*(it/=bn)&&(U=-U,_e=-_e,fn=-fn,jr=-jr),{scale:new Oe(jr,0,0,bn,0,0),translate:new Oe(1,0,0,1,Qt,cr),rotate:new Oe(U,_e,-_e,U,0,0),skew:new Oe(1,0,fn,1,0,0)}},Oe.prototype.toString=function(U){return this.join(" ")},Oe.prototype.inversed=function(){var U=this.sx,_e=this.shy,it=this.shx,bt=this.sy,Qt=this.tx,cr=this.ty,jr=1/(U*bt-_e*it),fn=bt*jr,bn=-_e*jr,Un=-it*jr,Xn=U*jr;return new Oe(fn,bn,Un,Xn,-fn*Qt-Un*cr,-bn*Qt-Xn*cr)},Oe.prototype.applyToPoint=function(U){var _e=U.x*this.sx+U.y*this.shx+this.tx,it=U.x*this.shy+U.y*this.sy+this.ty;return new Pr(_e,it)},Oe.prototype.applyToRectangle=function(U){var _e=this.applyToPoint(U),it=this.applyToPoint(new Pr(U.x+U.w,U.y+U.h));return new Gr(_e.x,_e.y,it.x-_e.x,it.y-_e.y)},Oe.prototype.clone=function(){var U=this.sx,_e=this.shy,it=this.shx,bt=this.sy,Qt=this.tx,cr=this.ty;return new Oe(U,_e,it,bt,Qt,cr)},h.Matrix=Oe;var be=h.matrixMult=function(U,_e){return _e.multiply(U)},Ae=new Oe(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=Ae;var Le=function(U,_e){if(!ie[U]){var it=(_e instanceof H0?"Sh":"P")+(Object.keys($e).length+1).toString(10);_e.id=it,ie[U]=it,$e[it]=_e,mt.publish("addPattern",_e)}};h.ShadingPattern=H0,h.TilingPattern=Tp,h.addShadingPattern=function(U,_e){return E("addShadingPattern()"),Le(U,_e),this},h.beginTilingPattern=function(U){E("beginTilingPattern()"),Nn(U.boundingBox[0],U.boundingBox[1],U.boundingBox[2]-U.boundingBox[0],U.boundingBox[3]-U.boundingBox[1],U.matrix)},h.endTilingPattern=function(U,_e){E("endTilingPattern()"),_e.stream=ve[R].join(`
`),Le(U,_e),mt.publish("endTilingPattern",_e),Ft.pop().restore()};var ut,ct=h.__private__.newObject=function(){var U=st();return z(U,!0),U},st=h.__private__.newObjectDeferred=function(){return K++,Y[K]=function(){return V},K},z=function(U,_e){return _e=typeof _e=="boolean"&&_e,Y[U]=V,_e&&Z(U+" 0 obj"),U},X=h.__private__.newAdditionalObject=function(){var U={objId:st(),content:""};return te.push(U),U},re=st(),H=st(),L=h.__private__.decodeColorString=function(U){var _e=U.split(" ");if(_e.length!==2||_e[1]!=="g"&&_e[1]!=="G")_e.length!==5||_e[4]!=="k"&&_e[4]!=="K"||(_e=[(1-_e[0])*(1-_e[3]),(1-_e[1])*(1-_e[3]),(1-_e[2])*(1-_e[3]),"r"]);else{var it=parseFloat(_e[0]);_e=[it,it,it,"r"]}for(var bt="#",Qt=0;Qt<3;Qt++)bt+=("0"+Math.floor(255*parseFloat(_e[Qt])).toString(16)).slice(-2);return bt},ue=h.__private__.encodeColorString=function(U){var _e;typeof U=="string"&&(U={ch1:U});var it=U.ch1,bt=U.ch2,Qt=U.ch3,cr=U.ch4,jr=U.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof it=="string"&&it.charAt(0)!=="#"){var fn=new Qre(it);if(fn.ok)it=fn.toHex();else if(!/^\d*\.?\d*$/.test(it))throw new Error('Invalid color "'+it+'" passed to jsPDF.encodeColorString.')}if(typeof it=="string"&&/^#[0-9A-Fa-f]{3}$/.test(it)&&(it="#"+it[1]+it[1]+it[2]+it[2]+it[3]+it[3]),typeof it=="string"&&/^#[0-9A-Fa-f]{6}$/.test(it)){var bn=parseInt(it.substr(1),16);it=bn>>16&255,bt=bn>>8&255,Qt=255&bn}if(bt===void 0||cr===void 0&&it===bt&&bt===Qt)_e=typeof it=="string"?it+" "+jr[0]:U.precision===2?k(it/255)+" "+jr[0]:T(it/255)+" "+jr[0];else if(cr===void 0||ms(cr)==="object"){if(cr&&!isNaN(cr.a)&&cr.a===0)return["1.","1.","1.",jr[1]].join(" ");_e=typeof it=="string"?[it,bt,Qt,jr[1]].join(" "):U.precision===2?[k(it/255),k(bt/255),k(Qt/255),jr[1]].join(" "):[T(it/255),T(bt/255),T(Qt/255),jr[1]].join(" ")}else _e=typeof it=="string"?[it,bt,Qt,cr,jr[2]].join(" "):U.precision===2?[k(it),k(bt),k(Qt),k(cr),jr[2]].join(" "):[T(it),T(bt),T(Qt),T(cr),jr[2]].join(" ");return _e},Pe=h.__private__.getFilters=function(){return o},xe=h.__private__.putStream=function(U){var _e=(U=U||{}).data||"",it=U.filters||Pe(),bt=U.alreadyAppliedFilters||[],Qt=U.addLength1||!1,cr=_e.length,jr=U.objectId,fn=function(ti){return ti};if(u!==null&&jr===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(fn=Fr.encryptor(jr,0));var bn={};it===!0&&(it=["FlateEncode"]);var Un=U.additionalKeyValues||[],Xn=(bn=An.API.processDataByFilters!==void 0?An.API.processDataByFilters(_e,it):{data:_e,reverseChain:[]}).reverseChain+(Array.isArray(bt)?bt.join(" "):bt.toString());if(bn.data.length!==0&&(Un.push({key:"Length",value:bn.data.length}),Qt===!0&&Un.push({key:"Length1",value:cr})),Xn.length!=0)if(Xn.split("/").length-1==1)Un.push({key:"Filter",value:Xn});else{Un.push({key:"Filter",value:"["+Xn+"]"});for(var oa=0;oa<Un.length;oa+=1)if(Un[oa].key==="DecodeParms"){for(var Ea=[],Da=0;Da<bn.reverseChain.split("/").length-1;Da+=1)Ea.push("null");Ea.push(Un[oa].value),Un[oa].value="["+Ea.join(" ")+"]"}}Z("<<");for(var Va=0;Va<Un.length;Va++)Z("/"+Un[Va].key+" "+Un[Va].value);Z(">>"),bn.data.length!==0&&(Z("stream"),Z(fn(bn.data)),Z("endstream"))},Ge=h.__private__.putPage=function(U){var _e=U.number,it=U.data,bt=U.objId,Qt=U.contentsObjId;z(bt,!0),Z("<</Type /Page"),Z("/Parent "+U.rootDictionaryObjId+" 0 R"),Z("/Resources "+U.resourceDictionaryObjId+" 0 R"),Z("/MediaBox ["+parseFloat(S(U.mediaBox.bottomLeftX))+" "+parseFloat(S(U.mediaBox.bottomLeftY))+" "+S(U.mediaBox.topRightX)+" "+S(U.mediaBox.topRightY)+"]"),U.cropBox!==null&&Z("/CropBox ["+S(U.cropBox.bottomLeftX)+" "+S(U.cropBox.bottomLeftY)+" "+S(U.cropBox.topRightX)+" "+S(U.cropBox.topRightY)+"]"),U.bleedBox!==null&&Z("/BleedBox ["+S(U.bleedBox.bottomLeftX)+" "+S(U.bleedBox.bottomLeftY)+" "+S(U.bleedBox.topRightX)+" "+S(U.bleedBox.topRightY)+"]"),U.trimBox!==null&&Z("/TrimBox ["+S(U.trimBox.bottomLeftX)+" "+S(U.trimBox.bottomLeftY)+" "+S(U.trimBox.topRightX)+" "+S(U.trimBox.topRightY)+"]"),U.artBox!==null&&Z("/ArtBox ["+S(U.artBox.bottomLeftX)+" "+S(U.artBox.bottomLeftY)+" "+S(U.artBox.topRightX)+" "+S(U.artBox.topRightY)+"]"),typeof U.userUnit=="number"&&U.userUnit!==1&&Z("/UserUnit "+U.userUnit),mt.publish("putPage",{objId:bt,pageContext:ye[_e],pageNumber:_e,page:it}),Z("/Contents "+Qt+" 0 R"),Z(">>"),Z("endobj");var cr=it.join(`
`);return w===b&&(cr+=`
Q`),z(Qt,!0),xe({data:cr,filters:Pe(),objectId:Qt}),Z("endobj"),bt},ze=h.__private__.putPages=function(){var U,_e,it=[];for(U=1;U<=me;U++)ye[U].objId=st(),ye[U].contentsObjId=st();for(U=1;U<=me;U++)it.push(Ge({number:U,data:ve[U],objId:ye[U].objId,contentsObjId:ye[U].contentsObjId,mediaBox:ye[U].mediaBox,cropBox:ye[U].cropBox,bleedBox:ye[U].bleedBox,trimBox:ye[U].trimBox,artBox:ye[U].artBox,userUnit:ye[U].userUnit,rootDictionaryObjId:re,resourceDictionaryObjId:H}));z(re,!0),Z("<</Type /Pages");var bt="/Kids [";for(_e=0;_e<me;_e++)bt+=it[_e]+" 0 R ";Z(bt+"]"),Z("/Count "+me),Z(">>"),Z("endobj"),mt.publish("postPutPages")},Ke=function(U){mt.publish("putFont",{font:U,out:Z,newObject:ct,putStream:xe}),U.isAlreadyPutted!==!0&&(U.objectNumber=ct(),Z("<<"),Z("/Type /Font"),Z("/BaseFont /"+Dx(U.postScriptName)),Z("/Subtype /Type1"),typeof U.encoding=="string"&&Z("/Encoding /"+U.encoding),Z("/FirstChar 32"),Z("/LastChar 255"),Z(">>"),Z("endobj"))},pt=function(U){U.objectNumber=ct();var _e=[];_e.push({key:"Type",value:"/XObject"}),_e.push({key:"Subtype",value:"/Form"}),_e.push({key:"BBox",value:"["+[S(U.x),S(U.y),S(U.x+U.width),S(U.y+U.height)].join(" ")+"]"}),_e.push({key:"Matrix",value:"["+U.matrix.toString()+"]"});var it=U.pages[1].join(`
`);xe({data:it,additionalKeyValues:_e,objectId:U.objectNumber}),Z("endobj")},ne=function(U,_e){_e||(_e=21);var it=ct(),bt=function(jr,fn){var bn,Un=[],Xn=1/(fn-1);for(bn=0;bn<1;bn+=Xn)Un.push(bn);if(Un.push(1),jr[0].offset!=0){var oa={offset:0,color:jr[0].color};jr.unshift(oa)}if(jr[jr.length-1].offset!=1){var Ea={offset:1,color:jr[jr.length-1].color};jr.push(Ea)}for(var Da="",Va=0,ti=0;ti<Un.length;ti++){for(bn=Un[ti];bn>jr[Va+1].offset;)Va++;var as=jr[Va].offset,ri=(bn-as)/(jr[Va+1].offset-as),Qs=jr[Va].color,Wc=jr[Va+1].color;Da+=M(Math.round((1-ri)*Qs[0]+ri*Wc[0]).toString(16))+M(Math.round((1-ri)*Qs[1]+ri*Wc[1]).toString(16))+M(Math.round((1-ri)*Qs[2]+ri*Wc[2]).toString(16))}return Da.trim()}(U.colors,_e),Qt=[];Qt.push({key:"FunctionType",value:"0"}),Qt.push({key:"Domain",value:"[0.0 1.0]"}),Qt.push({key:"Size",value:"["+_e+"]"}),Qt.push({key:"BitsPerSample",value:"8"}),Qt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Qt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),xe({data:bt,additionalKeyValues:Qt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:it}),Z("endobj"),U.objectNumber=ct(),Z("<< /ShadingType "+U.type),Z("/ColorSpace /DeviceRGB");var cr="/Coords ["+S(parseFloat(U.coords[0]))+" "+S(parseFloat(U.coords[1]))+" ";U.type===2?cr+=S(parseFloat(U.coords[2]))+" "+S(parseFloat(U.coords[3])):cr+=S(parseFloat(U.coords[2]))+" "+S(parseFloat(U.coords[3]))+" "+S(parseFloat(U.coords[4]))+" "+S(parseFloat(U.coords[5])),Z(cr+="]"),U.matrix&&Z("/Matrix ["+U.matrix.toString()+"]"),Z("/Function "+it+" 0 R"),Z("/Extend [true true]"),Z(">>"),Z("endobj")},Ue=function(U,_e){var it=st(),bt=ct();_e.push({resourcesOid:it,objectOid:bt}),U.objectNumber=bt;var Qt=[];Qt.push({key:"Type",value:"/Pattern"}),Qt.push({key:"PatternType",value:"1"}),Qt.push({key:"PaintType",value:"1"}),Qt.push({key:"TilingType",value:"1"}),Qt.push({key:"BBox",value:"["+U.boundingBox.map(S).join(" ")+"]"}),Qt.push({key:"XStep",value:S(U.xStep)}),Qt.push({key:"YStep",value:S(U.yStep)}),Qt.push({key:"Resources",value:it+" 0 R"}),U.matrix&&Qt.push({key:"Matrix",value:"["+U.matrix.toString()+"]"}),xe({data:U.stream,additionalKeyValues:Qt,objectId:U.objectNumber}),Z("endobj")},tt=function(U){for(var _e in U.objectNumber=ct(),Z("<<"),U)switch(_e){case"opacity":Z("/ca "+k(U[_e]));break;case"stroke-opacity":Z("/CA "+k(U[_e]))}Z(">>"),Z("endobj")},nt=function(U){z(U.resourcesOid,!0),Z("<<"),Z("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var _e in Z("/Font <<"),ee)ee.hasOwnProperty(_e)&&(f===!1||f===!0&&A.hasOwnProperty(_e))&&Z("/"+_e+" "+ee[_e].objectNumber+" 0 R");Z(">>")}(),function(){if(Object.keys($e).length>0){for(var _e in Z("/Shading <<"),$e)$e.hasOwnProperty(_e)&&$e[_e]instanceof H0&&$e[_e].objectNumber>=0&&Z("/"+_e+" "+$e[_e].objectNumber+" 0 R");mt.publish("putShadingPatternDict"),Z(">>")}}(),function(_e){if(Object.keys($e).length>0){for(var it in Z("/Pattern <<"),$e)$e.hasOwnProperty(it)&&$e[it]instanceof h.TilingPattern&&$e[it].objectNumber>=0&&$e[it].objectNumber<_e&&Z("/"+it+" "+$e[it].objectNumber+" 0 R");mt.publish("putTilingPatternDict"),Z(">>")}}(U.objectOid),function(){if(Object.keys(pe).length>0){var _e;for(_e in Z("/ExtGState <<"),pe)pe.hasOwnProperty(_e)&&pe[_e].objectNumber>=0&&Z("/"+_e+" "+pe[_e].objectNumber+" 0 R");mt.publish("putGStateDict"),Z(">>")}}(),function(){for(var _e in Z("/XObject <<"),yt)yt.hasOwnProperty(_e)&&yt[_e].objectNumber>=0&&Z("/"+_e+" "+yt[_e].objectNumber+" 0 R");mt.publish("putXobjectDict"),Z(">>")}(),Z(">>"),Z("endobj")},wt=function(U){Ve[U.fontName]=Ve[U.fontName]||{},Ve[U.fontName][U.fontStyle]=U.id},Bt=function(U,_e,it,bt,Qt){var cr={id:"F"+(Object.keys(ee).length+1).toString(10),postScriptName:U,fontName:_e,fontStyle:it,encoding:bt,isStandardFont:Qt||!1,metadata:{}};return mt.publish("addFont",{font:cr,instance:this}),ee[cr.id]=cr,wt(cr),cr.id},tr=h.__private__.pdfEscape=h.pdfEscape=function(U,_e){return function(it,bt){var Qt,cr,jr,fn,bn,Un,Xn,oa,Ea;if(jr=(bt=bt||{}).sourceEncoding||"Unicode",bn=bt.outputEncoding,(bt.autoencode||bn)&&ee[Ye].metadata&&ee[Ye].metadata[jr]&&ee[Ye].metadata[jr].encoding&&(fn=ee[Ye].metadata[jr].encoding,!bn&&ee[Ye].encoding&&(bn=ee[Ye].encoding),!bn&&fn.codePages&&(bn=fn.codePages[0]),typeof bn=="string"&&(bn=fn[bn]),bn)){for(Xn=!1,Un=[],Qt=0,cr=it.length;Qt<cr;Qt++)(oa=bn[it.charCodeAt(Qt)])?Un.push(String.fromCharCode(oa)):Un.push(it[Qt]),Un[Qt].charCodeAt(0)>>8&&(Xn=!0);it=Un.join("")}for(Qt=it.length;Xn===void 0&&Qt!==0;)it.charCodeAt(Qt-1)>>8&&(Xn=!0),Qt--;if(!Xn)return it;for(Un=bt.noBOM?[]:[254,255],Qt=0,cr=it.length;Qt<cr;Qt++){if((Ea=(oa=it.charCodeAt(Qt))>>8)>>8)throw new Error("Character at position "+Qt+" of string '"+it+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Un.push(Ea),Un.push(oa-(Ea<<8))}return String.fromCharCode.apply(void 0,Un)}(U,_e).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Or=h.__private__.beginPage=function(U){ve[++me]=[],ye[me]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(U[0]),topRightY:Number(U[1])}},Dr(me),se(ve[R])},zr=function(U,_e){var it,bt,Qt;switch(r=_e||r,typeof U=="string"&&(it=v(U.toLowerCase()),Array.isArray(it)&&(bt=it[0],Qt=it[1])),Array.isArray(U)&&(bt=U[0]*dt,Qt=U[1]*dt),isNaN(bt)&&(bt=a[0],Qt=a[1]),(bt>14400||Qt>14400)&&(Is.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),bt=Math.min(14400,bt),Qt=Math.min(14400,Qt)),a=[bt,Qt],r.substr(0,1)){case"l":Qt>bt&&(a=[Qt,bt]);break;case"p":bt>Qt&&(a=[Qt,bt])}Or(a),Ct(ft),Z(sn),Sr!==0&&Z(Sr+" J"),Hn!==0&&Z(Hn+" j"),mt.publish("addPage",{pageNumber:me})},ur=function(U){U>0&&U<=me&&(ve.splice(U,1),ye.splice(U,1),me--,R>me&&(R=me),this.setPage(R))},Dr=function(U){U>0&&U<=me&&(R=U)},dn=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return ve.length-1},mn=function(U,_e,it){var bt,Qt=void 0;return it=it||{},U=U!==void 0?U:ee[Ye].fontName,_e=_e!==void 0?_e:ee[Ye].fontStyle,bt=U.toLowerCase(),Ve[bt]!==void 0&&Ve[bt][_e]!==void 0?Qt=Ve[bt][_e]:Ve[U]!==void 0&&Ve[U][_e]!==void 0?Qt=Ve[U][_e]:it.disableWarning===!1&&Is.warn("Unable to look up font label for font '"+U+"', '"+_e+"'. Refer to getFontList() for available fonts."),Qt||it.noFallback||(Qt=Ve.times[_e])==null&&(Qt=Ve.times.normal),Qt},kr=h.__private__.putInfo=function(){var U=ct(),_e=function(bt){return bt};for(var it in u!==null&&(_e=Fr.encryptor(U,0)),Z("<<"),Z("/Producer ("+tr(_e("jsPDF "+An.version))+")"),Te)Te.hasOwnProperty(it)&&Te[it]&&Z("/"+it.substr(0,1).toUpperCase()+it.substr(1)+" ("+tr(_e(Te[it]))+")");Z("/CreationDate ("+tr(_e(de))+")"),Z(">>"),Z("endobj")},Qe=h.__private__.putCatalog=function(U){var _e=(U=U||{}).rootDictionaryObjId||re;switch(ct(),Z("<<"),Z("/Type /Catalog"),Z("/Pages "+_e+" 0 R"),ot||(ot="fullwidth"),ot){case"fullwidth":Z("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Z("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Z("/OpenAction [3 0 R /Fit]");break;case"original":Z("/OpenAction [3 0 R /XYZ null null 1]");break;default:var it=""+ot;it.substr(it.length-1)==="%"&&(ot=parseInt(ot)/100),typeof ot=="number"&&Z("/OpenAction [3 0 R /XYZ null null "+k(ot)+"]")}switch(Rt||(Rt="continuous"),Rt){case"continuous":Z("/PageLayout /OneColumn");break;case"single":Z("/PageLayout /SinglePage");break;case"two":case"twoleft":Z("/PageLayout /TwoColumnLeft");break;case"tworight":Z("/PageLayout /TwoColumnRight")}Tt&&Z("/PageMode /"+Tt),mt.publish("putCatalog"),Z(">>"),Z("endobj")},jt=h.__private__.putTrailer=function(){Z("trailer"),Z("<<"),Z("/Size "+(K+1)),Z("/Root "+K+" 0 R"),Z("/Info "+(K-1)+" 0 R"),u!==null&&Z("/Encrypt "+Fr.oid+" 0 R"),Z("/ID [ <"+ce+"> <"+ce+"> ]"),Z(">>")},wr=h.__private__.putHeader=function(){Z("%PDF-"+m),Z("%")},ln=h.__private__.putXRef=function(){var U="0000000000";Z("xref"),Z("0 "+(K+1)),Z("0000000000 65535 f ");for(var _e=1;_e<=K;_e++)typeof Y[_e]=="function"?Z((U+Y[_e]()).slice(-10)+" 00000 n "):Y[_e]!==void 0?Z((U+Y[_e]).slice(-10)+" 00000 n "):Z("0000000000 00000 n ")},cn=h.__private__.buildDocument=function(){var U;K=0,V=0,D=[],Y=[],te=[],re=st(),H=st(),se(D),mt.publish("buildDocument"),wr(),ze(),function(){mt.publish("putAdditionalObjects");for(var it=0;it<te.length;it++){var bt=te[it];z(bt.objId,!0),Z(bt.content),Z("endobj")}mt.publish("postPutAdditionalObjects")}(),U=[],function(){for(var it in ee)ee.hasOwnProperty(it)&&(f===!1||f===!0&&A.hasOwnProperty(it))&&Ke(ee[it])}(),function(){var it;for(it in pe)pe.hasOwnProperty(it)&&tt(pe[it])}(),function(){for(var it in yt)yt.hasOwnProperty(it)&&pt(yt[it])}(),function(it){var bt;for(bt in $e)$e.hasOwnProperty(bt)&&($e[bt]instanceof H0?ne($e[bt]):$e[bt]instanceof Tp&&Ue($e[bt],it))}(U),mt.publish("putResources"),U.forEach(nt),nt({resourcesOid:H,objectOid:Number.MAX_SAFE_INTEGER}),mt.publish("postPutResources"),u!==null&&(Fr.oid=ct(),Z("<<"),Z("/Filter /Standard"),Z("/V "+Fr.v),Z("/R "+Fr.r),Z("/U <"+Fr.toHexString(Fr.U)+">"),Z("/O <"+Fr.toHexString(Fr.O)+">"),Z("/P "+Fr.P),Z(">>"),Z("endobj")),kr(),Qe();var _e=V;return ln(),jt(),Z("startxref"),Z(""+_e),Z("%%EOF"),se(ve[R]),D.join(`
`)},_r=h.__private__.getBlob=function(U){return new Blob([Se(U)],{type:"application/pdf"})},Jt=h.output=h.__private__.output=(ut=function(U,_e){switch(typeof(_e=_e||{})=="string"?_e={filename:_e}:_e.filename=_e.filename||"generated.pdf",U){case void 0:return cn();case"save":h.save(_e.filename);break;case"arraybuffer":return Se(cn());case"blob":return _r(cn());case"bloburi":case"bloburl":if(Yn.URL!==void 0&&typeof Yn.URL.createObjectURL=="function")return Yn.URL&&Yn.URL.createObjectURL(_r(cn()))||void 0;Is.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var it="",bt=cn();try{it=FV(bt)}catch{it=FV(unescape(encodeURIComponent(bt)))}return"data:application/pdf;filename="+_e.filename+";base64,"+it;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Yn)==="[object Window]"){var Qt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",cr=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';_e.pdfObjectUrl&&(Qt=_e.pdfObjectUrl,cr="");var jr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Qt+'"'+cr+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(_e)+");<\/script></body></html>",fn=Yn.open();return fn!==null&&fn.document.write(jr),fn}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Yn)==="[object Window]"){var bn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(_e.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+_e.filename+'" width="500px" height="400px" /></body></html>',Un=Yn.open();if(Un!==null){Un.document.write(bn);var Xn=this;Un.document.documentElement.querySelector("#pdfViewer").onload=function(){Un.document.title=_e.filename,Un.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Xn.output("bloburl"))}}return Un}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Yn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var oa='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",_e)+'"></iframe></body></html>',Ea=Yn.open();if(Ea!==null&&(Ea.document.write(oa),Ea.document.title=_e.filename),Ea||typeof safari>"u")return Ea;break;case"datauri":case"dataurl":return Yn.document.location.href=this.output("datauristring",_e);default:return null}},ut.foo=function(){try{return ut.apply(this,arguments)}catch(it){var U=it.stack||"";~U.indexOf(" at ")&&(U=U.split(" at ")[1]);var _e="Error in function "+U.split(`
`)[0].split("<")[0]+": "+it.message;if(!Yn.console)throw new Error(_e);Yn.console.error(_e,it),Yn.alert&&alert(_e)}},ut.foo.bar=ut,ut.foo),ir=function(U){return Array.isArray(gt)===!0&&gt.indexOf(U)>-1};switch(n){case"pt":dt=1;break;case"mm":dt=72/25.4;break;case"cm":dt=72/2.54;break;case"in":dt=72;break;case"px":dt=ir("px_scaling")==1?.75:96/72;break;case"pc":case"em":dt=12;break;case"ex":dt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);dt=n}var Fr=null;De(),he();var Er=h.__private__.getPageInfo=h.getPageInfo=function(U){if(isNaN(U)||U%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:ye[U].objId,pageNumber:U,pageContext:ye[U]}},Lr=h.__private__.getPageInfoByObjId=function(U){if(isNaN(U)||U%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var _e in ye)if(ye[_e].objId===U)break;return Er(_e)},Ln=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:ye[R].objId,pageNumber:R,pageContext:ye[R]}};h.addPage=function(){return zr.apply(this,arguments),this},h.setPage=function(){return Dr.apply(this,arguments),se.call(this,ve[R]),this},h.insertPage=function(U){return this.addPage(),this.movePage(R,U),this},h.movePage=function(U,_e){var it,bt;if(U>_e){it=ve[U],bt=ye[U];for(var Qt=U;Qt>_e;Qt--)ve[Qt]=ve[Qt-1],ye[Qt]=ye[Qt-1];ve[_e]=it,ye[_e]=bt,this.setPage(_e)}else if(U<_e){it=ve[U],bt=ye[U];for(var cr=U;cr<_e;cr++)ve[cr]=ve[cr+1],ye[cr]=ye[cr+1];ve[_e]=it,ye[_e]=bt,this.setPage(_e)}return this},h.deletePage=function(){return ur.apply(this,arguments),this},h.__private__.text=h.text=function(U,_e,it,bt,Qt){var cr,jr,fn,bn,Un,Xn,oa,Ea,Da,Va=(bt=bt||{}).scope||this;if(typeof U=="number"&&typeof _e=="number"&&(typeof it=="string"||Array.isArray(it))){var ti=it;it=_e,_e=U,U=ti}if(arguments[3]instanceof Oe==0?(fn=arguments[4],bn=arguments[5],ms(oa=arguments[3])==="object"&&oa!==null||(typeof fn=="string"&&(bn=fn,fn=null),typeof oa=="string"&&(bn=oa,oa=null),typeof oa=="number"&&(fn=oa,oa=null),bt={flags:oa,angle:fn,align:bn})):(E("The transform parameter of text() with a Matrix value"),Da=Qt),isNaN(_e)||isNaN(it)||U==null)throw new Error("Invalid arguments passed to jsPDF.text");if(U.length===0)return Va;var as,ri="",Qs=typeof bt.lineHeightFactor=="number"?bt.lineHeightFactor:we,Wc=Va.internal.scaleFactor;function eu(ts){return ts=ts.split("	").join(Array(bt.TabLen||9).join(" ")),tr(ts,oa)}function tu(ts){for(var Ss,qi=ts.concat(),Eo=[],_h=qi.length;_h--;)typeof(Ss=qi.shift())=="string"?Eo.push(Ss):Array.isArray(ts)&&(Ss.length===1||Ss[1]===void 0&&Ss[2]===void 0)?Eo.push(Ss[0]):Eo.push([Ss[0],Ss[1],Ss[2]]);return Eo}function _(ts,Ss){var qi;if(typeof ts=="string")qi=Ss(ts)[0];else if(Array.isArray(ts)){for(var Eo,_h,z1=ts.concat(),ex=[],NN=z1.length;NN--;)typeof(Eo=z1.shift())=="string"?ex.push(Ss(Eo)[0]):Array.isArray(Eo)&&typeof Eo[0]=="string"&&(_h=Ss(Eo[0],Eo[1],Eo[2]),ex.push([_h[0],_h[1],_h[2]]));qi=ex}return qi}var J=!1,ge=!0;if(typeof U=="string")J=!0;else if(Array.isArray(U)){var et=U.concat();jr=[];for(var Ht,er=et.length;er--;)(typeof(Ht=et.shift())!="string"||Array.isArray(Ht)&&typeof Ht[0]!="string")&&(ge=!1);J=ge}if(J===!1)throw new Error('Type of text must be string or Array. "'+U+'" is not recognized.');typeof U=="string"&&(U=U.match(/[\r?\n]/)?U.split(/\r\n|\r|\n/g):[U]);var qr=Ze/Va.internal.scaleFactor,Pa=qr*(Qs-1);switch(bt.baseline){case"bottom":it-=Pa;break;case"top":it+=qr-Pa;break;case"hanging":it+=qr-2*Pa;break;case"middle":it+=qr/2-Pa}if((Xn=bt.maxWidth||0)>0&&(typeof U=="string"?U=Va.splitTextToSize(U,Xn):Object.prototype.toString.call(U)==="[object Array]"&&(U=U.reduce(function(ts,Ss){return ts.concat(Va.splitTextToSize(Ss,Xn))},[]))),cr={text:U,x:_e,y:it,options:bt,mutex:{pdfEscape:tr,activeFontKey:Ye,fonts:ee,activeFontSize:Ze}},mt.publish("preProcessText",cr),U=cr.text,fn=(bt=cr.options).angle,Da instanceof Oe==0&&fn&&typeof fn=="number"){fn*=Math.PI/180,bt.rotationDirection===0&&(fn=-fn),w===b&&(fn=-fn);var gi=Math.cos(fn),ya=Math.sin(fn);Da=new Oe(gi,ya,-ya,gi,0,0)}else fn&&fn instanceof Oe&&(Da=fn);w!==b||Da||(Da=Ae),(Un=bt.charSpace||rn)!==void 0&&(ri+=S(P(Un))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ea=bt.horizontalScale)!==void 0&&(ri+=S(100*Ea)+` Tz
`),bt.lang;var Ha=-1,ks=bt.renderingMode!==void 0?bt.renderingMode:bt.stroke,vd=Va.internal.getCurrentPageInfo().pageContext;switch(ks){case 0:case!1:case"fill":Ha=0;break;case 1:case!0:case"stroke":Ha=1;break;case 2:case"fillThenStroke":Ha=2;break;case 3:case"invisible":Ha=3;break;case 4:case"fillAndAddForClipping":Ha=4;break;case 5:case"strokeAndAddPathForClipping":Ha=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ha=6;break;case 7:case"addToPathForClipping":Ha=7}var ql=vd.usedRenderingMode!==void 0?vd.usedRenderingMode:-1;Ha!==-1?ri+=Ha+` Tr
`:ql!==-1&&(ri+=`0 Tr
`),Ha!==-1&&(vd.usedRenderingMode=Ha),bn=bt.align||"left";var bl,Wu=Ze*Qs,Q1=Va.internal.pageSize.getWidth(),V1=ee[Ye];Un=bt.charSpace||rn,Xn=bt.maxWidth||0,oa=Object.assign({autoencode:!0,noBOM:!0},bt.flags);var XA=[],Xm=function(ts){return Va.getStringUnitWidth(ts,{font:V1,charSpace:Un,fontSize:Ze,doKerning:!1})*Ze/Wc};if(Object.prototype.toString.call(U)==="[object Array]"){var yd;jr=tu(U),bn!=="left"&&(bl=jr.map(Xm));var bd,YA=0;if(bn==="right"){_e-=bl[0],U=[],er=jr.length;for(var Ch=0;Ch<er;Ch++)Ch===0?(bd=br(_e),yd=hr(it)):(bd=P(YA-bl[Ch]),yd=-Wu),U.push([jr[Ch],bd,yd]),YA=bl[Ch]}else if(bn==="center"){_e-=bl[0]/2,U=[],er=jr.length;for(var JA=0;JA<er;JA++)JA===0?(bd=br(_e),yd=hr(it)):(bd=P((YA-bl[JA])/2),yd=-Wu),U.push([jr[JA],bd,yd]),YA=bl[JA]}else if(bn==="left"){U=[],er=jr.length;for(var H1=0;H1<er;H1++)U.push(jr[H1])}else if(bn==="justify"&&V1.encoding==="Identity-H"){U=[],er=jr.length,Xn=Xn!==0?Xn:Q1;for(var Zg=0,Ki=0;Ki<er;Ki++)if(yd=Ki===0?hr(it):-Wu,bd=Ki===0?br(_e):Zg,Ki<er-1){var wN=P((Xn-bl[Ki])/(jr[Ki].split(" ").length-1)),Rf=jr[Ki].split(" ");U.push([Rf[0]+" ",bd,yd]),Zg=0;for(var Mf=1;Mf<Rf.length;Mf++){var $1=(Xm(Rf[Mf-1]+" "+Rf[Mf])-Xm(Rf[Mf]))*Wc+wN;Mf==Rf.length-1?U.push([Rf[Mf],$1,0]):U.push([Rf[Mf]+" ",$1,0]),Zg-=$1}}else U.push([jr[Ki],bd,yd]);U.push(["",Zg,0])}else{if(bn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(U=[],er=jr.length,Xn=Xn!==0?Xn:Q1,Ki=0;Ki<er;Ki++){yd=Ki===0?hr(it):-Wu,bd=Ki===0?br(_e):0;var G1=jr[Ki].split(" ").length-1,K1=G1>0?(Xn-bl[Ki])/G1:0;Ki<er-1?XA.push(S(P(K1))):XA.push(0),U.push([jr[Ki],bd,yd])}}}(typeof bt.R2L=="boolean"?bt.R2L:_t)===!0&&(U=_(U,function(ts,Ss,qi){return[ts.split("").reverse().join(""),Ss,qi]})),cr={text:U,x:_e,y:it,options:bt,mutex:{pdfEscape:tr,activeFontKey:Ye,fonts:ee,activeFontSize:Ze}},mt.publish("postProcessText",cr),U=cr.text,as=cr.mutex.isHex||!1;var q1=ee[Ye].encoding;q1!=="WinAnsiEncoding"&&q1!=="StandardEncoding"||(U=_(U,function(ts,Ss,qi){return[eu(ts),Ss,qi]})),jr=tu(U),U=[];for(var ZA,e0,t0,Ym=Array.isArray(jr[0])?1:0,r0="",Jm=function(ts,Ss,qi){var Eo="";return qi instanceof Oe?(qi=typeof bt.angle=="number"?be(qi,new Oe(1,0,0,1,ts,Ss)):be(new Oe(1,0,0,1,ts,Ss),qi),w===b&&(qi=be(new Oe(1,0,0,-1,0,0),qi)),Eo=qi.join(" ")+` Tm
`):Eo=S(ts)+" "+S(Ss)+` Td
`,Eo},ru=0;ru<jr.length;ru++){switch(r0="",Ym){case 1:t0=(as?"<":"(")+jr[ru][0]+(as?">":")"),ZA=parseFloat(jr[ru][1]),e0=parseFloat(jr[ru][2]);break;case 0:t0=(as?"<":"(")+jr[ru]+(as?">":")"),ZA=br(_e),e0=hr(it)}XA!==void 0&&XA[ru]!==void 0&&(r0=XA[ru]+` Tw
`),ru===0?U.push(r0+Jm(ZA,e0,Da)+t0):Ym===0?U.push(r0+t0):Ym===1&&U.push(r0+Jm(ZA,e0,Da)+t0)}U=Ym===0?U.join(` Tj
T* `):U.join(` Tj
`),U+=` Tj
`;var Lf=`BT
/`;return Lf+=Ye+" "+Ze+` Tf
`,Lf+=S(Ze*Qs)+` TL
`,Lf+=Zn+`
`,Lf+=ri,Lf+=U,Z(Lf+="ET"),A[Ye]=!0,Va};var Nt=h.__private__.clip=h.clip=function(U){return Z(U==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return Nt("evenodd")},h.__private__.discardPath=h.discardPath=function(){return Z("n"),this};var nr=h.__private__.isValidStyle=function(U){var _e=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(U)!==-1&&(_e=!0),_e};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(U){return nr(U)&&(d=U),this};var $t=h.__private__.getStyle=h.getStyle=function(U){var _e=d;switch(U){case"D":case"S":_e="S";break;case"F":_e="f";break;case"FD":case"DF":_e="B";break;case"f":case"f*":case"B":case"B*":_e=U}return _e},Mt=h.close=function(){return Z("h"),this};h.stroke=function(){return Z("S"),this},h.fill=function(U){return Be("f",U),this},h.fillEvenOdd=function(U){return Be("f*",U),this},h.fillStroke=function(U){return Be("B",U),this},h.fillStrokeEvenOdd=function(U){return Be("B*",U),this};var Be=function(U,_e){ms(_e)==="object"?Ot(_e,U):Z(U)},It=function(U){U===null||w===b&&U===void 0||(U=$t(U),Z(U))};function Vt(U,_e,it,bt,Qt){var cr=new Tp(_e||this.boundingBox,it||this.xStep,bt||this.yStep,this.gState,Qt||this.matrix);cr.stream=this.stream;var jr=U+"$$"+this.cloneIndex+++"$$";return Le(jr,cr),cr}var Ot=function(U,_e){var it=ie[U.key],bt=$e[it];if(bt instanceof H0)Z("q"),Z(qt(_e)),bt.gState&&h.setGState(bt.gState),Z(U.matrix.toString()+" cm"),Z("/"+it+" sh"),Z("Q");else if(bt instanceof Tp){var Qt=new Oe(1,0,0,-1,0,ea());U.matrix&&(Qt=Qt.multiply(U.matrix||Ae),it=Vt.call(bt,U.key,U.boundingBox,U.xStep,U.yStep,Qt).id),Z("q"),Z("/Pattern cs"),Z("/"+it+" scn"),bt.gState&&h.setGState(bt.gState),Z(_e),Z("Q")}},qt=function(U){switch(U){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},sr=h.moveTo=function(U,_e){return Z(S(P(U))+" "+S(q(_e))+" m"),this},vr=h.lineTo=function(U,_e){return Z(S(P(U))+" "+S(q(_e))+" l"),this},rr=h.curveTo=function(U,_e,it,bt,Qt,cr){return Z([S(P(U)),S(q(_e)),S(P(it)),S(q(bt)),S(P(Qt)),S(q(cr)),"c"].join(" ")),this};h.__private__.line=h.line=function(U,_e,it,bt,Qt){if(isNaN(U)||isNaN(_e)||isNaN(it)||isNaN(bt)||!nr(Qt))throw new Error("Invalid arguments passed to jsPDF.line");return w===y?this.lines([[it-U,bt-_e]],U,_e,[1,1],Qt||"S"):this.lines([[it-U,bt-_e]],U,_e,[1,1]).stroke()},h.__private__.lines=h.lines=function(U,_e,it,bt,Qt,cr){var jr,fn,bn,Un,Xn,oa,Ea,Da,Va,ti,as,ri;if(typeof U=="number"&&(ri=it,it=_e,_e=U,U=ri),bt=bt||[1,1],cr=cr||!1,isNaN(_e)||isNaN(it)||!Array.isArray(U)||!Array.isArray(bt)||!nr(Qt)||typeof cr!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(sr(_e,it),jr=bt[0],fn=bt[1],Un=U.length,ti=_e,as=it,bn=0;bn<Un;bn++)(Xn=U[bn]).length===2?(ti=Xn[0]*jr+ti,as=Xn[1]*fn+as,vr(ti,as)):(oa=Xn[0]*jr+ti,Ea=Xn[1]*fn+as,Da=Xn[2]*jr+ti,Va=Xn[3]*fn+as,ti=Xn[4]*jr+ti,as=Xn[5]*fn+as,rr(oa,Ea,Da,Va,ti,as));return cr&&Mt(),It(Qt),this},h.path=function(U){for(var _e=0;_e<U.length;_e++){var it=U[_e],bt=it.c;switch(it.op){case"m":sr(bt[0],bt[1]);break;case"l":vr(bt[0],bt[1]);break;case"c":rr.apply(this,bt);break;case"h":Mt()}}return this},h.__private__.rect=h.rect=function(U,_e,it,bt,Qt){if(isNaN(U)||isNaN(_e)||isNaN(it)||isNaN(bt)||!nr(Qt))throw new Error("Invalid arguments passed to jsPDF.rect");return w===y&&(bt=-bt),Z([S(P(U)),S(q(_e)),S(P(it)),S(P(bt)),"re"].join(" ")),It(Qt),this},h.__private__.triangle=h.triangle=function(U,_e,it,bt,Qt,cr,jr){if(isNaN(U)||isNaN(_e)||isNaN(it)||isNaN(bt)||isNaN(Qt)||isNaN(cr)||!nr(jr))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[it-U,bt-_e],[Qt-it,cr-bt],[U-Qt,_e-cr]],U,_e,[1,1],jr,!0),this},h.__private__.roundedRect=h.roundedRect=function(U,_e,it,bt,Qt,cr,jr){if(isNaN(U)||isNaN(_e)||isNaN(it)||isNaN(bt)||isNaN(Qt)||isNaN(cr)||!nr(jr))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var fn=4/3*(Math.SQRT2-1);return Qt=Math.min(Qt,.5*it),cr=Math.min(cr,.5*bt),this.lines([[it-2*Qt,0],[Qt*fn,0,Qt,cr-cr*fn,Qt,cr],[0,bt-2*cr],[0,cr*fn,-Qt*fn,cr,-Qt,cr],[2*Qt-it,0],[-Qt*fn,0,-Qt,-cr*fn,-Qt,-cr],[0,2*cr-bt],[0,-cr*fn,Qt*fn,-cr,Qt,-cr]],U+Qt,_e,[1,1],jr,!0),this},h.__private__.ellipse=h.ellipse=function(U,_e,it,bt,Qt){if(isNaN(U)||isNaN(_e)||isNaN(it)||isNaN(bt)||!nr(Qt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var cr=4/3*(Math.SQRT2-1)*it,jr=4/3*(Math.SQRT2-1)*bt;return sr(U+it,_e),rr(U+it,_e-jr,U+cr,_e-bt,U,_e-bt),rr(U-cr,_e-bt,U-it,_e-jr,U-it,_e),rr(U-it,_e+jr,U-cr,_e+bt,U,_e+bt),rr(U+cr,_e+bt,U+it,_e+jr,U+it,_e),It(Qt),this},h.__private__.circle=h.circle=function(U,_e,it,bt){if(isNaN(U)||isNaN(_e)||isNaN(it)||!nr(bt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(U,_e,it,it,bt)},h.setFont=function(U,_e,it){return it&&(_e=N(_e,it)),Ye=mn(U,_e,{disableWarning:!1}),this};var dr=h.__private__.getFont=h.getFont=function(){return ee[mn.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var U,_e,it={};for(U in Ve)if(Ve.hasOwnProperty(U))for(_e in it[U]=[],Ve[U])Ve[U].hasOwnProperty(_e)&&it[U].push(_e);return it},h.addFont=function(U,_e,it,bt,Qt){var cr=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&cr.indexOf(arguments[3])!==-1?Qt=arguments[3]:arguments[3]&&cr.indexOf(arguments[3])==-1&&(it=N(it,bt)),Bt.call(this,U,_e,it,Qt=Qt||"Identity-H")};var we,ft=t.lineWidth||.200025,St=h.__private__.getLineWidth=h.getLineWidth=function(){return ft},Ct=h.__private__.setLineWidth=h.setLineWidth=function(U){return ft=U,Z(S(P(U))+" w"),this};h.__private__.setLineDash=An.API.setLineDash=An.API.setLineDashPattern=function(U,_e){if(U=U||[],_e=_e||0,isNaN(_e)||!Array.isArray(U))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return U=U.map(function(it){return S(P(it))}).join(" "),_e=S(P(_e)),Z("["+U+"] "+_e+" d"),this};var fr=h.__private__.getLineHeight=h.getLineHeight=function(){return Ze*we};h.__private__.getLineHeight=h.getLineHeight=function(){return Ze*we};var or=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(U){return typeof(U=U||1.15)=="number"&&(we=U),this},Hr=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return we};or(t.lineHeight);var br=h.__private__.getHorizontalCoordinate=function(U){return P(U)},hr=h.__private__.getVerticalCoordinate=function(U){return w===b?U:ye[R].mediaBox.topRightY-ye[R].mediaBox.bottomLeftY-P(U)},Ir=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(U){return S(br(U))},en=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(U){return S(hr(U))},sn=t.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return L(sn)},h.__private__.setStrokeColor=h.setDrawColor=function(U,_e,it,bt){return sn=ue({ch1:U,ch2:_e,ch3:it,ch4:bt,pdfColorType:"draw",precision:2}),Z(sn),this};var da=t.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return L(da)},h.__private__.setFillColor=h.setFillColor=function(U,_e,it,bt){return da=ue({ch1:U,ch2:_e,ch3:it,ch4:bt,pdfColorType:"fill",precision:2}),Z(da),this};var Zn=t.textColor||"0 g",wn=h.__private__.getTextColor=h.getTextColor=function(){return L(Zn)};h.__private__.setTextColor=h.setTextColor=function(U,_e,it,bt){return Zn=ue({ch1:U,ch2:_e,ch3:it,ch4:bt,pdfColorType:"text",precision:3}),this};var rn=t.charSpace,pr=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(rn||0)};h.__private__.setCharSpace=h.setCharSpace=function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return rn=U,this};var Sr=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(U){var _e=h.CapJoinStyles[U];if(_e===void 0)throw new Error("Line cap style of '"+U+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Sr=_e,Z(_e+" J"),this};var Hn=0;h.__private__.setLineJoin=h.setLineJoin=function(U){var _e=h.CapJoinStyles[U];if(_e===void 0)throw new Error("Line join style of '"+U+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Hn=_e,Z(_e+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(U){if(U=U||0,isNaN(U))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Z(S(P(U))+" M"),this},h.GState=O2,h.setGState=function(U){(U=typeof U=="string"?pe[fe[U]]:$r(null,U)).equals(Me)||(Z("/"+U.id+" gs"),Me=U)};var $r=function(U,_e){if(!U||!fe[U]){var it=!1;for(var bt in pe)if(pe.hasOwnProperty(bt)&&pe[bt].equals(_e)){it=!0;break}if(it)_e=pe[bt];else{var Qt="GS"+(Object.keys(pe).length+1).toString(10);pe[Qt]=_e,_e.id=Qt}return U&&(fe[U]=_e.id),mt.publish("addGState",_e),_e}};h.addGState=function(U,_e){return $r(U,_e),this},h.saveGraphicsState=function(){return Z("q"),rt.push({key:Ye,size:Ze,color:Zn}),this},h.restoreGraphicsState=function(){Z("Q");var U=rt.pop();return Ye=U.key,Ze=U.size,Zn=U.color,Me=null,this},h.setCurrentTransformationMatrix=function(U){return Z(U.toString()+" cm"),this},h.comment=function(U){return Z("#"+U),this};var Pr=function(U,_e){var it=U||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return it},set:function(cr){isNaN(cr)||(it=parseFloat(cr))}});var bt=_e||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return bt},set:function(cr){isNaN(cr)||(bt=parseFloat(cr))}});var Qt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Qt},set:function(cr){Qt=cr.toString()}}),this},Gr=function(U,_e,it,bt){Pr.call(this,U,_e),this.type="rect";var Qt=it||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Qt},set:function(jr){isNaN(jr)||(Qt=parseFloat(jr))}});var cr=bt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return cr},set:function(jr){isNaN(jr)||(cr=parseFloat(jr))}}),this},$n=function(){this.page=me,this.currentPage=R,this.pages=ve.slice(0),this.pagesContext=ye.slice(0),this.x=Fe,this.y=je,this.matrix=We,this.width=aa(R),this.height=Zo(R),this.outputDestination=Xe,this.id="",this.objectNumber=-1};$n.prototype.restore=function(){me=this.page,R=this.currentPage,ye=this.pagesContext,ve=this.pages,Fe=this.x,je=this.y,We=this.matrix,Wa(R,this.width),ki(R,this.height),Xe=this.outputDestination};var Nn=function(U,_e,it,bt,Qt){Ft.push(new $n),me=R=0,ve=[],Fe=U,je=_e,We=Qt,Or([it,bt])};for(var Fn in h.beginFormObject=function(U,_e,it,bt,Qt){return Nn(U,_e,it,bt,Qt),this},h.endFormObject=function(U){return function(_e){if(Pt[_e])Ft.pop().restore();else{var it=new $n,bt="Xo"+(Object.keys(yt).length+1).toString(10);it.id=bt,Pt[_e]=bt,yt[bt]=it,mt.publish("addFormObject",it),Ft.pop().restore()}}(U),this},h.doFormObject=function(U,_e){var it=yt[Pt[U]];return Z("q"),Z(_e.toString()+" cm"),Z("/"+it.id+" Do"),Z("Q"),this},h.getFormObject=function(U){var _e=yt[Pt[U]];return{x:_e.x,y:_e.y,width:_e.width,height:_e.height,matrix:_e.matrix}},h.save=function(U,_e){return U=U||"generated.pdf",(_e=_e||{}).returnPromise=_e.returnPromise||!1,_e.returnPromise===!1?(mp(_r(cn()),U),typeof mp.unload=="function"&&Yn.setTimeout&&setTimeout(mp.unload,911),this):new Promise(function(it,bt){try{var Qt=mp(_r(cn()),U);typeof mp.unload=="function"&&Yn.setTimeout&&setTimeout(mp.unload,911),it(Qt)}catch(cr){bt(cr.message)}})},An.API)An.API.hasOwnProperty(Fn)&&(Fn==="events"&&An.API.events.length?function(U,_e){var it,bt,Qt;for(Qt=_e.length-1;Qt!==-1;Qt--)it=_e[Qt][0],bt=_e[Qt][1],U.subscribe.apply(U,[it].concat(typeof bt=="function"?[bt]:bt))}(mt,An.API.events):h[Fn]=An.API[Fn]);function aa(U){return ye[U].mediaBox.topRightX-ye[U].mediaBox.bottomLeftX}function Wa(U,_e){ye[U].mediaBox.topRightX=_e+ye[U].mediaBox.bottomLeftX}function Zo(U){return ye[U].mediaBox.topRightY-ye[U].mediaBox.bottomLeftY}function ki(U,_e){ye[U].mediaBox.topRightY=_e+ye[U].mediaBox.bottomLeftY}var el=h.getPageWidth=function(U){return aa(U=U||R)/dt},Cc=h.setPageWidth=function(U,_e){Wa(U,_e*dt)},ea=h.getPageHeight=function(U){return Zo(U=U||R)/dt},zc=h.setPageHeight=function(U,_e){ki(U,_e*dt)};return h.internal={pdfEscape:tr,getStyle:$t,getFont:dr,getFontSize:vt,getCharSpace:pr,getTextColor:wn,getLineHeight:fr,getLineHeightFactor:Hr,getLineWidth:St,write:ke,getHorizontalCoordinate:br,getVerticalCoordinate:hr,getCoordinateString:Ir,getVerticalCoordinateString:en,collections:{},newObject:ct,newAdditionalObject:X,newObjectDeferred:st,newObjectDeferredBegin:z,getFilters:Pe,putStream:xe,events:mt,scaleFactor:dt,pageSize:{getWidth:function(){return el(R)},setWidth:function(U){Cc(R,U)},getHeight:function(){return ea(R)},setHeight:function(U){zc(R,U)}},encryptionOptions:u,encryption:Fr,getEncryptor:function(U){return u!==null?Fr.encryptor(U,0):function(_e){return _e}},output:Jt,getNumberOfPages:dn,get pages(){return ve},out:Z,f2:k,f3:T,getPageInfo:Er,getPageInfoByObjId:Lr,getCurrentPageInfo:Ln,getPDFVersion:p,Point:Pr,Rectangle:Gr,Matrix:Oe,hasHotfix:ir},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return el(R)},set:function(U){Cc(R,U)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return ea(R)},set:function(U){zc(R,U)},enumerable:!0,configurable:!0}),(function(U){for(var _e=0,it=Ee.length;_e<it;_e++){var bt=Bt.call(this,U[_e][0],U[_e][1],U[_e][2],Ee[_e][3],!0);f===!1&&(A[bt]=!0);var Qt=U[_e][0].split("-");wt({id:bt,fontName:Qt[0],fontStyle:Qt[1]||""})}mt.publish("addFonts",{fonts:ee,dictionary:Ve})}).call(h,Ee),Ye="F1",zr(a,r),mt.publish("initialized"),h}Ox.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Ox.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Ox.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},Ox.prototype.processOwnerPassword=function(t,e){return Yk(Xk(e).substr(0,5),t)},Ox.prototype.encryptor=function(t,e){var r=Xk(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return Yk(r,n)}},O2.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||ms(t)!==ms(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},An.API={events:[]},An.version="3.0.4";var Ri=An.API,sR=1,Qg=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},mx=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ia=function(t){return t.toFixed(2)},m0=function(t){return t.toFixed(5)};Ri.__acroform__={};var pd=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},MV=function(t){return t*sR},Kf=function(t){var e=new Gre,r=vn.internal.getHeight(t)||0,n=vn.internal.getWidth(t)||0;return e.BBox=[0,0,Number(ia(n)),Number(ia(r))],e},tPe=Ri.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},rPe=Ri.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},nPe=Ri.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},so=Ri.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return nPe(t,e-1)},io=Ri.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return tPe(t,e-1)},oo=Ri.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return rPe(t,e-1)},aPe=Ri.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,a=t[0],s=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=r(a)||0,c.lowerLeft_Y=n(s+l)||0,c.upperRight_X=r(a+o)||0,c.upperRight_Y=n(s)||0,[Number(ia(c.lowerLeft_X)),Number(ia(c.lowerLeft_Y)),Number(ia(c.upperRight_X)),Number(ia(c.upperRight_Y))]},sPe=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=Jk(t,r),a=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+a+" "+ia(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=Kf(t);return s.scope=t.scope,s.stream=e.join(`
`),s}},Jk=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},a=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");a=t.multiline?a.map(function(k){return k.split(`
`)}):a.map(function(k){return[k]});var s=r,o=vn.internal.getHeight(t)||0;o=o<0?-o:o;var l=vn.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(k,T,P){if(k+1<a.length){var q=T+" "+a[k+1][0];return UC(q,t,P).width<=l-4}return!1};s++;e:for(;s>0;){e="",s--;var d,u,f=UC("3",t,s).height,A=t.multiline?o-s:(o-f)/2,h=A+=2,m=0,p=0,x=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+UC(e,t,s=12).width+", FieldWidth:"+l+`
`;break}for(var v="",y=0,b=0;b<a.length;b++)if(a.hasOwnProperty(b)){var w=!1;if(a[b].length!==1&&x!==a[b].length-1){if((f+2)*(y+2)+2>o)continue e;v+=a[b][x],w=!0,p=b,b--}else{v=(v+=a[b][x]+" ").substr(v.length-1)==" "?v.substr(0,v.length-1):v;var I=parseInt(b),j=c(I,v,s),N=b>=a.length-1;if(j&&!N){v+=" ",x=0;continue}if(j||N){if(N)p=I;else if(t.multiline&&(f+2)*(y+2)+2>o)continue e}else{if(!t.multiline||(f+2)*(y+2)+2>o)continue e;p=I}}for(var S="",E=m;E<=p;E++){var B=a[E];if(t.multiline){if(E===p){S+=B[x]+" ",x=(x+1)%B.length;continue}if(E===m){S+=B[B.length-1]+" ";continue}}S+=B[0]+" "}switch(S=S.substr(S.length-1)==" "?S.substr(0,S.length-1):S,u=UC(S,t,s).width,t.textAlign){case"right":d=l-u-2;break;case"center":d=(l-u)/2;break;default:d=2}e+=ia(d)+" "+ia(h)+` Td
`,e+="("+Qg(S)+`) Tj
`,e+=-ia(d)+` 0 Td
`,h=-(s+2),u=0,m=w?p:p+1,y++,v=""}break}return n.text=e,n.fontSize=s,n},UC=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),a=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},iPe={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},oPe=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},lPe=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Ff.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(iPe)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");sR=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new Kre,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var s=n[a];s.objId=void 0,s.hasAnnotation&&oPe(s,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,a){var s=!n;for(var o in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],d=l.Rect;if(l.Rect&&(l.Rect=aPe(l.Rect,a)),a.internal.newObjectDeferredBegin(l.objId,!0),l.DA=vn.createDefaultAppearanceStream(l),ms(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=d,l.hasAppearanceStream&&!l.appearanceStreamContent){var u=sPe(l);c.push({key:"AP",value:"<</N "+u+">>"}),a.internal.acroformPlugin.xForms.push(u)}if(l.appearanceStreamContent){var f="";for(var A in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(A)){var h=l.appearanceStreamContent[A];if(f+="/"+A+" ",f+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var o in h)if(h.hasOwnProperty(o)){var m=h[o];typeof m=="function"&&(m=m.call(a,l)),f+="/"+o+" "+m+" ",a.internal.acroformPlugin.xForms.indexOf(m)>=0||a.internal.acroformPlugin.xForms.push(m)}}else typeof(m=h)=="function"&&(m=m.call(a,l)),f+="/"+o+" "+m,a.internal.acroformPlugin.xForms.indexOf(m)>=0||a.internal.acroformPlugin.xForms.push(m);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}a.internal.putStream({additionalKeyValues:c,objectId:l.objId}),a.internal.out("endobj")}s&&function(p,x){for(var v in p)if(p.hasOwnProperty(v)){var y=v,b=p[v];x.internal.newObjectDeferredBegin(b.objId,!0),ms(b)==="object"&&typeof b.putStream=="function"&&b.putStream(),delete p[y]}}(a.internal.acroformPlugin.xForms,a)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},$re=Ri.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(o){return o};if(Array.isArray(t)){for(var a="[",s=0;s<t.length;s++)switch(s!==0&&(a+=" "),ms(t[s])){case"boolean":case"number":case"object":a+=t[s].toString();break;case"string":t[s].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),a+="("+Qg(n(t[s].toString()))+")"):a+=t[s].toString()}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},b5=function(t,e,r){var n=function(a){return a};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+Qg(n(t))+")"},rh=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};rh.prototype.toString=function(){return this.objId+" 0 R"},rh.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},rh.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],a=this[n];a&&(Array.isArray(a)?t.push({key:n,value:$re(a,this.objId,this.scope)}):a instanceof rh?(a.scope=this.scope,t.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&t.push({key:n,value:a}))}return t};var Gre=function(){rh.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};pd(Gre,rh);var Kre=function(){rh.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Qg(r(t))+")"}},set:function(r){t=r}})};pd(Kre,rh);var Ff=function t(){rh.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute F supplied.');e=v}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!so(e,3)},set:function(v){v?this.F=io(e,3):this.F=oo(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute Ff supplied.');r=v}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(v){n=v!==void 0?v:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(v){n[0]=v}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(v){n[1]=v}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(v){n[2]=v}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(v){n[3]=v}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(v){switch(v){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=v;break;default:throw new Error('Invalid value "'+v+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof QS)return;s="FieldObject"+t.FieldNum++}var v=function(y){return y};return this.scope&&(v=this.scope.internal.getEncryptor(this.objId)),"("+Qg(v(s))+")"},set:function(v){s=v.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(v){s=v}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(v){o=v}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(v){l=v}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(v){c=v}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/sR:d},set:function(v){d=v}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(v){u=v}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof QS||this instanceof pm))return b5(f,this.objId,this.scope)},set:function(v){v=v.toString(),f=v}});var A=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(A)return this instanceof Do==0?b5(A,this.objId,this.scope):A},set:function(v){v=v.toString(),A=this instanceof Do==0?v.substr(0,1)==="("?mx(v.substr(1,v.length-2)):mx(v):v}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Do==1?mx(A.substr(1,A.length-1)):A},set:function(v){v=v.toString(),A=this instanceof Do==1?"/"+v:v}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(v){this.V=v}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Do==0?b5(h,this.objId,this.scope):h},set:function(v){v=v.toString(),h=this instanceof Do==0?v.substr(0,1)==="("?mx(v.substr(1,v.length-2)):mx(v):v}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Do==1?mx(h.substr(1,h.length-1)):h},set:function(v){v=v.toString(),h=this instanceof Do==1?"/"+v:v}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,p=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return p},set:function(v){v=!!v,p=v}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(v){m=v}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!so(this.Ff,1)},set:function(v){v?this.Ff=io(this.Ff,1):this.Ff=oo(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!so(this.Ff,2)},set:function(v){v?this.Ff=io(this.Ff,2):this.Ff=oo(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!so(this.Ff,3)},set:function(v){v?this.Ff=io(this.Ff,3):this.Ff=oo(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(x!==null)return x},set:function(v){if([0,1,2].indexOf(v)===-1)throw new Error('Invalid value "'+v+'" for attribute Q supplied.');x=v}}),Object.defineProperty(this,"textAlign",{get:function(){var v;switch(x){case 0:default:v="left";break;case 1:v="center";break;case 2:v="right"}return v},configurable:!0,enumerable:!0,set:function(v){switch(v){case"right":case 2:x=2;break;case"center":case 1:x=1;break;default:x=0}}})};pd(Ff,rh);var Vp=function(){Ff.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return $re(e,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=function(s,o,l){l||(l=1);for(var c,d=[];c=o.exec(s);)d.push(c[l]);return d}(n,/\((.*?)\)/g)),e=a}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!so(this.Ff,18)},set:function(r){r?this.Ff=io(this.Ff,18):this.Ff=oo(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!so(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=io(this.Ff,19):this.Ff=oo(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!so(this.Ff,20)},set:function(r){r?(this.Ff=io(this.Ff,20),e.sort()):this.Ff=oo(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!so(this.Ff,22)},set:function(r){r?this.Ff=io(this.Ff,22):this.Ff=oo(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!so(this.Ff,23)},set:function(r){r?this.Ff=io(this.Ff,23):this.Ff=oo(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!so(this.Ff,27)},set:function(r){r?this.Ff=io(this.Ff,27):this.Ff=oo(this.Ff,27)}}),this.hasAppearanceStream=!1};pd(Vp,Ff);var Hp=function(){Vp.call(this),this.fontName="helvetica",this.combo=!1};pd(Hp,Vp);var $p=function(){Hp.call(this),this.combo=!0};pd($p,Hp);var Fb=function(){$p.call(this),this.edit=!0};pd(Fb,$p);var Do=function(){Ff.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!so(this.Ff,15)},set:function(r){r?this.Ff=io(this.Ff,15):this.Ff=oo(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!so(this.Ff,16)},set:function(r){r?this.Ff=io(this.Ff,16):this.Ff=oo(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!so(this.Ff,17)},set:function(r){r?this.Ff=io(this.Ff,17):this.Ff=oo(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!so(this.Ff,26)},set:function(r){r?this.Ff=io(this.Ff,26):this.Ff=oo(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,a=[];for(n in a.push("<<"),e)a.push("/"+n+" ("+Qg(r(e[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){ms(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};pd(Do,Ff);var Ob=function(){Do.call(this),this.pushButton=!0};pd(Ob,Do);var Gp=function(){Do.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};pd(Gp,Do);var QS=function(){var t,e;Ff.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(a){t=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(a){e=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(l){return l};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),n)o.push("/"+s+" ("+Qg(a(n[s]))+")");return o.push(">>"),o.join(`
`)},set:function(a){ms(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=vn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};pd(QS,Ff),Gp.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},Gp.prototype.createOption=function(t){var e=new QS;return e.Parent=this,e.optionName=t,this.Kids.push(e),cPe.call(this.scope,e),e};var Db=function(){Do.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=vn.CheckBox.createAppearanceStream()};pd(Db,Do);var pm=function(){Ff.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!so(this.Ff,13)},set:function(e){e?this.Ff=io(this.Ff,13):this.Ff=oo(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!so(this.Ff,21)},set:function(e){e?this.Ff=io(this.Ff,21):this.Ff=oo(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!so(this.Ff,23)},set:function(e){e?this.Ff=io(this.Ff,23):this.Ff=oo(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!so(this.Ff,24)},set:function(e){e?this.Ff=io(this.Ff,24):this.Ff=oo(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!so(this.Ff,25)},set:function(e){e?this.Ff=io(this.Ff,25):this.Ff=oo(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!so(this.Ff,26)},set:function(e){e?this.Ff=io(this.Ff,26):this.Ff=oo(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};pd(pm,Ff);var Rb=function(){pm.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!so(this.Ff,14)},set:function(t){t?this.Ff=io(this.Ff,14):this.Ff=oo(this.Ff,14)}}),this.password=!0};pd(Rb,pm);var vn={CheckBox:{createAppearanceStream:function(){return{N:{On:vn.CheckBox.YesNormal},D:{On:vn.CheckBox.YesPushDown,Off:vn.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Kf(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,a=t.scope.__private__.encodeColorString(t.color),s=Jk(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+ia(vn.internal.getWidth(t))+" "+ia(vn.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+ia(s.fontSize)+" Tf "+a),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=Kf(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),a=[],s=vn.internal.getHeight(t),o=vn.internal.getWidth(t),l=Jk(t,t.caption);return a.push("1 g"),a.push("0 0 "+ia(o)+" "+ia(s)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+ia(o-1)+" "+ia(s-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+ia(l.fontSize)+" Tf "+n),a.push(l.text),a.push("ET"),a.push("Q"),e.stream=a.join(`
`),e},OffPushDown:function(t){var e=Kf(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ia(vn.internal.getWidth(t))+" "+ia(vn.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:vn.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=vn.RadioButton.Circle.YesNormal,e.D[t]=vn.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Kf(t);e.scope=t.scope;var r=[],n=vn.internal.getWidth(t)<=vn.internal.getHeight(t)?vn.internal.getWidth(t)/4:vn.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var a=vn.internal.Bezier_C,s=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+m0(vn.internal.getWidth(t)/2)+" "+m0(vn.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Kf(t);e.scope=t.scope;var r=[],n=vn.internal.getWidth(t)<=vn.internal.getHeight(t)?vn.internal.getWidth(t)/4:vn.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*vn.internal.Bezier_C).toFixed(5)),o=Number((n*vn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+m0(vn.internal.getWidth(t)/2)+" "+m0(vn.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+m0(vn.internal.getWidth(t)/2)+" "+m0(vn.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Kf(t);e.scope=t.scope;var r=[],n=vn.internal.getWidth(t)<=vn.internal.getHeight(t)?vn.internal.getWidth(t)/4:vn.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*vn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+m0(vn.internal.getWidth(t)/2)+" "+m0(vn.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:vn.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=vn.RadioButton.Cross.YesNormal,e.D[t]=vn.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Kf(t);e.scope=t.scope;var r=[],n=vn.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+ia(vn.internal.getWidth(t)-2)+" "+ia(vn.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(ia(n.x1.x)+" "+ia(n.x1.y)+" m"),r.push(ia(n.x2.x)+" "+ia(n.x2.y)+" l"),r.push(ia(n.x4.x)+" "+ia(n.x4.y)+" m"),r.push(ia(n.x3.x)+" "+ia(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Kf(t);e.scope=t.scope;var r=vn.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+ia(vn.internal.getWidth(t))+" "+ia(vn.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+ia(vn.internal.getWidth(t)-2)+" "+ia(vn.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(ia(r.x1.x)+" "+ia(r.x1.y)+" m"),n.push(ia(r.x2.x)+" "+ia(r.x2.y)+" l"),n.push(ia(r.x4.x)+" "+ia(r.x4.y)+" m"),n.push(ia(r.x3.x)+" "+ia(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Kf(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ia(vn.internal.getWidth(t))+" "+ia(vn.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};vn.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=vn.internal.getWidth(t),r=vn.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},vn.internal.getWidth=function(t){var e=0;return ms(t)==="object"&&(e=MV(t.Rect[2])),e},vn.internal.getHeight=function(t){var e=0;return ms(t)==="object"&&(e=MV(t.Rect[3])),e};var cPe=Ri.addField=function(t){if(lPe(this,t),!(t instanceof Ff))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Ri.AcroFormChoiceField=Vp,Ri.AcroFormListBox=Hp,Ri.AcroFormComboBox=$p,Ri.AcroFormEditBox=Fb,Ri.AcroFormButton=Do,Ri.AcroFormPushButton=Ob,Ri.AcroFormRadioButton=Gp,Ri.AcroFormCheckBox=Db,Ri.AcroFormTextField=pm,Ri.AcroFormPasswordField=Rb,Ri.AcroFormAppearance=vn,Ri.AcroForm={ChoiceField:Vp,ListBox:Hp,ComboBox:$p,EditBox:Fb,Button:Do,PushButton:Ob,RadioButton:Gp,CheckBox:Db,TextField:pm,PasswordField:Rb,Appearance:vn},An.AcroForm={ChoiceField:Vp,ListBox:Hp,ComboBox:$p,EditBox:Fb,Button:Do,PushButton:Ob,RadioButton:Gp,CheckBox:Db,TextField:pm,PasswordField:Rb,Appearance:vn};var dPe=An.AcroForm;function qre(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=t.__addimage__.getImageFileTypeByImageData=function(k,T){var P,q,de,ce,le,he=r;if((T=T||r)==="RGBA"||k.data!==void 0&&k.data instanceof Uint8ClampedArray&&"height"in k&&"width"in k)return"RGBA";if(j(k))for(le in n)for(de=n[le],P=0;P<de.length;P+=1){for(ce=!0,q=0;q<de[P].length;q+=1)if(de[P][q]!==void 0&&de[P][q]!==k[q]){ce=!1;break}if(ce===!0){he=le;break}}else for(le in n)for(de=n[le],P=0;P<de.length;P+=1){for(ce=!0,q=0;q<de[P].length;q+=1)if(de[P][q]!==void 0&&de[P][q]!==k.charCodeAt(q)){ce=!1;break}if(ce===!0){he=le;break}}return he===r&&T!==r&&(he=T),he},s=function k(T){for(var P=this.internal.write,q=this.internal.putStream,de=(0,this.internal.getFilters)();de.indexOf("FlateEncode")!==-1;)de.splice(de.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var ce=[];if(ce.push({key:"Type",value:"/XObject"}),ce.push({key:"Subtype",value:"/Image"}),ce.push({key:"Width",value:T.width}),ce.push({key:"Height",value:T.height}),T.colorSpace===v.INDEXED?ce.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(ce.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===v.DEVICE_CMYK&&ce.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ce.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&ce.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)&&T.transparency.length>0){for(var le="",he=0,ae=T.transparency.length;he<ae;he++)le+=T.transparency[he]+" "+T.transparency[he]+" ";ce.push({key:"Mask",value:"["+le+"]"})}T.sMask!==void 0&&ce.push({key:"SMask",value:T.objectId+1+" 0 R"});var Ce=T.filter!==void 0?["/"+T.filter]:void 0;if(q({data:T.data,additionalKeyValues:ce,alreadyAppliedFilters:Ce,objectId:T.objectId}),P("endobj"),"sMask"in T&&T.sMask!==void 0){var De,O=(De=T.sMaskBitsPerComponent)!==null&&De!==void 0?De:T.bitsPerComponent,R={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:O,data:T.sMask};"filter"in T&&(R.decodeParameters="/Predictor ".concat(T.predictor," /Colors 1 /BitsPerComponent ").concat(O," /Columns ").concat(T.width),R.filter=T.filter),k.call(this,R)}if(T.colorSpace===v.INDEXED){var G=this.internal.newObject();q({data:S(new Uint8Array(T.palette)),objectId:G}),P("endobj")}},o=function(){var k=this.internal.collections[e+"images"];for(var T in k)s.call(this,k[T])},l=function(){var k,T=this.internal.collections[e+"images"],P=this.internal.write;for(var q in T)P("/I"+(k=T[q]).index,k.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},d=function(){var k=this.internal.collections[e+"images"];return c.call(this),k},u=function(){return Object.keys(this.internal.collections[e+"images"]).length},f=function(k){return typeof t["process"+k.toUpperCase()]=="function"},A=function(k){return ms(k)==="object"&&k.nodeType===1},h=function(k,T){if(k.nodeName==="IMG"&&k.hasAttribute("src")){var P=""+k.getAttribute("src");if(P.indexOf("data:image/")===0)return NE(unescape(P).split("base64,").pop());var q=t.loadFile(P,!0);if(q!==void 0)return q}if(k.nodeName==="CANVAS"){if(k.width===0||k.height===0)throw new Error("Given canvas must have data. Canvas width: "+k.width+", height: "+k.height);var de;switch(T){case"PNG":de="image/png";break;case"WEBP":de="image/webp";break;default:de="image/jpeg"}return NE(k.toDataURL(de,1).split("base64,").pop())}},m=function(k){var T=this.internal.collections[e+"images"];if(T){for(var P in T)if(k===T[P].alias)return T[P]}},p=function(k,T,P){return k||T||(k=-96,T=-96),k<0&&(k=-1*P.width*72/k/this.internal.scaleFactor),T<0&&(T=-1*P.height*72/T/this.internal.scaleFactor),k===0&&(k=T*P.width/P.height),T===0&&(T=k*P.height/P.width),[k,T]},x=function(k,T,P,q,de,ce){var le=p.call(this,P,q,de),he=this.internal.getCoordinateString,ae=this.internal.getVerticalCoordinateString,Ce=d.call(this);if(P=le[0],q=le[1],Ce[de.index]=de,ce){ce*=Math.PI/180;var De=Math.cos(ce),O=Math.sin(ce),R=function(M){return M.toFixed(4)},G=[R(De),R(O),R(-1*O),R(De),0,0,"cm"]}this.internal.write("q"),ce?(this.internal.write([1,"0","0",1,he(k),ae(T+q),"cm"].join(" ")),this.internal.write(G.join(" ")),this.internal.write([he(P),"0","0",he(q),"0","0","cm"].join(" "))):this.internal.write([he(P),"0","0",he(q),he(k),ae(T+q),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+de.index+" Do"),this.internal.write("Q")},v=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=t.__addimage__.sHashCode=function(k){var T,P,q=0;if(typeof k=="string")for(P=k.length,T=0;T<P;T++)q=(q<<5)-q+k.charCodeAt(T),q|=0;else if(j(k))for(P=k.byteLength/2,T=0;T<P;T++)q=(q<<5)-q+k[T],q|=0;return q},w=t.__addimage__.validateStringAsBase64=function(k){(k=k||"").toString().trim();var T=!0;return k.length===0&&(T=!1),k.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(k.substr(0,k.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(k.substr(-2))===!1&&(T=!1),T},I=t.__addimage__.extractImageFromDataUrl=function(k){if(k==null||!(k=k.trim()).startsWith("data:"))return null;var T=k.indexOf(",");return T<0?null:k.substring(0,T).trim().endsWith("base64")?k.substring(T+1):null};t.__addimage__.isArrayBuffer=function(k){return k instanceof ArrayBuffer};var j=t.__addimage__.isArrayBufferView=function(k){return k instanceof Int8Array||k instanceof Uint8Array||k instanceof Uint8ClampedArray||k instanceof Int16Array||k instanceof Uint16Array||k instanceof Int32Array||k instanceof Uint32Array||k instanceof Float32Array||k instanceof Float64Array},N=t.__addimage__.binaryStringToUint8Array=function(k){for(var T=k.length,P=new Uint8Array(T),q=0;q<T;q++)P[q]=k.charCodeAt(q);return P},S=t.__addimage__.arrayBufferToBinaryString=function(k){for(var T="",P=j(k)?k:new Uint8Array(k),q=0;q<P.length;q+=8192)T+=String.fromCharCode.apply(null,P.subarray(q,q+8192));return T};t.addImage=function(){var k,T,P,q,de,ce,le,he,ae;if(typeof arguments[1]=="number"?(T=r,P=arguments[1],q=arguments[2],de=arguments[3],ce=arguments[4],le=arguments[5],he=arguments[6],ae=arguments[7]):(T=arguments[1],P=arguments[2],q=arguments[3],de=arguments[4],ce=arguments[5],le=arguments[6],he=arguments[7],ae=arguments[8]),ms(k=arguments[0])==="object"&&!A(k)&&"imageData"in k){var Ce=k;k=Ce.imageData,T=Ce.format||T||r,P=Ce.x||P||0,q=Ce.y||q||0,de=Ce.w||Ce.width||de,ce=Ce.h||Ce.height||ce,le=Ce.alias||le,he=Ce.compression||he,ae=Ce.rotation||Ce.angle||ae}var De=this.internal.getFilters();if(he===void 0&&De.indexOf("FlateEncode")!==-1&&(he="SLOW"),isNaN(P)||isNaN(q))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var O=E.call(this,k,T,le,he);return x.call(this,P,q,de,ce,O,ae),this};var E=function(k,T,P,q){var de,ce,le;if(typeof k=="string"&&a(k)===r){k=unescape(k);var he=B(k,!1);(he!==""||(he=t.loadFile(k,!0))!==void 0)&&(k=he)}if(A(k)&&(k=h(k,T)),T=a(k,T),!f(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((le=P)==null||le.length===0)&&(P=function(ae){return typeof ae=="string"||j(ae)?b(ae):j(ae.data)?b(ae.data):null}(k)),(de=m.call(this,P))||(k instanceof Uint8Array||T==="RGBA"||(ce=k,k=N(k)),de=this["process"+T.toUpperCase()](k,u.call(this),P,function(ae){return ae&&typeof ae=="string"&&(ae=ae.toUpperCase()),ae in t.image_compression?ae:y.NONE}(q),ce)),!de)throw new Error("An unknown error occurred whilst processing the image.");return de},B=t.__addimage__.convertBase64ToBinaryString=function(k,T){T=typeof T!="boolean"||T;var P,q="";if(typeof k=="string"){var de;P=(de=I(k))!==null&&de!==void 0?de:k;try{q=NE(P)}catch(ce){if(T)throw w(P)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ce.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return q};t.getImageProperties=function(k){var T,P,q="";if(A(k)&&(k=h(k)),typeof k=="string"&&a(k)===r&&((q=B(k,!1))===""&&(q=t.loadFile(k)||""),k=q),P=a(k),!f(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(k instanceof Uint8Array||(k=N(k)),!(T=this["process"+P.toUpperCase()](k)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=P,T}})(An.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};An.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,a,s,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),d=r.pageContext.annotations,u=!1,f=0;f<d.length&&!u;f++)switch((n=d[f]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var A=0;A<d.length;A++){n=d[A];var h=this.internal.pdfEscape,m=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),x=this.internal.newAdditionalObject(),v=this.internal.getEncryptor(p.objId),y=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+h(v(n.contents))+")",s+=" /Popup "+x.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+h(v(y))+") >>",p.content=s;var b=p.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+b,n.open&&(s+=" /Open true"),s+=" >>",x.content=s,this.internal.write(p.objId,"0 R",x.objId,"0 R");break;case"freetext":a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var w=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+h(m(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+w+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var I=this.annotations._nameMap[n.options.name];n.options.pageNumber=I.page,n.options.top=I.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+h(m(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;default:var j=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+j+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,a,s,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:d(n),w:c(r+a),h:d(n+s)},options:o,type:"link"})},t.textWithLink=function(r,n,a,s){var o,l,c=this.getTextWidth(r),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){l=s.maxWidth;var u=this.splitTextToSize(r,l).length;o=Math.ceil(d*u)}else l=c,o=d;return this.text(r,n,a,s),a+=.2*d,s.align==="center"&&(n-=c/2),s.align==="right"&&(n-=c),this.link(n,a-d,l,o,s),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(An.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];t.__arabicParser__={};var s=t.__arabicParser__.isInArabicSubstitutionA=function(p){return e[p.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(p){return typeof p=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(p)},l=t.__arabicParser__.isArabicEndLetter=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(p){return o(p)&&a.indexOf(p.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length>=1};var d=t.__arabicParser__.arabicLetterHasFinalForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length>=3};var u=t.__arabicParser__.arabicLetterHasMedialForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length==4},f=t.__arabicParser__.resolveLigatures=function(p){var x=0,v=r,y="",b=0;for(x=0;x<p.length;x+=1)v[p.charCodeAt(x)]!==void 0?(b++,typeof(v=v[p.charCodeAt(x)])=="number"&&(y+=String.fromCharCode(v),v=r,b=0),x===p.length-1&&(v=r,y+=p.charAt(x-(b-1)),x-=b-1,b=0)):(v=r,y+=p.charAt(x-b),x-=b,b=0);return y};t.__arabicParser__.isArabicDiacritic=function(p){return p!==void 0&&n[p.charCodeAt(0)]!==void 0};var A=t.__arabicParser__.getCorrectForm=function(p,x,v){return o(p)?s(p)===!1?-1:!d(p)||!o(x)&&!o(v)||!o(v)&&l(x)||l(p)&&!o(x)||l(p)&&c(x)||l(p)&&l(x)?0:u(p)&&o(x)&&!l(x)&&o(v)&&d(v)?3:l(p)||!o(v)?1:2:-1},h=function(p){var x=0,v=0,y=0,b="",w="",I="",j=(p=p||"").split("\\s+"),N=[];for(x=0;x<j.length;x+=1){for(N.push(""),v=0;v<j[x].length;v+=1)b=j[x][v],w=j[x][v-1],I=j[x][v+1],o(b)?(y=A(b,w,I),N[x]+=y!==-1?String.fromCharCode(e[b.charCodeAt(0)][y]):b):N[x]+=b;N[x]=f(N[x])}return N.join(" ")},m=t.__arabicParser__.processArabic=t.processArabic=function(){var p,x=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,v=[];if(Array.isArray(x)){var y=0;for(v=[],y=0;y<x.length;y+=1)Array.isArray(x[y])?v.push([h(x[y][0]),x[y][1],x[y][2]]):v.push([h(x[y])]);p=v}else p=h(x);return typeof arguments[0]=="string"?p:(arguments[0].text=p,arguments[0])};t.events.push(["preProcessText",m])}(An.API),An.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(l){a=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(l){s=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(An.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(p){c=p}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(p){d=p}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(p){u=p}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(p){f=p}});var A=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return A},set:function(p){A=p}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(p){h=p}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(p){m=p}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,d){n.call(this);var u=(d=d||{}).fontSize||this.getFontSize(),f=d.font||this.getFont(),A=d.scaleFactor||this.internal.scaleFactor,h=0,m=0,p=0,x=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var v=d.maxWidth;v>0?typeof c=="string"?c=this.splitTextToSize(c,v):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(b,w){return b.concat(x.splitTextToSize(w,v))},[])):c=Array.isArray(c)?c:[c];for(var y=0;y<c.length;y++)h<(p=this.getStringUnitWidth(c[y],{font:f})*u)&&(h=p);return h!==0&&(m=c.length),{w:h/=A,h:Math.max((m*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/A,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var d=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,f=this.internal.__cell__.margins||e,A=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===c.lineNumber?(c.x=(d.x||0)+(d.width||0),c.y=d.y||0):d.y+d.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,h&&A&&(this.printHeaderRow(c.lineNumber,!0),c.y+=A[0].height)):c.y=d.y+d.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};t.table=function(c,d,u,f,A){if(n.call(this),!u)throw new Error("No data for PDF table.");var h,m,p,x,v=[],y=[],b=[],w={},I={},j=[],N=[],S=(A=A||{}).autoSize||!1,E=A.printHeaders!==!1,B=A.css&&A.css["font-size"]!==void 0?16*A.css["font-size"]:A.fontSize||12,k=A.margins||Object.assign({width:this.getPageWidth()},e),T=typeof A.padding=="number"?A.padding:3,P=A.headerBackgroundColor||"#c8c8c8",q=A.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=E,this.internal.__cell__.margins=k,this.internal.__cell__.table_font_size=B,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=P,this.internal.__cell__.headerTextColor=q,this.setFontSize(B),f==null)y=v=Object.keys(u[0]),b=v.map(function(){return"left"});else if(Array.isArray(f)&&ms(f[0])==="object")for(v=f.map(function(Ce){return Ce.name}),y=f.map(function(Ce){return Ce.prompt||Ce.name||""}),b=f.map(function(Ce){return Ce.align||"left"}),h=0;h<f.length;h+=1)I[f[h].name]=.7499990551181103*f[h].width;else Array.isArray(f)&&typeof f[0]=="string"&&(y=v=f,b=v.map(function(){return"left"}));if(S||Array.isArray(f)&&typeof f[0]=="string")for(h=0;h<v.length;h+=1){for(w[x=v[h]]=u.map(function(Ce){return Ce[x]}),this.setFont(void 0,"bold"),j.push(this.getTextDimensions(y[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=w[x],this.setFont(void 0,"normal"),p=0;p<m.length;p+=1)j.push(this.getTextDimensions(m[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);I[x]=Math.max.apply(null,j)+T+T,j=[]}if(E){var de={};for(h=0;h<v.length;h+=1)de[v[h]]={},de[v[h]].text=y[h],de[v[h]].align=b[h];var ce=l.call(this,de,I);N=v.map(function(Ce){return new s(c,d,I[Ce],ce,de[Ce].text,void 0,de[Ce].align)}),this.setTableHeaderRow(N),this.printHeaderRow(1,!1)}var le=f.reduce(function(Ce,De){return Ce[De.name]=De.align,Ce},{});for(h=0;h<u.length;h+=1){"rowStart"in A&&A.rowStart instanceof Function&&A.rowStart({row:h,data:u[h]},this);var he=l.call(this,u[h],I);for(p=0;p<v.length;p+=1){var ae=u[h][v[p]];"cellStart"in A&&A.cellStart instanceof Function&&A.cellStart({row:h,col:p,data:ae},this),o.call(this,new s(c,d,I[v[p]],he,ae,h+2,le[v[p]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=d,this};var l=function(c,d){var u=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,A=this.internal.scaleFactor;return Object.keys(c).map(function(h){var m=c[h];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,d[h]-u-u)},this).map(function(h){return this.getLineHeightFactor()*h.length*f/A+u+u},this).reduce(function(h,m){return Math.max(h,m)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,d){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var A=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){u=this.internal.__cell__.tableHeaderRow[h].clone(),d&&(u.y=this.internal.__cell__.margins.top||0,A.push(u)),u.lineNumber=c;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,u),this.setTextColor(m)}A.length>0&&this.setTableHeaderRow(A),this.setFont(void 0,"normal"),r=!1}}(An.API);var zre={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Wre=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Zk=qre(Wre),Xre=[100,200,300,400,500,600,700,800,900],uPe=qre(Xre);function w5(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return zre[s=s||"normal"]?s:"normal"}(t.style),n=function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400}(t.weight),a=function(s){return typeof Zk[s=s||"normal"]=="number"?s:"normal"}(t.stretch);return{family:e,style:r,weight:n,stretch:a,src:t.src||[],ref:t.ref||{name:e,style:[a,r,n].join(" ")}}}function LV(t,e,r,n){var a;for(a=r;a>=0&&a<e.length;a+=n)if(t[e[a]])return t[e[a]];for(a=r;a>=0&&a<e.length;a-=n)if(t[e[a]])return t[e[a]]}var fPe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},UV={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function QV(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function VV(t){return t.trimLeft()}function hPe(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function APe(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var QC,HV,$V,px,VC,GV,KV,qV,N5=["times"];function zV(t,e,r,n,a){var s=4,o=XV;switch(a){case An.API.image_compression.FAST:s=1,o=WV;break;case An.API.image_compression.MEDIUM:s=6,o=YV;break;case An.API.image_compression.SLOW:s=9,o=JV}t=function(c,d,u,f){for(var A,h=c.length/d,m=new Uint8Array(c.length+h),p=[mPe,WV,XV,YV,JV],x=0;x<h;x+=1){var v=x*d,y=c.subarray(v,v+d);if(f)m.set(f(y,u,A),v+x);else{for(var b=p.length,w=[],I=0;I<b;I+=1)w[I]=p[I](y,u,A);var j=gPe(w.concat());m.set(w[j],v+x)}A=y}return m}(t,e,Math.ceil(r*n/8),o);var l=Kk(t,{level:s});return An.API.__addimage__.arrayBufferToBinaryString(l)}function mPe(t){var e=Array.apply([],t);return e.unshift(0),e}function WV(t,e){var r=t.length,n=[];n[0]=1;for(var a=0;a<r;a+=1){var s=t[a-e]||0;n[a+1]=t[a]-s+256&255}return n}function XV(t,e,r){var n=t.length,a=[];a[0]=2;for(var s=0;s<n;s+=1){var o=r&&r[s]||0;a[s+1]=t[s]-o+256&255}return a}function YV(t,e,r){var n=t.length,a=[];a[0]=3;for(var s=0;s<n;s+=1){var o=t[s-e]||0,l=r&&r[s]||0;a[s+1]=t[s]+256-(o+l>>>1)&255}return a}function JV(t,e,r){var n=t.length,a=[];a[0]=4;for(var s=0;s<n;s+=1){var o=pPe(t[s-e]||0,r&&r[s]||0,r&&r[s-e]||0);a[s+1]=t[s]-o+256&255}return a}function pPe(t,e,r){if(t===e&&e===r)return t;var n=Math.abs(e-r),a=Math.abs(t-r),s=Math.abs(t+e-r-r);return n<=a&&n<=s?t:a<=s?e:r}function gPe(t){var e=t.map(function(r){return r.reduce(function(n,a){return n+Math.abs(a)},0)});return e.indexOf(Math.min.apply(null,e))}function C5(t,e,r){var n=e*r,a=Math.floor(n/8),s=16-(n-8*a+r),o=(1<<r)-1;return Yre(t,a)>>s&o}function ZV(t,e,r,n){var a=r*n,s=Math.floor(a/8),o=16-(a-8*s+n),l=(1<<n)-1,c=(e&l)<<o;(function(d,u,f){if(u+1<d.byteLength)d.setUint16(u,f,!1);else{var A=f>>8&255;d.setUint8(u,A)}})(t,s,Yre(t,s)&~(l<<o)&65535|c)}function Yre(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function xPe(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,a=t[e++],s=a>>7,o=1<<1+(7&a);t[e++],t[e++];var l=null,c=null;s&&(l=e,c=o,e+=3*o);var d=!0,u=[],f=0,A=null,h=0,m=null;for(this.width=r,this.height=n;d&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,m=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var p=t[e++];f=t[e++]|t[e++]<<8,A=t[e++],1&p||(A=null),h=p>>2&7,e++;break;case 254:for(;;){if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var x=t[e++]|t[e++]<<8,v=t[e++]|t[e++]<<8,y=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,w=t[e++],I=w>>6&1,j=1<<1+(7&w),N=l,S=c,E=!1;w>>7&&(E=!0,N=e,S=j,e+=3*j);var B=e;for(e++;;){var k;if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}u.push({x,y:v,width:y,height:b,has_local_palette:E,palette_offset:N,palette_size:S,data_offset:B,data_length:e-B,transparent_index:A,interlaced:!!I,delay:f,disposal:h});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return m},this.frameInfo=function(T){if(T<0||T>=u.length)throw new Error("Frame index out of range.");return u[T]},this.decodeAndBlitFrameBGRA=function(T,P){var q=this.frameInfo(T),de=q.width*q.height,ce=new Uint8Array(de);eH(t,q.data_offset,ce,de);var le=q.palette_offset,he=q.transparent_index;he===null&&(he=256);var ae=q.width,Ce=r-ae,De=ae,O=4*(q.y*r+q.x),R=4*((q.y+q.height)*r+q.x),G=O,M=4*Ce;q.interlaced===!0&&(M+=4*r*7);for(var K=8,Y=0,D=ce.length;Y<D;++Y){var V=ce[Y];if(De===0&&(De=ae,(G+=M)>=R&&(M=4*Ce+4*r*(K-1),G=O+(ae+Ce)*(K<<1),K>>=1)),V===he)G+=4;else{var te=t[le+3*V],ve=t[le+3*V+1],Q=t[le+3*V+2];P[G++]=Q,P[G++]=ve,P[G++]=te,P[G++]=255}--De}},this.decodeAndBlitFrameRGBA=function(T,P){var q=this.frameInfo(T),de=q.width*q.height,ce=new Uint8Array(de);eH(t,q.data_offset,ce,de);var le=q.palette_offset,he=q.transparent_index;he===null&&(he=256);var ae=q.width,Ce=r-ae,De=ae,O=4*(q.y*r+q.x),R=4*((q.y+q.height)*r+q.x),G=O,M=4*Ce;q.interlaced===!0&&(M+=4*r*7);for(var K=8,Y=0,D=ce.length;Y<D;++Y){var V=ce[Y];if(De===0&&(De=ae,(G+=M)>=R&&(M=4*Ce+4*r*(K-1),G=O+(ae+Ce)*(K<<1),K>>=1)),V===he)G+=4;else{var te=t[le+3*V],ve=t[le+3*V+1],Q=t[le+3*V+2];P[G++]=te,P[G++]=ve,P[G++]=Q,P[G++]=255}--De}}}function eH(t,e,r,n){for(var a=t[e++],s=1<<a,o=s+1,l=o+1,c=a+1,d=(1<<c)-1,u=0,f=0,A=0,h=t[e++],m=new Int32Array(4096),p=null;;){for(;u<16&&h!==0;)f|=t[e++]<<u,u+=8,h===1?h=t[e++]:--h;if(u<c)break;var x=f&d;if(f>>=c,u-=c,x!==s){if(x===o)break;for(var v=x<l?x:p,y=0,b=v;b>s;)b=m[b]>>8,++y;var w=b;if(A+y+(v!==x?1:0)>n)return void Is.log("Warning, gif stream longer than expected.");r[A++]=w;var I=A+=y;for(v!==x&&(r[A++]=w),b=v;y--;)b=m[b],r[--I]=255&b,b>>=8;p!==null&&l<4096&&(m[l++]=p<<8|w,l>=d+1&&c<12&&(++c,d=d<<1|1)),p=x}else l=o+1,d=(1<<(c=a+1))-1,p=null}return A!==n&&Is.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function _5(t){var e,r,n,a,s,o=Math.floor,l=new Array(64),c=new Array(64),d=new Array(64),u=new Array(64),f=new Array(65535),A=new Array(65535),h=new Array(64),m=new Array(64),p=[],x=0,v=7,y=new Array(64),b=new Array(64),w=new Array(64),I=new Array(256),j=new Array(2048),N=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],S=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],E=[0,1,2,3,4,5,6,7,8,9,10,11],B=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],k=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],q=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],de=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ce(O,R){for(var G=0,M=0,K=new Array,Y=1;Y<=16;Y++){for(var D=1;D<=O[Y];D++)K[R[M]]=[],K[R[M]][0]=G,K[R[M]][1]=Y,M++,G++;G*=2}return K}function le(O){for(var R=O[0],G=O[1]-1;G>=0;)R&1<<G&&(x|=1<<v),G--,--v<0&&(x==255?(he(255),he(0)):he(x),v=7,x=0)}function he(O){p.push(O)}function ae(O){he(O>>8&255),he(255&O)}function Ce(O,R,G,M,K){for(var Y,D=K[0],V=K[240],te=function(Ze,ot){var vt,_t,Tt,Lt,Rt,Et,Re,Te,Ye,dt,Fe=0;for(Ye=0;Ye<8;++Ye){vt=Ze[Fe],_t=Ze[Fe+1],Tt=Ze[Fe+2],Lt=Ze[Fe+3],Rt=Ze[Fe+4],Et=Ze[Fe+5],Re=Ze[Fe+6];var je=vt+(Te=Ze[Fe+7]),We=vt-Te,ee=_t+Re,Ve=_t-Re,rt=Tt+Et,$e=Tt-Et,ie=Lt+Rt,pe=Lt-Rt,fe=je+ie,Me=je-ie,me=ee+rt,ye=ee-rt;Ze[Fe]=fe+me,Ze[Fe+4]=fe-me;var mt=.707106781*(ye+Me);Ze[Fe+2]=Me+mt,Ze[Fe+6]=Me-mt;var gt=.382683433*((fe=pe+$e)-(ye=Ve+We)),yt=.5411961*fe+gt,Pt=1.306562965*ye+gt,Ft=.707106781*(me=$e+Ve),Oe=We+Ft,be=We-Ft;Ze[Fe+5]=be+yt,Ze[Fe+3]=be-yt,Ze[Fe+1]=Oe+Pt,Ze[Fe+7]=Oe-Pt,Fe+=8}for(Fe=0,Ye=0;Ye<8;++Ye){vt=Ze[Fe],_t=Ze[Fe+8],Tt=Ze[Fe+16],Lt=Ze[Fe+24],Rt=Ze[Fe+32],Et=Ze[Fe+40],Re=Ze[Fe+48];var Ae=vt+(Te=Ze[Fe+56]),Le=vt-Te,ut=_t+Re,ct=_t-Re,st=Tt+Et,z=Tt-Et,X=Lt+Rt,re=Lt-Rt,H=Ae+X,L=Ae-X,ue=ut+st,Pe=ut-st;Ze[Fe]=H+ue,Ze[Fe+32]=H-ue;var xe=.707106781*(Pe+L);Ze[Fe+16]=L+xe,Ze[Fe+48]=L-xe;var Ge=.382683433*((H=re+z)-(Pe=ct+Le)),ze=.5411961*H+Ge,Ke=1.306562965*Pe+Ge,pt=.707106781*(ue=z+ct),ne=Le+pt,Ue=Le-pt;Ze[Fe+40]=Ue+ze,Ze[Fe+24]=Ue-ze,Ze[Fe+8]=ne+Ke,Ze[Fe+56]=ne-Ke,Fe++}for(Ye=0;Ye<64;++Ye)dt=Ze[Ye]*ot[Ye],h[Ye]=dt>0?dt+.5|0:dt-.5|0;return h}(O,R),ve=0;ve<64;++ve)m[N[ve]]=te[ve];var Q=m[0]-G;G=m[0],Q==0?le(M[0]):(le(M[A[Y=32767+Q]]),le(f[Y]));for(var Xe=63;Xe>0&&m[Xe]==0;)Xe--;if(Xe==0)return le(D),G;for(var se,Z=1;Z<=Xe;){for(var ke=Z;m[Z]==0&&Z<=Xe;)++Z;var Se=Z-ke;if(Se>=16){se=Se>>4;for(var Ee=1;Ee<=se;++Ee)le(V);Se&=15}Y=32767+m[Z],le(K[(Se<<4)+A[Y]]),le(f[Y]),Z++}return Xe!=63&&le(D),G}function De(O){O=Math.min(Math.max(O,1),100),s!=O&&(function(R){for(var G=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],M=0;M<64;M++){var K=o((G[M]*R+50)/100);K=Math.min(Math.max(K,1),255),l[N[M]]=K}for(var Y=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],D=0;D<64;D++){var V=o((Y[D]*R+50)/100);V=Math.min(Math.max(V,1),255),c[N[D]]=V}for(var te=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ve=0,Q=0;Q<8;Q++)for(var Xe=0;Xe<8;Xe++)d[ve]=1/(l[N[ve]]*te[Q]*te[Xe]*8),u[ve]=1/(c[N[ve]]*te[Q]*te[Xe]*8),ve++}(O<50?Math.floor(5e3/O):Math.floor(200-2*O)),s=O)}this.encode=function(O,R){R&&De(R),p=new Array,x=0,v=7,ae(65496),ae(65504),ae(16),he(74),he(70),he(73),he(70),he(0),he(1),he(1),he(0),ae(1),ae(1),he(0),he(0),function(){ae(65499),ae(132),he(0);for(var _t=0;_t<64;_t++)he(l[_t]);he(1);for(var Tt=0;Tt<64;Tt++)he(c[Tt])}(),function(_t,Tt){ae(65472),ae(17),he(8),ae(Tt),ae(_t),he(3),he(1),he(17),he(0),he(2),he(17),he(1),he(3),he(17),he(1)}(O.width,O.height),function(){ae(65476),ae(418),he(0);for(var _t=0;_t<16;_t++)he(S[_t+1]);for(var Tt=0;Tt<=11;Tt++)he(E[Tt]);he(16);for(var Lt=0;Lt<16;Lt++)he(B[Lt+1]);for(var Rt=0;Rt<=161;Rt++)he(k[Rt]);he(1);for(var Et=0;Et<16;Et++)he(T[Et+1]);for(var Re=0;Re<=11;Re++)he(P[Re]);he(17);for(var Te=0;Te<16;Te++)he(q[Te+1]);for(var Ye=0;Ye<=161;Ye++)he(de[Ye])}(),ae(65498),ae(12),he(3),he(1),he(0),he(2),he(17),he(3),he(17),he(0),he(63),he(0);var G=0,M=0,K=0;x=0,v=7,this.encode.displayName="_encode_";for(var Y,D,V,te,ve,Q,Xe,se,Z,ke=O.data,Se=O.width,Ee=O.height,Ze=4*Se,ot=0;ot<Ee;){for(Y=0;Y<Ze;){for(ve=Ze*ot+Y,Xe=-1,se=0,Z=0;Z<64;Z++)Q=ve+(se=Z>>3)*Ze+(Xe=4*(7&Z)),ot+se>=Ee&&(Q-=Ze*(ot+1+se-Ee)),Y+Xe>=Ze&&(Q-=Y+Xe-Ze+4),D=ke[Q++],V=ke[Q++],te=ke[Q++],y[Z]=(j[D]+j[V+256|0]+j[te+512|0]>>16)-128,b[Z]=(j[D+768|0]+j[V+1024|0]+j[te+1280|0]>>16)-128,w[Z]=(j[D+1280|0]+j[V+1536|0]+j[te+1792|0]>>16)-128;G=Ce(y,d,G,e,n),M=Ce(b,u,M,r,a),K=Ce(w,u,K,r,a),Y+=32}ot+=8}if(v>=0){var vt=[];vt[1]=v+1,vt[0]=(1<<v+1)-1,le(vt)}return ae(65497),new Uint8Array(p)},t=t||50,function(){for(var O=String.fromCharCode,R=0;R<256;R++)I[R]=O(R)}(),e=ce(S,E),r=ce(T,P),n=ce(B,k),a=ce(q,de),function(){for(var O=1,R=2,G=1;G<=15;G++){for(var M=O;M<R;M++)A[32767+M]=G,f[32767+M]=[],f[32767+M][1]=G,f[32767+M][0]=M;for(var K=-(R-1);K<=-O;K++)A[32767+K]=G,f[32767+K]=[],f[32767+K][1]=G,f[32767+K][0]=R-1+K;O<<=1,R<<=1}}(),function(){for(var O=0;O<256;O++)j[O]=19595*O,j[O+256|0]=38470*O,j[O+512|0]=7471*O+32768,j[O+768|0]=-11059*O,j[O+1024|0]=-21709*O,j[O+1280|0]=32768*O+8421375,j[O+1536|0]=-27439*O,j[O+1792|0]=-5329*O}(),De(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function ef(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function tH(t){function e(E){if(!E)throw Error("assert :P")}function r(E,B,k){for(var T=0;4>T;T++)if(E[B+T]!=k.charCodeAt(T))return!0;return!1}function n(E,B,k,T,P){for(var q=0;q<P;q++)E[B+q]=k[T+q]}function a(E,B,k,T){for(var P=0;P<T;P++)E[B+P]=k}function s(E){return new Int32Array(E)}function o(E,B){for(var k=[],T=0;T<E;T++)k.push(new B);return k}function l(E,B){var k=[];return function T(P,q,de){for(var ce=de[q],le=0;le<ce&&(P.push(de.length>q+1?[]:new B),!(de.length<q+1));le++)T(P[le],q+1,de)}(k,0,E),k}var c=function(){var E=this;function B(C,F){for(var W=1<<F-1>>>0;C&W;)W>>>=1;return W?(C&W-1)+W:C}function k(C,F,W,oe,Ie){e(!(oe%W));do C[F+(oe-=W)]=Ie;while(0<oe)}function T(C,F,W,oe,Ie){if(e(2328>=Ie),512>=Ie)var He=s(512);else if((He=s(Ie))==null)return 0;return function(qe,Je,at,ht,kt,Xt){var At,Dt,Gt=Je,gr=1<<at,Wt=s(16),yr=s(16);for(e(kt!=0),e(ht!=null),e(qe!=null),e(0<at),Dt=0;Dt<kt;++Dt){if(15<ht[Dt])return 0;++Wt[ht[Dt]]}if(Wt[0]==kt)return 0;for(yr[1]=0,At=1;15>At;++At){if(Wt[At]>1<<At)return 0;yr[At+1]=yr[At]+Wt[At]}for(Dt=0;Dt<kt;++Dt)At=ht[Dt],0<ht[Dt]&&(Xt[yr[At]++]=Dt);if(yr[15]==1)return(ht=new P).g=0,ht.value=Xt[0],k(qe,Gt,1,gr,ht),gr;var Cr,Mr=-1,Br=gr-1,Pn=0,xn=1,ha=1,_n=1<<at;for(Dt=0,At=1,kt=2;At<=at;++At,kt<<=1){if(xn+=ha<<=1,0>(ha-=Wt[At]))return 0;for(;0<Wt[At];--Wt[At])(ht=new P).g=At,ht.value=Xt[Dt++],k(qe,Gt+Pn,kt,_n,ht),Pn=B(Pn,At)}for(At=at+1,kt=2;15>=At;++At,kt<<=1){if(xn+=ha<<=1,0>(ha-=Wt[At]))return 0;for(;0<Wt[At];--Wt[At]){if(ht=new P,(Pn&Br)!=Mr){for(Gt+=_n,Cr=1<<(Mr=At)-at;15>Mr&&!(0>=(Cr-=Wt[Mr]));)++Mr,Cr<<=1;gr+=_n=1<<(Cr=Mr-at),qe[Je+(Mr=Pn&Br)].g=Cr+at,qe[Je+Mr].value=Gt-Je-Mr}ht.g=At-at,ht.value=Xt[Dt++],k(qe,Gt+(Pn>>at),kt,_n,ht),Pn=B(Pn,At)}}return xn!=2*yr[15]-1?0:gr}(C,F,W,oe,Ie,He)}function P(){this.value=this.g=0}function q(){this.value=this.g=0}function de(){this.G=o(5,P),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Xm,q)}function ce(C,F,W,oe){e(C!=null),e(F!=null),e(2147483648>oe),C.Ca=254,C.I=0,C.b=-8,C.Ka=0,C.oa=F,C.pa=W,C.Jd=F,C.Yc=W+oe,C.Zc=4<=oe?W+oe-4+1:W,D(C)}function le(C,F){for(var W=0;0<F--;)W|=te(C,128)<<F;return W}function he(C,F){var W=le(C,F);return V(C)?-W:W}function ae(C,F,W,oe){var Ie,He=0;for(e(C!=null),e(F!=null),e(4294967288>oe),C.Sb=oe,C.Ra=0,C.u=0,C.h=0,4<oe&&(oe=4),Ie=0;Ie<oe;++Ie)He+=F[W+Ie]<<8*Ie;C.Ra=He,C.bb=oe,C.oa=F,C.pa=W}function Ce(C){for(;8<=C.u&&C.bb<C.Sb;)C.Ra>>>=8,C.Ra+=C.oa[C.pa+C.bb]<<YA-8>>>0,++C.bb,C.u-=8;M(C)&&(C.h=1,C.u=0)}function De(C,F){if(e(0<=F),!C.h&&F<=bd){var W=G(C)&yd[F];return C.u+=F,Ce(C),W}return C.h=1,C.u=0}function O(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function R(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function G(C){return C.Ra>>>(C.u&YA-1)>>>0}function M(C){return e(C.bb<=C.Sb),C.h||C.bb==C.Sb&&C.u>YA}function K(C,F){C.u=F,C.h=M(C)}function Y(C){C.u>=Ch&&(e(C.u>=Ch),Ce(C))}function D(C){e(C!=null&&C.oa!=null),C.pa<C.Zc?(C.I=(C.oa[C.pa++]|C.I<<8)>>>0,C.b+=8):(e(C!=null&&C.oa!=null),C.pa<C.Yc?(C.b+=8,C.I=C.oa[C.pa++]|C.I<<8):C.Ka?C.b=0:(C.I<<=8,C.b+=8,C.Ka=1))}function V(C){return le(C,1)}function te(C,F){var W=C.Ca;0>C.b&&D(C);var oe=C.b,Ie=W*F>>>8,He=(C.I>>>oe>Ie)+0;for(He?(W-=Ie,C.I-=Ie+1<<oe>>>0):W=Ie+1,oe=W,Ie=0;256<=oe;)Ie+=8,oe>>=8;return oe=7^Ie+JA[oe],C.b-=oe,C.Ca=(W<<oe)-1,He}function ve(C,F,W){C[F+0]=W>>24&255,C[F+1]=W>>16&255,C[F+2]=W>>8&255,C[F+3]=255&W}function Q(C,F){return C[F+0]|C[F+1]<<8}function Xe(C,F){return Q(C,F)|C[F+2]<<16}function se(C,F){return Q(C,F)|Q(C,F+2)<<16}function Z(C,F){var W=1<<F;return e(C!=null),e(0<F),C.X=s(W),C.X==null?0:(C.Mb=32-F,C.Xa=F,1)}function ke(C,F){e(C!=null),e(F!=null),e(C.Xa==F.Xa),n(F.X,0,C.X,0,1<<F.Xa)}function Se(){this.X=[],this.Xa=this.Mb=0}function Ee(C,F,W,oe){e(W!=null),e(oe!=null);var Ie=W[0],He=oe[0];return Ie==0&&(Ie=(C*He+F/2)/F),He==0&&(He=(F*Ie+C/2)/C),0>=Ie||0>=He?0:(W[0]=Ie,oe[0]=He,1)}function Ze(C,F){return C+(1<<F)-1>>>F}function ot(C,F){return((4278255360&C)+(4278255360&F)>>>0&4278255360)+((16711935&C)+(16711935&F)>>>0&16711935)>>>0}function vt(C,F){E[F]=function(W,oe,Ie,He,qe,Je,at){var ht;for(ht=0;ht<qe;++ht){var kt=E[C](Je[at+ht-1],Ie,He+ht);Je[at+ht]=ot(W[oe+ht],kt)}}}function _t(){this.ud=this.hd=this.jd=0}function Tt(C,F){return((4278124286&(C^F))>>>1)+(C&F)>>>0}function Lt(C){return 0<=C&&256>C?C:0>C?0:255<C?255:void 0}function Rt(C,F){return Lt(C+(C-F+.5>>1))}function Et(C,F,W){return Math.abs(F-W)-Math.abs(C-W)}function Re(C,F,W,oe,Ie,He,qe){for(oe=He[qe-1],W=0;W<Ie;++W)He[qe+W]=oe=ot(C[F+W],oe)}function Te(C,F,W,oe,Ie){var He;for(He=0;He<W;++He){var qe=C[F+He],Je=qe>>8&255,at=16711935&(at=(at=16711935&qe)+((Je<<16)+Je));oe[Ie+He]=(4278255360&qe)+at>>>0}}function Ye(C,F){F.jd=255&C,F.hd=C>>8&255,F.ud=C>>16&255}function dt(C,F,W,oe,Ie,He){var qe;for(qe=0;qe<oe;++qe){var Je=F[W+qe],at=Je>>>8,ht=Je,kt=255&(kt=(kt=Je>>>16)+((C.jd<<24>>24)*(at<<24>>24)>>>5));ht=255&(ht=(ht+=(C.hd<<24>>24)*(at<<24>>24)>>>5)+((C.ud<<24>>24)*(kt<<24>>24)>>>5)),Ie[He+qe]=(4278255360&Je)+(kt<<16)+ht}}function Fe(C,F,W,oe,Ie){E[F]=function(He,qe,Je,at,ht,kt,Xt,At,Dt){for(at=Xt;at<At;++at)for(Xt=0;Xt<Dt;++Xt)ht[kt++]=Ie(Je[oe(He[qe++])])},E[C]=function(He,qe,Je,at,ht,kt,Xt){var At=8>>He.b,Dt=He.Ea,Gt=He.K[0],gr=He.w;if(8>At)for(He=(1<<He.b)-1,gr=(1<<At)-1;qe<Je;++qe){var Wt,yr=0;for(Wt=0;Wt<Dt;++Wt)Wt&He||(yr=oe(at[ht++])),kt[Xt++]=Ie(Gt[yr&gr]),yr>>=At}else E["VP8LMapColor"+W](at,ht,Gt,gr,kt,Xt,qe,Je,Dt)}}function je(C,F,W,oe,Ie){for(W=F+W;F<W;){var He=C[F++];oe[Ie++]=He>>16&255,oe[Ie++]=He>>8&255,oe[Ie++]=255&He}}function We(C,F,W,oe,Ie){for(W=F+W;F<W;){var He=C[F++];oe[Ie++]=He>>16&255,oe[Ie++]=He>>8&255,oe[Ie++]=255&He,oe[Ie++]=He>>24&255}}function ee(C,F,W,oe,Ie){for(W=F+W;F<W;){var He=(qe=C[F++])>>16&240|qe>>12&15,qe=240&qe|qe>>28&15;oe[Ie++]=He,oe[Ie++]=qe}}function Ve(C,F,W,oe,Ie){for(W=F+W;F<W;){var He=(qe=C[F++])>>16&248|qe>>13&7,qe=qe>>5&224|qe>>3&31;oe[Ie++]=He,oe[Ie++]=qe}}function rt(C,F,W,oe,Ie){for(W=F+W;F<W;){var He=C[F++];oe[Ie++]=255&He,oe[Ie++]=He>>8&255,oe[Ie++]=He>>16&255}}function $e(C,F,W,oe,Ie,He){if(He==0)for(W=F+W;F<W;)ve(oe,((He=C[F++])[0]>>24|He[1]>>8&65280|He[2]<<8&16711680|He[3]<<24)>>>0),Ie+=32;else n(oe,Ie,C,F,W)}function ie(C,F){E[F][0]=E[C+"0"],E[F][1]=E[C+"1"],E[F][2]=E[C+"2"],E[F][3]=E[C+"3"],E[F][4]=E[C+"4"],E[F][5]=E[C+"5"],E[F][6]=E[C+"6"],E[F][7]=E[C+"7"],E[F][8]=E[C+"8"],E[F][9]=E[C+"9"],E[F][10]=E[C+"10"],E[F][11]=E[C+"11"],E[F][12]=E[C+"12"],E[F][13]=E[C+"13"],E[F][14]=E[C+"0"],E[F][15]=E[C+"0"]}function pe(C){return C==M3||C==L3||C==IN||C==U3}function fe(){this.eb=[],this.size=this.A=this.fb=0}function Me(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function me(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new fe,this.f.kb=new Me,this.sd=null}function ye(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function mt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function gt(C){return alert("todo:WebPSamplerProcessPlane"),C.T}function yt(C,F){var W=C.T,oe=F.ba.f.RGBA,Ie=oe.eb,He=oe.fb+C.ka*oe.A,qe=au[F.ba.S],Je=C.y,at=C.O,ht=C.f,kt=C.N,Xt=C.ea,At=C.W,Dt=F.cc,Gt=F.dc,gr=F.Mc,Wt=F.Nc,yr=C.ka,Cr=C.ka+C.T,Mr=C.U,Br=Mr+1>>1;for(yr==0?qe(Je,at,null,null,ht,kt,Xt,At,ht,kt,Xt,At,Ie,He,null,null,Mr):(qe(F.ec,F.fc,Je,at,Dt,Gt,gr,Wt,ht,kt,Xt,At,Ie,He-oe.A,Ie,He,Mr),++W);yr+2<Cr;yr+=2)Dt=ht,Gt=kt,gr=Xt,Wt=At,kt+=C.Rc,At+=C.Rc,He+=2*oe.A,qe(Je,(at+=2*C.fa)-C.fa,Je,at,Dt,Gt,gr,Wt,ht,kt,Xt,At,Ie,He-oe.A,Ie,He,Mr);return at+=C.fa,C.j+Cr<C.o?(n(F.ec,F.fc,Je,at,Mr),n(F.cc,F.dc,ht,kt,Br),n(F.Mc,F.Nc,Xt,At,Br),W--):1&Cr||qe(Je,at,null,null,ht,kt,Xt,At,ht,kt,Xt,At,Ie,He+oe.A,null,null,Mr),W}function Pt(C,F,W){var oe=C.F,Ie=[C.J];if(oe!=null){var He=C.U,qe=F.ba.S,Je=qe==jN||qe==IN;F=F.ba.f.RGBA;var at=[0],ht=C.ka;at[0]=C.T,C.Kb&&(ht==0?--at[0]:(--ht,Ie[0]-=C.width),C.j+C.ka+C.T==C.o&&(at[0]=C.o-C.j-ht));var kt=F.eb;ht=F.fb+ht*F.A,C=lL(oe,Ie[0],C.width,He,at,kt,ht+(Je?0:3),F.A),e(W==at),C&&pe(qe)&&W1(kt,ht,Je,He,at,F.A)}return 0}function Ft(C){var F=C.ma,W=F.ba.S,oe=11>W,Ie=W==EN||W==SN||W==jN||W==R3||W==12||pe(W);if(F.memory=null,F.Ib=null,F.Jb=null,F.Nd=null,!Q1(F.Oa,C,Ie?11:12))return 0;if(Ie&&pe(W)&&tu(),C.da)alert("todo:use_scaling");else{if(oe){if(F.Ib=gt,C.Kb){if(W=C.U+1>>1,F.memory=s(C.U+2*W),F.memory==null)return 0;F.ec=F.memory,F.fc=0,F.cc=F.ec,F.dc=F.fc+C.U,F.Mc=F.cc,F.Nc=F.dc+W,F.Ib=yt,tu()}}else alert("todo:EmitYUV");Ie&&(F.Jb=Pt,oe&&Wc())}if(oe&&!CL){for(C=0;256>C;++C)Vue[C]=89858*(C-128)+TN>>PN,Gue[C]=-22014*(C-128)+TN,$ue[C]=-45773*(C-128),Hue[C]=113618*(C-128)+TN>>PN;for(C=Y1;C<H3;++C)F=76283*(C-16)+TN>>PN,Kue[C-Y1]=kr(F,255),que[C-Y1]=kr(F+8>>4,15);CL=1}return 1}function Oe(C){var F=C.ma,W=C.U,oe=C.T;return e(!(1&C.ka)),0>=W||0>=oe?0:(W=F.Ib(C,F),F.Jb!=null&&F.Jb(C,F,W),F.Dc+=W,1)}function be(C){C.ma.memory=null}function Ae(C,F,W,oe){return De(C,8)!=47?0:(F[0]=De(C,14)+1,W[0]=De(C,14)+1,oe[0]=De(C,1),De(C,3)!=0?0:!C.h)}function Le(C,F){if(4>C)return C+1;var W=C-2>>1;return(2+(1&C)<<W)+De(F,W)+1}function ut(C,F){return 120<F?F-120:1<=(W=((W=jue[F-1])>>4)*C+(8-(15&W)))?W:1;var W}function ct(C,F,W){var oe=G(W),Ie=C[F+=255&oe].g-8;return 0<Ie&&(K(W,W.u+8),oe=G(W),F+=C[F].value,F+=oe&(1<<Ie)-1),K(W,W.u+C[F].g),C[F].value}function st(C,F,W){return W.g+=C.g,W.value+=C.value<<F>>>0,e(8>=W.g),C.g}function z(C,F,W){var oe=C.xc;return e((F=oe==0?0:C.vc[C.md*(W>>oe)+(F>>oe)])<C.Wb),C.Ya[F]}function X(C,F,W,oe){var Ie=C.ab,He=C.c*F,qe=C.C;F=qe+F;var Je=W,at=oe;for(oe=C.Ta,W=C.Ua;0<Ie--;){var ht=C.gc[Ie],kt=qe,Xt=F,At=Je,Dt=at,Gt=(at=oe,Je=W,ht.Ea);switch(e(kt<Xt),e(Xt<=ht.nc),ht.hc){case 2:Ki(At,Dt,(Xt-kt)*Gt,at,Je);break;case 0:var gr=kt,Wt=Xt,yr=at,Cr=Je,Mr=(_n=ht).Ea;gr==0&&(H1(At,Dt,null,null,1,yr,Cr),Re(At,Dt+1,0,0,Mr-1,yr,Cr+1),Dt+=Mr,Cr+=Mr,++gr);for(var Br=1<<_n.b,Pn=Br-1,xn=Ze(Mr,_n.b),ha=_n.K,_n=_n.w+(gr>>_n.b)*xn;gr<Wt;){var Ta=ha,So=_n,Aa=1;for(Zg(At,Dt,yr,Cr-Mr,1,yr,Cr);Aa<Mr;){var En=(Aa&~Pn)+Br;En>Mr&&(En=Mr),(0,G1[Ta[So++]>>8&15])(At,Dt+ +Aa,yr,Cr+Aa-Mr,En-Aa,yr,Cr+Aa),Aa=En}Dt+=Mr,Cr+=Mr,++gr&Pn||(_n+=xn)}Xt!=ht.nc&&n(at,Je-Gt,at,Je+(Xt-kt-1)*Gt,Gt);break;case 1:for(Gt=At,Wt=Dt,Mr=(At=ht.Ea)-(Cr=At&~(yr=(Dt=1<<ht.b)-1)),gr=Ze(At,ht.b),Br=ht.K,ht=ht.w+(kt>>ht.b)*gr;kt<Xt;){for(Pn=Br,xn=ht,ha=new _t,_n=Wt+Cr,Ta=Wt+At;Wt<_n;)Ye(Pn[xn++],ha),K1(ha,Gt,Wt,Dt,at,Je),Wt+=Dt,Je+=Dt;Wt<Ta&&(Ye(Pn[xn++],ha),K1(ha,Gt,Wt,Mr,at,Je),Wt+=Mr,Je+=Mr),++kt&yr||(ht+=gr)}break;case 3:if(At==at&&Dt==Je&&0<ht.b){for(Wt=at,At=Gt=Je+(Xt-kt)*Gt-(Cr=(Xt-kt)*Ze(ht.Ea,ht.b)),Dt=at,yr=Je,gr=[],Cr=(Mr=Cr)-1;0<=Cr;--Cr)gr[Cr]=Dt[yr+Cr];for(Cr=Mr-1;0<=Cr;--Cr)Wt[At+Cr]=gr[Cr];wN(ht,kt,Xt,at,Gt,at,Je)}else wN(ht,kt,Xt,At,Dt,at,Je)}Je=oe,at=W}at!=W&&n(oe,W,Je,at,He)}function re(C,F){var W=C.V,oe=C.Ba+C.c*C.C,Ie=F-C.C;if(e(F<=C.l.o),e(16>=Ie),0<Ie){var He=C.l,qe=C.Ta,Je=C.Ua,at=He.width;if(X(C,Ie,W,oe),Ie=Je=[Je],e((W=C.C)<(oe=F)),e(He.v<He.va),oe>He.o&&(oe=He.o),W<He.j){var ht=He.j-W;W=He.j,Ie[0]+=ht*at}if(W>=oe?W=0:(Ie[0]+=4*He.v,He.ka=W-He.j,He.U=He.va-He.v,He.T=oe-W,W=1),W){if(Je=Je[0],11>(W=C.ca).S){var kt=W.f.RGBA,Xt=(oe=W.S,Ie=He.U,He=He.T,ht=kt.eb,kt.A),At=He;for(kt=kt.fb+C.Ma*kt.A;0<At--;){var Dt=qe,Gt=Je,gr=Ie,Wt=ht,yr=kt;switch(oe){case _N:q1(Dt,Gt,gr,Wt,yr);break;case EN:ZA(Dt,Gt,gr,Wt,yr);break;case M3:ZA(Dt,Gt,gr,Wt,yr),W1(Wt,yr,0,gr,1,0);break;case mL:Ym(Dt,Gt,gr,Wt,yr);break;case SN:$e(Dt,Gt,gr,Wt,yr,1);break;case L3:$e(Dt,Gt,gr,Wt,yr,1),W1(Wt,yr,0,gr,1,0);break;case jN:$e(Dt,Gt,gr,Wt,yr,0);break;case IN:$e(Dt,Gt,gr,Wt,yr,0),W1(Wt,yr,1,gr,1,0);break;case R3:e0(Dt,Gt,gr,Wt,yr);break;case U3:e0(Dt,Gt,gr,Wt,yr),oL(Wt,yr,gr,1,0);break;case pL:t0(Dt,Gt,gr,Wt,yr);break;default:e(0)}Je+=at,kt+=Xt}C.Ma+=He}else alert("todo:EmitRescaledRowsYUVA");e(C.Ma<=W.height)}}C.C=F,e(C.C<=C.i)}function H(C){var F;if(0<C.ua)return 0;for(F=0;F<C.Wb;++F){var W=C.Ya[F].G,oe=C.Ya[F].H;if(0<W[1][oe[1]+0].g||0<W[2][oe[2]+0].g||0<W[3][oe[3]+0].g)return 0}return 1}function L(C,F,W,oe,Ie,He){if(C.Z!=0){var qe=C.qd,Je=C.rd;for(e(a0[C.Z]!=null);F<W;++F)a0[C.Z](qe,Je,oe,Ie,oe,Ie,He),qe=oe,Je=Ie,Ie+=He;C.qd=qe,C.rd=Je}}function ue(C,F){var W=C.l.ma,oe=W.Z==0||W.Z==1?C.l.j:C.C;if(oe=C.C<oe?oe:C.C,e(F<=C.l.o),F>oe){var Ie=C.l.width,He=W.ca,qe=W.tb+Ie*oe,Je=C.V,at=C.Ba+C.c*oe,ht=C.gc;e(C.ab==1),e(ht[0].hc==3),Mf(ht[0],oe,F,Je,at,He,qe),L(W,oe,F,He,qe,Ie)}C.C=C.Ma=F}function Pe(C,F,W,oe,Ie,He,qe){var Je=C.$/oe,at=C.$%oe,ht=C.m,kt=C.s,Xt=W+C.$,At=Xt;Ie=W+oe*Ie;var Dt=W+oe*He,Gt=280+kt.ua,gr=C.Pb?Je:16777216,Wt=0<kt.ua?kt.Wa:null,yr=kt.wc,Cr=Xt<Dt?z(kt,at,Je):null;e(C.C<He),e(Dt<=Ie);var Mr=!1;e:for(;;){for(;Mr||Xt<Dt;){var Br=0;if(Je>=gr){var Pn=Xt-W;e((gr=C).Pb),gr.wd=gr.m,gr.xd=Pn,0<gr.s.ua&&ke(gr.s.Wa,gr.s.vb),gr=Je+Pue}if(at&yr||(Cr=z(kt,at,Je)),e(Cr!=null),Cr.Qb&&(F[Xt]=Cr.qb,Mr=!0),!Mr)if(Y(ht),Cr.jc){Br=ht,Pn=F;var xn=Xt,ha=Cr.pd[G(Br)&Xm-1];e(Cr.jc),256>ha.g?(K(Br,Br.u+ha.g),Pn[xn]=ha.value,Br=0):(K(Br,Br.u+ha.g-256),e(256<=ha.value),Br=ha.value),Br==0&&(Mr=!0)}else Br=ct(Cr.G[0],Cr.H[0],ht);if(ht.h)break;if(Mr||256>Br){if(!Mr)if(Cr.nd)F[Xt]=(Cr.qb|Br<<8)>>>0;else{if(Y(ht),Mr=ct(Cr.G[1],Cr.H[1],ht),Y(ht),Pn=ct(Cr.G[2],Cr.H[2],ht),xn=ct(Cr.G[3],Cr.H[3],ht),ht.h)break;F[Xt]=(xn<<24|Mr<<16|Br<<8|Pn)>>>0}if(Mr=!1,++Xt,++at>=oe&&(at=0,++Je,qe!=null&&Je<=He&&!(Je%16)&&qe(C,Je),Wt!=null))for(;At<Xt;)Br=F[At++],Wt.X[(506832829*Br&4294967295)>>>Wt.Mb]=Br}else if(280>Br){if(Br=Le(Br-256,ht),Pn=ct(Cr.G[4],Cr.H[4],ht),Y(ht),Pn=ut(oe,Pn=Le(Pn,ht)),ht.h)break;if(Xt-W<Pn||Ie-Xt<Br)break e;for(xn=0;xn<Br;++xn)F[Xt+xn]=F[Xt+xn-Pn];for(Xt+=Br,at+=Br;at>=oe;)at-=oe,++Je,qe!=null&&Je<=He&&!(Je%16)&&qe(C,Je);if(e(Xt<=Ie),at&yr&&(Cr=z(kt,at,Je)),Wt!=null)for(;At<Xt;)Br=F[At++],Wt.X[(506832829*Br&4294967295)>>>Wt.Mb]=Br}else{if(!(Br<Gt))break e;for(Mr=Br-280,e(Wt!=null);At<Xt;)Br=F[At++],Wt.X[(506832829*Br&4294967295)>>>Wt.Mb]=Br;Br=Xt,e(!(Mr>>>(Pn=Wt).Xa)),F[Br]=Pn.X[Mr],Mr=!0}Mr||e(ht.h==M(ht))}if(C.Pb&&ht.h&&Xt<Ie)e(C.m.h),C.a=5,C.m=C.wd,C.$=C.xd,0<C.s.ua&&ke(C.s.vb,C.s.Wa);else{if(ht.h)break e;qe!=null&&qe(C,Je>He?He:Je),C.a=0,C.$=Xt-W}return 1}return C.a=3,0}function xe(C){e(C!=null),C.vc=null,C.yc=null,C.Ya=null;var F=C.Wa;F!=null&&(F.X=null),C.vb=null,e(C!=null)}function Ge(){var C=new Un;return C==null?null:(C.a=0,C.xb=vL,ie("Predictor","VP8LPredictors"),ie("Predictor","VP8LPredictors_C"),ie("PredictorAdd","VP8LPredictorsAdd"),ie("PredictorAdd","VP8LPredictorsAdd_C"),Ki=Te,K1=dt,q1=je,ZA=We,e0=ee,t0=Ve,Ym=rt,E.VP8LMapColor32b=Rf,E.VP8LMapColor8b=$1,C)}function ze(C,F,W,oe,Ie){var He=1,qe=[C],Je=[F],at=oe.m,ht=oe.s,kt=null,Xt=0;e:for(;;){if(W)for(;He&&De(at,1);){var At=qe,Dt=Je,Gt=oe,gr=1,Wt=Gt.m,yr=Gt.gc[Gt.ab],Cr=De(Wt,2);if(Gt.Oc&1<<Cr)He=0;else{switch(Gt.Oc|=1<<Cr,yr.hc=Cr,yr.Ea=At[0],yr.nc=Dt[0],yr.K=[null],++Gt.ab,e(4>=Gt.ab),Cr){case 0:case 1:yr.b=De(Wt,3)+2,gr=ze(Ze(yr.Ea,yr.b),Ze(yr.nc,yr.b),0,Gt,yr.K),yr.K=yr.K[0];break;case 3:var Mr,Br=De(Wt,8)+1,Pn=16<Br?0:4<Br?1:2<Br?2:3;if(At[0]=Ze(yr.Ea,Pn),yr.b=Pn,Mr=gr=ze(Br,1,0,Gt,yr.K)){var xn,ha=Br,_n=yr,Ta=1<<(8>>_n.b),So=s(Ta);if(So==null)Mr=0;else{var Aa=_n.K[0],En=_n.w;for(So[0]=_n.K[0][0],xn=1;xn<1*ha;++xn)So[xn]=ot(Aa[En+xn],So[xn-1]);for(;xn<4*Ta;++xn)So[xn]=0;_n.K[0]=null,_n.K[0]=So,Mr=1}}gr=Mr;break;case 2:break;default:e(0)}He=gr}}if(qe=qe[0],Je=Je[0],He&&De(at,1)&&!(He=1<=(Xt=De(at,4))&&11>=Xt)){oe.a=3;break e}var nn;if(nn=He)t:{var zi,la,Ba,Vs=oe,wl=qe,_c=Je,Fi=Xt,zl=W,Ec=Vs.m,jo=Vs.s,Ra=[null],ss=1,Oi=0,is=Iue[Fi];r:for(;;){if(zl&&De(Ec,1)){var Nl=De(Ec,3)+2,Yu=Ze(wl,Nl),Wi=Ze(_c,Nl),Xc=Yu*Wi;if(!ze(Yu,Wi,0,Vs,Ra))break r;for(Ra=Ra[0],jo.xc=Nl,zi=0;zi<Xc;++zi){var js=Ra[zi]>>8&65535;Ra[zi]=js,js>=ss&&(ss=js+1)}}if(Ec.h)break r;for(la=0;5>la;++la){var Io=gL[la];!la&&0<Fi&&(Io+=1<<Fi),Oi<Io&&(Oi=Io)}var Nd=o(ss*is,P),Sc=ss,Cd=o(Sc,de);if(Cd==null)var _d=null;else e(65536>=Sc),_d=Cd;var Yc=s(Oi);if(_d==null||Yc==null||Nd==null){Vs.a=1;break r}var Ed=Nd;for(zi=Ba=0;zi<ss;++zi){var Fs=_d[zi],Sd=Fs.G,Ju=Fs.H,Zm=0,Sh=1,Cl=0;for(la=0;5>la;++la){Io=gL[la],Sd[la]=Ed,Ju[la]=Ba,!la&&0<Fi&&(Io+=1<<Fi);a:{var kN,$3=Io,FN=Vs,J1=Yc,Xue=Ed,Yue=Ba,G3=0,s0=FN.m,Jue=De(s0,1);if(a(J1,0,0,$3),Jue){var Zue=De(s0,1)+1,efe=De(s0,1),SL=De(s0,efe==0?1:8);J1[SL]=1,Zue==2&&(J1[SL=De(s0,8)]=1);var ON=1}else{var jL=s(19),IL=De(s0,4)+4;if(19<IL){FN.a=3;var DN=0;break a}for(kN=0;kN<IL;++kN)jL[Sue[kN]]=De(s0,3);var K3=void 0,Z1=void 0,PL=FN,tfe=jL,RN=$3,TL=J1,q3=0,i0=PL.m,BL=8,kL=o(128,P);n:for(;T(kL,0,7,tfe,19);){if(De(i0,1)){var rfe=2+2*De(i0,3);if((K3=2+De(i0,rfe))>RN)break n}else K3=RN;for(Z1=0;Z1<RN&&K3--;){Y(i0);var FL=kL[0+(127&G(i0))];K(i0,i0.u+FL.g);var tx=FL.value;if(16>tx)TL[Z1++]=tx,tx!=0&&(BL=tx);else{var nfe=tx==16,OL=tx-16,afe=_ue[OL],DL=De(i0,Cue[OL])+afe;if(Z1+DL>RN)break n;for(var sfe=nfe?BL:0;0<DL--;)TL[Z1++]=sfe}}q3=1;break n}q3||(PL.a=3),ON=q3}(ON=ON&&!s0.h)&&(G3=T(Xue,Yue,8,J1,$3)),ON&&G3!=0?DN=G3:(FN.a=3,DN=0)}if(DN==0)break r;if(Sh&&Eue[la]==1&&(Sh=Ed[Ba].g==0),Zm+=Ed[Ba].g,Ba+=DN,3>=la){var ey,z3=Yc[0];for(ey=1;ey<Io;++ey)Yc[ey]>z3&&(z3=Yc[ey]);Cl+=z3}}if(Fs.nd=Sh,Fs.Qb=0,Sh&&(Fs.qb=(Sd[3][Ju[3]+0].value<<24|Sd[1][Ju[1]+0].value<<16|Sd[2][Ju[2]+0].value)>>>0,Zm==0&&256>Sd[0][Ju[0]+0].value&&(Fs.Qb=1,Fs.qb+=Sd[0][Ju[0]+0].value<<8)),Fs.jc=!Fs.Qb&&6>Cl,Fs.jc){var MN,jh=Fs;for(MN=0;MN<Xm;++MN){var o0=MN,l0=jh.pd[o0],LN=jh.G[0][jh.H[0]+o0];256<=LN.value?(l0.g=LN.g+256,l0.value=LN.value):(l0.g=0,l0.value=0,o0>>=st(LN,8,l0),o0>>=st(jh.G[1][jh.H[1]+o0],16,l0),o0>>=st(jh.G[2][jh.H[2]+o0],0,l0),st(jh.G[3][jh.H[3]+o0],24,l0))}}}jo.vc=Ra,jo.Wb=ss,jo.Ya=_d,jo.yc=Nd,nn=1;break t}nn=0}if(!(He=nn)){oe.a=3;break e}if(0<Xt){if(ht.ua=1<<Xt,!Z(ht.Wa,Xt)){oe.a=1,He=0;break e}}else ht.ua=0;var W3=oe,RL=qe,ife=Je,X3=W3.s,Y3=X3.xc;if(W3.c=RL,W3.i=ife,X3.md=Ze(RL,Y3),X3.wc=Y3==0?-1:(1<<Y3)-1,W){oe.xb=Rue;break e}if((kt=s(qe*Je))==null){oe.a=1,He=0;break e}He=(He=Pe(oe,kt,0,qe,Je,Je,null))&&!at.h;break e}return He?(Ie!=null?Ie[0]=kt:(e(kt==null),e(W)),oe.$=0,W||xe(ht)):xe(ht),He}function Ke(C,F){var W=C.c*C.i,oe=W+F+16*F;return e(C.c<=F),C.V=s(oe),C.V==null?(C.Ta=null,C.Ua=0,C.a=1,0):(C.Ta=C.V,C.Ua=C.Ba+W+F,1)}function pt(C,F){var W=C.C,oe=F-W,Ie=C.V,He=C.Ba+C.c*W;for(e(F<=C.l.o);0<oe;){var qe=16<oe?16:oe,Je=C.l.ma,at=C.l.width,ht=at*qe,kt=Je.ca,Xt=Je.tb+at*W,At=C.Ta,Dt=C.Ua;X(C,qe,Ie,He),cL(At,Dt,kt,Xt,ht),L(Je,W,W+qe,kt,Xt,at),oe-=qe,Ie+=qe*C.c,W+=qe}e(W==F),C.C=C.Ma=F}function ne(){this.ub=this.yd=this.td=this.Rb=0}function Ue(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function tt(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function nt(){this.Yb=function(){var C=[];return function F(W,oe,Ie){for(var He=Ie[oe],qe=0;qe<He&&(W.push(Ie.length>oe+1?[]:0),!(Ie.length<oe+1));qe++)F(W[qe],oe+1,Ie)}(C,0,[3,11]),C}()}function wt(){this.jb=s(3),this.Wc=l([4,8],nt),this.Xc=l([4,17],nt)}function Bt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function tr(){this.ld=this.La=this.dd=this.tc=0}function Or(){this.Na=this.la=0}function zr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ur(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Dr(){this.uc=this.M=this.Nb=0,this.wa=Array(new tr),this.Y=0,this.ya=Array(new ur),this.aa=0,this.l=new Qe}function dn(){this.y=s(16),this.f=s(8),this.ea=s(8)}function mn(){this.cb=this.a=0,this.sc="",this.m=new O,this.Od=new ne,this.Kc=new Ue,this.ed=new Bt,this.Qa=new tt,this.Ic=this.$c=this.Aa=0,this.D=new Dr,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,O),this.ia=0,this.pb=o(4,zr),this.Pa=new wt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new dn),this.Hd=0,this.rb=Array(new Or),this.sb=0,this.wa=Array(new tr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ur),this.L=this.aa=0,this.gd=l([4,2],tr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function kr(C,F){return 0>C?0:C>F?F:C}function Qe(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function jt(){var C=new mn;return C!=null&&(C.a=0,C.sc="OK",C.cb=0,C.Xb=0,X1||(X1=_r)),C}function wr(C,F,W){return C.a==0&&(C.a=F,C.sc=W,C.cb=0),0}function ln(C,F,W){return 3<=W&&C[F+0]==157&&C[F+1]==1&&C[F+2]==42}function cn(C,F){if(C==null)return 0;if(C.a=0,C.sc="OK",F==null)return wr(C,2,"null VP8Io passed to VP8GetHeaders()");var W=F.data,oe=F.w,Ie=F.ha;if(4>Ie)return wr(C,7,"Truncated header.");var He=W[oe+0]|W[oe+1]<<8|W[oe+2]<<16,qe=C.Od;if(qe.Rb=!(1&He),qe.td=He>>1&7,qe.yd=He>>4&1,qe.ub=He>>5,3<qe.td)return wr(C,3,"Incorrect keyframe parameters.");if(!qe.yd)return wr(C,4,"Frame not displayable.");oe+=3,Ie-=3;var Je=C.Kc;if(qe.Rb){if(7>Ie)return wr(C,7,"cannot parse picture header");if(!ln(W,oe,Ie))return wr(C,3,"Bad code word");Je.c=16383&(W[oe+4]<<8|W[oe+3]),Je.Td=W[oe+4]>>6,Je.i=16383&(W[oe+6]<<8|W[oe+5]),Je.Ud=W[oe+6]>>6,oe+=7,Ie-=7,C.za=Je.c+15>>4,C.Ub=Je.i+15>>4,F.width=Je.c,F.height=Je.i,F.Da=0,F.j=0,F.v=0,F.va=F.width,F.o=F.height,F.da=0,F.ib=F.width,F.hb=F.height,F.U=F.width,F.T=F.height,a((He=C.Pa).jb,0,255,He.jb.length),e((He=C.Qa)!=null),He.Cb=0,He.Bb=0,He.Fb=1,a(He.Zb,0,0,He.Zb.length),a(He.Lb,0,0,He.Lb)}if(qe.ub>Ie)return wr(C,7,"bad partition length");ce(He=C.m,W,oe,qe.ub),oe+=qe.ub,Ie-=qe.ub,qe.Rb&&(Je.Ld=V(He),Je.Kd=V(He)),Je=C.Qa;var at,ht=C.Pa;if(e(He!=null),e(Je!=null),Je.Cb=V(He),Je.Cb){if(Je.Bb=V(He),V(He)){for(Je.Fb=V(He),at=0;4>at;++at)Je.Zb[at]=V(He)?he(He,7):0;for(at=0;4>at;++at)Je.Lb[at]=V(He)?he(He,6):0}if(Je.Bb)for(at=0;3>at;++at)ht.jb[at]=V(He)?le(He,8):255}else Je.Bb=0;if(He.Ka)return wr(C,3,"cannot parse segment header");if((Je=C.ed).zd=V(He),Je.Tb=le(He,6),Je.wb=le(He,3),Je.Pc=V(He),Je.Pc&&V(He)){for(ht=0;4>ht;++ht)V(He)&&(Je.vd[ht]=he(He,6));for(ht=0;4>ht;++ht)V(He)&&(Je.od[ht]=he(He,6))}if(C.L=Je.Tb==0?0:Je.zd?1:2,He.Ka)return wr(C,3,"cannot parse filter header");var kt=Ie;if(Ie=at=oe,oe=at+kt,Je=kt,C.Xb=(1<<le(C.m,2))-1,kt<3*(ht=C.Xb))W=7;else{for(at+=3*ht,Je-=3*ht,kt=0;kt<ht;++kt){var Xt=W[Ie+0]|W[Ie+1]<<8|W[Ie+2]<<16;Xt>Je&&(Xt=Je),ce(C.Jc[+kt],W,at,Xt),at+=Xt,Je-=Xt,Ie+=3}ce(C.Jc[+ht],W,at,Je),W=at<oe?0:5}if(W!=0)return wr(C,W,"cannot parse partitions");for(W=le(at=C.m,7),Ie=V(at)?he(at,4):0,oe=V(at)?he(at,4):0,Je=V(at)?he(at,4):0,ht=V(at)?he(at,4):0,at=V(at)?he(at,4):0,kt=C.Qa,Xt=0;4>Xt;++Xt){if(kt.Cb){var At=kt.Zb[Xt];kt.Fb||(At+=W)}else{if(0<Xt){C.pb[Xt]=C.pb[0];continue}At=W}var Dt=C.pb[Xt];Dt.Sc[0]=Q3[kr(At+Ie,127)],Dt.Sc[1]=V3[kr(At+0,127)],Dt.Eb[0]=2*Q3[kr(At+oe,127)],Dt.Eb[1]=101581*V3[kr(At+Je,127)]>>16,8>Dt.Eb[1]&&(Dt.Eb[1]=8),Dt.Qc[0]=Q3[kr(At+ht,117)],Dt.Qc[1]=V3[kr(At+at,127)],Dt.lc=At+at}if(!qe.Rb)return wr(C,4,"Not a key frame.");for(V(He),qe=C.Pa,W=0;4>W;++W){for(Ie=0;8>Ie;++Ie)for(oe=0;3>oe;++oe)for(Je=0;11>Je;++Je)ht=te(He,Oue[W][Ie][oe][Je])?le(He,8):kue[W][Ie][oe][Je],qe.Wc[W][Ie].Yb[oe][Je]=ht;for(Ie=0;17>Ie;++Ie)qe.Xc[W][Ie]=qe.Wc[W][Due[Ie]]}return C.kc=V(He),C.kc&&(C.Bd=le(He,8)),C.cb=1}function _r(C,F,W,oe,Ie,He,qe){var Je=F[Ie].Yb[W];for(W=0;16>Ie;++Ie){if(!te(C,Je[W+0]))return Ie;for(;!te(C,Je[W+1]);)if(Je=F[++Ie].Yb[0],W=0,Ie==16)return 16;var at=F[Ie+1].Yb;if(te(C,Je[W+2])){var ht=C,kt=0;if(te(ht,(At=Je)[(Xt=W)+3]))if(te(ht,At[Xt+6])){for(Je=0,Xt=2*(kt=te(ht,At[Xt+8]))+(At=te(ht,At[Xt+9+kt])),kt=0,At=Tue[Xt];At[Je];++Je)kt+=kt+te(ht,At[Je]);kt+=3+(8<<Xt)}else te(ht,At[Xt+7])?(kt=7+2*te(ht,165),kt+=te(ht,145)):kt=5+te(ht,159);else kt=te(ht,At[Xt+4])?3+te(ht,At[Xt+5]):2;Je=at[2]}else kt=1,Je=at[1];at=qe+Bue[Ie],0>(ht=C).b&&D(ht);var Xt,At=ht.b,Dt=(Xt=ht.Ca>>1)-(ht.I>>At)>>31;--ht.b,ht.Ca+=Dt,ht.Ca|=1,ht.I-=(Xt+1&Dt)<<At,He[at]=((kt^Dt)-Dt)*oe[(0<Ie)+0]}return 16}function Jt(C){var F=C.rb[C.sb-1];F.la=0,F.Na=0,a(C.zc,0,0,C.zc.length),C.ja=0}function ir(C,F,W,oe,Ie){Ie=C[F+W+32*oe]+(Ie>>3),C[F+W+32*oe]=-256&Ie?0>Ie?0:255:Ie}function Fr(C,F,W,oe,Ie,He){ir(C,F,0,W,oe+Ie),ir(C,F,1,W,oe+He),ir(C,F,2,W,oe-He),ir(C,F,3,W,oe-Ie)}function Er(C){return(20091*C>>16)+C}function Lr(C,F,W,oe){var Ie,He=0,qe=s(16);for(Ie=0;4>Ie;++Ie){var Je=C[F+0]+C[F+8],at=C[F+0]-C[F+8],ht=(35468*C[F+4]>>16)-Er(C[F+12]),kt=Er(C[F+4])+(35468*C[F+12]>>16);qe[He+0]=Je+kt,qe[He+1]=at+ht,qe[He+2]=at-ht,qe[He+3]=Je-kt,He+=4,F++}for(Ie=He=0;4>Ie;++Ie)Je=(C=qe[He+0]+4)+qe[He+8],at=C-qe[He+8],ht=(35468*qe[He+4]>>16)-Er(qe[He+12]),ir(W,oe,0,0,Je+(kt=Er(qe[He+4])+(35468*qe[He+12]>>16))),ir(W,oe,1,0,at+ht),ir(W,oe,2,0,at-ht),ir(W,oe,3,0,Je-kt),He++,oe+=32}function Ln(C,F,W,oe){var Ie=C[F+0]+4,He=35468*C[F+4]>>16,qe=Er(C[F+4]),Je=35468*C[F+1]>>16;Fr(W,oe,0,Ie+qe,C=Er(C[F+1]),Je),Fr(W,oe,1,Ie+He,C,Je),Fr(W,oe,2,Ie-He,C,Je),Fr(W,oe,3,Ie-qe,C,Je)}function Nt(C,F,W,oe,Ie){Lr(C,F,W,oe),Ie&&Lr(C,F+16,W,oe+4)}function nr(C,F,W,oe){Jm(C,F+0,W,oe,1),Jm(C,F+32,W,oe+128,1)}function $t(C,F,W,oe){var Ie;for(C=C[F+0]+4,Ie=0;4>Ie;++Ie)for(F=0;4>F;++F)ir(W,oe,F,Ie,C)}function Mt(C,F,W,oe){C[F+0]&&ts(C,F+0,W,oe),C[F+16]&&ts(C,F+16,W,oe+4),C[F+32]&&ts(C,F+32,W,oe+128),C[F+48]&&ts(C,F+48,W,oe+128+4)}function Be(C,F,W,oe){var Ie,He=s(16);for(Ie=0;4>Ie;++Ie){var qe=C[F+0+Ie]+C[F+12+Ie],Je=C[F+4+Ie]+C[F+8+Ie],at=C[F+4+Ie]-C[F+8+Ie],ht=C[F+0+Ie]-C[F+12+Ie];He[0+Ie]=qe+Je,He[8+Ie]=qe-Je,He[4+Ie]=ht+at,He[12+Ie]=ht-at}for(Ie=0;4>Ie;++Ie)qe=(C=He[0+4*Ie]+3)+He[3+4*Ie],Je=He[1+4*Ie]+He[2+4*Ie],at=He[1+4*Ie]-He[2+4*Ie],ht=C-He[3+4*Ie],W[oe+0]=qe+Je>>3,W[oe+16]=ht+at>>3,W[oe+32]=qe-Je>>3,W[oe+48]=ht-at>>3,oe+=64}function It(C,F,W){var oe,Ie=F-32,He=wd,qe=255-C[Ie-1];for(oe=0;oe<W;++oe){var Je,at=He,ht=qe+C[F-1];for(Je=0;Je<W;++Je)C[F+Je]=at[ht+C[Ie+Je]];F+=32}}function Vt(C,F){It(C,F,4)}function Ot(C,F){It(C,F,8)}function qt(C,F){It(C,F,16)}function sr(C,F){var W;for(W=0;16>W;++W)n(C,F+32*W,C,F-32,16)}function vr(C,F){var W;for(W=16;0<W;--W)a(C,F,C[F-1],16),F+=32}function rr(C,F,W){var oe;for(oe=0;16>oe;++oe)a(F,W+32*oe,C,16)}function dr(C,F){var W,oe=16;for(W=0;16>W;++W)oe+=C[F-1+32*W]+C[F+W-32];rr(oe>>5,C,F)}function we(C,F){var W,oe=8;for(W=0;16>W;++W)oe+=C[F-1+32*W];rr(oe>>4,C,F)}function ft(C,F){var W,oe=8;for(W=0;16>W;++W)oe+=C[F+W-32];rr(oe>>4,C,F)}function St(C,F){rr(128,C,F)}function Ct(C,F,W){return C+2*F+W+2>>2}function fr(C,F){var W,oe=F-32;for(oe=new Uint8Array([Ct(C[oe-1],C[oe+0],C[oe+1]),Ct(C[oe+0],C[oe+1],C[oe+2]),Ct(C[oe+1],C[oe+2],C[oe+3]),Ct(C[oe+2],C[oe+3],C[oe+4])]),W=0;4>W;++W)n(C,F+32*W,oe,0,oe.length)}function or(C,F){var W=C[F-1],oe=C[F-1+32],Ie=C[F-1+64],He=C[F-1+96];ve(C,F+0,16843009*Ct(C[F-1-32],W,oe)),ve(C,F+32,16843009*Ct(W,oe,Ie)),ve(C,F+64,16843009*Ct(oe,Ie,He)),ve(C,F+96,16843009*Ct(Ie,He,He))}function Hr(C,F){var W,oe=4;for(W=0;4>W;++W)oe+=C[F+W-32]+C[F-1+32*W];for(oe>>=3,W=0;4>W;++W)a(C,F+32*W,oe,4)}function br(C,F){var W=C[F-1+0],oe=C[F-1+32],Ie=C[F-1+64],He=C[F-1-32],qe=C[F+0-32],Je=C[F+1-32],at=C[F+2-32],ht=C[F+3-32];C[F+0+96]=Ct(oe,Ie,C[F-1+96]),C[F+1+96]=C[F+0+64]=Ct(W,oe,Ie),C[F+2+96]=C[F+1+64]=C[F+0+32]=Ct(He,W,oe),C[F+3+96]=C[F+2+64]=C[F+1+32]=C[F+0+0]=Ct(qe,He,W),C[F+3+64]=C[F+2+32]=C[F+1+0]=Ct(Je,qe,He),C[F+3+32]=C[F+2+0]=Ct(at,Je,qe),C[F+3+0]=Ct(ht,at,Je)}function hr(C,F){var W=C[F+1-32],oe=C[F+2-32],Ie=C[F+3-32],He=C[F+4-32],qe=C[F+5-32],Je=C[F+6-32],at=C[F+7-32];C[F+0+0]=Ct(C[F+0-32],W,oe),C[F+1+0]=C[F+0+32]=Ct(W,oe,Ie),C[F+2+0]=C[F+1+32]=C[F+0+64]=Ct(oe,Ie,He),C[F+3+0]=C[F+2+32]=C[F+1+64]=C[F+0+96]=Ct(Ie,He,qe),C[F+3+32]=C[F+2+64]=C[F+1+96]=Ct(He,qe,Je),C[F+3+64]=C[F+2+96]=Ct(qe,Je,at),C[F+3+96]=Ct(Je,at,at)}function Ir(C,F){var W=C[F-1+0],oe=C[F-1+32],Ie=C[F-1+64],He=C[F-1-32],qe=C[F+0-32],Je=C[F+1-32],at=C[F+2-32],ht=C[F+3-32];C[F+0+0]=C[F+1+64]=He+qe+1>>1,C[F+1+0]=C[F+2+64]=qe+Je+1>>1,C[F+2+0]=C[F+3+64]=Je+at+1>>1,C[F+3+0]=at+ht+1>>1,C[F+0+96]=Ct(Ie,oe,W),C[F+0+64]=Ct(oe,W,He),C[F+0+32]=C[F+1+96]=Ct(W,He,qe),C[F+1+32]=C[F+2+96]=Ct(He,qe,Je),C[F+2+32]=C[F+3+96]=Ct(qe,Je,at),C[F+3+32]=Ct(Je,at,ht)}function en(C,F){var W=C[F+0-32],oe=C[F+1-32],Ie=C[F+2-32],He=C[F+3-32],qe=C[F+4-32],Je=C[F+5-32],at=C[F+6-32],ht=C[F+7-32];C[F+0+0]=W+oe+1>>1,C[F+1+0]=C[F+0+64]=oe+Ie+1>>1,C[F+2+0]=C[F+1+64]=Ie+He+1>>1,C[F+3+0]=C[F+2+64]=He+qe+1>>1,C[F+0+32]=Ct(W,oe,Ie),C[F+1+32]=C[F+0+96]=Ct(oe,Ie,He),C[F+2+32]=C[F+1+96]=Ct(Ie,He,qe),C[F+3+32]=C[F+2+96]=Ct(He,qe,Je),C[F+3+64]=Ct(qe,Je,at),C[F+3+96]=Ct(Je,at,ht)}function sn(C,F){var W=C[F-1+0],oe=C[F-1+32],Ie=C[F-1+64],He=C[F-1+96];C[F+0+0]=W+oe+1>>1,C[F+2+0]=C[F+0+32]=oe+Ie+1>>1,C[F+2+32]=C[F+0+64]=Ie+He+1>>1,C[F+1+0]=Ct(W,oe,Ie),C[F+3+0]=C[F+1+32]=Ct(oe,Ie,He),C[F+3+32]=C[F+1+64]=Ct(Ie,He,He),C[F+3+64]=C[F+2+64]=C[F+0+96]=C[F+1+96]=C[F+2+96]=C[F+3+96]=He}function da(C,F){var W=C[F-1+0],oe=C[F-1+32],Ie=C[F-1+64],He=C[F-1+96],qe=C[F-1-32],Je=C[F+0-32],at=C[F+1-32],ht=C[F+2-32];C[F+0+0]=C[F+2+32]=W+qe+1>>1,C[F+0+32]=C[F+2+64]=oe+W+1>>1,C[F+0+64]=C[F+2+96]=Ie+oe+1>>1,C[F+0+96]=He+Ie+1>>1,C[F+3+0]=Ct(Je,at,ht),C[F+2+0]=Ct(qe,Je,at),C[F+1+0]=C[F+3+32]=Ct(W,qe,Je),C[F+1+32]=C[F+3+64]=Ct(oe,W,qe),C[F+1+64]=C[F+3+96]=Ct(Ie,oe,W),C[F+1+96]=Ct(He,Ie,oe)}function Zn(C,F){var W;for(W=0;8>W;++W)n(C,F+32*W,C,F-32,8)}function wn(C,F){var W;for(W=0;8>W;++W)a(C,F,C[F-1],8),F+=32}function rn(C,F,W){var oe;for(oe=0;8>oe;++oe)a(F,W+32*oe,C,8)}function pr(C,F){var W,oe=8;for(W=0;8>W;++W)oe+=C[F+W-32]+C[F-1+32*W];rn(oe>>4,C,F)}function Sr(C,F){var W,oe=4;for(W=0;8>W;++W)oe+=C[F+W-32];rn(oe>>3,C,F)}function Hn(C,F){var W,oe=4;for(W=0;8>W;++W)oe+=C[F-1+32*W];rn(oe>>3,C,F)}function $r(C,F){rn(128,C,F)}function Pr(C,F,W){var oe=C[F-W],Ie=C[F+0],He=3*(Ie-oe)+D3[1020+C[F-2*W]-C[F+W]],qe=CN[112+(He+4>>3)];C[F-W]=wd[255+oe+CN[112+(He+3>>3)]],C[F+0]=wd[255+Ie-qe]}function Gr(C,F,W,oe){var Ie=C[F+0],He=C[F+W];return nu[255+C[F-2*W]-C[F-W]]>oe||nu[255+He-Ie]>oe}function $n(C,F,W,oe){return 4*nu[255+C[F-W]-C[F+0]]+nu[255+C[F-2*W]-C[F+W]]<=oe}function Nn(C,F,W,oe,Ie){var He=C[F-3*W],qe=C[F-2*W],Je=C[F-W],at=C[F+0],ht=C[F+W],kt=C[F+2*W],Xt=C[F+3*W];return 4*nu[255+Je-at]+nu[255+qe-ht]>oe?0:nu[255+C[F-4*W]-He]<=Ie&&nu[255+He-qe]<=Ie&&nu[255+qe-Je]<=Ie&&nu[255+Xt-kt]<=Ie&&nu[255+kt-ht]<=Ie&&nu[255+ht-at]<=Ie}function Fn(C,F,W,oe){var Ie=2*oe+1;for(oe=0;16>oe;++oe)$n(C,F+oe,W,Ie)&&Pr(C,F+oe,W)}function aa(C,F,W,oe){var Ie=2*oe+1;for(oe=0;16>oe;++oe)$n(C,F+oe*W,1,Ie)&&Pr(C,F+oe*W,1)}function Wa(C,F,W,oe){var Ie;for(Ie=3;0<Ie;--Ie)Fn(C,F+=4*W,W,oe)}function Zo(C,F,W,oe){var Ie;for(Ie=3;0<Ie;--Ie)aa(C,F+=4,W,oe)}function ki(C,F,W,oe,Ie,He,qe,Je){for(He=2*He+1;0<Ie--;){if(Nn(C,F,W,He,qe))if(Gr(C,F,W,Je))Pr(C,F,W);else{var at=C,ht=F,kt=W,Xt=at[ht-2*kt],At=at[ht-kt],Dt=at[ht+0],Gt=at[ht+kt],gr=at[ht+2*kt],Wt=27*(Cr=D3[1020+3*(Dt-At)+D3[1020+Xt-Gt]])+63>>7,yr=18*Cr+63>>7,Cr=9*Cr+63>>7;at[ht-3*kt]=wd[255+at[ht-3*kt]+Cr],at[ht-2*kt]=wd[255+Xt+yr],at[ht-kt]=wd[255+At+Wt],at[ht+0]=wd[255+Dt-Wt],at[ht+kt]=wd[255+Gt-yr],at[ht+2*kt]=wd[255+gr-Cr]}F+=oe}}function el(C,F,W,oe,Ie,He,qe,Je){for(He=2*He+1;0<Ie--;){if(Nn(C,F,W,He,qe))if(Gr(C,F,W,Je))Pr(C,F,W);else{var at=C,ht=F,kt=W,Xt=at[ht-kt],At=at[ht+0],Dt=at[ht+kt],Gt=CN[112+(4+(gr=3*(At-Xt))>>3)],gr=CN[112+(gr+3>>3)],Wt=Gt+1>>1;at[ht-2*kt]=wd[255+at[ht-2*kt]+Wt],at[ht-kt]=wd[255+Xt+gr],at[ht+0]=wd[255+At-Gt],at[ht+kt]=wd[255+Dt-Wt]}F+=oe}}function Cc(C,F,W,oe,Ie,He){ki(C,F,W,1,16,oe,Ie,He)}function ea(C,F,W,oe,Ie,He){ki(C,F,1,W,16,oe,Ie,He)}function zc(C,F,W,oe,Ie,He){var qe;for(qe=3;0<qe;--qe)el(C,F+=4*W,W,1,16,oe,Ie,He)}function U(C,F,W,oe,Ie,He){var qe;for(qe=3;0<qe;--qe)el(C,F+=4,1,W,16,oe,Ie,He)}function _e(C,F,W,oe,Ie,He,qe,Je){ki(C,F,Ie,1,8,He,qe,Je),ki(W,oe,Ie,1,8,He,qe,Je)}function it(C,F,W,oe,Ie,He,qe,Je){ki(C,F,1,Ie,8,He,qe,Je),ki(W,oe,1,Ie,8,He,qe,Je)}function bt(C,F,W,oe,Ie,He,qe,Je){el(C,F+4*Ie,Ie,1,8,He,qe,Je),el(W,oe+4*Ie,Ie,1,8,He,qe,Je)}function Qt(C,F,W,oe,Ie,He,qe,Je){el(C,F+4,1,Ie,8,He,qe,Je),el(W,oe+4,1,Ie,8,He,qe,Je)}function cr(){this.ba=new me,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new mt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function jr(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function fn(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function bn(){this.ua=0,this.Wa=new Se,this.vb=new Se,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new de,this.yc=new P}function Un(){this.xb=this.a=0,this.l=new Qe,this.ca=new me,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new R,this.Pb=0,this.wd=new R,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new bn,this.ab=0,this.gc=o(4,fn),this.Oc=0}function Xn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Qe,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function oa(C,F,W,oe,Ie,He,qe){for(C=C==null?0:C[F+0],F=0;F<qe;++F)Ie[He+F]=C+W[oe+F]&255,C=Ie[He+F]}function Ea(C,F,W,oe,Ie,He,qe){var Je;if(C==null)oa(null,null,W,oe,Ie,He,qe);else for(Je=0;Je<qe;++Je)Ie[He+Je]=C[F+Je]+W[oe+Je]&255}function Da(C,F,W,oe,Ie,He,qe){if(C==null)oa(null,null,W,oe,Ie,He,qe);else{var Je,at=C[F+0],ht=at,kt=at;for(Je=0;Je<qe;++Je)ht=kt+(at=C[F+Je])-ht,kt=W[oe+Je]+(-256&ht?0>ht?0:255:ht)&255,ht=at,Ie[He+Je]=kt}}function Va(C,F,W,oe){var Ie=F.width,He=F.o;if(e(C!=null&&F!=null),0>W||0>=oe||W+oe>He)return null;if(!C.Cc){if(C.ga==null){var qe;if(C.ga=new Xn,(qe=C.ga==null)||(qe=F.width*F.o,e(C.Gb.length==0),C.Gb=s(qe),C.Uc=0,C.Gb==null?qe=0:(C.mb=C.Gb,C.nb=C.Uc,C.rc=null,qe=1),qe=!qe),!qe){qe=C.ga;var Je=C.Fa,at=C.P,ht=C.qc,kt=C.mb,Xt=C.nb,At=at+1,Dt=ht-1,Gt=qe.l;if(e(Je!=null&&kt!=null&&F!=null),a0[0]=null,a0[1]=oa,a0[2]=Ea,a0[3]=Da,qe.ca=kt,qe.tb=Xt,qe.c=F.width,qe.i=F.height,e(0<qe.c&&0<qe.i),1>=ht)F=0;else if(qe.$a=3&Je[at+0],qe.Z=Je[at+0]>>2&3,qe.Lc=Je[at+0]>>4&3,at=Je[at+0]>>6&3,0>qe.$a||1<qe.$a||4<=qe.Z||1<qe.Lc||at)F=0;else if(Gt.put=Oe,Gt.ac=Ft,Gt.bc=be,Gt.ma=qe,Gt.width=F.width,Gt.height=F.height,Gt.Da=F.Da,Gt.v=F.v,Gt.va=F.va,Gt.j=F.j,Gt.o=F.o,qe.$a)e:{e(qe.$a==1),F=Ge();t:for(;;){if(F==null){F=0;break e}if(e(qe!=null),qe.mc=F,F.c=qe.c,F.i=qe.i,F.l=qe.l,F.l.ma=qe,F.l.width=qe.c,F.l.height=qe.i,F.a=0,ae(F.m,Je,At,Dt),!ze(qe.c,qe.i,1,F,null)||(F.ab==1&&F.gc[0].hc==3&&H(F.s)?(qe.ic=1,Je=F.c*F.i,F.Ta=null,F.Ua=0,F.V=s(Je),F.Ba=0,F.V==null?(F.a=1,F=0):F=1):(qe.ic=0,F=Ke(F,qe.c)),!F))break t;F=1;break e}qe.mc=null,F=0}else F=Dt>=qe.c*qe.i;qe=!F}if(qe)return null;C.ga.Lc!=1?C.Ga=0:oe=He-W}e(C.ga!=null),e(W+oe<=He);e:{if(F=(Je=C.ga).c,He=Je.l.o,Je.$a==0){if(At=C.rc,Dt=C.Vc,Gt=C.Fa,at=C.P+1+W*F,ht=C.mb,kt=C.nb+W*F,e(at<=C.P+C.qc),Je.Z!=0)for(e(a0[Je.Z]!=null),qe=0;qe<oe;++qe)a0[Je.Z](At,Dt,Gt,at,ht,kt,F),At=ht,Dt=kt,kt+=F,at+=F;else for(qe=0;qe<oe;++qe)n(ht,kt,Gt,at,F),At=ht,Dt=kt,kt+=F,at+=F;C.rc=At,C.Vc=Dt}else{if(e(Je.mc!=null),F=W+oe,e((qe=Je.mc)!=null),e(F<=qe.i),qe.C>=F)F=1;else if(Je.ic||Wc(),Je.ic){Je=qe.V,At=qe.Ba,Dt=qe.c;var gr=qe.i,Wt=(Gt=1,at=qe.$/Dt,ht=qe.$%Dt,kt=qe.m,Xt=qe.s,qe.$),yr=Dt*gr,Cr=Dt*F,Mr=Xt.wc,Br=Wt<Cr?z(Xt,ht,at):null;e(Wt<=yr),e(F<=gr),e(H(Xt));t:for(;;){for(;!kt.h&&Wt<Cr;){if(ht&Mr||(Br=z(Xt,ht,at)),e(Br!=null),Y(kt),256>(gr=ct(Br.G[0],Br.H[0],kt)))Je[At+Wt]=gr,++Wt,++ht>=Dt&&(ht=0,++at<=F&&!(at%16)&&ue(qe,at));else{if(!(280>gr)){Gt=0;break t}gr=Le(gr-256,kt);var Pn,xn=ct(Br.G[4],Br.H[4],kt);if(Y(kt),!(Wt>=(xn=ut(Dt,xn=Le(xn,kt)))&&yr-Wt>=gr)){Gt=0;break t}for(Pn=0;Pn<gr;++Pn)Je[At+Wt+Pn]=Je[At+Wt+Pn-xn];for(Wt+=gr,ht+=gr;ht>=Dt;)ht-=Dt,++at<=F&&!(at%16)&&ue(qe,at);Wt<Cr&&ht&Mr&&(Br=z(Xt,ht,at))}e(kt.h==M(kt))}ue(qe,at>F?F:at);break t}!Gt||kt.h&&Wt<yr?(Gt=0,qe.a=kt.h?5:3):qe.$=Wt,F=Gt}else F=Pe(qe,qe.V,qe.Ba,qe.c,qe.i,F,pt);if(!F){oe=0;break e}}W+oe>=He&&(C.Cc=1),oe=1}if(!oe)return null;if(C.Cc&&((oe=C.ga)!=null&&(oe.mc=null),C.ga=null,0<C.Ga))return alert("todo:WebPDequantizeLevels"),null}return C.nb+W*Ie}function ti(C,F,W,oe,Ie,He){for(;0<Ie--;){var qe,Je=C,at=F+(W?1:0),ht=C,kt=F+(W?0:3);for(qe=0;qe<oe;++qe){var Xt=ht[kt+4*qe];Xt!=255&&(Xt*=32897,Je[at+4*qe+0]=Je[at+4*qe+0]*Xt>>23,Je[at+4*qe+1]=Je[at+4*qe+1]*Xt>>23,Je[at+4*qe+2]=Je[at+4*qe+2]*Xt>>23)}F+=He}}function as(C,F,W,oe,Ie){for(;0<oe--;){var He;for(He=0;He<W;++He){var qe=C[F+2*He+0],Je=15&(ht=C[F+2*He+1]),at=4369*Je,ht=(240&ht|ht>>4)*at>>16;C[F+2*He+0]=(240&qe|qe>>4)*at>>16&240|(15&qe|qe<<4)*at>>16>>4&15,C[F+2*He+1]=240&ht|Je}F+=Ie}}function ri(C,F,W,oe,Ie,He,qe,Je){var at,ht,kt=255;for(ht=0;ht<Ie;++ht){for(at=0;at<oe;++at){var Xt=C[F+at];He[qe+4*at]=Xt,kt&=Xt}F+=W,qe+=Je}return kt!=255}function Qs(C,F,W,oe,Ie){var He;for(He=0;He<Ie;++He)W[oe+He]=C[F+He]>>8}function Wc(){W1=ti,oL=as,lL=ri,cL=Qs}function eu(C,F,W){E[C]=function(oe,Ie,He,qe,Je,at,ht,kt,Xt,At,Dt,Gt,gr,Wt,yr,Cr,Mr){var Br,Pn=Mr-1>>1,xn=Je[at+0]|ht[kt+0]<<16,ha=Xt[At+0]|Dt[Gt+0]<<16;e(oe!=null);var _n=3*xn+ha+131074>>2;for(F(oe[Ie+0],255&_n,_n>>16,gr,Wt),He!=null&&(_n=3*ha+xn+131074>>2,F(He[qe+0],255&_n,_n>>16,yr,Cr)),Br=1;Br<=Pn;++Br){var Ta=Je[at+Br]|ht[kt+Br]<<16,So=Xt[At+Br]|Dt[Gt+Br]<<16,Aa=xn+Ta+ha+So+524296,En=Aa+2*(Ta+ha)>>3;_n=En+xn>>1,xn=(Aa=Aa+2*(xn+So)>>3)+Ta>>1,F(oe[Ie+2*Br-1],255&_n,_n>>16,gr,Wt+(2*Br-1)*W),F(oe[Ie+2*Br-0],255&xn,xn>>16,gr,Wt+(2*Br-0)*W),He!=null&&(_n=Aa+ha>>1,xn=En+So>>1,F(He[qe+2*Br-1],255&_n,_n>>16,yr,Cr+(2*Br-1)*W),F(He[qe+2*Br+0],255&xn,xn>>16,yr,Cr+(2*Br+0)*W)),xn=Ta,ha=So}1&Mr||(_n=3*xn+ha+131074>>2,F(oe[Ie+Mr-1],255&_n,_n>>16,gr,Wt+(Mr-1)*W),He!=null&&(_n=3*ha+xn+131074>>2,F(He[qe+Mr-1],255&_n,_n>>16,yr,Cr+(Mr-1)*W)))}}function tu(){au[_N]=Mue,au[EN]=yL,au[mL]=Lue,au[SN]=bL,au[jN]=wL,au[R3]=NL,au[pL]=Uue,au[M3]=yL,au[L3]=bL,au[IN]=wL,au[U3]=NL}function _(C){return C&-16384?0>C?0:255:C>>Que}function J(C,F){return _((19077*C>>8)+(26149*F>>8)-14234)}function ge(C,F,W){return _((19077*C>>8)-(6419*F>>8)-(13320*W>>8)+8708)}function et(C,F){return _((19077*C>>8)+(33050*F>>8)-17685)}function Ht(C,F,W,oe,Ie){oe[Ie+0]=J(C,W),oe[Ie+1]=ge(C,F,W),oe[Ie+2]=et(C,F)}function er(C,F,W,oe,Ie){oe[Ie+0]=et(C,F),oe[Ie+1]=ge(C,F,W),oe[Ie+2]=J(C,W)}function qr(C,F,W,oe,Ie){var He=ge(C,F,W);F=He<<3&224|et(C,F)>>3,oe[Ie+0]=248&J(C,W)|He>>5,oe[Ie+1]=F}function Pa(C,F,W,oe,Ie){var He=240&et(C,F)|15;oe[Ie+0]=240&J(C,W)|ge(C,F,W)>>4,oe[Ie+1]=He}function gi(C,F,W,oe,Ie){oe[Ie+0]=255,Ht(C,F,W,oe,Ie+1)}function ya(C,F,W,oe,Ie){er(C,F,W,oe,Ie),oe[Ie+3]=255}function Ha(C,F,W,oe,Ie){Ht(C,F,W,oe,Ie),oe[Ie+3]=255}function ks(C,F,W){E[C]=function(oe,Ie,He,qe,Je,at,ht,kt,Xt){for(var At=kt+(-2&Xt)*W;kt!=At;)F(oe[Ie+0],He[qe+0],Je[at+0],ht,kt),F(oe[Ie+1],He[qe+0],Je[at+0],ht,kt+W),Ie+=2,++qe,++at,kt+=2*W;1&Xt&&F(oe[Ie+0],He[qe+0],Je[at+0],ht,kt)}}function vd(C,F,W){return W==0?C==0?F==0?6:5:F==0?4:0:W}function ql(C,F,W,oe,Ie){switch(C>>>30){case 3:Jm(F,W,oe,Ie,0);break;case 2:ru(F,W,oe,Ie);break;case 1:ts(F,W,oe,Ie)}}function bl(C,F){var W,oe,Ie=F.M,He=F.Nb,qe=C.oc,Je=C.pc+40,at=C.oc,ht=C.pc+584,kt=C.oc,Xt=C.pc+600;for(W=0;16>W;++W)qe[Je+32*W-1]=129;for(W=0;8>W;++W)at[ht+32*W-1]=129,kt[Xt+32*W-1]=129;for(0<Ie?qe[Je-1-32]=at[ht-1-32]=kt[Xt-1-32]=129:(a(qe,Je-32-1,127,21),a(at,ht-32-1,127,9),a(kt,Xt-32-1,127,9)),oe=0;oe<C.za;++oe){var At=F.ya[F.aa+oe];if(0<oe){for(W=-1;16>W;++W)n(qe,Je+32*W-4,qe,Je+32*W+12,4);for(W=-1;8>W;++W)n(at,ht+32*W-4,at,ht+32*W+4,4),n(kt,Xt+32*W-4,kt,Xt+32*W+4,4)}var Dt=C.Gd,Gt=C.Hd+oe,gr=At.ad,Wt=At.Hc;if(0<Ie&&(n(qe,Je-32,Dt[Gt].y,0,16),n(at,ht-32,Dt[Gt].f,0,8),n(kt,Xt-32,Dt[Gt].ea,0,8)),At.Za){var yr=qe,Cr=Je-32+16;for(0<Ie&&(oe>=C.za-1?a(yr,Cr,Dt[Gt].y[15],4):n(yr,Cr,Dt[Gt+1].y,0,4)),W=0;4>W;W++)yr[Cr+128+W]=yr[Cr+256+W]=yr[Cr+384+W]=yr[Cr+0+W];for(W=0;16>W;++W,Wt<<=2)yr=qe,Cr=Je+_L[W],Xu[At.Ob[W]](yr,Cr),ql(Wt,gr,16*+W,yr,Cr)}else if(yr=vd(oe,Ie,At.Ob[0]),n0[yr](qe,Je),Wt!=0)for(W=0;16>W;++W,Wt<<=2)ql(Wt,gr,16*+W,qe,Je+_L[W]);for(W=At.Gc,yr=vd(oe,Ie,At.Dd),Eh[yr](at,ht),Eh[yr](kt,Xt),Wt=gr,yr=at,Cr=ht,255&(At=0|W)&&(170&At?Lf(Wt,256,yr,Cr):Ss(Wt,256,yr,Cr)),At=kt,Wt=Xt,255&(W>>=8)&&(170&W?Lf(gr,320,At,Wt):Ss(gr,320,At,Wt)),Ie<C.Ub-1&&(n(Dt[Gt].y,0,qe,Je+480,16),n(Dt[Gt].f,0,at,ht+224,8),n(Dt[Gt].ea,0,kt,Xt+224,8)),W=8*He*C.B,Dt=C.sa,Gt=C.ta+16*oe+16*He*C.R,gr=C.qa,At=C.ra+8*oe+W,Wt=C.Ha,yr=C.Ia+8*oe+W,W=0;16>W;++W)n(Dt,Gt+W*C.R,qe,Je+32*W,16);for(W=0;8>W;++W)n(gr,At+W*C.B,at,ht+32*W,8),n(Wt,yr+W*C.B,kt,Xt+32*W,8)}}function Wu(C,F,W,oe,Ie,He,qe,Je,at){var ht=[0],kt=[0],Xt=0,At=at!=null?at.kd:0,Dt=at??new jr;if(C==null||12>W)return 7;Dt.data=C,Dt.w=F,Dt.ha=W,F=[F],W=[W],Dt.gb=[Dt.gb];e:{var Gt=F,gr=W,Wt=Dt.gb;if(e(C!=null),e(gr!=null),e(Wt!=null),Wt[0]=0,12<=gr[0]&&!r(C,Gt[0],"RIFF")){if(r(C,Gt[0]+8,"WEBP")){Wt=3;break e}var yr=se(C,Gt[0]+4);if(12>yr||4294967286<yr){Wt=3;break e}if(At&&yr>gr[0]-8){Wt=7;break e}Wt[0]=yr,Gt[0]+=12,gr[0]-=12}Wt=0}if(Wt!=0)return Wt;for(yr=0<Dt.gb[0],W=W[0];;){e:{var Cr=C;gr=F,Wt=W;var Mr=ht,Br=kt,Pn=Gt=[0];if((_n=Xt=[Xt])[0]=0,8>Wt[0])Wt=7;else{if(!r(Cr,gr[0],"VP8X")){if(se(Cr,gr[0]+4)!=10){Wt=3;break e}if(18>Wt[0]){Wt=7;break e}var xn=se(Cr,gr[0]+8),ha=1+Xe(Cr,gr[0]+12);if(2147483648<=ha*(Cr=1+Xe(Cr,gr[0]+15))){Wt=3;break e}Pn!=null&&(Pn[0]=xn),Mr!=null&&(Mr[0]=ha),Br!=null&&(Br[0]=Cr),gr[0]+=18,Wt[0]-=18,_n[0]=1}Wt=0}}if(Xt=Xt[0],Gt=Gt[0],Wt!=0)return Wt;if(gr=!!(2&Gt),!yr&&Xt)return 3;if(He!=null&&(He[0]=!!(16&Gt)),qe!=null&&(qe[0]=gr),Je!=null&&(Je[0]=0),qe=ht[0],Gt=kt[0],Xt&&gr&&at==null){Wt=0;break}if(4>W){Wt=7;break}if(yr&&Xt||!yr&&!Xt&&!r(C,F[0],"ALPH")){W=[W],Dt.na=[Dt.na],Dt.P=[Dt.P],Dt.Sa=[Dt.Sa];e:{xn=C,Wt=F,yr=W;var _n=Dt.gb;Mr=Dt.na,Br=Dt.P,Pn=Dt.Sa,ha=22,e(xn!=null),e(yr!=null),Cr=Wt[0];var Ta=yr[0];for(e(Mr!=null),e(Pn!=null),Mr[0]=null,Br[0]=null,Pn[0]=0;;){if(Wt[0]=Cr,yr[0]=Ta,8>Ta){Wt=7;break e}var So=se(xn,Cr+4);if(4294967286<So){Wt=3;break e}var Aa=8+So+1&-2;if(ha+=Aa,0<_n&&ha>_n){Wt=3;break e}if(!r(xn,Cr,"VP8 ")||!r(xn,Cr,"VP8L")){Wt=0;break e}if(Ta[0]<Aa){Wt=7;break e}r(xn,Cr,"ALPH")||(Mr[0]=xn,Br[0]=Cr+8,Pn[0]=So),Cr+=Aa,Ta-=Aa}}if(W=W[0],Dt.na=Dt.na[0],Dt.P=Dt.P[0],Dt.Sa=Dt.Sa[0],Wt!=0)break}W=[W],Dt.Ja=[Dt.Ja],Dt.xa=[Dt.xa];e:if(_n=C,Wt=F,yr=W,Mr=Dt.gb[0],Br=Dt.Ja,Pn=Dt.xa,xn=Wt[0],Cr=!r(_n,xn,"VP8 "),ha=!r(_n,xn,"VP8L"),e(_n!=null),e(yr!=null),e(Br!=null),e(Pn!=null),8>yr[0])Wt=7;else{if(Cr||ha){if(_n=se(_n,xn+4),12<=Mr&&_n>Mr-12){Wt=3;break e}if(At&&_n>yr[0]-8){Wt=7;break e}Br[0]=_n,Wt[0]+=8,yr[0]-=8,Pn[0]=ha}else Pn[0]=5<=yr[0]&&_n[xn+0]==47&&!(_n[xn+4]>>5),Br[0]=yr[0];Wt=0}if(W=W[0],Dt.Ja=Dt.Ja[0],Dt.xa=Dt.xa[0],F=F[0],Wt!=0)break;if(4294967286<Dt.Ja)return 3;if(Je==null||gr||(Je[0]=Dt.xa?2:1),qe=[qe],Gt=[Gt],Dt.xa){if(5>W){Wt=7;break}Je=qe,At=Gt,gr=He,C==null||5>W?C=0:5<=W&&C[F+0]==47&&!(C[F+4]>>5)?(yr=[0],_n=[0],Mr=[0],ae(Br=new R,C,F,W),Ae(Br,yr,_n,Mr)?(Je!=null&&(Je[0]=yr[0]),At!=null&&(At[0]=_n[0]),gr!=null&&(gr[0]=Mr[0]),C=1):C=0):C=0}else{if(10>W){Wt=7;break}Je=Gt,C==null||10>W||!ln(C,F+3,W-3)?C=0:(At=C[F+0]|C[F+1]<<8|C[F+2]<<16,gr=16383&(C[F+7]<<8|C[F+6]),C=16383&(C[F+9]<<8|C[F+8]),1&At||3<(At>>1&7)||!(At>>4&1)||At>>5>=Dt.Ja||!gr||!C?C=0:(qe&&(qe[0]=gr),Je&&(Je[0]=C),C=1))}if(!C||(qe=qe[0],Gt=Gt[0],Xt&&(ht[0]!=qe||kt[0]!=Gt)))return 3;at!=null&&(at[0]=Dt,at.offset=F-at.w,e(4294967286>F-at.w),e(at.offset==at.ha-W));break}return Wt==0||Wt==7&&Xt&&at==null?(He!=null&&(He[0]|=Dt.na!=null&&0<Dt.na.length),oe!=null&&(oe[0]=qe),Ie!=null&&(Ie[0]=Gt),0):Wt}function Q1(C,F,W){var oe=F.width,Ie=F.height,He=0,qe=0,Je=oe,at=Ie;if(F.Da=C!=null&&0<C.Da,F.Da&&(Je=C.cd,at=C.bd,He=C.v,qe=C.j,11>W||(He&=-2,qe&=-2),0>He||0>qe||0>=Je||0>=at||He+Je>oe||qe+at>Ie))return 0;if(F.v=He,F.j=qe,F.va=He+Je,F.o=qe+at,F.U=Je,F.T=at,F.da=C!=null&&0<C.da,F.da){if(!Ee(Je,at,W=[C.ib],He=[C.hb]))return 0;F.ib=W[0],F.hb=He[0]}return F.ob=C!=null&&C.ob,F.Kb=C==null||!C.Sd,F.da&&(F.ob=F.ib<3*oe/4&&F.hb<3*Ie/4,F.Kb=0),1}function V1(C){if(C==null)return 2;if(11>C.S){var F=C.f.RGBA;F.fb+=(C.height-1)*F.A,F.A=-F.A}else F=C.f.kb,C=C.height,F.O+=(C-1)*F.fa,F.fa=-F.fa,F.N+=(C-1>>1)*F.Ab,F.Ab=-F.Ab,F.W+=(C-1>>1)*F.Db,F.Db=-F.Db,F.F!=null&&(F.J+=(C-1)*F.lb,F.lb=-F.lb);return 0}function XA(C,F,W,oe){if(oe==null||0>=C||0>=F)return 2;if(W!=null){if(W.Da){var Ie=W.cd,He=W.bd,qe=-2&W.v,Je=-2&W.j;if(0>qe||0>Je||0>=Ie||0>=He||qe+Ie>C||Je+He>F)return 2;C=Ie,F=He}if(W.da){if(!Ee(C,F,Ie=[W.ib],He=[W.hb]))return 2;C=Ie[0],F=He[0]}}oe.width=C,oe.height=F;e:{var at=oe.width,ht=oe.height;if(C=oe.S,0>=at||0>=ht||!(C>=_N&&13>C))C=2;else{if(0>=oe.Rd&&oe.sd==null){qe=He=Ie=F=0;var kt=(Je=at*EL[C])*ht;if(11>C||(He=(ht+1)/2*(F=(at+1)/2),C==12&&(qe=(Ie=at)*ht)),(ht=s(kt+2*He+qe))==null){C=1;break e}oe.sd=ht,11>C?((at=oe.f.RGBA).eb=ht,at.fb=0,at.A=Je,at.size=kt):((at=oe.f.kb).y=ht,at.O=0,at.fa=Je,at.Fd=kt,at.f=ht,at.N=0+kt,at.Ab=F,at.Cd=He,at.ea=ht,at.W=0+kt+He,at.Db=F,at.Ed=He,C==12&&(at.F=ht,at.J=0+kt+2*He),at.Tc=qe,at.lb=Ie)}if(F=1,Ie=oe.S,He=oe.width,qe=oe.height,Ie>=_N&&13>Ie)if(11>Ie)C=oe.f.RGBA,F&=(Je=Math.abs(C.A))*(qe-1)+He<=C.size,F&=Je>=He*EL[Ie],F&=C.eb!=null;else{C=oe.f.kb,Je=(He+1)/2,kt=(qe+1)/2,at=Math.abs(C.fa),ht=Math.abs(C.Ab);var Xt=Math.abs(C.Db),At=Math.abs(C.lb),Dt=At*(qe-1)+He;F&=at*(qe-1)+He<=C.Fd,F&=ht*(kt-1)+Je<=C.Cd,F=(F&=Xt*(kt-1)+Je<=C.Ed)&at>=He&ht>=Je&Xt>=Je,F&=C.y!=null,F&=C.f!=null,F&=C.ea!=null,Ie==12&&(F&=At>=He,F&=Dt<=C.Tc,F&=C.F!=null)}else F=0;C=F?0:2}}return C!=0||W!=null&&W.fd&&(C=V1(oe)),C}var Xm=64,yd=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],bd=24,YA=32,Ch=8,JA=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];vt("Predictor0","PredictorAdd0"),E.Predictor0=function(){return 4278190080},E.Predictor1=function(C){return C},E.Predictor2=function(C,F,W){return F[W+0]},E.Predictor3=function(C,F,W){return F[W+1]},E.Predictor4=function(C,F,W){return F[W-1]},E.Predictor5=function(C,F,W){return Tt(Tt(C,F[W+1]),F[W+0])},E.Predictor6=function(C,F,W){return Tt(C,F[W-1])},E.Predictor7=function(C,F,W){return Tt(C,F[W+0])},E.Predictor8=function(C,F,W){return Tt(F[W-1],F[W+0])},E.Predictor9=function(C,F,W){return Tt(F[W+0],F[W+1])},E.Predictor10=function(C,F,W){return Tt(Tt(C,F[W-1]),Tt(F[W+0],F[W+1]))},E.Predictor11=function(C,F,W){var oe=F[W+0];return 0>=Et(oe>>24&255,C>>24&255,(F=F[W-1])>>24&255)+Et(oe>>16&255,C>>16&255,F>>16&255)+Et(oe>>8&255,C>>8&255,F>>8&255)+Et(255&oe,255&C,255&F)?oe:C},E.Predictor12=function(C,F,W){var oe=F[W+0];return(Lt((C>>24&255)+(oe>>24&255)-((F=F[W-1])>>24&255))<<24|Lt((C>>16&255)+(oe>>16&255)-(F>>16&255))<<16|Lt((C>>8&255)+(oe>>8&255)-(F>>8&255))<<8|Lt((255&C)+(255&oe)-(255&F)))>>>0},E.Predictor13=function(C,F,W){var oe=F[W-1];return(Rt((C=Tt(C,F[W+0]))>>24&255,oe>>24&255)<<24|Rt(C>>16&255,oe>>16&255)<<16|Rt(C>>8&255,oe>>8&255)<<8|Rt(255&C,255&oe))>>>0};var H1=E.PredictorAdd0;E.PredictorAdd1=Re,vt("Predictor2","PredictorAdd2"),vt("Predictor3","PredictorAdd3"),vt("Predictor4","PredictorAdd4"),vt("Predictor5","PredictorAdd5"),vt("Predictor6","PredictorAdd6"),vt("Predictor7","PredictorAdd7"),vt("Predictor8","PredictorAdd8"),vt("Predictor9","PredictorAdd9"),vt("Predictor10","PredictorAdd10"),vt("Predictor11","PredictorAdd11"),vt("Predictor12","PredictorAdd12"),vt("Predictor13","PredictorAdd13");var Zg=E.PredictorAdd2;Fe("ColorIndexInverseTransform","MapARGB","32b",function(C){return C>>8&255},function(C){return C}),Fe("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(C){return C},function(C){return C>>8&255});var Ki,wN=E.ColorIndexInverseTransform,Rf=E.MapARGB,Mf=E.VP8LColorIndexInverseTransformAlpha,$1=E.MapAlpha,G1=E.VP8LPredictorsAdd=[];G1.length=16,(E.VP8LPredictors=[]).length=16,(E.VP8LPredictorsAdd_C=[]).length=16,(E.VP8LPredictors_C=[]).length=16;var K1,q1,ZA,e0,t0,Ym,r0,Jm,ru,Lf,ts,Ss,qi,Eo,_h,z1,ex,NN,tL,rL,nL,aL,sL,iL,W1,oL,lL,cL,dL=s(511),uL=s(2041),fL=s(225),hL=s(767),AL=0,D3=uL,CN=fL,wd=hL,nu=dL,_N=0,EN=1,mL=2,SN=3,jN=4,R3=5,pL=6,M3=7,L3=8,IN=9,U3=10,Cue=[2,3,7],_ue=[3,3,11],gL=[280,256,256,256,40],Eue=[0,1,1,1,0],Sue=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],jue=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Iue=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Pue=8,Q3=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],V3=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],X1=null,Tue=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Bue=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],xL=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],kue=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Fue=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Oue=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Due=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],n0=[],Xu=[],Eh=[],Rue=1,vL=2,a0=[],au=[];eu("UpsampleRgbLinePair",Ht,3),eu("UpsampleBgrLinePair",er,3),eu("UpsampleRgbaLinePair",Ha,4),eu("UpsampleBgraLinePair",ya,4),eu("UpsampleArgbLinePair",gi,4),eu("UpsampleRgba4444LinePair",Pa,2),eu("UpsampleRgb565LinePair",qr,2);var Mue=E.UpsampleRgbLinePair,Lue=E.UpsampleBgrLinePair,yL=E.UpsampleRgbaLinePair,bL=E.UpsampleBgraLinePair,wL=E.UpsampleArgbLinePair,NL=E.UpsampleRgba4444LinePair,Uue=E.UpsampleRgb565LinePair,PN=16,TN=1<<PN-1,Y1=-227,H3=482,Que=6,CL=0,Vue=s(256),Hue=s(256),$ue=s(256),Gue=s(256),Kue=s(H3-Y1),que=s(H3-Y1);ks("YuvToRgbRow",Ht,3),ks("YuvToBgrRow",er,3),ks("YuvToRgbaRow",Ha,4),ks("YuvToBgraRow",ya,4),ks("YuvToArgbRow",gi,4),ks("YuvToRgba4444Row",Pa,2),ks("YuvToRgb565Row",qr,2);var _L=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],BN=[0,2,8],zue=[8,7,6,4,4,2,2,2,1,1,1,1],Wue=1;this.WebPDecodeRGBA=function(C,F,W,oe,Ie){var He=EN,qe=new cr,Je=new me;qe.ba=Je,Je.S=He,Je.width=[Je.width],Je.height=[Je.height];var at=Je.width,ht=Je.height,kt=new ye;if(kt==null||C==null)var Xt=2;else e(kt!=null),Xt=Wu(C,F,W,kt.width,kt.height,kt.Pd,kt.Qd,kt.format,null);if(Xt!=0?at=0:(at!=null&&(at[0]=kt.width[0]),ht!=null&&(ht[0]=kt.height[0]),at=1),at){Je.width=Je.width[0],Je.height=Je.height[0],oe!=null&&(oe[0]=Je.width),Ie!=null&&(Ie[0]=Je.height);e:{if(oe=new Qe,(Ie=new jr).data=C,Ie.w=F,Ie.ha=W,Ie.kd=1,F=[0],e(Ie!=null),((C=Wu(Ie.data,Ie.w,Ie.ha,null,null,null,F,null,Ie))==0||C==7)&&F[0]&&(C=4),(F=C)==0){if(e(qe!=null),oe.data=Ie.data,oe.w=Ie.w+Ie.offset,oe.ha=Ie.ha-Ie.offset,oe.put=Oe,oe.ac=Ft,oe.bc=be,oe.ma=qe,Ie.xa){if((C=Ge())==null){qe=1;break e}if(function(At,Dt){var Gt=[0],gr=[0],Wt=[0];t:for(;;){if(At==null)return 0;if(Dt==null)return At.a=2,0;if(At.l=Dt,At.a=0,ae(At.m,Dt.data,Dt.w,Dt.ha),!Ae(At.m,Gt,gr,Wt)){At.a=3;break t}if(At.xb=vL,Dt.width=Gt[0],Dt.height=gr[0],!ze(Gt[0],gr[0],1,At,null))break t;return 1}return e(At.a!=0),0}(C,oe)){if(oe=(F=XA(oe.width,oe.height,qe.Oa,qe.ba))==0){t:{oe=C;r:for(;;){if(oe==null){oe=0;break t}if(e(oe.s.yc!=null),e(oe.s.Ya!=null),e(0<oe.s.Wb),e((W=oe.l)!=null),e((Ie=W.ma)!=null),oe.xb!=0){if(oe.ca=Ie.ba,oe.tb=Ie.tb,e(oe.ca!=null),!Q1(Ie.Oa,W,SN)){oe.a=2;break r}if(!Ke(oe,W.width)||W.da)break r;if((W.da||pe(oe.ca.S))&&Wc(),11>oe.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),oe.ca.f.kb.F!=null&&Wc()),oe.Pb&&0<oe.s.ua&&oe.s.vb.X==null&&!Z(oe.s.vb,oe.s.Wa.Xa)){oe.a=1;break r}oe.xb=0}if(!Pe(oe,oe.V,oe.Ba,oe.c,oe.i,W.o,re))break r;Ie.Dc=oe.Ma,oe=1;break t}e(oe.a!=0),oe=0}oe=!oe}oe&&(F=C.a)}else F=C.a}else{if((C=new jt)==null){qe=1;break e}if(C.Fa=Ie.na,C.P=Ie.P,C.qc=Ie.Sa,cn(C,oe)){if((F=XA(oe.width,oe.height,qe.Oa,qe.ba))==0){if(C.Aa=0,W=qe.Oa,e((Ie=C)!=null),W!=null){if(0<(at=0>(at=W.Md)?0:100<at?255:255*at/100)){for(ht=kt=0;4>ht;++ht)12>(Xt=Ie.pb[ht]).lc&&(Xt.ia=at*zue[0>Xt.lc?0:Xt.lc]>>3),kt|=Xt.ia;kt&&(alert("todo:VP8InitRandom"),Ie.ia=1)}Ie.Ga=W.Id,100<Ie.Ga?Ie.Ga=100:0>Ie.Ga&&(Ie.Ga=0)}(function(At,Dt){if(At==null)return 0;if(Dt==null)return wr(At,2,"NULL VP8Io parameter in VP8Decode().");if(!At.cb&&!cn(At,Dt))return 0;if(e(At.cb),Dt.ac==null||Dt.ac(Dt)){Dt.ob&&(At.L=0);var Gt=BN[At.L];if(At.L==2?(At.yb=0,At.zb=0):(At.yb=Dt.v-Gt>>4,At.zb=Dt.j-Gt>>4,0>At.yb&&(At.yb=0),0>At.zb&&(At.zb=0)),At.Va=Dt.o+15+Gt>>4,At.Hb=Dt.va+15+Gt>>4,At.Hb>At.za&&(At.Hb=At.za),At.Va>At.Ub&&(At.Va=At.Ub),0<At.L){var gr=At.ed;for(Gt=0;4>Gt;++Gt){var Wt;if(At.Qa.Cb){var yr=At.Qa.Lb[Gt];At.Qa.Fb||(yr+=gr.Tb)}else yr=gr.Tb;for(Wt=0;1>=Wt;++Wt){var Cr=At.gd[Gt][Wt],Mr=yr;if(gr.Pc&&(Mr+=gr.vd[0],Wt&&(Mr+=gr.od[0])),0<(Mr=0>Mr?0:63<Mr?63:Mr)){var Br=Mr;0<gr.wb&&(Br=4<gr.wb?Br>>2:Br>>1)>9-gr.wb&&(Br=9-gr.wb),1>Br&&(Br=1),Cr.dd=Br,Cr.tc=2*Mr+Br,Cr.ld=40<=Mr?2:15<=Mr?1:0}else Cr.tc=0;Cr.La=Wt}}}Gt=0}else wr(At,6,"Frame setup failed"),Gt=At.a;if(Gt=Gt==0){if(Gt){At.$c=0,0<At.Aa||(At.Ic=Wue);t:{Gt=At.Ic,gr=4*(Br=At.za);var Pn=32*Br,xn=Br+1,ha=0<At.L?Br*(0<At.Aa?2:1):0,_n=(At.Aa==2?2:1)*Br;if((Cr=gr+832+(Wt=3*(16*Gt+BN[At.L])/2*Pn)+(yr=At.Fa!=null&&0<At.Fa.length?At.Kc.c*At.Kc.i:0))!=Cr)Gt=0;else{if(Cr>At.Vb){if(At.Vb=0,At.Ec=s(Cr),At.Fc=0,At.Ec==null){Gt=wr(At,1,"no memory during frame initialization.");break t}At.Vb=Cr}Cr=At.Ec,Mr=At.Fc,At.Ac=Cr,At.Bc=Mr,Mr+=gr,At.Gd=o(Pn,dn),At.Hd=0,At.rb=o(xn+1,Or),At.sb=1,At.wa=ha?o(ha,tr):null,At.Y=0,At.D.Nb=0,At.D.wa=At.wa,At.D.Y=At.Y,0<At.Aa&&(At.D.Y+=Br),e(!0),At.oc=Cr,At.pc=Mr,Mr+=832,At.ya=o(_n,ur),At.aa=0,At.D.ya=At.ya,At.D.aa=At.aa,At.Aa==2&&(At.D.aa+=Br),At.R=16*Br,At.B=8*Br,Br=(Pn=BN[At.L])*At.R,Pn=Pn/2*At.B,At.sa=Cr,At.ta=Mr+Br,At.qa=At.sa,At.ra=At.ta+16*Gt*At.R+Pn,At.Ha=At.qa,At.Ia=At.ra+8*Gt*At.B+Pn,At.$c=0,Mr+=Wt,At.mb=yr?Cr:null,At.nb=yr?Mr:null,e(Mr+yr<=At.Fc+At.Vb),Jt(At),a(At.Ac,At.Bc,0,gr),Gt=1}}if(Gt){if(Dt.ka=0,Dt.y=At.sa,Dt.O=At.ta,Dt.f=At.qa,Dt.N=At.ra,Dt.ea=At.Ha,Dt.Vd=At.Ia,Dt.fa=At.R,Dt.Rc=At.B,Dt.F=null,Dt.J=0,!AL){for(Gt=-255;255>=Gt;++Gt)dL[255+Gt]=0>Gt?-Gt:Gt;for(Gt=-1020;1020>=Gt;++Gt)uL[1020+Gt]=-128>Gt?-128:127<Gt?127:Gt;for(Gt=-112;112>=Gt;++Gt)fL[112+Gt]=-16>Gt?-16:15<Gt?15:Gt;for(Gt=-255;510>=Gt;++Gt)hL[255+Gt]=0>Gt?0:255<Gt?255:Gt;AL=1}r0=Be,Jm=Nt,Lf=nr,ts=$t,Ss=Mt,ru=Ln,qi=Cc,Eo=ea,_h=_e,z1=it,ex=zc,NN=U,tL=bt,rL=Qt,nL=Fn,aL=aa,sL=Wa,iL=Zo,Xu[0]=Hr,Xu[1]=Vt,Xu[2]=fr,Xu[3]=or,Xu[4]=br,Xu[5]=Ir,Xu[6]=hr,Xu[7]=en,Xu[8]=da,Xu[9]=sn,n0[0]=dr,n0[1]=qt,n0[2]=sr,n0[3]=vr,n0[4]=we,n0[5]=ft,n0[6]=St,Eh[0]=pr,Eh[1]=Ot,Eh[2]=Zn,Eh[3]=wn,Eh[4]=Hn,Eh[5]=Sr,Eh[6]=$r,Gt=1}else Gt=0}Gt&&(Gt=function(Ta,So){for(Ta.M=0;Ta.M<Ta.Va;++Ta.M){var Aa,En=Ta.Jc[Ta.M&Ta.Xb],nn=Ta.m,zi=Ta;for(Aa=0;Aa<zi.za;++Aa){var la=nn,Ba=zi,Vs=Ba.Ac,wl=Ba.Bc+4*Aa,_c=Ba.zc,Fi=Ba.ya[Ba.aa+Aa];if(Ba.Qa.Bb?Fi.$b=te(la,Ba.Pa.jb[0])?2+te(la,Ba.Pa.jb[2]):te(la,Ba.Pa.jb[1]):Fi.$b=0,Ba.kc&&(Fi.Ad=te(la,Ba.Bd)),Fi.Za=!te(la,145)+0,Fi.Za){var zl=Fi.Ob,Ec=0;for(Ba=0;4>Ba;++Ba){var jo,Ra=_c[0+Ba];for(jo=0;4>jo;++jo){Ra=Fue[Vs[wl+jo]][Ra];for(var ss=xL[te(la,Ra[0])];0<ss;)ss=xL[2*ss+te(la,Ra[ss])];Ra=-ss,Vs[wl+jo]=Ra}n(zl,Ec,Vs,wl,4),Ec+=4,_c[0+Ba]=Ra}}else Ra=te(la,156)?te(la,128)?1:3:te(la,163)?2:0,Fi.Ob[0]=Ra,a(Vs,wl,Ra,4),a(_c,0,Ra,4);Fi.Dd=te(la,142)?te(la,114)?te(la,183)?1:3:2:0}if(zi.m.Ka)return wr(Ta,7,"Premature end-of-partition0 encountered.");for(;Ta.ja<Ta.za;++Ta.ja){if(zi=En,la=(nn=Ta).rb[nn.sb-1],Vs=nn.rb[nn.sb+nn.ja],Aa=nn.ya[nn.aa+nn.ja],wl=nn.kc?Aa.Ad:0)la.la=Vs.la=0,Aa.Za||(la.Na=Vs.Na=0),Aa.Hc=0,Aa.Gc=0,Aa.ia=0;else{var Oi,is;if(la=Vs,Vs=zi,wl=nn.Pa.Xc,_c=nn.ya[nn.aa+nn.ja],Fi=nn.pb[_c.$b],Ba=_c.ad,zl=0,Ec=nn.rb[nn.sb-1],Ra=jo=0,a(Ba,zl,0,384),_c.Za)var Nl=0,Yu=wl[3];else{ss=s(16);var Wi=la.Na+Ec.Na;if(Wi=X1(Vs,wl[1],Wi,Fi.Eb,0,ss,0),la.Na=Ec.Na=(0<Wi)+0,1<Wi)r0(ss,0,Ba,zl);else{var Xc=ss[0]+3>>3;for(ss=0;256>ss;ss+=16)Ba[zl+ss]=Xc}Nl=1,Yu=wl[0]}var js=15&la.la,Io=15&Ec.la;for(ss=0;4>ss;++ss){var Nd=1&Io;for(Xc=is=0;4>Xc;++Xc)js=js>>1|(Nd=(Wi=X1(Vs,Yu,Wi=Nd+(1&js),Fi.Sc,Nl,Ba,zl))>Nl)<<7,is=is<<2|(3<Wi?3:1<Wi?2:Ba[zl+0]!=0),zl+=16;js>>=4,Io=Io>>1|Nd<<7,jo=(jo<<8|is)>>>0}for(Yu=js,Nl=Io>>4,Oi=0;4>Oi;Oi+=2){for(is=0,js=la.la>>4+Oi,Io=Ec.la>>4+Oi,ss=0;2>ss;++ss){for(Nd=1&Io,Xc=0;2>Xc;++Xc)Wi=Nd+(1&js),js=js>>1|(Nd=0<(Wi=X1(Vs,wl[2],Wi,Fi.Qc,0,Ba,zl)))<<3,is=is<<2|(3<Wi?3:1<Wi?2:Ba[zl+0]!=0),zl+=16;js>>=2,Io=Io>>1|Nd<<5}Ra|=is<<4*Oi,Yu|=js<<4<<Oi,Nl|=(240&Io)<<Oi}la.la=Yu,Ec.la=Nl,_c.Hc=jo,_c.Gc=Ra,_c.ia=43690&Ra?0:Fi.ia,wl=!(jo|Ra)}if(0<nn.L&&(nn.wa[nn.Y+nn.ja]=nn.gd[Aa.$b][Aa.Za],nn.wa[nn.Y+nn.ja].La|=!wl),zi.Ka)return wr(Ta,7,"Premature end-of-file encountered.")}if(Jt(Ta),nn=So,zi=1,Aa=(En=Ta).D,la=0<En.L&&En.M>=En.zb&&En.M<=En.Va,En.Aa==0)t:{if(Aa.M=En.M,Aa.uc=la,bl(En,Aa),zi=1,Aa=(is=En.D).Nb,la=(Ra=BN[En.L])*En.R,Vs=Ra/2*En.B,ss=16*Aa*En.R,Xc=8*Aa*En.B,wl=En.sa,_c=En.ta-la+ss,Fi=En.qa,Ba=En.ra-Vs+Xc,zl=En.Ha,Ec=En.Ia-Vs+Xc,Io=(js=is.M)==0,jo=js>=En.Va-1,En.Aa==2&&bl(En,is),is.uc)for(Nd=(Wi=En).D.M,e(Wi.D.uc),is=Wi.yb;is<Wi.Hb;++is){Nl=is,Yu=Nd;var Sc=(Cd=(Cl=Wi).D).Nb;Oi=Cl.R;var Cd=Cd.wa[Cd.Y+Nl],_d=Cl.sa,Yc=Cl.ta+16*Sc*Oi+16*Nl,Ed=Cd.dd,Fs=Cd.tc;if(Fs!=0)if(e(3<=Fs),Cl.L==1)0<Nl&&aL(_d,Yc,Oi,Fs+4),Cd.La&&iL(_d,Yc,Oi,Fs),0<Yu&&nL(_d,Yc,Oi,Fs+4),Cd.La&&sL(_d,Yc,Oi,Fs);else{var Sd=Cl.B,Ju=Cl.qa,Zm=Cl.ra+8*Sc*Sd+8*Nl,Sh=Cl.Ha,Cl=Cl.Ia+8*Sc*Sd+8*Nl;Sc=Cd.ld,0<Nl&&(Eo(_d,Yc,Oi,Fs+4,Ed,Sc),z1(Ju,Zm,Sh,Cl,Sd,Fs+4,Ed,Sc)),Cd.La&&(NN(_d,Yc,Oi,Fs,Ed,Sc),rL(Ju,Zm,Sh,Cl,Sd,Fs,Ed,Sc)),0<Yu&&(qi(_d,Yc,Oi,Fs+4,Ed,Sc),_h(Ju,Zm,Sh,Cl,Sd,Fs+4,Ed,Sc)),Cd.La&&(ex(_d,Yc,Oi,Fs,Ed,Sc),tL(Ju,Zm,Sh,Cl,Sd,Fs,Ed,Sc))}}if(En.ia&&alert("todo:DitherRow"),nn.put!=null){if(is=16*js,js=16*(js+1),Io?(nn.y=En.sa,nn.O=En.ta+ss,nn.f=En.qa,nn.N=En.ra+Xc,nn.ea=En.Ha,nn.W=En.Ia+Xc):(is-=Ra,nn.y=wl,nn.O=_c,nn.f=Fi,nn.N=Ba,nn.ea=zl,nn.W=Ec),jo||(js-=Ra),js>nn.o&&(js=nn.o),nn.F=null,nn.J=null,En.Fa!=null&&0<En.Fa.length&&is<js&&(nn.J=Va(En,nn,is,js-is),nn.F=En.mb,nn.F==null&&nn.F.length==0)){zi=wr(En,3,"Could not decode alpha data.");break t}is<nn.j&&(Ra=nn.j-is,is=nn.j,e(!(1&Ra)),nn.O+=En.R*Ra,nn.N+=En.B*(Ra>>1),nn.W+=En.B*(Ra>>1),nn.F!=null&&(nn.J+=nn.width*Ra)),is<js&&(nn.O+=nn.v,nn.N+=nn.v>>1,nn.W+=nn.v>>1,nn.F!=null&&(nn.J+=nn.v),nn.ka=is-nn.j,nn.U=nn.va-nn.v,nn.T=js-is,zi=nn.put(nn))}Aa+1!=En.Ic||jo||(n(En.sa,En.ta-la,wl,_c+16*En.R,la),n(En.qa,En.ra-Vs,Fi,Ba+8*En.B,Vs),n(En.Ha,En.Ia-Vs,zl,Ec+8*En.B,Vs))}if(!zi)return wr(Ta,6,"Output aborted.")}return 1}(At,Dt)),Dt.bc!=null&&Dt.bc(Dt),Gt&=1}return Gt?(At.cb=0,Gt):0})(C,oe)||(F=C.a)}}else F=C.a}F==0&&qe.Oa!=null&&qe.Oa.fd&&(F=V1(qe.ba))}qe=F}He=qe!=0?null:11>He?Je.f.RGBA.eb:Je.f.kb.y}else He=null;return He};var EL=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(E,B){for(var k="",T=0;T<4;T++)k+=String.fromCharCode(E[B++]);return k}function u(E,B){return E[B+0]|E[B+1]<<8}function f(E,B){return(E[B+0]|E[B+1]<<8|E[B+2]<<16)>>>0}function A(E,B){return(E[B+0]|E[B+1]<<8|E[B+2]<<16|E[B+3]<<24)>>>0}new c;var h=[0],m=[0],p=[],x=new c,v=t,y=function(E,B){var k={},T=0,P=!1,q=0,de=0;if(k.frames=[],!function(O,R){for(var G=0;G<4;G++)if(O[R+G]!="RIFF".charCodeAt(G))return!0;return!1}(E,B)){for(A(E,B+=4),B+=8;B<E.length;){var ce=d(E,B),le=A(E,B+=4);B+=4;var he=le+(1&le);switch(ce){case"VP8 ":case"VP8L":k.frames[T]===void 0&&(k.frames[T]={}),(De=k.frames[T]).src_off=P?de:B-8,De.src_size=q+le+8,T++,P&&(P=!1,q=0,de=0);break;case"VP8X":(De=k.header={}).feature_flags=E[B];var ae=B+4;De.canvas_width=1+f(E,ae),ae+=3,De.canvas_height=1+f(E,ae),ae+=3;break;case"ALPH":P=!0,q=he+8,de=B-8;break;case"ANIM":(De=k.header).bgcolor=A(E,B),ae=B+4,De.loop_count=u(E,ae),ae+=2;break;case"ANMF":var Ce,De;(De=k.frames[T]={}).offset_x=2*f(E,B),B+=3,De.offset_y=2*f(E,B),B+=3,De.width=1+f(E,B),B+=3,De.height=1+f(E,B),B+=3,De.duration=f(E,B),B+=3,Ce=E[B++],De.dispose=1&Ce,De.blend=Ce>>1&1}ce!="ANMF"&&(B+=he)}return k}}(v,0);y.response=v,y.rgbaoutput=!0,y.dataurl=!1;var b=y.header?y.header:null,w=y.frames?y.frames:null;if(b){b.loop_counter=b.loop_count,h=[b.canvas_height],m=[b.canvas_width];for(var I=0;I<w.length&&w[I].blend!=0;I++);}var j=w[0],N=x.WebPDecodeRGBA(v,j.src_off,j.src_size,m,h);j.rgba=N,j.imgwidth=m[0],j.imgheight=h[0];for(var S=0;S<m[0]*h[0]*4;S++)p[S]=N[S];return this.width=m,this.height=h,this.data=p,this}(function(t){var e,r,n,a,s,o,l,c,d,u=function(O){return O=O||{},this.isStrokeTransparent=O.isStrokeTransparent||!1,this.strokeOpacity=O.strokeOpacity||1,this.strokeStyle=O.strokeStyle||"#000000",this.fillStyle=O.fillStyle||"#000000",this.isFillTransparent=O.isFillTransparent||!1,this.fillOpacity=O.fillOpacity||1,this.font=O.font||"10px sans-serif",this.textBaseline=O.textBaseline||"alphabetic",this.textAlign=O.textAlign||"left",this.lineWidth=O.lineWidth||1,this.lineJoin=O.lineJoin||"miter",this.lineCap=O.lineCap||"butt",this.path=O.path||[],this.transform=O.transform!==void 0?O.transform.clone():new c,this.globalCompositeOperation=O.globalCompositeOperation||"normal",this.globalAlpha=O.globalAlpha||1,this.clip_path=O.clip_path||[],this.currentPoint=O.currentPoint||new o,this.miterLimit=O.miterLimit||10,this.lastPoint=O.lastPoint||new o,this.lineDashOffset=O.lineDashOffset||0,this.lineDash=O.lineDash||[],this.margin=O.margin||[0,0,0,0],this.prevPageLastElemOffset=O.prevPageLastElemOffset||0,this.ignoreClearRect=typeof O.ignoreClearRect!="boolean"||O.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new f(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,d=new u}]);var f=function(O){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var R=O;Object.defineProperty(this,"pdf",{get:function(){return R}});var G=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return G},set:function(Z){G=!!Z}});var M=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return M},set:function(Z){M=!!Z}});var K=0;Object.defineProperty(this,"posX",{get:function(){return K},set:function(Z){isNaN(Z)||(K=Z)}});var Y=0;Object.defineProperty(this,"posY",{get:function(){return Y},set:function(Z){isNaN(Z)||(Y=Z)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(Z){var ke;typeof Z=="number"?ke=[Z,Z,Z,Z]:((ke=new Array(4))[0]=Z[0],ke[1]=Z.length>=2?Z[1]:ke[0],ke[2]=Z.length>=3?Z[2]:ke[0],ke[3]=Z.length>=4?Z[3]:ke[1]),d.margin=ke}});var D=!1;Object.defineProperty(this,"autoPaging",{get:function(){return D},set:function(Z){D=Z}});var V=0;Object.defineProperty(this,"lastBreak",{get:function(){return V},set:function(Z){V=Z}});var te=[];Object.defineProperty(this,"pageBreaks",{get:function(){return te},set:function(Z){te=Z}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(Z){Z instanceof u&&(d=Z)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(Z){d.path=Z}});var ve=[];Object.defineProperty(this,"ctxStack",{get:function(){return ve},set:function(Z){ve=Z}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Z){var ke;ke=A(Z),this.ctx.fillStyle=ke.style,this.ctx.isFillTransparent=ke.a===0,this.ctx.fillOpacity=ke.a,this.pdf.setFillColor(ke.r,ke.g,ke.b,{a:ke.a}),this.pdf.setTextColor(ke.r,ke.g,ke.b,{a:ke.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Z){var ke=A(Z);this.ctx.strokeStyle=ke.style,this.ctx.isStrokeTransparent=ke.a===0,this.ctx.strokeOpacity=ke.a,ke.a===0?this.pdf.setDrawColor(255,255,255):(ke.a,this.pdf.setDrawColor(ke.r,ke.g,ke.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Z){["butt","round","square"].indexOf(Z)!==-1&&(this.ctx.lineCap=Z,this.pdf.setLineCap(Z))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Z){isNaN(Z)||(this.ctx.lineWidth=Z,this.pdf.setLineWidth(Z))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Z){["bevel","round","miter"].indexOf(Z)!==-1&&(this.ctx.lineJoin=Z,this.pdf.setLineJoin(Z))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Z){isNaN(Z)||(this.ctx.miterLimit=Z,this.pdf.setMiterLimit(Z))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Z){this.ctx.textBaseline=Z}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Z){["right","end","center","left","start"].indexOf(Z)!==-1&&(this.ctx.textAlign=Z)}});var Q=null,Xe=null,se=null;Object.defineProperty(this,"fontFaces",{get:function(){return se},set:function(Z){Q=null,Xe=null,se=Z}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Z){var ke;if(this.ctx.font=Z,(ke=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(Z))!==null){var Se=ke[1];ke[2];var Ee=ke[3],Ze=ke[4];ke[5];var ot=ke[6],vt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ze)[2];Ze=Math.floor(vt==="px"?parseFloat(Ze)*this.pdf.internal.scaleFactor:vt==="em"?parseFloat(Ze)*this.pdf.getFontSize():parseFloat(Ze)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ze);var _t=function(Fe){var je,We,ee=[],Ve=Fe.trim();if(Ve==="")return N5;if(Ve in UV)return[UV[Ve]];for(;Ve!=="";){switch(We=null,je=(Ve=VV(Ve)).charAt(0)){case'"':case"'":We=hPe(Ve.substring(1),je);break;default:We=APe(Ve)}if(We===null||(ee.push(We[0]),(Ve=VV(We[1]))!==""&&Ve.charAt(0)!==","))return N5;Ve=Ve.replace(/^,/,"")}return ee}(ot);if(this.fontFaces){var Tt=function(Fe,je){var We=Fe.getFontList(),ee=JSON.stringify(We);if(Q===null||Xe!==ee){var Ve=function(rt){var $e=[];return Object.keys(rt).forEach(function(ie){rt[ie].forEach(function(pe){var fe=null;switch(pe){case"bold":fe={family:ie,weight:"bold"};break;case"italic":fe={family:ie,style:"italic"};break;case"bolditalic":fe={family:ie,weight:"bold",style:"italic"};break;case"":case"normal":fe={family:ie}}fe!==null&&(fe.ref={name:ie,style:pe},$e.push(fe))})}),$e}(We);Q=function(rt){for(var $e={},ie=0;ie<rt.length;++ie){var pe=w5(rt[ie]),fe=pe.family,Me=pe.stretch,me=pe.style,ye=pe.weight;$e[fe]=$e[fe]||{},$e[fe][Me]=$e[fe][Me]||{},$e[fe][Me][me]=$e[fe][Me][me]||{},$e[fe][Me][me][ye]=pe}return $e}(Ve.concat(je)),Xe=ee}return Q}(this.pdf,this.fontFaces),Lt=_t.map(function(Fe){return{family:Fe,stretch:"normal",weight:Ee,style:Se}}),Rt=function(Fe,je,We){for(var ee=(We=We||{}).defaultFontFamily||"times",Ve=Object.assign({},fPe,We.genericFontFamilies||{}),rt=null,$e=null,ie=0;ie<je.length;++ie)if(Ve[(rt=w5(je[ie])).family]&&(rt.family=Ve[rt.family]),Fe.hasOwnProperty(rt.family)){$e=Fe[rt.family];break}if(!($e=$e||Fe[ee]))throw new Error("Could not find a font-family for the rule '"+QV(rt)+"' and default family '"+ee+"'.");if($e=function(pe,fe){if(fe[pe])return fe[pe];var Me=Zk[pe],me=Me<=Zk.normal?-1:1,ye=LV(fe,Wre,Me,me);if(!ye)throw new Error("Could not find a matching font-stretch value for "+pe);return ye}(rt.stretch,$e),$e=function(pe,fe){if(fe[pe])return fe[pe];for(var Me=zre[pe],me=0;me<Me.length;++me)if(fe[Me[me]])return fe[Me[me]];throw new Error("Could not find a matching font-style for "+pe)}(rt.style,$e),!($e=function(pe,fe){if(fe[pe])return fe[pe];if(pe===400&&fe[500])return fe[500];if(pe===500&&fe[400])return fe[400];var Me=uPe[pe],me=LV(fe,Xre,Me,pe<400?-1:1);if(!me)throw new Error("Could not find a matching font-weight for value "+pe);return me}(rt.weight,$e)))throw new Error("Failed to resolve a font for the rule '"+QV(rt)+"'.");return $e}(Tt,Lt);this.pdf.setFont(Rt.ref.name,Rt.ref.style)}else{var Et="";(Ee==="bold"||parseInt(Ee,10)>=700||Se==="bold")&&(Et="bold"),Se==="italic"&&(Et+="italic"),Et.length===0&&(Et="normal");for(var Re="",Te={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ye=0;Ye<_t.length;Ye++){if(this.pdf.internal.getFont(_t[Ye],Et,{noFallback:!0,disableWarning:!0})!==void 0){Re=_t[Ye];break}if(Et==="bolditalic"&&this.pdf.internal.getFont(_t[Ye],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Re=_t[Ye],Et="bold";else if(this.pdf.internal.getFont(_t[Ye],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Re=_t[Ye],Et="normal";break}}if(Re===""){for(var dt=0;dt<_t.length;dt++)if(Te[_t[dt]]){Re=Te[_t[dt]];break}}Re=Re===""?"Times":Re,this.pdf.setFont(Re,Et)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Z){this.ctx.globalCompositeOperation=Z}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Z){this.ctx.globalAlpha=Z}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Z){this.ctx.lineDashOffset=Z,De.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Z){this.ctx.lineDash=Z,De.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Z){this.ctx.ignoreClearRect=!!Z}})};f.prototype.setLineDash=function(O){this.lineDash=O},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){w.call(this,"fill",!1)},f.prototype.stroke=function(){w.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(O,R){if(isNaN(O)||isNaN(R))throw Is.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var G=this.ctx.transform.applyToPoint(new o(O,R));this.path.push({type:"mt",x:G.x,y:G.y}),this.ctx.lastPoint=new o(O,R)},f.prototype.closePath=function(){var O=new o(0,0),R=0;for(R=this.path.length-1;R!==-1;R--)if(this.path[R].type==="begin"&&ms(this.path[R+1])==="object"&&typeof this.path[R+1].x=="number"){O=new o(this.path[R+1].x,this.path[R+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(O.x,O.y)},f.prototype.lineTo=function(O,R){if(isNaN(O)||isNaN(R))throw Is.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var G=this.ctx.transform.applyToPoint(new o(O,R));this.path.push({type:"lt",x:G.x,y:G.y}),this.ctx.lastPoint=new o(G.x,G.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),w.call(this,null,!0)},f.prototype.quadraticCurveTo=function(O,R,G,M){if(isNaN(G)||isNaN(M)||isNaN(O)||isNaN(R))throw Is.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var K=this.ctx.transform.applyToPoint(new o(G,M)),Y=this.ctx.transform.applyToPoint(new o(O,R));this.path.push({type:"qct",x1:Y.x,y1:Y.y,x:K.x,y:K.y}),this.ctx.lastPoint=new o(K.x,K.y)},f.prototype.bezierCurveTo=function(O,R,G,M,K,Y){if(isNaN(K)||isNaN(Y)||isNaN(O)||isNaN(R)||isNaN(G)||isNaN(M))throw Is.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var D=this.ctx.transform.applyToPoint(new o(K,Y)),V=this.ctx.transform.applyToPoint(new o(O,R)),te=this.ctx.transform.applyToPoint(new o(G,M));this.path.push({type:"bct",x1:V.x,y1:V.y,x2:te.x,y2:te.y,x:D.x,y:D.y}),this.ctx.lastPoint=new o(D.x,D.y)},f.prototype.arc=function(O,R,G,M,K,Y){if(isNaN(O)||isNaN(R)||isNaN(G)||isNaN(M)||isNaN(K))throw Is.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Y=!!Y,!this.ctx.transform.isIdentity){var D=this.ctx.transform.applyToPoint(new o(O,R));O=D.x,R=D.y;var V=this.ctx.transform.applyToPoint(new o(0,G)),te=this.ctx.transform.applyToPoint(new o(0,0));G=Math.sqrt(Math.pow(V.x-te.x,2)+Math.pow(V.y-te.y,2))}Math.abs(K-M)>=2*Math.PI&&(M=0,K=2*Math.PI),this.path.push({type:"arc",x:O,y:R,radius:G,startAngle:M,endAngle:K,counterclockwise:Y})},f.prototype.arcTo=function(O,R,G,M,K){throw new Error("arcTo not implemented.")},f.prototype.rect=function(O,R,G,M){if(isNaN(O)||isNaN(R)||isNaN(G)||isNaN(M))throw Is.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(O,R),this.lineTo(O+G,R),this.lineTo(O+G,R+M),this.lineTo(O,R+M),this.lineTo(O,R),this.lineTo(O+G,R),this.lineTo(O,R)},f.prototype.fillRect=function(O,R,G,M){if(isNaN(O)||isNaN(R)||isNaN(G)||isNaN(M))throw Is.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var K={};this.lineCap!=="butt"&&(K.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(K.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(O,R,G,M),this.fill(),K.hasOwnProperty("lineCap")&&(this.lineCap=K.lineCap),K.hasOwnProperty("lineJoin")&&(this.lineJoin=K.lineJoin)}},f.prototype.strokeRect=function(O,R,G,M){if(isNaN(O)||isNaN(R)||isNaN(G)||isNaN(M))throw Is.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(O,R,G,M),this.stroke())},f.prototype.clearRect=function(O,R,G,M){if(isNaN(O)||isNaN(R)||isNaN(G)||isNaN(M))throw Is.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(O,R,G,M))},f.prototype.save=function(O){O=typeof O!="boolean"||O;for(var R=this.pdf.internal.getCurrentPageInfo().pageNumber,G=0;G<this.pdf.internal.getNumberOfPages();G++)this.pdf.setPage(G+1),this.pdf.internal.out("q");if(this.pdf.setPage(R),O){this.ctx.fontSize=this.pdf.internal.getFontSize();var M=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=M}},f.prototype.restore=function(O){O=typeof O!="boolean"||O;for(var R=this.pdf.internal.getCurrentPageInfo().pageNumber,G=0;G<this.pdf.internal.getNumberOfPages();G++)this.pdf.setPage(G+1),this.pdf.internal.out("Q");this.pdf.setPage(R),O&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var A=function(O){var R,G,M,K;if(O.isCanvasGradient===!0&&(O=O.getColor()),!O)return{r:0,g:0,b:0,a:0,style:O};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(O))R=0,G=0,M=0,K=0;else{var Y=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(O);if(Y!==null)R=parseInt(Y[1]),G=parseInt(Y[2]),M=parseInt(Y[3]),K=1;else if((Y=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(O))!==null)R=parseInt(Y[1]),G=parseInt(Y[2]),M=parseInt(Y[3]),K=parseFloat(Y[4]);else{if(K=1,typeof O=="string"&&O.charAt(0)!=="#"){var D=new Qre(O);O=D.ok?D.toHex():"#000000"}O.length===4?(R=O.substring(1,2),R+=R,G=O.substring(2,3),G+=G,M=O.substring(3,4),M+=M):(R=O.substring(1,3),G=O.substring(3,5),M=O.substring(5,7)),R=parseInt(R,16),G=parseInt(G,16),M=parseInt(M,16)}}return{r:R,g:G,b:M,a:K,style:O}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(O,R,G,M){if(isNaN(R)||isNaN(G)||typeof O!="string")throw Is.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(M=isNaN(M)?void 0:M,!h.call(this)){var K=he(this.ctx.transform.rotation),Y=this.ctx.transform.scaleX;T.call(this,{text:O,x:R,y:G,scale:Y,angle:K,align:this.textAlign,maxWidth:M})}},f.prototype.strokeText=function(O,R,G,M){if(isNaN(R)||isNaN(G)||typeof O!="string")throw Is.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){M=isNaN(M)?void 0:M;var K=he(this.ctx.transform.rotation),Y=this.ctx.transform.scaleX;T.call(this,{text:O,x:R,y:G,scale:Y,renderingMode:"stroke",angle:K,align:this.textAlign,maxWidth:M})}},f.prototype.measureText=function(O){if(typeof O!="string")throw Is.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var R=this.pdf,G=this.pdf.internal.scaleFactor,M=R.internal.getFontSize(),K=R.getStringUnitWidth(O)*M/R.internal.scaleFactor;return new function(Y){var D=(Y=Y||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return D}}),this}({width:K*=Math.round(96*G/72*1e4)/1e4})},f.prototype.scale=function(O,R){if(isNaN(O)||isNaN(R))throw Is.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var G=new c(O,0,0,R,0,0);this.ctx.transform=this.ctx.transform.multiply(G)},f.prototype.rotate=function(O){if(isNaN(O))throw Is.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var R=new c(Math.cos(O),Math.sin(O),-Math.sin(O),Math.cos(O),0,0);this.ctx.transform=this.ctx.transform.multiply(R)},f.prototype.translate=function(O,R){if(isNaN(O)||isNaN(R))throw Is.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var G=new c(1,0,0,1,O,R);this.ctx.transform=this.ctx.transform.multiply(G)},f.prototype.transform=function(O,R,G,M,K,Y){if(isNaN(O)||isNaN(R)||isNaN(G)||isNaN(M)||isNaN(K)||isNaN(Y))throw Is.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var D=new c(O,R,G,M,K,Y);this.ctx.transform=this.ctx.transform.multiply(D)},f.prototype.setTransform=function(O,R,G,M,K,Y){O=isNaN(O)?1:O,R=isNaN(R)?0:R,G=isNaN(G)?0:G,M=isNaN(M)?1:M,K=isNaN(K)?0:K,Y=isNaN(Y)?0:Y,this.ctx.transform=new c(O,R,G,M,K,Y)};var p=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(O,R,G,M,K,Y,D,V,te){var ve=this.pdf.getImageProperties(O),Q=1,Xe=1,se=1,Z=1;M!==void 0&&V!==void 0&&(se=V/M,Z=te/K,Q=ve.width/M*V/M,Xe=ve.height/K*te/K),Y===void 0&&(Y=R,D=G,R=0,G=0),M!==void 0&&V===void 0&&(V=M,te=K),M===void 0&&V===void 0&&(V=ve.width,te=ve.height);var ke=this.ctx.transform.decompose(),Se=he(ke.rotate.shx),Ee=new c,Ze=(Ee=(Ee=(Ee=Ee.multiply(ke.translate)).multiply(ke.skew)).multiply(ke.scale)).applyToRectangle(new l(Y-R*se,D-G*Z,M*Q,K*Xe));if(this.autoPaging){for(var ot,vt=x.call(this,Ze),_t=[],Tt=0;Tt<vt.length;Tt+=1)_t.indexOf(vt[Tt])===-1&&_t.push(vt[Tt]);b(_t);for(var Lt=_t[0],Rt=_t[_t.length-1],Et=Lt;Et<Rt+1;Et++){this.pdf.setPage(Et);var Re=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Te=Et===1?this.posY+this.margin[0]:this.margin[0],Ye=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],dt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Fe=Et===1?0:Ye+(Et-2)*dt;if(this.ctx.clip_path.length!==0){var je=this.path;ot=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(ot,this.posX+this.margin[3],-Fe+Te+this.ctx.prevPageLastElemOffset),I.call(this,"fill",!0),this.path=je}var We=JSON.parse(JSON.stringify(Ze));We=y([We],this.posX+this.margin[3],-Fe+Te+this.ctx.prevPageLastElemOffset)[0];var ee=(Et>Lt||Et<Rt)&&p.call(this);ee&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Re,dt,null).clip().discardPath()),this.pdf.addImage(O,"JPEG",We.x,We.y,We.w,We.h,null,null,Se),ee&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(O,"JPEG",Ze.x,Ze.y,Ze.w,Ze.h,null,null,Se)};var x=function(O,R,G){var M=[];R=R||this.pdf.internal.pageSize.width,G=G||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var K=this.posY+this.ctx.prevPageLastElemOffset;switch(O.type){default:case"mt":case"lt":M.push(Math.floor((O.y+K)/G)+1);break;case"arc":M.push(Math.floor((O.y+K-O.radius)/G)+1),M.push(Math.floor((O.y+K+O.radius)/G)+1);break;case"qct":var Y=ae(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x,O.y);M.push(Math.floor((Y.y+K)/G)+1),M.push(Math.floor((Y.y+Y.h+K)/G)+1);break;case"bct":var D=Ce(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x2,O.y2,O.x,O.y);M.push(Math.floor((D.y+K)/G)+1),M.push(Math.floor((D.y+D.h+K)/G)+1);break;case"rect":M.push(Math.floor((O.y+K)/G)+1),M.push(Math.floor((O.y+O.h+K)/G)+1)}for(var V=0;V<M.length;V+=1)for(;this.pdf.internal.getNumberOfPages()<M[V];)v.call(this);return M},v=function(){var O=this.fillStyle,R=this.strokeStyle,G=this.font,M=this.lineCap,K=this.lineWidth,Y=this.lineJoin;this.pdf.addPage(),this.fillStyle=O,this.strokeStyle=R,this.font=G,this.lineCap=M,this.lineWidth=K,this.lineJoin=Y},y=function(O,R,G){for(var M=0;M<O.length;M++)switch(O[M].type){case"bct":O[M].x2+=R,O[M].y2+=G;case"qct":O[M].x1+=R,O[M].y1+=G;default:O[M].x+=R,O[M].y+=G}return O},b=function(O){return O.sort(function(R,G){return R-G})},w=function(O,R){var G=this.fillStyle,M=this.strokeStyle,K=this.lineCap,Y=this.lineWidth,D=Math.abs(Y*this.ctx.transform.scaleX),V=this.lineJoin;if(this.autoPaging){for(var te,ve,Q=JSON.parse(JSON.stringify(this.path)),Xe=JSON.parse(JSON.stringify(this.path)),se=[],Z=0;Z<Xe.length;Z++)if(Xe[Z].x!==void 0)for(var ke=x.call(this,Xe[Z]),Se=0;Se<ke.length;Se+=1)se.indexOf(ke[Se])===-1&&se.push(ke[Se]);for(var Ee=0;Ee<se.length;Ee++)for(;this.pdf.internal.getNumberOfPages()<se[Ee];)v.call(this);b(se);for(var Ze=se[0],ot=se[se.length-1],vt=Ze;vt<ot+1;vt++){this.pdf.setPage(vt),this.fillStyle=G,this.strokeStyle=M,this.lineCap=K,this.lineWidth=D,this.lineJoin=V;var _t=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Tt=vt===1?this.posY+this.margin[0]:this.margin[0],Lt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Rt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Et=vt===1?0:Lt+(vt-2)*Rt;if(this.ctx.clip_path.length!==0){var Re=this.path;te=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(te,this.posX+this.margin[3],-Et+Tt+this.ctx.prevPageLastElemOffset),I.call(this,O,!0),this.path=Re}if(ve=JSON.parse(JSON.stringify(Q)),this.path=y(ve,this.posX+this.margin[3],-Et+Tt+this.ctx.prevPageLastElemOffset),R===!1||vt===0){var Te=(vt>Ze||vt<ot)&&p.call(this);Te&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],_t,Rt,null).clip().discardPath()),I.call(this,O,R),Te&&this.pdf.restoreGraphicsState()}this.lineWidth=Y}this.path=Q}else this.lineWidth=D,I.call(this,O,R),this.lineWidth=Y},I=function(O,R){if((O!=="stroke"||R||!m.call(this))&&(O==="stroke"||R||!h.call(this))){for(var G,M,K=[],Y=this.path,D=0;D<Y.length;D++){var V=Y[D];switch(V.type){case"begin":K.push({begin:!0});break;case"close":K.push({close:!0});break;case"mt":K.push({start:V,deltas:[],abs:[]});break;case"lt":var te=K.length;if(Y[D-1]&&!isNaN(Y[D-1].x)&&(G=[V.x-Y[D-1].x,V.y-Y[D-1].y],te>0)){for(;te>=0;te--)if(K[te-1].close!==!0&&K[te-1].begin!==!0){K[te-1].deltas.push(G),K[te-1].abs.push(V);break}}break;case"bct":G=[V.x1-Y[D-1].x,V.y1-Y[D-1].y,V.x2-Y[D-1].x,V.y2-Y[D-1].y,V.x-Y[D-1].x,V.y-Y[D-1].y],K[K.length-1].deltas.push(G);break;case"qct":var ve=Y[D-1].x+2/3*(V.x1-Y[D-1].x),Q=Y[D-1].y+2/3*(V.y1-Y[D-1].y),Xe=V.x+2/3*(V.x1-V.x),se=V.y+2/3*(V.y1-V.y),Z=V.x,ke=V.y;G=[ve-Y[D-1].x,Q-Y[D-1].y,Xe-Y[D-1].x,se-Y[D-1].y,Z-Y[D-1].x,ke-Y[D-1].y],K[K.length-1].deltas.push(G);break;case"arc":K.push({deltas:[],abs:[],arc:!0}),Array.isArray(K[K.length-1].abs)&&K[K.length-1].abs.push(V)}}M=R?null:O==="stroke"?"stroke":"fill";for(var Se=!1,Ee=0;Ee<K.length;Ee++)if(K[Ee].arc)for(var Ze=K[Ee].abs,ot=0;ot<Ze.length;ot++){var vt=Ze[ot];vt.type==="arc"?S.call(this,vt.x,vt.y,vt.radius,vt.startAngle,vt.endAngle,vt.counterclockwise,void 0,R,!Se):P.call(this,vt.x,vt.y),Se=!0}else if(K[Ee].close===!0)this.pdf.internal.out("h"),Se=!1;else if(K[Ee].begin!==!0){var _t=K[Ee].start.x,Tt=K[Ee].start.y;q.call(this,K[Ee].deltas,_t,Tt),Se=!0}M&&E.call(this,M),R&&B.call(this)}},j=function(O){var R=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,G=R*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return O-G;case"top":return O+R-G;case"hanging":return O+R-2*G;case"middle":return O+R/2-G;default:return O}},N=function(O){return O+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var O=function(){};return O.colorStops=[],O.addColorStop=function(R,G){this.colorStops.push([R,G])},O.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},O.isCanvasGradient=!0,O},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var S=function(O,R,G,M,K,Y,D,V,te){for(var ve=ce.call(this,G,M,K,Y),Q=0;Q<ve.length;Q++){var Xe=ve[Q];Q===0&&(te?k.call(this,Xe.x1+O,Xe.y1+R):P.call(this,Xe.x1+O,Xe.y1+R)),de.call(this,O,R,Xe.x2,Xe.y2,Xe.x3,Xe.y3,Xe.x4,Xe.y4)}V?B.call(this):E.call(this,D)},E=function(O){switch(O){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},B=function(){this.pdf.clip(),this.pdf.discardPath()},k=function(O,R){this.pdf.internal.out(r(O)+" "+n(R)+" m")},T=function(O){var R;switch(O.align){case"right":case"end":R="right";break;case"center":R="center";break;default:R="left"}var G,M,K,Y=this.pdf.getTextDimensions(O.text),D=j.call(this,O.y),V=N.call(this,D)-Y.h,te=this.ctx.transform.applyToPoint(new o(O.x,D));if(this.autoPaging){var ve=this.ctx.transform.decompose(),Q=new c;Q=(Q=(Q=Q.multiply(ve.translate)).multiply(ve.skew)).multiply(ve.scale);for(var Xe=this.ctx.transform.applyToRectangle(new l(O.x,D,Y.w,Y.h)),se=Q.applyToRectangle(new l(O.x,V,Y.w,Y.h)),Z=x.call(this,se),ke=[],Se=0;Se<Z.length;Se+=1)ke.indexOf(Z[Se])===-1&&ke.push(Z[Se]);b(ke);for(var Ee=ke[0],Ze=ke[ke.length-1],ot=Ee;ot<Ze+1;ot++){this.pdf.setPage(ot);var vt=ot===1?this.posY+this.margin[0]:this.margin[0],_t=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Tt=this.pdf.internal.pageSize.height-this.margin[2],Lt=Tt-this.margin[0],Rt=this.pdf.internal.pageSize.width-this.margin[1],Et=Rt-this.margin[3],Re=ot===1?0:_t+(ot-2)*Lt;if(this.ctx.clip_path.length!==0){var Te=this.path;G=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(G,this.posX+this.margin[3],-1*Re+vt),I.call(this,"fill",!0),this.path=Te}var Ye=y([JSON.parse(JSON.stringify(se))],this.posX+this.margin[3],-Re+vt+this.ctx.prevPageLastElemOffset)[0];O.scale>=.01&&(M=this.pdf.internal.getFontSize(),this.pdf.setFontSize(M*O.scale),K=this.lineWidth,this.lineWidth=K*O.scale);var dt=this.autoPaging!=="text";if(dt||Ye.y+Ye.h<=Tt){if(dt||Ye.y>=vt&&Ye.x<=Rt){var Fe=dt?O.text:this.pdf.splitTextToSize(O.text,O.maxWidth||Rt-Ye.x)[0],je=y([JSON.parse(JSON.stringify(Xe))],this.posX+this.margin[3],-Re+vt+this.ctx.prevPageLastElemOffset)[0],We=dt&&(ot>Ee||ot<Ze)&&p.call(this);We&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Et,Lt,null).clip().discardPath()),this.pdf.text(Fe,je.x,je.y,{angle:O.angle,align:R,renderingMode:O.renderingMode}),We&&this.pdf.restoreGraphicsState()}}else Ye.y<Tt&&(this.ctx.prevPageLastElemOffset+=Tt-Ye.y);O.scale>=.01&&(this.pdf.setFontSize(M),this.lineWidth=K)}}else O.scale>=.01&&(M=this.pdf.internal.getFontSize(),this.pdf.setFontSize(M*O.scale),K=this.lineWidth,this.lineWidth=K*O.scale),this.pdf.text(O.text,te.x+this.posX,te.y+this.posY,{angle:O.angle,align:R,renderingMode:O.renderingMode,maxWidth:O.maxWidth}),O.scale>=.01&&(this.pdf.setFontSize(M),this.lineWidth=K)},P=function(O,R,G,M){G=G||0,M=M||0,this.pdf.internal.out(r(O+G)+" "+n(R+M)+" l")},q=function(O,R,G){return this.pdf.lines(O,R,G,null,null)},de=function(O,R,G,M,K,Y,D,V){this.pdf.internal.out([e(a(G+O)),e(s(M+R)),e(a(K+O)),e(s(Y+R)),e(a(D+O)),e(s(V+R)),"c"].join(" "))},ce=function(O,R,G,M){for(var K=2*Math.PI,Y=Math.PI/2;R>G;)R-=K;var D=Math.abs(G-R);D<K&&M&&(D=K-D);for(var V=[],te=M?-1:1,ve=R;D>1e-5;){var Q=ve+te*Math.min(D,Y);V.push(le.call(this,O,ve,Q)),D-=Math.abs(Q-ve),ve=Q}return V},le=function(O,R,G){var M=(G-R)/2,K=O*Math.cos(M),Y=O*Math.sin(M),D=K,V=-Y,te=D*D+V*V,ve=te+D*K+V*Y,Q=4/3*(Math.sqrt(2*te*ve)-ve)/(D*Y-V*K),Xe=D-Q*V,se=V+Q*D,Z=Xe,ke=-se,Se=M+R,Ee=Math.cos(Se),Ze=Math.sin(Se);return{x1:O*Math.cos(R),y1:O*Math.sin(R),x2:Xe*Ee-se*Ze,y2:Xe*Ze+se*Ee,x3:Z*Ee-ke*Ze,y3:Z*Ze+ke*Ee,x4:O*Math.cos(G),y4:O*Math.sin(G)}},he=function(O){return 180*O/Math.PI},ae=function(O,R,G,M,K,Y){var D=O+.5*(G-O),V=R+.5*(M-R),te=K+.5*(G-K),ve=Y+.5*(M-Y),Q=Math.min(O,K,D,te),Xe=Math.max(O,K,D,te),se=Math.min(R,Y,V,ve),Z=Math.max(R,Y,V,ve);return new l(Q,se,Xe-Q,Z-se)},Ce=function(O,R,G,M,K,Y,D,V){var te,ve,Q,Xe,se,Z,ke,Se,Ee,Ze,ot,vt,_t,Tt,Lt=G-O,Rt=M-R,Et=K-G,Re=Y-M,Te=D-K,Ye=V-Y;for(ve=0;ve<41;ve++)Ee=(ke=(Q=O+(te=ve/40)*Lt)+te*((se=G+te*Et)-Q))+te*(se+te*(K+te*Te-se)-ke),Ze=(Se=(Xe=R+te*Rt)+te*((Z=M+te*Re)-Xe))+te*(Z+te*(Y+te*Ye-Z)-Se),ve==0?(ot=Ee,vt=Ze,_t=Ee,Tt=Ze):(ot=Math.min(ot,Ee),vt=Math.min(vt,Ze),_t=Math.max(_t,Ee),Tt=Math.max(Tt,Ze));return new l(Math.round(ot),Math.round(vt),Math.round(_t-ot),Math.round(Tt-vt))},De=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var O,R,G=(O=this.ctx.lineDash,R=this.ctx.lineDashOffset,JSON.stringify({lineDash:O,lineDashOffset:R}));this.prevLineDash!==G&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=G)}}})(An.API),function(t){var e=function(o){var l,c,d,u,f,A,h,m,p,x;for(c=[],d=0,u=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;u>d;d+=4)(f=(o.charCodeAt(d)<<24)+(o.charCodeAt(d+1)<<16)+(o.charCodeAt(d+2)<<8)+o.charCodeAt(d+3))!==0?(A=(f=((f=((f=((f=(f-(x=f%85))/85)-(p=f%85))/85)-(m=f%85))/85)-(h=f%85))/85)%85,c.push(A+33,h+33,m+33,p+33,x+33)):c.push(122);return function(v,y){for(var b=y;b>0;b--)v.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,d,u,f,A=String,h="length",m=255,p="charCodeAt",x="slice",v="replace";for(o[x](-2),o=o[x](0,-2)[v](/\s/g,"")[v]("z","!!!!!"),d=[],u=0,f=(o+=l="uuuuu"[x](o[h]%5||5))[h];f>u;u+=5)c=52200625*(o[p](u)-33)+614125*(o[p](u+1)-33)+7225*(o[p](u+2)-33)+85*(o[p](u+3)-33)+(o[p](u+4)-33),d.push(m&c>>24,m&c>>16,m&c>>8,m&c);return function(y,b){for(var w=b;w>0;w--)y.pop()}(d,l[h]),A.fromCharCode.apply(A,d)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",d=0;d<o.length;d+=2)c+=String.fromCharCode("0x"+(o[d]+o[d+1]));return c},s=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=Kk(l)).reduce(function(d,u){return d+String.fromCharCode(u)},"")};t.processDataByFilters=function(o,l){var c=0,d=o||"",u=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":d=r(d),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=e(d),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=a(d),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=n(d),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=s(d),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:d,reverseChain:u.reverse().join(" ")}}}(An.API),function(t){t.loadFile=function(e,r,n){return function(a,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,d,u){var f=new XMLHttpRequest,A=0,h=function(m){var p=m.length,x=[],v=String.fromCharCode;for(A=0;A<p;A+=1)x.push(v(255&m.charCodeAt(A)));return x.join("")};if(f.open("GET",c,!d),f.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(f.onload=function(){f.status===200?u(h(this.responseText)):u(void 0)}),f.send(null),d&&f.status===200)return h(f.responseText)}(a,s,o)}catch{}return l}(e,r,n)},t.loadImageFile=t.loadFile}(An.API),function(t){function e(){return(Yn.html2canvas?Promise.resolve(Yn.html2canvas):dA(()=>Promise.resolve().then(()=>eR),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Yn.DOMPurify?Promise.resolve(Yn.DOMPurify):dA(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=ms(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},a=function(l,c){var d=document.createElement(l);for(var u in c.className&&(d.className=c.className),c.innerHTML&&c.dompurify&&(d.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)d.style[u]=c.style[u];return d},s=function l(c,d){for(var u=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),f=c.firstChild;f;f=f.nextSibling)d!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||u.appendChild(l(f,d));return c.nodeType===1&&(c.nodeName==="CANVAS"?(u.width=c.width,u.height=c.height,u.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(u.value=c.value),u.addEventListener("load",function(){u.scrollTop=c.scrollTop,u.scrollLeft=c.scrollLeft},!0)),u},o=function l(c){var d=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),u=l.convert(Promise.resolve(),d);return(u=u.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(d){switch(n(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(d){return this.set({src:a("div",{innerHTML:l,dompurify:d})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,c(this.prop.container,d)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var d=this.opt.jsPDF,u=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,A=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete A.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=u,u)for(var h=0;h<u.length;++h){var m=u[h],p=m.src.find(function(x){return x.format==="truetype"});p&&d.addFont(p.url,m.ref.name,m.ref.style)}return A.windowHeight=A.windowHeight||0,A.windowHeight=A.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):A.windowHeight,d.context2d.save(!0),c(this.prop.container,A)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(d){if(d in o.template.prop)return function(){this.prop[d]=l[d]};switch(d){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[d]=l[d]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var d=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(d):d})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(d,u){return Math.floor(d*u/72*96)}return this.then(function(){(l=l||An.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,d,u){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),d!=null&&(this.progress.n=d),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,d,u){return this.setProgress(l?this.progress.val+l:null,c||null,d?this.progress.n+d:null,u?this.progress.stack.concat(u):null)},o.prototype.then=function(l,c){var d=this;return this.thenCore(l,c,function(u,f){return d.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(A){return d.updateProgress(null,u),A}).then(u,f).then(function(A){return d.updateProgress(1),A})})},o.prototype.thenCore=function(l,c,d){d=d||Promise.prototype.then;var u=this;l&&(l=l.bind(u)),c&&(c=c.bind(u));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:o.convert(Object.assign({},u),Promise.prototype),A=d.call(f,l,c);return o.convert(A,u.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(d){c=c.thenCore(d)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,An.getPageSize=function(l,c,d){if(ms(l)==="object"){var u=l;l=u.orientation,c=u.unit||c,d=u.format||d}c=c||"mm",d=d||"a4",l=(""+(l||"P")).toLowerCase();var f,A=(""+d).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+c}var m,p=0,x=0;if(h.hasOwnProperty(A))p=h[A][1]/f,x=h[A][0]/f;else try{p=d[1],x=d[0]}catch{throw new Error("Invalid format: "+d)}if(l==="p"||l==="portrait")l="p",x>p&&(m=x,x=p,p=m);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",p>x&&(m=x,x=p,p=m)}return{width:x,height:p,unit:c,k:f,orientation:l}},t.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(w5):null;var d=new o(c);return c.worker?d:d.from(l).doCallback()}}(An.API),An.API.addJS=function(t){return $V=t,this.internal.events.subscribe("postPutResources",function(){QC=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(QC+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),HV=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+$V+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){QC!==void 0&&HV!==void 0&&this.internal.out("/Names <</JavaScript "+QC+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),s=0;s<a.length;s++){var o=a[s],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,u=[];for(s=0;s<d;s++){var f=r.internal.newObject();u.push(f);var A=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+A.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<u.length;s++)r.internal.write("(page_"+(s+1)+")"+u[s]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,s){var o={title:a,options:s,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var o=n.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var d=0;d<n.children.length;d++)this.renderItems(n.children[d])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var s=0;s<a.children.length;s++)n.count++,this.count_r(n,a.children[s]);return n.count}}])}(An.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,a,s,o,l){var c,d=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(f){for(var A,h=256*f.charCodeAt(4)+f.charCodeAt(5),m=f.length,p={width:0,height:0,numcomponents:1},x=4;x<m;x+=2){if(x+=h,e.indexOf(f.charCodeAt(x+1))!==-1){A=256*f.charCodeAt(x+5)+f.charCodeAt(x+6),p={width:256*f.charCodeAt(x+7)+f.charCodeAt(x+8),height:A,numcomponents:f.charCodeAt(x+9)};break}h=256*f.charCodeAt(x+2)+f.charCodeAt(x+3)}return p}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}u={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:d,index:n,alias:a}}return u}}(An.API),An.API.processPNG=function(t,e,r,n){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var a,s=XIe(t,{checkCrc:!0}),o=s.width,l=s.height,c=s.channels,d=s.palette,u=s.depth;a=d&&c===1?function(S){for(var E=S.width,B=S.height,k=S.data,T=S.palette,P=S.depth,q=!1,de=[],ce=[],le=void 0,he=!1,ae=0,Ce=0;Ce<T.length;Ce++){var De=zQ(T[Ce],4),O=De[0],R=De[1],G=De[2],M=De[3];de.push(O,R,G),M!=null&&(M===0?(ae++,ce.length<1&&ce.push(Ce)):M<255&&(he=!0))}if(he||ae>1){q=!0,ce=void 0;var K=E*B;le=new Uint8Array(K);for(var Y=new DataView(k.buffer),D=0;D<K;D++){var V=C5(Y,D,P),te=zQ(T[V],4)[3];le[D]=te}}else ae===0&&(ce=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:q?8:void 0,colorBytes:k,alphaBytes:le,needSMask:q,palette:de,mask:ce}}(s):c===2||c===4?function(S){for(var E=S.data,B=S.width,k=S.height,T=S.channels,P=S.depth,q=T===2?"DeviceGray":"DeviceRGB",de=T-1,ce=B*k,le=de,he=ce*le,ae=1*ce,Ce=Math.ceil(he*P/8),De=Math.ceil(ae*P/8),O=new Uint8Array(Ce),R=new Uint8Array(De),G=new DataView(E.buffer),M=new DataView(O.buffer),K=new DataView(R.buffer),Y=!1,D=0;D<ce;D++){for(var V=D*T,te=0;te<le;te++)ZV(M,C5(G,V+te,P),D*le+te,P);var ve=C5(G,V+le,P);ve<(1<<P)-1&&(Y=!0),ZV(K,ve,1*D,P)}return{colorSpace:q,colorsPerPixel:de,sMaskBitsPerComponent:Y?P:void 0,colorBytes:O,alphaBytes:R,needSMask:Y}}(s):function(S){var E=S.data,B=S.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:B,colorsPerPixel:B==="DeviceGray"?1:3,colorBytes:E instanceof Uint16Array?function(k){for(var T=k.length,P=new Uint8Array(2*T),q=new DataView(P.buffer,P.byteOffset,P.byteLength),de=0;de<T;de++)q.setUint16(2*de,k[de],!1);return P}(E):E,needSMask:!1}}(s);var f,A,h,m=a,p=m.colorSpace,x=m.colorsPerPixel,v=m.sMaskBitsPerComponent,y=m.colorBytes,b=m.alphaBytes,w=m.needSMask,I=m.palette,j=m.mask,N=null;return n!==An.API.image_compression.NONE&&typeof Kk=="function"?(N=function(S){var E;switch(S){case An.API.image_compression.FAST:E=11;break;case An.API.image_compression.MEDIUM:E=13;break;case An.API.image_compression.SLOW:E=14;break;default:E=12}return E}(n),f=this.decode.FLATE_DECODE,A="/Predictor ".concat(N," /Colors ").concat(x," /BitsPerComponent ").concat(u," /Columns ").concat(o),t=zV(y,Math.ceil(o*x*u/8),x,u,n),w&&(h=zV(b,Math.ceil(o*v/8),1,v,n))):(f=void 0,A=void 0,t=y,w&&(h=b)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:r,data:t,index:e,filter:f,decodeParameters:A,transparency:j,palette:I,sMask:h,predictor:N,width:o,height:l,bitsPerComponent:u,sMaskBitsPerComponent:v,colorSpace:p}}},function(t){t.processGIF89A=function(e,r,n,a){var s=new xPe(e),o=s.width,l=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var d={data:c,width:o,height:l},u=new _5(100).encode(d,100);return t.processJPEG.call(this,u,r,n,a)},t.processGIF87A=t.processGIF89A}(An.API),ef.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:a,green:n,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},ef.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){Is.log("bit decode error:"+r)}},ef.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<e;a++)for(var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*a*4,l=0;l<8&&8*a+l<this.width;l++){var c=this.palette[s>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},ef.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<t;a++){var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*a*4,l=s>>4,c=15&s,d=this.palette[l];if(this.data[o]=d.blue,this.data[o+1]=d.green,this.data[o+2]=d.red,this.data[o+3]=255,2*a+1>=this.width)break;d=this.palette[c],this.data[o+4]=d.blue,this.data[o+4+1]=d.green,this.data[o+4+2]=d.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},ef.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*n;if(a<this.palette.length){var o=this.palette[a];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}t!==0&&(this.pos+=4-t)}},ef.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,l=(s>>5&e)/e*255|0,c=(s>>10&e)/e*255|0,d=s>>15?255:0,u=n*this.width*4+4*a;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=d}this.pos+=t}},ef.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&r)/r*255|0,d=(o>>11)/e*255|0,u=a*this.width*4+4*s;this.data[u]=d,this.data[u+1]=c,this.data[u+2]=l,this.data[u+3]=255}this.pos+=t}},ef.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=s,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},ef.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=s,this.data[l+1]=a,this.data[l+2]=n,this.data[l+3]=o}},ef.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,n,a){var s=new ef(e,!1),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},d=new _5(100).encode(c,100);return t.processJPEG.call(this,d,r,n,a)}}(An.API),tH.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,n,a){var s=new tH(e),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},d=new _5(100).encode(c,100);return t.processJPEG.call(this,d,r,n,a)}}(An.API),An.API.processRGBA=function(t,e,r){for(var n=t.data,a=n.length,s=new Uint8Array(a/4*3),o=new Uint8Array(a/4),l=0,c=0,d=0;d<a;d+=4){var u=n[d],f=n[d+1],A=n[d+2],h=n[d+3];s[l++]=u,s[l++]=f,s[l++]=A,o[c++]=h}var m=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:m,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},An.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},px=An.API,VC=px.getCharWidthsArray=function(t,e){var r,n,a=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:a.metadata.Unicode.widths,c=l.fof?l.fof:1,d=e.kerning?e.kerning:a.metadata.Unicode.kerning,u=d.fof?d.fof:1,f=e.doKerning!==!1,A=0,h=t.length,m=0,p=l[0]||c,x=[];for(r=0;r<h;r++)n=t.charCodeAt(r),typeof a.metadata.widthOfString=="function"?x.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+o*(1e3/s)||0)/1e3):(A=f&&ms(d[n])==="object"&&!isNaN(parseInt(d[n][m],10))?d[n][m]/u:0,x.push((l[n]||p)/c+A)),m=n;return x},GV=px.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),a=e.charSpace||this.internal.getCharSpace();return px.processArabic&&(t=px.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,a)/r:VC.apply(this,arguments).reduce(function(s,o){return s+o},0)},KV=function(t,e,r,n){for(var a=[],s=0,o=t.length,l=0;s!==o&&l+e[s]<r;)l+=e[s],s++;a.push(t.slice(0,s));var c=s;for(l=0;s!==o;)l+e[s]>n&&(a.push(t.slice(c,s)),l=0,c=s),l+=e[s],s++;return c!==s&&a.push(t.slice(c,s)),a},qV=function(t,e,r){r||(r={});var n,a,s,o,l,c,d,u=[],f=[u],A=r.textIndent||0,h=0,m=0,p=t.split(" "),x=VC.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?p[0].length+2:r.lineIndent||0){var v=Array(c).join(" "),y=[];p.map(function(w){(w=w.split(/\s*\n/)).length>1?y=y.concat(w.map(function(I,j){return(j&&I.length?`
`:"")+I})):y.push(w[0])}),p=y,c=GV.apply(this,[v,r])}for(s=0,o=p.length;s<o;s++){var b=0;if(n=p[s],c&&n[0]==`
`&&(n=n.substr(1),b=1),A+h+(m=(a=VC.apply(this,[n,r])).reduce(function(w,I){return w+I},0))>e||b){if(m>e){for(l=KV.apply(this,[n,a,e-(A+h),e]),u.push(l.shift()),u=[l.pop()];l.length;)f.push([l.shift()]);m=a.slice(n.length-(u[0]?u[0].length:0)).reduce(function(w,I){return w+I},0)}else u=[n];f.push(u),A=m+c,h=x}else u.push(n),A+=h+m,h=x}return d=c?function(w,I){return(I?v:"")+w.join(" ")}:function(w){return w.join(" ")},f.map(d)},px.splitTextToSize=function(t,e,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var f=this.internal.getFont(u.fontName,u.fontStyle),A="Unicode";return f.metadata[A]?{widths:f.metadata[A].widths||{0:1},kerning:f.metadata[A].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/a;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,s.lineIndent=r.lineIndent;var l,c,d=[];for(l=0,c=n.length;l<c;l++)d=d.concat(qV.apply(this,[n[l],o,s]));return d},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",n={},a={},s=0;s<16;s++)n[r[s]]=e[s],a[e[s]]=r[s];var o=function(A){return"0x"+parseInt(A,10).toString(16)},l=t.__fontmetrics__.compress=function(A){var h,m,p,x,v=["{"];for(var y in A){if(h=A[y],isNaN(parseInt(y,10))?m="'"+y+"'":(y=parseInt(y,10),m=(m=o(y).slice(2)).slice(0,-1)+a[m.slice(-1)]),typeof h=="number")h<0?(p=o(h).slice(3),x="-"):(p=o(h).slice(2),x=""),p=x+p.slice(0,-1)+a[p.slice(-1)];else{if(ms(h)!=="object")throw new Error("Don't know what to do with value type "+ms(h)+".");p=l(h)}v.push(m+p)}return v.push("}"),v.join("")},c=t.__fontmetrics__.uncompress=function(A){if(typeof A!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,m,p,x,v={},y=1,b=v,w=[],I="",j="",N=A.length-1,S=1;S<N;S+=1)(x=A[S])=="'"?h?(p=h.join(""),h=void 0):h=[]:h?h.push(x):x=="{"?(w.push([b,p]),b={},p=void 0):x=="}"?((m=w.pop())[0][m[1]]=b,p=void 0,b=m[0]):x=="-"?y=-1:p===void 0?n.hasOwnProperty(x)?(I+=n[x],p=parseInt(I,16)*y,y=1,I=""):I+=x:n.hasOwnProperty(x)?(j+=n[x],b[p]=parseInt(j,16)*y,y=1,p=void 0,j=""):j+=x;return v},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},f={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(A){var h=A.font,m=f.Unicode[h.postScriptName];m&&(h.metadata.Unicode={},h.metadata.Unicode.widths=m.widths,h.metadata.Unicode.kerning=m.kerning);var p=u.Unicode[h.postScriptName];p&&(h.metadata.Unicode.encoding=p,h.encoding=p.codePages[0])}])}(An.API),function(t){var e=function(r){for(var n=r.length,a=new Uint8Array(n),s=0;s<n;s++)a[s]=r.charCodeAt(s);return a};t.API.events.push(["addFont",function(r){var n=void 0,a=r.font,s=r.instance;if(!a.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=s.existsFileInVFS(a.postScriptName)===!1?s.loadFile(a.postScriptName):s.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(NE(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(a,n)}}])}(An),An.API.addSvgAsImage=function(t,e,r,n,a,s,o,l){if(isNaN(e)||isNaN(r))throw Is.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(a))throw Is.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=a;var d=c.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(Yn.canvg?Promise.resolve(Yn.canvg):dA(()=>import("./index.es-BW_29Rdi.js"),[])).catch(function(A){return Promise.reject(new Error("Could not load canvg: "+A))}).then(function(A){return A.default?A.default:A}).then(function(A){return A.fromString(d,t,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(A){return A.render(u)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),e,r,n,a,o,l)})},An.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(e,r);return this},An.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,a,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],d=0,u=0,f=0;function A(m,p){var x,v=!1;for(x=0;x<m.length;x+=1)m[x]===p&&(v=!0);return v}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var h=l.length;for(f=0;f<h;f+=1)r[l[f]].value=r[l[f]].defaultValue,r[l[f]].explicitSet=!1}if(ms(t)==="object"){for(a in t)if(s=t[a],A(l,a)&&s!==void 0){if(r[a].type==="boolean"&&typeof s=="boolean")r[a].value=s;else if(r[a].type==="name"&&A(r[a].valueSet,s))r[a].value=s;else if(r[a].type==="integer"&&Number.isInteger(s))r[a].value=s;else if(r[a].type==="array"){for(d=0;d<s.length;d+=1)if(n=!0,s[d].length===1&&typeof s[d][0]=="number")c.push(String(s[d]-1));else if(s[d].length>1){for(u=0;u<s[d].length;u+=1)typeof s[d][u]!="number"&&(n=!1);n===!0&&c.push([s[d][0]-1,s[d][1]-1].join(" "))}r[a].value="["+c.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,p=[];for(m in r)r[m].explicitSet===!0&&(r[m].type==="name"?p.push("/"+m+" /"+r[m].value):p.push("/"+m+" "+r[m].value));p.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+p.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),d=s.length+o.length+l.length+a.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(a+s+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(An.API),function(t){var e=t.API,r=e.pdfEscape16=function(s,o){for(var l,c=o.metadata.Unicode.widths,d=["","0","00","000","0000"],u=[""],f=0,A=s.length;f<A;++f){if(l=o.metadata.characterToGlyph(s.charCodeAt(f)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=s.charCodeAt(f),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return u.join("");l=l.toString(16),u.push(d[4-l.length],l)}return u.join("")},n=function(s){var o,l,c,d,u,f,A;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,A=(l=Object.keys(s).sort(function(h,m){return h-m})).length;f<A;f++)o=l[f],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(d=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+d+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,d=o.newObject,u=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var f=l.metadata.Unicode.widths,A=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),h="",m=0;m<A.length;m++)h+=String.fromCharCode(A[m]);var p=d();u({data:h,addLength1:!0,objectId:p}),c("endobj");var x=d();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:x}),c("endobj");var v=d();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Dx(l.fontName)),c("/FontFile2 "+p+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var y=d();c("<<"),c("/Type /Font"),c("/BaseFont /"+Dx(l.fontName)),c("/FontDescriptor "+v+" 0 R"),c("/W "+t.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=d(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+x+" 0 R"),c("/BaseFont /"+Dx(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+y+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,d=o.newObject,u=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var f=l.metadata.rawData,A="",h=0;h<f.length;h++)A+=String.fromCharCode(f[h]);var m=d();u({data:A,addLength1:!0,objectId:m}),c("endobj");var p=d();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:p}),c("endobj");var x=d();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+m+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Dx(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=d();for(var v=0;v<l.metadata.hmtx.widths.length;v++)l.metadata.hmtx.widths[v]=parseInt(l.metadata.hmtx.widths[v]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+p+" 0 R/BaseFont/"+Dx(l.fontName)+"/FontDescriptor "+x+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]);var a=function(s){var o,l=s.text||"",c=s.x,d=s.y,u=s.options||{},f=s.mutex||{},A=f.pdfEscape,h=f.activeFontKey,m=f.fonts,p=h,x="",v=0,y="",b=m[p].encoding;if(m[p].encoding!=="Identity-H")return{text:l,x:c,y:d,options:u,mutex:f};for(y=l,p=h,Array.isArray(l)&&(y=l[0]),v=0;v<y.length;v+=1)m[p].metadata.hasOwnProperty("cmap")&&(o=m[p].metadata.cmap.unicode.codeMap[y[v].charCodeAt(0)]),o||y[v].charCodeAt(0)<256&&m[p].metadata.hasOwnProperty("Unicode")?x+=y[v]:x+="";var w="";return parseInt(p.slice(1))<14||b==="WinAnsiEncoding"?w=A(x,p).split("").map(function(I){return I.charCodeAt(0).toString(16)}).join(""):b==="Identity-H"&&(w=r(x,m[p])),f.isHex=!0,{text:w,x:c,y:d,options:u,mutex:f}};e.events.push(["postProcessText",function(s){var o=s.text||"",l=[],c={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var d=0;for(d=0;d<o.length;d+=1)Array.isArray(o[d])&&o[d].length===3?l.push([a(Object.assign({},c,{text:o[d][0]})).text,o[d][1],o[d][2]]):l.push(a(Object.assign({},c,{text:o[d]})).text);s.text=l}else s.text=a(Object.assign({},c,{text:o})).text}])}(An),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(An.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var a,s,o,l,c,d,u,f=e,A=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},p={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},x=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],v=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),y=!1,b=0;this.__bidiEngine__={};var w=function(k){var T=k.charCodeAt(),P=T>>8,q=p[P];return q!==void 0?f[256*q+(255&T)]:P===252||P===253?"AL":v.test(P)?"L":P===8?"R":"N"},I=function(k){for(var T,P=0;P<k.length;P++){if((T=w(k.charAt(P)))==="L")return!1;if(T==="R")return!0}return!1},j=function(k,T,P,q){var de,ce,le,he,ae=T[q];switch(ae){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":y=!1;break;case"N":case"AN":break;case"EN":y&&(ae="AN");break;case"AL":y=!0,ae="R";break;case"WS":case"BN":ae="N";break;case"CS":q<1||q+1>=T.length||(de=P[q-1])!=="EN"&&de!=="AN"||(ce=T[q+1])!=="EN"&&ce!=="AN"?ae="N":y&&(ce="AN"),ae=ce===de?ce:"N";break;case"ES":ae=(de=q>0?P[q-1]:"B")==="EN"&&q+1<T.length&&T[q+1]==="EN"?"EN":"N";break;case"ET":if(q>0&&P[q-1]==="EN"){ae="EN";break}if(y){ae="N";break}for(le=q+1,he=T.length;le<he&&T[le]==="ET";)le++;ae=le<he&&T[le]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(he=T.length,le=q+1;le<he&&T[le]==="NSM";)le++;if(le<he){var Ce=k[q],De=Ce>=1425&&Ce<=2303||Ce===64286;if(de=T[le],De&&(de==="R"||de==="AL")){ae="R";break}}}ae=q<1||(de=T[q-1])==="B"?"N":P[q-1];break;case"B":y=!1,a=!0,ae=b;break;case"S":s=!0,ae="N"}return ae},N=function(k,T,P){var q=k.split("");return P&&S(q,P,{hiLevel:b}),q.reverse(),T&&T.reverse(),q.join("")},S=function(k,T,P){var q,de,ce,le,he,ae=-1,Ce=k.length,De=0,O=[],R=b?h:A,G=[];for(y=!1,a=!1,s=!1,de=0;de<Ce;de++)G[de]=w(k[de]);for(ce=0;ce<Ce;ce++){if(he=De,O[ce]=j(k,G,O,ce),q=240&(De=R[he][m[O[ce]]]),De&=15,T[ce]=le=R[De][5],q>0)if(q===16){for(de=ae;de<ce;de++)T[de]=1;ae=-1}else ae=-1;if(R[De][6])ae===-1&&(ae=ce);else if(ae>-1){for(de=ae;de<ce;de++)T[de]=le;ae=-1}G[ce]==="B"&&(T[ce]=0),P.hiLevel|=le}s&&function(M,K,Y){for(var D=0;D<Y;D++)if(M[D]==="S"){K[D]=b;for(var V=D-1;V>=0&&M[V]==="WS";V--)K[V]=b}}(G,T,Ce)},E=function(k,T,P,q,de){if(!(de.hiLevel<k)){if(k===1&&b===1&&!a)return T.reverse(),void(P&&P.reverse());for(var ce,le,he,ae,Ce=T.length,De=0;De<Ce;){if(q[De]>=k){for(he=De+1;he<Ce&&q[he]>=k;)he++;for(ae=De,le=he-1;ae<le;ae++,le--)ce=T[ae],T[ae]=T[le],T[le]=ce,P&&(ce=P[ae],P[ae]=P[le],P[le]=ce);De=he}De++}}},B=function(k,T,P){var q=k.split(""),de={hiLevel:b};return P||(P=[]),S(q,P,de),function(ce,le,he){if(he.hiLevel!==0&&u)for(var ae,Ce=0;Ce<ce.length;Ce++)le[Ce]===1&&(ae=x.indexOf(ce[Ce]))>=0&&(ce[Ce]=x[ae+1])}(q,P,de),E(2,q,T,P,de),E(1,q,T,P,de),q.join("")};return this.__bidiEngine__.doBidiReorder=function(k,T,P){if(function(de,ce){if(ce)for(var le=0;le<de.length;le++)ce[le]=le;l===void 0&&(l=I(de)),d===void 0&&(d=I(de))}(k,T),o||!c||d)if(o&&c&&l^d)b=l?1:0,k=N(k,T,P);else if(!o&&c&&d)b=l?1:0,k=B(k,T,P),k=N(k,T);else if(!o||l||c||d){if(o&&!c&&l^d)k=N(k,T),l?(b=0,k=B(k,T,P)):(b=1,k=B(k,T,P),k=N(k,T));else if(o&&l&&!c&&d)b=1,k=B(k,T,P),k=N(k,T);else if(!o&&!c&&l^d){var q=u;l?(b=1,k=B(k,T,P),b=0,u=!1,k=B(k,T,P),u=q):(b=0,k=B(k,T,P),k=N(k,T),b=1,u=!1,k=B(k,T,P),u=q,k=N(k,T))}}else b=0,k=B(k,T,P);else b=l?1:0,k=B(k,T,P);return k},this.__bidiEngine__.setOptions=function(k){k&&(o=k.isInputVisual,c=k.isOutputVisual,l=k.isInputRtl,d=k.isOutputRtl,u=k.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var s=n.options||{};n.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(a)==="[object Array]"){var l=0;for(o=[],l=0;l<a.length;l+=1)Object.prototype.toString.call(a[l])==="[object Array]"?o.push([r.doBidiReorder(a[l][0]),a[l][1],a[l][2]]):o.push([r.doBidiReorder(a[l])]);n.text=o}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])}(An),An.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new Pm(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new kPe(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new vPe(this.contents),this.head=new bPe(this),this.name=new EPe(this),this.cmap=new Jre(this),this.toUnicode={},this.hhea=new wPe(this),this.maxp=new SPe(this),this.hmtx=new jPe(this),this.post=new CPe(this),this.os2=new NPe(this),this.loca=new BPe(this),this.glyf=new IPe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,a,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,d;for(d=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],d.push(Math.round(e*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(r=a>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var a,s,o,l;for(o=0,s=0,l=(e=""+e).length;0<=l?s<l:s>l;s=0<=l?++s:--s)a=e.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return o*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t}();var Of,Pm=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,a;for(a=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(e.charCodeAt(r)));return a},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,a,s,o,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^s)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*a+16777216*s+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,a,s;for(s=[],n=0,a=e.length;n<a;n++)r=e[n],s.push(this.writeByte(r));return s},t}(),vPe=function(){var t;function e(r){var n,a,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,s=this.tableCount;0<=s?a<s:a>s;a=0<=s?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,a,s,o,l,c,d,u,f,A,h,m,p;for(p in h=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(h)/c),o=Math.floor(f/c),u=16*h-f,(a=new Pm).writeInt(this.scalarType),a.writeShort(h),a.writeShort(f),a.writeShort(o),a.writeShort(u),s=16*h,d=a.pos+s,l=null,m=[],r)for(A=r[p],a.writeString(p),a.writeInt(t(A)),a.writeInt(d),a.writeInt(A.length),m=m.concat(A),p==="head"&&(l=d),d+=A.length;d%4;)m.push(0),d++;return a.write(m),n=2981146554-t(a.data),a.pos=l+8,a.writeUInt32(n),a.data},t=function(r){var n,a,s,o;for(r=Zre.call(r);r.length%4;)r.push(0);for(s=new Pm(r),a=0,n=0,o=r.length;n<o;n=n+=4)a+=s.readUInt32();return 4294967295&a},e}(),yPe={}.hasOwnProperty,yh=function(t,e){for(var r in e)yPe.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Of=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var bPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return yh(t,Of),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new Pm).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t}(),rH=function(){function t(e,r){var n,a,s,o,l,c,d,u,f,A,h,m,p,x,v,y,b;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),f=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(h=e.readUInt16(),A=h/2,e.pos+=6,s=function(){var w,I;for(I=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)I.push(e.readUInt16());return I}(),e.pos+=2,p=function(){var w,I;for(I=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)I.push(e.readUInt16());return I}(),d=function(){var w,I;for(I=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)I.push(e.readUInt16());return I}(),u=function(){var w,I;for(I=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)I.push(e.readUInt16());return I}(),a=(this.length-e.pos+this.offset)/2,l=function(){var w,I;for(I=[],c=w=0;0<=a?w<a:w>a;c=0<=a?++w:--w)I.push(e.readUInt16());return I}(),c=v=0,b=s.length;v<b;c=++v)for(x=s[c],n=y=m=p[c];m<=x?y<=x:y>=x;n=m<=x?++y:--y)u[c]===0?o=n+d[c]:(o=l[u[c]/2+(n-m)-(A-c)]||0)!==0&&(o+=d[c]),this.codeMap[n]=65535&o}e.pos=f}return t.encode=function(e,r){var n,a,s,o,l,c,d,u,f,A,h,m,p,x,v,y,b,w,I,j,N,S,E,B,k,T,P,q,de,ce,le,he,ae,Ce,De,O,R,G,M,K,Y,D,V,te,ve,Q;switch(q=new Pm,o=Object.keys(e).sort(function(Xe,se){return Xe-se}),r){case"macroman":for(p=0,x=function(){var Xe=[];for(m=0;m<256;++m)Xe.push(0);return Xe}(),y={0:0},s={},de=0,ae=o.length;de<ae;de++)y[V=e[a=o[de]]]==null&&(y[V]=++p),s[a]={old:e[a],new:y[e[a]]},x[a]=y[e[a]];return q.writeUInt16(1),q.writeUInt16(0),q.writeUInt32(12),q.writeUInt16(0),q.writeUInt16(262),q.writeUInt16(0),q.write(x),{charMap:s,subtable:q.data,maxGlyphID:p+1};case"unicode":for(T=[],f=[],b=0,y={},n={},v=d=null,ce=0,Ce=o.length;ce<Ce;ce++)y[I=e[a=o[ce]]]==null&&(y[I]=++b),n[a]={old:I,new:y[I]},l=y[I]-a,v!=null&&l===d||(v&&f.push(v),T.push(a),d=l),v=a;for(v&&f.push(v),f.push(65535),T.push(65535),B=2*(E=T.length),S=2*Math.pow(Math.log(E)/Math.LN2,2),A=Math.log(S/2)/Math.LN2,N=2*E-S,c=[],j=[],h=[],m=le=0,De=T.length;le<De;m=++le){if(k=T[m],u=f[m],k===65535){c.push(0),j.push(0);break}if(k-(P=n[k].new)>=32768)for(c.push(0),j.push(2*(h.length+E-m)),a=he=k;k<=u?he<=u:he>=u;a=k<=u?++he:--he)h.push(n[a].new);else c.push(P-k),j.push(0)}for(q.writeUInt16(3),q.writeUInt16(1),q.writeUInt32(12),q.writeUInt16(4),q.writeUInt16(16+8*E+2*h.length),q.writeUInt16(0),q.writeUInt16(B),q.writeUInt16(S),q.writeUInt16(A),q.writeUInt16(N),Y=0,O=f.length;Y<O;Y++)a=f[Y],q.writeUInt16(a);for(q.writeUInt16(0),D=0,R=T.length;D<R;D++)a=T[D],q.writeUInt16(a);for(te=0,G=c.length;te<G;te++)l=c[te],q.writeUInt16(l);for(ve=0,M=j.length;ve<M;ve++)w=j[ve],q.writeUInt16(w);for(Q=0,K=h.length;Q<K;Q++)p=h[Q],q.writeUInt16(p);return{charMap:n,subtable:q.data,maxGlyphID:b+1}}},t}(),Jre=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return yh(t,Of),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,n,a;for(e.pos=this.offset,this.version=e.readUInt16(),a=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=a?n<a:n>a;n=0<=a?++n:--n)r=new rH(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var n,a;return r==null&&(r="macroman"),n=rH.encode(e,r),(a=new Pm).writeUInt16(0),a.writeUInt16(1),n.table=a.data.concat(n.subtable),n},t}(),wPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return yh(t,Of),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),NPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return yh(t,Of),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(e.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(e.readInt());return n}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(e.readInt());return n}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),CPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return yh(t,Of),t.prototype.tag="post",t.prototype.parse=function(e){var r,n,a;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(n=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],a=[];e.pos<this.offset+this.length;)r=e.readByte(),a.push(this.names.push(e.readString(r)));return a;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)c.push(e.readUInt32());return c}).call(this)}},t}(),_Pe=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},EPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return yh(t,Of),t.prototype.tag="name",t.prototype.parse=function(e){var r,n,a,s,o,l,c,d,u,f,A;for(e.pos=this.offset,e.readShort(),r=e.readShort(),l=e.readShort(),n=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},s=u=0,f=n.length;u<f;s=++u)a=n[s],e.pos=a.offset,d=e.readString(a.length),o=new _Pe(d,a),c[A=a.nameID]==null&&(c[A]=[]),c[a.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t}(),SPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return yh(t,Of),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),jPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return yh(t,Of),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,n,a,s,o,l,c;for(e.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,u;for(u=[],r=d=0;0<=a?d<a:d>a;r=0<=a?++d:--d)u.push(e.readInt16());return u}(),this.widths=(function(){var d,u,f,A;for(A=[],d=0,u=(f=this.metrics).length;d<u;d++)s=f[d],A.push(s.advance);return A}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=a?o<a:o>a;r=0<=a?++o:--o)c.push(this.widths.push(n));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),Zre=[].slice,IPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return yh(t,Of),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,n,a,s,o,l,c,d,u,f;return e in this.cache?this.cache[e]:(s=this.file.loca,r=this.file.contents,n=s.indexOf(e),(a=s.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+n,o=(l=new Pm(r.read(a))).readShort(),d=l.readShort(),f=l.readShort(),c=l.readShort(),u=l.readShort(),this.cache[e]=o===-1?new TPe(l,d,f,c,u):new PPe(l,o,d,f,c,u),this.cache[e]))},t.prototype.encode=function(e,r,n){var a,s,o,l,c;for(o=[],s=[],l=0,c=r.length;l<c;l++)a=e[r[l]],s.push(o.length),a&&(o=o.concat(a.encode(n)));return s.push(o.length),{table:o,offsets:s}},t}(),PPe=function(){function t(e,r,n,a,s,o){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=s,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),TPe=function(){function t(e,r,n,a,s){var o,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new Pm(Zre.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),BPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return yh(t,Of),t.prototype.tag="loca",t.prototype.parse=function(e){var r,n;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var a,s;for(s=[],n=0,a=this.length;n<a;n+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var a,s;for(s=[],n=0,a=this.length;n<a;n+=4)s.push(e.readUInt32());return s}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var n=new Uint32Array(this.offsets.length),a=0,s=0,o=0;o<n.length;++o)if(n[o]=a,s<r.length&&r[s]==o){++s,n[o]=a;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(a+=c)}for(var d=new Array(4*n.length),u=0;u<n.length;++u)d[4*u+3]=255&n[u],d[4*u+2]=(65280&n[u])>>8,d[4*u+1]=(16711680&n[u])>>16,d[4*u]=(4278190080&n[u])>>24;return d},t}(),kPe=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,a,s;for(r in a=this.font.cmap.tables[0].codeMap,e={},s=this.subset)n=s[r],e[r]=a[n];return e},t.prototype.glyphsFor=function(e){var r,n,a,s,o,l,c;for(a={},o=0,l=e.length;o<l;o++)a[s=e[o]]=this.font.glyf.glyphFor(s);for(s in r=[],a)(n=a[s])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(s in c=this.glyphsFor(r))n=c[s],a[s]=n;return a},t.prototype.encode=function(e,r){var n,a,s,o,l,c,d,u,f,A,h,m,p,x,v;for(a in n=Jre.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),h={0:0},v=n.charMap)h[(c=v[a]).old]=c.new;for(m in A=n.maxGlyphID,o)m in h||(h[m]=A++);return u=function(y){var b,w;for(b in w={},y)w[y[b]]=b;return w}(h),f=Object.keys(u).sort(function(y,b){return y-b}),p=function(){var y,b,w;for(w=[],y=0,b=f.length;y<b;y++)l=f[y],w.push(u[l]);return w}(),s=this.font.glyf.encode(o,p,h),d=this.font.loca.encode(s.offsets,p),x={cmap:this.font.cmap.raw(),glyf:s.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(x["OS/2"]=this.font.os2.raw()),this.font.directory.encode(x)},t}();An.API.PDFObject=function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,a,s,o;if(Array.isArray(r))return"["+function(){var l,c,d;for(d=[],l=0,c=r.length;l<c;l++)n=r[l],d.push(e.convert(n));return d}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in s=["<<"],r)o=r[a],s.push("/"+a+" "+e.convert(o));return s.push(">>"),s.join(`
`)}return""+r},e}();const eF=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:dPe,AcroFormAppearance:vn,AcroFormButton:Do,AcroFormCheckBox:Db,AcroFormChoiceField:Vp,AcroFormComboBox:$p,AcroFormEditBox:Fb,AcroFormListBox:Hp,AcroFormPasswordField:Rb,AcroFormPushButton:Ob,AcroFormRadioButton:Gp,AcroFormTextField:pm,GState:O2,ShadingPattern:H0,TilingPattern:Tp,default:An,jsPDF:An},Symbol.toStringTag,{value:"Module"}));async function nH(t){const e={...t,remaining:t.quantity,status:"PENDIENTE",createdAt:Nr.now()};return ta(xt(Ne,"inventory_batches"),e)}async function ene(t,e){await Mn(Kt(Ne,"inventory_batches",t),{status:"PAGADO",paidAmount:null,paidAt:Nr.now()})}async function FPe(t,e){const r=ar(xt(Ne,"batch_allocations"),lr("saleDate",">=",t),lr("saleDate","<=",e)),n=await Ut(r),a={};return n.forEach(s=>{const o=s.data(),l=o.batchId;a[l]||(a[l]={batchId:o.batchId,batchDate:o.batchDate,productName:o.productName,quantity:0,amountCharged:0}),a[l].quantity+=Number(o.quantity||0),a[l].amountCharged+=Number(o.amountCharged||0)}),Object.values(a)}async function tne(t){const e=Kt(Ne,"salesV2",t),r=await Es(e);if(!r.exists())throw new Error("La venta no existe.");const n=r.data(),a=[];if(Array.isArray(n.items)){for(const l of n.items)if(Array.isArray(l==null?void 0:l.allocations))for(const c of l.allocations){const d=String((c==null?void 0:c.batchId)||"").trim(),u=Number((c==null?void 0:c.qty)||0);d&&u&&a.push({batchId:d,qty:u})}}if(Array.isArray(n.allocations))for(const l of n.allocations){const c=String((l==null?void 0:l.batchId)||"").trim(),d=Number((l==null?void 0:l.qty)||0);c&&d&&a.push({batchId:c,qty:d})}if(a.length===0)return await fi(Ne,async l=>{l.delete(e)}),{restored:0};const s=new Map;for(const l of a)s.set(l.batchId,Number((s.get(l.batchId)||0)+l.qty));let o=0;return await fi(Ne,async l=>{const c=Array.from(s.entries()),d=c.map(([f])=>Kt(Ne,"inventory_batches",f)),u=await Promise.all(d.map(f=>l.get(f)));c.forEach(([f,A],h)=>{const m=u[h];if(!m.exists())return;const p=m.data(),x=Number((p==null?void 0:p.remaining)??0),v=Number((x+Number(A||0)).toFixed(3));l.update(d[h],{remaining:v}),o+=Number(A||0)}),l.delete(e)}),{restored:o}}var rne={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},aH=wi.createContext&&wi.createContext(rne),OPe=["attr","size","title"];function DPe(t,e){if(t==null)return{};var r=RPe(t,e),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)n=s[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function RPe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function VS(){return VS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},VS.apply(this,arguments)}function sH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function HS(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sH(Object(r),!0).forEach(function(n){MPe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function MPe(t,e,r){return e=LPe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LPe(t){var e=UPe(t,"string");return typeof e=="symbol"?e:e+""}function UPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nne(t){return t&&t.map((e,r)=>wi.createElement(e.tag,HS({key:r},e.attr),nne(e.child)))}function QPe(t){return e=>wi.createElement(VPe,VS({attr:HS({},t.attr)},e),nne(t.child))}function VPe(t){var e=r=>{var{attr:n,size:a,title:s}=t,o=DPe(t,OPe),l=a||r.size||"1em",c;return r.className&&(c=r.className),t.className&&(c=(c?c+" ":"")+t.className),wi.createElement("svg",VS({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,o,{className:c,style:HS(HS({color:t.color||r.color},r.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),s&&wi.createElement("title",null,s),t.children)};return aH!==void 0?wi.createElement(aH.Consumer,null,r=>e(r)):e(rne)}function HPe(t){return QPe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"},child:[]},{tag:"polyline",attr:{points:"1 20 1 14 7 14"},child:[]},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"},child:[]}]})(t)}function yc({onClick:t,loading:e,className:r=""}){return i.jsxs("button",{onClick:t,disabled:e,className:`flex items-center gap-2 px-3 py-1.5 rounded-2xl  border 
        bg-white hover:bg-gray-100 text-sm font-medium shadow-2xl
        disabled:opacity-50 disabled:cursor-not-allowed ${r}`,title:"Refrescar datos",children:[i.jsx(HPe,{className:`w-4 h-4 ${e?"animate-spin text-blue-500":""}`}),e?"Actualizando...":"Refrescar"]})}function bc(){const[t,e]=g.useState(0),r=g.useCallback(()=>e(n=>n+1),[]);return{refreshKey:t,refresh:r}}const Sl=t=>Math.round((Number(t)||0)*100)/100,kh=t=>Math.round((Number(t)||0)*1e3)/1e3,su=t=>Number(t??0).toFixed(2),Fh=t=>Number(t??0).toFixed(3),iH=(t,e)=>{var o;const r=t.date?String(t.date):"",n=(o=t.timestamp)!=null&&o.toDate?Kr(t.timestamp.toDate(),"yyyy-MM-dd"):"";let a=r||n;if(r&&n){const l=new Date(r+"T00:00:00").getTime(),c=new Date(n+"T00:00:00").getTime(),d=Math.abs(l-c)/(1e3*60*60*24);isFinite(d)&&d>30&&(a=n)}if(!a)return[];const s=t.type??"CONTADO";return Array.isArray(t.items)&&t.items.length>0?t.items.map((l,c)=>{const d=Number((l==null?void 0:l.qty)??0),u=Number((l==null?void 0:l.lineFinal)??0)||Math.max(0,Number((l==null?void 0:l.unitPrice)||0)*d-Number((l==null?void 0:l.discount)||0));return{id:`${e}#${c}`,productName:String((l==null?void 0:l.productName)??"(sin nombre)"),quantity:d,amount:Sl(u),amountSuggested:Number(t.amountSuggested??0),date:a,userEmail:t.userEmail??t.vendor??"(sin usuario)",clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",type:s,measurement:String((l==null?void 0:l.measurement)??t.measurement??""),allocations:Array.isArray(l==null?void 0:l.allocations)?l.allocations:t.allocations,avgUnitCost:Number((l==null?void 0:l.avgUnitCost)??t.avgUnitCost??0),cogsAmount:Number((l==null?void 0:l.cogsAmount)??0)}}):[{id:e,productName:t.productName??"(sin nombre)",quantity:Number(t.quantity??0),amount:Number(t.amount??t.amountCharged??0),amountSuggested:Number(t.amountSuggested??0),date:a,userEmail:t.userEmail??t.vendor??"(sin usuario)",clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",type:s,measurement:String(t.measurement??""),allocations:t.allocations,avgUnitCost:t.avgUnitCost,cogsAmount:t.cogsAmount}]};function $Pe({role:t,roles:e}){const[r,n]=g.useState([]),[a,s]=g.useState([]),[o,l]=g.useState(null),[c,d]=g.useState(!0),[u,f]=g.useState(""),[A,h]=g.useState("ALL"),[m,p]=g.useState("ALL"),[x,v]=g.useState({}),[y,b]=g.useState(null),[w,I]=g.useState(0),[j,N]=g.useState(0),[S,E]=g.useState(""),[B,k]=g.useState(0),[T,P]=g.useState("0"),q=Kr(new Date,"yyyy-MM-dd"),[de,ce]=g.useState(q),[le,he]=g.useState(q),[ae,Ce]=g.useState(!1),[De,O]=g.useState(!1),[R,G]=g.useState(!1),[M,K]=g.useState(""),Y=g.useRef(null),{refreshKey:D,refresh:V}=bc(),te=e&&e.length?e:t,ve=pbe(te,"bills","cerrarVentas"),Q=Rn(te,"admin"),Xe=({title:me,open:ye,onToggle:mt,right:gt})=>i.jsxs("button",{type:"button",onClick:mt,className:"w-full flex items-center justify-between gap-3 px-4 py-3 rounded-xl border bg-gray-50 hover:bg-gray-100 active:bg-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[i.jsx("span",{className:"font-semibold truncate",children:me}),gt?i.jsx("span",{className:"text-xs text-gray-600",children:gt}):null]}),i.jsx("div",{className:"shrink-0 text-lg font-bold leading-none",children:ye?"":"+"})]});g.useEffect(()=>{if(!de||!le)return;d(!0);const me=ar(xt(Ne,"salesV2"),lr("date",">=",de),lr("date","<=",le)),ye=Fu(me,mt=>{const gt=[];mt.forEach(yt=>{const Pt=iH(yt.data(),yt.id);gt.push(...Pt)}),n(gt),d(!1)},mt=>{console.error("Error cargando ventas por periodo:",mt),n([]),d(!1)});return()=>ye()},[de,le,D]),g.useEffect(()=>{if(!de||!le)return;const me=ar(xt(Ne,"salesV2"),lr("status","==","FLOTANTE"),lr("date",">=",de),lr("date","<=",le)),ye=Fu(me,mt=>{const gt=[];mt.forEach(yt=>{const Pt=iH(yt.data(),yt.id);gt.push(...Pt)}),s(gt)});return()=>ye()},[de,le,D]),g.useEffect(()=>{(async()=>{try{const me=await Ut(xt(Ne,"users")),ye={};me.forEach(mt=>{const gt=mt.data(),yt=String(gt.email||"").trim().toLowerCase(),Pt=String(gt.name||"").trim();yt&&(ye[yt]=Pt||gt.email||"")}),v(ye)}catch(me){console.error("Error cargando usuarios:",me),v({})}})()},[]);const se=me=>{const ye=String(me||"").trim().toLowerCase();return x[ye]||me||""};g.useEffect(()=>{(async()=>{const ye=ar(xt(Ne,"daily_closures"),lr("date","==",q)),mt=await Ut(ye);if(mt.empty)l(null);else{const gt=mt.docs[0];l({id:gt.id,...gt.data()})}})()},[q,D]);const Z=wi.useMemo(()=>{let me=[];if(A==="FLOTANTE"){const mt=[...r,...a],gt=new Map;for(const yt of mt)yt.status==="FLOTANTE"&&gt.set(yt.id,yt);me=Array.from(gt.values())}else if(A==="ALL"){const mt=[...r,...a],gt=new Map;for(const yt of mt)gt.set(yt.id,yt);me=Array.from(gt.values())}else me=r.filter(mt=>mt.status==="PROCESADA");m!=="ALL"&&(me=me.filter(mt=>mt.type===m));const ye=M.trim().toLowerCase();if(ye){const mt=yt=>String(yt||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),gt=mt(ye);me=me.filter(yt=>mt(yt.productName).includes(gt))}return me},[A,r,a,M,m]),ke=Sl(Z.reduce((me,ye)=>me+(ye.amount||0),0)),Se=Sl(Z.reduce((me,ye)=>me+Number(ye.cogsAmount??0),0)),Ee=me=>String(me||"").trim().toLowerCase()!=="lb",Ze=Z.filter(me=>me.type==="CONTADO"),ot=Z.filter(me=>me.type==="CREDITO"),vt=kh(Ze.filter(me=>Ee(me.measurement)).reduce((me,ye)=>me+(ye.quantity||0),0)),_t=kh(Ze.filter(me=>!Ee(me.measurement)).reduce((me,ye)=>me+(ye.quantity||0),0)),Tt=kh(ot.filter(me=>Ee(me.measurement)).reduce((me,ye)=>me+(ye.quantity||0),0)),Lt=kh(ot.filter(me=>!Ee(me.measurement)).reduce((me,ye)=>me+(ye.quantity||0),0)),Rt=Sl(Ze.reduce((me,ye)=>me+(ye.amount||0),0)),Et=Sl(ot.reduce((me,ye)=>me+(ye.amount||0),0)),Re=Sl(Ze.reduce((me,ye)=>me+Number(ye.cogsAmount??0),0)),Te=Sl(ot.reduce((me,ye)=>me+Number(ye.cogsAmount??0),0)),Ye=Sl(Rt-Re),dt=Sl(Et-Te),Fe=kh(vt+Tt),je=kh(_t+Lt),We=Sl(Rt+Et),ee={};Z.forEach(me=>{const ye=me.productName||"(sin nombre)";ee[ye]||(ee[ye]={totalQuantity:0,totalAmount:0}),ee[ye].totalQuantity=kh(ee[ye].totalQuantity+(me.quantity||0)),ee[ye].totalAmount=Sl(ee[ye].totalAmount+(me.amount||0))});const Ve=Object.entries(ee).map(([me,ye])=>({productName:me,totalQuantity:ye.totalQuantity,totalAmount:ye.totalAmount})),rt=async()=>{try{const me=Z.filter(Oe=>Oe.status==="FLOTANTE"),ye=me.length>0?me:r.filter(Oe=>Oe.status!=="PROCESADA");if(ye.length===0){f("No hay ventas para procesar.");return}const mt={totalCharged:Sl(ye.reduce((Oe,be)=>Oe+(be.amount||0),0)),totalSuggested:Sl(ye.reduce((Oe,be)=>Oe+(be.amountSuggested||0),0)),totalUnits:kh(ye.reduce((Oe,be)=>Oe+(be.quantity||0),0)),totalCOGS:Sl(ye.reduce((Oe,be)=>Oe+Number(be.cogsAmount??0),0))},gt=Sl(mt.totalCharged-mt.totalSuggested),yt=Sl(mt.totalCharged-mt.totalCOGS),Pt=await ta(xt(Ne,"daily_closures"),{date:q,createdAt:Nr.now(),periodStart:de,periodEnd:le,totalCharged:mt.totalCharged,totalSuggested:mt.totalSuggested,totalDifference:gt,totalUnits:mt.totalUnits,totalCOGS:mt.totalCOGS,grossProfit:yt,products:ye.map(Oe=>({productName:Oe.productName,quantity:Oe.quantity,amount:Oe.amount})),salesV2:ye.map(Oe=>({id:Oe.id,productName:Oe.productName,quantity:Oe.quantity,amount:Oe.amount,amountSuggested:Oe.amountSuggested,userEmail:Oe.userEmail,clientName:Oe.clientName,amountReceived:Oe.amountReceived,change:Oe.change,status:Oe.status,cogsAmount:Oe.cogsAmount??0,avgUnitCost:Oe.avgUnitCost??null,allocations:Oe.allocations??[],date:Oe.date})),productSummary:Object.entries(ye.reduce((Oe,be)=>{const Ae=be.productName||"(sin nombre)";return Oe[Ae]||(Oe[Ae]={totalQuantity:0,totalAmount:0}),Oe[Ae].totalQuantity=kh(Oe[Ae].totalQuantity+(be.quantity||0)),Oe[Ae].totalAmount=Sl(Oe[Ae].totalAmount+(be.amount||0)),Oe},{})).map(([Oe,be])=>({productName:Oe,totalQuantity:be.totalQuantity,totalAmount:be.totalAmount}))}),Ft=Lc(Ne);ye.forEach(Oe=>{Ft.update(Kt(Ne,"salesV2",Oe.id.split("#")[0]),{status:"PROCESADA",closureId:Pt.id,closureDate:q,date:Oe.date})}),await Ft.commit(),f(` Cierre guardado. Ventas procesadas: ${ye.length}.`)}catch(me){console.error(me),f(" Error al guardar el cierre.")}},$e=async me=>{if(!Q){f(" No tienes permisos para revertir esta venta.");return}if(window.confirm("Revertir esta venta? Esta accin no se puede deshacer."))try{await Mn(Kt(Ne,"salesV2",me.split("#")[0]),{status:"FLOTANTE",closureId:null,closureDate:null}),f(" Venta revertida a FLOTANTE.")}catch(ye){console.error(ye),f(" No se pudo revertir la venta.")}},ie=me=>{if(!Q){f(" No tienes permisos para editar esta venta.");return}b(me),I(me.quantity),N(me.amount),E(me.clientName),k(me.amountReceived),P(me.change)},pe=async()=>{if(!Q){f(" No tienes permisos para guardar cambios.");return}if(y)try{await Mn(Kt(Ne,"salesV2",y.id.split("#")[0]),{quantity:w,amount:j,amountCharged:j,clientName:S,amountReceived:B,change:T}),b(null),f(" Venta actualizada.")}catch(me){console.error(me),f(" No se pudo actualizar la venta.")}},fe=async me=>{if(!Q){f(" No tienes permisos para eliminar esta venta.");return}if(window.confirm("Eliminar esta venta? Se restaurar el stock en los lotes asignados."))try{const{restored:ye}=await tne(me.split("#")[0]);f(` Venta eliminada. Stock restaurado: ${Number(ye).toFixed(2)}.`)}catch(ye){console.error(ye),f(" No se pudo eliminar la venta.")}},Me=async()=>{if(Y.current){Y.current.classList.add("force-pdf-colors"),Y.current.classList.add("pdf-print-mode");try{const ye=(await $m(Y.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),mt=new An;mt.addImage(ye,"PNG",10,10,190,0),mt.save(`cierre_${q}.pdf`)}finally{Y.current.classList.remove("pdf-print-mode"),Y.current.classList.remove("force-pdf-colors")}}};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("style",{children:`
        .pdf-print-mode .pdf-desktop { display: block !important; }
        .pdf-print-mode .pdf-mobile  { display: none !important; }
      `}),i.jsxs("div",{className:"flex items-start justify-between gap-3 mb-4",children:[i.jsxs("h2",{className:"text-2xl font-bold",children:["Cierre de Ventas - ",de,"  ",le]}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsx(yc,{onClick:V})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx(Xe,{title:"Filtros",open:ae,onToggle:()=>Ce(me=>!me),right:i.jsxs("span",{className:"ml-1",children:[de,"  ",le,A!=="ALL"?`  ${A}`:"",m!=="ALL"?`  ${m==="CREDITO"?"Crdito":"Cash"}`:"",M.trim()?`  "${M.trim()}"`:""]})}),ae&&i.jsx("div",{className:"mt-3 border rounded-xl p-3 bg-white",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3",children:[i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Periodo desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-2 w-full",value:de,onChange:me=>ce(me.target.value)})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-2 w-full",value:le,onChange:me=>he(me.target.value)})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Estado"}),i.jsxs("select",{className:"border rounded px-2 py-2 w-full",value:A,onChange:me=>h(me.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Venta Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Venta Procesada"})]})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Tipo Operacin"}),i.jsxs("select",{className:"border rounded px-2 py-2 w-full",value:m,onChange:me=>p(me.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),i.jsx("option",{value:"CREDITO",children:"Crdito"}),i.jsx("option",{value:"CONTADO",children:"Cash"})]})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Producto"}),i.jsx("input",{type:"text",className:"border rounded px-2 py-2 w-full",placeholder:"Buscar por producto...",value:M,onChange:me=>K(me.target.value)})]})]})})]}),c?i.jsx("p",{children:"Cargando ventas..."}):i.jsxs("div",{ref:Y,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Libras - Unidad"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[Z.map(me=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${me.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:me.status})}),i.jsx("td",{className:"border p-1",children:me.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:me.productName}),i.jsx("td",{className:"border p-1",children:Fh(me.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",su(me.amount)]}),i.jsx("td",{className:"border p-1",children:me.date}),i.jsx("td",{className:"border p-1",children:se(me.userEmail)}),i.jsx("td",{className:"border p-1",children:me.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2 justify-center",children:Q?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>ie(me),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>fe(me.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):me.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:Q?i.jsx("button",{onClick:()=>$e(me.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},me.id)),Z.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-3 text-center text-gray-500",children:"Sin ventas para mostrar."})})]})]})}),i.jsxs("div",{className:"pdf-mobile md:hidden mb-4",children:[i.jsx(Xe,{title:"Ventas",open:De,onToggle:()=>O(me=>!me),right:i.jsxs("span",{className:"ml-1",children:[Z.length,"  C$",su(ke)]})}),De&&i.jsxs("div",{className:"mt-3 space-y-3",children:[Z.map(me=>i.jsxs("details",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("summary",{className:"px-4 py-3 flex justify-between items-center cursor-pointer",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:me.productName}),i.jsx("div",{className:"text-xs text-gray-500",children:me.date})]}),i.jsxs("div",{className:"text-right shrink-0 ml-3",children:[i.jsxs("div",{className:"font-bold",children:["C$",su(me.amount)]}),i.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${me.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:me.status})]})]}),i.jsxs("div",{className:"px-4 pb-4 pt-2 text-sm space-y-2",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Cantidad"}),i.jsx("strong",{children:Fh(me.quantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("strong",{children:me.type==="CREDITO"?"Crdito":"Cash"})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("strong",{className:"text-right break-all",children:se(me.userEmail)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("strong",{className:"text-right break-all",children:me.clientName||""})]}),i.jsx("div",{className:"pt-2",children:me.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2",children:Q?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>ie(me),className:"flex-1 text-xs bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>fe(me.id),className:"flex-1 text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):me.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2",children:Q?i.jsx("button",{onClick:()=>$e(me.id),className:"w-full text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:"No options"})})]})]},me.id)),Z.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin ventas para mostrar."})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-6",children:[i.jsxs("div",{children:["Total libras Cash: ",i.jsx("strong",{children:Fh(_t)})]}),i.jsxs("div",{children:["Total Unidades cash: ",i.jsx("strong",{children:Fh(vt)})]}),i.jsxs("div",{children:["Total libras credito: ",i.jsx("strong",{children:Fh(Lt)})]}),i.jsxs("div",{children:["Total Unidades credito: ",i.jsx("strong",{children:Fh(Tt)})]}),i.jsxs("div",{children:["Total facturado Cash: ",i.jsxs("strong",{children:["C$",su(Re)]})]}),i.jsxs("div",{children:["Total facturado credito:"," ",i.jsxs("strong",{children:["C$",su(Te)]})]}),i.jsxs("div",{children:["Total venta Cash: ",i.jsxs("strong",{children:["C$",su(Rt)]})]}),i.jsxs("div",{children:["Total venta Credito: ",i.jsxs("strong",{children:["C$",su(Et)]})]}),i.jsxs("div",{children:["Utilidad bruta Cash: ",i.jsxs("strong",{children:["C$",su(Ye)]})]}),i.jsxs("div",{children:["Utilidad bruta credito:"," ",i.jsxs("strong",{children:["C$",su(dt)]})]}),i.jsxs("div",{children:["Total libras cash y credito: ",i.jsx("strong",{children:Fh(je)})]}),i.jsxs("div",{children:["Total unidades cash y credito:"," ",i.jsx("strong",{children:Fh(Fe)})]}),i.jsxs("div",{children:["Total ventas Cash y credito:"," ",i.jsxs("strong",{children:["C$",su(We)]})]}),i.jsxs("div",{children:["Total facturado a precio compra:"," ",i.jsxs("strong",{children:["C$",su(Se)]})]})]}),i.jsxs("div",{className:"mt-4",children:[i.jsx(Xe,{title:"Consolidado por producto",open:R,onToggle:()=>G(me=>!me),right:i.jsx("span",{className:"ml-1",children:Ve.length})}),R&&i.jsx("div",{className:"mt-3",children:i.jsxs("table",{className:"min-w-full border text-sm mb-2 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Total dinero"})]})}),i.jsxs("tbody",{children:[Ve.map(me=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:me.productName}),i.jsx("td",{className:"border p-1",children:Fh(me.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",su(me.totalAmount)]})]},me.productName)),Ve.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500",children:"Sin datos para consolidar."})})]})]})})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[i.jsx("button",{disabled:!ve,onClick:rt,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Cerrar ventas del da"}),i.jsx("button",{onClick:Me,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Descargar PDF"})]}),u&&i.jsx("p",{className:"mt-2 text-sm",children:u}),y&&i.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-4 space-y-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:"Editar venta"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[y.productName,"  ",se(y.userEmail)]}),i.jsx("label",{className:"text-sm",children:"Cantidad"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:w,onChange:me=>I(parseFloat(me.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Monto cobrado"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:j,onChange:me=>N(parseFloat(me.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Cliente"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:S,onChange:me=>E(me.target.value)}),i.jsx("label",{className:"text-sm",children:"Paga con"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:B,onChange:me=>k(parseFloat(me.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Vuelto"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:T,onChange:me=>P(me.target.value)}),i.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[i.jsx("button",{onClick:()=>b(null),className:"px-3 py-1 border rounded",children:"Cancelar"}),i.jsx("button",{onClick:pe,className:"px-3 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",children:"Guardar cambios"})]})]})})]})}const iu=t=>Number(t??0).toFixed(2),gx=t=>Number(t??0).toFixed(3);function GPe(){var y,b,w,I;const t=async j=>{if(!window.confirm(`Eliminar el cierre del ${j.date}?`))return;const N=window.confirm("Tambin quieres reabrir (revertir a FLOTANTE) las ventas vinculadas a este cierre?");try{if(N){const S=await Ut(ar(xt(Ne,"salesV2"),lr("closureId","==",j.id)));if(!S.empty){const E=Lc(Ne);S.forEach(B=>{E.update(Kt(Ne,"salesV2",B.id),{status:"FLOTANTE",closureId:null,closureDate:null})}),await E.commit()}}await na(Kt(Ne,"daily_closures",j.id)),(d==null?void 0:d.id)===j.id&&u(null),await m(),A(` Cierre eliminado${N?" y ventas reabiertas.":"."}`)}catch(S){console.error(S),A(" No se pudo eliminar el cierre.")}},[e,r]=g.useState(Kr(ste(new Date),"yyyy-MM-dd")),[n,a]=g.useState(Kr(new Date,"yyyy-MM-dd")),[s,o]=g.useState(!0),[l,c]=g.useState([]),[d,u]=g.useState(null),[f,A]=g.useState(""),h=g.useRef(null),m=async()=>{try{o(!0);const j=ar(xt(Ne,"daily_closures"),lr("date",">=",e),lr("date","<=",n)),N=await Ut(j),S=[];N.forEach(E=>S.push({id:E.id,...E.data()})),S.sort((E,B)=>E.date<B.date?1:E.date>B.date?-1:0),c(S)}catch(j){console.error(j),A(" Error cargando el historial.")}finally{o(!1)}};g.useEffect(()=>{m()},[]);const p=async j=>{j.preventDefault(),m()},x=g.useMemo(()=>{if(!d)return{units:0,sug:0,chg:0,diff:0,cogs:0,profit:0};const j=Number(d.totalUnits??0),N=Number(d.totalSuggested??0),S=Number(d.totalCharged??0),E=Number(d.totalDifference??(isFinite(S-N)?S-N:0)),B=Number(d.totalCOGS??0),k=Number(d.grossProfit??(isFinite(S-B)?S-B:0));return{units:j,sug:N,chg:S,diff:E,cogs:B,profit:k}},[d]),v=async()=>{if(!h.current||!d)return;const j=h.current;j.classList.add("force-pdf-colors");try{const[{default:N},{jsPDF:S}]=await Promise.all([dA(()=>Promise.resolve().then(()=>eR),void 0),dA(()=>Promise.resolve().then(()=>eF),void 0)]),B=(await N(j,{backgroundColor:"#ffffff",onclone:P=>{const q=P.defaultView;P.body.querySelectorAll("*").forEach(ce=>{const le=q.getComputedStyle(ce);le.color&&(ce.style.color=le.color),le.backgroundColor&&le.backgroundColor!=="rgba(0, 0, 0, 0)"&&(ce.style.backgroundColor=le.backgroundColor),le.borderColor&&(ce.style.borderColor=le.borderColor)})}})).toDataURL("image/png"),{jsPDF:k}=await dA(async()=>{const{jsPDF:P}=await Promise.resolve().then(()=>eF);return{jsPDF:P}},void 0),T=new k;T.addImage(B,"PNG",10,10,190,0),T.save(`cierre_${d.date}.pdf`)}finally{j.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Histrico de cierres"}),i.jsxs("form",{onSubmit:p,className:"flex flex-wrap items-end gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:e,onChange:j=>r(j.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:n,onChange:j=>a(j.target.value)})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Aplicar"})]}),s?i.jsx("p",{children:"Cargando..."}):l.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cierres en el rango seleccionado."}):i.jsxs("table",{className:"min-w-full text-sm mb-6  shadow-lg p-4 bg-white border-gray-100",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Monto de venta"}),i.jsx("th",{className:"border p-2",children:"Monto al costo"}),i.jsx("th",{className:"border p-2",children:"Ganancia sin gastos"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsx("tbody",{children:l.map(j=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:j.date}),i.jsx("td",{className:"border p-1",children:gx(j.totalUnits)}),i.jsxs("td",{className:"border p-1",children:["C$",iu(j.totalCharged)]}),i.jsxs("td",{className:"border p-1",children:["C$",iu(j.totalCOGS)]}),i.jsxs("td",{className:"border p-1",children:["C$",iu(j.grossProfit??Number(j.totalCharged??0)-Number(j.totalCOGS??0))]}),i.jsx("td",{className:"border p-1",children:i.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>u(j),children:"Ver detalle"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>t(j),children:"Eliminar"})]})})]},j.id))})]}),d&&i.jsxs("div",{className:"mt-6 rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2 ",children:[i.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle ",d.date]}),i.jsx("button",{onClick:()=>u(null),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"}),i.jsx("button",{onClick:v,className:"ml-auto bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Descargar PDF"})]}),i.jsxs("div",{ref:h,className:"space-y-4",children:[i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:i.jsxs("div",{children:["Total Libras/Unidades: ",i.jsx("strong",{children:gx(x.units)})]})}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm",children:[i.jsxs("div",{children:["Monto al costo:"," ",i.jsxs("strong",{children:["C$",iu(x.cogs)]})]}),i.jsxs("div",{children:["Ganancia sin gastos:"," ",i.jsxs("strong",{children:["C$",iu(x.profit)]})]})]}),(y=d.salesV2)!=null&&y.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto de ventas"}),i.jsx("th",{className:"border p-2",children:"Monto al costo"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Vendedor"})]})}),i.jsx("tbody",{children:d.salesV2.map((j,N)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:j.productName??"(sin nombre)"}),i.jsx("td",{className:"border p-1",children:gx(j.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",iu(j.amount)]}),i.jsxs("td",{className:"border p-1",children:["C$",iu(j.cogsAmount)]}),i.jsx("td",{className:"border p-1",children:j.date??""}),i.jsx("td",{className:"border p-1",children:j.userEmail??""})]},N))})]})]}):(b=d.sales)!=null&&b.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Paga con"}),i.jsx("th",{className:"border p-2",children:"Vuelto"})]})}),i.jsx("tbody",{children:d.sales.map((j,N)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:j.productName??"(sin nombre)"}),i.jsx("td",{className:"border p-1",children:gx(j.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",iu(j.amount)]}),i.jsx("td",{className:"border p-1",children:j.userEmail??""}),i.jsx("td",{className:"border p-1",children:j.clientName??""}),i.jsxs("td",{className:"border p-1",children:["C$",iu(j.amountReceived)]}),i.jsx("td",{className:"border p-1",children:typeof j.change=="number"?iu(j.change):j.change??"0"})]},N))})]})]}):(w=d.products)!=null&&w.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Productos en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto"})]})}),i.jsx("tbody",{children:d.products.map((j,N)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:j.productName}),i.jsx("td",{className:"border p-1",children:gx(j.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",iu(j.amount)]})]},N))})]})]}):i.jsx("p",{className:"text-sm text-gray-500",children:"Sin detalle de ventas en este cierre."}),(I=d.productSummary)!=null&&I.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Consolidado por producto"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Total dinero"})]})}),i.jsx("tbody",{children:d.productSummary.map((j,N)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:j.productName}),i.jsx("td",{className:"border p-1",children:gx(j.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",iu(j.totalAmount)]})]},N))})]})]}):null]})]}),f&&i.jsx("p",{className:"mt-3 text-sm",children:f})]})}function KPe(){const[t,e]=g.useState(""),[r,n]=g.useState(""),[a,s]=g.useState(""),[o,l]=g.useState(!1),[c,d]=g.useState(["vendedor_pollo"]),[u,f]=g.useState(""),[A,h]=g.useState(""),[m,p]=g.useState([]),[x,v]=g.useState(!0),[y,b]=g.useState(null),[w,I]=g.useState(["vendedor_pollo"]),[j,N]=g.useState(""),[S,E]=g.useState(""),[B,k]=g.useState(!1),[T,P]=g.useState([]),q=M=>!M||M==="vendedor"?"vendedor_pollo":M==="admin"||M==="supervisor_pollo"||M==="contador"||M==="vendedor_pollo"||M==="vendedor_ropa"||M==="vendedor_dulces"?M:"vendedor_pollo",de=M=>M?Array.isArray(M)?M.map(K=>q(String(K))):[q(String(M))]:["vendedor_pollo"],ce=async()=>{v(!0);const M=await Ut(xt(Ne,"users")),K=[];M.forEach(Y=>{const D=Y.data();K.push({id:Y.id,email:D.email??"",name:D.name??"",roles:de(D.roles??D.role),sellerCandyId:D.sellerCandyId??""})}),p(K),v(!1)},le=async()=>{try{const M=await Ut(xt(Ne,"sellers_candies")),K=[];M.forEach(Y=>{const D=Y.data();K.push({id:Y.id,name:D.name??"(sin nombre)",branchLabel:D.branch??"",commissionPercent:Number(D.commissionPercent??0)})}),P(K)}catch(M){console.error("Error cargando sellers_candies:",M)}};g.useEffect(()=>{ce(),le()},[]);const he=()=>{e(""),n(""),s(""),d(["vendedor_pollo"]),h("")},ae=async M=>{if(M.preventDefault(),f(""),y){if(a&&a.length>0&&a.length<6){f(" La contrasea debe tener al menos 6 caracteres.");return}}else if(a.length<6){f(" La contrasea debe tener al menos 6 caracteres.");return}if(!t.trim()){f(" El nombre es obligatorio.");return}try{if(y){const Q=Kt(Ne,"users",y),Xe=w.length?w:["vendedor_pollo"],se=Xe.includes("vendedor_dulces")&&(j||A)||"";if(await Mn(Q,{email:r,name:t.trim(),roles:Xe,role:Xe[0]||"vendedor_pollo",sellerCandyId:se}),p(Z=>Z.map(ke=>ke.id===y?{...ke,email:r,name:t.trim(),roles:Xe,sellerCandyId:se}:ke)),a&&a.length>=6)try{const Z=YB(),ke=S||r;await kge(Z,ke),f(` Usuario actualizado. Se envi correo de restablecimiento a ${ke}`)}catch(Z){console.error("Error sending password reset:",Z),f(" Usuario actualizado. No se pudo enviar correo de restablecimiento.")}else f(" Usuario actualizado correctamente.");De();return}const K=LD(),Y=MD(K.options,"Secondary"),D=YB(Y),V=await Fge(D,r,a),te=c.length?c:["vendedor_pollo"],ve=te.includes("vendedor_dulces")&&A||"";await Uee(Kt(xt(Ne,"users"),V.user.uid),{email:r,name:t.trim(),roles:te,role:te[0]||"vendedor_pollo",sellerCandyId:ve}),await qD(D),await Epe(Y),p(Q=>[{id:V.user.uid,email:r,name:t.trim(),roles:te,sellerCandyId:ve},...Q]),f(" Usuario creado correctamente."),he(),k(!1)}catch(K){console.error(K),f(" Error al crear el usuario: "+K.message)}},Ce=M=>{b(M.id),e(M.name||""),n(M.email||""),E(M.email||""),I(M.roles&&M.roles.length?M.roles:["vendedor_pollo"]),h(M.sellerCandyId||""),N(M.sellerCandyId||""),s(""),k(!0)},De=()=>{b(null),I(["vendedor_pollo"]),N(""),E(""),he(),k(!1)},O=async M=>{confirm("Eliminar este usuario del listado?")&&(await na(Kt(Ne,"users",M)),p(Y=>Y.filter(D=>D.id!==M)))},R=M=>{const K=M==="admin"?"admin":M==="supervisor_pollo"?"supervisor_pollo":M==="vendedor_ropa"?"vendedor_ropa":M==="vendedor_dulces"?"vendedor_dulces":"vendedor_pollo",Y=K==="admin"?"bg-blue-100 text-blue-700":K==="supervisor_pollo"?"bg-amber-100 text-amber-700":K==="vendedor_ropa"?"bg-indigo-100 text-indigo-700":K==="vendedor_dulces"?"bg-pink-100 text-pink-700":"bg-green-100 text-green-700";return i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Y}`,children:K})},G=M=>`${M.name}  ${M.branchLabel||"Sin sucursal"}  ${M.commissionPercent.toFixed(2)}%`;return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Usuarios"}),i.jsx("button",{className:"px-3 py-2 rounded bg-purple-600 text-white hover:bg-purple-700",onClick:()=>k(!0),type:"button",children:"Crear usuario"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Email"}),i.jsx("th",{className:"p-2 border",children:"Rol"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:x?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Cargando"})}):m.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Sin usuarios"})}):m.map(M=>{const K=y===M.id,Y=(K?w:M.roles).includes("vendedor_dulces");return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:M.name||""}),i.jsx("td",{className:"p-2 border",children:M.email}),i.jsx("td",{className:"p-2 border",children:K?i.jsxs("div",{className:"space-y-2 text-left",children:[["supervisor_pollo","admin","vendedor_pollo","vendedor_ropa","vendedor_dulces"].map(D=>i.jsxs("label",{className:"inline-flex items-center mr-3",children:[i.jsx("input",{type:"checkbox",className:"mr-2",checked:w.includes(D),onChange:()=>I(V=>V.includes(D)?V.filter(te=>te!==D):[...V,D])}),i.jsx("span",{className:"text-sm",children:D})]},D)),w.includes("vendedor_dulces")&&i.jsxs("select",{className:"w-full border p-1 rounded text-xs mt-1",value:j,onChange:D=>N(D.target.value),children:[i.jsx("option",{value:"",children:"Selecciona vendedor de dulces"}),T.map(D=>i.jsx("option",{value:D.id,children:G(D)},D.id))]})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"flex gap-2 justify-center",children:M.roles.map(D=>i.jsx("span",{children:R(D)},D))}),Y&&M.sellerCandyId&&i.jsx("div",{className:"mt-1 text-[11px] text-gray-500",children:"Vendedor asignado"})]})}),i.jsx("td",{className:"p-2 border space-x-2",children:i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Ce(M),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>O(M.id),children:"Eliminar"})]})})]},M.id)})})]})}),u&&i.jsx("p",{className:"text-sm mt-2",children:u}),B&&i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>k(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-lg max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:y?"Editar usuario":"Registrar nuevo usuario"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:De,type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:ae,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nombre completo"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400",value:t,onChange:M=>e(M.target.value),required:!0})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Correo electrnico"}),i.jsx("input",{type:"email",className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400",value:r,onChange:M=>n(M.target.value),required:!0})]}),i.jsxs("div",{className:"space-y-1 relative",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Contrasea (mnimo 6 caracteres)"}),i.jsx("input",{type:o?"text":"password",minLength:6,className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400 pr-10",value:a,onChange:M=>s(M.target.value),required:!y}),i.jsx("button",{type:"button",className:"absolute right-2 top-8 text-sm text-gray-600 hover:text-gray-800",onClick:()=>l(M=>!M),children:o?"":""})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Roles"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:["supervisor_pollo","contador","admin","vendedor_pollo","vendedor_ropa","vendedor_dulces"].map(M=>i.jsxs("label",{className:"inline-flex items-center mr-3",children:[i.jsx("input",{type:"checkbox",className:"mr-2",checked:y?w.includes(M):c.includes(M),onChange:()=>{y?I(K=>K.includes(M)?K.filter(Y=>Y!==M):[...K,M]):d(K=>K.includes(M)?K.filter(Y=>Y!==M):[...K,M])}}),i.jsx("span",{className:"text-sm",children:M})]},M))})]}),(y?w.includes("vendedor_dulces"):c.includes("vendedor_dulces"))&&i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Vendedor (dulces)"}),i.jsxs("select",{className:"w-full border p-2 rounded text-sm",value:A,onChange:M=>h(M.target.value),children:[i.jsx("option",{value:"",children:"Selecciona vendedor de dulces asignado"}),T.map(M=>i.jsx("option",{value:M.id,children:G(M)},M.id))]})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:De,children:"Cancelar"}),i.jsx("button",{className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:y?"Guardar cambios":"Crear usuario"})]})]}),u&&i.jsx("p",{className:"text-sm mt-2",children:u})]})]})]})}const oH=t=>`C$${(Number(t)||0).toFixed(2)}`;function qPe(){const[t,e]=g.useState(""),[r,n]=g.useState(0),[a,s]=g.useState(0),[o,l]=g.useState(""),[c,d]=g.useState(""),[u,f]=g.useState(""),[A,h]=g.useState([]),[m,p]=g.useState(!0),[x,v]=g.useState(!1),[y,b]=g.useState(null),[w,I]=g.useState(""),[j,N]=g.useState(""),[S,E]=g.useState(""),[B,k]=g.useState(0),[T,P]=g.useState(0),[q,de]=g.useState(!1),ce=async()=>{p(!0);const G=await Ut(xt(Ne,"products")),M=[];G.forEach(K=>{const Y=K.data();M.push({id:K.id,name:Y.name??"",price:Number(Y.price??0),providerPrice:Number(Y.providerPrice??0),category:Y.category??"",measurement:Y.measurement??"",active:Y.active!==!1})}),h(M),p(!1)};g.useEffect(()=>{ce()},[]);const le=async G=>{if(G.preventDefault(),l(""),!t||r<=0||!u){l(" Completa nombre, precio vlido y unidad de medida");return}try{const M={name:t,price:parseFloat(r.toFixed(2)),providerPrice:parseFloat((a||0).toFixed(2)),category:c,measurement:u,active:!0},K=await ta(xt(Ne,"products"),M);h(Y=>[{id:K.id,...M},...Y]),l(" Producto registrado con exito."),e(""),n(0),s(0),f(""),d(""),de(!1)}catch(M){l(" Error: "+M.message)}},he=G=>{b(G.id),I(G.name),N(G.category),E(G.measurement),k(G.price),P(G.providerPrice||0)},ae=()=>{b(null),I(""),N(""),E(""),k(0)},Ce=async()=>{if(!y)return;const G=Kt(Ne,"products",y);await Mn(G,{name:w,category:j,measurement:S,price:parseFloat((B||0).toFixed(2)),providerPrice:parseFloat((T||0).toFixed(2))}),h(M=>M.map(K=>K.id===y?{...K,name:w,category:j,measurement:S,price:parseFloat((B||0).toFixed(2)),providerPrice:parseFloat((T||0).toFixed(2))}:K)),ae()},De=async G=>{const M=Kt(Ne,"products",G.id),K=G.active===!1;await Mn(M,{active:K}),h(Y=>Y.map(D=>D.id===G.id?{...D,active:K}:D))},O=async G=>{const M=ar(xt(Ne,"inventory_batches"),lr("productId","==",G),_S(1));if(!(await Ut(M)).empty){alert(`No se puede eliminar: hay lotes asociados a este producto.
Sugerencia: desactvalo para ocultarlo.`);return}confirm("Eliminar este producto definitivamente?")&&(await na(Kt(Ne,"products",G)),h(D=>D.filter(V=>V.id!==G)))},R=x?A:A.filter(G=>G.active!==!1);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Productos"}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{l(""),de(!0)},children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo producto"]})]}),q&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>de(!1)}),i.jsxs("div",{className:"relative z-10 w-[95%] max-w-lg bg-white rounded-lg shadow-2xl border p-5",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("h3",{className:"text-lg font-bold text-green-700 flex items-center gap-2",children:[i.jsx("span",{className:"inline-block bg-green-100 text-green-700 rounded-full p-2",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Registrar producto"]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>de(!1),children:"Cerrar"})]}),i.jsxs("form",{onSubmit:le,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Categora"}),i.jsxs("select",{value:c,onChange:G=>d(G.target.value),className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-400",children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"pollo",children:"Pollo"}),i.jsx("option",{value:"cerdo",children:"Cerdo"}),i.jsx("option",{value:"huevo",children:"Huevos"}),i.jsx("option",{value:"ropa",children:"Ropa"}),i.jsx("option",{value:"otros",children:"Otros"})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nombre del producto"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded",value:t,onChange:G=>e(G.target.value)})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tipo de unidad de medida"}),i.jsxs("select",{value:u,onChange:G=>f(G.target.value),className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-400",children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"lb",children:"Libra"}),i.jsx("option",{value:"kg",children:"Kilogramo"}),i.jsx("option",{value:"unidad",children:"Unidad"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Precio proveedor (ej: 40.00)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-2 rounded",value:Number.isNaN(a)?"":a,onChange:G=>s(parseFloat(G.target.value))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Precio por unidad (ej: 55.50)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-2 rounded",value:Number.isNaN(r)?"":r,onChange:G=>n(parseFloat(G.target.value)),onFocus:G=>G.target.value==="0"?n(NaN):null})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",children:"Agregar producto"}),o&&i.jsx("p",{className:"text-sm mt-2",children:o})]})]})]}),i.jsxs("div",{className:"flex items-center justify-between mt-6 mb-2",children:[i.jsx("h3",{className:"text-lg font-semibold p-2",children:"Productos"}),i.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[i.jsx("input",{type:"checkbox",checked:x,onChange:G=>v(G.target.checked)}),"Mostrar inactivos"]})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:m?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):R.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin productos"})}):R.map(G=>{const M=y===G.id,K=G.active!==!1;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:M?i.jsx("input",{className:"w-full border p-1 rounded",value:w,onChange:Y=>I(Y.target.value)}):G.name}),i.jsx("td",{className:"p-2 border",children:M?i.jsxs("select",{className:"w-full border p-1 rounded",value:j,onChange:Y=>N(Y.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"pollo",children:"Pollo"}),i.jsx("option",{value:"cerdo",children:"Cerdo"}),i.jsx("option",{value:"huevo",children:"Huevos"}),i.jsx("option",{value:"ropa",children:"Ropa"}),i.jsx("option",{value:"otros",children:"Otros"})]}):G.category}),i.jsx("td",{className:"p-2 border",children:M?i.jsxs("select",{className:"w-full border p-1 rounded",value:S,onChange:Y=>E(Y.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"lb",children:"Libra"}),i.jsx("option",{value:"kg",children:"Kilogramo"}),i.jsx("option",{value:"unidad",children:"Unidad"})]}):G.measurement}),i.jsx("td",{className:"p-2 border",children:M?i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-1 rounded text-right",value:Number.isNaN(T)?"":T,onChange:Y=>P(parseFloat(Y.target.value))}):oH(G.providerPrice||0)}),i.jsx("td",{className:"p-2 border",children:M?i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-1 rounded text-right",value:Number.isNaN(B)?"":B,onChange:Y=>k(parseFloat(Y.target.value))}):oH(G.price)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${K?"bg-green-100 text-green-700":"bg-gray-200 text-gray-700"}`,children:K?"Activo":"Inactivo"})}),i.jsx("td",{className:"p-2 border space-x-2",children:M?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Ce,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:ae,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>he(G),children:"Editar"}),i.jsx("button",{className:`px-2 py-1 rounded ${K?"bg-gray-600 hover:bg-gray-700 text-white":"bg-green-600 hover:bg-green-700 text-white"}`,onClick:()=>De(G),children:K?"Desactivar":"Activar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>O(G.id),children:"Eliminar"})]})})]},G.id)})})]})})]})}const jl=[];for(let t=0;t<256;++t)jl.push((t+256).toString(16).slice(1));function zPe(t,e=0){return(jl[t[e+0]]+jl[t[e+1]]+jl[t[e+2]]+jl[t[e+3]]+"-"+jl[t[e+4]]+jl[t[e+5]]+"-"+jl[t[e+6]]+jl[t[e+7]]+"-"+jl[t[e+8]]+jl[t[e+9]]+"-"+jl[t[e+10]]+jl[t[e+11]]+jl[t[e+12]]+jl[t[e+13]]+jl[t[e+14]]+jl[t[e+15]]).toLowerCase()}let E5;const WPe=new Uint8Array(16);function XPe(){if(!E5){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");E5=crypto.getRandomValues.bind(crypto)}return E5(WPe)}const YPe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),lH={randomUUID:YPe};function JPe(t,e,r){var a;if(lH.randomUUID&&!t)return lH.randomUUID();t=t||{};const n=t.random??((a=t.rng)==null?void 0:a.call(t))??XPe();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,zPe(n)}async function ZPe(t,e,r,n=!1){if(r<=0)return{allocations:[],avgUnitCost:0,cogsAmount:0};const a=xt(t,"inventory_batches"),s=ar(a,lr("productName","==",e)),c=(await Ut(s)).docs.map(d=>({id:d.id,data:d.data()})).sort((d,u)=>{var p,x;const f=d.data.date??"",A=u.data.date??"";if(f!==A)return f<A?-1:1;const h=((p=d.data.createdAt)==null?void 0:p.seconds)??0,m=((x=u.data.createdAt)==null?void 0:x.seconds)??0;return h-m}).map(d=>Kt(t,"inventory_batches",d.id));return fi(t,async d=>{let u=Number(r);const f=[],A=await Promise.all(c.map(x=>d.get(x)));for(let x=0;x<c.length&&u>0;x++){const v=c[x],y=A[x];if(!y.exists())continue;const b=y.data(),w=Number(b.quantity??0),I=Number(b.remaining??w??0),j=Number(b.purchasePrice??0);if(I<=0)continue;const N=Math.min(I,u),S=Number((I-N).toFixed(3));d.update(v,{remaining:S}),f.push({batchId:v.id,qty:N,unitCost:j,lineCost:Number((N*j).toFixed(2))}),u=Number((u-N).toFixed(3))}if(u>0&&!n)throw new Error(`Stock insuficiente para "${e}". Faltan ${u} unidades.`);const h=Number(f.reduce((x,v)=>x+v.lineCost,0).toFixed(2)),m=f.reduce((x,v)=>x+v.qty,0),p=m>0?Number((h/m).toFixed(4)):0;return{allocations:f,avgUnitCost:p,cogsAmount:h}})}const ane=3,e3e=.5*10**-ane;function Ps(t){const e=Number(t??0);return Number(e.toFixed(ane))}function S5(t,e){return Ps((t??0)+(e??0))}function HC(t,e){return Ps(t)+e3e>=Ps(e)}async function t3e(t,e){const r=await Ut(xt(Ne,"inventory_batches")),n=t.trim().toLowerCase();let a=0;for(const s of r.docs){const o=s.data();(o.productName||"").trim().toLowerCase()===n&&o.productId!==e&&(await Mn(Kt(Ne,"inventory_batches",s.id),{productId:e}),a++)}return a}const p0=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function cH({user:t,role:e,roles:r}){r&&r.length;const[n,a]=g.useState([]),[s,o]=g.useState([]),[l,c]=g.useState(""),[d,u]=g.useState(Kr(new Date,"yyyy-MM-dd")),[f,A]=g.useState(""),[h,m]=g.useState(""),[p,x]=g.useState([]),[v,y]=g.useState(0),[b,w]=g.useState(0),[I,j]=g.useState("0"),[N,S]=g.useState(""),[E,B]=g.useState(!1),[k,T]=g.useState({}),P=Re=>Math.round(Re*100)/100,q=Re=>Ps(Re).toFixed(3),[de,ce]=g.useState("CONTADO"),[le,he]=g.useState([]),[ae,Ce]=g.useState(""),[De,O]=g.useState(0),R=Re=>{ce(Re),Re==="CREDITO"?(A(""),w(0),j("0.00")):(Ce(""),O(0))},G=Re=>{const Te=Number(Re.specialPrice||0);return Te>0?Te:Number(Re.price||0)},M=async Re=>{if(!Re)return 0;const Te=ar(xt(Ne,"inventory_batches"),lr("productId","==",Re)),Ye=await Ut(Te);let dt=0;return Ye.forEach(Fe=>{const je=Fe.data();dt=S5(dt,Number(je.remaining||0))}),Ps(dt)},K=async Re=>{if(!Re)return 0;const Te=await Ut(xt(Ne,"inventory_batches"));let Ye=0;return Te.forEach(dt=>{const Fe=dt.data();(Fe.productName||"").trim().toLowerCase()===Re.trim().toLowerCase()&&(Ye=S5(Ye,Number(Fe.remaining||0)))}),Ps(Ye)};g.useEffect(()=>{(async()=>{const Re=await Ut(xt(Ne,"products")),Te=[];Re.forEach(Ye=>{const dt=Ye.data();(dt==null?void 0:dt.active)!==!1&&Te.push({id:Ye.id,productName:dt.name??dt.productName??"(sin nombre)",price:Number(dt.price??0),measurement:dt.measurement??"(sin unidad)",category:dt.category??"(sin categora)"})}),a(Te)})()},[]),g.useEffect(()=>{(async()=>{const Re=await Ut(xt(Ne,"inventory_batches")),Te={};Re.forEach(Ye=>{const dt=Ye.data(),Fe=dt.productId,je=Number(dt.remaining||0);Fe&&(Te[Fe]=S5(Te[Fe]||0,je))}),Object.keys(Te).forEach(Ye=>Te[Ye]=Ps(Te[Ye])),T(Te)})()},[]),g.useEffect(()=>{(async()=>{const Re=await Ut(xt(Ne,"users")),Te=[];Re.forEach(Ye=>{const dt=Ye.data();Te.push({id:Ye.id,email:dt.email??"(sin email)",role:dt.role??"USER"})}),o(Te)})()},[]);const Y=async()=>{if(!l)return;const Re=n.find(Ye=>Ye.id===l);if(!Re)return;if(p.some(Ye=>Ye.productId===Re.id)){c("");return}const Te=await M(Re.id);x(Ye=>[...Ye,{productId:Re.id,productName:Re.productName,measurement:Re.measurement,price:Number(Re.price||0),specialPrice:0,stock:Te,qty:0,qtyInput:"",specialPriceInput:"",discount:0,discountInput:""}]),c("")},D=async Re=>{if(!Re)return;const Te=n.find(dt=>dt.id===Re);if(!Te||p.some(dt=>dt.productId===Te.id))return;const Ye=await M(Te.id);x(dt=>[...dt,{productId:Te.id,productName:Te.productName,measurement:Te.measurement,price:Number(Te.price||0),specialPrice:0,stock:Ye,qty:0,qtyInput:"",specialPriceInput:"",discount:0,discountInput:""}]),c("")},V=Re=>{x(Te=>Te.filter(Ye=>Ye.productId!==Re))},te=Re=>{const Te=String(Re||"").replace(",",".");if(Te==="")return"";const Ye=Te.split(".");return Ye.length===1?Te:`${Ye[0]}.${Ye.slice(1).join("")}`},ve=async(Re,Te)=>{x(Ye=>Ye.map(dt=>{if(dt.productId!==Re)return dt;const Fe=(dt.measurement||"").toLowerCase()!=="lb",je=te(Te);if(je.trim()==="")return{...dt,qty:0,qtyInput:""};if(!Fe&&je===".")return{...dt,qty:0,qtyInput:"0."};const We=Number(je),ee=Number.isFinite(We)?We:0;let Ve=Fe?Math.max(0,Math.round(ee)):Ps(ee);const rt=Fe?Math.max(0,Math.floor(Number(dt.stock||0))):Ps(Number(dt.stock||0));if(Ve>rt){Ve=rt,S(` Cantidad limitada a existencias (${rt})`);const ie=Fe?String(Ve):Ve===0?"":String(Ve);return{...dt,qty:Ve,qtyInput:ie}}const $e=Fe?String(Ve):je.endsWith(".")?je:String(Ve);return{...dt,qty:Ve,qtyInput:$e}}))},Q=(Re,Te)=>{x(Ye=>Ye.map(dt=>{if(dt.productId!==Re)return dt;const Fe=te(Te);if(Fe.trim()==="")return{...dt,specialPrice:0,specialPriceInput:""};if(Fe===".")return{...dt,specialPrice:0,specialPriceInput:"0."};const je=Number(Fe),We=Number.isFinite(je)?Math.max(0,P(je)):0,ee=Fe.endsWith(".")?Fe:String(We);return{...dt,specialPrice:We,specialPriceInput:ee}}))},Xe=(Re,Te)=>{x(Ye=>Ye.map(dt=>{if(dt.productId!==Re)return dt;const Fe=te(Te);if(Fe.trim()==="")return{...dt,discount:0,discountInput:""};if(Fe===".")return{...dt,discount:0,discountInput:"0."};const je=Number(Fe),We=Number.isFinite(je)?Math.max(0,Math.floor(je)):0,ee=Fe.endsWith(".")?Fe:String(We);return{...dt,discount:We,discountInput:ee}}))},se=g.useMemo(()=>{let Re=0;for(const Te of p){const Ye=G(Te),dt=Number(Ye||0)*Number(Te.qty||0),Fe=Math.max(0,dt-Math.max(0,Number(Te.discount||0)));Re+=Fe}return P(Re)},[p]);g.useEffect(()=>{y(se)},[se]),g.useEffect(()=>{const Re=Number(b)||0,Te=Number(v)||0;j((Re-Te).toFixed(2))},[b,v]);const Z=Re=>{Re.key===","&&(Re.preventDefault(),Re.target.value+=".")},[ke,Se]=g.useState(!1);g.useEffect(()=>{var Ye;const Re=window.matchMedia("(max-width: 900px)"),Te=()=>Se(Re.matches);return Te(),(Ye=Re.addEventListener)==null||Ye.call(Re,"change",Te),()=>{var dt;return(dt=Re.removeEventListener)==null?void 0:dt.call(Re,"change",Te)}},[]),g.useEffect(()=>{(async()=>{try{const Re=await Ut(xt(Ne,"customers_pollo")),Te=[];Re.forEach(Ye=>{const dt=Ye.data();Te.push({id:Ye.id,name:dt.name??"",phone:dt.phone??"",status:dt.status??"ACTIVO",creditLimit:Number(dt.creditLimit??0),vendorId:dt.vendorId??"",vendorName:dt.vendorName??"",balance:0})});for(const Ye of Te)try{const dt=ar(xt(Ne,"ar_movements_pollo"),lr("customerId","==",Ye.id)),Fe=await Ut(dt);let je=0;Fe.forEach(ee=>{je+=Number(ee.data().amount||0)});const We=Number(Ye.initialDebt||0);Ye.balance=je+We}catch{Ye.balance=0}Te.sort((Ye,dt)=>(Ye.name||"").localeCompare(dt.name||"")),he(Te)}catch(Re){console.error("Error cargando customers_pollo:",Re),he([])}})()},[]);const Ee=g.useMemo(()=>le.find(Re=>Re.id===ae)||null,[le,ae]),Ze=Number((Ee==null?void 0:Ee.balance)||0),ot=de==="CREDITO"?Math.max(0,Number(Ze||0)+Math.max(0,Number(v||0))):0;g.useEffect(()=>{de==="CREDITO"&&O(Re=>Math.min(Math.max(0,Number(Re||0)),ot))},[de,ot]),g.useEffect(()=>{de==="CREDITO"&&(w(Number(De||0)),j("0.00"))},[de,De]);const vt=de==="CREDITO"?Ze+Math.max(0,Number(v||0))-Math.max(0,Number(De||0)):0,_t=async()=>{if(p.length===0)return"Agrega al menos un producto.";for(const Re of p){if(!Re.qty||Re.qty<=0)return`Cantidad invlida para "${Re.productName}".`;const Te=await M(Re.productId);if(!HC(Te,Re.qty)){const Ye=await K(Re.productName);if(HC(Ye,0)&&!HC(Te,0)){const dt=await t3e(Re.productName,Re.productId),Fe=await M(Re.productId);if(!HC(Fe,Re.qty))return`Stock insuficiente tras corregir ${dt} lote(s) para "${Re.productName}".`}else return`Stock insuficiente para "${Re.productName}". Disponible: ${Te}`}}return null},Tt=async Re=>{var Ye,dt;Re.preventDefault(),S("");const Te=await _t();if(Te){S(" "+Te);return}try{B(!0);const Fe=[];if(de==="CONTADO"){if(!f.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!ae)return"Selecciona un cliente (crdito).";if(De<0)return"El pago inicial no puede ser negativo.";if(De>v)return"El pago inicial no puede superar el total.";if((Ee==null?void 0:Ee.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede fiar."}for(const ie of p){const pe=ie.qty,{allocations:fe,avgUnitCost:Me,cogsAmount:me}=await ZPe(Ne,ie.productName,pe,!1),ye=G(ie),mt=Number(ye||0)*Number(pe||0),gt=Math.max(0,Number(ie.discount||0)),yt=Math.max(0,mt-gt);Fe.push({productId:ie.productId,productName:ie.productName,measurement:ie.measurement,unitPrice:Number(ye||0),regularPrice:Number(ie.price||0),specialPrice:Number(ie.specialPrice||0)>0?Number(ie.specialPrice):null,qty:pe,discount:gt,lineTotal:P(mt),lineFinal:P(yt),allocations:fe,avgUnitCost:Me,cogsAmount:me})}const je=Fe.reduce((ie,pe)=>ie+pe.lineFinal,0),We=Fe.reduce((ie,pe)=>ie+Number(pe.qty||0),0),ee=Number(de==="CREDITO"?De||0:b||0),Ve=de==="CREDITO"?"0.00":I,rt={id:JPe(),quantity:We,amount:je,amountCharged:je,timestamp:Nr.now(),date:d,userEmail:(t==null?void 0:t.email)??((Ye=s[0])==null?void 0:Ye.email)??"sin usuario",vendor:e??((dt=s[0])==null?void 0:dt.role)??"sin usuario",status:"FLOTANTE",items:Fe,itemsTotal:je,type:de,amountReceived:ee,change:Ve,customerId:de==="CREDITO"?ae:"",customerName:de==="CREDITO"?(Ee==null?void 0:Ee.name)||"":f.trim(),clientName:de==="CONTADO"?f.trim():""};if(de==="CONTADO"){if(!f.trim()){S(" Ingresa el nombre del cliente (contado).");return}}else{if(!ae){S(" Selecciona un cliente (crdito).");return}if(De<0){S(" El pago inicial no puede ser negativo.");return}if(De>v){S(" El pago inicial no puede superar el total.");return}if((Ee==null?void 0:Ee.status)==="BLOQUEADO"){S(" El cliente est BLOQUEADO. No se puede fiar.");return}const ie=Number((Ee==null?void 0:Ee.creditLimit)||0);if(ie>0&&vt>ie){S(` Supera el lmite de crdito (C$ ${ie.toFixed(2)}).`);return}}const $e=await ta(xt(Ne,"salesV2"),rt);if(de==="CREDITO"&&ae){const ie={customerId:ae,date:d,createdAt:Nr.now(),ref:{saleId:$e.id}};await ta(xt(Ne,"ar_movements_pollo"),{...ie,type:"CARGO",amount:Number(je)||0}),Number(De)>0&&await ta(xt(Ne,"ar_movements_pollo"),{...ie,type:"ABONO",amount:-Number(De)}),he(pe=>pe.map(fe=>fe.id===ae?{...fe,balance:Number(fe.balance||0)+Number(je||0)-Number(De||0)}:fe))}S(" Venta registrada y asignada a inventario (FIFO)."),x([]),c(""),y(0),w(0),j("0"),A(""),u(Kr(new Date,"yyyy-MM-dd")),Ce(""),O(0),ce("CONTADO")}catch(Fe){console.error(Fe),S(` ${(Fe==null?void 0:Fe.message)||"Error al registrar la venta."}`)}finally{B(!1)}},Lt=g.useMemo(()=>new Set(p.map(Re=>Re.productId)),[p]),Rt=g.useMemo(()=>n.filter(Re=>(k[Re.id]||0)>0),[n,k]),Et=g.useMemo(()=>{const Re=String(h||"").trim().toLowerCase();return Re?Rt.filter(Te=>`${Te.productName||""}`.toLowerCase().includes(Re)):Rt},[Rt,h]);return ke?i.jsx("div",{className:"w-full max-w-lg mx-auto p-3",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow p-3 space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{className:"font-bold text-lg text-blue-700",children:"Registrar venta (Pollo)"}),i.jsx("input",{type:"date",className:"text-sm text-gray-700 border rounded px-2 py-1",value:d,onChange:Re=>u(Re.target.value),"aria-label":"Fecha de la venta"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:de,onChange:Re=>R(Re.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),de==="CONTADO"?i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Cliente (Contado)"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:f,onChange:Re=>A(Re.target.value),placeholder:"Ej: Cliente Mostrador"})]}):i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Cliente (Crdito)"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:ae,onChange:Re=>Ce(Re.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),le.map(Re=>i.jsxs("option",{value:Re.status==="ACTIVO"?Re.id:"",disabled:Re.status==="BLOQUEADO",children:[Re.name,"  Saldo: ",p0(Re.balance||0)]},Re.id))]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-base font-semibold",children:p0(Ze)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-base font-semibold",children:p0(vt)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-semibold",children:"Pago inicial"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",type:"number",step:"0.01",inputMode:"decimal",max:ot,value:De===0?"":De,onChange:Re=>{const Te=Math.max(0,Number(Re.target.value||0)),Ye=Math.min(Te,ot);O(Ye)},placeholder:"0.00"}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Mximo: ",p0(ot)]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2 mb-2",placeholder:"Buscar producto por nombre...",value:h,onChange:Re=>m(Re.target.value)}),i.jsx("div",{className:"flex gap-2",children:i.jsxs("select",{className:"flex-1 border rounded px-1 py-2 text-sm",value:l,onChange:async Re=>{const Te=Re.target.value;c(Te),await D(Te)},children:[i.jsx("option",{value:"",disabled:!0,children:"Selecciona un producto"}),Et.map(Re=>i.jsxs("option",{value:Re.id,disabled:Lt.has(Re.id),children:[Re.productName," | C$ ",Re.price," | Disp:"," ",q(k[Re.id]||0)]},Re.id))]})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"text-sm font-semibold",children:"Items"}),p.length===0?i.jsx("div",{className:"text-gray-500",children:"Agrega productos al carrito."}):i.jsx("div",{className:"space-y-2",children:p.map(Re=>{const Te=G(Re),Ye=Number(Te||0)*Number(Re.qty||0),dt=Math.max(0,Ye-Math.max(0,Number(Re.discount||0))),Fe=(Re.measurement||"").toLowerCase()!=="lb";return i.jsxs("div",{className:"border rounded p-2",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("div",{className:"font-semibold",children:Re.productName}),i.jsxs("div",{className:"text-sm",children:["C$ ",P(Te).toFixed(2)]})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 items-center",children:[i.jsx("input",{className:"border rounded px-2 py-1 text-right",inputMode:Fe?"numeric":"decimal",step:Fe?1:.01,value:Re.qtyInput??(Re.qty===0?"":Re.qty),onKeyDown:Z,onChange:je=>ve(Re.productId,je.target.value),placeholder:Fe?"Unid":"Libras",title:Fe?"Unidades":"Libras"}),i.jsx("input",{className:"border rounded px-1 py-1 text-right",inputMode:"numeric",value:Re.discountInput??(Re.discount===0?"":Re.discount),onChange:je=>Xe(Re.productId,je.target.value),placeholder:"Descuento",title:"Descuento (C$)"}),i.jsx("input",{className:"border rounded px-2 py-1 text-right",inputMode:"decimal",value:Re.specialPriceInput??(Re.specialPrice===0?"":Re.specialPrice),onChange:je=>Q(Re.productId,je.target.value),placeholder:"Sugerido",title:"Precio sugerido (opcional)"})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Exist:"," ",Ps(Number(Re.stock)-Number(Re.qty||0)).toFixed(3)]}),i.jsxs("div",{className:"font-semibold",children:["C$ ",P(dt).toFixed(2)]})]}),i.jsx("div",{className:"mt-2 text-right",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 text-red-600",onClick:()=>V(Re.productId),children:"Quitar"})})]},Re.productId)})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"text-sm font-semibold",children:"Monto total"}),i.jsxs("div",{className:"text-xl font-bold",children:["C$ ",v.toFixed(2)]})]}),de==="CONTADO"&&i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("input",{className:"border rounded px-2 py-2",inputMode:"decimal",value:b===0?"":b,onChange:Re=>w(Number(Re.target.value||0)),placeholder:"Monto recibido"}),i.jsxs("div",{className:"border rounded px-2 py-2 bg-gray-100",children:["Cambio: C$ ",I]})]}),i.jsx("button",{onClick:Tt,disabled:p.length===0||E,className:"w-full bg-blue-600 text-white px-4 py-2 rounded",children:E?"Guardando...":"Guardar venta"}),N&&i.jsx("div",{className:`text-sm ${N.startsWith("")?"text-green-600":N.startsWith("")?"text-yellow-600":"text-red-600"}`,children:N})]})}):i.jsxs("div",{className:"relative",children:[i.jsxs("form",{onSubmit:Tt,className:`w-full mx-auto bg-white rounded-2xl shadow-2xl\r
                 p-4 sm:p-6 md:p-8\r
                 max-w-5xl space-y-4`,children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-blue-700 whitespace-nowrap",children:"Registrar venta (Pollo)"})}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Producto | Precio por Libra/Unidad"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("select",{className:"flex-1 border border-gray-300 p-2 rounded-2xl shadow-2xl focus:ring-2 focus:ring-blue-400",value:l,onChange:Re=>c(Re.target.value),children:[i.jsx("option",{value:"",disabled:!0,children:"Selecciona un producto"}),Rt.map(Re=>i.jsxs("option",{value:Re.id,disabled:Lt.has(Re.id),title:Lt.has(Re.id)?"Ya est en la lista":`Disponible: ${q(k[Re.id]||0)}`,children:[Re.productName,"  ",Re.measurement,"  C$ ",Re.price," (disp:"," ",q(k[Re.id]||0),")"]},Re.id))]}),i.jsx("button",{type:"button",onClick:Y,disabled:!l||Lt.has(l),className:"px-3 py-2 rounded-2xl shadow-2xl bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:"Agregar"})]})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Fecha de la venta"}),i.jsx("input",{type:"date",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl focus:ring-2 focus:ring-blue-400",value:d,onChange:Re=>u(Re.target.value)})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:de,onChange:Re=>R(Re.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),de==="CONTADO"?i.jsxs("div",{className:"md:col-span-2 space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cliente (Contado)"}),i.jsx("input",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:f,onChange:Re=>A(Re.target.value),placeholder:"Ej: Cliente Mostrador"})]}):i.jsxs("div",{className:"md:col-span-2 space-y-2",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cliente (Crdito)"}),i.jsxs("select",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:ae,onChange:Re=>Ce(Re.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),le.map(Re=>i.jsxs("option",{value:Re.status==="ACTIVO"?Re.id:"",disabled:Re.status==="BLOQUEADO",children:[Re.name,"  Saldo: ",p0(Re.balance||0)]},Re.id))]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:p0(Ze)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Pago inicial"}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Mximo: ",p0(ot)]}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",max:ot,className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:De===0?"":De,onChange:Re=>{const Te=Math.max(0,Number(Re.target.value||0)),Ye=Math.min(Te,ot);O(Ye)},placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:p0(vt)})]})]})]})]}),i.jsx("div",{className:"rounded border overflow-x-auto shadow-2xl",children:i.jsxs("table",{className:"min-w-full text-sm r",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"text-center",children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio especial"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Existencias"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cantidad"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descuento"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:""})]})}),i.jsx("tbody",{children:p.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Agrega productos al carrito."})}):p.map(Re=>{const Te=G(Re),Ye=Number(Te||0)*Number(Re.qty||0),dt=Math.max(0,Ye-Math.max(0,Number(Re.discount||0))),Fe=(Re.measurement||"").toLowerCase()!=="lb",je=Ps(Number(Re.stock)-Number(Re.qty||0));return i.jsxs("tr",{className:"text-center",children:[i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:[Re.productName,"  ",Re.measurement]}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:["C$ ",P(Re.price).toFixed(2)]}),i.jsxs("td",{className:"p-2 border",children:[i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:Re.specialPrice===0?"":Re.specialPrice,onKeyDown:Z,onChange:We=>Q(Re.productId,We.target.value),placeholder:"",title:"Precio especial (si se deja vaco, se usa el precio normal)"}),i.jsxs("div",{className:"text-[11px] text-gray-500 mt-1",children:["Aplicado: C$ ",P(Te).toFixed(2)]})]}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:je.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:Fe?1:.01,inputMode:Fe?"numeric":"decimal",className:"w-28 border p-1 rounded text-right",value:Re.qtyInput??(Re.qty===0?"":Re.qty),onKeyDown:Z,onChange:We=>ve(Re.productId,We.target.value),placeholder:"0",title:"Cantidad"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:1,min:0,className:"w-24 border p-1 rounded text-right",value:Re.discount===0?"":Re.discount,onChange:We=>Xe(Re.productId,We.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento (entero C$)"})}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:["C$ ",P(dt).toFixed(2)]}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 text-red-600 hover:bg-red-200",onClick:()=>V(Re.productId),title:"Quitar",children:""})})]},Re.productId)})})]})}),i.jsxs("div",{className:"space-y-1 ",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 ",children:" Monto total"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl bg-gray-100",value:`C$ ${v.toFixed(2)}`,readOnly:!0,title:"Suma de (precio aplicado  cantidad  descuento) de cada producto."})]}),de==="CONTADO"&&i.jsx(i.Fragment,{children:i.jsxs("div",{className:"grid grid-cols-2 gap-x-3",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Monto recibido"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:b===0?"":b,onChange:Re=>w(Number(Re.target.value||0))})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cambio"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl bg-gray-100",value:`C$ ${I}`,readOnly:!0})]})]})}),i.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white px-4 py-3 sm:py-2 rounded-2xl shadow-2xl font-semibold shadow hover:bg-blue-700 transition disabled:opacity-50",disabled:p.length===0||E,children:E?"Guardando...":"Guardar venta"}),N&&i.jsx("p",{className:`text-sm mt-2 ${N.startsWith("")?"text-green-600":N.startsWith("")?"text-yellow-600":"text-red-600"}`,children:N})]}),E&&i.jsx("div",{className:"fixed inset-0 bg-black/40 z-[60] flex items-center justify-center",children:i.jsx("div",{className:"bg-white rounded-lg shadow-xl border px-6 py-5",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-semibold",children:"Guardando venta"})]})})})]})}function sne(t,e,r,n,a){n=n||{};var s=1.15,o=a.internal.scaleFactor,l=a.internal.getFontSize()/o,c=a.getLineHeightFactor?a.getLineHeightFactor():s,d=l*c,u=/\r\n|\r|\n/g,f="",A=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(f=typeof t=="string"?t.split(u):t,A=f.length||1),r+=l*(2-s),n.valign==="middle"?r-=A/2*d:n.valign==="bottom"&&(r-=A*d),n.halign==="center"||n.halign==="right"){var h=l;if(n.halign==="center"&&(h*=.5),f&&A>=1){for(var m=0;m<f.length;m++)a.text(f[m],e-a.getStringUnitWidth(f[m])*h,r),r+=d;return a}e-=a.getStringUnitWidth(t)*h}return n.halign==="justify"?a.text(t,e,r,{maxWidth:n.maxWidth||100,align:"justify"}):a.text(t,e,r),a}var dH={},xv=function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:dH=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var n,a,s;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var o=this.jsPDFDocument.internal.getFont(),l=o.fontStyle,c=o.fontName;if(e.font&&(c=e.font),e.fontStyle){l=e.fontStyle;var d=this.getFontList()[c];d&&d.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(d[0]),l=d[0])}if(this.jsPDFDocument.setFont(c,l),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var u=t.unifyColor(e.fillColor);u&&(n=this.jsPDFDocument).setFillColor.apply(n,u),u=t.unifyColor(e.textColor),u&&(a=this.jsPDFDocument).setTextColor.apply(a,u),u=t.unifyColor(e.lineColor),u&&(s=this.jsPDFDocument).setDrawColor.apply(s,u),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,n){return this.jsPDFDocument.splitTextToSize(e,r,n)},t.prototype.rect=function(e,r,n,a,s){return this.jsPDFDocument.rect(e,r,n,a,s)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return dH||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t}(),tF=function(t,e){return tF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},tF(t,e)};function ine(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");tF(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var one=function(t){ine(e,t);function e(r){var n=t.call(this)||this;return n._element=r,n}return e}(Array);function r3e(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function n3e(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function $S(t,e,r){r.applyStyles(e,!0);var n=Array.isArray(t)?t:[t],a=n.map(function(s){return r.getTextWidth(s)}).reduce(function(s,o){return Math.max(s,o)},0);return a}function lne(t,e,r,n){var a=e.settings.tableLineWidth,s=e.settings.tableLineColor;t.applyStyles({lineWidth:a,lineColor:s});var o=cne(a,!1);o&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),n.y-r.y,o)}function cne(t,e){var r=t>0,n=e||e===0;return r&&n?"DF":r?"S":n?"F":null}function AP(t,e){var r,n,a,s;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(n=t.top)!==null&&n!==void 0?n:e,right:(a=t.right)!==null&&a!==void 0?a:e,bottom:(s=t.bottom)!==null&&s!==void 0?s:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function dne(t,e){var r=AP(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function a3e(t,e,r,n,a){var s={},o=1.3333333333333333,l=j5(e,function(b){return a.getComputedStyle(b).backgroundColor});l!=null&&(s.fillColor=l);var c=j5(e,function(b){return a.getComputedStyle(b).color});c!=null&&(s.textColor=c);var d=i3e(n,r);d&&(s.cellPadding=d);var u="borderTopColor",f=o*r,A=n.borderTopWidth;if(n.borderBottomWidth===A&&n.borderRightWidth===A&&n.borderLeftWidth===A){var h=(parseFloat(A)||0)/f;h&&(s.lineWidth=h)}else s.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/f,right:(parseFloat(n.borderRightWidth)||0)/f,bottom:(parseFloat(n.borderBottomWidth)||0)/f,left:(parseFloat(n.borderLeftWidth)||0)/f},s.lineWidth.top||(s.lineWidth.right?u="borderRightColor":s.lineWidth.bottom?u="borderBottomColor":s.lineWidth.left&&(u="borderLeftColor"));var m=j5(e,function(b){return a.getComputedStyle(b)[u]});m!=null&&(s.lineColor=m);var p=["left","right","center","justify"];p.indexOf(n.textAlign)!==-1&&(s.halign=n.textAlign),p=["middle","bottom","top"],p.indexOf(n.verticalAlign)!==-1&&(s.valign=n.verticalAlign);var x=parseInt(n.fontSize||"");isNaN(x)||(s.fontSize=x/o);var v=s3e(n);v&&(s.fontStyle=v);var y=(n.fontFamily||"").toLowerCase();return t.indexOf(y)!==-1&&(s.font=y),s}function s3e(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function j5(t,e){var r=une(t,e);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var a=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],s=parseInt(n[4]);return s===0||isNaN(a[0])||isNaN(a[1])||isNaN(a[2])?null:a}function une(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:une(t.parentElement,e):r}function i3e(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],n=96/(72/e),a=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,s=r.map(function(l){return parseInt(l||"0")/n}),o=AP(s,0);return a>o.top&&(o.top=a),a>o.bottom&&(o.bottom=a),o}function fne(t,e,r,n,a){var s,o;n===void 0&&(n=!1),a===void 0&&(a=!1);var l;typeof e=="string"?l=r.document.querySelector(e):l=e;var c=Object.keys(t.getFontList()),d=t.scaleFactor(),u=[],f=[],A=[];if(!l)return console.error("Html table could not be found with input: ",e),{head:u,body:f,foot:A};for(var h=0;h<l.rows.length;h++){var m=l.rows[h],p=(o=(s=m==null?void 0:m.parentElement)===null||s===void 0?void 0:s.tagName)===null||o===void 0?void 0:o.toLowerCase(),x=o3e(c,d,r,m,n,a);x&&(p==="thead"?u.push(x):p==="tfoot"?A.push(x):f.push(x))}return{head:u,body:f,foot:A}}function o3e(t,e,r,n,a,s){for(var o=new one(n),l=0;l<n.cells.length;l++){var c=n.cells[l],d=r.getComputedStyle(c);if(a||d.display!=="none"){var u=void 0;s&&(u=a3e(t,c,e,d,r)),o.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:u,_element:c,content:l3e(c)})}}var f=r.getComputedStyle(n);if(o.length>0&&(a||f.display!=="none"))return o}function l3e(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function c3e(t,e,r){for(var n=0,a=[t,e,r];n<a.length;n++){var s=a[n];s&&typeof s!="object"&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&typeof s.startY!="number"&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}function eA(t,e,r,n,a){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(t),o=1;o<arguments.length;o++){var l=arguments[o];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(s[c]=l[c])}return s}function hne(t,e){var r=new xv(t),n=r.getDocumentOptions(),a=r.getGlobalOptions();c3e(a,n,e);var s=eA({},a,n,e),o;typeof window<"u"&&(o=window);var l=d3e(a,n,e),c=u3e(a,n,e),d=f3e(r,s),u=A3e(r,s,o);return{id:e.tableId,content:u,hooks:c,styles:l,settings:d}}function d3e(t,e,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},a=function(c){if(c==="columnStyles"){var d=t[c],u=e[c],f=r[c];n.columnStyles=eA({},d,u,f)}else{var A=[t,e,r],h=A.map(function(m){return m[c]||{}});n[c]=eA({},h[0],h[1],h[2])}},s=0,o=Object.keys(n);s<o.length;s++){var l=o[s];a(l)}return n}function u3e(t,e,r){for(var n=[t,e,r],a={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},s=0,o=n;s<o.length;s++){var l=o[s];l.didParseCell&&a.didParseCell.push(l.didParseCell),l.willDrawCell&&a.willDrawCell.push(l.willDrawCell),l.didDrawCell&&a.didDrawCell.push(l.didDrawCell),l.willDrawPage&&a.willDrawPage.push(l.willDrawPage),l.didDrawPage&&a.didDrawPage.push(l.didDrawPage)}return a}function f3e(t,e){var r,n,a,s,o,l,c,d,u,f,A,h,m=AP(e.margin,40/t.scaleFactor()),p=(r=h3e(t,e.startY))!==null&&r!==void 0?r:m.top,x;e.showFoot===!0?x="everyPage":e.showFoot===!1?x="never":x=(n=e.showFoot)!==null&&n!==void 0?n:"everyPage";var v;e.showHead===!0?v="everyPage":e.showHead===!1?v="never":v=(a=e.showHead)!==null&&a!==void 0?a:"everyPage";var y=(s=e.useCss)!==null&&s!==void 0?s:!1,b=e.theme||(y?"plain":"striped"),w=!!e.horizontalPageBreak,I=(o=e.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(l=e.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:y,theme:b,startY:p,margin:m,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(d=e.rowPageBreak)!==null&&d!==void 0?d:"auto",tableWidth:(u=e.tableWidth)!==null&&u!==void 0?u:"auto",showHead:v,showFoot:x,tableLineWidth:(f=e.tableLineWidth)!==null&&f!==void 0?f:0,tableLineColor:(A=e.tableLineColor)!==null&&A!==void 0?A:200,horizontalPageBreak:w,horizontalPageBreakRepeat:I,horizontalPageBreakBehaviour:(h=e.horizontalPageBreakBehaviour)!==null&&h!==void 0?h:"afterAllRows"}}function h3e(t,e){var r=t.getLastAutoTable(),n=t.scaleFactor(),a=t.pageNumber(),s=!1;if(r&&r.startPageNumber){var o=r.startPageNumber+r.pageNumber-1;s=o===a}return typeof e=="number"?e:(e==null||e===!1)&&s&&(r==null?void 0:r.finalY)!=null?r.finalY+20/n:null}function A3e(t,e,r){var n=e.head||[],a=e.body||[],s=e.foot||[];if(e.html){var o=e.includeHiddenHtml;if(r){var l=fne(t,e.html,r,o,e.useCss)||{};n=l.head||n,a=l.body||n,s=l.foot||n}else console.error("Cannot parse html in non browser environment")}var c=e.columns||m3e(n,a,s);return{columns:c,head:n,body:a,foot:s}}function m3e(t,e,r){var n=t[0]||e[0]||r[0]||[],a=[];return Object.keys(n).filter(function(s){return s!=="_element"}).forEach(function(s){var o=1,l;Array.isArray(n)?l=n[parseInt(s)]:l=n[s],typeof l=="object"&&!Array.isArray(l)&&(o=(l==null?void 0:l.colSpan)||1);for(var c=0;c<o;c++){var d=void 0;Array.isArray(n)?d=a.length:d=s+(c>0?"_".concat(c):"");var u={dataKey:d};a.push(u)}}),a}var rF=function(){function t(e,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=e.getDocument()}return t}(),p3e=function(t){ine(e,t);function e(r,n,a,s,o,l){var c=t.call(this,r,n,l)||this;return c.cell=a,c.row=s,c.column=o,c.section=s.section,c}return e}(rF),g3e=function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,n,a,s,o){for(var l=0,c=r;l<c.length;l++){var d=c[l],u=new p3e(e,this,n,a,s,o),f=d(u)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],f)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var n=0,a=this.hooks.didDrawPage;n<a.length;n++){var s=a[n];s(new rF(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var n=0,a=this.hooks.willDrawPage;n<a.length;n++){var s=a[n];s(new rF(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(a,s){return a+s.wrappedWidth},0);return r}else{var n=this.settings.margin;return e-n.left-n.right}},t}(),Ane=function(){function t(e,r,n,a,s){s===void 0&&(s=!1),this.height=0,this.raw=e,e instanceof one&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=n,this.cells=a,this.spansMultiplePages=s}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(n,a){var s;return Math.max(n,((s=r.cells[a.index])===null||s===void 0?void 0:s.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(n){var a=r.cells[n.index];return a?a.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var n=this;return e.reduce(function(a,s){var o=n.cells[s.index];if(!o)return 0;var l=r.getLineHeight(o.styles.fontSize),c=o.padding("vertical"),d=c+l;return d>a?d:a},0)},t}(),mne=function(){function t(e,r,n){var a;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=e;var s=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,s=(a=e.content)!==null&&a!==void 0?a:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var o=s!=null?""+s:"",l=/\r\n|\r|\n/g;this.text=o.split(l)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var a=this.width-this.padding("horizontal");n=this.x+a/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,a=this.styles.fontSize/e*r,s=n*a+this.padding("vertical");return Math.max(s,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=AP(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t}(),x3e=function(){function t(e,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=n}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,n=0,a=e.allRows();n<a.length;n++){var s=a[n],o=s.cells[this.index];o&&typeof o.styles.cellWidth=="number"&&(r=Math.max(r,o.styles.cellWidth))}return r},t}();function v3e(t,e){y3e(t,e);var r=[],n=0;e.columns.forEach(function(s){var o=s.getMaxCustomCellWidth(e);o?s.width=o:(s.width=s.wrappedWidth,r.push(s)),n+=s.width});var a=e.getWidth(t.pageSize().width)-n;a&&(a=nF(r,a,function(s){return Math.max(s.minReadableWidth,s.minWidth)})),a&&(a=nF(r,a,function(s){return s.minWidth})),a=Math.abs(a),!e.settings.horizontalPageBreak&&a>.1/t.scaleFactor()&&(a=a<1?a:Math.round(a),console.warn("Of the table content, ".concat(a," units width could not fit page"))),w3e(e),N3e(e,t),b3e(e)}function y3e(t,e){var r=t.scaleFactor(),n=e.settings.horizontalPageBreak,a=dne(t,e);e.allRows().forEach(function(s){for(var o=0,l=e.columns;o<l.length;o++){var c=l[o],d=s.cells[c.index];if(d){var u=e.hooks.didParseCell;e.callCellHooks(t,u,d,s,c,null);var f=d.padding("horizontal");d.contentWidth=$S(d.text,d.styles,t)+f;var A=$S(d.text.join(" ").split(/[^\S\u00A0]+/),d.styles,t);if(d.minReadableWidth=A+d.padding("horizontal"),typeof d.styles.cellWidth=="number")d.minWidth=d.styles.cellWidth,d.wrappedWidth=d.styles.cellWidth;else if(d.styles.cellWidth==="wrap"||n===!0)d.contentWidth>a?(d.minWidth=a,d.wrappedWidth=a):(d.minWidth=d.contentWidth,d.wrappedWidth=d.contentWidth);else{var h=10/r;d.minWidth=d.styles.minCellWidth||h,d.wrappedWidth=d.contentWidth,d.minWidth>d.wrappedWidth&&(d.wrappedWidth=d.minWidth)}}}}),e.allRows().forEach(function(s){for(var o=0,l=e.columns;o<l.length;o++){var c=l[o],d=s.cells[c.index];if(d&&d.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,d.wrappedWidth),c.minWidth=Math.max(c.minWidth,d.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,d.minReadableWidth);else{var u=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},f=u.cellWidth||u.minCellWidth;f&&typeof f=="number"&&(c.minWidth=f,c.wrappedWidth=f)}d&&(d.colSpan>1&&!c.minWidth&&(c.minWidth=d.minWidth),d.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=d.minWidth))}})}function nF(t,e,r){for(var n=e,a=t.reduce(function(h,m){return h+m.wrappedWidth},0),s=0;s<t.length;s++){var o=t[s],l=o.wrappedWidth/a,c=n*l,d=o.width+c,u=r(o),f=d<u?u:d;e-=f-o.width,o.width=f}if(e=Math.round(e*1e10)/1e10,e){var A=t.filter(function(h){return e<0?h.width>r(h):!0});A.length&&(e=nF(A,e,r))}return e}function b3e(t){for(var e={},r=1,n=t.allRows(),a=0;a<n.length;a++)for(var s=n[a],o=0,l=t.columns;o<l.length;o++){var c=l[o],d=e[c.index];if(r>1)r--,delete s.cells[c.index];else if(d)d.cell.height+=s.height,r=d.cell.colSpan,delete s.cells[c.index],d.left--,d.left<=1&&delete e[c.index];else{var u=s.cells[c.index];if(!u)continue;if(u.height=s.height,u.rowSpan>1){var f=n.length-a,A=u.rowSpan>f?f:u.rowSpan;e[c.index]={cell:u,left:A,row:s}}}}}function w3e(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var n=e[r],a=null,s=0,o=0,l=0;l<t.columns.length;l++){var c=t.columns[l];if(o-=1,o>1&&t.columns[l+1])s+=c.width,delete n.cells[c.index];else if(a){var d=a;delete n.cells[c.index],a=null,d.width=c.width+s}else{var d=n.cells[c.index];if(!d)continue;if(o=d.colSpan,s=0,d.colSpan>1){a=d,s+=c.width;continue}d.width=c.width+s}}}function N3e(t,e){for(var r={count:0,height:0},n=0,a=t.allRows();n<a.length;n++){for(var s=a[n],o=0,l=t.columns;o<l.length;o++){var c=l[o],d=s.cells[c.index];if(d){e.applyStyles(d.styles,!0);var u=d.width-d.padding("horizontal");if(d.styles.overflow==="linebreak")d.text=e.splitTextToSize(d.text,u+1/e.scaleFactor(),{fontSize:d.styles.fontSize});else if(d.styles.overflow==="ellipsize")d.text=uH(d.text,u,d.styles,e,"...");else if(d.styles.overflow==="hidden")d.text=uH(d.text,u,d.styles,e,"");else if(typeof d.styles.overflow=="function"){var f=d.styles.overflow(d.text,u);typeof f=="string"?d.text=[f]:d.text=f}d.contentHeight=d.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var A=d.contentHeight/d.rowSpan;d.rowSpan>1&&r.count*r.height<A*d.rowSpan?r={height:A,count:d.rowSpan}:r&&r.count>0&&r.height>A&&(A=r.height),A>s.height&&(s.height=A)}}r.count--}}function uH(t,e,r,n,a){return t.map(function(s){return C3e(s,e,r,n,a)})}function C3e(t,e,r,n,a){var s=1e4*n.scaleFactor();if(e=Math.ceil(e*s)/s,e>=$S(t,r,n))return t;for(;e<$S(t+a,r,n)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+a}function pne(t,e){var r=new xv(t),n=_3e(e,r.scaleFactor()),a=new g3e(e,n);return v3e(r,a),r.applyStyles(r.userStyles),a}function _3e(t,e){var r=t.content,n=S3e(r.columns);if(r.head.length===0){var a=fH(n,"head");a&&r.head.push(a)}if(r.foot.length===0){var a=fH(n,"foot");a&&r.foot.push(a)}var s=t.settings.theme,o=t.styles;return{columns:n,head:I5("head",r.head,n,o,s,e),body:I5("body",r.body,n,o,s,e),foot:I5("foot",r.foot,n,o,s,e)}}function I5(t,e,r,n,a,s){var o={},l=e.map(function(c,d){for(var u=0,f={},A=0,h=0,m=0,p=r;m<p.length;m++){var x=p[m];if(o[x.index]==null||o[x.index].left===0)if(h===0){var v=void 0;Array.isArray(c)?v=c[x.index-A-u]:v=c[x.dataKey];var y={};typeof v=="object"&&!Array.isArray(v)&&(y=(v==null?void 0:v.styles)||{});var b=j3e(t,x,d,a,n,s,y),w=new mne(v,b,t);f[x.dataKey]=w,f[x.index]=w,h=w.colSpan-1,o[x.index]={left:w.rowSpan-1,times:h}}else h--,A++;else o[x.index].left--,h=o[x.index].times,u++}return new Ane(c,d,t,f)});return l}function fH(t,e){var r={};return t.forEach(function(n){if(n.raw!=null){var a=E3e(e,n.raw);a!=null&&(r[n.dataKey]=a)}}),Object.keys(r).length>0?r:null}function E3e(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function S3e(t){return t.map(function(e,r){var n,a;return typeof e=="object"?a=(n=e.dataKey)!==null&&n!==void 0?n:r:a=r,new x3e(a,e,r)})}function j3e(t,e,r,n,a,s,o){var l=n3e(n),c;t==="head"?c=a.headStyles:t==="body"?c=a.bodyStyles:t==="foot"&&(c=a.footStyles);var d=eA({},l.table,l[t],a.styles,c),u=a.columnStyles[e.dataKey]||a.columnStyles[e.index]||{},f=t==="body"?u:{},A=t==="body"&&r%2===0?eA({},l.alternateRow,a.alternateRowStyles):{},h=r3e(s),m=eA({},h,d,A,f);return eA(m,o)}function I3e(t,e,r){var n;r===void 0&&(r={});var a=dne(t,e),s=new Map,o=[],l=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(A){var h=e.columns.find(function(m){return m.dataKey===A||m.index===A});h&&!s.has(h.index)&&(s.set(h.index,!0),o.push(h.index),l.push(e.columns[h.index]),a-=h.wrappedWidth)});for(var d=!0,u=(n=r==null?void 0:r.start)!==null&&n!==void 0?n:0;u<e.columns.length;){if(s.has(u)){u++;continue}var f=e.columns[u].wrappedWidth;if(d||a>=f)d=!1,o.push(u),l.push(e.columns[u]),a-=f;else break;u++}return{colIndexes:o,columns:l,lastIndex:u-1}}function P3e(t,e){for(var r=[],n=0;n<e.columns.length;n++){var a=I3e(t,e,{start:n});a.columns.length&&(r.push(a),n=a.lastIndex)}return r}function gne(t,e){var r=e.settings,n=r.startY,a=r.margin,s={x:a.left,y:n},o=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),l=n+a.bottom+o;if(r.pageBreak==="avoid"){var c=e.body,d=c.reduce(function(A,h){return A+h.height},0);l+=d}var u=new xv(t);(r.pageBreak==="always"||r.startY!=null&&l>u.pageSize().height)&&(vne(u),s.y=a.top),e.callWillDrawPageHooks(u,s);var f=eA({},s);e.startPageNumber=u.pageNumber(),r.horizontalPageBreak?T3e(u,e,f,s):(u.applyStyles(u.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(A){return CA(u,e,A,s,e.columns)}),u.applyStyles(u.userStyles),e.body.forEach(function(A,h){var m=h===e.body.length-1;GS(u,e,A,m,f,s,e.columns)}),u.applyStyles(u.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(A){return CA(u,e,A,s,e.columns)})),lne(u,e,f,s),e.callEndPageHooks(u,s),e.finalY=s.y,t.lastAutoTable=e,u.applyStyles(u.userStyles)}function T3e(t,e,r,n){var a=P3e(t,e),s=e.settings;if(s.horizontalPageBreakBehaviour==="afterAllRows")a.forEach(function(d,u){t.applyStyles(t.userStyles),u>0?Mb(t,e,r,n,d.columns,!0):hH(t,e,n,d.columns),B3e(t,e,r,n,d.columns),P5(t,e,n,d.columns)});else for(var o=-1,l=a[0],c=function(){var d=o;if(l){t.applyStyles(t.userStyles);var u=l.columns;o>=0?Mb(t,e,r,n,u,!0):hH(t,e,n,u),d=AH(t,e,o+1,n,u),P5(t,e,n,u)}var f=d-o;a.slice(1).forEach(function(A){t.applyStyles(t.userStyles),Mb(t,e,r,n,A.columns,!0),AH(t,e,o+1,n,A.columns,f),P5(t,e,n,A.columns)}),o=d};o<e.body.length-1;)c()}function hH(t,e,r,n){var a=e.settings;t.applyStyles(t.userStyles),(a.showHead==="firstPage"||a.showHead==="everyPage")&&e.head.forEach(function(s){return CA(t,e,s,r,n)})}function B3e(t,e,r,n,a){t.applyStyles(t.userStyles),e.body.forEach(function(s,o){var l=o===e.body.length-1;GS(t,e,s,l,r,n,a)})}function AH(t,e,r,n,a,s){t.applyStyles(t.userStyles),s=s??e.body.length;var o=Math.min(r+s,e.body.length),l=-1;return e.body.slice(r,o).forEach(function(c,d){var u=r+d===e.body.length-1,f=xne(t,e,u,n);c.canEntireRowFit(f,a)&&(CA(t,e,c,n,a),l=r+d)}),l}function P5(t,e,r,n){var a=e.settings;t.applyStyles(t.userStyles),(a.showFoot==="lastPage"||a.showFoot==="everyPage")&&e.foot.forEach(function(s){return CA(t,e,s,r,n)})}function k3e(t,e,r){var n=r.getLineHeight(t.styles.fontSize),a=t.padding("vertical"),s=Math.floor((e-a)/n);return Math.max(0,s)}function F3e(t,e,r,n){var a={};t.spansMultiplePages=!0,t.height=0;for(var s=0,o=0,l=r.columns;o<l.length;o++){var c=l[o],d=t.cells[c.index];if(d){Array.isArray(d.text)||(d.text=[d.text]);var u=new mne(d.raw,d.styles,d.section);u=eA(u,d),u.text=[];var f=k3e(d,e,n);d.text.length>f&&(u.text=d.text.splice(f,d.text.length));var A=n.scaleFactor(),h=n.getLineHeightFactor();d.contentHeight=d.getContentHeight(A,h),d.contentHeight>=e&&(d.contentHeight=e,u.styles.minCellHeight-=e),d.contentHeight>t.height&&(t.height=d.contentHeight),u.contentHeight=u.getContentHeight(A,h),u.contentHeight>s&&(s=u.contentHeight),a[c.index]=u}}var m=new Ane(t.raw,-1,t.section,a,!0);m.height=s;for(var p=0,x=r.columns;p<x.length;p++){var c=x[p],u=m.cells[c.index];u&&(u.height=m.height);var d=t.cells[c.index];d&&(d.height=t.height)}return m}function O3e(t,e,r,n){var a=t.pageSize().height,s=n.settings.margin,o=s.top+s.bottom,l=a-o;e.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=e.getMinimumRowHeight(n.columns,t),d=c<r;if(c>l)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!d)return!1;var u=e.hasRowSpan(n.columns),f=e.getMaxCellHeight(n.columns)>l;return f?(u&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(u||n.settings.rowPageBreak==="avoid")}function GS(t,e,r,n,a,s,o){var l=xne(t,e,n,s);if(r.canEntireRowFit(l,o))CA(t,e,r,s,o);else if(O3e(t,r,l,e)){var c=F3e(r,l,e,t);CA(t,e,r,s,o),Mb(t,e,a,s,o),GS(t,e,c,n,a,s,o)}else Mb(t,e,a,s,o),GS(t,e,r,n,a,s,o)}function CA(t,e,r,n,a){n.x=e.settings.margin.left;for(var s=0,o=a;s<o.length;s++){var l=o[s],c=r.cells[l.index];if(!c){n.x+=l.width;continue}t.applyStyles(c.styles),c.x=n.x,c.y=n.y;var d=e.callCellHooks(t,e.hooks.willDrawCell,c,r,l,n);if(d===!1){n.x+=l.width;continue}D3e(t,c,n);var u=c.getTextPos();sne(c.text,u.x,u.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,c,r,l,n),n.x+=l.width}n.y+=r.height}function D3e(t,e,r){var n=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof n.lineWidth=="number"){var a=cne(n.lineWidth,n.fillColor);a&&t.rect(e.x,r.y,e.width,e.height,a)}else typeof n.lineWidth=="object"&&(n.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),R3e(t,e,r,n.lineWidth))}function R3e(t,e,r,n){var a,s,o,l;n.top&&(a=r.x,s=r.y,o=r.x+e.width,l=r.y,n.right&&(o+=.5*n.right),n.left&&(a-=.5*n.left),c(n.top,a,s,o,l)),n.bottom&&(a=r.x,s=r.y+e.height,o=r.x+e.width,l=r.y+e.height,n.right&&(o+=.5*n.right),n.left&&(a-=.5*n.left),c(n.bottom,a,s,o,l)),n.left&&(a=r.x,s=r.y,o=r.x,l=r.y+e.height,n.top&&(s-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.left,a,s,o,l)),n.right&&(a=r.x+e.width,s=r.y,o=r.x+e.width,l=r.y+e.height,n.top&&(s-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.right,a,s,o,l));function c(d,u,f,A,h){t.getDocument().setLineWidth(d),t.getDocument().line(u,f,A,h,"S")}}function xne(t,e,r,n){var a=e.settings.margin.bottom,s=e.settings.showFoot;return(s==="everyPage"||s==="lastPage"&&r)&&(a+=e.getFootHeight(e.columns)),t.pageSize().height-n.y-a}function Mb(t,e,r,n,a,s){a===void 0&&(a=[]),s===void 0&&(s=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!s&&e.foot.forEach(function(l){return CA(t,e,l,n,a)}),e.callEndPageHooks(t,n);var o=e.settings.margin;lne(t,e,r,n),vne(t),e.pageNumber++,n.x=o.left,n.y=o.top,r.y=o.top,e.callWillDrawPageHooks(t,n),e.settings.showHead==="everyPage"&&(e.head.forEach(function(l){return CA(t,e,l,n,a)}),t.applyStyles(t.userStyles))}function vne(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function M3e(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e[0],a=hne(this,n),s=pne(this,a);return gne(this,s),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,n,a){sne(e,r,n,a,this)},t.API.autoTableSetDefaults=function(e){return xv.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){xv.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var a=new xv(this),s=fne(a,e,window,r,!1),o=s.head,l=s.body,c=((n=o[0])===null||n===void 0?void 0:n.map(function(d){return d.content}))||[];return{columns:c,rows:l,data:l}}}var T5;function $0(t,e){var r=hne(t,e),n=pne(t,r);gne(t,n)}try{if(typeof window<"u"&&window){var mH=window,pH=mH.jsPDF||((T5=mH.jspdf)===null||T5===void 0?void 0:T5.jsPDF);pH&&M3e(pH)}}catch(t){console.error("Could not apply autoTable plugin",t)}const os=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function B5(t="LOT"){return`${t}-${Date.now()}-${Math.random().toString(16).slice(2)}`}function L3e({role:t="",roles:e,sellerCandyId:r="",currentUserEmail:n}){const[a,s]=g.useState([]),[o,l]=g.useState([]),[c,d]=g.useState(!0),[u,f]=g.useState(""),{refreshKey:A,refresh:h}=bc(),m=e&&e.length?e:t,p=Rn(m,"admin"),x=p||Rn(m,"contador"),[v,y]=g.useState(Kr(Gu(new Date),"yyyy-MM-dd")),[b,w]=g.useState(Kr($u(new Date),"yyyy-MM-dd")),[I,j]=g.useState(""),[N,S]=g.useState(!1),[E,B]=g.useState(""),[k,T]=g.useState(Kr(new Date,"yyyy-MM-dd")),[P,q]=g.useState("lb"),[de,ce]=g.useState(""),[le,he]=g.useState(0),[ae,Ce]=g.useState(NaN),[De,O]=g.useState(0),[R,G]=g.useState([]),[M,K]=g.useState(null),[Y,D]=g.useState([]),[V,te]=g.useState(!1),[ve,Q]=g.useState(null),[Xe,se]=g.useState(!1),[Z,ke]=g.useState(null),[Se,Ee]=g.useState(null),Ze=be=>Ee(Ae=>Ae===be?null:be),[ot,vt]=g.useState(!1),_t=()=>vt(be=>!be),[Tt,Lt]=g.useState("all"),[Rt,Et]=g.useState({}),Re=be=>Et(Ae=>({...Ae,[be]:!(Ae[be]??!1)})),Te=(be,Ae)=>{const Le=[];return be>0&&Le.push(`${be.toFixed(3)} lb`),Ae>0&&Le.push(`${Ae.toFixed(3)} un`),Le.length===0?"0":Le.join("  ")},Ye=be=>{const Ae=(be||"").toLowerCase();return/(^|\s)(lb|lbs|libra|libras)(\s|$)/.test(Ae)||Ae==="lb"};g.useEffect(()=>{(async()=>{d(!0),f("");const be=await Ut(xt(Ne,"products")),Ae=[];be.forEach(st=>{const z=st.data();z.active===!0&&Ae.push({id:st.id,name:z.name??z.productName??"(sin nombre)",category:z.category??"(sin categora)",measurement:z.measurement??"lb",price:Number(z.price??0),providerPrice:Object.prototype.hasOwnProperty.call(z,"providerPrice")?Number(z.providerPrice):void 0})}),s(Ae);const Le=ar(xt(Ne,"inventory_batches"),kn("date","desc")),ut=await Ut(Le),ct=[];ut.forEach(st=>{const z=st.data(),X=Ps(Number(z.quantity||0)),re=Number(z.purchasePrice||0),H=Number(z.salePrice||0),L=Number((X*re).toFixed(2)),ue=Number((X*H).toFixed(2));ct.push({id:st.id,productId:z.productId,productName:z.productName,category:z.category,unit:z.unit,quantity:X,remaining:Ps(Number(z.remaining||0)),purchasePrice:re,salePrice:H,invoiceTotal:z.invoiceTotal!=null?Number(z.invoiceTotal):L,expectedTotal:z.expectedTotal!=null?Number(z.expectedTotal):ue,date:z.date,createdAt:z.createdAt,status:z.status,notes:z.notes,paidAmount:Number(z.paidAmount||0),paidAt:z.paidAt,batchGroupId:z.batchGroupId,orderName:z.orderName})}),l(ct),d(!1)})()},[A]);const dt=g.useMemo(()=>o.filter(be=>!(v&&be.date<v||b&&be.date>b||I&&be.productId!==I)),[o,v,b,I]),Fe=g.useMemo(()=>{if(!I)return"Todos";const be=a.find(Ae=>Ae.id===I);return be?`${be.name}  ${be.category}`:"Filtro activo"},[I,a]),je=g.useMemo(()=>{const be=dt.reduce((re,H)=>re+Number(H.invoiceTotal||0),0),Ae=dt.reduce((re,H)=>re+Number(H.expectedTotal||0),0);let Le=0,ut=0,ct=0,st=0;for(const re of dt)Ye(re.unit)?(Le+=re.quantity,ut+=re.remaining):(ct+=re.quantity,st+=re.remaining);const z=dt.reduce((re,H)=>re+H.quantity,0),X=dt.reduce((re,H)=>re+H.remaining,0);return{lbsIng:Le,lbsRem:ut,udsIng:ct,udsRem:st,qty:z,rem:X,totalFacturado:be,totalEsperado:Ae}},[dt]),We=g.useMemo(()=>{var Le,ut;const be=new Map;for(const ct of dt){const st=ct.batchGroupId&&String(ct.batchGroupId).trim()||ct.id;be.has(st)||be.set(st,[]),be.get(st).push(ct)}const Ae=[];for(const[ct,st]of be.entries()){const z=[...st].sort((Ue,tt)=>{var Bt,tr;const nt=((Bt=Ue.createdAt)==null?void 0:Bt.seconds)??0;return(((tr=tt.createdAt)==null?void 0:tr.seconds)??0)-nt}),X=((Le=z[0])==null?void 0:Le.date)||"",re=String(((ut=z[0])==null?void 0:ut.orderName)||"").trim()||`Pedido ${X||""}`.trim()||"Pedido",H=new Set(z.map(Ue=>String(Ue.category||"").trim()).filter(Boolean)),L=H.size===1?Array.from(H)[0].toUpperCase():"MIXTO",ue=z.some(Ue=>Ue.status==="PENDIENTE")?"PENDIENTE":"PAGADO",Pe=Ps(z.reduce((Ue,tt)=>Ue+(Ye(tt.unit)?Number(tt.quantity||0):0),0)),xe=Ps(z.reduce((Ue,tt)=>Ue+(Ye(tt.unit)?Number(tt.remaining||0):0),0)),Ge=Ps(z.reduce((Ue,tt)=>Ue+(Ye(tt.unit)?0:Number(tt.quantity||0)),0)),ze=Ps(z.reduce((Ue,tt)=>Ue+(Ye(tt.unit)?0:Number(tt.remaining||0)),0)),Ke=Number(z.reduce((Ue,tt)=>Ue+Number(tt.invoiceTotal||0),0).toFixed(2)),pt=Number(z.reduce((Ue,tt)=>Ue+Number(tt.expectedTotal||0),0).toFixed(2)),ne=Number((pt-Ke).toFixed(2));Ae.push({groupId:ct,orderName:re,date:X,typeLabel:L,status:ue,lbsIn:Pe,lbsRem:xe,udsIn:Ge,udsRem:ze,totalFacturado:Ke,totalEsperado:pt,utilidadBruta:ne,items:z})}return Ae.sort((ct,st)=>ct.date===st.date?ct.groupId<st.groupId?1:-1:ct.date<st.date?1:-1),Ae},[dt]),ee=g.useMemo(()=>Tt==="all"?We:We.filter(be=>{const Ae=be.lbsRem>0||be.udsRem>0;return Tt==="with"?Ae:!Ae}),[We,Tt]),Ve=g.useMemo(()=>{const be=new Map;return ee.forEach(Ae=>{const Le=Ae.typeLabel||"MIXTO";be.has(Le)||be.set(Le,[]),be.get(Le).push(Ae)}),Array.from(be.entries()).map(([Ae,Le])=>({type:Ae,items:Le}))},[ee]),rt=g.useMemo(()=>{const be=String(P||"").toLowerCase().trim();return a.filter(Le=>String(Le.measurement||"").toLowerCase().trim()===be).sort((Le,ut)=>Le.name.localeCompare(ut.name,"es"))},[a,P]);g.useEffect(()=>{const be=R.find(Le=>Le.productId===de);if(be){he(Number(be.quantity||0)),Ce(Number(be.purchasePrice||0)),O(Number(be.salePrice||0));return}const Ae=a.find(Le=>Le.id===de);Ae?(he(0),O(Number(Ae.price||0)),Ae.providerPrice!=null&&Number.isFinite(Number(Ae.providerPrice))?Ce(Number(Ae.providerPrice)):Ce(NaN)):(he(0),O(0),Ce(NaN))},[de,a,A,R]);const $e=()=>{f("");const be=a.find(X=>X.id===de);if(!be)return f("Selecciona un producto.");if(le<=0||!Number.isFinite(ae)||ae<=0)return f("Completa libras a ingresar y precio proveedor.");const Ae=Ps(le),Le=be.measurement,ut=Number((Ae*Number(ae||0)).toFixed(2)),ct=Number((Ae*Number(De||0)).toFixed(2)),st=Number((ct-ut).toFixed(2)),z=R.findIndex(X=>X.productId===be.id);z>=0?G(X=>X.map((re,H)=>H!==z?re:{...re,quantity:Ae,remaining:Ae,purchasePrice:Number(ae||0),salePrice:Number(De||0),invoiceTotal:ut,expectedTotal:ct,utilidadBruta:st})):G(X=>[...X,{tempId:B5("IT"),productId:be.id,productName:be.name,category:be.category,unit:Le,quantity:Ae,remaining:Ae,purchasePrice:Number(ae||0),salePrice:Number(De||0),invoiceTotal:ut,expectedTotal:ct,utilidadBruta:st}]),ce(""),he(0),Ce(NaN),O(0)},ie=be=>{G(Ae=>Ae.filter(Le=>Le.tempId!==be))},pe=(be,Ae,Le)=>{G(ut=>ut.map(ct=>{if(ct.tempId!==be)return ct;const st={...ct};return Ae==="quantity"&&(st.quantity=Ps(Math.max(0,Le)),M||(st.remaining=st.quantity)),Ae==="purchasePrice"&&(st.purchasePrice=Math.max(0,Number(Le||0))),Ae==="salePrice"&&(st.salePrice=Math.max(0,Number(Le||0))),st.invoiceTotal=Number((st.quantity*st.purchasePrice).toFixed(2)),st.expectedTotal=Number((st.quantity*st.salePrice).toFixed(2)),st.utilidadBruta=Number((st.expectedTotal-st.invoiceTotal).toFixed(2)),st}))},fe=g.useMemo(()=>{const be=Ps(R.reduce((st,z)=>st+(Ye(z.unit)?Number(z.quantity||0):0),0)),Ae=Ps(R.reduce((st,z)=>st+(Ye(z.unit)?Number(z.remaining||0):0),0)),Le=Number(R.reduce((st,z)=>st+Number(z.invoiceTotal||0),0).toFixed(2)),ut=Number(R.reduce((st,z)=>st+Number(z.expectedTotal||0),0).toFixed(2)),ct=Number((ut-Le).toFixed(2));return{lbsIn:be,lbsRem:Ae,totalFacturado:Le,totalEsperado:ut,utilidadBruta:ct}},[R]),Me=()=>{K(null),D([]),B(""),T(Kr(new Date,"yyyy-MM-dd")),q("lb"),ce(""),he(0),Ce(NaN),O(0),G([])},me=async()=>{if(f(""),!R.length)return f("Agrega al menos un producto al pedido.");const be=k||Kr(new Date,"yyyy-MM-dd"),Ae=String(E||"").trim()||`Pedido ${be}`,Le=M||B5("BATCH");try{if(!M){for(const z of R)await nH({productId:z.productId,productName:z.productName,category:z.category,unit:z.unit,quantity:Ps(z.quantity),purchasePrice:Number(z.purchasePrice||0),salePrice:Number(z.salePrice||0),invoiceTotal:Number(z.invoiceTotal||0),expectedTotal:Number(z.expectedTotal||0),date:be,notes:"",batchGroupId:Le,orderName:Ae});f(" Pedido creado"),S(!1),Me(),h();return}const ut=Y,ct=new Map;for(const z of ut)ct.set(z.productId,z);const st=new Set(R.map(z=>z.productId));for(const z of R){const X=ct.get(z.productId),re=Ps(z.quantity);if(X){const H=Ps(X.quantity-X.remaining),L=Math.max(0,Ps(re-H));await Mn(Kt(Ne,"inventory_batches",X.id),{date:be,orderName:Ae,batchGroupId:Le,quantity:re,purchasePrice:Number(z.purchasePrice||0),salePrice:Number(z.salePrice||0),invoiceTotal:Number(z.invoiceTotal||0),expectedTotal:Number(z.expectedTotal||0),remaining:L})}else await nH({productId:z.productId,productName:z.productName,category:z.category,unit:z.unit,quantity:re,purchasePrice:Number(z.purchasePrice||0),salePrice:Number(z.salePrice||0),invoiceTotal:Number(z.invoiceTotal||0),expectedTotal:Number(z.expectedTotal||0),date:be,notes:"",batchGroupId:Le,orderName:Ae})}for(const z of ut)st.has(z.productId)||await na(Kt(Ne,"inventory_batches",z.id));f(" Pedido actualizado"),S(!1),Me(),h()}catch(ut){console.error(ut),f(" Error al guardar pedido")}},ye=be=>{Q(be),te(!0)},mt=be=>{K(be.groupId),D(be.items),B(be.orderName),T(be.date||Kr(new Date,"yyyy-MM-dd"));const Ae=be.items.map(Le=>{const ut=Number(Le.invoiceTotal||0),ct=Number(Le.expectedTotal||0);return{tempId:B5("IT"),productId:Le.productId,productName:Le.productName,category:Le.category,unit:Le.unit,quantity:Ps(Le.quantity),remaining:Ps(Le.remaining),purchasePrice:Number(Le.purchasePrice||0),salePrice:Number(Le.salePrice||0),invoiceTotal:ut,expectedTotal:ct,utilidadBruta:Number((ct-ut).toFixed(2))}});G(Ae),S(!0)},gt=async be=>{if(confirm(`Eliminar el pedido "${be.orderName}" del ${be.date}?`))try{for(const Le of be.items)await na(Kt(Ne,"inventory_batches",Le.id));f(" Pedido eliminado"),h()}catch(Le){console.error(Le),f(" Error al eliminar pedido")}},yt=be=>{ke(be),se(!0)},Pt=async()=>{if(Z)try{for(const be of Z.items){if(be.status!=="PENDIENTE")continue;await ene(be.id),await Mn(Kt(Ne,"inventory_batches",be.id),{remaining:0});const Ae={date:be.date,productName:be.productName,quantity:be.quantity,amount:Number((be.expectedTotal??be.salePrice*be.quantity).toFixed(2)),allocations:[{batchId:be.id,qty:be.quantity,unitCost:be.purchasePrice,lineCost:Number((be.purchasePrice*be.quantity).toFixed(2))}],avgUnitCost:be.purchasePrice,measurement:be.unit,createdAt:Nr.now(),autoGeneratedFromInventory:!0};await ta(xt(Ne,"salesV2"),Ae)}f(" Pedido pagado y reflejado como venta"),h()}catch(be){console.error(be),f(" Error al pagar pedido")}finally{se(!1),ke(null)}},Ft=()=>{se(!1),ke(null)},Oe=()=>{const be=new An({unit:"pt",format:"a4",orientation:"landscape"}),Ae="Inventario de Pollo",Le=`Rango: ${v||"(sin inicio)"} a ${b||"(sin fin)"}`,ut=`Producto: ${Fe}`,ct=X=>Number(X||0).toFixed(3);let st=40;be.setFontSize(16),be.text(Ae,40,st),st+=16,be.setFontSize(10),be.text(Le,40,st),st+=12,be.text(ut,40,st),st+=14;const z=()=>{var X;st=(X=be.lastAutoTable)!=null&&X.finalY?be.lastAutoTable.finalY+18:st+18};$0(be,{startY:st,head:[["KPI","Valor"]],body:[["Libras ingresadas",ct(je.lbsIng)],["Libras restantes",ct(je.lbsRem)],["Unidades ingresadas",ct(je.udsIng)],["Unidades restantes",ct(je.udsRem)],["Total esperado",os(je.totalEsperado)],["Total facturado",os(je.totalFacturado)],["Ganancia sin gastos",os(je.totalEsperado-je.totalFacturado)],["Cantidad de lotes",dt.length.toString()]],styles:{fontSize:9},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),z(),$0(be,{startY:st,head:[["Fecha","Pedido","Tipo","Lb In","Lb Rem","Ud In","Ud Rem","Facturado","Esperado","Utilidad","Estado"]],body:We.map(X=>[X.date,X.orderName,X.typeLabel,ct(X.lbsIn),ct(X.lbsRem),ct(X.udsIn),ct(X.udsRem),os(X.totalFacturado),os(X.totalEsperado),os(X.utilidadBruta),X.status]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),z(),We.forEach(X=>{be.setFontSize(11),be.text(`Pedido: ${X.orderName} (${X.date})  ${X.typeLabel}`,40,st),st+=12,$0(be,{startY:st,head:[["Producto","Unidad","Ingresado","Restante","Precio compra","Precio venta","Total facturado","Total esperado","Utilidad","Estado"]],body:X.items.map(re=>[re.productName,(re.unit||"").toUpperCase(),ct(re.quantity),ct(re.remaining),os(re.purchasePrice),os(re.salePrice),os(re.invoiceTotal||re.purchasePrice*re.quantity),os(re.expectedTotal||re.salePrice*re.quantity),os((re.expectedTotal||re.salePrice*re.quantity)-(re.invoiceTotal||re.purchasePrice*re.quantity)),re.status]),styles:{fontSize:8},headStyles:{fillColor:[230,230,230],textColor:[0,0,0]}}),z()}),be.save(`inventario_pollo_${v||"sin_desde"}_a_${b||"sin_hasta"}.pdf`)};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded-2xl bg-gray-900 text-white hover:bg-black",type:"button",onClick:Oe,disabled:c,children:"Exportar PDF"}),x&&i.jsx("button",{className:"px-3 py-2 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",type:"button",onClick:()=>{Me(),S(!0)},children:"Crear Lote"})]})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow-2xl border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:v,onChange:be=>y(be.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:b,onChange:be=>w(be.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:I,onChange:be=>j(be.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),a.map(be=>i.jsxs("option",{value:be.id,children:[be.name,"  ",be.category]},be.id))]})]}),i.jsx("button",{className:"px-3 rounded-2xl shadow-2xl py-1 bg-gray-200 hover:bg-gray-300",onClick:()=>{y(""),w(""),j("")},children:"Quitar filtro"}),i.jsx("div",{className:"ml-auto",children:i.jsx(yc,{onClick:()=>h(),loading:c})})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded-2xl shadow-2xl border mb-3 text-base",children:[i.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:_t,role:"button","aria-expanded":ot,children:[i.jsxs("div",{className:"flex gap-6 items-center",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",je.lbsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",je.lbsRem.toFixed(3)]})]}),i.jsx("div",{className:"text-sm text-gray-500",children:ot?"Cerrar":"Ver ms"})]}),ot&&i.jsx("div",{className:"mt-3",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",je.lbsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",je.lbsRem.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",je.udsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",je.udsRem.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ","C$ ",je.totalEsperado.toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," C$"," ",je.totalFacturado.toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," C$"," ",(je.totalEsperado-je.totalFacturado).toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes (por filtro):"})," ",dt.length.toLocaleString()]})]})})]}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsx("div",{className:"flex gap-2",children:[{key:"all",label:"Todos"},{key:"with",label:"Con disponibilidad"},{key:"without",label:"Sin disponibilidad"}].map(be=>{const Ae=Tt===be.key;return i.jsx("button",{type:"button",onClick:()=>Lt(be.key),className:`flex-1 px-3 py-2 rounded-xl text-sm font-semibold shadow ${Ae?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:be.label},be.key)})}),c?i.jsx("div",{className:"bg-white border rounded-2xl p-4 shadow",children:"Cargando"}):ee.length===0?i.jsx("div",{className:"bg-white border rounded-2xl p-4 shadow text-center",children:Tt==="with"?"Sin lotes con disponibilidad.":Tt==="without"?"Sin lotes sin disponibilidad.":"Sin lotes"}):Ve.map(({type:be,items:Ae})=>{const Le=Rt[be]??!1;return i.jsxs("div",{className:"bg-white border rounded-2xl",children:[i.jsxs("button",{type:"button",onClick:()=>Re(be),className:"w-full px-4 py-3 flex items-center justify-between text-left",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:be}),i.jsxs("div",{className:"text-xs text-gray-500",children:[Ae.length," ",Ae.length===1?"lote":"lotes"]})]}),i.jsx("span",{className:"text-xs text-gray-500",children:Le?"Cerrar":"Ver"})]}),Le&&i.jsx("div",{className:"space-y-3 px-2 pb-4",children:Ae.map(ut=>{const ct=Se===ut.groupId,st=ut.lbsRem>0||ut.udsRem>0;return i.jsxs("div",{className:"bg-gray-50 border rounded-2xl",children:[i.jsxs("div",{className:"p-4 flex items-start justify-between gap-3 cursor-pointer",onClick:()=>Ze(ut.groupId),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsxs("div",{className:"font-semibold text-lg",children:[ut.date,i.jsxs("div",{className:"text-sm text-gray-500",children:["Producto: ",ut.typeLabel]})]}),i.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["Nombre: ",ut.orderName]})]}),i.jsx("div",{className:"flex items-center gap-3",children:i.jsx("span",{className:`px-2 py-1 rounded text-xs shrink-0 ${ut.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:ut.status})})]}),i.jsxs("div",{className:"pb-4 p-4 flex items-start justify-between gap-1 cursor-pointer",children:[i.jsxs("div",{className:"px-2 py-1 rounded text-xs shrink-0 bg-green-100 font-semibold text-gray-700",children:["Ingresado: ",Te(ut.lbsIn,ut.udsIn)]}),i.jsxs("span",{className:`px-2 py-1 rounded text-xs shrink-0 ${st?"bg-green-100 font-semibold text-gray-700":"bg-red-100 font-semibold text-red-700"}`,children:["Disponible: ",Te(ut.lbsRem,ut.udsRem)]})]}),ct&&i.jsxs("div",{className:"p-4 pt-0",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-white rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Tipo"}),i.jsx("div",{className:"font-semibold",children:ut.typeLabel})]}),i.jsxs("div",{className:"bg-white rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Utilidad bruta"}),i.jsx("div",{className:"font-semibold",children:os(ut.utilidadBruta)})]}),i.jsxs("div",{className:"bg-white rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lbs ingresadas"}),i.jsx("div",{className:"font-semibold",children:ut.lbsIn.toFixed(3)})]}),i.jsxs("div",{className:"bg-white rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lbs restantes"}),i.jsx("div",{className:"font-semibold",children:ut.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"bg-white rounded-xl p-2 col-span-2",children:[i.jsxs("div",{className:"flex justify-between text-[11px] text-gray-500",children:[i.jsx("span",{children:"Total facturado"}),i.jsx("span",{children:"Total esperado"})]}),i.jsxs("div",{className:"flex justify-between font-semibold",children:[i.jsx("span",{children:os(ut.totalFacturado)}),i.jsx("span",{children:os(ut.totalEsperado)})]})]}),ut.items.length>0&&i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 col-span-2 border border-gray-100",children:[i.jsx("div",{className:"text-[11px] text-gray-500 mb-2",children:"Productos asociados"}),i.jsx("div",{className:"space-y-1",children:ut.items.map(z=>i.jsxs("div",{className:"flex items-center text-xs justify-between gap-2",children:[i.jsx("div",{className:"font-semibold text-gray-800 truncate",children:z.productName}),i.jsxs("div",{className:"text-gray-600 text-right",children:[i.jsxs("div",{children:["Ingresado:"," ",z.quantity.toFixed(3)]}),i.jsxs("div",{children:["Restante:"," ",z.remaining.toFixed(3)]})]})]},z.id))})]})]}),i.jsxs("div",{className:"mt-3 flex gap-2",children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-sm",onClick:()=>ye(ut),children:"Ver detalle"}),p?i.jsxs(i.Fragment,{children:[ut.status==="PENDIENTE"&&i.jsx("button",{className:"px-3 py-2 rounded-xl bg-green-600 hover:bg-green-700 text-white text-sm",onClick:()=>yt(ut),children:"Pagar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-yellow-600 hover:bg-yellow-700 text-white text-sm",onClick:()=>mt(ut),children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-red-600 hover:bg-red-700 text-white text-sm",onClick:()=>gt(ut),children:"Borrar"})]}):null]})]})]},ut.groupId)})})]},be)})]}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] w-full text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Libras ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Libras restantes"}),i.jsx("th",{className:"p-2 border",children:"Unidades ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Unidades restantes"}),i.jsx("th",{className:"p-2 border",children:"Total Facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:c?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):We.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin lotes"})}):We.map(be=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsxs("td",{className:"p-2 border",children:[i.jsx("button",{className:"underline text-blue-700 hover:text-blue-900",onClick:()=>ye(be),title:be.orderName,children:be.date}),i.jsx("div",{className:"text-[11px] text-gray-500",children:be.orderName})]}),i.jsx("td",{className:"p-2 border",children:be.typeLabel}),i.jsx("td",{className:"p-2 border",children:be.lbsIn.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:be.lbsRem.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:be.udsIn.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:be.udsRem.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:os(be.totalFacturado)}),i.jsx("td",{className:"p-2 border",children:os(be.totalEsperado)}),i.jsx("td",{className:"p-2 border",children:os(be.utilidadBruta)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${be.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:be.status})}),i.jsx("td",{className:"p-2 border",children:p?i.jsxs("div",{className:"flex gap-2 justify-center",children:[be.status==="PENDIENTE"&&i.jsx("button",{onClick:()=>yt(be),className:"px-2 py-1 rounded text-white bg-green-600 hover:bg-green-700",children:"Pagar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>mt(be),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>gt(be),children:"Borrar"})]}):i.jsx("span",{className:"text-xs text-gray-500",children:"Solo vista"})})]},be.groupId))})]})}),u&&i.jsx("p",{className:"mt-2 text-sm",children:u}),N&&$d.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>S(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-6xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:M?"Editar pedido":"Crear pedido"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>S(!1),type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre de pedido"}),i.jsx("input",{className:"w-full border p-2 rounded",value:E,onChange:be=>B(be.target.value),placeholder:"Ej: Pedido Pollo - Semana 1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de lote"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:k,onChange:be=>T(be.target.value)})]})]}),i.jsxs("div",{className:"border rounded p-3 bg-gray-50 mb-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3 items-end",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Unidad"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:P,onChange:be=>{q(be.target.value),ce(""),he(0),Ce(NaN),O(0)},children:[i.jsx("option",{value:"lb",children:"lb"}),i.jsx("option",{value:"unidad",children:"unidad"}),i.jsx("option",{value:"kg",children:"kg"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (solo activos)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:de,onChange:be=>ce(be.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un producto"}),rt.map(be=>i.jsxs("option",{value:be.id,children:[be.name,"  ",be.category,"  ",be.measurement]},be.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Libras a ingresar"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:le===0?"":le,onChange:be=>{const Ae=be.target.value.replace(",","."),Le=parseFloat(Ae),ut=Number.isFinite(Le)?parseFloat(Le.toFixed(3)):0;he(Math.max(0,ut));const ct=R.find(st=>st.productId===de);ct&&pe(ct.tempId,"quantity",ut)},disabled:!de})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio proveedor"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Number.isNaN(ae)?"":ae,onChange:be=>{const Ae=be.target.value.replace(",",".");if(Ae==="")return Ce(NaN);const Le=parseFloat(Ae),ut=Number.isFinite(Le)?parseFloat(Le.toFixed(2)):NaN;Ce(Number.isFinite(ut)?Math.max(0,ut):NaN);const ct=R.find(st=>st.productId===de);ct&&Number.isFinite(ut)&&pe(ct.tempId,"purchasePrice",ut)},disabled:!de})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio venta (editable)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:De===0?"":De,onChange:be=>{const Ae=be.target.value.replace(",","."),Le=parseFloat(Ae),ut=Number.isFinite(Le)?parseFloat(Le.toFixed(2)):0;O(Math.max(0,ut));const ct=R.find(st=>st.productId===de);ct&&pe(ct.tempId,"salePrice",ut)},disabled:!de})]})]}),i.jsx("div",{className:"flex justify-end mt-3",children:i.jsx("button",{type:"button",onClick:$e,className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Agregar producto al pedido"})})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Libras ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Libras restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:R.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center text-gray-500",children:"No hay productos agregados."})}):R.map(be=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsxs("td",{className:"p-2 border text-left",children:[be.productName,i.jsxs("div",{className:"text-[11px] text-gray-500",children:[be.category,"  ",be.unit]})]}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:be.quantity,onChange:Ae=>{const Le=Ae.target.value.replace(",","."),ut=parseFloat(Le),ct=Number.isFinite(ut)?parseFloat(ut.toFixed(3)):0;pe(be.tempId,"quantity",ct)}})}),i.jsx("td",{className:"p-2 border",children:Number(be.remaining||0).toFixed(3)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:be.purchasePrice,onChange:Ae=>{const Le=Ae.target.value.replace(",","."),ut=parseFloat(Le),ct=Number.isFinite(ut)?parseFloat(ut.toFixed(2)):0;pe(be.tempId,"purchasePrice",ct)}})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:be.salePrice,onChange:Ae=>{const Le=Ae.target.value.replace(",","."),ut=parseFloat(Le),ct=Number.isFinite(ut)?parseFloat(ut.toFixed(2)):0;pe(be.tempId,"salePrice",ct)}})}),i.jsx("td",{className:"p-2 border",children:os(be.invoiceTotal)}),i.jsx("td",{className:"p-2 border",children:os(be.expectedTotal)}),i.jsx("td",{className:"p-2 border",children:os(be.utilidadBruta)}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ie(be.tempId),children:"Quitar"})})]},be.tempId))})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras ingresadas"}),i.jsx("div",{className:"text-lg font-semibold",children:fe.lbsIn.toFixed(3)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Libras restantes"}),i.jsx("div",{className:"text-lg font-semibold",children:fe.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado"}),i.jsx("div",{className:"text-lg font-semibold",children:os(fe.totalFacturado)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Total esperado"}),i.jsx("div",{className:"text-lg font-semibold",children:os(fe.totalEsperado)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Utilidad bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:os(fe.utilidadBruta)})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>S(!1),children:"Cancelar"}),i.jsx("button",{type:"button",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",onClick:me,disabled:R.length===0,children:M?"Editar pedido":"Crear pedido"})]})]})]}),document.body),V&&ve&&$d.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[75] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>{te(!1),Q(null)}}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-6xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold",children:"Detalle del pedido"}),i.jsxs("div",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:ve.orderName})," "," ",ve.date]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{te(!1),Q(null)},type:"button",children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Ingresado"}),i.jsx("th",{className:"p-2 border",children:"Restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Compra"}),i.jsx("th",{className:"p-2 border",children:"Precio Venta"}),i.jsx("th",{className:"p-2 border",children:"Total factura"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:ve.items.map(be=>{const Ae=Number(be.invoiceTotal||0),Le=Number(be.expectedTotal||0);return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border text-left",children:be.productName}),i.jsx("td",{className:"p-2 border",children:(be.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:be.quantity.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:be.remaining.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:os(be.purchasePrice)}),i.jsx("td",{className:"p-2 border",children:os(be.salePrice)}),i.jsx("td",{className:"p-2 border",children:os(Ae)}),i.jsx("td",{className:"p-2 border",children:os(Le)}),i.jsx("td",{className:"p-2 border",children:os(Le-Ae)}),i.jsx("td",{className:"p-2 border",children:be.status})]},be.id)})})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mt-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras ingresadas"}),i.jsx("div",{className:"text-lg font-semibold",children:ve.lbsIn.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras restantes"}),i.jsx("div",{className:"text-lg font-semibold",children:ve.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:os(ve.utilidadBruta)})]})]})]})]}),document.body),Xe&&Z&&$d.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[80] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:Ft}),i.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl border w-[90%] max-w-md p-6",children:[i.jsx("h3",{className:"text-lg font-bold mb-3 text-center",children:"Confirmar pago de inventario"}),i.jsxs("p",{className:"text-sm text-gray-700 mb-5 text-center",children:["Seguro que quieres pagar este pedido?",i.jsx("br",{}),i.jsx("strong",{children:Z.orderName})," "," ",Z.date,i.jsx("br",{}),"Ya no habrn libras disponibles al pagar este inventario."]}),i.jsxs("div",{className:"flex justify-center gap-4",children:[i.jsx("button",{onClick:Pt,className:"px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700",children:"Confirmar"}),i.jsx("button",{onClick:Ft,className:"px-4 py-2 rounded-lg bg-gray-300 hover:bg-gray-400",children:"Cancelar"})]})]})]}),document.body)]})}const Oh=t=>`C$${(Number(t)||0).toFixed(2)}`;function U3e(){const t=xwe(new Date),[e,r]=g.useState(Kr(t,"yyyy-MM")),[n,a]=g.useState([]),[s,o]=g.useState(!1),[l,c]=g.useState(""),d=g.useRef(null),u=g.useMemo(()=>{const[x,v]=e.split("-").map(w=>parseInt(w,10)),y=Kr(Gu(new Date(x,v-1,1)),"yyyy-MM-dd"),b=Kr($u(new Date(x,v-1,1)),"yyyy-MM-dd");return{from:y,to:b}},[e]),f=async()=>{o(!0);try{const x=await FPe(u.from,u.to),v=[];for(const y of x){const b=Kt(Ne,"inventory_batches",y.batchId),w=await Es(b);if(!w.exists())continue;const I=w.data();v.push({batchId:y.batchId,batchDate:y.batchDate,productName:y.productName,soldQty:Number(y.quantity||0),soldAmount:Number(y.amountCharged||0),status:I.status??"PENDIENTE",purchasePrice:Number(I.purchasePrice||0),salePrice:Number(I.salePrice||0),supplier:I.supplier})}a(v)}catch(x){console.error(x),c(" Error al cargar liquidaciones")}finally{o(!1)}};g.useEffect(()=>{f()},[e]);const A=async x=>{confirm("Marcar este lote como PAGADO?")&&(await ene(x),a(y=>y.map(b=>b.batchId===x?{...b,status:"PAGADO"}:b)))},h=g.useMemo(()=>{const x=n.reduce((w,I)=>w+I.soldQty,0),v=n.reduce((w,I)=>w+I.soldAmount,0),y=n.reduce((w,I)=>w+I.soldQty*I.purchasePrice,0),b=v-y;return{q:x,amt:v,cogs:y,profit:b}},[n]),m=g.useMemo(()=>{const x=new Map;for(const v of n){const y=v.productName||"(sin nombre)";x.has(y)||x.set(y,{productName:y,qty:0,revenue:0,cogs:0,profit:0});const b=x.get(y);b.qty+=v.soldQty,b.revenue+=v.soldAmount;const w=v.soldQty*v.purchasePrice;b.cogs+=w,b.profit=b.revenue-b.cogs}return Array.from(x.values()).sort((v,y)=>v.productName.localeCompare(y.productName))},[n]),p=async()=>{if(!d.current)return;const x=d.current;x.classList.add("force-pdf-colors");try{const[{default:v},{jsPDF:y}]=await Promise.all([dA(()=>Promise.resolve().then(()=>eR),void 0),dA(()=>Promise.resolve().then(()=>eF),void 0)]),w=(await v(x,{backgroundColor:"#ffffff",scale:2})).toDataURL("image/png"),I=new y("p","mm","a4"),j=190,N=I.getImageProperties(w),S=j,E=N.height*S/N.width;I.addImage(w,"PNG",10,10,S,E),I.save(`liquidaciones_${e}.pdf`)}catch(v){console.error(v),alert("No se pudo generar el PDF")}finally{x.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between gap-3 mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Liquidaciones por lote"}),i.jsx("button",{onClick:p,className:"bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700",children:"Descargar PDF"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-center gap-3",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Mes:"}),i.jsx("input",{type:"month",className:"border rounded px-2 py-1",value:e,onChange:x=>r(x.target.value)}),i.jsx("button",{onClick:f,className:"bg-gray-800 text-white px-3 py-1 rounded",children:"Aplicar"})]}),i.jsxs("div",{ref:d,children:[i.jsx("div",{className:"bg-white p-3 rounded shadow border mb-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total vendido (cantidad):"})," ",h.q]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Monto vendido:"})," ",Oh(h.amt)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Costo (COGS):"})," ",Oh(h.cogs)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Utilidad:"})," ",Oh(h.profit)]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto mb-6",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Lote (fecha)"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Proveedor"}),i.jsx("th",{className:"p-2 border",children:"Vendido"}),i.jsx("th",{className:"p-2 border",children:"Monto vendido"}),i.jsx("th",{className:"p-2 border",children:"COGS"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Cargando"})}):n.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Sin datos"})}):n.map(x=>{const v=x.soldQty*x.purchasePrice,y=x.soldAmount-v;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:x.batchDate}),i.jsx("td",{className:"p-2 border",children:x.productName}),i.jsx("td",{className:"p-2 border",children:x.supplier||"-"}),i.jsx("td",{className:"p-2 border",children:x.soldQty}),i.jsx("td",{className:"p-2 border",children:Oh(x.soldAmount)}),i.jsx("td",{className:"p-2 border",children:Oh(v)}),i.jsx("td",{className:`p-2 border ${y>=0?"text-green-700":"text-red-700"}`,children:Oh(y)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${x.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:x.status})}),i.jsx("td",{className:"p-2 border",children:x.status==="PENDIENTE"&&i.jsx("button",{onClick:()=>A(x.batchId),className:"px-2 py-1 rounded text-white bg-green-600 hover:bg-green-700",children:"Marcar pagado"})})]},x.batchId)})})]})}),i.jsx("h3",{className:"font-semibold mb-2",children:"Utilidad por producto"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Cantidad vendida"}),i.jsx("th",{className:"p-2 border",children:"Ingreso"}),i.jsx("th",{className:"p-2 border",children:"COGS"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"})]})}),i.jsx("tbody",{children:m.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin datos"})}):m.map(x=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:x.productName}),i.jsx("td",{className:"p-2 border",children:x.qty}),i.jsx("td",{className:"p-2 border",children:Oh(x.revenue)}),i.jsx("td",{className:"p-2 border",children:Oh(x.cogs)}),i.jsx("td",{className:`p-2 border ${x.profit>=0?"text-green-700":"text-red-700"}`,children:Oh(x.profit)})]},x.productName))})]})})]}),l&&i.jsx("p",{className:"mt-2 text-sm",children:l})]})}const on=t=>`C$${Number(t??0).toFixed(2)}`,Q3e=()=>Kr(new Date,"yyyy-MM-dd"),Na=t=>Number(t||0).toFixed(3);function V3e(){const[t,e]=g.useState(()=>{const H=new Date,L=new Date(H.getFullYear(),H.getMonth(),1);return Kr(L,"yyyy-MM-dd")}),[r,n]=g.useState(Q3e()),[a,s]=g.useState(!0),[o,l]=g.useState([]),[c,d]=g.useState([]),[u,f]=g.useState([]),[A,h]=g.useState(!1),[m,p]=g.useState(null),[x,v]=g.useState(0),[y,b]=g.useState(0),[w,I]=g.useState(0),[j,N]=g.useState(0),[S,E]=g.useState({}),[B,k]=g.useState({}),{refreshKey:T,refresh:P}=bc(),[q,de]=g.useState({}),[ce,le]=g.useState({}),[he,ae]=g.useState(!1),Ce=()=>ae(H=>!H),[De,O]=g.useState(!1),R=()=>O(H=>!H),[G,M]=g.useState(!1),[K,Y]=g.useState(!1),[D,V]=g.useState(!1),[te,ve]=g.useState(!1),[Q,Xe]=g.useState(!1),[se,Z]=g.useState(!1),ke=()=>M(H=>!H),Se=()=>Y(H=>!H),Ee=()=>V(H=>!H),Ze=()=>ve(H=>!H),ot=()=>Xe(H=>!H),vt=()=>Z(H=>!H),[_t,Tt]=g.useState("");g.useEffect(()=>{(async()=>{s(!0);const L=ar(xt(Ne,"salesV2"),lr("date",">=",t),lr("date","<=",r)),ue=await Ut(L),Pe=[];ue.forEach(Ke=>{const pt=Ke.data(),ne=pt.date??"";if(Array.isArray(pt.items)&&pt.items.length>0){pt.items.forEach((Ue,tt)=>{const nt=String(Ue.productName??"(sin nombre)"),wt=Number(Ue.qty??0),Bt=Number(Ue.lineFinal??0)||Math.max(0,Number(Ue.unitPrice||0)*wt-Number(Ue.discount||0));Pe.push({id:`${Ke.id}#${tt}`,date:ne,productName:nt,quantity:wt,amount:Bt,allocations:Array.isArray(Ue.allocations)?Ue.allocations:pt.allocations,avgUnitCost:Number(Ue.avgUnitCost??pt.avgUnitCost??0),measurement:Ue.measurement??pt.measurement??"",type:pt.type??"CONTADO"})});return}Pe.push({id:Ke.id,date:ne,productName:pt.productName??"(sin nombre)",quantity:Number(pt.quantity??0),amount:Number(pt.amount??pt.amountCharged??0),allocations:Array.isArray(pt.allocations)?pt.allocations:[],avgUnitCost:Number(pt.avgUnitCost??0),measurement:pt.measurement??"",type:pt.type??"CONTADO"})}),l(Pe);const xe=ar(xt(Ne,"expenses"),lr("date",">=",t),lr("date","<=",r)),Ge=await Ut(xe),ze=[];Ge.forEach(Ke=>{const pt=Ke.data();ze.push({id:Ke.id,date:pt.date??"",category:pt.category??"(sin categora)",description:pt.description??"",amount:Number(pt.amount??0),status:pt.status??"PAGADO",createdAt:pt.createdAt})}),d(ze),s(!1)})()},[t,r,T]),g.useMemo(()=>{const H=o.reduce((Ge,ze)=>Ge+(ze.amount||0),0);let L=0;o.forEach(Ge=>{var ze;(ze=Ge.allocations)!=null&&ze.length?L+=Ge.allocations.reduce((Ke,pt)=>Ke+Number(pt.lineCost||0),0):Ge.avgUnitCost&&Ge.quantity&&(L+=Number(Ge.avgUnitCost)*Number(Ge.quantity))});const ue=H-L,Pe=c.reduce((Ge,ze)=>Ge+(ze.amount||0),0),xe=ue-Pe;return{revenue:H,cogsReal:L,grossProfit:ue,expensesSum:Pe,netProfit:xe}},[o,c]);const Lt=g.useMemo(()=>_t?o.filter(H=>(H.productName||"")===_t):o,[o,_t]),Rt=g.useMemo(()=>{const H=Lt.reduce((Ge,ze)=>Ge+(ze.amount||0),0);let L=0;Lt.forEach(Ge=>{var ze;(ze=Ge.allocations)!=null&&ze.length?L+=Ge.allocations.reduce((Ke,pt)=>Ke+Number(pt.lineCost||0),0):Ge.avgUnitCost&&Ge.quantity&&(L+=Number(Ge.avgUnitCost)*Number(Ge.quantity))});const ue=H-L,Pe=c.reduce((Ge,ze)=>Ge+(ze.amount||0),0),xe=ue-Pe;return{revenue:H,cogsReal:L,grossProfit:ue,expensesSum:Pe,netProfit:xe}},[Lt,c]),Et=g.useMemo(()=>{const H=Lt.filter(ze=>ze.type==="CONTADO"),L=H.reduce((ze,Ke)=>ze+(Ke.amount||0),0);let ue=0;H.forEach(ze=>{var Ke;(Ke=ze.allocations)!=null&&Ke.length?ue+=ze.allocations.reduce((pt,ne)=>pt+Number(ne.lineCost||0),0):ze.avgUnitCost&&ze.quantity&&(ue+=Number(ze.avgUnitCost)*Number(ze.quantity))});const Pe=L-ue,xe=c.reduce((ze,Ke)=>ze+(Ke.amount||0),0),Ge=Pe-xe;return{revenue:L,cogsReal:ue,grossProfit:Pe,expensesSum:xe,netProfit:Ge}},[Lt,c]),Re=g.useMemo(()=>{const H=Lt.filter(xe=>xe.type==="CREDITO"),L=H.reduce((xe,Ge)=>xe+(Ge.amount||0),0);let ue=0;H.forEach(xe=>{var Ge;(Ge=xe.allocations)!=null&&Ge.length?ue+=xe.allocations.reduce((ze,Ke)=>ze+Number(Ke.lineCost||0),0):xe.avgUnitCost&&xe.quantity&&(ue+=Number(xe.avgUnitCost)*Number(xe.quantity))});const Pe=L-ue;return{revenue:L,cogsReal:ue,grossProfit:Pe}},[Lt]),Te=H=>String(H??"").toLowerCase().trim(),Ye=H=>Number(H.qty??H.quantity??0),dt=H=>["lb","lbs","libra","libras"].includes(Te(H)),Fe=H=>["unidad","unidades","ud","uds","pieza","piezas"].includes(Te(H)),je=H=>H?typeof H=="string"?H:H!=null&&H.toDate?Kr(H.toDate(),"yyyy-MM-dd"):"":"";g.useEffect(()=>{(async()=>{h(!0);try{const L=await Ut(xt(Ne,"customers_pollo")),ue={};L.forEach(Jt=>{const ir=Jt.data();ue[Jt.id]=String(ir.name??"(sin nombre)")});const Pe=await Ut(xt(Ne,"ar_movements_pollo")),xe={},Ge={},ze={},Ke={},pt={},ne=new Set,Ue={},tt={},nt={},wt={};let Bt=0,tr=0;const Or=Jt=>{var ir;return Jt!=null&&Jt.date?String(Jt.date):(ir=Jt==null?void 0:Jt.createdAt)!=null&&ir.toDate?Kr(Jt.createdAt.toDate(),"yyyy-MM-dd"):""};Pe.forEach(Jt=>{var $t,Mt,Be;const ir=Jt.data(),Fr=String(ir.customerId??"").trim();if(!Fr)return;const Er=Number(ir.amount??0);xe[Fr]=(xe[Fr]||0)+Er;const Lr=String(ir.type??"").toUpperCase(),Ln=String(ir.debtStatus??ir.creditStatus??ir.cycleStatus??ir.status??"").toUpperCase().trim(),Nt=["PAGADA","PAGADO","CERRADA","CERRADO","LIQUIDADA","LIQUIDADO"].includes(Ln),nr=ir.createdAt??null;if(Lr==="ABONO"){Bt+=Math.abs(Er);const It=Or(ir);It&&It>=t&&It<=r&&(tr+=Math.abs(Er));const Vt=($t=ir==null?void 0:ir.ref)!=null&&$t.saleId?String(ir.ref.saleId):"";Vt?(Ue[Vt]=(Ue[Vt]||0)+Math.abs(Er),It&&It>=t&&It<=r&&(nt[Vt]=(nt[Vt]||0)+Math.abs(Er)),ne.add(Vt)):(tt[Fr]=(tt[Fr]||0)+Math.abs(Er),It&&It>=t&&It<=r&&(wt[Fr]=(wt[Fr]||0)+Math.abs(Er)));const Ot=ze[Fr],qt=!(Ot!=null&&Ot.ts)||(nr!=null&&nr.toDate&&((Mt=Ot.ts)!=null&&Mt.toDate)?nr.toDate()>Ot.ts.toDate():!1);(!Ot||qt)&&(ze[Fr]={amount:Math.abs(Er),date:ir.date??"",ts:nr})}if(Lr==="CARGO"){const It=(Be=ir==null?void 0:ir.ref)!=null&&Be.saleId?String(ir.ref.saleId):"";It&&(Ke[Fr]||(Ke[Fr]=new Set),Ke[Fr].add(It),Nt||(pt[Fr]||(pt[Fr]=new Set),pt[Fr].add(It)),ne.add(It)),Nt||(Ge[Fr]=(Ge[Fr]||0)+Math.abs(Er))}});const zr=new Map;await Promise.all(Array.from(ne).map(async Jt=>{const ir=await Es(Kt(Ne,"salesV2",Jt));ir.exists()&&zr.set(Jt,ir.data())}));let ur=0,Dr=0;const dn=Jt=>{const ir=Number(Jt.qty??Jt.quantity??0);return Number(Jt.lineFinal??0)||Math.max(0,Number(Jt.unitPrice||0)*ir-Number(Jt.discount||0))},mn=Jt=>{if(Array.isArray(Jt.items)&&Jt.items.length>0){let Lr=0,Ln=0;return Jt.items.forEach(Nt=>{const nr=Number(Nt.qty??Nt.quantity??0);if(Lr+=dn(Nt),Array.isArray(Nt.allocations)&&Nt.allocations.length>0)Ln+=Nt.allocations.reduce(($t,Mt)=>$t+Number(Mt.lineCost||0),0);else{const $t=Number(Nt.avgUnitCost??Jt.avgUnitCost??0);Ln+=$t*nr}}),{total:Lr,cogs:Ln}}const ir=Number(Jt.quantity??0),Fr=Number(Jt.amount??Jt.amountCharged??0)||0;let Er=0;return Array.isArray(Jt.allocations)&&Jt.allocations.length>0?Er=Jt.allocations.reduce((Lr,Ln)=>Lr+Number(Ln.lineCost||0),0):Jt.avgUnitCost&&(Er=Number(Jt.avgUnitCost)*ir),{total:Fr,cogs:Er}},kr=new Map;zr.forEach((Jt,ir)=>{const{total:Fr,cogs:Er}=mn(Jt);kr.set(ir,{total:Fr,cogs:Er,grossProfit:Fr-Er})});const Qe={},jt={},wr={},ln={};Object.keys(Ue).forEach(Jt=>{const ir=kr.get(Jt);if(!(ir!=null&&ir.total))return;const Fr=Number(Ue[Jt]||0);jt[Jt]=Fr;const Er=Math.min(1,Fr/ir.total),Lr=ir.grossProfit*Er;Qe[Jt]=Lr,ur+=Lr}),Object.keys(nt).forEach(Jt=>{const ir=kr.get(Jt);if(!(ir!=null&&ir.total))return;const Fr=Number(nt[Jt]||0);ln[Jt]=Fr;const Er=Math.min(1,Fr/ir.total),Lr=ir.grossProfit*Er;wr[Jt]=Lr,Dr+=Lr}),Object.keys(tt).forEach(Jt=>{const ir=Ke[Jt];if(!ir||ir.size===0)return;let Fr=0,Er=0,Lr=0,Ln=0;ir.forEach(Be=>{const It=kr.get(Be);It&&(Fr+=It.total,Er+=It.grossProfit,jt[Be]&&(Lr+=Math.min(It.total,jt[Be])),Ln+=Qe[Be]||0)});const Nt=Math.max(0,Fr-Lr),nr=Math.max(0,Er-Ln);if(!Nt||!nr)return;const $t=Number(tt[Jt]||0),Mt=Math.min(1,$t/Nt);ur+=nr*Mt}),Object.keys(wt).forEach(Jt=>{const ir=Ke[Jt];if(!ir||ir.size===0)return;let Fr=0,Er=0,Lr=0,Ln=0;ir.forEach(Be=>{const It=kr.get(Be);It&&(Fr+=It.total,Er+=It.grossProfit,ln[Be]&&(Lr+=Math.min(It.total,ln[Be])),Ln+=wr[Be]||0)});const Nt=Math.max(0,Fr-Lr),nr=Math.max(0,Er-Ln);if(!Nt||!nr)return;const $t=Number(wt[Jt]||0),Mt=Math.min(1,$t/Nt);Dr+=nr*Mt});const cn=[];Object.keys(xe).forEach(Jt=>{const ir=Number(xe[Jt]||0);if(ir<=0)return;const Fr=new Map;let Er=0,Lr=0,Ln="";(pt[Jt]||new Set).forEach(Mt=>{const Be=zr.get(Mt);if(!Be)return;const It=String(Be.date??"");It&&(!Ln||It>Ln)&&(Ln=It),(Array.isArray(Be.items)&&Be.items.length>0?Be.items:[{productName:Be.productName,qty:Be.quantity,unitPrice:Be.unitPrice,discount:Be.discount,lineFinal:Be.amount??Be.amountCharged,measurement:Be.measurement}]).forEach(Ot=>{const qt=String(Ot.productName??"(sin nombre)"),sr=Number(Ot.qty??Ot.quantity??0),vr=String(Ot.measurement??""),rr=Number(Ot.lineFinal??0)||Math.max(0,Number(Ot.unitPrice||0)*sr-Number(Ot.discount||0));dt(vr)?Er+=sr:Lr+=sr;const dr=`${qt}||${vr}`,we=Fr.get(dr)||{productName:qt,qty:0,amount:0,measurement:vr};we.qty+=sr,we.amount+=rr,Fr.set(dr,we)})});const nr=ze[Jt],$t=Number(Ge[Jt]||0);cn.push({customerId:Jt,name:ue[Jt]||"(sin nombre)",balance:ir,globalBalance:$t>0?$t:ir,lbs:Er,units:Lr,lastPaymentAmount:Number((nr==null?void 0:nr.amount)||0),lastSaleDate:Ln||"",lastPaymentDate:je((nr==null?void 0:nr.ts)||(nr==null?void 0:nr.date)),products:Array.from(Fr.values()).sort((Mt,Be)=>Mt.productName.localeCompare(Be.productName))})});const _r=cn.filter(Jt=>Jt.products.length);_r.sort((Jt,ir)=>ir.balance-Jt.balance),f(_r),v(Bt),b(tr),I(ur),N(Dr)}catch(L){console.error("Error cargando saldos pendientes:",L),f([]),v(0),b(0),N(0)}finally{h(!1)}})()},[T,t,r]),g.useEffect(()=>{(async()=>{try{const L=await Ut(ar(xt(Ne,"inventory_batches"))),ue=jS(t,"yyyy-MM-dd",new Date),Pe=jS(r,"yyyy-MM-dd",new Date),xe=Kr(Gu(ue),"yyyy-MM-dd"),Ge=Kr($u(Pe),"yyyy-MM-dd"),ze={};L.forEach(Ke=>{var Bt;const pt=Ke.data(),ne=String(pt.productName??"(sin nombre)"),Ue=Number(pt.quantity??0),tt=Number(pt.remaining??0),nt=(Bt=pt==null?void 0:pt.date)!=null&&Bt.toDate?Kr(pt.date.toDate(),"yyyy-MM-dd"):String((pt==null?void 0:pt.date)??(pt==null?void 0:pt.createdAt)??""),wt=nt&&nt>=xe&&nt<=Ge;ze[ne]||(ze[ne]={incomingQty:0,remainingQty:0}),wt&&(ze[ne].incomingQty+=Ue),ze[ne].remainingQty+=tt}),E(ze)}catch(L){console.error("Error cargando inventario:",L),E({})}})()},[T,t,r]);const We=g.useMemo(()=>o.reduce((H,L)=>dt(L.measurement)?H+Ye(L):H,0),[o]);g.useMemo(()=>Lt.reduce((H,L)=>dt(L.measurement)?H+Ye(L):H,0),[Lt]);const ee=g.useMemo(()=>Lt.filter(H=>H.type==="CONTADO"),[Lt]),Ve=g.useMemo(()=>Lt.filter(H=>H.type==="CREDITO"),[Lt]),rt=g.useMemo(()=>ee.reduce((H,L)=>H+(L.amount||0),0),[ee]),$e=g.useMemo(()=>Ve.reduce((H,L)=>H+(L.amount||0),0),[Ve]),ie=g.useMemo(()=>u.reduce((H,L)=>H+Number(L.balance||0),0),[u]),pe=g.useMemo(()=>Et.revenue,[Et.revenue]),fe=g.useMemo(()=>rt,[rt]),Me=g.useMemo(()=>rt+y,[rt,y]),me=g.useMemo(()=>Et.grossProfit+j,[Et.grossProfit,j]),ye=g.useMemo(()=>Et.netProfit+j,[Et.netProfit,j]),mt=g.useMemo(()=>ee.reduce((H,L)=>dt(L.measurement)?H+Ye(L):H,0),[ee]),gt=g.useMemo(()=>Ve.reduce((H,L)=>dt(L.measurement)?H+Ye(L):H,0),[Ve]),yt=g.useMemo(()=>o.reduce((H,L)=>Fe(L.measurement)?H+Ye(L):H,0),[o]);g.useMemo(()=>Lt.reduce((H,L)=>Fe(L.measurement)?H+Ye(L):H,0),[Lt]);const Pt=g.useMemo(()=>ee.reduce((H,L)=>Fe(L.measurement)?H+Ye(L):H,0),[ee]),Ft=g.useMemo(()=>Ve.reduce((H,L)=>Fe(L.measurement)?H+Ye(L):H,0),[Ve]),Oe=g.useMemo(()=>Array.from(new Set(o.map(H=>H.productName||"(sin nombre)"))).sort(),[o]),be=g.useMemo(()=>{var L;const H=new Map;for(const ue of Lt){const Pe=ue.productName||"(sin nombre)";H.has(Pe)||H.set(Pe,{productName:Pe,units:0,revenue:0,cogs:0,profit:0,firstDate:ue.date||"",lastDate:ue.date||""});const xe=H.get(Pe);xe.units+=Number(ue.quantity||0),xe.revenue+=Number(ue.amount||0),(!xe.firstDate||ue.date<(xe.firstDate||ue.date))&&(xe.firstDate=ue.date),(!xe.lastDate||ue.date>(xe.lastDate||ue.date))&&(xe.lastDate=ue.date);let Ge=0;(L=ue.allocations)!=null&&L.length?Ge=ue.allocations.reduce((ze,Ke)=>ze+Number(Ke.lineCost||0),0):ue.avgUnitCost&&(Ge=Number(ue.avgUnitCost)*Number(ue.quantity||0)),xe.cogs+=Ge,xe.profit=xe.revenue-xe.cogs}return Array.from(H.values()).sort((ue,Pe)=>ue.productName.localeCompare(Pe.productName))},[Lt]),Ae=g.useMemo(()=>[...be].sort((H,L)=>L.units-H.units).slice(0,3).map((H,L)=>({idx:L+1,name:H.productName,units:H.units})),[be]),Le=H=>de(L=>({...L,[H]:!L[H]})),ut=H=>le(L=>({...L,[H]:!L[H]})),ct=()=>{const H=new An({unit:"pt",format:"a4"}),L="Dashboard Financiero",ue=`Rango: ${t} a ${r}`,Pe=_t?`Producto: ${_t}`:"Producto: Todos";H.setFontSize(16),H.text(L,40,40),H.setFontSize(10),H.text(ue,40,58),H.text(Pe,40,72);let xe=90;const Ge=()=>{var Ke;xe=(Ke=H.lastAutoTable)!=null&&Ke.finalY?H.lastAutoTable.finalY+18:xe+18},ze=(Ke,pt)=>{pt.length&&(H.setFontSize(11),H.text(Ke,40,xe),xe+=12,$0(H,{startY:xe,head:[["KPI","Valor"]],body:pt,styles:{fontSize:9},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),Ge())};ze("KPIs Generales",[["Ventas (rango)",on(Rt.revenue)],["Costo",on(Rt.cogsReal)],["Utilidad Bruta",on(Rt.grossProfit)],["Gastos",on(Rt.expensesSum)],["Utilidad Neta",on(Rt.netProfit)]]),ze("KPIs Cash",[["Ventas Cash",on(pe)],["Costo Cash",on(Et.cogsReal)],["Utilidad Bruta Cash",on(Et.grossProfit)]]),ze("KPIs Crdito",[["Ventas Crdito",on(Re.revenue)],["Costo Crdito",on(Re.cogsReal)],["Utilidad Bruta Crdito",on(Re.grossProfit)]]),ze("Fondos y Utilidades",[["CxC",on(ie)],["Recaudacin (Abonos)",on(x)],["Recaudacin a la fecha",on(y)],["Recolectado Cash + Abonos",on(Me)],["Utilidad Neta Crdito (Caja)",on(j)],["Utilidad Bruta Cash + Crdito",on(me)],["Gastos",on(Et.expensesSum)],["Utilidad Neta Cash + Crdito",on(ye)]]),ze("KPIs de Volumen y Ventas",[["Ventas Cash",on(fe)],["Ventas Crdito",on($e)],["Libras Cash",Na(mt)],["Libras Crdito",Na(gt)],["Libras Cash + Crdito",Na(mt+gt)],["Unidades Cash",Na(Pt)],["Unidades Crdito",Na(Ft)],["Unidades Cash + Crdito",Na(Pt+Ft)]]),Ae.length>0&&(H.setFontSize(11),H.text("Top productos por unidades",40,xe),xe+=12,$0(H,{startY:xe,head:[["#","Producto","Cantidad"]],body:Ae.map(Ke=>[String(Ke.idx),Ke.name,Na(Ke.units)]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),Ge()),$0(H,{startY:xe,head:[["Cliente","Libras","Unidades","Saldo Global","ltimo abono","Saldo pendiente","Fecha ult. abono"]],body:u.map(Ke=>[Ke.name,Na(Ke.lbs),Na(Ke.units),on(Ke.globalBalance),on(Ke.lastPaymentAmount),on(Ke.balance),Ke.lastPaymentDate||""]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]},didDrawPage:Ke=>{Ke.pageNumber>1&&(H.setFontSize(10),H.text(L,40,30))}}),Ge(),$0(H,{startY:xe,head:[["Producto","Ingresado","Disponibilidad","Fechas","Cantidad","Venta","Costo","Utilidad"]],body:be.map(Ke=>{var pt,ne;return[Ke.productName,Na(((pt=S[Ke.productName])==null?void 0:pt.incomingQty)||0),Na(((ne=S[Ke.productName])==null?void 0:ne.remainingQty)||0),Ke.firstDate&&Ke.lastDate?Ke.firstDate===Ke.lastDate?Ke.firstDate:`${Ke.firstDate}  ${Ke.lastDate}`:"",Na(Ke.units),on(Ke.revenue),on(Ke.cogs),on(Ke.profit)]}),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),Ge(),$0(H,{startY:xe,head:[["Fecha","Categora","Descripcin","Monto","Estado"]],body:c.map(Ke=>[Ke.date,Ke.category,Ke.description||"",on(Ke.amount),Ke.status||""]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),H.save(`dashboard_${t}_a_${r}.pdf`)},[st,z]=g.useState(!1),X=g.useRef(!1),re=async(H=!1)=>{try{z(!0);const L=Vi.currentUser,ue={from:t,to:r,createdAt:tP(),user:L?{uid:L.uid,email:L.email??null,displayName:L.displayName??null}:null,kpis:{visible:Rt,cash:Et,credit:Re},totals:{totalLbs:We,totalUnits:yt,totalSalesCash:rt,totalSalesCredit:$e,totalPendingBalance:ie,totalAbonos:x,totalAbonosRange:y,collectedCashPlusAbonos:Me,grossProfitCashPlusCredit:me,netProfitCashPlusCredit:ye},topProducts:Ae,byProduct:be.map(Pe=>({productName:Pe.productName,units:Pe.units,revenue:Pe.revenue,cogs:Pe.cogs,profit:Pe.profit}))};await ta(xt(Ne,"financial_snapshots"),ue),H||window.alert("KPIs guardados en la coleccin 'financial_snapshots'.")}catch(L){console.error("Error guardando snapshot de KPIs:",L),H||window.alert("Error guardando snapshot de KPIs. Revisa la consola.")}finally{z(!1)}};return g.useEffect(()=>{if(!X.current){X.current=!0;return}const H=setTimeout(()=>{re(!0)},800);return()=>clearTimeout(H)},[t,r]),i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-4 sm:p-6 rounded-2xl shadow-2xl",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[i.jsx("h2",{className:"text-xl sm:text-2xl font-bold",children:"Dashboard Financiero"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",onClick:ct,className:"px-3 py-2 rounded-lg text-sm bg-gray-900 text-white hover:bg-black",children:"Exportar PDF"}),i.jsx("button",{type:"button",onClick:re,disabled:st,className:"px-3 py-2 rounded-lg text-sm bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",children:st?"Guardando":"Guardar KPIs"}),i.jsx(yc,{onClick:P,loading:a})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-3 py-2 w-full",value:t,onChange:H=>e(H.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-3 py-2 w-full",value:r,onChange:H=>n(H.target.value)})]})]}),a?i.jsx("p",{children:"Cargando"}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{type:"button",onClick:ke,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Kpi Financiero"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Ventas: ",i.jsx("b",{children:on(Rt.revenue)}),"  Utilidad Neta:"," ",i.jsx("b",{children:on(Rt.netProfit)})]})]}),i.jsx("div",{className:"text-gray-500",children:G?"Cerrar":"Ver"})]}),G&&i.jsxs("div",{className:"mt-3",children:[i.jsx("div",{className:"flex gap-2 mb-2 items-center",children:i.jsxs("select",{className:"w-full border rounded px-2 py-2 text-sm",value:_t,onChange:H=>Tt(H.target.value),children:[i.jsx("option",{value:"",children:"Todos los productos"}),Oe.map(H=>i.jsx("option",{value:H,children:H},H))]})}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsxs("div",{className:"rounded-3xl bg-white shadow-xl border border-gray-100 p-3 sm:p-4 space-y-3",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between text-left",onClick:Ze,children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-sm text-gray-800",children:"Ventas cash - Credito"}),i.jsx("span",{className:"text-xs text-gray-500",children:"Resumen"})]}),i.jsx("span",{className:"text-xs text-gray-500",children:te?"Cerrar":"Ver"})]}),te&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[i.jsx(ys,{title:"Ventas",subtitle:"Ventas cash",value:on(pe),valueClass:"text-[#1E4D2B]"}),i.jsx(ys,{title:"Costo",value:on(Et.cogsReal)}),i.jsx(ys,{title:"Utilidad Bruta Cash",value:on(Et.grossProfit),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[i.jsx(ys,{title:"Ventas Crdito",value:on(Re.revenue)}),i.jsx(ys,{title:"Costo",value:on(Re.cogsReal),negative:!0}),i.jsx(ys,{title:"Utilidad Bruta Crdito",value:on(Re.grossProfit),positive:!0})]})]})]}),i.jsxs("div",{className:"rounded-3xl bg-white shadow-xl border border-gray-100 p-3 sm:p-4 space-y-3",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between text-left",onClick:ot,children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-sm text-gray-800",children:"Fondos"}),i.jsx("span",{className:"text-xs text-gray-500",children:"Liquidez"})]}),i.jsx("span",{className:"text-xs text-gray-500",children:Q?"Cerrar":"Ver"})]}),Q&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[i.jsx(ys,{title:"CxC",value:on(ie)}),i.jsx(ys,{title:"Recaudacin Global(Abonos)",value:on(x)}),i.jsx(ys,{title:"Recaudacin a la fecha",value:on(y)}),i.jsx(ys,{title:"Recolectado Cash + Abonos",value:on(Me),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsx(ys,{title:"Utilidad Neta Crdito (Caja)",value:on(j),valueClass:"text-[#BF5700]"}),i.jsx(ys,{title:"Utilidad Bruta Cash + Crdito",value:on(me),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsx(ys,{title:"Gastos",value:on(Et.expensesSum),negative:!0}),i.jsx(ys,{title:"Utilidad Neta Cash + Crdito",value:on(ye),positive:!0})]})]})]}),i.jsxs("div",{className:"rounded-3xl bg-white shadow-xl border border-gray-100 p-3 sm:p-4 space-y-3",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between text-left",onClick:vt,children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-sm text-gray-800",children:"Detalles"}),i.jsx("span",{className:"text-xs text-gray-500",children:"Mtricas adicionales"})]}),i.jsx("span",{className:"text-xs text-gray-500",children:se?"Cerrar":"Ver"})]}),se&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(rc,{title:"Ventas Cash",value:on(fe)}),i.jsx(rc,{title:"Ventas Crdito",value:on($e)}),i.jsx(rc,{title:"Libras Cash",value:Na(mt)}),i.jsx(rc,{title:"Libras Crdito",value:Na(gt)}),i.jsx(rc,{title:"Unidades Cash",value:Na(Pt)}),i.jsx(rc,{title:"Unidades Crdito",value:Na(Ft)})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 rounded-lg shadow-2xl p-3 sm:p-4 bg-gray-50",children:[i.jsx(rc,{title:"Libras Cash + Credito",value:Na(mt+gt)}),i.jsx(rc,{title:"Unidades Cash + Credito",value:Na(Pt+Ft)}),i.jsx(gH,{title:"Productos ms vendidos",items:Ae.map(H=>({key:`${H.idx}`,label:`${H.idx}. ${H.name}`,value:`(${Na(H.units)})`}))})]})]})]})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(ys,{title:"Ventas Cash",value:on(pe),positive:!0}),i.jsx(ys,{title:"Costo",value:on(Et.cogsReal),negative:!0}),i.jsx(ys,{title:"Utilidad Bruta Cash",value:on(Et.grossProfit),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(ys,{title:"Ventas Crdito",value:on(Re.revenue),positive:!0}),i.jsx(ys,{title:"Costo",value:on(Re.cogsReal),negative:!0}),i.jsx(ys,{title:"Utilidad Bruta Crdito",value:on(Re.grossProfit),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-3 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(ys,{title:"CxC",value:on(ie),negative:!0}),i.jsx(ys,{title:"Recaudacin Global(Abonos)",value:on(x),positive:!0}),i.jsx(ys,{title:"Recaudacin a la fecha",value:on(y),positive:!0}),i.jsx(ys,{title:"Recolectado Cash + Abonos",value:on(Me),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-4 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(ys,{title:"Utilidad Neta Crdito (Caja)",value:on(j),valueClass:"text-[#BF5700]"}),i.jsx(ys,{title:"Utilidad Bruta Cash + Crdito",value:on(me),positive:!0}),i.jsx(ys,{title:"Gastos",value:on(Et.expensesSum),negative:!0}),i.jsx(ys,{title:"Utilidad Neta Cash + Crdito",value:on(ye),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(rc,{title:"Ventas Cash",value:on(fe)}),i.jsx(rc,{title:"Ventas Crdito",value:on($e)}),i.jsx(rc,{title:"Libras Cash",value:Na(mt)}),i.jsx(rc,{title:"Libras Crdito",value:Na(gt)}),i.jsx(rc,{title:"Unidades Cash",value:Na(Pt)}),i.jsx(rc,{title:"Unidades Crdito",value:Na(Ft)})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-3 gap-3 mb-6 rounded-lg shadow-2xl p-3 sm:p-4 bg-gray-50",children:[i.jsx(rc,{title:"Libras Cash + Credito",value:Na(mt+gt)}),i.jsx(rc,{title:"Unidades Cash + Credito",value:Na(Pt+Ft)}),i.jsx(gH,{title:"Productos ms vendidos",items:Ae.map(H=>({key:`${H.idx}`,label:`${H.idx}. ${H.name}`,value:`(${Na(H.units)})`}))})]})]})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{type:"button",onClick:Se,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsx("div",{className:"font-semibold",children:"Saldos pendientes"}),i.jsx("div",{className:"text-gray-500",children:K?"Cerrar":"Ver"})]}),K&&i.jsx("div",{className:"border rounded-2xl p-3 sm:p-4 bg-gray-50 mt-3",children:A?i.jsx("div",{className:"text-sm text-gray-600",children:"Cargando saldos"}):u.length===0?i.jsx("div",{className:"text-sm text-gray-600",children:"Sin saldos pendientes."}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-white",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Libras"}),i.jsx("th",{className:"border p-2",children:"Unidades"}),i.jsx("th",{className:"border p-2",children:"Saldo Global"}),i.jsx("th",{className:"border p-2",children:"ltimo abono"}),i.jsx("th",{className:"border p-2",children:"Saldo pendiente"}),i.jsx("th",{className:"border p-2",children:"Fecha ult. abono"}),i.jsx("th",{className:"border p-2",children:"Ver"})]})}),i.jsx("tbody",{children:u.map(H=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1 text-left",children:H.name}),i.jsx("td",{className:"border p-1",children:Na(H.lbs)}),i.jsx("td",{className:"border p-1",children:Na(H.units)}),i.jsx("td",{className:"border p-1",children:on(H.globalBalance)}),i.jsx("td",{className:"border p-1",children:on(H.lastPaymentAmount)}),i.jsx("td",{className:"border p-1",children:on(H.balance)}),i.jsx("td",{className:"border p-1",children:H.lastPaymentDate||""}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",onClick:()=>p(H),className:"px-3 py-1 rounded bg-indigo-600 text-white text-xs hover:bg-indigo-700",children:"Ver"})})]},H.customerId))})]})})})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{type:"button",onClick:Ee,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsx("div",{className:"font-semibold",children:"Ventas y Gastos"}),i.jsx("div",{className:"text-gray-500",children:D?"Cerrar":"Ver"})]}),D&&i.jsxs("div",{className:"mt-3",children:[i.jsx("h3",{className:"font-semibold mb-2",children:"Ventas"}),i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-6",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Ingresado Lb/Un"}),i.jsx("th",{className:"border p-2",children:"Disponibilidad"}),i.jsx("th",{className:"border p-2",children:"Fecha Venta"}),i.jsx("th",{className:"border p-2",children:"Cantidad Lb/Un"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Costo"}),i.jsx("th",{className:"border p-2",children:"Utilidad"})]})}),i.jsxs("tbody",{children:[be.map(H=>{var L,ue;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:H.productName}),i.jsx("td",{className:"border p-1",children:Na(((L=S[H.productName])==null?void 0:L.incomingQty)||0)}),i.jsx("td",{className:"border p-1",children:Na(((ue=S[H.productName])==null?void 0:ue.remainingQty)||0)}),i.jsx("td",{className:"border p-1",children:H.firstDate&&H.lastDate?H.firstDate===H.lastDate?H.firstDate:`${H.firstDate}  ${H.lastDate}`:""}),i.jsx("td",{className:"border p-1",children:Na(H.units)}),i.jsx("td",{className:"border p-1",children:on(H.revenue)}),i.jsx("td",{className:"border p-1",children:on(H.cogs)}),i.jsx("td",{className:`border p-1 ${H.profit>=0?"text-green-700":"text-red-700"}`,children:on(H.profit)})]},H.productName)}),be.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-3 text-center text-gray-500",children:"Sin datos en el rango seleccionado."})})]})]})}),i.jsxs("div",{className:"md:hidden mb-6",children:[i.jsxs("button",{type:"button",onClick:Ce,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Ventas por producto"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[be.length," productos"]})]}),i.jsx("div",{className:"text-gray-500",children:he?"Cerrar":"Ver"})]}),he&&i.jsx("div",{className:"space-y-2 mt-3",children:be.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-sm text-gray-500 bg-gray-50",children:"Sin datos en el rango seleccionado."}):be.map(H=>{var Pe,xe,Ge,ze;const L=!!q[H.productName],ue=H.firstDate&&H.lastDate?H.firstDate===H.lastDate?H.firstDate:`${H.firstDate}  ${H.lastDate}`:"";return i.jsxs("div",{className:"border rounded-2xl bg-white shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",onClick:()=>Le(H.productName),className:"w-full text-left px-3 py-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:H.productName}),i.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Libras/Unidades"}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Vendidas: ",i.jsx("b",{children:Na(H.units)}),"  Disponible:"," ",i.jsx("b",{className:((Pe=S[H.productName])==null?void 0:Pe.remainingQty)>0?"text-green-700":"text-red-700",children:Na(((xe=S[H.productName])==null?void 0:xe.remainingQty)||0)})]})]}),i.jsx("div",{className:"text-gray-500 text-xs pt-0.10",children:L?"Cerrar":"Ver"})]}),L&&i.jsx("div",{className:"px-3 pb-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx(ou,{label:"Lb/Un Ingresadas",value:Na(((Ge=S[H.productName])==null?void 0:Ge.incomingQty)||0)}),i.jsx(ou,{label:"Lb/Un Disponibles",value:Na(((ze=S[H.productName])==null?void 0:ze.remainingQty)||0)}),i.jsx(ou,{label:"Fechas Venta",value:ue}),i.jsx(ou,{label:"Lb/Un Vendidas",value:Na(H.units)}),i.jsx(ou,{label:"Facturado al costo",value:on(H.cogs)}),i.jsx(ou,{label:"Monto Venta",value:on(H.revenue)}),i.jsx(ou,{label:"Utilidad bruta",value:on(H.profit),valueClass:H.profit>=0?"text-green-700 font-semibold":"text-red-700 font-semibold"})]})})]},H.productName)})})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Categora"}),i.jsx("th",{className:"border p-2",children:"Descripcin"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Estado"})]})}),i.jsxs("tbody",{children:[c.map(H=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:H.date}),i.jsx("td",{className:"border p-1",children:H.category}),i.jsx("td",{className:"border p-1",children:H.description}),i.jsx("td",{className:"border p-1",children:on(H.amount)}),i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${H.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:H.status})})]},H.id)),c.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-3 text-center text-gray-500",children:"Sin gastos en el rango seleccionado."})})]})]})}),i.jsxs("div",{className:"md:hidden mb-6",children:[i.jsxs("button",{type:"button",onClick:R,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Gastos del periodo"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[c.length," registros"]})]}),i.jsx("div",{className:"text-gray-500",children:De?"Cerrar":"Abrir"})]}),De&&i.jsx("div",{className:"space-y-2 mt-3",children:c.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-sm text-gray-500 bg-gray-50",children:"Sin gastos en el rango seleccionado."}):c.map(H=>{const L=!!ce[H.id],ue=H.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700";return i.jsxs("div",{className:"border rounded-2xl bg-white shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",onClick:()=>ut(H.id),className:"w-full text-left px-3 py-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:H.category}),i.jsx("span",{className:`px-2 py-0.5 rounded text-[11px] ${ue}`,children:H.status})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[H.date,"  ",i.jsx("b",{children:on(H.amount)})]})]}),i.jsx("div",{className:"text-gray-500 text-sm pt-0.5",children:L?"Cerrar":"Ver"})]}),L&&i.jsx("div",{className:"px-3 pb-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[i.jsx(ou,{label:"Fecha",value:H.date}),i.jsx(ou,{label:"Categora",value:H.category}),i.jsx(ou,{label:"Descripcin",value:H.description||""}),i.jsx(ou,{label:"Monto",value:on(H.amount)}),i.jsx(ou,{label:"Estado",value:H.status||""})]})})]},H.id)})})]})]})]})]}),m&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:m.name}),i.jsx("button",{type:"button",onClick:()=>p(null),className:"text-sm text-gray-500 hover:text-gray-700",children:""})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Libras/Unidades"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Fecha Venta"})]})}),i.jsx("tbody",{children:m.products.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"border p-2 text-center text-gray-500",children:"Sin productos asociados."})}):m.products.map(H=>i.jsxs("tr",{children:[i.jsx("td",{className:"border p-1",children:H.productName}),i.jsx("td",{className:"border p-1 text-center",children:Na(H.qty)}),i.jsx("td",{className:"border p-1 text-center",children:on(H.amount)}),i.jsx("td",{className:"border p-1 text-center",children:m.lastSaleDate||""})]},`${H.productName}-${H.measurement}`))})]})})]})})]})}function ys({title:t,value:e,positive:r,negative:n,valueClass:a,subtitle:s}){const o=a||(r?"text-[#568203]":n?"text-[#AB274F]":"");return i.jsxs("div",{className:"border rounded-2xl p-3 bg-white",children:[i.jsx("div",{className:"text-[13px] sm:text-[17px] text-gray-500",children:t}),s?i.jsx("div",{className:"text-[11px] sm:text-[12px] text-gray-400",children:s}):null,i.jsx("div",{className:`text-[26px] sm:text-[30px] font-bold ${o}`,children:e})]})}function rc({title:t,value:e}){return i.jsxs("div",{className:"border rounded-lg p-3 bg-white",children:[i.jsx("div",{className:"text-[13px] sm:text-[17px] text-gray-500",children:t}),i.jsx("div",{className:"text-[18px] sm:text-[20px] font-semibold",children:e})]})}function gH({title:t,items:e}){return i.jsxs("div",{className:"border rounded-lg p-3 bg-white",children:[i.jsx("div",{className:"text-[11px] text-gray-500 mb-1",children:t}),i.jsx("ul",{className:"text-sm leading-snug list-none pl-0 m-0 space-y-0.5",children:e.length===0?i.jsx("li",{className:"text-gray-500",children:""}):e.map(r=>i.jsxs("li",{children:[r.label," ",r.value??""]},r.key))})]})}function ou({label:t,value:e,valueClass:r}){return i.jsxs("div",{className:"border rounded-xl p-2 bg-gray-50",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:t}),i.jsx("div",{className:`text-sm mt-0.5 ${r||""}`,children:e})]})}function H3e({open:t,onClose:e,children:r}){return t?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 max-w-lg w-full relative",children:[i.jsx("button",{className:"absolute top-2 right-2 text-gray-500 hover:text-gray-700 text-2xl font-bold",onClick:e,"aria-label":"Cerrar",children:""}),r]})}):null}const k5=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal","Varios"],g0=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function $3e(){const{refreshKey:t,refresh:e}=bc(),[r,n]=g.useState(Kr(Gu(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Kr($u(new Date),"yyyy-MM-dd")),[o,l]=g.useState(Kr(new Date,"yyyy-MM-dd")),[c,d]=g.useState(""),[u,f]=g.useState(""),[A,h]=g.useState(0),[m,p]=g.useState("PENDIENTE"),[x,v]=g.useState(""),[y,b]=g.useState([]),[w,I]=g.useState(!0),[j,N]=g.useState(""),[S,E]=g.useState(null),[B,k]=g.useState(""),[T,P]=g.useState(""),[q,de]=g.useState(""),[ce,le]=g.useState(0),[he,ae]=g.useState("PENDIENTE"),[Ce,De]=g.useState(""),[O,R]=g.useState(!1),G=()=>R(!0),M=()=>R(!1),[K,Y]=g.useState(null),D=Ee=>Y(Ze=>Ze===Ee?null:Ee);g.useEffect(()=>{(async()=>{I(!0),N("");try{const Ee=ar(xt(Ne,"expenses"),kn("date","desc")),Ze=await Ut(Ee),ot=[];Ze.forEach(vt=>{const _t=vt.data();ot.push({id:vt.id,date:_t.date||Kr(new Date,"yyyy-MM-dd"),category:_t.category||"",description:_t.description||"",amount:Number(_t.amount||0),status:_t.status||"PENDIENTE",notes:_t.notes||"",createdAt:_t.createdAt??Nr.now()})}),b(ot)}catch(Ee){console.error(Ee),N(" Error al cargar gastos")}finally{I(!1)}})()},[t]);const V=g.useMemo(()=>y.filter(Ee=>!(r&&Ee.date<r||a&&Ee.date>a)),[y,r,a]),te=g.useMemo(()=>{const Ee=V.reduce((vt,_t)=>vt+(_t.amount||0),0),Ze=V.filter(vt=>vt.status==="PAGADO").reduce((vt,_t)=>vt+(_t.amount||0),0),ot=Ee-Ze;return{total:Ee,pagado:Ze,pendiente:ot}},[V]),ve=()=>{l(Kr(new Date,"yyyy-MM-dd")),d(""),f(""),h(0),p("PENDIENTE"),v("")},Q=async Ee=>{if(Ee.preventDefault(),N(""),!c)return N("Selecciona una categora.");if(!u.trim())return N("Ingresa una descripcin.");if(!A||A<=0)return N("Ingresa un monto vlido.");try{const Ze={date:o,category:c,description:u.trim(),amount:Number(Number(A||0).toFixed(2)),status:m,notes:x||"",createdAt:Nr.now()},ot=await ta(xt(Ne,"expenses"),Ze);b(vt=>[{id:ot.id,...Ze},...vt]),ve(),N(" Gasto registrado")}catch(Ze){console.error(Ze),N(" Error al guardar gasto")}},Xe=Ee=>{N(""),E(Ee.id),k(Ee.date),P(Ee.category||""),de(Ee.description||""),le(Number(Ee.amount||0)),ae(Ee.status||"PENDIENTE"),De(Ee.notes||"")},se=()=>{E(null),k(""),P(""),de(""),le(0),ae("PENDIENTE"),De("")},Z=async()=>{if(S){if(!T)return N("Selecciona una categora.");if(!q.trim())return N("Ingresa una descripcin.");if(!ce||ce<=0)return N("Ingresa un monto vlido.");try{const Ee={date:B,category:T,description:q.trim(),amount:Number(Number(ce||0).toFixed(2)),status:he,notes:Ce||""};await Mn(Kt(Ne,"expenses",S),Ee),b(Ze=>Ze.map(ot=>ot.id===S?{...ot,...Ee}:ot)),se(),N(" Gasto actualizado")}catch(Ee){console.error(Ee),N(" Error al actualizar gasto")}}},ke=async Ee=>{if(confirm(`Eliminar el gasto "${Ee.description}"?`))try{await na(Kt(Ne,"expenses",Ee.id)),b(ot=>ot.filter(vt=>vt.id!==Ee.id)),N(" Gasto borrado")}catch(ot){console.error(ot),N(" Error al borrar gasto")}},Se=Ee=>Ee==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700";return i.jsxs("div",{className:"max-w-6xl mx-auto px-3 sm:px-0",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2 flex-wrap",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Gastos (Pollo)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",onClick:G,type:"button",children:"Crear pago"}),i.jsx(yc,{onClick:e,loading:w})]})]}),i.jsxs("div",{className:"bg-white p-3 rounded-2xl shadow-2xl border mb-4 flex flex-col sm:flex-row sm:items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:Ee=>n(Ee.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:Ee=>s(Ee.target.value)})]})]}),i.jsxs("div",{className:"sm:ml-auto text-sm bg-gray-50 border rounded-xl p-3",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",g0(te.total)]}),i.jsxs("div",{children:["Pagado: ",g0(te.pagado)]}),i.jsxs("div",{children:["Pendiente: ",g0(te.pendiente)]})]})]}),i.jsxs(H3e,{open:O,onClose:M,children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Crear gasto"}),i.jsxs("form",{onSubmit:Ee=>{Q(Ee),!(!c||!u.trim()||!A||A<=0)&&M()},className:"grid grid-cols-1 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:o,onChange:Ee=>l(Ee.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:c,onChange:Ee=>d(Ee.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),k5.map(Ee=>i.jsx("option",{value:Ee,children:Ee},Ee))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:u,onChange:Ee=>f(Ee.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:A===0?"":A,onChange:Ee=>{const Ze=String(Ee.target.value||"").replace(",","."),ot=parseFloat(Ze);h(Number.isFinite(ot)?Math.max(0,ot):0)},placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:Ee=>p(Ee.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:x,onChange:Ee=>v(Ee.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[x.length,"/500"]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"}),i.jsx("button",{type:"button",className:"bg-gray-200 px-4 py-2 rounded hover:bg-gray-300",onClick:()=>{ve(),M()},children:"Cancelar"})]})]}),j&&i.jsx("p",{className:"mt-2 text-sm",children:j})]}),i.jsx("div",{className:"block md:hidden space-y-3",children:w?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Cargando"}):V.length===0?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Sin gastos en el rango seleccionado."}):V.map(Ee=>{const Ze=K===Ee.id,ot=S===Ee.id;return i.jsxs("div",{className:"bg-white border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full text-left px-3 py-3 flex items-start justify-between bg-white",onClick:()=>D(Ee.id),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:Ee.description}),i.jsxs("div",{className:"text-xs text-gray-500",children:[Ee.category||"","  ",Ee.date]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"font-bold",children:g0(Ee.amount)}),i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Se(Ee.status)}`,children:Ee.status})]})]}),Ze&&i.jsxs("div",{className:"p-3",children:[i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:Ee.notes?Ee.notes:""}),ot?i.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2 text-sm",children:[i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:B,onChange:vt=>k(vt.target.value)}),i.jsxs("select",{className:"w-full border p-2 rounded",value:T,onChange:vt=>P(vt.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),k5.map(vt=>i.jsx("option",{value:vt,children:vt},vt))]}),i.jsx("input",{className:"w-full border p-2 rounded",value:q,onChange:vt=>de(vt.target.value)}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:Number.isNaN(ce)?"":ce,onChange:vt=>{const _t=String(vt.target.value||"").replace(",","."),Tt=parseFloat(_t);le(Number.isFinite(Tt)?Math.max(0,Tt):0)}}),i.jsxs("select",{className:"w-full border p-2 rounded",value:he,onChange:vt=>ae(vt.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Ce,onChange:vt=>De(vt.target.value),maxLength:500}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Z,children:"Guardar"}),i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:se,children:"Cancelar"})]})]}):i.jsxs("div",{className:"mt-3 flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Xe(Ee),children:"Editar"}),i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>ke(Ee),children:"Borrar"})]})]})]},Ee.id)})}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded-2xl shadow-2xl border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-2 py-1 text-left",children:"Fecha"}),i.jsx("th",{className:"px-2 py-1 text-left",children:"Categora"}),i.jsx("th",{className:"px-2 py-1 text-left",children:"Descripcin"}),i.jsx("th",{className:"px-2 py-1 text-right",children:"Monto"}),i.jsx("th",{className:"px-2 py-1 text-center",children:"Estado"}),i.jsx("th",{className:"px-2 py-1 text-left",children:"Comentario"}),i.jsx("th",{className:"px-2 py-1 text-center",children:"Acciones"})]})}),i.jsx("tbody",{children:w?i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"text-center py-4",children:"Cargando"})}):V.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"text-center py-4",children:"Sin gastos en el rango seleccionado."})}):V.map(Ee=>{const Ze=S===Ee.id;return i.jsx("tr",{className:Ze?"bg-yellow-50":"",children:Ze?i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"px-2 py-1",children:i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:B,onChange:ot=>k(ot.target.value)})}),i.jsx("td",{className:"px-2 py-1",children:i.jsxs("select",{className:"w-full border p-1 rounded",value:T,onChange:ot=>P(ot.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),k5.map(ot=>i.jsx("option",{value:ot,children:ot},ot))]})}),i.jsx("td",{className:"px-2 py-1",children:i.jsx("input",{className:"w-full border p-1 rounded",value:q,onChange:ot=>de(ot.target.value)})}),i.jsx("td",{className:"px-2 py-1 text-right",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(ce)?"":ce,onChange:ot=>{const vt=String(ot.target.value||"").replace(",","."),_t=parseFloat(vt);le(Number.isFinite(_t)?Math.max(0,_t):0)}})}),i.jsx("td",{className:"px-2 py-1 text-center",children:i.jsxs("select",{className:"w-full border p-1 rounded",value:he,onChange:ot=>ae(ot.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})}),i.jsx("td",{className:"px-2 py-1",children:i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:Ce,onChange:ot=>De(ot.target.value),maxLength:500})}),i.jsxs("td",{className:"px-2 py-1 text-center flex gap-1",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Z,children:"Guardar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:se,children:"Cancelar"})]})]}):i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"px-2 py-1",children:Ee.date}),i.jsx("td",{className:"px-2 py-1",children:Ee.category||""}),i.jsx("td",{className:"px-2 py-1",children:Ee.description}),i.jsx("td",{className:"px-2 py-1 text-right",children:g0(Ee.amount)}),i.jsx("td",{className:"px-2 py-1 text-center",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Se(Ee.status)}`,children:Ee.status})}),i.jsx("td",{className:"px-2 py-1",children:Ee.notes?Ee.notes:""}),i.jsxs("td",{className:"px-2 py-1 text-center flex gap-1",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Xe(Ee),children:"Editar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>ke(Ee),children:"Borrar"})]})]})},Ee.id)})})]})}),i.jsxs("div",{className:"mt-6 flex flex-col md:flex-row gap-4 justify-center items-stretch",children:[i.jsxs("div",{className:"flex-1 bg-blue-50 border border-blue-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-blue-700 font-semibold mb-1",children:"Total"}),i.jsx("div",{className:"text-2xl font-bold text-blue-900",children:g0(te.total)})]}),i.jsxs("div",{className:"flex-1 bg-green-50 border border-green-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-green-700 font-semibold mb-1",children:"Pagado"}),i.jsx("div",{className:"text-2xl font-bold text-green-900",children:g0(te.pagado)})]}),i.jsxs("div",{className:"flex-1 bg-yellow-50 border border-yellow-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-yellow-700 font-semibold mb-1",children:"Pendiente"}),i.jsx("div",{className:"text-2xl font-bold text-yellow-900",children:g0(te.pendiente)})]})]}),j&&i.jsx("p",{className:"mt-2 text-sm",children:j})]})}function KS(t){return(t||"").trim().toLowerCase()}async function yne(){const t=await Ut(xt(Ne,"products")),e=new Map;return t.forEach(r=>{const n=r.data(),a=KS(n.name??n.productName);a&&e.set(a,r.id)}),e}async function G3e(t=!1){const e=await yne(),r=await Ut(xt(Ne,"inventory_batches")),n={checked:0,fixed:0,alreadyOk:0,missingName:0,withoutMatch:0,details:[]};for(const a of r.docs){n.checked++;const s=a.data(),o=KS(s.productName);if(!o){n.missingName++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,status:"missingName"});continue}const l=e.get(o);if(!l){n.withoutMatch++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,status:"withoutMatch"});continue}if(s.productId===l){n.alreadyOk++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,newProductId:l,status:"alreadyOk"});continue}t||await Mn(Kt(Ne,"inventory_batches",a.id),{productId:l}),n.fixed++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,newProductId:l,status:"fixed"})}return console.group("[fixAllBatchProductIds] Resultado"),console.log("checked:",n.checked),console.log("fixed:",n.fixed),console.log("alreadyOk:",n.alreadyOk),console.log("missingName:",n.missingName),console.log("withoutMatch:",n.withoutMatch),console.groupEnd(),n}async function K3e(t,e=!1){const r=KS(t),a=(await yne()).get(r);if(!a)throw new Error(`No existe un producto activo con nombre "${t}".`);const s=await Ut(xt(Ne,"inventory_batches"));let o=0;for(const l of s.docs){const c=l.data();KS(c.productName)===r&&c.productId!==a&&(e||await Mn(Kt(Ne,"inventory_batches",l.id),{productId:a}),o++)}return console.log(`[fixBatchesByProductName] "${t}" fixed: ${o} lote(s)`),o}function q3e(){const[t,e]=g.useState(!1),[r,n]=g.useState(""),a=async()=>{try{e(!0),n("");const c=await G3e(!1);n(` Hecho. Revisados: ${c.checked}, Corregidos: ${c.fixed}, Ok: ${c.alreadyOk}, Sin nombre: ${c.missingName}, Sin match: ${c.withoutMatch}. (Mira consola para detalles)`)}catch(c){n(" Error: "+((c==null?void 0:c.message)||c))}finally{e(!1)}},[s,o]=g.useState(""),l=async()=>{if(!s.trim()){n(" Escribe el nombre del producto.");return}try{e(!0),n("");const c=await K3e(s.trim(),!1);n(` Hecho. Corregidos ${c} lote(s) para "${s}".`)}catch(c){n(" Error: "+((c==null?void 0:c.message)||c))}finally{e(!1)}};return i.jsxs("div",{className:"max-w-xl mx-auto bg-white p-6 rounded shadow border space-y-4",children:[i.jsx("h1",{className:"text-xl font-bold",children:"Herramienta de Migracin de Lotes"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Corrige los ",i.jsx("code",{children:"inventory_batches.productId"})," basndose en el nombre del producto. salo una sola vez para limpiar datos viejos. Revisa la consola para un log detallado."]}),i.jsx("div",{className:"space-y-2",children:i.jsx("button",{onClick:a,disabled:t,className:"bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-60",children:t?"Corriendo":"Corregir TODOS los lotes"})}),i.jsx("hr",{}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Corregir por nombre:"}),i.jsx("input",{className:"border p-2 rounded w-full",placeholder:'Ej: "Pierna Entera"',value:s,onChange:c=>o(c.target.value)}),i.jsx("button",{onClick:l,disabled:t,className:"bg-indigo-600 text-white px-4 py-2 rounded disabled:opacity-60",children:t?"Corriendo":"Corregir lotes de ese producto"})]}),r&&i.jsx("p",{className:"text-sm",children:r})]})}const lu=t=>`C$ ${(Number(t)||0).toFixed(2)}`,x0=t=>Number(t||0).toFixed(3),F5=(t,e)=>{var a,s,o,l;const r=t._raw||{},n=t.customerName||r.customerName||((a=r.customer)==null?void 0:a.name)||r.clientName||((s=r.client)==null?void 0:s.name)||"";return t.type==="CONTADO"&&n?n:(t.customerId?e[t.customerId]:"")||t.customerName||r.customerName||((o=r.customer)==null?void 0:o.name)||r.clientName||((l=r.client)==null?void 0:l.name)||"Nombre cliente"},xH=t=>{const e=t._raw||{},r=wne(e)||t.date,n=Zx(r);return isFinite(n)?n:NaN},O5=t=>String((t==null?void 0:t.status)||"").toUpperCase()==="PROCESADA"||t!=null&&t.closureId||t!=null&&t.closureDate||t!=null&&t.processedDate?"PROCESADA":"FLOTANTE",z3e=t=>String(t??"").toLowerCase().trim(),vH=t=>["lb","lbs","libra","libras"].includes(z3e(t)),yH=t=>Number((t==null?void 0:t.qty)??(t==null?void 0:t.quantity)??0)||0,W3e=t=>t?Array.isArray(t.items)&&t.items.length>0?t.items.reduce((e,r)=>vH((r==null?void 0:r.measurement)??(t==null?void 0:t.measurement))?e+yH(r):e,0):vH(t==null?void 0:t.measurement)?yH(t):0:0;function bne(t){if(!t)return"";if(t!=null&&t.toDate)return Kr(t.toDate(),"yyyy-MM-dd");const e=String(t).trim();if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const r=["dd/MM/yyyy","d/M/yyyy","MM/dd/yyyy","M/d/yyyy","yyyy/MM/dd","yyyy-M-d","yyyy/M/d","yyyy-MM-dd'T'HH:mm:ss","yyyy-MM-dd'T'HH:mm:ss.SSSX"];for(const a of r){const s=jS(e,a,new Date);if(H6(s))return Kr(s,"yyyy-MM-dd")}const n=new Date(e);return isNaN(n.getTime())?"":Kr(n,"yyyy-MM-dd")}function Zx(t){const e=bne(t);if(!e)return NaN;const r=jS(e,"yyyy-MM-dd",new Date);return H6(r)?r.getTime():NaN}function wne(t){var n,a;const e=bne(t==null?void 0:t.date),r=(n=t==null?void 0:t.createdAt)!=null&&n.toDate?t.createdAt.toDate():null;if(e&&r){const s=Zx(e),o=r.getTime();if(Math.abs(o-s)/(1e3*60*60*24)>30)return Kr(r,"yyyy-MM-dd")}return e||((a=t==null?void 0:t.timestamp)!=null&&a.toDate?Kr(t.timestamp.toDate(),"yyyy-MM-dd"):r?Kr(r,"yyyy-MM-dd"):"")}function X3e(t,e){var s,o,l,c;const r=wne(t);if(!r)return null;let n=0,a=0;return Array.isArray(t.items)&&t.items.length>0?(n=t.items.reduce((d,u)=>d+(Number(u.qty??u.quantity??u.lbs??0)||0),0),a=Number(t.amount??t.total??0)||0):(n=Number(t.quantity??t.lbs??t.weight??0)||0,a=Number(t.amount??t.total??0)||0),{id:e,date:r,type:t.type||"CONTADO",total:a,quantity:n,customerId:t.customerId||((s=t.customer)==null?void 0:s.id)||((o=t.customer)==null?void 0:o.customerId)||t.clientId||void 0,customerName:t.customerName||((l=t.customer)==null?void 0:l.name)||t.clientName||((c=t.client)==null?void 0:c.name)||void 0,_raw:t}}async function Y3e(t){const e=ar(xt(Ne,"ar_movements"),lr("ref.saleId","==",t)),r=await Ut(e);await Promise.all(r.docs.map(n=>na(Kt(Ne,"ar_movements",n.id))))}function J3e({role:t="",sellerCandyId:e="",roles:r}){const n=r&&r.length?r:t,a=Rn(n,"vendedor_pollo"),s=Rn(n,"admin");if(!(Rn(n,"admin")||Rn(n,"vendedor_pollo")||Rn(n,"supervisor_pollo")||Rn(n,"contador")))return i.jsx("div",{className:"p-6 max-w-4xl mx-auto text-center text-red-600",children:"Acceso restringido  Solo administradores, vendedores y supervisores de pollo."});const o=s?8:7,[l,c]=g.useState(!1),[d,u]=g.useState(!1),[f,A]=g.useState(null),[h,m]=g.useState([]),p=async Fe=>{c(!0),u(!0),A(Fe),m([]);try{const je=await Es(Kt(Ne,"salesV2",Fe)),We=je.exists()?je.data():null;if(!We){m([]);return}let ee=[];if(Array.isArray(We.items)&&We.items.length>0)ee=We.items;else if(We.items&&typeof We.items=="object")try{ee=Object.values(We.items)}catch{ee=[]}else We.item?ee=[We.item]:Array.isArray(We.products)&&We.products.length>0?ee=We.products:Array.isArray(We.lines)&&We.lines.length>0?ee=We.lines:Array.isArray(We.detalles)&&We.detalles.length>0?ee=We.detalles:(We.productName||We.product)&&(ee=[{productName:We.productName||We.product||"",qty:We.qty??We.quantity??We.lbs??0,unitPrice:We.unitPrice??We.price??0,discount:We.discount??0,total:We.total??We.amount??0}]);const Ve=pe=>{if(pe==null)return NaN;if(typeof pe=="number")return pe;let fe=String(pe).trim();if(!fe)return NaN;if(fe=fe.replace(/[^0-9.,-]/g,""),!fe)return NaN;fe.indexOf(".")>-1&&fe.indexOf(",")>-1?fe=fe.replace(/,/g,""):fe.indexOf(",")>-1&&fe.indexOf(".")===-1&&(fe=fe.replace(/,/g,"."));const Me=Number(fe);return isNaN(Me)?NaN:Me},rt=new Set;for(const pe of ee)if(Array.isArray(pe==null?void 0:pe.allocations))for(const fe of pe.allocations){const Me=String((fe==null?void 0:fe.batchId)||"").trim();Me&&rt.add(Me)}else if(pe!=null&&pe.allocations&&typeof pe.allocations=="object")try{for(const fe of Object.values(pe.allocations)){const Me=String((fe==null?void 0:fe.batchId)||"").trim();Me&&rt.add(Me)}}catch{}if(Array.isArray(We==null?void 0:We.allocations))for(const pe of We.allocations){const fe=String((pe==null?void 0:pe.batchId)||"").trim();fe&&rt.add(fe)}const $e={};rt.size>0&&await Promise.all(Array.from(rt).map(async pe=>{try{const fe=await Es(Kt(Ne,"inventory_batches",pe));if(fe.exists()){const Me=fe.data();$e[pe]=Number(Me.salePrice??Me.sale_price??Me.price??0)}}catch{}}));const ie=ee.map(pe=>{const fe=String(pe.productName||pe.product||pe.name||"(sin nombre)"),Me=Number(pe.qty??pe.quantity??pe.lbs??pe.weight??0)||0,me=Ve(pe.total??pe.lineFinal??pe.amount??pe.monto??pe.line_total)||0;let ye=0;const mt=[pe.unitPrice,pe.unitPricePackage,pe.salePrice,pe.sale_price,pe.price,pe.unit_price,pe.pricePerUnit,pe.price_per_unit];for(const Pt of mt){const Ft=Ve(Pt);if(!isNaN(Ft)&&Ft!==0){ye=Ft;break}}if(!ye){const Pt=(We==null?void 0:We.salePrice)??(We==null?void 0:We.sale_price)??(We==null?void 0:We.unitPrice)??(We==null?void 0:We.unit_price)??(We==null?void 0:We.price)??(We==null?void 0:We.pricePerUnit),Ft=Ve(Pt);!isNaN(Ft)&&Ft!==0&&(ye=Ft)}if(!ye){const Pt=Array.isArray(pe.allocations)?pe.allocations[0]:pe.allocations&&typeof pe.allocations=="object"?Object.values(pe.allocations)[0]:null,Ft=Pt?String(Pt.batchId||"").trim():"";Ft&&$e[Ft]&&(ye=$e[Ft]||0)}!ye&&pe.productId&&(ye=productPriceMap[String(pe.productId)]||0),(!ye||ye===0)&&me>0&&Me>0&&(ye=me/Me);const gt=Ve(pe.discount??pe.desc??0)||0;let yt=me;return(!yt||yt===0)&&(yt=Number(ye*Me||0)),yt=Number(yt)||0,{productName:fe,qty:Me,unitPrice:ye,discount:gt,total:yt}});m(ie)}catch(je){console.error(je)}finally{u(!1)}},[x,v]=g.useState(Kr(new Date,"yyyy-MM-01")),[y,b]=g.useState(Kr(new Date,"yyyy-MM-dd")),[w,I]=g.useState([]),[j,N]=g.useState([]),[S,E]=g.useState([]),[B,k]=g.useState(!0),[T,P]=g.useState(""),{refreshKey:q,refresh:de}=bc(),[ce,le]=g.useState(""),[he,ae]=g.useState(""),[Ce,De]=g.useState("ALL"),[O,R]=g.useState(""),[G,M]=g.useState(null),K=15,[Y,D]=g.useState(1),V=g.useMemo(()=>{const Fe={};return w.forEach(je=>Fe[je.id]=je.name),Fe},[w]);g.useEffect(()=>{Ce!=="ALL"&&!S.includes(Ce)&&De("ALL")},[S,Ce]),g.useEffect(()=>{(async()=>{k(!0),P("");try{const Fe=[];if(a&&e){const me=ar(xt(Ne,"customers_pollo"),lr("vendorId","==",e),kn("createdAt","desc"));(await Ut(me)).forEach(mt=>Fe.push({id:mt.id,name:mt.data().name||""}))}else(await Ut(ar(xt(Ne,"customers_pollo"),kn("createdAt","desc")))).forEach(ye=>Fe.push({id:ye.id,name:ye.data().name||""}));I(Fe);const je={};Fe.forEach(me=>{je[me.id]=me.name});const[We,ee,Ve]=await Promise.all([Ut(ar(xt(Ne,"salesV2"),kn("timestamp","desc"))),Ut(ar(xt(Ne,"daily_closures"),kn("createdAt","desc"))),Ut(ar(xt(Ne,"ar_movements_pollo"),lr("date",">=",x),lr("date","<=",y)))]),rt=new Map;Ve.forEach(me=>{var yt;const ye=me.data(),mt=String(((yt=ye==null?void 0:ye.ref)==null?void 0:yt.saleId)||"").trim(),gt=String((ye==null?void 0:ye.customerId)||"").trim();mt&&gt&&rt.set(mt,gt)});const $e=new Map;ee.forEach(me=>{const ye=me.data(),mt=Array.isArray(ye==null?void 0:ye.salesV2)?ye.salesV2:[];for(const gt of mt){const yt=String((gt==null?void 0:gt.id)||"").trim();if(!yt)continue;const Pt=yt.split("#")[0];(String((gt==null?void 0:gt.status)||"").toUpperCase()==="PROCESADA"||gt!=null&&gt.closureDate||gt!=null&&gt.processedDate)&&$e.set(Pt,{closureDate:gt==null?void 0:gt.closureDate,processedDate:gt==null?void 0:gt.processedDate})}});const ie=[];We.forEach(me=>{const ye=me.data(),mt=$e.get(me.id),gt=rt.get(me.id);!ye.customerId&&gt&&(ye.customerId=gt),!ye.customerName&&gt&&(ye.customerName=je[gt]||""),mt&&(ye.status="PROCESADA",!ye.closureDate&&mt.closureDate&&(ye.closureDate=mt.closureDate),!ye.processedDate&&mt.processedDate&&(ye.processedDate=mt.processedDate));const yt=X3e(ye,me.id);yt&&ie.push(yt)});const pe=ie.sort((me,ye)=>ye.date.localeCompare(me.date));N(pe);const fe=Zx(x),Me=Zx(y);E(Array.from(new Set(pe.filter(me=>{const ye=xH(me);return!(!isFinite(ye)||isFinite(fe)&&ye<fe||isFinite(Me)&&ye>Me)}).map(me=>{var ye,mt,gt,yt;return((ye=me._raw)==null?void 0:ye.productName)||((yt=(gt=(mt=me._raw)==null?void 0:mt.items)==null?void 0:gt[0])==null?void 0:yt.productName)||"(sin producto)"}))).sort()),D(1)}catch(Fe){console.error(Fe),P(" Error cargando transacciones.")}finally{k(!1)}})()},[x,y,q]);const te=g.useMemo(()=>{const Fe=Zx(x),je=Zx(y);return j.filter(We=>{const ee=xH(We);return!(!isFinite(ee)||isFinite(Fe)&&ee<Fe||isFinite(je)&&ee>je)})},[j,x,y]),ve=g.useMemo(()=>te.filter(Fe=>{var je,We,ee,Ve;if(ce&&Fe.customerId!==ce||he&&Fe.type!==he)return!1;if(Ce&&Ce!=="ALL"){const rt=((je=Fe._raw)==null?void 0:je.productName)||((Ve=(ee=(We=Fe._raw)==null?void 0:We.items)==null?void 0:ee[0])==null?void 0:Ve.productName)||"";if(!rt||rt!==Ce)return!1}return!(O&&O5(Fe._raw)!==O)}),[te,ce,he,Ce,O]),Q=g.useMemo(()=>{let Fe=0,je=0,We=0,ee=0;for(const $e of ve){const ie=W3e($e._raw);$e.type==="CONTADO"?(Fe+=ie,We+=$e.total):(je+=ie,ee+=$e.total)}const Ve=Fe+je,rt=We+ee;return{packsCash:Fe,packsCredito:je,packsTotal:Ve,montoCash:We,montoCredito:ee,montoTotal:rt}},[ve]),Xe=g.useMemo(()=>{let Fe=0,je=0;for(const ee of ve)ee.type==="CONTADO"?Fe+=ee.quantity:je+=ee.quantity;const We=Fe+je;return{unidadesCash:Fe,unidadesCredito:je,unidadesTotal:We}},[ve]),se=Math.max(1,Math.ceil(ve.length/K)),Z=g.useMemo(()=>{const Fe=(Y-1)*K;return ve.slice(Fe,Fe+K)},[ve,Y]),[ke,Se]=g.useState(!1),[Ee,Ze]=g.useState(!1),[ot,vt]=g.useState(!1),_t=g.useMemo(()=>{const Fe=new Map;return Z.forEach(je=>{var Ve,rt,$e,ie;const We=((Ve=je._raw)==null?void 0:Ve.productName)||((ie=($e=(rt=je._raw)==null?void 0:rt.items)==null?void 0:$e[0])==null?void 0:ie.productName)||"(sin producto)";Fe.has(We)||Fe.set(We,{cash:[],credit:[]});const ee=Fe.get(We);je.type==="CONTADO"?ee.cash.push(je):ee.credit.push(je)}),Array.from(Fe.entries()).sort((je,We)=>je[0].localeCompare(We[0]))},[Z]);g.useMemo(()=>f&&j.find(Fe=>Fe.id===f)||null,[f,j]);const Tt=async Fe=>{if(s&&(M(null),!!window.confirm("Eliminar esta venta? Se restaurar el inventario asociado.")))try{k(!0),await tne(Fe.id),await Y3e(Fe.id),N(je=>je.filter(We=>We.id!==Fe.id)),P(" Venta eliminada")}catch(je){console.error(je),P(" No se pudo eliminar la venta.")}finally{k(!1)}},Lt=()=>{const Fe=`Ventas del dia  ${x} a ${y}`,je=rt=>(rt||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),We=ve.map(rt=>{var ie,pe,fe,Me;const $e=F5(rt,V);return(ie=rt._raw)!=null&&ie.productName||(Me=(fe=(pe=rt._raw)==null?void 0:pe.items)==null?void 0:fe[0])!=null&&Me.productName,`<tr>
          <td>${rt.date}</td>
          <td>${je($e)}</td>
          <td>${rt.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${rt.quantity}</td>
          <td style="text-align:right">${lu(rt.total)}</td>
        </tr>`}).join(""),ee=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${je(Fe)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${je(Fe)}</h1>
      <div class="kpis">

      
        <div><b>Unidades Cash:</b> ${x0(Xe.unidadesCash)}</div>
        <div><b>Unidades Crdito:</b> ${x0(Xe.unidadesCredito)}</div>
        <div><b>Total Unidades:</b> ${x0(Xe.unidadesTotal)}</div>
      </div>

      <div class="kpis">
        <div><b>Libras Cash:</b> ${Q.packsCash}</div>
        <div><b>Libras Crdito:</b> ${Q.packsCredito}</div>
        <div><b>Ventas Cash:</b> ${lu(Q.montoCash)}</div>
        <div><b>Ventas Crdito:</b> ${lu(Q.montoCredito)}</div>
      </div>

      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Libras</th><th>Ventas</th>
      </tr></thead><tbody>
      ${We||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,Ve=window.open("","_blank");Ve&&(Ve.document.open(),Ve.document.write(ee),Ve.document.close())},Rt=()=>D(1),Et=()=>D(Fe=>Math.max(1,Fe-1)),Re=()=>D(Fe=>Math.min(se,Fe+1)),Te=()=>D(se),Ye=()=>{const Fe=[];if(se<=7)for(let We=1;We<=se;We++)Fe.push(We);else{const We=Math.max(1,Y-2),ee=Math.min(se,Y+2);Fe.push(1),We>2&&Fe.push(-1);for(let Ve=We;Ve<=ee;Ve++)Ve!==1&&Ve!==se&&Fe.push(Ve);ee<se-1&&Fe.push(-2),Fe.push(se)}return i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Rt,disabled:Y===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Et,disabled:Y===1,children:" Anterior"}),Fe.map((We,ee)=>typeof We=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${We===Y?"bg-blue-600 text-white":""}`,onClick:()=>D(We),children:We},ee):i.jsx("span",{className:"px-2",children:""},ee)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Re,disabled:Y===se,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Te,disabled:Y===se,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",Y," de ",se,"  ",ve.length," transaccin(es)"]})]})},dt=Fe=>{var Ve,rt,$e,ie,pe;const je=F5(Fe,V);let We="(sin producto)";Array.isArray((Ve=Fe._raw)==null?void 0:Ve.items)&&Fe._raw.items.length>0?We=Fe._raw.items.map(fe=>fe.productName||fe.product||fe.name||"(sin nombre)").join(", "):(rt=Fe._raw)!=null&&rt.productName?We=Fe._raw.productName:(pe=(ie=($e=Fe._raw)==null?void 0:$e.items)==null?void 0:ie[0])!=null&&pe.productName&&(We=Fe._raw.items[0].productName);const ee=O5(Fe._raw);return i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:je}),i.jsx("div",{className:"text-xs text-gray-600 shrink-0",children:Fe.date})]}),i.jsxs("div",{className:"mt-1 flex items-center gap-2 flex-wrap text-xs",children:[i.jsx("span",{className:`px-2 py-1 rounded-full border ${ee==="PROCESADA"?"bg-blue-50 border-blue-200 text-blue-700":"bg-gray-50 border-gray-200 text-gray-700"}`,children:ee}),i.jsx("span",{className:`px-2 py-1 rounded-full border ${Fe.type==="CREDITO"?"bg-yellow-50 border-yellow-200 text-yellow-700":"bg-green-50 border-green-200 text-green-700"}`,children:Fe.type==="CREDITO"?"Crdito":"Cash"}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Libras:"})," ",i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:fe=>{fe.preventDefault(),p(Fe.id)},title:"Ver detalle",children:x0(Fe.quantity)})]}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Monto:"})," ",lu(Fe.total)]})]})]}),i.jsx("div",{className:"text-gray-500 mt-1",children:i.jsx("span",{className:"inline-block transition-transform group-open:rotate-180",children:""})})]}),i.jsx("div",{className:"px-3 pb-3 pt-0 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2 border-t pt-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("span",{className:"font-medium text-right",children:je})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Producto"}),i.jsx("span",{className:"font-medium text-right",children:We})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha"}),i.jsx("span",{className:"font-medium",children:Fe.date})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Estado"}),i.jsx("span",{className:"font-medium",children:ee})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("span",{className:"font-medium",children:Fe.type==="CREDITO"?"Crdito":"Cash"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Libras"}),i.jsx("span",{className:"font-medium",children:i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:()=>p(Fe.id),title:"Ver detalle",children:x0(Fe.quantity)})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Monto"}),i.jsx("span",{className:"font-semibold",children:lu(Fe.total)})]}),i.jsx("div",{className:"flex items-center justify-between",children:s&&i.jsxs("div",{className:"pt-2 flex items-center justify-end gap-2 w-full",children:[i.jsx("button",{className:"px-3 py-2 rounded border hover:bg-gray-50",onClick:()=>M(fe=>fe===Fe.id?null:Fe.id),children:" Acciones"}),G===Fe.id&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>Tt(Fe),children:"Eliminar"})]})})]})})]})},Fe.id)};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas del dia"}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Se(Fe=>!Fe),"aria-expanded":ke,children:[i.jsx("span",{children:"Filtros de bsqueda"}),i.jsx("span",{className:`transition-transform ${ke?"rotate-180":""}`,children:""})]}),ke&&i.jsx("div",{className:"p-4 border-t",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-7 gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:x,onChange:Fe=>{v(Fe.target.value),D(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:y,onChange:Fe=>{b(Fe.target.value),D(1)}})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:ce,onChange:Fe=>{le(Fe.target.value),D(1)},children:[i.jsx("option",{value:"",children:"Todos"}),w.map(Fe=>i.jsx("option",{value:Fe.id,children:Fe.name},Fe.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:he,onChange:Fe=>{ae(Fe.target.value),D(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:Ce,onChange:Fe=>{De(Fe.target.value),D(1)},children:[i.jsx("option",{value:"ALL",children:"Todos"}),S.map(Fe=>i.jsx("option",{value:Fe,children:Fe},Fe))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Estado"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:O,onChange:Fe=>{R(Fe.target.value),D(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"FLOTANTE",children:"FLOTANTE"}),i.jsx("option",{value:"PROCESADA",children:"PROCESADA"})]})]}),i.jsx("button",{className:"sm:col-span-2 lg:col-span-1 px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 w-full",onClick:Lt,children:"Exportar PDF"}),i.jsx("div",{className:"sm:col-span-2 lg:col-span-1 flex",children:i.jsx(yc,{onClick:de,loading:B,className:"w-full justify-center"})})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Ze(Fe=>!Fe),"aria-expanded":Ee,children:[i.jsx("span",{children:"KPIs"}),i.jsx("span",{className:`transition-transform ${Ee?"rotate-180":""}`,children:""})]}),Ee&&i.jsx("div",{className:"p-4 border-t",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:x0(Q.packsCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:x0(Q.packsCredito)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:lu(Q.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:lu(Q.montoCredito)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Total"}),i.jsx("div",{className:"text-xl font-semibold",children:lu(Q.montoTotal)})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>vt(Fe=>!Fe),"aria-expanded":ot,children:[i.jsx("span",{children:"Transacciones"}),i.jsx("span",{className:`transition-transform ${ot?"rotate-180":""}`,children:""})]}),ot&&i.jsxs("div",{className:"p-3 border-t space-y-4",children:[i.jsxs("div",{className:"block md:hidden space-y-3",children:[B?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Cargando"}):Z.length===0?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Sin transacciones en el rango."}):_t.map(([Fe,je])=>i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"font-semibold",children:["Categora: ",Fe]}),i.jsxs("div",{className:"text-xs text-gray-500",children:[je.cash.length+je.credit.length," transaccin(es)"]})]}),i.jsxs("div",{className:"p-3 pt-0 space-y-3",children:[i.jsx("div",{className:"bg-gray-50 border rounded-lg",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-center justify-between",children:[i.jsx("div",{className:"font-semibold",children:"Cash"}),i.jsxs("div",{className:"text-xs text-gray-500",children:[je.cash.length," item(s)"]})]}),i.jsx("div",{className:"px-3 pb-3 space-y-3",children:je.cash.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"Sin transacciones cash."}):je.cash.map(dt)})]})}),i.jsx("div",{className:"bg-gray-50 border rounded-lg",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-center justify-between",children:[i.jsx("div",{className:"font-semibold",children:"Crdito"}),i.jsxs("div",{className:"text-xs text-gray-500",children:[je.credit.length," item(s)"]})]}),i.jsx("div",{className:"px-3 pb-3 space-y-3",children:je.credit.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"Sin transacciones crdito."}):je.credit.map(dt)})]})})]})]})},Fe)),i.jsx("div",{className:"bg-white p-3 rounded shadow border",children:Ye()})]}),i.jsxs("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Libras"}),i.jsx("th",{className:"p-2 border",children:"Ventas"}),s&&i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:B?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Cargando"})}):Z.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Sin transacciones en el rango."})}):Z.map(Fe=>{var Ve,rt,$e,ie,pe;const je=F5(Fe,V);let We="(sin producto)";Array.isArray((Ve=Fe._raw)==null?void 0:Ve.items)&&Fe._raw.items.length>0?We=Fe._raw.items.map(fe=>fe.productName||fe.product||fe.name||"(sin nombre)").join(", "):(rt=Fe._raw)!=null&&rt.productName?We=Fe._raw.productName:(pe=(ie=($e=Fe._raw)==null?void 0:$e.items)==null?void 0:ie[0])!=null&&pe.productName&&(We=Fe._raw.items[0].productName);const ee=O5(Fe._raw);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Fe.date}),i.jsx("td",{className:"p-2 border",children:ee}),i.jsx("td",{className:"p-2 border",children:je}),i.jsx("td",{className:"p-2 border",children:We}),i.jsx("td",{className:"p-2 border",children:Fe.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver detalle de productos de esta venta",onClick:()=>p(Fe.id),children:x0(Fe.quantity)})}),i.jsx("td",{className:"p-2 border",children:lu(Fe.total)}),s&&i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>M(fe=>fe===Fe.id?null:Fe.id),title:"Acciones",children:""}),G===Fe.id&&i.jsx("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>Tt(Fe),children:"Eliminar"})})]})]},Fe.id)})})]}),Ye()]})]})]}),T&&i.jsx("p",{className:"mt-2 text-sm",children:T}),l&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{children:i.jsxs("h3",{className:"text-lg font-bold",children:["Productos vendidos"," ",f?` #${f}`:""]})}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>c(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Libras"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:d?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):h.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):h.map((Fe,je)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:Fe.productName}),i.jsx("td",{className:"p-2 border text-right",children:Fe.qty}),i.jsx("td",{className:"p-2 border text-right",children:lu(Fe.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:lu(Fe.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:lu(Fe.total)})]},je))})]})})]})})]})}const Z3e=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal","Varios"];function e4e({onCreated:t,onClose:e}){const[r,n]=g.useState(Kr(new Date,"yyyy-MM-dd")),[a,s]=g.useState(""),[o,l]=g.useState(""),[c,d]=g.useState(0),[u]=g.useState("PAGADO"),[f,A]=g.useState(""),[h,m]=g.useState(""),[p,x]=g.useState(!1),v=async y=>{if(y.preventDefault(),m(""),!a)return m("Selecciona una categora.");if(!o.trim())return m("Ingresa una descripcin.");if(!c||c<=0)return m("Ingresa un monto vlido.");try{x(!0);const b={date:r,category:a,description:o.trim(),amount:Number(Number(c||0).toFixed(2)),status:"PAGADO",notes:f||"",createdAt:Nr.now()},w=await ta(xt(Ne,"expenses"),b);t({id:w.id,...b}),m(" Gasto registrado"),e()}catch{m(" Error al guardar gasto")}finally{x(!1)}};return i.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-xl p-6 relative",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Crear gasto"}),i.jsx("button",{type:"button",onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:v,className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:r,onChange:y=>n(y.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:a,onChange:y=>s(y.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),Z3e.map(y=>i.jsx("option",{value:y,children:y},y))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",value:o,onChange:y=>l(y.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:c===0?"":c,onChange:y=>d(Number(y.target.value)),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100 text-gray-500 cursor-not-allowed",value:"PAGADO",readOnly:!0,disabled:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:f,onChange:y=>A(y.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[f.length,"/500"]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",disabled:p,children:"Guardar gasto"}),i.jsx("button",{type:"button",className:"bg-gray-200 px-4 py-2 rounded hover:bg-gray-300",onClick:e,children:"Cancelar"})]}),h&&i.jsx("div",{className:"text-sm mt-2",children:h})]})]})})}const _l=t=>`C$${Number(t||0).toFixed(2)}`,tf=t=>Number(t||0).toFixed(3),bH=t=>(t||"").toLowerCase()==="lb"||/libra/.test((t||"").toLowerCase()),D5=()=>{const t=new Date;return Kr(new Date(t.getFullYear(),t.getMonth(),1),"yyyy-MM-dd")},$C=()=>Kr(new Date,"yyyy-MM-dd");function Nne({paidBatches:t=[],onClose:e,onCreated:r}){const n=Array.isArray(t)?t:[],[a,s]=g.useState(D5()),[o,l]=g.useState($C()),[c,d]=g.useState(""),u=g.useMemo(()=>{const $e=new Map;return n.forEach(ie=>$e.set(ie.productId,{id:ie.productId,name:ie.productName})),Array.from($e.values()).sort((ie,pe)=>ie.name.localeCompare(pe.name))},[n]),f=g.useMemo(()=>n.filter($e=>!(a&&$e.date<a||o&&$e.date>o||c&&$e.productId!==c)),[n,a,o,c]),[A,h]=g.useState($C()),[m,p]=g.useState(()=>`FAC-${Date.now().toString().slice(-6)}`),[x,v]=g.useState(""),[y,b]=g.useState([]),[w,I]=g.useState([]),[j,N]=g.useState([]),[S,E]=g.useState(!1),[B,k]=g.useState(D5()),[T,P]=g.useState($C()),[q,de]=g.useState(!1);g.useEffect(()=>{(async()=>{try{E(!0);const $e=ar(xt(Ne,"expenses"),kn("date","desc")),ie=await Ut($e),pe=[];ie.forEach(fe=>{const Me=fe.data();pe.push({id:fe.id,date:Me.date,description:Me.description,amount:Number(Me.amount||0)})}),I(pe)}catch($e){console.error($e)}finally{E(!1)}})()},[]);const ce=$e=>{I(ie=>[$e,...ie]),N(ie=>[$e.id,...ie])},le=g.useMemo(()=>w.filter($e=>!(!$e.date||B&&$e.date<B||T&&$e.date>T)),[w,B,T]),[he,ae]=g.useState([]),[Ce,De]=g.useState(!1),[O,R]=g.useState(""),[G,M]=g.useState("DEBITO"),[K,Y]=g.useState(""),D=()=>{const $e=Number(K);!O.trim()||!isFinite($e)||$e<=0||(ae(ie=>[...ie,{id:`${Date.now()}_${ie.length+1}`,description:O.trim(),type:G,amount:Number($e.toFixed(2))}]),R(""),Y(""))},[V,te]=g.useState(null),[ve,Q]=g.useState(""),[Xe,se]=g.useState("DEBITO"),[Z,ke]=g.useState(""),Se=$e=>{te($e.id),Q($e.description),se($e.type),ke($e.amount.toFixed(2))},Ee=()=>{te(null),Q(""),se("DEBITO"),ke("")},Ze=()=>{if(!V)return;const $e=Number(Z);!isFinite($e)||$e<=0||(ae(ie=>ie.map(pe=>pe.id===V?{...pe,description:ve.trim(),type:Xe,amount:Number($e.toFixed(2))}:pe)),Ee())},ot=$e=>{ae(ie=>ie.filter(pe=>pe.id!==$e)),V===$e&&Ee()},vt=($e,ie)=>{N(pe=>ie?[...new Set([...pe,$e])]:pe.filter(fe=>fe!==$e))},[_t,Tt]=g.useState([]),[Lt,Rt]=g.useState(0),Et=g.useMemo(()=>{let $e=0,ie=0,pe=0,fe=0;for(const Me of _t){const me=Number(Me.totalQuantity||0);bH(Me.measurement||"")?$e+=me:ie+=me,pe+=Number(Me.totalExpected||0),fe+=Number(Me.totalInvoiced||0)}return{totalLbs:$e,totalUnits:ie,totalExpected:Number(pe.toFixed(2)),totalFacturado:Number(fe.toFixed(2)),grossProfit:Number((pe-fe).toFixed(2))}},[_t]),Re=g.useMemo(()=>Number(((Et.totalExpected||0)+(Lt||0)-(Et.totalFacturado||0)).toFixed(2)),[Et,Lt]);g.useEffect(()=>{(async()=>{if(!a||!o){Tt([]),Rt(0);return}try{const ie=ar(xt(Ne,"salesV2"),lr("date",">=",a),lr("date","<=",o)),pe=await Ut(ie),fe={};pe.forEach(mt=>{const gt=mt.data(),yt=gt.date??"";if(String(gt.type??"CONTADO").toUpperCase()!=="CONTADO")return;const Ft=(ct,st,z,X,re)=>{const H=`${ct}||${st}`;fe[H]||(fe[H]={measurement:st||"",totalQuantity:0,totalExpected:0,totalInvoiced:0}),fe[H].totalQuantity+=z,fe[H].totalExpected+=X,fe[H].totalInvoiced+=re};if(Array.isArray(gt.items)&&gt.items.length>0){gt.items.forEach(ct=>{const st=String(ct.productName??"(sin nombre)"),z=Number(ct.qty??ct.quantity??0),X=Number(ct.unitPrice??ct.price??gt.amountSuggested??0),re=Number(ct.lineFinal??0)||Math.max(0,Number(X||0)*z-Number(ct.discount||0)),H=Number(re||0),L=Array.isArray(ct.allocations)?ct.allocations:Array.isArray(gt.allocations)?gt.allocations:[];let ue=0;L&&L.length?ue=L.reduce((Pe,xe)=>Pe+Number(xe.lineCost||0),0):ue=Number(ct.avgUnitCost??gt.avgUnitCost??0)*z,Ft(st,ct.measurement??gt.measurement??"",z,H,ue)});return}const Oe=String(gt.productName??"(sin nombre)"),be=Number(gt.quantity??0),Ae=Number(gt.amount??gt.amountCharged??0)||Number(gt.amountSuggested??gt.unitPrice??0)*be,Le=Array.isArray(gt.allocations)?gt.allocations:[];let ut=0;Le&&Le.length?ut=Le.reduce((ct,st)=>ct+Number(st.lineCost||0),0):ut=Number(gt.avgUnitCost??0)*be,Ft(Oe,gt.measurement??"",be,Ae,ut)});const Me=Object.entries(fe).map(([mt,gt])=>{const[yt]=mt.split("||"),Pt=Number((gt.totalExpected-gt.totalInvoiced).toFixed(2));return{productName:yt,measurement:gt.measurement,totalQuantity:Number(gt.totalQuantity.toFixed(3)),totalExpected:Number(gt.totalExpected.toFixed(2)),totalInvoiced:Number(gt.totalInvoiced.toFixed(2)),grossProfit:Pt}});Tt(Me.sort((mt,gt)=>gt.totalInvoiced-mt.totalInvoiced));const me=await Ut(xt(Ne,"ar_movements_pollo"));let ye=0;me.forEach(mt=>{var Oe;const gt=mt.data();if(String(gt.type??"").toUpperCase()!=="ABONO")return;const Pt=Math.abs(Number(gt.amount??0)),Ft=gt!=null&&gt.date?String(gt.date):(Oe=gt==null?void 0:gt.createdAt)!=null&&Oe.toDate?Kr(gt.createdAt.toDate(),"yyyy-MM-dd"):"";Ft&&Ft>=a&&Ft<=o&&(ye+=Pt)}),Rt(Number(ye.toFixed(2)))}catch(ie){console.error("Error cargando consolidado de ventas/abonos:",ie),Tt([]),Rt(0)}})()},[a,o]);const Te=g.useMemo(()=>f.filter($e=>y.includes($e.id)),[f,y]),Ye=g.useMemo(()=>he.filter($e=>$e.type==="DEBITO").reduce(($e,ie)=>$e+ie.amount,0),[he]),dt=g.useMemo(()=>he.filter($e=>$e.type==="CREDITO").reduce(($e,ie)=>$e+ie.amount,0),[he]),Fe=g.useMemo(()=>{let $e=0,ie=0,pe=0,fe=0;for(const ye of Te){bH(ye.unit)?$e+=Number(ye.quantity||0):ie+=Number(ye.quantity||0);const mt=ye.expectedTotal??Number((Number(ye.quantity||0)*Number(ye.salePrice||0)).toFixed(2)),gt=ye.invoiceTotal!==void 0&&ye.invoiceTotal!==null?Number(ye.invoiceTotal):Number((Number(ye.quantity||0)*Number(ye.purchasePrice||0)).toFixed(2));pe+=Number(mt||0),fe+=Number(gt||0)}const Me=le.filter(ye=>j.includes(ye.id)).reduce((ye,mt)=>ye+Number(mt.amount||0),0),me=pe-Me-Ye+dt;return{totalLbs:$e,totalUnits:ie,totalExpected:Number(pe.toFixed(2)),totalInvoiced:Number(fe.toFixed(2)),totalGastos:Number(Me.toFixed(2)),debits:Number(Ye.toFixed(2)),credits:Number(dt.toFixed(2)),finalAmount:Number(me.toFixed(2)),grossProfit:Number((pe-fe).toFixed(2))}},[Te,le,j,Ye,dt]),[je,We]=g.useState(!1),[ee,Ve]=g.useState(""),rt=async()=>{Ve("");const $e=Array.isArray(_t)&&_t.length>0;if(!$e&&Te.length===0){Ve("Selecciona al menos 1 lote pagado o genera un consolidado.");return}try{We(!0);const ie=(_t||[]).map(yt=>({productName:yt.productName,measurement:yt.measurement,quantity:Number(tf(yt.totalQuantity)),expectedTotal:Number(yt.totalExpected),invoiceTotal:Number(yt.totalInvoiced)})),pe=Number(tf($e?Et.totalLbs:Fe.totalLbs)),fe=Number(tf($e?Et.totalUnits:Fe.totalUnits)),Me=$e?Number((Et.totalExpected+Lt).toFixed(2)):Fe.totalExpected,me=$e?Et.totalFacturado:Fe.totalInvoiced,ye=Number(((Me||0)-Number(Fe.totalGastos||0)-Number(Fe.debits||0)+Number(Fe.credits||0)).toFixed(2)),mt={number:m.trim(),date:A,description:x.trim(),status:"PENDIENTE",createdAt:Nr.now(),totalLbs:pe,totalUnits:fe,totalAmount:Me,invoiceTotal:me,totalExpenses:Fe.totalGastos,totalDebits:Fe.debits,totalCredits:Fe.credits,finalAmount:ye,batches:($e?[]:Te).map(yt=>{var Pt;return{id:yt.id,productId:yt.productId,productName:yt.productName,unit:yt.unit,quantity:Number(tf(yt.quantity)),salePrice:Number(Number(yt.salePrice||0).toFixed(2)),purchasePrice:Number(Number(yt.purchasePrice||0).toFixed(2)),expectedTotal:Number((Number(yt.quantity||0)*Number(yt.salePrice||0)).toFixed(2)),invoiceTotal:yt.invoiceTotal!==void 0&&yt.invoiceTotal!==null?Number(yt.invoiceTotal):Number((Number(yt.quantity||0)*Number(yt.purchasePrice||0)).toFixed(2)),batchDate:yt.date,paidAt:(Pt=yt.paidAt)!=null&&Pt.toDate?Kr(yt.paidAt.toDate(),"yyyy-MM-dd"):null}}),consolidatedProducts:ie,expenses:le.filter(yt=>j.includes(yt.id)).map(yt=>({id:yt.id,date:yt.date||null,description:yt.description||"",amount:Number(Number(yt.amount||0).toFixed(2))})),adjustments:he.map(yt=>({id:yt.id,description:yt.description,type:yt.type,amount:Number(yt.amount.toFixed(2))}))},gt=await ta(xt(Ne,"invoices"),mt);if($e)try{await ta(xt(Ne,"consolidated_reports"),{invoiceId:gt.id,lotFrom:a,lotTo:o,consolidatedProducts:ie,consolidatedTotals:{totalLbs:Et.totalLbs,totalUnits:Et.totalUnits,totalExpected:Et.totalExpected,totalFacturado:Et.totalFacturado,grossProfit:Et.grossProfit},abonosRangeTotal:Lt,createdAt:Nr.now()})}catch(yt){console.error("Error saving consolidated report:",yt)}Ve(" Factura creada."),r()}catch(ie){console.error(ie),Ve(` Error al crear factura: ${(ie==null?void 0:ie.message)||"desconocido"}`)}finally{We(!1)}};return i.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:[i.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-xl shadow-xl p-4 md:p-6 max-h-[90vh] overflow-auto relative",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Crear factura"}),i.jsx("button",{type:"button",onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:A,onChange:$e=>h($e.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Nmero"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:m,onChange:$e=>p($e.target.value),placeholder:"FAC-001"})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Descripcin"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:x,onChange:$e=>v($e.target.value),placeholder:"Comentarios de la factura"})]})]}),i.jsx("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:i.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Desde (lote)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:$e=>s($e.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Hasta (lote)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:o,onChange:$e=>l($e.target.value)})]}),i.jsxs("div",{className:"min-w-[220px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:c,onChange:$e=>d($e.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),u.map($e=>i.jsx("option",{value:$e.id,children:$e.name},$e.id))]})]}),i.jsx("button",{type:"button",className:"ml-auto px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{s(D5()),l($C()),d("")},children:"Quitar filtro"})]})}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Consolidado ventas (CASH)"}),i.jsxs("div",{className:"text-sm text-gray-600 ml-auto",children:["Periodo: ",a,"  ",o]})]}),i.jsxs("div",{className:"flex gap-3 mb-3 items-stretch",children:[i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-3 text-center min-w-[120px]",children:[i.jsx("div",{className:"text-xs text-blue-700 font-semibold",children:"Total libras"}),i.jsx("div",{className:"text-xl font-bold text-blue-900",children:tf(Et.totalLbs)})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-3 text-center min-w-[120px]",children:[i.jsx("div",{className:"text-xs text-blue-700 font-semibold",children:"Total unidades"}),i.jsx("div",{className:"text-xl font-bold text-blue-900",children:tf(Et.totalUnits)})]}),i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-3 text-center min-w-[180px]",children:[i.jsx("div",{className:"text-xs text-green-700 font-semibold",children:"Total facturado"}),i.jsx("div",{className:"text-xl font-bold text-green-900",children:_l(Et.totalFacturado)})]}),i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-3 text-center min-w-[200px]",children:[i.jsx("div",{className:"text-xs text-green-700 font-semibold",children:"Total esperado"}),i.jsx("div",{className:"text-xl font-bold text-green-900",children:_l(Et.totalExpected)})]}),i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-3 text-center min-w-[180px]",children:[i.jsx("div",{className:"text-xs text-yellow-700 font-semibold",children:"Utilidad bruta"}),i.jsx("div",{className:"text-xl font-bold text-yellow-900",children:_l(Re)})]})]}),_t.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin ventas cash en el periodo."}):i.jsx("div",{className:"border rounded max-h-80 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Total facturado"}),i.jsx("th",{className:"p-2 border text-right",children:"Total esperado"}),i.jsx("th",{className:"p-2 border text-right",children:"Ganancia bruta"})]})}),i.jsx("tbody",{children:_t.map($e=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:$e.productName}),i.jsx("td",{className:"p-2 border",children:$e.measurement||""}),i.jsx("td",{className:"p-2 border text-right",children:tf($e.totalQuantity)}),i.jsx("td",{className:"p-2 border text-right",children:_l($e.totalInvoiced)}),i.jsx("td",{className:"p-2 border text-right",children:_l($e.totalExpected)}),i.jsx("td",{className:"p-2 border text-right",children:_l($e.grossProfit)})]},$e.productName))})]})}),i.jsxs("div",{className:"mt-3",children:[i.jsx("h4",{className:"font-semibold",children:"Abonos (Periodo)"}),i.jsxs("div",{className:"mt-2",children:[i.jsxs("div",{className:"p-3 border rounded bg-white inline-block",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Periodo"}),i.jsxs("div",{className:"font-semibold",children:[a,"  ",o]})]}),i.jsxs("div",{className:"p-3 border rounded bg-white inline-block ml-3",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Total recaudado"}),i.jsx("div",{className:"font-semibold",children:_l(Lt)})]})]})]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Gastos a incluir (opcional)"}),S&&i.jsx("span",{className:"text-xs text-gray-500",children:"Cargando"}),i.jsx("button",{type:"button",className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>de(!0),children:"Crear gasto"}),i.jsxs("div",{className:"flex items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:B,onChange:$e=>k($e.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:T,onChange:$e=>P($e.target.value)})]})]})]}),le.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay gastos en el rango seleccionado."}):i.jsx("div",{className:"border rounded max-h-48 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:le.map($e=>{const ie=j.includes($e.id);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:ie,onChange:pe=>vt($e.id,pe.target.checked)})}),i.jsx("td",{className:"p-2 border",children:$e.date||""}),i.jsx("td",{className:"p-2 border",children:$e.description||""}),i.jsx("td",{className:"p-2 border",children:_l(Number($e.amount||0))})]},$e.id)})})]})}),q&&i.jsx(e4e,{onCreated:ce,onClose:()=>de(!1)})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Notas Crdito/Dbito (Cargos extras)"}),i.jsx("button",{type:"button",className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>De(!0),children:"Crear Cargo"})]}),he.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cargos agregados."}):i.jsx("div",{className:"border rounded max-h-40 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:he.map($e=>{const ie=V===$e.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ie?i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[70px]",value:ve,onChange:pe=>Q(pe.target.value)}):i.jsx("span",{title:$e.description,children:$e.description.length>60?`${$e.description.slice(0,60)}`:$e.description})}),i.jsx("td",{className:"p-2 border",children:ie?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Xe,onChange:pe=>se(pe.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${$e.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:$e.type})}),i.jsx("td",{className:"p-2 border",children:ie?i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1 text-right",value:Z,onChange:pe=>ke(pe.target.value)}):_l($e.amount)}),i.jsx("td",{className:"p-2 border",children:ie?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:Ze,children:"Guardar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:Ee,children:"Cancelar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ot($e.id),children:"Eliminar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 text-xs",onClick:()=>Se($e),children:"Editar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ot($e.id),children:"Eliminar"})]})})]},$e.id)})})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[i.jsxs("div",{className:"flex flex-col gap-4",children:[i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-blue-700 font-semibold mb-1",children:"Total libras"}),i.jsx("div",{className:"text-2xl font-bold text-blue-900",children:tf(Et.totalLbs)})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-blue-700 font-semibold mb-1",children:"Total unidades"}),i.jsx("div",{className:"text-2xl font-bold text-blue-900",children:tf(Et.totalUnits)})]}),i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-green-700 font-semibold mb-1",children:"Total facturado"}),i.jsx("div",{className:"text-2xl font-bold text-green-900",children:_l(Et.totalFacturado)})]})]}),i.jsxs("div",{className:"flex flex-col gap-4",children:[i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-red-700 font-semibold mb-1",children:"Gastos"}),i.jsx("div",{className:"text-2xl font-bold text-red-900",children:_l(Fe.totalGastos)})]}),i.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-orange-700 font-semibold mb-1",children:"Dbitos"}),i.jsx("div",{className:"text-2xl font-bold text-orange-900",children:_l(Fe.debits)})]}),i.jsxs("div",{className:"bg-lime-50 border border-lime-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-lime-700 font-semibold mb-1",children:"Crditos"}),i.jsx("div",{className:"text-2xl font-bold text-lime-900",children:_l(Fe.credits)})]})]}),i.jsxs("div",{className:"flex flex-col gap-4",children:[i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-green-700 font-semibold mb-1",children:"Total Cash + Abonos"}),i.jsx("div",{className:"text-2xl font-bold text-green-900",children:_l(Et.totalExpected+Lt)})]}),i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-yellow-700 font-semibold mb-1",children:"Ganancia bruta"}),i.jsx("div",{className:"text-2xl font-bold text-yellow-900",children:_l(Re)})]}),i.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-purple-700 font-semibold mb-1",children:"Ganancia neta"}),i.jsx("div",{className:"text-2xl font-bold text-purple-900",children:_l(Re-Fe.totalGastos-Fe.debits)})]})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"p-4 bg-blue-100 border border-blue-300 rounded-xl text-center font-semibold text-lg shadow",children:["Monto final (esperado  gastos  dbitos + crditos):"," ",i.jsx("span",{className:"text-blue-700",children:_l(Fe.finalAmount)})]})}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",disabled:je,onClick:rt,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",children:je?"Creando":"Crear factura"}),i.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border rounded",children:"Cancelar"}),ee&&i.jsx("span",{className:"text-sm ml-2",children:ee})]}),je&&i.jsxs("div",{className:"absolute inset-0 z-[11000] bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Creando factura"})]})]}),Ce&&i.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-lg rounded-xl shadow-xl p-4",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx("h4",{className:"font-semibold",children:"Nuevo cargo"}),i.jsx("button",{type:"button",className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",onClick:()=>De(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[90px]",value:O,onChange:$e=>R($e.target.value),placeholder:"Detalle del cargo"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Tipo de cargo"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:G,onChange:$e=>M($e.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:K,onChange:$e=>Y($e.target.value),placeholder:"0.00"})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:D,children:"Agregar"})})]})]})})]})}const cu=t=>`C$ ${Number(t||0).toFixed(2)}`,Jc=t=>Number(t||0).toFixed(3),t4e=t=>(t||"").toLowerCase()==="lb"||/libra/.test((t||"").toLowerCase());function r4e(){const[t,e]=g.useState([]),[r,n]=g.useState(!0),[a,s]=g.useState(!1),[o,l]=g.useState(null),[c,d]=g.useState(Kr(new Date(new Date().getFullYear(),new Date().getMonth(),1),"yyyy-MM-dd")),[u,f]=g.useState(Kr(new Date,"yyyy-MM-dd")),[A,h]=g.useState(""),[m,p]=g.useState(!1),{refreshKey:x,refresh:v}=bc(),[y,b]=g.useState(!1),w=()=>b(P=>!P),[I,j]=g.useState(null),N=P=>j(q=>q===P?null:P);g.useEffect(()=>{(async()=>{n(!0);const P=ar(xt(Ne,"inventory_batches"),lr("status","==","PAGADO"),kn("date","desc")),q=await Ut(P),de=[];q.forEach(ce=>{const le=ce.data(),he=Number(le.quantity||0),ae=Number(le.remaining||0),Ce=Number(le.purchasePrice||0),De=Number(le.salePrice||0),O=Number((he*Ce).toFixed(2)),R=Number((he*De).toFixed(2));de.push({id:ce.id,productId:le.productId,productName:le.productName,category:le.category,unit:le.unit,quantity:he,remaining:ae,purchasePrice:Ce,salePrice:De,invoiceTotal:le.invoiceTotal!=null?Number(le.invoiceTotal):O,expectedTotal:le.expectedTotal!=null?Number(le.expectedTotal):R,date:le.date,status:le.status,paidAt:le.paidAt})}),e(de),n(!1)})()},[x]);const S=g.useMemo(()=>t.filter(P=>!(c&&P.date<c||u&&P.date>u||A&&P.productId!==A)),[t,c,u,A]),E=g.useMemo(()=>{let P=0,q=0,de=0,ce=0,le=0,he=0;for(const ae of S)t4e(ae.unit)?(P+=ae.quantity,q+=ae.remaining):(de+=ae.quantity,ce+=ae.remaining),le+=Number(ae.expectedTotal||0),he+=Number(ae.invoiceTotal||0);return{lbsIng:P,lbsRem:q,udsIng:de,udsRem:ce,totalEsperado:le,totalFact:he,gross:le-he}},[S]),B=P=>{l(P),s(!0)},k=async()=>{if(o)try{const P=Kt(Ne,"inventory_batches",o.id);await Mn(P,{status:"PENDIENTE",remaining:o.quantity});const q=xt(Ne,"salesV2"),de=await Ut(ar(q,lr("batchId","==",o.id))),ce=await Ut(ar(q,lr("productName","==",o.productName),lr("date","==",o.date))),le=[...de.docs,...ce.docs];for(const he of le)await na(Kt(Ne,"salesV2",he.id));s(!1),l(null),v()}catch(P){console.error("Error al marcar pendiente:",P)}},T=g.useMemo(()=>{const P=new Map;return t.forEach(q=>P.set(q.productId,{id:q.productId,name:q.productName})),Array.from(P.values()).sort((q,de)=>q.name.localeCompare(de.name))},[t]);return i.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-0",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Pagados"}),i.jsx(yc,{onClick:v,loading:r})]}),i.jsxs("div",{className:"bg-white p-3 rounded-2xl shadow-2xl border mb-4 flex flex-col sm:flex-row sm:items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-wrap gap-3",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:P=>d(P.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:P=>f(P.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:P=>h(P.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),T.map(P=>i.jsx("option",{value:P.id,children:P.name},P.id))]})]}),i.jsx("button",{type:"button",className:"px-3 py-1 rounded-2xl bg-gray-200 hover:bg-gray-300",onClick:()=>{d(""),f(""),h("")},children:"Quitar filtro"})]}),i.jsx("button",{type:"button",className:"sm:ml-auto px-3 py-2 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",onClick:()=>p(!0),children:"Crear factura"})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("div",{className:"md:hidden",children:[i.jsxs("button",{type:"button",onClick:w,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Totales"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Libras: ",i.jsx("b",{children:Jc(E.lbsIng)}),"  Restantes:"," ",i.jsx("b",{children:Jc(E.lbsRem)})]})]}),i.jsx("div",{className:"text-gray-500",children:y?"":""})]}),y&&i.jsx("div",{className:"mt-3 bg-gray-50 p-3 rounded-2xl shadow-2xl border text-base",children:i.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",Jc(E.lbsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",Jc(E.udsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",cu(E.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",Jc(E.lbsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",Jc(E.udsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",cu(E.totalFact)]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",cu(E.gross)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes:"})," ",S.length.toLocaleString()]})]})})]}),i.jsx("div",{className:"hidden md:block bg-gray-50 p-3 rounded-2xl shadow-2xl border mb-3 text-base",children:i.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",Jc(E.lbsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",Jc(E.udsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",cu(E.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",Jc(E.lbsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",Jc(E.udsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",cu(E.totalFact)]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",cu(E.gross)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes:"})," ",S.length.toLocaleString()]})]})})]}),i.jsx("div",{className:"block md:hidden space-y-3",children:r?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Cargando"}):S.length===0?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Sin lotes pagados"}):S.map(P=>{var de;const q=I===P.id;return i.jsxs("div",{className:"bg-white border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",onClick:()=>N(P.id),className:"w-full text-left px-3 py-3 flex items-center justify-between bg-white",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:P.productName}),i.jsxs("div",{className:"text-xs text-gray-500 truncate",children:[(P.category||"").toUpperCase(),"  ",P.date," "," ",(P.unit||"").toUpperCase()]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-sm font-bold",children:cu(P.expectedTotal||0)}),i.jsx("div",{className:"text-[11px] text-gray-500",children:q?"Detalles":"Esperado"})]})]}),q&&i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ingresado"}),i.jsx("div",{className:"font-semibold",children:Jc(P.quantity)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Restantes"}),i.jsx("div",{className:"font-semibold",children:Jc(P.remaining)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Costo"}),i.jsx("div",{className:"font-semibold",children:cu(P.invoiceTotal||0)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Fecha pago"}),i.jsx("div",{className:"font-semibold",children:(de=P.paidAt)!=null&&de.toDate?Kr(P.paidAt.toDate(),"yyyy-MM-dd"):""})]})]}),i.jsx("div",{className:"mt-3",children:i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded-xl text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>B(P),children:"Marcar PENDIENTE"})})]})]},P.id)})}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow-2xl border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Ingresado"}),i.jsx("th",{className:"p-2 border",children:"Restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Compra"}),i.jsx("th",{className:"p-2 border",children:"Precio Venta"}),i.jsx("th",{className:"p-2 border",children:"Total factura"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Fecha pago"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):S.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin lotes pagados"})}):S.map(P=>{var q;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:P.date}),i.jsx("td",{className:"p-2 border",children:(P.category||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:P.productName}),i.jsx("td",{className:"p-2 border",children:(P.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:Jc(P.quantity)}),i.jsx("td",{className:"p-2 border",children:Jc(P.remaining)}),i.jsx("td",{className:"p-2 border",children:cu(P.purchasePrice)}),i.jsx("td",{className:"p-2 border",children:cu(P.salePrice)}),i.jsx("td",{className:"p-2 border",children:cu(P.invoiceTotal||0)}),i.jsx("td",{className:"p-2 border",children:cu(P.expectedTotal||0)}),i.jsx("td",{className:"p-2 border",children:(q=P.paidAt)!=null&&q.toDate?Kr(P.paidAt.toDate(),"yyyy-MM-dd"):""}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>B(P),children:"Marcar PENDIENTE"})})]},P.id)})})]})}),m&&i.jsx(Nne,{paidBatches:t,onClose:()=>p(!1),onCreated:()=>p(!1)}),a&&o&&i.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50 p-3",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 w-full max-w-md",children:[i.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Confirmar accin"}),i.jsxs("p",{className:"text-gray-700 mb-4",children:["Seguro que quieres marcar pendiente este inventario?",i.jsx("br",{}),"Al hacerlo, las libras se restaurarn y se eliminarn las ventas generadas."]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{type:"button",onClick:()=>s(!1),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-xl",children:"Cancelar"}),i.jsx("button",{type:"button",onClick:k,className:"px-4 py-2 bg-yellow-600 text-white hover:bg-yellow-700 rounded-xl",children:"Confirmar"})]})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var qS={};qS.version="0.18.5";var Cne=1252,n4e=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],iR={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},oR=function(t){n4e.indexOf(t)!=-1&&(Cne=iR[0]=t)};function a4e(){oR(1252)}var xf=function(t){oR(t)};function lR(){xf(1200),a4e()}function wH(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function s4e(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function _ne(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var rb=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?s4e(t.slice(2)):e==254&&r==255?_ne(t.slice(2)):e==65279?t.slice(1):t},GC=function(e){return String.fromCharCode(e)},NH=function(e){return String.fromCharCode(e)},D2,Z0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function R2(t){for(var e="",r=0,n=0,a=0,s=0,o=0,l=0,c=0,d=0;d<t.length;)r=t.charCodeAt(d++),s=r>>2,n=t.charCodeAt(d++),o=(r&3)<<4|n>>4,a=t.charCodeAt(d++),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),e+=Z0.charAt(s)+Z0.charAt(o)+Z0.charAt(l)+Z0.charAt(c);return e}function Wd(t){var e="",r=0,n=0,a=0,s=0,o=0,l=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)s=Z0.indexOf(t.charAt(d++)),o=Z0.indexOf(t.charAt(d++)),r=s<<2|o>>4,e+=String.fromCharCode(r),l=Z0.indexOf(t.charAt(d++)),n=(o&15)<<4|l>>2,l!==64&&(e+=String.fromCharCode(n)),c=Z0.indexOf(t.charAt(d++)),a=(l&3)<<6|c,c!==64&&(e+=String.fromCharCode(a));return e}var xa=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),UA=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Tm(t){return xa?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function CH(t){return xa?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Dd=function(e){return xa?UA(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function mP(t){if(typeof ArrayBuffer>"u")return Dd(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Gm(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function i4e(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function cR(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return cR(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var fl=xa?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:UA(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),a=0;for(e=0,r=0;e<t.length;r+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function o4e(t){for(var e=[],r=0,n=t.length+250,a=Tm(t.length+255),s=0;s<t.length;++s){var o=t.charCodeAt(s);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=t.charCodeAt(++s)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|l>>6&15|(o&3)<<4,a[r++]=128|l&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(e.push(a.slice(0,r)),r=0,a=Tm(65535),n=65530)}return e.push(a.slice(0,r)),fl(e)}var Hc=/\u0000/g,nb=/[\u0001-\u0006]/g;function vv(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function vf(t,e){var r=""+t;return r.length>=e?r:Ui("0",e-r.length)+r}function dR(t,e){var r=""+t;return r.length>=e?r:Ui(" ",e-r.length)+r}function zS(t,e){var r=""+t;return r.length>=e?r:r+Ui(" ",e-r.length)}function l4e(t,e){var r=""+Math.round(t);return r.length>=e?r:Ui("0",e-r.length)+r}function c4e(t,e){var r=""+t;return r.length>=e?r:Ui("0",e-r.length)+r}var _H=Math.pow(2,32);function xx(t,e){if(t>_H||t<-_H)return l4e(t,e);var r=Math.round(t);return c4e(r,e)}function WS(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var EH=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],R5=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function d4e(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Gn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},SH={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},u4e={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function XS(t,e,r){for(var n=t<0?-1:1,a=t*n,s=0,o=1,l=0,c=1,d=0,u=0,f=Math.floor(a);d<e&&(f=Math.floor(a),l=f*o+s,u=f*d+c,!(a-f<5e-8));)a=1/(a-f),s=o,o=l,c=d,d=u;if(u>e&&(d>e?(u=c,l=s):(u=d,l=o)),!r)return[0,n*l,u];var A=Math.floor(n*l/u);return[A,n*l-A*u,u]}function Bp(t,e,r){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),s=0,o=[],l={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),e&&e.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=g4e(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=s,l}var Ene=new Date(1899,11,31,0,0,0),f4e=Ene.getTime(),h4e=new Date(1900,2,1,0,0,0);function Sne(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=h4e&&(r+=24*60*60*1e3),(r-(f4e+(t.getTimezoneOffset()-Ene.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function uR(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function A4e(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function m4e(t){var e=t<0?12:11,r=uR(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function p4e(t){var e=uR(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function M2(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=m4e(t):e===10?r=t.toFixed(10).substr(0,12):r=p4e(t),uR(A4e(r.toUpperCase()))}function xg(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):M2(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Uu(14,Sne(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function g4e(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function x4e(t,e,r,n){var a="",s=0,o=0,l=r.y,c,d=0;switch(t){case 98:l=r.y+543;case 121:switch(e.length){case 1:case 2:c=l%100,d=2;break;default:c=l%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,d=e.length;break;case 3:return R5[r.m-1][1];case 5:return R5[r.m-1][0];default:return R5[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,d=e.length;break;case 3:return EH[r.q][0];default:return EH[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?vf(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),e==="s"?s===0?"0":""+s/o:(a=vf(s,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:c=l,d=1;break}var u=d>0?vf(c,d):"";return u}function em(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var jne=/%/g;function v4e(t,e,r){var n=e.replace(jne,""),a=e.length-n.length;return uA(t,n,r*Math.pow(10,2*a))+Ui("%",a)}function y4e(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return uA(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Ine(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Ine(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(e/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Pne=/# (\?+)( ?)\/( ?)(\d+)/;function b4e(t,e,r){var n=parseInt(t[4],10),a=Math.round(e*n),s=Math.floor(a/n),o=a-s*n,l=n;return r+(s===0?"":""+s)+" "+(o===0?Ui(" ",t[1].length+1+t[4].length):dR(o,t[1].length)+t[2]+"/"+t[3]+vf(l,t[4].length))}function w4e(t,e,r){return r+(e===0?"":""+e)+Ui(" ",t[1].length+2+t[4].length)}var Tne=/^#*0*\.([0#]+)/,Bne=/\).*[0#]/,kne=/\(###\) ###\\?-####/;function Oc(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function jH(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function IH(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function N4e(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function C4e(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function hu(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Bne)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?hu("n",n,r):"("+hu("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return y4e(t,e,r);if(e.indexOf("%")!==-1)return v4e(t,e,r);if(e.indexOf("E")!==-1)return Ine(e,r);if(e.charCodeAt(0)===36)return"$"+hu(t,e.substr(e.charAt(1)==" "?2:1),r);var a,s,o,l,c=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+xx(c,e.length);if(e.match(/^[#?]+$/))return a=xx(r,0),a==="0"&&(a=""),a.length>e.length?a:Oc(e.substr(0,e.length-a.length))+a;if(s=e.match(Pne))return b4e(s,c,d);if(e.match(/^#+0+$/))return d+xx(c,e.length-e.indexOf("0"));if(s=e.match(Tne))return a=jH(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Oc(s[1])).replace(/\.$/,"."+Oc(s[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+Ui("0",Oc(s[1]).length-p.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return d+jH(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return d+em(xx(c,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+hu(t,e,-r):em(""+(Math.floor(r)+N4e(r,s[1].length)))+"."+vf(IH(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return hu(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=vv(hu(t,e.replace(/[\\-]/g,""),r)),o=0,vv(vv(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<a.length?a.charAt(o++):m==="0"?"0":""}));if(e.match(kne))return a=hu(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=XS(c,Math.pow(10,o)-1,!1),a=""+d,u=uA("n",s[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=zS(l[2],o),u.length<s[4].length&&(u=Oc(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=XS(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?dR(l[1],o)+s[2]+"/"+s[3]+zS(l[2],o):Ui(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=xx(r,0),e.length<=a.length?a:Oc(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=e.indexOf(".")-o,A=e.length-a.length-f;return Oc(e.substr(0,f)+a+e.substr(e.length-A))}if(s=e.match(/^00,000\.([#0]*0)$/))return o=IH(r,s[1].length),r<0?"-"+hu(t,e,-r):em(C4e(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?vf(0,3-m.length):"")+m})+"."+vf(o,s[1].length);switch(e){case"###,##0.00":return hu(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=em(xx(c,0));return h!=="0"?d+h:"";case"###,###.00":return hu(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return hu(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function _4e(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return uA(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function E4e(t,e,r){var n=e.replace(jne,""),a=e.length-n.length;return uA(t,n,r*Math.pow(10,2*a))+Ui("%",a)}function Fne(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Fne(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(e/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function qf(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Bne)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?qf("n",n,r):"("+qf("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return _4e(t,e,r);if(e.indexOf("%")!==-1)return E4e(t,e,r);if(e.indexOf("E")!==-1)return Fne(e,r);if(e.charCodeAt(0)===36)return"$"+qf(t,e.substr(e.charAt(1)==" "?2:1),r);var a,s,o,l,c=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+vf(c,e.length);if(e.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>e.length?a:Oc(e.substr(0,e.length-a.length))+a;if(s=e.match(Pne))return w4e(s,c,d);if(e.match(/^#+0+$/))return d+vf(c,e.length-e.indexOf("0"));if(s=e.match(Tne))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Oc(s[1])).replace(/\.$/,"."+Oc(s[1])),a=a.replace(/\.(\d*)$/,function(m,p){return"."+p+Ui("0",Oc(s[1]).length-p.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return d+em(""+c);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+qf(t,e,-r):em(""+r)+"."+Ui("0",s[1].length);if(s=e.match(/^#,#*,#0/))return qf(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=vv(qf(t,e.replace(/[\\-]/g,""),r)),o=0,vv(vv(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<a.length?a.charAt(o++):m==="0"?"0":""}));if(e.match(kne))return a=qf(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=XS(c,Math.pow(10,o)-1,!1),a=""+d,u=uA("n",s[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=zS(l[2],o),u.length<s[4].length&&(u=Oc(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=XS(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?dR(l[1],o)+s[2]+"/"+s[3]+zS(l[2],o):Ui(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=""+r,e.length<=a.length?a:Oc(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=e.indexOf(".")-o,A=e.length-a.length-f;return Oc(e.substr(0,f)+a+e.substr(e.length-A))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+qf(t,e,-r):em(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?vf(0,3-m.length):"")+m})+"."+vf(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var h=em(""+c);return h!=="0"?d+h:"";default:if(e.match(/\.[0#?]*$/))return qf(t,e.slice(0,e.lastIndexOf(".")),r)+Oc(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function uA(t,e,r){return(r|0)===r?qf(t,e,r):hu(t,e,r)}function S4e(t){for(var e=[],r=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(a,n-a),a=n+1}if(e[e.length]=t.substr(a),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var One=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function _1(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":WS(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(One))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function j4e(t,e,r,n){for(var a=[],s="",o=0,l="",c="t",d,u,f,A="H";o<t.length;)switch(l=t.charAt(o)){case"G":if(!WS(t,o))throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(f=t.charCodeAt(++o))!==34&&o<t.length;)s+=String.fromCharCode(f);a[a.length]={t:"t",v:s},++o;break;case"\\":var h=t.charAt(++o),m=h==="("||h===")"?h:"t";a[a.length]={t:m,v:h},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(d==null&&(d=Bp(e,r,t.charAt(o+1)==="2"),d==null))return"";a[a.length]={t:"X",v:t.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=Bp(e,r),d==null))return"";for(s=l;++o<t.length&&t.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=A),a[a.length]={t:l,v:s},c=l;break;case"A":case"a":case"":var p={t:l,v:l};if(d==null&&(d=Bp(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(p.v=d.H>=12?"P":"A"),p.t="T",A="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(p.v=d.H>=12?"PM":"AM"),p.t="T",o+=5,A="h"):t.substr(o,5).toUpperCase()==="/"?(d!=null&&(p.v=d.H>=12?"":""),p.t="T",o+=5,A="h"):(p.t="t",++o),d==null&&p.t==="T")return"";a[a.length]=p,c=l;break;case"[":for(s=l;t.charAt(o++)!=="]"&&o<t.length;)s+=t.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(One)){if(d==null&&(d=Bp(e,r),d==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",_1(t)||(a[a.length]={t:"t",v:s}));break;case".":if(d!=null){for(s=l;++o<t.length&&(l=t.charAt(o))==="0";)s+=l;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(o))>-1;)s+=l;a[a.length]={t:"n",v:s};break;case"?":for(s=l;t.charAt(++o)===l;)s+=l;a[a.length]={t:l,v:s},c=l;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)s+=t.charAt(o);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:l,v:l},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"t",v:l},++o;break}var x=0,v=0,y;for(o=a.length-1,c="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=A,c="h",x<1&&(x=1);break;case"s":(y=a[o].v.match(/\.0+$/))&&(v=Math.max(v,y[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":c=a[o].t;break;case"m":c==="s"&&(a[o].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&a[o].v.match(/[Hh]/)&&(x=1),x<2&&a[o].v.match(/[Mm]/)&&(x=2),x<3&&a[o].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var b="",w;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=x4e(a[o].t.charCodeAt(0),a[o].v,d,v),a[o].t="t";break;case"n":case"?":for(w=o+1;a[w]!=null&&((l=a[w].t)==="?"||l==="D"||(l===" "||l==="t")&&a[w+1]!=null&&(a[w+1].t==="?"||a[w+1].t==="t"&&a[w+1].v==="/")||a[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[w].v==="/"||a[w].v===" "&&a[w+1]!=null&&a[w+1].t=="?"));)a[o].v+=a[w].v,a[w]={v:"",t:";"},++w;b+=a[o].v,o=w-1;break;case"G":a[o].t="t",a[o].v=xg(e,r);break}var I="",j,N;if(b.length>0){b.charCodeAt(0)==40?(j=e<0&&b.charCodeAt(0)===45?-e:e,N=uA("n",b,j)):(j=e<0&&n>1?-e:e,N=uA("n",b,j),j<0&&a[0]&&a[0].t=="t"&&(N=N.substr(1),a[0].v="-"+a[0].v)),w=N.length-1;var S=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){S=o;break}var E=a.length;if(S===a.length&&N.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(w>=a[o].v.length-1?(w-=a[o].v.length,a[o].v=N.substr(w+1,a[o].v.length)):w<0?a[o].v="":(a[o].v=N.substr(0,w+1),w=-1),a[o].t="t",E=o);w>=0&&E<a.length&&(a[E].v=N.substr(0,w+1)+a[E].v)}else if(S!==a.length&&N.indexOf("E")===-1){for(w=N.indexOf(".")-1,o=S;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(u=a[o].v.indexOf(".")>-1&&o===S?a[o].v.indexOf(".")-1:a[o].v.length-1,I=a[o].v.substr(u+1);u>=0;--u)w>=0&&(a[o].v.charAt(u)==="0"||a[o].v.charAt(u)==="#")&&(I=N.charAt(w--)+I);a[o].v=I,a[o].t="t",E=o}for(w>=0&&E<a.length&&(a[E].v=N.substr(0,w+1)+a[E].v),w=N.indexOf(".")+1,o=S;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==S)){for(u=a[o].v.indexOf(".")>-1&&o===S?a[o].v.indexOf(".")+1:0,I=a[o].v.substr(0,u);u<a[o].v.length;++u)w<N.length&&(I+=N.charAt(w++));a[o].v=I,a[o].t="t",E=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(j=n>1&&e<0&&o>0&&a[o-1].v==="-"?-e:e,a[o].v=uA(a[o].t,a[o].v,j),a[o].t="t");var B="";for(o=0;o!==a.length;++o)a[o]!=null&&(B+=a[o].v);return B}var PH=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function TH(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function I4e(t,e){var r=S4e(t),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(PH),l=r[1].match(PH);return TH(e,o)?[n,r[0]]:TH(e,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,s]}function Uu(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Gn)[t],n==null&&(n=r.table&&r.table[SH[t]]||Gn[SH[t]]),n==null&&(n=u4e[t]||"General");break}if(WS(n,0))return xg(e,r);e instanceof Date&&(e=Sne(e,r.date1904));var a=I4e(n,e);if(WS(a[1]))return xg(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return j4e(a[1],e,r,a[0])}function fA(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Gn[r]==null){e<0&&(e=r);continue}if(Gn[r]==t){e=r;break}}e<0&&(e=391)}return Gn[e]=t,e}function pP(t){for(var e=0;e!=392;++e)t[e]!==void 0&&fA(t[e],e)}function E1(){Gn=d4e()}var P4e={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Dne=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function T4e(t){var e=typeof t=="number"?Gn[t]:t;return e=e.replace(Dne,"(\\d+)"),new RegExp("^"+e+"$")}function B4e(t,e,r){var n=-1,a=-1,s=-1,o=-1,l=-1,c=-1;(e.match(Dne)||[]).forEach(function(f,A){var h=parseInt(r[A+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=h;break;case"d":s=h;break;case"h":o=h;break;case"s":c=h;break;case"m":o>=0?l=h:a=h;break}}),c>=0&&l==-1&&a>=0&&(l=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?d:n==-1&&a==-1&&s==-1?u:d+"T"+u}var k4e=function(){var t={};t.version="1.2.0";function e(){for(var N=0,S=new Array(256),E=0;E!=256;++E)N=E,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,S[E]=N;return typeof Int32Array<"u"?new Int32Array(S):S}var r=e();function n(N){var S=0,E=0,B=0,k=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)k[B]=N[B];for(B=0;B!=256;++B)for(E=N[B],S=256+B;S<4096;S+=256)E=k[S]=E>>>8^N[E&255];var T=[];for(B=1;B!=16;++B)T[B-1]=typeof Int32Array<"u"?k.subarray(B*256,B*256+256):k.slice(B*256,B*256+256);return T}var a=n(r),s=a[0],o=a[1],l=a[2],c=a[3],d=a[4],u=a[5],f=a[6],A=a[7],h=a[8],m=a[9],p=a[10],x=a[11],v=a[12],y=a[13],b=a[14];function w(N,S){for(var E=S^-1,B=0,k=N.length;B<k;)E=E>>>8^r[(E^N.charCodeAt(B++))&255];return~E}function I(N,S){for(var E=S^-1,B=N.length-15,k=0;k<B;)E=b[N[k++]^E&255]^y[N[k++]^E>>8&255]^v[N[k++]^E>>16&255]^x[N[k++]^E>>>24]^p[N[k++]]^m[N[k++]]^h[N[k++]]^A[N[k++]]^f[N[k++]]^u[N[k++]]^d[N[k++]]^c[N[k++]]^l[N[k++]]^o[N[k++]]^s[N[k++]]^r[N[k++]];for(B+=15;k<B;)E=E>>>8^r[(E^N[k++])&255];return~E}function j(N,S){for(var E=S^-1,B=0,k=N.length,T=0,P=0;B<k;)T=N.charCodeAt(B++),T<128?E=E>>>8^r[(E^T)&255]:T<2048?(E=E>>>8^r[(E^(192|T>>6&31))&255],E=E>>>8^r[(E^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,P=N.charCodeAt(B++)&1023,E=E>>>8^r[(E^(240|T>>8&7))&255],E=E>>>8^r[(E^(128|T>>2&63))&255],E=E>>>8^r[(E^(128|P>>6&15|(T&3)<<4))&255],E=E>>>8^r[(E^(128|P&63))&255]):(E=E>>>8^r[(E^(224|T>>12&15))&255],E=E>>>8^r[(E^(128|T>>6&63))&255],E=E>>>8^r[(E^(128|T&63))&255]);return~E}return t.table=r,t.bstr=w,t.buf=I,t.str=j,t}(),Dn=function(){var e={};e.version="1.2.1";function r(z,X){for(var re=z.split("/"),H=X.split("/"),L=0,ue=0,Pe=Math.min(re.length,H.length);L<Pe;++L){if(ue=re[L].length-H[L].length)return ue;if(re[L]!=H[L])return re[L]<H[L]?-1:1}return re.length-H.length}function n(z){if(z.charAt(z.length-1)=="/")return z.slice(0,-1).indexOf("/")===-1?z:n(z.slice(0,-1));var X=z.lastIndexOf("/");return X===-1?z:z.slice(0,X+1)}function a(z){if(z.charAt(z.length-1)=="/")return a(z.slice(0,-1));var X=z.lastIndexOf("/");return X===-1?z:z.slice(X+1)}function s(z,X){typeof X=="string"&&(X=new Date(X));var re=X.getHours();re=re<<6|X.getMinutes(),re=re<<5|X.getSeconds()>>>1,z.write_shift(2,re);var H=X.getFullYear()-1980;H=H<<4|X.getMonth()+1,H=H<<5|X.getDate(),z.write_shift(2,H)}function o(z){var X=z.read_shift(2)&65535,re=z.read_shift(2)&65535,H=new Date,L=re&31;re>>>=5;var ue=re&15;re>>>=4,H.setMilliseconds(0),H.setFullYear(re+1980),H.setMonth(ue-1),H.setDate(L);var Pe=X&31;X>>>=5;var xe=X&63;return X>>>=6,H.setHours(X),H.setMinutes(xe),H.setSeconds(Pe<<1),H}function l(z){Ml(z,0);for(var X={},re=0;z.l<=z.length-4;){var H=z.read_shift(2),L=z.read_shift(2),ue=z.l+L,Pe={};switch(H){case 21589:re=z.read_shift(1),re&1&&(Pe.mtime=z.read_shift(4)),L>5&&(re&2&&(Pe.atime=z.read_shift(4)),re&4&&(Pe.ctime=z.read_shift(4))),Pe.mtime&&(Pe.mt=new Date(Pe.mtime*1e3));break}z.l=ue,X[H]=Pe}return X}var c;function d(){return c||(c={})}function u(z,X){if(z[0]==80&&z[1]==75)return fe(z,X);if((z[0]|32)==109&&(z[1]|32)==105)return Oe(z,X);if(z.length<512)throw new Error("CFB file size "+z.length+" < 512");var re=3,H=512,L=0,ue=0,Pe=0,xe=0,Ge=0,ze=[],Ke=z.slice(0,512);Ml(Ke,0);var pt=f(Ke);switch(re=pt[0],re){case 3:H=512;break;case 4:H=4096;break;case 0:if(pt[1]==0)return fe(z,X);default:throw new Error("Major Version: Expected 3 or 4 saw "+re)}H!==512&&(Ke=z.slice(0,H),Ml(Ke,28));var ne=z.slice(0,H);A(Ke,re);var Ue=Ke.read_shift(4,"i");if(re===3&&Ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ue);Ke.l+=4,Pe=Ke.read_shift(4,"i"),Ke.l+=4,Ke.chk("00100000","Mini Stream Cutoff Size: "),xe=Ke.read_shift(4,"i"),L=Ke.read_shift(4,"i"),Ge=Ke.read_shift(4,"i"),ue=Ke.read_shift(4,"i");for(var tt=-1,nt=0;nt<109&&(tt=Ke.read_shift(4,"i"),!(tt<0));++nt)ze[nt]=tt;var wt=h(z,H);x(Ge,ue,wt,H,ze);var Bt=y(wt,Pe,ze,H);Bt[Pe].name="!Directory",L>0&&xe!==P&&(Bt[xe].name="!MiniFAT"),Bt[ze[0]].name="!FAT",Bt.fat_addrs=ze,Bt.ssz=H;var tr={},Or=[],zr=[],ur=[];b(Pe,Bt,wt,Or,L,tr,zr,xe),m(zr,ur,Or),Or.shift();var Dr={FileIndex:zr,FullPaths:ur};return X&&X.raw&&(Dr.raw={header:ne,sectors:wt}),Dr}function f(z){if(z[z.l]==80&&z[z.l+1]==75)return[0,0];z.chk(q,"Header Signature: "),z.l+=16;var X=z.read_shift(2,"u");return[z.read_shift(2,"u"),X]}function A(z,X){var re=9;switch(z.l+=2,re=z.read_shift(2)){case 9:if(X!=3)throw new Error("Sector Shift: Expected 9 saw "+re);break;case 12:if(X!=4)throw new Error("Sector Shift: Expected 12 saw "+re);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+re)}z.chk("0600","Mini Sector Shift: "),z.chk("000000000000","Reserved: ")}function h(z,X){for(var re=Math.ceil(z.length/X)-1,H=[],L=1;L<re;++L)H[L-1]=z.slice(L*X,(L+1)*X);return H[re-1]=z.slice(re*X),H}function m(z,X,re){for(var H=0,L=0,ue=0,Pe=0,xe=0,Ge=re.length,ze=[],Ke=[];H<Ge;++H)ze[H]=Ke[H]=H,X[H]=re[H];for(;xe<Ke.length;++xe)H=Ke[xe],L=z[H].L,ue=z[H].R,Pe=z[H].C,ze[H]===H&&(L!==-1&&ze[L]!==L&&(ze[H]=ze[L]),ue!==-1&&ze[ue]!==ue&&(ze[H]=ze[ue])),Pe!==-1&&(ze[Pe]=H),L!==-1&&H!=ze[H]&&(ze[L]=ze[H],Ke.lastIndexOf(L)<xe&&Ke.push(L)),ue!==-1&&H!=ze[H]&&(ze[ue]=ze[H],Ke.lastIndexOf(ue)<xe&&Ke.push(ue));for(H=1;H<Ge;++H)ze[H]===H&&(ue!==-1&&ze[ue]!==ue?ze[H]=ze[ue]:L!==-1&&ze[L]!==L&&(ze[H]=ze[L]));for(H=1;H<Ge;++H)if(z[H].type!==0){if(xe=H,xe!=ze[xe])do xe=ze[xe],X[H]=X[xe]+"/"+X[H];while(xe!==0&&ze[xe]!==-1&&xe!=ze[xe]);ze[H]=-1}for(X[0]+="/",H=1;H<Ge;++H)z[H].type!==2&&(X[H]+="/")}function p(z,X,re){for(var H=z.start,L=z.size,ue=[],Pe=H;re&&L>0&&Pe>=0;)ue.push(X.slice(Pe*T,Pe*T+T)),L-=T,Pe=_p(re,Pe*4);return ue.length===0?mr(0):fl(ue).slice(0,z.size)}function x(z,X,re,H,L){var ue=P;if(z===P){if(X!==0)throw new Error("DIFAT chain shorter than expected")}else if(z!==-1){var Pe=re[z],xe=(H>>>2)-1;if(!Pe)return;for(var Ge=0;Ge<xe&&(ue=_p(Pe,Ge*4))!==P;++Ge)L.push(ue);x(_p(Pe,H-4),X-1,re,H,L)}}function v(z,X,re,H,L){var ue=[],Pe=[];L||(L=[]);var xe=H-1,Ge=0,ze=0;for(Ge=X;Ge>=0;){L[Ge]=!0,ue[ue.length]=Ge,Pe.push(z[Ge]);var Ke=re[Math.floor(Ge*4/H)];if(ze=Ge*4&xe,H<4+ze)throw new Error("FAT boundary crossed: "+Ge+" 4 "+H);if(!z[Ke])break;Ge=_p(z[Ke],ze)}return{nodes:ue,data:HH([Pe])}}function y(z,X,re,H){var L=z.length,ue=[],Pe=[],xe=[],Ge=[],ze=H-1,Ke=0,pt=0,ne=0,Ue=0;for(Ke=0;Ke<L;++Ke)if(xe=[],ne=Ke+X,ne>=L&&(ne-=L),!Pe[ne]){Ge=[];var tt=[];for(pt=ne;pt>=0;){tt[pt]=!0,Pe[pt]=!0,xe[xe.length]=pt,Ge.push(z[pt]);var nt=re[Math.floor(pt*4/H)];if(Ue=pt*4&ze,H<4+Ue)throw new Error("FAT boundary crossed: "+pt+" 4 "+H);if(!z[nt]||(pt=_p(z[nt],Ue),tt[pt]))break}ue[ne]={nodes:xe,data:HH([Ge])}}return ue}function b(z,X,re,H,L,ue,Pe,xe){for(var Ge=0,ze=H.length?2:0,Ke=X[z].data,pt=0,ne=0,Ue;pt<Ke.length;pt+=128){var tt=Ke.slice(pt,pt+128);Ml(tt,64),ne=tt.read_shift(2),Ue=xR(tt,0,ne-ze),H.push(Ue);var nt={name:Ue,type:tt.read_shift(1),color:tt.read_shift(1),L:tt.read_shift(4,"i"),R:tt.read_shift(4,"i"),C:tt.read_shift(4,"i"),clsid:tt.read_shift(16),state:tt.read_shift(4,"i"),start:0,size:0},wt=tt.read_shift(2)+tt.read_shift(2)+tt.read_shift(2)+tt.read_shift(2);wt!==0&&(nt.ct=w(tt,tt.l-8));var Bt=tt.read_shift(2)+tt.read_shift(2)+tt.read_shift(2)+tt.read_shift(2);Bt!==0&&(nt.mt=w(tt,tt.l-8)),nt.start=tt.read_shift(4,"i"),nt.size=tt.read_shift(4,"i"),nt.size<0&&nt.start<0&&(nt.size=nt.type=0,nt.start=P,nt.name=""),nt.type===5?(Ge=nt.start,L>0&&Ge!==P&&(X[Ge].name="!StreamData")):nt.size>=4096?(nt.storage="fat",X[nt.start]===void 0&&(X[nt.start]=v(re,nt.start,X.fat_addrs,X.ssz)),X[nt.start].name=nt.name,nt.content=X[nt.start].data.slice(0,nt.size)):(nt.storage="minifat",nt.size<0?nt.size=0:Ge!==P&&nt.start!==P&&X[Ge]&&(nt.content=p(nt,X[Ge].data,(X[xe]||{}).data))),nt.content&&Ml(nt.content,0),ue[Ue]=nt,Pe.push(nt)}}function w(z,X){return new Date((Od(z,X+4)/1e7*Math.pow(2,32)+Od(z,X)/1e7-11644473600)*1e3)}function I(z,X){return d(),u(c.readFileSync(z),X)}function j(z,X){var re=X&&X.type;switch(re||xa&&Buffer.isBuffer(z)&&(re="buffer"),re||"base64"){case"file":return I(z,X);case"base64":return u(Dd(Wd(z)),X);case"binary":return u(Dd(z),X)}return u(z,X)}function N(z,X){var re=X||{},H=re.root||"Root Entry";if(z.FullPaths||(z.FullPaths=[]),z.FileIndex||(z.FileIndex=[]),z.FullPaths.length!==z.FileIndex.length)throw new Error("inconsistent CFB structure");z.FullPaths.length===0&&(z.FullPaths[0]=H+"/",z.FileIndex[0]={name:H,type:5}),re.CLSID&&(z.FileIndex[0].clsid=re.CLSID),S(z)}function S(z){var X="Sh33tJ5";if(!Dn.find(z,"/"+X)){var re=mr(4);re[0]=55,re[1]=re[3]=50,re[2]=54,z.FileIndex.push({name:X,type:2,content:re,size:4,L:69,R:69,C:69}),z.FullPaths.push(z.FullPaths[0]+X),E(z)}}function E(z,X){N(z);for(var re=!1,H=!1,L=z.FullPaths.length-1;L>=0;--L){var ue=z.FileIndex[L];switch(ue.type){case 0:H?re=!0:(z.FileIndex.pop(),z.FullPaths.pop());break;case 1:case 2:case 5:H=!0,isNaN(ue.R*ue.L*ue.C)&&(re=!0),ue.R>-1&&ue.L>-1&&ue.R==ue.L&&(re=!0);break;default:re=!0;break}}if(!(!re&&!X)){var Pe=new Date(1987,1,19),xe=0,Ge=Object.create?Object.create(null):{},ze=[];for(L=0;L<z.FullPaths.length;++L)Ge[z.FullPaths[L]]=!0,z.FileIndex[L].type!==0&&ze.push([z.FullPaths[L],z.FileIndex[L]]);for(L=0;L<ze.length;++L){var Ke=n(ze[L][0]);H=Ge[Ke],H||(ze.push([Ke,{name:a(Ke).replace("/",""),type:1,clsid:ce,ct:Pe,mt:Pe,content:null}]),Ge[Ke]=!0)}for(ze.sort(function(Ue,tt){return r(Ue[0],tt[0])}),z.FullPaths=[],z.FileIndex=[],L=0;L<ze.length;++L)z.FullPaths[L]=ze[L][0],z.FileIndex[L]=ze[L][1];for(L=0;L<ze.length;++L){var pt=z.FileIndex[L],ne=z.FullPaths[L];if(pt.name=a(ne).replace("/",""),pt.L=pt.R=pt.C=-(pt.color=1),pt.size=pt.content?pt.content.length:0,pt.start=0,pt.clsid=pt.clsid||ce,L===0)pt.C=ze.length>1?1:-1,pt.size=0,pt.type=5;else if(ne.slice(-1)=="/"){for(xe=L+1;xe<ze.length&&n(z.FullPaths[xe])!=ne;++xe);for(pt.C=xe>=ze.length?-1:xe,xe=L+1;xe<ze.length&&n(z.FullPaths[xe])!=n(ne);++xe);pt.R=xe>=ze.length?-1:xe,pt.type=1}else n(z.FullPaths[L+1]||"")==n(ne)&&(pt.R=L+1),pt.type=2}}}function B(z,X){var re=X||{};if(re.fileType=="mad")return be(z,re);switch(E(z),re.fileType){case"zip":return me(z,re)}var H=function(Ue){for(var tt=0,nt=0,wt=0;wt<Ue.FileIndex.length;++wt){var Bt=Ue.FileIndex[wt];if(Bt.content){var tr=Bt.content.length;tr>0&&(tr<4096?tt+=tr+63>>6:nt+=tr+511>>9)}}for(var Or=Ue.FullPaths.length+3>>2,zr=tt+7>>3,ur=tt+127>>7,Dr=zr+nt+Or+ur,dn=Dr+127>>7,mn=dn<=109?0:Math.ceil((dn-109)/127);Dr+dn+mn+127>>7>dn;)mn=++dn<=109?0:Math.ceil((dn-109)/127);var kr=[1,mn,dn,ur,Or,nt,tt,0];return Ue.FileIndex[0].size=tt<<6,kr[7]=(Ue.FileIndex[0].start=kr[0]+kr[1]+kr[2]+kr[3]+kr[4]+kr[5])+(kr[6]+7>>3),kr}(z),L=mr(H[7]<<9),ue=0,Pe=0;{for(ue=0;ue<8;++ue)L.write_shift(1,de[ue]);for(ue=0;ue<8;++ue)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),ue=0;ue<3;++ue)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,H[2]),L.write_shift(4,H[0]+H[1]+H[2]+H[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,H[3]?H[0]+H[1]+H[2]-1:P),L.write_shift(4,H[3]),L.write_shift(-4,H[1]?H[0]-1:P),L.write_shift(4,H[1]),ue=0;ue<109;++ue)L.write_shift(-4,ue<H[2]?H[1]+ue:-1)}if(H[1])for(Pe=0;Pe<H[1];++Pe){for(;ue<236+Pe*127;++ue)L.write_shift(-4,ue<H[2]?H[1]+ue:-1);L.write_shift(-4,Pe===H[1]-1?P:Pe+1)}var xe=function(Ue){for(Pe+=Ue;ue<Pe-1;++ue)L.write_shift(-4,ue+1);Ue&&(++ue,L.write_shift(-4,P))};for(Pe=ue=0,Pe+=H[1];ue<Pe;++ue)L.write_shift(-4,le.DIFSECT);for(Pe+=H[2];ue<Pe;++ue)L.write_shift(-4,le.FATSECT);xe(H[3]),xe(H[4]);for(var Ge=0,ze=0,Ke=z.FileIndex[0];Ge<z.FileIndex.length;++Ge)Ke=z.FileIndex[Ge],Ke.content&&(ze=Ke.content.length,!(ze<4096)&&(Ke.start=Pe,xe(ze+511>>9)));for(xe(H[6]+7>>3);L.l&511;)L.write_shift(-4,le.ENDOFCHAIN);for(Pe=ue=0,Ge=0;Ge<z.FileIndex.length;++Ge)Ke=z.FileIndex[Ge],Ke.content&&(ze=Ke.content.length,!(!ze||ze>=4096)&&(Ke.start=Pe,xe(ze+63>>6)));for(;L.l&511;)L.write_shift(-4,le.ENDOFCHAIN);for(ue=0;ue<H[4]<<2;++ue){var pt=z.FullPaths[ue];if(!pt||pt.length===0){for(Ge=0;Ge<17;++Ge)L.write_shift(4,0);for(Ge=0;Ge<3;++Ge)L.write_shift(4,-1);for(Ge=0;Ge<12;++Ge)L.write_shift(4,0);continue}Ke=z.FileIndex[ue],ue===0&&(Ke.start=Ke.size?Ke.start-1:P);var ne=ue===0&&re.root||Ke.name;if(ze=2*(ne.length+1),L.write_shift(64,ne,"utf16le"),L.write_shift(2,ze),L.write_shift(1,Ke.type),L.write_shift(1,Ke.color),L.write_shift(-4,Ke.L),L.write_shift(-4,Ke.R),L.write_shift(-4,Ke.C),Ke.clsid)L.write_shift(16,Ke.clsid,"hex");else for(Ge=0;Ge<4;++Ge)L.write_shift(4,0);L.write_shift(4,Ke.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,Ke.start),L.write_shift(4,Ke.size),L.write_shift(4,0)}for(ue=1;ue<z.FileIndex.length;++ue)if(Ke=z.FileIndex[ue],Ke.size>=4096)if(L.l=Ke.start+1<<9,xa&&Buffer.isBuffer(Ke.content))Ke.content.copy(L,L.l,0,Ke.size),L.l+=Ke.size+511&-512;else{for(Ge=0;Ge<Ke.size;++Ge)L.write_shift(1,Ke.content[Ge]);for(;Ge&511;++Ge)L.write_shift(1,0)}for(ue=1;ue<z.FileIndex.length;++ue)if(Ke=z.FileIndex[ue],Ke.size>0&&Ke.size<4096)if(xa&&Buffer.isBuffer(Ke.content))Ke.content.copy(L,L.l,0,Ke.size),L.l+=Ke.size+63&-64;else{for(Ge=0;Ge<Ke.size;++Ge)L.write_shift(1,Ke.content[Ge]);for(;Ge&63;++Ge)L.write_shift(1,0)}if(xa)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function k(z,X){var re=z.FullPaths.map(function(Ge){return Ge.toUpperCase()}),H=re.map(function(Ge){var ze=Ge.split("/");return ze[ze.length-(Ge.slice(-1)=="/"?2:1)]}),L=!1;X.charCodeAt(0)===47?(L=!0,X=re[0].slice(0,-1)+X):L=X.indexOf("/")!==-1;var ue=X.toUpperCase(),Pe=L===!0?re.indexOf(ue):H.indexOf(ue);if(Pe!==-1)return z.FileIndex[Pe];var xe=!ue.match(nb);for(ue=ue.replace(Hc,""),xe&&(ue=ue.replace(nb,"!")),Pe=0;Pe<re.length;++Pe)if((xe?re[Pe].replace(nb,"!"):re[Pe]).replace(Hc,"")==ue||(xe?H[Pe].replace(nb,"!"):H[Pe]).replace(Hc,"")==ue)return z.FileIndex[Pe];return null}var T=64,P=-2,q="d0cf11e0a1b11ae1",de=[208,207,17,224,161,177,26,225],ce="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:P,FREESECT:-1,HEADER_SIGNATURE:q,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ce,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function he(z,X,re){d();var H=B(z,re);c.writeFileSync(X,H)}function ae(z){for(var X=new Array(z.length),re=0;re<z.length;++re)X[re]=String.fromCharCode(z[re]);return X.join("")}function Ce(z,X){var re=B(z,X);switch(X&&X.type||"buffer"){case"file":return d(),c.writeFileSync(X.filename,re),re;case"binary":return typeof re=="string"?re:ae(re);case"base64":return R2(typeof re=="string"?re:ae(re));case"buffer":if(xa)return Buffer.isBuffer(re)?re:UA(re);case"array":return typeof re=="string"?Dd(re):re}return re}var De;function O(z){try{var X=z.InflateRaw,re=new X;if(re._processChunk(new Uint8Array([3,0]),re._finishFlushFlag),re.bytesRead)De=z;else throw new Error("zlib does not expose bytesRead")}catch(H){console.error("cannot use native zlib: "+(H.message||H))}}function R(z,X){if(!De)return ie(z,X);var re=De.InflateRaw,H=new re,L=H._processChunk(z.slice(z.l),H._finishFlushFlag);return z.l+=H.bytesRead,L}function G(z){return De?De.deflateRawSync(z):dt(z)}var M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Y=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function D(z){var X=(z<<1|z<<11)&139536|(z<<5|z<<15)&558144;return(X>>16|X>>8|X)&255}for(var V=typeof Uint8Array<"u",te=V?new Uint8Array(256):[],ve=0;ve<256;++ve)te[ve]=D(ve);function Q(z,X){var re=te[z&255];return X<=8?re>>>8-X:(re=re<<8|te[z>>8&255],X<=16?re>>>16-X:(re=re<<8|te[z>>16&255],re>>>24-X))}function Xe(z,X){var re=X&7,H=X>>>3;return(z[H]|(re<=6?0:z[H+1]<<8))>>>re&3}function se(z,X){var re=X&7,H=X>>>3;return(z[H]|(re<=5?0:z[H+1]<<8))>>>re&7}function Z(z,X){var re=X&7,H=X>>>3;return(z[H]|(re<=4?0:z[H+1]<<8))>>>re&15}function ke(z,X){var re=X&7,H=X>>>3;return(z[H]|(re<=3?0:z[H+1]<<8))>>>re&31}function Se(z,X){var re=X&7,H=X>>>3;return(z[H]|(re<=1?0:z[H+1]<<8))>>>re&127}function Ee(z,X,re){var H=X&7,L=X>>>3,ue=(1<<re)-1,Pe=z[L]>>>H;return re<8-H||(Pe|=z[L+1]<<8-H,re<16-H)||(Pe|=z[L+2]<<16-H,re<24-H)||(Pe|=z[L+3]<<24-H),Pe&ue}function Ze(z,X,re){var H=X&7,L=X>>>3;return H<=5?z[L]|=(re&7)<<H:(z[L]|=re<<H&255,z[L+1]=(re&7)>>8-H),X+3}function ot(z,X,re){var H=X&7,L=X>>>3;return re=(re&1)<<H,z[L]|=re,X+1}function vt(z,X,re){var H=X&7,L=X>>>3;return re<<=H,z[L]|=re&255,re>>>=8,z[L+1]=re,X+8}function _t(z,X,re){var H=X&7,L=X>>>3;return re<<=H,z[L]|=re&255,re>>>=8,z[L+1]=re&255,z[L+2]=re>>>8,X+16}function Tt(z,X){var re=z.length,H=2*re>X?2*re:X+5,L=0;if(re>=X)return z;if(xa){var ue=CH(H);if(z.copy)z.copy(ue);else for(;L<z.length;++L)ue[L]=z[L];return ue}else if(V){var Pe=new Uint8Array(H);if(Pe.set)Pe.set(z);else for(;L<re;++L)Pe[L]=z[L];return Pe}return z.length=H,z}function Lt(z){for(var X=new Array(z),re=0;re<z;++re)X[re]=0;return X}function Rt(z,X,re){var H=1,L=0,ue=0,Pe=0,xe=0,Ge=z.length,ze=V?new Uint16Array(32):Lt(32);for(ue=0;ue<32;++ue)ze[ue]=0;for(ue=Ge;ue<re;++ue)z[ue]=0;Ge=z.length;var Ke=V?new Uint16Array(Ge):Lt(Ge);for(ue=0;ue<Ge;++ue)ze[L=z[ue]]++,H<L&&(H=L),Ke[ue]=0;for(ze[0]=0,ue=1;ue<=H;++ue)ze[ue+16]=xe=xe+ze[ue-1]<<1;for(ue=0;ue<Ge;++ue)xe=z[ue],xe!=0&&(Ke[ue]=ze[xe+16]++);var pt=0;for(ue=0;ue<Ge;++ue)if(pt=z[ue],pt!=0)for(xe=Q(Ke[ue],H)>>H-pt,Pe=(1<<H+4-pt)-1;Pe>=0;--Pe)X[xe|Pe<<pt]=pt&15|ue<<4;return H}var Et=V?new Uint16Array(512):Lt(512),Re=V?new Uint16Array(32):Lt(32);if(!V){for(var Te=0;Te<512;++Te)Et[Te]=0;for(Te=0;Te<32;++Te)Re[Te]=0}(function(){for(var z=[],X=0;X<32;X++)z.push(5);Rt(z,Re,32);var re=[];for(X=0;X<=143;X++)re.push(8);for(;X<=255;X++)re.push(9);for(;X<=279;X++)re.push(7);for(;X<=287;X++)re.push(8);Rt(re,Et,288)})();var Ye=function(){for(var X=V?new Uint8Array(32768):[],re=0,H=0;re<Y.length-1;++re)for(;H<Y[re+1];++H)X[H]=re;for(;H<32768;++H)X[H]=29;var L=V?new Uint8Array(259):[];for(re=0,H=0;re<K.length-1;++re)for(;H<K[re+1];++H)L[H]=re;function ue(xe,Ge){for(var ze=0;ze<xe.length;){var Ke=Math.min(65535,xe.length-ze),pt=ze+Ke==xe.length;for(Ge.write_shift(1,+pt),Ge.write_shift(2,Ke),Ge.write_shift(2,~Ke&65535);Ke-- >0;)Ge[Ge.l++]=xe[ze++]}return Ge.l}function Pe(xe,Ge){for(var ze=0,Ke=0,pt=V?new Uint16Array(32768):[];Ke<xe.length;){var ne=Math.min(65535,xe.length-Ke);if(ne<10){for(ze=Ze(Ge,ze,+(Ke+ne==xe.length)),ze&7&&(ze+=8-(ze&7)),Ge.l=ze/8|0,Ge.write_shift(2,ne),Ge.write_shift(2,~ne&65535);ne-- >0;)Ge[Ge.l++]=xe[Ke++];ze=Ge.l*8;continue}ze=Ze(Ge,ze,+(Ke+ne==xe.length)+2);for(var Ue=0;ne-- >0;){var tt=xe[Ke];Ue=(Ue<<5^tt)&32767;var nt=-1,wt=0;if((nt=pt[Ue])&&(nt|=Ke&-32768,nt>Ke&&(nt-=32768),nt<Ke))for(;xe[nt+wt]==xe[Ke+wt]&&wt<250;)++wt;if(wt>2){tt=L[wt],tt<=22?ze=vt(Ge,ze,te[tt+1]>>1)-1:(vt(Ge,ze,3),ze+=5,vt(Ge,ze,te[tt-23]>>5),ze+=3);var Bt=tt<8?0:tt-4>>2;Bt>0&&(_t(Ge,ze,wt-K[tt]),ze+=Bt),tt=X[Ke-nt],ze=vt(Ge,ze,te[tt]>>3),ze-=3;var tr=tt<4?0:tt-2>>1;tr>0&&(_t(Ge,ze,Ke-nt-Y[tt]),ze+=tr);for(var Or=0;Or<wt;++Or)pt[Ue]=Ke&32767,Ue=(Ue<<5^xe[Ke])&32767,++Ke;ne-=wt-1}else tt<=143?tt=tt+48:ze=ot(Ge,ze,1),ze=vt(Ge,ze,te[tt]),pt[Ue]=Ke&32767,++Ke}ze=vt(Ge,ze,0)-1}return Ge.l=(ze+7)/8|0,Ge.l}return function(Ge,ze){return Ge.length<8?ue(Ge,ze):Pe(Ge,ze)}}();function dt(z){var X=mr(50+Math.floor(z.length*1.1)),re=Ye(z,X);return X.slice(0,re)}var Fe=V?new Uint16Array(32768):Lt(32768),je=V?new Uint16Array(32768):Lt(32768),We=V?new Uint16Array(128):Lt(128),ee=1,Ve=1;function rt(z,X){var re=ke(z,X)+257;X+=5;var H=ke(z,X)+1;X+=5;var L=Z(z,X)+4;X+=4;for(var ue=0,Pe=V?new Uint8Array(19):Lt(19),xe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ge=1,ze=V?new Uint8Array(8):Lt(8),Ke=V?new Uint8Array(8):Lt(8),pt=Pe.length,ne=0;ne<L;++ne)Pe[M[ne]]=ue=se(z,X),Ge<ue&&(Ge=ue),ze[ue]++,X+=3;var Ue=0;for(ze[0]=0,ne=1;ne<=Ge;++ne)Ke[ne]=Ue=Ue+ze[ne-1]<<1;for(ne=0;ne<pt;++ne)(Ue=Pe[ne])!=0&&(xe[ne]=Ke[Ue]++);var tt=0;for(ne=0;ne<pt;++ne)if(tt=Pe[ne],tt!=0){Ue=te[xe[ne]]>>8-tt;for(var nt=(1<<7-tt)-1;nt>=0;--nt)We[Ue|nt<<tt]=tt&7|ne<<3}var wt=[];for(Ge=1;wt.length<re+H;)switch(Ue=We[Se(z,X)],X+=Ue&7,Ue>>>=3){case 16:for(ue=3+Xe(z,X),X+=2,Ue=wt[wt.length-1];ue-- >0;)wt.push(Ue);break;case 17:for(ue=3+se(z,X),X+=3;ue-- >0;)wt.push(0);break;case 18:for(ue=11+Se(z,X),X+=7;ue-- >0;)wt.push(0);break;default:wt.push(Ue),Ge<Ue&&(Ge=Ue);break}var Bt=wt.slice(0,re),tr=wt.slice(re);for(ne=re;ne<286;++ne)Bt[ne]=0;for(ne=H;ne<30;++ne)tr[ne]=0;return ee=Rt(Bt,Fe,286),Ve=Rt(tr,je,30),X}function $e(z,X){if(z[0]==3&&!(z[1]&3))return[Tm(X),2];for(var re=0,H=0,L=CH(X||1<<18),ue=0,Pe=L.length>>>0,xe=0,Ge=0;!(H&1);){if(H=se(z,re),re+=3,H>>>1)H>>1==1?(xe=9,Ge=5):(re=rt(z,re),xe=ee,Ge=Ve);else{re&7&&(re+=8-(re&7));var ze=z[re>>>3]|z[(re>>>3)+1]<<8;if(re+=32,ze>0)for(!X&&Pe<ue+ze&&(L=Tt(L,ue+ze),Pe=L.length);ze-- >0;)L[ue++]=z[re>>>3],re+=8;continue}for(;;){!X&&Pe<ue+32767&&(L=Tt(L,ue+32767),Pe=L.length);var Ke=Ee(z,re,xe),pt=H>>>1==1?Et[Ke]:Fe[Ke];if(re+=pt&15,pt>>>=4,!(pt>>>8&255))L[ue++]=pt;else{if(pt==256)break;pt-=257;var ne=pt<8?0:pt-4>>2;ne>5&&(ne=0);var Ue=ue+K[pt];ne>0&&(Ue+=Ee(z,re,ne),re+=ne),Ke=Ee(z,re,Ge),pt=H>>>1==1?Re[Ke]:je[Ke],re+=pt&15,pt>>>=4;var tt=pt<4?0:pt-2>>1,nt=Y[pt];for(tt>0&&(nt+=Ee(z,re,tt),re+=tt),!X&&Pe<Ue&&(L=Tt(L,Ue+100),Pe=L.length);ue<Ue;)L[ue]=L[ue-nt],++ue}}}return X?[L,re+7>>>3]:[L.slice(0,ue),re+7>>>3]}function ie(z,X){var re=z.slice(z.l||0),H=$e(re,X);return z.l+=H[1],H[0]}function pe(z,X){if(z)typeof console<"u"&&console.error(X);else throw new Error(X)}function fe(z,X){var re=z;Ml(re,0);var H=[],L=[],ue={FileIndex:H,FullPaths:L};N(ue,{root:X.root});for(var Pe=re.length-4;(re[Pe]!=80||re[Pe+1]!=75||re[Pe+2]!=5||re[Pe+3]!=6)&&Pe>=0;)--Pe;re.l=Pe+4,re.l+=4;var xe=re.read_shift(2);re.l+=6;var Ge=re.read_shift(4);for(re.l=Ge,Pe=0;Pe<xe;++Pe){re.l+=20;var ze=re.read_shift(4),Ke=re.read_shift(4),pt=re.read_shift(2),ne=re.read_shift(2),Ue=re.read_shift(2);re.l+=8;var tt=re.read_shift(4),nt=l(re.slice(re.l+pt,re.l+pt+ne));re.l+=pt+ne+Ue;var wt=re.l;re.l=tt+4,Me(re,ze,Ke,ue,nt),re.l=wt}return ue}function Me(z,X,re,H,L){z.l+=2;var ue=z.read_shift(2),Pe=z.read_shift(2),xe=o(z);if(ue&8257)throw new Error("Unsupported ZIP encryption");for(var Ge=z.read_shift(4),ze=z.read_shift(4),Ke=z.read_shift(4),pt=z.read_shift(2),ne=z.read_shift(2),Ue="",tt=0;tt<pt;++tt)Ue+=String.fromCharCode(z[z.l++]);if(ne){var nt=l(z.slice(z.l,z.l+ne));(nt[21589]||{}).mt&&(xe=nt[21589].mt),((L||{})[21589]||{}).mt&&(xe=L[21589].mt)}z.l+=ne;var wt=z.slice(z.l,z.l+ze);switch(Pe){case 8:wt=R(z,Ke);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Pe)}var Bt=!1;ue&8&&(Ge=z.read_shift(4),Ge==134695760&&(Ge=z.read_shift(4),Bt=!0),ze=z.read_shift(4),Ke=z.read_shift(4)),ze!=X&&pe(Bt,"Bad compressed size: "+X+" != "+ze),Ke!=re&&pe(Bt,"Bad uncompressed size: "+re+" != "+Ke),Le(H,Ue,wt,{unsafe:!0,mt:xe})}function me(z,X){var re=X||{},H=[],L=[],ue=mr(1),Pe=re.compression?8:0,xe=0,Ge=0,ze=0,Ke=0,pt=0,ne=z.FullPaths[0],Ue=ne,tt=z.FileIndex[0],nt=[],wt=0;for(Ge=1;Ge<z.FullPaths.length;++Ge)if(Ue=z.FullPaths[Ge].slice(ne.length),tt=z.FileIndex[Ge],!(!tt.size||!tt.content||Ue=="Sh33tJ5")){var Bt=Ke,tr=mr(Ue.length);for(ze=0;ze<Ue.length;++ze)tr.write_shift(1,Ue.charCodeAt(ze)&127);tr=tr.slice(0,tr.l),nt[pt]=k4e.buf(tt.content,0);var Or=tt.content;Pe==8&&(Or=G(Or)),ue=mr(30),ue.write_shift(4,67324752),ue.write_shift(2,20),ue.write_shift(2,xe),ue.write_shift(2,Pe),tt.mt?s(ue,tt.mt):ue.write_shift(4,0),ue.write_shift(-4,nt[pt]),ue.write_shift(4,Or.length),ue.write_shift(4,tt.content.length),ue.write_shift(2,tr.length),ue.write_shift(2,0),Ke+=ue.length,H.push(ue),Ke+=tr.length,H.push(tr),Ke+=Or.length,H.push(Or),ue=mr(46),ue.write_shift(4,33639248),ue.write_shift(2,0),ue.write_shift(2,20),ue.write_shift(2,xe),ue.write_shift(2,Pe),ue.write_shift(4,0),ue.write_shift(-4,nt[pt]),ue.write_shift(4,Or.length),ue.write_shift(4,tt.content.length),ue.write_shift(2,tr.length),ue.write_shift(2,0),ue.write_shift(2,0),ue.write_shift(2,0),ue.write_shift(2,0),ue.write_shift(4,0),ue.write_shift(4,Bt),wt+=ue.l,L.push(ue),wt+=tr.length,L.push(tr),++pt}return ue=mr(22),ue.write_shift(4,101010256),ue.write_shift(2,0),ue.write_shift(2,0),ue.write_shift(2,pt),ue.write_shift(2,pt),ue.write_shift(4,wt),ue.write_shift(4,Ke),ue.write_shift(2,0),fl([fl(H),fl(L),ue])}var ye={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function mt(z,X){if(z.ctype)return z.ctype;var re=z.name||"",H=re.match(/\.([^\.]+)$/);return H&&ye[H[1]]||X&&(H=(re=X).match(/[\.\\]([^\.\\])+$/),H&&ye[H[1]])?ye[H[1]]:"application/octet-stream"}function gt(z){for(var X=R2(z),re=[],H=0;H<X.length;H+=76)re.push(X.slice(H,H+76));return re.join(`\r
`)+`\r
`}function yt(z){var X=z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ze){var Ke=ze.charCodeAt(0).toString(16).toUpperCase();return"="+(Ke.length==1?"0"+Ke:Ke)});X=X.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),X.charAt(0)==`
`&&(X="=0D"+X.slice(1)),X=X.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var re=[],H=X.split(`\r
`),L=0;L<H.length;++L){var ue=H[L];if(ue.length==0){re.push("");continue}for(var Pe=0;Pe<ue.length;){var xe=76,Ge=ue.slice(Pe,Pe+xe);Ge.charAt(xe-1)=="="?xe--:Ge.charAt(xe-2)=="="?xe-=2:Ge.charAt(xe-3)=="="&&(xe-=3),Ge=ue.slice(Pe,Pe+xe),Pe+=xe,Pe<ue.length&&(Ge+="="),re.push(Ge)}}return re.join(`\r
`)}function Pt(z){for(var X=[],re=0;re<z.length;++re){for(var H=z[re];re<=z.length&&H.charAt(H.length-1)=="=";)H=H.slice(0,H.length-1)+z[++re];X.push(H)}for(var L=0;L<X.length;++L)X[L]=X[L].replace(/[=][0-9A-Fa-f]{2}/g,function(ue){return String.fromCharCode(parseInt(ue.slice(1),16))});return Dd(X.join(`\r
`))}function Ft(z,X,re){for(var H="",L="",ue="",Pe,xe=0;xe<10;++xe){var Ge=X[xe];if(!Ge||Ge.match(/^\s*$/))break;var ze=Ge.match(/^(.*?):\s*([^\s].*)$/);if(ze)switch(ze[1].toLowerCase()){case"content-location":H=ze[2].trim();break;case"content-type":ue=ze[2].trim();break;case"content-transfer-encoding":L=ze[2].trim();break}}switch(++xe,L.toLowerCase()){case"base64":Pe=Dd(Wd(X.slice(xe).join("")));break;case"quoted-printable":Pe=Pt(X.slice(xe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var Ke=Le(z,H.slice(re.length),Pe,{unsafe:!0});ue&&(Ke.ctype=ue)}function Oe(z,X){if(ae(z.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var re=X&&X.root||"",H=(xa&&Buffer.isBuffer(z)?z.toString("binary"):ae(z)).split(`\r
`),L=0,ue="";for(L=0;L<H.length;++L)if(ue=H[L],!!/^Content-Location:/i.test(ue)&&(ue=ue.slice(ue.indexOf("file")),re||(re=ue.slice(0,ue.lastIndexOf("/")+1)),ue.slice(0,re.length)!=re))for(;re.length>0&&(re=re.slice(0,re.length-1),re=re.slice(0,re.lastIndexOf("/")+1),ue.slice(0,re.length)!=re););var Pe=(H[1]||"").match(/boundary="(.*?)"/);if(!Pe)throw new Error("MAD cannot find boundary");var xe="--"+(Pe[1]||""),Ge=[],ze=[],Ke={FileIndex:Ge,FullPaths:ze};N(Ke);var pt,ne=0;for(L=0;L<H.length;++L){var Ue=H[L];Ue!==xe&&Ue!==xe+"--"||(ne++&&Ft(Ke,H.slice(pt,L),re),pt=L)}return Ke}function be(z,X){var re=X||{},H=re.boundary||"SheetJS";H="------="+H;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+H.slice(2)+'"',"","",""],ue=z.FullPaths[0],Pe=ue,xe=z.FileIndex[0],Ge=1;Ge<z.FullPaths.length;++Ge)if(Pe=z.FullPaths[Ge].slice(ue.length),xe=z.FileIndex[Ge],!(!xe.size||!xe.content||Pe=="Sh33tJ5")){Pe=Pe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(wt){return"_x"+wt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(wt){return"_u"+wt.charCodeAt(0).toString(16)+"_"});for(var ze=xe.content,Ke=xa&&Buffer.isBuffer(ze)?ze.toString("binary"):ae(ze),pt=0,ne=Math.min(1024,Ke.length),Ue=0,tt=0;tt<=ne;++tt)(Ue=Ke.charCodeAt(tt))>=32&&Ue<128&&++pt;var nt=pt>=ne*4/5;L.push(H),L.push("Content-Location: "+(re.root||"file:///C:/SheetJS/")+Pe),L.push("Content-Transfer-Encoding: "+(nt?"quoted-printable":"base64")),L.push("Content-Type: "+mt(xe,Pe)),L.push(""),L.push(nt?yt(Ke):gt(Ke))}return L.push(H+`--\r
`),L.join(`\r
`)}function Ae(z){var X={};return N(X,z),X}function Le(z,X,re,H){var L=H&&H.unsafe;L||N(z);var ue=!L&&Dn.find(z,X);if(!ue){var Pe=z.FullPaths[0];X.slice(0,Pe.length)==Pe?Pe=X:(Pe.slice(-1)!="/"&&(Pe+="/"),Pe=(Pe+X).replace("//","/")),ue={name:a(X),type:2},z.FileIndex.push(ue),z.FullPaths.push(Pe),L||Dn.utils.cfb_gc(z)}return ue.content=re,ue.size=re?re.length:0,H&&(H.CLSID&&(ue.clsid=H.CLSID),H.mt&&(ue.mt=H.mt),H.ct&&(ue.ct=H.ct)),ue}function ut(z,X){N(z);var re=Dn.find(z,X);if(re){for(var H=0;H<z.FileIndex.length;++H)if(z.FileIndex[H]==re)return z.FileIndex.splice(H,1),z.FullPaths.splice(H,1),!0}return!1}function ct(z,X,re){N(z);var H=Dn.find(z,X);if(H){for(var L=0;L<z.FileIndex.length;++L)if(z.FileIndex[L]==H)return z.FileIndex[L].name=a(re),z.FullPaths[L]=re,!0}return!1}function st(z){E(z,!0)}return e.find=k,e.read=j,e.parse=u,e.write=Ce,e.writeFile=he,e.utils={cfb_new:Ae,cfb_add:Le,cfb_del:ut,cfb_mov:ct,cfb_gc:st,ReadShift:Lb,CheckField:aae,prep_blob:Ml,bconcat:fl,use_zlib:O,_deflateRaw:dt,_inflateRaw:ie,consts:le},e}();function F4e(t){return typeof t=="string"?mP(t):Array.isArray(t)?i4e(t):t}function Vw(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=mP(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?nh(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var a=new Blob([F4e(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(t);return l.open("w"),l.encoding="binary",Array.isArray(e)&&(e=Gm(e)),l.write(e),l.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function O4e(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Gi(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function BH(t,e){for(var r=[],n=Gi(t),a=0;a!==n.length;++a)r[t[n[a]][e]]==null&&(r[t[n[a]][e]]=n[a]);return r}function gP(t){for(var e=[],r=Gi(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function xP(t){for(var e=[],r=Gi(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function D4e(t){for(var e=[],r=Gi(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var YS=new Date(1899,11,30,0,0,0);function qo(t,e){var r=t.getTime(),n=YS.getTime()+(t.getTimezoneOffset()-YS.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Rne=new Date,R4e=YS.getTime()+(Rne.getTimezoneOffset()-YS.getTimezoneOffset())*6e4,kH=Rne.getTimezoneOffset();function vP(t){var e=new Date;return e.setTime(t*24*60*60*1e3+R4e),e.getTimezoneOffset()!==kH&&e.setTime(e.getTime()+(e.getTimezoneOffset()-kH)*6e4),e}function M4e(t){var e=0,r=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(a[s],10)}return e}var FH=new Date("2017-02-19T19:06:09.000Z"),Mne=isNaN(FH.getFullYear())?new Date("2/19/17"):FH,L4e=Mne.getFullYear()==2017;function Zs(t,e){var r=new Date(t);if(L4e)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(Mne.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function vg(t,e){if(xa&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return nh(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return nh(_ne(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return nh(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return nh(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function ei(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=ei(t[r]));return e}function Ui(t,e){for(var r="";r.length<e;)r+=t;return r}function Nf(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var U4e=["january","february","march","april","may","june","july","august","september","october","november","december"];function $v(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),a=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&U4e.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var Q4e=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],l=1;l<s.length;++l)o.push(a),o.push(s[l]);return o}}();function Lne(t){return t?t.content&&t.type?vg(t.content,!0):t.data?rb(t.data):t.asNodeBuffer&&xa?rb(t.asNodeBuffer().toString("binary")):t.asBinary?rb(t.asBinary()):t._data&&t._data.getContent?rb(vg(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function Une(t){if(!t)return null;if(t.data)return wH(t.data);if(t.asNodeBuffer&&xa)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?wH(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function V4e(t){return t&&t.name.slice(-4)===".bin"?Une(t):Lne(t)}function bu(t,e){for(var r=t.FullPaths||Gi(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function fR(t,e){var r=bu(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function go(t,e,r){if(!r)return V4e(fR(t,e));if(!e)return null;try{return go(t,e)}catch{return null}}function Rd(t,e,r){if(!r)return Lne(fR(t,e));if(!e)return null;try{return Rd(t,e)}catch{return null}}function H4e(t,e,r){return Une(fR(t,e))}function OH(t){for(var e=t.FullPaths||Gi(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function ma(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return xa?n=UA(r):n=o4e(r),Dn.utils.cfb_add(t,e,n)}Dn.utils.cfb_add(t,e,r)}else t.file(e,r)}function hR(){return Dn.utils.cfb_new()}function Qne(t,e){switch(e.type){case"base64":return Dn.read(t,{type:"base64"});case"binary":return Dn.read(t,{type:"binary"});case"buffer":case"array":return Dn.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function ab(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var ho=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,$4e=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,DH=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,G4e=/<[^>]*>/g,wc=ho.match(DH)?DH:G4e,K4e=/<\w*:/,q4e=/<(\/?)\w+:/;function zn(t,e,r){for(var n={},a=0,s=0;a!==t.length&&!((s=t.charCodeAt(a))===32||s===10||s===13);++a);if(e||(n[0]=t.slice(0,a)),a===t.length)return n;var o=t.match($4e),l=0,c="",d=0,u="",f="",A=1;if(o)for(d=0;d!=o.length;++d){for(f=o[d],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(u=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(A=(a=f.charCodeAt(s+1))==34||a==39?1:0,c=f.slice(s+1+A,f.length-A),l=0;l!=u.length&&u.charCodeAt(l)!==58;++l);if(l===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=c,n[u.toLowerCase()]=c;else{var h=(l===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(l+1);if(n[h]&&u.slice(l-3,l)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function bh(t){return t.replace(q4e,"<$1")}var Vne={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},AR=gP(Vne),Ua=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(t,function(l,c){return Vne[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(e,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,o)+r(a.slice(o+3))}}(),mR=/[&<>'"]/g,z4e=/[\u0000-\u0008\u000b-\u001f]/g;function gs(t){var e=t+"";return e.replace(mR,function(r){return AR[r]}).replace(z4e,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function RH(t){return gs(t).replace(/ /g,"_x0020_")}var Hne=/[\u0000-\u001f]/g;function pR(t){var e=t+"";return e.replace(mR,function(r){return AR[r]}).replace(/\n/g,"<br/>").replace(Hne,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function W4e(t){var e=t+"";return e.replace(mR,function(r){return AR[r]}).replace(Hne,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var MH=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function X4e(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ws(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function M5(t){for(var e="",r=0,n=0,a=0,s=0,o=0,l=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(a=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,e+=String.fromCharCode(o);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}o=t.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(s&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(l>>>10&1023)),e+=String.fromCharCode(56320+(l&1023))}return e}function LH(t){var e=Tm(2*t.length),r,n,a=1,s=0,o=0,l;for(n=0;n<t.length;n+=a)a=1,(l=t.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(t.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[s++]=o&255,e[s++]=o>>>8,o=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function UH(t){return UA(t,"binary").toString("utf8")}var KC="foo bar baz",Cs=xa&&(UH(KC)==M5(KC)&&UH||LH(KC)==M5(KC)&&LH)||M5,nh=xa?function(t){return UA(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,a=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},L2=function(){var t={};return function(r,n){var a=r+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),$ne=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}}(),Y4e=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),J4e=/<\/?(?:vt:)?variant>/g,Z4e=/<(?:vt:)([^>]*)>([\s\S]*)</;function QH(t,e){var r=zn(t),n=t.match(Y4e(r.baseType))||[],a=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var o=s.replace(J4e,"").match(Z4e);o&&a.push({v:Cs(o[2]),t:o[1]})}),a}var Gne=/(^\s|\s$|\n)/;function Ul(t,e){return"<"+t+(e.match(Gne)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function U2(t){return Gi(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Yr(t,e,r){return"<"+t+(r!=null?U2(r):"")+(e!=null?(e.match(Gne)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function aF(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function e5e(t,e){switch(typeof t){case"string":var r=Yr("vt:lpwstr",gs(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Yr((t|0)==t?"vt:i4":"vt:r8",gs(String(t)));case"boolean":return Yr("vt:bool",t?"true":"false")}if(t instanceof Date)return Yr("vt:filetime",aF(t));throw new Error("Unable to serialize "+t)}function gR(t){if(xa&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Cs(Gm(cR(t)));throw new Error("Bad input format: expected Buffer or string")}var Q2=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Vo={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Vg=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Fd={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function t5e(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,s=5;s>=0;--s)a=a*256+t[e+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function r5e(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,s=0,o=n?-e:e;isFinite(o)?o==0?a=s=0:(a=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(e)?26985:0);for(var l=0;l<=5;++l,s/=256)t[r+l]=s&255;t[r+6]=(a&15)<<4|s&15,t[r+7]=a>>4|n}var VH=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,s=t[0][n].length;a<s;a+=r)e.push.apply(e,t[0][n].slice(a,a+r));return e},HH=xa?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:UA(e)})):VH(t)}:VH,$H=function(t,e,r){for(var n=[],a=e;a<r;a+=2)n.push(String.fromCharCode(tA(t,a)));return n.join("").replace(Hc,"")},xR=xa?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Hc,""):$H(t,e,r)}:$H,GH=function(t,e,r){for(var n=[],a=e;a<e+r;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},Kne=xa?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):GH(t,e,r)}:GH,KH=function(t,e,r){for(var n=[],a=e;a<r;a++)n.push(String.fromCharCode(Rx(t,a)));return n.join("")},Hw=xa?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):KH(e,r,n)}:KH,qne=function(t,e){var r=Od(t,e);return r>0?Hw(t,e+4,e+4+r-1):""},zne=qne,Wne=function(t,e){var r=Od(t,e);return r>0?Hw(t,e+4,e+4+r-1):""},Xne=Wne,Yne=function(t,e){var r=2*Od(t,e);return r>0?Hw(t,e+4,e+4+r-1):""},Jne=Yne,Zne=function(e,r){var n=Od(e,r);return n>0?xR(e,r+4,r+4+n):""},eae=Zne,tae=function(t,e){var r=Od(t,e);return r>0?Hw(t,e+4,e+4+r):""},rae=tae,nae=function(t,e){return t5e(t,e)},JS=nae,vR=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};xa&&(zne=function(e,r){if(!Buffer.isBuffer(e))return qne(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Xne=function(e,r){if(!Buffer.isBuffer(e))return Wne(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Jne=function(e,r){if(!Buffer.isBuffer(e))return Yne(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},eae=function(e,r){if(!Buffer.isBuffer(e))return Zne(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},rae=function(e,r){if(!Buffer.isBuffer(e))return tae(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},JS=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):nae(e,r)},vR=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Rx=function(t,e){return t[e]},tA=function(t,e){return t[e+1]*256+t[e]},n5e=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Od=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},_p=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},a5e=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Lb(t,e){var r="",n,a,s=[],o,l,c,d;switch(e){case"dbcs":if(d=this.l,xa&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(tA(this,d)),d+=2;t*=2;break;case"utf8":r=Hw(this,this.l,this.l+t);break;case"utf16le":t*=2,r=xR(this,this.l,this.l+t);break;case"wstr":return Lb.call(this,t,"dbcs");case"lpstr-ansi":r=zne(this,this.l),t=4+Od(this,this.l);break;case"lpstr-cp":r=Xne(this,this.l),t=4+Od(this,this.l);break;case"lpwstr":r=Jne(this,this.l),t=4+2*Od(this,this.l);break;case"lpp4":t=4+Od(this,this.l),r=eae(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Od(this,this.l),r=rae(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=Rx(this,this.l+t++))!==0;)s.push(GC(o));r=s.join("");break;case"_wstr":for(t=0,r="";(o=tA(this,this.l+t))!==0;)s.push(GC(o)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Rx(this,d),this.l=d+1,l=Lb.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(GC(tA(this,d))),d+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Rx(this,d),this.l=d+1,l=Lb.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(GC(Rx(this,d))),d+=1}r=s.join("");break;default:switch(t){case 1:return n=Rx(this,this.l),this.l++,n;case 2:return n=(e==="i"?n5e:tA)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?_p:a5e)(this,this.l),this.l+=4,n):(a=Od(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=JS(this,this.l):a=JS([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:r=Kne(this,this.l,t);break}}return this.l+=t,r}var s5e=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},i5e=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},o5e=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function l5e(t,e,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=e.length;++a)o5e(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(r==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var o=e.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,s5e(this,e,this.l);break;case 8:if(n=8,r==="f"){r5e(this,e,this.l);break}case 16:break;case-4:n=4,i5e(this,e,this.l);break}return this.l+=n,this}function aae(t,e){var r=Kne(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Ml(t,e){t.l=e,t.read_shift=Lb,t.chk=aae,t.write_shift=l5e}function vc(t,e){t.l+=e}function mr(t){var e=Tm(t);return Ml(e,0),e}function QA(t,e,r){if(t){var n,a,s;Ml(t,t.l||0);for(var o=t.length,l=0,c=0;t.l<o;){l=t.read_shift(1),l&128&&(l=(l&127)+((t.read_shift(1)&127)<<7));var d=q2[l]||q2[65535];for(n=t.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=t.read_shift(1))&127)<<7*a;c=t.l+s;var u=d.f&&d.f(t,s,r);if(t.l=c,e(u,d,l))return}}}function Ad(){var t=[],e=xa?256:2048,r=function(d){var u=mr(d);return Ml(u,0),u},n=r(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,e)))},o=function(){return a(),fl(t)},l=function(d){a(),n=d,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:l,end:o,_bufs:t}}function Tr(t,e,r,n){var a=+e,s;if(!isNaN(a)){n||(n=q2[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=t.next(s);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&vR(r)&&t.push(r)}}function Ub(t,e,r){var n=ei(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function qH(t,e,r){var n=ei(t);return n.s=Ub(n.s,e.s,r),n.e=Ub(n.e,e.s,r),n}function Qb(t,e){if(t.cRel&&t.c<0)for(t=ei(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=ei(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Kn(t);return!t.cRel&&t.cRel!=null&&(r=u5e(r)),!t.rRel&&t.rRel!=null&&(r=c5e(r)),r}function L5(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+_i(t.s.c)+":"+(t.e.cRel?"":"$")+_i(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+uo(t.s.r)+":"+(t.e.rRel?"":"$")+uo(t.e.r):Qb(t.s,e.biff)+":"+Qb(t.e,e.biff)}function yR(t){return parseInt(d5e(t),10)-1}function uo(t){return""+(t+1)}function c5e(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function d5e(t){return t.replace(/\$(\d+)$/,"$1")}function bR(t){for(var e=f5e(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function _i(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function u5e(t){return t.replace(/^([A-Z])/,"$$$1")}function f5e(t){return t.replace(/^\$([A-Z])/,"$1")}function h5e(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ei(t){for(var e=0,r=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:e-1}}function Kn(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function md(t){var e=t.indexOf(":");return e==-1?{s:Ei(t),e:Ei(t)}:{s:Ei(t.slice(0,e)),e:Ei(t.slice(e+1))}}function fa(t,e){return typeof e>"u"||typeof e=="number"?fa(t.s,t.e):(typeof t!="string"&&(t=Kn(t)),typeof e!="string"&&(e=Kn(e)),t==e?t:t+":"+e)}function Qa(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=t.length;for(r=0;n<s&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.s.c=--r,r=0;n<s&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(e.s.r=--r,n===s||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.e.c=--r,r=0;n!=s&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return e.e.r=--r,e}function zH(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Uu(t.z,r?qo(e):e)}catch{}try{return t.w=Uu((t.XF||{}).numFmtId||(r?14:0),r?qo(e):e)}catch{return""+e}}function _A(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?VA[t.v]||t.v:e==null?zH(t,t.v):zH(t,e))}function Km(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function sae(t,e,r){var n=r||{},a=t?Array.isArray(t):n.dense,s=t||(a?[]:{}),o=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Ei(n.origin):n.origin;o=c.r,l=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=Qa(s["!ref"]);d.s.c=u.s.c,d.s.r=u.s.r,d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),o==-1&&(d.e.r=o=u.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var A=0;A!=e[f].length;++A)if(!(typeof e[f][A]>"u")){var h={v:e[f][A]},m=o+f,p=l+A;if(d.s.r>m&&(d.s.r=m),d.s.c>p&&(d.s.c=p),d.e.r<m&&(d.e.r=m),d.e.c<p&&(d.e.c=p),e[f][A]&&typeof e[f][A]=="object"&&!Array.isArray(e[f][A])&&!(e[f][A]instanceof Date))h=e[f][A];else if(Array.isArray(h.v)&&(h.f=e[f][A][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Gn[14],n.cellDates?(h.t="d",h.w=Uu(h.z,qo(h.v))):(h.t="n",h.v=qo(h.v),h.w=Uu(h.z,h.v))):h.t="s";if(a)s[m]||(s[m]=[]),s[m][p]&&s[m][p].z&&(h.z=s[m][p].z),s[m][p]=h;else{var x=Kn({c:p,r:m});s[x]&&s[x].z&&(h.z=s[x].z),s[x]=h}}}return d.s.c<1e7&&(s["!ref"]=fa(d)),s}function S1(t,e){return sae(null,t,e)}function A5e(t){return t.read_shift(4,"i")}function Cf(t,e){return e||(e=mr(4)),e.write_shift(4,t),e}function pc(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function hl(t,e){var r=!1;return e==null&&(r=!0,e=mr(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function m5e(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function p5e(t,e){return e||(e=mr(4)),e.write_shift(2,0),e.write_shift(2,0),e}function wR(t,e){var r=t.l,n=t.read_shift(1),a=pc(t),s=[],o={t:a,h:a};if(n&1){for(var l=t.read_shift(4),c=0;c!=l;++c)s.push(m5e(t));o.r=s}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function g5e(t,e){var r=!1;return e==null&&(r=!0,e=mr(15+4*t.t.length)),e.write_shift(1,0),hl(t.t,e),r?e.slice(0,e.l):e}var x5e=wR;function v5e(t,e){var r=!1;return e==null&&(r=!0,e=mr(23+4*t.t.length)),e.write_shift(1,1),hl(t.t,e),e.write_shift(4,1),p5e({},e),r?e.slice(0,e.l):e}function Ku(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Hg(t,e){return e==null&&(e=mr(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function $g(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Gg(t,e){return e==null&&(e=mr(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var y5e=pc,iae=hl;function NR(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function ZS(t,e){var r=!1;return e==null&&(r=!0,e=mr(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var b5e=pc,sF=NR,CR=ZS;function _R(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var a=n===0?JS([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):_p(e,0)>>2;return r?a/100:a}function oae(t,e){e==null&&(e=mr(4));var r=0,n=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?a:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function lae(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function w5e(t,e){return e||(e=mr(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Kg=lae,j1=w5e;function Ac(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function yg(t,e){return(e||mr(8)).write_shift(8,t,"f")}function N5e(t){var e={},r=t.read_shift(1),n=r>>>1,a=t.read_shift(1),s=t.read_shift(2,"i"),o=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var d=Kp[a];d&&(e.rgb=H2(d));break;case 2:e.rgb=H2([o,l,c]);break;case 3:e.theme=a;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function ej(t,e){if(e||(e=mr(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function C5e(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function _5e(t,e){e||(e=mr(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function cae(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function E5e(t){return cae(t,1)}function S5e(t){return cae(t,2)}var ER=2,nd=3,qC=11,WH=12,tj=19,zC=64,j5e=65,I5e=71,P5e=4108,T5e=4126,cl=80,dae=81,B5e=[cl,dae],iF={1:{n:"CodePage",t:ER},2:{n:"Category",t:cl},3:{n:"PresentationFormat",t:cl},4:{n:"ByteCount",t:nd},5:{n:"LineCount",t:nd},6:{n:"ParagraphCount",t:nd},7:{n:"SlideCount",t:nd},8:{n:"NoteCount",t:nd},9:{n:"HiddenCount",t:nd},10:{n:"MultimediaClipCount",t:nd},11:{n:"ScaleCrop",t:qC},12:{n:"HeadingPairs",t:P5e},13:{n:"TitlesOfParts",t:T5e},14:{n:"Manager",t:cl},15:{n:"Company",t:cl},16:{n:"LinksUpToDate",t:qC},17:{n:"CharacterCount",t:nd},19:{n:"SharedDoc",t:qC},22:{n:"HyperlinksChanged",t:qC},23:{n:"AppVersion",t:nd,p:"version"},24:{n:"DigSig",t:j5e},26:{n:"ContentType",t:cl},27:{n:"ContentStatus",t:cl},28:{n:"Language",t:cl},29:{n:"Version",t:cl},255:{},2147483648:{n:"Locale",t:tj},2147483651:{n:"Behavior",t:tj},1919054434:{}},oF={1:{n:"CodePage",t:ER},2:{n:"Title",t:cl},3:{n:"Subject",t:cl},4:{n:"Author",t:cl},5:{n:"Keywords",t:cl},6:{n:"Comments",t:cl},7:{n:"Template",t:cl},8:{n:"LastAuthor",t:cl},9:{n:"RevNumber",t:cl},10:{n:"EditTime",t:zC},11:{n:"LastPrinted",t:zC},12:{n:"CreatedDate",t:zC},13:{n:"ModifiedDate",t:zC},14:{n:"PageCount",t:nd},15:{n:"WordCount",t:nd},16:{n:"CharCount",t:nd},17:{n:"Thumbnail",t:I5e},18:{n:"Application",t:cl},19:{n:"DocSecurity",t:nd},255:{},2147483648:{n:"Locale",t:tj},2147483651:{n:"Behavior",t:tj},1919054434:{}},XH={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},k5e=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function F5e(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var O5e=F5e([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Kp=ei(O5e),VA={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},uae={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},lF={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},WC={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function SR(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function D5e(t){var e=SR();if(!t||!t.match)return e;var r={};if((t.match(wc)||[]).forEach(function(n){var a=zn(n);switch(a[0].replace(K4e,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":e[lF[a.ContentType]]!==void 0&&e[lF[a.ContentType]].push(a.PartName);break}}),e.xmlns!==Vo.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function fae(t,e){var r=D4e(lF),n=[],a;n[n.length]=ho,n[n.length]=Yr("Types",null,{xmlns:Vo.CT,"xmlns:xsd":Vo.xsd,"xmlns:xsi":Vo.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Yr("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){t[c]&&t[c].length>0&&(a=t[c][0],n[n.length]=Yr("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:WC[c][e.bookType]||WC[c].xlsx}))},o=function(c){(t[c]||[]).forEach(function(d){n[n.length]=Yr("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:WC[c][e.bookType]||WC[c].xlsx})})},l=function(c){(t[c]||[]).forEach(function(d){n[n.length]=Yr("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[c][0]})})};return s("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var wa={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function V2(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Vb(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(wc)||[]).forEach(function(a){var s=zn(a);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:ab(s.Target,e);r[l]=o,n[s.Id]=o}}),r["!id"]=n,r}function yv(t){var e=[ho,Yr("Relationships",null,{xmlns:Vo.RELS})];return Gi(t["!id"]).forEach(function(r){e[e.length]=Yr("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function hs(t,e,r,n,a,s){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,a.Id="rId"+e,a.Type=n,a.Target=r,[wa.HLINK,wa.XPATH,wa.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,e}var R5e="application/vnd.oasis.opendocument.spreadsheet";function M5e(t,e){for(var r=gR(t),n,a;n=Q2.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=zn(n[0],!1),a.path=="/"&&a.type!==R5e)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function L5e(t){var e=[ho];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function YH(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function U5e(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function Q5e(t){var e=[ho];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(YH(t[r][0],t[r][1])),e.push(U5e("",t[r][0]));return e.push(YH("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function hae(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+qS.version+"</meta:generator></office:meta></office:document-meta>"}var Ou=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],V5e=function(){for(var t=new Array(Ou.length),e=0;e<Ou.length;++e){var r=Ou[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function Aae(t){var e={};t=Cs(t);for(var r=0;r<Ou.length;++r){var n=Ou[r],a=t.match(V5e[r]);a!=null&&a.length>0&&(e[n[1]]=Ua(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Zs(e[n[1]]))}return e}function U5(t,e,r,n,a){a[t]!=null||e==null||e===""||(a[t]=e,e=gs(e),n[n.length]=r?Yr(t,e,r):Ul(t,e))}function mae(t,e){var r=e||{},n=[ho,Yr("cp:coreProperties",null,{"xmlns:cp":Vo.CORE_PROPS,"xmlns:dc":Vo.dc,"xmlns:dcterms":Vo.dcterms,"xmlns:dcmitype":Vo.dcmitype,"xmlns:xsi":Vo.xsi})],a={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&U5("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:aF(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),t.ModifiedDate!=null&&U5("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:aF(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=Ou.length;++s){var o=Ou[s],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&U5(o[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var qp=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],pae=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function gae(t,e,r,n){var a=[];if(typeof t=="string")a=QH(t,n);else for(var s=0;s<t.length;++s)a=a.concat(t[s].map(function(u){return{v:u}}));var o=typeof e=="string"?QH(e,n).map(function(u){return u.v}):e,l=0,c=0;if(o.length>0)for(var d=0;d!==a.length;d+=2){switch(c=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function H5e(t,e,r){var n={};return e||(e={}),t=Cs(t),qp.forEach(function(a){var s=(t.match(L2(a[0]))||[])[1];switch(a[2]){case"string":s&&(e[a[1]]=Ua(s));break;case"bool":e[a[1]]=s==="true";break;case"raw":var o=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&gae(n.HeadingPairs,n.TitlesOfParts,e,r),e}function xae(t){var e=[],r=Yr;return t||(t={}),t.Application="SheetJS",e[e.length]=ho,e[e.length]=Yr("Properties",null,{xmlns:Vo.EXT_PROPS,"xmlns:vt":Vo.vt}),qp.forEach(function(n){if(t[n[1]]!==void 0){var a;switch(n[2]){case"string":a=gs(String(t[n[1]]));break;case"bool":a=t[n[1]]?"true":"false";break}a!==void 0&&(e[e.length]=r(n[0],a))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+gs(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var $5e=/<[^>]+>[^<]*/g;function G5e(t,e){var r={},n="",a=t.match($5e);if(a)for(var s=0;s!=a.length;++s){var o=a[s],l=zn(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ua(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),d=c[0].slice(4),u=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=Ua(u);break;case"bool":r[n]=Ws(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=Zs(u);break;case"cy":case"error":r[n]=Ua(u);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,c)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function vae(t){var e=[ho,Yr("Properties",null,{xmlns:Vo.CUST_PROPS,"xmlns:vt":Vo.vt})];if(!t)return e.join("");var r=1;return Gi(t).forEach(function(a){++r,e[e.length]=Yr("property",e5e(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:gs(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var cF={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Q5;function K5e(t,e,r){Q5||(Q5=gP(cF)),e=Q5[e]||e,t[e]=r}function q5e(t,e){var r=[];return Gi(cF).map(function(n){for(var a=0;a<Ou.length;++a)if(Ou[a][1]==n)return Ou[a];for(a=0;a<qp.length;++a)if(qp[a][1]==n)return qp[a];throw n}).forEach(function(n){if(t[n[1]]!=null){var a=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Ul(cF[n[1]]||n[1],a))}}),Yr("DocumentProperties",r.join(""),{xmlns:Fd.o})}function z5e(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return t&&Gi(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var o=0;o<Ou.length;++o)if(s==Ou[o][1])return;for(o=0;o<qp.length;++o)if(s==qp[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var l=t[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),a.push(Yr(RH(s),l,{"dt:dt":c}))}}),e&&Gi(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),a.push(Yr(RH(s),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Fd.o+'">'+a.join("")+"</"+n+">"}function jR(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function W5e(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var o=mr(8);return o.write_shift(4,n),o.write_shift(4,a),o}function yae(t,e,r){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return a}function bae(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function wae(t,e,r){return e===31?bae(t):yae(t,e,r)}function dF(t,e,r){return wae(t,e,r===!1?0:4)}function X5e(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return wae(t,e,0)}function Y5e(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var a=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Hc,""),t.l-a&2&&(t.l+=2)}return r}function J5e(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Hc,"");return r}function Z5e(t){var e=t.l,r=rj(t,dae);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=rj(t,nd);return[r,n]}function eTe(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(Z5e(t));return r}function JH(t,e){for(var r=t.read_shift(4),n={},a=0;a!=r;++a){var s=t.read_shift(4),o=t.read_shift(4);n[s]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(Hc,"").replace(nb,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function Nae(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function tTe(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function rj(t,e,r){var n=t.read_shift(2),a,s=r||{};if(t.l+=2,e!==WH&&n!==e&&B5e.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===WH?n:e){case 2:return a=t.read_shift(2,"i"),s.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return yae(t,n,4).replace(Hc,"");case 31:return bae(t);case 64:return jR(t);case 65:return Nae(t);case 71:return tTe(t);case 80:return dF(t,n,!s.raw).replace(Hc,"");case 81:return X5e(t,n).replace(Hc,"");case 4108:return eTe(t);case 4126:case 4127:return n==4127?Y5e(t):J5e(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function ZH(t,e){var r=mr(4),n=mr(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=mr(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=W5e(e);break;case 31:case 80:for(n=mr(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return fl([r,n])}function e$(t,e){var r=t.l,n=t.read_shift(4),a=t.read_shift(4),s=[],o=0,l=0,c=-1,d={};for(o=0;o!=a;++o){var u=t.read_shift(4),f=t.read_shift(4);s[o]=[u,f+r]}s.sort(function(y,b){return y[1]-b[1]});var A={};for(o=0;o!=a;++o){if(t.l!==s[o][1]){var h=!0;if(o>0&&e)switch(e[s[o-1][0]].t){case 2:t.l+2===s[o][1]&&(t.l+=2,h=!1);break;case 80:t.l<=s[o][1]&&(t.l=s[o][1],h=!1);break;case 4108:t.l<=s[o][1]&&(t.l=s[o][1],h=!1);break}if((!e||o==0)&&t.l<=s[o][1]&&(h=!1,t.l=s[o][1]),h)throw new Error("Read Error: Expected address "+s[o][1]+" at "+t.l+" :"+o)}if(e){var m=e[s[o][0]];if(A[m.n]=rj(t,m.t,{raw:!0}),m.p==="version"&&(A[m.n]=String(A[m.n]>>16)+"."+("0000"+String(A[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(A[m.n]){case 0:A[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:xf(l=A[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+A[m.n])}}else if(s[o][0]===1){if(l=A.CodePage=rj(t,ER),xf(l),c!==-1){var p=t.l;t.l=s[c][1],d=JH(t,l),t.l=p}}else if(s[o][0]===0){if(l===0){c=o,t.l=s[o+1][1];continue}d=JH(t,l)}else{var x=d[s[o][0]],v;switch(t[t.l]){case 65:t.l+=4,v=Nae(t);break;case 30:t.l+=4,v=dF(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,v=dF(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,v=t.read_shift(4,"i");break;case 19:t.l+=4,v=t.read_shift(4);break;case 5:t.l+=4,v=t.read_shift(8,"f");break;case 11:t.l+=4,v=eo(t,4);break;case 64:t.l+=4,v=Zs(jR(t));break;default:throw new Error("unparsed value: "+t[t.l])}A[x]=v}}return t.l=r+n,A}var Cae=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function rTe(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function t$(t,e,r){var n=mr(8),a=[],s=[],o=8,l=0,c=mr(8),d=mr(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),s.push(c),a.push(d),o+=8+c.length,!e){d=mr(8),d.write_shift(4,0),a.unshift(d);var u=[mr(4)];for(u[0].write_shift(4,t.length),l=0;l<t.length;++l){var f=t[l][0];for(c=mr(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=fl(u),s.unshift(c),o+=8+c.length}for(l=0;l<t.length;++l)if(!(e&&!e[t[l][0]])&&!(Cae.indexOf(t[l][0])>-1||pae.indexOf(t[l][0])>-1)&&t[l][1]!=null){var A=t[l][1],h=0;if(e){h=+e[t[l][0]];var m=r[h];if(m.p=="version"&&typeof A=="string"){var p=A.split(".");A=(+p[0]<<16)+(+p[1]||0)}c=ZH(m.t,A)}else{var x=rTe(A);x==-1&&(x=31,A=String(A)),c=ZH(x,A)}s.push(c),d=mr(8),d.write_shift(4,e?h:2+l),a.push(d),o+=8+c.length}var v=8*(s.length+1);for(l=0;l<s.length;++l)a[l].write_shift(4,v),v+=s[l].length;return n.write_shift(4,o),n.write_shift(4,s.length),fl([n].concat(a).concat(s))}function r$(t,e,r){var n=t.content;if(!n)return{};Ml(n,0);var a,s,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),u=n.read_shift(16);if(u!==Dn.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(o=n.read_shift(16),c=n.read_shift(4));var f=e$(n,e),A={SystemIdentifier:d};for(var h in f)A[h]=f[h];if(A.FMTID=s,a===1)return A;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var m;try{m=e$(n,null)}catch{}for(h in m)A[h]=m[h];return A.FMTID=[s,o],A}function n$(t,e,r,n,a,s){var o=mr(a?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Dn.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,a?68:48);var c=t$(t,r,n);if(l.push(c),a){var d=t$(a,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+c.length),l.push(d)}return fl(l)}function v0(t,e){return t.read_shift(e),null}function nTe(t,e){e||(e=mr(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function aTe(t,e,r){for(var n=[],a=t.l+e;t.l<a;)n.push(r(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function eo(t,e){return t.read_shift(e)===1}function Dc(t,e){return e||(e=mr(2)),e.write_shift(2,+!!t),e}function xo(t){return t.read_shift(2,"u")}function wu(t,e){return e||(e=mr(2)),e.write_shift(2,t),e}function _ae(t,e){return aTe(t,e,xo)}function sTe(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function Eae(t,e,r){return r||(r=mr(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function $w(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?t.read_shift(n,a):"";return o}function iTe(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,a=r&8,s=1+(r&1),o=0,l,c={};a&&(o=t.read_shift(2)),n&&(l=t.read_shift(4));var d=s==2?"dbcs-cont":"sbcs-cont",u=e===0?"":t.read_shift(e,d);return a&&(t.l+=4*o),n&&(t.l+=l),c.t=u,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function oTe(t){var e=t.t||"",r=mr(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=mr(2*e.length);n.write_shift(2*e.length,e,"utf16le");var a=[r,n];return fl(a)}function bg(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Gw(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):bg(t,n,r)}function qg(t,e,r){if(r.biff>5)return Gw(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function Sae(t,e,r){return r||(r=mr(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function lTe(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function cTe(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var a=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Hc,"");return n&&(t.l+=24),a}function dTe(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(s>>1,"utf16le").replace(Hc,"");return r+o}function uTe(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return cTe(t);case"0303000000000000c000000000000046":return dTe(t);default:throw new Error("Unsupported Moniker "+r)}}function XC(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Hc,""):"";return r}function a$(t,e){e||(e=mr(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function fTe(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var s,o,l,c,d="",u,f;a&16&&(s=XC(t,r-t.l)),a&128&&(o=XC(t,r-t.l)),(a&257)===257&&(l=XC(t,r-t.l)),(a&257)===1&&(c=uTe(t,r-t.l)),a&8&&(d=XC(t,r-t.l)),a&32&&(u=t.read_shift(16)),a&64&&(f=jR(t)),t.l=r;var A=o||l||c||"";A&&d&&(A+="#"+d),A||(A="#"+d),a&2&&A.charAt(0)=="/"&&A.charAt(1)!="/"&&(A="file://"+A);var h={Target:A};return u&&(h.guid=u),f&&(h.time=f),s&&(h.Tooltip=s),h}function hTe(t){var e=mr(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(s==28)n=n.slice(1),a$(n,e);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var l=a>-1?n.slice(0,a):n;for(e.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)e.write_shift(2,l.charCodeAt(r));e.write_shift(2,0),s&8&&a$(a>-1?n.slice(a+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)e.write_shift(1,n.charCodeAt(r+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function jae(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[e,r,n,a]}function Iae(t,e){var r=jae(t);return r[3]=0,r}function wh(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function wg(t,e,r,n){return n||(n=mr(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function ATe(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function mTe(t,e,r){return e===0?"":qg(t,e,r)}function pTe(t,e,r){var n=r.biff>8?4:2,a=t.read_shift(n),s=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[a,s,o]}function Pae(t){var e=t.read_shift(2),r=_R(t);return[e,r]}function gTe(t,e,r){t.l+=4,e-=4;var n=t.l+e,a=$w(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,a}function yP(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r:e},e:{c:a,r}}}function Tae(t,e){return e||(e=mr(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function Bae(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r:e},e:{c:a,r}}}var xTe=Bae;function kae(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function vTe(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function yTe(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function nc(t){t.l+=2,t.l+=t.read_shift(2)}var bTe={0:nc,4:nc,5:nc,6:nc,7:yTe,8:nc,9:nc,10:nc,11:nc,12:nc,13:vTe,14:nc,15:nc,16:nc,17:nc,18:nc,19:nc,20:nc,21:kae};function wTe(t,e){for(var r=t.l+e,n=[];t.l<r;){var a=t.read_shift(2);t.l-=2;try{n.push(bTe[a](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function YC(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function IR(t,e,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=mr(a);return s.write_shift(2,n),s.write_shift(2,e),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function NTe(t,e){return e===0||t.read_shift(2),1200}function CTe(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,a=qg(t,0,r);return t.read_shift(e+n-t.l),a}function _Te(t,e){var r=!e||e.biff==8,n=mr(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function ETe(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function STe(t,e,r){var n=t.read_shift(4),a=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=$w(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:s,name:o}}function jTe(t,e){var r=!e||e.biff>=8?2:1,n=mr(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function ITe(t,e){for(var r=t.l+e,n=t.read_shift(4),a=t.read_shift(4),s=[],o=0;o!=a&&t.l<r;++o)s.push(iTe(t));return s.Count=n,s.Unique=a,s}function PTe(t,e){var r=mr(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],a=0;a<t.length;++a)n[a]=oTe(t[a]);var s=fl([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function TTe(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function BTe(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function kTe(t){var e=ATe(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function FTe(t){return t.read_shift(2),t.read_shift(4)}function s$(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function OTe(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,r],Dim:[n,a],Flags:s,CurTab:o,FirstTab:l,Selected:c,TabRatio:d}}function DTe(){var t=mr(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function RTe(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function MTe(t){var e=mr(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function LTe(){}function UTe(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=$w(t,0,r),n}function QTe(t,e){var r=t.name||"Arial",n=e&&e.biff==5,a=n?15+r.length:16+2*r.length,s=mr(a);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function VTe(t){var e=wh(t);return e.isst=t.read_shift(4),e}function HTe(t,e,r,n){var a=mr(10);return wg(t,e,n,a),a.write_shift(4,r),a}function $Te(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,a=wh(t);r.biff==2&&t.l++;var s=Gw(t,n-t.l,r);return a.val=s,a}function GTe(t,e,r,n,a){var s=!a||a.biff==8,o=mr(8+ +s+(1+s)*r.length);return wg(t,e,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function KTe(t,e,r){var n=t.read_shift(2),a=qg(t,0,r);return[n,a]}function qTe(t,e,r,n){var a=r&&r.biff==5;n||(n=mr(a?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(a?1:2,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var zTe=qg;function i$(t,e,r){var n=t.l+e,a=r.biff==8||!r.biff?4:2,s=t.read_shift(a),o=t.read_shift(a),l=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:s,c:l},e:{r:o,c}}}function WTe(t,e){var r=e.biff==8||!e.biff?4:2,n=mr(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function XTe(t){var e=t.read_shift(2),r=t.read_shift(2),n=Pae(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function YTe(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),s=[];t.l<r;)s.push(Pae(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(s.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:s}}function JTe(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(s.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:s}}function ZTe(t,e,r,n){var a={},s=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(2);return a.patternType=k5e[l>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function eBe(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=ZTe(t,e,n.fStyle,r),n}function o$(t,e,r,n){var a=r&&r.biff==5;n||(n=mr(a?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function tBe(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function rBe(t){var e=mr(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function l$(t,e,r){var n=wh(t);(r.biff==2||e==9)&&++t.l;var a=sTe(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function nBe(t,e,r,n,a,s){var o=mr(8);return wg(t,e,n,o),Eae(r,s,o),o}function aBe(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=wh(t),a=Ac(t);return n.val=a,n}function sBe(t,e,r,n){var a=mr(14);return wg(t,e,n,a),yg(r,a),a}var c$=mTe;function iBe(t,e,r){var n=t.l+e,a=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=bg(t,s),l=[];n>t.l;)l.push(Gw(t));return[s,a,o,l]}function d$(t,e,r){var n=t.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=gTe(t,e-2,r)),s.body=a||t.read_shift(e-2),typeof a=="string"&&(s.Name=a),s}var oBe=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function u$(t,e,r){var n=t.l+e,a=t.read_shift(2),s=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=bg(t,o,r);a&32&&(d=oBe[d.charCodeAt(0)]);var u=n-t.l;r&&r.biff==2&&--u;var f=n==t.l||l===0||!(u>0)?[]:wDe(t,u,r,l);return{chKey:s,Name:d,itab:c,rgce:f}}function Fae(t,e,r){if(r.biff<8)return lBe(t,e,r);for(var n=[],a=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(pTe(t,r.biff>8?12:6,r));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function lBe(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=$w(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function cBe(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),a=t.read_shift(2),s=bg(t,n,r),o=bg(t,a,r);return[s,o]}function dBe(t,e,r){var n=Bae(t);t.l++;var a=t.read_shift(1);return e-=8,[NDe(t,e,r),a,n]}function f$(t,e,r){var n=xTe(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,yDe(t,e,r)]}function uBe(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function fBe(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),l=qg(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:a},l,o,s]}}function hBe(t,e,r){return fBe(t,e,r)}function ABe(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(yP(t));return r}function mBe(t){var e=mr(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)Tae(t[r],e);return e}function pBe(t,e,r){if(r&&r.biff<8)return xBe(t,e,r);var n=kae(t),a=wTe(t,e-22,n[1]);return{cmo:n,ft:a}}var gBe={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=r,{fmt:n}}};function xBe(t,e,r){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((gBe[n]||vc)(t,e,r)),{cmo:[a,n,s],ft:o}}function vBe(t,e,r){var n=t.l,a="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:o=lTe(t,6,r);var l=t.read_shift(2);t.read_shift(2),xo(t,2);var c=t.read_shift(2);t.l+=c;for(var d=1;d<t.lens.length-1;++d){if(t.l-n!=t.lens[d])throw new Error("TxO: bad continue record");var u=t[t.l],f=bg(t,t.lens[d+1]-t.lens[d]-1);if(a+=f,a.length>=(u?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return t.l=n+e,{t:a}}catch{return t.l=n+e,{t:a}}}function yBe(t,e){var r=yP(t);t.l+=16;var n=fTe(t,e-24);return[r,n]}function bBe(t){var e=mr(24),r=Ei(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(n[a],16));return fl([e,hTe(t[1])])}function wBe(t,e){t.read_shift(2);var r=yP(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Hc,""),[r,n]}function NBe(t){var e=t[1].Tooltip,r=mr(10+2*(e.length+1));r.write_shift(2,2048);var n=Ei(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<e.length;++a)r.write_shift(2,e.charCodeAt(a));return r.write_shift(2,0),r}function CBe(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=XH[r]||r,r=t.read_shift(2),e[1]=XH[r]||r,e}function _Be(t){return t||(t=mr(4)),t.write_shift(2,1),t.write_shift(2,1),t}function EBe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(Iae(t));return r}function SBe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(Iae(t));return r}function jBe(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function Oae(t,e,r){if(!r.cellStyles)return vc(t,e);var n=r&&r.biff>=12?4:2,a=t.read_shift(n),s=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var d={s:a,e:s,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function IBe(t,e){var r=mr(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function PBe(t,e){var r={};return e<32||(t.l+=16,r.header=Ac(t),r.footer=Ac(t),t.l+=2),r}function TBe(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}function BBe(t){for(var e=mr(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var kBe=wh,FBe=_ae,OBe=Gw;function DBe(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function RBe(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=wh(t);++t.l;var a=qg(t,e-7,r);return n.t="str",n.val=a,n}function MBe(t){var e=wh(t);++t.l;var r=Ac(t);return e.t="n",e.val=r,e}function LBe(t,e,r){var n=mr(15);return Ww(n,t,e),n.write_shift(8,r,"f"),n}function UBe(t){var e=wh(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function QBe(t,e,r){var n=mr(9);return Ww(n,t,e),n.write_shift(2,r),n}function VBe(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function HBe(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function $Be(t,e,r){var n=t.l+e,a=wh(t),s=t.read_shift(2),o=bg(t,s,r);return t.l=n,a.t="str",a.val=o,a}var GBe=[2,3,48,49,131,139,140,245],uF=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=gP({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var d=[],u=Tm(1);switch(c.type){case"base64":u=Dd(Wd(l));break;case"binary":u=Dd(l);break;case"buffer":case"array":u=l;break}Ml(u,0);var f=u.read_shift(1),A=!!(f&136),h=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,A=!0;break;case 49:h=!0,A=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,x=521;f==2&&(p=u.read_shift(2)),u.l+=3,f!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(x=u.read_shift(2));var v=u.read_shift(2),y=c.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(y=t[u[u.l]]),u.l+=1,u.l+=2),m&&(u.l+=36);for(var b=[],w={},I=Math.min(u.length,f==2?521:x-10-(h?264:0)),j=m?32:11;u.l<I&&u[u.l]!=13;)switch(w={},w.name=D2.utils.decode(y,u.slice(u.l,u.l+j)).replace(/[\u0000\r\n].*$/g,""),u.l+=j,w.type=String.fromCharCode(u.read_shift(1)),f!=2&&!m&&(w.offset=u.read_shift(4)),w.len=u.read_shift(1),f==2&&(w.offset=u.read_shift(2)),w.dec=u.read_shift(1),w.name.length&&b.push(w),f!=2&&(u.l+=m?13:14),w.type){case"B":(!h||w.len!=8)&&c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(u[u.l]!==13&&(u.l=x-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=x;var N=0,S=0;for(d[0]=[],S=0;S!=b.length;++S)d[0][S]=b[S].name;for(;p-- >0;){if(u[u.l]===42){u.l+=v;continue}for(++u.l,d[++N]=[],S=0,S=0;S!=b.length;++S){var E=u.slice(u.l,u.l+b[S].len);u.l+=b[S].len,Ml(E,0);var B=D2.utils.decode(y,E);switch(b[S].type){case"C":B.trim().length&&(d[N][S]=B.replace(/\s+$/,""));break;case"D":B.length===8?d[N][S]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):d[N][S]=B;break;case"F":d[N][S]=parseFloat(B.trim());break;case"+":case"I":d[N][S]=m?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":d[N][S]=!0;break;case"N":case"F":d[N][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!A)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));d[N][S]="##MEMO##"+(m?parseInt(B.trim(),10):E.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(d[N][S]=+B||0);break;case"@":d[N][S]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":d[N][S]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":d[N][S]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[N][S]=-E.read_shift(-8,"f");break;case"B":if(h&&b[S].len==8){d[N][S]=E.read_shift(8,"f");break}case"G":case"P":E.l+=b[S].len;break;case"0":if(b[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[S].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=b,d}function n(l,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var u=S1(r(l,d),d);return u["!cols"]=d.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete d.DBF,u}function a(l,c){try{return Km(n(l,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var d=c||{};if(+d.codepage>=0&&xf(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var u=Ad(),f=sj(l,{header:1,raw:!0,cellDates:!0}),A=f[0],h=f.slice(1),m=l["!cols"]||[],p=0,x=0,v=0,y=1;for(p=0;p<A.length;++p){if(((m[p]||{}).DBF||{}).name){A[p]=m[p].DBF.name,++v;continue}if(A[p]!=null){if(++v,typeof A[p]=="number"&&(A[p]=A[p].toString(10)),typeof A[p]!="string")throw new Error("DBF Invalid column name "+A[p]+" |"+typeof A[p]+"|");if(A.indexOf(A[p])!==p){for(x=0;x<1024;++x)if(A.indexOf(A[p]+"_"+x)==-1){A[p]+="_"+x;break}}}}var b=Qa(l["!ref"]),w=[],I=[],j=[];for(p=0;p<=b.e.c-b.s.c;++p){var N="",S="",E=0,B=[];for(x=0;x<h.length;++x)h[x][p]!=null&&B.push(h[x][p]);if(B.length==0||A[p]==null){w[p]="?";continue}for(x=0;x<B.length;++x){switch(typeof B[x]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=B[x]instanceof Date?"D":"C";break;default:S="C"}E=Math.max(E,String(B[x]).length),N=N&&N!=S?"C":S}E>250&&(E=250),S=((m[p]||{}).DBF||{}).type,S=="C"&&m[p].DBF.len>E&&(E=m[p].DBF.len),N=="B"&&S=="N"&&(N="N",j[p]=m[p].DBF.dec,E=m[p].DBF.len),I[p]=N=="C"||S=="N"?E:s[N]||0,y+=I[p],w[p]=N}var k=u.next(32);for(k.write_shift(4,318902576),k.write_shift(4,h.length),k.write_shift(2,296+32*v),k.write_shift(2,y),p=0;p<4;++p)k.write_shift(4,0);for(k.write_shift(4,0|(+e[Cne]||3)<<8),p=0,x=0;p<A.length;++p)if(A[p]!=null){var T=u.next(32),P=(A[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,P,"sbcs"),T.write_shift(1,w[p]=="?"?"C":w[p],"sbcs"),T.write_shift(4,x),T.write_shift(1,I[p]||s[w[p]]||0),T.write_shift(1,j[p]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),x+=I[p]||s[w[p]]||0}var q=u.next(264);for(q.write_shift(4,13),p=0;p<65;++p)q.write_shift(4,0);for(p=0;p<h.length;++p){var de=u.next(y);for(de.write_shift(1,0),x=0;x<A.length;++x)if(A[x]!=null)switch(w[x]){case"L":de.write_shift(1,h[p][x]==null?63:h[p][x]?84:70);break;case"B":de.write_shift(8,h[p][x]||0,"f");break;case"N":var ce="0";for(typeof h[p][x]=="number"&&(ce=h[p][x].toFixed(j[x]||0)),v=0;v<I[x]-ce.length;++v)de.write_shift(1,32);de.write_shift(1,ce,"sbcs");break;case"D":h[p][x]?(de.write_shift(4,("0000"+h[p][x].getFullYear()).slice(-4),"sbcs"),de.write_shift(2,("00"+(h[p][x].getMonth()+1)).slice(-2),"sbcs"),de.write_shift(2,("00"+h[p][x].getDate()).slice(-2),"sbcs")):de.write_shift(8,"00000000","sbcs");break;case"C":var le=String(h[p][x]!=null?h[p][x]:"").slice(0,I[x]);for(de.write_shift(1,le,"sbcs"),v=0;v<I[x]-le.length;++v)de.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),Dae=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Gi(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(A,h){var m=t[h];return typeof m=="number"?NH(m):m},n=function(A,h,m){var p=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?A:NH(p)};t["|"]=254;function a(A,h){switch(h.type){case"base64":return s(Wd(A),h);case"binary":return s(A,h);case"buffer":return s(xa&&Buffer.isBuffer(A)?A.toString("binary"):Gm(A),h);case"array":return s(vg(A),h)}throw new Error("Unrecognized type "+h.type)}function s(A,h){var m=A.split(/[\n\r]+/),p=-1,x=-1,v=0,y=0,b=[],w=[],I=null,j={},N=[],S=[],E=[],B=0,k;for(+h.codepage>=0&&xf(+h.codepage);v!==m.length;++v){B=0;var T=m[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),P=T.replace(/;;/g,"\0").split(";").map(function(M){return M.replace(/\u0000/g,";")}),q=P[0],de;if(T.length>0)switch(q){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":P[1].charAt(0)=="P"&&w.push(T.slice(3).replace(/;;/g,";"));break;case"C":var ce=!1,le=!1,he=!1,ae=!1,Ce=-1,De=-1;for(y=1;y<P.length;++y)switch(P[y].charAt(0)){case"A":break;case"X":x=parseInt(P[y].slice(1))-1,le=!0;break;case"Y":for(p=parseInt(P[y].slice(1))-1,le||(x=0),k=b.length;k<=p;++k)b[k]=[];break;case"K":de=P[y].slice(1),de.charAt(0)==='"'?de=de.slice(1,de.length-1):de==="TRUE"?de=!0:de==="FALSE"?de=!1:isNaN(Nf(de))?isNaN($v(de).getDate())||(de=Zs(de)):(de=Nf(de),I!==null&&_1(I)&&(de=vP(de))),ce=!0;break;case"E":ae=!0;var O=bv(P[y].slice(1),{r:p,c:x});b[p][x]=[b[p][x],O];break;case"S":he=!0,b[p][x]=[b[p][x],"S5S"];break;case"G":break;case"R":Ce=parseInt(P[y].slice(1))-1;break;case"C":De=parseInt(P[y].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}if(ce&&(b[p][x]&&b[p][x].length==2?b[p][x][0]=de:b[p][x]=de,I=null),he){if(ae)throw new Error("SYLK shared formula cannot have own formula");var R=Ce>-1&&b[Ce][De];if(!R||!R[1])throw new Error("SYLK shared formula cannot find base");b[p][x][1]=ese(R[1],{r:p-Ce,c:x-De})}break;case"F":var G=0;for(y=1;y<P.length;++y)switch(P[y].charAt(0)){case"X":x=parseInt(P[y].slice(1))-1,++G;break;case"Y":for(p=parseInt(P[y].slice(1))-1,k=b.length;k<=p;++k)b[k]=[];break;case"M":B=parseInt(P[y].slice(1))/20;break;case"F":break;case"G":break;case"P":I=w[parseInt(P[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=P[y].slice(1).split(" "),k=parseInt(E[0],10);k<=parseInt(E[1],10);++k)B=parseInt(E[2],10),S[k-1]=B===0?{hidden:!0}:{wch:B},Bm(S[k-1]);break;case"C":x=parseInt(P[y].slice(1))-1,S[x]||(S[x]={});break;case"R":p=parseInt(P[y].slice(1))-1,N[p]||(N[p]={}),B>0?(N[p].hpt=B,N[p].hpx=Kv(B)):B===0&&(N[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}G<1&&(I=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}}return N.length>0&&(j["!rows"]=N),S.length>0&&(j["!cols"]=S),h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),[b,j]}function o(A,h){var m=a(A,h),p=m[0],x=m[1],v=S1(p,h);return Gi(x).forEach(function(y){v[y]=x[y]}),v}function l(A,h){return Km(o(A,h),h)}function c(A,h,m,p){var x="C;Y"+(m+1)+";X"+(p+1)+";K";switch(A.t){case"n":x+=A.v||0,A.f&&!A.F&&(x+=";E"+OR(A.f,{r:m,c:p}));break;case"b":x+=A.v?"TRUE":"FALSE";break;case"e":x+=A.w||A.v;break;case"d":x+='"'+(A.w||A.v)+'"';break;case"s":x+='"'+A.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function d(A,h){h.forEach(function(m,p){var x="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?x+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=$2(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=G2(m.wpx)),typeof m.wch=="number"&&(x+=Math.round(m.wch))),x.charAt(x.length-1)!=" "&&A.push(x)})}function u(A,h){h.forEach(function(m,p){var x="F;";m.hidden?x+="M0;":m.hpt?x+="M"+20*m.hpt+";":m.hpx&&(x+="M"+20*K2(m.hpx)+";"),x.length>2&&A.push(x+"R"+(p+1))})}function f(A,h){var m=["ID;PWXL;N;E"],p=[],x=Qa(A["!ref"]),v,y=Array.isArray(A),b=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),A["!cols"]&&d(m,A["!cols"]),A["!rows"]&&u(m,A["!rows"]),m.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var w=x.s.r;w<=x.e.r;++w)for(var I=x.s.c;I<=x.e.c;++I){var j=Kn({r:w,c:I});v=y?(A[w]||[])[I]:A[j],!(!v||v.v==null&&(!v.f||v.F))&&p.push(c(v,A,w,I))}return m.join(b)+b+p.join(b)+b+"E"+b}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),Rae=function(){function t(s,o){switch(o.type){case"base64":return e(Wd(s),o);case"binary":return e(s,o);case"buffer":return e(xa&&Buffer.isBuffer(s)?s.toString("binary"):Gm(s),o);case"array":return e(vg(s),o)}throw new Error("Unrecognized type "+o.type)}function e(s,o){for(var l=s.split(`
`),c=-1,d=-1,u=0,f=[];u!==l.length;++u){if(l[u].trim()==="BOT"){f[++c]=[],d=0;continue}if(!(c<0)){var A=l[u].trim().split(","),h=A[0],m=A[1];++u;for(var p=l[u]||"";(p.match(/["]/g)||[]).length&1&&u<l.length-1;)p+=`
`+l[++u];switch(p=p.trim(),+h){case-1:if(p==="BOT"){f[++c]=[],d=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][d]=!0:p==="FALSE"?f[c][d]=!1:isNaN(Nf(m))?isNaN($v(m).getDate())?f[c][d]=m:f[c][d]=Zs(m):f[c][d]=Nf(m),++d;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][d++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(s,o){return S1(t(s,o),o)}function n(s,o){return Km(r(s,o),o)}var a=function(){var s=function(c,d,u,f,A){c.push(d),c.push(u+","+f),c.push('"'+A.replace(/"/g,'""')+'"')},o=function(c,d,u,f){c.push(d+","+u),c.push(d==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var d=[],u=Qa(c["!ref"]),f,A=Array.isArray(c);s(d,"TABLE",0,1,"sheetjs"),s(d,"VECTORS",0,u.e.r-u.s.r+1,""),s(d,"TUPLES",0,u.e.c-u.s.c+1,""),s(d,"DATA",0,0,"");for(var h=u.s.r;h<=u.e.r;++h){o(d,-1,0,"BOT");for(var m=u.s.c;m<=u.e.c;++m){var p=Kn({r:h,c:m});if(f=A?(c[h]||[])[m]:c[p],!f){o(d,1,0,"");continue}switch(f.t){case"n":var x=f.w;!x&&f.v!=null&&(x=f.v),x==null?f.f&&!f.F?o(d,1,0,"="+f.f):o(d,1,0,""):o(d,0,x,"V");break;case"b":o(d,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Uu(f.z||Gn[14],qo(Zs(f.v)))),o(d,0,f.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var v=`\r
`,y=d.join(v);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),Mae=function(){function t(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,A){for(var h=f.split(`
`),m=-1,p=-1,x=0,v=[];x!==h.length;++x){var y=h[x].trim().split(":");if(y[0]==="cell"){var b=Ei(y[1]);if(v.length<=b.r)for(m=v.length;m<=b.r;++m)v[m]||(v[m]=[]);switch(m=b.r,p=b.c,y[2]){case"t":v[m][p]=t(y[3]);break;case"v":v[m][p]=+y[3];break;case"vtf":var w=y[y.length-1];case"vtc":switch(y[3]){case"nl":v[m][p]=!!+y[4];break;default:v[m][p]=+y[4];break}y[2]=="vtf"&&(v[m][p]=[v[m][p],w])}}}return A&&A.sheetRows&&(v=v.slice(0,A.sheetRows)),v}function n(f,A){return S1(r(f,A),A)}function a(f,A){return Km(n(f,A),A)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(f){if(!f||!f["!ref"])return"";for(var A=[],h=[],m,p="",x=md(f["!ref"]),v=Array.isArray(f),y=x.s.r;y<=x.e.r;++y)for(var b=x.s.c;b<=x.e.c;++b)if(p=Kn({r:y,c:b}),m=v?(f[y]||[])[b]:f[p],!(!m||m.v==null||m.t==="z")){switch(h=["cell",p,"t"],m.t){case"s":case"str":h.push(e(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=e(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=e(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var w=qo(Zs(m.v));h[2]="vtc",h[3]="nd",h[4]=""+w,h[5]=m.w||Uu(m.z||Gn[14],w);break;case"e":continue}A.push(h.join(":"))}return A.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),A.push("valueformat:1:text-wiki"),A.join(`
`)}function u(f){return[s,o,l,o,d(f),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),Gv=function(){function t(u,f,A,h,m){m.raw?f[A][h]=u:u===""||(u==="TRUE"?f[A][h]=!0:u==="FALSE"?f[A][h]=!1:isNaN(Nf(u))?isNaN($v(u).getDate())?f[A][h]=u:f[A][h]=Zs(u):f[A][h]=Nf(u))}function e(u,f){var A=f||{},h=[];if(!u||u.length===0)return h;for(var m=u.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var x=10,v=0,y=0;y<=p;++y)v=m[y].indexOf(" "),v==-1?v=m[y].length:v++,x=Math.max(x,v);for(y=0;y<=p;++y){h[y]=[];var b=0;for(t(m[y].slice(0,x).trim(),h,y,b,A),b=1;b<=(m[y].length-x)/10+1;++b)t(m[y].slice(x+(b-1)*10,x+b*10).trim(),h,y,b,A)}return A.sheetRows&&(h=h.slice(0,A.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var f={},A=!1,h=0,m=0;h<u.length;++h)(m=u.charCodeAt(h))==34?A=!A:!A&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h]);if(!m.length){f=n;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h])}return m.sort(function(p,x){return p[0]-x[0]||n[p[1]]-n[x[1]]}),r[m.pop()[1]]||44}function s(u,f){var A=f||{},h="",m=A.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(h=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(h=u.charAt(4),u=u.slice(6)):h=a(u.slice(0,1024)):A&&A.FS?h=A.FS:h=a(u.slice(0,1024));var x=0,v=0,y=0,b=0,w=0,I=h.charCodeAt(0),j=!1,N=0,S=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var E=A.dateNF!=null?T4e(A.dateNF):null;function B(){var k=u.slice(b,w),T={};if(k.charAt(0)=='"'&&k.charAt(k.length-1)=='"'&&(k=k.slice(1,-1).replace(/""/g,'"')),k.length===0)T.t="z";else if(A.raw)T.t="s",T.v=k;else if(k.trim().length===0)T.t="s",T.v=k;else if(k.charCodeAt(0)==61)k.charCodeAt(1)==34&&k.charCodeAt(k.length-1)==34?(T.t="s",T.v=k.slice(2,-1).replace(/""/g,'"')):iOe(k)?(T.t="n",T.f=k.slice(1)):(T.t="s",T.v=k);else if(k=="TRUE")T.t="b",T.v=!0;else if(k=="FALSE")T.t="b",T.v=!1;else if(!isNaN(y=Nf(k)))T.t="n",A.cellText!==!1&&(T.w=k),T.v=y;else if(!isNaN($v(k).getDate())||E&&k.match(E)){T.z=A.dateNF||Gn[14];var P=0;E&&k.match(E)&&(k=B4e(k,A.dateNF,k.match(E)||[]),P=1),A.cellDates?(T.t="d",T.v=Zs(k,P)):(T.t="n",T.v=qo(Zs(k,P))),A.cellText!==!1&&(T.w=Uu(T.z,T.v instanceof Date?qo(T.v):T.v)),A.cellNF||delete T.z}else T.t="s",T.v=k;if(T.t=="z"||(A.dense?(m[x]||(m[x]=[]),m[x][v]=T):m[Kn({c:v,r:x})]=T),b=w+1,S=u.charCodeAt(b),p.e.c<v&&(p.e.c=v),p.e.r<x&&(p.e.r=x),N==I)++v;else if(v=0,++x,A.sheetRows&&A.sheetRows<=x)return!0}e:for(;w<u.length;++w)switch(N=u.charCodeAt(w)){case 34:S===34&&(j=!j);break;case I:case 10:case 13:if(!j&&B())break e;break}return w-b>0&&B(),m["!ref"]=fa(p),m}function o(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,f):S1(e(u,f),f)}function l(u,f){var A="",h=f.type=="string"?[0,0,0,0]:HR(u,f);switch(f.type){case"base64":A=Wd(u);break;case"binary":A=u;break;case"buffer":f.codepage==65001?A=u.toString("utf8"):f.codepage&&typeof D2<"u"||(A=xa&&Buffer.isBuffer(u)?u.toString("binary"):Gm(u));break;case"array":A=vg(u);break;case"string":A=u;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?A=Cs(A.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?A=Cs(A):f.type=="binary"&&typeof D2<"u",A.slice(0,19)=="socialcalc:version:"?Mae.to_sheet(f.type=="string"?A:Cs(A),f):o(A,f)}function c(u,f){return Km(l(u,f),f)}function d(u){for(var f=[],A=Qa(u["!ref"]),h,m=Array.isArray(u),p=A.s.r;p<=A.e.r;++p){for(var x=[],v=A.s.c;v<=A.e.c;++v){var y=Kn({r:p,c:v});if(h=m?(u[p]||[])[v]:u[y],!h||h.v==null){x.push("          ");continue}for(var b=(h.w||(_A(h),h.w)||"").slice(0,10);b.length<10;)b+=" ";x.push(b+(v===0?" ":""))}f.push(x.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:d}}();function KBe(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var a=Dae.to_workbook(t,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Gv.to_workbook(t,e)}}var zp=function(){function t(O,R,G){if(O){Ml(O,O.l||0);for(var M=G.Enum||Ce;O.l<O.length;){var K=O.read_shift(2),Y=M[K]||M[65535],D=O.read_shift(2),V=O.l+D,te=Y.f&&Y.f(O,D,G);if(O.l=V,R(te,Y,K))return}}}function e(O,R){switch(R.type){case"base64":return r(Dd(Wd(O)),R);case"binary":return r(Dd(O),R);case"buffer":case"array":return r(O,R)}throw"Unsupported type "+R.type}function r(O,R){if(!O)return O;var G=R||{},M=G.dense?[]:{},K="Sheet1",Y="",D=0,V={},te=[],ve=[],Q={s:{r:0,c:0},e:{r:0,c:0}},Xe=G.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)G.Enum=Ce,t(O,function(Se,Ee,Ze){switch(Ze){case 0:G.vers=Se,Se>=4096&&(G.qpro=!0);break;case 6:Q=Se;break;case 204:Se&&(Y=Se);break;case 222:Y=Se;break;case 15:case 51:G.qpro||(Se[1].v=Se[1].v.slice(1));case 13:case 14:case 16:Ze==14&&(Se[2]&112)==112&&(Se[2]&15)>1&&(Se[2]&15)<15&&(Se[1].z=G.dateNF||Gn[14],G.cellDates&&(Se[1].t="d",Se[1].v=vP(Se[1].v))),G.qpro&&Se[3]>D&&(M["!ref"]=fa(Q),V[K]=M,te.push(K),M=G.dense?[]:{},Q={s:{r:0,c:0},e:{r:0,c:0}},D=Se[3],K=Y||"Sheet"+(D+1),Y="");var ot=G.dense?(M[Se[0].r]||[])[Se[0].c]:M[Kn(Se[0])];if(ot){ot.t=Se[1].t,ot.v=Se[1].v,Se[1].z!=null&&(ot.z=Se[1].z),Se[1].f!=null&&(ot.f=Se[1].f);break}G.dense?(M[Se[0].r]||(M[Se[0].r]=[]),M[Se[0].r][Se[0].c]=Se[1]):M[Kn(Se[0])]=Se[1];break}},G);else if(O[2]==26||O[2]==14)G.Enum=De,O[2]==14&&(G.qpro=!0,O.l=0),t(O,function(Se,Ee,Ze){switch(Ze){case 204:K=Se;break;case 22:Se[1].v=Se[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Se[3]>D&&(M["!ref"]=fa(Q),V[K]=M,te.push(K),M=G.dense?[]:{},Q={s:{r:0,c:0},e:{r:0,c:0}},D=Se[3],K="Sheet"+(D+1)),Xe>0&&Se[0].r>=Xe)break;G.dense?(M[Se[0].r]||(M[Se[0].r]=[]),M[Se[0].r][Se[0].c]=Se[1]):M[Kn(Se[0])]=Se[1],Q.e.c<Se[0].c&&(Q.e.c=Se[0].c),Q.e.r<Se[0].r&&(Q.e.r=Se[0].r);break;case 27:Se[14e3]&&(ve[Se[14e3][0]]=Se[14e3][1]);break;case 1537:ve[Se[0]]=Se[1],Se[0]==D&&(K=Se[1]);break}},G);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(M["!ref"]=fa(Q),V[Y||K]=M,te.push(Y||K),!ve.length)return{SheetNames:te,Sheets:V};for(var se={},Z=[],ke=0;ke<ve.length;++ke)V[te[ke]]?(Z.push(ve[ke]||te[ke]),se[ve[ke]]=V[ve[ke]]||V[te[ke]]):(Z.push(ve[ke]),se[ve[ke]]={"!ref":"A1"});return{SheetNames:Z,Sheets:se}}function n(O,R){var G=R||{};if(+G.codepage>=0&&xf(+G.codepage),G.type=="string")throw new Error("Cannot write WK1 to JS string");var M=Ad(),K=Qa(O["!ref"]),Y=Array.isArray(O),D=[];Jr(M,0,s(1030)),Jr(M,6,c(K));for(var V=Math.min(K.e.r,8191),te=K.s.r;te<=V;++te)for(var ve=uo(te),Q=K.s.c;Q<=K.e.c;++Q){te===K.s.r&&(D[Q]=_i(Q));var Xe=D[Q]+ve,se=Y?(O[te]||[])[Q]:O[Xe];if(!(!se||se.t=="z"))if(se.t=="n")(se.v|0)==se.v&&se.v>=-32768&&se.v<=32767?Jr(M,13,h(te,Q,se.v)):Jr(M,14,p(te,Q,se.v));else{var Z=_A(se);Jr(M,15,f(te,Q,Z.slice(0,239)))}}return Jr(M,1),M.end()}function a(O,R){var G=R||{};if(+G.codepage>=0&&xf(+G.codepage),G.type=="string")throw new Error("Cannot write WK3 to JS string");var M=Ad();Jr(M,0,o(O));for(var K=0,Y=0;K<O.SheetNames.length;++K)(O.Sheets[O.SheetNames[K]]||{})["!ref"]&&Jr(M,27,ae(O.SheetNames[K],Y++));var D=0;for(K=0;K<O.SheetNames.length;++K){var V=O.Sheets[O.SheetNames[K]];if(!(!V||!V["!ref"])){for(var te=Qa(V["!ref"]),ve=Array.isArray(V),Q=[],Xe=Math.min(te.e.r,8191),se=te.s.r;se<=Xe;++se)for(var Z=uo(se),ke=te.s.c;ke<=te.e.c;++ke){se===te.s.r&&(Q[ke]=_i(ke));var Se=Q[ke]+Z,Ee=ve?(V[se]||[])[ke]:V[Se];if(!(!Ee||Ee.t=="z"))if(Ee.t=="n")Jr(M,23,B(se,ke,D,Ee.v));else{var Ze=_A(Ee);Jr(M,22,N(se,ke,D,Ze.slice(0,239)))}}++D}}return Jr(M,1),M.end()}function s(O){var R=mr(2);return R.write_shift(2,O),R}function o(O){var R=mr(26);R.write_shift(2,4096),R.write_shift(2,4),R.write_shift(4,0);for(var G=0,M=0,K=0,Y=0;Y<O.SheetNames.length;++Y){var D=O.SheetNames[Y],V=O.Sheets[D];if(!(!V||!V["!ref"])){++K;var te=md(V["!ref"]);G<te.e.r&&(G=te.e.r),M<te.e.c&&(M=te.e.c)}}return G>8191&&(G=8191),R.write_shift(2,G),R.write_shift(1,K),R.write_shift(1,M),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(1,1),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(4,0),R}function l(O,R,G){var M={s:{c:0,r:0},e:{c:0,r:0}};return R==8&&G.qpro?(M.s.c=O.read_shift(1),O.l++,M.s.r=O.read_shift(2),M.e.c=O.read_shift(1),O.l++,M.e.r=O.read_shift(2),M):(M.s.c=O.read_shift(2),M.s.r=O.read_shift(2),R==12&&G.qpro&&(O.l+=2),M.e.c=O.read_shift(2),M.e.r=O.read_shift(2),R==12&&G.qpro&&(O.l+=2),M.s.c==65535&&(M.s.c=M.e.c=M.s.r=M.e.r=0),M)}function c(O){var R=mr(8);return R.write_shift(2,O.s.c),R.write_shift(2,O.s.r),R.write_shift(2,O.e.c),R.write_shift(2,O.e.r),R}function d(O,R,G){var M=[{c:0,r:0},{t:"n",v:0},0,0];return G.qpro&&G.vers!=20768?(M[0].c=O.read_shift(1),M[3]=O.read_shift(1),M[0].r=O.read_shift(2),O.l+=2):(M[2]=O.read_shift(1),M[0].c=O.read_shift(2),M[0].r=O.read_shift(2)),M}function u(O,R,G){var M=O.l+R,K=d(O,R,G);if(K[1].t="s",G.vers==20768){O.l++;var Y=O.read_shift(1);return K[1].v=O.read_shift(Y,"utf8"),K}return G.qpro&&O.l++,K[1].v=O.read_shift(M-O.l,"cstr"),K}function f(O,R,G){var M=mr(7+G.length);M.write_shift(1,255),M.write_shift(2,R),M.write_shift(2,O),M.write_shift(1,39);for(var K=0;K<M.length;++K){var Y=G.charCodeAt(K);M.write_shift(1,Y>=128?95:Y)}return M.write_shift(1,0),M}function A(O,R,G){var M=d(O,R,G);return M[1].v=O.read_shift(2,"i"),M}function h(O,R,G){var M=mr(7);return M.write_shift(1,255),M.write_shift(2,R),M.write_shift(2,O),M.write_shift(2,G,"i"),M}function m(O,R,G){var M=d(O,R,G);return M[1].v=O.read_shift(8,"f"),M}function p(O,R,G){var M=mr(13);return M.write_shift(1,255),M.write_shift(2,R),M.write_shift(2,O),M.write_shift(8,G,"f"),M}function x(O,R,G){var M=O.l+R,K=d(O,R,G);if(K[1].v=O.read_shift(8,"f"),G.qpro)O.l=M;else{var Y=O.read_shift(2);w(O.slice(O.l,O.l+Y),K),O.l+=Y}return K}function v(O,R,G){var M=R&32768;return R&=-32769,R=(M?O:0)+(R>=8192?R-16384:R),(M?"":"$")+(G?_i(R):uo(R))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(O,R){Ml(O,0);for(var G=[],M=0,K="",Y="",D="",V="";O.l<O.length;){var te=O[O.l++];switch(te){case 0:G.push(O.read_shift(8,"f"));break;case 1:Y=v(R[0].c,O.read_shift(2),!0),K=v(R[0].r,O.read_shift(2),!1),G.push(Y+K);break;case 2:{var ve=v(R[0].c,O.read_shift(2),!0),Q=v(R[0].r,O.read_shift(2),!1);Y=v(R[0].c,O.read_shift(2),!0),K=v(R[0].r,O.read_shift(2),!1),G.push(ve+Q+":"+Y+K)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:G.push("("+G.pop()+")");break;case 5:G.push(O.read_shift(2));break;case 6:{for(var Xe="";te=O[O.l++];)Xe+=String.fromCharCode(te);G.push('"'+Xe.replace(/"/g,'""')+'"')}break;case 8:G.push("-"+G.pop());break;case 23:G.push("+"+G.pop());break;case 22:G.push("NOT("+G.pop()+")");break;case 20:case 21:V=G.pop(),D=G.pop(),G.push(["AND","OR"][te-20]+"("+D+","+V+")");break;default:if(te<32&&b[te])V=G.pop(),D=G.pop(),G.push(D+b[te]+V);else if(y[te]){if(M=y[te][1],M==69&&(M=O[O.l++]),M>G.length){console.error("WK1 bad formula parse 0x"+te.toString(16)+":|"+G.join("|")+"|");return}var se=G.slice(-M);G.length-=M,G.push(y[te][0]+"("+se.join(",")+")")}else return te<=7?console.error("WK1 invalid opcode "+te.toString(16)):te<=24?console.error("WK1 unsupported op "+te.toString(16)):te<=30?console.error("WK1 invalid opcode "+te.toString(16)):te<=115?console.error("WK1 unsupported function opcode "+te.toString(16)):console.error("WK1 unrecognized opcode "+te.toString(16))}}G.length==1?R[1].f=""+G[0]:console.error("WK1 bad formula parse |"+G.join("|")+"|")}function I(O){var R=[{c:0,r:0},{t:"n",v:0},0];return R[0].r=O.read_shift(2),R[3]=O[O.l++],R[0].c=O[O.l++],R}function j(O,R){var G=I(O);return G[1].t="s",G[1].v=O.read_shift(R-4,"cstr"),G}function N(O,R,G,M){var K=mr(6+M.length);K.write_shift(2,O),K.write_shift(1,G),K.write_shift(1,R),K.write_shift(1,39);for(var Y=0;Y<M.length;++Y){var D=M.charCodeAt(Y);K.write_shift(1,D>=128?95:D)}return K.write_shift(1,0),K}function S(O,R){var G=I(O);G[1].v=O.read_shift(2);var M=G[1].v>>1;if(G[1].v&1)switch(M&7){case 0:M=(M>>3)*5e3;break;case 1:M=(M>>3)*500;break;case 2:M=(M>>3)/20;break;case 3:M=(M>>3)/200;break;case 4:M=(M>>3)/2e3;break;case 5:M=(M>>3)/2e4;break;case 6:M=(M>>3)/16;break;case 7:M=(M>>3)/64;break}return G[1].v=M,G}function E(O,R){var G=I(O),M=O.read_shift(4),K=O.read_shift(4),Y=O.read_shift(2);if(Y==65535)return M===0&&K===3221225472?(G[1].t="e",G[1].v=15):M===0&&K===3489660928?(G[1].t="e",G[1].v=42):G[1].v=0,G;var D=Y&32768;return Y=(Y&32767)-16446,G[1].v=(1-D*2)*(K*Math.pow(2,Y+32)+M*Math.pow(2,Y)),G}function B(O,R,G,M){var K=mr(14);if(K.write_shift(2,O),K.write_shift(1,G),K.write_shift(1,R),M==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var Y=0,D=0,V=0,te=0;return M<0&&(Y=1,M=-M),D=Math.log2(M)|0,M/=Math.pow(2,D-31),te=M>>>0,te&2147483648||(M/=2,++D,te=M>>>0),M-=te,te|=2147483648,te>>>=0,M*=Math.pow(2,32),V=M>>>0,K.write_shift(4,V),K.write_shift(4,te),D+=16383+(Y?32768:0),K.write_shift(2,D),K}function k(O,R){var G=E(O);return O.l+=R-14,G}function T(O,R){var G=I(O),M=O.read_shift(4);return G[1].v=M>>6,G}function P(O,R){var G=I(O),M=O.read_shift(8,"f");return G[1].v=M,G}function q(O,R){var G=P(O);return O.l+=R-10,G}function de(O,R){return O[O.l+R-1]==0?O.read_shift(R,"cstr"):""}function ce(O,R){var G=O[O.l++];G>R-1&&(G=R-1);for(var M="";M.length<G;)M+=String.fromCharCode(O[O.l++]);return M}function le(O,R,G){if(!(!G.qpro||R<21)){var M=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var K=O.read_shift(R-21,"cstr");return[M,K]}}function he(O,R){for(var G={},M=O.l+R;O.l<M;){var K=O.read_shift(2);if(K==14e3){for(G[K]=[0,""],G[K][0]=O.read_shift(2);O[O.l];)G[K][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return G}function ae(O,R){var G=mr(5+O.length);G.write_shift(2,14e3),G.write_shift(2,R);for(var M=0;M<O.length;++M){var K=O.charCodeAt(M);G[G.l++]=K>127?95:K}return G[G.l++]=0,G}var Ce={0:{n:"BOF",f:xo},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:A},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:de},222:{n:"SHEETNAMELP",f:ce},65535:{n:""}},De={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:j},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:k},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:he},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:P},40:{n:"FORMULA28",f:q},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:de},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}}();function qBe(t){var e={},r=t.match(wc),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=zn(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=iR[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return e}var zBe=function(){var t=L2("t"),e=L2("rPr");function r(s){var o=s.match(t);if(!o)return{t:"s",v:""};var l={t:"s",v:Ua(o[1])},c=s.match(e);return c&&(l.s=qBe(c[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(l){return l.v})}}(),WBe=function(){var e=/(\r\n|\n)/g;function r(a,s,o){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),a.b&&(s.push("<b>"),o.push("</b>")),a.i&&(s.push("<i>"),o.push("</i>")),a.strike&&(s.push("<s>"),o.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),XBe=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,YBe=/<(?:\w+:)?r>/,JBe=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function PR(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ua(Cs(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Cs(t),r&&(n.h=pR(n.t))):t.match(YBe)&&(n.r=Cs(t),n.t=Ua(Cs((t.replace(JBe,"").match(XBe)||[]).join("").replace(wc,""))),r&&(n.h=WBe(zBe(n.r)))),n):{t:""}}var ZBe=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,eke=/<(?:\w+:)?(?:si|sstItem)>/g,tke=/<\/(?:\w+:)?(?:si|sstItem)>/;function rke(t,e){var r=[],n="";if(!t)return r;var a=t.match(ZBe);if(a){n=a[2].replace(eke,"").split(tke);for(var s=0;s!=n.length;++s){var o=PR(n[s].trim(),e);o!=null&&(r[r.length]=o)}a=zn(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var nke=/^\s|\s$|[\t\n\r]/;function Lae(t,e){if(!e.bookSST)return"";var r=[ho];r[r.length]=Yr("sst",null,{xmlns:Vg[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var a=t[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(nke)&&(s+=' xml:space="preserve"'),s+=">"+gs(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function ake(t){return[t.read_shift(4),t.read_shift(4)]}function ske(t,e){var r=[],n=!1;return QA(t,function(s,o,l){switch(l){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function ike(t,e){return e||(e=mr(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var oke=g5e;function lke(t){var e=Ad();Tr(e,159,ike(t));for(var r=0;r<t.length;++r)Tr(e,19,oke(t[r]));return Tr(e,160),e.end()}function Uae(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function hA(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function cke(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=hA(t,4),e.U=hA(t,4),e.W=hA(t,4),e}function dke(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},a=t.read_shift(4),s=[];a-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function uke(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(dke(t));return e}function fke(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function hke(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=hA(t,4),e.U=hA(t,4),e.W=hA(t,4),e}function Ake(t){var e=hke(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function Qae(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function Vae(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function mke(t){var e=hA(t);switch(e.Minor){case 2:return[e.Minor,pke(t)];case 3:return[e.Minor,gke()];case 4:return[e.Minor,xke(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function pke(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=Qae(t,r),a=Vae(t,t.length-t.l);return{t:"Std",h:n,v:a}}function gke(){throw new Error("File is password-protected: ECMA-376 Extensible")}function xke(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(wc,function(s){var o=zn(s);switch(bh(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function vke(t,e){var r={},n=r.EncryptionVersionInfo=hA(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,r.EncryptionHeader=Qae(t,a),e-=a,r.EncryptionVerifier=Vae(t,e),r}function yke(t){var e={},r=e.EncryptionVersionInfo=hA(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function TR(t){var e=0,r,n=Uae(t),a=n.length+1,s,o,l,c,d;for(r=Tm(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)o=r[s],l=e&16384?1:0,c=e<<1&32767,d=l|c,e=d^o;return e^52811}var Hae=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,l){return n(o^l)},s=function(o){for(var l=e[o.length-1],c=104,d=o.length-1;d>=0;--d)for(var u=o[d],f=0;f!=7;++f)u&64&&(l^=r[c]),u*=2,--c;return l};return function(o){for(var l=Uae(o),c=s(l),d=l.length,u=Tm(16),f=0;f!=16;++f)u[f]=0;var A,h,m;for((d&1)===1&&(A=c>>8,u[d]=a(t[0],A),--d,A=c&255,h=l[l.length-1],u[d]=a(h,A));d>0;)--d,A=c>>8,u[d]=a(l[d],A),--d,A=c&255,u[d]=a(l[d],A);for(d=15,m=15-l.length;m>0;)A=c>>8,u[d]=a(t[m],A),--d,--m,A=c&255,u[d]=a(l[d],A),--d,--m;return u}}(),bke=function(t,e,r,n,a){a||(a=e),n||(n=Hae(t));var s,o;for(s=0;s!=e.length;++s)o=e[s],o^=n[r],o=(o>>5|o<<3)&255,a[s]=o,++r;return[a,r,n]},wke=function(t){var e=0,r=Hae(t);return function(n){var a=bke("",n,e,r);return e=a[1],a[0]}};function Nke(t,e,r,n){var a={key:xo(t),verificationBytes:xo(t)};return r.password&&(a.verifier=TR(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=wke(r.password)),a}function Cke(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=yke(t):n.Data=vke(t,e),n}function _ke(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?Cke(t,e-2,n):Nke(t,r.biff>=8?e:e-2,r,n),n}var $ae=function(){function t(a,s){switch(s.type){case"base64":return e(Wd(a),s);case"binary":return e(a,s);case"buffer":return e(xa&&Buffer.isBuffer(a)?a.toString("binary"):Gm(a),s);case"array":return e(vg(a),s)}throw new Error("Unrecognized type "+s.type)}function e(a,s){var o=s||{},l=o.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,f){Array.isArray(l)&&(l[f]=[]);for(var A=/\\\w+\b/g,h=0,m,p=-1;m=A.exec(u);){switch(m[0]){case"\\cell":var x=u.slice(h,A.lastIndex-m[0].length);if(x[0]==" "&&(x=x.slice(1)),++p,x.length){var v={v:x,t:"s"};Array.isArray(l)?l[f][p]=v:l[Kn({r:f,c:p})]=v}break}h=A.lastIndex}p>d.e.c&&(d.e.c=p)}),l["!ref"]=fa(d),l}function r(a,s){return Km(t(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],o=Qa(a["!ref"]),l,c=Array.isArray(a),d=o.s.r;d<=o.e.r;++d){s.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var f=Kn({r:d,c:u});l=c?(a[d]||[])[u]:a[f],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(_A(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function Eke(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function H2(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function Ske(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,a=Math.max(e,r,n),s=Math.min(e,r,n),o=a-s;if(o===0)return[0,0,e];var l=0,c=0,d=a+s;switch(c=o/(d>1?2-d:d),a){case e:l=((r-n)/o+6)%6;break;case r:l=(n-e)/o+2;break;case n:l=(e-r)/o+4;break}return[l/6,c,d/2]}function jke(t){var e=t[0],r=t[1],n=t[2],a=r*2*(n<.5?n:1-n),s=n-a/2,o=[s,s,s],l=6*e,c;if(r!==0)switch(l|0){case 0:case 6:c=a*l,o[0]+=a,o[1]+=c;break;case 1:c=a*(2-l),o[0]+=c,o[1]+=a;break;case 2:c=a*(l-2),o[1]+=a,o[2]+=c;break;case 3:c=a*(4-l),o[1]+=c,o[2]+=a;break;case 4:c=a*(l-4),o[2]+=a,o[0]+=c;break;case 5:c=a*(6-l),o[2]+=c,o[0]+=a;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function nj(t,e){if(e===0)return t;var r=Ske(Eke(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),H2(jke(r))}var Gae=6,Ike=15,Pke=1,hc=Gae;function $2(t){return Math.floor((t+Math.round(128/hc)/256)*hc)}function G2(t){return Math.floor((t-5)/hc*100+.5)/100}function aj(t){return Math.round((t*hc+5)/hc*256)/256}function V5(t){return aj(G2($2(t)))}function BR(t){var e=Math.abs(t-V5(t)),r=hc;if(e>.005)for(hc=Pke;hc<Ike;++hc)Math.abs(t-V5(t))<=e&&(e=Math.abs(t-V5(t)),r=hc);hc=r}function Bm(t){t.width?(t.wpx=$2(t.width),t.wch=G2(t.wpx),t.MDW=hc):t.wpx?(t.wch=G2(t.wpx),t.width=aj(t.wch),t.MDW=hc):typeof t.wch=="number"&&(t.width=aj(t.wch),t.wpx=$2(t.width),t.MDW=hc),t.customWidth&&delete t.customWidth}var Tke=96,Kae=Tke;function K2(t){return t*96/Kae}function Kv(t){return t*Kae/96}var Bke={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function kke(t,e,r,n){e.Borders=[];var a={},s=!1;(t[0].match(wc)||[]).forEach(function(o){var l=zn(o);switch(bh(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=Ws(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=Ws(l.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function Fke(t,e,r,n){e.Fills=[];var a={},s=!1;(t[0].match(wc)||[]).forEach(function(o){var l=zn(o);switch(bh(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function Oke(t,e,r,n){e.Fonts=[];var a={},s=!1;(t[0].match(wc)||[]).forEach(function(o){var l=zn(o);switch(bh(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=Cs(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?Ws(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?Ws(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?Ws(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?Ws(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?Ws(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?Ws(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?Ws(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=iR[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=Ws(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var c=Kp[a.color.index];a.color.index==81&&(c=Kp[1]),c||(c=Kp[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=nj(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function Dke(t,e,r){e.NumberFmt=[];for(var n=Gi(Gn),a=0;a<n.length;++a)e.NumberFmt[n[a]]=Gn[n[a]];var s=t[0].match(wc);if(s)for(a=0;a<s.length;++a){var o=zn(s[a]);switch(bh(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=Ua(Cs(o.formatCode)),c=parseInt(o.numFmtId,10);if(e.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=l}fA(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function Rke(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Yr("numFmt",null,{numFmtId:n,formatCode:gs(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Yr("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var JC=["numFmtId","fillId","fontId","borderId","xfId"],ZC=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Mke(t,e,r){e.CellXf=[];var n,a=!1;(t[0].match(wc)||[]).forEach(function(s){var o=zn(s),l=0;switch(bh(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<JC.length;++l)n[JC[l]]&&(n[JC[l]]=parseInt(n[JC[l]],10));for(l=0;l<ZC.length;++l)n[ZC[l]]&&(n[ZC[l]]=Ws(n[ZC[l]]));if(e.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[l]){n.numFmtId=l;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=Ws(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Lke(t){var e=[];return e[e.length]=Yr("cellXfs",null),t.forEach(function(r){e[e.length]=Yr("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Yr("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Uke=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,d){var u={};if(!l)return u;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(e))&&Dke(f,u,d),(f=l.match(a))&&Oke(f,u,c,d),(f=l.match(n))&&Fke(f,u,c,d),(f=l.match(s))&&kke(f,u,c,d),(f=l.match(r))&&Mke(f,u,d),u}}();function qae(t,e){var r=[ho,Yr("styleSheet",null,{xmlns:Vg[0],"xmlns:vt":Vo.vt})],n;return t.SSF&&(n=Rke(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Lke(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Qke(t,e){var r=t.read_shift(2),n=pc(t);return[r,n]}function Vke(t,e,r){r||(r=mr(6+4*e.length)),r.write_shift(2,t),hl(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Hke(t,e,r){var n={};n.sz=t.read_shift(2)/20;var a=C5e(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var l=t.read_shift(1);l>0&&(n.family=l);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=N5e(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=pc(t),n}function $ke(t,e){e||(e=mr(25+4*32)),e.write_shift(2,t.sz*20),_5e(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),ej(t.color,e);var n=0;return n=2,e.write_shift(1,n),hl(t.name,e),e.length>e.l?e.slice(0,e.l):e}var Gke=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],H5,Kke=vc;function h$(t,e){e||(e=mr(4*3+8*7+16*1)),H5||(H5=gP(Gke));var r=H5[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(ej({auto:1},e),ej({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function qke(t,e){var r=t.l+e,n=t.read_shift(2),a=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:a}}function zae(t,e,r){r||(r=mr(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Cy(t,e){return e||(e=mr(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var zke=vc;function Wke(t,e){return e||(e=mr(51)),e.write_shift(1,0),Cy(null,e),Cy(null,e),Cy(null,e),Cy(null,e),Cy(null,e),e.length>e.l?e.slice(0,e.l):e}function Xke(t,e){return e||(e=mr(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),ZS(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function Yke(t,e,r){var n=mr(2052);return n.write_shift(4,t),ZS(e,n),ZS(r,n),n.length>n.l?n.slice(0,n.l):n}function Jke(t,e,r){var n={};n.NumberFmt=[];for(var a in Gn)n.NumberFmt[a]=Gn[a];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return QA(t,function(c,d,u){switch(u){case 44:n.NumberFmt[c[0]]=c[1],fA(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=nj(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(u),o=!0;break;case 38:s.pop(),o=!1;break;default:if(d.T>0)s.push(u);else if(d.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function Zke(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&++r}),r!=0&&(Tr(t,615,Cf(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Tr(t,44,Vke(a,e[a]))}),Tr(t,616))}}function eFe(t){var e=1;Tr(t,611,Cf(e)),Tr(t,43,$ke({sz:12,color:{theme:1},name:"Calibri",family:2})),Tr(t,612)}function tFe(t){var e=2;Tr(t,603,Cf(e)),Tr(t,45,h$({patternType:"none"})),Tr(t,45,h$({patternType:"gray125"})),Tr(t,604)}function rFe(t){var e=1;Tr(t,613,Cf(e)),Tr(t,46,Wke()),Tr(t,614)}function nFe(t){var e=1;Tr(t,626,Cf(e)),Tr(t,47,zae({numFmtId:0},65535)),Tr(t,627)}function aFe(t,e){Tr(t,617,Cf(e.length)),e.forEach(function(r){Tr(t,47,zae(r,0))}),Tr(t,618)}function sFe(t){var e=1;Tr(t,619,Cf(e)),Tr(t,48,Xke({xfId:0,name:"Normal"})),Tr(t,620)}function iFe(t){var e=0;Tr(t,505,Cf(e)),Tr(t,506)}function oFe(t){var e=0;Tr(t,508,Yke(e,"TableStyleMedium9","PivotStyleMedium4")),Tr(t,509)}function lFe(t,e){var r=Ad();return Tr(r,278),Zke(r,t.SSF),eFe(r),tFe(r),rFe(r),nFe(r),aFe(r,e.cellXfs),sFe(r),iFe(r),oFe(r),Tr(r,279),r.end()}var cFe=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function dFe(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(wc)||[]).forEach(function(a){var s=zn(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[cFe.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function uFe(){}function fFe(){}var hFe=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,AFe=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,mFe=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function pFe(t,e,r){e.themeElements={};var n;[["clrScheme",hFe,dFe],["fontScheme",AFe,uFe],["fmtScheme",mFe,fFe]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,r)})}var gFe=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Wae(t,e){(!t||t.length===0)&&(t=kR());var r,n={};if(!(r=t.match(gFe)))throw new Error("themeElements not found in theme");return pFe(r[0],n,e),n.raw=t,n}function kR(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[ho];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function xFe(t,e,r){var n=t.l+e,a=t.read_shift(4);if(a!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var o;try{o=Qne(s,{type:"array"})}catch{return}var l=Rd(o,"theme/theme/theme1.xml",!0);if(l)return Wae(l,r)}}function vFe(t){return t.read_shift(4)}function yFe(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=bFe(t,4);break;case 2:e.xclrValue=jae(t);break;case 3:e.xclrValue=vFe(t);break;case 4:t.l+=4;break}return t.l+=8,e}function bFe(t,e){return vc(t,e)}function wFe(t,e){return vc(t,e)}function NFe(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=yFe(t);break;case 6:n[1]=wFe(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function CFe(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),s=[];a-- >0;)s.push(NFe(t,r-t.l));return{ixfe:n,ext:s}}function _Fe(t,e){e.forEach(function(r){switch(r[0]){}})}function EFe(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:pc(t)}}function SFe(t){var e=mr(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),hl(t.name,e),e.slice(0,e.l)}function jFe(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function IFe(t){var e=mr(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function PFe(t,e){var r=mr(8+2*e.length);return r.write_shift(4,t),hl(e,r),r.slice(0,r.l)}function TFe(t){return t.l+=4,t.read_shift(4)!=0}function BFe(t,e){var r=mr(8);return r.write_shift(4,t),r.write_shift(4,1),r}function kFe(t,e,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],o=!1,l=2;return QA(t,function(c,d,u){switch(u){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):l==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:s.push(u),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!d.T){if(!o||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function FFe(){var t=Ad();return Tr(t,332),Tr(t,334,Cf(1)),Tr(t,335,SFe({name:"XLDAPR",version:12e4,flags:3496657072})),Tr(t,336),Tr(t,339,PFe(1,"XLDAPR")),Tr(t,52),Tr(t,35,Cf(514)),Tr(t,4096,Cf(0)),Tr(t,4097,wu(1)),Tr(t,36),Tr(t,53),Tr(t,340),Tr(t,337,BFe(1)),Tr(t,51,IFe([[1,0]])),Tr(t,338),Tr(t,333),t.end()}function OFe(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,s=2,o;return t.replace(wc,function(l){var c=zn(l);switch(bh(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==c.name&&(o=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function Xae(){var t=[ho];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function DFe(t){var e=[];if(!t)return e;var r=1;return(t.match(wc)||[]).forEach(function(n){var a=zn(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,e.push(a);break}}),e}function RFe(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Kn(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function MFe(t,e,r){var n=[];return QA(t,function(s,o,l){switch(l){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function LFe(t,e,r,n){if(!t)return t;var a=n||{},s=!1;QA(t,function(l,c,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function UFe(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var ev=1024;function Yae(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Yr("xml",null,{"xmlns:v":Fd.v,"xmlns:o":Fd.o,"xmlns:x":Fd.x,"xmlns:mv":Fd.mv}).replace(/\/>/,">"),Yr("o:shapelayout",Yr("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Yr("v:shapetype",[Yr("v:stroke",null,{joinstyle:"miter"}),Yr("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];ev<t*1e3;)ev+=1e3;return e.forEach(function(s){var o=Ei(s[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Yr("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Yr("v:fill",c,l),u={on:"t",obscured:"t"};++ev,a=a.concat(["<v:shape"+U2({id:"_x0000_s"+ev,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Yr("v:shadow",null,u),Yr("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ul("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Ul("x:AutoFill","False"),Ul("x:Row",String(o.r)),Ul("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function A$(t,e,r,n){var a=Array.isArray(t),s;e.forEach(function(o){var l=Ei(o.ref);if(a?(t[l.r]||(t[l.r]=[]),s=t[l.r][l.c]):s=t[o.ref],!s){s={t:"z"},a?t[l.r][l.c]=s:t[o.ref]=s;var c=Qa(t["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var d=fa(c);d!==t["!ref"]&&(t["!ref"]=d)}s.c||(s.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}s.c.push(u)})}function QFe(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=zn(l[0]),d={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=Ei(c.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),A=!!f&&!!f[1]&&PR(f[1])||{r:"",t:"",h:""};d.r=A.r,A.r=="<t></t>"&&(A.t=A.h=""),d.t=(A.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=A.h),n.push(d)}}}}),n}function Jae(t){var e=[ho,Yr("comments",null,{xmlns:Vg[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(a){var s=gs(a.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(gs(c.a))),s.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)e.push(Ul("t",gs(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)o+=`Reply:
    `+s[l]+`
`;e.push(Ul("t",gs(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function VFe(t,e){var r=[],n=!1,a={},s=0;return t.replace(wc,function(l,c){var d=zn(l);switch(bh(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=c+l.length;break;case"</text>":a.t=t.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return l}),r}function HFe(t,e,r){var n=[ho,Yr("ThreadedComments",null,{xmlns:Vo.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var s="";(a[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?s=c.id:c.parentId=s,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(Yr("threadedComment",Ul("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function $Fe(t,e){var r=[],n=!1;return t.replace(wc,function(s){var o=zn(s);switch(bh(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function GFe(t){var e=[ho,Yr("personList",null,{xmlns:Vo.TCMNT,"xmlns:x":Vg[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Yr("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function KFe(t){var e={};e.iauthor=t.read_shift(4);var r=Kg(t);return e.rfx=r.s,e.ref=Kn(r.s),t.l+=16,e}function qFe(t,e){return e==null&&(e=mr(36)),e.write_shift(4,t[1].iauthor),j1(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var zFe=pc;function WFe(t){return hl(t.slice(0,54))}function XFe(t,e){var r=[],n=[],a={},s=!1;return QA(t,function(l,c,d){switch(d){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function YFe(t){var e=Ad(),r=[];return Tr(e,628),Tr(e,630),t.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Tr(e,632,WFe(a.a)))})}),Tr(e,631),Tr(e,633),t.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:Ei(n[0]),e:Ei(n[0])};Tr(e,635,qFe([s,a])),a.t&&a.t.length>0&&Tr(e,637,v5e(a)),Tr(e,636),delete a.iauthor})}),Tr(e,634),Tr(e,629),e.end()}var JFe="application/vnd.ms-office.vbaProject";function ZFe(t){var e=Dn.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Dn.utils.cfb_add(e,a,t.FileIndex[n].content)}}),Dn.write(e)}function eOe(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Dn.utils.cfb_add(t,a,e.FileIndex[n].content)}})}var Zae=["xlsb","xlsm","xlam","biff8","xla"];function tOe(){return{"!type":"dialog"}}function rOe(){return{"!type":"dialog"}}function nOe(){return{"!type":"macro"}}function aOe(){return{"!type":"macro"}}var bv=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,a,s,o){var l=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var d=s.length>0?parseInt(s,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return l?u+=e.c:--u,c?d+=e.r:--d,a+(l?"":"$")+_i(u)+(c?"":"$")+uo(d)}return function(a,s){return e=s,a.replace(t,r)}}(),FR=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,OR=function(){return function(e,r){return e.replace(FR,function(n,a,s,o,l,c){var d=bR(o)-(s?0:r.c),u=yR(c)-(l?0:r.r),f=u==0?"":l?u+1:"["+u+"]",A=d==0?"":s?d+1:"["+d+"]";return a+"R"+f+"C"+A})}}();function ese(t,e){return t.replace(FR,function(r,n,a,s,o,l){return n+(a=="$"?a+s:_i(bR(s)+e.c))+(o=="$"?o+l:uo(yR(l)+e.r))})}function sOe(t,e,r){var n=md(e),a=n.s,s=Ei(r),o={r:s.r-a.r,c:s.c-a.c};return ese(t,o)}function iOe(t){return t.length!=1}function m$(t){return t.replace(/_xlfn\./g,"")}function Ao(t){t.l+=1}function km(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function tse(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return rse(t);r.biff==12&&(n=4)}var a=t.read_shift(n),s=t.read_shift(n),o=km(t),l=km(t);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function rse(t){var e=km(t),r=km(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function oOe(t,e,r){if(r.biff<8)return rse(t);var n=t.read_shift(r.biff==12?4:2),a=t.read_shift(r.biff==12?4:2),s=km(t),o=km(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function nse(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return lOe(t);var n=t.read_shift(r&&r.biff==12?4:2),a=km(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function lOe(t){var e=km(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function cOe(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function dOe(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return uOe(t);var a=t.read_shift(n>=12?4:2),s=t.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;a>524287;)a-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:o,rRel:l}}function uOe(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:a,rRel:n}}function fOe(t,e,r){var n=(t[t.l++]&96)>>5,a=tse(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function hOe(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var o=tse(t,s,r);return[n,a,o]}function AOe(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function mOe(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,a]}function pOe(t,e,r){var n=(t[t.l++]&96)>>5,a=oOe(t,e-1,r);return[n,a]}function gOe(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function p$(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function xOe(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(t.read_shift(r&&r.biff==2?1:2));return a}function vOe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function yOe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function bOe(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function wOe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function ase(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function NOe(t){return t.read_shift(2),ase(t)}function COe(t){return t.read_shift(2),ase(t)}function _Oe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=nse(t,0,r);return[n,a]}function EOe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=dOe(t,0,r);return[n,a]}function SOe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=nse(t,0,r);return[n,a,s]}function jOe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(r&&r.biff<=3?1:2);return[TDe[a],ose[a],n]}function IOe(t,e,r){var n=t[t.l++],a=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:POe(t);return[a,(s[0]===0?ose:PDe)[s[1]]]}function POe(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function TOe(t,e,r){t.l+=r&&r.biff==2?3:4}function BOe(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function kOe(t){return t.l++,VA[t.read_shift(1)]}function FOe(t){return t.l++,t.read_shift(2)}function OOe(t){return t.l++,t.read_shift(1)!==0}function DOe(t){return t.l++,Ac(t)}function ROe(t,e,r){return t.l++,$w(t,e-1,r)}function MOe(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=eo(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=VA[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Ac(t);break;case 2:r[1]=qg(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function LOe(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?Kg:yP)(t));return a}function UOe(t,e,r){var n=0,a=0;r.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var l=0;l!=a;++l)o[s][l]=MOe(t,r.biff);return o}function QOe(t,e,r){var n=t.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=t.read_shift(a);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function VOe(t,e,r){if(r.biff==5)return HOe(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),s=t.read_shift(4);return[n,a,s]}function HOe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function $Oe(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function GOe(t,e,r){var n=t.read_shift(1)>>>5&3,a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function KOe(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function qOe(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,a]}var zOe=vc,WOe=vc,XOe=vc;function Kw(t,e,r){return t.l+=2,[cOe(t)]}function DR(t){return t.l+=6,[]}var YOe=Kw,JOe=DR,ZOe=DR,eDe=Kw;function sse(t){return t.l+=2,[xo(t),t.read_shift(2)&1]}var tDe=Kw,rDe=sse,nDe=DR,aDe=Kw,sDe=Kw,iDe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function oDe(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),s=t.read_shift(2),o=iDe[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:a,C:s}}function lDe(t){return t.l+=2,[t.read_shift(4)]}function cDe(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function dDe(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function uDe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function fDe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function hDe(t){return t.l+=4,[0,0]}var g$={1:{n:"PtgExp",f:BOe},2:{n:"PtgTbl",f:XOe},3:{n:"PtgAdd",f:Ao},4:{n:"PtgSub",f:Ao},5:{n:"PtgMul",f:Ao},6:{n:"PtgDiv",f:Ao},7:{n:"PtgPower",f:Ao},8:{n:"PtgConcat",f:Ao},9:{n:"PtgLt",f:Ao},10:{n:"PtgLe",f:Ao},11:{n:"PtgEq",f:Ao},12:{n:"PtgGe",f:Ao},13:{n:"PtgGt",f:Ao},14:{n:"PtgNe",f:Ao},15:{n:"PtgIsect",f:Ao},16:{n:"PtgUnion",f:Ao},17:{n:"PtgRange",f:Ao},18:{n:"PtgUplus",f:Ao},19:{n:"PtgUminus",f:Ao},20:{n:"PtgPercent",f:Ao},21:{n:"PtgParen",f:Ao},22:{n:"PtgMissArg",f:Ao},23:{n:"PtgStr",f:ROe},26:{n:"PtgSheet",f:cDe},27:{n:"PtgEndSheet",f:dDe},28:{n:"PtgErr",f:kOe},29:{n:"PtgBool",f:OOe},30:{n:"PtgInt",f:FOe},31:{n:"PtgNum",f:DOe},32:{n:"PtgArray",f:gOe},33:{n:"PtgFunc",f:jOe},34:{n:"PtgFuncVar",f:IOe},35:{n:"PtgName",f:QOe},36:{n:"PtgRef",f:_Oe},37:{n:"PtgArea",f:fOe},38:{n:"PtgMemArea",f:$Oe},39:{n:"PtgMemErr",f:zOe},40:{n:"PtgMemNoMem",f:WOe},41:{n:"PtgMemFunc",f:GOe},42:{n:"PtgRefErr",f:KOe},43:{n:"PtgAreaErr",f:AOe},44:{n:"PtgRefN",f:EOe},45:{n:"PtgAreaN",f:pOe},46:{n:"PtgMemAreaN",f:uDe},47:{n:"PtgMemNoMemN",f:fDe},57:{n:"PtgNameX",f:VOe},58:{n:"PtgRef3d",f:SOe},59:{n:"PtgArea3d",f:hOe},60:{n:"PtgRefErr3d",f:qOe},61:{n:"PtgAreaErr3d",f:mOe},255:{}},ADe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},mDe={1:{n:"PtgElfLel",f:sse},2:{n:"PtgElfRw",f:aDe},3:{n:"PtgElfCol",f:YOe},6:{n:"PtgElfRwV",f:sDe},7:{n:"PtgElfColV",f:eDe},10:{n:"PtgElfRadical",f:tDe},11:{n:"PtgElfRadicalS",f:nDe},13:{n:"PtgElfColS",f:JOe},15:{n:"PtgElfColSV",f:ZOe},16:{n:"PtgElfRadicalLel",f:rDe},25:{n:"PtgList",f:oDe},29:{n:"PtgSxName",f:lDe},255:{}},pDe={0:{n:"PtgAttrNoop",f:hDe},1:{n:"PtgAttrSemi",f:wOe},2:{n:"PtgAttrIf",f:yOe},4:{n:"PtgAttrChoose",f:xOe},8:{n:"PtgAttrGoto",f:vOe},16:{n:"PtgAttrSum",f:TOe},32:{n:"PtgAttrBaxcel",f:p$},33:{n:"PtgAttrBaxcel",f:p$},64:{n:"PtgAttrSpace",f:NOe},65:{n:"PtgAttrSpaceSemi",f:COe},128:{n:"PtgAttrIfError",f:bOe},255:{}};function qw(t,e,r,n){if(n.biff<8)return vc(t,e);for(var a=t.l+e,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=UOe(t,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=LOe(t,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=a-t.l,e!==0&&s.push(vc(t,e)),s}function zw(t,e,r){for(var n=t.l+e,a,s,o=[];n!=t.l;)e=n-t.l,s=t[t.l],a=g$[s]||g$[ADe[s]],(s===24||s===25)&&(a=(s===24?mDe:pDe)[t[t.l+1]]),!a||!a.f?vc(t,e):o.push([a.n,a.f(t,e,r)]);return o}function gDe(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],a=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var xDe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function vDe(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function ise(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function x$(t,e,r){var n=ise(t,e,r);return n=="#REF"?n:vDe(n,r)}function uc(t,e,r,n,a){var s=a&&a.biff||8,o={s:{c:0,r:0}},l=[],c,d,u,f=0,A=0,h,m="";if(!t[0]||!t[0][0])return"";for(var p=-1,x="",v=0,y=t[0].length;v<y;++v){var b=t[0][v];switch(b[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),d=l.pop(),p>=0){switch(t[0][p][1][0]){case 0:x=Ui(" ",t[0][p][1][1]);break;case 1:x=Ui("\r",t[0][p][1][1]);break;default:if(x="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}d=d+x,p=-1}l.push(d+xDe[b[0]]+c);break;case"PtgIsect":c=l.pop(),d=l.pop(),l.push(d+" "+c);break;case"PtgUnion":c=l.pop(),d=l.pop(),l.push(d+","+c);break;case"PtgRange":c=l.pop(),d=l.pop(),l.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Ub(b[1][1],o,a),l.push(Qb(u,s));break;case"PtgRefN":u=r?Ub(b[1][1],r,a):b[1][1],l.push(Qb(u,s));break;case"PtgRef3d":f=b[1][1],u=Ub(b[1][2],o,a),m=x$(n,f,a),l.push(m+"!"+Qb(u,s));break;case"PtgFunc":case"PtgFuncVar":var w=b[1][0],I=b[1][1];w||(w=0),w&=127;var j=w==0?[]:l.slice(-w);l.length-=w,I==="User"&&(I=j.shift()),l.push(I+"("+j.join(",")+")");break;case"PtgBool":l.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(b[1]);break;case"PtgNum":l.push(String(b[1]));break;case"PtgStr":l.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(b[1]);break;case"PtgAreaN":h=qH(b[1][1],r?{s:r}:o,a),l.push(L5(h,a));break;case"PtgArea":h=qH(b[1][1],o,a),l.push(L5(h,a));break;case"PtgArea3d":f=b[1][1],h=b[1][2],m=x$(n,f,a),l.push(m+"!"+L5(h,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":A=b[1][2];var N=(n.names||[])[A-1]||(n[0]||[])[A],S=N?N.Name:"SH33TJSNAME"+String(A);S&&S.slice(0,6)=="_xlfn."&&!a.xlfn&&(S=S.slice(6)),l.push(S);break;case"PtgNameX":var E=b[1][1];A=b[1][2];var B;if(a.biff<=5)E<0&&(E=-E),n[E]&&(B=n[E][A]);else{var k="";if(((n[E]||[])[0]||[])[0]==14849||(((n[E]||[])[0]||[])[0]==1025?n[E][A]&&n[E][A].itab>0&&(k=n.SheetNames[n[E][A].itab-1]+"!"):k=n.SheetNames[A-1]+"!"),n[E]&&n[E][A])k+=n[E][A].Name;else if(n[0]&&n[0][A])k+=n[0][A].Name;else{var T=(ise(n,E,a)||"").split(";;");T[A-1]?k=T[A-1]:k+="SH33TJSERRX"}l.push(k);break}B||(B={Name:"SH33TJSERRY"}),l.push(B.Name);break;case"PtgParen":var P="(",q=")";if(p>=0){switch(x="",t[0][p][1][0]){case 2:P=Ui(" ",t[0][p][1][1])+P;break;case 3:P=Ui("\r",t[0][p][1][1])+P;break;case 4:q=Ui(" ",t[0][p][1][1])+q;break;case 5:q=Ui("\r",t[0][p][1][1])+q;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}p=-1}l.push(P+l.pop()+q);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:b[1][1],r:b[1][0]};var de={c:r.c,r:r.r};if(n.sharedf[Kn(u)]){var ce=n.sharedf[Kn(u)];l.push(uc(ce,o,de,n,a))}else{var le=!1;for(c=0;c!=n.arrayf.length;++c)if(d=n.arrayf[c],!(u.c<d[0].s.c||u.c>d[0].e.c)&&!(u.r<d[0].s.r||u.r>d[0].e.r)){l.push(uc(d[1],o,de,n,a)),le=!0;break}le||l.push(b[1])}break;case"PtgArray":l.push("{"+gDe(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var he=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&he.indexOf(t[0][v][0])==-1){b=t[0][p];var ae=!0;switch(b[1][0]){case 4:ae=!1;case 0:x=Ui(" ",b[1][1]);break;case 5:ae=!1;case 1:x=Ui("\r",b[1][1]);break;default:if(x="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}l.push((ae?x:"")+l.pop()+(ae?"":x)),p=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function yDe(t,e,r){var n=t.l+e,a=r.biff==2?1:2,s,o=t.read_shift(a);if(o==65535)return[[],vc(t,e-2)];var l=zw(t,o,r);return e!==o+a&&(s=qw(t,e-o-a,l,r)),t.l=n,[l,s]}function bDe(t,e,r){var n=t.l+e,a=r.biff==2?1:2,s,o=t.read_shift(a);if(o==65535)return[[],vc(t,e-2)];var l=zw(t,o,r);return e!==o+a&&(s=qw(t,e-o-a,l,r)),t.l=n,[l,s]}function wDe(t,e,r,n){var a=t.l+e,s=zw(t,n,r),o;return a!==t.l&&(o=qw(t,a-t.l,s,r)),[s,o]}function NDe(t,e,r){var n=t.l+e,a,s=t.read_shift(2),o=zw(t,s,r);return s==65535?[[],vc(t,e-2)]:(e!==s+2&&(a=qw(t,n-s-2,o,r)),[o,a])}function CDe(t){var e;if(tA(t,t.l+6)!==65535)return[Ac(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function _De(t){if(t==null){var e=mr(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return yg(t);return yg(0)}function $5(t,e,r){var n=t.l+e,a=wh(t);r.biff==2&&++t.l;var s=CDe(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var l=bDe(t,n-t.l,r);return{cell:a,val:s[0],formula:l,shared:o>>3&1,tt:s[1]}}function EDe(t,e,r,n,a){var s=wg(e,r,a),o=_De(t.v),l=mr(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var d=mr(t.bf.length),u=0;u<t.bf.length;++u)d[u]=t.bf[u];var f=fl([s,o,l,d]);return f}function bP(t,e,r){var n=t.read_shift(4),a=zw(t,n,r),s=t.read_shift(4),o=s>0?qw(t,s,a,r):null;return[a,o]}var SDe=bP,wP=bP,jDe=bP,IDe=bP,PDe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ose={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},TDe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function v$(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function BDe(t){var e="of:="+t.replace(FR,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function G5(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function kDe(t){return t.replace(/\./,"!")}var Hb={},wv={},$b=typeof Map<"u";function RR(t,e,r){var n=0,a=t.length;if(r){if($b?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=$b?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<a;++n)if(t[n].t===e)return t.Count++,n;return t[a]={t:e},t.Count++,t.Unique++,r&&($b?(r.has(e)||r.set(e,[]),r.get(e).push(a)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(a))),a}function NP(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(hc=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=G2(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=aj(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Wp(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function qm(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],a=60,s=t.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){fA(e.z,a),r.ssf[a]=e.z,r.revssf[e.z]=n=a;break}}for(a=0;a!=s;++a)if(t[a].numFmtId===n)return a;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function lse(t,e,r,n,a,s){try{n.cellNF&&(t.z=Gn[e])}catch(l){if(n.WTF)throw l}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Zs(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Gn[e]==null&&fA(P4e[e]||"General",e),t.t==="e")t.w=t.w||VA[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=M2(t.v);else if(t.t==="d"){var o=qo(t.v);(o|0)===o?t.w=o.toString(10):t.w=M2(o)}else{if(t.v===void 0)return"";t.w=xg(t.v,wv)}else t.t==="d"?t.w=Uu(e,qo(t.v),wv):t.w=Uu(e,t.v,wv)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=nj(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=nj(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&s.Fills)throw l}}}function FDe(t,e,r){if(t&&t["!ref"]){var n=Qa(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function ODe(t,e){var r=Qa(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=fa(r))}var DDe=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,RDe=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,MDe=/<(?:\w:)?hyperlink [^>]*>/mg,LDe=/"(\w*:\w*)"/,UDe=/<(?:\w:)?col\b[^>]*[\/]?>/g,QDe=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,VDe=/<(?:\w:)?pageMargins[^>]*\/>/g,cse=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,HDe=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,$De=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function GDe(t,e,r,n,a,s,o){if(!t)return t;n||(n={"!id":{}});var l=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",u="",f=t.match(RDe);f?(d=t.slice(0,f.index),u=t.slice(f.index+f[0].length)):d=u=t;var A=d.match(cse);A?MR(A[0],l,a,r):(A=d.match(HDe))&&qDe(A[0],A[1]||"",l,a,r);var h=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=d.slice(h,h+50).match(LDe);m&&ODe(l,m[1])}var p=d.match($De);p&&p[1]&&i6e(p[1],a);var x=[];if(e.cellStyles){var v=d.match(UDe);v&&t6e(x,v)}f&&c6e(f[1],l,e,c,s,o);var y=u.match(QDe);y&&(l["!autofilter"]=n6e(y[0]));var b=[],w=u.match(DDe);if(w)for(h=0;h!=w.length;++h)b[h]=Qa(w[h].slice(w[h].indexOf('"')+1));var I=u.match(MDe);I&&JDe(l,I,n);var j=u.match(VDe);if(j&&(l["!margins"]=ZDe(zn(j[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=fa(c)),e.sheetRows>0&&l["!ref"]){var N=Qa(l["!ref"]);e.sheetRows<=+N.e.r&&(N.e.r=e.sheetRows-1,N.e.r>c.e.r&&(N.e.r=c.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>c.e.c&&(N.e.c=c.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),l["!fullref"]=l["!ref"],l["!ref"]=fa(N))}return x.length>0&&(l["!cols"]=x),b.length>0&&(l["!merges"]=b),l}function KDe(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+fa(t[r])+'"/>';return e+"</mergeCells>"}function MR(t,e,r,n){var a=zn(t);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Ua(Cs(a.codeName)))}function qDe(t,e,r,n,a){MR(t.slice(0,t.indexOf(">")),r,n,a)}function zDe(t,e,r,n,a){var s=!1,o={},l=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[r];try{e.Workbook&&(c=e.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,o.codeName=nh(gs(c))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),l=(l||"")+Yr("outlinePr",null,d)}!s&&!l||(a[a.length]=Yr("sheetPr",l,o))}var WDe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],XDe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function YDe(t){var e={sheet:1};return WDe.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),XDe.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=TR(t.password).toString(16).toUpperCase()),Yr("sheetProtection",null,e)}function JDe(t,e,r){for(var n=Array.isArray(t),a=0;a!=e.length;++a){var s=zn(Cs(e[a]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+Ua(s.location))):(s.Target="#"+Ua(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=Qa(s.ref),c=l.s.r;c<=l.e.r;++c)for(var d=l.s.c;d<=l.e.c;++d){var u=Kn({c:d,r:c});n?(t[c]||(t[c]=[]),t[c][d]||(t[c][d]={t:"z",v:void 0}),t[c][d].l=s):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=s)}}}function ZDe(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function e6e(t){return Wp(t),Yr("pageMargins",null,t)}function t6e(t,e){for(var r=!1,n=0;n!=e.length;++n){var a=zn(e[n],!0);a.hidden&&(a.hidden=Ws(a.hidden));var s=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,BR(a.width)),Bm(a);s<=o;)t[s++]=ei(a)}}function r6e(t,e){for(var r=["<cols>"],n,a=0;a!=e.length;++a)(n=e[a])&&(r[r.length]=Yr("col",null,NP(a,n)));return r[r.length]="</cols>",r.join("")}function n6e(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function a6e(t,e,r,n){var a=typeof t.ref=="string"?t.ref:fa(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=md(a);o.s.r==o.e.r&&(o.e.r=md(e["!ref"]).e.r,a=fa(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Yr("autoFilter",null,{ref:a})}var s6e=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function i6e(t,e){e.Views||(e.Views=[{}]),(t.match(s6e)||[]).forEach(function(r,n){var a=zn(r);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),Ws(a.rightToLeft)&&(e.Views[n].RTL=!0)})}function o6e(t,e,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Yr("sheetViews",Yr("sheetView",null,a),{})}function l6e(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",s=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=VA[t.v];break;case"d":n&&n.cellDates?a=Zs(t.v,-1).toISOString():(t=ei(t),t.t="n",a=""+(t.v=qo(Zs(t.v)))),typeof t.z>"u"&&(t.z=Gn[14]);break;default:a=t.v;break}var l=Ul("v",gs(a)),c={r:e},d=qm(n.cellXfs,t,n);switch(d!==0&&(c.s=d),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=Ul("v",""+RR(n.Strings,t.v,n.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=s&&(t.t=s,t.v=o),typeof t.f=="string"&&t.f){var u=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;l=Yr("f",gs(t.f),u)+(t.v!=null?l:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(c.cm=1),Yr("c",l,c)}var c6e=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=L2("v"),o=L2("f");return function(c,d,u,f,A,h){for(var m=0,p="",x=[],v=[],y=0,b=0,w=0,I="",j,N,S=0,E=0,B,k,T=0,P=0,q=Array.isArray(h.CellXf),de,ce=[],le=[],he=Array.isArray(d),ae=[],Ce={},De=!1,O=!!u.sheetStubs,R=c.split(e),G=0,M=R.length;G!=M;++G){p=R[G].trim();var K=p.length;if(K!==0){var Y=0;e:for(m=0;m<K;++m)switch(p[m]){case">":if(p[m-1]!="/"){++m;break e}if(u&&u.cellStyles){if(N=zn(p.slice(Y,m),!0),S=N.r!=null?parseInt(N.r,10):S+1,E=-1,u.sheetRows&&u.sheetRows<S)continue;Ce={},De=!1,N.ht&&(De=!0,Ce.hpt=parseFloat(N.ht),Ce.hpx=Kv(Ce.hpt)),N.hidden=="1"&&(De=!0,Ce.hidden=!0),N.outlineLevel!=null&&(De=!0,Ce.level=+N.outlineLevel),De&&(ae[S-1]=Ce)}break;case"<":Y=m;break}if(Y>=m)break;if(N=zn(p.slice(Y,m),!0),S=N.r!=null?parseInt(N.r,10):S+1,E=-1,!(u.sheetRows&&u.sheetRows<S)){f.s.r>S-1&&(f.s.r=S-1),f.e.r<S-1&&(f.e.r=S-1),u&&u.cellStyles&&(Ce={},De=!1,N.ht&&(De=!0,Ce.hpt=parseFloat(N.ht),Ce.hpx=Kv(Ce.hpt)),N.hidden=="1"&&(De=!0,Ce.hidden=!0),N.outlineLevel!=null&&(De=!0,Ce.level=+N.outlineLevel),De&&(ae[S-1]=Ce)),x=p.slice(m).split(t);for(var D=0;D!=x.length&&x[D].trim().charAt(0)=="<";++D);for(x=x.slice(D),m=0;m!=x.length;++m)if(p=x[m].trim(),p.length!==0){if(v=p.match(r),y=m,b=0,w=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,v!=null&&v.length===2){for(y=0,I=v[1],b=0;b!=I.length&&!((w=I.charCodeAt(b)-64)<1||w>26);++b)y=26*y+w;--y,E=y}else++E;for(b=0;b!=p.length&&p.charCodeAt(b)!==62;++b);if(++b,N=zn(p.slice(0,b),!0),N.r||(N.r=Kn({r:S-1,c:E})),I=p.slice(b),j={t:""},(v=I.match(s))!=null&&v[1]!==""&&(j.v=Ua(v[1])),u.cellFormula){if((v=I.match(o))!=null&&v[1]!==""){if(j.f=Ua(Cs(v[1])).replace(/\r\n/g,`
`),u.xlfn||(j.f=m$(j.f)),v[0].indexOf('t="array"')>-1)j.F=(I.match(a)||[])[1],j.F.indexOf(":")>-1&&ce.push([Qa(j.F),j.F]);else if(v[0].indexOf('t="shared"')>-1){k=zn(v[0]);var V=Ua(Cs(v[1]));u.xlfn||(V=m$(V)),le[parseInt(k.si,10)]=[k,V,N.r]}}else(v=I.match(/<f[^>]*\/>/))&&(k=zn(v[0]),le[k.si]&&(j.f=sOe(le[k.si][1],le[k.si][2],N.r)));var te=Ei(N.r);for(b=0;b<ce.length;++b)te.r>=ce[b][0].s.r&&te.r<=ce[b][0].e.r&&te.c>=ce[b][0].s.c&&te.c<=ce[b][0].e.c&&(j.F=ce[b][1])}if(N.t==null&&j.v===void 0)if(j.f||j.F)j.v=0,j.t="n";else if(O)j.t="z";else continue;else j.t=N.t||"n";switch(f.s.c>E&&(f.s.c=E),f.e.c<E&&(f.e.c=E),j.t){case"n":if(j.v==""||j.v==null){if(!O)continue;j.t="z"}else j.v=parseFloat(j.v);break;case"s":if(typeof j.v>"u"){if(!O)continue;j.t="z"}else B=Hb[parseInt(j.v,10)],j.v=B.t,j.r=B.r,u.cellHTML&&(j.h=B.h);break;case"str":j.t="s",j.v=j.v!=null?Cs(j.v):"",u.cellHTML&&(j.h=pR(j.v));break;case"inlineStr":v=I.match(n),j.t="s",v!=null&&(B=PR(v[1]))?(j.v=B.t,u.cellHTML&&(j.h=B.h)):j.v="";break;case"b":j.v=Ws(j.v);break;case"d":u.cellDates?j.v=Zs(j.v,1):(j.v=qo(Zs(j.v,1)),j.t="n");break;case"e":(!u||u.cellText!==!1)&&(j.w=j.v),j.v=uae[j.v];break}if(T=P=0,de=null,q&&N.s!==void 0&&(de=h.CellXf[N.s],de!=null&&(de.numFmtId!=null&&(T=de.numFmtId),u.cellStyles&&de.fillId!=null&&(P=de.fillId))),lse(j,T,P,u,A,h),u.cellDates&&q&&j.t=="n"&&_1(Gn[T])&&(j.t="d",j.v=vP(j.v)),N.cm&&u.xlmeta){var ve=(u.xlmeta.Cell||[])[+N.cm-1];ve&&ve.type=="XLDAPR"&&(j.D=!0)}if(he){var Q=Ei(N.r);d[Q.r]||(d[Q.r]=[]),d[Q.r][Q.c]=j}else d[N.r]=j}}}}ae.length>0&&(d["!rows"]=ae)}}();function d6e(t,e,r,n){var a=[],s=[],o=Qa(t["!ref"]),l="",c,d="",u=[],f=0,A=0,h=t["!rows"],m=Array.isArray(t),p={r:d},x,v=-1;for(A=o.s.c;A<=o.e.c;++A)u[A]=_i(A);for(f=o.s.r;f<=o.e.r;++f){for(s=[],d=uo(f),A=o.s.c;A<=o.e.c;++A){c=u[A]+d;var y=m?(t[f]||[])[A]:t[c];y!==void 0&&(l=l6e(y,c,t,e))!=null&&s.push(l)}(s.length>0||h&&h[f])&&(p={r:d},h&&h[f]&&(x=h[f],x.hidden&&(p.hidden=1),v=-1,x.hpx?v=K2(x.hpx):x.hpt&&(v=x.hpt),v>-1&&(p.ht=v,p.customHeight=1),x.level&&(p.outlineLevel=x.level)),a[a.length]=Yr("row",s.join(""),p))}if(h)for(;f<h.length;++f)h&&h[f]&&(p={r:f+1},x=h[f],x.hidden&&(p.hidden=1),v=-1,x.hpx?v=K2(x.hpx):x.hpt&&(v=x.hpt),v>-1&&(p.ht=v,p.customHeight=1),x.level&&(p.outlineLevel=x.level),a[a.length]=Yr("row","",p));return a.join("")}function dse(t,e,r,n){var a=[ho,Yr("worksheet",null,{xmlns:Vg[0],"xmlns:r":Vo.r})],s=r.SheetNames[t],o=0,l="",c=r.Sheets[s];c==null&&(c={});var d=c["!ref"]||"A1",u=Qa(d);if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),d=fa(u)}n||(n={}),c["!comments"]=[];var f=[];zDe(c,r,t,e,a),a[a.length]=Yr("dimension",null,{ref:d}),a[a.length]=o6e(c,e,t,r),e.sheetFormat&&(a[a.length]=Yr("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=r6e(c,c["!cols"])),a[o=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=d6e(c,e),l.length>0&&(a[a.length]=l)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),c["!protect"]&&(a[a.length]=YDe(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=a6e(c["!autofilter"],c,r,t)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=KDe(c["!merges"]));var A=-1,h,m=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(m=hs(n,-1,gs(p[1].Target).replace(/#.*$/,""),wa.HLINK),h["r:id"]="rId"+m),(A=p[1].Target.indexOf("#"))>-1&&(h.location=gs(p[1].Target.slice(A+1))),p[1].Tooltip&&(h.tooltip=gs(p[1].Tooltip)),a[a.length]=Yr("hyperlink",null,h))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=e6e(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=Ul("ignoredErrors",Yr("ignoredError",null,{numberStoredAsText:1,sqref:d}))),f.length>0&&(m=hs(n,-1,"../drawings/drawing"+(t+1)+".xml",wa.DRAW),a[a.length]=Yr("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=f),c["!comments"].length>0&&(m=hs(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",wa.VML),a[a.length]=Yr("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function u6e(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function f6e(t,e,r){var n=mr(145),a=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;a.hpx?s=K2(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var d={r:t,c:0},u=0;u<16;++u)if(!(e.s.c>u+1<<10||e.e.c<u<<10)){for(var f=-1,A=-1,h=u<<10;h<u+1<<10;++h){d.c=h;var m=Array.isArray(r)?(r[d.r]||[])[d.c]:r[Kn(d)];m&&(f<0&&(f=h),A=h)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,A))}var p=n.l;return n.l=c,n.write_shift(4,l),n.l=p,n.length>n.l?n.slice(0,n.l):n}function h6e(t,e,r,n){var a=f6e(n,r,e);(a.length>17||(e["!rows"]||[])[n])&&Tr(t,0,a)}var A6e=Kg,m6e=j1;function p6e(){}function g6e(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=y5e(t),r}function x6e(t,e,r){r==null&&(r=mr(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return ej({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),iae(t,r),r.slice(0,r.l)}function v6e(t){var e=Ku(t);return[e]}function y6e(t,e,r){return r==null&&(r=mr(8)),Hg(e,r)}function b6e(t){var e=$g(t);return[e]}function w6e(t,e,r){return r==null&&(r=mr(4)),Gg(e,r)}function N6e(t){var e=Ku(t),r=t.read_shift(1);return[e,r,"b"]}function C6e(t,e,r){return r==null&&(r=mr(9)),Hg(e,r),r.write_shift(1,t.v?1:0),r}function _6e(t){var e=$g(t),r=t.read_shift(1);return[e,r,"b"]}function E6e(t,e,r){return r==null&&(r=mr(5)),Gg(e,r),r.write_shift(1,t.v?1:0),r}function S6e(t){var e=Ku(t),r=t.read_shift(1);return[e,r,"e"]}function j6e(t,e,r){return r==null&&(r=mr(9)),Hg(e,r),r.write_shift(1,t.v),r}function I6e(t){var e=$g(t),r=t.read_shift(1);return[e,r,"e"]}function P6e(t,e,r){return r==null&&(r=mr(8)),Gg(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function T6e(t){var e=Ku(t),r=t.read_shift(4);return[e,r,"s"]}function B6e(t,e,r){return r==null&&(r=mr(12)),Hg(e,r),r.write_shift(4,e.v),r}function k6e(t){var e=$g(t),r=t.read_shift(4);return[e,r,"s"]}function F6e(t,e,r){return r==null&&(r=mr(8)),Gg(e,r),r.write_shift(4,e.v),r}function O6e(t){var e=Ku(t),r=Ac(t);return[e,r,"n"]}function D6e(t,e,r){return r==null&&(r=mr(16)),Hg(e,r),yg(t.v,r),r}function use(t){var e=$g(t),r=Ac(t);return[e,r,"n"]}function R6e(t,e,r){return r==null&&(r=mr(12)),Gg(e,r),yg(t.v,r),r}function M6e(t){var e=Ku(t),r=_R(t);return[e,r,"n"]}function L6e(t,e,r){return r==null&&(r=mr(12)),Hg(e,r),oae(t.v,r),r}function U6e(t){var e=$g(t),r=_R(t);return[e,r,"n"]}function Q6e(t,e,r){return r==null&&(r=mr(8)),Gg(e,r),oae(t.v,r),r}function V6e(t){var e=Ku(t),r=wR(t);return[e,r,"is"]}function H6e(t){var e=Ku(t),r=pc(t);return[e,r,"str"]}function $6e(t,e,r){return r==null&&(r=mr(12+4*t.v.length)),Hg(e,r),hl(t.v,r),r.length>r.l?r.slice(0,r.l):r}function G6e(t){var e=$g(t),r=pc(t);return[e,r,"str"]}function K6e(t,e,r){return r==null&&(r=mr(8+4*t.v.length)),Gg(e,r),hl(t.v,r),r.length>r.l?r.slice(0,r.l):r}function q6e(t,e,r){var n=t.l+e,a=Ku(t);a.r=r["!row"];var s=t.read_shift(1),o=[a,s,"b"];if(r.cellFormula){t.l+=2;var l=wP(t,n-t.l,r);o[3]=uc(l,null,a,r.supbooks,r)}else t.l=n;return o}function z6e(t,e,r){var n=t.l+e,a=Ku(t);a.r=r["!row"];var s=t.read_shift(1),o=[a,s,"e"];if(r.cellFormula){t.l+=2;var l=wP(t,n-t.l,r);o[3]=uc(l,null,a,r.supbooks,r)}else t.l=n;return o}function W6e(t,e,r){var n=t.l+e,a=Ku(t);a.r=r["!row"];var s=Ac(t),o=[a,s,"n"];if(r.cellFormula){t.l+=2;var l=wP(t,n-t.l,r);o[3]=uc(l,null,a,r.supbooks,r)}else t.l=n;return o}function X6e(t,e,r){var n=t.l+e,a=Ku(t);a.r=r["!row"];var s=pc(t),o=[a,s,"str"];if(r.cellFormula){t.l+=2;var l=wP(t,n-t.l,r);o[3]=uc(l,null,a,r.supbooks,r)}else t.l=n;return o}var Y6e=Kg,J6e=j1;function Z6e(t,e){return e==null&&(e=mr(4)),e.write_shift(4,t),e}function eRe(t,e){var r=t.l+e,n=Kg(t),a=NR(t),s=pc(t),o=pc(t),l=pc(t);t.l=r;var c={rfx:n,relId:a,loc:s,display:l};return o&&(c.Tooltip=o),c}function tRe(t,e){var r=mr(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));j1({s:Ei(t[0]),e:Ei(t[0])},r),CR("rId"+e,r);var n=t[1].Target.indexOf("#"),a=n==-1?"":t[1].Target.slice(n+1);return hl(a||"",r),hl(t[1].Tooltip||"",r),hl("",r),r.slice(0,r.l)}function rRe(){}function nRe(t,e,r){var n=t.l+e,a=lae(t),s=t.read_shift(1),o=[a];if(o[2]=s,r.cellFormula){var l=SDe(t,n-t.l,r);o[1]=l}else t.l=n;return o}function aRe(t,e,r){var n=t.l+e,a=Kg(t),s=[a];if(r.cellFormula){var o=IDe(t,n-t.l,r);s[1]=o,t.l=n}else t.l=n;return s}function sRe(t,e,r){r==null&&(r=mr(18));var n=NP(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),r.write_shift(2,a),r}var fse=["left","right","top","bottom","header","footer"];function iRe(t){var e={};return fse.forEach(function(r){e[r]=Ac(t)}),e}function oRe(t,e){return e==null&&(e=mr(6*8)),Wp(t),fse.forEach(function(r){yg(t[r],e)}),e}function lRe(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function cRe(t,e,r){r==null&&(r=mr(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function dRe(t){var e=mr(24);return e.write_shift(4,4),e.write_shift(4,1),j1(t,e),e}function uRe(t,e){return e==null&&(e=mr(16*4+2)),e.write_shift(2,t.password?TR(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function fRe(){}function hRe(){}function ARe(t,e,r,n,a,s,o){if(!t)return t;var l=e||{};n||(n={"!id":{}});var c=l.dense?[]:{},d,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,A=!1,h,m,p,x,v,y,b,w,I,j=[];l.biff=12,l["!row"]=0;var N=0,S=!1,E=[],B={},k=l.supbooks||a.supbooks||[[]];if(k.sharedf=B,k.arrayf=E,k.SheetNames=a.SheetNames||a.Sheets.map(function(he){return he.name}),!l.supbooks&&(l.supbooks=k,a.Names))for(var T=0;T<a.Names.length;++T)k[0][T+1]=a.Names[T];var P=[],q=[],de=!1;q2[16]={n:"BrtShortReal",f:use};var ce;if(QA(t,function(ae,Ce,De){if(!A)switch(De){case 148:d=ae;break;case 0:h=ae,l.sheetRows&&l.sheetRows<=h.r&&(A=!0),w=uo(x=h.r),l["!row"]=h.r,(ae.hidden||ae.hpt||ae.level!=null)&&(ae.hpt&&(ae.hpx=Kv(ae.hpt)),q[ae.r]=ae);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:ae[2]},ae[2]){case"n":m.v=ae[1];break;case"s":b=Hb[ae[1]],m.v=b.t,m.r=b.r;break;case"b":m.v=!!ae[1];break;case"e":m.v=ae[1],l.cellText!==!1&&(m.w=VA[m.v]);break;case"str":m.t="s",m.v=ae[1];break;case"is":m.t="s",m.v=ae[1].t;break}if((p=o.CellXf[ae[0].iStyleRef])&&lse(m,p.numFmtId,null,l,s,o),v=ae[0].c==-1?v+1:ae[0].c,l.dense?(c[x]||(c[x]=[]),c[x][v]=m):c[_i(v)+w]=m,l.cellFormula){for(S=!1,N=0;N<E.length;++N){var O=E[N];h.r>=O[0].s.r&&h.r<=O[0].e.r&&v>=O[0].s.c&&v<=O[0].e.c&&(m.F=fa(O[0]),S=!0)}!S&&ae.length>3&&(m.f=ae[3])}if(u.s.r>h.r&&(u.s.r=h.r),u.s.c>v&&(u.s.c=v),u.e.r<h.r&&(u.e.r=h.r),u.e.c<v&&(u.e.c=v),l.cellDates&&p&&m.t=="n"&&_1(Gn[p.numFmtId])){var R=Bp(m.v);R&&(m.t="d",m.v=new Date(R.y,R.m-1,R.d,R.H,R.M,R.S,R.u))}ce&&(ce.type=="XLDAPR"&&(m.D=!0),ce=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;m={t:"z",v:void 0},v=ae[0].c==-1?v+1:ae[0].c,l.dense?(c[x]||(c[x]=[]),c[x][v]=m):c[_i(v)+w]=m,u.s.r>h.r&&(u.s.r=h.r),u.s.c>v&&(u.s.c=v),u.e.r<h.r&&(u.e.r=h.r),u.e.c<v&&(u.e.c=v),ce&&(ce.type=="XLDAPR"&&(m.D=!0),ce=void 0);break;case 176:j.push(ae);break;case 49:ce=((l.xlmeta||{}).Cell||[])[ae-1];break;case 494:var G=n["!id"][ae.relId];for(G?(ae.Target=G.Target,ae.loc&&(ae.Target+="#"+ae.loc),ae.Rel=G):ae.relId==""&&(ae.Target="#"+ae.loc),x=ae.rfx.s.r;x<=ae.rfx.e.r;++x)for(v=ae.rfx.s.c;v<=ae.rfx.e.c;++v)l.dense?(c[x]||(c[x]=[]),c[x][v]||(c[x][v]={t:"z",v:void 0}),c[x][v].l=ae):(y=Kn({c:v,r:x}),c[y]||(c[y]={t:"z",v:void 0}),c[y].l=ae);break;case 426:if(!l.cellFormula)break;E.push(ae),I=l.dense?c[x][v]:c[_i(v)+w],I.f=uc(ae[1],u,{r:h.r,c:v},k,l),I.F=fa(ae[0]);break;case 427:if(!l.cellFormula)break;B[Kn(ae[0].s)]=ae[1],I=l.dense?c[x][v]:c[_i(v)+w],I.f=uc(ae[1],u,{r:h.r,c:v},k,l);break;case 60:if(!l.cellStyles)break;for(;ae.e>=ae.s;)P[ae.e--]={width:ae.w/256,hidden:!!(ae.flags&1),level:ae.level},de||(de=!0,BR(ae.w/256)),Bm(P[ae.e+1]);break;case 161:c["!autofilter"]={ref:fa(ae)};break;case 476:c["!margins"]=ae;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),ae.name&&(a.Sheets[r].CodeName=ae.name),(ae.above||ae.left)&&(c["!outline"]={above:ae.above,left:ae.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ae.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!Ce.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+De.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(u.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=fa(d||u)),l.sheetRows&&c["!ref"]){var le=Qa(c["!ref"]);l.sheetRows<=+le.e.r&&(le.e.r=l.sheetRows-1,le.e.r>u.e.r&&(le.e.r=u.e.r),le.e.r<le.s.r&&(le.s.r=le.e.r),le.e.c>u.e.c&&(le.e.c=u.e.c),le.e.c<le.s.c&&(le.s.c=le.e.c),c["!fullref"]=c["!ref"],c["!ref"]=fa(le))}return j.length>0&&(c["!merges"]=j),P.length>0&&(c["!cols"]=P),q.length>0&&(c["!rows"]=q),c}function mRe(t,e,r,n,a,s,o){if(e.v===void 0)return!1;var l="";switch(e.t){case"b":l=e.v?"1":"0";break;case"d":e=ei(e),e.z=e.z||Gn[14],e.v=qo(Zs(e.v)),e.t="n";break;case"n":case"e":l=""+e.v;break;default:l=e.v;break}var c={r,c:n};switch(c.s=qm(a.cellXfs,e,a),e.l&&s["!links"].push([Kn(c),e.l]),e.c&&s["!comments"].push([Kn(c),e.c]),e.t){case"s":case"str":return a.bookSST?(l=RR(a.Strings,e.v,a.revStrings),c.t="s",c.v=l,o?Tr(t,18,F6e(e,c)):Tr(t,7,B6e(e,c))):(c.t="str",o?Tr(t,17,K6e(e,c)):Tr(t,6,$6e(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?Tr(t,13,Q6e(e,c)):Tr(t,2,L6e(e,c)):o?Tr(t,16,R6e(e,c)):Tr(t,5,D6e(e,c)),!0;case"b":return c.t="b",o?Tr(t,15,E6e(e,c)):Tr(t,4,C6e(e,c)),!0;case"e":return c.t="e",o?Tr(t,14,P6e(e,c)):Tr(t,3,j6e(e,c)),!0}return o?Tr(t,12,w6e(e,c)):Tr(t,1,y6e(e,c)),!0}function pRe(t,e,r,n){var a=Qa(e["!ref"]||"A1"),s,o="",l=[];Tr(t,145);var c=Array.isArray(e),d=a.e.r;e["!rows"]&&(d=Math.max(a.e.r,e["!rows"].length-1));for(var u=a.s.r;u<=d;++u){o=uo(u),h6e(t,e,a,u);var f=!1;if(u<=a.e.r)for(var A=a.s.c;A<=a.e.c;++A){u===a.s.r&&(l[A]=_i(A)),s=l[A]+o;var h=c?(e[u]||[])[A]:e[s];if(!h){f=!1;continue}f=mRe(t,h,u,A,n,e,f)}}Tr(t,146)}function gRe(t,e){!e||!e["!merges"]||(Tr(t,177,Z6e(e["!merges"].length)),e["!merges"].forEach(function(r){Tr(t,176,J6e(r))}),Tr(t,178))}function xRe(t,e){!e||!e["!cols"]||(Tr(t,390),e["!cols"].forEach(function(r,n){r&&Tr(t,60,sRe(n,r))}),Tr(t,391))}function vRe(t,e){!e||!e["!ref"]||(Tr(t,648),Tr(t,649,dRe(Qa(e["!ref"]))),Tr(t,650))}function yRe(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var a=hs(r,-1,n[1].Target.replace(/#.*$/,""),wa.HLINK);Tr(t,494,tRe(n,a))}}),delete e["!links"]}function bRe(t,e,r,n){if(e["!comments"].length>0){var a=hs(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",wa.VML);Tr(t,551,CR("rId"+a)),e["!legacy"]=a}}function wRe(t,e,r,n){if(e["!autofilter"]){var a=e["!autofilter"],s=typeof a.ref=="string"?a.ref:fa(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=md(s);l.s.r==l.e.r&&(l.e.r=md(e["!ref"]).e.r,s=fa(l));for(var c=0;c<o.length;++c){var d=o[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Tr(t,161,j1(Qa(s))),Tr(t,162)}}function NRe(t,e,r){Tr(t,133),Tr(t,137,cRe(e,r)),Tr(t,138),Tr(t,134)}function CRe(t,e){e["!protect"]&&Tr(t,535,uRe(e["!protect"]))}function _Re(t,e,r,n){var a=Ad(),s=r.SheetNames[t],o=r.Sheets[s]||{},l=s;try{r&&r.Workbook&&(l=r.Workbook.Sheets[t].CodeName||l)}catch{}var c=Qa(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Tr(a,129),(r.vbaraw||o["!outline"])&&Tr(a,147,x6e(l,o["!outline"])),Tr(a,148,m6e(c)),NRe(a,o,r.Workbook),xRe(a,o),pRe(a,o,t,e),CRe(a,o),wRe(a,o,r,t),gRe(a,o),yRe(a,o,n),o["!margins"]&&Tr(a,476,oRe(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&vRe(a,o),bRe(a,o,t,n),Tr(a,130),a.end()}function ERe(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var a=Ua((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,a,n]}function SRe(t,e,r,n,a,s){var o=s||{"!type":"chart"};if(!t)return s;var l=0,c=0,d="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var A=ERe(f);u.s.r=u.s.c=0,u.e.c=l,d=_i(l),A[0].forEach(function(h,m){o[d+uo(m)]={t:"n",v:h,z:A[1]},c=m}),u.e.r<c&&(u.e.r=c),++l}),l>0&&(o["!ref"]=fa(u)),o}function jRe(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,l=t.match(cse);return l&&MR(l[0],s,a,r),(o=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function IRe(t,e){t.l+=10;var r=pc(t);return{name:r}}function PRe(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return QA(t,function(c,d,u){switch(u){case 550:s["!rel"]=c;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),c.name&&(a.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var LR=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],TRe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],BRe=[],kRe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function y$(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],a=0;a!=e.length;++a){var s=e[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Ws(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function b$(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Ws(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function hse(t){b$(t.WBProps,LR),b$(t.CalcPr,kRe),y$(t.WBView,TRe),y$(t.Sheets,BRe),wv.date1904=Ws(t.WBProps.date1904)}function FRe(t){return!t.Workbook||!t.Workbook.WBProps?"false":Ws(t.Workbook.WBProps.date1904)?"true":"false"}var ORe="][*?/\\".split("");function Ase(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return ORe.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function DRe(t,e,r){t.forEach(function(n,a){Ase(n);for(var s=0;s<a;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[a]&&e[a].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function RRe(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];DRe(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)FDe(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var MRe=/<\w+:workbook/;function LRe(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},o=0;if(t.replace(wc,function(c,d){var u=zn(c);switch(bh(u[0])){case"<?xml":break;case"<workbook":c.match(MRe)&&(a="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=u[a];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":LR.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Ws(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=Cs(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Ua(Cs(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Cs(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),Ws(u.hidden||"0")&&(s.Hidden=!0),o=d+c.length;break;case"</definedName>":s.Ref=Ua(Cs(t.slice(o,d))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),Vg.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return hse(r),r}function mse(t){var e=[ho];e[e.length]=Yr("workbook",null,{xmlns:Vg[0],"xmlns:r":Vo.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(LR.forEach(function(l){t.Workbook.WBProps[l[0]]!=null&&t.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=t.Workbook.WBProps[l[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Yr("workbookPr",null,n);var a=t.Workbook&&t.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var o={name:gs(t.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=Yr("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(e[e.length]=Yr("definedName",gs(l.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function URe(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=sF(t),r.name=pc(t),r}function QRe(t,e){return e||(e=mr(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),CR(t.strRelID,e),hl(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function VRe(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var a=e>8?pc(t):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function HRe(t,e){e||(e=mr(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),iae(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function $Re(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function GRe(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),s=b5e(t),o=jDe(t,0,r),l=NR(t);t.l=n;var c={Name:s,Ptg:o};return a<268435455&&(c.Sheet=a),l&&(c.Comment=l),c}function KRe(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],q2[16]={n:"BrtFRTArchID$",f:$Re},QA(t,function(c,d,u){switch(u){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=uc(c.Ptg,null,null,o,e),delete e.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,c]):o[0]=[u,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),hse(r),r.Names=s,r.supbooks=o,r}function qRe(t,e){Tr(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Tr(t,156,QRe(a))}Tr(t,144)}function zRe(t,e){e||(e=mr(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return hl("SheetJS",e),hl(qS.version,e),hl(qS.version,e),hl("7262",e),e.length>e.l?e.slice(0,e.l):e}function WRe(t,e){e||(e=mr(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function XRe(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(Tr(t,135),Tr(t,158,WRe(a)),Tr(t,136))}}function YRe(t,e){var r=Ad();return Tr(r,131),Tr(r,128,zRe()),Tr(r,153,HRe(t.Workbook&&t.Workbook.WBProps||null)),XRe(r,t),qRe(r,t),Tr(r,132),r.end()}function JRe(t,e,r){return e.slice(-4)===".bin"?KRe(t,r):LRe(t,r)}function ZRe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?ARe(t,n,r,a,s,o,l):GDe(t,n,r,a,s,o,l)}function eMe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?PRe(t,n,r,a,s):jRe(t,n,r,a,s)}function tMe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?nOe():aOe()}function rMe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?tOe():rOe()}function nMe(t,e,r,n){return e.slice(-4)===".bin"?Jke(t,r,n):Uke(t,r,n)}function aMe(t,e,r){return Wae(t,r)}function sMe(t,e,r){return e.slice(-4)===".bin"?ske(t,r):rke(t,r)}function iMe(t,e,r){return e.slice(-4)===".bin"?XFe(t,r):QFe(t,r)}function oMe(t,e,r){return e.slice(-4)===".bin"?MFe(t):DFe(t)}function lMe(t,e,r,n){return r.slice(-4)===".bin"?LFe(t,e,r,n):void 0}function cMe(t,e,r){return e.slice(-4)===".bin"?kFe(t,e,r):OFe(t,e,r)}function dMe(t,e,r){return(e.slice(-4)===".bin"?YRe:mse)(t)}function uMe(t,e,r,n,a){return(e.slice(-4)===".bin"?_Re:dse)(t,r,n,a)}function fMe(t,e,r){return(e.slice(-4)===".bin"?lFe:qae)(t,r)}function hMe(t,e,r){return(e.slice(-4)===".bin"?lke:Lae)(t,r)}function AMe(t,e,r){return(e.slice(-4)===".bin"?YFe:Jae)(t)}function mMe(t){return(t.slice(-4)===".bin"?FFe:Xae)()}var pse=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,gse=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function rf(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=t.match(pse),s,o,l,c;if(a)for(c=0;c!=a.length;++c)s=a[c].match(gse),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(o+1),n[l]=s[2].slice(1,s[2].length-1));return n}function pMe(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(pse),a,s,o,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(gse),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),r[o]=a[2].slice(1,a[2].length-1));return r}var Gb;function gMe(t,e){var r=Gb[t]||Ua(t);return r==="General"?xg(e):Uu(r,e)}function xMe(t,e,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Ws(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Zs(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Ua(e)]=a}function vMe(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||VA[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=M2(t.v):t.w=xg(t.v):t.w=gMe(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=Gb[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&_1(n)){var a=Bp(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function yMe(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=Bke[n.Pattern]||n.Pattern)}t[e.ID]=e}function bMe(t,e,r,n,a,s,o,l,c,d){var u="General",f=n.StyleID,A={};d=d||{};var h=[],m=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);s[f]!==void 0&&(s[f].nf&&(u=s[f].nf),s[f].Interior&&h.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Ws(t);break;case"String":n.t="s",n.r=MH(Ua(t)),n.v=t.indexOf("<")>-1?Ua(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Zs(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ua(t):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=uae[t],d.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=MH(e||t));break}if(vMe(n,u,d),d.cellFormula!==!1)if(n.Formula){var p=Ua(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=bv(p,a),delete n.Formula,n.ArrayRange=="RC"?n.F=bv("RC:RC",a):n.ArrayRange&&(n.F=bv(n.ArrayRange,a),c.push([Qa(n.F),n.F]))}else for(m=0;m<c.length;++m)a.r>=c[m][0].s.r&&a.r<=c[m][0].e.r&&a.c>=c[m][0].s.c&&a.c<=c[m][0].e.c&&(n.F=c[m][1]);d.cellStyles&&(h.forEach(function(x){!A.patternType&&x.patternType&&(A.patternType=x.patternType)}),n.s=A),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function wMe(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function K5(t,e){var r=e||{};E1();var n=rb(gR(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Cs(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=ei(r);return o.type="string",Gv.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ee){a.indexOf("<"+Ee)>=0&&(s=!0)}),s)return o8e(n,r);Gb={"General Number":"General","General Date":Gn[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Gn[15],"Short Date":Gn[14],"Long Time":Gn[19],"Medium Time":Gn[18],"Short Time":Gn[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Gn[2],Standard:Gn[4],Percent:Gn[10],Scientific:Gn[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],d,u={},f=[],A=r.dense?[]:{},h="",m={},p={},x=rf('<Data ss:Type="String">'),v=0,y=0,b=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},I={},j={},N="",S=0,E=[],B={},k={},T=0,P=[],q=[],de={},ce=[],le,he=!1,ae=[],Ce=[],De={},O=0,R=0,G={Sheets:[],WBProps:{date1904:!1}},M={};Q2.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var K="";l=Q2.exec(n);)switch(l[3]=(K=l[3]).toLowerCase()){case"data":if(K=="data"){if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?bMe(n.slice(v,l.index),N,x,c[c.length-1][0]=="comment"?de:m,{c:y,r:b},I,ce[y],p,ae,r):(N="",x=rf(l[0]),v=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(q.length>0&&(m.c=q),(!r.sheetRows||r.sheetRows>b)&&m.v!==void 0&&(r.dense?(A[b]||(A[b]=[]),A[b][y]=m):A[_i(y)+uo(b)]=m),m.HRef&&(m.l={Target:Ua(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(O=y+(parseInt(m.MergeAcross,10)|0),R=b+(parseInt(m.MergeDown,10)|0),E.push({s:{c:y,r:b},e:{c:O,r:R}})),!r.sheetStubs)m.MergeAcross?y=O+1:++y;else if(m.MergeAcross||m.MergeDown){for(var Y=y;Y<=O;++Y)for(var D=b;D<=R;++D)(Y>y||D>b)&&(r.dense?(A[D]||(A[D]=[]),A[D][Y]={t:"z"}):A[_i(Y)+uo(D)]={t:"z"});y=O+1}else++y;else m=pMe(l[0]),m.Index&&(y=+m.Index-1),y<w.s.c&&(w.s.c=y),y>w.e.c&&(w.e.c=y),l[0].slice(-2)==="/>"&&++y,q=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(b<w.s.r&&(w.s.r=b),b>w.e.r&&(w.e.r=b),l[0].slice(-2)==="/>"&&(p=rf(l[0]),p.Index&&(b=+p.Index-1)),y=0,++b):(p=rf(l[0]),p.Index&&(b=+p.Index-1),De={},(p.AutoFitHeight=="0"||p.Height)&&(De.hpx=parseInt(p.Height,10),De.hpt=K2(De.hpx),Ce[b]=De),p.Hidden=="1"&&(De.hidden=!0,Ce[b]=De));break;case"worksheet":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));f.push(h),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(A["!ref"]=fa(w),r.sheetRows&&r.sheetRows<=w.e.r&&(A["!fullref"]=A["!ref"],w.e.r=r.sheetRows-1,A["!ref"]=fa(w))),E.length&&(A["!merges"]=E),ce.length>0&&(A["!cols"]=ce),Ce.length>0&&(A["!rows"]=Ce),u[h]=A}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=y=0,c.push([l[3],!1]),d=rf(l[0]),h=Ua(d.Name),A=r.dense?[]:{},E=[],ae=[],Ce=[],M={name:h,Hidden:0},G.Sheets.push(M);break;case"table":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),ce=[],he=!1}break;case"style":l[1]==="/"?yMe(I,j,r):j=rf(l[0]);break;case"numberformat":j.nf=Ua(rf(l[0]).Format||"General"),Gb[j.nf]&&(j.nf=Gb[j.nf]);for(var V=0;V!=392&&Gn[V]!=j.nf;++V);if(V==392){for(V=57;V!=392;++V)if(Gn[V]==null){fA(j.nf,V);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(le=rf(l[0]),le.Hidden&&(le.hidden=!0,delete le.Hidden),le.Width&&(le.wpx=parseInt(le.Width,10)),!he&&le.wpx>10){he=!0,hc=Gae;for(var te=0;te<ce.length;++te)ce[te]&&Bm(ce[te])}he&&Bm(le),ce[le.Index-1||ce.length]=le;for(var ve=0;ve<+le.Span;++ve)ce[ce.length]=ei(le);break;case"namedrange":if(l[1]==="/")break;G.Names||(G.Names=[]);var Q=zn(l[0]),Xe={Name:Q.Name,Ref:bv(Q.RefersTo.slice(1),{r:0,c:0})};G.Sheets.length>0&&(Xe.Sheet=G.Sheets.length-1),G.Names.push(Xe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?N+=n.slice(S,l.index):S=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;j.Interior=rf(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?K5e(B,K,n.slice(T,l.index)):T=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));wMe(de),q.push(de)}else c.push([l[3],!1]),d=rf(l[0]),de={a:d.Author};break;case"autofilter":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var se=rf(l[0]);A["!autofilter"]={ref:bv(se.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return E$(n,r);var Z=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Z=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Z=!1}break;case"excelworkbook":switch(l[3]){case"date1904":G.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Z=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Z=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(T,l.index)){case"SheetHidden":M.Hidden=1;break;case"SheetVeryHidden":M.Hidden=2;break}else T=l.index+l[0].length;break;case"header":A["!margins"]||Wp(A["!margins"]={},"xlml"),isNaN(+zn(l[0]).Margin)||(A["!margins"].header=+zn(l[0]).Margin);break;case"footer":A["!margins"]||Wp(A["!margins"]={},"xlml"),isNaN(+zn(l[0]).Margin)||(A["!margins"].footer=+zn(l[0]).Margin);break;case"pagemargins":var ke=zn(l[0]);A["!margins"]||Wp(A["!margins"]={},"xlml"),isNaN(+ke.Top)||(A["!margins"].top=+ke.Top),isNaN(+ke.Left)||(A["!margins"].left=+ke.Left),isNaN(+ke.Right)||(A["!margins"].right=+ke.Right),isNaN(+ke.Bottom)||(A["!margins"].bottom=+ke.Bottom);break;case"displayrighttoleft":G.Views||(G.Views=[]),G.Views[0]||(G.Views[0]={}),G.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":A["!outline"]||(A["!outline"]={}),A["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":A["!outline"]||(A["!outline"]={}),A["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Z=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Z=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Z=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Z=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Z=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Z=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Z=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Z=!1}break;case"smarttags":break;default:Z=!1;break}if(Z||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?xMe(k,K,P,n.slice(T,l.index)):(P=l,T=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var Se={};return!r.bookSheets&&!r.bookProps&&(Se.Sheets=u),Se.SheetNames=f,Se.Workbook=G,Se.SSF=ei(Gn),Se.Props=B,Se.Custprops=k,Se}function fF(t,e){switch(QR(e=e||{}),e.type||"base64"){case"base64":return K5(Wd(t),e);case"binary":case"buffer":case"file":return K5(t,e);case"array":return K5(Gm(t),e)}}function NMe(t,e){var r=[];return t.Props&&r.push(q5e(t.Props,e)),t.Custprops&&r.push(z5e(t.Props,t.Custprops)),r.join("")}function CMe(){return""}function _Me(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,a){var s=[];s.push(Yr("NumberFormat",null,{"ss:Format":gs(Gn[n.numFmtId])}));var o={"ss:ID":"s"+(21+a)};r.push(Yr("Style",s.join(""),o))}),Yr("Styles",r.join(""))}function xse(t){return Yr("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+OR(t.Ref,{r:0,c:0})})}function EMe(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var a=e[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(xse(a)))}return Yr("Names",r.join(""))}function SMe(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],o=0;o<a.length;++o){var l=a[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||s.push(xse(l)))}return s.join("")}function jMe(t,e,r,n){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(Yr("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(Yr("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(Yr("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Yr("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(Ul("ProtectContents","True")),t["!protect"].objects&&a.push(Ul("ProtectObjects","True")),t["!protect"].scenarios&&a.push(Ul("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(Ul("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(Ul("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":Yr("WorksheetOptions",a.join(""),{xmlns:Fd.x})}function IMe(t){return t.map(function(e){var r=X4e(e.t||""),n=Yr("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Yr("Comment",n,{"ss:Author":e.a})}).join("")}function PMe(t,e,r,n,a,s,o){if(!t||t.v==null&&t.f==null)return"";var l={};if(t.f&&(l["ss:Formula"]="="+gs(OR(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var c=Ei(t.F.slice(e.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(t.l&&t.l.Target&&(l["ss:HRef"]=gs(t.l.Target),t.l.Tooltip&&(l["x:HRefScreenTip"]=gs(t.l.Tooltip))),r["!merges"])for(var d=r["!merges"],u=0;u!=d.length;++u)d[u].s.c!=o.c||d[u].s.r!=o.r||(d[u].e.c>d[u].s.c&&(l["ss:MergeAcross"]=d[u].e.c-d[u].s.c),d[u].e.r>d[u].s.r&&(l["ss:MergeDown"]=d[u].e.r-d[u].s.r));var f="",A="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",A=String(t.v);break;case"b":f="Boolean",A=t.v?"1":"0";break;case"e":f="Error",A=VA[t.v];break;case"d":f="DateTime",A=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Gn[14]);break;case"s":f="String",A=W4e(t.v||"");break}var h=qm(n.cellXfs,t,n);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=o.c+1;var m=t.v!=null?A:"",p=t.t=="z"?"":'<Data ss:Type="'+f+'">'+m+"</Data>";return(t.c||[]).length>0&&(p+=IMe(t.c)),Yr("Cell",p,l)}function TMe(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Kv(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function BMe(t,e,r,n){if(!t["!ref"])return"";var a=Qa(t["!ref"]),s=t["!merges"]||[],o=0,l=[];t["!cols"]&&t["!cols"].forEach(function(x,v){Bm(x);var y=!!x.width,b=NP(v,x),w={"ss:Index":v+1};y&&(w["ss:Width"]=$2(b.width)),x.hidden&&(w["ss:Hidden"]="1"),l.push(Yr("Column",null,w))});for(var c=Array.isArray(t),d=a.s.r;d<=a.e.r;++d){for(var u=[TMe(d,(t["!rows"]||[])[d])],f=a.s.c;f<=a.e.c;++f){var A=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>f)&&!(s[o].s.r>d)&&!(s[o].e.c<f)&&!(s[o].e.r<d)){(s[o].s.c!=f||s[o].s.r!=d)&&(A=!0);break}if(!A){var h={r:d,c:f},m=Kn(h),p=c?(t[d]||[])[f]:t[m];u.push(PMe(p,m,t,e,r,n,h))}}u.push("</Row>"),u.length>2&&l.push(u.join(""))}return l.join("")}function kMe(t,e,r){var n=[],a=r.SheetNames[t],s=r.Sheets[a],o=s?SMe(s,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?BMe(s,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(jMe(s,e,t,r)),n.join("")}function FMe(t,e){e||(e={}),t.SSF||(t.SSF=ei(Gn)),t.SSF&&(E1(),pP(t.SSF),e.revssf=xP(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],qm(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(NMe(t,e)),r.push(CMe()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Yr("Worksheet",kMe(n,e,t),{"ss:Name":gs(t.SheetNames[n])}));return r[2]=_Me(t,e),r[3]=EMe(t),ho+Yr("Workbook",r.join(""),{xmlns:Fd.ss,"xmlns:o":Fd.o,"xmlns:x":Fd.x,"xmlns:ss":Fd.ss,"xmlns:dt":Fd.dt,"xmlns:html":Fd.html})}function OMe(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=E5e(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=S5e(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var DMe=[60,1084,2066,2165,2175];function RMe(t,e,r,n,a){var s=n,o=[],l=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}o.push(l),r.l+=s;for(var c=tA(r,r.l),d=hF[c],u=0;d!=null&&DMe.indexOf(c)>-1;)s=tA(r,r.l+2),u=r.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),l=r.slice(u,r.l+4+s),o.push(l),r.l+=4+s,d=hF[c=tA(r,r.l)];var f=fl(o);Ml(f,0);var A=0;f.lens=[];for(var h=0;h<o.length;++h)f.lens.push(A),A+=o[h].length;if(f.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+f.length+" < "+n;return e.f(f,f.length,a)}function Hf(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Gn[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||VA[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=M2(t.v):t.w=xg(t.v):t.w=Uu(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&_1(Gn[n]||String(n))){var a=Bp(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function e_(t,e,r){return{v:t,ixfe:e,t:r}}function MMe(t,e){var r={opts:{}},n={},a=e.dense?[]:{},s={},o={},l=null,c=[],d="",u={},f,A="",h,m,p,x,v={},y=[],b,w,I=[],j=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},E=function(dt){return dt<8?Kp[dt]:dt<64&&j[dt-8]||Kp[dt]},B=function(dt,Fe,je){var We=Fe.XF.data;if(!(!We||!We.patternType||!je||!je.cellStyles)){Fe.s={},Fe.s.patternType=We.patternType;var ee;(ee=H2(E(We.icvFore)))&&(Fe.s.fgColor={rgb:ee}),(ee=H2(E(We.icvBack)))&&(Fe.s.bgColor={rgb:ee})}},k=function(dt,Fe,je){if(!(De>1)&&!(je.sheetRows&&dt.r>=je.sheetRows)){if(je.cellStyles&&Fe.XF&&Fe.XF.data&&B(dt,Fe,je),delete Fe.ixfe,delete Fe.XF,f=dt,A=Kn(dt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),dt.r<o.s.r&&(o.s.r=dt.r),dt.c<o.s.c&&(o.s.c=dt.c),dt.r+1>o.e.r&&(o.e.r=dt.r+1),dt.c+1>o.e.c&&(o.e.c=dt.c+1),je.cellFormula&&Fe.f){for(var We=0;We<y.length;++We)if(!(y[We][0].s.c>dt.c||y[We][0].s.r>dt.r)&&!(y[We][0].e.c<dt.c||y[We][0].e.r<dt.r)){Fe.F=fa(y[We][0]),(y[We][0].s.c!=dt.c||y[We][0].s.r!=dt.r)&&delete Fe.f,Fe.f&&(Fe.f=""+uc(y[We][1],o,dt,ae,T));break}}je.dense?(a[dt.r]||(a[dt.r]=[]),a[dt.r][dt.c]=Fe):a[A]=Fe}},T={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(T.password=e.password);var P,q=[],de=[],ce=[],le=[],he=!1,ae=[];ae.SheetNames=T.snames,ae.sharedf=T.sharedf,ae.arrayf=T.arrayf,ae.names=[],ae.XTI=[];var Ce=0,De=0,O=0,R=[],G=[],M;T.codepage=1200,xf(1200);for(var K=!1;t.l<t.length-1;){var Y=t.l,D=t.read_shift(2);if(D===0&&Ce===10)break;var V=t.l===t.length?0:t.read_shift(2),te=hF[D];if(te&&te.f){if(e.bookSheets&&Ce===133&&D!==133)break;if(Ce=D,te.r===2||te.r==12){var ve=t.read_shift(2);if(V-=2,!T.enc&&ve!==D&&((ve&255)<<8|ve>>8)!==D)throw new Error("rt mismatch: "+ve+"!="+D);te.r==12&&(t.l+=10,V-=10)}var Q={};if(D===10?Q=te.f(t,V,T):Q=RMe(D,te,t,V,T),De==0&&[9,521,1033,2057].indexOf(Ce)===-1)continue;switch(D){case 34:r.opts.Date1904=N.WBProps.date1904=Q;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(T.enc||(t.l=0),T.enc=Q,!e.password)throw new Error("File is password-protected");if(Q.valid==null)throw new Error("Encryption scheme unsupported");if(!Q.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=Q;break;case 66:var Xe=Number(Q);switch(Xe){case 21010:Xe=1200;break;case 32768:Xe=1e4;break;case 32769:Xe=1252;break}xf(T.codepage=Xe),K=!0;break;case 317:T.rrtabid=Q;break;case 25:T.winlocked=Q;break;case 439:r.opts.RefreshAll=Q;break;case 12:r.opts.CalcCount=Q;break;case 16:r.opts.CalcDelta=Q;break;case 17:r.opts.CalcIter=Q;break;case 13:r.opts.CalcMode=Q;break;case 14:r.opts.CalcPrecision=Q;break;case 95:r.opts.CalcSaveRecalc=Q;break;case 15:T.CalcRefMode=Q;break;case 2211:r.opts.FullCalc=Q;break;case 129:Q.fDialog&&(a["!type"]="dialog"),Q.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),Q.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:I.push(Q);break;case 430:ae.push([Q]),ae[ae.length-1].XTI=[];break;case 35:case 547:ae[ae.length-1].push(Q);break;case 24:case 536:M={Name:Q.Name,Ref:uc(Q.rgce,o,null,ae,T)},Q.itab>0&&(M.Sheet=Q.itab-1),ae.names.push(M),ae[0]||(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].push(Q),Q.Name=="_xlnm._FilterDatabase"&&Q.itab>0&&Q.rgce&&Q.rgce[0]&&Q.rgce[0][0]&&Q.rgce[0][0][0]=="PtgArea3d"&&(G[Q.itab-1]={ref:fa(Q.rgce[0][0][1][2])});break;case 22:T.ExternCount=Q;break;case 23:ae.length==0&&(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].XTI=ae[ae.length-1].XTI.concat(Q),ae.XTI=ae.XTI.concat(Q);break;case 2196:if(T.biff<8)break;M!=null&&(M.Comment=Q[1]);break;case 18:a["!protect"]=Q;break;case 19:Q!==0&&T.WTF&&console.error("Password verifier: "+Q);break;case 133:s[Q.pos]=Q,T.snames.push(Q.name);break;case 10:{if(--De)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=fa(o),e.sheetRows&&e.sheetRows<=o.e.r){var se=o.e.r;o.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=fa(o),o.e.r=se}o.e.r++,o.e.c++}q.length>0&&(a["!merges"]=q),de.length>0&&(a["!objects"]=de),ce.length>0&&(a["!cols"]=ce),le.length>0&&(a["!rows"]=le),N.Sheets.push(S)}d===""?u=a:n[d]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[D]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Q.BIFFVer]||8),T.biffguess=Q.BIFFVer==0,Q.BIFFVer==0&&Q.dt==4096&&(T.biff=5,K=!0,xf(T.codepage=28591)),T.biff==8&&Q.BIFFVer==0&&Q.dt==16&&(T.biff=2),De++)break;if(a=e.dense?[]:{},T.biff<8&&!K&&(K=!0,xf(T.codepage=e.codepage||1252)),T.biff<5||Q.BIFFVer==0&&Q.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Z={pos:t.l-V,name:d};s[Z.pos]=Z,T.snames.push(d)}else d=(s[Y]||{name:""}).name;Q.dt==32&&(a["!type"]="chart"),Q.dt==64&&(a["!type"]="macro"),q=[],de=[],T.arrayf=y=[],ce=[],le=[],he=!1,S={Hidden:(s[Y]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[Q.r]||[])[Q.c]:a[Kn({c:Q.c,r:Q.r})])&&++Q.c,b={ixfe:Q.ixfe,XF:I[Q.ixfe]||{},v:Q.val,t:"n"},O>0&&(b.z=R[b.ixfe>>8&63]),Hf(b,e,r.opts.Date1904),k({c:Q.c,r:Q.r},b,e);break;case 5:case 517:b={ixfe:Q.ixfe,XF:I[Q.ixfe],v:Q.val,t:Q.t},O>0&&(b.z=R[b.ixfe>>8&63]),Hf(b,e,r.opts.Date1904),k({c:Q.c,r:Q.r},b,e);break;case 638:b={ixfe:Q.ixfe,XF:I[Q.ixfe],v:Q.rknum,t:"n"},O>0&&(b.z=R[b.ixfe>>8&63]),Hf(b,e,r.opts.Date1904),k({c:Q.c,r:Q.r},b,e);break;case 189:for(var ke=Q.c;ke<=Q.C;++ke){var Se=Q.rkrec[ke-Q.c][0];b={ixfe:Se,XF:I[Se],v:Q.rkrec[ke-Q.c][1],t:"n"},O>0&&(b.z=R[b.ixfe>>8&63]),Hf(b,e,r.opts.Date1904),k({c:ke,r:Q.r},b,e)}break;case 6:case 518:case 1030:{if(Q.val=="String"){l=Q;break}if(b=e_(Q.val,Q.cell.ixfe,Q.tt),b.XF=I[b.ixfe],e.cellFormula){var Ee=Q.formula;if(Ee&&Ee[0]&&Ee[0][0]&&Ee[0][0][0]=="PtgExp"){var Ze=Ee[0][0][1][0],ot=Ee[0][0][1][1],vt=Kn({r:Ze,c:ot});v[vt]?b.f=""+uc(Q.formula,o,Q.cell,ae,T):b.F=((e.dense?(a[Ze]||[])[ot]:a[vt])||{}).F}else b.f=""+uc(Q.formula,o,Q.cell,ae,T)}O>0&&(b.z=R[b.ixfe>>8&63]),Hf(b,e,r.opts.Date1904),k(Q.cell,b,e),l=Q}break;case 7:case 519:if(l)l.val=Q,b=e_(Q,l.cell.ixfe,"s"),b.XF=I[b.ixfe],e.cellFormula&&(b.f=""+uc(l.formula,o,l.cell,ae,T)),O>0&&(b.z=R[b.ixfe>>8&63]),Hf(b,e,r.opts.Date1904),k(l.cell,b,e),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(Q);var _t=Kn(Q[0].s);if(h=e.dense?(a[Q[0].s.r]||[])[Q[0].s.c]:a[_t],e.cellFormula&&h){if(!l||!_t||!h)break;h.f=""+uc(Q[1],o,Q[0],ae,T),h.F=fa(Q[0])}}break;case 1212:{if(!e.cellFormula)break;if(A){if(!l)break;v[Kn(l.cell)]=Q[0],h=e.dense?(a[l.cell.r]||[])[l.cell.c]:a[Kn(l.cell)],(h||{}).f=""+uc(Q[0],o,f,ae,T)}}break;case 253:b=e_(c[Q.isst].t,Q.ixfe,"s"),c[Q.isst].h&&(b.h=c[Q.isst].h),b.XF=I[b.ixfe],O>0&&(b.z=R[b.ixfe>>8&63]),Hf(b,e,r.opts.Date1904),k({c:Q.c,r:Q.r},b,e);break;case 513:e.sheetStubs&&(b={ixfe:Q.ixfe,XF:I[Q.ixfe],t:"z"},O>0&&(b.z=R[b.ixfe>>8&63]),Hf(b,e,r.opts.Date1904),k({c:Q.c,r:Q.r},b,e));break;case 190:if(e.sheetStubs)for(var Tt=Q.c;Tt<=Q.C;++Tt){var Lt=Q.ixfe[Tt-Q.c];b={ixfe:Lt,XF:I[Lt],t:"z"},O>0&&(b.z=R[b.ixfe>>8&63]),Hf(b,e,r.opts.Date1904),k({c:Tt,r:Q.r},b,e)}break;case 214:case 516:case 4:b=e_(Q.val,Q.ixfe,"s"),b.XF=I[b.ixfe],O>0&&(b.z=R[b.ixfe>>8&63]),Hf(b,e,r.opts.Date1904),k({c:Q.c,r:Q.r},b,e);break;case 0:case 512:De===1&&(o=Q);break;case 252:c=Q;break;case 1054:if(T.biff==4){R[O++]=Q[1];for(var Rt=0;Rt<O+163&&Gn[Rt]!=Q[1];++Rt);Rt>=163&&fA(Q[1],O+163)}else fA(Q[1],Q[0]);break;case 30:{R[O++]=Q;for(var Et=0;Et<O+163&&Gn[Et]!=Q;++Et);Et>=163&&fA(Q,O+163)}break;case 229:q=q.concat(Q);break;case 93:de[Q.cmo[0]]=T.lastobj=Q;break;case 438:T.lastobj.TxO=Q;break;case 127:T.lastobj.ImData=Q;break;case 440:for(x=Q[0].s.r;x<=Q[0].e.r;++x)for(p=Q[0].s.c;p<=Q[0].e.c;++p)h=e.dense?(a[x]||[])[p]:a[Kn({c:p,r:x})],h&&(h.l=Q[1]);break;case 2048:for(x=Q[0].s.r;x<=Q[0].e.r;++x)for(p=Q[0].s.c;p<=Q[0].e.c;++p)h=e.dense?(a[x]||[])[p]:a[Kn({c:p,r:x})],h&&h.l&&(h.l.Tooltip=Q[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;h=e.dense?(a[Q[0].r]||[])[Q[0].c]:a[Kn(Q[0])];var Re=de[Q[2]];h||(e.dense?(a[Q[0].r]||(a[Q[0].r]=[]),h=a[Q[0].r][Q[0].c]={t:"z"}):h=a[Kn(Q[0])]={t:"z"},o.e.r=Math.max(o.e.r,Q[0].r),o.s.r=Math.min(o.s.r,Q[0].r),o.e.c=Math.max(o.e.c,Q[0].c),o.s.c=Math.min(o.s.c,Q[0].c)),h.c||(h.c=[]),m={a:Q[1],t:Re.TxO.t},h.c.push(m)}break;case 2173:_Fe(I[Q.ixfe],Q.ext);break;case 125:{if(!T.cellStyles)break;for(;Q.e>=Q.s;)ce[Q.e--]={width:Q.w/256,level:Q.level||0,hidden:!!(Q.flags&1)},he||(he=!0,BR(Q.w/256)),Bm(ce[Q.e+1])}break;case 520:{var Te={};Q.level!=null&&(le[Q.r]=Te,Te.level=Q.level),Q.hidden&&(le[Q.r]=Te,Te.hidden=!0),Q.hpt&&(le[Q.r]=Te,Te.hpt=Q.hpt,Te.hpx=Kv(Q.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Wp(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[D]]=Q;break;case 161:a["!margins"]||Wp(a["!margins"]={}),a["!margins"].header=Q.header,a["!margins"].footer=Q.footer;break;case 574:Q.RTL&&(N.Views[0].RTL=!0);break;case 146:j=Q;break;case 2198:P=Q;break;case 140:w=Q;break;case 442:d?S.CodeName=Q||S.name:N.WBProps.CodeName=Q||"ThisWorkbook";break}}else te||console.error("Missing Info for XLS Record 0x"+D.toString(16)),t.l+=V}return r.SheetNames=Gi(s).sort(function(Ye,dt){return Number(Ye)-Number(dt)}).map(function(Ye){return s[Ye].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&G.forEach(function(Ye,dt){r.Sheets[r.SheetNames[dt]]["!autofilter"]=Ye}),r.Strings=c,r.SSF=ei(Gn),T.enc&&(r.Encryption=T.enc),P&&(r.Themes=P),r.Metadata={},w!==void 0&&(r.Metadata.Country=w),ae.names.length>0&&(N.Names=ae.names),r.Workbook=N,r}var Kb={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function LMe(t,e,r){var n=Dn.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=r$(n,iF,Kb.DSI);for(var s in a)e[s]=a[s]}catch(d){if(r.WTF)throw d}var o=Dn.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var l=r$(o,oF,Kb.SI);for(var c in l)e[c]==null&&(e[c]=l[c])}catch(d){if(r.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(gae(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function UMe(t,e){var r=[],n=[],a=[],s=0,o,l=BH(iF,"n"),c=BH(oF,"n");if(t.Props)for(o=Gi(t.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],t.Props[o[s]]]);if(t.Custprops)for(o=Gi(t.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],t.Custprops[o[s]]]);var d=[];for(s=0;s<a.length;++s)Cae.indexOf(a[s][0])>-1||pae.indexOf(a[s][0])>-1||a[s][1]!=null&&d.push(a[s]);n.length&&Dn.utils.cfb_add(e,"/SummaryInformation",n$(n,Kb.SI,c,oF)),(r.length||d.length)&&Dn.utils.cfb_add(e,"/DocumentSummaryInformation",n$(r,Kb.DSI,l,iF,d.length?d:null,Kb.UDI))}function vse(t,e){e||(e={}),QR(e),lR(),e.codepage&&oR(e.codepage);var r,n;if(t.FullPaths){if(Dn.find(t,"/encryption"))throw new Error("File is password-protected");r=Dn.find(t,"!CompObj"),n=Dn.find(t,"/Workbook")||Dn.find(t,"/Book")}else{switch(e.type){case"base64":t=Dd(Wd(t));break;case"binary":t=Dd(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Ml(t,0),n={content:t}}var a,s;if(r&&OMe(r),e.bookProps&&!e.bookSheets)a={};else{var o=xa?"buffer":"array";if(n&&n.content)a=MMe(n.content,e);else if((s=Dn.find(t,"PerfectOffice_MAIN"))&&s.content)a=zp.to_workbook(s.content,(e.type=o,e));else if((s=Dn.find(t,"NativeContent_MAIN"))&&s.content)a=zp.to_workbook(s.content,(e.type=o,e));else throw(s=Dn.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Dn.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=ZFe(t))}var l={};return t.FullPaths&&LMe(t,l,e),a.Props=a.Custprops=l,e.bookFiles&&(a.cfb=t),a}function QMe(t,e){var r=e||{},n=Dn.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Dn.utils.cfb_add(n,a,yse(t,r)),r.biff==8&&(t.Props||t.Custprops)&&UMe(t,n),r.biff==8&&t.vbaraw&&eOe(n,Dn.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var q2={0:{f:u6e},1:{f:v6e},2:{f:M6e},3:{f:S6e},4:{f:N6e},5:{f:O6e},6:{f:H6e},7:{f:T6e},8:{f:X6e},9:{f:W6e},10:{f:q6e},11:{f:z6e},12:{f:b6e},13:{f:U6e},14:{f:I6e},15:{f:_6e},16:{f:use},17:{f:G6e},18:{f:k6e},19:{f:wR},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:GRe},40:{},42:{},43:{f:Hke},44:{f:Qke},45:{f:Kke},46:{f:zke},47:{f:qke},48:{},49:{f:A5e},50:{},51:{f:jFe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Oae},62:{f:V6e},63:{f:RFe},64:{f:fRe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:vc,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:lRe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:g6e},148:{f:A6e,p:16},151:{f:rRe},152:{},153:{f:VRe},154:{},155:{},156:{f:URe},157:{},158:{},159:{T:1,f:ake},160:{T:-1},161:{T:1,f:Kg},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Y6e},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:EFe},336:{T:-1},337:{f:TFe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:sF},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Fae},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:nRe},427:{f:aRe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:iRe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:p6e},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:eRe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:sF},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:zFe},633:{T:1},634:{T:-1},635:{T:1,f:KFe},636:{T:-1},637:{f:x5e},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:IRe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:hRe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},hF={6:{f:$5},10:{f:v0},12:{f:xo},13:{f:xo},14:{f:eo},15:{f:eo},16:{f:Ac},17:{f:eo},18:{f:eo},19:{f:xo},20:{f:c$},21:{f:c$},23:{f:Fae},24:{f:u$},25:{f:eo},26:{},27:{},28:{f:hBe},29:{},34:{f:eo},35:{f:d$},38:{f:Ac},39:{f:Ac},40:{f:Ac},41:{f:Ac},42:{f:eo},43:{f:eo},47:{f:_ke},49:{f:UTe},51:{f:xo},60:{},61:{f:OTe},64:{f:eo},65:{f:LTe},66:{f:xo},77:{},80:{},81:{},82:{},85:{f:xo},89:{},90:{},91:{},92:{f:CTe},93:{f:pBe},94:{},95:{f:eo},96:{},97:{},99:{f:eo},125:{f:Oae},128:{f:tBe},129:{f:ETe},130:{f:xo},131:{f:eo},132:{f:eo},133:{f:STe},134:{},140:{f:CBe},141:{f:xo},144:{},146:{f:SBe},151:{},152:{},153:{},154:{},155:{},156:{f:xo},157:{},158:{},160:{f:FBe},161:{f:PBe},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:YTe},190:{f:JTe},193:{f:v0},197:{},198:{},199:{},200:{},201:{},202:{f:eo},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:xo},220:{},221:{f:eo},222:{},224:{f:eBe},225:{f:NTe},226:{f:v0},227:{},229:{f:ABe},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:ITe},253:{f:VTe},255:{f:TTe},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:_ae},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:eo},353:{f:v0},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:iBe},431:{f:eo},432:{},433:{},434:{},437:{},438:{f:vBe},439:{f:eo},440:{f:yBe},441:{},442:{f:Gw},443:{},444:{f:xo},445:{},446:{},448:{f:v0},449:{f:FTe,r:2},450:{f:v0},512:{f:i$},513:{f:kBe},515:{f:aBe},516:{f:$Te},517:{f:l$},519:{f:OBe},520:{f:BTe},523:{},545:{f:f$},549:{f:s$},566:{},574:{f:RTe},638:{f:XTe},659:{},1048:{},1054:{f:KTe},1084:{},1212:{f:dBe},2048:{f:wBe},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:YC},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:v0},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:jBe,r:12},2173:{f:CFe,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:eo,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:cBe,r:12},2197:{},2198:{f:xFe,r:12},2199:{},2200:{},2201:{},2202:{f:uBe,r:12},2203:{f:v0},2204:{},2205:{},2206:{},2207:{},2211:{f:kTe},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:xo},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:TBe},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:EBe},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:i$},1:{},2:{f:UBe},3:{f:MBe},4:{f:RBe},5:{f:l$},7:{f:VBe},8:{},9:{f:YC},11:{},22:{f:xo},30:{f:zTe},31:{},32:{},33:{f:f$},36:{},37:{f:s$},50:{f:HBe},62:{},52:{},67:{},68:{f:xo},69:{},86:{},126:{},127:{f:DBe},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:$Be},223:{},234:{},354:{},421:{},518:{f:$5},521:{f:YC},536:{f:u$},547:{f:d$},561:{},579:{},1030:{f:$5},1033:{f:YC},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Jr(t,e,r,n){var a=e;if(!isNaN(a)){var s=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,a),o.write_shift(2,s),s>0&&vR(r)&&t.push(r)}}function VMe(t,e,r,n){var a=(r||[]).length||0;if(a<=8224)return Jr(t,e,r,a);var s=e;if(!isNaN(s)){for(var o=r.parts||[],l=0,c=0,d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;var u=t.next(4);for(u.write_shift(2,s),u.write_shift(2,d),t.push(r.slice(c,c+d)),c+=d;c<a;){for(u=t.next(4),u.write_shift(2,60),d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;u.write_shift(2,d),t.push(r.slice(c,c+d)),c+=d}}}function Ww(t,e,r){return t||(t=mr(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function HMe(t,e,r,n){var a=mr(9);return Ww(a,t,e),Eae(r,n||"b",a),a}function $Me(t,e,r){var n=mr(8+2*r.length);return Ww(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function GMe(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?qo(Zs(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?Jr(t,2,QBe(r,n,a)):Jr(t,3,LBe(r,n,a));return;case"b":case"e":Jr(t,5,HMe(r,n,e.v,e.t));return;case"s":case"str":Jr(t,4,$Me(r,n,(e.v||"").slice(0,255)));return}Jr(t,1,Ww(null,r,n))}function KMe(t,e,r,n){var a=Array.isArray(e),s=Qa(e["!ref"]||"A1"),o,l="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=fa(s)}for(var d=s.s.r;d<=s.e.r;++d){l=uo(d);for(var u=s.s.c;u<=s.e.c;++u){d===s.s.r&&(c[u]=_i(u)),o=c[u]+l;var f=a?(e[d]||[])[u]:e[o];f&&GMe(t,f,d,u)}}}function qMe(t,e){for(var r=e||{},n=Ad(),a=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Jr(n,r.biff==4?1033:r.biff==3?521:9,IR(t,16,r)),KMe(n,t.Sheets[t.SheetNames[a]],a,r),Jr(n,10),n.end()}function zMe(t,e,r){Jr(t,49,QTe({sz:12,name:"Arial"},r))}function WMe(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Jr(t,1054,qTe(a,e[a],r))})}function XMe(t,e){var r=mr(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Jr(t,2151,r),r=mr(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Tae(Qa(e["!ref"]||"A1"),r),r.write_shift(4,4),Jr(t,2152,r)}function YMe(t,e){for(var r=0;r<16;++r)Jr(t,224,o$({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Jr(t,224,o$(n,0,e))})}function JMe(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Jr(t,440,bBe(n)),n[1].Tooltip&&Jr(t,2048,NBe(n))}delete e["!links"]}function ZMe(t,e){if(e){var r=0;e.forEach(function(n,a){++r<=256&&n&&Jr(t,125,IBe(NP(a,n),a))})}}function e8e(t,e,r,n,a){var s=16+qm(a.cellXfs,e,a);if(e.v==null&&!e.bf){Jr(t,513,wg(r,n,s));return}if(e.bf)Jr(t,6,EDe(e,r,n,a,s));else switch(e.t){case"d":case"n":var o=e.t=="d"?qo(Zs(e.v)):e.v;Jr(t,515,sBe(r,n,o,s));break;case"b":case"e":Jr(t,517,nBe(r,n,e.v,s,a,e.t));break;case"s":case"str":if(a.bookSST){var l=RR(a.Strings,e.v,a.revStrings);Jr(t,253,HTe(r,n,l,s))}else Jr(t,516,GTe(r,n,(e.v||"").slice(0,255),s,a));break;default:Jr(t,513,wg(r,n,s))}}function t8e(t,e,r){var n=Ad(),a=r.SheetNames[t],s=r.Sheets[a]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[t]||{},c=Array.isArray(s),d=e.biff==8,u,f="",A=[],h=Qa(s["!ref"]||"A1"),m=d?65536:16384;if(h.e.c>255||h.e.r>=m){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,m-1)}Jr(n,2057,IR(r,16,e)),Jr(n,13,wu(1)),Jr(n,12,wu(100)),Jr(n,15,Dc(!0)),Jr(n,17,Dc(!1)),Jr(n,16,yg(.001)),Jr(n,95,Dc(!0)),Jr(n,42,Dc(!1)),Jr(n,43,Dc(!1)),Jr(n,130,wu(1)),Jr(n,128,rBe()),Jr(n,131,Dc(!1)),Jr(n,132,Dc(!1)),d&&ZMe(n,s["!cols"]),Jr(n,512,WTe(h,e)),d&&(s["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){f=uo(p);for(var x=h.s.c;x<=h.e.c;++x){p===h.s.r&&(A[x]=_i(x)),u=A[x]+f;var v=c?(s[p]||[])[x]:s[u];v&&(e8e(n,v,p,x,e),d&&v.l&&s["!links"].push([u,v.l]))}}var y=l.CodeName||l.name||a;return d&&Jr(n,574,MTe((o.Views||[])[0])),d&&(s["!merges"]||[]).length&&Jr(n,229,mBe(s["!merges"])),d&&JMe(n,s),Jr(n,442,Sae(y)),d&&XMe(n,s),Jr(n,10),n.end()}function r8e(t,e,r){var n=Ad(),a=(t||{}).Workbook||{},s=a.Sheets||[],o=a.WBProps||{},l=r.biff==8,c=r.biff==5;if(Jr(n,2057,IR(t,5,r)),r.bookType=="xla"&&Jr(n,135),Jr(n,225,l?wu(1200):null),Jr(n,193,nTe(2)),c&&Jr(n,191),c&&Jr(n,192),Jr(n,226),Jr(n,92,_Te("SheetJS",r)),Jr(n,66,wu(l?1200:1252)),l&&Jr(n,353,wu(0)),l&&Jr(n,448),Jr(n,317,BBe(t.SheetNames.length)),l&&t.vbaraw&&Jr(n,211),l&&t.vbaraw){var d=o.CodeName||"ThisWorkbook";Jr(n,442,Sae(d))}Jr(n,156,wu(17)),Jr(n,25,Dc(!1)),Jr(n,18,Dc(!1)),Jr(n,19,wu(0)),l&&Jr(n,431,Dc(!1)),l&&Jr(n,444,wu(0)),Jr(n,61,DTe()),Jr(n,64,Dc(!1)),Jr(n,141,wu(0)),Jr(n,34,Dc(FRe(t)=="true")),Jr(n,14,Dc(!0)),l&&Jr(n,439,Dc(!1)),Jr(n,218,wu(0)),zMe(n,t,r),WMe(n,t.SSF,r),YMe(n,r),l&&Jr(n,352,Dc(!1));var u=n.end(),f=Ad();l&&Jr(f,140,_Be()),l&&r.Strings&&VMe(f,252,PTe(r.Strings)),Jr(f,10);var A=f.end(),h=Ad(),m=0,p=0;for(p=0;p<t.SheetNames.length;++p)m+=(l?12:11)+(l?2:1)*t.SheetNames[p].length;var x=u.length+m+A.length;for(p=0;p<t.SheetNames.length;++p){var v=s[p]||{};Jr(h,133,jTe({pos:x,hs:v.Hidden||0,dt:0,name:t.SheetNames[p]},r)),x+=e[p].length}var y=h.end();if(m!=y.length)throw new Error("BS8 "+m+" != "+y.length);var b=[];return u.length&&b.push(u),y.length&&b.push(y),A.length&&b.push(A),fl(b)}function n8e(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=ei(Gn)),t&&t.SSF&&(E1(),pP(t.SSF),r.revssf=xP(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,VR(r),r.cellXfs=[],qm(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)n[n.length]=t8e(a,r,t);return n.unshift(r8e(t,n,r)),fl(n)}function yse(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var a=md(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return n8e(t,e);case 4:case 3:case 2:return qMe(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function w$(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),o=a.index,l=s&&s.index||t.length,c=Q4e(t.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,u=0,f=0,A=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<c.length;++o){var p=c[o].trim(),x=p.slice(0,3).toLowerCase();if(x=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}u=0;continue}if(!(x!="<td"&&x!="<th")){var v=p.split(/<\/t[dh]>/i);for(l=0;l<v.length;++l){var y=v[l].trim();if(y.match(/<t[dh]/i)){for(var b=y,w=0;b.charAt(0)=="<"&&(w=b.indexOf(">"))>-1;)b=b.slice(w+1);for(var I=0;I<m.length;++I){var j=m[I];j.s.c==u&&j.s.r<d&&d<=j.e.r&&(u=j.e.c+1,I=-1)}var N=zn(y.slice(0,y.indexOf(">")));A=N.colspan?+N.colspan:1,((f=+N.rowspan)>1||A>1)&&m.push({s:{r:d,c:u},e:{r:d+(f||1)-1,c:u+A-1}});var S=N.t||N["data-t"]||"";if(!b.length){u+=A;continue}if(b=$ne(b),h.s.r>d&&(h.s.r=d),h.e.r<d&&(h.e.r=d),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),!b.length){u+=A;continue}var E={t:"s",v:b};r.raw||!b.trim().length||S=="s"||(b==="TRUE"?E={t:"b",v:!0}:b==="FALSE"?E={t:"b",v:!1}:isNaN(Nf(b))?isNaN($v(b).getDate())||(E={t:"d",v:Zs(b)},r.cellDates||(E={t:"n",v:qo(E.v)}),E.z=r.dateNF||Gn[14]):E={t:"n",v:Nf(b)}),r.dense?(n[d]||(n[d]=[]),n[d][u]=E):n[Kn({r:d,c:u})]=E,u+=A}}}}return n["!ref"]=fa(h),m.length&&(n["!merges"]=m),n}function a8e(t,e,r,n){for(var a=t["!merges"]||[],s=[],o=e.s.c;o<=e.e.c;++o){for(var l=0,c=0,d=0;d<a.length;++d)if(!(a[d].s.r>r||a[d].s.c>o)&&!(a[d].e.r<r||a[d].e.c<o)){if(a[d].s.r<r||a[d].s.c<o){l=-1;break}l=a[d].e.r-a[d].s.r+1,c=a[d].e.c-a[d].s.c+1;break}if(!(l<0)){var u=Kn({r,c:o}),f=n.dense?(t[r]||[])[o]:t[u],A=f&&f.v!=null&&(f.h||pR(f.w||(_A(f),f.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),n.editable?A='<span contenteditable="true">'+A+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(A='<a href="'+f.l.Target+'">'+A+"</a>")),h.id=(n.id||"sjs")+"-"+u,s.push(Yr("td",A,h))}}var m="<tr>";return m+s.join("")+"</tr>"}var s8e='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',i8e="</body></html>";function o8e(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Km(w$(r[0],e),e);var n=GR();return r.forEach(function(a,s){KR(n,w$(a,e),"Sheet"+(s+1))}),n}function l8e(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function bse(t,e){var r=e||{},n=r.header!=null?r.header:s8e,a=r.footer!=null?r.footer:i8e,s=[n],o=md(t["!ref"]);r.dense=Array.isArray(t),s.push(l8e(t,o,r));for(var l=o.s.r;l<=o.e.r;++l)s.push(a8e(t,o,l,r));return s.push("</table>"+a),s.join("")}function wse(t,e,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?Ei(n.origin):n.origin;a=o.r,s=o.c}var l=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:a,c:s}};if(t["!ref"]){var u=md(t["!ref"]);d.s.r=Math.min(d.s.r,u.s.r),d.s.c=Math.min(d.s.c,u.s.c),d.e.r=Math.max(d.e.r,u.e.r),d.e.c=Math.max(d.e.c,u.e.c),a==-1&&(d.e.r=a=u.e.r+1)}var f=[],A=0,h=t["!rows"]||(t["!rows"]=[]),m=0,p=0,x=0,v=0,y=0,b=0;for(t["!cols"]||(t["!cols"]=[]);m<l.length&&p<c;++m){var w=l[m];if(N$(w)){if(n.display)continue;h[p]={hidden:!0}}var I=w.children;for(x=v=0;x<I.length;++x){var j=I[x];if(!(n.display&&N$(j))){var N=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):$ne(j.innerHTML),S=j.getAttribute("data-z")||j.getAttribute("z");for(A=0;A<f.length;++A){var E=f[A];E.s.c==v+s&&E.s.r<p+a&&p+a<=E.e.r&&(v=E.e.c+1-s,A=-1)}b=+j.getAttribute("colspan")||1,((y=+j.getAttribute("rowspan")||1)>1||b>1)&&f.push({s:{r:p+a,c:v+s},e:{r:p+a+(y||1)-1,c:v+s+(b||1)-1}});var B={t:"s",v:N},k=j.getAttribute("data-t")||j.getAttribute("t")||"";N!=null&&(N.length==0?B.t=k||"z":n.raw||N.trim().length==0||k=="s"||(N==="TRUE"?B={t:"b",v:!0}:N==="FALSE"?B={t:"b",v:!1}:isNaN(Nf(N))?isNaN($v(N).getDate())||(B={t:"d",v:Zs(N)},n.cellDates||(B={t:"n",v:qo(B.v)}),B.z=n.dateNF||Gn[14]):B={t:"n",v:Nf(N)})),B.z===void 0&&S!=null&&(B.z=S);var T="",P=j.getElementsByTagName("A");if(P&&P.length)for(var q=0;q<P.length&&!(P[q].hasAttribute("href")&&(T=P[q].getAttribute("href"),T.charAt(0)!="#"));++q);T&&T.charAt(0)!="#"&&(B.l={Target:T}),n.dense?(t[p+a]||(t[p+a]=[]),t[p+a][v+s]=B):t[Kn({c:v+s,r:p+a})]=B,d.e.c<v+s&&(d.e.c=v+s),v+=b}}++p}return f.length&&(t["!merges"]=(t["!merges"]||[]).concat(f)),d.e.r=Math.max(d.e.r,p-1+a),t["!ref"]=fa(d),p>=c&&(t["!fullref"]=fa((d.e.r=l.length-m+p-1+a,d))),t}function Nse(t,e){var r=e||{},n=r.dense?[]:{};return wse(n,t,e)}function c8e(t,e){return Km(Nse(t,e),e)}function N$(t){var e="",r=d8e(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function d8e(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function u8e(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ua(e.replace(/<[^>]*>/g,""));return[r]}var C$={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Cse(t,e){var r=e||{},n=gR(t),a=[],s,o,l={name:""},c="",d=0,u,f,A={},h=[],m=r.dense?[]:{},p,x,v={value:""},y="",b=0,w=[],I=-1,j=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,E={},B=[],k={},T=0,P=0,q=[],de=1,ce=1,le=[],he={Names:[]},ae={},Ce=["",""],De=[],O={},R="",G=0,M=!1,K=!1,Y=0;for(Q2.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Q2.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?m["!ref"]=fa(N):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=N.e.r&&(m["!fullref"]=m["!ref"],N.e.r=r.sheetRows-1,m["!ref"]=fa(N)),B.length&&(m["!merges"]=B),q.length&&(m["!rows"]=q),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),h.push(u.name),A[u.name]=m,K=!1):p[0].charAt(p[0].length-2)!=="/"&&(u=zn(p[0],!1),I=j=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,m=r.dense?[]:{},B=[],q=[],K=!0);break;case"table-row-group":p[1]==="/"?--S:++S;break;case"table-row":case"":if(p[1]==="/"){I+=de,de=1;break}if(f=zn(p[0],!1),f.?I=f.-1:I==-1&&(I=0),de=+f["number-rows-repeated"]||1,de<10)for(Y=0;Y<de;++Y)S>0&&(q[I+Y]={level:S});j=-1;break;case"covered-table-cell":p[1]!=="/"&&++j,r.sheetStubs&&(r.dense?(m[I]||(m[I]=[]),m[I][j]={t:"z"}):m[Kn({r:I,c:j})]={t:"z"}),y="",w=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++j,v=zn(p[0],!1),ce=parseInt(v["number-columns-repeated"]||"1",10),x={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(x.f=v$(Ua(v.formula))),(v.||v["value-type"])=="string"&&(x.t="s",x.v=Ua(v["string-value"]||""),r.dense?(m[I]||(m[I]=[]),m[I][j]=x):m[Kn({r:I,c:j})]=x),j+=ce-1;else if(p[1]!=="/"){++j,y="",b=0,w=[],ce=1;var D=de?I+de-1:I;if(j>N.e.c&&(N.e.c=j),j<N.s.c&&(N.s.c=j),I<N.s.r&&(N.s.r=I),D>N.e.r&&(N.e.r=D),v=zn(p[0],!1),De=[],O={},x={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=Ua(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(T=parseInt(v["number-matrix-rows-spanned"],10)||0,P=parseInt(v["number-matrix-columns-spanned"],10)||0,k={s:{r:I,c:j},e:{r:I+T-1,c:j+P-1}},x.F=fa(k),le.push([k,x.F])),v.formula)x.f=v$(v.formula);else for(Y=0;Y<le.length;++Y)I>=le[Y][0].s.r&&I<=le[Y][0].e.r&&j>=le[Y][0].s.c&&j<=le[Y][0].e.c&&(x.F=le[Y][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(T=parseInt(v["number-rows-spanned"],10)||0,P=parseInt(v["number-columns-spanned"],10)||0,k={s:{r:I,c:j},e:{r:I+T-1,c:j+P-1}},B.push(k)),v["number-columns-repeated"]&&(ce=parseInt(v["number-columns-repeated"],10)),x.t){case"boolean":x.t="b",x.v=Ws(v["boolean-value"]);break;case"float":x.t="n",x.v=parseFloat(v.value);break;case"percentage":x.t="n",x.v=parseFloat(v.value);break;case"currency":x.t="n",x.v=parseFloat(v.value);break;case"date":x.t="d",x.v=Zs(v["date-value"]),r.cellDates||(x.t="n",x.v=qo(x.v)),x.z="m/d/yy";break;case"time":x.t="n",x.v=M4e(v["time-value"])/86400,r.cellDates&&(x.t="d",x.v=vP(x.v)),x.z="HH:MM:SS";break;case"number":x.t="n",x.v=parseFloat(v.);break;default:if(x.t==="string"||x.t==="text"||!x.t)x.t="s",v["string-value"]!=null&&(y=Ua(v["string-value"]),w=[]);else throw new Error("Unsupported value type "+x.t)}}else{if(M=!1,x.t==="s"&&(x.v=y||"",w.length&&(x.R=w),M=b==0),ae.Target&&(x.l=ae),De.length>0&&(x.c=De,De=[]),y&&r.cellText!==!1&&(x.w=y),M&&(x.t="z",delete x.v),(!M||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=I))for(var V=0;V<de;++V){if(ce=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(m[I+V]||(m[I+V]=[]),m[I+V][j]=V==0?x:ei(x);--ce>0;)m[I+V][j+ce]=ei(x);else for(m[Kn({r:I+V,c:j})]=x;--ce>0;)m[Kn({r:I+V,c:j+ce})]=ei(x);N.e.c<=j&&(N.e.c=j)}ce=parseInt(v["number-columns-repeated"]||"1",10),j+=ce-1,ce=0,x={},y="",w=[]}ae={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s;O.t=y,w.length&&(O.R=w),O.a=R,De.push(O)}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);R="",G=0,y="",b=0,w=[];break;case"creator":p[1]==="/"?R=n.slice(G,p.index):G=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);y="",b=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(E[l.name]=c,(s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(c="",l=zn(p[0],!1),a.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=zn(p[0],!1),c+=C$[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=zn(p[0],!1),c+=C$[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(d,p.index);break}else d=p.index+p[0].length;break;case"named-range":o=zn(p[0],!1),Ce=G5(o["cell-range-address"]);var te={Name:o.name,Ref:Ce[0]+"!"+Ce[1]};K&&(te.Sheet=h.length),he.Names.push(te);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(p[1]==="/"&&(!v||!v["string-value"])){var ve=u8e(n.slice(b,p.index));y=(y.length>0?y+`
`:"")+ve[0]}else zn(p[0],!1),b=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{Ce=G5(zn(p[0])["target-range-address"]),A[Ce[0]]["!autofilter"]={ref:Ce[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(ae=zn(p[0],!1),!ae.href)break;ae.Target=Ua(ae.href),delete ae.href,ae.Target.charAt(0)=="#"&&ae.Target.indexOf(".")>-1?(Ce=G5(ae.Target.slice(1)),ae.Target="#"+Ce[0]+"!"+Ce[1]):ae.Target.match(/^\.\.[\\\/]/)&&(ae.Target=ae.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var Q={Sheets:A,SheetNames:h,Workbook:he};return r.bookSheets&&delete Q.Sheets,Q}function _$(t,e){e=e||{},bu(t,"META-INF/manifest.xml")&&M5e(go(t,"META-INF/manifest.xml"),e);var r=Rd(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Cse(Cs(r),e);return bu(t,"meta.xml")&&(n.Props=Aae(go(t,"meta.xml"))),n}function E$(t,e){return Cse(t,e)}var f8e=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+U2({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return ho+e}}(),S$=function(){var t=function(s){return gs(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,l){var c=[];c.push('      <table:table table:name="'+gs(o.SheetNames[l])+`" table:style-name="ta1">
`);var d=0,u=0,f=md(s["!ref"]||"A1"),A=s["!merges"]||[],h=0,m=Array.isArray(s);if(s["!cols"])for(u=0;u<=f.e.c;++u)c.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var p="",x=s["!rows"]||[];for(d=0;d<f.s.r;++d)p=x[d]?' table:style-name="ro'+x[d].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;d<=f.e.r;++d){for(p=x[d]?' table:style-name="ro'+x[d].ods+'"':"",c.push("        <table:table-row"+p+`>
`),u=0;u<f.s.c;++u)c.push(e);for(;u<=f.e.c;++u){var v=!1,y={},b="";for(h=0;h!=A.length;++h)if(!(A[h].s.c>u)&&!(A[h].s.r>d)&&!(A[h].e.c<u)&&!(A[h].e.r<d)){(A[h].s.c!=u||A[h].s.r!=d)&&(v=!0),y["table:number-columns-spanned"]=A[h].e.c-A[h].s.c+1,y["table:number-rows-spanned"]=A[h].e.r-A[h].s.r+1;break}if(v){c.push(r);continue}var w=Kn({r:d,c:u}),I=m?(s[d]||[])[u]:s[w];if(I&&I.f&&(y["table:formula"]=gs(BDe(I.f)),I.F&&I.F.slice(0,w.length)==w)){var j=md(I.F);y["table:number-matrix-columns-spanned"]=j.e.c-j.s.c+1,y["table:number-matrix-rows-spanned"]=j.e.r-j.s.r+1}if(!I){c.push(e);continue}switch(I.t){case"b":b=I.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=I.v?"true":"false";break;case"n":b=I.w||String(I.v||0),y["office:value-type"]="float",y["office:value"]=I.v||0;break;case"s":case"str":b=I.v==null?"":I.v,y["office:value-type"]="string";break;case"d":b=I.w||Zs(I.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=Zs(I.v).toISOString(),y["table:style-name"]="ce1";break;default:c.push(e);continue}var N=t(b);if(I.l&&I.l.Target){var S=I.l.Target;S=S.charAt(0)=="#"?"#"+kDe(S.slice(1)):S,S.charAt(0)!="#"&&!S.match(/^\w+:/)&&(S="../"+S),N=Yr("text:a",N,{"xlink:href":S.replace(/&/g,"&amp;")})}c.push("          "+Yr("table:table-cell",Yr("text:p",N,{}),y)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var u=0;u<d["!cols"].length;++u)if(d["!cols"][u]){var f=d["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Bm(f),f.ods=l;var A=d["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+A+`"/>
`),s.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var u=0;u<d["!rows"].length;++u)if(d["!rows"][u]){d["!rows"][u].ods=c;var f=d["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,l){var c=[ho],d=U2({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=U2({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+d+u+`>
`),c.push(hae().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),a(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(n(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function _se(t,e){if(e.bookType=="fods")return S$(t,e);var r=hR(),n="",a=[],s=[];return n="mimetype",ma(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ma(r,n,S$(t,e)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",ma(r,n,f8e(t,e)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",ma(r,n,ho+hae()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",ma(r,n,Q5e(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ma(r,n,L5e(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ng(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function AF(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Cs(Gm(t))}function h8e(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Dd(nh(t))}function A8e(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Fm(t){var e=t.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(a){r.set(a,n),n+=a.length}),r}function j$(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function m8e(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,a=e+13;a>=e;--a)n=n*256+t[a];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function p8e(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)t[e+s]=a&255;t[e+15]|=r>=0?0:128}function z2(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function ds(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Hi(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function $a(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],a=z2(t,r),s=a&7;a=Math.floor(a/8);var o=0,l;if(a==0)break;switch(s){case 0:{for(var c=r[0];t[r[0]++]>=128;);l=t.slice(c,r[0])}break;case 5:o=4,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=z2(t,r),l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var d={data:l,type:s};e[a]==null?e[a]=[d]:e[a].push(d)}return e}function Il(t){var e=[];return t.forEach(function(r,n){r.forEach(function(a){a.data&&(e.push(ds(n*8+a.type)),a.type==2&&e.push(ds(a.data.length)),e.push(a.data))})}),Fm(e)}function UR(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function Au(t){for(var e,r=[],n=[0];n[0]<t.length;){var a=z2(t,n),s=$a(t.slice(n[0],n[0]+a));n[0]+=a;var o={id:Hi(s[1][0].data),messages:[]};s[2].forEach(function(l){var c=$a(l.data),d=Hi(c[3][0].data);o.messages.push({meta:c,data:t.slice(n[0],n[0]+d)}),n[0]+=d}),(e=s[3])!=null&&e[0]&&(o.merge=Hi(s[3][0].data)>>>0>0),r.push(o)}return r}function vx(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:ds(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:ds(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:ds(o.data.length)}],n[2].push({data:Il(o.meta),type:2})});var s=Il(n);e.push(ds(s.length)),e.push(s),a.forEach(function(o){return e.push(o)})}),Fm(e)}function g8e(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=z2(e,r),a=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=e[r[0]],l>1&&(o|=e[r[0]+1]<<8),l>2&&(o|=e[r[0]+2]<<16),l>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}a.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,d=0;if(s==1?(d=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,s==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Fm(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(a.push(a[0].slice(-c)),d-=c;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-c,-c+d))}}var u=Fm(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function mu(t){for(var e=[],r=0;r<t.length;){var n=t[r++],a=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(g8e(n,t.slice(r,r+a))),r+=a}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Fm(e)}function yx(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),a=new Uint8Array(4);e.push(a);var s=ds(n),o=s.length;e.push(s),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,r+=n}return Fm(e)}function x8e(t,e,r,n){var a=Ng(t),s=a.getUint32(4,!0),o=(n>1?12:8)+j$(s&(n>1?3470:398))*4,l=-1,c=-1,d=NaN,u=new Date(2001,0,1);s&512&&(l=a.getUint32(o,!0),o+=4),o+=j$(s&(n>1?12288:4096))*4,s&16&&(c=a.getUint32(o,!0),o+=4),s&32&&(d=a.getFloat64(o,!0),o+=8),s&64&&(u.setTime(u.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var f;switch(t[2]){case 0:break;case 2:f={t:"n",v:d};break;case 3:f={t:"s",v:e[c]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:d>0};break;case 7:f={t:"n",v:d/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:e[c]};else if(!isNaN(d))f={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return f}function v8e(t,e,r){var n=Ng(t),a=n.getUint32(8,!0),s=12,o=-1,l=-1,c=NaN,d=NaN,u=new Date(2001,0,1);a&1&&(c=m8e(t,s),s+=16),a&2&&(d=n.getFloat64(s,!0),s+=8),a&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(l=n.getUint32(s,!0),s+=4),a&16&&(o=n.getUint32(s,!0),s+=4);var f;switch(t[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:e[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:d>0};break;case 7:f={t:"n",v:d/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return f}function q5(t,e){var r=new Uint8Array(32),n=Ng(r),a=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,p8e(r,a,t.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,t.v?1:0,!0),s|=2,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(a,e.indexOf(t.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,a)}function z5(t,e){var r=new Uint8Array(32),n=Ng(r),a=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(a,t.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,t.v?1:0,!0),s|=32,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(a,e.indexOf(t.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,a)}function y8e(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return x8e(t,e,r,t[0]);case 5:return v8e(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function cc(t){var e=$a(t);return z2(e[1][0].data)}function I$(t,e){var r=$a(e.data),n=Hi(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(o){var l=$a(o.data),c=Hi(l[1][0].data)>>>0;switch(n){case 1:s[c]=AF(l[3][0].data);break;case 8:{var d=t[cc(l[9][0].data)][0],u=$a(d.data),f=t[cc(u[1][0].data)][0],A=Hi(f.meta[1][0].data);if(A!=2001)throw new Error("2000 unexpected reference to ".concat(A));var h=$a(f.data);s[c]=h[3].map(function(m){return AF(m.data)}).join("")}break}}),s}function b8e(t,e){var r,n,a,s,o,l,c,d,u,f,A,h,m,p,x=$a(t),v=Hi(x[1][0].data)>>>0,y=Hi(x[2][0].data)>>>0,b=((n=(r=x[8])==null?void 0:r[0])==null?void 0:n.data)&&Hi(x[8][0].data)>0||!1,w,I;if((s=(a=x[7])==null?void 0:a[0])!=null&&s.data&&e!=0)w=(l=(o=x[7])==null?void 0:o[0])==null?void 0:l.data,I=(d=(c=x[6])==null?void 0:c[0])==null?void 0:d.data;else if((f=(u=x[4])==null?void 0:u[0])!=null&&f.data&&e!=1)w=(h=(A=x[4])==null?void 0:A[0])==null?void 0:h.data,I=(p=(m=x[3])==null?void 0:m[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var j=b?4:1,N=Ng(w),S=[],E=0;E<w.length/2;++E){var B=N.getUint16(E*2,!0);B<65535&&S.push([E,B])}if(S.length!=y)throw"Expected ".concat(y," cells, found ").concat(S.length);var k=[];for(E=0;E<S.length-1;++E)k[S[E][0]]=I.subarray(S[E][1]*j,S[E+1][1]*j);return S.length>=1&&(k[S[S.length-1][0]]=I.subarray(S[S.length-1][1]*j)),{R:v,cells:k}}function w8e(t,e){var r,n=$a(e.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Hi(n[7][0].data)>>>0>0?1:0:-1,s=UR(n[5],function(o){return b8e(o,a)});return{nrows:Hi(n[4][0].data)>>>0,data:s.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,d){if(o[l.R][d])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(d));o[l.R][d]=c}),o},[])}}function N8e(t,e,r){var n,a=$a(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Hi(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Hi(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=fa(s);var o=$a(a[4][0].data),l=I$(t,t[cc(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?I$(t,t[cc(o[17][0].data)][0]):[],d=$a(o[3][0].data),u=0;d[1].forEach(function(f){var A=$a(f.data),h=t[cc(A[2][0].data)][0],m=Hi(h.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var p=w8e(t,h);p.data.forEach(function(x,v){x.forEach(function(y,b){var w=Kn({r:u+v,c:b}),I=y8e(y,l,c);I&&(r[w]=I)})}),u+=p.nrows})}function C8e(t,e){var r=$a(e.data),n={"!ref":"A1"},a=t[cc(r[2][0].data)],s=Hi(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return N8e(t,a[0],n),n}function _8e(t,e){var r,n=$a(e.data),a={name:(r=n[1])!=null&&r[0]?AF(n[1][0].data):"",sheets:[]},s=UR(n[2],cc);return s.forEach(function(o){t[o].forEach(function(l){var c=Hi(l.meta[1][0].data);c==6e3&&a.sheets.push(C8e(t,l))})}),a}function E8e(t,e){var r=GR(),n=$a(e.data),a=UR(n[1],cc);if(a.forEach(function(s){t[s].forEach(function(o){var l=Hi(o.meta[1][0].data);if(l==2){var c=_8e(t,o);c.sheets.forEach(function(d,u){KR(r,d,u==0?c.name:c.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function W5(t){var e,r,n,a,s={},o=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var d;try{d=mu(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var u;try{u=Au(d)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){s[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((a=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Hi(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||o.forEach(function(c){s[c].forEach(function(d){var u=Hi(d.meta[1][0].data)>>>0;if(u==1)if(!l)l=d;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return E8e(s,l)}function S8e(t,e,r){var n,a,s,o;if(!((n=t[6])!=null&&n[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(s=t[8])==null?void 0:s[0])==null?void 0:o.data)&&Hi(t[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,d=Ng(t[7][0].data),u=0,f=[],A=Ng(t[4][0].data),h=0,m=[],p=0;p<e.length;++p){if(e[p]==null){d.setUint16(p*2,65535,!0),A.setUint16(p*2,65535);continue}d.setUint16(p*2,u,!0),A.setUint16(p*2,h,!0);var x,v;switch(typeof e[p]){case"string":x=q5({t:"s",v:e[p]},r),v=z5({t:"s",v:e[p]},r);break;case"number":x=q5({t:"n",v:e[p]},r),v=z5({t:"n",v:e[p]},r);break;case"boolean":x=q5({t:"b",v:e[p]},r),v=z5({t:"b",v:e[p]},r);break;default:throw new Error("Unsupported value "+e[p])}f.push(x),u+=x.length,m.push(v),h+=v.length,++c}for(t[2][0].data=ds(c);p<t[7][0].data.length/2;++p)d.setUint16(p*2,65535,!0),A.setUint16(p*2,65535,!0);return t[6][0].data=Fm(f),t[3][0].data=Fm(m),c}function j8e(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=md(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(fa(n)));var s=sj(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(R){return R.forEach(function(G){typeof G=="string"&&o.push(G)})});var l={},c=[],d=Dn.read(e.numbers,{type:"base64"});d.FileIndex.map(function(R,G){return[R,d.FullPaths[G]]}).forEach(function(R){var G=R[0],M=R[1];if(G.type==2&&G.name.match(/\.iwa/)){var K=G.content,Y=mu(K),D=Au(Y);D.forEach(function(V){c.push(V.id),l[V.id]={deps:[],location:M,type:Hi(V.messages[0].meta[1][0].data)}})}}),c.sort(function(R,G){return R-G});var u=c.filter(function(R){return R>1}).map(function(R){return[R,ds(R)]});d.FileIndex.map(function(R,G){return[R,d.FullPaths[G]]}).forEach(function(R){var G=R[0];if(R[1],!!G.name.match(/\.iwa/)){var M=Au(mu(G.content));M.forEach(function(K){K.messages.forEach(function(Y){u.forEach(function(D){K.messages.some(function(V){return Hi(V.meta[1][0].data)!=11006&&A8e(V.data,D[1])})&&l[D[0]].deps.push(K.id)})})})}});for(var f=Dn.find(d,l[1].location),A=Au(mu(f.content)),h,m=0;m<A.length;++m){var p=A[m];p.id==1&&(h=p)}var x=cc($a(h.messages[0].data)[1][0].data);for(f=Dn.find(d,l[x].location),A=Au(mu(f.content)),m=0;m<A.length;++m)p=A[m],p.id==x&&(h=p);for(x=cc($a(h.messages[0].data)[2][0].data),f=Dn.find(d,l[x].location),A=Au(mu(f.content)),m=0;m<A.length;++m)p=A[m],p.id==x&&(h=p);for(x=cc($a(h.messages[0].data)[2][0].data),f=Dn.find(d,l[x].location),A=Au(mu(f.content)),m=0;m<A.length;++m)p=A[m],p.id==x&&(h=p);var v=$a(h.messages[0].data);{v[6][0].data=ds(n.e.r+1),v[7][0].data=ds(n.e.c+1);var y=cc(v[46][0].data),b=Dn.find(d,l[y].location),w=Au(mu(b.content));{for(var I=0;I<w.length&&w[I].id!=y;++I);if(w[I].id!=y)throw"Bad ColumnRowUIDMapArchive";var j=$a(w[I].messages[0].data);j[1]=[],j[2]=[],j[3]=[];for(var N=0;N<=n.e.c;++N){var S=[];S[1]=S[2]=[{type:0,data:ds(N+420690)}],j[1].push({type:2,data:Il(S)}),j[2].push({type:0,data:ds(N)}),j[3].push({type:0,data:ds(N)})}j[4]=[],j[5]=[],j[6]=[];for(var E=0;E<=n.e.r;++E)S=[],S[1]=S[2]=[{type:0,data:ds(E+726270)}],j[4].push({type:2,data:Il(S)}),j[5].push({type:0,data:ds(E)}),j[6].push({type:0,data:ds(E)});w[I].messages[0].data=Il(j)}b.content=yx(vx(w)),b.size=b.content.length,delete v[46];var B=$a(v[4][0].data);{B[7][0].data=ds(n.e.r+1);var k=$a(B[1][0].data),T=cc(k[2][0].data);b=Dn.find(d,l[T].location),w=Au(mu(b.content));{if(w[0].id!=T)throw"Bad HeaderStorageBucket";var P=$a(w[0].messages[0].data);for(E=0;E<s.length;++E){var q=$a(P[2][0].data);q[1][0].data=ds(E),q[4][0].data=ds(s[E].length),P[2][E]={type:P[2][0].type,data:Il(q)}}w[0].messages[0].data=Il(P)}b.content=yx(vx(w)),b.size=b.content.length;var de=cc(B[2][0].data);b=Dn.find(d,l[de].location),w=Au(mu(b.content));{if(w[0].id!=de)throw"Bad HeaderStorageBucket";for(P=$a(w[0].messages[0].data),N=0;N<=n.e.c;++N)q=$a(P[2][0].data),q[1][0].data=ds(N),q[4][0].data=ds(n.e.r+1),P[2][N]={type:P[2][0].type,data:Il(q)};w[0].messages[0].data=Il(P)}b.content=yx(vx(w)),b.size=b.content.length;var ce=cc(B[4][0].data);(function(){for(var R=Dn.find(d,l[ce].location),G=Au(mu(R.content)),M,K=0;K<G.length;++K){var Y=G[K];Y.id==ce&&(M=Y)}var D=$a(M.messages[0].data);{D[3]=[];var V=[];o.forEach(function(Q,Xe){V[1]=[{type:0,data:ds(Xe)}],V[2]=[{type:0,data:ds(1)}],V[3]=[{type:2,data:h8e(Q)}],D[3].push({type:2,data:Il(V)})})}M.messages[0].data=Il(D);var te=vx(G),ve=yx(te);R.content=ve,R.size=R.content.length})();var le=$a(B[3][0].data);{var he=le[1][0];delete le[2];var ae=$a(he.data);{var Ce=cc(ae[2][0].data);(function(){for(var R=Dn.find(d,l[Ce].location),G=Au(mu(R.content)),M,K=0;K<G.length;++K){var Y=G[K];Y.id==Ce&&(M=Y)}var D=$a(M.messages[0].data);{delete D[6],delete le[7];var V=new Uint8Array(D[5][0].data);D[5]=[];for(var te=0,ve=0;ve<=n.e.r;++ve){var Q=$a(V);te+=S8e(Q,s[ve],o),Q[1][0].data=ds(ve),D[5].push({data:Il(Q),type:2})}D[1]=[{type:0,data:ds(n.e.c+1)}],D[2]=[{type:0,data:ds(n.e.r+1)}],D[3]=[{type:0,data:ds(te)}],D[4]=[{type:0,data:ds(n.e.r+1)}]}M.messages[0].data=Il(D);var Xe=vx(G),se=yx(Xe);R.content=se,R.size=R.content.length})()}he.data=Il(ae)}B[3][0].data=Il(le)}v[4][0].data=Il(B)}h.messages[0].data=Il(v);var De=vx(A),O=yx(De);return f.content=O,f.size=f.content.length,d}function Ese(t){return function(r){for(var n=0;n!=t.length;++n){var a=t[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function QR(t){Ese([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function VR(t){Ese([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function I8e(t){return wa.WS.indexOf(t)>-1?"sheet":t==wa.CS?"chart":t==wa.DS?"dialog":t==wa.MS?"macro":t&&t.length?t:"sheet"}function P8e(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,I8e(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function T8e(t,e,r,n,a,s,o,l,c,d,u,f){try{s[n]=Vb(Rd(t,r,!0),e);var A=go(t,e),h;switch(l){case"sheet":h=ZRe(A,e,a,c,s[n],d,u,f);break;case"chart":if(h=eMe(A,e,a,c,s[n],d,u,f),!h||!h["!drawel"])break;var m=ab(h["!drawel"].Target,e),p=V2(m),x=UFe(Rd(t,m,!0),Vb(Rd(t,p,!0),m)),v=ab(x,m),y=V2(v);h=SRe(Rd(t,v,!0),v,c,Vb(Rd(t,y,!0),v),d,h);break;case"macro":h=tMe(A,e,a,c,s[n],d,u,f);break;case"dialog":h=rMe(A,e,a,c,s[n],d,u,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=h;var b=[];s&&s[n]&&Gi(s[n]).forEach(function(w){var I="";if(s[n][w].Type==wa.CMNT){I=ab(s[n][w].Target,e);var j=iMe(go(t,I,!0),I,c);if(!j||!j.length)return;A$(h,j,!1)}s[n][w].Type==wa.TCMNT&&(I=ab(s[n][w].Target,e),b=b.concat(VFe(go(t,I,!0),c)))}),b&&b.length&&A$(h,b,!0,c.people||[])}catch(w){if(c.WTF)throw w}}function du(t){return t.charAt(0)=="/"?t.slice(1):t}function B8e(t,e){if(E1(),e=e||{},QR(e),bu(t,"META-INF/manifest.xml")||bu(t,"objectdata.xml"))return _$(t,e);if(bu(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof W5<"u"){if(t.FileIndex)return W5(t);var r=Dn.utils.cfb_new();return OH(t).forEach(function(q){ma(r,q,H4e(t,q))}),W5(r)}throw new Error("Unsupported NUMBERS file")}if(!bu(t,"[Content_Types].xml"))throw bu(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):bu(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=OH(t),a=D5e(Rd(t,"[Content_Types].xml")),s=!1,o,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",go(t,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!go(t,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},d={};if(!e.bookSheets&&!e.bookProps){if(Hb=[],a.sst)try{Hb=sMe(go(t,du(a.sst)),a.sst,e)}catch(q){if(e.WTF)throw q}e.cellStyles&&a.themes.length&&(c=aMe(Rd(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(d=nMe(go(t,du(a.style)),a.style,c,e))}a.links.map(function(q){try{var de=Vb(Rd(t,V2(du(q))),q);return lMe(go(t,du(q)),de,q,e)}catch{}});var u=JRe(go(t,du(a.workbooks[0])),a.workbooks[0],e),f={},A="";a.coreprops.length&&(A=go(t,du(a.coreprops[0]),!0),A&&(f=Aae(A)),a.extprops.length!==0&&(A=go(t,du(a.extprops[0]),!0),A&&H5e(A,f,e)));var h={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(A=Rd(t,du(a.custprops[0]),!0),A&&(h=G5e(A,e)));var m={};if((e.bookSheets||e.bookProps)&&(u.Sheets?o=u.Sheets.map(function(de){return de.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),e.bookProps&&(m.Props=f,m.Custprops=h),e.bookSheets&&typeof o<"u"&&(m.SheetNames=o),e.bookSheets?m.SheetNames:e.bookProps))return m;o={};var p={};e.bookDeps&&a.calcchain&&(p=oMe(go(t,du(a.calcchain)),a.calcchain));var x=0,v={},y,b;{var w=u.Sheets;f.Worksheets=w.length,f.SheetNames=[];for(var I=0;I!=w.length;++I)f.SheetNames[I]=w[I].name}var j=s?"bin":"xml",N=a.workbooks[0].lastIndexOf("/"),S=(a.workbooks[0].slice(0,N+1)+"_rels/"+a.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");bu(t,S)||(S="xl/_rels/workbook."+j+".rels");var E=Vb(Rd(t,S,!0),S.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=cMe(go(t,du(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=$Fe(go(t,du(a.people[0])),e)),E&&(E=P8e(E,u.Sheets));var B=go(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(x=0;x!=f.Worksheets;++x){var k="sheet";if(E&&E[x]?(y="xl/"+E[x][1].replace(/[\/]?xl\//,""),bu(t,y)||(y=E[x][1]),bu(t,y)||(y=S.replace(/_rels\/.*$/,"")+E[x][1]),k=E[x][2]):(y="xl/worksheets/sheet"+(x+1-B)+"."+j,y=y.replace(/sheet0\./,"sheet.")),b=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(x!=e.sheets)continue e;break;case"string":if(f.SheetNames[x].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var T=!1,P=0;P!=e.sheets.length;++P)typeof e.sheets[P]=="number"&&e.sheets[P]==x&&(T=1),typeof e.sheets[P]=="string"&&e.sheets[P].toLowerCase()==f.SheetNames[x].toLowerCase()&&(T=1);if(!T)continue e}}T8e(t,y,b,f.SheetNames[x],x,v,o,k,e,u,c,d)}return m={Directory:a,Workbook:u,Props:f,Custprops:h,Deps:p,Sheets:o,SheetNames:f.SheetNames,Strings:Hb,Styles:d,Themes:c,SSF:ei(Gn)},e&&e.bookFiles&&(t.files?(m.keys=n,m.files=t.files):(m.keys=[],m.files={},t.FullPaths.forEach(function(q,de){q=q.replace(/^Root Entry[\/]/,""),m.keys.push(q),m.files[q]=t.FileIndex[de]}))),e&&e.bookVBA&&(a.vba.length>0?m.vbaraw=go(t,du(a.vba[0]),!0):a.defaults&&a.defaults.bin===JFe&&(m.vbaraw=go(t,"xl/vbaProject.bin",!0))),m}function k8e(t,e){var r=e||{},n="Workbook",a=Dn.find(t,n);try{if(n="/!DataSpaces/Version",a=Dn.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(cke(a.content),n="/!DataSpaces/DataSpaceMap",a=Dn.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=uke(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Dn.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=fke(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Dn.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);Ake(a.content)}catch{}if(n="/EncryptionInfo",a=Dn.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=mke(a.content);if(n="/EncryptedPackage",a=Dn.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function F8e(t,e){return e.bookType=="ods"?_se(t,e):e.bookType=="numbers"?j8e(t,e):e.bookType=="xlsb"?O8e(t,e):D8e(t,e)}function O8e(t,e){ev=1024,t&&!t.SSF&&(t.SSF=ei(Gn)),t&&t.SSF&&(E1(),pP(t.SSF),e.revssf=xP(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,$b?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=Zae.indexOf(e.bookType)>-1,a=SR();VR(e=e||{});var s=hR(),o="",l=0;if(e.cellXfs=[],qm(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",ma(s,o,mae(t.Props,e)),a.coreprops.push(o),hs(e.rels,2,o,wa.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(t.SheetNames[d]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,ma(s,o,xae(t.Props)),a.extprops.push(o),hs(e.rels,3,o,wa.EXT_PROPS),t.Custprops!==t.Props&&Gi(t.Custprops||{}).length>0&&(o="docProps/custom.xml",ma(s,o,vae(t.Custprops)),a.custprops.push(o),hs(e.rels,4,o,wa.CUST_PROPS)),l=1;l<=t.SheetNames.length;++l){var u={"!id":{}},f=t.Sheets[t.SheetNames[l-1]],A=(f||{})["!type"]||"sheet";switch(A){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,ma(s,o,uMe(l-1,o,e,t,u)),a.sheets.push(o),hs(e.wbrels,-1,"worksheets/sheet"+l+"."+r,wa.WS[0])}if(f){var h=f["!comments"],m=!1,p="";h&&h.length>0&&(p="xl/comments"+l+"."+r,ma(s,p,AMe(h,p)),a.comments.push(p),hs(u,-1,"../comments"+l+"."+r,wa.CMNT),m=!0),f["!legacy"]&&m&&ma(s,"xl/drawings/vmlDrawing"+l+".vml",Yae(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&ma(s,V2(o),yv(u))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,ma(s,o,hMe(e.Strings,o,e)),a.strs.push(o),hs(e.wbrels,-1,"sharedStrings."+r,wa.SST)),o="xl/workbook."+r,ma(s,o,dMe(t,o)),a.workbooks.push(o),hs(e.rels,1,o,wa.WB),o="xl/theme/theme1.xml",ma(s,o,kR(t.Themes,e)),a.themes.push(o),hs(e.wbrels,-1,"theme/theme1.xml",wa.THEME),o="xl/styles."+r,ma(s,o,fMe(t,o,e)),a.styles.push(o),hs(e.wbrels,-1,"styles."+r,wa.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",ma(s,o,t.vbaraw),a.vba.push(o),hs(e.wbrels,-1,"vbaProject.bin",wa.VBA)),o="xl/metadata."+r,ma(s,o,mMe(o)),a.metadata.push(o),hs(e.wbrels,-1,"metadata."+r,wa.XLMETA),ma(s,"[Content_Types].xml",fae(a,e)),ma(s,"_rels/.rels",yv(e.rels)),ma(s,"xl/_rels/workbook."+r+".rels",yv(e.wbrels)),delete e.revssf,delete e.ssf,s}function D8e(t,e){ev=1024,t&&!t.SSF&&(t.SSF=ei(Gn)),t&&t.SSF&&(E1(),pP(t.SSF),e.revssf=xP(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,$b?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=Zae.indexOf(e.bookType)>-1,a=SR();VR(e=e||{});var s=hR(),o="",l=0;if(e.cellXfs=[],qm(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",ma(s,o,mae(t.Props,e)),a.coreprops.push(o),hs(e.rels,2,o,wa.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(t.SheetNames[d]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,ma(s,o,xae(t.Props)),a.extprops.push(o),hs(e.rels,3,o,wa.EXT_PROPS),t.Custprops!==t.Props&&Gi(t.Custprops||{}).length>0&&(o="docProps/custom.xml",ma(s,o,vae(t.Custprops)),a.custprops.push(o),hs(e.rels,4,o,wa.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,l=1;l<=t.SheetNames.length;++l){var f={"!id":{}},A=t.Sheets[t.SheetNames[l-1]],h=(A||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,ma(s,o,dse(l-1,e,t,f)),a.sheets.push(o),hs(e.wbrels,-1,"worksheets/sheet"+l+"."+r,wa.WS[0])}if(A){var m=A["!comments"],p=!1,x="";if(m&&m.length>0){var v=!1;m.forEach(function(y){y[1].forEach(function(b){b.T==!0&&(v=!0)})}),v&&(x="xl/threadedComments/threadedComment"+l+"."+r,ma(s,x,HFe(m,u,e)),a.threadedcomments.push(x),hs(f,-1,"../threadedComments/threadedComment"+l+"."+r,wa.TCMNT)),x="xl/comments"+l+"."+r,ma(s,x,Jae(m)),a.comments.push(x),hs(f,-1,"../comments"+l+"."+r,wa.CMNT),p=!0}A["!legacy"]&&p&&ma(s,"xl/drawings/vmlDrawing"+l+".vml",Yae(l,A["!comments"])),delete A["!comments"],delete A["!legacy"]}f["!id"].rId1&&ma(s,V2(o),yv(f))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,ma(s,o,Lae(e.Strings,e)),a.strs.push(o),hs(e.wbrels,-1,"sharedStrings."+r,wa.SST)),o="xl/workbook."+r,ma(s,o,mse(t)),a.workbooks.push(o),hs(e.rels,1,o,wa.WB),o="xl/theme/theme1.xml",ma(s,o,kR(t.Themes,e)),a.themes.push(o),hs(e.wbrels,-1,"theme/theme1.xml",wa.THEME),o="xl/styles."+r,ma(s,o,qae(t,e)),a.styles.push(o),hs(e.wbrels,-1,"styles."+r,wa.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",ma(s,o,t.vbaraw),a.vba.push(o),hs(e.wbrels,-1,"vbaProject.bin",wa.VBA)),o="xl/metadata."+r,ma(s,o,Xae()),a.metadata.push(o),hs(e.wbrels,-1,"metadata."+r,wa.XLMETA),u.length>1&&(o="xl/persons/person.xml",ma(s,o,GFe(u)),a.people.push(o),hs(e.wbrels,-1,"persons/person.xml",wa.PEOPLE)),ma(s,"[Content_Types].xml",fae(a,e)),ma(s,"_rels/.rels",yv(e.rels)),ma(s,"xl/_rels/workbook."+r+".rels",yv(e.wbrels)),delete e.revssf,delete e.ssf,s}function HR(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Wd(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function R8e(t,e){return Dn.find(t,"EncryptedPackage")?k8e(t,e):vse(t,e)}function M8e(t,e){var r,n=t,a=e||{};return a.type||(a.type=xa&&Buffer.isBuffer(t)?"buffer":"base64"),r=Qne(n,a),B8e(r,a)}function Sse(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return fF(t.slice(r),e);default:break e}return Gv.to_workbook(t,e)}function L8e(t,e){var r="",n=HR(t,e);switch(e.type){case"base64":r=Wd(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=vg(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Cs(r)),e.type="binary",Sse(r,e)}function U8e(t,e){var r=t;return e.type=="base64"&&(r=Wd(r)),r=D2.utils.decode(1200,r.slice(2),"str"),e.type="binary",Sse(r,e)}function Q8e(t){return t.match(/[^\x00-\x7F]/)?nh(t):t}function X5(t,e,r,n){return n?(r.type="string",Gv.to_workbook(t,r)):Gv.to_workbook(e,r)}function qv(t,e){lR();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return qv(new Uint8Array(t),(r=ei(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),wv={},r.dateNF&&(wv.dateNF=r.dateNF),r.type||(r.type=xa&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=xa?"buffer":"binary",n=O4e(t),typeof Uint8Array<"u"&&!xa&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=Q8e(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=ei(r),r.type="array",qv(cR(n),r)}switch((a=HR(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return R8e(Dn.read(n,r),r);break;case 9:if(a[1]<=8)return vse(n,r);break;case 60:return fF(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return KBe(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return Rae.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?M8e(n,r):X5(t,n,r,s);case 239:return a[3]===60?fF(n,r):X5(t,n,r,s);case 255:if(a[1]===254)return U8e(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return zp.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return zp.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return uF.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return $ae.to_workbook(n,r);break;case 10:case 13:case 32:return L8e(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return GBe.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?uF.to_workbook(n,r):X5(t,n,r,s)}function jse(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Vw(e.file,Dn.write(t,{type:xa?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Dn.write(t,e)}function V8e(t,e){var r=ei(e||{}),n=F8e(t,r);return H8e(n,r)}function H8e(t,e){var r={},n=xa?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var a=t.FullPaths?Dn.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(mP(a))}return e.password&&typeof encrypt_agile<"u"?jse(encrypt_agile(a,e.password),e):e.type==="file"?Vw(e.file,a):e.type=="string"?Cs(a):a}function $8e(t,e){var r=e||{},n=QMe(t,r);return jse(n,r)}function zf(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return R2(nh(n));case"binary":return nh(n);case"string":return t;case"file":return Vw(e.file,n,"utf8");case"buffer":return xa?UA(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):zf(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function G8e(t,e){switch(e.type){case"base64":return R2(t);case"binary":return t;case"string":return t;case"file":return Vw(e.file,t,"binary");case"buffer":return xa?UA(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function t_(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?R2(r):e.type=="string"?Cs(r):r;case"file":return Vw(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function I1(t,e){lR(),RRe(t);var r=ei(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=I1(t,r);return r.type="array",mP(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=t.SheetNames.indexOf(r.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return zf(FMe(t,r),r);case"slk":case"sylk":return zf(Dae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"htm":case"html":return zf(bse(t.Sheets[t.SheetNames[a]],r),r);case"txt":return G8e(Ise(t.Sheets[t.SheetNames[a]],r),r);case"csv":return zf($R(t.Sheets[t.SheetNames[a]],r),r,"\uFEFF");case"dif":return zf(Rae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"dbf":return t_(uF.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"prn":return zf(Gv.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"rtf":return zf($ae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"eth":return zf(Mae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"fods":return zf(_se(t,r),r);case"wk1":return t_(zp.sheet_to_wk1(t.Sheets[t.SheetNames[a]],r),r);case"wk3":return t_(zp.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),t_(yse(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),$8e(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return V8e(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function K8e(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function zv(t,e,r){var n={};return n.type="file",n.file=e,K8e(n),I1(t,n)}function q8e(t,e,r,n,a,s,o,l){var c=uo(r),d=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,A=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(A,"__rowNum__",{value:r,enumerable:!1})}catch{A.__rowNum__=r}else A.__rowNum__=r;if(!o||t[r])for(var h=e.s.c;h<=e.e.c;++h){var m=o?t[r][h]:t[n[h]+c];if(m===void 0||m.t===void 0){if(d===void 0)continue;s[h]!=null&&(A[s[h]]=d);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[h]!=null){if(p==null)if(m.t=="e"&&p===null)A[s[h]]=null;else if(d!==void 0)A[s[h]]=d;else if(u&&p===null)A[s[h]]=null;else continue;else A[s[h]]=u&&(m.t!=="n"||m.t==="n"&&l.rawNumbers!==!1)?p:_A(m,p,l);p!=null&&(f=!1)}}return{row:A,isempty:f}}function sj(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},u=d.range!=null?d.range:t["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof u){case"string":c=Qa(u);break;case"number":c=Qa(t["!ref"]),c.s.r=u;break;default:c=u}n>0&&(a=0);var f=uo(c.s.r),A=[],h=[],m=0,p=0,x=Array.isArray(t),v=c.s.r,y=0,b={};x&&!t[v]&&(t[v]=[]);var w=d.skipHidden&&t["!cols"]||[],I=d.skipHidden&&t["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(w[y]||{}).hidden)switch(A[y]=_i(y),r=x?t[v][y]:t[A[y]+f],n){case 1:s[y]=y-c.s.c;break;case 2:s[y]=A[y];break;case 3:s[y]=d.header[y-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=_A(r,null,d),p=b[o]||0,!p)b[o]=1;else{do l=o+"_"+p++;while(b[l]);b[o]=p,b[l]=1}s[y]=l}for(v=c.s.r+a;v<=c.e.r;++v)if(!(I[v]||{}).hidden){var j=q8e(t,c,v,A,n,s,x,d);(j.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(h[m++]=j.row)}return h.length=m,h}var P$=/"/g;function z8e(t,e,r,n,a,s,o,l){for(var c=!0,d=[],u="",f=uo(r),A=e.s.c;A<=e.e.c;++A)if(n[A]){var h=l.dense?(t[r]||[])[A]:t[n[A]+f];if(h==null)u="";else if(h.v!=null){c=!1,u=""+(l.rawNumbers&&h.t=="n"?h.v:_A(h,null,l));for(var m=0,p=0;m!==u.length;++m)if((p=u.charCodeAt(m))===a||p===s||p===34||l.forceQuotes){u='"'+u.replace(P$,'""')+'"';break}u=="ID"&&(u='"ID"')}else h.f!=null&&!h.F?(c=!1,u="="+h.f,u.indexOf(",")>=0&&(u='"'+u.replace(P$,'""')+'"')):u="";d.push(u)}return l.blankrows===!1&&c?null:d.join(o)}function $R(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var a=Qa(t["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),d=new RegExp((s=="|"?"\\|":s)+"+$"),u="",f=[];n.dense=Array.isArray(t);for(var A=n.skipHidden&&t["!cols"]||[],h=n.skipHidden&&t["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(A[m]||{}).hidden||(f[m]=_i(m));for(var p=0,x=a.s.r;x<=a.e.r;++x)(h[x]||{}).hidden||(u=z8e(t,a,x,f,o,c,s,n),u!=null&&(n.strip&&(u=u.replace(d,"")),(u||n.blankrows!==!1)&&r.push((p++?l:"")+u)));return delete n.dense,r.join("")}function Ise(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=$R(t,e);return r}function W8e(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var a=Qa(t["!ref"]),s="",o=[],l,c=[],d=Array.isArray(t);for(l=a.s.c;l<=a.e.c;++l)o[l]=_i(l);for(var u=a.s.r;u<=a.e.r;++u)for(s=uo(u),l=a.s.c;l<=a.e.c;++l)if(e=o[l]+s,r=d?(t[u]||[])[l]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function Pse(t,e,r){var n=r||{},a=+!n.skipHeader,s=t||{},o=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Ei(n.origin):n.origin;o=c.r,l=c.c}var d,u={s:{c:0,r:0},e:{c:l,r:o+e.length-1+a}};if(s["!ref"]){var f=Qa(s["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),o==-1&&(o=f.e.r+1,u.e.r=o+e.length-1+a)}else o==-1&&(o=0,u.e.r=e.length-1+a);var A=n.header||[],h=0;e.forEach(function(p,x){Gi(p).forEach(function(v){(h=A.indexOf(v))==-1&&(A[h=A.length]=v);var y=p[v],b="z",w="",I=Kn({c:l+h,r:o+x+a});d=W2(s,I),y&&typeof y=="object"&&!(y instanceof Date)?s[I]=y:(typeof y=="number"?b="n":typeof y=="boolean"?b="b":typeof y=="string"?b="s":y instanceof Date?(b="d",n.cellDates||(b="n",y=qo(y)),w=n.dateNF||Gn[14]):y===null&&n.nullError&&(b="e",y=0),d?(d.t=b,d.v=y,delete d.w,delete d.R,w&&(d.z=w)):s[I]=d={t:b,v:y},w&&(d.z=w))})}),u.e.c=Math.max(u.e.c,l+A.length-1);var m=uo(o);if(a)for(h=0;h<A.length;++h)s[_i(h+l)+m]={t:"s",v:A[h]};return s["!ref"]=fa(u),s}function X8e(t,e){return Pse(null,t,e)}function W2(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Ei(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?W2(t,Kn(e)):W2(t,Kn({r:e,c:r||0}))}function Y8e(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function GR(){return{SheetNames:[],Sheets:{}}}function KR(t,e,r,n){var a=1;if(!r)for(;a<=65535&&t.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var o=s&&s[1]||r;for(++a;a<=65535&&t.SheetNames.indexOf(r=o+a)!=-1;++a);}if(Ase(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function J8e(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=Y8e(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Z8e(t,e){return t.z=e,t}function Tse(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function eLe(t,e,r){return Tse(t,"#"+e,r)}function tLe(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function rLe(t,e,r,n){for(var a=typeof e!="string"?e:Qa(e),s=typeof e=="string"?e:fa(e),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l){var c=W2(t,o,l);c.t="n",c.F=s,delete c.v,o==a.s.r&&l==a.s.c&&(c.f=r,n&&(c.D=!0))}return t}var pa={encode_col:_i,encode_row:uo,encode_cell:Kn,encode_range:fa,decode_col:bR,decode_row:yR,split_cell:h5e,decode_cell:Ei,decode_range:md,format_cell:_A,sheet_add_aoa:sae,sheet_add_json:Pse,sheet_add_dom:wse,aoa_to_sheet:S1,json_to_sheet:X8e,table_to_sheet:Nse,table_to_book:c8e,sheet_to_csv:$R,sheet_to_txt:Ise,sheet_to_json:sj,sheet_to_html:bse,sheet_to_formulae:W8e,sheet_to_row_object_array:sj,sheet_get_cell:W2,book_new:GR,book_append_sheet:KR,book_set_sheet_visibility:J8e,cell_set_number_format:Z8e,cell_set_hyperlink:Tse,cell_set_internal_link:eLe,cell_add_comment:tLe,sheet_set_array_formula:rLe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const CP="pollo_cash_audits";async function nLe(t){return(await ta(xt(Ne,CP),{...t,createdAt:t.createdAt??Nr.now()})).id}async function aLe(t){const e=xt(Ne,CP),r=(()=>{if(t!=null&&t.createdFrom&&(t!=null&&t.createdTo)){const s=Nr.fromDate(t.createdFrom),o=Nr.fromDate(t.createdTo);return ar(e,lr("createdAt",">=",s),lr("createdAt","<=",o),kn("createdAt","desc"))}return ar(e,kn("createdAt","desc"))})();return(await Ut(r)).docs.map(s=>{const o=s.data();return{id:s.id,createdAt:o.createdAt,createdByUid:o.createdByUid||"",createdByName:o.createdByName||"",contadorUid:o.contadorUid||"",contadorName:o.contadorName||"",entregadoPor:o.entregadoPor||"",recibidoPor:o.recibidoPor||"",rangeFrom:o.rangeFrom||"",rangeTo:o.rangeTo||"",ventasCash:Number(o.ventasCash||0),abonos:Number(o.abonos||0),ingresosExtra:Number(o.ingresosExtra||0),debitos:Number(o.debitos||0),subTotal:Number(o.subTotal||0),totalEntregado:Number(o.totalEntregado||0),comment:o.comment||""}})}async function sLe(t){await na(Kt(Ne,CP,t))}async function iLe(t,e){await Mn(Kt(Ne,CP,t),e)}const Di=t=>`C$ ${(Number(t)||0).toFixed(2)}`,r_=t=>Number(t||0).toFixed(3),Zi=t=>{const e=Number(String(t??"").replace(/,/g,"."));return isNaN(e)?0:Math.round(e*100)/100},ij=t=>{const e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${e}-${r}-${n}`},rp=()=>{const t=new Date,e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${e}-${r}-${n}`},oLe=()=>{const t=new Date;return ij(new Date(t.getFullYear(),t.getMonth(),1))},lLe=()=>{const t=new Date;return ij(new Date(t.getFullYear(),t.getMonth()+1,0))},cLe=t=>new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0),dLe=t=>new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59),Bse=t=>String(t??"").toLowerCase().trim(),n_=t=>Number(t.qty??t.quantity??0),T$=t=>["lb","lbs","libra","libras"].includes(Bse(t)),B$=t=>["unidad","unidades","ud","uds","pieza","piezas"].includes(Bse(t));function uLe(){const[t,e]=g.useState(!1),[r,n]=g.useState(!1),[a,s]=g.useState(!1),[o,l]=g.useState(!1),[c,d]=g.useState(null),[u,f]=g.useState(!1),[A,h]=g.useState([]),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,I]=g.useState(""),[j,N]=g.useState(rp()),[S,E]=g.useState(rp()),[B,k]=g.useState(0),[T,P]=g.useState(0),[q,de]=g.useState(0),[ce,le]=g.useState(0),[he,ae]=g.useState(""),[Ce,De]=g.useState([]),[O,R]=g.useState(0),[G,M]=g.useState(!1),K=g.useMemo(()=>Zi(B+T+q),[B,T,q]),Y=g.useMemo(()=>Zi(K-ce),[K,ce]),[D,V]=g.useState([]),[te,ve]=g.useState(!1),[Q,Xe]=g.useState(oLe()),[se,Z]=g.useState(lLe()),[ke,Se]=g.useState([]),[Ee,Ze]=g.useState(0),[ot,vt]=g.useState(!1);async function _t(){var ie;const ee=(await Ut(ar(xt(Ne,"users")))).docs.map(pe=>{const fe=pe.data();return{uid:pe.id,name:fe.displayName||fe.name||fe.email||pe.id,role:fe.role,roles:fe.roles}}).filter(pe=>pe.role==="contador"||Array.isArray(pe.roles)&&pe.roles.includes("contador"));h(ee);const Ve=((ie=Vi.currentUser)==null?void 0:ie.uid)||"",$e=ee.find(pe=>pe.uid===Ve)||ee[0];$e&&(p($e.uid),v($e.name))}async function Tt(){ve(!0);try{const je=Q&&se?{createdFrom:cLe(new Date(Q)),createdTo:dLe(new Date(se))}:void 0,We=await aLe(je);V(We)}finally{ve(!1)}}g.useEffect(()=>{_t(),Tt()},[]),g.useEffect(()=>{Tt()},[Q,se]),g.useEffect(()=>{(async()=>{if(!(!Q||!se)){vt(!0);try{const We=ar(xt(Ne,"salesV2"),lr("date",">=",Q),lr("date","<=",se)),ee=await Ut(We),Ve=[];ee.forEach(pe=>{const fe=pe.data(),Me=fe.date??"";if(Array.isArray(fe.items)&&fe.items.length>0){fe.items.forEach((me,ye)=>{const mt=String(me.productName??"(sin nombre)"),gt=Number(me.qty??0),yt=Number(me.lineFinal??0)||Math.max(0,Number(me.unitPrice||0)*gt-Number(me.discount||0));Ve.push({id:`${pe.id}#${ye}`,date:Me,productName:mt,quantity:gt,amount:yt,measurement:me.measurement??fe.measurement??"",type:fe.type??"CONTADO"})});return}Ve.push({id:pe.id,date:Me,productName:fe.productName??"(sin nombre)",quantity:Number(fe.quantity??0),amount:Number(fe.amount??fe.amountCharged??0),measurement:fe.measurement??"",type:fe.type??"CONTADO"})}),Se(Ve);const rt=await Ut(xt(Ne,"ar_movements_pollo"));let $e=0;const ie=pe=>{var fe;return pe!=null&&pe.date?String(pe.date):(fe=pe==null?void 0:pe.createdAt)!=null&&fe.toDate?ij(pe.createdAt.toDate()):""};rt.forEach(pe=>{const fe=pe.data();if(String(fe.type??"").toUpperCase()!=="ABONO")return;const me=Math.abs(Number(fe.amount??0)),ye=ie(fe);ye&&ye>=Q&&ye<=se&&($e+=me)}),Ze($e)}catch(We){console.error("Error cargando KPIs del periodo:",We),Se([]),Ze(0)}finally{vt(!1)}}})()},[Q,se]),g.useEffect(()=>{(async()=>{if(!(!j||!S)){M(!0);try{const We=ar(xt(Ne,"salesV2"),lr("date",">=",j),lr("date","<=",S)),ee=await Ut(We),Ve=[];ee.forEach(pe=>{const fe=pe.data(),Me=fe.date??"";if(Array.isArray(fe.items)&&fe.items.length>0){fe.items.forEach((me,ye)=>{const mt=String(me.productName??"(sin nombre)"),gt=Number(me.qty??0),yt=Number(me.lineFinal??0)||Math.max(0,Number(me.unitPrice||0)*gt-Number(me.discount||0));Ve.push({id:`${pe.id}#${ye}`,date:Me,productName:mt,quantity:gt,amount:yt,measurement:me.measurement??fe.measurement??"",type:fe.type??"CONTADO"})});return}Ve.push({id:pe.id,date:Me,productName:fe.productName??"(sin nombre)",quantity:Number(fe.quantity??0),amount:Number(fe.amount??fe.amountCharged??0),measurement:fe.measurement??"",type:fe.type??"CONTADO"})}),De(Ve);const rt=await Ut(xt(Ne,"ar_movements_pollo"));let $e=0;const ie=pe=>{var fe;return pe!=null&&pe.date?String(pe.date):(fe=pe==null?void 0:pe.createdAt)!=null&&fe.toDate?ij(pe.createdAt.toDate()):""};rt.forEach(pe=>{const fe=pe.data();if(String(fe.type??"").toUpperCase()!=="ABONO")return;const me=Math.abs(Number(fe.amount??0)),ye=ie(fe);ye&&ye>=j&&ye<=S&&($e+=me)}),R($e)}catch(We){console.error("Error cargando KPI de modal:",We),De([]),R(0)}finally{M(!1)}}})()},[j,S]);const Lt=g.useMemo(()=>{const je=D.reduce((Ve,rt)=>Ve+(Number(rt.totalEntregado)||0),0),We=D.reduce((Ve,rt)=>Ve+(Number(rt.debitos)||0),0),ee=D.reduce((Ve,rt)=>Ve+(Number(rt.subTotal)||0),0);return{sumTotal:Zi(je),sumDeb:Zi(We),sumSub:Zi(ee)}},[D]),Rt=g.useMemo(()=>{const je=ke.filter(fe=>fe.type==="CONTADO"),We=ke.filter(fe=>fe.type==="CREDITO"),ee=je.reduce((fe,Me)=>fe+(Me.amount||0),0),Ve=ee+Ee,rt=je.reduce((fe,Me)=>T$(Me.measurement)?fe+n_(Me):fe,0),$e=je.reduce((fe,Me)=>B$(Me.measurement)?fe+n_(Me):fe,0),ie=We.reduce((fe,Me)=>T$(Me.measurement)?fe+n_(Me):fe,0),pe=We.reduce((fe,Me)=>B$(Me.measurement)?fe+n_(Me):fe,0);return{ventasCash:Zi(ee),recaudado:Zi(Ve),lbsCash:r_(rt),unitsCash:r_($e),lbsCredit:r_(ie),unitsCredit:r_(pe)}},[ke,Ee]),Et=g.useMemo(()=>{const ee=Ce.filter(Ve=>Ve.type==="CONTADO").reduce((Ve,rt)=>Ve+(rt.amount||0),0)+O;return{recaudado:Zi(ee)}},[Ce,O]);function Re(){b(""),I(""),N(rp()),E(rp()),k(0),P(0),de(0),le(0),ae(""),s(!1),l(!1),d(null)}function Te(je){d(je.id),e(!0),s(!0),l(!0),p(je.contadorUid||""),v(je.contadorName||""),b(je.recibidoPor||""),I(je.entregadoPor||""),N(je.rangeFrom||rp()),E(je.rangeTo||rp()),k(Number(je.ventasCash||0)),P(Number(je.abonos||0)),de(Number(je.ingresosExtra||0)),le(Number(je.debitos||0)),ae(je.comment||"")}async function Ye(){var je,We,ee;if(!m)return alert("Seleccione Contador.");if(!y.trim())return alert("Recibido por es obligatorio.");if(!j||!S)return alert("Seleccione el rango arqueado.");if(new Date(j)>new Date(S))return alert("Rango invlido: Desde no puede ser mayor que Hasta.");n(!0);try{if(c)await iLe(c,{contadorUid:m,contadorName:x,recibidoPor:y.trim(),entregadoPor:w.trim(),rangeFrom:j,rangeTo:S,ventasCash:Zi(B),abonos:Zi(T),ingresosExtra:Zi(q),debitos:Zi(ce),subTotal:Zi(K),totalEntregado:Zi(Y),comment:he.trim()});else{const Ve=((je=Vi.currentUser)==null?void 0:je.uid)||"",rt=((We=Vi.currentUser)==null?void 0:We.displayName)||((ee=Vi.currentUser)==null?void 0:ee.email)||Ve;await nLe({createdAt:Nr.now(),createdByUid:Ve,createdByName:rt,contadorUid:m,contadorName:x,recibidoPor:y.trim(),entregadoPor:w.trim(),rangeFrom:j,rangeTo:S,ventasCash:Zi(B),abonos:Zi(T),ingresosExtra:Zi(q),debitos:Zi(ce),subTotal:Zi(K),totalEntregado:Zi(Y),comment:he.trim()})}e(!1),Re(),await Tt()}finally{n(!1)}}async function dt(je){var ee;if(window.confirm(`Eliminar el arqueo creado el ${(ee=je.createdAt)!=null&&ee.toDate?je.createdAt.toDate().toLocaleString():""}?`)){n(!0);try{await sLe(je.id),await Tt()}finally{n(!1)}}}function Fe(){const je=D.map(Ve=>{var rt;return{"Fecha de creacin":(rt=Ve.createdAt)!=null&&rt.toDate?Ve.createdAt.toDate().toLocaleString():"","Rango arqueado":`${Ve.rangeFrom} a ${Ve.rangeTo}`,"Arqueado por (Contador)":Ve.contadorName,"Recibido por":Ve.recibidoPor,"Entregado por":Ve.entregadoPor,"Ventas cash":Ve.ventasCash,Abonos:Ve.abonos,"Ingresos extra":Ve.ingresosExtra,"Sub total":Ve.subTotal,Dbitos:Ve.debitos,"Monto entregado":Ve.totalEntregado,Comentario:Ve.comment||""}}),We=pa.json_to_sheet(je),ee=pa.book_new();pa.book_append_sheet(ee,We,"Arqueos"),zv(ee,`arqueos_pollo_${rp()}.xlsx`)}return i.jsxs("div",{className:"p-3 md:p-6",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3 flex-wrap",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg md:text-xl font-semibold",children:"Arqueo fsico y entregas (Pollo)"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Registro de arqueos, dbitos por gasto/reabastecimiento y monto entregado."})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>{Re(),e(!0)},className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",children:"+ Nuevo arqueo"}),i.jsx("button",{onClick:Fe,className:"px-3 py-2 rounded bg-emerald-600 text-white text-sm hover:bg-emerald-700",children:"Exportar Excel"})]})]}),i.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Filtro por fecha (creacin)"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",value:Q,onChange:je=>Xe(je.target.value),className:"w-full border rounded px-2 py-2 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",value:se,onChange:je=>Z(je.target.value),className:"w-full border rounded px-2 py-2 text-sm"})]})]}),i.jsx("button",{onClick:()=>{Xe(""),Z("")},className:"mt-2 text-xs text-blue-600 hover:underline",children:"Limpiar filtro"})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3 hidden md:block",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Monto entregado"}),i.jsx("div",{className:"text-xl font-semibold",children:Di(Lt.sumTotal)}),i.jsx("div",{className:"text-xs text-gray-400",children:"Suma de Total (Sub total - Dbitos)"})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3 hidden md:block",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Dbitos"}),i.jsx("div",{className:"text-lg font-semibold",children:Di(Lt.sumDeb)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Sub totales"}),i.jsx("div",{className:"text-lg font-semibold",children:Di(Lt.sumSub)})]})]}),i.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Sumas del listado filtrado"})]})]}),i.jsxs("div",{className:"mt-3 hidden md:grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-3",children:[i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas cash (perodo)"}),i.jsx("div",{className:"text-lg font-semibold",children:Di(Rt.ventasCash)}),ot&&i.jsx("div",{className:"text-[11px] text-gray-400",children:"Actualizando"})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Recaudado (perodo)"}),i.jsx("div",{className:"text-lg font-semibold",children:Di(Rt.recaudado)}),i.jsx("div",{className:"text-[11px] text-gray-400",children:"Cash + abonos"})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Libras cash"}),i.jsx("div",{className:"text-lg font-semibold",children:Rt.lbsCash})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Unidades cash"}),i.jsx("div",{className:"text-lg font-semibold",children:Rt.unitsCash})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Libras crdito"}),i.jsx("div",{className:"text-lg font-semibold",children:Rt.lbsCredit})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Unidades crdito"}),i.jsx("div",{className:"text-lg font-semibold",children:Rt.unitsCredit})]})]}),i.jsx("div",{className:"mt-3 md:hidden",children:i.jsx(Y5,{title:"KPIs",open:u,onToggle:()=>f(je=>!je),children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Monto entregado"}),i.jsx("div",{className:"text-lg font-semibold",children:Di(Lt.sumTotal)}),i.jsx("div",{className:"text-xs text-gray-400",children:"Suma de Total (Sub total - Dbitos)"})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Dbitos"}),i.jsx("div",{className:"text-lg font-semibold",children:Di(Lt.sumDeb)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Sub totales"}),i.jsx("div",{className:"text-lg font-semibold",children:Di(Lt.sumSub)})]})]}),i.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Sumas del listado filtrado"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas cash (perodo)"}),i.jsx("div",{className:"text-lg font-semibold",children:Di(Rt.ventasCash)}),ot&&i.jsx("div",{className:"text-[11px] text-gray-400",children:"Actualizando"})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Recaudado (perodo)"}),i.jsx("div",{className:"text-lg font-semibold",children:Di(Rt.recaudado)}),i.jsx("div",{className:"text-[11px] text-gray-400",children:"Cash + abonos"})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Libras cash"}),i.jsx("div",{className:"text-lg font-semibold",children:Rt.lbsCash})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Unidades cash"}),i.jsx("div",{className:"text-lg font-semibold",children:Rt.unitsCash})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Libras crdito"}),i.jsx("div",{className:"text-lg font-semibold",children:Rt.lbsCredit})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Unidades crdito"}),i.jsx("div",{className:"text-lg font-semibold",children:Rt.unitsCredit})]})]})]})})}),i.jsx("div",{className:"mt-4 block md:hidden space-y-3",children:te?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Cargando"}):D.length===0?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"No hay arqueos en este rango."}):D.map(je=>{var We;return i.jsxs("div",{className:"bg-white border rounded-2xl p-3 shadow-sm",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Fecha de creacin"}),i.jsx("div",{className:"font-semibold text-sm",children:(We=je.createdAt)!=null&&We.toDate?je.createdAt.toDate().toLocaleString():""}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Rango arqueado"}),i.jsxs("div",{className:"text-sm",children:[je.rangeFrom," a ",je.rangeTo]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Monto entregado"}),i.jsx("div",{className:"font-semibold",children:Di(je.totalEntregado)})]})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-xs text-gray-600",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Contador:"})," ",je.contadorName]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Recibido:"})," ",je.recibidoPor]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Sub total:"})," ",Di(je.subTotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Dbitos:"})," ",Di(je.debitos)]})]}),i.jsxs("div",{className:"mt-3 flex justify-end",children:[i.jsx("button",{type:"button",onClick:()=>Te(je),className:"text-xs px-3 py-1.5 rounded border text-gray-700 hover:bg-gray-50",disabled:r,children:"Editar"}),i.jsx("button",{type:"button",onClick:()=>dt(je),className:"ml-2 text-xs px-3 py-1.5 rounded bg-red-600 text-white hover:bg-red-700 disabled:opacity-60",disabled:r,children:"Eliminar"})]})]},je.id)})}),i.jsxs("div",{className:"mt-4 bg-white rounded shadow overflow-hidden hidden md:block",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsx("div",{className:"text-sm font-semibold",children:"Arqueos guardados"}),i.jsx("div",{className:"text-xs text-gray-500",children:te?"Cargando...":`${D.length} registro(s)`})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-[900px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50 text-gray-600",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left px-3 py-2",children:"Fecha de creacin"}),i.jsx("th",{className:"text-left px-3 py-2",children:"Rango arqueado"}),i.jsx("th",{className:"text-left px-3 py-2",children:"Arqueado por"}),i.jsx("th",{className:"text-left px-3 py-2",children:"Recibido por"}),i.jsx("th",{className:"text-right px-3 py-2",children:"Sub total"}),i.jsx("th",{className:"text-right px-3 py-2",children:"Dbitos"}),i.jsx("th",{className:"text-right px-3 py-2",children:"Monto entregado"}),i.jsx("th",{className:"text-right px-3 py-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[!te&&D.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"px-3 py-6 text-center text-gray-500",children:"No hay arqueos en este rango."})}),D.map(je=>{var We;return i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"px-3 py-2",children:(We=je.createdAt)!=null&&We.toDate?je.createdAt.toDate().toLocaleString():""}),i.jsxs("td",{className:"px-3 py-2",children:[je.rangeFrom," a ",je.rangeTo]}),i.jsx("td",{className:"px-3 py-2",children:je.contadorName}),i.jsx("td",{className:"px-3 py-2",children:je.recibidoPor}),i.jsx("td",{className:"px-3 py-2 text-right font-medium",children:Di(je.subTotal)}),i.jsx("td",{className:"px-3 py-2 text-right",children:Di(je.debitos)}),i.jsx("td",{className:"px-3 py-2 text-right font-semibold",children:Di(je.totalEntregado)}),i.jsxs("td",{className:"px-3 py-2 text-right",children:[i.jsx("button",{type:"button",onClick:()=>Te(je),className:"text-xs px-3 py-1.5 rounded border text-gray-700 hover:bg-gray-50",disabled:r,children:"Editar"}),i.jsx("button",{type:"button",onClick:()=>dt(je),className:"ml-2 text-xs px-3 py-1.5 rounded bg-red-600 text-white hover:bg-red-700 disabled:opacity-60",disabled:r,children:"Eliminar"})]})]},je.id)})]})]})})]}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-3xl rounded shadow-lg overflow-hidden",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsx("div",{className:"font-semibold",children:c?"Editar arqueo":"Nuevo arqueo"}),i.jsx("button",{onClick:()=>{e(!1),Re()},className:"text-sm px-2 py-1 rounded hover:bg-gray-100",children:""})]}),i.jsxs("div",{className:"p-3 md:p-4 space-y-3 text-sm",children:[i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsx(Y5,{title:"Datos colaboradores",open:a,onToggle:()=>s(je=>!je),children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Contador"}),i.jsxs("select",{value:m,onChange:je=>{const We=je.target.value,ee=A.find(Ve=>Ve.uid===We);p(We),v((ee==null?void 0:ee.name)||"")},className:"w-full border rounded px-2 py-2",children:[A.length===0&&i.jsx("option",{value:"",children:"(No hay contadores)"}),A.map(je=>i.jsx("option",{value:je.uid,children:je.name},je.uid))]}),i.jsx("div",{className:"text-[11px] text-gray-400 mt-1",children:"Por default se selecciona el contador logueado si aplica."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Recibido por (obligatorio)"}),i.jsx("input",{value:y,onChange:je=>b(je.target.value),className:"w-full border rounded px-2 py-2",placeholder:"Nombre de quien recibe el dinero"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Entregado por"}),i.jsx("input",{value:w,onChange:je=>I(je.target.value),className:"w-full border rounded px-2 py-2",placeholder:"Nombre de quien entrega el dinero"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Rango cierre ventas"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("input",{type:"date",value:j,onChange:je=>N(je.target.value),className:"w-full border rounded px-2 py-2"}),i.jsx("input",{type:"date",value:S,onChange:je=>E(je.target.value),className:"w-full border rounded px-2 py-2"})]})]})]})}),i.jsxs(Y5,{title:"Inputs y KPIs",open:o,onToggle:()=>l(je=>!je),children:[i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-3 mb-3",children:[i.jsx("div",{className:"text-xs text-blue-700",children:"Recaudado en el rango (Ventas cash + abonos)"}),i.jsx("div",{className:"text-lg font-semibold text-blue-900",children:Di(Et.recaudado)}),G&&i.jsx("div",{className:"text-[11px] text-blue-600",children:"Actualizando"})]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsx(y0,{label:"Ventas cash",value:B,onChange:k}),i.jsx(y0,{label:"Abonos",value:T,onChange:P}),i.jsx(y0,{label:"Ingresos extra oficiales",value:q,onChange:de}),i.jsx(y0,{label:"Dbitos (gasto o reabastecimiento)",value:ce,onChange:le})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3",children:[i.jsx(a_,{title:"Sub total (ventas + abonos + ingresos)",value:Di(K)}),i.jsx(a_,{title:"Total (sub total - dbitos)",value:Di(Y)})]})]})]}),i.jsxs("div",{className:"hidden md:block space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Contador"}),i.jsxs("select",{value:m,onChange:je=>{const We=je.target.value,ee=A.find(Ve=>Ve.uid===We);p(We),v((ee==null?void 0:ee.name)||"")},className:"w-full border rounded px-2 py-2",children:[A.length===0&&i.jsx("option",{value:"",children:"(No hay contadores)"}),A.map(je=>i.jsx("option",{value:je.uid,children:je.name},je.uid))]}),i.jsx("div",{className:"text-[11px] text-gray-400 mt-1",children:"Por default se selecciona el contador logueado si aplica."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Recibido por (obligatorio)"}),i.jsx("input",{value:y,onChange:je=>b(je.target.value),className:"w-full border rounded px-2 py-2",placeholder:"Nombre de quien recibe el dinero"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Entregado por"}),i.jsx("input",{value:w,onChange:je=>I(je.target.value),className:"w-full border rounded px-2 py-2",placeholder:"Nombre de quien entrega el dinero"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Rango cierre ventas"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("input",{type:"date",value:j,onChange:je=>N(je.target.value),className:"w-full border rounded px-2 py-2"}),i.jsx("input",{type:"date",value:S,onChange:je=>E(je.target.value),className:"w-full border rounded px-2 py-2"})]})]})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-3",children:[i.jsx("div",{className:"text-xs text-blue-700",children:"Recaudado en el rango (Ventas cash + abonos)"}),i.jsx("div",{className:"text-lg font-semibold text-blue-900",children:Di(Et.recaudado)}),G&&i.jsx("div",{className:"text-[11px] text-blue-600",children:"Actualizando"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsx(y0,{label:"Ventas cash",value:B,onChange:k}),i.jsx(y0,{label:"Abonos",value:T,onChange:P}),i.jsx(y0,{label:"Ingresos extra oficiales",value:q,onChange:de}),i.jsx(y0,{label:"Dbitos (gasto o reabastecimiento)",value:ce,onChange:le})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsx(a_,{title:"Sub total (ventas + abonos + ingresos)",value:Di(K)}),i.jsx(a_,{title:"Total (sub total - dbitos)",value:Di(Y)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Comentario / Nota"}),i.jsx("textarea",{value:he,onChange:je=>ae(je.target.value),className:"w-full border rounded px-2 py-2 min-h-[90px]",placeholder:"Opcional..."})]})]}),i.jsxs("div",{className:"p-3 border-t flex items-center justify-end gap-2",children:[i.jsx("button",{onClick:()=>{e(!1),Re()},className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",disabled:r,children:"Cancelar"}),i.jsx("button",{onClick:Ye,className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700 disabled:opacity-60",disabled:r,children:r?"Guardando...":c?"Guardar cambios":"Guardar arqueo"})]})]})})]})}function a_({title:t,value:e}){return i.jsxs("div",{className:"bg-gray-50 border rounded p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:t}),i.jsx("div",{className:"text-lg font-semibold",children:e})]})}function y0({label:t,value:e,onChange:r}){return i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:t}),i.jsx("input",{inputMode:"decimal",value:String(e),onChange:n=>r(Zi(n.target.value)),className:"w-full border rounded px-2 py-2",placeholder:"0.00"})]})}function Y5({title:t,open:e,onToggle:r,children:n}){return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[i.jsx("div",{className:"font-semibold text-sm",children:t}),i.jsx("button",{type:"button",onClick:r,className:"text-xs px-3 py-1.5 rounded border hover:bg-gray-50",children:e?"Cerrar":"Ver"})]}),e&&i.jsx("div",{className:"px-3 pb-3 pt-1",children:n})]})}const Hs=t=>`C$ ${Number(t??0).toFixed(2)}`,np=t=>Number(t??0).toFixed(3);async function fLe(t){const e=new Set;for(const n of t)for(const a of n.batches||[]){const s=(a.batchId||a.id||"").trim();if(!s)continue;(a.purchasePrice===void 0||a.purchasePrice===null)&&(a.invoiceTotal===void 0||a.invoiceTotal===null)&&e.add(s)}if(e.size===0)return t;const r=new Map;return await Promise.all(Array.from(e).map(async n=>{try{const a=await Es(Kt(Ne,"inventory_batches",n));if(a.exists()){const s=a.data();r.set(n,Number(s.purchasePrice||0))}}catch{}})),t.map(n=>({...n,batches:(n.batches||[]).map(a=>{if((a.purchasePrice===void 0||a.purchasePrice===null)&&(a.invoiceTotal===void 0||a.invoiceTotal===null)){const s=(a.batchId||a.id||"").trim(),o=s?r.get(s):void 0;if(o!==void 0)return{...a,purchasePrice:o}}return a})}))}function J5(t){var p,x;const e=t.batches||[],r=t.expenses||[],n=t.adjustments||[],a=Number(((p=t.totals)==null?void 0:p.lbs)??t.totalLbs??0),s=Number(((x=t.totals)==null?void 0:x.units)??t.totalUnits??0);let o=0,l=0;for(const v of e){const y=Number(v.quantity??0);let b=v.expectedTotal!==void 0&&v.expectedTotal!==null?Number(v.expectedTotal):y*Number(v.salePrice??0);isFinite(b)||(b=0);let w=y*Number(v.purchasePrice??Number.NaN);isFinite(w)||(w=v.invoiceTotal!==void 0&&v.invoiceTotal!==null?Number(v.invoiceTotal):0),o+=b,l+=w}const c=r.reduce((v,y)=>v+Number(y.amount||0),0),d=n.filter(v=>v.type==="DEBITO").reduce((v,y)=>v+Number(y.amount||0),0),u=n.filter(v=>v.type==="CREDITO").reduce((v,y)=>v+Number(y.amount||0),0),f=t.totalDebits!==void 0?Number(t.totalDebits):d,A=t.totalCredits!==void 0?Number(t.totalCredits):u,h=o-l,m=o-c-f+A;return{lbs:a,units:s,expectedSum:o,invoicedSum:l,expenses:c,debits:f,credits:A,grossProfit:h,finalAmount:m}}function hLe(){const[t,e]=g.useState([]),[r,n]=g.useState(!0),[a,s]=g.useState(null),o=g.useRef(null),[l,c]=g.useState(!1),[d,u]=g.useState([]),[f,A]=g.useState(""),[h,m]=g.useState(""),[p,x]=g.useState(""),[v,y]=g.useState(""),b=t.filter(P=>{let q=!0;return f&&P.date<f&&(q=!1),h&&P.date>h&&(q=!1),p&&!(P.number||"").toLowerCase().includes(p.toLowerCase())&&(q=!1),v&&P.status!==v&&(q=!1),q}),[w,I]=g.useState(1),j=5,N=Math.ceil(b.length/j)||1,S=b.slice((w-1)*j,w*j);wi.useEffect(()=>{I(1)},[f,h,p,v,t]);const E=async()=>{n(!0);const P=ar(xt(Ne,"invoices"),kn("date","desc")),q=await Ut(P),de=[];q.forEach(ae=>{const Ce=ae.data();de.push({id:ae.id,...Ce,batches:Ce.batches||[],expenses:Ce.expenses||[],adjustments:Ce.adjustments||[],totals:Ce.totals||{lbs:Ce.totalLbs||0,units:Ce.totalUnits||0,amount:Ce.totalAmount||0,expenses:Ce.totalExpenses||0,finalAmount:Ce.finalAmount||0,invoiceTotal:Ce.invoiceTotal||0},totalDebits:Ce.totalDebits||0,totalCredits:Ce.totalCredits||0})});const ce=await fLe(de);e(ce);const le=await Ut(xt(Ne,"inventory_batches")),he=[];le.forEach(ae=>{const Ce=ae.data();he.push({id:ae.id,...Ce})}),u(he),n(!1)};g.useEffect(()=>{E()},[]);const B=async P=>{const q=P.status==="PAGADA"?"PENDIENTE":"PAGADA";await Mn(Kt(Ne,"invoices",P.id),{status:q}),e(de=>de.map(ce=>ce.id===P.id?{...ce,status:q}:ce)),(a==null?void 0:a.id)===P.id&&s({...P,status:q})},k=async P=>{if(window.confirm(`Eliminar factura del ${P.date}?`))try{const q=Kt(Ne,"invoices",P.id),de=await Es(q),ce=de.exists()?de.data():null,le=Lc(Ne),he=(ce==null?void 0:ce.batches)||[];for(const ae of he){const Ce=ae.batchId||ae.id;if(!Ce)continue;const De=Kt(Ne,"inventory_batches",Ce);le.update(De,{invoiceId:null,invoiceNumber:null,invoiceTotal:null})}le.delete(q),await le.commit(),e(ae=>ae.filter(Ce=>Ce.id!==P.id)),(a==null?void 0:a.id)===P.id&&s(null)}catch(q){console.error(q),alert("No se pudo eliminar la factura por completo.")}},T=async()=>{if(!o.current||!a)return;const P=o.current,q=await $m(P,{backgroundColor:"#ffffff",onclone:ae=>{const Ce=ae.body;Ce.style.background="#ffffff",Ce.querySelectorAll("*").forEach(De=>{const O=ae.defaultView.getComputedStyle(De);O.boxShadow&&O.boxShadow!=="none"&&(De.style.boxShadow="none")})},scale:2}),de=q.toDataURL("image/png"),ce=new An("p","mm","a4"),le=ce.internal.pageSize.getWidth(),he=q.height*le/q.width;ce.addImage(de,"PNG",0,0,le,he),ce.save(`factura_${a.number||a.date}.pdf`)};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded shadow",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Facturacin"}),i.jsx("div",{className:"mb-4 flex justify-end",children:i.jsx("button",{type:"button",className:"px-4 py-2 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",onClick:()=>c(!0),children:"Crear factura"})}),l&&i.jsx(Nne,{paidBatches:d,onClose:()=>c(!1),onCreated:()=>{c(!1),E()}}),i.jsxs("div",{className:"bg-white p-3 rounded-xl shadow border mb-4 flex flex-wrap gap-3 items-end",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:f,onChange:P=>A(P.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:h,onChange:P=>m(P.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold mb-1",children:"N factura"}),i.jsx("input",{type:"text",className:"border rounded px-2 py-1",placeholder:"Buscar...",value:p,onChange:P=>x(P.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold mb-1",children:"Estado"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:v,onChange:P=>y(P.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"PAGADA",children:"Pagada"}),i.jsx("option",{value:"PENDIENTE",children:"Pendiente"})]})]}),i.jsx("button",{type:"button",className:"ml-auto text-xs px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{A(""),m(""),x(""),y("")},children:"Limpiar filtros"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-4",children:i.jsxs("table",{className:"min-w-full w-full- text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"N factura"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Libras"}),i.jsx("th",{className:"p-2 border",children:"Unidades"}),i.jsx("th",{className:"p-2 border",children:"Facturado"}),i.jsx("th",{className:"p-2 border",children:"Ventas"}),i.jsx("th",{className:"p-2 border",children:"Gastos"}),i.jsx("th",{className:"p-2 border",children:"Dbitos"}),i.jsx("th",{className:"p-2 border",children:"Crditos"}),i.jsx("th",{className:"p-2 border",children:"Monto final"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsxs("tbody",{children:[r?i.jsx("tr",{children:i.jsx("td",{colSpan:13,className:"p-4 text-center",children:"Cargando"})}):S.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:13,className:"p-4 text-center",children:"Sin facturas"})}):S.map(P=>{const q=J5(P);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:P.date}),i.jsx("td",{className:"p-2 border",children:P.number||""}),i.jsx("td",{className:"p-2 border",children:P.description||""}),i.jsx("td",{className:"p-2 border",children:np(q.lbs)}),i.jsx("td",{className:"p-2 border",children:np(q.units)}),i.jsx("td",{className:"p-2 border",children:Hs(q.invoicedSum)}),i.jsx("td",{className:"p-2 border",children:Hs(q.expectedSum)}),i.jsx("td",{className:"p-2 border",children:Hs(q.expenses)}),i.jsx("td",{className:"p-2 border",children:Hs(q.debits)}),i.jsx("td",{className:"p-2 border",children:Hs(q.credits)}),i.jsx("td",{className:"p-2 border",children:Hs(q.finalAmount)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${P.status==="PAGADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:P.status})}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",onClick:()=>s(P),children:"Ver"}),i.jsx("button",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",onClick:()=>B(P),children:P.status==="PAGADA"?"Marcar PENDIENTE":"Marcar PAGADA"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>k(P),children:"Eliminar"})]})})]},P.id)}),i.jsxs("div",{className:"flex justify-center items-center gap-2 mb-4",children:[i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-50",onClick:()=>I(P=>Math.max(1,P-1)),disabled:w===1,children:"Anterior"}),i.jsxs("span",{className:"text-sm",children:["Pgina ",w," de ",N]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-50",onClick:()=>I(P=>Math.min(N,P+1)),disabled:w===N,children:"Siguiente"})]})]})]})}),a&&i.jsxs("div",{ref:o,className:"bg-white p-4 rounded shadow-2xl",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsxs("h3",{className:"text-lg font-semibold",children:["Detalle ",a.date," ",a.number?` ${a.number}`:""]}),i.jsx("button",{className:"ml-auto px-3 py-1 border rounded",onClick:()=>s(null),children:"Cerrar"}),i.jsx("button",{onClick:T,className:"bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Imprimir PDF"})]}),(()=>{const P=J5(a);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Estado:"})," ",a.status]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras:"})," ",np(P.lbs)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades:"})," ",np(P.units)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Monto Facturado:"})," ",Hs(P.invoicedSum)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Monto Ventas (Esperado):"})," ",Hs(P.expectedSum)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia Bruta:"})," ",Hs(P.grossProfit)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Gastos:"})," ",Hs(P.expenses)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Dbitos:"})," ",Hs(P.debits)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Crditos:"})," ",Hs(P.credits)]})]})]})})(),i.jsx("h4",{className:"font-semibold mb-1",children:"Lotes"}),i.jsxs("table",{className:"min-w-full text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Cantidad"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Ganancia bruta"})]})}),i.jsx("tbody",{children:(a.batches||[]).map((P,q)=>{const de=Number(P.quantity??0),ce=P.expectedTotal!==void 0&&P.expectedTotal!==null?Number(P.expectedTotal):de*Number(P.salePrice??0);let le=de*Number(P.purchasePrice??Number.NaN);isFinite(le)||(le=P.invoiceTotal!==void 0&&P.invoiceTotal!==null?Number(P.invoiceTotal):0);const he=ce-le;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:P.productName||"(sin nombre)"}),i.jsx("td",{className:"p-2 border",children:(P.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:np(P.quantity)}),i.jsx("td",{className:"p-2 border",children:Hs(P.salePrice)}),i.jsx("td",{className:"p-2 border",children:Hs(le)}),i.jsx("td",{className:"p-2 border",children:Hs(ce)}),i.jsx("td",{className:"p-2 border",children:Hs(he)})]},q)})})]}),i.jsx("h4",{className:"font-semibold mb-1",children:"Gastos"}),i.jsxs("table",{className:"min-w-full text-sm shadow-xl mb-4",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:(a.expenses||[]).length>0?(a.expenses||[]).map((P,q)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:P.date}),i.jsx("td",{className:"p-2 border",children:P.description}),i.jsx("td",{className:"p-2 border",children:Hs(P.amount)})]},q)):i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500",children:"Sin gastos"})})})]}),i.jsx("h4",{className:"font-semibold mb-1",children:"Cargos extras (Notas crdito/dbito)"}),i.jsxs("table",{className:"min-w-full text-sm shadow-xl mb-4",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo de cargo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Fecha"})]})}),i.jsx("tbody",{children:(a.adjustments||[]).length>0?(a.adjustments||[]).map((P,q)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:P.description}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${P.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:P.type})}),i.jsx("td",{className:"p-2 border",children:Hs(P.amount)}),i.jsx("td",{className:"p-2 border",children:a.date})]},q)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin cargos extras"})})})]}),(()=>{const P=J5(a);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-2 justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:["Total libras: ",i.jsx("strong",{children:np(P.lbs)})]}),i.jsxs("div",{children:["Total unidades: ",i.jsx("strong",{children:np(P.units)})]})]}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Total facturado (costo):"," ",i.jsx("strong",{children:Hs(P.invoicedSum)})]}),i.jsxs("div",{children:["Total esperado (ventas):"," ",i.jsx("strong",{children:Hs(P.expectedSum)})]}),i.jsxs("div",{children:["Ganancia bruta (esperado  facturado):"," ",i.jsx("strong",{children:Hs(P.grossProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:Hs(P.expenses)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:Hs(P.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:Hs(P.credits)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-4 text-center",children:[i.jsx("span",{className:"block text-lg font-semibold text-gray-800",children:"Monto final (esperado  gastos  dbitos + crditos):"}),i.jsx("span",{className:"block text-2xl font-bold text-blue-700 mt-1",children:Hs(P.finalAmount)})]})})]})})()]})]})}const s_=t=>Math.round((Number(t)||0)*100)/100,i_=t=>Math.round((Number(t)||0)*1e3)/1e3,ALe=t=>String(t??"").toLowerCase().trim(),mF=t=>["lb","lbs","libra","libras"].includes(ALe(t)),k$=t=>!mF(t);async function mLe(t,e){const r=ar(xt(Ne,"salesV2"),lr("date",">=",t),lr("date","<=",e)),n=await Ut(r),a=[];n.forEach(x=>{const v=x.data();if(Array.isArray(v.items)&&v.items.length>0){v.items.forEach(y=>{const b=Number(y.qty??0),w=Number(y.lineFinal??0)||Math.max(0,Number(y.unitPrice||0)*b-Number(y.discount||0));a.push({quantity:b,amount:Number(w||0),measurement:y.measurement??v.measurement??"",type:v.type??"CONTADO"})});return}a.push({quantity:Number(v.quantity??0),amount:Number(v.amount??v.amountCharged??0),measurement:v.measurement??"",type:v.type??"CONTADO"})});const s=a.filter(x=>x.type==="CONTADO"),o=a.filter(x=>x.type==="CREDITO"),l=i_(s.filter(x=>mF(x.measurement)).reduce((x,v)=>x+v.quantity,0)),c=i_(o.filter(x=>mF(x.measurement)).reduce((x,v)=>x+v.quantity,0)),d=i_(s.filter(x=>k$(x.measurement)).reduce((x,v)=>x+v.quantity,0)),u=i_(o.filter(x=>k$(x.measurement)).reduce((x,v)=>x+v.quantity,0)),f=s_(s.reduce((x,v)=>x+v.amount,0)),A=s_(o.reduce((x,v)=>x+v.amount,0)),h=ar(xt(Ne,"ar_movements_pollo"),lr("date",">=",t),lr("date","<=",e)),m=await Ut(h);let p=0;return m.forEach(x=>{const v=x.data();String(v.type??"").trim().toUpperCase()==="ABONO"&&(p+=Math.abs(Number(v.amount??0)))}),p=s_(p),{lbsCash:l,lbsCredit:c,unitsCash:d,unitsCredit:u,salesCash:f,salesCredit:A,abonosPeriodo:p,saldoBase:s_(f+p)}}const Yi=t=>`C$${Number(t??0).toFixed(2)}`,bx=t=>Number(t??0).toFixed(3),o_=()=>Kr(new Date,"yyyy-MM-dd");function pLe(){const[t,e]=g.useState(o_()),[r,n]=g.useState(o_()),[a,s]=g.useState(!0),[o,l]=g.useState(null),[c,d]=g.useState([]),[u,f]=g.useState(o_()),[A,h]=g.useState("GASTO"),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,I]=g.useState(""),{refreshKey:j,refresh:N}=bc(),[S,E]=g.useState(!1),[B,k]=g.useState(null),[T,P]=g.useState(null),q=g.useRef(null),de=g.useRef(null);g.useEffect(()=>{(async()=>{s(!0);try{const R=await mLe(t,r);l(R)}catch(R){console.error("Error base summary:",R),l(null)}finally{s(!1)}})()},[t,r,j]),g.useEffect(()=>{(async()=>{try{const R=ar(xt(Ne,"cash_ledger_pollo"),lr("date",">=",t),lr("date","<=",r),kn("date","asc")),M=(await Ut(R)).docs.map(te=>({id:te.id,...te.data(),source:"ledger"})),K=ar(xt(Ne,"expenses"),lr("date",">=",t),lr("date","<=",r),kn("date","asc")),D=(await Ut(K)).docs.map(te=>{const ve=te.data();return{id:`exp_${te.id}`,date:ve.date||o_(),type:"GASTO",description:ve.description||"Gasto",reference:ve.category||ve.reference||null,inAmount:0,outAmount:Number(ve.amount||0),createdAt:ve.createdAt??null,createdBy:ve.createdBy??null,source:"expenses"}}),V=[...M,...D].sort((te,ve)=>(te.date||"").localeCompare(ve.date||""));d(V)}catch(R){console.error("Error ledger:",R),d([])}})()},[t,r,j]);const ce=(o==null?void 0:o.saldoBase)??0,le=g.useMemo(()=>{let R=Number(ce||0);return[...c].sort((M,K)=>(M.date||"").localeCompare(K.date||"")).map(M=>(R=R+Number(M.inAmount||0)-Number(M.outAmount||0),{...M,balance:R}))},[c,ce]),he=le.length?le[le.length-1].balance:ce,ae=g.useMemo(()=>{const R=c.reduce((M,K)=>M+Number(K.inAmount||0),0),G=c.reduce((M,K)=>M+Number(K.outAmount||0),0);return{inSum:R,outSum:G}},[c]),Ce=(R,G,M="Hoja1")=>{const K=pa.book_new(),Y=pa.aoa_to_sheet(G);pa.book_append_sheet(K,Y,M),zv(K,R)},De=()=>{const R=[],G=["Fecha","Movimiento","Descripcin","Referencia","Entrada","Salida","Saldo","Fuente","Creado por"];R.push(G),(le||[]).forEach(K=>{const Y=K.createdBy?`${K.createdBy.email||K.createdBy.uid||""}`:"";R.push([K.date||"",K.type||"",K.description||"",K.reference||"",K.inAmount||0,K.outAmount||0,K.balance||0,K.source||"ledger",Y])});const M=`estado_cuenta_${t||"desde"}_${r||"hasta"}.xlsx`;Ce(M,R,"Movimientos")},O=async()=>{const R=Number(y||0),G=Number(w||0);if(!u)return window.alert("Pon una fecha.");if(!m.trim())return window.alert("Pon una descripcin.");if(R<=0&&G<=0)return window.alert("Pon una entrada o una salida.");if(R>0&&G>0)return window.alert("Us solo entrada o salida, no ambos.");const M=Vi.currentUser,K={date:u,type:A,description:m.trim(),reference:x.trim()||null,inAmount:R>0?R:0,outAmount:G>0?G:0,createdAt:tP(),createdBy:M?{uid:M.uid,email:M.email??null}:null,periodFrom:t,periodTo:r};if(B)try{await Mn(Kt(Ne,"cash_ledger_pollo",B),K)}catch(Y){console.error("Error updating movement:",Y),window.alert("No se pudo actualizar el movimiento. Revisa la consola.");return}else await ta(xt(Ne,"cash_ledger_pollo"),K);p(""),v(""),b(""),I(""),N(),E(!1),k(null)};return g.useEffect(()=>{const R=M=>{const K=M.target;S&&q.current&&!q.current.contains(K)&&(E(!1),k(null)),T&&de.current&&!de.current.contains(K)&&P(null)},G=M=>{M.key==="Escape"&&(P(null),E(!1),k(null))};return document.addEventListener("mousedown",R),document.addEventListener("keydown",G),()=>{document.removeEventListener("mousedown",R),document.removeEventListener("keydown",G)}},[S,T]),i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-4 sm:p-6 rounded-2xl shadow-2xl",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[i.jsx("h2",{className:"text-xl sm:text-2xl font-bold",children:"Estado de Cuenta (Pollo)"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(yc,{onClick:N,loading:a}),i.jsx("button",{type:"button",onClick:De,className:"px-3 py-2 border rounded bg-white hover:bg-gray-50 text-sm",children:"Exportar Excel"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-3 py-2 w-full",value:t,onChange:R=>e(R.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-3 py-2 w-full",value:r,onChange:R=>n(R.target.value)})]})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-2xl p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras Cash"}),i.jsx("div",{className:"text-2xl font-bold",children:bx((o==null?void 0:o.lbsCash)??0)})]}),i.jsxs("div",{className:"border rounded-2xl p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras Crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:bx((o==null?void 0:o.lbsCredit)??0)})]}),i.jsxs("div",{className:"border rounded-2xl p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total Libras"}),i.jsx("div",{className:"text-2xl font-bold",children:bx(((o==null?void 0:o.lbsCash)??0)+((o==null?void 0:o.lbsCredit)??0))})]}),i.jsxs("div",{className:"border rounded-2xl p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Unidades Cash"}),i.jsx("div",{className:"text-2xl font-bold",children:bx((o==null?void 0:o.unitsCash)??0)})]}),i.jsxs("div",{className:"border rounded-2xl p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Unidades Crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:bx((o==null?void 0:o.unitsCredit)??0)})]}),i.jsxs("div",{className:"border rounded-2xl p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total Unidades"}),i.jsx("div",{className:"text-2xl font-bold",children:bx(((o==null?void 0:o.unitsCash)??0)+((o==null?void 0:o.unitsCredit)??0))})]}),i.jsxs("div",{className:"border rounded-2xl p-3 bg-white",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Cash"}),i.jsx("div",{className:"text-2xl font-bold",children:Yi((o==null?void 0:o.salesCash)??0)})]}),i.jsxs("div",{className:"border rounded-2xl p-3 bg-white",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:Yi((o==null?void 0:o.salesCredit)??0)})]}),i.jsxs("div",{className:"border rounded-2xl p-3 bg-white",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonado al periodo"}),i.jsx("div",{className:"text-2xl font-bold",children:Yi((o==null?void 0:o.abonosPeriodo)??0)})]}),i.jsxs("div",{className:"border rounded-2xl p-3 bg-indigo-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo base (Ventas Cash + Abonos)"}),i.jsx("div",{className:"text-2xl font-bold",children:Yi(ce)})]}),i.jsxs("div",{className:"border rounded-2xl p-3 bg-green-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Entradas manuales"}),i.jsx("div",{className:"text-2xl font-bold",children:Yi(ae.inSum)})]}),i.jsxs("div",{className:"border rounded-2xl p-3 bg-red-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Salidas manuales"}),i.jsx("div",{className:"text-2xl font-bold",children:Yi(ae.outSum)})]}),i.jsxs("div",{className:"border rounded-2xl p-3 bg-gray-900 text-white sm:col-span-2 lg:col-span-3",children:[i.jsx("div",{className:"text-xs opacity-80",children:"Saldo final (corriente)"}),i.jsx("div",{className:"text-3xl font-extrabold",children:Yi(he)})]})]}),i.jsx("div",{className:"md:hidden mb-4",children:i.jsxs("div",{className:"border rounded-2xl p-3 bg-white shadow-sm space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo final (corriente)"}),i.jsx("div",{className:"text-lg font-bold",children:Yi(he)})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"border rounded p-2 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo base"}),i.jsx("div",{className:"font-semibold",children:Yi(ce)})]}),i.jsxs("div",{className:"border rounded p-2 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Entradas manuales"}),i.jsx("div",{className:"font-semibold",children:Yi(ae.inSum)})]}),i.jsxs("div",{className:"border rounded p-2 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Salidas manuales"}),i.jsx("div",{className:"font-semibold",children:Yi(ae.outSum)})]}),i.jsxs("div",{className:"border rounded p-2 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Cash"}),i.jsx("div",{className:"font-semibold",children:Yi((o==null?void 0:o.salesCash)??0)})]}),i.jsxs("div",{className:"border rounded p-2 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonado al periodo"}),i.jsx("div",{className:"font-semibold",children:Yi((o==null?void 0:o.abonosPeriodo)??0)})]})]})]})}),i.jsx("div",{className:"mb-4",children:i.jsx("button",{type:"button",onClick:()=>E(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Agregar movimiento"})}),S&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>E(!1)}),i.jsxs("div",{ref:q,className:"relative bg-white rounded-2xl p-4 w-full max-w-2xl shadow-xl",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"font-semibold",children:"Agregar movimiento"}),i.jsx("button",{type:"button",onClick:()=>E(!1),className:"text-gray-500 hover:text-gray-700",children:""})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Fecha"}),i.jsx("input",{type:"date",className:"border rounded px-3 py-2 w-full",value:u,onChange:R=>f(R.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Tipo movimiento"}),i.jsxs("select",{className:"border rounded px-3 py-2 w-full",value:A,onChange:R=>h(R.target.value),children:[i.jsx("option",{value:"GASTO",children:"Gasto"}),i.jsx("option",{value:"REABASTECIMIENTO",children:"Reabastecimiento"}),i.jsx("option",{value:"RETIRO",children:"Retiro"}),i.jsx("option",{value:"DEPOSITO",children:"Deposito a Carmen Ortiz"}),i.jsx("option",{value:"PERDIDA",children:"Perdida por robo"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Referencia"}),i.jsx("input",{className:"border rounded px-3 py-2 w-full",value:x,onChange:R=>v(R.target.value),placeholder:"Factura, recibo, etc."})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Descripcin"}),i.jsx("input",{className:"border rounded px-3 py-2 w-full",value:m,onChange:R=>p(R.target.value),placeholder:"Ej: Compra bolsas / Re abastecimiento / Pago proveedor..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Entrada (+)"}),i.jsx("input",{type:"text",inputMode:"decimal",pattern:"^\\\\d*(\\\\.\\\\d{0,2})?$",className:"border rounded px-3 py-2 w-full",value:y,onChange:R=>{let G=R.target.value.replace(/,/g,".");(/^\d*(\.\d{0,2})?$/.test(G)||G==="."||G==="")&&b(G==="."?".":G)},placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Salida ()"}),i.jsx("input",{type:"text",inputMode:"decimal",pattern:"^\\\\d*(\\\\.\\\\d{0,2})?$",className:"border rounded px-3 py-2 w-full",value:w,onChange:R=>{let G=R.target.value.replace(/,/g,".");(/^\d*(\.\d{0,2})?$/.test(G)||G==="."||G==="")&&I(G==="."?".":G)},placeholder:"0.00"})]}),i.jsxs("div",{className:"sm:col-span-3 flex gap-2 justify-end mt-2",children:[i.jsx("button",{type:"button",onClick:()=>E(!1),className:"px-4 py-2 border rounded",children:"Cancelar"}),i.jsx("button",{type:"button",onClick:O,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Guardar movimiento"})]})]})]})]}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Movimiento"}),i.jsx("th",{className:"border p-2",children:"Descripcin"}),i.jsx("th",{className:"border p-2",children:"Referencia"}),i.jsx("th",{className:"border p-2",children:"Entrada (+)"}),i.jsx("th",{className:"border p-2",children:"Salida ()"}),i.jsx("th",{className:"border p-2",children:"Saldo"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[i.jsxs("tr",{className:"text-center bg-indigo-50",children:[i.jsxs("td",{className:"border p-1",children:[t,"  ",r]}),i.jsx("td",{className:"border p-1",children:"SALDO_BASE"}),i.jsx("td",{className:"border p-1 text-left",children:"Ventas Cash + Abonos del periodo"}),i.jsx("td",{className:"border p-1",children:""}),i.jsx("td",{className:"border p-1",children:Yi(ce)}),i.jsx("td",{className:"border p-1",children:Yi(0)}),i.jsx("td",{className:"border p-1 font-semibold",children:Yi(ce)})]}),le.map(R=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:R.date}),i.jsx("td",{className:"border p-1",children:R.type}),i.jsx("td",{className:"border p-1 text-left",children:R.description}),i.jsx("td",{className:"border p-1",children:R.reference||""}),i.jsx("td",{className:"border p-1",children:Yi(R.inAmount)}),i.jsx("td",{className:"border p-1",children:Yi(R.outAmount)}),i.jsx("td",{className:"border p-1 font-semibold",children:Yi(R.balance)}),i.jsx("td",{className:"border p-1 relative",children:R.source==="expenses"?i.jsx("div",{className:"text-xs text-gray-400",children:"Gasto registrado"}):i.jsxs("div",{className:"inline-block",children:[i.jsx("button",{onClick:()=>P(T===R.id?null:R.id),className:"px-2 py-1 rounded hover:bg-gray-100","aria-label":"Acciones",children:""}),T===R.id&&i.jsxs("div",{ref:G=>{de.current=G},className:"absolute right-2 mt-1 bg-white border rounded shadow-md z-50 text-left text-sm",children:[i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>{k(R.id),f(R.date),h(R.type),p(R.description||""),v(R.reference||"");const G=Number(R.inAmount||0)===0?"":String(Number(R.inAmount)),M=Number(R.outAmount||0)===0?"":String(Number(R.outAmount));b(G),I(M),E(!0),P(null)},children:"Editar"}),i.jsx("button",{className:"block w-full text-left px-3 py-2 text-red-600 hover:bg-gray-100",onClick:async()=>{if(P(null),!!window.confirm("Eliminar este movimiento?"))try{await na(Kt(Ne,"cash_ledger_pollo",R.id)),N()}catch(G){console.error("Error eliminando movimiento:",G),window.alert("No se pudo eliminar el movimiento. Revisa la consola.")}},children:"Eliminar"})]})]})})]},R.id)),le.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"p-3 text-center text-gray-500",children:"No hay movimientos manuales en este rango."})})]})]})}),i.jsx("div",{className:"md:hidden space-y-3",children:le.length===0?i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin movimientos manuales en este rango."}):le.map(R=>i.jsxs("div",{className:"border rounded-xl p-3 bg-white shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-semibold",children:R.description}),i.jsxs("div",{className:"text-xs text-gray-500",children:[R.date,"  ",R.type]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-sm",children:Yi(R.inAmount||0)}),i.jsx("div",{className:"text-xs text-gray-500",children:"Entrada"})]})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm text-gray-700",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Referencia"}),i.jsx("div",{children:R.reference||""})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Saldo"}),i.jsx("div",{className:"font-semibold",children:Yi(R.balance)})]})]}),i.jsx("div",{className:"mt-3 flex justify-end gap-2",children:R.source==="expenses"?null:i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>{k(R.id),f(R.date),h(R.type),p(R.description||""),v(R.reference||"");const G=Number(R.inAmount||0)===0?"":String(Number(R.inAmount)),M=Number(R.outAmount||0)===0?"":String(Number(R.outAmount));b(G),I(M),E(!0)},className:"px-3 py-1 border rounded text-sm",children:"Editar"}),i.jsx("button",{onClick:async()=>{if(window.confirm("Eliminar este movimiento?"))try{await na(Kt(Ne,"cash_ledger_pollo",R.id)),N()}catch(G){console.error("Error eliminando movimiento:",G),window.alert("No se pudo eliminar el movimiento. Revisa la consola.")}},className:"px-3 py-1 bg-red-600 text-white rounded text-sm",children:"Eliminar"})]})})]},R.id))})]})}const tl=t=>`C$ ${(Number(t)||0).toFixed(2)}`,gLe=["","HOMBRE","MUJER","NINO","NINA","UNISEX"];function l_(t){return(t||"").trim().toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"")}function xLe(t){switch((t||"").toUpperCase()){case"HOMBRE":return"HOM";case"MUJER":return"MUJ";case"NINO":return"NIN";case"NINA":return"NIA";case"UNISEX":return"UNI";default:return"GEN"}}function vLe(t){const e="ROP",r=l_(t.subcat).slice(0,3)||"GEN",n=xLe(t.gender),a=l_(t.color).slice(0,3)||"COL",s=l_(t.size)||"TLL",o=l_(t.brand).slice(0,4)||"BRD",l=Date.now().toString(36).toUpperCase().slice(-4);return`${e}-${r}-${n}-${a}-${s}-${o}-${l}`}const _y=/^[A-Za-z0-9._-]{0,32}$/;function yLe(){const[t,e]=g.useState([]),[r,n]=g.useState([]),[a,s]=g.useState(!0),[o,l]=g.useState(""),[c,d]=g.useState(Kr(Gu(new Date),"yyyy-MM-dd")),[u,f]=g.useState(Kr($u(new Date),"yyyy-MM-dd")),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(Kr(new Date,"yyyy-MM-dd")),[y,b]=g.useState(0),[w,I]=g.useState(0),[j,N]=g.useState(0),[S,E]=g.useState(0),[B,k]=g.useState(0),[T,P]=g.useState(""),[q,de]=g.useState(""),[ce,le]=g.useState(""),[he,ae]=g.useState(""),[Ce,De]=g.useState(""),[O,R]=g.useState(""),[G,M]=g.useState(""),[K,Y]=g.useState(!1),[D,V]=g.useState(""),[te,ve]=g.useState("Camisa"),[Q,Xe]=g.useState(null),[se,Z]=g.useState(""),[ke,Se]=g.useState(0),[Ee,Ze]=g.useState(0),[ot,vt]=g.useState(0),[_t,Tt]=g.useState(0),[Lt,Rt]=g.useState(0),[Et,Re]=g.useState(""),[Te,Ye]=g.useState(""),[dt,Fe]=g.useState(""),[je,We]=g.useState(""),[ee,Ve]=g.useState(""),[rt,$e]=g.useState(""),[ie,pe]=g.useState(""),[fe,Me]=g.useState(null),[me,ye]=g.useState({x:0,y:0}),[mt,gt]=g.useState(!1);g.useEffect(()=>{const X=()=>Me(null),re=H=>H.key==="Escape"&&Me(null);return document.addEventListener("click",X),document.addEventListener("keydown",re),()=>{document.removeEventListener("click",X),document.removeEventListener("keydown",re)}},[]);const yt=(X,re,H=192,L=160)=>{let Pe=X;X+H+8>window.innerWidth&&(Pe=X-H),Pe=Math.max(8,Math.min(Pe,window.innerWidth-H-8));let xe=re;return re+L+8>window.innerHeight&&(xe=window.innerHeight-L-8),xe=Math.max(8,Math.min(xe,window.innerHeight-L-8)),{x:Pe,y:xe}},Pt=(X,re)=>{X.stopPropagation();const H=X.currentTarget.getBoundingClientRect(),L=H.right,ue=H.bottom,Pe=yt(L,ue);ye(Pe),Me(xe=>xe===re?null:re)};g.useEffect(()=>{const X=()=>Me(null),re=H=>{H.key==="Escape"&&Me(null)};return document.addEventListener("click",X),document.addEventListener("keydown",re),()=>{document.removeEventListener("click",X),document.removeEventListener("keydown",re)}},[]),g.useEffect(()=>{if(!fe)return;const X=()=>Me(null);return window.addEventListener("scroll",X,!0),window.addEventListener("resize",X),()=>{window.removeEventListener("scroll",X,!0),window.removeEventListener("resize",X)}},[fe]),g.useEffect(()=>{(async()=>{const X=await Ut(xt(Ne,"products_clothes")),re=[];X.forEach(Pe=>{const xe=Pe.data();re.push({id:Pe.id,name:xe.name??"(sin nombre)",category:xe.category??"(sin categora)",measurement:xe.measurement??"unidad",price:Number(xe.price??0),sku:xe.sku||"",size:xe.size||"",color:xe.color||"",gender:xe.gender||"",brand:xe.brand||""})}),e(re);const H=ar(xt(Ne,"inventory_clothes_batches"),kn("date","desc")),L=await Ut(H),ue=[];L.forEach(Pe=>{const xe=Pe.data();ue.push({id:Pe.id,productId:xe.productId,productName:xe.productName,category:xe.category,unit:xe.unit,quantity:Number(xe.quantity||0),remaining:Number(xe.remaining??xe.quantity??0),purchasePrice:Number(xe.purchasePrice||0),salePrice:Number(xe.salePrice||0),invoiceTotal:Number(xe.invoiceTotal??Number(xe.quantity||0)*Number(xe.purchasePrice||0)),expectedTotal:Number(xe.expectedTotal??Number(xe.quantity||0)*Number(xe.salePrice||0)),date:xe.date,createdAt:xe.createdAt,status:xe.status,notes:xe.notes||"",sku:xe.sku||"",size:xe.size||"",color:xe.color||"",gender:xe.gender||"",brand:xe.brand||"",clientCode:xe.clientCode||""})}),n(ue),s(!1)})()},[]),g.useEffect(()=>{const X=t.find(re=>re.id===m);X&&(N(Number(X.price||0)),X.sku&&de(X.sku),X.size&&le(re=>re||X.size),X.color&&ae(re=>re||X.color),X.gender&&De(re=>re||X.gender),X.brand&&R(re=>re||X.brand))},[m,t]),g.useEffect(()=>{E(Math.floor(y*w*100)/100)},[y,w]),g.useEffect(()=>{k(Math.floor(y*j*100)/100)},[y,j]),g.useEffect(()=>{const X=t.find(L=>L.id===m);if(X!=null&&X.sku){de(X.sku);return}const re=K&&te?te:(X==null?void 0:X.category)||"";if(!re&&!Ce&&!he&&!ce&&!O){de("");return}const H=vLe({subcat:re,gender:Ce||"",color:he||"",size:ce||"",brand:O||""});de(H)},[K,te,m,Ce,he,ce,O,t]);const Ft=g.useMemo(()=>r.filter(X=>!(c&&X.date<c||u&&X.date>u||A&&X.productId!==A)),[r,c,u,A]),Oe=g.useMemo(()=>{const X=Ft.reduce((ue,Pe)=>ue+(Pe.invoiceTotal||0),0),re=Ft.reduce((ue,Pe)=>ue+(Pe.expectedTotal||0),0),H=Ft.reduce((ue,Pe)=>ue+Pe.quantity,0),L=Ft.reduce((ue,Pe)=>ue+Pe.remaining,0);return{udsIng:H,udsRem:L,totalFacturado:X,totalEsperado:re}},[Ft]),be=async X=>{X.preventDefault(),l("");const re=!!m&&!K,H=t.find(xe=>xe.id===m),L=re?(H==null?void 0:H.name)||"":D||"",ue=re?(H==null?void 0:H.category)||"":te||"General",Pe=re&&(H==null?void 0:H.measurement)||"unidad";if(!L||y<=0||w<=0){l("Completa nombre/cantidad/costo.");return}if(G&&!_y.test(G)){l("Cdigo del cliente invlido (solo A-Z, 0-9, . _ - , mx 32).");return}try{const xe=await ta(xt(Ne,"inventory_clothes_batches"),{productId:re?H.id:"",productName:L,category:ue,unit:Pe,quantity:y,remaining:y,purchasePrice:w,salePrice:j,invoiceTotal:S,expectedTotal:B,date:x,createdAt:Nr.now(),status:"PENDIENTE",notes:T||"",sku:q||"",size:ce||"",color:he||"",gender:Ce||"",brand:O||"",clientCode:G||""});n(Ge=>[{id:xe.id,productId:re?H.id:"",productName:L,category:ue,unit:Pe,quantity:y,remaining:y,purchasePrice:w,salePrice:j,invoiceTotal:S,expectedTotal:B,date:x,createdAt:Nr.now(),status:"PENDIENTE",notes:T||"",sku:q||"",size:ce||"",color:he||"",gender:Ce||"",brand:O||"",clientCode:G||""},...Ge]),l(" Lote de ropa creado"),p(""),v(Kr(new Date,"yyyy-MM-dd")),b(0),I(0),N(0),E(0),k(0),P(""),de(""),le(""),ae(""),De(""),R(""),M(""),Y(!1),V(""),ve("Camisa")}catch(xe){console.error(xe),l(" Error al crear lote")}},Ae=async X=>{confirm(`Marcar PAGADO el lote del ${X.date} (${X.productName})?`)&&(await Mn(Kt(Ne,"inventory_clothes_batches",X.id),{status:"PAGADO"}),n(H=>H.map(L=>L.id===X.id?{...L,status:"PAGADO"}:L)))},Le=X=>{Xe(X.id),Z(X.date),Se(X.quantity),Ze(X.purchasePrice),vt(X.salePrice),Tt(Number((X.quantity*X.purchasePrice).toFixed(2))),Rt(Number((X.quantity*X.salePrice).toFixed(2))),Re(X.notes||""),Ye(X.sku||""),Fe(X.size||""),We(X.color||""),Ve(X.gender||""),$e(X.brand||""),pe(X.clientCode||"")},ut=()=>{Xe(null),Z(""),Se(0),Ze(0),vt(0),Tt(0),Rt(0),Re(""),Ye(""),Fe(""),We(""),Ve(""),$e(""),pe("")};g.useEffect(()=>{Q&&Tt(Math.floor(ke*Ee*100)/100)},[Q,ke,Ee]),g.useEffect(()=>{Q&&Rt(Math.floor(ke*ot*100)/100)},[Q,ke,ot]);const ct=async()=>{if(!Q)return;const X=r.find(ue=>ue.id===Q);if(!X)return;const re=Math.max(0,X.quantity-X.remaining),H=Math.max(0,ke-re);if(ie&&!_y.test(ie)){l("Cdigo del cliente invlido (solo A-Z, 0-9, . _ - , mx 32).");return}const L=Kt(Ne,"inventory_clothes_batches",Q);await Mn(L,{date:se,quantity:ke,purchasePrice:Ee,salePrice:ot,invoiceTotal:_t,expectedTotal:Lt,notes:Et,remaining:H,sku:Te,size:dt,color:je,gender:ee||"",brand:rt||"",clientCode:ie||""}),n(ue=>ue.map(Pe=>Pe.id===Q?{...Pe,date:se,quantity:ke,purchasePrice:Ee,salePrice:ot,invoiceTotal:_t,expectedTotal:Lt,notes:Et,remaining:H,sku:Te,size:dt,color:je,gender:ee||"",brand:rt||"",clientCode:ie||""}:Pe)),ut(),l(" Lote actualizado")},st=async X=>{confirm(`Eliminar el lote del ${X.date} (${X.productName})?`)&&(await na(Kt(Ne,"inventory_clothes_batches",X.id)),n(H=>H.filter(L=>L.id!==X.id)),l(" Lote eliminado"))},z=()=>{const X=(c?`Desde ${c}`:"Desde inicio")+"  "+(u?`Hasta ${u}`:"Hasta hoy"),re=Pe=>(Pe||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),H=Ft.map(Pe=>`
      <tr>
        <td>${Pe.date}</td>
        <td>${(Pe.category||"").toUpperCase()}</td>
        <td>${re(Pe.productName)}</td>
        <td>${re(Pe.sku||"")}</td>
        <td>${re(Pe.size||"")}</td>
        <td>${re(Pe.color||"")}</td>
        <td>${re(Pe.clientCode||"")}</td>
        <td>${re(Pe.gender||"")}</td>
        <td>${(Pe.unit||"").toUpperCase()}</td>
        <td style="text-align:right">${Pe.quantity.toFixed(0)}</td>
        <td style="text-align:right">${Pe.remaining.toFixed(0)}</td>
        <td style="text-align:right">${tl(Pe.purchasePrice)}</td>
        <td style="text-align:right">${tl(Pe.salePrice)}</td>
        <td style="text-align:right">${tl(Pe.invoiceTotal||0)}</td>
        <td style="text-align:right">${tl(Pe.expectedTotal||0)}</td>
        <td>${re((Pe.notes||"").slice(0,120))}</td>
        <td>${Pe.status}</td>
      </tr>`).join(""),L=`
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Inventario de Ropa por Lotes</title>
  <style>
    * { font-family: Arial, sans-serif; }
    h1 { margin: 0 0 4px; }
    .muted { color: #555; font-size: 12px; margin-bottom: 12px; }
    table { width: 100%; border-collapse: collapse; font-size: 11px; }
    th, td { border: 1px solid #ddd; padding: 6px; }
    th { background: #f5f5f5; text-align: left; }
    .totals { margin: 10px 0 16px; font-size: 12px; display: grid; grid-template-columns: repeat(2, max-content); column-gap: 32px; row-gap: 6px; align-items: center; }
    @media print { @page { size: A4 landscape; margin: 12mm; } button { display: none; } }
  </style>
</head>
<body>
  <button onclick="window.print()">Imprimir</button>
  <h1>Inventario de Ropa por Lotes</h1>
  <div class="muted">${X}</div>
  <div class="totals">
    <span><strong>Unidades ingresadas:</strong> ${Oe.udsIng.toFixed(0)}</span>
    <span><strong>Unidades restantes:</strong> ${Oe.udsRem.toFixed(0)}</span>
    <span><strong>Total esperado a ganar:</strong> ${tl(Oe.totalEsperado)}</span>
    <span><strong>Total facturado:</strong> ${tl(Oe.totalFacturado)}</span>
    <span><strong>Ganancia sin gastos:</strong> ${tl(Number((Oe.totalEsperado-Oe.totalFacturado).toFixed(2)))}</span>
  </div>
  <table>
    <thead>
      <tr>
        <th>Fecha</th>
        <th>Subcat.</th>
        <th>Producto</th>
        <th>SKU</th>
        <th>Talla</th>
        <th>Color</th>
        <th>Cdigo Cliente</th>
        <th>Gnero</th>
        <th>Unidad</th>
        <th>Ingresado</th>
        <th>Restantes</th>
        <th>Precio Compra</th>
        <th>Precio Venta</th>
        <th>Total factura</th>
        <th>Total esperado</th>
        <th>Comentario</th>
        <th>Estado</th>
      </tr>
    </thead>
    <tbody>${H||'<tr><td colspan="17" style="text-align:center">Sin lotes</td></tr>'}</tbody>
  </table>
</body>
</html>`,ue=window.open("","_blank");ue&&(ue.document.open(),ue.document.write(L),ue.document.close())};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario de Ropa"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>gt(!0),type:"button",children:"Crear Inventario"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:X=>d(X.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:X=>f(X.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:X=>h(X.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),t.map(X=>i.jsxs("option",{value:X.id,children:[X.name,"  ",X.category]},X.id))]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{d(""),f(""),h("")},children:"Quitar filtro"}),i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:z,children:"Imprimir PDF"})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-base",children:i.jsxs("div",{className:"grid grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",Oe.udsIng.toFixed(0)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",Oe.udsRem.toFixed(0)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",tl(Oe.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",tl(Oe.totalFacturado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",tl(Number((Oe.totalEsperado-Oe.totalFacturado).toFixed(2)))]})]})}),i.jsx("div",{className:"bg-white rounded shadow border",children:i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Fecha"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden sm:table-cell",children:"Subcat."}),i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"SKU"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden md:table-cell",children:"Talla"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden md:table-cell",children:"Color"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden xl:table-cell",children:"Cdigo Cliente"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"Gnero"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"Unidad"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums",children:"Ingresado"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums",children:"Restantes"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden md:table-cell",children:"Precio Compra"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden md:table-cell",children:"Precio Venta"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden lg:table-cell",children:"Total factura"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden lg:table-cell",children:"Total esperado"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden xl:table-cell",children:"Comentario"}),i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Estado"}),i.jsx("th",{className:"p-2 md:p-3 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center",children:"Cargando"})}):Ft.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center",children:"Sin lotes"})}):Ft.map(X=>{const re=Q===X.id;return i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 md:p-3 border align-top",children:re?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:se,onChange:H=>Z(H.target.value)}):X.date}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden sm:table-cell",children:(X.category||"").toUpperCase()}),i.jsx("td",{className:"p-2 md:p-3 border align-top max-w-[220px] md:max-w-[320px]",children:i.jsx("span",{className:"block truncate",title:X.productName,children:X.productName})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell max-w-[220px]",children:re?i.jsx("input",{className:"w-full border p-1 rounded",value:Te,onChange:H=>Ye(H.target.value)}):i.jsx("span",{className:"block truncate",title:X.sku||"",children:X.sku||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden md:table-cell",children:re?i.jsx("input",{className:"w-full border p-1 rounded",value:dt,onChange:H=>Fe(H.target.value)}):X.size||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden md:table-cell",children:re?i.jsx("input",{className:"w-full border p-1 rounded",value:je,onChange:H=>We(H.target.value)}):X.color||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden xl:table-cell max-w-[200px]",children:re?i.jsx("input",{className:"w-full border p-1 rounded",value:ie,onChange:H=>{const L=H.target.value;_y.test(L)&&pe(L)},placeholder:"Ej: LOTE-SHEIN-SEP-01",title:"AZ 09 . _ - (mx 32)"}):i.jsx("span",{className:"block truncate",title:X.clientCode||"",children:X.clientCode||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell",children:re?i.jsx("select",{className:"w-full border p-1 rounded",value:ee,onChange:H=>Ve(H.target.value),children:gLe.map(H=>i.jsx("option",{value:H,children:H||""},H))}):X.gender||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell",children:(X.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums",children:re?i.jsx("input",{type:"number",step:"1",inputMode:"numeric",className:"w-20 border p-1 rounded text-right",value:Number.isNaN(ke)?"":ke,onChange:H=>Se(Math.max(0,parseInt(H.target.value||"0",10)))}):X.quantity.toFixed(0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums",children:re?X.remaining:X.remaining.toFixed(0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden md:table-cell",children:re?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(Ee)?"":Ee,onChange:H=>Ze(Math.max(0,parseFloat(H.target.value||"0")))}):tl(X.purchasePrice)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden md:table-cell",children:re?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(ot)?"":ot,onChange:H=>vt(Math.max(0,parseFloat(H.target.value||"0")))}):tl(X.salePrice)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden lg:table-cell",children:tl(re?_t:X.invoiceTotal||0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden lg:table-cell",children:tl(re?Lt:X.expectedTotal||0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden xl:table-cell max-w-[280px]",children:re?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:Et,onChange:H=>Re(H.target.value),maxLength:500}):i.jsx("span",{className:"block truncate",title:X.notes||"",children:X.notes||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] md:text-xs ${X.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:X.status})}),i.jsx("td",{className:"p-2 md:p-3 border align-top",children:re?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:ct,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:ut,children:"Cancelar"})]}):i.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-8 h-8 rounded border border-gray-200 hover:bg-gray-100",title:"Acciones",onClick:H=>Pt(H,X.id),children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:[i.jsx("circle",{cx:"12",cy:"5",r:"1.6"}),i.jsx("circle",{cx:"12",cy:"12",r:"1.6"}),i.jsx("circle",{cx:"12",cy:"19",r:"1.6"})]})})})]},X.id)})})]})})}),fe&&$d.createPortal(i.jsxs(i.Fragment,{children:[i.jsx("div",{onClick:()=>Me(null),className:"fixed inset-0 z-[60]"}),i.jsx("div",{className:"fixed z-[61] w-44 rounded-md border border-gray-200 bg-white shadow-xl",style:{left:me.x,top:me.y},onClick:X=>X.stopPropagation(),role:"menu","aria-orientation":"vertical",children:i.jsxs("div",{className:"py-1 text-sm",children:[(()=>{const X=Ft.find(re=>re.id===fe);return(X==null?void 0:X.status)==="PENDIENTE"?i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-green-50",onClick:()=>{Me(null),Ae(X)},children:" Pagar"}):null})(),i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-yellow-50",onClick:()=>{const X=Ft.find(re=>re.id===fe);X&&(Me(null),Le(X))},children:" Editar"}),i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-red-50 text-red-600",onClick:()=>{const X=Ft.find(re=>re.id===fe);X&&(Me(null),st(X))},children:" Borrar"})]})})]}),document.body),mt&&$d.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>gt(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-4xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Inventario (Lote)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>gt(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:be,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto de ropa"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:X=>p(X.target.value),children:[i.jsx("option",{value:"",children:"(Opcional) Selecciona un producto"}),t.map(X=>i.jsxs("option",{value:X.id,children:[X.name,"  ",X.category,"  ",X.sku?`SKU: ${X.sku}`:""]},X.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del lote"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:x,onChange:X=>v(X.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad (pzas)"}),i.jsx("input",{type:"number",step:"1",inputMode:"numeric",className:"w-full border p-2 rounded",value:y===0?"":y,onChange:X=>b(Math.max(0,parseInt(X.target.value||"0",10))),placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de compra (pza)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:w===0?"":w,onChange:X=>I(Math.max(0,parseFloat(X.target.value||"0")))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de venta (pza)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:j===0?"":j,onChange:X=>N(Math.max(0,parseFloat(X.target.value||"0")))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"SKU (auto)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:q,readOnly:!0,placeholder:"Se genera automticamente o se carga del producto",title:"Si el producto tiene SKU, se usa tal cual; si no, se genera por subcat/gnero/talla/color/marca."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Talla"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:ce,readOnly:!0,onChange:X=>le(X.target.value),placeholder:"XS/S/M/L/XL/10/12"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:he,readOnly:!0,onChange:X=>ae(X.target.value),placeholder:"Negro, Azul, Rojo"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:Ce,readOnly:!0,onChange:X=>De(X.target.value),placeholder:"Masculino, Femenino, Otro"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Marca / Origen (opcional)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:O,onChange:X=>R(X.target.value),placeholder:"Shein, Usado, Otro"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cdigo del cliente (opcional)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: LOTE-SHEIN-SEP-01",value:G,onChange:X=>{const re=X.target.value;_y.test(re)&&M(re)},title:"Solo letras, nmeros, punto, guion y guion_bajo (mx 32)"}),!_y.test(G)&&G.length>0&&i.jsx("div",{className:"text-xs text-red-600 mt-1",children:"Formato invlido"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:T,onChange:X=>P(X.target.value),maxLength:500,placeholder:"Ej: Camisita veranera, tela delgada, tirantes"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[T.length,"/500"]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Total factura (auto)"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:tl(S),readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Total esperado (auto)"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:tl(B),readOnly:!0})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>gt(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar lote"})]})]})]})]}),document.body),o&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const bLe=["Camisa","Blusa","Vestido","Jean","Pantaln","Short","Falda","Conjunto","Abrigo","Suter","Accesorio"],wLe=["Negro","Blanco","Azul","Rojo","Verde","Gris","Beige","Rosa","Amarillo","Marrn","Morado","Naranja"],NLe=["XS","S","M","L","XL","2XL"],CLe=["2","4","6","8","10","12","14"],_Le=["26","28","30","32","34","36","38"],ELe=["Shein","Usado","Otro"],SLe=["","HOMBRE","MUJER","NINO","NINA","UNISEX"];function c_(t){return(t||"").trim().toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"")}function jLe(t){switch((t||"").toUpperCase()){case"HOMBRE":return"HOM";case"MUJER":return"MUJ";case"NINO":return"NIN";case"NINA":return"NIA";case"UNISEX":return"UNI";default:return"GEN"}}function ILe(t){const e="ROP",r=c_(t.subcat).slice(0,3)||"GEN",n=jLe(t.gender),a=c_(t.color).slice(0,3)||"COL",s=c_(t.size)||"TLL",o=c_(t.brand).slice(0,4)||"BRD";return`${e}-${r}-${n}-${a}-${s}-${o}`}const PLe=/^[A-Za-z0-9._-]{0,32}$/;function TLe(){const[t,e]=g.useState(""),[r,n]=g.useState("Camisa"),[a,s]=g.useState(""),[o,l]=g.useState(""),[c,d]=g.useState("Shein"),[u,f]=g.useState(""),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,I]=g.useState("0"),[j,N]=g.useState(""),[S,E]=g.useState(""),B=g.useMemo(()=>{const M=Number(w||0),K=Number(y||0);return Math.floor(M*K*100)/100},[w,y]),[k,T]=g.useState([]),[P,q]=g.useState(!0),[de,ce]=g.useState(""),{refreshKey:le,refresh:he}=bc(),[ae,Ce]=g.useState(!1),De=g.useMemo(()=>r.toLowerCase()==="jean"?_Le:u==="NINO"||u==="NINA"?CLe:NLe,[r,u]);g.useEffect(()=>{p(ILe({subcat:r,gender:u,color:o,size:a,brand:c}))},[r,u,o,a,c]),g.useEffect(()=>{(async()=>{q(!0);const M=ar(xt(Ne,"products_clothes"),kn("createdAt","desc")),K=await Ut(M),Y=[];K.forEach(D=>{const V=D.data();Y.push({id:D.id,name:V.name??"(sin nombre)",category:V.category??"",measurement:V.measurement??"unidad",sku:V.sku??"",size:V.size||"",color:V.color||"",brand:V.brand||"",gender:V.gender||"",clientCode:V.clientCode||"",notes:V.notes||"",createdAt:V.createdAt??Nr.now()})}),T(Y),q(!1)})()},[le]);const O=()=>{e(""),n("Camisa"),s(""),l(""),d("Shein"),f(""),h(""),v(""),b(""),I("0"),N(""),E("")},R=async M=>{if(M.preventDefault(),ce(""),!t.trim()){ce("Ingresa el nombre del producto.");return}if(A&&!PLe.test(A)){ce("Cdigo del cliente invlido");return}const K=Number(w||0),Y=Number(y||0);if(K<0){ce("La cantidad de piezas debe ser 0 o mayor.");return}if(Y<0){ce("El precio de venta no puede ser negativo.");return}try{const D=await ta(xt(Ne,"products_clothes"),{name:t.trim(),category:r,measurement:"unidad",sku:m,size:a||"",color:o||"",brand:c||"",gender:u||"",clientCode:A||"",notes:x||"",createdAt:Nr.now(),price:Y||0});if(T(V=>[{id:D.id,name:t.trim(),category:r,measurement:"unidad",sku:m,size:a||"",color:o||"",brand:c||"",gender:u||"",clientCode:A||"",notes:x||"",createdAt:Nr.now()},...V]),K>0){const V=new Date().toISOString().slice(0,10),te=j||V;await ta(xt(Ne,"inventory_clothes_batches"),{productId:D.id,productName:t.trim(),category:r,unit:"unidad",quantity:K,remaining:K,purchasePrice:0,salePrice:Y||0,invoiceTotal:0,expectedTotal:B||0,date:te,createdAt:Nr.now(),status:"PENDIENTE",notes:S||"",sku:m||"",size:a||"",color:o||"",gender:u||"",brand:c||"",clientCode:A||""})}ce(K>0?" Producto creado y lote de inventario registrado":" Producto de ropa creado"),O()}catch(D){console.error(D),ce(" Error al crear producto")}},G=async M=>{confirm(`Eliminar el producto "${M.name}"?`)&&(await na(Kt(Ne,"products_clothes",M.id)),T(Y=>Y.filter(D=>D.id!==M.id)))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Productos de Ropa"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(yc,{onClick:he,loading:P}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{Ce(!0)},children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo producto"]})]})]}),ae&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Nuevo producto de ropa"}),i.jsxs("form",{onSubmit:R,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:t,onChange:M=>e(M.target.value),placeholder:"Ej: Blusa floral"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Subcategora"}),i.jsx("select",{className:"w-full border p-2 rounded",value:r,onChange:M=>n(M.target.value),children:bLe.map(M=>i.jsx("option",{value:M,children:M},M))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Gnero"}),i.jsx("select",{className:"w-full border p-2 rounded",value:u,onChange:M=>f(M.target.value),children:SLe.map(M=>i.jsx("option",{value:M,children:M||""},M))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Talla"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:a,onChange:M=>s(M.target.value),children:[i.jsx("option",{value:"",children:""}),De.map(M=>i.jsx("option",{value:M,children:M},M))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:M=>l(M.target.value),children:[i.jsx("option",{value:"",children:""}),wLe.map(M=>i.jsx("option",{value:M,children:M},M))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Marca"}),i.jsx("select",{className:"w-full border p-2 rounded",value:c,onChange:M=>d(M.target.value),children:ELe.map(M=>i.jsx("option",{value:M,children:M},M))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"SKU (auto)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:m,readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cdigo cliente"}),i.jsx("input",{className:"w-full border p-2 rounded",value:A,onChange:M=>h(M.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de venta (pza)"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"number",step:"0.01",min:0,value:y,onChange:M=>b(M.target.value),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad de piezas (crea lote si > 0)"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"number",min:0,value:w,onChange:M=>I(M.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de lote"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"date",value:j,onChange:M=>N(M.target.value)})]}),i.jsxs("div",{className:"md:col-span-2 flex items-center justify-between border-t pt-3 mt-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Medicin:"})," unidad"]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado (auto): "}),isNaN(B)?"":B.toFixed(2)]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2 mt-2",children:[i.jsx("button",{type:"button",onClick:O,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Limpiar"}),i.jsx("button",{type:"button",onClick:()=>Ce(!1),className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Guardar"})]})]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Subcat."}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Talla"}),i.jsx("th",{className:"p-2 border",children:"Color"}),i.jsx("th",{className:"p-2 border",children:"Marca"}),i.jsx("th",{className:"p-2 border",children:"Gnero"}),i.jsx("th",{className:"p-2 border",children:"Cdigo Cliente"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:P?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):k.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin productos"})}):k.map(M=>{var K;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(K=M.createdAt)!=null&&K.toDate?M.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border",children:M.category}),i.jsx("td",{className:"p-2 border",children:M.name}),i.jsx("td",{className:"p-2 border",children:M.sku}),i.jsx("td",{className:"p-2 border",children:M.size||""}),i.jsx("td",{className:"p-2 border",children:M.color||""}),i.jsx("td",{className:"p-2 border",children:M.brand||""}),i.jsx("td",{className:"p-2 border",children:M.gender||""}),i.jsx("td",{className:"p-2 border",children:M.clientCode||""}),i.jsx("td",{className:"p-2 border",children:M.notes||""}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>G(M),children:"Borrar"})})]},M.id)})})]})}),de&&i.jsx("p",{className:"mt-2 text-sm",children:de})]})}async function BLe(t){const{productId:e,quantity:r,saleDate:n,saleId:a}=t,s=Math.max(0,Math.floor(Number(r||0)));if(!e||s<=0)throw new Error("Parmetros invlidos para allocateSaleFIFOClothes");const o=ar(xt(Ne,"inventory_clothes_batches"),lr("productId","==",e)),d=(await Ut(o)).docs.map(f=>({id:f.id,data:f.data()})).sort((f,A)=>{var v,y;const h=String(f.data.date||""),m=String(A.data.date||"");if(h!==m)return h<m?-1:1;const p=((v=f.data.createdAt)==null?void 0:v.seconds)??0,x=((y=A.data.createdAt)==null?void 0:y.seconds)??0;return p-x}).map(f=>Kt(Ne,"inventory_clothes_batches",f.id)),u=[];return await fi(Ne,async f=>{const A=await Promise.all(d.map(m=>f.get(m)));let h=s;for(let m=0;m<d.length&&h>0;m++){const p=d[m],x=A[m];if(!x.exists())continue;const v=x.data(),y=Math.max(0,Math.floor(Number(v.quantity||0))),b=Number.isFinite(Number(v.remaining))?Math.max(0,Math.floor(Number(v.remaining||0))):y;if(b<=0)continue;const w=Math.min(b,h),I=Math.max(0,b-w);f.update(p,{remaining:I}),u.push({batchId:p.id,qty:w,batchDate:String(v.date||""),productName:String(v.productName||"")}),h-=w}if(h>0)throw new Error(`Inventario insuficiente. Faltan ${h} unidades.`);if(a)for(const m of u)await ta(xt(Ne,"batch_clothes_allocations"),{saleId:a,saleDate:n,productId:e,productName:m.productName??"",batchId:m.batchId,batchDate:m.batchDate??"",quantity:m.qty,createdAt:Nr.now()})}),{allocations:u}}async function pF(t){const e=Kt(Ne,"sales_clothes",t),r=await Es(e);if(!r.exists())throw new Error("La venta no existe.");const n=r.data(),a=[];if(Array.isArray(n.items)&&n.items.length>0){const l={};if(n.allocationsByItem&&typeof n.allocationsByItem=="object")for(const c of Object.keys(n.allocationsByItem)){const d=n.allocationsByItem[c],u=String((d==null?void 0:d.productId)||c||"");if(!u)continue;const f=Array.isArray(d==null?void 0:d.allocations)?d.allocations:[];l[u]=f.map(A=>({batchId:String(A.batchId),qty:Math.max(0,Math.floor(Number(A.qty||A.quantity||0)))}))}if(Array.isArray(n.allocationsByItem))for(const c of n.allocationsByItem){const d=String((c==null?void 0:c.productId)||"");if(!d)continue;const u=Array.isArray(c==null?void 0:c.allocations)?c.allocations:[];l[d]=u.map(f=>({batchId:String(f.batchId),qty:Math.max(0,Math.floor(Number(f.qty||f.quantity||0)))}))}for(const c of n.items){const d=String((c==null?void 0:c.productId)||"");if(!d)continue;const u=Math.max(0,Math.floor(Number((c==null?void 0:c.qty)||(c==null?void 0:c.quantity)||0))),f=Array.isArray(c==null?void 0:c.allocations)?c.allocations.map(A=>({batchId:String(A.batchId),qty:Math.max(0,Math.floor(Number(A.qty||A.quantity||0)))})):l[d]||[];a.push({productId:d,productName:String((c==null?void 0:c.productName)||""),qty:u,allocations:f.length?f:void 0})}}else{const l=n.item||{},c=String(l.productId||n.productId||""),d=Math.max(0,Math.floor(Number(l.qty??n.quantity??0))),u=Array.isArray(n.allocations)?n.allocations.map(f=>({batchId:String(f.batchId),qty:Math.max(0,Math.floor(Number(f.qty||f.quantity||0)))})):[];c&&d>0&&a.push({productId:c,productName:String(l.productName||n.productName||""),qty:d,allocations:u.length?u:void 0})}return a.length===0?(await fi(Ne,async l=>{l.delete(e)}),{restored:0}):a.every(l=>Array.isArray(l.allocations)&&l.allocations.length>0)?(await fi(Ne,async c=>{const d=[];for(const f of a)for(const A of f.allocations||[])d.push({ref:Kt(Ne,"inventory_clothes_batches",A.batchId),addBack:Math.max(0,Math.floor(Number(A.qty||0)))});const u=await Promise.all(d.map(f=>c.get(f.ref)));for(let f=0;f<d.length;f++){const A=u[f];if(!A.exists())continue;const h=A.data(),m=Math.max(0,Math.floor(Number(h.remaining||0)));c.update(d[f].ref,{remaining:m+d[f].addBack})}c.delete(e)}),{restored:a.reduce((c,d)=>c+(d.allocations||[]).reduce((u,f)=>u+f.qty,0),0)}):(await fi(Ne,async l=>{const c={};for(const h of a){if(!h.productId||h.qty<=0)continue;const m=ar(xt(Ne,"inventory_clothes_batches"),lr("productId","==",h.productId)),x=(await Ut(m)).docs.map(v=>{const y=v.data(),b=Math.max(0,Math.floor(Number(y.quantity||0))),w=Number.isFinite(Number(y.remaining))?Math.max(0,Math.floor(Number(y.remaining||0))):b;return{id:v.id,date:String(y.date||""),quantity:b,remaining:w}}).sort((v,y)=>v.date.localeCompare(y.date));c[h.productId]=x}const d=[];for(const h of a){if(!h.productId||h.qty<=0)continue;if(Array.isArray(h.allocations)&&h.allocations.length>0){for(const x of h.allocations)d.push({id:x.batchId,addBack:Math.max(0,Math.floor(Number(x.qty||0)))});continue}const m=c[h.productId]||[];let p=h.qty;for(const x of m){if(p<=0)break;const v=Math.max(0,x.quantity-x.remaining);if(v<=0)continue;const y=Math.min(v,p);d.push({id:x.id,addBack:y}),p-=y}for(const x of m){if(p<=0)break;const v=Math.min(p,h.qty);d.push({id:x.id,addBack:v}),p-=v}}const u={};for(const h of d)u[h.id]=(u[h.id]||0)+Math.max(0,Math.floor(Number(h.addBack||0)));const f=Object.keys(u).map(h=>Kt(Ne,"inventory_clothes_batches",h)),A=await Promise.all(f.map(h=>l.get(h)));for(let h=0;h<f.length;h++){const m=A[h];if(!m.exists())continue;const p=m.data(),x=Math.max(0,Math.floor(Number(p.remaining||0))),v=Math.max(0,Math.floor(Number(u[f[h].id]||0)));l.update(f[h],{remaining:x+v})}l.delete(e)}),{restored:a.reduce((l,c)=>l+c.qty,0)})}const F$=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],Dh=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function d_(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function O$(t){const e=ar(xt(Ne,"ar_movements"),lr("ref.saleId","==",t)),r=await Ut(e);await Promise.all(r.docs.map(n=>na(Kt(Ne,"ar_movements",n.id))))}function kLe(){const[t,e]=g.useState(!1),[r,n]=g.useState(!1),[a,s]=g.useState(null),[o,l]=g.useState([]),c=async Oe=>{e(!0),n(!0),s(Oe),l([]);try{const Ae=(await Ut(ar(xt(Ne,"sales_clothes"),lr("__name__","==",Oe)))).docs[0],Le=Ae==null?void 0:Ae.data(),ct=(Array.isArray(Le==null?void 0:Le.items)?Le.items:Le!=null&&Le.item?[Le.item]:[]).map(st=>({productName:String(st.productName||""),qty:Number(st.qty||0),unitPrice:Number(st.unitPrice||0),discount:Number(st.discount||0),total:Number(st.total||0)}));l(ct)}catch(be){console.error(be)}finally{n(!1)}},[d,u]=g.useState(""),[f,A]=g.useState("+505 "),[h,m]=g.useState(""),[p,x]=g.useState(""),[v,y]=g.useState("ACTIVO"),[b,w]=g.useState(0),[I,j]=g.useState([]),[N,S]=g.useState(!0),[E,B]=g.useState(""),[k,T]=g.useState(null),[P,q]=g.useState(""),[de,ce]=g.useState("+505 "),[le,he]=g.useState(""),[ae,Ce]=g.useState(""),[De,O]=g.useState("ACTIVO"),[R,G]=g.useState(0),[M,K]=g.useState(!1),[Y,D]=g.useState(null),[V,te]=g.useState(!1),[ve,Q]=g.useState([]),[Xe,se]=g.useState({saldoActual:0,totalAbonado:0,totalCargos:0}),[Z,ke]=g.useState(!1),[Se,Ee]=g.useState(0),[Ze,ot]=g.useState(new Date().toISOString().slice(0,10)),[vt,_t]=g.useState(""),[Tt,Lt]=g.useState(!1),[Rt,Et]=g.useState(null),[Re,Te]=g.useState(""),[Ye,dt]=g.useState(0),[Fe,je]=g.useState(""),[We,ee]=g.useState(!1);g.useEffect(()=>{(async()=>{const Oe=ar(xt(Ne,"customers_clothes"),kn("createdAt","desc")),be=await Ut(Oe),Ae=[];be.forEach(Le=>{const ut=Le.data();Ae.push({id:Le.id,name:ut.name??"",phone:ut.phone??"+505 ",place:ut.place??"",notes:ut.notes??"",status:ut.status??"ACTIVO",creditLimit:Number(ut.creditLimit??0),createdAt:ut.createdAt??Nr.now(),balance:0})});for(const Le of Ae)try{const ut=ar(xt(Ne,"ar_movements"),lr("customerId","==",Le.id)),ct=await Ut(ut);let st=0;ct.forEach(z=>st+=Number(z.data().amount||0)),Le.balance=st}catch{Le.balance=0}j(Ae),S(!1)})()},[]);const Ve=()=>{u(""),A("+505 "),m(""),x(""),y("ACTIVO"),w(0)},rt=async Oe=>{if(Oe.preventDefault(),B(""),!d.trim()){B("Ingresa el nombre.");return}const be=d_(f);if(be.length<6){B("Telfono incompleto.");return}try{const Ae=await ta(xt(Ne,"customers_clothes"),{name:d.trim(),phone:be,place:h||"",notes:p||"",status:v,creditLimit:Number(b||0),createdAt:Nr.now()});j(Le=>[{id:Ae.id,name:d.trim(),phone:be,place:h||"",notes:p||"",status:v,creditLimit:Number(b||0),createdAt:Nr.now(),balance:0},...Le]),Ve(),ee(!1),B(" Cliente creado")}catch(Ae){console.error(Ae),B(" Error al crear cliente")}},$e=Oe=>{T(Oe.id),q(Oe.name),ce(Oe.phone||"+505 "),he(Oe.place||""),Ce(Oe.notes||""),O(Oe.status||"ACTIVO"),G(Number(Oe.creditLimit||0))},ie=()=>{T(null),q(""),ce("+505 "),he(""),Ce(""),O("ACTIVO"),G(0)},pe=async()=>{if(!k)return;const Oe=d_(de);if(!P.trim()){B("Ingresa el nombre.");return}try{await Mn(Kt(Ne,"customers_clothes",k),{name:P.trim(),phone:Oe,place:le||"",notes:ae||"",status:De,creditLimit:Number(R||0)}),j(be=>be.map(Ae=>Ae.id===k?{...Ae,name:P.trim(),phone:Oe,place:le||"",notes:ae||"",status:De,creditLimit:Number(R||0)}:Ae)),ie(),B(" Cliente actualizado")}catch(be){console.error(be),B(" Error al actualizar")}},fe=async Oe=>{if(confirm(`Eliminar al cliente "${Oe.name}"?
Se devolvern al inventario todas las prendas de sus compras y se borrarn sus movimientos.`))try{S(!0);const Ae=ar(xt(Ne,"sales_clothes"),lr("customerId","==",Oe.id)),Le=await Ut(Ae);for(const st of Le.docs){const z=st.id;try{await pF(z)}catch(X){console.warn("restoreSaleAndDeleteClothes error",X);try{await na(Kt(Ne,"sales_clothes",z))}catch{}}await O$(z)}const ut=ar(xt(Ne,"ar_movements"),lr("customerId","==",Oe.id)),ct=await Ut(ut);await Promise.all(ct.docs.map(st=>na(Kt(Ne,"ar_movements",st.id)))),await na(Kt(Ne,"customers_clothes",Oe.id)),j(st=>st.filter(z=>z.id!==Oe.id)),B(" Cliente eliminado y prendas devueltas al inventario")}catch(Ae){console.error(Ae),B(" No se pudo eliminar el cliente.")}finally{S(!1)}},Me=async Oe=>{D(Oe),Q([]),se({saldoActual:0,totalAbonado:0,totalCargos:0}),K(!0),ke(!1),Ee(0),ot(new Date().toISOString().slice(0,10)),_t(""),Et(null),te(!0);try{const be=ar(xt(Ne,"ar_movements"),lr("customerId","==",Oe.id)),Ae=await Ut(be),Le=[];Ae.forEach(ut=>{var st,z;const ct=ut.data();Le.push({id:ut.id,date:ct.date??((z=(st=ct.createdAt)==null?void 0:st.toDate)!=null&&z.call(st)?ct.createdAt.toDate().toISOString().slice(0,10):""),type:ct.type??"CARGO",amount:Number(ct.amount||0),ref:ct.ref||{},comment:ct.comment||"",createdAt:ct.createdAt})}),Le.sort((ut,ct)=>{var X,re;if(ut.date!==ct.date)return ut.date.localeCompare(ct.date);const st=((X=ut.createdAt)==null?void 0:X.seconds)||0,z=((re=ct.createdAt)==null?void 0:re.seconds)||0;return st-z}),Q(Le),me(Le)}catch(be){console.error(be),B(" No se pudo cargar el estado de cuenta")}finally{te(!1)}},me=Oe=>{const be=Oe.reduce((ut,ct)=>ut+(Number(ct.amount)||0),0),Ae=Oe.filter(ut=>Number(ut.amount)<0).reduce((ut,ct)=>ut+Math.abs(Number(ct.amount)||0),0),Le=Oe.filter(ut=>Number(ut.amount)>0).reduce((ut,ct)=>ut+Number(ct.amount)||0,0);se({saldoActual:be,totalAbonado:Ae,totalCargos:Le})},ye=async()=>{if(!Y)return;B("");const Oe=Number(Se||0);if(!(Oe>0)){B("Ingresa un monto de abono mayor a 0.");return}const be=parseFloat(Oe.toFixed(2));if(!Ze){B("Selecciona la fecha del abono.");return}try{Lt(!0);const Ae={customerId:Y.id,type:"ABONO",amount:-be,date:Ze,comment:vt||"",createdAt:Nr.now()},ut={id:(await ta(xt(Ne,"ar_movements"),Ae)).id,date:Ze,type:"ABONO",amount:-be,comment:vt||"",createdAt:Nr.now()},ct=[...ve,ut].sort((st,z)=>{var H,L;if(st.date!==z.date)return st.date.localeCompare(z.date);const X=((H=st.createdAt)==null?void 0:H.seconds)||0,re=((L=z.createdAt)==null?void 0:L.seconds)||0;return X-re});Q(ct),me(ct),j(st=>st.map(z=>z.id===Y.id?{...z,balance:(z.balance||0)-be}:z)),D(st=>st&&{...st,balance:(st.balance||0)-be}),Ee(0),_t(""),ot(new Date().toISOString().slice(0,10)),ke(!1),B(" Abono registrado")}catch(Ae){console.error(Ae),B(" Error al registrar el abono")}finally{Lt(!1)}},mt=Oe=>{Et(Oe.id),Te(Oe.date||new Date().toISOString().slice(0,10)),dt(Math.abs(Number(Oe.amount||0))),je(Oe.comment||"")},gt=()=>{Et(null),Te(""),dt(0),je("")},yt=async()=>{if(!Rt)return;const Oe=ve.findIndex(ut=>ut.id===Rt);if(Oe===-1)return;const be=ve[Oe],Ae=Number(Ye||0);if(!(Ae>0)){B("El monto debe ser mayor a 0.");return}const Le=be.type==="ABONO"?-parseFloat(Ae.toFixed(2)):+parseFloat(Ae.toFixed(2));try{await Mn(Kt(Ne,"ar_movements",Rt),{date:Re,amount:Le,comment:Fe||""});const ut=[...ve];ut[Oe]={...be,date:Re,amount:Le,comment:Fe||""},ut.sort((st,z)=>{var H,L;if(st.date!==z.date)return st.date.localeCompare(z.date);const X=((H=st.createdAt)==null?void 0:H.seconds)||0,re=((L=z.createdAt)==null?void 0:L.seconds)||0;return X-re}),Q(ut),me(ut);const ct=ut.reduce((st,z)=>st+(Number(z.amount)||0),0);j(st=>st.map(z=>z.id===(Y==null?void 0:Y.id)?{...z,balance:ct}:z)),D(st=>st&&{...st,balance:ct}),gt(),B(" Movimiento actualizado")}catch(ut){console.error(ut),B(" Error al actualizar movimiento")}},Pt=async Oe=>{var Ae,Le;if(confirm(`Eliminar este movimiento (${Oe.type==="ABONO"?"Abono":"Compra"}) del ${Oe.date}?${Oe.type==="CARGO"&&((Ae=Oe.ref)!=null&&Ae.saleId)?`
Se devolvern al inventario las prendas de esa venta.`:""}`))try{if(S(!0),Oe.type==="CARGO"&&((Le=Oe.ref)!=null&&Le.saleId)){try{await pF(Oe.ref.saleId)}catch(st){console.warn("restoreSaleAndDeleteClothes error",st),S(!1),B(" No se pudo devolver inventario de la venta.");return}await O$(Oe.ref.saleId)}else await na(Kt(Ne,"ar_movements",Oe.id));const ut=ve.filter(st=>{var z,X;return Oe.type==="CARGO"&&((z=Oe.ref)!=null&&z.saleId)?((X=st.ref)==null?void 0:X.saleId)!==Oe.ref.saleId:st.id!==Oe.id});Q(ut),me(ut);const ct=ut.reduce((st,z)=>st+(Number(z.amount)||0),0);j(st=>st.map(z=>z.id===(Y==null?void 0:Y.id)?{...z,balance:ct}:z)),D(st=>st&&{...st,balance:ct}),B(" Movimiento eliminado")}catch(ut){console.error(ut),B(" Error al eliminar movimiento")}finally{S(!1)}},Ft=g.useMemo(()=>[...I].sort((Oe,be)=>{var Ae,Le;return Oe.status!==be.status?Oe.status==="BLOQUEADO"?1:-1:(((Ae=be.createdAt)==null?void 0:Ae.seconds)||0)-(((Le=Oe.createdAt)==null?void 0:Le.seconds)||0)}),[I]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Ropa)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>ee(!0),type:"button",children:"Crear Cliente"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:N?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):Ft.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin clientes"})}):Ft.map(Oe=>{var Ae;const be=k===Oe.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(Ae=Oe.createdAt)!=null&&Ae.toDate?Oe.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border",children:be?i.jsx("input",{className:"w-full border p-1 rounded",value:P,onChange:Le=>q(Le.target.value)}):Oe.name}),i.jsx("td",{className:"p-2 border",children:be?i.jsx("input",{className:"w-full border p-1 rounded",value:de,onChange:Le=>ce(d_(Le.target.value))}):Oe.phone}),i.jsx("td",{className:"p-2 border",children:be?i.jsxs("select",{className:"w-full border p-1 rounded",value:le,onChange:Le=>he(Le.target.value),children:[i.jsx("option",{value:"",children:""}),F$.map(Le=>i.jsx("option",{value:Le,children:Le},Le))]}):Oe.place||""}),i.jsx("td",{className:"p-2 border",children:be?i.jsxs("select",{className:"w-full border p-1 rounded",value:De,onChange:Le=>O(Le.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Oe.status==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:Oe.status})}),i.jsx("td",{className:"p-2 border",children:be?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(R)?"":R,onChange:Le=>G(Math.max(0,Number(Le.target.value||0)))}):Dh(Oe.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:Dh(Oe.balance||0)}),i.jsx("td",{className:"p-2 border",children:be?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:ae,onChange:Le=>Ce(Le.target.value),maxLength:500}):i.jsx("span",{title:Oe.notes||"",children:(Oe.notes||"").length>40?(Oe.notes||"").slice(0,40)+"":Oe.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:be?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:pe,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:ie,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>$e(Oe),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>fe(Oe),children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>Me(Oe),title:"Ver compras y abonos",children:"Estado de cuenta"})]})})})]},Oe.id)})})]})}),E&&i.jsx("p",{className:"mt-2 text-sm",children:E}),We&&$d.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>ee(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ee(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:rt,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:d,onChange:Oe=>u(Oe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:f,onChange:Oe=>A(d_(Oe.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:Oe=>m(Oe.target.value),children:[i.jsx("option",{value:"",children:""}),F$.map(Oe=>i.jsx("option",{value:Oe,children:Oe},Oe))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:v,onChange:Oe=>y(Oe.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:b===0?"":b,onChange:Oe=>w(Math.max(0,Number(Oe.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:p,onChange:Oe=>x(Oe.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[p.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ee(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),M&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(Y==null?void 0:Y.name)||""]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{Ee(0),ot(new Date().toISOString().slice(0,10)),_t(""),ke(!0)},children:"Abonar"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>K(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:Dh(Xe.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:Dh(Xe.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:Dh(Xe.saldoActual)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Referencia"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:V?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):ve.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):ve.map(Oe=>{var Ae,Le;const be=Rt===Oe.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:be?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:Re,onChange:ut=>Te(ut.target.value)}):Oe.date||""}),i.jsx("td",{className:"p-2 border",children:Oe.amount>=0?(Ae=Oe.ref)!=null&&Ae.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",title:"Ver piezas de esta compra",onClick:()=>c(Oe.ref.saleId),children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:(Le=Oe.ref)!=null&&Le.saleId?`Venta #${Oe.ref.saleId}`:""}),i.jsx("td",{className:"p-2 border",children:be?i.jsx("input",{className:"w-full border p-1 rounded",value:Fe,onChange:ut=>je(ut.target.value),placeholder:"Comentario"}):i.jsx("span",{title:Oe.comment||"",children:(Oe.comment||"").length>40?(Oe.comment||"").slice(0,40)+"":Oe.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:be?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Ye)?"":Ye,onChange:ut=>{const ct=Number(ut.target.value||0),st=Number.isFinite(ct)?Math.max(0,parseFloat(ct.toFixed(2))):0;dt(st)},placeholder:"0.00",title:Oe.type==="ABONO"?"Se guardar como negativo":"Se guardar como positivo"}):Dh(Oe.amount)}),i.jsx("td",{className:"p-2 border",children:be?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:yt,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:gt,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>mt(Oe),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Pt(Oe),children:"Borrar"})]})})]},Oe.id)})})]})})]})}),Z&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(Y==null?void 0:Y.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:Ze,onChange:Oe=>ot(Oe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto del abono"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Se===0?"":Se,onChange:Oe=>{const be=Number(Oe.target.value||0),Ae=Number.isFinite(be)?Math.max(0,parseFloat(be.toFixed(2))):0;Ee(Ae)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se guarda con 2 decimales (se registrar como ABONO negativo)."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:vt,onChange:Oe=>_t(Oe.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[vt.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ke(!1),disabled:Tt,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:ye,disabled:Tt,children:Tt?"Guardando...":"Guardar abono"})]})]})}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[65]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Piezas vendidas"," ",a?` #${a}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>e(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):o.map((Oe,be)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:Oe.productName}),i.jsx("td",{className:"p-2 border text-right",children:Oe.qty}),i.jsx("td",{className:"p-2 border text-right",children:Dh(Oe.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Dh(Oe.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Dh(Oe.total)})]},be))})]})})]})})]})}const wx=t=>`C$ ${(Number(t)||0).toFixed(2)}`,FLe=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"];async function OLe(t){if(!t)return 0;const e=ar(xt(Ne,"inventory_clothes_batches"),lr("productId","==",t)),r=await Ut(e);let n="0000-00-00",a=-1,s=0;return r.forEach(o=>{const l=o.data(),c=String(l.date||"0000-00-00"),d=Number(l.salePrice||0),u=l.createdAt,f=((u==null?void 0:u.seconds)??0)*1e3+((u==null?void 0:u.nanoseconds)??0)/1e6;c>n?(n=c,a=f,s=d):c===n&&f>a&&(a=f,s=d)}),Number(s||0)}async function D$(t){if(!t)return 0;const e=ar(xt(Ne,"inventory_clothes_batches"),lr("productId","==",t)),r=await Ut(e);let n=0;return r.forEach(a=>n+=Number(a.data().remaining||0)),n}function R$(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}function DLe({role:t="",roles:e}={role:""}){const r=e&&e.length?e:t;Rn(r,"admin"),Rn(r,"vendedor_ropa");const[n,a]=g.useState([]),[s,o]=g.useState([]),[l,c]=g.useState({}),[d,u]=g.useState("CONTADO"),[f,A]=g.useState(""),[h,m]=g.useState(""),[p,x]=g.useState(new Date().toISOString().slice(0,10)),[v,y]=g.useState(""),[b,w]=g.useState([]),I=g.useMemo(()=>b.reduce((Se,Ee)=>Se+(Ee.qty||0),0),[b]),j=g.useMemo(()=>{const Se=b.reduce((Ee,Ze)=>{const ot=Math.max(0,(Number(Ze.unitPrice)||0)*(Ze.qty||0)-(Number(Ze.discount)||0));return Ee+ot},0);return Math.floor(Se*100)/100},[b]),[N,S]=g.useState(0),[E,B]=g.useState(""),[k,T]=g.useState(!1),[P,q]=g.useState(!1),[de,ce]=g.useState(""),[le,he]=g.useState("+505 "),[ae,Ce]=g.useState(""),[De,O]=g.useState(""),[R,G]=g.useState("ACTIVO"),[M,K]=g.useState(0),Y=()=>{ce(""),he("+505 "),Ce(""),O(""),G("ACTIVO"),K(0)};g.useEffect(()=>{(async()=>{const Se=ar(xt(Ne,"customers_clothes"),kn("createdAt","desc")),Ee=await Ut(Se),Ze=[];Ee.forEach(Et=>{const Re=Et.data();Ze.push({id:Et.id,name:Re.name??"",phone:Re.phone??"+505 ",place:Re.place??"",status:Re.status??"ACTIVO",creditLimit:Number(Re.creditLimit??0),balance:0})});for(const Et of Ze)try{const Re=ar(xt(Ne,"ar_movements"),lr("customerId","==",Et.id)),Te=await Ut(Re);let Ye=0;Te.forEach(dt=>Ye+=Number(dt.data().amount||0)),Et.balance=Ye}catch{Et.balance=0}a(Ze);const ot=ar(xt(Ne,"products_clothes"),kn("createdAt","desc")),vt=await Ut(ot),_t=[];vt.forEach(Et=>{const Re=Et.data();_t.push({id:Et.id,name:Re.name??"(sin nombre)",sku:Re.sku??""})}),o(_t);const Tt=ar(xt(Ne,"inventory_clothes_batches"),lr("remaining",">",0)),Lt=await Ut(Tt),Rt={};Lt.forEach(Et=>{const Re=Et.data(),Te=Re.productId||"",Ye=Number(Re.remaining||0);Te&&(Rt[Te]=(Rt[Te]||0)+Ye)}),c(Rt)})()},[]);const D=g.useMemo(()=>n.find(Se=>Se.id===f),[n,f]),V=(D==null?void 0:D.balance)||0,te=d==="CREDITO"?V+Math.max(0,Number(j||0))-Math.max(0,Number(N||0)):0,ve=async Se=>{if(!Se)return;if(b.some(_t=>_t.productId===Se)){y("");return}const Ee=s.find(_t=>_t.id===Se);if(!Ee){y("");return}let Ze=await OLe(Se);Ze||(Ze=Number((Ee==null?void 0:Ee.price)||0));const ot=await D$(Se),vt={productId:Se,productName:Ee.name||"",sku:Ee.sku||"",unitPrice:Number(Ze)||0,available:Number(ot)||0,qty:0,discount:0};w(_t=>[..._t,vt]),y("")},Q=(Se,Ee)=>{w(Ze=>Ze.map(ot=>{if(ot.productId!==Se)return ot;if(Ee==="")return{...ot,qty:0};const vt=Math.max(0,Math.floor(Number(Ee)));return{...ot,qty:vt}}))},Xe=(Se,Ee)=>{w(Ze=>Ze.map(ot=>{if(ot.productId!==Se)return ot;if(Ee==="")return{...ot,discount:0};const vt=Math.max(0,Math.floor(Number(Ee)));return{...ot,discount:vt}}))},se=Se=>w(Ee=>Ee.filter(Ze=>Ze.productId!==Se)),Z=async()=>{if(!p)return"Selecciona la fecha.";if(b.length===0)return"Agrega al menos un producto.";const Se=b.filter(Ee=>(Ee.qty||0)>0);if(Se.length===0)return"Debes ingresar cantidades (> 0) en al menos un producto.";if(!(j>0))return"El total debe ser mayor a cero.";if(d==="CONTADO"){if(!h.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!f)return"Selecciona un cliente (crdito).";if(N<0)return"El pago inicial no puede ser negativo.";if(N>j)return"El pago inicial no puede superar el total.";if((D==null?void 0:D.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede facturar a crdito."}for(const Ee of Se){const Ze=await D$(Ee.productId);if(Ee.qty>Ze)return`Inventario insuficiente para "${Ee.productName}". Disponible: ${Ze} unidades.`;const ot=(Number(Ee.unitPrice)||0)*(Ee.qty||0),vt=Number(Ee.discount)||0;if(!Number.isInteger(vt)||vt<0)return`El descuento en "${Ee.productName}" debe ser entero y  0.`;if(vt>ot)return`El descuento en "${Ee.productName}" no puede exceder C$ ${ot.toFixed(2)}.`}return null},ke=async Se=>{Se.preventDefault(),B("");const Ee=await Z();if(Ee){B(" "+Ee);return}try{T(!0);const Ze=b.filter(Tt=>(Tt.qty||0)>0).map(Tt=>{const Lt=(Number(Tt.unitPrice)||0)*(Tt.qty||0),Rt=Math.max(0,Math.floor(Number(Tt.discount)||0)),Et=Math.max(0,Lt-Rt);return{productId:Tt.productId,productName:Tt.productName,sku:Tt.sku||"",qty:Tt.qty,unitPrice:Number(Tt.unitPrice)||0,discount:Rt,total:Math.floor(Et*100)/100}}),ot={type:d,date:p,createdAt:Nr.now(),itemsTotal:Number(j)||0,total:Number(j)||0,quantity:Number(I)||0,items:Ze};d==="CONTADO"?ot.customerName=h.trim():(ot.customerId=f,ot.downPayment=Number(N)||0);const vt=await ta(xt(Ne,"sales_clothes"),ot);if(d==="CREDITO"&&f){const Tt={customerId:f,date:p,createdAt:Nr.now(),ref:{saleId:vt.id}};await ta(xt(Ne,"ar_movements"),{...Tt,type:"CARGO",amount:Number(j)||0}),Number(N)>0&&await ta(xt(Ne,"ar_movements"),{...Tt,type:"ABONO",amount:-Number(N)})}const _t={};for(const Tt of Ze)if(Tt.qty>0){const{allocations:Lt}=await BLe({productId:Tt.productId,quantity:Tt.qty,saleDate:p,saleId:vt.id});_t[Tt.productId]={productId:Tt.productId,allocations:Lt}}await Mn(Kt(Ne,"sales_clothes",vt.id),{allocationsByItem:_t}),u("CONTADO"),A(""),m(""),x(new Date().toISOString().slice(0,10)),w([]),S(0),d==="CREDITO"&&f&&a(Tt=>Tt.map(Lt=>Lt.id===f?{...Lt,balance:(Lt.balance||0)+(Number(j)||0)-(Number(N)||0)}:Lt)),B(" Venta registrada"),(async()=>{const Tt=ar(xt(Ne,"inventory_clothes_batches"),lr("remaining",">",0)),Lt=await Ut(Tt),Rt={};Lt.forEach(Et=>{const Re=Et.data(),Te=Re.productId||"",Ye=Number(Re.remaining||0);Te&&(Rt[Te]=(Rt[Te]||0)+Ye)}),c(Rt)})()}catch(Ze){console.error(Ze),B(" Error al guardar la venta")}finally{T(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas (Ropa)"}),i.jsxs("form",{onSubmit:ke,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:d,onChange:Se=>u(Se.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),d==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre del cliente (contado)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Cliente Mostrador",value:h,onChange:Se=>m(Se.target.value)})]}):i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("select",{className:"flex-1 border p-2 rounded",value:f,onChange:Se=>A(Se.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),n.map(Se=>i.jsxs("option",{value:Se.status==="ACTIVO"?Se.id:"",disabled:Se.status==="BLOQUEADO",children:[Se.name," | ",Se.phone," | Saldo: ",wx(Se.balance||0)]},Se.id))]}),i.jsx("button",{type:"button",className:"px-20 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>q(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:wx(V)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:N===0?"":N,onChange:Se=>S(Math.max(0,Number(Se.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:wx(te)})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:p,onChange:Se=>x(Se.target.value)})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:v,onChange:async Se=>{const Ee=Se.target.value;y(Ee),await ve(Ee)},children:[i.jsx("option",{value:"",children:"Selecciona un producto"}),s.map(Se=>{const Ee=b.some(vt=>vt.productId===Se.id),Ze=l[Se.id]||0,ot=Ee||Ze<=0;return i.jsxs("option",{value:ot?"":Se.id,disabled:ot,children:[Se.name," ",Se.sku?` ${Se.sku}`:""," ",Ze>0?`(disp: ${Ze})`:"(sin stock)",Ee?" (seleccionado)":""]},Se.id)})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Productos sin existencias se muestran en gris y no se pueden seleccionar."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsxs("div",{className:"border rounded overflow-hidden",children:[i.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 px-3 py-2 text-xs font-semibold border-b",children:[i.jsx("div",{className:"col-span-4",children:"Producto"}),i.jsx("div",{className:"col-span-2 text-right",children:"Precio"}),i.jsx("div",{className:"col-span-2 text-right",children:"Existencias"}),i.jsx("div",{className:"col-span-1 text-right",children:"Cantidad"}),i.jsx("div",{className:"col-span-1 text-right",children:"Descuento"}),i.jsx("div",{className:"col-span-1 text-right",children:"Monto"}),i.jsx("div",{className:"col-span-1 text-center",children:"Quitar"})]}),b.length===0?i.jsx("div",{className:"px-3 py-4 text-sm text-gray-500",children:"No hay productos agregados."}):b.map(Se=>{const Ee=Math.max(0,(Se.available||0)-(Se.qty||0)),Ze=(Number(Se.unitPrice)||0)*(Se.qty||0),ot=Math.max(0,Ze-(Number(Se.discount)||0));return i.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 border-b text-sm gap-x-2",children:[i.jsx("div",{className:"col-span-4",children:i.jsxs("div",{className:"font-medium",children:[Se.productName,Se.sku?`  ${Se.sku}`:""]})}),i.jsx("div",{className:"col-span-2 text-right",children:wx(Se.unitPrice)}),i.jsx("div",{className:"col-span-2 text-right",children:Ee}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(Se.qty)||Se.qty===0?"":Se.qty,onChange:vt=>Q(Se.productId,vt.target.value),inputMode:"numeric",placeholder:"0",title:"Cantidad de piezas"})}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(Se.discount)||Se.discount===0?"":Se.discount,onChange:vt=>Xe(Se.productId,vt.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento entero (C$)"})}),i.jsx("div",{className:"col-span-1 text-right",children:wx(ot)}),i.jsx("div",{className:"col-span-1 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 hover:bg-red-200",onClick:()=>se(Se.productId),title:"Quitar producto",children:""})})]},Se.productId)})]}),b.length>0&&i.jsxs("div",{className:"flex justify-end gap-6 mt-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Piezas totales: "}),i.jsx("span",{className:"font-semibold",children:I})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Total: "}),i.jsx("span",{className:"font-semibold",children:wx(j)})]})]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",disabled:k,children:k?"Guardando...":"Registrar venta"})})]}),E&&i.jsx("p",{className:"mt-2 text-sm",children:E}),P&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-xl p-4",children:[i.jsx("h3",{className:"text-lg font-bold mb-3",children:"Nuevo cliente"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:de,onChange:Se=>ce(Se.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:le,onChange:Se=>he(R$(Se.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ae,onChange:Se=>Ce(Se.target.value),children:[i.jsx("option",{value:"",children:""}),FLe.map(Se=>i.jsx("option",{value:Se,children:Se},Se))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:R,onChange:Se=>G(Se.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:M===0?"":M,onChange:Se=>K(Math.max(0,Number(Se.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:De,onChange:Se=>O(Se.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{Y(),q(!1)},children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:async()=>{if(B(""),!de.trim()){B("Ingresa el nombre del nuevo cliente.");return}const Se=R$(le);try{const Ee=await ta(xt(Ne,"customers_clothes"),{name:de.trim(),phone:Se,place:ae||"",notes:De||"",status:R,creditLimit:Number(M||0),createdAt:Nr.now()}),Ze={id:Ee.id,name:de.trim(),phone:Se,place:ae||"",status:R,creditLimit:Number(M||0),balance:0};a(ot=>[Ze,...ot]),A(Ee.id),Y(),q(!1),B(" Cliente creado")}catch(Ee){console.error(Ee),B(" Error al crear cliente")}},children:"Guardar cliente"})]})]})}),k&&i.jsx("div",{className:"fixed inset-0 z-[70] bg-black/40 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border px-4 py-3 flex items-center gap-3",children:[i.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-medium",children:"Guardando venta"})]})})]})}const Po=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function CE(t){var r;const e=t==null?void 0:t.date;return e||((r=t==null?void 0:t.createdAt)!=null&&r.toDate?Kr(t.createdAt.toDate(),"yyyy-MM-dd"):"")}function RLe(t,e){const r=CE(t);if(!r)return null;if(Array.isArray(t.items))return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total??t.itemsTotal??0),items:t.items.map(o=>({productId:String(o.productId||""),productName:String(o.productName||""),sku:o.sku||"",qty:Number(o.qty||0),unitPrice:Number(o.unitPrice??(Number(o.total||0)/Math.max(1,Number(o.qty||0))||0)),discount:Number(o.discount||0)})),customerId:t.customerId||void 0,customerName:t.customerName||void 0};const n=t.item||{},a=Number(t.quantity??n.qty??0),s=Number(t.total??t.itemsTotal??n.total??0);return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total??t.itemsTotal??s??0),items:[{productId:String(n.productId||t.productId||""),productName:String(n.productName||t.productName||""),sku:n.sku||t.sku||"",qty:a,unitPrice:Number(n.unitPrice??(s&&a?s/a:0)),discount:Number(n.discount||0)}],customerId:t.customerId||void 0,customerName:t.customerName||void 0}}function MLe(t,e,r,n){const a={};for(const l of t)a[l.productId]||(a[l.productId]={productName:l.productName,lots:[]}),a[l.productId].lots.push({date:l.date,qtyLeft:Number(l.quantity||0),cost:Number(l.purchasePrice||0)});for(const l of Object.keys(a))a[l].lots.sort((c,d)=>c.date.localeCompare(d.date));const s=[...e].sort((l,c)=>l.date.localeCompare(c.date));let o=0;for(const l of s)for(const c of l.items||[]){const d=a[c.productId];if(!d)continue;let u=Number(c.qty||0);if(!(u<=0))for(const f of d.lots){if(u<=0)break;if(f.qtyLeft<=0)continue;const A=Math.min(f.qtyLeft,u);l.date>=r&&l.date<=n&&(o+=A*f.cost),f.qtyLeft-=A,u-=A}}return o}function LLe(){const{refreshKey:t,refresh:e}=bc(),[r,n]=g.useState(Kr(Gu(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Kr($u(new Date),"yyyy-MM-dd")),[o,l]=g.useState([]),[c,d]=g.useState([]),[u,f]=g.useState([]),[A,h]=g.useState([]),[m,p]=g.useState([]),[x,v]=g.useState([]),[y,b]=g.useState(!0),[w,I]=g.useState(""),[j,N]=g.useState(!1),[S,E]=g.useState(null),[B,k]=g.useState([]),[T,P]=g.useState(!1),[q,de]=g.useState({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});g.useEffect(()=>{(async()=>{b(!0),I("");try{const O=await Ut(xt(Ne,"sales_clothes")),R=[],G=[];O.forEach(se=>{const Z=se.data(),ke=RLe(Z,se.id);ke&&(ke.date<=a&&R.push(ke),ke.date>=r&&ke.date<=a&&G.push(ke))}),d(R),l(G);const M=await Ut(xt(Ne,"inventory_clothes_batches")),K=[];M.forEach(se=>{const Z=se.data(),ke=CE(Z);!ke||ke>a||K.push({id:se.id,productId:Z.productId,productName:Z.productName||"",date:ke,quantity:Number(Z.quantity||0),remaining:Number(Z.remaining||0),purchasePrice:Number(Z.purchasePrice||0)})}),f(K);const Y=await Ut(xt(Ne,"expenses_clothes")),D=[];Y.forEach(se=>{const Z=se.data(),ke=CE(Z);ke&&ke>=r&&ke<=a&&D.push({id:se.id,date:ke,category:Z.category||"",description:Z.description||"",amount:Number(Z.amount||0),status:Z.status||""})}),h(D);const V=await Ut(xt(Ne,"ar_movements")),te=[],ve={};V.forEach(se=>{const Z=se.data(),ke=CE(Z);if(!ke)return;const Se=Z.customerId,Ee=Number(Z.amount||0);Se&&(ve[Se]=(ve[Se]||0)+Ee),Z.type==="ABONO"&&ke>=r&&ke<=a&&te.push({id:se.id,customerId:Se,type:"ABONO",amount:Ee,date:ke})}),p(te);const Q=await Ut(xt(Ne,"customers_clothes")),Xe=[];Q.forEach(se=>{const Z=se.data();Xe.push({id:se.id,name:Z.name||"",balance:ve[se.id]||0})}),v(Xe)}catch(O){console.error(O),I(" Error cargando datos del dashboard.")}finally{b(!1)}})()},[r,a,t]);const ce=g.useMemo(()=>{try{return MLe(u,c,r,a)}catch(O){return console.error(O),0}},[u,c,r,a]),le=g.useMemo(()=>{const O=o.reduce((ve,Q)=>ve+(Q.total||0),0),R=A.reduce((ve,Q)=>ve+(Q.amount||0),0),G=O-ce,M=G-R,K=m.reduce((ve,Q)=>ve+Math.abs(Q.amount||0),0),Y=x.filter(ve=>(ve.balance||0)>0),D=Y.reduce((ve,Q)=>ve+(Q.balance||0),0);let V=0,te=0;for(const ve of o){const Q=(ve.items||[]).reduce((Xe,se)=>Xe+(Number(se.qty)||0),0);ve.type==="CONTADO"?V+=Q:te+=Q}return{ventasTotales:O,costoMercaderia:ce,gastosPeriodo:R,gananciaAntes:G,gananciaDespues:M,abonosRecibidos:K,saldosPendientes:D,clientesConSaldo:Y.length,prendasCash:V,prendasCredito:te}},[o,A,m,x,ce]),he=g.useMemo(()=>{const O={};for(const R of o){if(R.type!=="CREDITO"||!R.customerId)continue;const G=(R.items||[]).reduce((M,K)=>M+(Number(K.qty)||0),0);O[R.customerId]=(O[R.customerId]||0)+G}return x.filter(R=>(R.balance||0)>0).map(R=>({customerId:R.id,name:R.name,prendasCredito:O[R.id]||0,saldo:R.balance||0})).sort((R,G)=>G.saldo-R.saldo)},[x,o]),ae=g.useMemo(()=>{const O={};return x.forEach(R=>O[R.id]=R.name),O},[x]),Ce=g.useMemo(()=>[...o].sort((O,R)=>R.date.localeCompare(O.date)).map(O=>{var M;const R=(O.items||[]).reduce((K,Y)=>K+(Number(Y.qty)||0),0);let G="Cash";return O.type==="CREDITO"&&O.customerId?G=ae[O.customerId]||"":O.type==="CONTADO"&&(G=((M=O.customerName)==null?void 0:M.trim())||"Cash"),{id:O.id,date:O.date,type:O.type==="CREDITO"?"Crdito":"Cash",customer:G,piezas:R,total:Number(O.total||0)}}),[o,ae]),De=async O=>{N(!0),E({id:O.customerId,name:O.name}),k([]),P(!0),de({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});try{const R=[];let G=0,M=0,K=0;for(const te of o)if(!(te.type!=="CREDITO"||te.customerId!==O.customerId))for(const ve of te.items||[]){const Q=Number(ve.qty||0),Xe=Number(ve.unitPrice||0),se=Q*Xe,Z=Math.max(0,Number(ve.discount||0)),ke=Math.max(0,se-Z);R.push({saleId:te.id,date:te.date,productName:ve.productName,sku:ve.sku||"",qty:Q,unitPrice:Xe,lineTotal:se,discount:Z,lineFinal:ke}),G+=se,M+=Z,K+=ke}let Y=0;for(const te of m)te.customerId===O.customerId&&(Y+=Math.abs(te.amount||0));const D=x.find(te=>te.id===O.customerId),V=(D==null?void 0:D.balance)||0;k(R),de({totalBruto:G,totalDescuento:M,totalFiado:K,saldoActual:V,abonadoPeriodo:Y})}catch(R){console.error(R),I(" No se pudo cargar el detalle del cliente.")}finally{P(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas (Ropa)"}),i.jsx(yc,{onClick:e,loading:y})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:O=>n(O.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:O=>s(O.target.value)})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:Po(le.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Cash + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:Po(le.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia antes de Gastos"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:Po(le.gananciaAntes)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos del Negocio"}),i.jsx("div",{className:"text-xl font-semibold",children:Po(le.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia despus de Gastos"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:Po(le.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:Po(le.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:Po(le.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:le.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prendas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:le.prendasCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prendas Crdito (vendidas)"}),i.jsx("div",{className:"text-xl font-semibold",children:le.prendasCredito})]})]}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Consolidado por cliente"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Prendas Crdito (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo actual"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:3,children:"Cargando"})}):he.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:3,children:"Sin clientes con saldo"})}):he.map(O=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:O.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>De({customerId:O.customerId,name:O.name}),title:"Ver piezas fiadas del periodo",children:O.prendasCredito})}),i.jsx("td",{className:"p-2 border font-semibold",children:Po(O.saldo)})]},O.customerId))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Piezas"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):Ce.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin transacciones en el rango seleccionado."})}):Ce.map(O=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:O.date}),i.jsx("td",{className:"p-2 border",children:O.customer}),i.jsx("td",{className:"p-2 border",children:O.type}),i.jsx("td",{className:"p-2 border",children:O.piezas}),i.jsx("td",{className:"p-2 border",children:Po(O.total)})]},O.id))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):A.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):A.sort((O,R)=>O.date.localeCompare(R.date)).map(O=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:O.date}),i.jsx("td",{className:"p-2 border",children:O.category||""}),i.jsx("td",{className:"p-2 border",children:O.description?i.jsx("span",{title:O.description,children:O.description.length>40?O.description.slice(0,40)+"":O.description}):""}),i.jsx("td",{className:"p-2 border",children:Po(O.amount)}),i.jsx("td",{className:"p-2 border",children:O.status||""})]},O.id))})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w}),j&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle del cliente  ",(S==null?void 0:S.name)||""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>N(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total Bruto (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:Po(q.totalBruto)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Descuento (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:Po(q.totalDescuento)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Total Fiado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:Po(q.totalFiado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:Po(q.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:Po(q.abonadoPeriodo)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha compra"}),i.jsx("th",{className:"p-2 border",children:"Pieza"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Cant."}),i.jsx("th",{className:"p-2 border",children:"P. Unit"}),i.jsx("th",{className:"p-2 border",children:"Monto"})," ",i.jsx("th",{className:"p-2 border",children:"Descuento"})," ",i.jsx("th",{className:"p-2 border",children:"Monto final"})," "]})}),i.jsx("tbody",{children:T?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Cargando"})}):B.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Sin piezas fiadas en el periodo."})}):B.sort((O,R)=>O.date.localeCompare(R.date)).map((O,R)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:O.date}),i.jsx("td",{className:"p-2 border",children:O.productName}),i.jsx("td",{className:"p-2 border",children:O.sku||""}),i.jsx("td",{className:"p-2 border",children:O.qty}),i.jsx("td",{className:"p-2 border",children:Po(O.unitPrice)}),i.jsx("td",{className:"p-2 border",children:Po(O.lineTotal)}),i.jsx("td",{className:"p-2 border",children:Po(O.discount)}),i.jsx("td",{className:"p-2 border",children:Po(O.lineFinal)})]},`${O.saleId}-${R}`))})]})})]})})]})}const M$=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal"],u_=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function ULe(){const[t,e]=g.useState(Kr(Gu(new Date),"yyyy-MM-dd")),[r,n]=g.useState(Kr($u(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Kr(new Date,"yyyy-MM-dd")),[o,l]=g.useState(""),[c,d]=g.useState(""),[u,f]=g.useState(0),[A,h]=g.useState("PENDIENTE"),[m,p]=g.useState(""),[x,v]=g.useState([]),[y,b]=g.useState(!0),[w,I]=g.useState(""),[j,N]=g.useState(null),[S,E]=g.useState(""),[B,k]=g.useState(""),[T,P]=g.useState(""),[q,de]=g.useState(0),[ce,le]=g.useState("PENDIENTE"),[he,ae]=g.useState("");g.useEffect(()=>{(async()=>{b(!0);try{const D=ar(xt(Ne,"expenses_clothes"),kn("date","desc")),V=await Ut(D),te=[];V.forEach(ve=>{const Q=ve.data();te.push({id:ve.id,date:Q.date||Kr(new Date,"yyyy-MM-dd"),category:Q.category||"",description:Q.description||"",amount:Number(Q.amount||0),status:Q.status||"PENDIENTE",notes:Q.notes||"",createdAt:Q.createdAt??Nr.now()})}),v(te)}catch(D){console.error(D),I(" Error al cargar gastos")}finally{b(!1)}})()},[]);const Ce=g.useMemo(()=>x.filter(D=>!(t&&D.date<t||r&&D.date>r)),[x,t,r]),De=g.useMemo(()=>{const D=Ce.reduce((ve,Q)=>ve+(Q.amount||0),0),V=Ce.filter(ve=>ve.status==="PAGADO").reduce((ve,Q)=>ve+(Q.amount||0),0),te=D-V;return{total:D,pagado:V,pendiente:te}},[Ce]),O=()=>{s(Kr(new Date,"yyyy-MM-dd")),l(""),d(""),f(0),h("PENDIENTE"),p("")},R=async D=>{if(D.preventDefault(),I(""),!o){I("Selecciona una categora.");return}if(!c.trim()){I("Ingresa una descripcin.");return}if(!u||u<=0){I("Ingresa un monto vlido.");return}try{const V=await ta(xt(Ne,"expenses_clothes"),{date:a,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:A,notes:m||"",createdAt:Nr.now()});v(te=>[{id:V.id,date:a,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:A,notes:m||"",createdAt:Nr.now()},...te]),O(),I(" Gasto registrado")}catch(V){console.error(V),I(" Error al guardar gasto")}},G=D=>{N(D.id),E(D.date),k(D.category||""),P(D.description||""),de(Number(D.amount||0)),le(D.status||"PENDIENTE"),ae(D.notes||"")},M=()=>{N(null),E(""),k(""),P(""),de(0),le("PENDIENTE"),ae("")},K=async()=>{if(j){if(!B){I("Selecciona una categora.");return}if(!T.trim()){I("Ingresa una descripcin.");return}if(!q||q<=0){I("Ingresa un monto vlido.");return}try{await Mn(Kt(Ne,"expenses_clothes",j),{date:S,category:B,description:T.trim(),amount:Number(q.toFixed(2)),status:ce,notes:he||""}),v(D=>D.map(V=>V.id===j?{...V,date:S,category:B,description:T.trim(),amount:Number(q.toFixed(2)),status:ce,notes:he||""}:V)),M(),I(" Gasto actualizado")}catch(D){console.error(D),I(" Error al actualizar gasto")}}},Y=async D=>{confirm(`Eliminar el gasto "${D.description}"?`)&&(await na(Kt(Ne,"expenses_clothes",D.id)),v(te=>te.filter(ve=>ve.id!==D.id)),I(" Gasto borrado"))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Ropa)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:D=>e(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:D=>n(D.target.value)})]}),i.jsxs("div",{className:"ml-auto text-sm",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",u_(De.total)]}),i.jsxs("div",{children:["Pagado: ",u_(De.pagado)]}),i.jsxs("div",{children:["Pendiente: ",u_(De.pendiente)]})]})]}),i.jsxs("form",{onSubmit:R,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:a,onChange:D=>s(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:D=>l(D.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),M$.map(D=>i.jsx("option",{value:D,children:D},D))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:D=>d(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:u===0?"":u,onChange:D=>f(Math.max(0,Number(D.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:A,onChange:D=>h(D.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:D=>p(D.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):Ce.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):Ce.slice().sort((D,V)=>D.date.localeCompare(V.date)).map(D=>{const V=j===D.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:V?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:S,onChange:te=>E(te.target.value)}):D.date}),i.jsx("td",{className:"p-2 border",children:V?i.jsxs("select",{className:"w-full border p-1 rounded",value:B,onChange:te=>k(te.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),M$.map(te=>i.jsx("option",{value:te,children:te},te))]}):D.category||""}),i.jsx("td",{className:"p-2 border",children:V?i.jsx("input",{className:"w-full border p-1 rounded",value:T,onChange:te=>P(te.target.value)}):i.jsx("span",{title:D.description,children:D.description.length>40?D.description.slice(0,40)+"":D.description})}),i.jsx("td",{className:"p-2 border",children:V?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(q)?"":q,onChange:te=>de(Math.max(0,Number(te.target.value||0)))}):u_(D.amount)}),i.jsx("td",{className:"p-2 border",children:V?i.jsxs("select",{className:"w-full border p-1 rounded",value:ce,onChange:te=>le(te.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${D.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:D.status})}),i.jsx("td",{className:"p-2 border",children:V?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:he,onChange:te=>ae(te.target.value),maxLength:500}):i.jsx("span",{title:D.notes||"",children:(D.notes||"").length>40?(D.notes||"").slice(0,40)+"":D.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:V?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:K,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:M,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>G(D),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Y(D),children:"Borrar"})]})})})]},D.id)})})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w})]})}const nf=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function QLe(t){var e;return t!=null&&t.date?t.date:(e=t==null?void 0:t.createdAt)!=null&&e.toDate?Kr(t.createdAt.toDate(),"yyyy-MM-dd"):""}function VLe(t,e){const r=QLe(t);if(!r)return null;const n=t.item||{},a=Number((n==null?void 0:n.qty)??t.quantity??0)||0,s=Number((n==null?void 0:n.total)??t.total??0)||0,o=Number((n==null?void 0:n.unitPrice)??(a>0?s/a:0))||0;return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total||0),quantity:Number(t.quantity||a||0),customerId:t.customerId||void 0,customerName:t.customerName||void 0,downPayment:Number(t.downPayment||0),item:{productId:String((n==null?void 0:n.productId)||t.productId||""),productName:String((n==null?void 0:n.productName)||t.productName||""),sku:(n==null?void 0:n.sku)||t.sku||"",qty:a,unitPrice:o,total:a*o}}}async function HLe(t,e){if(e<=0)return;const r=ar(xt(Ne,"inventory_clothes_batches"),lr("productId","==",t)),n=await Ut(r),a=[];n.forEach(o=>{const l=o.data();a.push({id:o.id,productId:l.productId,date:l.date||"",quantity:Number(l.quantity||0),remaining:Number(l.remaining||0)})}),a.sort((o,l)=>o.date.localeCompare(l.date));let s=e;for(const o of a){if(s<=0)break;if(o.remaining<=0)continue;const l=Math.min(o.remaining,s);s-=l,await Mn(Kt(Ne,"inventory_clothes_batches",o.id),{remaining:Math.max(0,Number((o.remaining-l).toFixed(0)))})}s>0&&console.warn("consumeFIFO: falt inventario",s)}async function $Le(t,e){if(e<=0)return;const r=ar(xt(Ne,"inventory_clothes_batches"),lr("productId","==",t)),n=await Ut(r),a=[];n.forEach(o=>{const l=o.data();a.push({id:o.id,productId:l.productId,date:l.date||"",quantity:Number(l.quantity||0),remaining:Number(l.remaining||0)})}),a.sort((o,l)=>o.date.localeCompare(l.date));let s=e;for(const o of a){if(s<=0)break;const l=Math.max(0,o.quantity-o.remaining);if(l<=0)continue;const c=Math.min(l,s);s-=c,await Mn(Kt(Ne,"inventory_clothes_batches",o.id),{remaining:Number((o.remaining+c).toFixed(0))})}s>0&&console.warn("restoreFIFO: no se devolvi todo",s)}async function kse(t){const e=ar(xt(Ne,"ar_movements"),lr("ref.saleId","==",t)),r=await Ut(e);await Promise.all(r.docs.map(n=>na(Kt(Ne,"ar_movements",n.id))))}async function GLe(t,e,r){if(await kse(t.id),t.type!=="CREDITO"||!t.customerId)return;const n={customerId:t.customerId,date:t.date,createdAt:Nr.now(),ref:{saleId:t.id}},{addDoc:a}=await dA(async()=>{const{addDoc:o}=await Promise.resolve().then(()=>dbe);return{addDoc:o}},void 0);await a(xt(Ne,"ar_movements"),{...n,type:"CARGO",amount:Number(e)||0});const s=Math.max(0,Number(r??t.downPayment??0));s>0&&await a(xt(Ne,"ar_movements"),{...n,type:"ABONO",amount:-s})}function KLe(){const[t,e]=g.useState(!1),[r,n]=g.useState(!1),[a,s]=g.useState(null),[o,l]=g.useState([]),c=async se=>{e(!0),n(!0),s(se),l([]);try{const ke=(await Ut(ar(xt(Ne,"sales_clothes"),lr("__name__","==",se)))).docs[0],Se=ke==null?void 0:ke.data(),Ze=(Array.isArray(Se==null?void 0:Se.items)?Se.items:Se!=null&&Se.item?[Se.item]:[]).map(ot=>({productName:String(ot.productName||""),qty:Number(ot.qty||0),unitPrice:Number(ot.unitPrice||0),discount:Number(ot.discount||0),total:Number(ot.total||0)}));l(Ze)}catch(Z){console.error(Z)}finally{n(!1)}},[d,u]=g.useState(Kr(new Date,"yyyy-MM-01")),[f,A]=g.useState(Kr(new Date,"yyyy-MM-dd")),[h,m]=g.useState([]),[p,x]=g.useState([]),[v,y]=g.useState(!0),[b,w]=g.useState(""),[I,j]=g.useState(""),[N,S]=g.useState(""),[E,B]=g.useState(null),[k,T]=g.useState(!1),[P,q]=g.useState(null),[de,ce]=g.useState(0),le=15,[he,ae]=g.useState(1),Ce=g.useMemo(()=>{const se={};return h.forEach(Z=>se[Z.id]=Z.name),se},[h]);g.useEffect(()=>{(async()=>{y(!0),w("");try{const se=await Ut(xt(Ne,"customers_clothes")),Z=[];se.forEach(Ee=>Z.push({id:Ee.id,name:Ee.data().name||""})),m(Z);const ke=await Ut(ar(xt(Ne,"sales_clothes"),kn("createdAt","desc"))),Se=[];ke.forEach(Ee=>{const Ze=VLe(Ee.data(),Ee.id);Ze&&Ze.date>=d&&Ze.date<=f&&Se.push(Ze)}),x(Se.sort((Ee,Ze)=>Ze.date.localeCompare(Ee.date))),ae(1)}catch(se){console.error(se),w(" Error cargando transacciones.")}finally{y(!1)}})()},[d,f]);const De=g.useMemo(()=>p.filter(se=>!(I&&se.customerId!==I||N&&se.type!==N)),[p,I,N]),O=g.useMemo(()=>{let se=0,Z=0,ke=0,Se=0;for(const Ee of De)Ee.type==="CONTADO"?(se+=Ee.item.qty,ke+=Ee.total):(Z+=Ee.item.qty,Se+=Ee.total);return{piezasCash:se,piezasCredito:Z,montoCash:ke,montoCredito:Se}},[De]),R=Math.max(1,Math.ceil(De.length/le)),G=g.useMemo(()=>{const se=(he-1)*le;return De.slice(se,se+le)},[De,he]),M=se=>{B(null),q(se),ce(se.item.qty||0),T(!0)},K=async se=>{if(B(null),!!window.confirm("Eliminar esta venta? Esta accin no se puede deshacer."))try{y(!0),await pF(se.id),await kse(se.id),x(Z=>Z.filter(ke=>ke.id!==se.id)),w(" Venta eliminada")}catch(Z){console.error(Z),w(" No se pudo eliminar la venta.")}finally{y(!1)}},Y=async()=>{if(!P)return;const se=Number(P.item.qty||0),Z=Math.max(1,Math.floor(Number(de)||0));if(Z===se){T(!1);return}const ke=Number(P.item.unitPrice||0),Se=Number((ke*Z).toFixed(2));try{y(!0);const Ee=Z-se;Ee>0?await HLe(P.item.productId,Ee):Ee<0&&await $Le(P.item.productId,-Ee);const Ze=Kt(Ne,"sales_clothes",P.id);await Mn(Ze,{quantity:Z,total:Se,itemsTotal:Se,"item.qty":Z,"item.total":Se,updatedAt:Nr.now()});const ot=Math.min(Number(P.downPayment||0),Se);await GLe(P,Se,ot),x(vt=>vt.map(_t=>_t.id===P.id?{..._t,quantity:Z,total:Se,item:{..._t.item,qty:Z,total:Se},downPayment:ot}:_t)),w(" Venta actualizada"),T(!1)}catch(Ee){console.error(Ee),w(" No se pudo actualizar la venta.")}finally{y(!1)}},D=()=>{const se=`Reporte de transacciones (Ropa)  ${d} a ${f}`,Z=Ze=>(Ze||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),ke=De.map(Ze=>{const ot=Ze.customerName||(Ze.customerId?Ce[Ze.customerId]:"")||"Nombre cliente";return`<tr>
          <td>${Ze.date}</td>
          <td>${Z(ot)}</td>
          <td>${Ze.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${Ze.item.qty}</td>
          <td style="text-align:right">${nf(Ze.total)}</td>
        </tr>`}).join(""),Se=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${Z(se)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${Z(se)}</h1>
      <div class="kpis">
        <div><b>Piezas Cash:</b> ${O.piezasCash}</div>
        <div><b>Piezas Crdito:</b> ${O.piezasCredito}</div>
        <div><b>Monto Cash:</b> ${nf(O.montoCash)}</div>
        <div><b>Monto Crdito:</b> ${nf(O.montoCredito)}</div>
      </div>
      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Piezas</th><th>Monto</th>
      </tr></thead><tbody>
      ${ke||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,Ee=window.open("","_blank");Ee&&(Ee.document.open(),Ee.document.write(Se),Ee.document.close())},V=()=>ae(1),te=()=>ae(se=>Math.max(1,se-1)),ve=()=>ae(se=>Math.min(R,se+1)),Q=()=>ae(R),Xe=()=>{const se=[];if(R<=7)for(let ke=1;ke<=R;ke++)se.push(ke);else{const ke=Math.max(1,he-2),Se=Math.min(R,he+2);se.push(1),ke>2&&se.push(-1);for(let Ee=ke;Ee<=Se;Ee++)Ee!==1&&Ee!==R&&se.push(Ee);Se<R-1&&se.push(-2),se.push(R)}return i.jsxs("div",{className:"flex items-center gap-1 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:V,disabled:he===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:te,disabled:he===1,children:" Anterior"}),se.map((ke,Se)=>typeof ke=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${ke===he?"bg-blue-600 text-white":""}`,onClick:()=>ae(ke),children:ke},Se):i.jsx("span",{className:"px-2",children:""},Se)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:ve,disabled:he===R,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Q,disabled:he===R,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",he," de ",R,"  ",De.length," transaccin(es)"]})]})};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Reporte de transacciones (Ropa)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:se=>{u(se.target.value),ae(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:f,onChange:se=>{A(se.target.value),ae(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 min-w-[220px]",value:I,onChange:se=>{j(se.target.value),ae(1)},children:[i.jsx("option",{value:"",children:"Todos"}),h.map(se=>i.jsx("option",{value:se.id,children:se.name},se.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:N,onChange:se=>{S(se.target.value),ae(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsx("button",{className:"ml-auto px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:D,children:"Exportar PDF"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Piezas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:O.piezasCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Piezas Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:O.piezasCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:nf(O.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:nf(O.montoCredito)})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Piezas"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:v?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Cargando"})}):G.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Sin transacciones en el rango."})}):G.map(se=>{const Z=se.customerName||(se.customerId?Ce[se.customerId]:"")||"Nombre cliente";return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:se.date}),i.jsx("td",{className:"p-2 border",children:Z}),i.jsx("td",{className:"p-2 border",children:se.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver piezas de esta transaccin",onClick:()=>c(se.id),children:se.item.qty})}),i.jsx("td",{className:"p-2 border",children:nf(se.total)}),i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>B(ke=>ke===se.id?null:se.id),title:"Acciones",children:""}),E===se.id&&i.jsxs("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:[i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>M(se),children:"Editar"}),i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>K(se),children:"Eliminar"})]})]})]},se.id)})})]}),Xe()]}),b&&i.jsx("p",{className:"mt-2 text-sm",children:b}),k&&P&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-md p-4",children:[i.jsx("h3",{className:"text-lg font-bold mb-2",children:"Editar venta"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Producto"}),i.jsxs("div",{className:"font-semibold",children:[P.item.productName," ",P.item.sku?` ${P.item.sku}`:""]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad (piezas)"}),i.jsx("input",{type:"number",step:"1",min:1,className:"w-full border p-2 rounded",value:de,onChange:se=>ce(Math.max(1,Math.floor(Number(se.target.value||0))))})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"P. Unit"}),i.jsx("div",{className:"text-lg font-semibold",children:nf(P.item.unitPrice)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Nuevo total"}),i.jsx("div",{className:"text-lg font-semibold",children:nf(Number(P.item.unitPrice)*Number(de||0))})]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{T(!1),q(null)},children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:Y,children:"Guardar cambios"})]})]})}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Piezas vendidas"," ",a?` #${a}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>e(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):o.map((se,Z)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:se.productName}),i.jsx("td",{className:"p-2 border text-right",children:se.qty}),i.jsx("td",{className:"p-2 border text-right",children:nf(se.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:nf(se.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:nf(se.total)})]},Z))})]})})]})})]})}const L$=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],Zc=t=>`C$ ${(Number(t)||0).toFixed(2)}`,b0=t=>Math.round((Number(t)||0)*100)/100,qLe=new Set(["PAGADA","PAGADO","CERRADA","CERRADO","LIQUIDADA","LIQUIDADO"]),Ey=t=>{const e=String(t||"").trim().toUpperCase();return qLe.has(e)?"PAGADA":"PENDIENTE"};function f_(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function U$(t){const e=ar(xt(Ne,"ar_movements_pollo"),lr("ref.saleId","==",t)),r=await Ut(e);await Promise.all(r.docs.map(n=>na(Kt(Ne,"ar_movements_pollo",n.id))))}function zLe({role:t="",roles:e,sellerPolloId:r="",currentUserEmail:n}){const a=e&&e.length?e:t,s=String(r||"").trim(),o=Rn(a,"vendedor_pollo"),l=Rn(a,"admin"),[c,d]=g.useState([]),[u,f]=g.useState(!1),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,I]=g.useState(!1),[j,N]=g.useState(!1),[S,E]=g.useState(null),[B,k]=g.useState([]),T=async Nt=>{var nr;I(!0),N(!0),E(Nt),k([]);try{const $t=await Es(Kt(Ne,"salesV2",Nt));let Mt=null;if($t.exists()?Mt=$t.data():Mt=(nr=(await Ut(ar(xt(Ne,"salesV2"),lr("name","==",Nt)))).docs[0])==null?void 0:nr.data(),!Mt){k([]);return}let Be=[];if(Array.isArray(Mt.items)&&Mt.items.length>0)Be=Mt.items;else if(Mt.items&&typeof Mt.items=="object")try{Be=Object.values(Mt.items)}catch{Be=[]}else Mt.item?Be=[Mt.item]:Array.isArray(Mt.products)&&Mt.products.length>0?Be=Mt.products:Array.isArray(Mt.lines)&&Mt.lines.length>0?Be=Mt.lines:Array.isArray(Mt.detalles)&&Mt.detalles.length>0?Be=Mt.detalles:(Mt.productName||Mt.product)&&(Be=[{productName:Mt.productName||Mt.product||"",qty:Mt.qty??Mt.quantity??Mt.lbs??0,unitPrice:Mt.unitPrice??Mt.price??0,discount:Mt.discount??0,total:Mt.total??Mt.amount??0}]);const It=rr=>{if(rr==null)return NaN;if(typeof rr=="number")return rr;let dr=String(rr).trim();if(!dr)return NaN;if(dr=dr.replace(/[^0-9.,-]/g,""),!dr)return NaN;dr.indexOf(".")>-1&&dr.indexOf(",")>-1?dr=dr.replace(/,/g,""):dr.indexOf(",")>-1&&dr.indexOf(".")===-1&&(dr=dr.replace(/,/g,"."));const we=Number(dr);return Number.isNaN(we)?NaN:we},Vt=new Set;for(const rr of Be)if(Array.isArray(rr==null?void 0:rr.allocations))for(const dr of rr.allocations){const we=String((dr==null?void 0:dr.batchId)||"").trim();we&&Vt.add(we)}else if(rr!=null&&rr.allocations&&typeof rr.allocations=="object")try{for(const dr of Object.values(rr.allocations)){const we=String((dr==null?void 0:dr.batchId)||"").trim();we&&Vt.add(we)}}catch{}if(Array.isArray(Mt==null?void 0:Mt.allocations))for(const rr of Mt.allocations){const dr=String((rr==null?void 0:rr.batchId)||"").trim();dr&&Vt.add(dr)}const Ot={};Vt.size>0&&await Promise.all(Array.from(Vt).map(async rr=>{try{const dr=await Es(Kt(Ne,"inventory_batches",rr));if(dr.exists()){const we=dr.data();Ot[rr]=Number(we.salePrice??we.sale_price??we.price??0)}}catch{}}));const qt=new Set;for(const rr of Be){const dr=String(rr.productId||"").trim();dr&&qt.add(dr)}const sr={};qt.size>0&&await Promise.all(Array.from(qt).map(async rr=>{try{const dr=await Es(Kt(Ne,"products",rr));if(dr.exists()){const we=dr.data();sr[rr]=Number(we.salePrice??we.price??0)}}catch{}}));const vr=Be.map(rr=>{const dr=String(rr.productName||rr.product||rr.name||"(sin nombre)"),we=Number(rr.qty??rr.quantity??rr.lbs??rr.weight??0)||0,ft=It(rr.total??rr.lineFinal??rr.amount??rr.monto??rr.line_total)||0;let St=0;const Ct=[rr.unitPrice,rr.unitPricePackage,rr.salePrice,rr.sale_price,rr.price,rr.unit_price,rr.pricePerUnit,rr.price_per_unit];for(const Hr of Ct){const br=It(Hr);if(!Number.isNaN(br)&&br!==0){St=br;break}}if(!St){const Hr=(Mt==null?void 0:Mt.salePrice)??(Mt==null?void 0:Mt.sale_price)??(Mt==null?void 0:Mt.unitPrice)??(Mt==null?void 0:Mt.unit_price)??(Mt==null?void 0:Mt.price)??(Mt==null?void 0:Mt.pricePerUnit),br=It(Hr);!Number.isNaN(br)&&br!==0&&(St=br)}if(!St){const Hr=Array.isArray(rr.allocations)?rr.allocations[0]:rr.allocations&&typeof rr.allocations=="object"?Object.values(rr.allocations)[0]:null,br=Hr?String(Hr.batchId||"").trim():"";br&&Ot[br]&&(St=Ot[br]||0)}!St&&rr.productId&&(St=sr[String(rr.productId)]||0),(!St||St===0)&&ft>0&&we>0&&(St=ft/we);const fr=It(rr.discount??rr.desc??0)||0;let or=ft;return(!or||or===0)&&(or=Number(St*we||0)),or=Number(or)||0,{productName:dr,qty:we,unitPrice:St,discount:fr,total:or}});k(vr)}catch($t){console.error($t)}finally{N(!1)}},[P,q]=g.useState(""),[de,ce]=g.useState("+505 "),[le,he]=g.useState(""),[ae,Ce]=g.useState(""),[De,O]=g.useState("ACTIVO"),[R,G]=g.useState(0),[M,K]=g.useState(""),[Y,D]=g.useState(0),[V,te]=g.useState([]),[ve,Q]=g.useState(!0),[Xe,se]=g.useState(""),[Z,ke]=g.useState(null),[Se,Ee]=g.useState(""),[Ze,ot]=g.useState("+505 "),[vt,_t]=g.useState(""),[Tt,Lt]=g.useState(""),[Rt,Et]=g.useState("ACTIVO"),[Re,Te]=g.useState(0),[Ye,dt]=g.useState(""),[Fe,je]=g.useState(!1),[We,ee]=g.useState(null),[Ve,rt]=g.useState(!1),[$e,ie]=g.useState([]),[pe,fe]=g.useState({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),[Me,me]=g.useState(!1),[ye,mt]=g.useState(0),[gt,yt]=g.useState(new Date().toISOString().slice(0,10)),[Pt,Ft]=g.useState(""),[Oe,be]=g.useState(!1),[Ae,Le]=g.useState(null),[ut,ct]=g.useState(""),[st,z]=g.useState(0),[X,re]=g.useState(""),[H,L]=g.useState(null),[ue,Pe]=g.useState(!1),[xe,Ge]=g.useState(null),[ze,Ke]=g.useState(!1),[pt,ne]=g.useState(!1),[Ue,tt]=g.useState(null);g.useEffect(()=>{(async()=>{try{if(Q(!0),o&&!s){te([]),se(" Este usuario no tiene vendedor asociado (sellerPolloId vaco).");return}const Nt=await Ut(xt(Ne,"sellers_candies")),nr=[];Nt.forEach(It=>{const Vt=It.data();nr.push({id:It.id,name:String(Vt.name||"")})}),d(nr);const $t=o?ar(xt(Ne,"customers_pollo"),lr("vendorId","==",s),kn("createdAt","desc")):ar(xt(Ne,"customers_pollo"),kn("createdAt","desc")),Mt=await Ut($t),Be=[];Mt.forEach(It=>{const Vt=It.data();Be.push({id:It.id,name:Vt.name??"",phone:Vt.phone??"+505 ",place:Vt.place??"",notes:Vt.notes??"",status:Vt.status??"ACTIVO",creditLimit:Number(Vt.creditLimit??0),createdAt:Vt.createdAt??Nr.now(),balance:0,vendorId:Vt.vendorId||"",vendorName:Vt.vendorName||"",initialDebt:Number(Vt.initialDebt||0),lastAbonoDate:"",lastAbonoAmount:0})});for(const It of Be)try{const Vt=ar(xt(Ne,"ar_movements_pollo"),lr("customerId","==",It.id)),Ot=await Ut(Vt);let qt=0,sr=null,vr=!1;Ot.forEach(ft=>{var fr,or,Hr;const St=ft.data(),Ct=Number(St.amount||0);if(qt+=Ct,Ct>0&&Ey(St.debtStatus??St.creditStatus??St.cycleStatus??St.status)==="PENDIENTE"&&(vr=!0),Ct<0){const br=St.date??((or=(fr=St.createdAt)==null?void 0:fr.toDate)!=null&&or.call(fr)?St.createdAt.toDate().toISOString().slice(0,10):""),hr=(Hr=St.createdAt)!=null&&Hr.seconds?Number(St.createdAt.seconds):0;(!sr||hr>=sr.ts)&&(sr={date:br,amount:Math.abs(Ct),ts:hr})}});const rr=Number(It.initialDebt||0),dr=b0(rr+qt);It.balance=dr,(vr||dr>0)&&sr?(It.lastAbonoDate=sr.date,It.lastAbonoAmount=sr.amount):(It.lastAbonoDate="",It.lastAbonoAmount=0)}catch{It.balance=Number(It.initialDebt||0),It.lastAbonoDate="",It.lastAbonoAmount=0}te(Be)}catch(Nt){console.error(Nt),se(" Error cargando clientes.")}finally{Q(!1)}})()},[o,s]);const nt=()=>{q(""),ce("+505 "),he(""),Ce(""),O("ACTIVO"),G(0),K(""),D(0)},wt=async Nt=>{var Be;if(Nt.preventDefault(),se(""),!P.trim()){se("Ingresa el nombre.");return}const nr=f_(de);if(nr.length<6){se("Telfono incompleto.");return}const $t=o?s:String(M||""),Mt=$t&&((Be=c.find(It=>It.id===$t))==null?void 0:Be.name)||"";try{const It=Number(Y||0),Vt=await ta(xt(Ne,"customers_pollo"),{name:P.trim(),phone:nr,place:le||"",notes:ae||"",status:De,creditLimit:Number(R||0),vendorId:$t,vendorName:Mt,initialDebt:It,createdAt:Nr.now()});te(Ot=>[{id:Vt.id,name:P.trim(),phone:nr,place:le||"",notes:ae||"",status:De,creditLimit:Number(R||0),vendorId:$t,vendorName:Mt,initialDebt:It,createdAt:Nr.now(),balance:It,lastAbonoDate:"",lastAbonoAmount:0},...Ot]),nt(),Pe(!1),se(" Cliente creado")}catch(It){console.error(It),se(" Error al crear cliente")}},Bt=Nt=>{if(o){se(" No permitido: vendedores no editan clientes desde el listado.");return}ke(Nt.id),Ee(Nt.name),ot(Nt.phone||"+505 "),_t(Nt.place||""),Lt(Nt.notes||""),Et(Nt.status||"ACTIVO"),Te(Number(Nt.creditLimit||0)),dt(String(Nt.vendorId||""))},tr=()=>{ke(null),Ee(""),ot("+505 "),_t(""),Lt(""),Et("ACTIVO"),Te(0),dt("")},Or=async()=>{var Vt;if(o){se(" No permitido.");return}if(!Z)return;const Nt=f_(Ze);if(!Se.trim()){se("Ingresa el nombre.");return}const nr=V.find(Ot=>Ot.id===Z),$t=String((nr==null?void 0:nr.vendorId)||""),Mt=o?s:String(Ye||"");if(o&&$t&&$t!==s){se(" Este cliente pertenece a otro vendedor.");return}if(l&&$t&&Mt&&$t!==Mt){se(" Este cliente ya est asociado a otro vendedor. Primero desasocia (deja vendedor en ) y guarda; luego lo puedes asignar.");return}const Be=o?s:String(Ye||""),It=Be&&((Vt=c.find(Ot=>Ot.id===Be))==null?void 0:Vt.name)||"";try{await Mn(Kt(Ne,"customers_pollo",Z),{name:Se.trim(),phone:Nt,place:vt||"",notes:Tt||"",status:Rt,creditLimit:Number(Re||0),vendorId:Be,vendorName:It}),te(Ot=>Ot.map(qt=>qt.id===Z?{...qt,name:Se.trim(),phone:Nt,place:vt||"",notes:Tt||"",status:Rt,creditLimit:Number(Re||0),vendorId:Be,vendorName:It}:qt)),tr(),se(" Cliente actualizado")}catch(Ot){console.error(Ot),se(" Error al actualizar")}},zr=async Nt=>{if(confirm(`Eliminar al cliente "${Nt.name}"?
Se borrarn todas sus ventas y movimientos.`))try{Q(!0);const $t=ar(xt(Ne,"salesV2"),lr("customerId","==",Nt.id)),Mt=await Ut($t);for(const Vt of Mt.docs){const Ot=Vt.id;try{await na(Kt(Ne,"salesV2",Ot))}catch(qt){console.warn("delete sale error",qt)}await U$(Ot)}const Be=ar(xt(Ne,"ar_movements_pollo"),lr("customerId","==",Nt.id)),It=await Ut(Be);await Promise.all(It.docs.map(Vt=>na(Kt(Ne,"ar_movements_pollo",Vt.id)))),await na(Kt(Ne,"customers_pollo",Nt.id)),te(Vt=>Vt.filter(Ot=>Ot.id!==Nt.id)),se(" Cliente eliminado y registros borrados")}catch($t){console.error($t),se(" No se pudo eliminar el cliente.")}finally{Q(!1)}},ur=(Nt,nr)=>{const $t=Nt.reduce((Vt,Ot)=>Vt+(Number(Ot.amount)||0),0),Mt=Nt.filter(Vt=>Number(Vt.amount)<0).reduce((Vt,Ot)=>Vt+Math.abs(Number(Ot.amount)||0),0),Be=Nt.filter(Vt=>Number(Vt.amount)>0).reduce((Vt,Ot)=>Vt+(Number(Ot.amount)||0),0),It=Number(nr||0)+$t;fe({saldoActual:It,totalAbonado:Mt,totalCargos:Number(nr||0)+Be,saldoRestante:It})},Dr=async Nt=>{ee(Nt),ie([]),fe({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),je(!0),Ke(!1),ne(!1),tt(null),me(!1),mt(0),yt(new Date().toISOString().slice(0,10)),Ft(""),Le(null),rt(!0);try{const nr=ar(xt(Ne,"ar_movements_pollo"),lr("customerId","==",Nt.id)),$t=await Ut(nr),Mt=[];$t.forEach(Be=>{var qt,sr;const It=Be.data(),Vt=It.date??((sr=(qt=It.createdAt)==null?void 0:qt.toDate)!=null&&sr.call(qt)?It.createdAt.toDate().toISOString().slice(0,10):""),Ot=Number(It.amount||0);Mt.push({id:Be.id,date:Vt,type:It.type??(Ot<0?"ABONO":"CARGO"),amount:Ot,ref:It.ref||{},comment:It.comment||"",createdAt:It.createdAt,debtStatus:Ey(It.debtStatus??It.creditStatus??It.cycleStatus??It.status)})}),Mt.sort((Be,It)=>{var qt,sr;if(Be.date!==It.date)return Be.date.localeCompare(It.date);const Vt=((qt=Be.createdAt)==null?void 0:qt.seconds)||0,Ot=((sr=It.createdAt)==null?void 0:sr.seconds)||0;return Vt-Ot}),ie(Mt),ur(Mt,Number(Nt.initialDebt||0))}catch(nr){console.error(nr),se(" No se pudo cargar el estado de cuenta")}finally{rt(!1)}},dn=(Nt,nr)=>b0(nr||0)>0?!0:Nt.some($t=>$t.type==="CARGO"&&Ey($t.debtStatus)==="PENDIENTE"),mn=Nt=>{const nr=Nt.filter($t=>Number($t.amount)<0).map($t=>{var Mt;return{date:$t.date,amount:Math.abs(Number($t.amount||0)),ts:((Mt=$t.createdAt)==null?void 0:Mt.seconds)||0}}).sort(($t,Mt)=>($t.ts||0)-(Mt.ts||0));return nr.length?nr[nr.length-1]:null},kr=async()=>{if(!We)return;se("");const Nt=Number(ye||0);if(!(Nt>0)){se("Ingresa un monto de abono mayor a 0.");return}const nr=parseFloat(Nt.toFixed(2));if(!gt){se("Selecciona la fecha del abono.");return}try{be(!0);const $t={customerId:We.id,type:"ABONO",amount:-nr,date:gt,comment:Pt||"",createdAt:Nr.now()},Be={id:(await ta(xt(Ne,"ar_movements_pollo"),$t)).id,date:gt,type:"ABONO",amount:-nr,comment:Pt||"",createdAt:Nr.now()},It=[...$e,Be].sort((sr,vr)=>{var we,ft;if(sr.date!==vr.date)return sr.date.localeCompare(vr.date);const rr=((we=sr.createdAt)==null?void 0:we.seconds)||0,dr=((ft=vr.createdAt)==null?void 0:ft.seconds)||0;return rr-dr});ie(It),ur(It,Number(We.initialDebt||0));const Vt=It.reduce((sr,vr)=>sr+(Number(vr.amount)||0),0),Ot=b0(Number(We.initialDebt||0)+Vt),qt=dn(It,Ot);te(sr=>sr.map(vr=>{if(vr.id!==We.id)return vr;const rr=b0((vr.balance||0)-nr);return{...vr,balance:rr,lastAbonoDate:qt?gt:"",lastAbonoAmount:qt?nr:0}})),ee(sr=>sr&&{...sr,balance:b0((sr.balance||0)-nr),lastAbonoDate:qt?gt:"",lastAbonoAmount:qt?nr:0}),mt(0),Ft(""),yt(new Date().toISOString().slice(0,10)),me(!1),se(" Abono registrado")}catch($t){console.error($t),se(" Error al registrar el abono")}finally{be(!1)}},Qe=Nt=>{Le(Nt.id),ct(Nt.date||new Date().toISOString().slice(0,10)),z(Math.abs(Number(Nt.amount||0))),re(Nt.comment||"")},jt=()=>{Le(null),ct(""),z(0),re("")},wr=async()=>{if(!Ae||!We)return;const Nt=$e.findIndex(Be=>Be.id===Ae);if(Nt===-1)return;const nr=$e[Nt],$t=Number(st||0);if(!($t>0)){se("El monto debe ser mayor a 0.");return}const Mt=nr.type==="ABONO"?-parseFloat($t.toFixed(2)):+parseFloat($t.toFixed(2));try{await Mn(Kt(Ne,"ar_movements_pollo",Ae),{date:ut,amount:Mt,comment:X||""});const Be=[...$e];Be[Nt]={...nr,date:ut,amount:Mt,comment:X||""},Be.sort((sr,vr)=>{var we,ft;if(sr.date!==vr.date)return sr.date.localeCompare(vr.date);const rr=((we=sr.createdAt)==null?void 0:we.seconds)||0,dr=((ft=vr.createdAt)==null?void 0:ft.seconds)||0;return rr-dr}),ie(Be),ur(Be,Number(We.initialDebt||0));const It=Be.reduce((sr,vr)=>sr+(Number(vr.amount)||0),0),Vt=b0(Number(We.initialDebt||0)+It),Ot=dn(Be,Vt),qt=Ot?mn(Be):null;te(sr=>sr.map(vr=>vr.id===We.id?{...vr,balance:Vt,lastAbonoDate:Ot&&qt?qt.date:"",lastAbonoAmount:Ot&&qt?qt.amount:0}:vr)),ee(sr=>sr&&{...sr,balance:Vt,lastAbonoDate:Ot&&qt?qt.date:"",lastAbonoAmount:Ot&&qt?qt.amount:0}),jt(),se(" Movimiento actualizado")}catch(Be){console.error(Be),se(" Error al actualizar movimiento")}},ln=async Nt=>{var $t,Mt;if(confirm(`Eliminar este movimiento (${Nt.type==="ABONO"?"Abono":"Compra"}) del ${Nt.date}?${Nt.type==="CARGO"&&(($t=Nt.ref)!=null&&$t.saleId)?`
Se borrarn los registros de esa venta.`:""}`)&&We)try{if(Q(!0),Nt.type==="CARGO"&&((Mt=Nt.ref)!=null&&Mt.saleId)){try{await na(Kt(Ne,"salesV2",Nt.ref.saleId))}catch(sr){console.warn("delete sale error",sr),Q(!1),se(" No se pudo borrar la venta asociada.");return}await U$(Nt.ref.saleId)}else await na(Kt(Ne,"ar_movements_pollo",Nt.id));const Be=$e.filter(sr=>{var vr,rr;return Nt.type==="CARGO"&&((vr=Nt.ref)!=null&&vr.saleId)?((rr=sr.ref)==null?void 0:rr.saleId)!==Nt.ref.saleId:sr.id!==Nt.id});ie(Be),ur(Be,Number(We.initialDebt||0));const It=Be.reduce((sr,vr)=>sr+(Number(vr.amount)||0),0),Vt=b0(Number(We.initialDebt||0)+It),Ot=dn(Be,Vt),qt=Ot?mn(Be):null;te(sr=>sr.map(vr=>vr.id===We.id?{...vr,balance:Vt,lastAbonoDate:Ot&&qt?qt.date:"",lastAbonoAmount:Ot&&qt?qt.amount:0}:vr)),ee(sr=>sr&&{...sr,balance:Vt,lastAbonoDate:Ot&&qt?qt.date:"",lastAbonoAmount:Ot&&qt?qt.amount:0}),tt(null),se(" Movimiento eliminado")}catch(Be){console.error(Be),se(" Error al eliminar movimiento")}finally{Q(!1)}},cn=async Nt=>{if(Nt.type!=="CARGO")return;const nr=Ey(Nt.debtStatus)==="PAGADA"?"PENDIENTE":"PAGADA";try{L(Nt.id),await Mn(Kt(Ne,"ar_movements_pollo",Nt.id),{debtStatus:nr});const $t=$e.map(Mt=>Mt.id===Nt.id?{...Mt,debtStatus:nr}:Mt);if(ie($t),We){ur($t,Number(We.initialDebt||0));const Mt=$t.reduce((Ot,qt)=>Ot+(Number(qt.amount)||0),0),Be=b0(Number(We.initialDebt||0)+Mt),It=dn($t,Be),Vt=It?mn($t):null;te(Ot=>Ot.map(qt=>qt.id===We.id?{...qt,balance:Be,lastAbonoDate:It&&Vt?Vt.date:"",lastAbonoAmount:It&&Vt?Vt.amount:0}:qt)),ee(Ot=>Ot&&{...Ot,balance:Be,lastAbonoDate:It&&Vt?Vt.date:"",lastAbonoAmount:It&&Vt?Vt.amount:0})}se(nr==="PAGADA"?" Compra marcada como pagada":" Compra marcada como pendiente")}catch($t){console.error($t),se(" No se pudo actualizar el estado de la compra")}finally{L(null)}},_r=g.useMemo(()=>[...V].sort((Nt,nr)=>{var $t,Mt;return Nt.status!==nr.status?Nt.status==="BLOQUEADO"?1:-1:((($t=nr.createdAt)==null?void 0:$t.seconds)||0)-(((Mt=Nt.createdAt)==null?void 0:Mt.seconds)||0)}),[V]),Jt=Nt=>Nt==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700",ir=g.useMemo(()=>{const Nt=A.trim().toLowerCase(),nr=x.trim()===""?null:Number(x),$t=y.trim()===""?null:Number(y);return _r.filter(Mt=>{const Be=!Nt||String(Mt.name||"").toLowerCase().includes(Nt),It=!m||Mt.status===m,Vt=Number(Mt.balance||0),Ot=nr===null||!Number.isNaN(nr)&&Vt>=nr,qt=$t===null||!Number.isNaN($t)&&Vt<=$t;return Be&&It&&Ot&&qt})},[_r,A,m,x,y]),Fr=g.useMemo(()=>ir.reduce((Nt,nr)=>Nt+Number(nr.balance||0),0),[ir]),Er=g.useMemo(()=>ir.filter(Nt=>Nt.status==="ACTIVO").length,[ir]),Lr=ir.length,Ln=()=>{h(""),p(""),v(""),b("")};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Pollo)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>{Pe(!0),o&&K(s)},type:"button",children:"Crear Cliente"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[i.jsxs("div",{className:"p-4 border rounded-lg bg-white shadow-sm",children:[i.jsx("div",{className:"text-xs uppercase tracking-wide text-gray-600",children:"Saldo pendiente"}),i.jsx("div",{className:"text-2xl font-semibold",children:Zc(Fr)}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Calculado sobre los clientes filtrados"})]}),i.jsxs("div",{className:"p-4 border rounded-lg bg-white shadow-sm",children:[i.jsx("div",{className:"text-xs uppercase tracking-wide text-gray-600",children:"Clientes activos"}),i.jsx("div",{className:"text-2xl font-semibold",children:Er}),i.jsxs("p",{className:"text-[11px] text-gray-500 mt-1",children:["De un total de ",Lr]})]})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm p-4 mb-4",children:[i.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-end",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Filtrar cliente"}),i.jsx("input",{className:"w-full border rounded px-3 py-2",placeholder:"Nombre, telfono o nota",value:A,onChange:Nt=>h(Nt.target.value)})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded border bg-gray-50 hover:bg-gray-100",onClick:()=>f(Nt=>!Nt),children:u?"Ocultar filtros":"Ms filtros"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded border bg-white hover:bg-gray-50",onClick:Ln,children:"Limpiar"})]})]}),u&&i.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border rounded px-3 py-2",value:m,onChange:Nt=>p(Nt.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"ACTIVO",children:"Activo"}),i.jsx("option",{value:"BLOQUEADO",children:"Bloqueado"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Saldo mnimo"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-3 py-2",value:x,onChange:Nt=>v(Nt.target.value),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Saldo mximo"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-3 py-2",value:y,onChange:Nt=>b(Nt.target.value),placeholder:"0.00"})]})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:ve?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Cargando"})}):ir.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Sin clientes"})}):ir.map(Nt=>{var $t;const nr=Z===Nt.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:($t=Nt.createdAt)!=null&&$t.toDate?Nt.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border text-left",children:nr?i.jsx("input",{className:"w-full border p-1 rounded",value:Se,onChange:Mt=>Ee(Mt.target.value)}):i.jsx("div",{className:"font-medium",children:Nt.name})}),i.jsx("td",{className:"p-2 border",children:nr?i.jsx("input",{className:"w-full border p-1 rounded",value:Ze,onChange:Mt=>ot(f_(Mt.target.value))}):Nt.phone}),i.jsx("td",{className:"p-2 border",children:nr?i.jsxs("select",{className:"w-full border p-1 rounded text-xs",value:o?s:Ye,onChange:Mt=>dt(Mt.target.value),disabled:o,title:"Vendedor asociado",children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(Mt=>i.jsx("option",{value:Mt.id,children:Mt.name},Mt.id))]}):Nt.vendorName||""}),i.jsx("td",{className:"p-2 border",children:nr?i.jsxs("select",{className:"w-full border p-1 rounded",value:vt,onChange:Mt=>_t(Mt.target.value),children:[i.jsx("option",{value:"",children:""}),L$.map(Mt=>i.jsx("option",{value:Mt,children:Mt},Mt))]}):Nt.place||""}),i.jsx("td",{className:"p-2 border",children:nr?i.jsxs("select",{className:"w-full border p-1 rounded",value:Rt,onChange:Mt=>Et(Mt.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Jt(Nt.status)}`,children:Nt.status})}),i.jsx("td",{className:"p-2 border",children:nr?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Re)?"":Re,onChange:Mt=>Te(Math.max(0,Number(Mt.target.value||0)))}):Zc(Nt.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:Zc(Nt.balance||0)}),i.jsx("td",{className:"p-2 border",children:nr?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:Tt,onChange:Mt=>Lt(Mt.target.value),maxLength:500}):i.jsx("span",{title:Nt.notes||"",children:(Nt.notes||"").length>40?(Nt.notes||"").slice(0,40)+"":Nt.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:nr?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Or,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:tr,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Bt(Nt),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>zr(Nt),disabled:!l,title:l?"Borrar":"Solo admin",children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>Dr(Nt),children:"Estado de cuenta"})]})})})]},Nt.id)})})]})}),i.jsx("div",{className:"md:hidden space-y-2",children:ve?i.jsx("div",{className:"p-4 text-center text-sm text-gray-600",children:"Cargando"}):ir.length===0?i.jsx("div",{className:"p-4 text-center text-sm text-gray-600",children:"Sin clientes"}):ir.map(Nt=>i.jsxs("div",{className:"border rounded-lg bg-white p-3 shadow-sm",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-base",children:Nt.name}),i.jsx("div",{className:"text-xs text-gray-600",children:Nt.phone||""}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Vendedor:"," ",i.jsx("span",{className:"font-medium",children:Nt.vendorName||""})]})]}),i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Jt(Nt.status)}`,children:Nt.status})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"border rounded p-2 bg-gray-50",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Saldo"}),i.jsx("div",{className:"font-semibold",children:Zc(Nt.balance||0)})]}),i.jsxs("div",{className:"border rounded p-2 bg-gray-50",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Lmite"}),i.jsx("div",{className:"font-semibold",children:Zc(Nt.creditLimit||0)})]})]}),i.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["ltimo abono:"," ",i.jsx("span",{className:"font-medium",children:Nt.lastAbonoDate?`${Nt.lastAbonoDate} (${Zc(Nt.lastAbonoAmount||0)})`:""})]}),Nt.notes?i.jsxs("div",{className:"mt-2 text-xs text-gray-700",children:[i.jsx("span",{className:"font-semibold",children:"Nota:"})," ",(Nt.notes||"").length>80?(Nt.notes||"").slice(0,80)+"":Nt.notes]}):null,i.jsxs("div",{className:"mt-3 flex gap-2 flex-wrap",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-indigo-600 text-white text-sm",onClick:()=>Dr(Nt),children:"Estado de cuenta"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-yellow-600 text-white text-sm",onClick:()=>Bt(Nt),disabled:o,title:o?"Vendedor no edita":"Editar",children:"Editar"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-red-600 text-white text-sm disabled:opacity-50",onClick:()=>zr(Nt),disabled:!l,title:l?"Borrar":"Solo admin",children:"Borrar"})]})]},Nt.id))})]}),Xe&&i.jsx("p",{className:"mt-2 text-sm",children:Xe}),ue&&$d.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Pe(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Pe(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:wt,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:P,onChange:Nt=>q(Nt.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:de,onChange:Nt=>ce(f_(Nt.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:le,onChange:Nt=>he(Nt.target.value),children:[i.jsx("option",{value:"",children:""}),L$.map(Nt=>i.jsx("option",{value:Nt,children:Nt},Nt))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:De,onChange:Nt=>O(Nt.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor asociado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o?s:M,onChange:Nt=>K(Nt.target.value),disabled:o,children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(Nt=>i.jsx("option",{value:Nt.id,children:Nt.name},Nt.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Deuda inicial"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Y===0?"":Y,onChange:Nt=>D(Math.max(0,Number(Nt.target.value||0))),placeholder:"Ej: 1500"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este valor cuenta como saldo desde el inicio."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:R===0?"":R,onChange:Nt=>G(Math.max(0,Number(Nt.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:ae,onChange:Nt=>Ce(Nt.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[ae.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Pe(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),Fe&&$d.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[50]",style:{zIndex:50},children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>je(!1)}),i.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-full max-w-5xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 gap-3",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(We==null?void 0:We.name)||""]}),i.jsxs("div",{className:"flex gap-2 shrink-0",children:[i.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{mt(0),yt(new Date().toISOString().slice(0,10)),Ft(""),me(!0)},children:"Abonar"}),i.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>je(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Deuda inicial"}),i.jsx("div",{className:"text-xl font-semibold",children:Zc(Number((We==null?void 0:We.initialDebt)||0))})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:Zc(pe.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:Zc(pe.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:Zc(pe.saldoRestante)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Estado compra"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:Ve?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):$e.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):$e.map(Nt=>{var Mt;const nr=Ae===Nt.id,$t=Ey(Nt.debtStatus);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:nr?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:ut,onChange:Be=>ct(Be.target.value)}):Nt.date||""}),i.jsx("td",{className:"p-2 border",children:Nt.amount>=0?(Mt=Nt.ref)!=null&&Mt.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",onClick:()=>T(Nt.ref.saleId),children:"COMPRA (Ver detalle)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (Ver detalle)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:Nt.type==="CARGO"?i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${$t==="PAGADA"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:$t==="PAGADA"?"Pagada":"Pendiente"}):""}),i.jsx("td",{className:"p-2 border",children:nr?i.jsx("input",{className:"w-full border p-1 rounded",value:X,onChange:Be=>re(Be.target.value)}):i.jsx("span",{title:Nt.comment||"",children:(Nt.comment||"").length>40?(Nt.comment||"").slice(0,40)+"":Nt.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:nr?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(st)?"":st,onChange:Be=>z(Number(Be.target.value||0))}):Zc(Nt.amount)}),i.jsx("td",{className:"p-2 border",children:nr?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:wr,children:"Guardar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:jt,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Qe(Nt),children:"Editar"}),Nt.type==="CARGO"&&i.jsx("button",{type:"button",className:`px-2 py-1 rounded text-white ${$t==="PAGADA"?"bg-gray-600 hover:bg-gray-700":"bg-emerald-600 hover:bg-emerald-700"} disabled:opacity-50`,onClick:()=>cn(Nt),disabled:H===Nt.id,children:$t==="PAGADA"?"Marcar pendiente":"Marcar pagada"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>ln(Nt),children:"Borrar"})]})})]},Nt.id)})})]})})]})}),w&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",style:{zIndex:60},children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Productos vendidos"," "]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>I(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:j?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):B.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):B.map((Nt,nr)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:Nt.productName}),i.jsx("td",{className:"p-2 border text-right",children:Nt.qty}),i.jsx("td",{className:"p-2 border text-right",children:Zc(Nt.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Zc(Nt.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Zc(Nt.total)})]},nr))})]})})]})})]}),document.body),Me&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[90]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(We==null?void 0:We.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:gt,onChange:Nt=>yt(Nt.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ye===0?"":ye,onChange:Nt=>{const nr=Number(Nt.target.value||0),$t=Number.isFinite(nr)?Math.max(0,parseFloat(nr.toFixed(2))):0;mt($t)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se registrar como ABONO (negativo) con 2 decimales."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Pt,onChange:Nt=>Ft(Nt.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[Pt.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>me(!1),disabled:Oe,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:kr,disabled:Oe,children:Oe?"Guardando...":"Guardar abono"})]})]})})]})}function WLe(t,e){var r=Object.setPrototypeOf;r?r(t,e):t.__proto__=e}function XLe(t,e){e===void 0&&(e=t.constructor);var r=Error.captureStackTrace;r&&r(t,e)}var YLe=function(){var t=function(r,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,s){a.__proto__=s}||function(a,s){for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(a[o]=s[o])},t(r,n)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),JLe=function(t){YLe(e,t);function e(r,n){var a=this.constructor,s=t.call(this,r,n)||this;return Object.defineProperty(s,"name",{value:a.name,enumerable:!1,configurable:!0}),WLe(s,a.prototype),XLe(s),s}return e}(Error),ZLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),gd=function(t){ZLe(e,t);function e(r){r===void 0&&(r=void 0);var n=t.call(this,r)||this;return n.message=r,n}return e.prototype.getKind=function(){var r=this.constructor;return r.kind},e.kind="Exception",e}(JLe),eUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),no=function(t){eUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ArgumentException",e}(gd),tUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Vn=function(t){tUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="IllegalArgumentException",e}(gd),Fse=function(){function t(e){if(this.binarizer=e,e===null)throw new Vn("Binarizer must be non-null.")}return t.prototype.getWidth=function(){return this.binarizer.getWidth()},t.prototype.getHeight=function(){return this.binarizer.getHeight()},t.prototype.getBlackRow=function(e,r){return this.binarizer.getBlackRow(e,r)},t.prototype.getBlackMatrix=function(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix},t.prototype.isCropSupported=function(){return this.binarizer.getLuminanceSource().isCropSupported()},t.prototype.crop=function(e,r,n,a){var s=this.binarizer.getLuminanceSource().crop(e,r,n,a);return new t(this.binarizer.createBinarizer(s))},t.prototype.isRotateSupported=function(){return this.binarizer.getLuminanceSource().isRotateSupported()},t.prototype.rotateCounterClockwise=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new t(this.binarizer.createBinarizer(e))},t.prototype.rotateCounterClockwise45=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new t(this.binarizer.createBinarizer(e))},t.prototype.toString=function(){try{return this.getBlackMatrix().toString()}catch{return""}},t}(),rUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),wo=function(t){rUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getChecksumInstance=function(){return new e},e.kind="ChecksumException",e}(gd),nUe=function(){function t(e){this.source=e}return t.prototype.getLuminanceSource=function(){return this.source},t.prototype.getWidth=function(){return this.source.getWidth()},t.prototype.getHeight=function(){return this.source.getHeight()},t}(),Ms=function(){function t(){}return t.arraycopy=function(e,r,n,a,s){for(;s--;)n[a++]=e[r++]},t.currentTimeMillis=function(){return Date.now()},t}(),aUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),qR=function(t){aUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="IndexOutOfBoundsException",e}(gd),sUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Q$=function(t){sUe(e,t);function e(r,n){r===void 0&&(r=void 0),n===void 0&&(n=void 0);var a=t.call(this,n)||this;return a.index=r,a.message=n,a}return e.kind="ArrayIndexOutOfBoundsException",e}(qR),iUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ho=function(){function t(){}return t.fill=function(e,r){for(var n=0,a=e.length;n<a;n++)e[n]=r},t.fillWithin=function(e,r,n,a){t.rangeCheck(e.length,r,n);for(var s=r;s<n;s++)e[s]=a},t.rangeCheck=function(e,r,n){if(r>n)throw new Vn("fromIndex("+r+") > toIndex("+n+")");if(r<0)throw new Q$(r);if(n>e)throw new Q$(n)},t.asList=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e},t.create=function(e,r,n){var a=Array.from({length:e});return a.map(function(s){return Array.from({length:r}).fill(n)})},t.createInt32Array=function(e,r,n){var a=Array.from({length:e});return a.map(function(s){return Int32Array.from({length:r}).fill(n)})},t.equals=function(e,r){if(!e||!r||!e.length||!r.length||e.length!==r.length)return!1;for(var n=0,a=e.length;n<a;n++)if(e[n]!==r[n])return!1;return!0},t.hashCode=function(e){var r,n;if(e===null)return 0;var a=1;try{for(var s=iUe(e),o=s.next();!o.done;o=s.next()){var l=o.value;a=31*a+l}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a},t.fillUint8Array=function(e,r){for(var n=0;n!==e.length;n++)e[n]=r},t.copyOf=function(e,r){return e.slice(0,r)},t.copyOfUint8Array=function(e,r){if(e.length<=r){var n=new Uint8Array(r);return n.set(e),n}return e.slice(0,r)},t.copyOfRange=function(e,r,n){var a=n-r,s=new Int32Array(a);return Ms.arraycopy(e,r,s,0,a),s},t.binarySearch=function(e,r,n){n===void 0&&(n=t.numberComparator);for(var a=0,s=e.length-1;a<=s;){var o=s+a>>1,l=n(r,e[o]);if(l>0)a=o+1;else if(l<0)s=o-1;else return o}return-a-1},t.numberComparator=function(e,r){return e-r},t}(),ba=function(){function t(){}return t.numberOfTrailingZeros=function(e){var r;if(e===0)return 32;var n=31;return r=e<<16,r!==0&&(n-=16,e=r),r=e<<8,r!==0&&(n-=8,e=r),r=e<<4,r!==0&&(n-=4,e=r),r=e<<2,r!==0&&(n-=2,e=r),n-(e<<1>>>31)},t.numberOfLeadingZeros=function(e){if(e===0)return 32;var r=1;return e>>>16||(r+=16,e<<=16),e>>>24||(r+=8,e<<=8),e>>>28||(r+=4,e<<=4),e>>>30||(r+=2,e<<=2),r-=e>>>31,r},t.toHexString=function(e){return e.toString(16)},t.toBinaryString=function(e){return String(parseInt(String(e),2))},t.bitCount=function(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63},t.truncDivision=function(e,r){return Math.trunc(e/r)},t.parseInt=function(e,r){return r===void 0&&(r=void 0),parseInt(e,r)},t.MIN_VALUE_32_BITS=-2147483648,t.MAX_VALUE=Number.MAX_SAFE_INTEGER,t}(),Al=function(){function t(e,r){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,r==null?this.bits=t.makeArray(e):this.bits=r)}return t.prototype.getSize=function(){return this.size},t.prototype.getSizeInBytes=function(){return Math.floor((this.size+7)/8)},t.prototype.ensureCapacity=function(e){if(e>this.bits.length*32){var r=t.makeArray(e);Ms.arraycopy(this.bits,0,r,0,this.bits.length),this.bits=r}},t.prototype.get=function(e){return(this.bits[Math.floor(e/32)]&1<<(e&31))!==0},t.prototype.set=function(e){this.bits[Math.floor(e/32)]|=1<<(e&31)},t.prototype.flip=function(e){this.bits[Math.floor(e/32)]^=1<<(e&31)},t.prototype.getNextSet=function(e){var r=this.size;if(e>=r)return r;var n=this.bits,a=Math.floor(e/32),s=n[a];s&=~((1<<(e&31))-1);for(var o=n.length;s===0;){if(++a===o)return r;s=n[a]}var l=a*32+ba.numberOfTrailingZeros(s);return l>r?r:l},t.prototype.getNextUnset=function(e){var r=this.size;if(e>=r)return r;var n=this.bits,a=Math.floor(e/32),s=~n[a];s&=~((1<<(e&31))-1);for(var o=n.length;s===0;){if(++a===o)return r;s=~n[a]}var l=a*32+ba.numberOfTrailingZeros(s);return l>r?r:l},t.prototype.setBulk=function(e,r){this.bits[Math.floor(e/32)]=r},t.prototype.setRange=function(e,r){if(r<e||e<0||r>this.size)throw new Vn;if(r!==e){r--;for(var n=Math.floor(e/32),a=Math.floor(r/32),s=this.bits,o=n;o<=a;o++){var l=o>n?0:e&31,c=o<a?31:r&31,d=(2<<c)-(1<<l);s[o]|=d}}},t.prototype.clear=function(){for(var e=this.bits.length,r=this.bits,n=0;n<e;n++)r[n]=0},t.prototype.isRange=function(e,r,n){if(r<e||e<0||r>this.size)throw new Vn;if(r===e)return!0;r--;for(var a=Math.floor(e/32),s=Math.floor(r/32),o=this.bits,l=a;l<=s;l++){var c=l>a?0:e&31,d=l<s?31:r&31,u=(2<<d)-(1<<c)&4294967295;if((o[l]&u)!==(n?u:0))return!1}return!0},t.prototype.appendBit=function(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++},t.prototype.appendBits=function(e,r){if(r<0||r>32)throw new Vn("Num bits must be between 0 and 32");this.ensureCapacity(this.size+r);for(var n=r;n>0;n--)this.appendBit((e>>n-1&1)===1)},t.prototype.appendBitArray=function(e){var r=e.size;this.ensureCapacity(this.size+r);for(var n=0;n<r;n++)this.appendBit(e.get(n))},t.prototype.xor=function(e){if(this.size!==e.size)throw new Vn("Sizes don't match");for(var r=this.bits,n=0,a=r.length;n<a;n++)r[n]^=e.bits[n]},t.prototype.toBytes=function(e,r,n,a){for(var s=0;s<a;s++){for(var o=0,l=0;l<8;l++)this.get(e)&&(o|=1<<7-l),e++;r[n+s]=o}},t.prototype.getBitArray=function(){return this.bits},t.prototype.reverse=function(){for(var e=new Int32Array(this.bits.length),r=Math.floor((this.size-1)/32),n=r+1,a=this.bits,s=0;s<n;s++){var o=a[s];o=o>>1&1431655765|(o&1431655765)<<1,o=o>>2&858993459|(o&858993459)<<2,o=o>>4&252645135|(o&252645135)<<4,o=o>>8&16711935|(o&16711935)<<8,o=o>>16&65535|(o&65535)<<16,e[r-s]=o}if(this.size!==n*32){for(var l=n*32-this.size,c=e[0]>>>l,s=1;s<n;s++){var d=e[s];c|=d<<32-l,e[s-1]=c,c=d>>>l}e[n-1]=c}this.bits=e},t.makeArray=function(e){return new Int32Array(Math.floor((e+31)/32))},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.size===r.size&&Ho.equals(this.bits,r.bits)},t.prototype.hashCode=function(){return 31*this.size+Ho.hashCode(this.bits)},t.prototype.toString=function(){for(var e="",r=0,n=this.size;r<n;r++)r&7||(e+=" "),e+=this.get(r)?"X":".";return e},t.prototype.clone=function(){return new t(this.size,this.bits.slice())},t.prototype.toArray=function(){for(var e=[],r=0,n=this.size;r<n;r++)e.push(this.get(r));return e},t}(),gF;(function(t){t[t.OTHER=0]="OTHER",t[t.PURE_BARCODE=1]="PURE_BARCODE",t[t.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",t[t.TRY_HARDER=3]="TRY_HARDER",t[t.CHARACTER_SET=4]="CHARACTER_SET",t[t.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",t[t.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",t[t.ENABLE_CODE_39_EXTENDED_MODE=7]="ENABLE_CODE_39_EXTENDED_MODE",t[t.ASSUME_GS1=8]="ASSUME_GS1",t[t.RETURN_CODABAR_START_END=9]="RETURN_CODABAR_START_END",t[t.NEED_RESULT_POINT_CALLBACK=10]="NEED_RESULT_POINT_CALLBACK",t[t.ALLOWED_EAN_EXTENSIONS=11]="ALLOWED_EAN_EXTENSIONS"})(gF||(gF={}));const Ls=gF;var oUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Zr=function(t){oUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getFormatInstance=function(){return new e},e.kind="FormatException",e}(gd),lUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},cs;(function(t){t[t.Cp437=0]="Cp437",t[t.ISO8859_1=1]="ISO8859_1",t[t.ISO8859_2=2]="ISO8859_2",t[t.ISO8859_3=3]="ISO8859_3",t[t.ISO8859_4=4]="ISO8859_4",t[t.ISO8859_5=5]="ISO8859_5",t[t.ISO8859_6=6]="ISO8859_6",t[t.ISO8859_7=7]="ISO8859_7",t[t.ISO8859_8=8]="ISO8859_8",t[t.ISO8859_9=9]="ISO8859_9",t[t.ISO8859_10=10]="ISO8859_10",t[t.ISO8859_11=11]="ISO8859_11",t[t.ISO8859_13=12]="ISO8859_13",t[t.ISO8859_14=13]="ISO8859_14",t[t.ISO8859_15=14]="ISO8859_15",t[t.ISO8859_16=15]="ISO8859_16",t[t.SJIS=16]="SJIS",t[t.Cp1250=17]="Cp1250",t[t.Cp1251=18]="Cp1251",t[t.Cp1252=19]="Cp1252",t[t.Cp1256=20]="Cp1256",t[t.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",t[t.UTF8=22]="UTF8",t[t.ASCII=23]="ASCII",t[t.Big5=24]="Big5",t[t.GB18030=25]="GB18030",t[t.EUC_KR=26]="EUC_KR"})(cs||(cs={}));var Qo=function(){function t(e,r,n){for(var a,s,o=[],l=3;l<arguments.length;l++)o[l-3]=arguments[l];this.valueIdentifier=e,this.name=n,typeof r=="number"?this.values=Int32Array.from([r]):this.values=r,this.otherEncodingNames=o,t.VALUE_IDENTIFIER_TO_ECI.set(e,this),t.NAME_TO_ECI.set(n,this);for(var c=this.values,d=0,u=c.length;d!==u;d++){var f=c[d];t.VALUES_TO_ECI.set(f,this)}try{for(var A=lUe(o),h=A.next();!h.done;h=A.next()){var m=h.value;t.NAME_TO_ECI.set(m,this)}}catch(p){a={error:p}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}}return t.prototype.getValueIdentifier=function(){return this.valueIdentifier},t.prototype.getName=function(){return this.name},t.prototype.getValue=function(){return this.values[0]},t.getCharacterSetECIByValue=function(e){if(e<0||e>=900)throw new Zr("incorect value");var r=t.VALUES_TO_ECI.get(e);if(r===void 0)throw new Zr("incorect value");return r},t.getCharacterSetECIByName=function(e){var r=t.NAME_TO_ECI.get(e);if(r===void 0)throw new Zr("incorect value");return r},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.getName()===r.getName()},t.VALUE_IDENTIFIER_TO_ECI=new Map,t.VALUES_TO_ECI=new Map,t.NAME_TO_ECI=new Map,t.Cp437=new t(cs.Cp437,Int32Array.from([0,2]),"Cp437"),t.ISO8859_1=new t(cs.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),t.ISO8859_2=new t(cs.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),t.ISO8859_3=new t(cs.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),t.ISO8859_4=new t(cs.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),t.ISO8859_5=new t(cs.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),t.ISO8859_6=new t(cs.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),t.ISO8859_7=new t(cs.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),t.ISO8859_8=new t(cs.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),t.ISO8859_9=new t(cs.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),t.ISO8859_10=new t(cs.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),t.ISO8859_11=new t(cs.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),t.ISO8859_13=new t(cs.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),t.ISO8859_14=new t(cs.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),t.ISO8859_15=new t(cs.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),t.ISO8859_16=new t(cs.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),t.SJIS=new t(cs.SJIS,20,"SJIS","Shift_JIS"),t.Cp1250=new t(cs.Cp1250,21,"Cp1250","windows-1250"),t.Cp1251=new t(cs.Cp1251,22,"Cp1251","windows-1251"),t.Cp1252=new t(cs.Cp1252,23,"Cp1252","windows-1252"),t.Cp1256=new t(cs.Cp1256,24,"Cp1256","windows-1256"),t.UnicodeBigUnmarked=new t(cs.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),t.UTF8=new t(cs.UTF8,26,"UTF8","UTF-8"),t.ASCII=new t(cs.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),t.Big5=new t(cs.Big5,28,"Big5"),t.GB18030=new t(cs.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),t.EUC_KR=new t(cs.EUC_KR,30,"EUC_KR","EUC-KR"),t}(),cUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),_E=function(t){cUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="UnsupportedOperationException",e}(gd),Du=function(){function t(){}return t.decode=function(e,r){var n=this.encodingName(r);return this.customDecoder?this.customDecoder(e,n):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(n)?this.decodeFallback(e,n):new TextDecoder(n).decode(e)},t.shouldDecodeOnFallback=function(e){return!t.isBrowser()&&e==="ISO-8859-1"},t.encode=function(e,r){var n=this.encodingName(r);return this.customEncoder?this.customEncoder(e,n):typeof TextEncoder>"u"?this.encodeFallback(e):new TextEncoder().encode(e)},t.isBrowser=function(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"},t.encodingName=function(e){return typeof e=="string"?e:e.getName()},t.encodingCharacterSet=function(e){return e instanceof Qo?e:Qo.getCharacterSetECIByName(e)},t.decodeFallback=function(e,r){var n=this.encodingCharacterSet(r);if(t.isDecodeFallbackSupported(n)){for(var a="",s=0,o=e.length;s<o;s++){var l=e[s].toString(16);l.length<2&&(l="0"+l),a+="%"+l}return decodeURIComponent(a)}if(n.equals(Qo.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new _E("Encoding "+this.encodingName(r)+" not supported by fallback.")},t.isDecodeFallbackSupported=function(e){return e.equals(Qo.UTF8)||e.equals(Qo.ISO8859_1)||e.equals(Qo.ASCII)},t.encodeFallback=function(e){for(var r=btoa(unescape(encodeURIComponent(e))),n=r.split(""),a=[],s=0;s<n.length;s++)a.push(n[s].charCodeAt(0));return new Uint8Array(a)},t}(),Oa=function(){function t(){}return t.castAsNonUtf8Char=function(e,r){r===void 0&&(r=null);var n=r?r.getName():this.ISO88591;return Du.decode(new Uint8Array([e]),n)},t.guessEncoding=function(e,r){if(r!=null&&r.get(Ls.CHARACTER_SET)!==void 0)return r.get(Ls.CHARACTER_SET).toString();for(var n=e.length,a=!0,s=!0,o=!0,l=0,c=0,d=0,u=0,f=0,A=0,h=0,m=0,p=0,x=0,v=0,y=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191,b=0;b<n&&(a||s||o);b++){var w=e[b]&255;o&&(l>0?w&128?l--:o=!1:w&128&&(w&64?(l++,w&32?(l++,w&16?(l++,w&8?o=!1:u++):d++):c++):o=!1)),a&&(w>127&&w<160?a=!1:w>159&&(w<192||w===215||w===247)&&v++),s&&(f>0?w<64||w===127||w>252?s=!1:f--:w===128||w===160||w>239?s=!1:w>160&&w<224?(A++,m=0,h++,h>p&&(p=h)):w>127?(f++,h=0,m++,m>x&&(x=m)):(h=0,m=0))}return o&&l>0&&(o=!1),s&&f>0&&(s=!1),o&&(y||c+d+u>0)?t.UTF8:s&&(t.ASSUME_SHIFT_JIS||p>=3||x>=3)?t.SHIFT_JIS:a&&s?p===2&&A===2||v*10>=n?t.SHIFT_JIS:t.ISO88591:a?t.ISO88591:s?t.SHIFT_JIS:o?t.UTF8:t.PLATFORM_DEFAULT_ENCODING},t.format=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var a=-1;function s(l,c,d,u,f,A){if(l==="%%")return"%";if(r[++a]!==void 0){l=u?parseInt(u.substr(1)):void 0;var h=f?parseInt(f.substr(1)):void 0,m;switch(A){case"s":m=r[a];break;case"c":m=r[a][0];break;case"f":m=parseFloat(r[a]).toFixed(l);break;case"p":m=parseFloat(r[a]).toPrecision(l);break;case"e":m=parseFloat(r[a]).toExponential(l);break;case"x":m=parseInt(r[a]).toString(h||16);break;case"d":m=parseFloat(parseInt(r[a],h||10).toPrecision(l)).toFixed(0);break}m=typeof m=="object"?JSON.stringify(m):(+m).toString(h);for(var p=parseInt(d),x=d&&d[0]+""=="0"?"0":" ";m.length<p;)m=c!==void 0?m+x:x+m;return m}}var o=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(o,s)},t.getBytes=function(e,r){return Du.encode(e,r)},t.getCharCode=function(e,r){return r===void 0&&(r=0),e.charCodeAt(r)},t.getCharAt=function(e){return String.fromCharCode(e)},t.SHIFT_JIS=Qo.SJIS.getName(),t.GB2312="GB2312",t.ISO88591=Qo.ISO8859_1.getName(),t.EUC_JP="EUC_JP",t.UTF8=Qo.UTF8.getName(),t.PLATFORM_DEFAULT_ENCODING=t.UTF8,t.ASSUME_SHIFT_JIS=!1,t}(),ga=function(){function t(e){e===void 0&&(e=""),this.value=e}return t.prototype.enableDecoding=function(e){return this.encoding=e,this},t.prototype.append=function(e){return typeof e=="string"?this.value+=e.toString():this.encoding?this.value+=Oa.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this},t.prototype.appendChars=function(e,r,n){for(var a=r;r<r+n;a++)this.append(e[a]);return this},t.prototype.length=function(){return this.value.length},t.prototype.charAt=function(e){return this.value.charAt(e)},t.prototype.deleteCharAt=function(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)},t.prototype.setCharAt=function(e,r){this.value=this.value.substr(0,e)+r+this.value.substr(e+1)},t.prototype.substring=function(e,r){return this.value.substring(e,r)},t.prototype.setLengthToZero=function(){this.value=""},t.prototype.toString=function(){return this.value},t.prototype.insert=function(e,r){this.value=this.value.substring(0,e)+r+this.value.substring(e)},t}(),fh=function(){function t(e,r,n,a){if(this.width=e,this.height=r,this.rowSize=n,this.bits=a,r==null&&(r=e),this.height=r,e<1||r<1)throw new Vn("Both dimensions must be greater than 0");n==null&&(n=Math.floor((e+31)/32)),this.rowSize=n,a==null&&(this.bits=new Int32Array(this.rowSize*this.height))}return t.parseFromBooleanArray=function(e){for(var r=e.length,n=e[0].length,a=new t(n,r),s=0;s<r;s++)for(var o=e[s],l=0;l<n;l++)o[l]&&a.set(l,s);return a},t.parseFromString=function(e,r,n){if(e===null)throw new Vn("stringRepresentation cannot be null");for(var a=new Array(e.length),s=0,o=0,l=-1,c=0,d=0;d<e.length;)if(e.charAt(d)===`
`||e.charAt(d)==="\r"){if(s>o){if(l===-1)l=s-o;else if(s-o!==l)throw new Vn("row lengths do not match");o=s,c++}d++}else if(e.substring(d,d+r.length)===r)d+=r.length,a[s]=!0,s++;else if(e.substring(d,d+n.length)===n)d+=n.length,a[s]=!1,s++;else throw new Vn("illegal character encountered: "+e.substring(d));if(s>o){if(l===-1)l=s-o;else if(s-o!==l)throw new Vn("row lengths do not match");c++}for(var u=new t(l,c),f=0;f<s;f++)a[f]&&u.set(Math.floor(f%l),Math.floor(f/l));return u},t.prototype.get=function(e,r){var n=r*this.rowSize+Math.floor(e/32);return(this.bits[n]>>>(e&31)&1)!==0},t.prototype.set=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]|=1<<(e&31)&4294967295},t.prototype.unset=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]&=~(1<<(e&31)&4294967295)},t.prototype.flip=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]^=1<<(e&31)&4294967295},t.prototype.xor=function(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new Vn("input matrix dimensions do not match");for(var r=new Al(Math.floor(this.width/32)+1),n=this.rowSize,a=this.bits,s=0,o=this.height;s<o;s++)for(var l=s*n,c=e.getRow(s,r).getBitArray(),d=0;d<n;d++)a[l+d]^=c[d]},t.prototype.clear=function(){for(var e=this.bits,r=e.length,n=0;n<r;n++)e[n]=0},t.prototype.setRegion=function(e,r,n,a){if(r<0||e<0)throw new Vn("Left and top must be nonnegative");if(a<1||n<1)throw new Vn("Height and width must be at least 1");var s=e+n,o=r+a;if(o>this.height||s>this.width)throw new Vn("The region must fit inside the matrix");for(var l=this.rowSize,c=this.bits,d=r;d<o;d++)for(var u=d*l,f=e;f<s;f++)c[u+Math.floor(f/32)]|=1<<(f&31)&4294967295},t.prototype.getRow=function(e,r){r==null||r.getSize()<this.width?r=new Al(this.width):r.clear();for(var n=this.rowSize,a=this.bits,s=e*n,o=0;o<n;o++)r.setBulk(o*32,a[s+o]);return r},t.prototype.setRow=function(e,r){Ms.arraycopy(r.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)},t.prototype.rotate180=function(){for(var e=this.getWidth(),r=this.getHeight(),n=new Al(e),a=new Al(e),s=0,o=Math.floor((r+1)/2);s<o;s++)n=this.getRow(s,n),a=this.getRow(r-1-s,a),n.reverse(),a.reverse(),this.setRow(s,a),this.setRow(r-1-s,n)},t.prototype.getEnclosingRectangle=function(){for(var e=this.width,r=this.height,n=this.rowSize,a=this.bits,s=e,o=r,l=-1,c=-1,d=0;d<r;d++)for(var u=0;u<n;u++){var f=a[d*n+u];if(f!==0){if(d<o&&(o=d),d>c&&(c=d),u*32<s){for(var A=0;!(f<<31-A&4294967295);)A++;u*32+A<s&&(s=u*32+A)}if(u*32+31>l){for(var A=31;!(f>>>A);)A--;u*32+A>l&&(l=u*32+A)}}}return l<s||c<o?null:Int32Array.from([s,o,l-s+1,c-o+1])},t.prototype.getTopLeftOnBit=function(){for(var e=this.rowSize,r=this.bits,n=0;n<r.length&&r[n]===0;)n++;if(n===r.length)return null;for(var a=n/e,s=n%e*32,o=r[n],l=0;!(o<<31-l&4294967295);)l++;return s+=l,Int32Array.from([s,a])},t.prototype.getBottomRightOnBit=function(){for(var e=this.rowSize,r=this.bits,n=r.length-1;n>=0&&r[n]===0;)n--;if(n<0)return null;for(var a=Math.floor(n/e),s=Math.floor(n%e)*32,o=r[n],l=31;!(o>>>l);)l--;return s+=l,Int32Array.from([s,a])},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.getRowSize=function(){return this.rowSize},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.width===r.width&&this.height===r.height&&this.rowSize===r.rowSize&&Ho.equals(this.bits,r.bits)},t.prototype.hashCode=function(){var e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+Ho.hashCode(this.bits),e},t.prototype.toString=function(e,r,n){return e===void 0&&(e="X "),r===void 0&&(r="  "),n===void 0&&(n=`
`),this.buildToString(e,r,n)},t.prototype.buildToString=function(e,r,n){for(var a=new ga,s=0,o=this.height;s<o;s++){for(var l=0,c=this.width;l<c;l++)a.append(this.get(l,s)?e:r);a.append(n)}return a.toString()},t.prototype.clone=function(){return new t(this.width,this.height,this.rowSize,this.bits.slice())},t}(),dUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ar=function(t){dUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getNotFoundInstance=function(){return new e},e.kind="NotFoundException",e}(gd),uUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),fUe=function(t){uUe(e,t);function e(r){var n=t.call(this,r)||this;return n.luminances=e.EMPTY,n.buckets=new Int32Array(e.LUMINANCE_BUCKETS),n}return e.prototype.getBlackRow=function(r,n){var a=this.getLuminanceSource(),s=a.getWidth();n==null||n.getSize()<s?n=new Al(s):n.clear(),this.initArrays(s);for(var o=a.getRow(r,this.luminances),l=this.buckets,c=0;c<s;c++)l[(o[c]&255)>>e.LUMINANCE_SHIFT]++;var d=e.estimateBlackPoint(l);if(s<3)for(var c=0;c<s;c++)(o[c]&255)<d&&n.set(c);else for(var u=o[0]&255,f=o[1]&255,c=1;c<s-1;c++){var A=o[c+1]&255;(f*4-u-A)/2<d&&n.set(c),u=f,f=A}return n},e.prototype.getBlackMatrix=function(){var r=this.getLuminanceSource(),n=r.getWidth(),a=r.getHeight(),s=new fh(n,a);this.initArrays(n);for(var o=this.buckets,l=1;l<5;l++)for(var c=Math.floor(a*l/5),d=r.getRow(c,this.luminances),u=Math.floor(n*4/5),f=Math.floor(n/5);f<u;f++){var A=d[f]&255;o[A>>e.LUMINANCE_SHIFT]++}for(var h=e.estimateBlackPoint(o),m=r.getMatrix(),l=0;l<a;l++)for(var p=l*n,f=0;f<n;f++){var A=m[p+f]&255;A<h&&s.set(f,l)}return s},e.prototype.createBinarizer=function(r){return new e(r)},e.prototype.initArrays=function(r){this.luminances.length<r&&(this.luminances=new Uint8ClampedArray(r));for(var n=this.buckets,a=0;a<e.LUMINANCE_BUCKETS;a++)n[a]=0},e.estimateBlackPoint=function(r){for(var n=r.length,a=0,s=0,o=0,l=0;l<n;l++)r[l]>o&&(s=l,o=r[l]),r[l]>a&&(a=r[l]);for(var c=0,d=0,l=0;l<n;l++){var u=l-s,f=r[l]*u*u;f>d&&(c=l,d=f)}if(s>c){var A=s;s=c,c=A}if(c-s<=n/16)throw new Ar;for(var h=c-1,m=-1,l=c-1;l>s;l--){var p=l-s,f=p*p*(c-l)*(a-r[l]);f>m&&(h=l,m=f)}return h<<e.LUMINANCE_SHIFT},e.LUMINANCE_BITS=5,e.LUMINANCE_SHIFT=8-e.LUMINANCE_BITS,e.LUMINANCE_BUCKETS=1<<e.LUMINANCE_BITS,e.EMPTY=Uint8ClampedArray.from([0]),e}(nUe),hUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ose=function(t){hUe(e,t);function e(r){var n=t.call(this,r)||this;return n.matrix=null,n}return e.prototype.getBlackMatrix=function(){if(this.matrix!==null)return this.matrix;var r=this.getLuminanceSource(),n=r.getWidth(),a=r.getHeight();if(n>=e.MINIMUM_DIMENSION&&a>=e.MINIMUM_DIMENSION){var s=r.getMatrix(),o=n>>e.BLOCK_SIZE_POWER;n&e.BLOCK_SIZE_MASK&&o++;var l=a>>e.BLOCK_SIZE_POWER;a&e.BLOCK_SIZE_MASK&&l++;var c=e.calculateBlackPoints(s,o,l,n,a),d=new fh(n,a);e.calculateThresholdForBlock(s,o,l,n,a,c,d),this.matrix=d}else this.matrix=t.prototype.getBlackMatrix.call(this);return this.matrix},e.prototype.createBinarizer=function(r){return new e(r)},e.calculateThresholdForBlock=function(r,n,a,s,o,l,c){for(var d=o-e.BLOCK_SIZE,u=s-e.BLOCK_SIZE,f=0;f<a;f++){var A=f<<e.BLOCK_SIZE_POWER;A>d&&(A=d);for(var h=e.cap(f,2,a-3),m=0;m<n;m++){var p=m<<e.BLOCK_SIZE_POWER;p>u&&(p=u);for(var x=e.cap(m,2,n-3),v=0,y=-2;y<=2;y++){var b=l[h+y];v+=b[x-2]+b[x-1]+b[x]+b[x+1]+b[x+2]}var w=v/25;e.thresholdBlock(r,p,A,w,s,c)}}},e.cap=function(r,n,a){return r<n?n:r>a?a:r},e.thresholdBlock=function(r,n,a,s,o,l){for(var c=0,d=a*o+n;c<e.BLOCK_SIZE;c++,d+=o)for(var u=0;u<e.BLOCK_SIZE;u++)(r[d+u]&255)<=s&&l.set(n+u,a+c)},e.calculateBlackPoints=function(r,n,a,s,o){for(var l=o-e.BLOCK_SIZE,c=s-e.BLOCK_SIZE,d=new Array(a),u=0;u<a;u++){d[u]=new Int32Array(n);var f=u<<e.BLOCK_SIZE_POWER;f>l&&(f=l);for(var A=0;A<n;A++){var h=A<<e.BLOCK_SIZE_POWER;h>c&&(h=c);for(var m=0,p=255,x=0,v=0,y=f*s+h;v<e.BLOCK_SIZE;v++,y+=s){for(var b=0;b<e.BLOCK_SIZE;b++){var w=r[y+b]&255;m+=w,w<p&&(p=w),w>x&&(x=w)}if(x-p>e.MIN_DYNAMIC_RANGE)for(v++,y+=s;v<e.BLOCK_SIZE;v++,y+=s)for(var b=0;b<e.BLOCK_SIZE;b++)m+=r[y+b]&255}var I=m>>e.BLOCK_SIZE_POWER*2;if(x-p<=e.MIN_DYNAMIC_RANGE&&(I=p/2,u>0&&A>0)){var j=(d[u-1][A]+2*d[u][A-1]+d[u-1][A-1])/4;p<j&&(I=j)}d[u][A]=I}}return d},e.BLOCK_SIZE_POWER=3,e.BLOCK_SIZE=1<<e.BLOCK_SIZE_POWER,e.BLOCK_SIZE_MASK=e.BLOCK_SIZE-1,e.MINIMUM_DIMENSION=e.BLOCK_SIZE*5,e.MIN_DYNAMIC_RANGE=24,e}(fUe),Xw=function(){function t(e,r){this.width=e,this.height=r}return t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.isCropSupported=function(){return!1},t.prototype.crop=function(e,r,n,a){throw new _E("This luminance source does not support cropping.")},t.prototype.isRotateSupported=function(){return!1},t.prototype.rotateCounterClockwise=function(){throw new _E("This luminance source does not support rotation by 90 degrees.")},t.prototype.rotateCounterClockwise45=function(){throw new _E("This luminance source does not support rotation by 45 degrees.")},t.prototype.toString=function(){for(var e=new Uint8ClampedArray(this.width),r=new ga,n=0;n<this.height;n++){for(var a=this.getRow(n,e),s=0;s<this.width;s++){var o=a[s]&255,l=void 0;o<64?l="#":o<128?l="+":o<192?l=".":l=" ",r.append(l)}r.append(`
`)}return r.toString()},t}(),AUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),_P=function(t){AUe(e,t);function e(r){var n=t.call(this,r.getWidth(),r.getHeight())||this;return n.delegate=r,n}return e.prototype.getRow=function(r,n){for(var a=this.delegate.getRow(r,n),s=this.getWidth(),o=0;o<s;o++)a[o]=255-(a[o]&255);return a},e.prototype.getMatrix=function(){for(var r=this.delegate.getMatrix(),n=this.getWidth()*this.getHeight(),a=new Uint8ClampedArray(n),s=0;s<n;s++)a[s]=255-(r[s]&255);return a},e.prototype.isCropSupported=function(){return this.delegate.isCropSupported()},e.prototype.crop=function(r,n,a,s){return new e(this.delegate.crop(r,n,a,s))},e.prototype.isRotateSupported=function(){return this.delegate.isRotateSupported()},e.prototype.invert=function(){return this.delegate},e.prototype.rotateCounterClockwise=function(){return new e(this.delegate.rotateCounterClockwise())},e.prototype.rotateCounterClockwise45=function(){return new e(this.delegate.rotateCounterClockwise45())},e}(Xw),mUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),pUe=function(t){mUe(e,t);function e(r,n){n===void 0&&(n=!1);var a=t.call(this,r.width,r.height)||this;return a.canvas=r,a.tempCanvasElement=null,a.buffer=e.makeBufferFromCanvasImageData(r,n),a}return e.makeBufferFromCanvasImageData=function(r,n){n===void 0&&(n=!1);var a=r.getContext("2d").getImageData(0,0,r.width,r.height);return e.toGrayscaleBuffer(a.data,r.width,r.height,n)},e.toGrayscaleBuffer=function(r,n,a,s){s===void 0&&(s=!1);var o=new Uint8ClampedArray(n*a);if(e.FRAME_INDEX=!e.FRAME_INDEX,e.FRAME_INDEX||!s)for(var l=0,c=0,d=r.length;l<d;l+=4,c++){var u=void 0,f=r[l+3];if(f===0)u=255;else{var A=r[l],h=r[l+1],m=r[l+2];u=306*A+601*h+117*m+512>>10}o[c]=u}else for(var l=0,c=0,p=r.length;l<p;l+=4,c++){var u=void 0,f=r[l+3];if(f===0)u=255;else{var A=r[l],h=r[l+1],m=r[l+2];u=306*A+601*h+117*m+512>>10}o[c]=255-u}return o},e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Vn("Requested row is outside the image: "+r);var a=this.getWidth(),s=r*a;return n===null?n=this.buffer.slice(s,s+a):(n.length<a&&(n=new Uint8ClampedArray(a)),n.set(this.buffer.slice(s,s+a))),n},e.prototype.getMatrix=function(){return this.buffer},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return t.prototype.crop.call(this,r,n,a,s),this},e.prototype.isRotateSupported=function(){return!0},e.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},e.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},e.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement},e.prototype.rotate=function(r){var n=this.getTempCanvasElement(),a=n.getContext("2d"),s=r*e.DEGREE_TO_RADIANS,o=this.canvas.width,l=this.canvas.height,c=Math.ceil(Math.abs(Math.cos(s))*o+Math.abs(Math.sin(s))*l),d=Math.ceil(Math.abs(Math.sin(s))*o+Math.abs(Math.cos(s))*l);return n.width=c,n.height=d,a.translate(c/2,d/2),a.rotate(s),a.drawImage(this.canvas,o/-2,l/-2),this.buffer=e.makeBufferFromCanvasImageData(n),this},e.prototype.invert=function(){return new _P(this)},e.DEGREE_TO_RADIANS=Math.PI/180,e.FRAME_INDEX=!0,e}(Xw),gUe=function(){function t(e,r,n){this.deviceId=e,this.label=r,this.kind="videoinput",this.groupId=n||void 0}return t.prototype.toJSON=function(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}},t}(),jc=function(t,e,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(u){try{d(n.next(u))}catch(f){o(f)}}function c(u){try{d(n.throw(u))}catch(f){o(f)}}function d(u){u.done?s(u.value):a(u.value).then(l,c)}d((n=n.apply(t,e||[])).next())})},Ic=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(u){return c([d,u])}}function c(d){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=d[0]&2?a.return:d[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,d[1])).done)return s;switch(a=0,s&&(d=[d[0]&2,s.value]),d[0]){case 0:case 1:s=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,a=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!s||d[1]>s[0]&&d[1]<s[3])){r.label=d[1];break}if(d[0]===6&&r.label<s[1]){r.label=s[1],s=d;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(d);break}s[2]&&r.ops.pop(),r.trys.pop();continue}d=e.call(t,r)}catch(u){d=[6,u],a=0}finally{n=s=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},xUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},P1=function(){function t(e,r,n){r===void 0&&(r=500),this.reader=e,this.timeBetweenScansMillis=r,this._hints=n,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}return Object.defineProperty(t.prototype,"hasNavigator",{get:function(){return typeof navigator<"u"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMediaDevicesSuported",{get:function(){return this.hasNavigator&&!!navigator.mediaDevices},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canEnumerateDevices",{get:function(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"timeBetweenDecodingAttempts",{get:function(){return this._timeBetweenDecodingAttempts},set:function(e){this._timeBetweenDecodingAttempts=e<0?0:e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hints",{get:function(){return this._hints},set:function(e){this._hints=e||null},enumerable:!1,configurable:!0}),t.prototype.listVideoInputDevices=function(){return jc(this,void 0,void 0,function(){var e,r,n,a,s,o,l,c,d,u,f,A;return Ic(this,function(h){switch(h.label){case 0:if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=h.sent(),r=[];try{for(n=xUe(e),a=n.next();!a.done;a=n.next())s=a.value,o=s.kind==="video"?"videoinput":s.kind,o==="videoinput"&&(l=s.deviceId||s.id,c=s.label||"Video device "+(r.length+1),d=s.groupId,u={deviceId:l,label:c,kind:o,groupId:d},r.push(u))}catch(m){f={error:m}}finally{try{a&&!a.done&&(A=n.return)&&A.call(n)}finally{if(f)throw f.error}}return[2,r]}})})},t.prototype.getVideoInputDevices=function(){return jc(this,void 0,void 0,function(){var e;return Ic(this,function(r){switch(r.label){case 0:return[4,this.listVideoInputDevices()];case 1:return e=r.sent(),[2,e.map(function(n){return new gUe(n.deviceId,n.label)})]}})})},t.prototype.findDeviceById=function(e){return jc(this,void 0,void 0,function(){var r;return Ic(this,function(n){switch(n.label){case 0:return[4,this.listVideoInputDevices()];case 1:return r=n.sent(),r?[2,r.find(function(a){return a.deviceId===e})]:[2,null]}})})},t.prototype.decodeFromInputVideoDevice=function(e,r){return jc(this,void 0,void 0,function(){return Ic(this,function(n){switch(n.label){case 0:return[4,this.decodeOnceFromVideoDevice(e,r)];case 1:return[2,n.sent()]}})})},t.prototype.decodeOnceFromVideoDevice=function(e,r){return jc(this,void 0,void 0,function(){var n,a;return Ic(this,function(s){switch(s.label){case 0:return this.reset(),e?n={deviceId:{exact:e}}:n={facingMode:"environment"},a={video:n},[4,this.decodeOnceFromConstraints(a,r)];case 1:return[2,s.sent()]}})})},t.prototype.decodeOnceFromConstraints=function(e,r){return jc(this,void 0,void 0,function(){var n;return Ic(this,function(a){switch(a.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return n=a.sent(),[4,this.decodeOnceFromStream(n,r)];case 2:return[2,a.sent()]}})})},t.prototype.decodeOnceFromStream=function(e,r){return jc(this,void 0,void 0,function(){var n,a;return Ic(this,function(s){switch(s.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,r)];case 1:return n=s.sent(),[4,this.decodeOnce(n)];case 2:return a=s.sent(),[2,a]}})})},t.prototype.decodeFromInputVideoDeviceContinuously=function(e,r,n){return jc(this,void 0,void 0,function(){return Ic(this,function(a){switch(a.label){case 0:return[4,this.decodeFromVideoDevice(e,r,n)];case 1:return[2,a.sent()]}})})},t.prototype.decodeFromVideoDevice=function(e,r,n){return jc(this,void 0,void 0,function(){var a,s;return Ic(this,function(o){switch(o.label){case 0:return e?a={deviceId:{exact:e}}:a={facingMode:"environment"},s={video:a},[4,this.decodeFromConstraints(s,r,n)];case 1:return[2,o.sent()]}})})},t.prototype.decodeFromConstraints=function(e,r,n){return jc(this,void 0,void 0,function(){var a;return Ic(this,function(s){switch(s.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return a=s.sent(),[4,this.decodeFromStream(a,r,n)];case 2:return[2,s.sent()]}})})},t.prototype.decodeFromStream=function(e,r,n){return jc(this,void 0,void 0,function(){var a;return Ic(this,function(s){switch(s.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,r)];case 1:return a=s.sent(),[4,this.decodeContinuously(a,n)];case 2:return[2,s.sent()]}})})},t.prototype.stopAsyncDecode=function(){this._stopAsyncDecode=!0},t.prototype.stopContinuousDecode=function(){this._stopContinuousDecode=!0},t.prototype.attachStreamToVideo=function(e,r){return jc(this,void 0,void 0,function(){var n;return Ic(this,function(a){switch(a.label){case 0:return n=this.prepareVideoElement(r),this.addVideoSource(n,e),this.videoElement=n,this.stream=e,[4,this.playVideoOnLoadAsync(n)];case 1:return a.sent(),[2,n]}})})},t.prototype.playVideoOnLoadAsync=function(e){var r=this;return new Promise(function(n,a){return r.playVideoOnLoad(e,function(){return n()})})},t.prototype.playVideoOnLoad=function(e,r){var n=this;this.videoEndedListener=function(){return n.stopStreams()},this.videoCanPlayListener=function(){return n.tryPlayVideo(e)},e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",r),this.tryPlayVideo(e)},t.prototype.isVideoPlaying=function(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2},t.prototype.tryPlayVideo=function(e){return jc(this,void 0,void 0,function(){return Ic(this,function(r){switch(r.label){case 0:if(this.isVideoPlaying(e))return console.warn("Trying to play video that is already playing."),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.play()];case 2:return r.sent(),[3,4];case 3:return r.sent(),console.warn("It was not possible to play the video."),[3,4];case 4:return[2]}})})},t.prototype.getMediaElement=function(e,r){var n=document.getElementById(e);if(!n)throw new no("element with id '"+e+"' not found");if(n.nodeName.toLowerCase()!==r.toLowerCase())throw new no("element with id '"+e+"' must be an "+r+" element");return n},t.prototype.decodeFromImage=function(e,r){if(!e&&!r)throw new no("either imageElement with a src set or an url must be provided");return r&&!e?this.decodeFromImageUrl(r):this.decodeFromImageElement(e)},t.prototype.decodeFromVideo=function(e,r){if(!e&&!r)throw new no("Either an element with a src set or an URL must be provided");return r&&!e?this.decodeFromVideoUrl(r):this.decodeFromVideoElement(e)},t.prototype.decodeFromVideoContinuously=function(e,r,n){if(e===void 0&&r===void 0)throw new no("Either an element with a src set or an URL must be provided");return r&&!e?this.decodeFromVideoUrlContinuously(r,n):this.decodeFromVideoElementContinuously(e,n)},t.prototype.decodeFromImageElement=function(e){if(!e)throw new no("An image element must be provided.");this.reset();var r=this.prepareImageElement(e);this.imageElement=r;var n;return this.isImageLoaded(r)?n=this.decodeOnce(r,!1,!0):n=this._decodeOnLoadImage(r),n},t.prototype.decodeFromVideoElement=function(e){var r=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(r)},t.prototype.decodeFromVideoElementContinuously=function(e,r){var n=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(n,r)},t.prototype._decodeFromVideoElementSetup=function(e){if(!e)throw new no("A video element must be provided.");this.reset();var r=this.prepareVideoElement(e);return this.videoElement=r,r},t.prototype.decodeFromImageUrl=function(e){if(!e)throw new no("An URL must be provided.");this.reset();var r=this.prepareImageElement();this.imageElement=r;var n=this._decodeOnLoadImage(r);return r.src=e,n},t.prototype.decodeFromVideoUrl=function(e){if(!e)throw new no("An URL must be provided.");this.reset();var r=this.prepareVideoElement(),n=this.decodeFromVideoElement(r);return r.src=e,n},t.prototype.decodeFromVideoUrlContinuously=function(e,r){if(!e)throw new no("An URL must be provided.");this.reset();var n=this.prepareVideoElement(),a=this.decodeFromVideoElementContinuously(n,r);return n.src=e,a},t.prototype._decodeOnLoadImage=function(e){var r=this;return new Promise(function(n,a){r.imageLoadedListener=function(){return r.decodeOnce(e,!1,!0).then(n,a)},e.addEventListener("load",r.imageLoadedListener)})},t.prototype._decodeOnLoadVideo=function(e){return jc(this,void 0,void 0,function(){return Ic(this,function(r){switch(r.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return r.sent(),[4,this.decodeOnce(e)];case 2:return[2,r.sent()]}})})},t.prototype._decodeOnLoadVideoContinuously=function(e,r){return jc(this,void 0,void 0,function(){return Ic(this,function(n){switch(n.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return n.sent(),this.decodeContinuously(e,r),[2]}})})},t.prototype.isImageLoaded=function(e){return!(!e.complete||e.naturalWidth===0)},t.prototype.prepareImageElement=function(e){var r;return typeof e>"u"&&(r=document.createElement("img"),r.width=200,r.height=200),typeof e=="string"&&(r=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(r=e),r},t.prototype.prepareVideoElement=function(e){var r;return!e&&typeof document<"u"&&(r=document.createElement("video"),r.width=200,r.height=200),typeof e=="string"&&(r=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(r=e),r.setAttribute("autoplay","true"),r.setAttribute("muted","true"),r.setAttribute("playsinline","true"),r},t.prototype.decodeOnce=function(e,r,n){var a=this;r===void 0&&(r=!0),n===void 0&&(n=!0),this._stopAsyncDecode=!1;var s=function(o,l){if(a._stopAsyncDecode){l(new Ar("Video stream has ended before any code could be detected.")),a._stopAsyncDecode=void 0;return}try{var c=a.decode(e);o(c)}catch(A){var d=r&&A instanceof Ar,u=A instanceof wo||A instanceof Zr,f=u&&n;if(d||f)return setTimeout(s,a._timeBetweenDecodingAttempts,o,l);l(A)}};return new Promise(function(o,l){return s(o,l)})},t.prototype.decodeContinuously=function(e,r){var n=this;this._stopContinuousDecode=!1;var a=function(){if(n._stopContinuousDecode){n._stopContinuousDecode=void 0;return}try{var s=n.decode(e);r(s,null),setTimeout(a,n.timeBetweenScansMillis)}catch(c){r(null,c);var o=c instanceof wo||c instanceof Zr,l=c instanceof Ar;(o||l)&&setTimeout(a,n._timeBetweenDecodingAttempts)}};a()},t.prototype.decode=function(e){var r=this.createBinaryBitmap(e);return this.decodeBitmap(r)},t.prototype.createBinaryBitmap=function(e){this.getCaptureCanvasContext(e);var r=!1;e instanceof HTMLVideoElement?(this.drawFrameOnCanvas(e),r=!0):this.drawImageOnCanvas(e);var n=this.getCaptureCanvas(e),a=new pUe(n,r),s=new Ose(a);return new Fse(s)},t.prototype.getCaptureCanvasContext=function(e){if(!this.captureCanvasContext){var r=this.getCaptureCanvas(e),n=void 0;try{n=r.getContext("2d",{willReadFrequently:!0})}catch{n=r.getContext("2d")}this.captureCanvasContext=n}return this.captureCanvasContext},t.prototype.getCaptureCanvas=function(e){if(!this.captureCanvas){var r=this.createCaptureCanvas(e);this.captureCanvas=r}return this.captureCanvas},t.prototype.drawFrameOnCanvas=function(e,r,n){r===void 0&&(r={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),n===void 0&&(n=this.captureCanvasContext),n.drawImage(e,r.sx,r.sy,r.sWidth,r.sHeight,r.dx,r.dy,r.dWidth,r.dHeight)},t.prototype.drawImageOnCanvas=function(e,r,n){r===void 0&&(r={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),n===void 0&&(n=this.captureCanvasContext),n.drawImage(e,r.sx,r.sy,r.sWidth,r.sHeight,r.dx,r.dy,r.dWidth,r.dHeight)},t.prototype.decodeBitmap=function(e){return this.reader.decode(e,this._hints)},t.prototype.createCaptureCanvas=function(e){if(typeof document>"u")return this._destroyCaptureCanvas(),null;var r=document.createElement("canvas"),n,a;return typeof e<"u"&&(e instanceof HTMLVideoElement?(n=e.videoWidth,a=e.videoHeight):e instanceof HTMLImageElement&&(n=e.naturalWidth||e.width,a=e.naturalHeight||e.height)),r.style.width=n+"px",r.style.height=a+"px",r.width=n,r.height=a,r},t.prototype.stopStreams=function(){this.stream&&(this.stream.getVideoTracks().forEach(function(e){return e.stop()}),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()},t.prototype.reset=function(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()},t.prototype._destroyVideoElement=function(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)},t.prototype._destroyImageElement=function(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)},t.prototype._destroyCaptureCanvas=function(){this.captureCanvasContext=void 0,this.captureCanvas=void 0},t.prototype.addVideoSource=function(e,r){try{e.srcObject=r}catch{e.src=URL.createObjectURL(r)}},t.prototype.cleanVideoSource=function(e){try{e.srcObject=null}catch{e.src=""}this.videoElement.removeAttribute("src")},t}(),Nc=function(){function t(e,r,n,a,s,o){n===void 0&&(n=r==null?0:8*r.length),o===void 0&&(o=Ms.currentTimeMillis()),this.text=e,this.rawBytes=r,this.numBits=n,this.resultPoints=a,this.format=s,this.timestamp=o,this.text=e,this.rawBytes=r,n==null?this.numBits=r==null?0:8*r.length:this.numBits=n,this.resultPoints=a,this.format=s,this.resultMetadata=null,o==null?this.timestamp=Ms.currentTimeMillis():this.timestamp=o}return t.prototype.getText=function(){return this.text},t.prototype.getRawBytes=function(){return this.rawBytes},t.prototype.getNumBits=function(){return this.numBits},t.prototype.getResultPoints=function(){return this.resultPoints},t.prototype.getBarcodeFormat=function(){return this.format},t.prototype.getResultMetadata=function(){return this.resultMetadata},t.prototype.putMetadata=function(e,r){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(e,r)},t.prototype.putAllMetadata=function(e){e!==null&&(this.resultMetadata===null?this.resultMetadata=e:this.resultMetadata=new Map(e))},t.prototype.addResultPoints=function(e){var r=this.resultPoints;if(r===null)this.resultPoints=e;else if(e!==null&&e.length>0){var n=new Array(r.length+e.length);Ms.arraycopy(r,0,n,0,r.length),Ms.arraycopy(e,0,n,r.length,e.length),this.resultPoints=n}},t.prototype.getTimestamp=function(){return this.timestamp},t.prototype.toString=function(){return this.text},t}(),xF;(function(t){t[t.AZTEC=0]="AZTEC",t[t.CODABAR=1]="CODABAR",t[t.CODE_39=2]="CODE_39",t[t.CODE_93=3]="CODE_93",t[t.CODE_128=4]="CODE_128",t[t.DATA_MATRIX=5]="DATA_MATRIX",t[t.EAN_8=6]="EAN_8",t[t.EAN_13=7]="EAN_13",t[t.ITF=8]="ITF",t[t.MAXICODE=9]="MAXICODE",t[t.PDF_417=10]="PDF_417",t[t.QR_CODE=11]="QR_CODE",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(xF||(xF={}));const Qn=xF;var vF;(function(t){t[t.OTHER=0]="OTHER",t[t.ORIENTATION=1]="ORIENTATION",t[t.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",t[t.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",t[t.ISSUE_NUMBER=4]="ISSUE_NUMBER",t[t.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",t[t.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",t[t.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",t[t.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",t[t.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",t[t.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(vF||(vF={}));const Vl=vF;var EP=function(){function t(e,r,n,a,s,o){s===void 0&&(s=-1),o===void 0&&(o=-1),this.rawBytes=e,this.text=r,this.byteSegments=n,this.ecLevel=a,this.structuredAppendSequenceNumber=s,this.structuredAppendParity=o,this.numBits=e==null?0:8*e.length}return t.prototype.getRawBytes=function(){return this.rawBytes},t.prototype.getNumBits=function(){return this.numBits},t.prototype.setNumBits=function(e){this.numBits=e},t.prototype.getText=function(){return this.text},t.prototype.getByteSegments=function(){return this.byteSegments},t.prototype.getECLevel=function(){return this.ecLevel},t.prototype.getErrorsCorrected=function(){return this.errorsCorrected},t.prototype.setErrorsCorrected=function(e){this.errorsCorrected=e},t.prototype.getErasures=function(){return this.erasures},t.prototype.setErasures=function(e){this.erasures=e},t.prototype.getOther=function(){return this.other},t.prototype.setOther=function(e){this.other=e},t.prototype.hasStructuredAppend=function(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0},t.prototype.getStructuredAppendParity=function(){return this.structuredAppendParity},t.prototype.getStructuredAppendSequenceNumber=function(){return this.structuredAppendSequenceNumber},t}(),sb=function(){function t(){}return t.prototype.exp=function(e){return this.expTable[e]},t.prototype.log=function(e){if(e===0)throw new Vn;return this.logTable[e]},t.addOrSubtract=function(e,r){return e^r},t}(),gm=function(){function t(e,r){if(r.length===0)throw new Vn;this.field=e;var n=r.length;if(n>1&&r[0]===0){for(var a=1;a<n&&r[a]===0;)a++;a===n?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(n-a),Ms.arraycopy(r,a,this.coefficients,0,this.coefficients.length))}else this.coefficients=r}return t.prototype.getCoefficients=function(){return this.coefficients},t.prototype.getDegree=function(){return this.coefficients.length-1},t.prototype.isZero=function(){return this.coefficients[0]===0},t.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},t.prototype.evaluateAt=function(e){if(e===0)return this.getCoefficient(0);var r=this.coefficients,n;if(e===1){n=0;for(var a=0,s=r.length;a!==s;a++){var o=r[a];n=sb.addOrSubtract(n,o)}return n}n=r[0];for(var l=r.length,c=this.field,a=1;a<l;a++)n=sb.addOrSubtract(c.multiply(e,n),r[a]);return n},t.prototype.addOrSubtract=function(e){if(!this.field.equals(e.field))throw new Vn("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;var r=this.coefficients,n=e.coefficients;if(r.length>n.length){var a=r;r=n,n=a}var s=new Int32Array(n.length),o=n.length-r.length;Ms.arraycopy(n,0,s,0,o);for(var l=o;l<n.length;l++)s[l]=sb.addOrSubtract(r[l-o],n[l]);return new t(this.field,s)},t.prototype.multiply=function(e){if(!this.field.equals(e.field))throw new Vn("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();for(var r=this.coefficients,n=r.length,a=e.coefficients,s=a.length,o=new Int32Array(n+s-1),l=this.field,c=0;c<n;c++)for(var d=r[c],u=0;u<s;u++)o[c+u]=sb.addOrSubtract(o[c+u],l.multiply(d,a[u]));return new t(l,o)},t.prototype.multiplyScalar=function(e){if(e===0)return this.field.getZero();if(e===1)return this;for(var r=this.coefficients.length,n=this.field,a=new Int32Array(r),s=this.coefficients,o=0;o<r;o++)a[o]=n.multiply(s[o],e);return new t(n,a)},t.prototype.multiplyByMonomial=function(e,r){if(e<0)throw new Vn;if(r===0)return this.field.getZero();for(var n=this.coefficients,a=n.length,s=new Int32Array(a+e),o=this.field,l=0;l<a;l++)s[l]=o.multiply(n[l],r);return new t(o,s)},t.prototype.divide=function(e){if(!this.field.equals(e.field))throw new Vn("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new Vn("Divide by 0");for(var r=this.field,n=r.getZero(),a=this,s=e.getCoefficient(e.getDegree()),o=r.inverse(s);a.getDegree()>=e.getDegree()&&!a.isZero();){var l=a.getDegree()-e.getDegree(),c=r.multiply(a.getCoefficient(a.getDegree()),o),d=e.multiplyByMonomial(l,c),u=r.buildMonomial(l,c);n=n.addOrSubtract(u),a=a.addOrSubtract(d)}return[n,a]},t.prototype.toString=function(){for(var e="",r=this.getDegree();r>=0;r--){var n=this.getCoefficient(r);if(n!==0){if(n<0?(e+=" - ",n=-n):e.length>0&&(e+=" + "),r===0||n!==1){var a=this.field.log(n);a===0?e+="1":a===1?e+="a":(e+="a^",e+=a)}r!==0&&(r===1?e+="x":(e+="x^",e+=r))}}return e},t}(),vUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Dse=function(t){vUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ArithmeticException",e}(gd),yUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),od=function(t){yUe(e,t);function e(r,n,a){var s=t.call(this)||this;s.primitive=r,s.size=n,s.generatorBase=a;for(var o=new Int32Array(n),l=1,c=0;c<n;c++)o[c]=l,l*=2,l>=n&&(l^=r,l&=n-1);s.expTable=o;for(var d=new Int32Array(n),c=0;c<n-1;c++)d[o[c]]=c;return s.logTable=d,s.zero=new gm(s,Int32Array.from([0])),s.one=new gm(s,Int32Array.from([1])),s}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(r,n){if(r<0)throw new Vn;if(n===0)return this.zero;var a=new Int32Array(r+1);return a[0]=n,new gm(this,a)},e.prototype.inverse=function(r){if(r===0)throw new Dse;return this.expTable[this.size-this.logTable[r]-1]},e.prototype.multiply=function(r,n){return r===0||n===0?0:this.expTable[(this.logTable[r]+this.logTable[n])%(this.size-1)]},e.prototype.getSize=function(){return this.size},e.prototype.getGeneratorBase=function(){return this.generatorBase},e.prototype.toString=function(){return"GF(0x"+ba.toHexString(this.primitive)+","+this.size+")"},e.prototype.equals=function(r){return r===this},e.AZTEC_DATA_12=new e(4201,4096,1),e.AZTEC_DATA_10=new e(1033,1024,1),e.AZTEC_DATA_6=new e(67,64,1),e.AZTEC_PARAM=new e(19,16,1),e.QR_CODE_FIELD_256=new e(285,256,0),e.DATA_MATRIX_FIELD_256=new e(301,256,1),e.AZTEC_DATA_8=e.DATA_MATRIX_FIELD_256,e.MAXICODE_FIELD_64=e.AZTEC_DATA_6,e}(sb),bUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),h_=function(t){bUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ReedSolomonException",e}(gd),wUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Yw=function(t){wUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="IllegalStateException",e}(gd),SP=function(){function t(e){this.field=e}return t.prototype.decode=function(e,r){for(var n=this.field,a=new gm(n,e),s=new Int32Array(r),o=!0,l=0;l<r;l++){var c=a.evaluateAt(n.exp(l+n.getGeneratorBase()));s[s.length-1-l]=c,c!==0&&(o=!1)}if(!o)for(var d=new gm(n,s),u=this.runEuclideanAlgorithm(n.buildMonomial(r,1),d,r),f=u[0],A=u[1],h=this.findErrorLocations(f),m=this.findErrorMagnitudes(A,h),l=0;l<h.length;l++){var p=e.length-1-n.log(h[l]);if(p<0)throw new h_("Bad error location");e[p]=od.addOrSubtract(e[p],m[l])}},t.prototype.runEuclideanAlgorithm=function(e,r,n){if(e.getDegree()<r.getDegree()){var a=e;e=r,r=a}for(var s=this.field,o=e,l=r,c=s.getZero(),d=s.getOne();l.getDegree()>=(n/2|0);){var u=o,f=c;if(o=l,c=d,o.isZero())throw new h_("r_{i-1} was zero");l=u;for(var A=s.getZero(),h=o.getCoefficient(o.getDegree()),m=s.inverse(h);l.getDegree()>=o.getDegree()&&!l.isZero();){var p=l.getDegree()-o.getDegree(),x=s.multiply(l.getCoefficient(l.getDegree()),m);A=A.addOrSubtract(s.buildMonomial(p,x)),l=l.addOrSubtract(o.multiplyByMonomial(p,x))}if(d=A.multiply(c).addOrSubtract(f),l.getDegree()>=o.getDegree())throw new Yw("Division algorithm failed to reduce polynomial?")}var v=d.getCoefficient(0);if(v===0)throw new h_("sigmaTilde(0) was zero");var y=s.inverse(v),b=d.multiplyScalar(y),w=l.multiplyScalar(y);return[b,w]},t.prototype.findErrorLocations=function(e){var r=e.getDegree();if(r===1)return Int32Array.from([e.getCoefficient(1)]);for(var n=new Int32Array(r),a=0,s=this.field,o=1;o<s.getSize()&&a<r;o++)e.evaluateAt(o)===0&&(n[a]=s.inverse(o),a++);if(a!==r)throw new h_("Error locator degree does not match number of roots");return n},t.prototype.findErrorMagnitudes=function(e,r){for(var n=r.length,a=new Int32Array(n),s=this.field,o=0;o<n;o++){for(var l=s.inverse(r[o]),c=1,d=0;d<n;d++)if(o!==d){var u=s.multiply(r[d],l),f=u&1?u&-2:u|1;c=s.multiply(c,f)}a[o]=s.multiply(e.evaluateAt(l),s.inverse(c)),s.getGeneratorBase()!==0&&(a[o]=s.multiply(a[o],l))}return a},t}(),Pl;(function(t){t[t.UPPER=0]="UPPER",t[t.LOWER=1]="LOWER",t[t.MIXED=2]="MIXED",t[t.DIGIT=3]="DIGIT",t[t.PUNCT=4]="PUNCT",t[t.BINARY=5]="BINARY"})(Pl||(Pl={}));var V$=function(){function t(){}return t.prototype.decode=function(e){this.ddata=e;var r=e.getBits(),n=this.extractBits(r),a=this.correctBits(n),s=t.convertBoolArrayToByteArray(a),o=t.getEncodedData(a),l=new EP(s,o,null,null);return l.setNumBits(a.length),l},t.highLevelDecode=function(e){return this.getEncodedData(e)},t.getEncodedData=function(e){for(var r=e.length,n=Pl.UPPER,a=Pl.UPPER,s="",o=0;o<r;)if(a===Pl.BINARY){if(r-o<5)break;var l=t.readCode(e,o,5);if(o+=5,l===0){if(r-o<11)break;l=t.readCode(e,o,11)+31,o+=11}for(var c=0;c<l;c++){if(r-o<8){o=r;break}var d=t.readCode(e,o,8);s+=Oa.castAsNonUtf8Char(d),o+=8}a=n}else{var u=a===Pl.DIGIT?4:5;if(r-o<u)break;var d=t.readCode(e,o,u);o+=u;var f=t.getCharacter(a,d);f.startsWith("CTRL_")?(n=a,a=t.getTable(f.charAt(5)),f.charAt(6)==="L"&&(n=a)):(s+=f,a=n)}return s},t.getTable=function(e){switch(e){case"L":return Pl.LOWER;case"P":return Pl.PUNCT;case"M":return Pl.MIXED;case"D":return Pl.DIGIT;case"B":return Pl.BINARY;case"U":default:return Pl.UPPER}},t.getCharacter=function(e,r){switch(e){case Pl.UPPER:return t.UPPER_TABLE[r];case Pl.LOWER:return t.LOWER_TABLE[r];case Pl.MIXED:return t.MIXED_TABLE[r];case Pl.PUNCT:return t.PUNCT_TABLE[r];case Pl.DIGIT:return t.DIGIT_TABLE[r];default:throw new Yw("Bad table")}},t.prototype.correctBits=function(e){var r,n;this.ddata.getNbLayers()<=2?(n=6,r=od.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(n=8,r=od.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(n=10,r=od.AZTEC_DATA_10):(n=12,r=od.AZTEC_DATA_12);var a=this.ddata.getNbDatablocks(),s=e.length/n;if(s<a)throw new Zr;for(var o=e.length%n,l=new Int32Array(s),c=0;c<s;c++,o+=n)l[c]=t.readCode(e,o,n);try{var d=new SP(r);d.decode(l,s-a)}catch(x){throw new Zr(x)}for(var u=(1<<n)-1,f=0,c=0;c<a;c++){var A=l[c];if(A===0||A===u)throw new Zr;(A===1||A===u-1)&&f++}for(var h=new Array(a*n-f),m=0,c=0;c<a;c++){var A=l[c];if(A===1||A===u-1)h.fill(A>1,m,m+n-1),m+=n-1;else for(var p=n-1;p>=0;--p)h[m++]=(A&1<<p)!==0}return h},t.prototype.extractBits=function(e){var r=this.ddata.isCompact(),n=this.ddata.getNbLayers(),a=(r?11:14)+n*4,s=new Int32Array(a),o=new Array(this.totalBitsInLayer(n,r));if(r)for(var l=0;l<s.length;l++)s[l]=l;else for(var c=a+1+2*ba.truncDivision(ba.truncDivision(a,2)-1,15),d=a/2,u=ba.truncDivision(c,2),l=0;l<d;l++){var f=l+ba.truncDivision(l,15);s[d-l-1]=u-f-1,s[d+l]=u+f+1}for(var l=0,A=0;l<n;l++){for(var h=(n-l)*4+(r?9:12),m=l*2,p=a-1-m,x=0;x<h;x++)for(var v=x*2,y=0;y<2;y++)o[A+v+y]=e.get(s[m+y],s[m+x]),o[A+2*h+v+y]=e.get(s[m+x],s[p-y]),o[A+4*h+v+y]=e.get(s[p-y],s[p-x]),o[A+6*h+v+y]=e.get(s[p-x],s[m+y]);A+=h*8}return o},t.readCode=function(e,r,n){for(var a=0,s=r;s<r+n;s++)a<<=1,e[s]&&(a|=1);return a},t.readByte=function(e,r){var n=e.length-r;return n>=8?t.readCode(e,r,8):t.readCode(e,r,n)<<8-n},t.convertBoolArrayToByteArray=function(e){for(var r=new Uint8Array((e.length+7)/8),n=0;n<r.length;n++)r[n]=t.readByte(e,8*n);return r},t.prototype.totalBitsInLayer=function(e,r){return((r?88:112)+16*e)*e},t.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],t.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],t.MIXED_TABLE=["CTRL_PS"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~","","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],t.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],t.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"],t}(),Ga=function(){function t(){}return t.round=function(e){return isNaN(e)?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0},t.distance=function(e,r,n,a){var s=e-n,o=r-a;return Math.sqrt(s*s+o*o)},t.sum=function(e){for(var r=0,n=0,a=e.length;n!==a;n++){var s=e[n];r+=s}return r},t}(),yF=function(){function t(){}return t.floatToIntBits=function(e){return e},t.MAX_VALUE=Number.MAX_SAFE_INTEGER,t}(),Cn=function(){function t(e,r){this.x=e,this.y=r}return t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.equals=function(e){if(e instanceof t){var r=e;return this.x===r.x&&this.y===r.y}return!1},t.prototype.hashCode=function(){return 31*yF.floatToIntBits(this.x)+yF.floatToIntBits(this.y)},t.prototype.toString=function(){return"("+this.x+","+this.y+")"},t.orderBestPatterns=function(e){var r=this.distance(e[0],e[1]),n=this.distance(e[1],e[2]),a=this.distance(e[0],e[2]),s,o,l;if(n>=r&&n>=a?(o=e[0],s=e[1],l=e[2]):a>=n&&a>=r?(o=e[1],s=e[0],l=e[2]):(o=e[2],s=e[0],l=e[1]),this.crossProductZ(s,o,l)<0){var c=s;s=l,l=c}e[0]=s,e[1]=o,e[2]=l},t.distance=function(e,r){return Ga.distance(e.x,e.y,r.x,r.y)},t.crossProductZ=function(e,r,n){var a=r.x,s=r.y;return(n.x-a)*(e.y-s)-(n.y-s)*(e.x-a)},t}(),zR=function(){function t(e,r){this.bits=e,this.points=r}return t.prototype.getBits=function(){return this.bits},t.prototype.getPoints=function(){return this.points},t}(),NUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),CUe=function(t){NUe(e,t);function e(r,n,a,s,o){var l=t.call(this,r,n)||this;return l.compact=a,l.nbDatablocks=s,l.nbLayers=o,l}return e.prototype.getNbLayers=function(){return this.nbLayers},e.prototype.getNbDatablocks=function(){return this.nbDatablocks},e.prototype.isCompact=function(){return this.compact},e}(zR),bF=function(){function t(e,r,n,a){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),r==null&&(r=t.INIT_SIZE),n==null&&(n=e.getWidth()/2|0),a==null&&(a=e.getHeight()/2|0);var s=r/2|0;if(this.leftInit=n-s,this.rightInit=n+s,this.upInit=a-s,this.downInit=a+s,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new Ar}return t.prototype.detect=function(){for(var e=this.leftInit,r=this.rightInit,n=this.upInit,a=this.downInit,s=!1,o=!0,l=!1,c=!1,d=!1,u=!1,f=!1,A=this.width,h=this.height;o;){o=!1;for(var m=!0;(m||!c)&&r<A;)m=this.containsBlackPoint(n,a,r,!1),m?(r++,o=!0,c=!0):c||r++;if(r>=A){s=!0;break}for(var p=!0;(p||!d)&&a<h;)p=this.containsBlackPoint(e,r,a,!0),p?(a++,o=!0,d=!0):d||a++;if(a>=h){s=!0;break}for(var x=!0;(x||!u)&&e>=0;)x=this.containsBlackPoint(n,a,e,!1),x?(e--,o=!0,u=!0):u||e--;if(e<0){s=!0;break}for(var v=!0;(v||!f)&&n>=0;)v=this.containsBlackPoint(e,r,n,!0),v?(n--,o=!0,f=!0):f||n--;if(n<0){s=!0;break}o&&(l=!0)}if(!s&&l){for(var y=r-e,b=null,w=1;b===null&&w<y;w++)b=this.getBlackPointOnSegment(e,a-w,e+w,a);if(b==null)throw new Ar;for(var I=null,w=1;I===null&&w<y;w++)I=this.getBlackPointOnSegment(e,n+w,e+w,n);if(I==null)throw new Ar;for(var j=null,w=1;j===null&&w<y;w++)j=this.getBlackPointOnSegment(r,n+w,r-w,n);if(j==null)throw new Ar;for(var N=null,w=1;N===null&&w<y;w++)N=this.getBlackPointOnSegment(r,a-w,r-w,a);if(N==null)throw new Ar;return this.centerEdges(N,b,j,I)}else throw new Ar},t.prototype.getBlackPointOnSegment=function(e,r,n,a){for(var s=Ga.round(Ga.distance(e,r,n,a)),o=(n-e)/s,l=(a-r)/s,c=this.image,d=0;d<s;d++){var u=Ga.round(e+d*o),f=Ga.round(r+d*l);if(c.get(u,f))return new Cn(u,f)}return null},t.prototype.centerEdges=function(e,r,n,a){var s=e.getX(),o=e.getY(),l=r.getX(),c=r.getY(),d=n.getX(),u=n.getY(),f=a.getX(),A=a.getY(),h=t.CORR;return s<this.width/2?[new Cn(f-h,A+h),new Cn(l+h,c+h),new Cn(d-h,u-h),new Cn(s+h,o-h)]:[new Cn(f+h,A+h),new Cn(l+h,c-h),new Cn(d-h,u+h),new Cn(s-h,o-h)]},t.prototype.containsBlackPoint=function(e,r,n,a){var s=this.image;if(a){for(var o=e;o<=r;o++)if(s.get(o,n))return!0}else for(var l=e;l<=r;l++)if(s.get(n,l))return!0;return!1},t.INIT_SIZE=10,t.CORR=1,t}(),H$=function(){function t(){}return t.checkAndNudgePoints=function(e,r){for(var n=e.getWidth(),a=e.getHeight(),s=!0,o=0;o<r.length&&s;o+=2){var l=Math.floor(r[o]),c=Math.floor(r[o+1]);if(l<-1||l>n||c<-1||c>a)throw new Ar;s=!1,l===-1?(r[o]=0,s=!0):l===n&&(r[o]=n-1,s=!0),c===-1?(r[o+1]=0,s=!0):c===a&&(r[o+1]=a-1,s=!0)}s=!0;for(var o=r.length-2;o>=0&&s;o-=2){var l=Math.floor(r[o]),c=Math.floor(r[o+1]);if(l<-1||l>n||c<-1||c>a)throw new Ar;s=!1,l===-1?(r[o]=0,s=!0):l===n&&(r[o]=n-1,s=!0),c===-1?(r[o+1]=0,s=!0):c===a&&(r[o+1]=a-1,s=!0)}},t}(),Rse=function(){function t(e,r,n,a,s,o,l,c,d){this.a11=e,this.a21=r,this.a31=n,this.a12=a,this.a22=s,this.a32=o,this.a13=l,this.a23=c,this.a33=d}return t.quadrilateralToQuadrilateral=function(e,r,n,a,s,o,l,c,d,u,f,A,h,m,p,x){var v=t.quadrilateralToSquare(e,r,n,a,s,o,l,c),y=t.squareToQuadrilateral(d,u,f,A,h,m,p,x);return y.times(v)},t.prototype.transformPoints=function(e){for(var r=e.length,n=this.a11,a=this.a12,s=this.a13,o=this.a21,l=this.a22,c=this.a23,d=this.a31,u=this.a32,f=this.a33,A=0;A<r;A+=2){var h=e[A],m=e[A+1],p=s*h+c*m+f;e[A]=(n*h+o*m+d)/p,e[A+1]=(a*h+l*m+u)/p}},t.prototype.transformPointsWithValues=function(e,r){for(var n=this.a11,a=this.a12,s=this.a13,o=this.a21,l=this.a22,c=this.a23,d=this.a31,u=this.a32,f=this.a33,A=e.length,h=0;h<A;h++){var m=e[h],p=r[h],x=s*m+c*p+f;e[h]=(n*m+o*p+d)/x,r[h]=(a*m+l*p+u)/x}},t.squareToQuadrilateral=function(e,r,n,a,s,o,l,c){var d=e-n+s-l,u=r-a+o-c;if(d===0&&u===0)return new t(n-e,s-n,e,a-r,o-a,r,0,0,1);var f=n-s,A=l-s,h=a-o,m=c-o,p=f*m-A*h,x=(d*m-A*u)/p,v=(f*u-d*h)/p;return new t(n-e+x*n,l-e+v*l,e,a-r+x*a,c-r+v*c,r,x,v,1)},t.quadrilateralToSquare=function(e,r,n,a,s,o,l,c){return t.squareToQuadrilateral(e,r,n,a,s,o,l,c).buildAdjoint()},t.prototype.buildAdjoint=function(){return new t(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},t.prototype.times=function(e){return new t(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)},t}(),_Ue=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),EUe=function(t){_Ue(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.sampleGrid=function(r,n,a,s,o,l,c,d,u,f,A,h,m,p,x,v,y,b,w){var I=Rse.quadrilateralToQuadrilateral(s,o,l,c,d,u,f,A,h,m,p,x,v,y,b,w);return this.sampleGridWithTransform(r,n,a,I)},e.prototype.sampleGridWithTransform=function(r,n,a,s){if(n<=0||a<=0)throw new Ar;for(var o=new fh(n,a),l=new Float32Array(2*n),c=0;c<a;c++){for(var d=l.length,u=c+.5,f=0;f<d;f+=2)l[f]=f/2+.5,l[f+1]=u;s.transformPoints(l),H$.checkAndNudgePoints(r,l);try{for(var f=0;f<d;f+=2)r.get(Math.floor(l[f]),Math.floor(l[f+1]))&&o.set(f/2,c)}catch{throw new Ar}}return o},e}(H$),WR=function(){function t(){}return t.setGridSampler=function(e){t.gridSampler=e},t.getInstance=function(){return t.gridSampler},t.gridSampler=new EUe,t}(),ed=function(){function t(e,r){this.x=e,this.y=r}return t.prototype.toResultPoint=function(){return new Cn(this.getX(),this.getY())},t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t}(),SUe=function(){function t(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}return t.prototype.detect=function(){return this.detectMirror(!1)},t.prototype.detectMirror=function(e){var r=this.getMatrixCenter(),n=this.getBullsEyeCorners(r);if(e){var a=n[0];n[0]=n[2],n[2]=a}this.extractParameters(n);var s=this.sampleGrid(this.image,n[this.shift%4],n[(this.shift+1)%4],n[(this.shift+2)%4],n[(this.shift+3)%4]),o=this.getMatrixCornerPoints(n);return new CUe(s,o,this.compact,this.nbDataBlocks,this.nbLayers)},t.prototype.extractParameters=function(e){if(!this.isValidPoint(e[0])||!this.isValidPoint(e[1])||!this.isValidPoint(e[2])||!this.isValidPoint(e[3]))throw new Ar;var r=2*this.nbCenterLayers,n=new Int32Array([this.sampleLine(e[0],e[1],r),this.sampleLine(e[1],e[2],r),this.sampleLine(e[2],e[3],r),this.sampleLine(e[3],e[0],r)]);this.shift=this.getRotation(n,r);for(var a=0,s=0;s<4;s++){var o=n[(this.shift+s)%4];this.compact?(a<<=7,a+=o>>1&127):(a<<=10,a+=(o>>2&992)+(o>>1&31))}var l=this.getCorrectedParameterData(a,this.compact);this.compact?(this.nbLayers=(l>>6)+1,this.nbDataBlocks=(l&63)+1):(this.nbLayers=(l>>11)+1,this.nbDataBlocks=(l&2047)+1)},t.prototype.getRotation=function(e,r){var n=0;e.forEach(function(s,o,l){var c=(s>>r-2<<1)+(s&1);n=(n<<3)+c}),n=((n&1)<<11)+(n>>1);for(var a=0;a<4;a++)if(ba.bitCount(n^this.EXPECTED_CORNER_BITS[a])<=2)return a;throw new Ar},t.prototype.getCorrectedParameterData=function(e,r){var n,a;r?(n=7,a=2):(n=10,a=4);for(var s=n-a,o=new Int32Array(n),l=n-1;l>=0;--l)o[l]=e&15,e>>=4;try{var c=new SP(od.AZTEC_PARAM);c.decode(o,s)}catch{throw new Ar}for(var d=0,l=0;l<a;l++)d=(d<<4)+o[l];return d},t.prototype.getBullsEyeCorners=function(e){var r=e,n=e,a=e,s=e,o=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){var l=this.getFirstDifferent(r,o,1,-1),c=this.getFirstDifferent(n,o,1,1),d=this.getFirstDifferent(a,o,-1,1),u=this.getFirstDifferent(s,o,-1,-1);if(this.nbCenterLayers>2){var f=this.distancePoint(u,l)*this.nbCenterLayers/(this.distancePoint(s,r)*(this.nbCenterLayers+2));if(f<.75||f>1.25||!this.isWhiteOrBlackRectangle(l,c,d,u))break}r=l,n=c,a=d,s=u,o=!o}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new Ar;this.compact=this.nbCenterLayers===5;var A=new Cn(r.getX()+.5,r.getY()-.5),h=new Cn(n.getX()+.5,n.getY()+.5),m=new Cn(a.getX()-.5,a.getY()+.5),p=new Cn(s.getX()-.5,s.getY()-.5);return this.expandSquare([A,h,m,p],2*this.nbCenterLayers-3,2*this.nbCenterLayers)},t.prototype.getMatrixCenter=function(){var e,r,n,a;try{var s=new bF(this.image).detect();e=s[0],r=s[1],n=s[2],a=s[3]}catch{var o=this.image.getWidth()/2,l=this.image.getHeight()/2;e=this.getFirstDifferent(new ed(o+7,l-7),!1,1,-1).toResultPoint(),r=this.getFirstDifferent(new ed(o+7,l+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new ed(o-7,l+7),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new ed(o-7,l-7),!1,-1,-1).toResultPoint()}var c=Ga.round((e.getX()+a.getX()+r.getX()+n.getX())/4),d=Ga.round((e.getY()+a.getY()+r.getY()+n.getY())/4);try{var s=new bF(this.image,15,c,d).detect();e=s[0],r=s[1],n=s[2],a=s[3]}catch{e=this.getFirstDifferent(new ed(c+7,d-7),!1,1,-1).toResultPoint(),r=this.getFirstDifferent(new ed(c+7,d+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new ed(c-7,d+7),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new ed(c-7,d-7),!1,-1,-1).toResultPoint()}return c=Ga.round((e.getX()+a.getX()+r.getX()+n.getX())/4),d=Ga.round((e.getY()+a.getY()+r.getY()+n.getY())/4),new ed(c,d)},t.prototype.getMatrixCornerPoints=function(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())},t.prototype.sampleGrid=function(e,r,n,a,s){var o=WR.getInstance(),l=this.getDimension(),c=l/2-this.nbCenterLayers,d=l/2+this.nbCenterLayers;return o.sampleGrid(e,l,l,c,c,d,c,d,d,c,d,r.getX(),r.getY(),n.getX(),n.getY(),a.getX(),a.getY(),s.getX(),s.getY())},t.prototype.sampleLine=function(e,r,n){for(var a=0,s=this.distanceResultPoint(e,r),o=s/n,l=e.getX(),c=e.getY(),d=o*(r.getX()-e.getX())/s,u=o*(r.getY()-e.getY())/s,f=0;f<n;f++)this.image.get(Ga.round(l+f*d),Ga.round(c+f*u))&&(a|=1<<n-f-1);return a},t.prototype.isWhiteOrBlackRectangle=function(e,r,n,a){var s=3;e=new ed(e.getX()-s,e.getY()+s),r=new ed(r.getX()-s,r.getY()-s),n=new ed(n.getX()+s,n.getY()-s),a=new ed(a.getX()+s,a.getY()+s);var o=this.getColor(a,e);if(o===0)return!1;var l=this.getColor(e,r);return l!==o||(l=this.getColor(r,n),l!==o)?!1:(l=this.getColor(n,a),l===o)},t.prototype.getColor=function(e,r){for(var n=this.distancePoint(e,r),a=(r.getX()-e.getX())/n,s=(r.getY()-e.getY())/n,o=0,l=e.getX(),c=e.getY(),d=this.image.get(e.getX(),e.getY()),u=Math.ceil(n),f=0;f<u;f++)l+=a,c+=s,this.image.get(Ga.round(l),Ga.round(c))!==d&&o++;var A=o/n;return A>.1&&A<.9?0:A<=.1===d?1:-1},t.prototype.getFirstDifferent=function(e,r,n,a){for(var s=e.getX()+n,o=e.getY()+a;this.isValid(s,o)&&this.image.get(s,o)===r;)s+=n,o+=a;for(s-=n,o-=a;this.isValid(s,o)&&this.image.get(s,o)===r;)s+=n;for(s-=n;this.isValid(s,o)&&this.image.get(s,o)===r;)o+=a;return o-=a,new ed(s,o)},t.prototype.expandSquare=function(e,r,n){var a=n/(2*r),s=e[0].getX()-e[2].getX(),o=e[0].getY()-e[2].getY(),l=(e[0].getX()+e[2].getX())/2,c=(e[0].getY()+e[2].getY())/2,d=new Cn(l+a*s,c+a*o),u=new Cn(l-a*s,c-a*o);s=e[1].getX()-e[3].getX(),o=e[1].getY()-e[3].getY(),l=(e[1].getX()+e[3].getX())/2,c=(e[1].getY()+e[3].getY())/2;var f=new Cn(l+a*s,c+a*o),A=new Cn(l-a*s,c-a*o),h=[d,f,u,A];return h},t.prototype.isValid=function(e,r){return e>=0&&e<this.image.getWidth()&&r>0&&r<this.image.getHeight()},t.prototype.isValidPoint=function(e){var r=Ga.round(e.getX()),n=Ga.round(e.getY());return this.isValid(r,n)},t.prototype.distancePoint=function(e,r){return Ga.distance(e.getX(),e.getY(),r.getX(),r.getY())},t.prototype.distanceResultPoint=function(e,r){return Ga.distance(e.getX(),e.getY(),r.getX(),r.getY())},t.prototype.getDimension=function(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(ba.truncDivision(this.nbLayers-4,8)+1)+15},t}(),oj=function(){function t(){}return t.prototype.decode=function(e,r){r===void 0&&(r=null);var n=null,a=new SUe(e.getBlackMatrix()),s=null,o=null;try{var l=a.detectMirror(!1);s=l.getPoints(),this.reportFoundResultPoints(r,s),o=new V$().decode(l)}catch(f){n=f}if(o==null)try{var l=a.detectMirror(!0);s=l.getPoints(),this.reportFoundResultPoints(r,s),o=new V$().decode(l)}catch(f){throw n??f}var c=new Nc(o.getText(),o.getRawBytes(),o.getNumBits(),s,Qn.AZTEC,Ms.currentTimeMillis()),d=o.getByteSegments();d!=null&&c.putMetadata(Vl.BYTE_SEGMENTS,d);var u=o.getECLevel();return u!=null&&c.putMetadata(Vl.ERROR_CORRECTION_LEVEL,u),c},t.prototype.reportFoundResultPoints=function(e,r){if(e!=null){var n=e.get(Ls.NEED_RESULT_POINT_CALLBACK);n!=null&&r.forEach(function(a,s,o){n.foundPossibleResultPoint(a)})}},t.prototype.reset=function(){},t}(),jUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){jUe(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new oj,r)||this}return e})(P1);var Go=function(){function t(){}return t.prototype.decode=function(e,r){try{return this.doDecode(e,r)}catch{var n=r&&r.get(Ls.TRY_HARDER)===!0;if(n&&e.isRotateSupported()){var a=e.rotateCounterClockwise(),s=this.doDecode(a,r),o=s.getResultMetadata(),l=270;o!==null&&o.get(Vl.ORIENTATION)===!0&&(l=l+o.get(Vl.ORIENTATION)%360),s.putMetadata(Vl.ORIENTATION,l);var c=s.getResultPoints();if(c!==null)for(var d=a.getHeight(),u=0;u<c.length;u++)c[u]=new Cn(d-c[u].getY()-1,c[u].getX());return s}else throw new Ar}},t.prototype.reset=function(){},t.prototype.doDecode=function(e,r){var n=e.getWidth(),a=e.getHeight(),s=new Al(n),o=r&&r.get(Ls.TRY_HARDER)===!0,l=Math.max(1,a>>(o?8:5)),c;o?c=a:c=15;for(var d=Math.trunc(a/2),u=0;u<c;u++){var f=Math.trunc((u+1)/2),A=(u&1)===0,h=d+l*(A?f:-f);if(h<0||h>=a)break;try{s=e.getBlackRow(h,s)}catch{continue}for(var m=function(y){if(y===1&&(s.reverse(),r&&r.get(Ls.NEED_RESULT_POINT_CALLBACK)===!0)){var b=new Map;r.forEach(function(j,N){return b.set(N,j)}),b.delete(Ls.NEED_RESULT_POINT_CALLBACK),r=b}try{var w=p.decodeRow(h,s,r);if(y===1){w.putMetadata(Vl.ORIENTATION,180);var I=w.getResultPoints();I!==null&&(I[0]=new Cn(n-I[0].getX()-1,I[0].getY()),I[1]=new Cn(n-I[1].getX()-1,I[1].getY()))}return{value:w}}catch{}},p=this,x=0;x<2;x++){var v=m(x);if(typeof v=="object")return v.value}}throw new Ar},t.recordPattern=function(e,r,n){for(var a=n.length,s=0;s<a;s++)n[s]=0;var o=e.getSize();if(r>=o)throw new Ar;for(var l=!e.get(r),c=0,d=r;d<o;){if(e.get(d)!==l)n[c]++;else{if(++c===a)break;n[c]=1,l=!l}d++}if(!(c===a||c===a-1&&d===o))throw new Ar},t.recordPatternInReverse=function(e,r,n){for(var a=n.length,s=e.get(r);r>0&&a>=0;)e.get(--r)!==s&&(a--,s=!s);if(a>=0)throw new Ar;t.recordPattern(e,r+1,n)},t.patternMatchVariance=function(e,r,n){for(var a=e.length,s=0,o=0,l=0;l<a;l++)s+=e[l],o+=r[l];if(s<o)return Number.POSITIVE_INFINITY;var c=s/o;n*=c;for(var d=0,u=0;u<a;u++){var f=e[u],A=r[u]*c,h=f>A?f-A:A-f;if(h>n)return Number.POSITIVE_INFINITY;d+=h}return d/s},t}(),IUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),$$=function(t){IUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.findStartPattern=function(r){for(var n=r.getSize(),a=r.getNextSet(0),s=0,o=Int32Array.from([0,0,0,0,0,0]),l=a,c=!1,d=6,u=a;u<n;u++)if(r.get(u)!==c)o[s]++;else{if(s===d-1){for(var f=e.MAX_AVG_VARIANCE,A=-1,h=e.CODE_START_A;h<=e.CODE_START_C;h++){var m=Go.patternMatchVariance(o,e.CODE_PATTERNS[h],e.MAX_INDIVIDUAL_VARIANCE);m<f&&(f=m,A=h)}if(A>=0&&r.isRange(Math.max(0,l-(u-l)/2),l,!1))return Int32Array.from([l,u,A]);l+=o[0]+o[1],o=o.slice(2,o.length),o[s-1]=0,o[s]=0,s--}else s++;o[s]=1,c=!c}throw new Ar},e.decodeCode=function(r,n,a){Go.recordPattern(r,a,n);for(var s=e.MAX_AVG_VARIANCE,o=-1,l=0;l<e.CODE_PATTERNS.length;l++){var c=e.CODE_PATTERNS[l],d=this.patternMatchVariance(n,c,e.MAX_INDIVIDUAL_VARIANCE);d<s&&(s=d,o=l)}if(o>=0)return o;throw new Ar},e.prototype.decodeRow=function(r,n,a){var s=a&&a.get(Ls.ASSUME_GS1)===!0,o=e.findStartPattern(n),l=o[2],c=0,d=new Uint8Array(20);d[c++]=l;var u;switch(l){case e.CODE_START_A:u=e.CODE_CODE_A;break;case e.CODE_START_B:u=e.CODE_CODE_B;break;case e.CODE_START_C:u=e.CODE_CODE_C;break;default:throw new Zr}for(var f=!1,A=!1,h="",m=o[0],p=o[1],x=Int32Array.from([0,0,0,0,0,0]),v=0,y=0,b=l,w=0,I=!0,j=!1,N=!1;!f;){var S=A;switch(A=!1,v=y,y=e.decodeCode(n,x,p),d[c++]=y,y!==e.CODE_STOP&&(I=!0),y!==e.CODE_STOP&&(w++,b+=w*y),m=p,p+=x.reduce(function(le,he){return le+he},0),y){case e.CODE_START_A:case e.CODE_START_B:case e.CODE_START_C:throw new Zr}switch(u){case e.CODE_CODE_A:if(y<64)N===j?h+=String.fromCharCode(32+y):h+=String.fromCharCode(32+y+128),N=!1;else if(y<96)N===j?h+=String.fromCharCode(y-64):h+=String.fromCharCode(y+64),N=!1;else switch(y!==e.CODE_STOP&&(I=!1),y){case e.CODE_FNC_1:s&&(h.length===0?h+="]C1":h+="");break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_A:!j&&N?(j=!0,N=!1):j&&N?(j=!1,N=!1):N=!0;break;case e.CODE_SHIFT:A=!0,u=e.CODE_CODE_B;break;case e.CODE_CODE_B:u=e.CODE_CODE_B;break;case e.CODE_CODE_C:u=e.CODE_CODE_C;break;case e.CODE_STOP:f=!0;break}break;case e.CODE_CODE_B:if(y<96)N===j?h+=String.fromCharCode(32+y):h+=String.fromCharCode(32+y+128),N=!1;else switch(y!==e.CODE_STOP&&(I=!1),y){case e.CODE_FNC_1:s&&(h.length===0?h+="]C1":h+="");break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_B:!j&&N?(j=!0,N=!1):j&&N?(j=!1,N=!1):N=!0;break;case e.CODE_SHIFT:A=!0,u=e.CODE_CODE_A;break;case e.CODE_CODE_A:u=e.CODE_CODE_A;break;case e.CODE_CODE_C:u=e.CODE_CODE_C;break;case e.CODE_STOP:f=!0;break}break;case e.CODE_CODE_C:if(y<100)y<10&&(h+="0"),h+=y;else switch(y!==e.CODE_STOP&&(I=!1),y){case e.CODE_FNC_1:s&&(h.length===0?h+="]C1":h+="");break;case e.CODE_CODE_A:u=e.CODE_CODE_A;break;case e.CODE_CODE_B:u=e.CODE_CODE_B;break;case e.CODE_STOP:f=!0;break}break}S&&(u=u===e.CODE_CODE_A?e.CODE_CODE_B:e.CODE_CODE_A)}var E=p-m;if(p=n.getNextUnset(p),!n.isRange(p,Math.min(n.getSize(),p+(p-m)/2),!1))throw new Ar;if(b-=w*v,b%103!==v)throw new wo;var B=h.length;if(B===0)throw new Ar;B>0&&I&&(u===e.CODE_CODE_C?h=h.substring(0,B-2):h=h.substring(0,B-1));for(var k=(o[1]+o[0])/2,T=m+E/2,P=d.length,q=new Uint8Array(P),de=0;de<P;de++)q[de]=d[de];var ce=[new Cn(k,r),new Cn(T,r)];return new Nc(h,q,0,ce,Qn.CODE_128,new Date().getTime())},e.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],e.MAX_AVG_VARIANCE=.25,e.MAX_INDIVIDUAL_VARIANCE=.7,e.CODE_SHIFT=98,e.CODE_CODE_C=99,e.CODE_CODE_B=100,e.CODE_CODE_A=101,e.CODE_FNC_1=102,e.CODE_FNC_2=97,e.CODE_FNC_3=96,e.CODE_FNC_4_A=101,e.CODE_FNC_4_B=100,e.CODE_START_A=103,e.CODE_START_B=104,e.CODE_START_C=105,e.CODE_STOP=106,e}(Go),PUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Z5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},G$=function(t){PUe(e,t);function e(r,n){r===void 0&&(r=!1),n===void 0&&(n=!1);var a=t.call(this)||this;return a.usingCheckDigit=r,a.extendedMode=n,a.decodeRowResult="",a.counters=new Int32Array(9),a}return e.prototype.decodeRow=function(r,n,a){var s,o,l,c,d=this.counters;d.fill(0),this.decodeRowResult="";var u=e.findAsteriskPattern(n,d),f=n.getNextSet(u[1]),A=n.getSize(),h,m;do{e.recordPattern(n,f,d);var p=e.toNarrowWidePattern(d);if(p<0)throw new Ar;h=e.patternToChar(p),this.decodeRowResult+=h,m=f;try{for(var x=(s=void 0,Z5(d)),v=x.next();!v.done;v=x.next()){var y=v.value;f+=y}}catch(P){s={error:P}}finally{try{v&&!v.done&&(o=x.return)&&o.call(x)}finally{if(s)throw s.error}}f=n.getNextSet(f)}while(h!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var b=0;try{for(var w=Z5(d),I=w.next();!I.done;I=w.next()){var y=I.value;b+=y}}catch(P){l={error:P}}finally{try{I&&!I.done&&(c=w.return)&&c.call(w)}finally{if(l)throw l.error}}var j=f-m-b;if(f!==A&&j*2<b)throw new Ar;if(this.usingCheckDigit){for(var N=this.decodeRowResult.length-1,S=0,E=0;E<N;E++)S+=e.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(E));if(this.decodeRowResult.charAt(N)!==e.ALPHABET_STRING.charAt(S%43))throw new wo;this.decodeRowResult=this.decodeRowResult.substring(0,N)}if(this.decodeRowResult.length===0)throw new Ar;var B;this.extendedMode?B=e.decodeExtended(this.decodeRowResult):B=this.decodeRowResult;var k=(u[1]+u[0])/2,T=m+b/2;return new Nc(B,null,0,[new Cn(k,r),new Cn(T,r)],Qn.CODE_39,new Date().getTime())},e.findAsteriskPattern=function(r,n){for(var a=r.getSize(),s=r.getNextSet(0),o=0,l=s,c=!1,d=n.length,u=s;u<a;u++)if(r.get(u)!==c)n[o]++;else{if(o===d-1){if(this.toNarrowWidePattern(n)===e.ASTERISK_ENCODING&&r.isRange(Math.max(0,l-Math.floor((u-l)/2)),l,!1))return[l,u];l+=n[0]+n[1],n.copyWithin(0,2,2+o-1),n[o-1]=0,n[o]=0,o--}else o++;n[o]=1,c=!c}throw new Ar},e.toNarrowWidePattern=function(r){var n,a,s=r.length,o=0,l;do{var c=2147483647;try{for(var d=(n=void 0,Z5(r)),u=d.next();!u.done;u=d.next()){var f=u.value;f<c&&f>o&&(c=f)}}catch(p){n={error:p}}finally{try{u&&!u.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}o=c,l=0;for(var A=0,h=0,m=0;m<s;m++){var f=r[m];f>o&&(h|=1<<s-1-m,l++,A+=f)}if(l===3){for(var m=0;m<s&&l>0;m++){var f=r[m];if(f>o&&(l--,f*2>=A))return-1}return h}}while(l>3);return-1},e.patternToChar=function(r){for(var n=0;n<e.CHARACTER_ENCODINGS.length;n++)if(e.CHARACTER_ENCODINGS[n]===r)return e.ALPHABET_STRING.charAt(n);if(r===e.ASTERISK_ENCODING)return"*";throw new Ar},e.decodeExtended=function(r){for(var n=r.length,a="",s=0;s<n;s++){var o=r.charAt(s);if(o==="+"||o==="$"||o==="%"||o==="/"){var l=r.charAt(s+1),c="\0";switch(o){case"+":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)+32);else throw new Zr;break;case"$":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)-64);else throw new Zr;break;case"%":if(l>="A"&&l<="E")c=String.fromCharCode(l.charCodeAt(0)-38);else if(l>="F"&&l<="J")c=String.fromCharCode(l.charCodeAt(0)-11);else if(l>="K"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)+16);else if(l>="P"&&l<="T")c=String.fromCharCode(l.charCodeAt(0)+43);else if(l==="U")c="\0";else if(l==="V")c="@";else if(l==="W")c="`";else if(l==="X"||l==="Y"||l==="Z")c="";else throw new Zr;break;case"/":if(l>="A"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)-32);else if(l==="Z")c=":";else throw new Zr;break}a+=c,s++}else a+=o}return a},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",e.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],e.ASTERISK_ENCODING=148,e}(Go),TUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),eT=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},K$=function(t){TUe(e,t);function e(){var r=t.call(this)||this;return r.decodeRowResult="",r.counters=new Int32Array(6),r}return e.prototype.decodeRow=function(r,n,a){var s,o,l,c,d=this.findAsteriskPattern(n),u=n.getNextSet(d[1]),f=n.getSize(),A=this.counters;A.fill(0),this.decodeRowResult="";var h,m;do{e.recordPattern(n,u,A);var p=this.toPattern(A);if(p<0)throw new Ar;h=this.patternToChar(p),this.decodeRowResult+=h,m=u;try{for(var x=(s=void 0,eT(A)),v=x.next();!v.done;v=x.next()){var y=v.value;u+=y}}catch(E){s={error:E}}finally{try{v&&!v.done&&(o=x.return)&&o.call(x)}finally{if(s)throw s.error}}u=n.getNextSet(u)}while(h!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var b=0;try{for(var w=eT(A),I=w.next();!I.done;I=w.next()){var y=I.value;b+=y}}catch(E){l={error:E}}finally{try{I&&!I.done&&(c=w.return)&&c.call(w)}finally{if(l)throw l.error}}if(u===f||!n.get(u))throw new Ar;if(this.decodeRowResult.length<2)throw new Ar;this.checkChecksums(this.decodeRowResult),this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-2);var j=this.decodeExtended(this.decodeRowResult),N=(d[1]+d[0])/2,S=m+b/2;return new Nc(j,null,0,[new Cn(N,r),new Cn(S,r)],Qn.CODE_93,new Date().getTime())},e.prototype.findAsteriskPattern=function(r){var n=r.getSize(),a=r.getNextSet(0);this.counters.fill(0);for(var s=this.counters,o=a,l=!1,c=s.length,d=0,u=a;u<n;u++)if(r.get(u)!==l)s[d]++;else{if(d===c-1){if(this.toPattern(s)===e.ASTERISK_ENCODING)return new Int32Array([o,u]);o+=s[0]+s[1],s.copyWithin(0,2,2+d-1),s[d-1]=0,s[d]=0,d--}else d++;s[d]=1,l=!l}throw new Ar},e.prototype.toPattern=function(r){var n,a,s=0;try{for(var o=eT(r),l=o.next();!l.done;l=o.next()){var c=l.value;s+=c}}catch(m){n={error:m}}finally{try{l&&!l.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}for(var d=0,u=r.length,f=0;f<u;f++){var A=Math.round(r[f]*9/s);if(A<1||A>4)return-1;if(f&1)d<<=A;else for(var h=0;h<A;h++)d=d<<1|1}return d},e.prototype.patternToChar=function(r){for(var n=0;n<e.CHARACTER_ENCODINGS.length;n++)if(e.CHARACTER_ENCODINGS[n]===r)return e.ALPHABET_STRING.charAt(n);throw new Ar},e.prototype.decodeExtended=function(r){for(var n=r.length,a="",s=0;s<n;s++){var o=r.charAt(s);if(o>="a"&&o<="d"){if(s>=n-1)throw new Zr;var l=r.charAt(s+1),c="\0";switch(o){case"d":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)+32);else throw new Zr;break;case"a":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)-64);else throw new Zr;break;case"b":if(l>="A"&&l<="E")c=String.fromCharCode(l.charCodeAt(0)-38);else if(l>="F"&&l<="J")c=String.fromCharCode(l.charCodeAt(0)-11);else if(l>="K"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)+16);else if(l>="P"&&l<="T")c=String.fromCharCode(l.charCodeAt(0)+43);else if(l==="U")c="\0";else if(l==="V")c="@";else if(l==="W")c="`";else if(l>="X"&&l<="Z")c="";else throw new Zr;break;case"c":if(l>="A"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)-32);else if(l==="Z")c=":";else throw new Zr;break}a+=c,s++}else a+=o}return a},e.prototype.checkChecksums=function(r){var n=r.length;this.checkOneChecksum(r,n-2,20),this.checkOneChecksum(r,n-1,15)},e.prototype.checkOneChecksum=function(r,n,a){for(var s=1,o=0,l=n-1;l>=0;l--)o+=s*e.ALPHABET_STRING.indexOf(r.charAt(l)),++s>a&&(s=1);if(r.charAt(n)!==e.ALPHABET_STRING[o%47])throw new wo},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%abcd*",e.CHARACTER_ENCODINGS=[276,328,324,322,296,292,290,336,274,266,424,420,418,404,402,394,360,356,354,308,282,344,332,326,300,278,436,434,428,422,406,410,364,358,310,314,302,468,466,458,366,374,430,294,474,470,306,350],e.ASTERISK_ENCODING=e.CHARACTER_ENCODINGS[47],e}(Go),BUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),kUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},q$=function(t){BUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.narrowLineWidth=-1,r}return e.prototype.decodeRow=function(r,n,a){var s,o,l=this.decodeStart(n),c=this.decodeEnd(n),d=new ga;e.decodeMiddle(n,l[1],c[0],d);var u=d.toString(),f=null;a!=null&&(f=a.get(Ls.ALLOWED_LENGTHS)),f==null&&(f=e.DEFAULT_ALLOWED_LENGTHS);var A=u.length,h=!1,m=0;try{for(var p=kUe(f),x=p.next();!x.done;x=p.next()){var v=x.value;if(A===v){h=!0;break}v>m&&(m=v)}}catch(w){s={error:w}}finally{try{x&&!x.done&&(o=p.return)&&o.call(p)}finally{if(s)throw s.error}}if(!h&&A>m&&(h=!0),!h)throw new Zr;var y=[new Cn(l[1],r),new Cn(c[0],r)],b=new Nc(u,null,0,y,Qn.ITF,new Date().getTime());return b},e.decodeMiddle=function(r,n,a,s){var o=new Int32Array(10),l=new Int32Array(5),c=new Int32Array(5);for(o.fill(0),l.fill(0),c.fill(0);n<a;){Go.recordPattern(r,n,o);for(var d=0;d<5;d++){var u=2*d;l[d]=o[u],c[d]=o[u+1]}var f=e.decodeDigit(l);s.append(f.toString()),f=this.decodeDigit(c),s.append(f.toString()),o.forEach(function(A){n+=A})}},e.prototype.decodeStart=function(r){var n=e.skipWhiteSpace(r),a=e.findGuardPattern(r,n,e.START_PATTERN);return this.narrowLineWidth=(a[1]-a[0])/4,this.validateQuietZone(r,a[0]),a},e.prototype.validateQuietZone=function(r,n){var a=this.narrowLineWidth*10;a=a<n?a:n;for(var s=n-1;a>0&&s>=0&&!r.get(s);s--)a--;if(a!==0)throw new Ar},e.skipWhiteSpace=function(r){var n=r.getSize(),a=r.getNextSet(0);if(a===n)throw new Ar;return a},e.prototype.decodeEnd=function(r){r.reverse();try{var n=e.skipWhiteSpace(r),a=void 0;try{a=e.findGuardPattern(r,n,e.END_PATTERN_REVERSED[0])}catch(o){o instanceof Ar&&(a=e.findGuardPattern(r,n,e.END_PATTERN_REVERSED[1]))}this.validateQuietZone(r,a[0]);var s=a[0];return a[0]=r.getSize()-a[1],a[1]=r.getSize()-s,a}finally{r.reverse()}},e.findGuardPattern=function(r,n,a){var s=a.length,o=new Int32Array(s),l=r.getSize(),c=!1,d=0,u=n;o.fill(0);for(var f=n;f<l;f++)if(r.get(f)!==c)o[d]++;else{if(d===s-1){if(Go.patternMatchVariance(o,a,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return[u,f];u+=o[0]+o[1],Ms.arraycopy(o,2,o,0,d-1),o[d-1]=0,o[d]=0,d--}else d++;o[d]=1,c=!c}throw new Ar},e.decodeDigit=function(r){for(var n=e.MAX_AVG_VARIANCE,a=-1,s=e.PATTERNS.length,o=0;o<s;o++){var l=e.PATTERNS[o],c=Go.patternMatchVariance(r,l,e.MAX_INDIVIDUAL_VARIANCE);c<n?(n=c,a=o):c===n&&(a=-1)}if(a>=0)return a%10;throw new Ar},e.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],e.MAX_AVG_VARIANCE=.38,e.MAX_INDIVIDUAL_VARIANCE=.5,e.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],e.START_PATTERN=Int32Array.from([1,1,1,1]),e.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])],e}(Go),FUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Wv=function(t){FUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.decodeRowStringBuffer="",r}return e.findStartGuardPattern=function(r){for(var n=!1,a,s=0,o=Int32Array.from([0,0,0]);!n;){o=Int32Array.from([0,0,0]),a=e.findGuardPattern(r,s,!1,this.START_END_PATTERN,o);var l=a[0];s=a[1];var c=l-(s-l);c>=0&&(n=r.isRange(c,l,!1))}return a},e.checkChecksum=function(r){return e.checkStandardUPCEANChecksum(r)},e.checkStandardUPCEANChecksum=function(r){var n=r.length;if(n===0)return!1;var a=parseInt(r.charAt(n-1),10);return e.getStandardUPCEANChecksum(r.substring(0,n-1))===a},e.getStandardUPCEANChecksum=function(r){for(var n=r.length,a=0,s=n-1;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new Zr;a+=o}a*=3;for(var s=n-2;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new Zr;a+=o}return(1e3-a)%10},e.decodeEnd=function(r,n){return e.findGuardPattern(r,n,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e.findGuardPatternWithoutCounters=function(r,n,a,s){return this.findGuardPattern(r,n,a,s,new Int32Array(s.length))},e.findGuardPattern=function(r,n,a,s,o){var l=r.getSize();n=a?r.getNextUnset(n):r.getNextSet(n);for(var c=0,d=n,u=s.length,f=a,A=n;A<l;A++)if(r.get(A)!==f)o[c]++;else{if(c===u-1){if(Go.patternMatchVariance(o,s,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return Int32Array.from([d,A]);d+=o[0]+o[1];for(var h=o.slice(2,o.length),m=0;m<c-1;m++)o[m]=h[m];o[c-1]=0,o[c]=0,c--}else c++;o[c]=1,f=!f}throw new Ar},e.decodeDigit=function(r,n,a,s){this.recordPattern(r,a,n);for(var o=this.MAX_AVG_VARIANCE,l=-1,c=s.length,d=0;d<c;d++){var u=s[d],f=Go.patternMatchVariance(n,u,e.MAX_INDIVIDUAL_VARIANCE);f<o&&(o=f,l=d)}if(l>=0)return l;throw new Ar},e.MAX_AVG_VARIANCE=.48,e.MAX_INDIVIDUAL_VARIANCE=.7,e.START_END_PATTERN=Int32Array.from([1,1,1]),e.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),e.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])],e}(Go),OUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},DUe=function(){function t(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return t.prototype.decodeRow=function(e,r,n){var a=this.decodeRowStringBuffer,s=this.decodeMiddle(r,n,a),o=a.toString(),l=t.parseExtensionString(o),c=[new Cn((n[0]+n[1])/2,e),new Cn(s,e)],d=new Nc(o,null,0,c,Qn.UPC_EAN_EXTENSION,new Date().getTime());return l!=null&&d.putAllMetadata(l),d},t.prototype.decodeMiddle=function(e,r,n){var a,s,o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var l=e.getSize(),c=r[1],d=0,u=0;u<5&&c<l;u++){var f=Wv.decodeDigit(e,o,c,Wv.L_AND_G_PATTERNS);n+=String.fromCharCode(48+f%10);try{for(var A=(a=void 0,OUe(o)),h=A.next();!h.done;h=A.next()){var m=h.value;c+=m}}catch(x){a={error:x}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}f>=10&&(d|=1<<4-u),u!==4&&(c=e.getNextSet(c),c=e.getNextUnset(c))}if(n.length!==5)throw new Ar;var p=this.determineCheckDigit(d);if(t.extensionChecksum(n.toString())!==p)throw new Ar;return c},t.extensionChecksum=function(e){for(var r=e.length,n=0,a=r-2;a>=0;a-=2)n+=e.charAt(a).charCodeAt(0)-48;n*=3;for(var a=r-1;a>=0;a-=2)n+=e.charAt(a).charCodeAt(0)-48;return n*=3,n%10},t.prototype.determineCheckDigit=function(e){for(var r=0;r<10;r++)if(e===this.CHECK_DIGIT_ENCODINGS[r])return r;throw new Ar},t.parseExtensionString=function(e){if(e.length!==5)return null;var r=t.parseExtension5String(e);return r==null?null:new Map([[Vl.SUGGESTED_PRICE,r]])},t.parseExtension5String=function(e){var r;switch(e.charAt(0)){case"0":r="";break;case"5":r="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}r="";break;default:r="";break}var n=parseInt(e.substring(1)),a=(n/100).toString(),s=n%100,o=s<10?"0"+s:s.toString();return r+a+"."+o},t}(),RUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},MUe=function(){function t(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return t.prototype.decodeRow=function(e,r,n){var a=this.decodeRowStringBuffer,s=this.decodeMiddle(r,n,a),o=a.toString(),l=t.parseExtensionString(o),c=[new Cn((n[0]+n[1])/2,e),new Cn(s,e)],d=new Nc(o,null,0,c,Qn.UPC_EAN_EXTENSION,new Date().getTime());return l!=null&&d.putAllMetadata(l),d},t.prototype.decodeMiddle=function(e,r,n){var a,s,o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var l=e.getSize(),c=r[1],d=0,u=0;u<2&&c<l;u++){var f=Wv.decodeDigit(e,o,c,Wv.L_AND_G_PATTERNS);n+=String.fromCharCode(48+f%10);try{for(var A=(a=void 0,RUe(o)),h=A.next();!h.done;h=A.next()){var m=h.value;c+=m}}catch(p){a={error:p}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}f>=10&&(d|=1<<1-u),u!==1&&(c=e.getNextSet(c),c=e.getNextUnset(c))}if(n.length!==2)throw new Ar;if(parseInt(n.toString())%4!==d)throw new Ar;return c},t.parseExtensionString=function(e){return e.length!==2?null:new Map([[Vl.ISSUE_NUMBER,parseInt(e)]])},t}(),LUe=function(){function t(){}return t.decodeRow=function(e,r,n){var a=Wv.findGuardPattern(r,n,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{var s=new DUe;return s.decodeRow(e,r,a)}catch{var o=new MUe;return o.decodeRow(e,r,a)}},t.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]),t}(),UUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ro=function(t){UUe(e,t);function e(){var r=t.call(this)||this;r.decodeRowStringBuffer="",e.L_AND_G_PATTERNS=e.L_PATTERNS.map(function(l){return Int32Array.from(l)});for(var n=10;n<20;n++){for(var a=e.L_PATTERNS[n-10],s=new Int32Array(a.length),o=0;o<a.length;o++)s[o]=a[a.length-o-1];e.L_AND_G_PATTERNS[n]=s}return r}return e.prototype.decodeRow=function(r,n,a){var s=e.findStartGuardPattern(n),o=a==null?null:a.get(Ls.NEED_RESULT_POINT_CALLBACK);if(o!=null){var l=new Cn((s[0]+s[1])/2,r);o.foundPossibleResultPoint(l)}var c=this.decodeMiddle(n,s,this.decodeRowStringBuffer),d=c.rowOffset,u=c.resultString;if(o!=null){var f=new Cn(d,r);o.foundPossibleResultPoint(f)}var A=e.decodeEnd(n,d);if(o!=null){var h=new Cn((A[0]+A[1])/2,r);o.foundPossibleResultPoint(h)}var m=A[1],p=m+(m-A[0]);if(p>=n.getSize()||!n.isRange(m,p,!1))throw new Ar;var x=u.toString();if(x.length<8)throw new Zr;if(!e.checkChecksum(x))throw new wo;var v=(s[1]+s[0])/2,y=(A[1]+A[0])/2,b=this.getBarcodeFormat(),w=[new Cn(v,r),new Cn(y,r)],I=new Nc(x,null,0,w,b,new Date().getTime()),j=0;try{var N=LUe.decodeRow(r,n,A[1]);I.putMetadata(Vl.UPC_EAN_EXTENSION,N.getText()),I.putAllMetadata(N.getResultMetadata()),I.addResultPoints(N.getResultPoints()),j=N.getText().length}catch{}var S=a==null?null:a.get(Ls.ALLOWED_EAN_EXTENSIONS);if(S!=null){var E=!1;for(var B in S)if(j.toString()===B){E=!0;break}if(!E)throw new Ar}return b===Qn.EAN_13||Qn.UPC_A,I},e.checkChecksum=function(r){return e.checkStandardUPCEANChecksum(r)},e.checkStandardUPCEANChecksum=function(r){var n=r.length;if(n===0)return!1;var a=parseInt(r.charAt(n-1),10);return e.getStandardUPCEANChecksum(r.substring(0,n-1))===a},e.getStandardUPCEANChecksum=function(r){for(var n=r.length,a=0,s=n-1;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new Zr;a+=o}a*=3;for(var s=n-2;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new Zr;a+=o}return(1e3-a)%10},e.decodeEnd=function(r,n){return e.findGuardPattern(r,n,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e}(Wv),QUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),z$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},wF=function(t){QUe(e,t);function e(){var r=t.call(this)||this;return r.decodeMiddleCounters=Int32Array.from([0,0,0,0]),r}return e.prototype.decodeMiddle=function(r,n,a){var s,o,l,c,d=this.decodeMiddleCounters;d[0]=0,d[1]=0,d[2]=0,d[3]=0;for(var u=r.getSize(),f=n[1],A=0,h=0;h<6&&f<u;h++){var m=Ro.decodeDigit(r,d,f,Ro.L_AND_G_PATTERNS);a+=String.fromCharCode(48+m%10);try{for(var p=(s=void 0,z$(d)),x=p.next();!x.done;x=p.next()){var v=x.value;f+=v}}catch(I){s={error:I}}finally{try{x&&!x.done&&(o=p.return)&&o.call(p)}finally{if(s)throw s.error}}m>=10&&(A|=1<<5-h)}a=e.determineFirstDigit(a,A);var y=Ro.findGuardPattern(r,f,!0,Ro.MIDDLE_PATTERN,new Int32Array(Ro.MIDDLE_PATTERN.length).fill(0));f=y[1];for(var h=0;h<6&&f<u;h++){var m=Ro.decodeDigit(r,d,f,Ro.L_PATTERNS);a+=String.fromCharCode(48+m);try{for(var b=(l=void 0,z$(d)),w=b.next();!w.done;w=b.next()){var v=w.value;f+=v}}catch(N){l={error:N}}finally{try{w&&!w.done&&(c=b.return)&&c.call(b)}finally{if(l)throw l.error}}}return{rowOffset:f,resultString:a}},e.prototype.getBarcodeFormat=function(){return Qn.EAN_13},e.determineFirstDigit=function(r,n){for(var a=0;a<10;a++)if(n===this.FIRST_DIGIT_ENCODINGS[a])return r=String.fromCharCode(48+a)+r,r;throw new Ar},e.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26],e}(Ro),VUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),W$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},X$=function(t){VUe(e,t);function e(){var r=t.call(this)||this;return r.decodeMiddleCounters=Int32Array.from([0,0,0,0]),r}return e.prototype.decodeMiddle=function(r,n,a){var s,o,l,c,d=this.decodeMiddleCounters;d[0]=0,d[1]=0,d[2]=0,d[3]=0;for(var u=r.getSize(),f=n[1],A=0;A<4&&f<u;A++){var h=Ro.decodeDigit(r,d,f,Ro.L_PATTERNS);a+=String.fromCharCode(48+h);try{for(var m=(s=void 0,W$(d)),p=m.next();!p.done;p=m.next()){var x=p.value;f+=x}}catch(w){s={error:w}}finally{try{p&&!p.done&&(o=m.return)&&o.call(m)}finally{if(s)throw s.error}}}var v=Ro.findGuardPattern(r,f,!0,Ro.MIDDLE_PATTERN,new Int32Array(Ro.MIDDLE_PATTERN.length).fill(0));f=v[1];for(var A=0;A<4&&f<u;A++){var h=Ro.decodeDigit(r,d,f,Ro.L_PATTERNS);a+=String.fromCharCode(48+h);try{for(var y=(l=void 0,W$(d)),b=y.next();!b.done;b=y.next()){var x=b.value;f+=x}}catch(j){l={error:j}}finally{try{b&&!b.done&&(c=y.return)&&c.call(y)}finally{if(l)throw l.error}}}return{rowOffset:f,resultString:a}},e.prototype.getBarcodeFormat=function(){return Qn.EAN_8},e}(Ro),HUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Y$=function(t){HUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.ean13Reader=new wF,r}return e.prototype.getBarcodeFormat=function(){return Qn.UPC_A},e.prototype.decode=function(r,n){return this.maybeReturnResult(this.ean13Reader.decode(r))},e.prototype.decodeRow=function(r,n,a){return this.maybeReturnResult(this.ean13Reader.decodeRow(r,n,a))},e.prototype.decodeMiddle=function(r,n,a){return this.ean13Reader.decodeMiddle(r,n,a)},e.prototype.maybeReturnResult=function(r){var n=r.getText();if(n.charAt(0)==="0"){var a=new Nc(n.substring(1),null,null,r.getResultPoints(),Qn.UPC_A);return r.getResultMetadata()!=null&&a.putAllMetadata(r.getResultMetadata()),a}else throw new Ar},e.prototype.reset=function(){this.ean13Reader.reset()},e}(Ro),$Ue=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),GUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},J$=function(t){$Ue(e,t);function e(){var r=t.call(this)||this;return r.decodeMiddleCounters=new Int32Array(4),r}return e.prototype.decodeMiddle=function(r,n,a){var s,o,l=this.decodeMiddleCounters.map(function(x){return x});l[0]=0,l[1]=0,l[2]=0,l[3]=0;for(var c=r.getSize(),d=n[1],u=0,f=0;f<6&&d<c;f++){var A=e.decodeDigit(r,l,d,e.L_AND_G_PATTERNS);a+=String.fromCharCode(48+A%10);try{for(var h=(s=void 0,GUe(l)),m=h.next();!m.done;m=h.next()){var p=m.value;d+=p}}catch(x){s={error:x}}finally{try{m&&!m.done&&(o=h.return)&&o.call(h)}finally{if(s)throw s.error}}A>=10&&(u|=1<<5-f)}return e.determineNumSysAndCheckDigit(new ga(a),u),d},e.prototype.decodeEnd=function(r,n){return e.findGuardPatternWithoutCounters(r,n,!0,e.MIDDLE_END_PATTERN)},e.prototype.checkChecksum=function(r){return Ro.checkChecksum(e.convertUPCEtoUPCA(r))},e.determineNumSysAndCheckDigit=function(r,n){for(var a=0;a<=1;a++)for(var s=0;s<10;s++)if(n===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[a][s]){r.insert(0,"0"+a),r.append("0"+s);return}throw Ar.getNotFoundInstance()},e.prototype.getBarcodeFormat=function(){return Qn.UPC_E},e.convertUPCEtoUPCA=function(r){var n=r.slice(1,7).split("").map(function(o){return o.charCodeAt(0)}),a=new ga;a.append(r.charAt(0));var s=n[5];switch(s){case 0:case 1:case 2:a.appendChars(n,0,2),a.append(s),a.append("0000"),a.appendChars(n,2,3);break;case 3:a.appendChars(n,0,3),a.append("00000"),a.appendChars(n,3,2);break;case 4:a.appendChars(n,0,4),a.append("00000"),a.append(n[4]);break;default:a.appendChars(n,0,5),a.append("0000"),a.append(s);break}return r.length>=8&&a.append(r.charAt(7)),a.toString()},e.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,1])],e}(Ro),KUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Z$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},tT=function(t){KUe(e,t);function e(r){var n=t.call(this)||this,a=r==null?null:r.get(Ls.POSSIBLE_FORMATS),s=[];return a!=null&&(a.indexOf(Qn.EAN_13)>-1&&s.push(new wF),a.indexOf(Qn.UPC_A)>-1&&s.push(new Y$),a.indexOf(Qn.EAN_8)>-1&&s.push(new X$),a.indexOf(Qn.UPC_E)>-1&&s.push(new J$)),s.length===0&&(s.push(new wF),s.push(new Y$),s.push(new X$),s.push(new J$)),n.readers=s,n}return e.prototype.decodeRow=function(r,n,a){var s,o;try{for(var l=Z$(this.readers),c=l.next();!c.done;c=l.next()){var d=c.value;try{var u=d.decodeRow(r,n,a),f=u.getBarcodeFormat()===Qn.EAN_13&&u.getText().charAt(0)==="0",A=a==null?null:a.get(Ls.POSSIBLE_FORMATS),h=A==null||A.includes(Qn.UPC_A);if(f&&h){var m=u.getRawBytes(),p=new Nc(u.getText().substring(1),m,m?m.length:null,u.getResultPoints(),Qn.UPC_A);return p.putAllMetadata(u.getResultMetadata()),p}return u}catch{}}}catch(x){s={error:x}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(s)throw s.error}}throw new Ar},e.prototype.reset=function(){var r,n;try{for(var a=Z$(this.readers),s=a.next();!s.done;s=a.next()){var o=s.value;o.reset()}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},e}(Go),qUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),zUe=function(t){qUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.CODA_BAR_CHAR_SET={nnnnnww:"0",nnnnwwn:"1",nnnwnnw:"2",wwnnnnn:"3",nnwnnwn:"4",wnnnnwn:"5",nwnnnnw:"6",nwnnwnn:"7",nwwnnnn:"8",wnnwnnn:"9",nnnwwnn:"-",nnwwnnn:"$",wnnnwnw:":",wnwnnnw:"/",wnwnwnn:".",nnwwwww:"+",nnwwnwn:"A",nwnwnnw:"B",nnnwnww:"C",nnnwwwn:"D"},r}return e.prototype.decodeRow=function(r,n,a){var s=this.getValidRowData(n);if(!s)throw new Ar;var o=this.codaBarDecodeRow(s.row);if(!o)throw new Ar;return new Nc(o,null,0,[new Cn(s.left,r),new Cn(s.right,r)],Qn.CODABAR,new Date().getTime())},e.prototype.getValidRowData=function(r){var n=r.toArray(),a=n.indexOf(!0);if(a===-1)return null;var s=n.lastIndexOf(!0);if(s<=a)return null;n=n.slice(a,s+1);for(var o=[],l=n[0],c=1,d=1;d<n.length;d++)n[d]===l?c++:(l=n[d],o.push(c),c=1);return o.push(c),o.length<23&&(o.length+1)%8!==0?null:{row:o,left:a,right:s}},e.prototype.codaBarDecodeRow=function(r){for(var n=[],a=Math.ceil(r.reduce(function(c,d){return(c+d)/2},0));r.length>0;){var s=r.splice(0,8).splice(0,7),o=s.map(function(c){return c<a?"n":"w"}).join("");if(this.CODA_BAR_CHAR_SET[o]===void 0)return null;n.push(this.CODA_BAR_CHAR_SET[o])}var l=n.join("");return this.validCodaBarString(l)?l:null},e.prototype.validCodaBarString=function(r){var n=/^[A-D].{1,}[A-D]$/;return n.test(r)},e}(Go),WUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),XUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},pp=function(t){WUe(e,t);function e(){var r=t.call(this)||this;return r.decodeFinderCounters=new Int32Array(4),r.dataCharacterCounters=new Int32Array(8),r.oddRoundingErrors=new Array(4),r.evenRoundingErrors=new Array(4),r.oddCounts=new Array(r.dataCharacterCounters.length/2),r.evenCounts=new Array(r.dataCharacterCounters.length/2),r}return e.prototype.getDecodeFinderCounters=function(){return this.decodeFinderCounters},e.prototype.getDataCharacterCounters=function(){return this.dataCharacterCounters},e.prototype.getOddRoundingErrors=function(){return this.oddRoundingErrors},e.prototype.getEvenRoundingErrors=function(){return this.evenRoundingErrors},e.prototype.getOddCounts=function(){return this.oddCounts},e.prototype.getEvenCounts=function(){return this.evenCounts},e.prototype.parseFinderValue=function(r,n){for(var a=0;a<n.length;a++)if(Go.patternMatchVariance(r,n[a],e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return a;throw new Ar},e.count=function(r){return Ga.sum(new Int32Array(r))},e.increment=function(r,n){for(var a=0,s=n[0],o=1;o<r.length;o++)n[o]>s&&(s=n[o],a=o);r[a]++},e.decrement=function(r,n){for(var a=0,s=n[0],o=1;o<r.length;o++)n[o]<s&&(s=n[o],a=o);r[a]--},e.isFinderPattern=function(r){var n,a,s=r[0]+r[1],o=s+r[2]+r[3],l=s/o;if(l>=e.MIN_FINDER_PATTERN_RATIO&&l<=e.MAX_FINDER_PATTERN_RATIO){var c=Number.MAX_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER;try{for(var u=XUe(r),f=u.next();!f.done;f=u.next()){var A=f.value;A>d&&(d=A),A<c&&(c=A)}}catch(h){n={error:h}}finally{try{f&&!f.done&&(a=u.return)&&a.call(u)}finally{if(n)throw n.error}}return d<10*c}return!1},e.MAX_AVG_VARIANCE=.2,e.MAX_INDIVIDUAL_VARIANCE=.45,e.MIN_FINDER_PATTERN_RATIO=9.5/12,e.MAX_FINDER_PATTERN_RATIO=12.5/14,e}(Go),lj=function(){function t(e,r){this.value=e,this.checksumPortion=r}return t.prototype.getValue=function(){return this.value},t.prototype.getChecksumPortion=function(){return this.checksumPortion},t.prototype.toString=function(){return this.value+"("+this.checksumPortion+")"},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value&&this.checksumPortion===r.checksumPortion},t.prototype.hashCode=function(){return this.value^this.checksumPortion},t}(),Mse=function(){function t(e,r,n,a,s){this.value=e,this.startEnd=r,this.value=e,this.startEnd=r,this.resultPoints=new Array,this.resultPoints.push(new Cn(n,s)),this.resultPoints.push(new Cn(a,s))}return t.prototype.getValue=function(){return this.value},t.prototype.getStartEnd=function(){return this.startEnd},t.prototype.getResultPoints=function(){return this.resultPoints},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value},t.prototype.hashCode=function(){return this.value},t}(),YUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},tv=function(){function t(){}return t.getRSSvalue=function(e,r,n){var a,s,o=0;try{for(var l=YUe(e),c=l.next();!c.done;c=l.next()){var d=c.value;o+=d}}catch(y){a={error:y}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}for(var u=0,f=0,A=e.length,h=0;h<A-1;h++){var m=void 0;for(m=1,f|=1<<h;m<e[h];m++,f&=~(1<<h)){var p=t.combins(o-m-1,A-h-2);if(n&&f===0&&o-m-(A-h-1)>=A-h-1&&(p-=t.combins(o-m-(A-h),A-h-2)),A-h-1>1){for(var x=0,v=o-m-(A-h-2);v>r;v--)x+=t.combins(o-m-v-1,A-h-3);p-=x*(A-1-h)}else o-m>r&&p--;u+=p}o-=m}return u},t.combins=function(e,r){var n,a;e-r>r?(a=r,n=e-r):(a=e-r,n=r);for(var s=1,o=1,l=e;l>n;l--)s*=l,o<=a&&(s/=o,o++);for(;o<=a;)s/=o,o++;return s},t}(),JUe=function(){function t(){}return t.buildBitArray=function(e){var r=e.length*2-1;e[e.length-1].getRightChar()==null&&(r-=1);for(var n=12*r,a=new Al(n),s=0,o=e[0],l=o.getRightChar().getValue(),c=11;c>=0;--c)l&1<<c&&a.set(s),s++;for(var c=1;c<e.length;++c){for(var d=e[c],u=d.getLeftChar().getValue(),f=11;f>=0;--f)u&1<<f&&a.set(s),s++;if(d.getRightChar()!==null)for(var A=d.getRightChar().getValue(),f=11;f>=0;--f)A&1<<f&&a.set(s),s++}return a},t}(),ap=function(){function t(e,r){r?this.decodedInformation=null:(this.finished=e,this.decodedInformation=r)}return t.prototype.getDecodedInformation=function(){return this.decodedInformation},t.prototype.isFinished=function(){return this.finished},t}(),XR=function(){function t(e){this.newPosition=e}return t.prototype.getNewPosition=function(){return this.newPosition},t}(),ZUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),af=function(t){ZUe(e,t);function e(r,n){var a=t.call(this,r)||this;return a.value=n,a}return e.prototype.getValue=function(){return this.value},e.prototype.isFNC1=function(){return this.value===e.FNC1},e.FNC1="$",e}(XR),e7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),sp=function(t){e7e(e,t);function e(r,n,a){var s=t.call(this,r)||this;return a?(s.remaining=!0,s.remainingValue=s.remainingValue):(s.remaining=!1,s.remainingValue=0),s.newString=n,s}return e.prototype.getNewString=function(){return this.newString},e.prototype.isRemaining=function(){return this.remaining},e.prototype.getRemainingValue=function(){return this.remainingValue},e}(XR),t7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Nx=function(t){t7e(e,t);function e(r,n,a){var s=t.call(this,r)||this;if(n<0||n>10||a<0||a>10)throw new Zr;return s.firstDigit=n,s.secondDigit=a,s}return e.prototype.getFirstDigit=function(){return this.firstDigit},e.prototype.getSecondDigit=function(){return this.secondDigit},e.prototype.getValue=function(){return this.firstDigit*10+this.secondDigit},e.prototype.isFirstDigitFNC1=function(){return this.firstDigit===e.FNC1},e.prototype.isSecondDigitFNC1=function(){return this.secondDigit===e.FNC1},e.prototype.isAnyFNC1=function(){return this.firstDigit===e.FNC1||this.secondDigit===e.FNC1},e.FNC1=10,e}(XR),A_=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},r7e=function(){function t(){}return t.parseFieldsInGeneralPurpose=function(e){var r,n,a,s,o,l,c,d;if(!e)return null;if(e.length<2)throw new Ar;var u=e.substring(0,2);try{for(var f=A_(t.TWO_DIGIT_DATA_LENGTH),A=f.next();!A.done;A=f.next()){var h=A.value;if(h[0]===u)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(2,h[2],e):t.processFixedAI(2,h[1],e)}}catch(j){r={error:j}}finally{try{A&&!A.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}if(e.length<3)throw new Ar;var m=e.substring(0,3);try{for(var p=A_(t.THREE_DIGIT_DATA_LENGTH),x=p.next();!x.done;x=p.next()){var h=x.value;if(h[0]===m)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(3,h[2],e):t.processFixedAI(3,h[1],e)}}catch(j){a={error:j}}finally{try{x&&!x.done&&(s=p.return)&&s.call(p)}finally{if(a)throw a.error}}try{for(var v=A_(t.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH),y=v.next();!y.done;y=v.next()){var h=y.value;if(h[0]===m)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(4,h[2],e):t.processFixedAI(4,h[1],e)}}catch(j){o={error:j}}finally{try{y&&!y.done&&(l=v.return)&&l.call(v)}finally{if(o)throw o.error}}if(e.length<4)throw new Ar;var b=e.substring(0,4);try{for(var w=A_(t.FOUR_DIGIT_DATA_LENGTH),I=w.next();!I.done;I=w.next()){var h=I.value;if(h[0]===b)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(4,h[2],e):t.processFixedAI(4,h[1],e)}}catch(j){c={error:j}}finally{try{I&&!I.done&&(d=w.return)&&d.call(w)}finally{if(c)throw c.error}}throw new Ar},t.processFixedAI=function(e,r,n){if(n.length<e)throw new Ar;var a=n.substring(0,e);if(n.length<e+r)throw new Ar;var s=n.substring(e,e+r),o=n.substring(e+r),l="("+a+")"+s,c=t.parseFieldsInGeneralPurpose(o);return c==null?l:l+c},t.processVariableAI=function(e,r,n){var a=n.substring(0,e),s;n.length<e+r?s=n.length:s=e+r;var o=n.substring(e,s),l=n.substring(s),c="("+a+")"+o,d=t.parseFieldsInGeneralPurpose(l);return d==null?c:c+d},t.VARIABLE_LENGTH=[],t.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",t.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",t.VARIABLE_LENGTH,20],["22",t.VARIABLE_LENGTH,29],["30",t.VARIABLE_LENGTH,8],["37",t.VARIABLE_LENGTH,8],["90",t.VARIABLE_LENGTH,30],["91",t.VARIABLE_LENGTH,30],["92",t.VARIABLE_LENGTH,30],["93",t.VARIABLE_LENGTH,30],["94",t.VARIABLE_LENGTH,30],["95",t.VARIABLE_LENGTH,30],["96",t.VARIABLE_LENGTH,30],["97",t.VARIABLE_LENGTH,3],["98",t.VARIABLE_LENGTH,30],["99",t.VARIABLE_LENGTH,30]],t.THREE_DIGIT_DATA_LENGTH=[["240",t.VARIABLE_LENGTH,30],["241",t.VARIABLE_LENGTH,30],["242",t.VARIABLE_LENGTH,6],["250",t.VARIABLE_LENGTH,30],["251",t.VARIABLE_LENGTH,30],["253",t.VARIABLE_LENGTH,17],["254",t.VARIABLE_LENGTH,20],["400",t.VARIABLE_LENGTH,30],["401",t.VARIABLE_LENGTH,30],["402",17],["403",t.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",t.VARIABLE_LENGTH,20],["421",t.VARIABLE_LENGTH,15],["422",3],["423",t.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],t.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",t.VARIABLE_LENGTH,15],["391",t.VARIABLE_LENGTH,18],["392",t.VARIABLE_LENGTH,15],["393",t.VARIABLE_LENGTH,18],["703",t.VARIABLE_LENGTH,30]],t.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",t.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",t.VARIABLE_LENGTH,20],["8003",t.VARIABLE_LENGTH,30],["8004",t.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",t.VARIABLE_LENGTH,30],["8008",t.VARIABLE_LENGTH,12],["8018",18],["8020",t.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",t.VARIABLE_LENGTH,70],["8200",t.VARIABLE_LENGTH,70]],t}(),EE=function(){function t(e){this.buffer=new ga,this.information=e}return t.prototype.decodeAllCodes=function(e,r){var n=r,a=null;do{var s=this.decodeGeneralPurposeField(n,a),o=r7e.parseFieldsInGeneralPurpose(s.getNewString());if(o!=null&&e.append(o),s.isRemaining()?a=""+s.getRemainingValue():a=null,n===s.getNewPosition())break;n=s.getNewPosition()}while(!0);return e.toString()},t.prototype.isStillNumeric=function(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(var r=e;r<e+3;++r)if(this.information.get(r))return!0;return this.information.get(e+3)},t.prototype.decodeNumeric=function(e){if(e+7>this.information.getSize()){var r=this.extractNumericValueFromBitArray(e,4);return r===0?new Nx(this.information.getSize(),Nx.FNC1,Nx.FNC1):new Nx(this.information.getSize(),r-1,Nx.FNC1)}var n=this.extractNumericValueFromBitArray(e,7),a=(n-8)/11,s=(n-8)%11;return new Nx(e+7,a,s)},t.prototype.extractNumericValueFromBitArray=function(e,r){return t.extractNumericValueFromBitArray(this.information,e,r)},t.extractNumericValueFromBitArray=function(e,r,n){for(var a=0,s=0;s<n;++s)e.get(r+s)&&(a|=1<<n-s-1);return a},t.prototype.decodeGeneralPurposeField=function(e,r){this.buffer.setLengthToZero(),r!=null&&this.buffer.append(r),this.current.setPosition(e);var n=this.parseBlocks();return n!=null&&n.isRemaining()?new sp(this.current.getPosition(),this.buffer.toString(),n.getRemainingValue()):new sp(this.current.getPosition(),this.buffer.toString())},t.prototype.parseBlocks=function(){var e,r;do{var n=this.current.getPosition();this.current.isAlpha()?(r=this.parseAlphaBlock(),e=r.isFinished()):this.current.isIsoIec646()?(r=this.parseIsoIec646Block(),e=r.isFinished()):(r=this.parseNumericBlock(),e=r.isFinished());var a=n!==this.current.getPosition();if(!a&&!e)break}while(!e);return r.getDecodedInformation()},t.prototype.parseNumericBlock=function(){for(;this.isStillNumeric(this.current.getPosition());){var e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){var r=void 0;return e.isSecondDigitFNC1()?r=new sp(this.current.getPosition(),this.buffer.toString()):r=new sp(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new ap(!0,r)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){var r=new sp(this.current.getPosition(),this.buffer.toString());return new ap(!0,r)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new ap(!1)},t.prototype.parseIsoIec646Block=function(){for(;this.isStillIsoIec646(this.current.getPosition());){var e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var r=new sp(this.current.getPosition(),this.buffer.toString());return new ap(!0,r)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new ap(!1)},t.prototype.parseAlphaBlock=function(){for(;this.isStillAlpha(this.current.getPosition());){var e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var r=new sp(this.current.getPosition(),this.buffer.toString());return new ap(!0,r)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new ap(!1)},t.prototype.isStillIsoIec646=function(e){if(e+5>this.information.getSize())return!1;var r=this.extractNumericValueFromBitArray(e,5);if(r>=5&&r<16)return!0;if(e+7>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<116)return!0;if(e+8>this.information.getSize())return!1;var a=this.extractNumericValueFromBitArray(e,8);return a>=232&&a<253},t.prototype.decodeIsoIec646=function(e){var r=this.extractNumericValueFromBitArray(e,5);if(r===15)return new af(e+5,af.FNC1);if(r>=5&&r<15)return new af(e+5,"0"+(r-5));var n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<90)return new af(e+7,""+(n+1));if(n>=90&&n<116)return new af(e+7,""+(n+7));var a=this.extractNumericValueFromBitArray(e,8),s;switch(a){case 232:s="!";break;case 233:s='"';break;case 234:s="%";break;case 235:s="&";break;case 236:s="'";break;case 237:s="(";break;case 238:s=")";break;case 239:s="*";break;case 240:s="+";break;case 241:s=",";break;case 242:s="-";break;case 243:s=".";break;case 244:s="/";break;case 245:s=":";break;case 246:s=";";break;case 247:s="<";break;case 248:s="=";break;case 249:s=">";break;case 250:s="?";break;case 251:s="_";break;case 252:s=" ";break;default:throw new Zr}return new af(e+8,s)},t.prototype.isStillAlpha=function(e){if(e+5>this.information.getSize())return!1;var r=this.extractNumericValueFromBitArray(e,5);if(r>=5&&r<16)return!0;if(e+6>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,6);return n>=16&&n<63},t.prototype.decodeAlphanumeric=function(e){var r=this.extractNumericValueFromBitArray(e,5);if(r===15)return new af(e+5,af.FNC1);if(r>=5&&r<15)return new af(e+5,"0"+(r-5));var n=this.extractNumericValueFromBitArray(e,6);if(n>=32&&n<58)return new af(e+6,""+(n+33));var a;switch(n){case 58:a="*";break;case 59:a=",";break;case 60:a="-";break;case 61:a=".";break;case 62:a="/";break;default:throw new Yw("Decoding invalid alphanumeric value: "+n)}return new af(e+6,a)},t.prototype.isAlphaTo646ToAlphaLatch=function(e){if(e+1>this.information.getSize())return!1;for(var r=0;r<5&&r+e<this.information.getSize();++r)if(r===2){if(!this.information.get(e+2))return!1}else if(this.information.get(e+r))return!1;return!0},t.prototype.isAlphaOr646ToNumericLatch=function(e){if(e+3>this.information.getSize())return!1;for(var r=e;r<e+3;++r)if(this.information.get(r))return!1;return!0},t.prototype.isNumericToAlphaNumericLatch=function(e){if(e+1>this.information.getSize())return!1;for(var r=0;r<4&&r+e<this.information.getSize();++r)if(this.information.get(e+r))return!1;return!0},t}(),Lse=function(){function t(e){this.information=e,this.generalDecoder=new EE(e)}return t.prototype.getInformation=function(){return this.information},t.prototype.getGeneralDecoder=function(){return this.generalDecoder},t}(),n7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),hf=function(t){n7e(e,t);function e(r){return t.call(this,r)||this}return e.prototype.encodeCompressedGtin=function(r,n){r.append("(01)");var a=r.length();r.append("9"),this.encodeCompressedGtinWithoutAI(r,n,a)},e.prototype.encodeCompressedGtinWithoutAI=function(r,n,a){for(var s=0;s<4;++s){var o=this.getGeneralDecoder().extractNumericValueFromBitArray(n+10*s,10);o/100===0&&r.append("0"),o/10===0&&r.append("0"),r.append(o)}e.appendCheckDigit(r,a)},e.appendCheckDigit=function(r,n){for(var a=0,s=0;s<13;s++){var o=r.charAt(s+n).charCodeAt(0)-48;a+=s&1?o:3*o}a=10-a%10,a===10&&(a=0),r.append(a)},e.GTIN_SIZE=40,e}(Lse),a7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),s7e=function(t){a7e(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){var r=new ga;r.append("(01)");var n=r.length(),a=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE,4);return r.append(a),this.encodeCompressedGtinWithoutAI(r,e.HEADER_SIZE+4,n),this.getGeneralDecoder().decodeAllCodes(r,e.HEADER_SIZE+44)},e.HEADER_SIZE=4,e}(hf),i7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),o7e=function(t){i7e(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){var r=new ga;return this.getGeneralDecoder().decodeAllCodes(r,e.HEADER_SIZE)},e.HEADER_SIZE=5,e}(Lse),l7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),SE=function(t){l7e(e,t);function e(r){return t.call(this,r)||this}return e.prototype.encodeCompressedWeight=function(r,n,a){var s=this.getGeneralDecoder().extractNumericValueFromBitArray(n,a);this.addWeightCode(r,s);for(var o=this.checkWeight(s),l=1e5,c=0;c<5;++c)o/l===0&&r.append("0"),l/=10;r.append(o)},e}(hf),c7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Use=function(t){c7e(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+SE.GTIN_SIZE+e.WEIGHT_SIZE)throw new Ar;var r=new ga;return this.encodeCompressedGtin(r,e.HEADER_SIZE),this.encodeCompressedWeight(r,e.HEADER_SIZE+SE.GTIN_SIZE,e.WEIGHT_SIZE),r.toString()},e.HEADER_SIZE=5,e.WEIGHT_SIZE=15,e}(SE),d7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),u7e=function(t){d7e(e,t);function e(r){return t.call(this,r)||this}return e.prototype.addWeightCode=function(r,n){r.append("(3103)")},e.prototype.checkWeight=function(r){return r},e}(Use),f7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),h7e=function(t){f7e(e,t);function e(r){return t.call(this,r)||this}return e.prototype.addWeightCode=function(r,n){n<1e4?r.append("(3202)"):r.append("(3203)")},e.prototype.checkWeight=function(r){return r<1e4?r:r-1e4},e}(Use),A7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),m7e=function(t){A7e(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+hf.GTIN_SIZE)throw new Ar;var r=new ga;this.encodeCompressedGtin(r,e.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+hf.GTIN_SIZE,e.LAST_DIGIT_SIZE);r.append("(392"),r.append(n),r.append(")");var a=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+hf.GTIN_SIZE+e.LAST_DIGIT_SIZE,null);return r.append(a.getNewString()),r.toString()},e.HEADER_SIZE=8,e.LAST_DIGIT_SIZE=2,e}(hf),p7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),g7e=function(t){p7e(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+hf.GTIN_SIZE)throw new Ar;var r=new ga;this.encodeCompressedGtin(r,e.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+hf.GTIN_SIZE,e.LAST_DIGIT_SIZE);r.append("(393"),r.append(n),r.append(")");var a=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+hf.GTIN_SIZE+e.LAST_DIGIT_SIZE,e.FIRST_THREE_DIGITS_SIZE);a/100===0&&r.append("0"),a/10===0&&r.append("0"),r.append(a);var s=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+hf.GTIN_SIZE+e.LAST_DIGIT_SIZE+e.FIRST_THREE_DIGITS_SIZE,null);return r.append(s.getNewString()),r.toString()},e.HEADER_SIZE=8,e.LAST_DIGIT_SIZE=2,e.FIRST_THREE_DIGITS_SIZE=10,e}(hf),x7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),w0=function(t){x7e(e,t);function e(r,n,a){var s=t.call(this,r)||this;return s.dateCode=a,s.firstAIdigits=n,s}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE+e.DATE_SIZE)throw new Ar;var r=new ga;return this.encodeCompressedGtin(r,e.HEADER_SIZE),this.encodeCompressedWeight(r,e.HEADER_SIZE+e.GTIN_SIZE,e.WEIGHT_SIZE),this.encodeCompressedDate(r,e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE),r.toString()},e.prototype.encodeCompressedDate=function(r,n){var a=this.getGeneralDecoder().extractNumericValueFromBitArray(n,e.DATE_SIZE);if(a!==38400){r.append("("),r.append(this.dateCode),r.append(")");var s=a%32;a/=32;var o=a%12+1;a/=12;var l=a;l/10===0&&r.append("0"),r.append(l),o/10===0&&r.append("0"),r.append(o),s/10===0&&r.append("0"),r.append(s)}},e.prototype.addWeightCode=function(r,n){r.append("("),r.append(this.firstAIdigits),r.append(n/1e5),r.append(")")},e.prototype.checkWeight=function(r){return r%1e5},e.HEADER_SIZE=8,e.WEIGHT_SIZE=20,e.DATE_SIZE=16,e}(SE);function v7e(t){try{if(t.get(1))return new s7e(t);if(!t.get(2))return new o7e(t);var e=EE.extractNumericValueFromBitArray(t,1,4);switch(e){case 4:return new u7e(t);case 5:return new h7e(t)}var r=EE.extractNumericValueFromBitArray(t,1,5);switch(r){case 12:return new m7e(t);case 13:return new g7e(t)}var n=EE.extractNumericValueFromBitArray(t,1,7);switch(n){case 56:return new w0(t,"310","11");case 57:return new w0(t,"320","11");case 58:return new w0(t,"310","13");case 59:return new w0(t,"320","13");case 60:return new w0(t,"310","15");case 61:return new w0(t,"320","15");case 62:return new w0(t,"310","17");case 63:return new w0(t,"320","17")}}catch(a){throw console.log(a),new Yw("unknown decoder: "+t)}}var eG=function(){function t(e,r,n,a){this.leftchar=e,this.rightchar=r,this.finderpattern=n,this.maybeLast=a}return t.prototype.mayBeLast=function(){return this.maybeLast},t.prototype.getLeftChar=function(){return this.leftchar},t.prototype.getRightChar=function(){return this.rightchar},t.prototype.getFinderPattern=function(){return this.finderpattern},t.prototype.mustBeLast=function(){return this.rightchar==null},t.prototype.toString=function(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"},t.equals=function(e,r){return e instanceof t?t.equalsOrNull(e.leftchar,r.leftchar)&&t.equalsOrNull(e.rightchar,r.rightchar)&&t.equalsOrNull(e.finderpattern,r.finderpattern):!1},t.equalsOrNull=function(e,r){return e===null?r===null:t.equals(e,r)},t.prototype.hashCode=function(){var e=this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue();return e},t}(),y7e=function(){function t(e,r,n){this.pairs=e,this.rowNumber=r,this.wasReversed=n}return t.prototype.getPairs=function(){return this.pairs},t.prototype.getRowNumber=function(){return this.rowNumber},t.prototype.isReversed=function(){return this.wasReversed},t.prototype.isEquivalent=function(e){return this.checkEqualitity(this,e)},t.prototype.toString=function(){return"{ "+this.pairs+" }"},t.prototype.equals=function(e,r){return e instanceof t?this.checkEqualitity(e,r)&&e.wasReversed===r.wasReversed:!1},t.prototype.checkEqualitity=function(e,r){if(!(!e||!r)){var n;return e.forEach(function(a,s){r.forEach(function(o){a.getLeftChar().getValue()===o.getLeftChar().getValue()&&a.getRightChar().getValue()===o.getRightChar().getValue()&&a.getFinderPatter().getValue()===o.getFinderPatter().getValue()&&(n=!0)})}),n}},t}(),b7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),N0=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},w7e=function(t){b7e(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.pairs=new Array(e.MAX_PAIRS),r.rows=new Array,r.startEnd=[2],r}return e.prototype.decodeRow=function(r,n,a){this.pairs.length=0,this.startFromEven=!1;try{return e.constructResult(this.decodeRow2pairs(r,n))}catch{}return this.pairs.length=0,this.startFromEven=!0,e.constructResult(this.decodeRow2pairs(r,n))},e.prototype.reset=function(){this.pairs.length=0,this.rows.length=0},e.prototype.decodeRow2pairs=function(r,n){for(var a=!1;!a;)try{this.pairs.push(this.retrieveNextPair(n,this.pairs,r))}catch(l){if(l instanceof Ar){if(!this.pairs.length)throw new Ar;a=!0}}if(this.checkChecksum())return this.pairs;var s;if(this.rows.length?s=!0:s=!1,this.storeRow(r,!1),s){var o=this.checkRowsBoolean(!1);if(o!=null||(o=this.checkRowsBoolean(!0),o!=null))return o}throw new Ar},e.prototype.checkRowsBoolean=function(r){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,r&&(this.rows=this.rows.reverse());var n=null;try{n=this.checkRows(new Array,0)}catch(a){console.log(a)}return r&&(this.rows=this.rows.reverse()),n},e.prototype.checkRows=function(r,n){for(var a,s,o=n;o<this.rows.length;o++){var l=this.rows[o];this.pairs.length=0;try{for(var c=(a=void 0,N0(r)),d=c.next();!d.done;d=c.next()){var u=d.value;this.pairs.push(u.getPairs())}}catch(A){a={error:A}}finally{try{d&&!d.done&&(s=c.return)&&s.call(c)}finally{if(a)throw a.error}}if(this.pairs.push(l.getPairs()),!!e.isValidSequence(this.pairs)){if(this.checkChecksum())return this.pairs;var f=new Array(r);f.push(l);try{return this.checkRows(f,o+1)}catch(A){console.log(A)}}}throw new Ar},e.isValidSequence=function(r){var n,a;try{for(var s=N0(e.FINDER_PATTERN_SEQUENCES),o=s.next();!o.done;o=s.next()){var l=o.value;if(!(r.length>l.length)){for(var c=!0,d=0;d<r.length;d++)if(r[d].getFinderPattern().getValue()!==l[d]){c=!1;break}if(c)return!0}}}catch(u){n={error:u}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}return!1},e.prototype.storeRow=function(r,n){for(var a=0,s=!1,o=!1;a<this.rows.length;){var l=this.rows[a];if(l.getRowNumber()>r){o=l.isEquivalent(this.pairs);break}s=l.isEquivalent(this.pairs),a++}o||s||e.isPartialRow(this.pairs,this.rows)||(this.rows.push(a,new y7e(this.pairs,r,n)),this.removePartialRows(this.pairs,this.rows))},e.prototype.removePartialRows=function(r,n){var a,s,o,l,c,d;try{for(var u=N0(n),f=u.next();!f.done;f=u.next()){var A=f.value;if(A.getPairs().length!==r.length){var h=!0;try{for(var m=(o=void 0,N0(A.getPairs())),p=m.next();!p.done;p=m.next()){var x=p.value,v=!1;try{for(var y=(c=void 0,N0(r)),b=y.next();!b.done;b=y.next()){var w=b.value;if(eG.equals(x,w)){v=!0;break}}}catch(I){c={error:I}}finally{try{b&&!b.done&&(d=y.return)&&d.call(y)}finally{if(c)throw c.error}}v||(h=!1)}}catch(I){o={error:I}}finally{try{p&&!p.done&&(l=m.return)&&l.call(m)}finally{if(o)throw o.error}}}}}catch(I){a={error:I}}finally{try{f&&!f.done&&(s=u.return)&&s.call(u)}finally{if(a)throw a.error}}},e.isPartialRow=function(r,n){var a,s,o,l,c,d;try{for(var u=N0(n),f=u.next();!f.done;f=u.next()){var A=f.value,h=!0;try{for(var m=(o=void 0,N0(r)),p=m.next();!p.done;p=m.next()){var x=p.value,v=!1;try{for(var y=(c=void 0,N0(A.getPairs())),b=y.next();!b.done;b=y.next()){var w=b.value;if(x.equals(w)){v=!0;break}}}catch(I){c={error:I}}finally{try{b&&!b.done&&(d=y.return)&&d.call(y)}finally{if(c)throw c.error}}if(!v){h=!1;break}}}catch(I){o={error:I}}finally{try{p&&!p.done&&(l=m.return)&&l.call(m)}finally{if(o)throw o.error}}if(h)return!0}}catch(I){a={error:I}}finally{try{f&&!f.done&&(s=u.return)&&s.call(u)}finally{if(a)throw a.error}}return!1},e.prototype.getRows=function(){return this.rows},e.constructResult=function(r){var n=JUe.buildBitArray(r),a=v7e(n),s=a.parseInformation(),o=r[0].getFinderPattern().getResultPoints(),l=r[r.length-1].getFinderPattern().getResultPoints(),c=[o[0],o[1],l[0],l[1]];return new Nc(s,null,null,c,Qn.RSS_EXPANDED,null)},e.prototype.checkChecksum=function(){var r=this.pairs.get(0),n=r.getLeftChar(),a=r.getRightChar();if(a===null)return!1;for(var s=a.getChecksumPortion(),o=2,l=1;l<this.pairs.size();++l){var c=this.pairs.get(l);s+=c.getLeftChar().getChecksumPortion(),o++;var d=c.getRightChar();d!=null&&(s+=d.getChecksumPortion(),o++)}s%=211;var u=211*(o-4)+s;return u===n.getValue()},e.getNextSecondBar=function(r,n){var a;return r.get(n)?(a=r.getNextUnset(n),a=r.getNextSet(a)):(a=r.getNextSet(n),a=r.getNextUnset(a)),a},e.prototype.retrieveNextPair=function(r,n,a){var s=n.length%2===0;this.startFromEven&&(s=!s);var o,l=!0,c=-1;do this.findNextPair(r,n,c),o=this.parseFoundFinderPattern(r,a,s),o===null?c=e.getNextSecondBar(r,this.startEnd[0]):l=!1;while(l);var d=this.decodeDataCharacter(r,o,s,!0);if(!this.isEmptyPair(n)&&n[n.length-1].mustBeLast())throw new Ar;var u;try{u=this.decodeDataCharacter(r,o,s,!1)}catch(f){u=null,console.log(f)}return new eG(d,u,o,!0)},e.prototype.isEmptyPair=function(r){return r.length===0},e.prototype.findNextPair=function(r,n,a){var s=this.getDecodeFinderCounters();s[0]=0,s[1]=0,s[2]=0,s[3]=0;var o=r.getSize(),l;if(a>=0)l=a;else if(this.isEmptyPair(n))l=0;else{var c=n[n.length-1];l=c.getFinderPattern().getStartEnd()[1]}var d=n.length%2!==0;this.startFromEven&&(d=!d);for(var u=!1;l<o&&(u=!r.get(l),!!u);)l++;for(var f=0,A=l,h=l;h<o;h++)if(r.get(h)!==u)s[f]++;else{if(f===3){if(d&&e.reverseCounters(s),e.isFinderPattern(s)){this.startEnd[0]=A,this.startEnd[1]=h;return}d&&e.reverseCounters(s),A+=s[0]+s[1],s[0]=s[2],s[1]=s[3],s[2]=0,s[3]=0,f--}else f++;s[f]=1,u=!u}throw new Ar},e.reverseCounters=function(r){for(var n=r.length,a=0;a<n/2;++a){var s=r[a];r[a]=r[n-a-1],r[n-a-1]=s}},e.prototype.parseFoundFinderPattern=function(r,n,a){var s,o,l;if(a){for(var c=this.startEnd[0]-1;c>=0&&!r.get(c);)c--;c++,s=this.startEnd[0]-c,o=c,l=this.startEnd[1]}else o=this.startEnd[0],l=r.getNextUnset(this.startEnd[1]+1),s=l-this.startEnd[1];var d=this.getDecodeFinderCounters();Ms.arraycopy(d,0,d,1,d.length-1),d[0]=s;var u;try{u=this.parseFinderValue(d,e.FINDER_PATTERNS)}catch{return null}return new Mse(u,[o,l],o,l,n)},e.prototype.decodeDataCharacter=function(r,n,a,s){for(var o=this.getDataCharacterCounters(),l=0;l<o.length;l++)o[l]=0;if(s)e.recordPatternInReverse(r,n.getStartEnd()[0],o);else{e.recordPattern(r,n.getStartEnd()[1],o);for(var c=0,d=o.length-1;c<d;c++,d--){var u=o[c];o[c]=o[d],o[d]=u}}var f=17,A=Ga.sum(new Int32Array(o))/f,h=(n.getStartEnd()[1]-n.getStartEnd()[0])/15;if(Math.abs(A-h)/h>.3)throw new Ar;for(var m=this.getOddCounts(),p=this.getEvenCounts(),x=this.getOddRoundingErrors(),v=this.getEvenRoundingErrors(),c=0;c<o.length;c++){var y=1*o[c]/A,b=y+.5;if(b<1){if(y<.3)throw new Ar;b=1}else if(b>8){if(y>8.7)throw new Ar;b=8}var w=c/2;c&1?(p[w]=b,v[w]=y-b):(m[w]=b,x[w]=y-b)}this.adjustOddEvenCounts(f);for(var I=4*n.getValue()+(a?0:2)+(s?0:1)-1,j=0,N=0,c=m.length-1;c>=0;c--){if(e.isNotA1left(n,a,s)){var S=e.WEIGHTS[I][2*c];N+=m[c]*S}j+=m[c]}for(var E=0,c=p.length-1;c>=0;c--)if(e.isNotA1left(n,a,s)){var S=e.WEIGHTS[I][2*c+1];E+=p[c]*S}var B=N+E;if(j&1||j>13||j<4)throw new Ar;var k=(13-j)/2,T=e.SYMBOL_WIDEST[k],P=9-T,q=tv.getRSSvalue(m,T,!0),de=tv.getRSSvalue(p,P,!1),ce=e.EVEN_TOTAL_SUBSET[k],le=e.GSUM[k],he=q*ce+de+le;return new lj(he,B)},e.isNotA1left=function(r,n,a){return!(r.getValue()===0&&n&&a)},e.prototype.adjustOddEvenCounts=function(r){var n=Ga.sum(new Int32Array(this.getOddCounts())),a=Ga.sum(new Int32Array(this.getEvenCounts())),s=!1,o=!1;n>13?o=!0:n<4&&(s=!0);var l=!1,c=!1;a>13?c=!0:a<4&&(l=!0);var d=n+a-r,u=(n&1)===1,f=(a&1)===0;if(d===1)if(u){if(f)throw new Ar;o=!0}else{if(!f)throw new Ar;c=!0}else if(d===-1)if(u){if(f)throw new Ar;s=!0}else{if(!f)throw new Ar;l=!0}else if(d===0){if(u){if(!f)throw new Ar;n<a?(s=!0,c=!0):(o=!0,l=!0)}else if(f)throw new Ar}else throw new Ar;if(s){if(o)throw new Ar;e.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&e.decrement(this.getOddCounts(),this.getOddRoundingErrors()),l){if(c)throw new Ar;e.increment(this.getEvenCounts(),this.getOddRoundingErrors())}c&&e.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.SYMBOL_WIDEST=[7,5,4,3,1],e.EVEN_TOTAL_SUBSET=[4,20,52,104,204],e.GSUM=[0,348,1388,2948,3988],e.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],e.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],e.FINDER_PAT_A=0,e.FINDER_PAT_B=1,e.FINDER_PAT_C=2,e.FINDER_PAT_D=3,e.FINDER_PAT_E=4,e.FINDER_PAT_F=5,e.FINDER_PATTERN_SEQUENCES=[[e.FINDER_PAT_A,e.FINDER_PAT_A],[e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B],[e.FINDER_PAT_A,e.FINDER_PAT_C,e.FINDER_PAT_B,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_C],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F]],e.MAX_PAIRS=11,e}(pp),N7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),C7e=function(t){N7e(e,t);function e(r,n,a){var s=t.call(this,r,n)||this;return s.count=0,s.finderPattern=a,s}return e.prototype.getFinderPattern=function(){return this.finderPattern},e.prototype.getCount=function(){return this.count},e.prototype.incrementCount=function(){this.count++},e}(lj),_7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),rT=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},tG=function(t){_7e(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.possibleLeftPairs=[],r.possibleRightPairs=[],r}return e.prototype.decodeRow=function(r,n,a){var s,o,l,c,d=this.decodePair(n,!1,r,a);e.addOrTally(this.possibleLeftPairs,d),n.reverse();var u=this.decodePair(n,!0,r,a);e.addOrTally(this.possibleRightPairs,u),n.reverse();try{for(var f=rT(this.possibleLeftPairs),A=f.next();!A.done;A=f.next()){var h=A.value;if(h.getCount()>1)try{for(var m=(l=void 0,rT(this.possibleRightPairs)),p=m.next();!p.done;p=m.next()){var x=p.value;if(x.getCount()>1&&e.checkChecksum(h,x))return e.constructResult(h,x)}}catch(v){l={error:v}}finally{try{p&&!p.done&&(c=m.return)&&c.call(m)}finally{if(l)throw l.error}}}}catch(v){s={error:v}}finally{try{A&&!A.done&&(o=f.return)&&o.call(f)}finally{if(s)throw s.error}}throw new Ar},e.addOrTally=function(r,n){var a,s;if(n!=null){var o=!1;try{for(var l=rT(r),c=l.next();!c.done;c=l.next()){var d=c.value;if(d.getValue()===n.getValue()){d.incrementCount(),o=!0;break}}}catch(u){a={error:u}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}o||r.push(n)}},e.prototype.reset=function(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0},e.constructResult=function(r,n){for(var a=4537077*r.getValue()+n.getValue(),s=new String(a).toString(),o=new ga,l=13-s.length;l>0;l--)o.append("0");o.append(s);for(var c=0,l=0;l<13;l++){var d=o.charAt(l).charCodeAt(0)-48;c+=l&1?d:3*d}c=10-c%10,c===10&&(c=0),o.append(c.toString());var u=r.getFinderPattern().getResultPoints(),f=n.getFinderPattern().getResultPoints();return new Nc(o.toString(),null,0,[u[0],u[1],f[0],f[1]],Qn.RSS_14,new Date().getTime())},e.checkChecksum=function(r,n){var a=(r.getChecksumPortion()+16*n.getChecksumPortion())%79,s=9*r.getFinderPattern().getValue()+n.getFinderPattern().getValue();return s>72&&s--,s>8&&s--,a===s},e.prototype.decodePair=function(r,n,a,s){try{var o=this.findFinderPattern(r,n),l=this.parseFoundFinderPattern(r,a,n,o),c=s==null?null:s.get(Ls.NEED_RESULT_POINT_CALLBACK);if(c!=null){var d=(o[0]+o[1])/2;n&&(d=r.getSize()-1-d),c.foundPossibleResultPoint(new Cn(d,a))}var u=this.decodeDataCharacter(r,l,!0),f=this.decodeDataCharacter(r,l,!1);return new C7e(1597*u.getValue()+f.getValue(),u.getChecksumPortion()+4*f.getChecksumPortion(),l)}catch{return null}},e.prototype.decodeDataCharacter=function(r,n,a){for(var s=this.getDataCharacterCounters(),o=0;o<s.length;o++)s[o]=0;if(a)Go.recordPatternInReverse(r,n.getStartEnd()[0],s);else{Go.recordPattern(r,n.getStartEnd()[1]+1,s);for(var l=0,c=s.length-1;l<c;l++,c--){var d=s[l];s[l]=s[c],s[c]=d}}for(var u=a?16:15,f=Ga.sum(new Int32Array(s))/u,A=this.getOddCounts(),h=this.getEvenCounts(),m=this.getOddRoundingErrors(),p=this.getEvenRoundingErrors(),l=0;l<s.length;l++){var x=s[l]/f,v=Math.floor(x+.5);v<1?v=1:v>8&&(v=8);var y=Math.floor(l/2);l&1?(h[y]=v,p[y]=x-v):(A[y]=v,m[y]=x-v)}this.adjustOddEvenCounts(a,u);for(var b=0,w=0,l=A.length-1;l>=0;l--)w*=9,w+=A[l],b+=A[l];for(var I=0,j=0,l=h.length-1;l>=0;l--)I*=9,I+=h[l],j+=h[l];var N=w+3*I;if(a){if(b&1||b>12||b<4)throw new Ar;var S=(12-b)/2,E=e.OUTSIDE_ODD_WIDEST[S],B=9-E,k=tv.getRSSvalue(A,E,!1),T=tv.getRSSvalue(h,B,!0),P=e.OUTSIDE_EVEN_TOTAL_SUBSET[S],q=e.OUTSIDE_GSUM[S];return new lj(k*P+T+q,N)}else{if(j&1||j>10||j<4)throw new Ar;var S=(10-j)/2,E=e.INSIDE_ODD_WIDEST[S],B=9-E,k=tv.getRSSvalue(A,E,!0),T=tv.getRSSvalue(h,B,!1),de=e.INSIDE_ODD_TOTAL_SUBSET[S],q=e.INSIDE_GSUM[S];return new lj(T*de+k+q,N)}},e.prototype.findFinderPattern=function(r,n){var a=this.getDecodeFinderCounters();a[0]=0,a[1]=0,a[2]=0,a[3]=0;for(var s=r.getSize(),o=!1,l=0;l<s&&(o=!r.get(l),n!==o);)l++;for(var c=0,d=l,u=l;u<s;u++)if(r.get(u)!==o)a[c]++;else{if(c===3){if(pp.isFinderPattern(a))return[d,u];d+=a[0]+a[1],a[0]=a[2],a[1]=a[3],a[2]=0,a[3]=0,c--}else c++;a[c]=1,o=!o}throw new Ar},e.prototype.parseFoundFinderPattern=function(r,n,a,s){for(var o=r.get(s[0]),l=s[0]-1;l>=0&&o!==r.get(l);)l--;l++;var c=s[0]-l,d=this.getDecodeFinderCounters(),u=new Int32Array(d.length);Ms.arraycopy(d,0,u,1,d.length-1),u[0]=c;var f=this.parseFinderValue(u,e.FINDER_PATTERNS),A=l,h=s[1];return a&&(A=r.getSize()-1-A,h=r.getSize()-1-h),new Mse(f,[l,s[1]],A,h,n)},e.prototype.adjustOddEvenCounts=function(r,n){var a=Ga.sum(new Int32Array(this.getOddCounts())),s=Ga.sum(new Int32Array(this.getEvenCounts())),o=!1,l=!1,c=!1,d=!1;r?(a>12?l=!0:a<4&&(o=!0),s>12?d=!0:s<4&&(c=!0)):(a>11?l=!0:a<5&&(o=!0),s>10?d=!0:s<4&&(c=!0));var u=a+s-n,f=(a&1)===(r?1:0),A=(s&1)===1;if(u===1)if(f){if(A)throw new Ar;l=!0}else{if(!A)throw new Ar;d=!0}else if(u===-1)if(f){if(A)throw new Ar;o=!0}else{if(!A)throw new Ar;c=!0}else if(u===0){if(f){if(!A)throw new Ar;a<s?(o=!0,d=!0):(l=!0,c=!0)}else if(A)throw new Ar}else throw new Ar;if(o){if(l)throw new Ar;pp.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(l&&pp.decrement(this.getOddCounts(),this.getOddRoundingErrors()),c){if(d)throw new Ar;pp.increment(this.getEvenCounts(),this.getOddRoundingErrors())}d&&pp.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],e.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],e.OUTSIDE_GSUM=[0,161,961,2015,2715],e.INSIDE_GSUM=[0,336,1036,1516],e.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],e.INSIDE_ODD_WIDEST=[2,4,6,8],e.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])],e}(pp),E7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),rv=function(t){E7e(e,t);function e(r){var n=t.call(this)||this;n.readers=[];var a=r?r.get(Ls.POSSIBLE_FORMATS):null,s=r&&r.get(Ls.ASSUME_CODE_39_CHECK_DIGIT)!==void 0,o=r&&r.get(Ls.ENABLE_CODE_39_EXTENDED_MODE)!==void 0;return a&&((a.includes(Qn.EAN_13)||a.includes(Qn.UPC_A)||a.includes(Qn.EAN_8)||a.includes(Qn.UPC_E))&&n.readers.push(new tT(r)),a.includes(Qn.CODE_39)&&n.readers.push(new G$(s,o)),a.includes(Qn.CODE_93)&&n.readers.push(new K$),a.includes(Qn.CODE_128)&&n.readers.push(new $$),a.includes(Qn.ITF)&&n.readers.push(new q$),a.includes(Qn.CODABAR)&&n.readers.push(new zUe),a.includes(Qn.RSS_14)&&n.readers.push(new tG),a.includes(Qn.RSS_EXPANDED)&&(console.warn("RSS Expanded reader IS NOT ready for production yet! use at your own risk."),n.readers.push(new w7e))),n.readers.length===0&&(n.readers.push(new tT(r)),n.readers.push(new G$),n.readers.push(new K$),n.readers.push(new tT(r)),n.readers.push(new $$),n.readers.push(new q$),n.readers.push(new tG)),n}return e.prototype.decodeRow=function(r,n,a){for(var s=0;s<this.readers.length;s++)try{return this.readers[s].decodeRow(r,n,a)}catch{}throw new Ar},e.prototype.reset=function(){this.readers.forEach(function(r){return r.reset()})},e}(Go),S7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){S7e(e,t);function e(r,n){return r===void 0&&(r=500),t.call(this,new rv(n),r,n)||this}return e})(P1);var rG=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},rs=function(){function t(e,r,n){this.ecCodewords=e,this.ecBlocks=[r],n&&this.ecBlocks.push(n)}return t.prototype.getECCodewords=function(){return this.ecCodewords},t.prototype.getECBlocks=function(){return this.ecBlocks},t}(),Xa=function(){function t(e,r){this.count=e,this.dataCodewords=r}return t.prototype.getCount=function(){return this.count},t.prototype.getDataCodewords=function(){return this.dataCodewords},t}(),j7e=function(){function t(e,r,n,a,s,o){var l,c;this.versionNumber=e,this.symbolSizeRows=r,this.symbolSizeColumns=n,this.dataRegionSizeRows=a,this.dataRegionSizeColumns=s,this.ecBlocks=o;var d=0,u=o.getECCodewords(),f=o.getECBlocks();try{for(var A=rG(f),h=A.next();!h.done;h=A.next()){var m=h.value;d+=m.getCount()*(m.getDataCodewords()+u)}}catch(p){l={error:p}}finally{try{h&&!h.done&&(c=A.return)&&c.call(A)}finally{if(l)throw l.error}}this.totalCodewords=d}return t.prototype.getVersionNumber=function(){return this.versionNumber},t.prototype.getSymbolSizeRows=function(){return this.symbolSizeRows},t.prototype.getSymbolSizeColumns=function(){return this.symbolSizeColumns},t.prototype.getDataRegionSizeRows=function(){return this.dataRegionSizeRows},t.prototype.getDataRegionSizeColumns=function(){return this.dataRegionSizeColumns},t.prototype.getTotalCodewords=function(){return this.totalCodewords},t.prototype.getECBlocks=function(){return this.ecBlocks},t.getVersionForDimensions=function(e,r){var n,a;if(e&1||r&1)throw new Zr;try{for(var s=rG(t.VERSIONS),o=s.next();!o.done;o=s.next()){var l=o.value;if(l.symbolSizeRows===e&&l.symbolSizeColumns===r)return l}}catch(c){n={error:c}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}throw new Zr},t.prototype.toString=function(){return""+this.versionNumber},t.buildVersions=function(){return[new t(1,10,10,8,8,new rs(5,new Xa(1,3))),new t(2,12,12,10,10,new rs(7,new Xa(1,5))),new t(3,14,14,12,12,new rs(10,new Xa(1,8))),new t(4,16,16,14,14,new rs(12,new Xa(1,12))),new t(5,18,18,16,16,new rs(14,new Xa(1,18))),new t(6,20,20,18,18,new rs(18,new Xa(1,22))),new t(7,22,22,20,20,new rs(20,new Xa(1,30))),new t(8,24,24,22,22,new rs(24,new Xa(1,36))),new t(9,26,26,24,24,new rs(28,new Xa(1,44))),new t(10,32,32,14,14,new rs(36,new Xa(1,62))),new t(11,36,36,16,16,new rs(42,new Xa(1,86))),new t(12,40,40,18,18,new rs(48,new Xa(1,114))),new t(13,44,44,20,20,new rs(56,new Xa(1,144))),new t(14,48,48,22,22,new rs(68,new Xa(1,174))),new t(15,52,52,24,24,new rs(42,new Xa(2,102))),new t(16,64,64,14,14,new rs(56,new Xa(2,140))),new t(17,72,72,16,16,new rs(36,new Xa(4,92))),new t(18,80,80,18,18,new rs(48,new Xa(4,114))),new t(19,88,88,20,20,new rs(56,new Xa(4,144))),new t(20,96,96,22,22,new rs(68,new Xa(4,174))),new t(21,104,104,24,24,new rs(56,new Xa(6,136))),new t(22,120,120,18,18,new rs(68,new Xa(6,175))),new t(23,132,132,20,20,new rs(62,new Xa(8,163))),new t(24,144,144,22,22,new rs(62,new Xa(8,156),new Xa(2,155))),new t(25,8,18,6,16,new rs(7,new Xa(1,5))),new t(26,8,32,6,14,new rs(11,new Xa(1,10))),new t(27,12,26,10,24,new rs(14,new Xa(1,16))),new t(28,12,36,10,16,new rs(18,new Xa(1,22))),new t(29,16,36,14,16,new rs(24,new Xa(1,32))),new t(30,16,48,14,22,new rs(28,new Xa(1,49)))]},t.VERSIONS=t.buildVersions(),t}(),I7e=function(){function t(e){var r=e.getHeight();if(r<8||r>144||r&1)throw new Zr;this.version=t.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new fh(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}return t.prototype.getVersion=function(){return this.version},t.readVersion=function(e){var r=e.getHeight(),n=e.getWidth();return j7e.getVersionForDimensions(r,n)},t.prototype.readCodewords=function(){var e=new Int8Array(this.version.getTotalCodewords()),r=0,n=4,a=0,s=this.mappingBitMatrix.getHeight(),o=this.mappingBitMatrix.getWidth(),l=!1,c=!1,d=!1,u=!1;do if(n===s&&a===0&&!l)e[r++]=this.readCorner1(s,o)&255,n-=2,a+=2,l=!0;else if(n===s-2&&a===0&&o&3&&!c)e[r++]=this.readCorner2(s,o)&255,n-=2,a+=2,c=!0;else if(n===s+4&&a===2&&!(o&7)&&!d)e[r++]=this.readCorner3(s,o)&255,n-=2,a+=2,d=!0;else if(n===s-2&&a===0&&(o&7)===4&&!u)e[r++]=this.readCorner4(s,o)&255,n-=2,a+=2,u=!0;else{do n<s&&a>=0&&!this.readMappingMatrix.get(a,n)&&(e[r++]=this.readUtah(n,a,s,o)&255),n-=2,a+=2;while(n>=0&&a<o);n+=1,a+=3;do n>=0&&a<o&&!this.readMappingMatrix.get(a,n)&&(e[r++]=this.readUtah(n,a,s,o)&255),n+=2,a-=2;while(n<s&&a>=0);n+=3,a+=1}while(n<s||a<o);if(r!==this.version.getTotalCodewords())throw new Zr;return e},t.prototype.readModule=function(e,r,n,a){return e<0&&(e+=n,r+=4-(n+4&7)),r<0&&(r+=a,e+=4-(a+4&7)),this.readMappingMatrix.set(r,e),this.mappingBitMatrix.get(r,e)},t.prototype.readUtah=function(e,r,n,a){var s=0;return this.readModule(e-2,r-2,n,a)&&(s|=1),s<<=1,this.readModule(e-2,r-1,n,a)&&(s|=1),s<<=1,this.readModule(e-1,r-2,n,a)&&(s|=1),s<<=1,this.readModule(e-1,r-1,n,a)&&(s|=1),s<<=1,this.readModule(e-1,r,n,a)&&(s|=1),s<<=1,this.readModule(e,r-2,n,a)&&(s|=1),s<<=1,this.readModule(e,r-1,n,a)&&(s|=1),s<<=1,this.readModule(e,r,n,a)&&(s|=1),s},t.prototype.readCorner1=function(e,r){var n=0;return this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,1,e,r)&&(n|=1),n<<=1,this.readModule(e-1,2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n<<=1,this.readModule(2,r-1,e,r)&&(n|=1),n<<=1,this.readModule(3,r-1,e,r)&&(n|=1),n},t.prototype.readCorner2=function(e,r){var n=0;return this.readModule(e-3,0,e,r)&&(n|=1),n<<=1,this.readModule(e-2,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(0,r-4,e,r)&&(n|=1),n<<=1,this.readModule(0,r-3,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n},t.prototype.readCorner3=function(e,r){var n=0;return this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,r-1,e,r)&&(n|=1),n<<=1,this.readModule(0,r-3,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-3,e,r)&&(n|=1),n<<=1,this.readModule(1,r-2,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n},t.prototype.readCorner4=function(e,r){var n=0;return this.readModule(e-3,0,e,r)&&(n|=1),n<<=1,this.readModule(e-2,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n<<=1,this.readModule(2,r-1,e,r)&&(n|=1),n<<=1,this.readModule(3,r-1,e,r)&&(n|=1),n},t.prototype.extractDataRegion=function(e){var r=this.version.getSymbolSizeRows(),n=this.version.getSymbolSizeColumns();if(e.getHeight()!==r)throw new Vn("Dimension of bitMatrix must match the version size");for(var a=this.version.getDataRegionSizeRows(),s=this.version.getDataRegionSizeColumns(),o=r/a|0,l=n/s|0,c=o*a,d=l*s,u=new fh(d,c),f=0;f<o;++f)for(var A=f*a,h=0;h<l;++h)for(var m=h*s,p=0;p<a;++p)for(var x=f*(a+2)+1+p,v=A+p,y=0;y<s;++y){var b=h*(s+2)+1+y;if(e.get(b,x)){var w=m+y;u.set(w,v)}}return u},t}(),nG=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},P7e=function(){function t(e,r){this.numDataCodewords=e,this.codewords=r}return t.getDataBlocks=function(e,r){var n,a,s,o,l=r.getECBlocks(),c=0,d=l.getECBlocks();try{for(var u=nG(d),f=u.next();!f.done;f=u.next()){var A=f.value;c+=A.getCount()}}catch(q){n={error:q}}finally{try{f&&!f.done&&(a=u.return)&&a.call(u)}finally{if(n)throw n.error}}var h=new Array(c),m=0;try{for(var p=nG(d),x=p.next();!x.done;x=p.next())for(var A=x.value,v=0;v<A.getCount();v++){var y=A.getDataCodewords(),b=l.getECCodewords()+y;h[m++]=new t(y,new Uint8Array(b))}}catch(q){s={error:q}}finally{try{x&&!x.done&&(o=p.return)&&o.call(p)}finally{if(s)throw s.error}}for(var w=h[0].codewords.length,I=w-l.getECCodewords(),j=I-1,N=0,v=0;v<j;v++)for(var S=0;S<m;S++)h[S].codewords[v]=e[N++];for(var E=r.getVersionNumber()===24,B=E?8:m,S=0;S<B;S++)h[S].codewords[I-1]=e[N++];for(var k=h[0].codewords.length,v=I;v<k;v++)for(var S=0;S<m;S++){var T=E?(S+8)%m:S,P=E&&T>7?v-1:v;h[T].codewords[P]=e[N++]}if(N!==e.length)throw new Vn;return h},t.prototype.getNumDataCodewords=function(){return this.numDataCodewords},t.prototype.getCodewords=function(){return this.codewords},t}(),Qse=function(){function t(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}return t.prototype.getBitOffset=function(){return this.bitOffset},t.prototype.getByteOffset=function(){return this.byteOffset},t.prototype.readBits=function(e){if(e<1||e>32||e>this.available())throw new Vn(""+e);var r=0,n=this.bitOffset,a=this.byteOffset,s=this.bytes;if(n>0){var o=8-n,l=e<o?e:o,c=o-l,d=255>>8-l<<c;r=(s[a]&d)>>c,e-=l,n+=l,n===8&&(n=0,a++)}if(e>0){for(;e>=8;)r=r<<8|s[a]&255,a++,e-=8;if(e>0){var c=8-e,d=255>>c<<c;r=r<<e|(s[a]&d)>>c,n+=e}}return this.bitOffset=n,this.byteOffset=a,r},t.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset},t}(),Bo;(function(t){t[t.PAD_ENCODE=0]="PAD_ENCODE",t[t.ASCII_ENCODE=1]="ASCII_ENCODE",t[t.C40_ENCODE=2]="C40_ENCODE",t[t.TEXT_ENCODE=3]="TEXT_ENCODE",t[t.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",t[t.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",t[t.BASE256_ENCODE=6]="BASE256_ENCODE"})(Bo||(Bo={}));var T7e=function(){function t(){}return t.decode=function(e){var r=new Qse(e),n=new ga,a=new ga,s=new Array,o=Bo.ASCII_ENCODE;do if(o===Bo.ASCII_ENCODE)o=this.decodeAsciiSegment(r,n,a);else{switch(o){case Bo.C40_ENCODE:this.decodeC40Segment(r,n);break;case Bo.TEXT_ENCODE:this.decodeTextSegment(r,n);break;case Bo.ANSIX12_ENCODE:this.decodeAnsiX12Segment(r,n);break;case Bo.EDIFACT_ENCODE:this.decodeEdifactSegment(r,n);break;case Bo.BASE256_ENCODE:this.decodeBase256Segment(r,n,s);break;default:throw new Zr}o=Bo.ASCII_ENCODE}while(o!==Bo.PAD_ENCODE&&r.available()>0);return a.length()>0&&n.append(a.toString()),new EP(e,n.toString(),s.length===0?null:s,null)},t.decodeAsciiSegment=function(e,r,n){var a=!1;do{var s=e.readBits(8);if(s===0)throw new Zr;if(s<=128)return a&&(s+=128),r.append(String.fromCharCode(s-1)),Bo.ASCII_ENCODE;if(s===129)return Bo.PAD_ENCODE;if(s<=229){var o=s-130;o<10&&r.append("0"),r.append(""+o)}else switch(s){case 230:return Bo.C40_ENCODE;case 231:return Bo.BASE256_ENCODE;case 232:r.append("");break;case 233:case 234:break;case 235:a=!0;break;case 236:r.append("[)>05"),n.insert(0,"");break;case 237:r.append("[)>06"),n.insert(0,"");break;case 238:return Bo.ANSIX12_ENCODE;case 239:return Bo.TEXT_ENCODE;case 240:return Bo.EDIFACT_ENCODE;case 241:break;default:if(s!==254||e.available()!==0)throw new Zr;break}}while(e.available()>0);return Bo.ASCII_ENCODE},t.decodeC40Segment=function(e,r){var n=!1,a=[],s=0;do{if(e.available()===8)return;var o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),a);for(var l=0;l<3;l++){var c=a[l];switch(s){case 0:if(c<3)s=c+1;else if(c<this.C40_BASIC_SET_CHARS.length){var d=this.C40_BASIC_SET_CHARS[c];n?(r.append(String.fromCharCode(d.charCodeAt(0)+128)),n=!1):r.append(d)}else throw new Zr;break;case 1:n?(r.append(String.fromCharCode(c+128)),n=!1):r.append(String.fromCharCode(c)),s=0;break;case 2:if(c<this.C40_SHIFT2_SET_CHARS.length){var d=this.C40_SHIFT2_SET_CHARS[c];n?(r.append(String.fromCharCode(d.charCodeAt(0)+128)),n=!1):r.append(d)}else switch(c){case 27:r.append("");break;case 30:n=!0;break;default:throw new Zr}s=0;break;case 3:n?(r.append(String.fromCharCode(c+224)),n=!1):r.append(String.fromCharCode(c+96)),s=0;break;default:throw new Zr}}}while(e.available()>0)},t.decodeTextSegment=function(e,r){var n=!1,a=[],s=0;do{if(e.available()===8)return;var o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),a);for(var l=0;l<3;l++){var c=a[l];switch(s){case 0:if(c<3)s=c+1;else if(c<this.TEXT_BASIC_SET_CHARS.length){var d=this.TEXT_BASIC_SET_CHARS[c];n?(r.append(String.fromCharCode(d.charCodeAt(0)+128)),n=!1):r.append(d)}else throw new Zr;break;case 1:n?(r.append(String.fromCharCode(c+128)),n=!1):r.append(String.fromCharCode(c)),s=0;break;case 2:if(c<this.TEXT_SHIFT2_SET_CHARS.length){var d=this.TEXT_SHIFT2_SET_CHARS[c];n?(r.append(String.fromCharCode(d.charCodeAt(0)+128)),n=!1):r.append(d)}else switch(c){case 27:r.append("");break;case 30:n=!0;break;default:throw new Zr}s=0;break;case 3:if(c<this.TEXT_SHIFT3_SET_CHARS.length){var d=this.TEXT_SHIFT3_SET_CHARS[c];n?(r.append(String.fromCharCode(d.charCodeAt(0)+128)),n=!1):r.append(d),s=0}else throw new Zr;break;default:throw new Zr}}}while(e.available()>0)},t.decodeAnsiX12Segment=function(e,r){var n=[];do{if(e.available()===8)return;var a=e.readBits(8);if(a===254)return;this.parseTwoBytes(a,e.readBits(8),n);for(var s=0;s<3;s++){var o=n[s];switch(o){case 0:r.append("\r");break;case 1:r.append("*");break;case 2:r.append(">");break;case 3:r.append(" ");break;default:if(o<14)r.append(String.fromCharCode(o+44));else if(o<40)r.append(String.fromCharCode(o+51));else throw new Zr;break}}}while(e.available()>0)},t.parseTwoBytes=function(e,r,n){var a=(e<<8)+r-1,s=Math.floor(a/1600);n[0]=s,a-=s*1600,s=Math.floor(a/40),n[1]=s,n[2]=a-s*40},t.decodeEdifactSegment=function(e,r){do{if(e.available()<=16)return;for(var n=0;n<4;n++){var a=e.readBits(6);if(a===31){var s=8-e.getBitOffset();s!==8&&e.readBits(s);return}a&32||(a|=64),r.append(String.fromCharCode(a))}}while(e.available()>0)},t.decodeBase256Segment=function(e,r,n){var a=1+e.getByteOffset(),s=this.unrandomize255State(e.readBits(8),a++),o;if(s===0?o=e.available()/8|0:s<250?o=s:o=250*(s-249)+this.unrandomize255State(e.readBits(8),a++),o<0)throw new Zr;for(var l=new Uint8Array(o),c=0;c<o;c++){if(e.available()<8)throw new Zr;l[c]=this.unrandomize255State(e.readBits(8),a++)}n.push(l);try{r.append(Du.decode(l,Oa.ISO88591))}catch(d){throw new Yw("Platform does not support required encoding: "+d.message)}},t.unrandomize255State=function(e,r){var n=149*r%255+1,a=e-n;return a>=0?a:a+256},t.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],t.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],t.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],t.TEXT_SHIFT2_SET_CHARS=t.C40_SHIFT2_SET_CHARS,t.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""],t}(),B7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},k7e=function(){function t(){this.rsDecoder=new SP(od.DATA_MATRIX_FIELD_256)}return t.prototype.decode=function(e){var r,n,a=new I7e(e),s=a.getVersion(),o=a.readCodewords(),l=P7e.getDataBlocks(o,s),c=0;try{for(var d=B7e(l),u=d.next();!u.done;u=d.next()){var f=u.value;c+=f.getNumDataCodewords()}}catch(b){r={error:b}}finally{try{u&&!u.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}for(var A=new Uint8Array(c),h=l.length,m=0;m<h;m++){var p=l[m],x=p.getCodewords(),v=p.getNumDataCodewords();this.correctErrors(x,v);for(var y=0;y<v;y++)A[y*h+m]=x[y]}return T7e.decode(A)},t.prototype.correctErrors=function(e,r){var n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-r)}catch{throw new wo}for(var a=0;a<r;a++)e[a]=n[a]},t}(),F7e=function(){function t(e){this.image=e,this.rectangleDetector=new bF(this.image)}return t.prototype.detect=function(){var e=this.rectangleDetector.detect(),r=this.detectSolid1(e);if(r=this.detectSolid2(r),r[3]=this.correctTopRight(r),!r[3])throw new Ar;r=this.shiftToModuleCenter(r);var n=r[0],a=r[1],s=r[2],o=r[3],l=this.transitionsBetween(n,o)+1,c=this.transitionsBetween(s,o)+1;(l&1)===1&&(l+=1),(c&1)===1&&(c+=1),4*l<7*c&&4*c<7*l&&(l=c=Math.max(l,c));var d=t.sampleGrid(this.image,n,a,s,o,l,c);return new zR(d,[n,a,s,o])},t.shiftPoint=function(e,r,n){var a=(r.getX()-e.getX())/(n+1),s=(r.getY()-e.getY())/(n+1);return new Cn(e.getX()+a,e.getY()+s)},t.moveAway=function(e,r,n){var a=e.getX(),s=e.getY();return a<r?a-=1:a+=1,s<n?s-=1:s+=1,new Cn(a,s)},t.prototype.detectSolid1=function(e){var r=e[0],n=e[1],a=e[3],s=e[2],o=this.transitionsBetween(r,n),l=this.transitionsBetween(n,a),c=this.transitionsBetween(a,s),d=this.transitionsBetween(s,r),u=o,f=[s,r,n,a];return u>l&&(u=l,f[0]=r,f[1]=n,f[2]=a,f[3]=s),u>c&&(u=c,f[0]=n,f[1]=a,f[2]=s,f[3]=r),u>d&&(f[0]=a,f[1]=s,f[2]=r,f[3]=n),f},t.prototype.detectSolid2=function(e){var r=e[0],n=e[1],a=e[2],s=e[3],o=this.transitionsBetween(r,s),l=t.shiftPoint(n,a,(o+1)*4),c=t.shiftPoint(a,n,(o+1)*4),d=this.transitionsBetween(l,r),u=this.transitionsBetween(c,s);return d<u?(e[0]=r,e[1]=n,e[2]=a,e[3]=s):(e[0]=n,e[1]=a,e[2]=s,e[3]=r),e},t.prototype.correctTopRight=function(e){var r=e[0],n=e[1],a=e[2],s=e[3],o=this.transitionsBetween(r,s),l=this.transitionsBetween(n,s),c=t.shiftPoint(r,n,(l+1)*4),d=t.shiftPoint(a,n,(o+1)*4);o=this.transitionsBetween(c,s),l=this.transitionsBetween(d,s);var u=new Cn(s.getX()+(a.getX()-n.getX())/(o+1),s.getY()+(a.getY()-n.getY())/(o+1)),f=new Cn(s.getX()+(r.getX()-n.getX())/(l+1),s.getY()+(r.getY()-n.getY())/(l+1));if(!this.isValid(u))return this.isValid(f)?f:null;if(!this.isValid(f))return u;var A=this.transitionsBetween(c,u)+this.transitionsBetween(d,u),h=this.transitionsBetween(c,f)+this.transitionsBetween(d,f);return A>h?u:f},t.prototype.shiftToModuleCenter=function(e){var r=e[0],n=e[1],a=e[2],s=e[3],o=this.transitionsBetween(r,s)+1,l=this.transitionsBetween(a,s)+1,c=t.shiftPoint(r,n,l*4),d=t.shiftPoint(a,n,o*4);o=this.transitionsBetween(c,s)+1,l=this.transitionsBetween(d,s)+1,(o&1)===1&&(o+=1),(l&1)===1&&(l+=1);var u=(r.getX()+n.getX()+a.getX()+s.getX())/4,f=(r.getY()+n.getY()+a.getY()+s.getY())/4;r=t.moveAway(r,u,f),n=t.moveAway(n,u,f),a=t.moveAway(a,u,f),s=t.moveAway(s,u,f);var A,h;return c=t.shiftPoint(r,n,l*4),c=t.shiftPoint(c,s,o*4),A=t.shiftPoint(n,r,l*4),A=t.shiftPoint(A,a,o*4),d=t.shiftPoint(a,s,l*4),d=t.shiftPoint(d,n,o*4),h=t.shiftPoint(s,a,l*4),h=t.shiftPoint(h,r,o*4),[c,A,d,h]},t.prototype.isValid=function(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()},t.sampleGrid=function(e,r,n,a,s,o,l){var c=WR.getInstance();return c.sampleGrid(e,o,l,.5,.5,o-.5,.5,o-.5,l-.5,.5,l-.5,r.getX(),r.getY(),s.getX(),s.getY(),a.getX(),a.getY(),n.getX(),n.getY())},t.prototype.transitionsBetween=function(e,r){var n=Math.trunc(e.getX()),a=Math.trunc(e.getY()),s=Math.trunc(r.getX()),o=Math.trunc(r.getY()),l=Math.abs(o-a)>Math.abs(s-n);if(l){var c=n;n=a,a=c,c=s,s=o,o=c}for(var d=Math.abs(s-n),u=Math.abs(o-a),f=-d/2,A=a<o?1:-1,h=n<s?1:-1,m=0,p=this.image.get(l?a:n,l?n:a),x=n,v=a;x!==s;x+=h){var y=this.image.get(l?v:x,l?x:v);if(y!==p&&(m++,p=y),f+=u,f>0){if(v===o)break;v+=A,f-=d}}return m},t}(),cj=function(){function t(){this.decoder=new k7e}return t.prototype.decode=function(e,r){r===void 0&&(r=null);var n,a;if(r!=null&&r.has(Ls.PURE_BARCODE)){var s=t.extractPureBits(e.getBlackMatrix());n=this.decoder.decode(s),a=t.NO_POINTS}else{var o=new F7e(e.getBlackMatrix()).detect();n=this.decoder.decode(o.getBits()),a=o.getPoints()}var l=n.getRawBytes(),c=new Nc(n.getText(),l,8*l.length,a,Qn.DATA_MATRIX,Ms.currentTimeMillis()),d=n.getByteSegments();d!=null&&c.putMetadata(Vl.BYTE_SEGMENTS,d);var u=n.getECLevel();return u!=null&&c.putMetadata(Vl.ERROR_CORRECTION_LEVEL,u),c},t.prototype.reset=function(){},t.extractPureBits=function(e){var r=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(r==null||n==null)throw new Ar;var a=this.moduleSize(r,e),s=r[1],o=n[1],l=r[0],c=n[0],d=(c-l+1)/a,u=(o-s+1)/a;if(d<=0||u<=0)throw new Ar;var f=a/2;s+=f,l+=f;for(var A=new fh(d,u),h=0;h<u;h++)for(var m=s+h*a,p=0;p<d;p++)e.get(l+p*a,m)&&A.set(p,h);return A},t.moduleSize=function(e,r){for(var n=r.getWidth(),a=e[0],s=e[1];a<n&&r.get(a,s);)a++;if(a===n)throw new Ar;var o=a-e[0];if(o===0)throw new Ar;return o},t.NO_POINTS=[],t}(),O7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){O7e(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new cj,r)||this}return e})(P1);var nv;(function(t){t[t.L=0]="L",t[t.M=1]="M",t[t.Q=2]="Q",t[t.H=3]="H"})(nv||(nv={}));var D7e=function(){function t(e,r,n){this.value=e,this.stringValue=r,this.bits=n,t.FOR_BITS.set(n,this),t.FOR_VALUE.set(e,this)}return t.prototype.getValue=function(){return this.value},t.prototype.getBits=function(){return this.bits},t.fromString=function(e){switch(e){case"L":return t.L;case"M":return t.M;case"Q":return t.Q;case"H":return t.H;default:throw new no(e+"not available")}},t.prototype.toString=function(){return this.stringValue},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value},t.forBits=function(e){if(e<0||e>=t.FOR_BITS.size)throw new Vn;return t.FOR_BITS.get(e)},t.FOR_BITS=new Map,t.FOR_VALUE=new Map,t.L=new t(nv.L,"L",1),t.M=new t(nv.M,"M",0),t.Q=new t(nv.Q,"Q",3),t.H=new t(nv.H,"H",2),t}(),R7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Vse=function(){function t(e){this.errorCorrectionLevel=D7e.forBits(e>>3&3),this.dataMask=e&7}return t.numBitsDiffering=function(e,r){return ba.bitCount(e^r)},t.decodeFormatInformation=function(e,r){var n=t.doDecodeFormatInformation(e,r);return n!==null?n:t.doDecodeFormatInformation(e^t.FORMAT_INFO_MASK_QR,r^t.FORMAT_INFO_MASK_QR)},t.doDecodeFormatInformation=function(e,r){var n,a,s=Number.MAX_SAFE_INTEGER,o=0;try{for(var l=R7e(t.FORMAT_INFO_DECODE_LOOKUP),c=l.next();!c.done;c=l.next()){var d=c.value,u=d[0];if(u===e||u===r)return new t(d[1]);var f=t.numBitsDiffering(e,u);f<s&&(o=d[1],s=f),e!==r&&(f=t.numBitsDiffering(r,u),f<s&&(o=d[1],s=f))}}catch(A){n={error:A}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}return s<=3?new t(o):null},t.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},t.prototype.getDataMask=function(){return this.dataMask},t.prototype.hashCode=function(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.errorCorrectionLevel===r.errorCorrectionLevel&&this.dataMask===r.dataMask},t.FORMAT_INFO_MASK_QR=21522,t.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])],t}(),M7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},zt=function(){function t(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.ecCodewordsPerBlock=e,this.ecBlocks=r}return t.prototype.getECCodewordsPerBlock=function(){return this.ecCodewordsPerBlock},t.prototype.getNumBlocks=function(){var e,r,n=0,a=this.ecBlocks;try{for(var s=M7e(a),o=s.next();!o.done;o=s.next()){var l=o.value;n+=l.getCount()}}catch(c){e={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return n},t.prototype.getTotalECCodewords=function(){return this.ecCodewordsPerBlock*this.getNumBlocks()},t.prototype.getECBlocks=function(){return this.ecBlocks},t}(),lt=function(){function t(e,r){this.count=e,this.dataCodewords=r}return t.prototype.getCount=function(){return this.count},t.prototype.getDataCodewords=function(){return this.dataCodewords},t}(),L7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Xp=function(){function t(e,r){for(var n,a,s=[],o=2;o<arguments.length;o++)s[o-2]=arguments[o];this.versionNumber=e,this.alignmentPatternCenters=r,this.ecBlocks=s;var l=0,c=s[0].getECCodewordsPerBlock(),d=s[0].getECBlocks();try{for(var u=L7e(d),f=u.next();!f.done;f=u.next()){var A=f.value;l+=A.getCount()*(A.getDataCodewords()+c)}}catch(h){n={error:h}}finally{try{f&&!f.done&&(a=u.return)&&a.call(u)}finally{if(n)throw n.error}}this.totalCodewords=l}return t.prototype.getVersionNumber=function(){return this.versionNumber},t.prototype.getAlignmentPatternCenters=function(){return this.alignmentPatternCenters},t.prototype.getTotalCodewords=function(){return this.totalCodewords},t.prototype.getDimensionForVersion=function(){return 17+4*this.versionNumber},t.prototype.getECBlocksForLevel=function(e){return this.ecBlocks[e.getValue()]},t.getProvisionalVersionForDimension=function(e){if(e%4!==1)throw new Zr;try{return this.getVersionForNumber((e-17)/4)}catch{throw new Zr}},t.getVersionForNumber=function(e){if(e<1||e>40)throw new Vn;return t.VERSIONS[e-1]},t.decodeVersionInformation=function(e){for(var r=Number.MAX_SAFE_INTEGER,n=0,a=0;a<t.VERSION_DECODE_INFO.length;a++){var s=t.VERSION_DECODE_INFO[a];if(s===e)return t.getVersionForNumber(a+7);var o=Vse.numBitsDiffering(e,s);o<r&&(n=a+7,r=o)}return r<=3?t.getVersionForNumber(n):null},t.prototype.buildFunctionPattern=function(){var e=this.getDimensionForVersion(),r=new fh(e);r.setRegion(0,0,9,9),r.setRegion(e-8,0,8,9),r.setRegion(0,e-8,9,8);for(var n=this.alignmentPatternCenters.length,a=0;a<n;a++)for(var s=this.alignmentPatternCenters[a]-2,o=0;o<n;o++)a===0&&(o===0||o===n-1)||a===n-1&&o===0||r.setRegion(this.alignmentPatternCenters[o]-2,s,5,5);return r.setRegion(6,9,1,e-17),r.setRegion(9,6,e-17,1),this.versionNumber>6&&(r.setRegion(e-11,0,3,6),r.setRegion(0,e-11,6,3)),r},t.prototype.toString=function(){return""+this.versionNumber},t.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),t.VERSIONS=[new t(1,new Int32Array(0),new zt(7,new lt(1,19)),new zt(10,new lt(1,16)),new zt(13,new lt(1,13)),new zt(17,new lt(1,9))),new t(2,Int32Array.from([6,18]),new zt(10,new lt(1,34)),new zt(16,new lt(1,28)),new zt(22,new lt(1,22)),new zt(28,new lt(1,16))),new t(3,Int32Array.from([6,22]),new zt(15,new lt(1,55)),new zt(26,new lt(1,44)),new zt(18,new lt(2,17)),new zt(22,new lt(2,13))),new t(4,Int32Array.from([6,26]),new zt(20,new lt(1,80)),new zt(18,new lt(2,32)),new zt(26,new lt(2,24)),new zt(16,new lt(4,9))),new t(5,Int32Array.from([6,30]),new zt(26,new lt(1,108)),new zt(24,new lt(2,43)),new zt(18,new lt(2,15),new lt(2,16)),new zt(22,new lt(2,11),new lt(2,12))),new t(6,Int32Array.from([6,34]),new zt(18,new lt(2,68)),new zt(16,new lt(4,27)),new zt(24,new lt(4,19)),new zt(28,new lt(4,15))),new t(7,Int32Array.from([6,22,38]),new zt(20,new lt(2,78)),new zt(18,new lt(4,31)),new zt(18,new lt(2,14),new lt(4,15)),new zt(26,new lt(4,13),new lt(1,14))),new t(8,Int32Array.from([6,24,42]),new zt(24,new lt(2,97)),new zt(22,new lt(2,38),new lt(2,39)),new zt(22,new lt(4,18),new lt(2,19)),new zt(26,new lt(4,14),new lt(2,15))),new t(9,Int32Array.from([6,26,46]),new zt(30,new lt(2,116)),new zt(22,new lt(3,36),new lt(2,37)),new zt(20,new lt(4,16),new lt(4,17)),new zt(24,new lt(4,12),new lt(4,13))),new t(10,Int32Array.from([6,28,50]),new zt(18,new lt(2,68),new lt(2,69)),new zt(26,new lt(4,43),new lt(1,44)),new zt(24,new lt(6,19),new lt(2,20)),new zt(28,new lt(6,15),new lt(2,16))),new t(11,Int32Array.from([6,30,54]),new zt(20,new lt(4,81)),new zt(30,new lt(1,50),new lt(4,51)),new zt(28,new lt(4,22),new lt(4,23)),new zt(24,new lt(3,12),new lt(8,13))),new t(12,Int32Array.from([6,32,58]),new zt(24,new lt(2,92),new lt(2,93)),new zt(22,new lt(6,36),new lt(2,37)),new zt(26,new lt(4,20),new lt(6,21)),new zt(28,new lt(7,14),new lt(4,15))),new t(13,Int32Array.from([6,34,62]),new zt(26,new lt(4,107)),new zt(22,new lt(8,37),new lt(1,38)),new zt(24,new lt(8,20),new lt(4,21)),new zt(22,new lt(12,11),new lt(4,12))),new t(14,Int32Array.from([6,26,46,66]),new zt(30,new lt(3,115),new lt(1,116)),new zt(24,new lt(4,40),new lt(5,41)),new zt(20,new lt(11,16),new lt(5,17)),new zt(24,new lt(11,12),new lt(5,13))),new t(15,Int32Array.from([6,26,48,70]),new zt(22,new lt(5,87),new lt(1,88)),new zt(24,new lt(5,41),new lt(5,42)),new zt(30,new lt(5,24),new lt(7,25)),new zt(24,new lt(11,12),new lt(7,13))),new t(16,Int32Array.from([6,26,50,74]),new zt(24,new lt(5,98),new lt(1,99)),new zt(28,new lt(7,45),new lt(3,46)),new zt(24,new lt(15,19),new lt(2,20)),new zt(30,new lt(3,15),new lt(13,16))),new t(17,Int32Array.from([6,30,54,78]),new zt(28,new lt(1,107),new lt(5,108)),new zt(28,new lt(10,46),new lt(1,47)),new zt(28,new lt(1,22),new lt(15,23)),new zt(28,new lt(2,14),new lt(17,15))),new t(18,Int32Array.from([6,30,56,82]),new zt(30,new lt(5,120),new lt(1,121)),new zt(26,new lt(9,43),new lt(4,44)),new zt(28,new lt(17,22),new lt(1,23)),new zt(28,new lt(2,14),new lt(19,15))),new t(19,Int32Array.from([6,30,58,86]),new zt(28,new lt(3,113),new lt(4,114)),new zt(26,new lt(3,44),new lt(11,45)),new zt(26,new lt(17,21),new lt(4,22)),new zt(26,new lt(9,13),new lt(16,14))),new t(20,Int32Array.from([6,34,62,90]),new zt(28,new lt(3,107),new lt(5,108)),new zt(26,new lt(3,41),new lt(13,42)),new zt(30,new lt(15,24),new lt(5,25)),new zt(28,new lt(15,15),new lt(10,16))),new t(21,Int32Array.from([6,28,50,72,94]),new zt(28,new lt(4,116),new lt(4,117)),new zt(26,new lt(17,42)),new zt(28,new lt(17,22),new lt(6,23)),new zt(30,new lt(19,16),new lt(6,17))),new t(22,Int32Array.from([6,26,50,74,98]),new zt(28,new lt(2,111),new lt(7,112)),new zt(28,new lt(17,46)),new zt(30,new lt(7,24),new lt(16,25)),new zt(24,new lt(34,13))),new t(23,Int32Array.from([6,30,54,78,102]),new zt(30,new lt(4,121),new lt(5,122)),new zt(28,new lt(4,47),new lt(14,48)),new zt(30,new lt(11,24),new lt(14,25)),new zt(30,new lt(16,15),new lt(14,16))),new t(24,Int32Array.from([6,28,54,80,106]),new zt(30,new lt(6,117),new lt(4,118)),new zt(28,new lt(6,45),new lt(14,46)),new zt(30,new lt(11,24),new lt(16,25)),new zt(30,new lt(30,16),new lt(2,17))),new t(25,Int32Array.from([6,32,58,84,110]),new zt(26,new lt(8,106),new lt(4,107)),new zt(28,new lt(8,47),new lt(13,48)),new zt(30,new lt(7,24),new lt(22,25)),new zt(30,new lt(22,15),new lt(13,16))),new t(26,Int32Array.from([6,30,58,86,114]),new zt(28,new lt(10,114),new lt(2,115)),new zt(28,new lt(19,46),new lt(4,47)),new zt(28,new lt(28,22),new lt(6,23)),new zt(30,new lt(33,16),new lt(4,17))),new t(27,Int32Array.from([6,34,62,90,118]),new zt(30,new lt(8,122),new lt(4,123)),new zt(28,new lt(22,45),new lt(3,46)),new zt(30,new lt(8,23),new lt(26,24)),new zt(30,new lt(12,15),new lt(28,16))),new t(28,Int32Array.from([6,26,50,74,98,122]),new zt(30,new lt(3,117),new lt(10,118)),new zt(28,new lt(3,45),new lt(23,46)),new zt(30,new lt(4,24),new lt(31,25)),new zt(30,new lt(11,15),new lt(31,16))),new t(29,Int32Array.from([6,30,54,78,102,126]),new zt(30,new lt(7,116),new lt(7,117)),new zt(28,new lt(21,45),new lt(7,46)),new zt(30,new lt(1,23),new lt(37,24)),new zt(30,new lt(19,15),new lt(26,16))),new t(30,Int32Array.from([6,26,52,78,104,130]),new zt(30,new lt(5,115),new lt(10,116)),new zt(28,new lt(19,47),new lt(10,48)),new zt(30,new lt(15,24),new lt(25,25)),new zt(30,new lt(23,15),new lt(25,16))),new t(31,Int32Array.from([6,30,56,82,108,134]),new zt(30,new lt(13,115),new lt(3,116)),new zt(28,new lt(2,46),new lt(29,47)),new zt(30,new lt(42,24),new lt(1,25)),new zt(30,new lt(23,15),new lt(28,16))),new t(32,Int32Array.from([6,34,60,86,112,138]),new zt(30,new lt(17,115)),new zt(28,new lt(10,46),new lt(23,47)),new zt(30,new lt(10,24),new lt(35,25)),new zt(30,new lt(19,15),new lt(35,16))),new t(33,Int32Array.from([6,30,58,86,114,142]),new zt(30,new lt(17,115),new lt(1,116)),new zt(28,new lt(14,46),new lt(21,47)),new zt(30,new lt(29,24),new lt(19,25)),new zt(30,new lt(11,15),new lt(46,16))),new t(34,Int32Array.from([6,34,62,90,118,146]),new zt(30,new lt(13,115),new lt(6,116)),new zt(28,new lt(14,46),new lt(23,47)),new zt(30,new lt(44,24),new lt(7,25)),new zt(30,new lt(59,16),new lt(1,17))),new t(35,Int32Array.from([6,30,54,78,102,126,150]),new zt(30,new lt(12,121),new lt(7,122)),new zt(28,new lt(12,47),new lt(26,48)),new zt(30,new lt(39,24),new lt(14,25)),new zt(30,new lt(22,15),new lt(41,16))),new t(36,Int32Array.from([6,24,50,76,102,128,154]),new zt(30,new lt(6,121),new lt(14,122)),new zt(28,new lt(6,47),new lt(34,48)),new zt(30,new lt(46,24),new lt(10,25)),new zt(30,new lt(2,15),new lt(64,16))),new t(37,Int32Array.from([6,28,54,80,106,132,158]),new zt(30,new lt(17,122),new lt(4,123)),new zt(28,new lt(29,46),new lt(14,47)),new zt(30,new lt(49,24),new lt(10,25)),new zt(30,new lt(24,15),new lt(46,16))),new t(38,Int32Array.from([6,32,58,84,110,136,162]),new zt(30,new lt(4,122),new lt(18,123)),new zt(28,new lt(13,46),new lt(32,47)),new zt(30,new lt(48,24),new lt(14,25)),new zt(30,new lt(42,15),new lt(32,16))),new t(39,Int32Array.from([6,26,54,82,110,138,166]),new zt(30,new lt(20,117),new lt(4,118)),new zt(28,new lt(40,47),new lt(7,48)),new zt(30,new lt(43,24),new lt(22,25)),new zt(30,new lt(10,15),new lt(67,16))),new t(40,Int32Array.from([6,30,58,86,114,142,170]),new zt(30,new lt(19,118),new lt(6,119)),new zt(28,new lt(18,47),new lt(31,48)),new zt(30,new lt(34,24),new lt(34,25)),new zt(30,new lt(20,15),new lt(61,16)))],t}(),al;(function(t){t[t.DATA_MASK_000=0]="DATA_MASK_000",t[t.DATA_MASK_001=1]="DATA_MASK_001",t[t.DATA_MASK_010=2]="DATA_MASK_010",t[t.DATA_MASK_011=3]="DATA_MASK_011",t[t.DATA_MASK_100=4]="DATA_MASK_100",t[t.DATA_MASK_101=5]="DATA_MASK_101",t[t.DATA_MASK_110=6]="DATA_MASK_110",t[t.DATA_MASK_111=7]="DATA_MASK_111"})(al||(al={}));var aG=function(){function t(e,r){this.value=e,this.isMasked=r}return t.prototype.unmaskBitMatrix=function(e,r){for(var n=0;n<r;n++)for(var a=0;a<r;a++)this.isMasked(n,a)&&e.flip(a,n)},t.values=new Map([[al.DATA_MASK_000,new t(al.DATA_MASK_000,function(e,r){return(e+r&1)===0})],[al.DATA_MASK_001,new t(al.DATA_MASK_001,function(e,r){return(e&1)===0})],[al.DATA_MASK_010,new t(al.DATA_MASK_010,function(e,r){return r%3===0})],[al.DATA_MASK_011,new t(al.DATA_MASK_011,function(e,r){return(e+r)%3===0})],[al.DATA_MASK_100,new t(al.DATA_MASK_100,function(e,r){return(Math.floor(e/2)+Math.floor(r/3)&1)===0})],[al.DATA_MASK_101,new t(al.DATA_MASK_101,function(e,r){return e*r%6===0})],[al.DATA_MASK_110,new t(al.DATA_MASK_110,function(e,r){return e*r%6<3})],[al.DATA_MASK_111,new t(al.DATA_MASK_111,function(e,r){return(e+r+e*r%3&1)===0})]]),t}(),U7e=function(){function t(e){var r=e.getHeight();if(r<21||(r&3)!==1)throw new Zr;this.bitMatrix=e}return t.prototype.readFormatInformation=function(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;for(var e=0,r=0;r<6;r++)e=this.copyBit(r,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(var n=5;n>=0;n--)e=this.copyBit(8,n,e);for(var a=this.bitMatrix.getHeight(),s=0,o=a-7,n=a-1;n>=o;n--)s=this.copyBit(8,n,s);for(var r=a-8;r<a;r++)s=this.copyBit(r,8,s);if(this.parsedFormatInfo=Vse.decodeFormatInformation(e,s),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new Zr},t.prototype.readVersion=function(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;var e=this.bitMatrix.getHeight(),r=Math.floor((e-17)/4);if(r<=6)return Xp.getVersionForNumber(r);for(var n=0,a=e-11,s=5;s>=0;s--)for(var o=e-9;o>=a;o--)n=this.copyBit(o,s,n);var l=Xp.decodeVersionInformation(n);if(l!==null&&l.getDimensionForVersion()===e)return this.parsedVersion=l,l;n=0;for(var o=5;o>=0;o--)for(var s=e-9;s>=a;s--)n=this.copyBit(o,s,n);if(l=Xp.decodeVersionInformation(n),l!==null&&l.getDimensionForVersion()===e)return this.parsedVersion=l,l;throw new Zr},t.prototype.copyBit=function(e,r,n){var a=this.isMirror?this.bitMatrix.get(r,e):this.bitMatrix.get(e,r);return a?n<<1|1:n<<1},t.prototype.readCodewords=function(){var e=this.readFormatInformation(),r=this.readVersion(),n=aG.values.get(e.getDataMask()),a=this.bitMatrix.getHeight();n.unmaskBitMatrix(this.bitMatrix,a);for(var s=r.buildFunctionPattern(),o=!0,l=new Uint8Array(r.getTotalCodewords()),c=0,d=0,u=0,f=a-1;f>0;f-=2){f===6&&f--;for(var A=0;A<a;A++)for(var h=o?a-1-A:A,m=0;m<2;m++)s.get(f-m,h)||(u++,d<<=1,this.bitMatrix.get(f-m,h)&&(d|=1),u===8&&(l[c++]=d,u=0,d=0));o=!o}if(c!==r.getTotalCodewords())throw new Zr;return l},t.prototype.remask=function(){if(this.parsedFormatInfo!==null){var e=aG.values.get(this.parsedFormatInfo.getDataMask()),r=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,r)}},t.prototype.setMirror=function(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e},t.prototype.mirror=function(){for(var e=this.bitMatrix,r=0,n=e.getWidth();r<n;r++)for(var a=r+1,s=e.getHeight();a<s;a++)e.get(r,a)!==e.get(a,r)&&(e.flip(a,r),e.flip(r,a))},t}(),sG=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Q7e=function(){function t(e,r){this.numDataCodewords=e,this.codewords=r}return t.getDataBlocks=function(e,r,n){var a,s,o,l;if(e.length!==r.getTotalCodewords())throw new Vn;var c=r.getECBlocksForLevel(n),d=0,u=c.getECBlocks();try{for(var f=sG(u),A=f.next();!A.done;A=f.next()){var h=A.value;d+=h.getCount()}}catch(P){a={error:P}}finally{try{A&&!A.done&&(s=f.return)&&s.call(f)}finally{if(a)throw a.error}}var m=new Array(d),p=0;try{for(var x=sG(u),v=x.next();!v.done;v=x.next())for(var h=v.value,y=0;y<h.getCount();y++){var b=h.getDataCodewords(),w=c.getECCodewordsPerBlock()+b;m[p++]=new t(b,new Uint8Array(w))}}catch(P){o={error:P}}finally{try{v&&!v.done&&(l=x.return)&&l.call(x)}finally{if(o)throw o.error}}for(var I=m[0].codewords.length,j=m.length-1;j>=0;){var N=m[j].codewords.length;if(N===I)break;j--}j++;for(var S=I-c.getECCodewordsPerBlock(),E=0,y=0;y<S;y++)for(var B=0;B<p;B++)m[B].codewords[y]=e[E++];for(var B=j;B<p;B++)m[B].codewords[S]=e[E++];for(var k=m[0].codewords.length,y=S;y<k;y++)for(var B=0;B<p;B++){var T=B<j?y:y+1;m[B].codewords[T]=e[E++]}return m},t.prototype.getNumDataCodewords=function(){return this.numDataCodewords},t.prototype.getCodewords=function(){return this.codewords},t}(),xu;(function(t){t[t.TERMINATOR=0]="TERMINATOR",t[t.NUMERIC=1]="NUMERIC",t[t.ALPHANUMERIC=2]="ALPHANUMERIC",t[t.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",t[t.BYTE=4]="BYTE",t[t.ECI=5]="ECI",t[t.KANJI=6]="KANJI",t[t.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",t[t.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",t[t.HANZI=9]="HANZI"})(xu||(xu={}));var qs=function(){function t(e,r,n,a){this.value=e,this.stringValue=r,this.characterCountBitsForVersions=n,this.bits=a,t.FOR_BITS.set(a,this),t.FOR_VALUE.set(e,this)}return t.forBits=function(e){var r=t.FOR_BITS.get(e);if(r===void 0)throw new Vn;return r},t.prototype.getCharacterCountBits=function(e){var r=e.getVersionNumber(),n;return r<=9?n=0:r<=26?n=1:n=2,this.characterCountBitsForVersions[n]},t.prototype.getValue=function(){return this.value},t.prototype.getBits=function(){return this.bits},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value},t.prototype.toString=function(){return this.stringValue},t.FOR_BITS=new Map,t.FOR_VALUE=new Map,t.TERMINATOR=new t(xu.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),t.NUMERIC=new t(xu.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),t.ALPHANUMERIC=new t(xu.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),t.STRUCTURED_APPEND=new t(xu.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),t.BYTE=new t(xu.BYTE,"BYTE",Int32Array.from([8,16,16]),4),t.ECI=new t(xu.ECI,"ECI",Int32Array.from([0,0,0]),7),t.KANJI=new t(xu.KANJI,"KANJI",Int32Array.from([8,10,12]),8),t.FNC1_FIRST_POSITION=new t(xu.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),t.FNC1_SECOND_POSITION=new t(xu.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),t.HANZI=new t(xu.HANZI,"HANZI",Int32Array.from([8,10,12]),13),t}(),V7e=function(){function t(){}return t.decode=function(e,r,n,a){var s=new Qse(e),o=new ga,l=new Array,c=-1,d=-1;try{var u=null,f=!1,A=void 0;do{if(s.available()<4)A=qs.TERMINATOR;else{var h=s.readBits(4);A=qs.forBits(h)}switch(A){case qs.TERMINATOR:break;case qs.FNC1_FIRST_POSITION:case qs.FNC1_SECOND_POSITION:f=!0;break;case qs.STRUCTURED_APPEND:if(s.available()<16)throw new Zr;c=s.readBits(8),d=s.readBits(8);break;case qs.ECI:var m=t.parseECIValue(s);if(u=Qo.getCharacterSetECIByValue(m),u===null)throw new Zr;break;case qs.HANZI:var p=s.readBits(4),x=s.readBits(A.getCharacterCountBits(r));p===t.GB2312_SUBSET&&t.decodeHanziSegment(s,o,x);break;default:var v=s.readBits(A.getCharacterCountBits(r));switch(A){case qs.NUMERIC:t.decodeNumericSegment(s,o,v);break;case qs.ALPHANUMERIC:t.decodeAlphanumericSegment(s,o,v,f);break;case qs.BYTE:t.decodeByteSegment(s,o,v,u,l,a);break;case qs.KANJI:t.decodeKanjiSegment(s,o,v);break;default:throw new Zr}break}}while(A!==qs.TERMINATOR)}catch{throw new Zr}return new EP(e,o.toString(),l.length===0?null:l,n===null?null:n.toString(),c,d)},t.decodeHanziSegment=function(e,r,n){if(n*13>e.available())throw new Zr;for(var a=new Uint8Array(2*n),s=0;n>0;){var o=e.readBits(13),l=o/96<<8&4294967295|o%96;l<959?l+=41377:l+=42657,a[s]=l>>8&255,a[s+1]=l&255,s+=2,n--}try{r.append(Du.decode(a,Oa.GB2312))}catch(c){throw new Zr(c)}},t.decodeKanjiSegment=function(e,r,n){if(n*13>e.available())throw new Zr;for(var a=new Uint8Array(2*n),s=0;n>0;){var o=e.readBits(13),l=o/192<<8&4294967295|o%192;l<7936?l+=33088:l+=49472,a[s]=l>>8,a[s+1]=l,s+=2,n--}try{r.append(Du.decode(a,Oa.SHIFT_JIS))}catch(c){throw new Zr(c)}},t.decodeByteSegment=function(e,r,n,a,s,o){if(8*n>e.available())throw new Zr;for(var l=new Uint8Array(n),c=0;c<n;c++)l[c]=e.readBits(8);var d;a===null?d=Oa.guessEncoding(l,o):d=a.getName();try{r.append(Du.decode(l,d))}catch(u){throw new Zr(u)}s.push(l)},t.toAlphaNumericChar=function(e){if(e>=t.ALPHANUMERIC_CHARS.length)throw new Zr;return t.ALPHANUMERIC_CHARS[e]},t.decodeAlphanumericSegment=function(e,r,n,a){for(var s=r.length();n>1;){if(e.available()<11)throw new Zr;var o=e.readBits(11);r.append(t.toAlphaNumericChar(Math.floor(o/45))),r.append(t.toAlphaNumericChar(o%45)),n-=2}if(n===1){if(e.available()<6)throw new Zr;r.append(t.toAlphaNumericChar(e.readBits(6)))}if(a)for(var l=s;l<r.length();l++)r.charAt(l)==="%"&&(l<r.length()-1&&r.charAt(l+1)==="%"?r.deleteCharAt(l+1):r.setCharAt(l,""))},t.decodeNumericSegment=function(e,r,n){for(;n>=3;){if(e.available()<10)throw new Zr;var a=e.readBits(10);if(a>=1e3)throw new Zr;r.append(t.toAlphaNumericChar(Math.floor(a/100))),r.append(t.toAlphaNumericChar(Math.floor(a/10)%10)),r.append(t.toAlphaNumericChar(a%10)),n-=3}if(n===2){if(e.available()<7)throw new Zr;var s=e.readBits(7);if(s>=100)throw new Zr;r.append(t.toAlphaNumericChar(Math.floor(s/10))),r.append(t.toAlphaNumericChar(s%10))}else if(n===1){if(e.available()<4)throw new Zr;var o=e.readBits(4);if(o>=10)throw new Zr;r.append(t.toAlphaNumericChar(o))}},t.parseECIValue=function(e){var r=e.readBits(8);if(!(r&128))return r&127;if((r&192)===128){var n=e.readBits(8);return(r&63)<<8&4294967295|n}if((r&224)===192){var a=e.readBits(16);return(r&31)<<16&4294967295|a}throw new Zr},t.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",t.GB2312_SUBSET=1,t}(),Hse=function(){function t(e){this.mirrored=e}return t.prototype.isMirrored=function(){return this.mirrored},t.prototype.applyMirroredCorrection=function(e){if(!(!this.mirrored||e===null||e.length<3)){var r=e[0];e[0]=e[2],e[2]=r}},t}(),iG=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},H7e=function(){function t(){this.rsDecoder=new SP(od.QR_CODE_FIELD_256)}return t.prototype.decodeBooleanArray=function(e,r){return this.decodeBitMatrix(fh.parseFromBooleanArray(e),r)},t.prototype.decodeBitMatrix=function(e,r){var n=new U7e(e),a=null;try{return this.decodeBitMatrixParser(n,r)}catch(o){a=o}try{n.remask(),n.setMirror(!0),n.readVersion(),n.readFormatInformation(),n.mirror();var s=this.decodeBitMatrixParser(n,r);return s.setOther(new Hse(!0)),s}catch(o){throw a!==null?a:o}},t.prototype.decodeBitMatrixParser=function(e,r){var n,a,s,o,l=e.readVersion(),c=e.readFormatInformation().getErrorCorrectionLevel(),d=e.readCodewords(),u=Q7e.getDataBlocks(d,l,c),f=0;try{for(var A=iG(u),h=A.next();!h.done;h=A.next()){var m=h.value;f+=m.getNumDataCodewords()}}catch(j){n={error:j}}finally{try{h&&!h.done&&(a=A.return)&&a.call(A)}finally{if(n)throw n.error}}var p=new Uint8Array(f),x=0;try{for(var v=iG(u),y=v.next();!y.done;y=v.next()){var m=y.value,b=m.getCodewords(),w=m.getNumDataCodewords();this.correctErrors(b,w);for(var I=0;I<w;I++)p[x++]=b[I]}}catch(j){s={error:j}}finally{try{y&&!y.done&&(o=v.return)&&o.call(v)}finally{if(s)throw s.error}}return V7e.decode(p,l,c,r)},t.prototype.correctErrors=function(e,r){var n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-r)}catch{throw new wo}for(var a=0;a<r;a++)e[a]=n[a]},t}(),$7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),G7e=function(t){$7e(e,t);function e(r,n,a){var s=t.call(this,r,n)||this;return s.estimatedModuleSize=a,s}return e.prototype.aboutEquals=function(r,n,a){if(Math.abs(n-this.getY())<=r&&Math.abs(a-this.getX())<=r){var s=Math.abs(r-this.estimatedModuleSize);return s<=1||s<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(r,n,a){var s=(this.getX()+n)/2,o=(this.getY()+r)/2,l=(this.estimatedModuleSize+a)/2;return new e(s,o,l)},e}(Cn),K7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},q7e=function(){function t(e,r,n,a,s,o,l){this.image=e,this.startX=r,this.startY=n,this.width=a,this.height=s,this.moduleSize=o,this.resultPointCallback=l,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}return t.prototype.find=function(){for(var e=this.startX,r=this.height,n=this.width,a=e+n,s=this.startY+r/2,o=new Int32Array(3),l=this.image,c=0;c<r;c++){var d=s+(c&1?-Math.floor((c+1)/2):Math.floor((c+1)/2));o[0]=0,o[1]=0,o[2]=0;for(var u=e;u<a&&!l.get(u,d);)u++;for(var f=0;u<a;){if(l.get(u,d))if(f===1)o[1]++;else if(f===2){if(this.foundPatternCross(o)){var A=this.handlePossibleCenter(o,d,u);if(A!==null)return A}o[0]=o[2],o[1]=1,o[2]=0,f=1}else o[++f]++;else f===1&&f++,o[f]++;u++}if(this.foundPatternCross(o)){var A=this.handlePossibleCenter(o,d,a);if(A!==null)return A}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new Ar},t.centerFromEnd=function(e,r){return r-e[2]-e[1]/2},t.prototype.foundPatternCross=function(e){for(var r=this.moduleSize,n=r/2,a=0;a<3;a++)if(Math.abs(r-e[a])>=n)return!1;return!0},t.prototype.crossCheckVertical=function(e,r,n,a){var s=this.image,o=s.getHeight(),l=this.crossCheckStateCount;l[0]=0,l[1]=0,l[2]=0;for(var c=e;c>=0&&s.get(r,c)&&l[1]<=n;)l[1]++,c--;if(c<0||l[1]>n)return NaN;for(;c>=0&&!s.get(r,c)&&l[0]<=n;)l[0]++,c--;if(l[0]>n)return NaN;for(c=e+1;c<o&&s.get(r,c)&&l[1]<=n;)l[1]++,c++;if(c===o||l[1]>n)return NaN;for(;c<o&&!s.get(r,c)&&l[2]<=n;)l[2]++,c++;if(l[2]>n)return NaN;var d=l[0]+l[1]+l[2];return 5*Math.abs(d-a)>=2*a?NaN:this.foundPatternCross(l)?t.centerFromEnd(l,c):NaN},t.prototype.handlePossibleCenter=function(e,r,n){var a,s,o=e[0]+e[1]+e[2],l=t.centerFromEnd(e,n),c=this.crossCheckVertical(r,l,2*e[1],o);if(!isNaN(c)){var d=(e[0]+e[1]+e[2])/3;try{for(var u=K7e(this.possibleCenters),f=u.next();!f.done;f=u.next()){var A=f.value;if(A.aboutEquals(d,c,l))return A.combineEstimate(c,l,d)}}catch(m){a={error:m}}finally{try{f&&!f.done&&(s=u.return)&&s.call(u)}finally{if(a)throw a.error}}var h=new G7e(l,c,d);this.possibleCenters.push(h),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(h)}return null},t}(),z7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),W7e=function(t){z7e(e,t);function e(r,n,a,s){var o=t.call(this,r,n)||this;return o.estimatedModuleSize=a,o.count=s,s===void 0&&(o.count=1),o}return e.prototype.getEstimatedModuleSize=function(){return this.estimatedModuleSize},e.prototype.getCount=function(){return this.count},e.prototype.aboutEquals=function(r,n,a){if(Math.abs(n-this.getY())<=r&&Math.abs(a-this.getX())<=r){var s=Math.abs(r-this.estimatedModuleSize);return s<=1||s<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(r,n,a){var s=this.count+1,o=(this.count*this.getX()+n)/s,l=(this.count*this.getY()+r)/s,c=(this.count*this.estimatedModuleSize+a)/s;return new e(o,l,c,s)},e}(Cn),X7e=function(){function t(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}return t.prototype.getBottomLeft=function(){return this.bottomLeft},t.prototype.getTopLeft=function(){return this.topLeft},t.prototype.getTopRight=function(){return this.topRight},t}(),Sy=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Y7e=function(){function t(e,r){this.image=e,this.resultPointCallback=r,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=r}return t.prototype.getImage=function(){return this.image},t.prototype.getPossibleCenters=function(){return this.possibleCenters},t.prototype.find=function(e){var r=e!=null&&e.get(Ls.TRY_HARDER)!==void 0,n=e!=null&&e.get(Ls.PURE_BARCODE)!==void 0,a=this.image,s=a.getHeight(),o=a.getWidth(),l=Math.floor(3*s/(4*t.MAX_MODULES));(l<t.MIN_SKIP||r)&&(l=t.MIN_SKIP);for(var c=!1,d=new Int32Array(5),u=l-1;u<s&&!c;u+=l){d[0]=0,d[1]=0,d[2]=0,d[3]=0,d[4]=0;for(var f=0,A=0;A<o;A++)if(a.get(A,u))(f&1)===1&&f++,d[f]++;else if(f&1)d[f]++;else if(f===4)if(t.foundPatternCross(d)){var h=this.handlePossibleCenter(d,u,A,n);if(h===!0)if(l=2,this.hasSkipped===!0)c=this.haveMultiplyConfirmedCenters();else{var m=this.findRowSkip();m>d[2]&&(u+=m-d[2]-l,A=o-1)}else{d[0]=d[2],d[1]=d[3],d[2]=d[4],d[3]=1,d[4]=0,f=3;continue}f=0,d[0]=0,d[1]=0,d[2]=0,d[3]=0,d[4]=0}else d[0]=d[2],d[1]=d[3],d[2]=d[4],d[3]=1,d[4]=0,f=3;else d[++f]++;if(t.foundPatternCross(d)){var h=this.handlePossibleCenter(d,u,o,n);h===!0&&(l=d[0],this.hasSkipped&&(c=this.haveMultiplyConfirmedCenters()))}}var p=this.selectBestPatterns();return Cn.orderBestPatterns(p),new X7e(p)},t.centerFromEnd=function(e,r){return r-e[4]-e[3]-e[2]/2},t.foundPatternCross=function(e){for(var r=0,n=0;n<5;n++){var a=e[n];if(a===0)return!1;r+=a}if(r<7)return!1;var s=r/7,o=s/2;return Math.abs(s-e[0])<o&&Math.abs(s-e[1])<o&&Math.abs(3*s-e[2])<3*o&&Math.abs(s-e[3])<o&&Math.abs(s-e[4])<o},t.prototype.getCrossCheckStateCount=function(){var e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e},t.prototype.crossCheckDiagonal=function(e,r,n,a){for(var s=this.getCrossCheckStateCount(),o=0,l=this.image;e>=o&&r>=o&&l.get(r-o,e-o);)s[2]++,o++;if(e<o||r<o)return!1;for(;e>=o&&r>=o&&!l.get(r-o,e-o)&&s[1]<=n;)s[1]++,o++;if(e<o||r<o||s[1]>n)return!1;for(;e>=o&&r>=o&&l.get(r-o,e-o)&&s[0]<=n;)s[0]++,o++;if(s[0]>n)return!1;var c=l.getHeight(),d=l.getWidth();for(o=1;e+o<c&&r+o<d&&l.get(r+o,e+o);)s[2]++,o++;if(e+o>=c||r+o>=d)return!1;for(;e+o<c&&r+o<d&&!l.get(r+o,e+o)&&s[3]<n;)s[3]++,o++;if(e+o>=c||r+o>=d||s[3]>=n)return!1;for(;e+o<c&&r+o<d&&l.get(r+o,e+o)&&s[4]<n;)s[4]++,o++;if(s[4]>=n)return!1;var u=s[0]+s[1]+s[2]+s[3]+s[4];return Math.abs(u-a)<2*a&&t.foundPatternCross(s)},t.prototype.crossCheckVertical=function(e,r,n,a){for(var s=this.image,o=s.getHeight(),l=this.getCrossCheckStateCount(),c=e;c>=0&&s.get(r,c);)l[2]++,c--;if(c<0)return NaN;for(;c>=0&&!s.get(r,c)&&l[1]<=n;)l[1]++,c--;if(c<0||l[1]>n)return NaN;for(;c>=0&&s.get(r,c)&&l[0]<=n;)l[0]++,c--;if(l[0]>n)return NaN;for(c=e+1;c<o&&s.get(r,c);)l[2]++,c++;if(c===o)return NaN;for(;c<o&&!s.get(r,c)&&l[3]<n;)l[3]++,c++;if(c===o||l[3]>=n)return NaN;for(;c<o&&s.get(r,c)&&l[4]<n;)l[4]++,c++;if(l[4]>=n)return NaN;var d=l[0]+l[1]+l[2]+l[3]+l[4];return 5*Math.abs(d-a)>=2*a?NaN:t.foundPatternCross(l)?t.centerFromEnd(l,c):NaN},t.prototype.crossCheckHorizontal=function(e,r,n,a){for(var s=this.image,o=s.getWidth(),l=this.getCrossCheckStateCount(),c=e;c>=0&&s.get(c,r);)l[2]++,c--;if(c<0)return NaN;for(;c>=0&&!s.get(c,r)&&l[1]<=n;)l[1]++,c--;if(c<0||l[1]>n)return NaN;for(;c>=0&&s.get(c,r)&&l[0]<=n;)l[0]++,c--;if(l[0]>n)return NaN;for(c=e+1;c<o&&s.get(c,r);)l[2]++,c++;if(c===o)return NaN;for(;c<o&&!s.get(c,r)&&l[3]<n;)l[3]++,c++;if(c===o||l[3]>=n)return NaN;for(;c<o&&s.get(c,r)&&l[4]<n;)l[4]++,c++;if(l[4]>=n)return NaN;var d=l[0]+l[1]+l[2]+l[3]+l[4];return 5*Math.abs(d-a)>=a?NaN:t.foundPatternCross(l)?t.centerFromEnd(l,c):NaN},t.prototype.handlePossibleCenter=function(e,r,n,a){var s=e[0]+e[1]+e[2]+e[3]+e[4],o=t.centerFromEnd(e,n),l=this.crossCheckVertical(r,Math.floor(o),e[2],s);if(!isNaN(l)&&(o=this.crossCheckHorizontal(Math.floor(o),Math.floor(l),e[2],s),!isNaN(o)&&(!a||this.crossCheckDiagonal(Math.floor(l),Math.floor(o),e[2],s)))){for(var c=s/7,d=!1,u=this.possibleCenters,f=0,A=u.length;f<A;f++){var h=u[f];if(h.aboutEquals(c,l,o)){u[f]=h.combineEstimate(l,o,c),d=!0;break}}if(!d){var m=new W7e(o,l,c);u.push(m),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(m)}return!0}return!1},t.prototype.findRowSkip=function(){var e,r,n=this.possibleCenters.length;if(n<=1)return 0;var a=null;try{for(var s=Sy(this.possibleCenters),o=s.next();!o.done;o=s.next()){var l=o.value;if(l.getCount()>=t.CENTER_QUORUM)if(a==null)a=l;else return this.hasSkipped=!0,Math.floor((Math.abs(a.getX()-l.getX())-Math.abs(a.getY()-l.getY()))/2)}}catch(c){e={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return 0},t.prototype.haveMultiplyConfirmedCenters=function(){var e,r,n,a,s=0,o=0,l=this.possibleCenters.length;try{for(var c=Sy(this.possibleCenters),d=c.next();!d.done;d=c.next()){var u=d.value;u.getCount()>=t.CENTER_QUORUM&&(s++,o+=u.getEstimatedModuleSize())}}catch(p){e={error:p}}finally{try{d&&!d.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}if(s<3)return!1;var f=o/l,A=0;try{for(var h=Sy(this.possibleCenters),m=h.next();!m.done;m=h.next()){var u=m.value;A+=Math.abs(u.getEstimatedModuleSize()-f)}}catch(p){n={error:p}}finally{try{m&&!m.done&&(a=h.return)&&a.call(h)}finally{if(n)throw n.error}}return A<=.05*o},t.prototype.selectBestPatterns=function(){var e,r,n,a,s=this.possibleCenters.length;if(s<3)throw new Ar;var o=this.possibleCenters,l;if(s>3){var c=0,d=0;try{for(var u=Sy(this.possibleCenters),f=u.next();!f.done;f=u.next()){var A=f.value,h=A.getEstimatedModuleSize();c+=h,d+=h*h}}catch(I){e={error:I}}finally{try{f&&!f.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}l=c/s;var m=Math.sqrt(d/s-l*l);o.sort(function(I,j){var N=Math.abs(j.getEstimatedModuleSize()-l),S=Math.abs(I.getEstimatedModuleSize()-l);return N<S?-1:N>S?1:0});for(var p=Math.max(.2*l,m),x=0;x<o.length&&o.length>3;x++){var v=o[x];Math.abs(v.getEstimatedModuleSize()-l)>p&&(o.splice(x,1),x--)}}if(o.length>3){var c=0;try{for(var y=Sy(o),b=y.next();!b.done;b=y.next()){var w=b.value;c+=w.getEstimatedModuleSize()}}catch(j){n={error:j}}finally{try{b&&!b.done&&(a=y.return)&&a.call(y)}finally{if(n)throw n.error}}l=c/o.length,o.sort(function(j,N){if(N.getCount()===j.getCount()){var S=Math.abs(N.getEstimatedModuleSize()-l),E=Math.abs(j.getEstimatedModuleSize()-l);return S<E?1:S>E?-1:0}else return N.getCount()-j.getCount()}),o.splice(3)}return[o[0],o[1],o[2]]},t.CENTER_QUORUM=2,t.MIN_SKIP=3,t.MAX_MODULES=57,t}(),J7e=function(){function t(e){this.image=e}return t.prototype.getImage=function(){return this.image},t.prototype.getResultPointCallback=function(){return this.resultPointCallback},t.prototype.detect=function(e){this.resultPointCallback=e==null?null:e.get(Ls.NEED_RESULT_POINT_CALLBACK);var r=new Y7e(this.image,this.resultPointCallback),n=r.find(e);return this.processFinderPatternInfo(n)},t.prototype.processFinderPatternInfo=function(e){var r=e.getTopLeft(),n=e.getTopRight(),a=e.getBottomLeft(),s=this.calculateModuleSize(r,n,a);if(s<1)throw new Ar("No pattern found in proccess finder.");var o=t.computeDimension(r,n,a,s),l=Xp.getProvisionalVersionForDimension(o),c=l.getDimensionForVersion()-7,d=null;if(l.getAlignmentPatternCenters().length>0)for(var u=n.getX()-r.getX()+a.getX(),f=n.getY()-r.getY()+a.getY(),A=1-3/c,h=Math.floor(r.getX()+A*(u-r.getX())),m=Math.floor(r.getY()+A*(f-r.getY())),p=4;p<=16;p<<=1)try{d=this.findAlignmentInRegion(s,h,m,p);break}catch(b){if(!(b instanceof Ar))throw b}var x=t.createTransform(r,n,a,d,o),v=t.sampleGrid(this.image,x,o),y;return d===null?y=[a,r,n]:y=[a,r,n,d],new zR(v,y)},t.createTransform=function(e,r,n,a,s){var o=s-3.5,l,c,d,u;return a!==null?(l=a.getX(),c=a.getY(),d=o-3,u=d):(l=r.getX()-e.getX()+n.getX(),c=r.getY()-e.getY()+n.getY(),d=o,u=o),Rse.quadrilateralToQuadrilateral(3.5,3.5,o,3.5,d,u,3.5,o,e.getX(),e.getY(),r.getX(),r.getY(),l,c,n.getX(),n.getY())},t.sampleGrid=function(e,r,n){var a=WR.getInstance();return a.sampleGridWithTransform(e,n,n,r)},t.computeDimension=function(e,r,n,a){var s=Ga.round(Cn.distance(e,r)/a),o=Ga.round(Cn.distance(e,n)/a),l=Math.floor((s+o)/2)+7;switch(l&3){case 0:l++;break;case 2:l--;break;case 3:throw new Ar("Dimensions could be not found.")}return l},t.prototype.calculateModuleSize=function(e,r,n){return(this.calculateModuleSizeOneWay(e,r)+this.calculateModuleSizeOneWay(e,n))/2},t.prototype.calculateModuleSizeOneWay=function(e,r){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(r.getX()),Math.floor(r.getY())),a=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(r.getX()),Math.floor(r.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(n)?a/7:isNaN(a)?n/7:(n+a)/14},t.prototype.sizeOfBlackWhiteBlackRunBothWays=function(e,r,n,a){var s=this.sizeOfBlackWhiteBlackRun(e,r,n,a),o=1,l=e-(n-e);l<0?(o=e/(e-l),l=0):l>=this.image.getWidth()&&(o=(this.image.getWidth()-1-e)/(l-e),l=this.image.getWidth()-1);var c=Math.floor(r-(a-r)*o);return o=1,c<0?(o=r/(r-c),c=0):c>=this.image.getHeight()&&(o=(this.image.getHeight()-1-r)/(c-r),c=this.image.getHeight()-1),l=Math.floor(e+(l-e)*o),s+=this.sizeOfBlackWhiteBlackRun(e,r,l,c),s-1},t.prototype.sizeOfBlackWhiteBlackRun=function(e,r,n,a){var s=Math.abs(a-r)>Math.abs(n-e);if(s){var o=e;e=r,r=o,o=n,n=a,a=o}for(var l=Math.abs(n-e),c=Math.abs(a-r),d=-l/2,u=e<n?1:-1,f=r<a?1:-1,A=0,h=n+u,m=e,p=r;m!==h;m+=u){var x=s?p:m,v=s?m:p;if(A===1===this.image.get(x,v)){if(A===2)return Ga.distance(m,p,e,r);A++}if(d+=c,d>0){if(p===a)break;p+=f,d-=l}}return A===2?Ga.distance(n+u,a,e,r):NaN},t.prototype.findAlignmentInRegion=function(e,r,n,a){var s=Math.floor(a*e),o=Math.max(0,r-s),l=Math.min(this.image.getWidth()-1,r+s);if(l-o<e*3)throw new Ar("Alignment top exceeds estimated module size.");var c=Math.max(0,n-s),d=Math.min(this.image.getHeight()-1,n+s);if(d-c<e*3)throw new Ar("Alignment bottom exceeds estimated module size.");var u=new q7e(this.image,o,c,l-o,d-c,e,this.resultPointCallback);return u.find()},t}(),dj=function(){function t(){this.decoder=new H7e}return t.prototype.getDecoder=function(){return this.decoder},t.prototype.decode=function(e,r){var n,a;if(r!=null&&r.get(Ls.PURE_BARCODE)!==void 0){var s=t.extractPureBits(e.getBlackMatrix());n=this.decoder.decodeBitMatrix(s,r),a=t.NO_POINTS}else{var o=new J7e(e.getBlackMatrix()).detect(r);n=this.decoder.decodeBitMatrix(o.getBits(),r),a=o.getPoints()}n.getOther()instanceof Hse&&n.getOther().applyMirroredCorrection(a);var l=new Nc(n.getText(),n.getRawBytes(),void 0,a,Qn.QR_CODE,void 0),c=n.getByteSegments();c!==null&&l.putMetadata(Vl.BYTE_SEGMENTS,c);var d=n.getECLevel();return d!==null&&l.putMetadata(Vl.ERROR_CORRECTION_LEVEL,d),n.hasStructuredAppend()&&(l.putMetadata(Vl.STRUCTURED_APPEND_SEQUENCE,n.getStructuredAppendSequenceNumber()),l.putMetadata(Vl.STRUCTURED_APPEND_PARITY,n.getStructuredAppendParity())),l},t.prototype.reset=function(){},t.extractPureBits=function(e){var r=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(r===null||n===null)throw new Ar;var a=this.moduleSize(r,e),s=r[1],o=n[1],l=r[0],c=n[0];if(l>=c||s>=o)throw new Ar;if(o-s!==c-l&&(c=l+(o-s),c>=e.getWidth()))throw new Ar;var d=Math.round((c-l+1)/a),u=Math.round((o-s+1)/a);if(d<=0||u<=0)throw new Ar;if(u!==d)throw new Ar;var f=Math.floor(a/2);s+=f,l+=f;var A=l+Math.floor((d-1)*a)-c;if(A>0){if(A>f)throw new Ar;l-=A}var h=s+Math.floor((u-1)*a)-o;if(h>0){if(h>f)throw new Ar;s-=h}for(var m=new fh(d,u),p=0;p<u;p++)for(var x=s+Math.floor(p*a),v=0;v<d;v++)e.get(l+Math.floor(v*a),x)&&m.set(v,p);return m},t.moduleSize=function(e,r){for(var n=r.getHeight(),a=r.getWidth(),s=e[0],o=e[1],l=!0,c=0;s<a&&o<n;){if(l!==r.get(s,o)){if(++c===5)break;l=!l}s++,o++}if(s===a||o===n)throw new Ar;return(s-e[0])/7},t.NO_POINTS=new Array,t}(),Z7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ma=function(){function t(){}return t.prototype.PDF417Common=function(){},t.getBitCountSum=function(e){return Ga.sum(e)},t.toIntArray=function(e){var r,n;if(e==null||!e.length)return t.EMPTY_INT_ARRAY;var a=new Int32Array(e.length),s=0;try{for(var o=Z7e(e),l=o.next();!l.done;l=o.next()){var c=l.value;a[s++]=c}}catch(d){r={error:d}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a},t.getCodeword=function(e){var r=Ho.binarySearch(t.SYMBOL_TABLE,e&262143);return r<0?-1:(t.CODEWORD_TABLE[r]-1)%t.NUMBER_OF_CODEWORDS},t.NUMBER_OF_CODEWORDS=929,t.MAX_CODEWORDS_IN_BARCODE=t.NUMBER_OF_CODEWORDS-1,t.MIN_ROWS_IN_BARCODE=3,t.MAX_ROWS_IN_BARCODE=90,t.MODULES_IN_CODEWORD=17,t.MODULES_IN_STOP_PATTERN=18,t.BARS_IN_MODULE=8,t.EMPTY_INT_ARRAY=new Int32Array([]),t.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),t.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]),t}(),e9e=function(){function t(e,r){this.bits=e,this.points=r}return t.prototype.getBits=function(){return this.bits},t.prototype.getPoints=function(){return this.points},t}(),t9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},r9e=function(){function t(){}return t.detectMultiple=function(e,r,n){var a=e.getBlackMatrix(),s=t.detect(n,a);return s.length||(a=a.clone(),a.rotate180(),s=t.detect(n,a)),new e9e(a,s)},t.detect=function(e,r){for(var n,a,s=new Array,o=0,l=0,c=!1;o<r.getHeight();){var d=t.findVertices(r,o,l);if(d[0]==null&&d[3]==null){if(!c)break;c=!1,l=0;try{for(var u=(n=void 0,t9e(s)),f=u.next();!f.done;f=u.next()){var A=f.value;A[1]!=null&&(o=Math.trunc(Math.max(o,A[1].getY()))),A[3]!=null&&(o=Math.max(o,Math.trunc(A[3].getY())))}}catch(h){n={error:h}}finally{try{f&&!f.done&&(a=u.return)&&a.call(u)}finally{if(n)throw n.error}}o+=t.ROW_STEP;continue}if(c=!0,s.push(d),!e)break;d[2]!=null?(l=Math.trunc(d[2].getX()),o=Math.trunc(d[2].getY())):(l=Math.trunc(d[4].getX()),o=Math.trunc(d[4].getY()))}return s},t.findVertices=function(e,r,n){var a=e.getHeight(),s=e.getWidth(),o=new Array(8);return t.copyToResult(o,t.findRowsWithPattern(e,a,s,r,n,t.START_PATTERN),t.INDEXES_START_PATTERN),o[4]!=null&&(n=Math.trunc(o[4].getX()),r=Math.trunc(o[4].getY())),t.copyToResult(o,t.findRowsWithPattern(e,a,s,r,n,t.STOP_PATTERN),t.INDEXES_STOP_PATTERN),o},t.copyToResult=function(e,r,n){for(var a=0;a<n.length;a++)e[n[a]]=r[a]},t.findRowsWithPattern=function(e,r,n,a,s,o){for(var l=new Array(4),c=!1,d=new Int32Array(o.length);a<r;a+=t.ROW_STEP){var u=t.findGuardPattern(e,s,a,n,!1,o,d);if(u!=null){for(;a>0;){var f=t.findGuardPattern(e,s,--a,n,!1,o,d);if(f!=null)u=f;else{a++;break}}l[0]=new Cn(u[0],a),l[1]=new Cn(u[1],a),c=!0;break}}var A=a+1;if(c){for(var h=0,f=Int32Array.from([Math.trunc(l[0].getX()),Math.trunc(l[1].getX())]);A<r;A++){var u=t.findGuardPattern(e,f[0],A,n,!1,o,d);if(u!=null&&Math.abs(f[0]-u[0])<t.MAX_PATTERN_DRIFT&&Math.abs(f[1]-u[1])<t.MAX_PATTERN_DRIFT)f=u,h=0;else{if(h>t.SKIPPED_ROW_COUNT_MAX)break;h++}}A-=h+1,l[2]=new Cn(f[0],A),l[3]=new Cn(f[1],A)}return A-a<t.BARCODE_MIN_HEIGHT&&Ho.fill(l,null),l},t.findGuardPattern=function(e,r,n,a,s,o,l){Ho.fillWithin(l,0,l.length,0);for(var c=r,d=0;e.get(c,n)&&c>0&&d++<t.MAX_PIXEL_DRIFT;)c--;for(var u=c,f=0,A=o.length,h=s;u<a;u++){var m=e.get(u,n);if(m!==h)l[f]++;else{if(f===A-1){if(t.patternMatchVariance(l,o,t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE)return new Int32Array([c,u]);c+=l[0]+l[1],Ms.arraycopy(l,2,l,0,f-1),l[f-1]=0,l[f]=0,f--}else f++;l[f]=1,h=!h}}return f===A-1&&t.patternMatchVariance(l,o,t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE?new Int32Array([c,u-1]):null},t.patternMatchVariance=function(e,r,n){for(var a=e.length,s=0,o=0,l=0;l<a;l++)s+=e[l],o+=r[l];if(s<o)return 1/0;var c=s/o;n*=c;for(var d=0,u=0;u<a;u++){var f=e[u],A=r[u]*c,h=f>A?f-A:A-f;if(h>n)return 1/0;d+=h}return d/s},t.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),t.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),t.MAX_AVG_VARIANCE=.42,t.MAX_INDIVIDUAL_VARIANCE=.8,t.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),t.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),t.MAX_PIXEL_DRIFT=3,t.MAX_PATTERN_DRIFT=5,t.SKIPPED_ROW_COUNT_MAX=25,t.ROW_STEP=5,t.BARCODE_MIN_HEIGHT=10,t}(),n9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},kp=function(){function t(e,r){if(r.length===0)throw new Vn;this.field=e;var n=r.length;if(n>1&&r[0]===0){for(var a=1;a<n&&r[a]===0;)a++;a===n?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(n-a),Ms.arraycopy(r,a,this.coefficients,0,this.coefficients.length))}else this.coefficients=r}return t.prototype.getCoefficients=function(){return this.coefficients},t.prototype.getDegree=function(){return this.coefficients.length-1},t.prototype.isZero=function(){return this.coefficients[0]===0},t.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},t.prototype.evaluateAt=function(e){var r,n;if(e===0)return this.getCoefficient(0);if(e===1){var a=0;try{for(var s=n9e(this.coefficients),o=s.next();!o.done;o=s.next()){var l=o.value;a=this.field.add(a,l)}}catch(f){r={error:f}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a}for(var c=this.coefficients[0],d=this.coefficients.length,u=1;u<d;u++)c=this.field.add(this.field.multiply(e,c),this.coefficients[u]);return c},t.prototype.add=function(e){if(!this.field.equals(e.field))throw new Vn("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;var r=this.coefficients,n=e.coefficients;if(r.length>n.length){var a=r;r=n,n=a}var s=new Int32Array(n.length),o=n.length-r.length;Ms.arraycopy(n,0,s,0,o);for(var l=o;l<n.length;l++)s[l]=this.field.add(r[l-o],n[l]);return new t(this.field,s)},t.prototype.subtract=function(e){if(!this.field.equals(e.field))throw new Vn("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())},t.prototype.multiply=function(e){return e instanceof t?this.multiplyOther(e):this.multiplyScalar(e)},t.prototype.multiplyOther=function(e){if(!this.field.equals(e.field))throw new Vn("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new t(this.field,new Int32Array([0]));for(var r=this.coefficients,n=r.length,a=e.coefficients,s=a.length,o=new Int32Array(n+s-1),l=0;l<n;l++)for(var c=r[l],d=0;d<s;d++)o[l+d]=this.field.add(o[l+d],this.field.multiply(c,a[d]));return new t(this.field,o)},t.prototype.negative=function(){for(var e=this.coefficients.length,r=new Int32Array(e),n=0;n<e;n++)r[n]=this.field.subtract(0,this.coefficients[n]);return new t(this.field,r)},t.prototype.multiplyScalar=function(e){if(e===0)return new t(this.field,new Int32Array([0]));if(e===1)return this;for(var r=this.coefficients.length,n=new Int32Array(r),a=0;a<r;a++)n[a]=this.field.multiply(this.coefficients[a],e);return new t(this.field,n)},t.prototype.multiplyByMonomial=function(e,r){if(e<0)throw new Vn;if(r===0)return new t(this.field,new Int32Array([0]));for(var n=this.coefficients.length,a=new Int32Array(n+e),s=0;s<n;s++)a[s]=this.field.multiply(this.coefficients[s],r);return new t(this.field,a)},t.prototype.toString=function(){for(var e=new ga,r=this.getDegree();r>=0;r--){var n=this.getCoefficient(r);n!==0&&(n<0?(e.append(" - "),n=-n):e.length()>0&&e.append(" + "),(r===0||n!==1)&&e.append(n),r!==0&&(r===1?e.append("x"):(e.append("x^"),e.append(r))))}return e.toString()},t}(),a9e=function(){function t(){}return t.prototype.add=function(e,r){return(e+r)%this.modulus},t.prototype.subtract=function(e,r){return(this.modulus+e-r)%this.modulus},t.prototype.exp=function(e){return this.expTable[e]},t.prototype.log=function(e){if(e===0)throw new Vn;return this.logTable[e]},t.prototype.inverse=function(e){if(e===0)throw new Dse;return this.expTable[this.modulus-this.logTable[e]-1]},t.prototype.multiply=function(e,r){return e===0||r===0?0:this.expTable[(this.logTable[e]+this.logTable[r])%(this.modulus-1)]},t.prototype.getSize=function(){return this.modulus},t.prototype.equals=function(e){return e===this},t}(),s9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),i9e=function(t){s9e(e,t);function e(r,n){var a=t.call(this)||this;a.modulus=r,a.expTable=new Int32Array(r),a.logTable=new Int32Array(r);for(var s=1,o=0;o<r;o++)a.expTable[o]=s,s=s*n%r;for(var o=0;o<r-1;o++)a.logTable[a.expTable[o]]=o;return a.zero=new kp(a,new Int32Array([0])),a.one=new kp(a,new Int32Array([1])),a}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(r,n){if(r<0)throw new Vn;if(n===0)return this.zero;var a=new Int32Array(r+1);return a[0]=n,new kp(this,a)},e.PDF417_GF=new e(Ma.NUMBER_OF_CODEWORDS,3),e}(a9e),o9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l9e=function(){function t(){this.field=i9e.PDF417_GF}return t.prototype.decode=function(e,r,n){for(var a,s,o=new kp(this.field,e),l=new Int32Array(r),c=!1,d=r;d>0;d--){var u=o.evaluateAt(this.field.exp(d));l[r-d]=u,u!==0&&(c=!0)}if(!c)return 0;var f=this.field.getOne();if(n!=null)try{for(var A=o9e(n),h=A.next();!h.done;h=A.next()){var m=h.value,p=this.field.exp(e.length-1-m),x=new kp(this.field,new Int32Array([this.field.subtract(0,p),1]));f=f.multiply(x)}}catch(S){a={error:S}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}for(var v=new kp(this.field,l),y=this.runEuclideanAlgorithm(this.field.buildMonomial(r,1),v,r),b=y[0],w=y[1],I=this.findErrorLocations(b),j=this.findErrorMagnitudes(w,b,I),d=0;d<I.length;d++){var N=e.length-1-this.field.log(I[d]);if(N<0)throw wo.getChecksumInstance();e[N]=this.field.subtract(e[N],j[d])}return I.length},t.prototype.runEuclideanAlgorithm=function(e,r,n){if(e.getDegree()<r.getDegree()){var a=e;e=r,r=a}for(var s=e,o=r,l=this.field.getZero(),c=this.field.getOne();o.getDegree()>=Math.round(n/2);){var d=s,u=l;if(s=o,l=c,s.isZero())throw wo.getChecksumInstance();o=d;for(var f=this.field.getZero(),A=s.getCoefficient(s.getDegree()),h=this.field.inverse(A);o.getDegree()>=s.getDegree()&&!o.isZero();){var m=o.getDegree()-s.getDegree(),p=this.field.multiply(o.getCoefficient(o.getDegree()),h);f=f.add(this.field.buildMonomial(m,p)),o=o.subtract(s.multiplyByMonomial(m,p))}c=f.multiply(l).subtract(u).negative()}var x=c.getCoefficient(0);if(x===0)throw wo.getChecksumInstance();var v=this.field.inverse(x),y=c.multiply(v),b=o.multiply(v);return[y,b]},t.prototype.findErrorLocations=function(e){for(var r=e.getDegree(),n=new Int32Array(r),a=0,s=1;s<this.field.getSize()&&a<r;s++)e.evaluateAt(s)===0&&(n[a]=this.field.inverse(s),a++);if(a!==r)throw wo.getChecksumInstance();return n},t.prototype.findErrorMagnitudes=function(e,r,n){for(var a=r.getDegree(),s=new Int32Array(a),o=1;o<=a;o++)s[a-o]=this.field.multiply(o,r.getCoefficient(o));for(var l=new kp(this.field,s),c=n.length,d=new Int32Array(c),o=0;o<c;o++){var u=this.field.inverse(n[o]),f=this.field.subtract(0,e.evaluateAt(u)),A=this.field.inverse(l.evaluateAt(u));d[o]=this.field.multiply(f,A)}return d},t}(),NF=function(){function t(e,r,n,a,s){e instanceof t?this.constructor_2(e):this.constructor_1(e,r,n,a,s)}return t.prototype.constructor_1=function(e,r,n,a,s){var o=r==null||n==null,l=a==null||s==null;if(o&&l)throw new Ar;o?(r=new Cn(0,a.getY()),n=new Cn(0,s.getY())):l&&(a=new Cn(e.getWidth()-1,r.getY()),s=new Cn(e.getWidth()-1,n.getY())),this.image=e,this.topLeft=r,this.bottomLeft=n,this.topRight=a,this.bottomRight=s,this.minX=Math.trunc(Math.min(r.getX(),n.getX())),this.maxX=Math.trunc(Math.max(a.getX(),s.getX())),this.minY=Math.trunc(Math.min(r.getY(),a.getY())),this.maxY=Math.trunc(Math.max(n.getY(),s.getY()))},t.prototype.constructor_2=function(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()},t.merge=function(e,r){return e==null?r:r==null?e:new t(e.image,e.topLeft,e.bottomLeft,r.topRight,r.bottomRight)},t.prototype.addMissingRows=function(e,r,n){var a=this.topLeft,s=this.bottomLeft,o=this.topRight,l=this.bottomRight;if(e>0){var c=n?this.topLeft:this.topRight,d=Math.trunc(c.getY()-e);d<0&&(d=0);var u=new Cn(c.getX(),d);n?a=u:o=u}if(r>0){var f=n?this.bottomLeft:this.bottomRight,A=Math.trunc(f.getY()+r);A>=this.image.getHeight()&&(A=this.image.getHeight()-1);var h=new Cn(f.getX(),A);n?s=h:l=h}return new t(this.image,a,s,o,l)},t.prototype.getMinX=function(){return this.minX},t.prototype.getMaxX=function(){return this.maxX},t.prototype.getMinY=function(){return this.minY},t.prototype.getMaxY=function(){return this.maxY},t.prototype.getTopLeft=function(){return this.topLeft},t.prototype.getTopRight=function(){return this.topRight},t.prototype.getBottomLeft=function(){return this.bottomLeft},t.prototype.getBottomRight=function(){return this.bottomRight},t}(),c9e=function(){function t(e,r,n,a){this.columnCount=e,this.errorCorrectionLevel=a,this.rowCountUpperPart=r,this.rowCountLowerPart=n,this.rowCount=r+n}return t.prototype.getColumnCount=function(){return this.columnCount},t.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},t.prototype.getRowCount=function(){return this.rowCount},t.prototype.getRowCountUpperPart=function(){return this.rowCountUpperPart},t.prototype.getRowCountLowerPart=function(){return this.rowCountLowerPart},t}(),YR=function(){function t(){this.buffer=""}return t.form=function(e,r){var n=-1;function a(o,l,c,d,u,f){if(o==="%%")return"%";if(r[++n]!==void 0){o=d?parseInt(d.substr(1)):void 0;var A=u?parseInt(u.substr(1)):void 0,h;switch(f){case"s":h=r[n];break;case"c":h=r[n][0];break;case"f":h=parseFloat(r[n]).toFixed(o);break;case"p":h=parseFloat(r[n]).toPrecision(o);break;case"e":h=parseFloat(r[n]).toExponential(o);break;case"x":h=parseInt(r[n]).toString(A||16);break;case"d":h=parseFloat(parseInt(r[n],A||10).toPrecision(o)).toFixed(0);break}h=typeof h=="object"?JSON.stringify(h):(+h).toString(A);for(var m=parseInt(c),p=c&&c[0]+""=="0"?"0":" ";h.length<m;)h=l!==void 0?h+p:p+h;return h}}var s=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(s,a)},t.prototype.format=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.buffer+=t.form(e,r)},t.prototype.toString=function(){return this.buffer},t}(),d9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},$se=function(){function t(e){this.boundingBox=new NF(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}return t.prototype.getCodewordNearby=function(e){var r=this.getCodeword(e);if(r!=null)return r;for(var n=1;n<t.MAX_NEARBY_DISTANCE;n++){var a=this.imageRowToCodewordIndex(e)-n;if(a>=0&&(r=this.codewords[a],r!=null)||(a=this.imageRowToCodewordIndex(e)+n,a<this.codewords.length&&(r=this.codewords[a],r!=null)))return r}return null},t.prototype.imageRowToCodewordIndex=function(e){return e-this.boundingBox.getMinY()},t.prototype.setCodeword=function(e,r){this.codewords[this.imageRowToCodewordIndex(e)]=r},t.prototype.getCodeword=function(e){return this.codewords[this.imageRowToCodewordIndex(e)]},t.prototype.getBoundingBox=function(){return this.boundingBox},t.prototype.getCodewords=function(){return this.codewords},t.prototype.toString=function(){var e,r,n=new YR,a=0;try{for(var s=d9e(this.codewords),o=s.next();!o.done;o=s.next()){var l=o.value;if(l==null){n.format("%3d:    |   %n",a++);continue}n.format("%3d: %3d|%3d%n",a++,l.getRowNumber(),l.getValue())}}catch(c){e={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return n.toString()},t.MAX_NEARBY_DISTANCE=5,t}(),u9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},f9e=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),a,s=[],o;try{for(;(e===void 0||e-- >0)&&!(a=n.next()).done;)s.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s},ib=function(){function t(){this.values=new Map}return t.prototype.setValue=function(e){e=Math.trunc(e);var r=this.values.get(e);r==null&&(r=0),r++,this.values.set(e,r)},t.prototype.getValue=function(){var e,r,n=-1,a=new Array,s=function(f,A){var h={getKey:function(){return f},getValue:function(){return A}};h.getValue()>n?(n=h.getValue(),a=[],a.push(h.getKey())):h.getValue()===n&&a.push(h.getKey())};try{for(var o=u9e(this.values.entries()),l=o.next();!l.done;l=o.next()){var c=f9e(l.value,2),d=c[0],u=c[1];s(d,u)}}catch(f){e={error:f}}finally{try{l&&!l.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return Ma.toIntArray(a)},t.prototype.getConfidence=function(e){return this.values.get(e)},t}(),h9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),nT=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},oG=function(t){h9e(e,t);function e(r,n){var a=t.call(this,r)||this;return a._isLeft=n,a}return e.prototype.setRowNumbers=function(){var r,n;try{for(var a=nT(this.getCodewords()),s=a.next();!s.done;s=a.next()){var o=s.value;o!=null&&o.setRowNumberAsRowIndicatorColumn()}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},e.prototype.adjustCompleteIndicatorColumnRowNumbers=function(r){var n=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(n,r);for(var a=this.getBoundingBox(),s=this._isLeft?a.getTopLeft():a.getTopRight(),o=this._isLeft?a.getBottomLeft():a.getBottomRight(),l=this.imageRowToCodewordIndex(Math.trunc(s.getY())),c=this.imageRowToCodewordIndex(Math.trunc(o.getY())),d=-1,u=1,f=0,A=l;A<c;A++)if(n[A]!=null){var h=n[A],m=h.getRowNumber()-d;if(m===0)f++;else if(m===1)u=Math.max(u,f),f=1,d=h.getRowNumber();else if(m<0||h.getRowNumber()>=r.getRowCount()||m>A)n[A]=null;else{var p=void 0;u>2?p=(u-2)*m:p=m;for(var x=p>=A,v=1;v<=p&&!x;v++)x=n[A-v]!=null;x?n[A]=null:(d=h.getRowNumber(),f=1)}}},e.prototype.getRowHeights=function(){var r,n,a=this.getBarcodeMetadata();if(a==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(a);var s=new Int32Array(a.getRowCount());try{for(var o=nT(this.getCodewords()),l=o.next();!l.done;l=o.next()){var c=l.value;if(c!=null){var d=c.getRowNumber();if(d>=s.length)continue;s[d]++}}}catch(u){r={error:u}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s},e.prototype.adjustIncompleteIndicatorColumnRowNumbers=function(r){for(var n=this.getBoundingBox(),a=this._isLeft?n.getTopLeft():n.getTopRight(),s=this._isLeft?n.getBottomLeft():n.getBottomRight(),o=this.imageRowToCodewordIndex(Math.trunc(a.getY())),l=this.imageRowToCodewordIndex(Math.trunc(s.getY())),c=this.getCodewords(),d=-1,u=o;u<l;u++)if(c[u]!=null){var f=c[u];f.setRowNumberAsRowIndicatorColumn();var A=f.getRowNumber()-d;A===0||(A===1?d=f.getRowNumber():f.getRowNumber()>=r.getRowCount()?c[u]=null:d=f.getRowNumber())}},e.prototype.getBarcodeMetadata=function(){var r,n,a=this.getCodewords(),s=new ib,o=new ib,l=new ib,c=new ib;try{for(var d=nT(a),u=d.next();!u.done;u=d.next()){var f=u.value;if(f!=null){f.setRowNumberAsRowIndicatorColumn();var A=f.getValue()%30,h=f.getRowNumber();switch(this._isLeft||(h+=2),h%3){case 0:o.setValue(A*3+1);break;case 1:c.setValue(A/3),l.setValue(A%3);break;case 2:s.setValue(A+1);break}}}}catch(p){r={error:p}}finally{try{u&&!u.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}if(s.getValue().length===0||o.getValue().length===0||l.getValue().length===0||c.getValue().length===0||s.getValue()[0]<1||o.getValue()[0]+l.getValue()[0]<Ma.MIN_ROWS_IN_BARCODE||o.getValue()[0]+l.getValue()[0]>Ma.MAX_ROWS_IN_BARCODE)return null;var m=new c9e(s.getValue()[0],o.getValue()[0],l.getValue()[0],c.getValue()[0]);return this.removeIncorrectCodewords(a,m),m},e.prototype.removeIncorrectCodewords=function(r,n){for(var a=0;a<r.length;a++){var s=r[a];if(r[a]!=null){var o=s.getValue()%30,l=s.getRowNumber();if(l>n.getRowCount()){r[a]=null;continue}switch(this._isLeft||(l+=2),l%3){case 0:o*3+1!==n.getRowCountUpperPart()&&(r[a]=null);break;case 1:(Math.trunc(o/3)!==n.getErrorCorrectionLevel()||o%3!==n.getRowCountLowerPart())&&(r[a]=null);break;case 2:o+1!==n.getColumnCount()&&(r[a]=null);break}}}},e.prototype.isLeft=function(){return this._isLeft},e.prototype.toString=function(){return"IsLeft: "+this._isLeft+`
`+t.prototype.toString.call(this)},e}($se),A9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},m9e=function(){function t(e,r){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=r,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}return t.prototype.getDetectionResultColumns=function(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);var e=Ma.MAX_CODEWORDS_IN_BARCODE,r;do r=e,e=this.adjustRowNumbersAndGetCount();while(e>0&&e<r);return this.detectionResultColumns},t.prototype.adjustIndicatorColumnRowNumbers=function(e){e!=null&&e.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)},t.prototype.adjustRowNumbersAndGetCount=function(){var e=this.adjustRowNumbersByRow();if(e===0)return 0;for(var r=1;r<this.barcodeColumnCount+1;r++)for(var n=this.detectionResultColumns[r].getCodewords(),a=0;a<n.length;a++)n[a]!=null&&(n[a].hasValidRowNumber()||this.adjustRowNumbers(r,a,n));return e},t.prototype.adjustRowNumbersByRow=function(){this.adjustRowNumbersFromBothRI();var e=this.adjustRowNumbersFromLRI();return e+this.adjustRowNumbersFromRRI()},t.prototype.adjustRowNumbersFromBothRI=function(){if(!(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)){for(var e=this.detectionResultColumns[0].getCodewords(),r=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<e.length;n++)if(e[n]!=null&&r[n]!=null&&e[n].getRowNumber()===r[n].getRowNumber())for(var a=1;a<=this.barcodeColumnCount;a++){var s=this.detectionResultColumns[a].getCodewords()[n];s!=null&&(s.setRowNumber(e[n].getRowNumber()),s.hasValidRowNumber()||(this.detectionResultColumns[a].getCodewords()[n]=null))}}},t.prototype.adjustRowNumbersFromRRI=function(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;for(var e=0,r=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<r.length;n++)if(r[n]!=null)for(var a=r[n].getRowNumber(),s=0,o=this.barcodeColumnCount+1;o>0&&s<this.ADJUST_ROW_NUMBER_SKIP;o--){var l=this.detectionResultColumns[o].getCodewords()[n];l!=null&&(s=t.adjustRowNumberIfValid(a,s,l),l.hasValidRowNumber()||e++)}return e},t.prototype.adjustRowNumbersFromLRI=function(){if(this.detectionResultColumns[0]==null)return 0;for(var e=0,r=this.detectionResultColumns[0].getCodewords(),n=0;n<r.length;n++)if(r[n]!=null)for(var a=r[n].getRowNumber(),s=0,o=1;o<this.barcodeColumnCount+1&&s<this.ADJUST_ROW_NUMBER_SKIP;o++){var l=this.detectionResultColumns[o].getCodewords()[n];l!=null&&(s=t.adjustRowNumberIfValid(a,s,l),l.hasValidRowNumber()||e++)}return e},t.adjustRowNumberIfValid=function(e,r,n){return n==null||n.hasValidRowNumber()||(n.isValidRowNumber(e)?(n.setRowNumber(e),r=0):++r),r},t.prototype.adjustRowNumbers=function(e,r,n){var a,s;if(this.detectionResultColumns[e-1]!=null){var o=n[r],l=this.detectionResultColumns[e-1].getCodewords(),c=l;this.detectionResultColumns[e+1]!=null&&(c=this.detectionResultColumns[e+1].getCodewords());var d=new Array(14);d[2]=l[r],d[3]=c[r],r>0&&(d[0]=n[r-1],d[4]=l[r-1],d[5]=c[r-1]),r>1&&(d[8]=n[r-2],d[10]=l[r-2],d[11]=c[r-2]),r<n.length-1&&(d[1]=n[r+1],d[6]=l[r+1],d[7]=c[r+1]),r<n.length-2&&(d[9]=n[r+2],d[12]=l[r+2],d[13]=c[r+2]);try{for(var u=A9e(d),f=u.next();!f.done;f=u.next()){var A=f.value;if(t.adjustRowNumber(o,A))return}}catch(h){a={error:h}}finally{try{f&&!f.done&&(s=u.return)&&s.call(u)}finally{if(a)throw a.error}}}},t.adjustRowNumber=function(e,r){return r==null?!1:r.hasValidRowNumber()&&r.getBucket()===e.getBucket()?(e.setRowNumber(r.getRowNumber()),!0):!1},t.prototype.getBarcodeColumnCount=function(){return this.barcodeColumnCount},t.prototype.getBarcodeRowCount=function(){return this.barcodeMetadata.getRowCount()},t.prototype.getBarcodeECLevel=function(){return this.barcodeMetadata.getErrorCorrectionLevel()},t.prototype.setBoundingBox=function(e){this.boundingBox=e},t.prototype.getBoundingBox=function(){return this.boundingBox},t.prototype.setDetectionResultColumn=function(e,r){this.detectionResultColumns[e]=r},t.prototype.getDetectionResultColumn=function(e){return this.detectionResultColumns[e]},t.prototype.toString=function(){var e=this.detectionResultColumns[0];e==null&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);for(var r=new YR,n=0;n<e.getCodewords().length;n++){r.format("CW %3d:",n);for(var a=0;a<this.barcodeColumnCount+2;a++){if(this.detectionResultColumns[a]==null){r.format("    |   ");continue}var s=this.detectionResultColumns[a].getCodewords()[n];if(s==null){r.format("    |   ");continue}r.format(" %3d|%3d",s.getRowNumber(),s.getValue())}r.format("%n")}return r.toString()},t}(),p9e=function(){function t(e,r,n,a){this.rowNumber=t.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(r),this.bucket=Math.trunc(n),this.value=Math.trunc(a)}return t.prototype.hasValidRowNumber=function(){return this.isValidRowNumber(this.rowNumber)},t.prototype.isValidRowNumber=function(e){return e!==t.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3},t.prototype.setRowNumberAsRowIndicatorColumn=function(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))},t.prototype.getWidth=function(){return this.endX-this.startX},t.prototype.getStartX=function(){return this.startX},t.prototype.getEndX=function(){return this.endX},t.prototype.getBucket=function(){return this.bucket},t.prototype.getValue=function(){return this.value},t.prototype.getRowNumber=function(){return this.rowNumber},t.prototype.setRowNumber=function(e){this.rowNumber=e},t.prototype.toString=function(){return this.rowNumber+"|"+this.value},t.BARCODE_ROW_UNKNOWN=-1,t}(),g9e=function(){function t(){}return t.initialize=function(){for(var e=0;e<Ma.SYMBOL_TABLE.length;e++)for(var r=Ma.SYMBOL_TABLE[e],n=r&1,a=0;a<Ma.BARS_IN_MODULE;a++){for(var s=0;(r&1)===n;)s+=1,r>>=1;n=r&1,t.RATIOS_TABLE[e]||(t.RATIOS_TABLE[e]=new Array(Ma.BARS_IN_MODULE)),t.RATIOS_TABLE[e][Ma.BARS_IN_MODULE-a-1]=Math.fround(s/Ma.MODULES_IN_CODEWORD)}this.bSymbolTableReady=!0},t.getDecodedValue=function(e){var r=t.getDecodedCodewordValue(t.sampleBitCounts(e));return r!==-1?r:t.getClosestDecodedValue(e)},t.sampleBitCounts=function(e){for(var r=Ga.sum(e),n=new Int32Array(Ma.BARS_IN_MODULE),a=0,s=0,o=0;o<Ma.MODULES_IN_CODEWORD;o++){var l=r/(2*Ma.MODULES_IN_CODEWORD)+o*r/Ma.MODULES_IN_CODEWORD;s+e[a]<=l&&(s+=e[a],a++),n[a]++}return n},t.getDecodedCodewordValue=function(e){var r=t.getBitValue(e);return Ma.getCodeword(r)===-1?-1:r},t.getBitValue=function(e){for(var r=0,n=0;n<e.length;n++)for(var a=0;a<e[n];a++)r=r<<1|(n%2===0?1:0);return Math.trunc(r)},t.getClosestDecodedValue=function(e){var r=Ga.sum(e),n=new Array(Ma.BARS_IN_MODULE);if(r>1)for(var a=0;a<n.length;a++)n[a]=Math.fround(e[a]/r);var s=yF.MAX_VALUE,o=-1;this.bSymbolTableReady||t.initialize();for(var l=0;l<t.RATIOS_TABLE.length;l++){for(var c=0,d=t.RATIOS_TABLE[l],u=0;u<Ma.BARS_IN_MODULE;u++){var f=Math.fround(d[u]-n[u]);if(c+=Math.fround(f*f),c>=s)break}c<s&&(s=c,o=Ma.SYMBOL_TABLE[l])}return o},t.bSymbolTableReady=!1,t.RATIOS_TABLE=new Array(Ma.SYMBOL_TABLE.length).map(function(e){return new Array(Ma.BARS_IN_MODULE)}),t}(),x9e=function(){function t(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}return t.prototype.getSegmentIndex=function(){return this.segmentIndex},t.prototype.setSegmentIndex=function(e){this.segmentIndex=e},t.prototype.getFileId=function(){return this.fileId},t.prototype.setFileId=function(e){this.fileId=e},t.prototype.getOptionalData=function(){return this.optionalData},t.prototype.setOptionalData=function(e){this.optionalData=e},t.prototype.isLastSegment=function(){return this.lastSegment},t.prototype.setLastSegment=function(e){this.lastSegment=e},t.prototype.getSegmentCount=function(){return this.segmentCount},t.prototype.setSegmentCount=function(e){this.segmentCount=e},t.prototype.getSender=function(){return this.sender||null},t.prototype.setSender=function(e){this.sender=e},t.prototype.getAddressee=function(){return this.addressee||null},t.prototype.setAddressee=function(e){this.addressee=e},t.prototype.getFileName=function(){return this.fileName},t.prototype.setFileName=function(e){this.fileName=e},t.prototype.getFileSize=function(){return this.fileSize},t.prototype.setFileSize=function(e){this.fileSize=e},t.prototype.getChecksum=function(){return this.checksum},t.prototype.setChecksum=function(e){this.checksum=e},t.prototype.getTimestamp=function(){return this.timestamp},t.prototype.setTimestamp=function(e){this.timestamp=e},t}(),lG=function(){function t(){}return t.parseLong=function(e,r){return r===void 0&&(r=void 0),parseInt(e,r)},t}(),v9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),y9e=function(t){v9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="NullPointerException",e}(gd),b9e=function(){function t(){}return t.prototype.writeBytes=function(e){this.writeBytesOffset(e,0,e.length)},t.prototype.writeBytesOffset=function(e,r,n){if(e==null)throw new y9e;if(r<0||r>e.length||n<0||r+n>e.length||r+n<0)throw new qR;if(n===0)return;for(var a=0;a<n;a++)this.write(e[r+a])},t.prototype.flush=function(){},t.prototype.close=function(){},t}(),w9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),N9e=function(t){w9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(gd),C9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),_9e=function(t){C9e(e,t);function e(r){r===void 0&&(r=32);var n=t.call(this)||this;if(n.count=0,r<0)throw new Vn("Negative initial size: "+r);return n.buf=new Uint8Array(r),n}return e.prototype.ensureCapacity=function(r){r-this.buf.length>0&&this.grow(r)},e.prototype.grow=function(r){var n=this.buf.length,a=n<<1;if(a-r<0&&(a=r),a<0){if(r<0)throw new N9e;a=ba.MAX_VALUE}this.buf=Ho.copyOfUint8Array(this.buf,a)},e.prototype.write=function(r){this.ensureCapacity(this.count+1),this.buf[this.count]=r,this.count+=1},e.prototype.writeBytesOffset=function(r,n,a){if(n<0||n>r.length||a<0||n+a-r.length>0)throw new qR;this.ensureCapacity(this.count+a),Ms.arraycopy(r,n,this.buf,this.count,a),this.count+=a},e.prototype.writeTo=function(r){r.writeBytesOffset(this.buf,0,this.count)},e.prototype.reset=function(){this.count=0},e.prototype.toByteArray=function(){return Ho.copyOfUint8Array(this.buf,this.count)},e.prototype.size=function(){return this.count},e.prototype.toString=function(r){return r?typeof r=="string"?this.toString_string(r):this.toString_number(r):this.toString_void()},e.prototype.toString_void=function(){return new String(this.buf).toString()},e.prototype.toString_string=function(r){return new String(this.buf).toString()},e.prototype.toString_number=function(r){return new String(this.buf).toString()},e.prototype.close=function(){},e}(b9e),bs;(function(t){t[t.ALPHA=0]="ALPHA",t[t.LOWER=1]="LOWER",t[t.MIXED=2]="MIXED",t[t.PUNCT=3]="PUNCT",t[t.ALPHA_SHIFT=4]="ALPHA_SHIFT",t[t.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(bs||(bs={}));function Gse(){if(typeof window<"u")return window.BigInt||null;if(typeof global<"u")return global.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}var m_;function B0(t){if(typeof m_>"u"&&(m_=Gse()),m_===null)throw new Error("BigInt is not supported!");return m_(t)}function E9e(){var t=[];t[0]=B0(1);var e=B0(900);t[1]=e;for(var r=2;r<16;r++)t[r]=t[r-1]*e;return t}var S9e=function(){function t(){}return t.decode=function(e,r){var n=new ga(""),a=Qo.ISO8859_1;n.enableDecoding(a);for(var s=1,o=e[s++],l=new x9e;s<e[0];){switch(o){case t.TEXT_COMPACTION_MODE_LATCH:s=t.textCompaction(e,s,n);break;case t.BYTE_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:s=t.byteCompaction(o,e,a,s,n);break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[s++]);break;case t.NUMERIC_COMPACTION_MODE_LATCH:s=t.numericCompaction(e,s,n);break;case t.ECI_CHARSET:Qo.getCharacterSetECIByValue(e[s++]);break;case t.ECI_GENERAL_PURPOSE:s+=2;break;case t.ECI_USER_DEFINED:s++;break;case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:s=t.decodeMacroBlock(e,s,l);break;case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:throw new Zr;default:s--,s=t.textCompaction(e,s,n);break}if(s<e.length)o=e[s++];else throw Zr.getFormatInstance()}if(n.length()===0)throw Zr.getFormatInstance();var c=new EP(null,n.toString(),null,r);return c.setOther(l),c},t.decodeMacroBlock=function(e,r,n){if(r+t.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw Zr.getFormatInstance();for(var a=new Int32Array(t.NUMBER_OF_SEQUENCE_CODEWORDS),s=0;s<t.NUMBER_OF_SEQUENCE_CODEWORDS;s++,r++)a[s]=e[r];n.setSegmentIndex(ba.parseInt(t.decodeBase900toBase10(a,t.NUMBER_OF_SEQUENCE_CODEWORDS)));var o=new ga;r=t.textCompaction(e,r,o),n.setFileId(o.toString());var l=-1;for(e[r]===t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(l=r+1);r<e[0];)switch(e[r]){case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(r++,e[r]){case t.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:var c=new ga;r=t.textCompaction(e,r+1,c),n.setFileName(c.toString());break;case t.MACRO_PDF417_OPTIONAL_FIELD_SENDER:var d=new ga;r=t.textCompaction(e,r+1,d),n.setSender(d.toString());break;case t.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:var u=new ga;r=t.textCompaction(e,r+1,u),n.setAddressee(u.toString());break;case t.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:var f=new ga;r=t.numericCompaction(e,r+1,f),n.setSegmentCount(ba.parseInt(f.toString()));break;case t.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:var A=new ga;r=t.numericCompaction(e,r+1,A),n.setTimestamp(lG.parseLong(A.toString()));break;case t.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:var h=new ga;r=t.numericCompaction(e,r+1,h),n.setChecksum(ba.parseInt(h.toString()));break;case t.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:var m=new ga;r=t.numericCompaction(e,r+1,m),n.setFileSize(lG.parseLong(m.toString()));break;default:throw Zr.getFormatInstance()}break;case t.MACRO_PDF417_TERMINATOR:r++,n.setLastSegment(!0);break;default:throw Zr.getFormatInstance()}if(l!==-1){var p=r-l;n.isLastSegment()&&p--,n.setOptionalData(Ho.copyOfRange(e,l,l+p))}return r},t.textCompaction=function(e,r,n){for(var a=new Int32Array((e[0]-r)*2),s=new Int32Array((e[0]-r)*2),o=0,l=!1;r<e[0]&&!l;){var c=e[r++];if(c<t.TEXT_COMPACTION_MODE_LATCH)a[o]=c/30,a[o+1]=c%30,o+=2;else switch(c){case t.TEXT_COMPACTION_MODE_LATCH:a[o++]=t.TEXT_COMPACTION_MODE_LATCH;break;case t.BYTE_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.NUMERIC_COMPACTION_MODE_LATCH:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:r--,l=!0;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a[o]=t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,c=e[r++],s[o]=c,o++;break}}return t.decodeTextCompaction(a,s,o,n),r},t.decodeTextCompaction=function(e,r,n,a){for(var s=bs.ALPHA,o=bs.ALPHA,l=0;l<n;){var c=e[l],d="";switch(s){case bs.ALPHA:if(c<26)d=String.fromCharCode(65+c);else switch(c){case 26:d=" ";break;case t.LL:s=bs.LOWER;break;case t.ML:s=bs.MIXED;break;case t.PS:o=s,s=bs.PUNCT_SHIFT;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=bs.ALPHA;break}break;case bs.LOWER:if(c<26)d=String.fromCharCode(97+c);else switch(c){case 26:d=" ";break;case t.AS:o=s,s=bs.ALPHA_SHIFT;break;case t.ML:s=bs.MIXED;break;case t.PS:o=s,s=bs.PUNCT_SHIFT;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=bs.ALPHA;break}break;case bs.MIXED:if(c<t.PL)d=t.MIXED_CHARS[c];else switch(c){case t.PL:s=bs.PUNCT;break;case 26:d=" ";break;case t.LL:s=bs.LOWER;break;case t.AL:s=bs.ALPHA;break;case t.PS:o=s,s=bs.PUNCT_SHIFT;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=bs.ALPHA;break}break;case bs.PUNCT:if(c<t.PAL)d=t.PUNCT_CHARS[c];else switch(c){case t.PAL:s=bs.ALPHA;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=bs.ALPHA;break}break;case bs.ALPHA_SHIFT:if(s=o,c<26)d=String.fromCharCode(65+c);else switch(c){case 26:d=" ";break;case t.TEXT_COMPACTION_MODE_LATCH:s=bs.ALPHA;break}break;case bs.PUNCT_SHIFT:if(s=o,c<t.PAL)d=t.PUNCT_CHARS[c];else switch(c){case t.PAL:s=bs.ALPHA;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=bs.ALPHA;break}break}d!==""&&a.append(d),l++}},t.byteCompaction=function(e,r,n,a,s){var o=new _9e,l=0,c=0,d=!1;switch(e){case t.BYTE_COMPACTION_MODE_LATCH:for(var u=new Int32Array(6),f=r[a++];a<r[0]&&!d;)switch(u[l++]=f,c=900*c+f,f=r[a++],f){case t.TEXT_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH:case t.NUMERIC_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:a--,d=!0;break;default:if(l%5===0&&l>0){for(var A=0;A<6;++A)o.write(Number(B0(c)>>B0(8*(5-A))));c=0,l=0}break}a===r[0]&&f<t.TEXT_COMPACTION_MODE_LATCH&&(u[l++]=f);for(var h=0;h<l;h++)o.write(u[h]);break;case t.BYTE_COMPACTION_MODE_LATCH_6:for(;a<r[0]&&!d;){var m=r[a++];if(m<t.TEXT_COMPACTION_MODE_LATCH)l++,c=900*c+m;else switch(m){case t.TEXT_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH:case t.NUMERIC_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:a--,d=!0;break}if(l%5===0&&l>0){for(var A=0;A<6;++A)o.write(Number(B0(c)>>B0(8*(5-A))));c=0,l=0}}break}return s.append(Du.decode(o.toByteArray(),n)),a},t.numericCompaction=function(e,r,n){for(var a=0,s=!1,o=new Int32Array(t.MAX_NUMERIC_CODEWORDS);r<e[0]&&!s;){var l=e[r++];if(r===e[0]&&(s=!0),l<t.TEXT_COMPACTION_MODE_LATCH)o[a]=l,a++;else switch(l){case t.TEXT_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:r--,s=!0;break}(a%t.MAX_NUMERIC_CODEWORDS===0||l===t.NUMERIC_COMPACTION_MODE_LATCH||s)&&a>0&&(n.append(t.decodeBase900toBase10(o,a)),a=0)}return r},t.decodeBase900toBase10=function(e,r){for(var n=B0(0),a=0;a<r;a++)n+=t.EXP900[r-a-1]*B0(e[a]);var s=n.toString();if(s.charAt(0)!=="1")throw new Zr;return s.substring(1)},t.TEXT_COMPACTION_MODE_LATCH=900,t.BYTE_COMPACTION_MODE_LATCH=901,t.NUMERIC_COMPACTION_MODE_LATCH=902,t.BYTE_COMPACTION_MODE_LATCH_6=924,t.ECI_USER_DEFINED=925,t.ECI_GENERAL_PURPOSE=926,t.ECI_CHARSET=927,t.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,t.MACRO_PDF417_TERMINATOR=922,t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,t.MAX_NUMERIC_CODEWORDS=15,t.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,t.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,t.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,t.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,t.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,t.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,t.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,t.PL=25,t.LL=27,t.AS=27,t.ML=28,t.AL=28,t.PS=29,t.PAL=29,t.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,t.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",t.EXP900=Gse()?E9e():[],t.NUMBER_OF_SEQUENCE_CODEWORDS=2,t}(),jy=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},j9e=function(){function t(){}return t.decode=function(e,r,n,a,s,o,l){for(var c=new NF(e,r,n,a,s),d=null,u=null,f,A=!0;;A=!1){if(r!=null&&(d=t.getRowIndicatorColumn(e,c,r,!0,o,l)),a!=null&&(u=t.getRowIndicatorColumn(e,c,a,!1,o,l)),f=t.merge(d,u),f==null)throw Ar.getNotFoundInstance();var h=f.getBoundingBox();if(A&&h!=null&&(h.getMinY()<c.getMinY()||h.getMaxY()>c.getMaxY()))c=h;else break}f.setBoundingBox(c);var m=f.getBarcodeColumnCount()+1;f.setDetectionResultColumn(0,d),f.setDetectionResultColumn(m,u);for(var p=d!=null,x=1;x<=m;x++){var v=p?x:m-x;if(f.getDetectionResultColumn(v)===void 0){var y=void 0;v===0||v===m?y=new oG(c,v===0):y=new $se(c),f.setDetectionResultColumn(v,y);for(var b=-1,w=b,I=c.getMinY();I<=c.getMaxY();I++){if(b=t.getStartColumn(f,v,I,p),b<0||b>c.getMaxX()){if(w===-1)continue;b=w}var j=t.detectCodeword(e,c.getMinX(),c.getMaxX(),p,b,I,o,l);j!=null&&(y.setCodeword(I,j),w=b,o=Math.min(o,j.getWidth()),l=Math.max(l,j.getWidth()))}}}return t.createDecoderResult(f)},t.merge=function(e,r){if(e==null&&r==null)return null;var n=t.getBarcodeMetadata(e,r);if(n==null)return null;var a=NF.merge(t.adjustBoundingBox(e),t.adjustBoundingBox(r));return new m9e(n,a)},t.adjustBoundingBox=function(e){var r,n;if(e==null)return null;var a=e.getRowHeights();if(a==null)return null;var s=t.getMax(a),o=0;try{for(var l=jy(a),c=l.next();!c.done;c=l.next()){var d=c.value;if(o+=s-d,d>0)break}}catch(h){r={error:h}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}for(var u=e.getCodewords(),f=0;o>0&&u[f]==null;f++)o--;for(var A=0,f=a.length-1;f>=0&&(A+=s-a[f],!(a[f]>0));f--);for(var f=u.length-1;A>0&&u[f]==null;f--)A--;return e.getBoundingBox().addMissingRows(o,A,e.isLeft())},t.getMax=function(e){var r,n,a=-1;try{for(var s=jy(e),o=s.next();!o.done;o=s.next()){var l=o.value;a=Math.max(a,l)}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a},t.getBarcodeMetadata=function(e,r){var n;if(e==null||(n=e.getBarcodeMetadata())==null)return r==null?null:r.getBarcodeMetadata();var a;return r==null||(a=r.getBarcodeMetadata())==null?n:n.getColumnCount()!==a.getColumnCount()&&n.getErrorCorrectionLevel()!==a.getErrorCorrectionLevel()&&n.getRowCount()!==a.getRowCount()?null:n},t.getRowIndicatorColumn=function(e,r,n,a,s,o){for(var l=new oG(r,a),c=0;c<2;c++)for(var d=c===0?1:-1,u=Math.trunc(Math.trunc(n.getX())),f=Math.trunc(Math.trunc(n.getY()));f<=r.getMaxY()&&f>=r.getMinY();f+=d){var A=t.detectCodeword(e,0,e.getWidth(),a,u,f,s,o);A!=null&&(l.setCodeword(f,A),a?u=A.getStartX():u=A.getEndX())}return l},t.adjustCodewordCount=function(e,r){var n=r[0][1],a=n.getValue(),s=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-t.getNumberOfECCodeWords(e.getBarcodeECLevel());if(a.length===0){if(s<1||s>Ma.MAX_CODEWORDS_IN_BARCODE)throw Ar.getNotFoundInstance();n.setValue(s)}else a[0]!==s&&n.setValue(s)},t.createDecoderResult=function(e){var r=t.createBarcodeMatrix(e);t.adjustCodewordCount(e,r);for(var n=new Array,a=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),s=[],o=new Array,l=0;l<e.getBarcodeRowCount();l++)for(var c=0;c<e.getBarcodeColumnCount();c++){var d=r[l][c+1].getValue(),u=l*e.getBarcodeColumnCount()+c;d.length===0?n.push(u):d.length===1?a[u]=d[0]:(o.push(u),s.push(d))}for(var f=new Array(s.length),A=0;A<f.length;A++)f[A]=s[A];return t.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),a,Ma.toIntArray(n),Ma.toIntArray(o),f)},t.createDecoderResultFromAmbiguousValues=function(e,r,n,a,s){for(var o=new Int32Array(a.length),l=100;l-- >0;){for(var c=0;c<o.length;c++)r[a[c]]=s[c][o[c]];try{return t.decodeCodewords(r,e,n)}catch(u){var d=u instanceof wo;if(!d)throw u}if(o.length===0)throw wo.getChecksumInstance();for(var c=0;c<o.length;c++)if(o[c]<s[c].length-1){o[c]++;break}else if(o[c]=0,c===o.length-1)throw wo.getChecksumInstance()}throw wo.getChecksumInstance()},t.createBarcodeMatrix=function(e){for(var r,n,a,s,o=Array.from({length:e.getBarcodeRowCount()},function(){return new Array(e.getBarcodeColumnCount()+2)}),l=0;l<o.length;l++)for(var c=0;c<o[l].length;c++)o[l][c]=new ib;var d=0;try{for(var u=jy(e.getDetectionResultColumns()),f=u.next();!f.done;f=u.next()){var A=f.value;if(A!=null)try{for(var h=(a=void 0,jy(A.getCodewords())),m=h.next();!m.done;m=h.next()){var p=m.value;if(p!=null){var x=p.getRowNumber();if(x>=0){if(x>=o.length)continue;o[x][d].setValue(p.getValue())}}}}catch(v){a={error:v}}finally{try{m&&!m.done&&(s=h.return)&&s.call(h)}finally{if(a)throw a.error}}d++}}catch(v){r={error:v}}finally{try{f&&!f.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}return o},t.isValidBarcodeColumn=function(e,r){return r>=0&&r<=e.getBarcodeColumnCount()+1},t.getStartColumn=function(e,r,n,a){var s,o,l=a?1:-1,c=null;if(t.isValidBarcodeColumn(e,r-l)&&(c=e.getDetectionResultColumn(r-l).getCodeword(n)),c!=null)return a?c.getEndX():c.getStartX();if(c=e.getDetectionResultColumn(r).getCodewordNearby(n),c!=null)return a?c.getStartX():c.getEndX();if(t.isValidBarcodeColumn(e,r-l)&&(c=e.getDetectionResultColumn(r-l).getCodewordNearby(n)),c!=null)return a?c.getEndX():c.getStartX();for(var d=0;t.isValidBarcodeColumn(e,r-l);){r-=l;try{for(var u=(s=void 0,jy(e.getDetectionResultColumn(r).getCodewords())),f=u.next();!f.done;f=u.next()){var A=f.value;if(A!=null)return(a?A.getEndX():A.getStartX())+l*d*(A.getEndX()-A.getStartX())}}catch(h){s={error:h}}finally{try{f&&!f.done&&(o=u.return)&&o.call(u)}finally{if(s)throw s.error}}d++}return a?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()},t.detectCodeword=function(e,r,n,a,s,o,l,c){s=t.adjustCodewordStartColumn(e,r,n,a,s,o);var d=t.getModuleBitCount(e,r,n,a,s,o);if(d==null)return null;var u,f=Ga.sum(d);if(a)u=s+f;else{for(var A=0;A<d.length/2;A++){var h=d[A];d[A]=d[d.length-1-A],d[d.length-1-A]=h}u=s,s=u-f}if(!t.checkCodewordSkew(f,l,c))return null;var m=g9e.getDecodedValue(d),p=Ma.getCodeword(m);return p===-1?null:new p9e(s,u,t.getCodewordBucketNumber(m),p)},t.getModuleBitCount=function(e,r,n,a,s,o){for(var l=s,c=new Int32Array(8),d=0,u=a?1:-1,f=a;(a?l<n:l>=r)&&d<c.length;)e.get(l,o)===f?(c[d]++,l+=u):(d++,f=!f);return d===c.length||l===(a?n:r)&&d===c.length-1?c:null},t.getNumberOfECCodeWords=function(e){return 2<<e},t.adjustCodewordStartColumn=function(e,r,n,a,s,o){for(var l=s,c=a?-1:1,d=0;d<2;d++){for(;(a?l>=r:l<n)&&a===e.get(l,o);){if(Math.abs(s-l)>t.CODEWORD_SKEW_SIZE)return s;l+=c}c=-c,a=!a}return l},t.checkCodewordSkew=function(e,r,n){return r-t.CODEWORD_SKEW_SIZE<=e&&e<=n+t.CODEWORD_SKEW_SIZE},t.decodeCodewords=function(e,r,n){if(e.length===0)throw Zr.getFormatInstance();var a=1<<r+1,s=t.correctErrors(e,n,a);t.verifyCodewordCount(e,a);var o=S9e.decode(e,""+r);return o.setErrorsCorrected(s),o.setErasures(n.length),o},t.correctErrors=function(e,r,n){if(r!=null&&r.length>n/2+t.MAX_ERRORS||n<0||n>t.MAX_EC_CODEWORDS)throw wo.getChecksumInstance();return t.errorCorrection.decode(e,n,r)},t.verifyCodewordCount=function(e,r){if(e.length<4)throw Zr.getFormatInstance();var n=e[0];if(n>e.length)throw Zr.getFormatInstance();if(n===0)if(r<e.length)e[0]=e.length-r;else throw Zr.getFormatInstance()},t.getBitCountForCodeword=function(e){for(var r=new Int32Array(8),n=0,a=r.length-1;!((e&1)!==n&&(n=e&1,a--,a<0));)r[a]++,e>>=1;return r},t.getCodewordBucketNumber=function(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)},t.getCodewordBucketNumber_number=function(e){return t.getCodewordBucketNumber(t.getBitCountForCodeword(e))},t.getCodewordBucketNumber_Int32Array=function(e){return(e[0]-e[2]+e[4]-e[6]+9)%9},t.toString=function(e){for(var r=new YR,n=0;n<e.length;n++){r.format("Row %2d: ",n);for(var a=0;a<e[n].length;a++){var s=e[n][a];s.getValue().length===0?r.format("        ",null):r.format("%4d(%2d)",s.getValue()[0],s.getConfidence(s.getValue()[0]))}r.format("%n")}return r.toString()},t.CODEWORD_SKEW_SIZE=2,t.MAX_ERRORS=3,t.MAX_EC_CODEWORDS=512,t.errorCorrection=new l9e,t}(),I9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},uj=function(){function t(){}return t.prototype.decode=function(e,r){r===void 0&&(r=null);var n=t.decode(e,r,!1);if(n==null||n.length===0||n[0]==null)throw Ar.getNotFoundInstance();return n[0]},t.prototype.decodeMultiple=function(e,r){r===void 0&&(r=null);try{return t.decode(e,r,!0)}catch(n){throw n instanceof Zr||n instanceof wo?Ar.getNotFoundInstance():n}},t.decode=function(e,r,n){var a,s,o=new Array,l=r9e.detectMultiple(e,r,n);try{for(var c=I9e(l.getPoints()),d=c.next();!d.done;d=c.next()){var u=d.value,f=j9e.decode(l.getBits(),u[4],u[5],u[6],u[7],t.getMinCodewordWidth(u),t.getMaxCodewordWidth(u)),A=new Nc(f.getText(),f.getRawBytes(),void 0,u,Qn.PDF_417);A.putMetadata(Vl.ERROR_CORRECTION_LEVEL,f.getECLevel());var h=f.getOther();h!=null&&A.putMetadata(Vl.PDF417_EXTRA_METADATA,h),o.push(A)}}catch(m){a={error:m}}finally{try{d&&!d.done&&(s=c.return)&&s.call(c)}finally{if(a)throw a.error}}return o.map(function(m){return m})},t.getMaxWidth=function(e,r){return e==null||r==null?0:Math.trunc(Math.abs(e.getX()-r.getX()))},t.getMinWidth=function(e,r){return e==null||r==null?ba.MAX_VALUE:Math.trunc(Math.abs(e.getX()-r.getX()))},t.getMaxCodewordWidth=function(e){return Math.floor(Math.max(Math.max(t.getMaxWidth(e[0],e[4]),t.getMaxWidth(e[6],e[2])*Ma.MODULES_IN_CODEWORD/Ma.MODULES_IN_STOP_PATTERN),Math.max(t.getMaxWidth(e[1],e[5]),t.getMaxWidth(e[7],e[3])*Ma.MODULES_IN_CODEWORD/Ma.MODULES_IN_STOP_PATTERN)))},t.getMinCodewordWidth=function(e){return Math.floor(Math.min(Math.min(t.getMinWidth(e[0],e[4]),t.getMinWidth(e[6],e[2])*Ma.MODULES_IN_CODEWORD/Ma.MODULES_IN_STOP_PATTERN),Math.min(t.getMinWidth(e[1],e[5]),t.getMinWidth(e[7],e[3])*Ma.MODULES_IN_CODEWORD/Ma.MODULES_IN_STOP_PATTERN)))},t.prototype.reset=function(){},t}(),P9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),cG=function(t){P9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ReaderException",e}(gd),dG=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Kse=function(){function t(){}return t.prototype.decode=function(e,r){return this.setHints(r),this.decodeInternal(e)},t.prototype.decodeWithState=function(e){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(e)},t.prototype.setHints=function(e){this.hints=e;var r=e!=null&&e.get(Ls.TRY_HARDER)!==void 0,n=e==null?null:e.get(Ls.POSSIBLE_FORMATS),a=new Array;if(n!=null){var s=n.some(function(o){return o===Qn.UPC_A||o===Qn.UPC_E||o===Qn.EAN_13||o===Qn.EAN_8||o===Qn.CODABAR||o===Qn.CODE_39||o===Qn.CODE_93||o===Qn.CODE_128||o===Qn.ITF||o===Qn.RSS_14||o===Qn.RSS_EXPANDED});s&&!r&&a.push(new rv(e)),n.includes(Qn.QR_CODE)&&a.push(new dj),n.includes(Qn.DATA_MATRIX)&&a.push(new cj),n.includes(Qn.AZTEC)&&a.push(new oj),n.includes(Qn.PDF_417)&&a.push(new uj),s&&r&&a.push(new rv(e))}a.length===0&&(r||a.push(new rv(e)),a.push(new dj),a.push(new cj),a.push(new oj),a.push(new uj),r&&a.push(new rv(e))),this.readers=a},t.prototype.reset=function(){var e,r;if(this.readers!==null)try{for(var n=dG(this.readers),a=n.next();!a.done;a=n.next()){var s=a.value;s.reset()}}catch(o){e={error:o}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.decodeInternal=function(e){var r,n;if(this.readers===null)throw new cG("No readers where selected, nothing can be read.");try{for(var a=dG(this.readers),s=a.next();!s.done;s=a.next()){var o=s.value;try{return o.decode(e,this.hints)}catch(l){if(l instanceof cG)continue}}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}throw new Ar("No MultiFormat Readers were able to detect the code.")},t}(),T9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){T9e(e,t);function e(r,n){r===void 0&&(r=null),n===void 0&&(n=500);var a=this,s=new Kse;return s.setHints(r),a=t.call(this,s,n)||this,a}return e.prototype.decodeBitmap=function(r){return this.reader.decodeWithState(r)},e})(P1);var B9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){B9e(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new uj,r)||this}return e})(P1);var k9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){k9e(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new dj,r)||this}return e})(P1);var CF;(function(t){t[t.ERROR_CORRECTION=0]="ERROR_CORRECTION",t[t.CHARACTER_SET=1]="CHARACTER_SET",t[t.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",t[t.DATA_MATRIX_COMPACT=3]="DATA_MATRIX_COMPACT",t[t.MIN_SIZE=4]="MIN_SIZE",t[t.MAX_SIZE=5]="MAX_SIZE",t[t.MARGIN=6]="MARGIN",t[t.PDF417_COMPACT=7]="PDF417_COMPACT",t[t.PDF417_COMPACTION=8]="PDF417_COMPACTION",t[t.PDF417_DIMENSIONS=9]="PDF417_DIMENSIONS",t[t.AZTEC_LAYERS=10]="AZTEC_LAYERS",t[t.QR_VERSION=11]="QR_VERSION",t[t.GS1_FORMAT=12]="GS1_FORMAT",t[t.FORCE_C40=13]="FORCE_C40"})(CF||(CF={}));const p_=CF;var qse=function(){function t(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new gm(e,Int32Array.from([1])))}return t.prototype.buildGenerator=function(e){var r=this.cachedGenerators;if(e>=r.length)for(var n=r[r.length-1],a=this.field,s=r.length;s<=e;s++){var o=n.multiply(new gm(a,Int32Array.from([1,a.exp(s-1+a.getGeneratorBase())])));r.push(o),n=o}return r[e]},t.prototype.encode=function(e,r){if(r===0)throw new Vn("No error correction bytes");var n=e.length-r;if(n<=0)throw new Vn("No data bytes provided");var a=this.buildGenerator(r),s=new Int32Array(n);Ms.arraycopy(e,0,s,0,n);var o=new gm(this.field,s);o=o.multiplyByMonomial(r,1);for(var l=o.divide(a)[1],c=l.getCoefficients(),d=r-c.length,u=0;u<d;u++)e[n+u]=0;Ms.arraycopy(c,0,e,n+d,c.length)},t}(),ob=function(){function t(){}return t.applyMaskPenaltyRule1=function(e){return t.applyMaskPenaltyRule1Internal(e,!0)+t.applyMaskPenaltyRule1Internal(e,!1)},t.applyMaskPenaltyRule2=function(e){for(var r=0,n=e.getArray(),a=e.getWidth(),s=e.getHeight(),o=0;o<s-1;o++)for(var l=n[o],c=0;c<a-1;c++){var d=l[c];d===l[c+1]&&d===n[o+1][c]&&d===n[o+1][c+1]&&r++}return t.N2*r},t.applyMaskPenaltyRule3=function(e){for(var r=0,n=e.getArray(),a=e.getWidth(),s=e.getHeight(),o=0;o<s;o++)for(var l=0;l<a;l++){var c=n[o];l+6<a&&c[l]===1&&c[l+1]===0&&c[l+2]===1&&c[l+3]===1&&c[l+4]===1&&c[l+5]===0&&c[l+6]===1&&(t.isWhiteHorizontal(c,l-4,l)||t.isWhiteHorizontal(c,l+7,l+11))&&r++,o+6<s&&n[o][l]===1&&n[o+1][l]===0&&n[o+2][l]===1&&n[o+3][l]===1&&n[o+4][l]===1&&n[o+5][l]===0&&n[o+6][l]===1&&(t.isWhiteVertical(n,l,o-4,o)||t.isWhiteVertical(n,l,o+7,o+11))&&r++}return r*t.N3},t.isWhiteHorizontal=function(e,r,n){r=Math.max(r,0),n=Math.min(n,e.length);for(var a=r;a<n;a++)if(e[a]===1)return!1;return!0},t.isWhiteVertical=function(e,r,n,a){n=Math.max(n,0),a=Math.min(a,e.length);for(var s=n;s<a;s++)if(e[s][r]===1)return!1;return!0},t.applyMaskPenaltyRule4=function(e){for(var r=0,n=e.getArray(),a=e.getWidth(),s=e.getHeight(),o=0;o<s;o++)for(var l=n[o],c=0;c<a;c++)l[c]===1&&r++;var d=e.getHeight()*e.getWidth(),u=Math.floor(Math.abs(r*2-d)*10/d);return u*t.N4},t.getDataMaskBit=function(e,r,n){var a,s;switch(e){case 0:a=n+r&1;break;case 1:a=n&1;break;case 2:a=r%3;break;case 3:a=(n+r)%3;break;case 4:a=Math.floor(n/2)+Math.floor(r/3)&1;break;case 5:s=n*r,a=(s&1)+s%3;break;case 6:s=n*r,a=(s&1)+s%3&1;break;case 7:s=n*r,a=s%3+(n+r&1)&1;break;default:throw new Vn("Invalid mask pattern: "+e)}return a===0},t.applyMaskPenaltyRule1Internal=function(e,r){for(var n=0,a=r?e.getHeight():e.getWidth(),s=r?e.getWidth():e.getHeight(),o=e.getArray(),l=0;l<a;l++){for(var c=0,d=-1,u=0;u<s;u++){var f=r?o[l][u]:o[u][l];f===d?c++:(c>=5&&(n+=t.N1+(c-5)),c=1,d=f)}c>=5&&(n+=t.N1+(c-5))}return n},t.N1=3,t.N2=3,t.N3=40,t.N4=10,t}(),F9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},O9e=function(){function t(e,r){this.width=e,this.height=r;for(var n=new Array(r),a=0;a!==r;a++)n[a]=new Uint8Array(e);this.bytes=n}return t.prototype.getHeight=function(){return this.height},t.prototype.getWidth=function(){return this.width},t.prototype.get=function(e,r){return this.bytes[r][e]},t.prototype.getArray=function(){return this.bytes},t.prototype.setNumber=function(e,r,n){this.bytes[r][e]=n},t.prototype.setBoolean=function(e,r,n){this.bytes[r][e]=n?1:0},t.prototype.clear=function(e){var r,n;try{for(var a=F9e(this.bytes),s=a.next();!s.done;s=a.next()){var o=s.value;Ho.fill(o,e)}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;if(this.width!==r.width||this.height!==r.height)return!1;for(var n=0,a=this.height;n<a;++n)for(var s=this.bytes[n],o=r.bytes[n],l=0,c=this.width;l<c;++l)if(s[l]!==o[l])return!1;return!0},t.prototype.toString=function(){for(var e=new ga,r=0,n=this.height;r<n;++r){for(var a=this.bytes[r],s=0,o=this.width;s<o;++s)switch(a[s]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ");break}e.append(`
`)}return e.toString()},t}(),_F=function(){function t(){this.maskPattern=-1}return t.prototype.getMode=function(){return this.mode},t.prototype.getECLevel=function(){return this.ecLevel},t.prototype.getVersion=function(){return this.version},t.prototype.getMaskPattern=function(){return this.maskPattern},t.prototype.getMatrix=function(){return this.matrix},t.prototype.toString=function(){var e=new ga;return e.append(`<<
`),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append(`
 ecLevel: `),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append(`
 version: `),e.append(this.version?this.version.toString():"null"),e.append(`
 maskPattern: `),e.append(this.maskPattern.toString()),this.matrix?(e.append(`
 matrix:
`),e.append(this.matrix.toString())):e.append(`
 matrix: null
`),e.append(`>>
`),e.toString()},t.prototype.setMode=function(e){this.mode=e},t.prototype.setECLevel=function(e){this.ecLevel=e},t.prototype.setVersion=function(e){this.version=e},t.prototype.setMaskPattern=function(e){this.maskPattern=e},t.prototype.setMatrix=function(e){this.matrix=e},t.isValidMaskPattern=function(e){return e>=0&&e<t.NUM_MASK_PATTERNS},t.NUM_MASK_PATTERNS=8,t}(),D9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ks=function(t){D9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="WriterException",e}(gd),uG=function(){function t(){}return t.clearMatrix=function(e){e.clear(255)},t.buildMatrix=function(e,r,n,a,s){t.clearMatrix(s),t.embedBasicPatterns(n,s),t.embedTypeInfo(r,a,s),t.maybeEmbedVersionInfo(n,s),t.embedDataBits(e,a,s)},t.embedBasicPatterns=function(e,r){t.embedPositionDetectionPatternsAndSeparators(r),t.embedDarkDotAtLeftBottomCorner(r),t.maybeEmbedPositionAdjustmentPatterns(e,r),t.embedTimingPatterns(r)},t.embedTypeInfo=function(e,r,n){var a=new Al;t.makeTypeInfoBits(e,r,a);for(var s=0,o=a.getSize();s<o;++s){var l=a.get(a.getSize()-1-s),c=t.TYPE_INFO_COORDINATES[s],d=c[0],u=c[1];if(n.setBoolean(d,u,l),s<8){var f=n.getWidth()-s-1,A=8;n.setBoolean(f,A,l)}else{var f=8,A=n.getHeight()-7+(s-8);n.setBoolean(f,A,l)}}},t.maybeEmbedVersionInfo=function(e,r){if(!(e.getVersionNumber()<7)){var n=new Al;t.makeVersionInfoBits(e,n);for(var a=6*3-1,s=0;s<6;++s)for(var o=0;o<3;++o){var l=n.get(a);a--,r.setBoolean(s,r.getHeight()-11+o,l),r.setBoolean(r.getHeight()-11+o,s,l)}}},t.embedDataBits=function(e,r,n){for(var a=0,s=-1,o=n.getWidth()-1,l=n.getHeight()-1;o>0;){for(o===6&&(o-=1);l>=0&&l<n.getHeight();){for(var c=0;c<2;++c){var d=o-c;if(t.isEmpty(n.get(d,l))){var u=void 0;a<e.getSize()?(u=e.get(a),++a):u=!1,r!==255&&ob.getDataMaskBit(r,d,l)&&(u=!u),n.setBoolean(d,l,u)}}l+=s}s=-s,l+=s,o-=2}if(a!==e.getSize())throw new Ks("Not all bits consumed: "+a+"/"+e.getSize())},t.findMSBSet=function(e){return 32-ba.numberOfLeadingZeros(e)},t.calculateBCHCode=function(e,r){if(r===0)throw new Vn("0 polynomial");var n=t.findMSBSet(r);for(e<<=n-1;t.findMSBSet(e)>=n;)e^=r<<t.findMSBSet(e)-n;return e},t.makeTypeInfoBits=function(e,r,n){if(!_F.isValidMaskPattern(r))throw new Ks("Invalid mask pattern");var a=e.getBits()<<3|r;n.appendBits(a,5);var s=t.calculateBCHCode(a,t.TYPE_INFO_POLY);n.appendBits(s,10);var o=new Al;if(o.appendBits(t.TYPE_INFO_MASK_PATTERN,15),n.xor(o),n.getSize()!==15)throw new Ks("should not happen but we got: "+n.getSize())},t.makeVersionInfoBits=function(e,r){r.appendBits(e.getVersionNumber(),6);var n=t.calculateBCHCode(e.getVersionNumber(),t.VERSION_INFO_POLY);if(r.appendBits(n,12),r.getSize()!==18)throw new Ks("should not happen but we got: "+r.getSize())},t.isEmpty=function(e){return e===255},t.embedTimingPatterns=function(e){for(var r=8;r<e.getWidth()-8;++r){var n=(r+1)%2;t.isEmpty(e.get(r,6))&&e.setNumber(r,6,n),t.isEmpty(e.get(6,r))&&e.setNumber(6,r,n)}},t.embedDarkDotAtLeftBottomCorner=function(e){if(e.get(8,e.getHeight()-8)===0)throw new Ks;e.setNumber(8,e.getHeight()-8,1)},t.embedHorizontalSeparationPattern=function(e,r,n){for(var a=0;a<8;++a){if(!t.isEmpty(n.get(e+a,r)))throw new Ks;n.setNumber(e+a,r,0)}},t.embedVerticalSeparationPattern=function(e,r,n){for(var a=0;a<7;++a){if(!t.isEmpty(n.get(e,r+a)))throw new Ks;n.setNumber(e,r+a,0)}},t.embedPositionAdjustmentPattern=function(e,r,n){for(var a=0;a<5;++a)for(var s=t.POSITION_ADJUSTMENT_PATTERN[a],o=0;o<5;++o)n.setNumber(e+o,r+a,s[o])},t.embedPositionDetectionPattern=function(e,r,n){for(var a=0;a<7;++a)for(var s=t.POSITION_DETECTION_PATTERN[a],o=0;o<7;++o)n.setNumber(e+o,r+a,s[o])},t.embedPositionDetectionPatternsAndSeparators=function(e){var r=t.POSITION_DETECTION_PATTERN[0].length;t.embedPositionDetectionPattern(0,0,e),t.embedPositionDetectionPattern(e.getWidth()-r,0,e),t.embedPositionDetectionPattern(0,e.getWidth()-r,e);var n=8;t.embedHorizontalSeparationPattern(0,n-1,e),t.embedHorizontalSeparationPattern(e.getWidth()-n,n-1,e),t.embedHorizontalSeparationPattern(0,e.getWidth()-n,e);var a=7;t.embedVerticalSeparationPattern(a,0,e),t.embedVerticalSeparationPattern(e.getHeight()-a-1,0,e),t.embedVerticalSeparationPattern(a,e.getHeight()-a,e)},t.maybeEmbedPositionAdjustmentPatterns=function(e,r){if(!(e.getVersionNumber()<2))for(var n=e.getVersionNumber()-1,a=t.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[n],s=0,o=a.length;s!==o;s++){var l=a[s];if(l>=0)for(var c=0;c!==o;c++){var d=a[c];d>=0&&t.isEmpty(r.get(d,l))&&t.embedPositionAdjustmentPattern(d-2,l-2,r)}}},t.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),t.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),t.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),t.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),t.VERSION_INFO_POLY=7973,t.TYPE_INFO_POLY=1335,t.TYPE_INFO_MASK_PATTERN=21522,t}(),R9e=function(){function t(e,r){this.dataBytes=e,this.errorCorrectionBytes=r}return t.prototype.getDataBytes=function(){return this.dataBytes},t.prototype.getErrorCorrectionBytes=function(){return this.errorCorrectionBytes},t}(),fG=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function t(){}return t.calculateMaskPenalty=function(e){return ob.applyMaskPenaltyRule1(e)+ob.applyMaskPenaltyRule2(e)+ob.applyMaskPenaltyRule3(e)+ob.applyMaskPenaltyRule4(e)},t.encode=function(e,r,n){n===void 0&&(n=null);var a=t.DEFAULT_BYTE_MODE_ENCODING,s=n!==null&&n.get(p_.CHARACTER_SET)!==void 0;s&&(a=n.get(p_.CHARACTER_SET).toString());var o=this.chooseMode(e,a),l=new Al;if(o===qs.BYTE&&(s||t.DEFAULT_BYTE_MODE_ENCODING!==a)){var c=Qo.getCharacterSetECIByName(a);c!==void 0&&this.appendECI(c,l)}this.appendModeInfo(o,l);var d=new Al;this.appendBytes(e,o,d,a);var u;if(n!==null&&n.get(p_.QR_VERSION)!==void 0){var f=Number.parseInt(n.get(p_.QR_VERSION).toString(),10);u=Xp.getVersionForNumber(f);var A=this.calculateBitsNeeded(o,l,d,u);if(!this.willFit(A,u,r))throw new Ks("Data too big for requested version")}else u=this.recommendVersion(r,o,l,d);var h=new Al;h.appendBitArray(l);var m=o===qs.BYTE?d.getSizeInBytes():e.length;this.appendLengthInfo(m,u,o,h),h.appendBitArray(d);var p=u.getECBlocksForLevel(r),x=u.getTotalCodewords()-p.getTotalECCodewords();this.terminateBits(x,h);var v=this.interleaveWithECBytes(h,u.getTotalCodewords(),x,p.getNumBlocks()),y=new _F;y.setECLevel(r),y.setMode(o),y.setVersion(u);var b=u.getDimensionForVersion(),w=new O9e(b,b),I=this.chooseMaskPattern(v,r,u,w);return y.setMaskPattern(I),uG.buildMatrix(v,r,u,I,w),y.setMatrix(w),y},t.recommendVersion=function(e,r,n,a){var s=this.calculateBitsNeeded(r,n,a,Xp.getVersionForNumber(1)),o=this.chooseVersion(s,e),l=this.calculateBitsNeeded(r,n,a,o);return this.chooseVersion(l,e)},t.calculateBitsNeeded=function(e,r,n,a){return r.getSize()+e.getCharacterCountBits(a)+n.getSize()},t.getAlphanumericCode=function(e){return e<t.ALPHANUMERIC_TABLE.length?t.ALPHANUMERIC_TABLE[e]:-1},t.chooseMode=function(e,r){if(r===void 0&&(r=null),Qo.SJIS.getName()===r&&this.isOnlyDoubleByteKanji(e))return qs.KANJI;for(var n=!1,a=!1,s=0,o=e.length;s<o;++s){var l=e.charAt(s);if(t.isDigit(l))n=!0;else if(this.getAlphanumericCode(l.charCodeAt(0))!==-1)a=!0;else return qs.BYTE}return a?qs.ALPHANUMERIC:n?qs.NUMERIC:qs.BYTE},t.isOnlyDoubleByteKanji=function(e){var r;try{r=Du.encode(e,Qo.SJIS)}catch{return!1}var n=r.length;if(n%2!==0)return!1;for(var a=0;a<n;a+=2){var s=r[a]&255;if((s<129||s>159)&&(s<224||s>235))return!1}return!0},t.chooseMaskPattern=function(e,r,n,a){for(var s=Number.MAX_SAFE_INTEGER,o=-1,l=0;l<_F.NUM_MASK_PATTERNS;l++){uG.buildMatrix(e,r,n,l,a);var c=this.calculateMaskPenalty(a);c<s&&(s=c,o=l)}return o},t.chooseVersion=function(e,r){for(var n=1;n<=40;n++){var a=Xp.getVersionForNumber(n);if(t.willFit(e,a,r))return a}throw new Ks("Data too big")},t.willFit=function(e,r,n){var a=r.getTotalCodewords(),s=r.getECBlocksForLevel(n),o=s.getTotalECCodewords(),l=a-o,c=(e+7)/8;return l>=c},t.terminateBits=function(e,r){var n=e*8;if(r.getSize()>n)throw new Ks("data bits cannot fit in the QR Code"+r.getSize()+" > "+n);for(var a=0;a<4&&r.getSize()<n;++a)r.appendBit(!1);var s=r.getSize()&7;if(s>0)for(var a=s;a<8;a++)r.appendBit(!1);for(var o=e-r.getSizeInBytes(),a=0;a<o;++a)r.appendBits(a&1?17:236,8);if(r.getSize()!==n)throw new Ks("Bits size does not equal capacity")},t.getNumDataBytesAndNumECBytesForBlockID=function(e,r,n,a,s,o){if(a>=n)throw new Ks("Block ID too large");var l=e%n,c=n-l,d=Math.floor(e/n),u=d+1,f=Math.floor(r/n),A=f+1,h=d-f,m=u-A;if(h!==m)throw new Ks("EC bytes mismatch");if(n!==c+l)throw new Ks("RS blocks mismatch");if(e!==(f+h)*c+(A+m)*l)throw new Ks("Total bytes mismatch");a<c?(s[0]=f,o[0]=h):(s[0]=A,o[0]=m)},t.interleaveWithECBytes=function(e,r,n,a){var s,o,l,c;if(e.getSizeInBytes()!==n)throw new Ks("Number of bits and data bytes does not match");for(var d=0,u=0,f=0,A=new Array,h=0;h<a;++h){var m=new Int32Array(1),p=new Int32Array(1);t.getNumDataBytesAndNumECBytesForBlockID(r,n,a,h,m,p);var x=m[0],v=new Uint8Array(x);e.toBytes(8*d,v,0,x);var y=t.generateECBytes(v,p[0]);A.push(new R9e(v,y)),u=Math.max(u,x),f=Math.max(f,y.length),d+=m[0]}if(n!==d)throw new Ks("Data bytes does not match offset");for(var b=new Al,h=0;h<u;++h)try{for(var w=(s=void 0,fG(A)),I=w.next();!I.done;I=w.next()){var j=I.value,v=j.getDataBytes();h<v.length&&b.appendBits(v[h],8)}}catch(B){s={error:B}}finally{try{I&&!I.done&&(o=w.return)&&o.call(w)}finally{if(s)throw s.error}}for(var h=0;h<f;++h)try{for(var N=(l=void 0,fG(A)),S=N.next();!S.done;S=N.next()){var j=S.value,y=j.getErrorCorrectionBytes();h<y.length&&b.appendBits(y[h],8)}}catch(B){l={error:B}}finally{try{S&&!S.done&&(c=N.return)&&c.call(N)}finally{if(l)throw l.error}}if(r!==b.getSizeInBytes())throw new Ks("Interleaving error: "+r+" and "+b.getSizeInBytes()+" differ.");return b},t.generateECBytes=function(e,r){for(var n=e.length,a=new Int32Array(n+r),s=0;s<n;s++)a[s]=e[s]&255;new qse(od.QR_CODE_FIELD_256).encode(a,r);for(var o=new Uint8Array(r),s=0;s<r;s++)o[s]=a[n+s];return o},t.appendModeInfo=function(e,r){r.appendBits(e.getBits(),4)},t.appendLengthInfo=function(e,r,n,a){var s=n.getCharacterCountBits(r);if(e>=1<<s)throw new Ks(e+" is bigger than "+((1<<s)-1));a.appendBits(e,s)},t.appendBytes=function(e,r,n,a){switch(r){case qs.NUMERIC:t.appendNumericBytes(e,n);break;case qs.ALPHANUMERIC:t.appendAlphanumericBytes(e,n);break;case qs.BYTE:t.append8BitBytes(e,n,a);break;case qs.KANJI:t.appendKanjiBytes(e,n);break;default:throw new Ks("Invalid mode: "+r)}},t.getDigit=function(e){return e.charCodeAt(0)-48},t.isDigit=function(e){var r=t.getDigit(e);return r>=0&&r<=9},t.appendNumericBytes=function(e,r){for(var n=e.length,a=0;a<n;){var s=t.getDigit(e.charAt(a));if(a+2<n){var o=t.getDigit(e.charAt(a+1)),l=t.getDigit(e.charAt(a+2));r.appendBits(s*100+o*10+l,10),a+=3}else if(a+1<n){var o=t.getDigit(e.charAt(a+1));r.appendBits(s*10+o,7),a+=2}else r.appendBits(s,4),a++}},t.appendAlphanumericBytes=function(e,r){for(var n=e.length,a=0;a<n;){var s=t.getAlphanumericCode(e.charCodeAt(a));if(s===-1)throw new Ks;if(a+1<n){var o=t.getAlphanumericCode(e.charCodeAt(a+1));if(o===-1)throw new Ks;r.appendBits(s*45+o,11),a+=2}else r.appendBits(s,6),a++}},t.append8BitBytes=function(e,r,n){var a;try{a=Du.encode(e,n)}catch(c){throw new Ks(c)}for(var s=0,o=a.length;s!==o;s++){var l=a[s];r.appendBits(l,8)}},t.appendKanjiBytes=function(e,r){var n;try{n=Du.encode(e,Qo.SJIS)}catch(f){throw new Ks(f)}for(var a=n.length,s=0;s<a;s+=2){var o=n[s]&255,l=n[s+1]&255,c=o<<8&4294967295|l,d=-1;if(c>=33088&&c<=40956?d=c-33088:c>=57408&&c<=60351&&(d=c-49472),d===-1)throw new Ks("Invalid byte sequence");var u=(d>>8)*192+(d&255);r.appendBits(u,13)}},t.appendECI=function(e,r){r.appendBits(qs.ECI.getBits(),4),r.appendBits(e.getValue(),8)},t.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),t.DEFAULT_BYTE_MODE_ENCODING=Qo.UTF8.getName(),t})();var M9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){M9e(e,t);function e(r,n,a,s,o,l,c,d){var u=t.call(this,l,c)||this;if(u.yuvData=r,u.dataWidth=n,u.dataHeight=a,u.left=s,u.top=o,s+l>n||o+c>a)throw new Vn("Crop rectangle does not fit within image data.");return d&&u.reverseHorizontal(l,c),u}return e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Vn("Requested row is outside the image: "+r);var a=this.getWidth();(n==null||n.length<a)&&(n=new Uint8ClampedArray(a));var s=(r+this.top)*this.dataWidth+this.left;return Ms.arraycopy(this.yuvData,s,n,0,a),n},e.prototype.getMatrix=function(){var r=this.getWidth(),n=this.getHeight();if(r===this.dataWidth&&n===this.dataHeight)return this.yuvData;var a=r*n,s=new Uint8ClampedArray(a),o=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return Ms.arraycopy(this.yuvData,o,s,0,a),s;for(var l=0;l<n;l++){var c=l*r;Ms.arraycopy(this.yuvData,o,s,c,r),o+=this.dataWidth}return s},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return new e(this.yuvData,this.dataWidth,this.dataHeight,this.left+r,this.top+n,a,s,!1)},e.prototype.renderThumbnail=function(){for(var r=this.getWidth()/e.THUMBNAIL_SCALE_FACTOR,n=this.getHeight()/e.THUMBNAIL_SCALE_FACTOR,a=new Int32Array(r*n),s=this.yuvData,o=this.top*this.dataWidth+this.left,l=0;l<n;l++){for(var c=l*r,d=0;d<r;d++){var u=s[o+d*e.THUMBNAIL_SCALE_FACTOR]&255;a[c+d]=4278190080|u*65793}o+=this.dataWidth*e.THUMBNAIL_SCALE_FACTOR}return a},e.prototype.getThumbnailWidth=function(){return this.getWidth()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.getThumbnailHeight=function(){return this.getHeight()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.reverseHorizontal=function(r,n){for(var a=this.yuvData,s=0,o=this.top*this.dataWidth+this.left;s<n;s++,o+=this.dataWidth)for(var l=o+r/2,c=o,d=o+r-1;c<l;c++,d--){var u=a[c];a[c]=a[d],a[d]=u}},e.prototype.invert=function(){return new _P(this)},e.THUMBNAIL_SCALE_FACTOR=2,e})(Xw);var L9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){L9e(e,t);function e(r,n,a,s,o,l,c){var d=t.call(this,n,a)||this;if(d.dataWidth=s,d.dataHeight=o,d.left=l,d.top=c,r.BYTES_PER_ELEMENT===4){for(var u=n*a,f=new Uint8ClampedArray(u),A=0;A<u;A++){var h=r[A],m=h>>16&255,p=h>>7&510,x=h&255;f[A]=(m+p+x)/4&255}d.luminances=f}else d.luminances=r;if(s===void 0&&(d.dataWidth=n),o===void 0&&(d.dataHeight=a),l===void 0&&(d.left=0),c===void 0&&(d.top=0),d.left+n>d.dataWidth||d.top+a>d.dataHeight)throw new Vn("Crop rectangle does not fit within image data.");return d}return e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Vn("Requested row is outside the image: "+r);var a=this.getWidth();(n==null||n.length<a)&&(n=new Uint8ClampedArray(a));var s=(r+this.top)*this.dataWidth+this.left;return Ms.arraycopy(this.luminances,s,n,0,a),n},e.prototype.getMatrix=function(){var r=this.getWidth(),n=this.getHeight();if(r===this.dataWidth&&n===this.dataHeight)return this.luminances;var a=r*n,s=new Uint8ClampedArray(a),o=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return Ms.arraycopy(this.luminances,o,s,0,a),s;for(var l=0;l<n;l++){var c=l*r;Ms.arraycopy(this.luminances,o,s,c,r),o+=this.dataWidth}return s},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return new e(this.luminances,a,s,this.dataWidth,this.dataHeight,this.left+r,this.top+n)},e.prototype.invert=function(){return new _P(this)},e})(Xw);var U9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Q9e=function(t){U9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.forName=function(r){return this.getCharacterSetECIByName(r)},e}(Qo),V9e=function(){function t(){}return t.ISO_8859_1=Qo.ISO8859_1,t}(),EF,H9e=301,$9e=function(t,e){for(var r=1,n=0;n<255;n++)e[n]=r,t[r]=n,r*=2,r>=256&&(r^=H9e);return{LOG:t,ALOG:e}};EF=$9e([],[]),EF.LOG;EF.ALOG;var hG;(function(t){t[t.FORCE_NONE=0]="FORCE_NONE",t[t.FORCE_SQUARE=1]="FORCE_SQUARE",t[t.FORCE_RECTANGLE=2]="FORCE_RECTANGLE"})(hG||(hG={}));var AG=129,zse=230,G9e=231,K9e=235,q9e=236,z9e=237,W9e=238,X9e=239,Y9e=240,aT=254,J9e=254,mG="[)>05",pG="[)>06",gG="",us=0,Tl=1,Tc=2,ko=3,ol=4,ic=5,Z9e=function(){function t(){}return t.prototype.getEncodingMode=function(){return us},t.prototype.encode=function(e){var r=Af.determineConsecutiveDigitCount(e.getMessage(),e.pos);if(r>=2)e.writeCodeword(this.encodeASCIIDigits(e.getMessage().charCodeAt(e.pos),e.getMessage().charCodeAt(e.pos+1))),e.pos+=2;else{var n=e.getCurrentChar(),a=Af.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(a!==this.getEncodingMode())switch(a){case ic:e.writeCodeword(G9e),e.signalEncoderChange(ic);return;case Tl:e.writeCodeword(zse),e.signalEncoderChange(Tl);return;case ko:e.writeCodeword(W9e),e.signalEncoderChange(ko);break;case Tc:e.writeCodeword(X9e),e.signalEncoderChange(Tc);break;case ol:e.writeCodeword(Y9e),e.signalEncoderChange(ol);break;default:throw new Error("Illegal mode: "+a)}else Af.isExtendedASCII(n)?(e.writeCodeword(K9e),e.writeCodeword(n-128+1),e.pos++):(e.writeCodeword(n+1),e.pos++)}},t.prototype.encodeASCIIDigits=function(e,r){if(Af.isDigit(e)&&Af.isDigit(r)){var n=(e-48)*10+(r-48);return n+130}throw new Error("not digits: "+e+r)},t}(),eQe=function(){function t(){}return t.prototype.getEncodingMode=function(){return ic},t.prototype.encode=function(e){var r=new ga;for(r.append(0);e.hasMoreCharacters();){var n=e.getCurrentChar();r.append(n),e.pos++;var a=Af.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(a!==this.getEncodingMode()){e.signalEncoderChange(us);break}}var s=r.length()-1,o=1,l=e.getCodewordCount()+s+o;e.updateSymbolInfo(l);var c=e.getSymbolInfo().getDataCapacity()-l>0;if(e.hasMoreCharacters()||c)if(s<=249)r.setCharAt(0,Oa.getCharAt(s));else if(s<=1555)r.setCharAt(0,Oa.getCharAt(Math.floor(s/250)+249)),r.insert(1,Oa.getCharAt(s%250));else throw new Error("Message length not in valid ranges: "+s);for(var d=0,n=r.length();d<n;d++)e.writeCodeword(this.randomize255State(r.charAt(d).charCodeAt(0),e.getCodewordCount()+1))},t.prototype.randomize255State=function(e,r){var n=149*r%255+1,a=e+n;return a<=255?a:a-256},t}(),JR=function(){function t(){}return t.prototype.getEncodingMode=function(){return Tl},t.prototype.encodeMaximal=function(e){for(var r=new ga,n=0,a=e.pos,s=0;e.hasMoreCharacters();){var o=e.getCurrentChar();e.pos++,n=this.encodeChar(o,r),r.length()%3===0&&(a=e.pos,s=r.length())}if(s!==r.length()){var l=Math.floor(r.length()/3*2),c=Math.floor(e.getCodewordCount()+l+1);e.updateSymbolInfo(c);var d=e.getSymbolInfo().getDataCapacity()-c,u=Math.floor(r.length()%3);(u===2&&d!==2||u===1&&(n>3||d!==1))&&(e.pos=a)}r.length()>0&&e.writeCodeword(zse),this.handleEOD(e,r)},t.prototype.encode=function(e){for(var r=new ga;e.hasMoreCharacters();){var n=e.getCurrentChar();e.pos++;var a=this.encodeChar(n,r),s=Math.floor(r.length()/3)*2,o=e.getCodewordCount()+s;e.updateSymbolInfo(o);var l=e.getSymbolInfo().getDataCapacity()-o;if(!e.hasMoreCharacters()){var c=new ga;for(r.length()%3===2&&l!==2&&(a=this.backtrackOneCharacter(e,r,c,a));r.length()%3===1&&(a>3||l!==1);)a=this.backtrackOneCharacter(e,r,c,a);break}var d=r.length();if(d%3===0){var u=Af.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(u!==this.getEncodingMode()){e.signalEncoderChange(us);break}}}this.handleEOD(e,r)},t.prototype.backtrackOneCharacter=function(e,r,n,a){var s=r.length(),o=r.toString().substring(0,s-a);r.setLengthToZero(),r.append(o),e.pos--;var l=e.getCurrentChar();return a=this.encodeChar(l,n),e.resetSymbolInfo(),a},t.prototype.writeNextTriplet=function(e,r){e.writeCodewords(this.encodeToCodewords(r.toString()));var n=r.toString().substring(3);r.setLengthToZero(),r.append(n)},t.prototype.handleEOD=function(e,r){var n=Math.floor(r.length()/3*2),a=r.length()%3,s=e.getCodewordCount()+n;e.updateSymbolInfo(s);var o=e.getSymbolInfo().getDataCapacity()-s;if(a===2){for(r.append("\0");r.length()>=3;)this.writeNextTriplet(e,r);e.hasMoreCharacters()&&e.writeCodeword(aT)}else if(o===1&&a===1){for(;r.length()>=3;)this.writeNextTriplet(e,r);e.hasMoreCharacters()&&e.writeCodeword(aT),e.pos--}else if(a===0){for(;r.length()>=3;)this.writeNextTriplet(e,r);(o>0||e.hasMoreCharacters())&&e.writeCodeword(aT)}else throw new Error("Unexpected case. Please report!");e.signalEncoderChange(us)},t.prototype.encodeChar=function(e,r){if(e===32)return r.append(3),1;if(e>=48&&e<=57)return r.append(e-48+4),1;if(e>=65&&e<=90)return r.append(e-65+14),1;if(e<32)return r.append(0),r.append(e),2;if(e<=47)return r.append(1),r.append(e-33),2;if(e<=64)return r.append(1),r.append(e-58+15),2;if(e<=95)return r.append(1),r.append(e-91+22),2;if(e<=127)return r.append(2),r.append(e-96),2;r.append("1");var n=2;return n+=this.encodeChar(e-128,r),n},t.prototype.encodeToCodewords=function(e){var r=1600*e.charCodeAt(0)+40*e.charCodeAt(1)+e.charCodeAt(2)+1,n=r/256,a=r%256,s=new ga;return s.append(n),s.append(a),s.toString()},t}(),tQe=function(){function t(){}return t.prototype.getEncodingMode=function(){return ol},t.prototype.encode=function(e){for(var r=new ga;e.hasMoreCharacters();){var n=e.getCurrentChar();this.encodeChar(n,r),e.pos++;var a=r.length();if(a>=4){e.writeCodewords(this.encodeToCodewords(r.toString()));var s=r.toString().substring(4);r.setLengthToZero(),r.append(s);var o=Af.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(o!==this.getEncodingMode()){e.signalEncoderChange(us);break}}}r.append(Oa.getCharAt(31)),this.handleEOD(e,r)},t.prototype.handleEOD=function(e,r){try{var n=r.length();if(n===0)return;if(n===1){e.updateSymbolInfo();var a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount(),s=e.getRemainingCharacters();if(s>a&&(e.updateSymbolInfo(e.getCodewordCount()+1),a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount()),s<=a&&a<=2)return}if(n>4)throw new Error("Count must not exceed 4");var o=n-1,l=this.encodeToCodewords(r.toString()),c=!e.hasMoreCharacters(),d=c&&o<=2;if(o<=2){e.updateSymbolInfo(e.getCodewordCount()+o);var a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount();a>=3&&(d=!1,e.updateSymbolInfo(e.getCodewordCount()+l.length))}d?(e.resetSymbolInfo(),e.pos-=o):e.writeCodewords(l)}finally{e.signalEncoderChange(us)}},t.prototype.encodeChar=function(e,r){e>=32&&e<=63?r.append(e):e>=64&&e<=94?r.append(Oa.getCharAt(e-64)):Af.illegalCharacter(Oa.getCharAt(e))},t.prototype.encodeToCodewords=function(e){var r=e.length;if(r===0)throw new Error("StringBuilder must not be empty");var n=e.charAt(0).charCodeAt(0),a=r>=2?e.charAt(1).charCodeAt(0):0,s=r>=3?e.charAt(2).charCodeAt(0):0,o=r>=4?e.charAt(3).charCodeAt(0):0,l=(n<<18)+(a<<12)+(s<<6)+o,c=l>>16&255,d=l>>8&255,u=l&255,f=new ga;return f.append(c),r>=2&&f.append(d),r>=3&&f.append(u),f.toString()},t}(),rQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),nQe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Za=function(){function t(e,r,n,a,s,o,l,c){l===void 0&&(l=0),c===void 0&&(c=0),this.rectangular=e,this.dataCapacity=r,this.errorCodewords=n,this.matrixWidth=a,this.matrixHeight=s,this.dataRegions=o,this.rsBlockData=l,this.rsBlockError=c}return t.lookup=function(e,r,n,a,s){var o,l;r===void 0&&(r=0),n===void 0&&(n=null),a===void 0&&(a=null),s===void 0&&(s=!0);try{for(var c=nQe(sQe),d=c.next();!d.done;d=c.next()){var u=d.value;if(!(r===1&&u.rectangular)&&!(r===2&&!u.rectangular)&&!(n!=null&&(u.getSymbolWidth()<n.getWidth()||u.getSymbolHeight()<n.getHeight()))&&!(a!=null&&(u.getSymbolWidth()>a.getWidth()||u.getSymbolHeight()>a.getHeight()))&&e<=u.dataCapacity)return u}}catch(f){o={error:f}}finally{try{d&&!d.done&&(l=c.return)&&l.call(c)}finally{if(o)throw o.error}}if(s)throw new Error("Can't find a symbol arrangement that matches the message. Data codewords: "+e);return null},t.prototype.getHorizontalDataRegions=function(){switch(this.dataRegions){case 1:return 1;case 2:case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},t.prototype.getVerticalDataRegions=function(){switch(this.dataRegions){case 1:case 2:return 1;case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},t.prototype.getSymbolDataWidth=function(){return this.getHorizontalDataRegions()*this.matrixWidth},t.prototype.getSymbolDataHeight=function(){return this.getVerticalDataRegions()*this.matrixHeight},t.prototype.getSymbolWidth=function(){return this.getSymbolDataWidth()+this.getHorizontalDataRegions()*2},t.prototype.getSymbolHeight=function(){return this.getSymbolDataHeight()+this.getVerticalDataRegions()*2},t.prototype.getCodewordCount=function(){return this.dataCapacity+this.errorCodewords},t.prototype.getInterleavedBlockCount=function(){return this.rsBlockData?this.dataCapacity/this.rsBlockData:1},t.prototype.getDataCapacity=function(){return this.dataCapacity},t.prototype.getErrorCodewords=function(){return this.errorCodewords},t.prototype.getDataLengthForInterleavedBlock=function(e){return this.rsBlockData},t.prototype.getErrorLengthForInterleavedBlock=function(e){return this.rsBlockError},t}(),aQe=function(t){rQe(e,t);function e(){return t.call(this,!1,1558,620,22,22,36,-1,62)||this}return e.prototype.getInterleavedBlockCount=function(){return 10},e.prototype.getDataLengthForInterleavedBlock=function(r){return r<=8?156:155},e}(Za),sQe=[new Za(!1,3,5,8,8,1),new Za(!1,5,7,10,10,1),new Za(!0,5,7,16,6,1),new Za(!1,8,10,12,12,1),new Za(!0,10,11,14,6,2),new Za(!1,12,12,14,14,1),new Za(!0,16,14,24,10,1),new Za(!1,18,14,16,16,1),new Za(!1,22,18,18,18,1),new Za(!0,22,18,16,10,2),new Za(!1,30,20,20,20,1),new Za(!0,32,24,16,14,2),new Za(!1,36,24,22,22,1),new Za(!1,44,28,24,24,1),new Za(!0,49,28,22,14,2),new Za(!1,62,36,14,14,4),new Za(!1,86,42,16,16,4),new Za(!1,114,48,18,18,4),new Za(!1,144,56,20,20,4),new Za(!1,174,68,22,22,4),new Za(!1,204,84,24,24,4,102,42),new Za(!1,280,112,14,14,16,140,56),new Za(!1,368,144,16,16,16,92,36),new Za(!1,456,192,18,18,16,114,48),new Za(!1,576,224,20,20,16,144,56),new Za(!1,696,272,22,22,16,174,68),new Za(!1,816,336,24,24,16,136,56),new Za(!1,1050,408,18,18,36,175,68),new Za(!1,1304,496,20,20,36,163,62),new aQe],iQe=function(){function t(e){this.msg=e,this.pos=0,this.skipAtEnd=0;for(var r=e.split("").map(function(l){return l.charCodeAt(0)}),n=new ga,a=0,s=r.length;a<s;a++){var o=String.fromCharCode(r[a]&255);if(o==="?"&&e.charAt(a)!=="?")throw new Error("Message contains characters outside ISO-8859-1 encoding.");n.append(o)}this.msg=n.toString(),this.shape=0,this.codewords=new ga,this.newEncoding=-1}return t.prototype.setSymbolShape=function(e){this.shape=e},t.prototype.setSizeConstraints=function(e,r){this.minSize=e,this.maxSize=r},t.prototype.getMessage=function(){return this.msg},t.prototype.setSkipAtEnd=function(e){this.skipAtEnd=e},t.prototype.getCurrentChar=function(){return this.msg.charCodeAt(this.pos)},t.prototype.getCurrent=function(){return this.msg.charCodeAt(this.pos)},t.prototype.getCodewords=function(){return this.codewords},t.prototype.writeCodewords=function(e){this.codewords.append(e)},t.prototype.writeCodeword=function(e){this.codewords.append(e)},t.prototype.getCodewordCount=function(){return this.codewords.length()},t.prototype.getNewEncoding=function(){return this.newEncoding},t.prototype.signalEncoderChange=function(e){this.newEncoding=e},t.prototype.resetEncoderSignal=function(){this.newEncoding=-1},t.prototype.hasMoreCharacters=function(){return this.pos<this.getTotalMessageCharCount()},t.prototype.getTotalMessageCharCount=function(){return this.msg.length-this.skipAtEnd},t.prototype.getRemainingCharacters=function(){return this.getTotalMessageCharCount()-this.pos},t.prototype.getSymbolInfo=function(){return this.symbolInfo},t.prototype.updateSymbolInfo=function(e){e===void 0&&(e=this.getCodewordCount()),(this.symbolInfo==null||e>this.symbolInfo.getDataCapacity())&&(this.symbolInfo=Za.lookup(e,this.shape,this.minSize,this.maxSize,!0))},t.prototype.resetSymbolInfo=function(){this.symbolInfo=null},t}(),oQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),lQe=function(t){oQe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return ko},e.prototype.encode=function(r){for(var n=new ga;r.hasMoreCharacters();){var a=r.getCurrentChar();r.pos++,this.encodeChar(a,n);var s=n.length();if(s%3===0){this.writeNextTriplet(r,n);var o=Af.lookAheadTest(r.getMessage(),r.pos,this.getEncodingMode());if(o!==this.getEncodingMode()){r.signalEncoderChange(us);break}}}this.handleEOD(r,n)},e.prototype.encodeChar=function(r,n){switch(r){case 13:n.append(0);break;case 42:n.append(1);break;case 62:n.append(2);break;case 32:n.append(3);break;default:r>=48&&r<=57?n.append(r-48+4):r>=65&&r<=90?n.append(r-65+14):Af.illegalCharacter(Oa.getCharAt(r));break}return 1},e.prototype.handleEOD=function(r,n){r.updateSymbolInfo();var a=r.getSymbolInfo().getDataCapacity()-r.getCodewordCount(),s=n.length();r.pos-=s,(r.getRemainingCharacters()>1||a>1||r.getRemainingCharacters()!==a)&&r.writeCodeword(J9e),r.getNewEncoding()<0&&r.signalEncoderChange(us)},e}(JR),cQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),dQe=function(t){cQe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return Tc},e.prototype.encodeChar=function(r,n){if(r===32)return n.append(3),1;if(r>=48&&r<=57)return n.append(r-48+4),1;if(r>=97&&r<=122)return n.append(r-97+14),1;if(r<32)return n.append(0),n.append(r),2;if(r<=47)return n.append(1),n.append(r-33),2;if(r<=64)return n.append(1),n.append(r-58+15),2;if(r>=91&&r<=95)return n.append(1),n.append(r-91+22),2;if(r===96)return n.append(2),n.append(0),2;if(r<=90)return n.append(2),n.append(r-65+1),2;if(r<=127)return n.append(2),n.append(r-123+27),2;n.append("1");var a=2;return a+=this.encodeChar(r-128,n),a},e}(JR),Af=function(){function t(){}return t.randomize253State=function(e){var r=149*e%253+1,n=AG+r;return n<=254?n:n-254},t.encodeHighLevel=function(e,r,n,a,s){r===void 0&&(r=0),n===void 0&&(n=null),a===void 0&&(a=null),s===void 0&&(s=!1);var o=new JR,l=[new Z9e,o,new dQe,new lQe,new tQe,new eQe],c=new iQe(e);c.setSymbolShape(r),c.setSizeConstraints(n,a),e.startsWith(mG)&&e.endsWith(gG)?(c.writeCodeword(q9e),c.setSkipAtEnd(2),c.pos+=mG.length):e.startsWith(pG)&&e.endsWith(gG)&&(c.writeCodeword(z9e),c.setSkipAtEnd(2),c.pos+=pG.length);var d=us;for(s&&(o.encodeMaximal(c),d=c.getNewEncoding(),c.resetEncoderSignal());c.hasMoreCharacters();)l[d].encode(c),c.getNewEncoding()>=0&&(d=c.getNewEncoding(),c.resetEncoderSignal());var u=c.getCodewordCount();c.updateSymbolInfo();var f=c.getSymbolInfo().getDataCapacity();u<f&&d!==us&&d!==ic&&d!==ol&&c.writeCodeword("");var A=c.getCodewords();for(A.length()<f&&A.append(AG);A.length()<f;)A.append(this.randomize253State(A.length()+1));return c.getCodewords().toString()},t.lookAheadTest=function(e,r,n){var a=this.lookAheadTestIntern(e,r,n);if(n===ko&&a===ko){for(var s=Math.min(r+3,e.length),o=r;o<s;o++)if(!this.isNativeX12(e.charCodeAt(o)))return us}else if(n===ol&&a===ol){for(var s=Math.min(r+4,e.length),o=r;o<s;o++)if(!this.isNativeEDIFACT(e.charCodeAt(o)))return us}return a},t.lookAheadTestIntern=function(e,r,n){if(r>=e.length)return n;var a;n===us?a=[0,1,1,1,1,1.25]:(a=[1,2,2,2,2,2.25],a[n]=0);for(var s=0,o=new Uint8Array(6),l=[];;){if(r+s===e.length){Ho.fill(o,0),Ho.fill(l,0);var c=this.findMinimums(a,l,ba.MAX_VALUE,o),d=this.getMinimumCount(o);if(l[us]===c)return us;if(d===1){if(o[ic]>0)return ic;if(o[ol]>0)return ol;if(o[Tc]>0)return Tc;if(o[ko]>0)return ko}return Tl}var u=e.charCodeAt(r+s);if(s++,this.isDigit(u)?a[us]+=.5:this.isExtendedASCII(u)?(a[us]=Math.ceil(a[us]),a[us]+=2):(a[us]=Math.ceil(a[us]),a[us]++),this.isNativeC40(u)?a[Tl]+=2/3:this.isExtendedASCII(u)?a[Tl]+=8/3:a[Tl]+=4/3,this.isNativeText(u)?a[Tc]+=2/3:this.isExtendedASCII(u)?a[Tc]+=8/3:a[Tc]+=4/3,this.isNativeX12(u)?a[ko]+=2/3:this.isExtendedASCII(u)?a[ko]+=13/3:a[ko]+=10/3,this.isNativeEDIFACT(u)?a[ol]+=3/4:this.isExtendedASCII(u)?a[ol]+=17/4:a[ol]+=13/4,this.isSpecialB256(u)?a[ic]+=4:a[ic]++,s>=4){if(Ho.fill(o,0),Ho.fill(l,0),this.findMinimums(a,l,ba.MAX_VALUE,o),l[us]<this.min(l[ic],l[Tl],l[Tc],l[ko],l[ol]))return us;if(l[ic]<l[us]||l[ic]+1<this.min(l[Tl],l[Tc],l[ko],l[ol]))return ic;if(l[ol]+1<this.min(l[ic],l[Tl],l[Tc],l[ko],l[us]))return ol;if(l[Tc]+1<this.min(l[ic],l[Tl],l[ol],l[ko],l[us]))return Tc;if(l[ko]+1<this.min(l[ic],l[Tl],l[ol],l[Tc],l[us]))return ko;if(l[Tl]+1<this.min(l[us],l[ic],l[ol],l[Tc])){if(l[Tl]<l[ko])return Tl;if(l[Tl]===l[ko]){for(var f=r+s+1;f<e.length;){var A=e.charCodeAt(f);if(this.isX12TermSep(A))return ko;if(!this.isNativeX12(A))break;f++}return Tl}}}}},t.min=function(e,r,n,a,s){var o=Math.min(e,Math.min(r,Math.min(n,a)));return s===void 0?o:Math.min(o,s)},t.findMinimums=function(e,r,n,a){for(var s=0;s<6;s++){var o=r[s]=Math.ceil(e[s]);n>o&&(n=o,Ho.fill(a,0)),n===o&&(a[s]=a[s]+1)}return n},t.getMinimumCount=function(e){for(var r=0,n=0;n<6;n++)r+=e[n];return r||0},t.isDigit=function(e){return e>=48&&e<=57},t.isExtendedASCII=function(e){return e>=128&&e<=255},t.isNativeC40=function(e){return e===32||e>=48&&e<=57||e>=65&&e<=90},t.isNativeText=function(e){return e===32||e>=48&&e<=57||e>=97&&e<=122},t.isNativeX12=function(e){return this.isX12TermSep(e)||e===32||e>=48&&e<=57||e>=65&&e<=90},t.isX12TermSep=function(e){return e===13||e===42||e===62},t.isNativeEDIFACT=function(e){return e>=32&&e<=94},t.isSpecialB256=function(e){return!1},t.determineConsecutiveDigitCount=function(e,r){r===void 0&&(r=0);for(var n=e.length,a=r;a<n&&this.isDigit(e.charCodeAt(a));)a++;return a-r},t.illegalCharacter=function(e){var r=ba.toHexString(e.charCodeAt(0));throw r="0000".substring(0,4-r.length)+r,new Error("Illegal character: "+e+" (0x"+r+")")},t}(),sT=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},xG=function(){function t(e){this.charset=e,this.name=e.name}return t.prototype.canEncode=function(e){try{return Du.encode(e,this.charset)!=null}catch{return!1}},t}(),uQe=function(){function t(e,r,n){var a,s,o,l,c,d;this.ENCODERS=["IBM437","ISO-8859-2","ISO-8859-3","ISO-8859-4","ISO-8859-5","ISO-8859-6","ISO-8859-7","ISO-8859-8","ISO-8859-9","ISO-8859-10","ISO-8859-11","ISO-8859-13","ISO-8859-14","ISO-8859-15","ISO-8859-16","windows-1250","windows-1251","windows-1252","windows-1256","Shift_JIS"].map(function(E){return new xG(Q9e.forName(E))}),this.encoders=[];var u=[];u.push(new xG(V9e.ISO_8859_1));for(var f=r!=null&&r.name.startsWith("UTF"),A=0;A<e.length;A++){var h=!1;try{for(var m=(a=void 0,sT(u)),p=m.next();!p.done;p=m.next()){var x=p.value,v=e.charAt(A),y=v.charCodeAt(0);if(y===n||x.canEncode(v)){h=!0;break}}}catch(E){a={error:E}}finally{try{p&&!p.done&&(s=m.return)&&s.call(m)}finally{if(a)throw a.error}}if(!h)try{for(var b=(o=void 0,sT(this.ENCODERS)),w=b.next();!w.done;w=b.next()){var x=w.value;if(x.canEncode(e.charAt(A))){u.push(x),h=!0;break}}}catch(E){o={error:E}}finally{try{w&&!w.done&&(l=b.return)&&l.call(b)}finally{if(o)throw o.error}}h||(f=!0)}if(u.length===1&&!f)this.encoders=[u[0]];else{this.encoders=[];var I=0;try{for(var j=sT(u),N=j.next();!N.done;N=j.next()){var x=N.value;this.encoders[I++]=x}}catch(E){c={error:E}}finally{try{N&&!N.done&&(d=j.return)&&d.call(j)}finally{if(c)throw c.error}}}var S=-1;if(r!=null){for(var A=0;A<this.encoders.length;A++)if(this.encoders[A]!=null&&r.name===this.encoders[A].name){S=A;break}}this.priorityEncoderIndex=S}return t.prototype.length=function(){return this.encoders.length},t.prototype.getCharsetName=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].name},t.prototype.getCharset=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].charset},t.prototype.getECIValue=function(e){return this.encoders[e].charset.getValueIdentifier()},t.prototype.getPriorityEncoderIndex=function(){return this.priorityEncoderIndex},t.prototype.canEncode=function(e,r){if(!(r<this.length()))throw new Error("index must be less than length");return!0},t.prototype.encode=function(e,r){if(!(r<this.length()))throw new Error("index must be less than length");return Du.encode(Oa.getCharAt(e),this.encoders[r].name)},t}(),fQe=3,hQe=function(){function t(e,r,n){this.fnc1=n;var a=new uQe(e,r,n);if(a.length()===1)for(var s=0;s<this.bytes.length;s++){var o=e.charAt(s).charCodeAt(0);this.bytes[s]=o===n?1e3:o}else this.bytes=this.encodeMinimally(e,a,n)}return t.prototype.getFNC1Character=function(){return this.fnc1},t.prototype.length=function(){return this.bytes.length},t.prototype.haveNCharacters=function(e,r){if(e+r-1>=this.bytes.length)return!1;for(var n=0;n<r;n++)if(this.isECI(e+n))return!1;return!0},t.prototype.charAt=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(this.isECI(e))throw new Error("value at "+e+" is not a character but an ECI");return this.isFNC1(e)?this.fnc1:this.bytes[e]},t.prototype.subSequence=function(e,r){if(e<0||e>r||r>this.length())throw new Error(""+e);for(var n=new ga,a=e;a<r;a++){if(this.isECI(a))throw new Error("value at "+a+" is not a character but an ECI");n.append(this.charAt(a))}return n.toString()},t.prototype.isECI=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]>255&&this.bytes[e]<=999},t.prototype.isFNC1=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]===1e3},t.prototype.getECIValue=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(!this.isECI(e))throw new Error("value at "+e+" is not an ECI but a character");return this.bytes[e]-256},t.prototype.addEdge=function(e,r,n){(e[r][n.encoderIndex]==null||e[r][n.encoderIndex].cachedTotalSize>n.cachedTotalSize)&&(e[r][n.encoderIndex]=n)},t.prototype.addEdges=function(e,r,n,a,s,o){var l=e.charAt(a).charCodeAt(0),c=0,d=r.length();r.getPriorityEncoderIndex()>=0&&(l===o||r.canEncode(l,r.getPriorityEncoderIndex()))&&(c=r.getPriorityEncoderIndex(),d=c+1);for(var u=c;u<d;u++)(l===o||r.canEncode(l,u))&&this.addEdge(n,a+1,new vG(l,r,u,s,o))},t.prototype.encodeMinimally=function(e,r,n){var a=e.length,s=new vG[a+1][r.length()];this.addEdges(e,r,s,0,null,n);for(var o=1;o<=a;o++){for(var l=0;l<r.length();l++)s[o][l]!=null&&o<a&&this.addEdges(e,r,s,o,s[o][l],n);for(var l=0;l<r.length();l++)s[o-1][l]=null}for(var c=-1,d=ba.MAX_VALUE,l=0;l<r.length();l++)if(s[a][l]!=null){var u=s[a][l];u.cachedTotalSize<d&&(d=u.cachedTotalSize,c=l)}if(c<0)throw new Error('Failed to encode "'+e+'"');for(var f=[],A=s[a][c];A!=null;){if(A.isFNC1())f.unshift(1e3);else for(var h=r.encode(A.c,A.encoderIndex),o=h.length-1;o>=0;o--)f.unshift(h[o]&255);var m=A.previous===null?0:A.previous.encoderIndex;m!==A.encoderIndex&&f.unshift(256+r.getECIValue(A.encoderIndex)),A=A.previous}for(var p=[],o=0;o<p.length;o++)p[o]=f[o];return p},t}(),vG=function(){function t(e,r,n,a,s){this.c=e,this.encoderSet=r,this.encoderIndex=n,this.previous=a,this.fnc1=s,this.c=e===s?1e3:e;var o=this.isFNC1()?1:r.encode(e,n).length,l=a===null?0:a.encoderIndex;l!==n&&(o+=fQe),a!=null&&(o+=a.cachedTotalSize),this.cachedTotalSize=o}return t.prototype.isFNC1=function(){return this.c===1e3},t}(),AQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var yG;(function(t){t[t.ASCII=0]="ASCII",t[t.C40=1]="C40",t[t.TEXT=2]="TEXT",t[t.X12=3]="X12",t[t.EDF=4]="EDF",t[t.B256=5]="B256"})(yG||(yG={}));(function(t){AQe(e,t);function e(r,n,a,s,o){var l=t.call(this,r,n,a)||this;return l.shape=s,l.macroId=o,l}return e.prototype.getMacroId=function(){return this.macroId},e.prototype.getShapeHint=function(){return this.shape},e})(hQe);var mQe=function(){function t(){}return t.prototype.isCompact=function(){return this.compact},t.prototype.setCompact=function(e){this.compact=e},t.prototype.getSize=function(){return this.size},t.prototype.setSize=function(e){this.size=e},t.prototype.getLayers=function(){return this.layers},t.prototype.setLayers=function(e){this.layers=e},t.prototype.getCodeWords=function(){return this.codeWords},t.prototype.setCodeWords=function(e){this.codeWords=e},t.prototype.getMatrix=function(){return this.matrix},t.prototype.setMatrix=function(e){this.matrix=e},t}(),bG=function(){function t(){}return t.singletonList=function(e){return[e]},t.min=function(e,r){return e.sort(r)[0]},t}(),pQe=function(){function t(e){this.previous=e}return t.prototype.getPrevious=function(){return this.previous},t}(),gQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ZR=function(t){gQe(e,t);function e(r,n,a){var s=t.call(this,r)||this;return s.value=n,s.bitCount=a,s}return e.prototype.appendTo=function(r,n){r.appendBits(this.value,this.bitCount)},e.prototype.add=function(r,n){return new e(this,r,n)},e.prototype.addBinaryShift=function(r,n){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new e(this,r,n)},e.prototype.toString=function(){var r=this.value&(1<<this.bitCount)-1;return r|=1<<this.bitCount,"<"+ba.toBinaryString(r|1<<this.bitCount).substring(1)+">"},e}(pQe),xQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),vQe=function(t){xQe(e,t);function e(r,n,a){var s=t.call(this,r,0,0)||this;return s.binaryShiftStart=n,s.binaryShiftByteCount=a,s}return e.prototype.appendTo=function(r,n){for(var a=0;a<this.binaryShiftByteCount;a++)(a===0||a===31&&this.binaryShiftByteCount<=62)&&(r.appendBits(31,5),this.binaryShiftByteCount>62?r.appendBits(this.binaryShiftByteCount-31,16):a===0?r.appendBits(Math.min(this.binaryShiftByteCount,31),5):r.appendBits(this.binaryShiftByteCount-31,5)),r.appendBits(n[this.binaryShiftStart+a],8)},e.prototype.addBinaryShift=function(r,n){return new e(this,r,n)},e.prototype.toString=function(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"},e}(ZR);function yQe(t,e,r){return new vQe(t,e,r)}function Iy(t,e,r){return new ZR(t,e,r)}var bQe=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],xm=0,fj=1,Pu=2,Wse=3,ah=4,wQe=new ZR(null,0,0),iT=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])],NQe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function CQe(t){var e,r;try{for(var n=NQe(t),a=n.next();!a.done;a=n.next()){var s=a.value;Ho.fill(s,-1)}}catch(o){e={error:o}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return t[xm][ah]=0,t[fj][ah]=0,t[fj][xm]=28,t[Wse][ah]=0,t[Pu][ah]=0,t[Pu][xm]=15,t}var Xse=CQe(Ho.createInt32Array(6,6)),_Qe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},EQe=function(){function t(e,r,n,a){this.token=e,this.mode=r,this.binaryShiftByteCount=n,this.bitCount=a}return t.prototype.getMode=function(){return this.mode},t.prototype.getToken=function(){return this.token},t.prototype.getBinaryShiftByteCount=function(){return this.binaryShiftByteCount},t.prototype.getBitCount=function(){return this.bitCount},t.prototype.latchAndAppend=function(e,r){var n=this.bitCount,a=this.token;if(e!==this.mode){var s=iT[this.mode][e];a=Iy(a,s&65535,s>>16),n+=s>>16}var o=e===Pu?4:5;return a=Iy(a,r,o),new t(a,e,0,n+o)},t.prototype.shiftAndAppend=function(e,r){var n=this.token,a=this.mode===Pu?4:5;return n=Iy(n,Xse[this.mode][e],a),n=Iy(n,r,5),new t(n,this.mode,0,this.bitCount+a+5)},t.prototype.addBinaryShiftChar=function(e){var r=this.token,n=this.mode,a=this.bitCount;if(this.mode===ah||this.mode===Pu){var s=iT[n][xm];r=Iy(r,s&65535,s>>16),a+=s>>16,n=xm}var o=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,l=new t(r,n,this.binaryShiftByteCount+1,a+o);return l.binaryShiftByteCount===2078&&(l=l.endBinaryShift(e+1)),l},t.prototype.endBinaryShift=function(e){if(this.binaryShiftByteCount===0)return this;var r=this.token;return r=yQe(r,e-this.binaryShiftByteCount,this.binaryShiftByteCount),new t(r,this.mode,0,this.bitCount)},t.prototype.isBetterThanOrEqualTo=function(e){var r=this.bitCount+(iT[this.mode][e.mode]>>16);return this.binaryShiftByteCount<e.binaryShiftByteCount?r+=t.calculateBinaryShiftCost(e)-t.calculateBinaryShiftCost(this):this.binaryShiftByteCount>e.binaryShiftByteCount&&e.binaryShiftByteCount>0&&(r+=10),r<=e.bitCount},t.prototype.toBitArray=function(e){for(var r,n,a=[],s=this.endBinaryShift(e.length).token;s!==null;s=s.getPrevious())a.unshift(s);var o=new Al;try{for(var l=_Qe(a),c=l.next();!c.done;c=l.next()){var d=c.value;d.appendTo(o,e)}}catch(u){r={error:u}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return o},t.prototype.toString=function(){return Oa.format("%s bits=%d bytes=%d",bQe[this.mode],this.bitCount,this.binaryShiftByteCount)},t.calculateBinaryShiftCost=function(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0},t.INITIAL_STATE=new t(wQe,xm,0,0),t}();function SQe(t){var e=Oa.getCharCode(" "),r=Oa.getCharCode("."),n=Oa.getCharCode(",");t[xm][e]=1;for(var a=Oa.getCharCode("Z"),s=Oa.getCharCode("A"),o=s;o<=a;o++)t[xm][o]=o-s+2;t[fj][e]=1;for(var l=Oa.getCharCode("z"),c=Oa.getCharCode("a"),o=c;o<=l;o++)t[fj][o]=o-c+2;t[Pu][e]=1;for(var d=Oa.getCharCode("9"),u=Oa.getCharCode("0"),o=u;o<=d;o++)t[Pu][o]=o-u+2;t[Pu][n]=12,t[Pu][r]=13;for(var f=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""],A=0;A<f.length;A++)t[Wse][Oa.getCharCode(f[A])]=A;for(var h=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"],A=0;A<h.length;A++)Oa.getCharCode(h[A])>0&&(t[ah][Oa.getCharCode(h[A])]=A);return t}var oT=SQe(Ho.createInt32Array(5,256)),g_=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},jQe=function(){function t(e){this.text=e}return t.prototype.encode=function(){for(var e=Oa.getCharCode(" "),r=Oa.getCharCode(`
`),n=bG.singletonList(EQe.INITIAL_STATE),a=0;a<this.text.length;a++){var s=void 0,o=a+1<this.text.length?this.text[a+1]:0;switch(this.text[a]){case Oa.getCharCode("\r"):s=o===r?2:0;break;case Oa.getCharCode("."):s=o===e?3:0;break;case Oa.getCharCode(","):s=o===e?4:0;break;case Oa.getCharCode(":"):s=o===e?5:0;break;default:s=0}s>0?(n=t.updateStateListForPair(n,a,s),a++):n=this.updateStateListForChar(n,a)}var l=bG.min(n,function(c,d){return c.getBitCount()-d.getBitCount()});return l.toBitArray(this.text)},t.prototype.updateStateListForChar=function(e,r){var n,a,s=[];try{for(var o=g_(e),l=o.next();!l.done;l=o.next()){var c=l.value;this.updateStateForChar(c,r,s)}}catch(d){n={error:d}}finally{try{l&&!l.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}return t.simplifyStates(s)},t.prototype.updateStateForChar=function(e,r,n){for(var a=this.text[r]&255,s=oT[e.getMode()][a]>0,o=null,l=0;l<=ah;l++){var c=oT[l][a];if(c>0){if(o==null&&(o=e.endBinaryShift(r)),!s||l===e.getMode()||l===Pu){var d=o.latchAndAppend(l,c);n.push(d)}if(!s&&Xse[e.getMode()][l]>=0){var u=o.shiftAndAppend(l,c);n.push(u)}}}if(e.getBinaryShiftByteCount()>0||oT[e.getMode()][a]===0){var f=e.addBinaryShiftChar(r);n.push(f)}},t.updateStateListForPair=function(e,r,n){var a,s,o=[];try{for(var l=g_(e),c=l.next();!c.done;c=l.next()){var d=c.value;this.updateStateForPair(d,r,n,o)}}catch(u){a={error:u}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}return this.simplifyStates(o)},t.updateStateForPair=function(e,r,n,a){var s=e.endBinaryShift(r);if(a.push(s.latchAndAppend(ah,n)),e.getMode()!==ah&&a.push(s.shiftAndAppend(ah,n)),n===3||n===4){var o=s.latchAndAppend(Pu,16-n).latchAndAppend(Pu,1);a.push(o)}if(e.getBinaryShiftByteCount()>0){var l=e.addBinaryShiftChar(r).addBinaryShiftChar(r+1);a.push(l)}},t.simplifyStates=function(e){var r,n,a,s,o=[];try{for(var l=g_(e),c=l.next();!c.done;c=l.next()){var d=c.value,u=!0,f=function(x){if(x.isBetterThanOrEqualTo(d))return u=!1,"break";d.isBetterThanOrEqualTo(x)&&(o=o.filter(function(v){return v!==x}))};try{for(var A=(a=void 0,g_(o)),h=A.next();!h.done;h=A.next()){var m=h.value,p=f(m);if(p==="break")break}}catch(x){a={error:x}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}u&&o.push(d)}}catch(x){r={error:x}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return o},t}(),IQe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function t(){}return t.encodeBytes=function(e){return t.encode(e,t.DEFAULT_EC_PERCENT,t.DEFAULT_AZTEC_LAYERS)},t.encode=function(e,r,n){var a=new jQe(e).encode(),s=ba.truncDivision(a.getSize()*r,100)+11,o=a.getSize()+s,l,c,d,u,f;if(n!==t.DEFAULT_AZTEC_LAYERS){if(l=n<0,c=Math.abs(n),c>(l?t.MAX_NB_BITS_COMPACT:t.MAX_NB_BITS))throw new Vn(Oa.format("Illegal value %s for layers",n));d=t.totalBitsInLayer(c,l),u=t.WORD_SIZE[c];var A=d-d%u;if(f=t.stuffBits(a,u),f.getSize()+s>A)throw new Vn("Data to large for user specified layer");if(l&&f.getSize()>u*64)throw new Vn("Data to large for user specified layer")}else{u=0,f=null;for(var h=0;;h++){if(h>t.MAX_NB_BITS)throw new Vn("Data too large for an Aztec code");if(l=h<=3,c=l?h+1:h,d=t.totalBitsInLayer(c,l),!(o>d)){(f==null||u!==t.WORD_SIZE[c])&&(u=t.WORD_SIZE[c],f=t.stuffBits(a,u));var A=d-d%u;if(!(l&&f.getSize()>u*64)&&f.getSize()+s<=A)break}}}var m=t.generateCheckWords(f,d,u),p=f.getSize()/u,x=t.generateModeMessage(l,c,p),v=(l?11:14)+c*4,y=new Int32Array(v),b;if(l){b=v;for(var h=0;h<y.length;h++)y[h]=h}else{b=v+1+2*ba.truncDivision(ba.truncDivision(v,2)-1,15);for(var w=ba.truncDivision(v,2),I=ba.truncDivision(b,2),h=0;h<w;h++){var j=h+ba.truncDivision(h,15);y[w-h-1]=I-j-1,y[w+h]=I+j+1}}for(var N=new fh(b),h=0,S=0;h<c;h++){for(var E=(c-h)*4+(l?9:12),B=0;B<E;B++)for(var k=B*2,T=0;T<2;T++)m.get(S+k+T)&&N.set(y[h*2+T],y[h*2+B]),m.get(S+E*2+k+T)&&N.set(y[h*2+B],y[v-1-h*2-T]),m.get(S+E*4+k+T)&&N.set(y[v-1-h*2-T],y[v-1-h*2-B]),m.get(S+E*6+k+T)&&N.set(y[v-1-h*2-B],y[h*2+T]);S+=E*8}if(t.drawModeMessage(N,l,b,x),l)t.drawBullsEye(N,ba.truncDivision(b,2),5);else{t.drawBullsEye(N,ba.truncDivision(b,2),7);for(var h=0,B=0;h<ba.truncDivision(v,2)-1;h+=15,B+=16)for(var T=ba.truncDivision(b,2)&1;T<b;T+=2)N.set(ba.truncDivision(b,2)-B,T),N.set(ba.truncDivision(b,2)+B,T),N.set(T,ba.truncDivision(b,2)-B),N.set(T,ba.truncDivision(b,2)+B)}var P=new mQe;return P.setCompact(l),P.setSize(b),P.setLayers(c),P.setCodeWords(p),P.setMatrix(N),P},t.drawBullsEye=function(e,r,n){for(var a=0;a<n;a+=2)for(var s=r-a;s<=r+a;s++)e.set(s,r-a),e.set(s,r+a),e.set(r-a,s),e.set(r+a,s);e.set(r-n,r-n),e.set(r-n+1,r-n),e.set(r-n,r-n+1),e.set(r+n,r-n),e.set(r+n,r-n+1),e.set(r+n,r+n-1)},t.generateModeMessage=function(e,r,n){var a=new Al;return e?(a.appendBits(r-1,2),a.appendBits(n-1,6),a=t.generateCheckWords(a,28,4)):(a.appendBits(r-1,5),a.appendBits(n-1,11),a=t.generateCheckWords(a,40,4)),a},t.drawModeMessage=function(e,r,n,a){var s=ba.truncDivision(n,2);if(r)for(var o=0;o<7;o++){var l=s-3+o;a.get(o)&&e.set(l,s-5),a.get(o+7)&&e.set(s+5,l),a.get(20-o)&&e.set(l,s+5),a.get(27-o)&&e.set(s-5,l)}else for(var o=0;o<10;o++){var l=s-5+o+ba.truncDivision(o,5);a.get(o)&&e.set(l,s-7),a.get(o+10)&&e.set(s+7,l),a.get(29-o)&&e.set(l,s+7),a.get(39-o)&&e.set(s-7,l)}},t.generateCheckWords=function(e,r,n){var a,s,o=e.getSize()/n,l=new qse(t.getGF(n)),c=ba.truncDivision(r,n),d=t.bitsToWords(e,n,c);l.encode(d,c-o);var u=r%n,f=new Al;f.appendBits(0,u);try{for(var A=IQe(Array.from(d)),h=A.next();!h.done;h=A.next()){var m=h.value;f.appendBits(m,n)}}catch(p){a={error:p}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}return f},t.bitsToWords=function(e,r,n){var a=new Int32Array(n),s,o;for(s=0,o=e.getSize()/r;s<o;s++){for(var l=0,c=0;c<r;c++)l|=e.get(s*r+c)?1<<r-c-1:0;a[s]=l}return a},t.getGF=function(e){switch(e){case 4:return od.AZTEC_PARAM;case 6:return od.AZTEC_DATA_6;case 8:return od.AZTEC_DATA_8;case 10:return od.AZTEC_DATA_10;case 12:return od.AZTEC_DATA_12;default:throw new Vn("Unsupported word size "+e)}},t.stuffBits=function(e,r){for(var n=new Al,a=e.getSize(),s=(1<<r)-2,o=0;o<a;o+=r){for(var l=0,c=0;c<r;c++)(o+c>=a||e.get(o+c))&&(l|=1<<r-1-c);(l&s)===s?(n.appendBits(l&s,r),o--):l&s?n.appendBits(l,r):(n.appendBits(l|1,r),o--)}return n},t.totalBitsInLayer=function(e,r){return((r?88:112)+16*e)*e},t.DEFAULT_EC_PERCENT=33,t.DEFAULT_AZTEC_LAYERS=0,t.MAX_NB_BITS=32,t.MAX_NB_BITS_COMPACT=4,t.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]),t})();var PQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),TQe=function(t){PQe(e,t);function e(r){var n=t.call(this,r.width,r.height)||this;return n.canvas=r,n.tempCanvasElement=null,n.buffer=e.makeBufferFromCanvasImageData(r),n}return e.makeBufferFromCanvasImageData=function(r){var n;try{n=r.getContext("2d",{willReadFrequently:!0})}catch{n=r.getContext("2d")}if(!n)throw new Error("Couldn't get canvas context.");var a=n.getImageData(0,0,r.width,r.height);return e.toGrayscaleBuffer(a.data,r.width,r.height)},e.toGrayscaleBuffer=function(r,n,a){for(var s=new Uint8ClampedArray(n*a),o=0,l=0,c=r.length;o<c;o+=4,l++){var d=void 0,u=r[o+3];if(u===0)d=255;else{var f=r[o],A=r[o+1],h=r[o+2];d=306*f+601*A+117*h+512>>10}s[l]=d}return s},e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Vn("Requested row is outside the image: "+r);var a=this.getWidth(),s=r*a;return n===null?n=this.buffer.slice(s,s+a):(n.length<a&&(n=new Uint8ClampedArray(a)),n.set(this.buffer.slice(s,s+a))),n},e.prototype.getMatrix=function(){return this.buffer},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return t.prototype.crop.call(this,r,n,a,s),this},e.prototype.isRotateSupported=function(){return!0},e.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},e.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},e.prototype.invert=function(){return new _P(this)},e.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement},e.prototype.rotate=function(r){var n=this.getTempCanvasElement();if(!n)throw new Error("Could not create a Canvas element.");var a=r*e.DEGREE_TO_RADIANS,s=this.canvas.width,o=this.canvas.height,l=Math.ceil(Math.abs(Math.cos(a))*s+Math.abs(Math.sin(a))*o),c=Math.ceil(Math.abs(Math.sin(a))*s+Math.abs(Math.cos(a))*o);n.width=l,n.height=c;var d=n.getContext("2d");if(!d)throw new Error("Could not create a Canvas Context element.");return d.translate(l/2,c/2),d.rotate(a),d.drawImage(this.canvas,s/-2,o/-2),this.buffer=e.makeBufferFromCanvasImageData(n),this},e.DEGREE_TO_RADIANS=Math.PI/180,e}(Xw);function Yse(){return typeof navigator<"u"}function BQe(){return Yse()&&!!navigator.mediaDevices}function kQe(){return!!(BQe()&&navigator.mediaDevices.enumerateDevices)}var av=function(){return av=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},av.apply(this,arguments)},xi=function(t,e,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(u){try{d(n.next(u))}catch(f){o(f)}}function c(u){try{d(n.throw(u))}catch(f){o(f)}}function d(u){u.done?s(u.value):a(u.value).then(l,c)}d((n=n.apply(t,e||[])).next())})},vi=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(u){return c([d,u])}}function c(d){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=d[0]&2?a.return:d[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,d[1])).done)return s;switch(a=0,s&&(d=[d[0]&2,s.value]),d[0]){case 0:case 1:s=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,a=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!s||d[1]>s[0]&&d[1]<s[3])){r.label=d[1];break}if(d[0]===6&&r.label<s[1]){r.label=s[1],s=d;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(d);break}s[2]&&r.ops.pop(),r.trys.pop();continue}d=e.call(t,r)}catch(u){d=[6,u],a=0}finally{n=s=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},lT=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},FQe={delayBetweenScanAttempts:500,delayBetweenScanSuccess:500,tryPlayVideoTimeout:5e3},T1=function(){function t(e,r,n){r===void 0&&(r=new Map),n===void 0&&(n={}),this.reader=e,this.hints=r,this.options=av(av({},FQe),n)}return Object.defineProperty(t.prototype,"possibleFormats",{set:function(e){this.hints.set(Ls.POSSIBLE_FORMATS,e)},enumerable:!1,configurable:!0}),t.addVideoSource=function(e,r){try{e.srcObject=r}catch{console.error("got interrupted by new loading request")}},t.mediaStreamSetTorch=function(e,r){return xi(this,void 0,void 0,function(){return vi(this,function(n){switch(n.label){case 0:return[4,e.applyConstraints({advanced:[{fillLightMode:r?"flash":"off",torch:!!r}]})];case 1:return n.sent(),[2]}})})},t.mediaStreamIsTorchCompatible=function(e){var r,n,a=e.getVideoTracks();try{for(var s=lT(a),o=s.next();!o.done;o=s.next()){var l=o.value;if(t.mediaStreamIsTorchCompatibleTrack(l))return!0}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return!1},t.mediaStreamIsTorchCompatibleTrack=function(e){try{var r=e.getCapabilities();return"torch"in r}catch(n){return console.error(n),console.warn("Your browser may be not fully compatible with WebRTC and/or ImageCapture specs. Torch will not be available."),!1}},t.isVideoPlaying=function(e){return e.currentTime>0&&!e.paused&&e.readyState>2},t.getMediaElement=function(e,r){var n=document.getElementById(e);if(!n)throw new no("element with id '".concat(e,"' not found"));if(n.nodeName.toLowerCase()!==r.toLowerCase())throw new no("element with id '".concat(e,"' must be an ").concat(r," element"));return n},t.createVideoElement=function(e){if(e instanceof HTMLVideoElement)return e;if(typeof e=="string")return t.getMediaElement(e,"video");if(!e&&typeof document<"u"){var r=document.createElement("video");return r.width=200,r.height=200,r}throw new Error("Couldn't get videoElement from videoSource!")},t.prepareImageElement=function(e){if(e instanceof HTMLImageElement)return e;if(typeof e=="string")return t.getMediaElement(e,"img");if(typeof e>"u"){var r=document.createElement("img");return r.width=200,r.height=200,r}throw new Error("Couldn't get imageElement from imageSource!")},t.prepareVideoElement=function(e){var r=t.createVideoElement(e);return r.setAttribute("autoplay","true"),r.setAttribute("muted","true"),r.setAttribute("playsinline","true"),r},t.isImageLoaded=function(e){return!(!e.complete||e.naturalWidth===0)},t.createBinaryBitmapFromCanvas=function(e){var r=new TQe(e),n=new Ose(r);return new Fse(n)},t.drawImageOnCanvas=function(e,r){e.drawImage(r,0,0)},t.getMediaElementDimensions=function(e){if(e instanceof HTMLVideoElement)return{height:e.videoHeight,width:e.videoWidth};if(e instanceof HTMLImageElement)return{height:e.naturalHeight||e.height,width:e.naturalWidth||e.width};throw new Error("Couldn't find the Source's dimensions!")},t.createCaptureCanvas=function(e){if(!e)throw new no("Cannot create a capture canvas without a media element.");if(typeof document>"u")throw new Error(`The page "Document" is undefined, make sure you're running in a browser.`);var r=document.createElement("canvas"),n=t.getMediaElementDimensions(e),a=n.width,s=n.height;return r.style.width=a+"px",r.style.height=s+"px",r.width=a,r.height=s,r},t.tryPlayVideo=function(e){return xi(this,void 0,void 0,function(){var r;return vi(this,function(n){switch(n.label){case 0:if(e!=null&&e.ended)return console.error("Trying to play video that has ended."),[2,!1];if(t.isVideoPlaying(e))return console.warn("Trying to play video that is already playing."),[2,!0];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e.play()];case 2:return n.sent(),[2,!0];case 3:return r=n.sent(),console.warn("It was not possible to play the video.",r),[2,!1];case 4:return[2]}})})},t.createCanvasFromMediaElement=function(e){var r=t.createCaptureCanvas(e),n=r.getContext("2d");if(!n)throw new Error("Couldn't find Canvas 2D Context.");return t.drawImageOnCanvas(n,e),r},t.createBinaryBitmapFromMediaElem=function(e){var r=t.createCanvasFromMediaElement(e);return t.createBinaryBitmapFromCanvas(r)},t.destroyImageElement=function(e){e.src="",e.removeAttribute("src"),e=void 0},t.listVideoInputDevices=function(){return xi(this,void 0,void 0,function(){var e,r,n,a,s,o,l,c,d,u,f,A;return vi(this,function(h){switch(h.label){case 0:if(!Yse())throw new Error("Can't enumerate devices, navigator is not present.");if(!kQe())throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=h.sent(),r=[];try{for(n=lT(e),a=n.next();!a.done;a=n.next())s=a.value,o=s.kind==="video"?"videoinput":s.kind,o==="videoinput"&&(l=s.deviceId||s.id,c=s.label||"Video device ".concat(r.length+1),d=s.groupId,u={deviceId:l,label:c,kind:o,groupId:d},r.push(u))}catch(m){f={error:m}}finally{try{a&&!a.done&&(A=n.return)&&A.call(n)}finally{if(f)throw f.error}}return[2,r]}})})},t.findDeviceById=function(e){return xi(this,void 0,void 0,function(){var r;return vi(this,function(n){switch(n.label){case 0:return[4,t.listVideoInputDevices()];case 1:return r=n.sent(),r?[2,r.find(function(a){return a.deviceId===e})]:[2]}})})},t.cleanVideoSource=function(e){if(e){try{e.srcObject=null}catch{e.src=""}e&&e.removeAttribute("src")}},t.releaseAllStreams=function(){t.streamTracker.length!==0&&t.streamTracker.forEach(function(e){e.getTracks().forEach(function(r){return r.stop()})}),t.streamTracker=[]},t.playVideoOnLoadAsync=function(e,r){return xi(this,void 0,void 0,function(){var n;return vi(this,function(a){switch(a.label){case 0:return[4,t.tryPlayVideo(e)];case 1:return n=a.sent(),n?[2,!0]:[2,new Promise(function(s,o){var l=setTimeout(function(){t.isVideoPlaying(e)||(o(!1),e.removeEventListener("canplay",c))},r),c=function(){t.tryPlayVideo(e).then(function(d){clearTimeout(l),e.removeEventListener("canplay",c),s(d)})};e.addEventListener("canplay",c)})]}})})},t.attachStreamToVideo=function(e,r,n){return n===void 0&&(n=5e3),xi(this,void 0,void 0,function(){var a;return vi(this,function(s){switch(s.label){case 0:return a=t.prepareVideoElement(r),t.addVideoSource(a,e),[4,t.playVideoOnLoadAsync(a,n)];case 1:return s.sent(),[2,a]}})})},t._waitImageLoad=function(e){return new Promise(function(r,n){var a=1e4,s=setTimeout(function(){t.isImageLoaded(e)||(e.removeEventListener("load",o),n())},a),o=function(){clearTimeout(s),e.removeEventListener("load",o),r()};e.addEventListener("load",o)})},t.checkCallbackFnOrThrow=function(e){if(!e)throw new no("`callbackFn` is a required parameter, you cannot capture results without it.")},t.disposeMediaStream=function(e){e.getVideoTracks().forEach(function(r){return r.stop()}),e=void 0},t.prototype.decode=function(e){var r=t.createCanvasFromMediaElement(e);return this.decodeFromCanvas(r)},t.prototype.decodeBitmap=function(e){return this.reader.decode(e,this.hints)},t.prototype.decodeFromCanvas=function(e){var r=t.createBinaryBitmapFromCanvas(e);return this.decodeBitmap(r)},t.prototype.decodeFromImageElement=function(e){return xi(this,void 0,void 0,function(){var r;return vi(this,function(n){switch(n.label){case 0:if(!e)throw new no("An image element must be provided.");return r=t.prepareImageElement(e),[4,this._decodeOnLoadImage(r)];case 1:return[2,n.sent()]}})})},t.prototype.decodeFromImageUrl=function(e){return xi(this,void 0,void 0,function(){var r;return vi(this,function(n){switch(n.label){case 0:if(!e)throw new no("An URL must be provided.");r=t.prepareImageElement(),r.src=e,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this.decodeFromImageElement(r)];case 2:return[2,n.sent()];case 3:return t.destroyImageElement(r),[7];case 4:return[2]}})})},t.prototype.decodeFromConstraints=function(e,r,n){return xi(this,void 0,void 0,function(){var a,s;return vi(this,function(o){switch(o.label){case 0:return t.checkCallbackFnOrThrow(n),[4,this.getUserMedia(e)];case 1:a=o.sent(),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,this.decodeFromStream(a,r,n)];case 3:return[2,o.sent()];case 4:throw s=o.sent(),t.disposeMediaStream(a),s;case 5:return[2]}})})},t.prototype.decodeFromStream=function(e,r,n){return xi(this,void 0,void 0,function(){var a,s,o,l,c,d,u,f,A,h=this;return vi(this,function(m){switch(m.label){case 0:return t.checkCallbackFnOrThrow(n),a=this.options.tryPlayVideoTimeout,[4,t.attachStreamToVideo(e,r,a)];case 1:return s=m.sent(),o=function(){t.disposeMediaStream(e),t.cleanVideoSource(s)},l=this.scan(s,n,o),c=e.getVideoTracks(),d=av(av({},l),{stop:function(){l.stop()},streamVideoConstraintsApply:function(p,x){return xi(this,void 0,void 0,function(){var v,y,b,w,I,j,N;return vi(this,function(S){switch(S.label){case 0:v=x?c.filter(x):c,S.label=1;case 1:S.trys.push([1,6,7,8]),y=lT(v),b=y.next(),S.label=2;case 2:return b.done?[3,5]:(w=b.value,[4,w.applyConstraints(p)]);case 3:S.sent(),S.label=4;case 4:return b=y.next(),[3,2];case 5:return[3,8];case 6:return I=S.sent(),j={error:I},[3,8];case 7:try{b&&!b.done&&(N=y.return)&&N.call(y)}finally{if(j)throw j.error}return[7];case 8:return[2]}})})},streamVideoConstraintsGet:function(p){return c.find(p).getConstraints()},streamVideoSettingsGet:function(p){return c.find(p).getSettings()},streamVideoCapabilitiesGet:function(p){return c.find(p).getCapabilities()}}),u=t.mediaStreamIsTorchCompatible(e),u&&(f=c==null?void 0:c.find(function(p){return t.mediaStreamIsTorchCompatibleTrack(p)}),A=function(p){return xi(h,void 0,void 0,function(){return vi(this,function(x){switch(x.label){case 0:return[4,t.mediaStreamSetTorch(f,p)];case 1:return x.sent(),[2]}})})},d.switchTorch=A,d.stop=function(){return xi(h,void 0,void 0,function(){return vi(this,function(p){switch(p.label){case 0:return l.stop(),[4,A(!1)];case 1:return p.sent(),[2]}})})}),[2,d]}})})},t.prototype.decodeFromVideoDevice=function(e,r,n){return xi(this,void 0,void 0,function(){var a,s;return vi(this,function(o){switch(o.label){case 0:return t.checkCallbackFnOrThrow(n),e?a={deviceId:{exact:e}}:a={facingMode:"environment"},s={video:a},[4,this.decodeFromConstraints(s,r,n)];case 1:return[2,o.sent()]}})})},t.prototype.decodeFromVideoElement=function(e,r){return xi(this,void 0,void 0,function(){var n,a;return vi(this,function(s){switch(s.label){case 0:if(t.checkCallbackFnOrThrow(r),!e)throw new no("A video element must be provided.");return n=t.prepareVideoElement(e),a=this.options.tryPlayVideoTimeout,[4,t.playVideoOnLoadAsync(n,a)];case 1:return s.sent(),[2,this.scan(n,r)]}})})},t.prototype.decodeFromVideoUrl=function(e,r){return xi(this,void 0,void 0,function(){var n,a,s,o;return vi(this,function(l){switch(l.label){case 0:if(t.checkCallbackFnOrThrow(r),!e)throw new no("An URL must be provided.");return n=t.prepareVideoElement(),n.src=e,a=function(){t.cleanVideoSource(n)},s=this.options.tryPlayVideoTimeout,[4,t.playVideoOnLoadAsync(n,s)];case 1:return l.sent(),o=this.scan(n,r,a),[2,o]}})})},t.prototype.decodeOnceFromConstraints=function(e,r){return xi(this,void 0,void 0,function(){var n;return vi(this,function(a){switch(a.label){case 0:return[4,this.getUserMedia(e)];case 1:return n=a.sent(),[4,this.decodeOnceFromStream(n,r)];case 2:return[2,a.sent()]}})})},t.prototype.decodeOnceFromStream=function(e,r){return xi(this,void 0,void 0,function(){var n,a,s;return vi(this,function(o){switch(o.label){case 0:return n=!!r,[4,t.attachStreamToVideo(e,r)];case 1:a=o.sent(),o.label=2;case 2:return o.trys.push([2,,4,5]),[4,this.scanOneResult(a)];case 3:return s=o.sent(),[2,s];case 4:return n||t.cleanVideoSource(a),[7];case 5:return[2]}})})},t.prototype.decodeOnceFromVideoDevice=function(e,r){return xi(this,void 0,void 0,function(){var n,a;return vi(this,function(s){switch(s.label){case 0:return e?n={deviceId:{exact:e}}:n={facingMode:"environment"},a={video:n},[4,this.decodeOnceFromConstraints(a,r)];case 1:return[2,s.sent()]}})})},t.prototype.decodeOnceFromVideoElement=function(e){return xi(this,void 0,void 0,function(){var r,n;return vi(this,function(a){switch(a.label){case 0:if(!e)throw new no("A video element must be provided.");return r=t.prepareVideoElement(e),n=this.options.tryPlayVideoTimeout,[4,t.playVideoOnLoadAsync(r,n)];case 1:return a.sent(),[4,this.scanOneResult(r)];case 2:return[2,a.sent()]}})})},t.prototype.decodeOnceFromVideoUrl=function(e){return xi(this,void 0,void 0,function(){var r,n;return vi(this,function(a){switch(a.label){case 0:if(!e)throw new no("An URL must be provided.");r=t.prepareVideoElement(),r.src=e,n=this.decodeOnceFromVideoElement(r),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,n];case 2:return[2,a.sent()];case 3:return t.cleanVideoSource(r),[7];case 4:return[2]}})})},t.prototype.scanOneResult=function(e,r,n,a){var s=this;return r===void 0&&(r=!0),n===void 0&&(n=!0),a===void 0&&(a=!0),new Promise(function(o,l){s.scan(e,function(c,d,u){if(c){o(c),u.stop();return}if(d){if(d instanceof Ar&&r||d instanceof wo&&n||d instanceof Zr&&a)return;u.stop(),l(d)}})})},t.prototype.scan=function(e,r,n){var a=this;t.checkCallbackFnOrThrow(r);var s=t.createCaptureCanvas(e),o;try{o=s.getContext("2d",{willReadFrequently:!0})}catch{o=s.getContext("2d")}if(!o)throw new Error("Couldn't create canvas for visual element scan.");var l=function(){o=void 0,s=void 0},c=!1,d,u=function(){c=!0,clearTimeout(d),l(),n&&n()},f={stop:u},A=function(){if(!c)try{t.drawImageOnCanvas(o,e);var h=a.decodeFromCanvas(s);r(h,void 0,f),d=setTimeout(A,a.options.delayBetweenScanSuccess)}catch(v){r(void 0,v,f);var m=v instanceof wo,p=v instanceof Zr,x=v instanceof Ar;if(m||p||x){d=setTimeout(A,a.options.delayBetweenScanAttempts);return}l(),n&&n(v)}};return A(),f},t.prototype._decodeOnLoadImage=function(e){return xi(this,void 0,void 0,function(){var r;return vi(this,function(n){switch(n.label){case 0:return r=t.isImageLoaded(e),r?[3,2]:[4,t._waitImageLoad(e)];case 1:n.sent(),n.label=2;case 2:return[2,this.decode(e)]}})})},t.prototype.getUserMedia=function(e){return xi(this,void 0,void 0,function(){var r;return vi(this,function(n){switch(n.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return r=n.sent(),t.streamTracker.push(r),[2,r]}})})},t.streamTracker=[],t}(),OQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){OQe(e,t);function e(r,n){return t.call(this,new oj,r,n)||this}return e})(T1);var DQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){DQe(e,t);function e(r,n){return t.call(this,new rv(r),r,n)||this}return e})(T1);var RQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){RQe(e,t);function e(r,n){return t.call(this,new cj,r,n)||this}return e})(T1);var MQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),X2=function(t){MQe(e,t);function e(r,n){var a=this,s=new Kse;return s.setHints(r),a=t.call(this,s,r,n)||this,a.reader=s,a}return Object.defineProperty(e.prototype,"possibleFormats",{set:function(r){this.hints.set(Ls.POSSIBLE_FORMATS,r),this.reader.setHints(this.hints)},enumerable:!1,configurable:!0}),e.prototype.decodeBitmap=function(r){return this.reader.decodeWithState(r)},e.prototype.setHints=function(r){this.hints=r,this.reader.setHints(this.hints)},e}(T1),LQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){LQe(e,t);function e(r,n){return t.call(this,new uj,r,n)||this}return e})(T1);var UQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){UQe(e,t);function e(r,n){return t.call(this,new dj,r,n)||this}return e})(T1);const cT=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function ws(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function Qh(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function C0(t,e=1){const r=Math.floor(Qh(t,e));return r>0?r:e}function QQe(t){return Object.values(t||{}).every(r=>ws(r)==="")}function ip(t,e){const r=Object.keys(t||{}),n=new Map;r.forEach(a=>n.set(ws(a),a));for(const a of e){const s=n.get(ws(a));if(s!=null)return t[s]}}function VQe({open:t,code:e,onClose:r}){return t?i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-sm rounded-2xl shadow-lg border p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{className:"font-bold text-lg",children:"Cdigo de barras"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:r,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-3",children:[i.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Valor"}),i.jsx("div",{className:"text-xl font-mono font-semibold break-all",children:e})]}),i.jsx("div",{className:"mt-3 flex gap-2 justify-end",children:i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",type:"button",onClick:()=>{var n;try{(n=navigator.clipboard)==null||n.writeText(e)}catch{}},children:"Copiar"})})]})}):null}function HQe({open:t,onClose:e,onDetected:r}){const n=g.useRef(null),a=g.useRef(null),[s,o]=g.useState(""),l=g.useRef("");return g.useEffect(()=>{if(!t)return;let c=!1;const d=new X2,u=()=>{var A,h,m;try{(A=a.current)==null||A.stop()}catch{}a.current=null;try{const p=(h=n.current)==null?void 0:h.srcObject;(m=p==null?void 0:p.getTracks)==null||m.call(p).forEach(x=>x.stop())}catch{}try{n.current&&(n.current.srcObject=null)}catch{}};return(async()=>{o("");try{if(!n.current)return;try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1})).getTracks().forEach(m=>m.stop())}catch{}const A=await d.decodeFromConstraints({video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1},n.current,h=>{if(!c&&h){const m=String(h.getText()||"").trim().replace(/\s+/g,"");if(!m||m===l.current)return;l.current=m,u(),r(m),e()}});a.current=A}catch(A){const h=String((A==null?void 0:A.message)||""),m=String((A==null?void 0:A.name)||"");h.toLowerCase().includes("permission")||m==="NotAllowedError"?o("Permiso de cmara denegado."):m==="NotFoundError"||h.toLowerCase().includes("notfound")?o("No se encontr cmara en este dispositivo."):h.toLowerCase().includes("secure")||h.toLowerCase().includes("https")?o("La cmara requiere HTTPS (sitio seguro)."):o(h||"No se pudo iniciar el escner.")}})(),()=>{c=!0,u()}},[t,e,r]),t?i.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 p-3 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-lg border overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[i.jsx("div",{className:"font-bold",children:"Escanear cdigo"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:e,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"relative w-full aspect-[3/4] bg-black rounded-xl overflow-hidden",children:[i.jsx("video",{ref:n,className:"w-full h-full object-cover",muted:!0,playsInline:!0,autoPlay:!0}),i.jsx("div",{className:"absolute inset-0 pointer-events-none",children:i.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[85%] h-40 border-2 border-white/70 rounded-xl"})})]}),s&&i.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded p-2",children:s}),i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Apunt al cdigo de barras y mantenelo estable."})]})]})}):null}function $Qe(){const{refreshKey:t,refresh:e}=bc(),[r,n]=g.useState(!0),[a,s]=g.useState(""),[o,l]=g.useState([]),[c,d]=g.useState(""),[u,f]=g.useState(""),[A,h]=g.useState(0),[m,p]=g.useState(1),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,I]=g.useState(null),[j,N]=g.useState(""),[S,E]=g.useState(""),[B,k]=g.useState(0),[T,P]=g.useState(1),[q,de]=g.useState(""),[ce,le]=g.useState(""),[he,ae]=g.useState(""),[Ce,De]=g.useState(""),[O,R]=g.useState(""),[G,M]=g.useState(!1),[K,Y]=g.useState(""),[D,V]=g.useState(!1),[te,ve]=g.useState("create"),[Q,Xe]=g.useState(!1),[se,Z]=g.useState(""),[ke,Se]=g.useState([]),[Ee,Ze]=g.useState([]),[ot,vt]=g.useState(!1),[_t,Tt]=g.useState(!1);g.useEffect(()=>{var ze;const xe=window.matchMedia("(max-width: 900px)"),Ge=()=>Tt(xe.matches);return Ge(),(ze=xe.addEventListener)==null||ze.call(xe,"change",Ge),()=>{var Ke;return(Ke=xe.removeEventListener)==null?void 0:Ke.call(xe,"change",Ge)}},[]);const[Lt,Rt]=g.useState(!0),[Et,Re]=g.useState(!0);g.useEffect(()=>{_t?(Rt(!1),Re(!1)):(Rt(!0),Re(!0))},[_t]);const[Te,Ye]=g.useState(null),[dt,Fe]=g.useState({}),je=g.useRef(!1),We=g.useRef(null);g.useEffect(()=>{n(!0),s("");const xe=xt(Ne,"products_candies"),Ge=ar(xe,kn("name","asc")),ze=Fu(Ge,Ke=>{const pt=[],ne={};Ke.forEach(nt=>{const wt=nt.data(),Bt=String(wt.barcode||"").trim()||void 0;Bt&&(ne[nt.id]=Bt),pt.push({id:nt.id,name:wt.name||"",category:wt.category||"",providerPrice:Number(wt.providerPrice||0),unitsPerPackage:Number(wt.unitsPerPackage||1),barcode:Bt,packaging:String(wt.packaging||wt.empaque||"").trim()||void 0,createdAt:wt.createdAt})});const Ue=ee.current||{};let tt=!1;for(const nt of Object.keys(ne))if((ne[nt]||"")!==(Ue[nt]||"")){tt=!0;break}l(pt),ee.current=ne,n(!1),!Ve.current&&tt&&(s(" Catlogo actualizado."),setTimeout(()=>s(""),3e3)),Ve.current=!1},Ke=>{console.error(Ke),s(" Error sincronizando catlogo de dulces."),n(!1)});return()=>ze()},[t]);const ee=g.useRef({}),Ve=g.useRef(!0),rt=g.useMemo(()=>{const xe=ws(he),Ge=String(Ce||"").trim(),ze=String(O||"").trim().toLowerCase();return ze?o.filter(Ke=>String(Ke.packaging||"").trim().toLowerCase()===ze):!xe&&!Ge?o:o.filter(Ke=>{const pt=`${Ke.category} ${Ke.name}`.toLowerCase(),ne=xe?pt.includes(xe):!0,Ue=String(Ke.barcode||""),tt=Ge?Ue.includes(Ge):!0;return ne&&tt})},[o,he,Ce,O]),$e=7,[ie,pe]=g.useState(1),fe=g.useMemo(()=>{const xe={};return rt.forEach(Ge=>{const ze=String(Ge.category||"(sin categora)").trim()||"(sin categora)";xe[ze]||(xe[ze]=[]),xe[ze].push(Ge)}),Object.entries(xe).map(([Ge,ze])=>({category:Ge,rows:ze.sort((Ke,pt)=>Ke.name.localeCompare(pt.name,"es"))})).sort((Ge,ze)=>Ge.category.localeCompare(ze.category,"es"))},[rt]),Me=Math.max(1,Math.ceil((_t?fe.length:rt.length)/$e)),me=g.useMemo(()=>{const xe=(ie-1)*$e;return rt.slice(xe,xe+$e)},[rt,ie]),ye=g.useMemo(()=>{const xe=(ie-1)*$e;return fe.slice(xe,xe+$e)},[fe,ie]);g.useEffect(()=>{pe(1)},[he,Ce,O]),g.useEffect(()=>{pe(xe=>Math.min(xe,Me))},[Me]);const mt=()=>pe(1),gt=()=>pe(xe=>Math.max(1,xe-1)),yt=()=>pe(xe=>Math.min(Me,xe+1)),Pt=()=>pe(Me),Ft=()=>i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:mt,disabled:ie===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:gt,disabled:ie===1,children:" Anterior"}),i.jsxs("span",{className:"px-2 text-sm",children:["Pgina ",ie," de ",Me]}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:yt,disabled:ie===Me,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Pt,disabled:ie===Me,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[rt.length," producto(s)"]})]}),Oe=xe=>{Fe(Ge=>({...Ge,[xe]:!Ge[xe]}))},be=g.useMemo(()=>{const xe=new Set;return o.forEach(Ge=>{const ze=String(Ge.category||"").trim();ze&&xe.add(ze)}),Array.from(xe).sort((Ge,ze)=>Ge.localeCompare(ze,"es"))},[o]),Ae=()=>{d(""),f(""),h(0),p(1),v(""),b("")},Le=async xe=>{if(xe.preventDefault(),je.current||r)return;s("");const Ge=String(c||"").trim(),ze=String(u||"").trim(),Ke=Math.max(0,Qh(A,0)),pt=C0(m,1),ne=String(x||"").trim();if(!Ge)return s(" La categora es requerida.");if(!ze)return s(" El nombre del producto es requerido.");if(Ke<=0)return s(" El precio proveedor debe ser > 0.");if(pt<=0)return s(" Und x paquete debe ser > 0.");const Ue=`${ws(Ge)}::${ws(ze)}`,tt=Date.now();if(We.current&&We.current.key===Ue&&tt-We.current.ts<4e3){s(" Ya se est creando este producto.");return}if(o.some(wt=>ws(wt.category)===ws(Ge)&&ws(wt.name)===ws(ze)))return s(" Ya existe un producto con esa categora y nombre.");if(ne&&o.some(Bt=>String(Bt.barcode||"")===ne))return s(" Ya existe un producto con ese cdigo de barras.");je.current=!0,We.current={key:Ue,ts:tt};try{if(n(!0),!(await Ut(ar(xt(Ne,"products_candies"),lr("category","==",Ge),lr("name","==",ze),_S(1)))).empty){s(" Ya existe un producto con esa categora y nombre.");return}if(ne&&!(await Ut(ar(xt(Ne,"products_candies"),lr("barcode","==",ne),_S(1)))).empty){s(" Ya existe un producto con ese cdigo de barras.");return}const Bt={category:Ge,name:ze,providerPrice:Ke,unitsPerPackage:pt,createdAt:Nr.now()};ne&&(Bt.barcode=ne);const tr=String(y||"").trim();tr&&(Bt.packaging=tr),await ta(xt(Ne,"products_candies"),Bt),s(" Producto creado."),Ae()}catch(wt){console.error(wt),s(" Error creando producto.")}finally{n(!1),je.current=!1}},ut=xe=>{I(xe.id),N(xe.category),E(xe.name),k(xe.providerPrice),P(xe.unitsPerPackage||1),de(String(xe.barcode||"")),le(String(xe.packaging||"")),s("")},ct=()=>{I(null),N(""),E(""),k(0),P(1),de(""),le("")},st=async()=>{if(!w)return;s("");const xe=String(j||"").trim(),Ge=String(S||"").trim(),ze=Math.max(0,Qh(B,0)),Ke=C0(T,1),pt=String(q||"").trim(),ne=String(ce||"").trim();if(!xe)return s(" La categora es requerida.");if(!Ge)return s(" El nombre del producto es requerido.");if(ze<=0)return s(" El precio proveedor debe ser > 0.");if(Ke<=0)return s(" Und x paquete debe ser > 0.");if(o.some(tt=>tt.id!==w&&ws(tt.category)===ws(xe)&&ws(tt.name)===ws(Ge)))return s(" Ya existe otro producto con esa categora y nombre.");if(pt&&o.some(nt=>nt.id!==w&&String(nt.barcode||"")===pt))return s(" Ya existe otro producto con ese cdigo de barras.");try{n(!0);const tt={category:xe,name:Ge,providerPrice:ze,unitsPerPackage:Ke,updatedAt:Nr.now()};tt.barcode=pt||"",tt.packaging=ne||"",await Mn(Kt(Ne,"products_candies",w),tt),l(nt=>nt.map(wt=>wt.id===w?{...wt,category:xe,name:Ge,providerPrice:ze,unitsPerPackage:Ke,barcode:pt||void 0,packaging:ne||void 0}:wt).sort((wt,Bt)=>wt.name.localeCompare(Bt.name,"es"))),_t&&s(" Producto guardado."),ct()}catch(tt){console.error(tt),s(" Error actualizando producto.")}finally{n(!1)}},z=async xe=>{if(confirm(`Eliminar "${xe.name}" (${xe.category}) del catlogo?`))try{n(!0),await na(Kt(Ne,"products_candies",xe.id)),l(ze=>ze.filter(Ke=>Ke.id!==xe.id)),s(" Producto eliminado.")}catch(ze){console.error(ze),s(" Error eliminando producto.")}finally{n(!1)}},X=()=>{const xe=[{Id:"",Categoria:"Gomitas",Producto:"Gomita Fresa",PrecioProveedor:120,UnidadesPorPaquete:24,Empaque:"Tarro",Codigo:"7445074183182"}],Ge=pa.json_to_sheet(xe),ze=pa.book_new();pa.book_append_sheet(ze,Ge,"Productos");const Ke=I1(ze,{type:"array",bookType:"xlsx"}),pt=new Blob([Ke],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),ne=URL.createObjectURL(pt),Ue=document.createElement("a");Ue.href=ne,Ue.download="template_productos_dulces.xlsx",document.body.appendChild(Ue),Ue.click(),Ue.remove(),URL.revokeObjectURL(ne)},re=xe=>{const Ge=[],ze=[];xe.forEach((pt,ne)=>{if(!pt||typeof pt!="object"||QQe(pt))return;const Ue=String(ip(pt,["Id","ID","productId","docId"])??"").trim(),tt=String(ip(pt,["Categoria","Categora","Category","cat","category"])??"").trim(),nt=String(ip(pt,["Producto","Product","Nombre","Name","producto","name"])??"").trim(),wt=ip(pt,["PrecioProveedor","Precio Prov","Precio Prov.","ProviderPrice","Precio","Costo","providerPrice"]),Bt=ip(pt,["UnidadesPorPaquete","Und x Paquete","UnitsPerPackage","UPP","unitsPerPackage"]),tr=ip(pt,["Codigo","Cdigo","Barcode","barcode","EAN","UPC","Code"]),Or=String(tr??"").trim(),zr=ip(pt,["Empaque","Packaging","PackagingType","Pack","Formato"]),ur=String(zr??"").trim(),Dr=Math.max(0,Qh(wt,0)),dn=C0(Bt,1),mn=ne+2;tt||ze.push(`Fila ${mn}: falta Categoria.`),nt||ze.push(`Fila ${mn}: falta Producto/Nombre.`),Dr<=0&&ze.push(`Fila ${mn}: PrecioProveedor debe ser > 0.`),dn<=0&&ze.push(`Fila ${mn}: UnidadesPorPaquete debe ser > 0.`),tt&&nt&&Dr>0&&dn>0&&Ge.push({id:Ue||void 0,category:tt,name:nt,providerPrice:Dr,unitsPerPackage:dn,barcode:Or||void 0,packaging:ur||void 0,_raw:pt})});const Ke=new Map;for(const pt of Ge){const ne=pt.id?`id::${pt.id}`:`${ws(pt.category)}::${ws(pt.name)}`;Ke.set(ne,pt)}return{rows:Array.from(Ke.values()),errors:ze}},H=async xe=>{if(s(""),Ze([]),Se([]),Z((xe==null?void 0:xe.name)||""),!xe)return;const Ge=xe.name.toLowerCase(),ze=Ge.endsWith(".xlsx")||Ge.endsWith(".xls"),Ke=Ge.endsWith(".csv");if(!ze&&!Ke){Ze(["Solo se permiten archivos .xlsx, .xls o .csv"]);return}try{vt(!0);const pt=new FileReader,ne=await new Promise((Or,zr)=>{pt.onerror=()=>zr(new Error("No se pudo leer el archivo.")),pt.onload=()=>Or(pt.result),pt.readAsArrayBuffer(xe)}),Ue=qv(new Uint8Array(ne),{type:"array"}),tt=Ue.SheetNames[0],nt=Ue.Sheets[tt],wt=pa.sheet_to_json(nt,{defval:""}),{rows:Bt,errors:tr}=re(wt);Se(Bt),Ze(tr),Bt.length===0&&tr.length===0&&Ze(["No se encontraron filas vlidas para importar."])}catch(pt){console.error(pt),Ze(["Error leyendo el archivo. Revis que no est corrupto."])}finally{vt(!1)}},L=(xe,Ge)=>{Se(ze=>{const Ke=[...ze],pt=Ke[xe];return pt?(Ke[xe]={...pt,...Ge},Ke):ze})},ue=async()=>{if(s(""),Ee.length>0){s(" Correg los errores antes de importar.");return}if(ke.length===0){s(" No hay filas para importar.");return}try{vt(!0);const xe={},Ge={},ze={};o.forEach(Ue=>{xe[Ue.id]=Ue,Ge[`${ws(Ue.category)}::${ws(Ue.name)}`]=Ue;const tt=String(Ue.barcode||"").trim();tt&&(ze[tt]=Ue)});const Ke=Lc(Ne);let pt=0,ne=0;for(const Ue of ke){const tt=String(Ue.category||"").trim(),nt=String(Ue.name||"").trim(),wt=Math.max(0,Qh(Ue.providerPrice,0)),Bt=C0(Ue.unitsPerPackage,1),tr=String(Ue.barcode||"").trim();if(!tt||!nt||wt<=0||Bt<=0)continue;let Or;if(Ue.id&&xe[Ue.id])Or=xe[Ue.id];else{const zr=`${ws(tt)}::${ws(nt)}`;Or=Ge[zr]}if(!Or&&tr&&ze[tr]&&(Or=ze[tr]),Or){const zr={category:tt,name:nt,providerPrice:wt,unitsPerPackage:Bt,updatedAt:Nr.now()};Ue.barcode!=null&&(zr.barcode=tr||""),Ue.packaging!=null&&(zr.packaging=String(Ue.packaging||"")||""),Ke.update(Kt(Ne,"products_candies",Or.id),zr),ne+=1}else{const zr=Kt(xt(Ne,"products_candies")),ur={category:tt,name:nt,providerPrice:wt,unitsPerPackage:Bt,createdAt:Nr.now()};tr&&(ur.barcode=tr),Ue.packaging&&(ur.packaging=Ue.packaging),Ke.set(zr,ur),pt+=1}}await Ke.commit(),s(` Importacin lista. Creados: ${pt}, Actualizados: ${ne}`),Xe(!1),Se([]),Ze([]),Z(""),e()}catch(xe){console.error(xe),s(" Error importando productos a Firestore.")}finally{vt(!1)}},Pe=g.useMemo(()=>{const xe=new Set(o.map(ne=>ne.id)),Ge=new Set(o.map(ne=>`${ws(ne.category)}::${ws(ne.name)}`)),ze=new Set(o.map(ne=>String(ne.barcode||"").trim()).filter(Boolean));let Ke=0,pt=0;for(const ne of ke){if(ne.id&&xe.has(ne.id)){Ke+=1;continue}const Ue=`${ws(ne.category)}::${ws(ne.name)}`;if(Ge.has(Ue)){Ke+=1;continue}const tt=String(ne.barcode||"").trim();if(tt&&ze.has(tt)){Ke+=1;continue}pt+=1}return{willCreate:pt,willUpdate:Ke,total:ke.length}},[ke,o]);return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Catalogo"}),i.jsx("div",{className:"flex gap-2",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx(yc,{onClick:e,loading:r||ot}),!_t&&i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-white border shadow-sm",onClick:()=>{Xe(!0),Se([]),Ze([]),Z("")},children:"Importar"})]})})]}),_t&&i.jsxs("div",{className:"flex flex-col gap-2 mb-3",children:[i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-gray-900 text-white",onClick:()=>Rt(xe=>!xe),children:Lt?"Ocultar creacin":"Crear producto"}),i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-white border shadow-sm",onClick:()=>{Xe(!0),Se([]),Ze([]),Z("")},children:"Importar"}),i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-gray-200",onClick:()=>Re(xe=>!xe),children:Et?"Ocultar filtros":"Mostrar filtros"}),Et&&i.jsxs("div",{className:"bg-white p-3 rounded shadow-sm border",children:[i.jsx("label",{className:"block font-semibold",children:"Empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:O,onChange:xe=>R(xe.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]})]}),Lt&&i.jsxs("form",{onSubmit:Le,className:"bg-white p-3 rounded shadow border mb-4 grid grid-cols-1 md:grid-cols-6 gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Categora"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:c,onChange:xe=>d(xe.target.value),placeholder:"Ej: Gomitas"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:u,onChange:xe=>f(xe.target.value),placeholder:"Ej: Gomita Fresa"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:y,onChange:xe=>b(xe.target.value),children:[i.jsx("option",{value:"",children:"Seleccionar"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio proveedor (paq)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-1 text-right",value:Number.isNaN(A)?"":A,onChange:xe=>h(Math.max(0,Qh(xe.target.value,0)))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Und x paquete"}),i.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-1 text-right",value:m,onChange:xe=>p(C0(xe.target.value,1))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cdigo (opcional)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"w-full border rounded px-2 py-1",value:x,onChange:xe=>v(xe.target.value),placeholder:"EAN/UPC"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white hover:bg-black whitespace-nowrap",onClick:()=>{ve("create"),V(!0)},children:"Escanear"})]})]}),i.jsxs("div",{className:"md:col-span-6 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:Ae,children:"Limpiar"}),i.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",disabled:r,children:"Crear producto"})]})]}),Et&&i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-3 flex flex-col md:flex-row gap-3 items-center text-sm",children:[i.jsxs("div",{className:"w-full md:w-1/2",children:[i.jsx("label",{className:"block font-semibold",children:"Buscar"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:he,onChange:xe=>ae(xe.target.value),placeholder:"Buscar por categora o producto"}),i.jsxs("div",{className:"mt-2",children:[i.jsx("label",{className:"block font-semibold",children:"Empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:O,onChange:xe=>R(xe.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]})]}),i.jsxs("div",{className:"w-full md:w-1/2",children:[i.jsx("label",{className:"block font-semibold",children:"Buscar por cdigo"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:Ce,onChange:xe=>De(xe.target.value),placeholder:"Ej: 7445074183182"}),i.jsx("div",{className:"mt-2 md:mt-0",children:i.jsx("button",{type:"button",className:"w-full md:w-auto px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{ve("search"),V(!0),Re(!0)},children:"Escanear producto"})}),i.jsx("div",{className:"mt-2 md:mt-0",children:i.jsx("button",{type:"button",className:"w-full md:w-auto px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{ae(""),De("")},children:"Limpiar filtros"})})]}),i.jsxs("div",{className:"w-full md:w-auto text-right",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Productos en catlogo"}),i.jsx("div",{className:"text-lg font-semibold",children:rt.length})]})]}),_t?i.jsxs("div",{className:"space-y-2",children:[r?i.jsx("div",{className:"bg-white border rounded p-4 text-center",children:"Cargando"}):rt.length===0?i.jsx("div",{className:"bg-white border rounded p-4 text-center",children:"Sin productos."}):i.jsx("div",{className:"space-y-3",children:ye.map(xe=>{const Ge=!!dt[xe.category];return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>Oe(xe.category),"aria-expanded":Ge,children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-bold truncate",children:xe.category}),i.jsxs("div",{className:"text-xs text-gray-600",children:[xe.rows.length," producto(s)"]})]}),i.jsx("span",{className:`transition-transform ${Ge?"rotate-180":""}`,children:""})]}),Ge&&i.jsx("div",{className:"border-t p-2 space-y-2",children:xe.rows.map(ze=>{const Ke=w===ze.id,pt=Te===ze.id,ne=!!String(ze.barcode||"").trim();return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>Ye(Ue=>Ue===ze.id?null:ze.id),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-bold truncate",children:ze.name}),i.jsx("div",{className:"text-xs text-gray-600 truncate",children:ze.category})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Precio proveedor"}),i.jsx("div",{className:"font-bold tabular-nums",children:cT(ze.providerPrice)})]})]}),pt&&i.jsx("div",{className:"px-3 pb-3 border-t",children:i.jsxs("div",{className:"pt-3 space-y-2 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Categora"}),Ke?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:j,onChange:Ue=>N(Ue.target.value)}):i.jsx("div",{className:"font-semibold",children:ze.category})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Und x paquete"}),Ke?i.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-1 text-right",value:T,onChange:Ue=>P(C0(Ue.target.value,1))}):i.jsx("div",{className:"font-semibold text-right tabular-nums",children:ze.unitsPerPackage})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Empaque"}),Ke?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:ce,onChange:Ue=>le(Ue.target.value),children:[i.jsx("option",{value:"",children:"Seleccionar"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):i.jsx("div",{className:"font-semibold",children:ze.packaging||""})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Precio proveedor"}),Ke?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-1 text-right",value:Number.isNaN(B)?"":B,onChange:Ue=>k(Math.max(0,Qh(Ue.target.value,0)))}):i.jsx("div",{className:"font-semibold tabular-nums",children:cT(ze.providerPrice)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Cdigo"}),Ke?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-1",value:q,onChange:Ue=>de(Ue.target.value),placeholder:"EAN/UPC"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{ve("edit"),V(!0)},children:"Escanear"})]}):ne?i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200",onClick:()=>{Y(String(ze.barcode||"").trim()),M(!0)},children:"Ver cdigo"}):i.jsx("div",{className:"text-gray-600",children:"No"})]})]}),i.jsx("div",{className:"pt-2 flex gap-2",children:Ke?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-blue-600 text-white",onClick:st,type:"button",children:"Guardar"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{ve("edit"),V(!0)},type:"button",children:"Escanear"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-gray-200",onClick:ct,type:"button",children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-yellow-400",onClick:()=>ut(ze),type:"button",children:"Editar"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-red-600 text-white",onClick:()=>z(ze),type:"button",children:"Borrar"})]})})]})})]},ze.id)})})]},xe.category)})}),!r&&rt.length>0&&Ft()]}):i.jsxs("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:[i.jsxs("table",{className:"min-w-[1050px] w-full text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-left",children:"Empaque"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Und x paquete"}),i.jsx("th",{className:"p-2 border text-center",children:"Cdigo"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):rt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin productos."})}):me.map(xe=>{const Ge=w===xe.id,ze=!!String(xe.barcode||"").trim();return i.jsxs("tr",{className:"align-top",children:[i.jsx("td",{className:"p-2 border",children:Ge?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:j,onChange:Ke=>N(Ke.target.value)}):xe.category}),i.jsx("td",{className:"p-2 border",children:Ge?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:S,onChange:Ke=>E(Ke.target.value)}):xe.name}),i.jsx("td",{className:"p-2 border",children:Ge?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:ce,onChange:Ke=>le(Ke.target.value),children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):xe.packaging||""}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ge?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border rounded px-2 py-1 text-right",value:Number.isNaN(B)?"":B,onChange:Ke=>k(Math.max(0,Qh(Ke.target.value,0)))}):cT(xe.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ge?i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:T,onChange:Ke=>P(C0(Ke.target.value,1))}):xe.unitsPerPackage}),i.jsx("td",{className:"p-2 border text-center",children:Ge?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("input",{className:"w-44 border rounded px-2 py-1",value:q,onChange:Ke=>de(Ke.target.value),placeholder:"EAN/UPC"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-800 text-white hover:bg-black",onClick:()=>{ve("edit"),V(!0)},children:"Escanear"})]}):ze?i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200",onClick:()=>{Y(String(xe.barcode||"").trim()),M(!0)},children:"S"}):i.jsx("span",{className:"px-2 py-1 rounded bg-gray-100 text-gray-600",children:"No"})}),i.jsx("td",{className:"p-2 border",children:Ge?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:st,type:"button",children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:ct,type:"button",children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 hover:bg-yellow-500",onClick:()=>ut(xe),type:"button",children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>z(xe),type:"button",children:"Borrar"})]})})]},xe.id)})})]}),!r&&rt.length>0&&Ft()]}),a?_t&&a===" Producto guardado."?i.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[i.jsx("div",{className:"flex-1 text-sm",children:a}),i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white",onClick:()=>{s(""),ct(),V(!1)},children:"Aceptar"})]}):i.jsx("p",{className:"mt-2 text-sm",children:a}):null,i.jsx(VQe,{open:G,code:K,onClose:()=>M(!1)}),i.jsx(HQe,{open:D,onClose:()=>V(!1),onDetected:async xe=>{const Ge=String(xe||"").trim();if(Ge){if(te==="edit"&&w){if(o.some(Ke=>Ke.id!==w&&String(Ke.barcode||"")===Ge)){s(" Ya existe otro producto con ese cdigo de barras."),de(Ge),V(!1);return}try{await Mn(Kt(Ne,"products_candies",w),{barcode:Ge}),l(Ke=>Ke.map(pt=>pt.id===w?{...pt,barcode:Ge}:pt)),de(Ge),_t&&s(" Producto guardado.")}catch(Ke){console.error(Ke),s(" Error guardando cdigo de barras.")}finally{V(!1)}return}if(te==="search"){De(Ge),V(!1);return}te==="create"?v(xe):de(xe)}}}),Q&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white w-full max-w-6xl max-h-[90vh] overflow-y-auto rounded shadow-lg p-5 text-sm",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Importar productos (.xlsx / .csv)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Xe(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:[i.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-end md:justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"1) Sub tu archivo"}),i.jsx("div",{className:"text-xs text-gray-600",children:"Columnas esperadas (flexible): Id (opcional), Categoria, Producto/Nombre, PrecioProveedor, UnidadesPorPaquete, Empaque (opcional), Codigo (opcional)."})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:X,type:"button",children:"Descargar template .xlsx"})]}),i.jsxs("div",{className:"mt-3 flex flex-col md:flex-row gap-3 md:items-center",children:[i.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:xe=>{var Ge;return H(((Ge=xe.target.files)==null?void 0:Ge[0])||null)}}),se&&i.jsxs("span",{className:"text-xs text-gray-600",children:["Archivo: ",i.jsx("b",{children:se})]}),ot&&i.jsx("span",{className:"text-xs",children:"Procesando"})]})]}),Ee.length>0&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3 mb-3",children:[i.jsx("div",{className:"font-semibold text-red-700 mb-2",children:"Errores encontrados"}),i.jsx("ul",{className:"list-disc pl-5 text-red-700 text-xs space-y-1",children:Ee.slice(0,50).map((xe,Ge)=>i.jsx("li",{children:xe},Ge))})]}),i.jsxs("div",{className:"bg-white border rounded p-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"2) Previsualizacin (editable)"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Se importarn ",Pe.total," filas (Crear:"," ",Pe.willCreate," / Actualizar:"," ",Pe.willUpdate,")"]})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50",onClick:ue,disabled:ot||ke.length===0||Ee.length>0,type:"button",children:"Importar a Firestore"})]}),i.jsxs("div",{className:"overflow-x-auto border rounded",children:[i.jsxs("table",{className:"min-w-[1250px] w-full text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Id (opcional)"}),i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Und x paquete"}),i.jsx("th",{className:"p-2 border text-left",children:"Empaque (opcional)"}),i.jsx("th",{className:"p-2 border text-left",children:"Codigo (opcional)"}),i.jsx("th",{className:"p-2 border text-center",children:"Accin"})]})}),i.jsx("tbody",{children:ke.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Sub un archivo para ver la previsualizacin."})}):ke.slice(0,300).map((xe,Ge)=>{const ze=xe.id?o.some(Ue=>Ue.id===xe.id):!1,Ke=o.some(Ue=>`${ws(Ue.category)}::${ws(Ue.name)}`==`${ws(xe.category)}::${ws(xe.name)}`),pt=xe.barcode?o.some(Ue=>String(Ue.barcode||"")===xe.barcode):!1,ne=ze||Ke||pt;return i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:xe.id||"",onChange:Ue=>L(Ge,{id:Ue.target.value.trim()||void 0}),placeholder:"docId (si quers update exacto)"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:xe.category,onChange:Ue=>L(Ge,{category:Ue.target.value}),list:"categories-list"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-72 border rounded px-2 py-1",value:xe.name,onChange:Ue=>L(Ge,{name:Ue.target.value})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border rounded px-2 py-1 text-right",value:Number.isNaN(xe.providerPrice)?"":xe.providerPrice,onChange:Ue=>L(Ge,{providerPrice:Math.max(0,Qh(Ue.target.value,0))})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:xe.unitsPerPackage,onChange:Ue=>L(Ge,{unitsPerPackage:C0(Ue.target.value,1)})})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:xe.packaging||"",onChange:Ue=>L(Ge,{packaging:Ue.target.value.trim()||void 0}),placeholder:"Tarro, Bolsa..."})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:xe.barcode||"",onChange:Ue=>L(Ge,{barcode:Ue.target.value.trim()||void 0}),placeholder:"EAN/UPC (opcional)"})}),i.jsx("td",{className:"p-2 border text-center",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] ${ne?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:ne?"ACTUALIZA":"CREA"})})]},`${xe.id||""}-${Ge}`)})})]}),i.jsx("datalist",{id:"categories-list",children:be.map(xe=>i.jsx("option",{value:xe},xe))})]}),ke.length>300&&i.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:["Mostrando 300 de ",ke.length," filas (el import importa todas)."]})]})]})})]})}function Jse(t){const e=Math.max(1,Math.floor(Number(t.unitsPerPackage||1))),r=Number(t.totalUnits||0),n=Number(t.quantity||0),a=Number(t.packages||0);return r>0?Math.floor(r):n>0?Math.floor(n):a>0?Math.floor(a*e):0}function dT(t){const e=Number(t.remaining);return Number.isFinite(e)&&e>0?Math.floor(e):Jse(t)}const Zse=t=>Math.max(0,Math.floor(Number(t??0)));function GQe(t){return Zse(t.packages??t.totalPackages??t.packs??t.packagesInitial??t.initialPackages??0)}function KQe(t){return Zse(t.remainingPackages??t.remainingPacks??t.packsRemaining??t.packagesRemaining??t.remaining_packages??0)}async function SF(t){const e=String(t||"").trim();if(!e)return{created:0,skipped:0,updated:0,totalItems:0};let r=Kt(Ne,"candy_main_orders",e),n=await Es(r);if(!n.exists()){const p=ar(xt(Ne,"candy_main_orders"),lr("orderId","==",e)),x=await Ut(p);if(x.empty)throw new Error("Orden maestra no existe");r=x.docs[0].ref,n=x.docs[0]}const a=n.data(),s=r.id,o=Array.isArray(a.items)?a.items:[];if(!o.length)return{created:0,skipped:0,updated:0,totalItems:0};const l=await Ut(ar(xt(Ne,"inventory_candies"),lr("orderId","==",s))),c=new Set,d=new Map;l.forEach(p=>{const x=p.data(),v=String(x.productId||"").trim();if(v&&c.add(v),!v)return;const y=d.get(v)||[];y.push({ref:p.ref,data:x}),d.set(v,y)});const u=Lc(Ne);let f=0,A=0,h=0;const m=String(a.date||"");for(const p of o){const x=String(p.id||p.productId||"").trim();if(!x)continue;const v=d.get(x)||[];if(v.length>0){if(v.length===1&&v.every(k=>{const T=Math.max(0,Math.floor(Number(k.data.remainingPackages||0))),P=Math.max(0,Math.floor(Number(k.data.remaining||0))),q=Math.max(0,Math.floor(Number(k.data.totalUnits||0)));return T<=0&&P<=0&&q<=0})){const k=v[0].ref,T=Math.max(1,Math.floor(Number(p.unitsPerPackage??p.units_per_package??p.upp??1))),P=Number(p.packages??p.totalPackages??p.packagesInitial??p.initialPackages??0),q=Number(p.remainingPackages??p.remainingPacks??p.packagesRemaining??0);let de=Math.max(0,Math.floor(P||0)),ce=Math.max(0,Math.floor(q||0));de<=0&&ce>0&&(de=ce),ce<=0&&(ce=de);const le=de*T,he=ce*T;u.update(k,{productId:x,productName:String(p.name||p.productName||""),category:String(p.category||""),measurement:"unidad",quantity:le,remaining:he,packages:de,remainingPackages:ce,unitsPerPackage:T,totalUnits:le,providerPrice:Number(p.providerPrice??p.provider_price??p.priceProvider??p.costProvider??0),subtotal:Number(p.subtotal||0),totalRivas:Number(p.totalRivas||0),totalSanJorge:Number(p.totalSanJorge||0),totalIsla:Number(p.totalIsla||0),gainRivas:Number(p.gainRivas||0),gainSanJorge:Number(p.gainSanJorge||0),gainIsla:Number(p.gainIsla||0),unitPriceRivas:Number(p.unitPriceRivas||0),unitPriceSanJorge:Number(p.unitPriceSanJorge||0),unitPriceIsla:Number(p.unitPriceIsla||0),date:m,status:"PENDIENTE",orderId:s,updatedAt:Nr.now()}),h+=1;continue}A+=1;continue}const y=Math.max(1,Math.floor(Number(p.unitsPerPackage??p.units_per_package??p.upp??1))),b=Number(p.packages??p.totalPackages??p.packagesInitial??p.initialPackages??0),w=Number(p.remainingPackages??p.remainingPacks??p.packagesRemaining??0);let I=Math.max(0,Math.floor(b||0)),j=Math.max(0,Math.floor(w||0));I<=0&&j>0&&(I=j),j<=0&&(j=I);const N=I*y,S=j*y,E=Kt(xt(Ne,"inventory_candies"));u.set(E,{productId:x,productName:String(p.name||p.productName||""),category:String(p.category||""),measurement:"unidad",quantity:N,remaining:S,packages:I,remainingPackages:j,unitsPerPackage:y,totalUnits:N,providerPrice:Number(p.providerPrice??p.provider_price??p.priceProvider??p.costProvider??0),subtotal:Number(p.subtotal||0),totalRivas:Number(p.totalRivas||0),totalSanJorge:Number(p.totalSanJorge||0),totalIsla:Number(p.totalIsla||0),gainRivas:Number(p.gainRivas||0),gainSanJorge:Number(p.gainSanJorge||0),gainIsla:Number(p.gainIsla||0),unitPriceRivas:Number(p.unitPriceRivas||0),unitPriceSanJorge:Number(p.unitPriceSanJorge||0),unitPriceIsla:Number(p.unitPriceIsla||0),date:m,createdAt:Nr.now(),status:"PENDIENTE",orderId:s}),f+=1}return(f>0||h>0)&&await u.commit(),{created:f,skipped:A,updated:h,totalItems:o.length}}async function qQe(t){const e=Kt(Ne,"candy_main_orders",t);if((await Es(e)).exists())return e;const n=ar(xt(Ne,"candy_main_orders"),lr("orderId","==",t)),a=await Ut(n);return a.empty?null:Kt(Ne,"candy_main_orders",a.docs[0].id)}async function uT(t){if(!t)return;const e=await qQe(t);if(!e)return;const r=ar(xt(Ne,"inventory_candies"),lr("orderId","==",t)),n=await Ut(r),a=new Map;n.forEach(l=>{const c=l.data(),d=String(c.productId||"");if(!d)return;const u=GQe(c),f=KQe(c),A=Math.max(1,Math.floor(Number(c.unitsPerPackage||1))),h=Number(c.providerPrice||0),m=Number(c.unitPriceRivas||0),p=Number(c.unitPriceSanJorge||0),x=Number(c.unitPriceIsla||0),v=h*u,y=m*u,b=p*u,w=x*u,I=y-v,j=b-v,N=w-v;a.has(d)||a.set(d,{productId:d,name:String(c.productName||""),category:String(c.category||""),unitsPerPackage:A,providerPrice:h,marginRivas:typeof c.marginRivas=="number"?Number(c.marginRivas):void 0,marginSanJorge:typeof c.marginSanJorge=="number"?Number(c.marginSanJorge):void 0,marginIsla:typeof c.marginIsla=="number"?Number(c.marginIsla):void 0,packages:0,remainingPackages:0,subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0,unitPriceRivas:m||0,unitPriceSanJorge:p||0,unitPriceIsla:x||0,gainRivas:0,gainSanJorge:0,gainIsla:0});const S=a.get(d);S.packages+=u,S.remainingPackages+=f,S.subtotal+=v,S.totalRivas+=y,S.totalSanJorge+=b,S.totalIsla+=w,S.gainRivas+=I,S.gainSanJorge+=j,S.gainIsla+=N,S.providerPrice=h,S.unitPriceRivas=m||S.unitPriceRivas,S.unitPriceSanJorge=p||S.unitPriceSanJorge,S.unitPriceIsla=x||S.unitPriceIsla,S.unitsPerPackage=A||S.unitsPerPackage,S.name=String(c.productName||S.name),S.category=String(c.category||S.category)});const s=Array.from(a.values()).map(l=>({id:l.productId,name:l.name,category:l.category,providerPrice:l.providerPrice,unitsPerPackage:l.unitsPerPackage,packages:l.packages,remainingPackages:l.remainingPackages,marginRivas:l.marginRivas??void 0,marginSanJorge:l.marginSanJorge??void 0,marginIsla:l.marginIsla??void 0,subtotal:l.subtotal,totalRivas:l.totalRivas,totalSanJorge:l.totalSanJorge,totalIsla:l.totalIsla,unitPriceRivas:l.unitPriceRivas,unitPriceSanJorge:l.unitPriceSanJorge,unitPriceIsla:l.unitPriceIsla,gainRivas:l.gainRivas,gainSanJorge:l.gainSanJorge,gainIsla:l.gainIsla})),o=s.reduce((l,c)=>l+Number(c.packages||0),0);await Mn(e,{totalPackages:o,items:s})}function zQe(t){const e=t==null?void 0:t.allocationsByItem;if(!e)return null;const r=[];if(Array.isArray(e))for(const n of e){const a=Array.isArray(n==null?void 0:n.allocations)?n.allocations:[];for(const s of a){const o=String(s.inventorySellerId||""),l=Math.max(0,Math.floor(Number(s.units??s.qty??s.quantity??0)));!o||l<=0||r.push({inventorySellerId:o,units:l})}}else if(typeof e=="object")for(const n of Object.keys(e)){const a=e[n],s=Array.isArray(a==null?void 0:a.allocations)?a.allocations:[];for(const o of s){const l=String(o.inventorySellerId||""),c=Math.max(0,Math.floor(Number(o.units??o.qty??o.quantity??0)));!l||c<=0||r.push({inventorySellerId:l,units:c})}}return r.length?{allocations:r}:null}async function Y2(t){const e=t.split("#")[0],r=Kt(Ne,"sales_candies",e),n=await Es(r);if(!n.exists())throw new Error("La venta no existe.");const a=n.data(),s=zQe(a);if(s&&s.allocations.length>0){let d=0;return await fi(Ne,async u=>{const f={};for(const p of s.allocations){const x=p.inventorySellerId,v=Math.max(0,Math.floor(Number(p.units||0)));!x||v<=0||(f[x]=(f[x]||0)+v,d+=v)}const h=Object.keys(f).map(p=>Kt(Ne,"inventory_candies_sellers",p)),m=await Promise.all(h.map(p=>u.get(p)));for(let p=0;p<h.length;p++){const x=m[p];if(!x.exists())continue;const v=x.data(),y=Number(v.remainingUnits??v.remaining??0),b=Math.max(0,Math.floor(Number(f[h[p].id]||0))),w=y+b,I=Math.max(1,Math.floor(Number(v.unitsPerPackage||1))),j=Math.floor(w/I);u.update(h[p],{remainingUnits:w,remainingPackages:j})}u.delete(r)}),{restored:d}}const o=[];if(Array.isArray(a.items)&&a.items.length>0){const d={};if(a.allocationsByItem&&typeof a.allocationsByItem=="object")for(const u of Object.keys(a.allocationsByItem)){const f=a.allocationsByItem[u],A=String((f==null?void 0:f.productId)||u||"");if(!A)continue;const h=Array.isArray(f==null?void 0:f.allocations)?f.allocations:[];d[A]=h.map(m=>({batchId:String(m.batchId),qty:Math.max(0,Math.floor(Number(m.qty||m.quantity||0)))}))}if(Array.isArray(a.allocationsByItem))for(const u of a.allocationsByItem){const f=String((u==null?void 0:u.productId)||"");if(!f)continue;const A=Array.isArray(u==null?void 0:u.allocations)?u.allocations:[];d[f]=A.map(h=>({batchId:String(h.batchId),qty:Math.max(0,Math.floor(Number(h.qty||h.quantity||0)))}))}for(const u of a.items){const f=String((u==null?void 0:u.productId)||"");if(!f)continue;const A=Math.max(0,Math.floor(Number((u==null?void 0:u.qty)||(u==null?void 0:u.quantity)||0))),h=Array.isArray(u==null?void 0:u.allocations)?u.allocations.map(m=>({batchId:String(m.batchId),qty:Math.max(0,Math.floor(Number(m.qty||m.quantity||0)))})):d[f]||[];o.push({productId:f,productName:String((u==null?void 0:u.productName)||""),qty:A,allocations:h.length?h:void 0})}}else{const d=a.item||{},u=String(d.productId||a.productId||""),f=Math.max(0,Math.floor(Number(d.qty??a.quantity??0))),A=Array.isArray(a.allocations)?a.allocations.map(h=>({batchId:String(h.batchId),qty:Math.max(0,Math.floor(Number(h.qty||h.quantity||0)))})):[];u&&f>0&&o.push({productId:u,productName:String(d.productName||a.productName||""),qty:f,allocations:A.length?A:void 0})}if(o.length===0)return await fi(Ne,async d=>{d.delete(r)}),{restored:0};if(o.every(d=>Array.isArray(d.allocations)&&d.allocations.length>0)){let d=0;return await fi(Ne,async u=>{const f=[];for(const h of o)for(const m of h.allocations||[]){const p=Math.max(0,Math.floor(Number(m.qty||0)));d+=p,f.push({ref:Kt(Ne,"inventory_candies",m.batchId),addBack:p})}const A=await Promise.all(f.map(h=>u.get(h.ref)));for(let h=0;h<f.length;h++){const m=A[h];if(!m.exists())continue;const p=m.data(),x=dT(p),v=Math.max(0,Math.floor(Number(f[h].addBack||0))),y=x+v,b=Math.max(1,Math.floor(Number(p.unitsPerPackage||1))),w=Math.floor(y/b);u.update(f[h].ref,{remaining:y,remainingPackages:w,packages:w})}u.delete(r)}),{restored:d}}let c=0;return await fi(Ne,async d=>{const u={};for(const p of o){if(!p.productId||p.qty<=0)continue;const x=ar(xt(Ne,"inventory_candies"),lr("productId","==",p.productId)),y=(await Ut(x)).docs.map(b=>{const w=b.data(),I=Jse(w),j=dT(w);return{id:b.id,date:String(w.date||""),baseUnits:I,remaining:j}}).sort((b,w)=>b.date.localeCompare(w.date));u[p.productId]=y}const f=[];for(const p of o){if(!p.productId||p.qty<=0)continue;if(Array.isArray(p.allocations)&&p.allocations.length>0){for(const y of p.allocations){const b=Math.max(0,Math.floor(Number(y.qty||0)));c+=b,f.push({id:y.batchId,addBack:b})}continue}const x=u[p.productId]||[];let v=p.qty;for(const y of x){if(v<=0)break;const b=Math.max(0,y.baseUnits-y.remaining);if(b<=0)continue;const w=Math.min(b,v);f.push({id:y.id,addBack:w}),c+=w,v-=w}for(const y of x){if(v<=0)break;const b=Math.min(v,p.qty);f.push({id:y.id,addBack:b}),c+=b,v-=b}}const A={};for(const p of f)A[p.id]=(A[p.id]||0)+Math.max(0,Math.floor(Number(p.addBack||0)));const h=Object.keys(A).map(p=>Kt(Ne,"inventory_candies",p)),m=await Promise.all(h.map(p=>d.get(p)));for(let p=0;p<h.length;p++){const x=m[p];if(!x.exists())continue;const v=x.data(),y=dT(v),b=Math.max(0,Math.floor(Number(A[h[p].id]||0))),w=y+b,I=Math.max(1,Math.floor(Number(v.unitsPerPackage||1))),j=Math.floor(w/I);d.update(h[p],{remaining:w,remainingPackages:j,packages:j})}d.delete(r)}),{restored:c}}async function WQe(t){return Y2(t)}const Pc=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function fT(t){return isFinite(t)?Math.round(t):0}function sf(t){return t.unitsPerPackage>0&&t.totalUnits>0?Math.floor(t.totalUnits/t.unitsPerPackage):Math.max(0,Math.floor(Number(t.packages||0)))}function hT(t){return typeof t.remainingPackages=="number"&&isFinite(t.remainingPackages)?Math.max(0,Math.floor(t.remainingPackages)):t.unitsPerPackage>0?Math.max(0,Math.floor(Number(t.remaining||0)/t.unitsPerPackage)):0}function XQe(t,e){var o,l;const r=String(t.date||""),n=String(e.date||"");if(r!==n)return n.localeCompare(r);const a=((o=t.createdAt)==null?void 0:o.seconds)??0;return(((l=e.createdAt)==null?void 0:l.seconds)??0)-a}function YQe(){const[t,e]=g.useState([]),[r,n]=g.useState([]),[a,s]=g.useState(!0),[o,l]=g.useState(""),[c,d]=g.useState(Kr(Gu(new Date),"yyyy-MM-dd")),[u,f]=g.useState(Kr($u(new Date),"yyyy-MM-dd")),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(null),[y,b]=g.useState(""),[w,I]=g.useState(0),[j,N]=g.useState(!1),[S,E]=g.useState(""),[B,k]=g.useState(""),[T,P]=g.useState([]);g.useEffect(()=>{(async()=>{try{s(!0);const K=await Ut(xt(Ne,"products_candies")),Y=[];K.forEach(ve=>{const Q=ve.data();Y.push({id:ve.id,name:Q.name??"(sin nombre)",category:Q.category??"(sin categora)"})}),e(Y);const D=ar(xt(Ne,"inventory_candies"),kn("date","desc")),V=await Ut(D),te=[];V.forEach(ve=>{const Q=ve.data(),Xe=Number(Q.unitsPerPackage||0),se=Number(Q.totalUnits??Q.quantity??(Q.packages||0)*(Q.unitsPerPackage||0)),Z=Number(Q.remaining??Q.totalUnits??se??0);te.push({id:ve.id,productId:Q.productId,productName:Q.productName,category:Q.category,measurement:Q.measurement??"unidad",packages:Number(Q.packages||0),unitsPerPackage:Xe,totalUnits:se,remaining:Z,remainingPackages:typeof Q.remainingPackages=="number"?Number(Q.remainingPackages):void 0,providerPrice:Number(Q.providerPrice||0),subtotal:Number(Q.subtotal||0),totalRivas:Number(Q.totalRivas||0),totalSanJorge:Number(Q.totalSanJorge||0),totalIsla:Number(Q.totalIsla||0),gainRivas:Number(Q.gainRivas||0),gainSanJorge:Number(Q.gainSanJorge||0),gainIsla:Number(Q.gainIsla||0),unitPriceRivas:Number(Q.unitPriceRivas||0),unitPriceSanJorge:Number(Q.unitPriceSanJorge||0),unitPriceIsla:Number(Q.unitPriceIsla||0),date:Q.date,createdAt:Q.createdAt,status:Q.status??"PENDIENTE",orderId:Q.orderId??null})}),n(te)}catch(K){console.error(K),l(" Error cargando inventario.")}finally{s(!1)}})()},[]);const q=g.useMemo(()=>r.filter(K=>!(c&&K.date<c||u&&K.date>u||A&&K.productId!==A||m&&String(K.category||"")!==m)),[r,c,u,A,m]),de=g.useMemo(()=>{const K=new Set;for(const Y of t)Y.category&&K.add(Y.category);return Array.from(K).sort((Y,D)=>Y.localeCompare(D))},[t]),ce=g.useMemo(()=>{const K=q.reduce((Q,Xe)=>Q+sf(Xe),0),Y=q.reduce((Q,Xe)=>Q+hT(Xe),0),D=q.reduce((Q,Xe)=>{const se=sf(Xe);return Q+Number(Xe.providerPrice||0)*se},0),V=q.reduce((Q,Xe)=>{const se=sf(Xe);return Q+Number(Xe.unitPriceRivas||0)*se},0),te=q.reduce((Q,Xe)=>{const se=sf(Xe);return Q+Number(Xe.unitPriceSanJorge||0)*se},0),ve=q.reduce((Q,Xe)=>{const se=sf(Xe);return Q+Number(Xe.unitPriceIsla||0)*se},0);return{totalPaquetes:K,totalPaquetesRestantes:Y,totalSubtotal:D,totalRivas:V,totalSJ:te,totalIsla:ve}},[q]),le=g.useMemo(()=>{let K=0,Y=0;for(const D of q)D.status==="PENDIENTE"&&(K+=1),D.status==="PAGADO"&&(Y+=1);return{totalLotes:q.length,pendientes:K,pagados:Y}},[q]),he=g.useMemo(()=>{const K=new Map;for(const D of q){const V=String(D.productId||"");V&&(K.has(V)||K.set(V,{batches:[]}),K.get(V).batches.push(D))}const Y=[];for(const[D,V]of K.entries()){const te=[...V.batches].sort(XQe),ve=te[0],Q=te.reduce((Lt,Rt)=>Lt+sf(Rt),0),Xe=te.reduce((Lt,Rt)=>Lt+hT(Rt),0),se=Number((ve==null?void 0:ve.providerPrice)||0),Z=Number((ve==null?void 0:ve.unitPriceRivas)||0),ke=Number((ve==null?void 0:ve.unitPriceIsla)||0),Se=te.reduce((Lt,Rt)=>{const Et=sf(Rt);return Lt+Number(Rt.providerPrice||0)*Et},0),Ee=te.reduce((Lt,Rt)=>{const Et=sf(Rt);return Lt+Number(Rt.unitPriceRivas||0)*Et},0),Ze=te.reduce((Lt,Rt)=>{const Et=sf(Rt);return Lt+Number(Rt.unitPriceIsla||0)*Et},0),ot=Ee-Se,vt=Ze-Se;let _t="",Tt;for(const Lt of te)(!_t||String(Lt.date||"")>_t)&&(_t=String(Lt.date||""),Tt=Lt.createdAt);Y.push({productId:D,productName:(ve==null?void 0:ve.productName)||"",category:(ve==null?void 0:ve.category)||"",totalPackages:Q,remainingPackages:Xe,providerPrice:se,unitPriceRivas:Z,unitPriceIsla:ke,subtotal:Se,totalRivas:Ee,totalIsla:Ze,gainRivas:ot,gainIsla:vt,lastDate:_t,lastCreatedAt:Tt,batchCount:te.length})}return Y.sort((D,V)=>String(V.lastDate).localeCompare(String(D.lastDate))),Y},[q]),ae=K=>{v(K.id),b(K.date),I(K.providerPrice),l("")},Ce=()=>{v(null),b(""),I(0)},De=async()=>{if(!x)return;const K=r.find(Ze=>Ze.id===x);if(!K)return;if(w<0){l("El precio proveedor no puede ser negativo.");return}const Y=sf(K),D=w*Y,V=Y>0?D/.8:0,te=Y>0?D/.85:0,ve=Y>0?D/.7:0,Q=V-D,Xe=te-D,se=ve-D,Z=Y>0?fT(V/Y):0,ke=Y>0?fT(te/Y):0,Se=Y>0?fT(ve/Y):0,Ee=Kt(Ne,"inventory_candies",x);await Mn(Ee,{date:y,providerPrice:w,subtotal:D,totalRivas:V,totalSanJorge:te,totalIsla:ve,gainRivas:Q,gainSanJorge:Xe,gainIsla:se,unitPriceRivas:Z,unitPriceSanJorge:ke,unitPriceIsla:Se}),n(Ze=>Ze.map(ot=>ot.id===x?{...ot,date:y,providerPrice:w,subtotal:D,totalRivas:V,totalSanJorge:te,totalIsla:ve,gainRivas:Q,gainSanJorge:Xe,gainIsla:se,unitPriceRivas:Z,unitPriceSanJorge:ke,unitPriceIsla:Se}:ot)),K.orderId&&await uT(String(K.orderId)),l(" Lote de dulces actualizado"),Ce()},O=async K=>{confirm(`Marcar PAGADO el lote del ${K.date} (${K.productName})?`)&&(await Mn(Kt(Ne,"inventory_candies",K.id),{status:"PAGADO"}),n(D=>D.map(V=>V.id===K.id?{...V,status:"PAGADO"}:V)),l(" Lote marcado como pagado"))},R=async K=>{confirm(`Eliminar el lote del ${K.date} (${K.productName})?`)&&(await na(Kt(Ne,"inventory_candies",K.id)),n(D=>D.filter(V=>V.id!==K.id)),K.orderId&&await uT(String(K.orderId)),l(" Lote eliminado"))},G=async(K,Y)=>{try{s(!0),l("");const D=ar(xt(Ne,"inventory_candies"),lr("productId","==",K),kn("date","desc")),V=await Ut(D),te=[];V.forEach(ve=>{const Q=ve.data(),Xe=Number(Q.unitsPerPackage||0),se=Number(Q.totalUnits??Q.quantity??(Q.packages||0)*(Q.unitsPerPackage||0)),Z=Number(Q.remaining??Q.totalUnits??se??0);te.push({id:ve.id,productId:Q.productId,productName:Q.productName,category:Q.category,measurement:Q.measurement??"unidad",packages:Number(Q.packages||0),unitsPerPackage:Xe,totalUnits:se,remaining:Z,remainingPackages:typeof Q.remainingPackages=="number"?Number(Q.remainingPackages):void 0,providerPrice:Number(Q.providerPrice||0),subtotal:Number(Q.subtotal||0),totalRivas:Number(Q.totalRivas||0),totalSanJorge:Number(Q.totalSanJorge||0),totalIsla:Number(Q.totalIsla||0),gainRivas:Number(Q.gainRivas||0),gainSanJorge:Number(Q.gainSanJorge||0),gainIsla:Number(Q.gainIsla||0),unitPriceRivas:Number(Q.unitPriceRivas||0),unitPriceSanJorge:Number(Q.unitPriceSanJorge||0),unitPriceIsla:Number(Q.unitPriceIsla||0),date:Q.date,createdAt:Q.createdAt,status:Q.status??"PENDIENTE",orderId:Q.orderId??null})}),E(K),k(Y),P(te),N(!0)}catch(D){console.error(D),l(" Error abriendo detalle del producto.")}finally{s(!1)}},M=async(K,Y)=>{const D=r.filter(te=>te.productId===K);if(confirm(`Eliminar COMPLETAMENTE "${Y}"?
Esto eliminar ${D.length} lote(s) de este producto.`))try{s(!0),l("");const te=Array.from(new Set(D.map(ve=>ve.orderId?String(ve.orderId):"").filter(Boolean)));for(const ve of D)await na(Kt(Ne,"inventory_candies",ve.id));n(ve=>ve.filter(Q=>Q.productId!==K)),l(" Producto eliminado (todos sus lotes).");for(const ve of te)await uT(ve);j&&S===K&&(N(!1),P([]),E(""),k(""))}catch(te){console.error(te),l(" Error eliminando lotes del producto.")}finally{s(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario Productos"})}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:K=>d(K.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:K=>f(K.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[220px]",children:[i.jsx("label",{className:"font-semibold",children:"Categora"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:m,onChange:K=>p(K.target.value),children:[i.jsx("option",{value:"",children:"Todas"}),de.map(K=>i.jsx("option",{value:K,children:K},K))]})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:K=>h(K.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),t.map(K=>i.jsxs("option",{value:K.id,children:[K.name,"  ",K.category]},K.id))]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{d(""),f(""),h(""),p("")},children:"Quitar filtro"})]}),i.jsx("div",{className:"bg-gray-50 p-2 rounded shadow border mb-2 text-xs md:text-sm",children:i.jsxs("div",{className:"flex flex-wrap gap-x-6 gap-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes totales:"})," ",le.totalLotes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes pendientes:"})," ",le.pendientes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes pagados:"})," ",le.pagados]})]})}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-sm md:text-base",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-y-1 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes ingresados:"})," ",ce.totalPaquetes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes restantes:"})," ",ce.totalPaquetesRestantes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Sub total:"})," ",Pc(ce.totalSubtotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Rivas:"})," ",Pc(ce.totalRivas)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total San Jorge:"})," ",Pc(ce.totalSJ)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Isla:"})," ",Pc(ce.totalIsla)]})]})}),i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] table-auto text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio venta Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio venta Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Subtotal"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Total Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Ganancia bruta Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Ganancia bruta Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"ltima fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-center",children:"Opciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:14,className:"p-4 text-center",children:"Cargando"})}):he.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:14,className:"p-4 text-center",children:"Sin productos"})}):he.map(K=>i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 border",children:K.category||""}),i.jsxs("td",{className:"p-2 border max-w-[260px]",children:[i.jsx("span",{className:"block truncate",title:K.productName,children:K.productName}),i.jsxs("span",{className:"text-[10px] text-gray-500",children:["Lotes: ",K.batchCount]})]}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:K.totalPackages}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:K.remainingPackages}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Pc(K.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Pc(K.unitPriceRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Pc(K.unitPriceIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Pc(K.subtotal)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Pc(K.totalRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Pc(K.totalIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Pc(K.gainRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Pc(K.gainIsla)}),i.jsx("td",{className:"p-2 border",children:K.lastDate||""}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-1 justify-center flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>G(K.productId,K.productName),children:"Detalle"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>M(K.productId,K.productName),children:"Borrar"})]})})]},K.productId))})]})})}),o&&i.jsx("p",{className:"mt-2 text-sm",children:o}),j&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-4 rounded shadow-lg w-full max-w-6xl max-h-[90vh] overflow-y-auto text-sm",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold",children:"Detalle del producto"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[i.jsx("span",{className:"font-semibold",children:"Producto:"})," ",B||""," ",i.jsxs("span",{className:"ml-2",children:[i.jsx("span",{className:"font-semibold",children:"ID:"})," ",S]})]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{N(!1),P([]),E(""),k(""),Ce()},children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] table-auto text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border text-left",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes ingresados"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border text-right",children:"Unidades"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio venta Rivas"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio venta Isla"}),i.jsx("th",{className:"p-2 border",children:"Nmero orden"}),i.jsx("th",{className:"p-2 border",children:"Status"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:T.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center text-gray-500",children:"Sin lotes"})}):T.map(K=>{const Y=x===K.id,D=sf(K),V=hT(K);return i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 border align-top",children:Y?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:y,onChange:te=>b(te.target.value)}):K.date}),i.jsx("td",{className:"p-2 border align-top",children:K.category||""}),i.jsxs("td",{className:"p-2 border align-top max-w-[260px]",children:[i.jsx("span",{className:"block truncate",title:K.productName,children:K.productName}),i.jsxs("span",{className:"text-[10px] text-gray-500",children:["Lote ID: ",K.id]})]}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:D}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:V}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:K.totalUnits}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:Y?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(w)?"":w,onChange:te=>I(Math.max(0,parseFloat(te.target.value||"0")))}):Pc(K.providerPrice)}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:Pc(K.unitPriceRivas)}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:Pc(K.unitPriceIsla)}),i.jsx("td",{className:"p-2 border align-top",children:K.orderId?String(K.orderId):""}),i.jsx("td",{className:"p-2 border align-top",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] md:text-xs ${K.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:K.status})}),i.jsx("td",{className:"p-2 border align-top",children:Y?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:De,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Ce,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-1 justify-center flex-wrap",children:[K.status==="PENDIENTE"&&i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:()=>O(K),children:"Pagar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 text-black hover:bg-yellow-500 text-xs",onClick:()=>ae(K),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>R(K),children:"Borrar"})]})})]},K.id)})})]})}),i.jsx("div",{className:"mt-3 flex justify-end",children:i.jsx("button",{className:"px-3 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>M(S,B),children:"Borrar producto (todos los lotes)"})})]})})]})}const AT=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],rl=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Py(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function wG(t){const e=ar(xt(Ne,"ar_movements"),lr("ref.saleId","==",t)),r=await Ut(e);await Promise.all(r.docs.map(n=>na(Kt(Ne,"ar_movements",n.id))))}function JQe({role:t="",roles:e,sellerCandyId:r="",currentUserEmail:n}){const a=e&&e.length?e:t,s=String(r||"").trim(),o=Rn(a,"vendedor_dulces"),l=Rn(a,"admin"),[c,d]=g.useState([]),[u,f]=g.useState(!1),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,I]=g.useState(!1),[j,N]=g.useState(!1),[S,E]=g.useState(null),[B,k]=g.useState([]),T=async Be=>{var It;I(!0),N(!0),E(Be),k([]);try{const Vt=await Es(Kt(Ne,"sales_candies",Be));let Ot=null;Vt.exists()?Ot=Vt.data():Ot=(It=(await Ut(ar(xt(Ne,"sales_candies"),lr("name","==",Be)))).docs[0])==null?void 0:It.data();let qt=[];if(Array.isArray(Ot==null?void 0:Ot.items))qt=Ot.items;else if(Ot!=null&&Ot.items&&typeof Ot.items=="object")try{qt=Object.values(Ot.items)}catch{qt=[]}else Ot!=null&&Ot.item&&(qt=[Ot.item]);const sr=qt.map(vr=>({productName:String(vr.productName||""),qty:Number(vr.packages??vr.qty??vr.quantity??0),unitPrice:Number(vr.unitPricePackage??vr.unitPrice??vr.price??0),discount:Number(vr.discount||0),total:Number(vr.total??vr.lineFinal??vr.amount??0)}));k(sr)}catch(Vt){console.error(Vt)}finally{N(!1)}},[P,q]=g.useState(""),[de,ce]=g.useState("+505 "),[le,he]=g.useState(""),[ae,Ce]=g.useState(""),[De,O]=g.useState("ACTIVO"),[R,G]=g.useState(0),[M,K]=g.useState(""),[Y,D]=g.useState(0),[V,te]=g.useState([]),[ve,Q]=g.useState(!0),[Xe,se]=g.useState(""),Z=10,[ke,Se]=g.useState(1),[Ee,Ze]=g.useState(null),[ot,vt]=g.useState(""),[_t,Tt]=g.useState("+505 "),[Lt,Rt]=g.useState(""),[Et,Re]=g.useState(""),[Te,Ye]=g.useState("ACTIVO"),[dt,Fe]=g.useState(0),[je,We]=g.useState(""),[ee,Ve]=g.useState(!1),[rt,$e]=g.useState(null),[ie,pe]=g.useState(!1),[fe,Me]=g.useState([]),[me,ye]=g.useState({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),[mt,gt]=g.useState(!1),[yt,Pt]=g.useState(0),[Ft,Oe]=g.useState(new Date().toISOString().slice(0,10)),[be,Ae]=g.useState(""),[Le,ut]=g.useState(!1),[ct,st]=g.useState(null),[z,X]=g.useState(""),[re,H]=g.useState(0),[L,ue]=g.useState(""),[Pe,xe]=g.useState(!1),[Ge,ze]=g.useState(null),[Ke,pt]=g.useState(!1),[ne,Ue]=g.useState(!1),[tt,nt]=g.useState(null);g.useEffect(()=>{(async()=>{try{if(Q(!0),o&&!s){te([]),se(" Este usuario no tiene vendedor asociado (sellerCandyId vaco).");return}const Be=await Ut(xt(Ne,"sellers_candies")),It=[];Be.forEach(sr=>{const vr=sr.data(),rr=String(vr.status||"ACTIVO");rr==="ACTIVO"&&It.push({id:sr.id,name:String(vr.name||""),status:rr})}),d(It);const Vt=o?ar(xt(Ne,"customers_candies"),lr("vendorId","==",s),kn("createdAt","desc")):ar(xt(Ne,"customers_candies"),kn("createdAt","desc")),Ot=await Ut(Vt),qt=[];Ot.forEach(sr=>{const vr=sr.data();qt.push({id:sr.id,name:vr.name??"",phone:vr.phone??"+505 ",place:vr.place??"",notes:vr.notes??"",status:vr.status??"ACTIVO",creditLimit:Number(vr.creditLimit??0),createdAt:vr.createdAt??Nr.now(),balance:0,sellerId:vr.sellerId||"",vendorId:vr.vendorId||"",vendorName:vr.vendorName||"",initialDebt:Number(vr.initialDebt||0),initialDebtDate:String(vr.initialDebtDate||"").trim(),lastAbonoDate:"",lastAbonoAmount:0})});for(const sr of qt)try{const vr=ar(xt(Ne,"ar_movements"),lr("customerId","==",sr.id)),rr=await Ut(vr);let dr=0,we=null;const ft=[];rr.forEach(fr=>{var hr,Ir,en;const or=fr.data(),Hr=Number(or.amount||0);dr+=Hr;const br=or.date??((Ir=(hr=or.createdAt)==null?void 0:hr.toDate)!=null&&Ir.call(hr)?or.createdAt.toDate().toISOString().slice(0,10):"");if(ft.push({id:fr.id,date:br,type:or.type??(Hr<0?"ABONO":"CARGO"),amount:Hr,ref:or.ref||{},comment:or.comment||"",createdAt:or.createdAt}),Hr<0){const sn=(en=or.createdAt)!=null&&en.seconds?Number(or.createdAt.seconds):0;(!we||sn>=we.ts)&&(we={date:br,amount:Math.abs(Hr),ts:sn})}});const St=Number(sr.initialDebt||0),Ct=Dr(St,String(sr.initialDebtDate||""),ft);sr.balance=Ct+dr,we?(sr.lastAbonoDate=we==null?void 0:we.date,sr.lastAbonoAmount=we==null?void 0:we.amount):(sr.lastAbonoDate="",sr.lastAbonoAmount=0)}catch{sr.balance=Number(sr.initialDebt||0),sr.lastAbonoDate="",sr.lastAbonoAmount=0}te(qt)}catch(Be){console.error(Be),se(" Error cargando clientes.")}finally{Q(!1)}})()},[o,s]);const wt=()=>{q(""),ce("+505 "),he(""),Ce(""),O("ACTIVO"),G(0),K(""),D(0)},Bt=async Be=>{var qt;if(Be.preventDefault(),se(""),!P.trim()){se("Ingresa el nombre.");return}const It=Py(de);if(It.length<6){se("Telfono incompleto.");return}const Vt=o?s:String(M||"").trim(),Ot=Vt&&((qt=c.find(sr=>sr.id===Vt))==null?void 0:qt.name)||"";try{const sr=Number(Y||0),vr=await ta(xt(Ne,"customers_candies"),{name:P.trim(),phone:It,place:le||"",notes:ae||"",status:De,creditLimit:Number(R||0),vendorId:Vt,vendorName:Ot,initialDebt:sr,createdAt:Nr.now()});te(rr=>[{id:vr.id,name:P.trim(),phone:It,place:le||"",notes:ae||"",status:De,creditLimit:Number(R||0),vendorId:Vt,vendorName:Ot,initialDebt:sr,createdAt:Nr.now(),balance:sr,lastAbonoDate:"",lastAbonoAmount:0},...rr]),wt(),xe(!1),se(" Cliente creado")}catch(sr){console.error(sr),se(" Error al crear cliente")}},tr=Be=>{if(o){se(" No permitido: vendedores no editan clientes desde el listado.");return}Ze(Be.id),vt(Be.name),Tt(Be.phone||"+505 "),Rt(Be.place||""),Re(Be.notes||""),Ye(Be.status||"ACTIVO"),Fe(Number(Be.creditLimit||0)),We(String(Be.vendorId||""))},Or=()=>{Ze(null),vt(""),Tt("+505 "),Rt(""),Re(""),Ye("ACTIVO"),Fe(0),We("")},zr=async()=>{var vr;if(o){se(" No permitido.");return}if(!Ee)return;const Be=Py(_t);if(!ot.trim()){se("Ingresa el nombre.");return}const It=V.find(rr=>rr.id===Ee),Vt=String((It==null?void 0:It.vendorId)||""),Ot=o?s:String(je||"");if(o&&Vt&&Vt!==s){se(" Este cliente pertenece a otro vendedor.");return}if(l&&Vt&&Ot&&Vt!==Ot){se(" Este cliente ya est asociado a otro vendedor. Primero desasocia (deja vendedor en ) y guarda; luego lo puedes asignar.");return}const qt=o?s:String(je||""),sr=qt&&((vr=c.find(rr=>rr.id===qt))==null?void 0:vr.name)||"";try{await Mn(Kt(Ne,"customers_candies",Ee),{name:ot.trim(),phone:Be,place:Lt||"",notes:Et||"",status:Te,creditLimit:Number(dt||0),vendorId:qt,vendorName:sr}),te(rr=>rr.map(dr=>dr.id===Ee?{...dr,name:ot.trim(),phone:Be,place:Lt||"",notes:Et||"",status:Te,creditLimit:Number(dt||0),vendorId:qt,vendorName:sr}:dr)),Or(),se(" Cliente actualizado")}catch(rr){console.error(rr),se(" Error al actualizar")}},ur=async Be=>{if(confirm(`Eliminar al cliente "${Be.name}"?
Se devolvern al inventario todos los dulces de sus compras y se borrarn sus movimientos.`))try{Q(!0);const Vt=ar(xt(Ne,"sales_candies"),lr("customerId","==",Be.id)),Ot=await Ut(Vt);for(const vr of Ot.docs){const rr=vr.id;try{await Y2(rr)}catch(dr){console.warn("restoreSaleAndDeleteCandy error",dr);try{await na(Kt(Ne,"sales_candies",rr))}catch{}}await wG(rr)}const qt=ar(xt(Ne,"ar_movements"),lr("customerId","==",Be.id)),sr=await Ut(qt);await Promise.all(sr.docs.map(vr=>na(Kt(Ne,"ar_movements",vr.id)))),await na(Kt(Ne,"customers_candies",Be.id)),te(vr=>vr.filter(rr=>rr.id!==Be.id)),se(" Cliente eliminado y dulces devueltos al inventario")}catch(Vt){console.error(Vt),se(" No se pudo eliminar el cliente.")}finally{Q(!1)}},Dr=(Be,It,Vt)=>{const Ot=Number(Be||0);if(!Ot)return 0;const qt=String(It||"").trim();return qt&&Vt.some(vr=>{var St;const rr=Number(vr.amount||0);if(!(rr>0))return!1;const dr=Math.abs(rr-Ot)<.01,we=String(vr.date||"").trim()===qt,ft=!!((St=vr.ref)!=null&&St.saleId);return dr&&we&&ft})?0:Ot},dn=(Be,It,Vt)=>{const Ot=Be.reduce((dr,we)=>dr+(Number(we.amount)||0),0),qt=Be.filter(dr=>Number(dr.amount)<0).reduce((dr,we)=>dr+Math.abs(Number(we.amount)||0),0),sr=Be.filter(dr=>Number(dr.amount)>0).reduce((dr,we)=>dr+(Number(we.amount)||0),0),vr=Dr(It,Vt,Be),rr=Number(vr||0)+Ot;ye({saldoActual:rr,totalAbonado:qt,totalCargos:Number(vr||0)+sr,saldoRestante:rr})},mn=async Be=>{$e(Be),Me([]),ye({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),Ve(!0),pt(!1),Ue(!1),nt(null),gt(!1),Pt(0),Oe(new Date().toISOString().slice(0,10)),Ae(""),st(null),pe(!0);try{const It=ar(xt(Ne,"ar_movements"),lr("customerId","==",Be.id)),Vt=await Ut(It),Ot=[];Vt.forEach(qt=>{var dr,we;const sr=qt.data(),vr=sr.date??((we=(dr=sr.createdAt)==null?void 0:dr.toDate)!=null&&we.call(dr)?sr.createdAt.toDate().toISOString().slice(0,10):""),rr=Number(sr.amount||0);Ot.push({id:qt.id,date:vr,type:sr.type??(rr<0?"ABONO":"CARGO"),amount:rr,ref:sr.ref||{},comment:sr.comment||"",createdAt:sr.createdAt})}),Ot.sort((qt,sr)=>{var dr,we;if(qt.date!==sr.date)return qt.date.localeCompare(sr.date);const vr=((dr=qt.createdAt)==null?void 0:dr.seconds)||0,rr=((we=sr.createdAt)==null?void 0:we.seconds)||0;return vr-rr}),Me(Ot),dn(Ot,Number(Be.initialDebt||0),String(Be.initialDebtDate||""))}catch(It){console.error(It),se(" No se pudo cargar el estado de cuenta")}finally{pe(!1)}},kr=Be=>{const It=Be.filter(Vt=>Number(Vt.amount)<0).map(Vt=>{var Ot;return{date:Vt.date,amount:Math.abs(Number(Vt.amount||0)),ts:((Ot=Vt.createdAt)==null?void 0:Ot.seconds)||0}}).sort((Vt,Ot)=>(Vt.ts||0)-(Ot.ts||0));return It.length?It[It.length-1]:null},Qe=g.useMemo(()=>Dr(Number((rt==null?void 0:rt.initialDebt)||0),String((rt==null?void 0:rt.initialDebtDate)||""),fe),[rt==null?void 0:rt.initialDebt,rt==null?void 0:rt.initialDebtDate,fe]),jt=async()=>{if(!rt)return;se("");const Be=Number(yt||0);if(!(Be>0)){se("Ingresa un monto de abono mayor a 0.");return}const It=parseFloat(Be.toFixed(2));if(!Ft){se("Selecciona la fecha del abono.");return}try{ut(!0);const Vt={customerId:rt.id,type:"ABONO",amount:-It,date:Ft,comment:be||"",createdAt:Nr.now()},qt={id:(await ta(xt(Ne,"ar_movements"),Vt)).id,date:Ft,type:"ABONO",amount:-It,comment:be||"",createdAt:Nr.now()},sr=[...fe,qt].sort((we,ft)=>{var fr,or;if(we.date!==ft.date)return we.date.localeCompare(ft.date);const St=((fr=we.createdAt)==null?void 0:fr.seconds)||0,Ct=((or=ft.createdAt)==null?void 0:or.seconds)||0;return St-Ct});Me(sr),dn(sr,Number(rt.initialDebt||0),String(rt.initialDebtDate||""));const vr=sr.reduce((we,ft)=>we+(Number(ft.amount)||0),0),rr=Dr(Number(rt.initialDebt||0),String(rt.initialDebtDate||""),sr),dr=Number(rr||0)+vr;te(we=>we.map(ft=>ft.id!==rt.id?ft:{...ft,balance:dr,lastAbonoDate:Ft,lastAbonoAmount:It})),$e(we=>we&&{...we,balance:dr,lastAbonoDate:Ft,lastAbonoAmount:It}),Pt(0),Ae(""),Oe(new Date().toISOString().slice(0,10)),gt(!1),se(" Abono registrado")}catch(Vt){console.error(Vt),se(" Error al registrar el abono")}finally{ut(!1)}},wr=Be=>{st(Be.id),X(Be.date||new Date().toISOString().slice(0,10)),H(Math.abs(Number(Be.amount||0))),ue(Be.comment||"")},ln=()=>{st(null),X(""),H(0),ue("")},cn=async()=>{if(!ct||!rt)return;const Be=fe.findIndex(qt=>qt.id===ct);if(Be===-1)return;const It=fe[Be],Vt=Number(re||0);if(!(Vt>0)){se("El monto debe ser mayor a 0.");return}const Ot=It.type==="ABONO"?-parseFloat(Vt.toFixed(2)):+parseFloat(Vt.toFixed(2));try{await Mn(Kt(Ne,"ar_movements",ct),{date:z,amount:Ot,comment:L||""});const qt=[...fe];qt[Be]={...It,date:z,amount:Ot,comment:L||""},qt.sort((we,ft)=>{var fr,or;if(we.date!==ft.date)return we.date.localeCompare(ft.date);const St=((fr=we.createdAt)==null?void 0:fr.seconds)||0,Ct=((or=ft.createdAt)==null?void 0:or.seconds)||0;return St-Ct}),Me(qt),dn(qt,Number(rt.initialDebt||0),String(rt.initialDebtDate||""));const sr=qt.reduce((we,ft)=>we+(Number(ft.amount)||0),0),vr=Dr(Number(rt.initialDebt||0),String(rt.initialDebtDate||""),qt),rr=Number(vr||0)+sr,dr=kr(qt);te(we=>we.map(ft=>ft.id===rt.id?{...ft,balance:rr,lastAbonoDate:(dr==null?void 0:dr.date)||"",lastAbonoAmount:(dr==null?void 0:dr.amount)||0}:ft)),$e(we=>we&&{...we,balance:rr,lastAbonoDate:(dr==null?void 0:dr.date)||"",lastAbonoAmount:(dr==null?void 0:dr.amount)||0}),ln(),se(" Movimiento actualizado")}catch(qt){console.error(qt),se(" Error al actualizar movimiento")}},_r=async Be=>{var Vt,Ot;if(confirm(`Eliminar este movimiento (${Be.type==="ABONO"?"Abono":"Compra"}) del ${Be.date}?${Be.type==="CARGO"&&((Vt=Be.ref)!=null&&Vt.saleId)?`
Se devolvern al inventario los dulces de esa venta.`:""}`)&&rt)try{if(Q(!0),Be.type==="CARGO"&&((Ot=Be.ref)!=null&&Ot.saleId)){try{await Y2(Be.ref.saleId)}catch(we){console.warn("restoreSaleAndDeleteCandy error",we),Q(!1),se(" No se pudo devolver inventario de la venta.");return}await wG(Be.ref.saleId)}else await na(Kt(Ne,"ar_movements",Be.id));const qt=fe.filter(we=>{var ft,St;return Be.type==="CARGO"&&((ft=Be.ref)!=null&&ft.saleId)?((St=we.ref)==null?void 0:St.saleId)!==Be.ref.saleId:we.id!==Be.id});Me(qt),dn(qt,Number(rt.initialDebt||0),String(rt.initialDebtDate||""));const sr=qt.reduce((we,ft)=>we+(Number(ft.amount)||0),0),vr=Dr(Number(rt.initialDebt||0),String(rt.initialDebtDate||""),qt),rr=Number(vr||0)+sr,dr=kr(qt);te(we=>we.map(ft=>ft.id===rt.id?{...ft,balance:rr,lastAbonoDate:(dr==null?void 0:dr.date)||"",lastAbonoAmount:(dr==null?void 0:dr.amount)||0}:ft)),$e(we=>we&&{...we,balance:rr,lastAbonoDate:(dr==null?void 0:dr.date)||"",lastAbonoAmount:(dr==null?void 0:dr.amount)||0}),nt(null),se(" Movimiento eliminado")}catch(qt){console.error(qt),se(" Error al eliminar movimiento")}finally{Q(!1)}},Jt=g.useMemo(()=>[...V].sort((Be,It)=>{var Vt,Ot;return Be.status!==It.status?Be.status==="BLOQUEADO"?1:-1:(((Vt=It.createdAt)==null?void 0:Vt.seconds)||0)-(((Ot=Be.createdAt)==null?void 0:Ot.seconds)||0)}),[V]),ir=Be=>Be==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700",Fr=g.useMemo(()=>{const Be=A.trim().toLowerCase(),It=x.trim()===""?null:Number(x),Vt=y.trim()===""?null:Number(y);return Jt.filter(Ot=>{const qt=!Be||String(Ot.name||"").toLowerCase().includes(Be),sr=!m||Ot.status===m,vr=Number(Ot.balance||0),rr=It===null||!Number.isNaN(It)&&vr>=It,dr=Vt===null||!Number.isNaN(Vt)&&vr<=Vt;return qt&&sr&&rr&&dr})},[Jt,A,m,x,y]),Er=Math.max(1,Math.ceil(Fr.length/Z)),Lr=g.useMemo(()=>{const Be=(ke-1)*Z;return Fr.slice(Be,Be+Z)},[Fr,ke]);g.useEffect(()=>{Se(1)},[A,m,x,y]);const Ln=()=>Se(1),Nt=()=>Se(Be=>Math.max(1,Be-1)),nr=()=>Se(Be=>Math.min(Er,Be+1)),$t=()=>Se(Er),Mt=()=>i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Ln,disabled:ke===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Nt,disabled:ke===1,children:" Anterior"}),i.jsxs("span",{className:"px-2 text-sm",children:["Pgina ",ke," de ",Er]}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:nr,disabled:ke===Er,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:$t,disabled:ke===Er,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[Fr.length," cliente(s)"]})]});return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Dulces)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>{xe(!0),o&&K(s)},type:"button",children:"Crear Cliente"})]}),i.jsxs("div",{className:"mb-3",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 border w-full md:w-auto",onClick:()=>f(Be=>!Be),children:u?"Ocultar filtros":"Mostrar filtros"}),u&&i.jsxs("div",{className:"mt-2 bg-white border rounded-xl p-3 grid grid-cols-1 md:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Cliente"}),i.jsx("input",{className:"w-full border p-2 rounded",value:A,onChange:Be=>h(Be.target.value),placeholder:"Buscar por nombre"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:Be=>p(Be.target.value||""),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Monto mn."}),i.jsx("input",{className:"w-full border p-2 rounded text-right",inputMode:"decimal",value:x,onChange:Be=>v(Be.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Monto mx."}),i.jsx("input",{className:"w-full border p-2 rounded text-right",inputMode:"decimal",value:y,onChange:Be=>b(Be.target.value),placeholder:""})]})]}),i.jsx("div",{className:"md:col-span-4 flex flex-wrap gap-2 justify-end",children:i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 border",onClick:()=>{h(""),p(""),v(""),b("")},children:"Limpiar"})})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsxs("div",{className:"hidden md:block",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:ve?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Cargando"})}):Lr.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Sin clientes"})}):Lr.map(Be=>{var Vt;const It=Ee===Be.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(Vt=Be.createdAt)!=null&&Vt.toDate?Be.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border text-left",children:It?i.jsx("input",{className:"w-full border p-1 rounded",value:ot,onChange:Ot=>vt(Ot.target.value)}):i.jsx("div",{className:"font-medium",children:Be.name})}),i.jsx("td",{className:"p-2 border",children:It?i.jsx("input",{className:"w-full border p-1 rounded",value:_t,onChange:Ot=>Tt(Py(Ot.target.value))}):Be.phone}),i.jsx("td",{className:"p-2 border",children:It?i.jsxs("select",{className:"w-full border p-1 rounded text-xs",value:o?s:je,onChange:Ot=>We(Ot.target.value),disabled:o,title:"Vendedor asociado",children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(Ot=>i.jsx("option",{value:Ot.id,children:Ot.name},Ot.id))]}):Be.vendorName||""}),i.jsx("td",{className:"p-2 border",children:It?i.jsxs("select",{className:"w-full border p-1 rounded",value:Lt,onChange:Ot=>Rt(Ot.target.value),children:[i.jsx("option",{value:"",children:""}),AT.map(Ot=>i.jsx("option",{value:Ot,children:Ot},Ot))]}):Be.place||""}),i.jsx("td",{className:"p-2 border",children:It?i.jsxs("select",{className:"w-full border p-1 rounded",value:Te,onChange:Ot=>Ye(Ot.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ir(Be.status)}`,children:Be.status})}),i.jsx("td",{className:"p-2 border",children:It?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(dt)?"":dt,onChange:Ot=>Fe(Math.max(0,Number(Ot.target.value||0)))}):rl(Be.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:rl(Be.balance||0)}),i.jsx("td",{className:"p-2 border",children:It?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:Et,onChange:Ot=>Re(Ot.target.value),maxLength:500}):i.jsx("span",{title:Be.notes||"",children:(Be.notes||"").length>40?(Be.notes||"").slice(0,40)+"":Be.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:It?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:zr,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Or,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>tr(Be),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>ur(Be),disabled:!l,title:l?"Borrar":"Solo admin",children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>mn(Be),children:"Estado de cuenta"})]})})})]},Be.id)})})]}),Mt()]}),i.jsxs("div",{className:"md:hidden",children:[ve?i.jsx("div",{className:"p-4 text-center text-sm",children:"Cargando"}):Lr.length===0?i.jsx("div",{className:"p-4 text-center text-sm",children:"Sin clientes"}):i.jsx("div",{className:"space-y-2",children:Lr.map(Be=>{const It=Ge===Be.id,Vt=Ee===Be.id,Ot=i.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] ${ir(Be.status)}`,children:Be.status});return i.jsxs("div",{className:"border rounded-2xl shadow-sm bg-white overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between gap-2 text-left",onClick:()=>{se(""),!Vt&&ze(qt=>qt===Be.id?null:Be.id)},children:[i.jsx("div",{className:"min-w-0 flex-1",children:i.jsx("div",{className:"truncate font-semibold",children:Be.name})}),i.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[11px] text-gray-500 leading-3",children:"Pendiente"}),i.jsx("div",{className:"font-semibold leading-4",children:rl(Be.balance||0)})]}),Ot]})]}),It&&i.jsxs("div",{className:"px-3 pb-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"ltimo abono"}),i.jsx("div",{className:"font-medium",children:Be.lastAbonoDate?Be.lastAbonoDate:""}),i.jsx("div",{className:"text-[12px] text-gray-700",children:Be.lastAbonoAmount?rl(Be.lastAbonoAmount):""})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Saldo pendiente"}),i.jsx("div",{className:"text-lg font-bold",children:rl(Be.balance||0)})]})]}),Vt?i.jsxs("div",{className:"mt-3 space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded-xl",value:ot,onChange:qt=>vt(qt.target.value)})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded-xl",value:_t,onChange:qt=>Tt(Py(qt.target.value))})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded-xl",value:Te,onChange:qt=>Ye(qt.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded-xl",value:Lt,onChange:qt=>Rt(qt.target.value),children:[i.jsx("option",{value:"",children:""}),AT.map(qt=>i.jsx("option",{value:qt,children:qt},qt))]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded-xl",value:o?s:je,onChange:qt=>We(qt.target.value),disabled:o,children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(qt=>i.jsx("option",{value:qt.id,children:qt.name},qt.id))]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lmite"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded-xl text-right",value:Number.isNaN(dt)?"":dt,onChange:qt=>Fe(Math.max(0,Number(qt.target.value||0)))})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded-xl min-h-24 resize-y",value:Et,onChange:qt=>Re(qt.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-blue-600 hover:bg-blue-700",onClick:zr,type:"button",children:"Guardar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-gray-200 hover:bg-gray-300",onClick:()=>{Or(),ze(null)},type:"button",children:"Cancelar"})]})]}):i.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>tr(Be),type:"button",children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>ur(Be),disabled:!l,title:l?"Borrar":"Solo admin",type:"button",children:"Borrar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>mn(Be),type:"button",children:"Estado"})]})]})]},Be.id)})}),Mt()]})]}),Xe&&i.jsx("p",{className:"mt-2 text-sm",children:Xe}),Pe&&$d.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>xe(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>xe(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:Bt,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:P,onChange:Be=>q(Be.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:de,onChange:Be=>ce(Py(Be.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:le,onChange:Be=>he(Be.target.value),children:[i.jsx("option",{value:"",children:""}),AT.map(Be=>i.jsx("option",{value:Be,children:Be},Be))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:De,onChange:Be=>O(Be.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor asociado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o?s:M,onChange:Be=>K(Be.target.value),disabled:o,children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(Be=>i.jsx("option",{value:Be.id,children:Be.name},Be.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Deuda inicial"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Y===0?"":Y,onChange:Be=>D(Math.max(0,Number(Be.target.value||0))),placeholder:"Ej: 1500"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este valor cuenta como saldo desde el inicio."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:R===0?"":R,onChange:Be=>G(Math.max(0,Number(Be.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:ae,onChange:Be=>Ce(Be.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[ae.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>xe(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),ee&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4 max-h-[92vh] overflow-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(rt==null?void 0:rt.name)||""]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{Pt(0),Oe(new Date().toISOString().slice(0,10)),Ae(""),gt(!0)},children:"Abonar"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Ve(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"hidden md:block",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Deuda inicial"}),i.jsx("div",{className:"text-xl font-semibold",children:rl(Number(Qe||0))})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:rl(me.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:rl(me.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:rl(me.saldoRestante)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Referencia"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:ie?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):fe.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):fe.map(Be=>{var Vt,Ot;const It=ct===Be.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:It?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:z,onChange:qt=>X(qt.target.value)}):Be.date||""}),i.jsx("td",{className:"p-2 border",children:Be.amount>=0?(Vt=Be.ref)!=null&&Vt.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",title:"Ver dulces de esta compra",onClick:()=>T(Be.ref.saleId),children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:(Ot=Be.ref)!=null&&Ot.saleId?`Venta #${Be.ref.saleId}`:""}),i.jsx("td",{className:"p-2 border",children:It?i.jsx("input",{className:"w-full border p-1 rounded",value:L,onChange:qt=>ue(qt.target.value),placeholder:"Comentario"}):i.jsx("span",{title:Be.comment||"",children:(Be.comment||"").length>40?(Be.comment||"").slice(0,40)+"":Be.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:It?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(re)?"":re,onChange:qt=>{const sr=Number(qt.target.value||0),vr=Number.isFinite(sr)?Math.max(0,parseFloat(sr.toFixed(2))):0;H(vr)},placeholder:"0.00"}):rl(Be.amount)}),i.jsx("td",{className:"p-2 border",children:It?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:cn,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:ln,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>wr(Be),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>_r(Be),children:"Borrar"})]})})]},Be.id)})})]})})]}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsxs("div",{className:"border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>pt(Be=>!Be),children:[i.jsx("div",{className:"font-semibold",children:"Estado de cuenta"}),i.jsx("div",{className:"text-sm text-gray-500",children:Ke?"Ocultar":"Ver"})]}),Ke&&i.jsxs("div",{className:"px-3 pb-3 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Deuda inicial"}),i.jsx("div",{className:"font-bold",children:rl(Number(Qe||0))})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Saldo actual"}),i.jsx("div",{className:"font-bold",children:rl(me.saldoActual)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Total abonado"}),i.jsx("div",{className:"font-bold",children:rl(me.totalAbonado)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Saldo restante"}),i.jsx("div",{className:"font-bold",children:rl(me.saldoRestante)})]})]})]}),i.jsxs("div",{className:"border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>Ue(Be=>!Be),children:[i.jsx("div",{className:"font-semibold",children:"Movimientos"}),i.jsx("div",{className:"text-sm text-gray-500",children:ne?"Ocultar":"Ver"})]}),ne&&i.jsx("div",{className:"px-3 pb-3 space-y-2",children:ie?i.jsx("div",{className:"text-center text-sm p-3",children:"Cargando"}):fe.length===0?i.jsx("div",{className:"text-center text-sm p-3",children:"Sin movimientos"}):fe.map(Be=>{var sr,vr;const It=tt===Be.id,Vt=ct===Be.id,Ot=Be.amount>=0?"CARGO":"ABONO",qt=Be.amount>=0?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700";return i.jsxs("div",{className:"border rounded-2xl overflow-hidden bg-white",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between gap-2 text-left",onClick:()=>{Vt||nt(rr=>rr===Be.id?null:Be.id)},children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[11px] text-gray-500 leading-3",children:"Fecha"}),i.jsx("div",{className:"font-semibold",children:Be.date||""})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] ${qt}`,children:Ot}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[11px] text-gray-500 leading-3",children:"Monto"}),i.jsx("div",{className:"font-semibold",children:rl(Be.amount)})]})]})]}),It&&i.jsxs("div",{className:"px-3 pb-3 space-y-2",children:[i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Referencia"}),i.jsx("div",{className:"font-medium",children:(sr=Be.ref)!=null&&sr.saleId?`Venta #${Be.ref.saleId}`:""}),((vr=Be.ref)==null?void 0:vr.saleId)&&i.jsx("button",{type:"button",className:"mt-2 text-xs underline text-blue-600",onClick:()=>T(Be.ref.saleId),children:"Ver productos de la venta"})]}),i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Comentario"}),Vt?i.jsx("input",{className:"w-full border p-2 rounded-xl",value:L,onChange:rr=>ue(rr.target.value),placeholder:"Comentario"}):i.jsx("div",{className:"font-medium",children:(Be.comment||"").trim()||""})]}),Vt&&i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded-xl",value:z,onChange:rr=>X(rr.target.value)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded-xl text-right",value:Number.isNaN(re)?"":re,onChange:rr=>{const dr=Number(rr.target.value||0),we=Number.isFinite(dr)?Math.max(0,parseFloat(dr.toFixed(2))):0;H(we)}})]})]}),Vt?i.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-1",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-blue-600 hover:bg-blue-700",onClick:cn,type:"button",children:"Guardar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-gray-200 hover:bg-gray-300",onClick:ln,type:"button",children:"Cancelar"})]}):i.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-1",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>wr(Be),type:"button",children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-red-600 hover:bg-red-700",onClick:()=>_r(Be),type:"button",children:"Borrar"})]})]})]},Be.id)})})]})]}),mt&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(rt==null?void 0:rt.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:Ft,onChange:Be=>Oe(Be.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:yt===0?"":yt,onChange:Be=>{const It=Number(Be.target.value||0),Vt=Number.isFinite(It)?Math.max(0,parseFloat(It.toFixed(2))):0;Pt(Vt)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se registrar como ABONO (negativo) con 2 decimales."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:be,onChange:Be=>Ae(Be.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[be.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>gt(!1),disabled:Le,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:jt,disabled:Le,children:Le?"Guardando...":"Guardar abono"})]})]})})]})}),w&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[65]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Dulces vendidos"," ",S?` #${S}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>I(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:j?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):B.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):B.map((Be,It)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:Be.productName}),i.jsx("td",{className:"p-2 border text-right",children:Be.qty}),i.jsx("td",{className:"p-2 border text-right",children:rl(Be.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:rl(Be.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:rl(Be.total)})]},It))})]})})]})})]})}const td=t=>`C$ ${(Number(t)||0).toFixed(2)}`,ZQe=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas","Pull","Tilgue","Balge","Santa Cruz","Moyogalpa","Santo Domingo","San Jos del Sur","San Fernando","Merida","La Paloma","San Lorenzo","San Carlos","San Miguel"];function eVe(t){switch(t){case"RIVAS":return"Rivas";case"SAN_JORGE":return"San Jorge";case"ISLA":return"Isla de Ometepe";default:return""}}function tVe(t){switch(t){case"Rivas":return"RIVAS";case"San Jorge":return"SAN_JORGE";case"Isla Ometepe":return"ISLA";default:return"RIVAS"}}function rVe(t){const{saleId:e,date:r,customerName:n,branch:a,items:s,total:o,vendorName:l,vendorCommissionPercent:c,vendorCommissionAmount:d}=t,u=new An;let f=12;if(u.setFontSize(16),u.text("Multiservicios Ortiz",10,f),f+=6,u.setFontSize(12),u.text("Recibo de venta certificada",10,f),f+=8,u.setFontSize(12),u.text(`Fecha: ${r}`,10,f),f+=5,u.text(`Cliente: ${n||"Cliente Mostrador"}`,10,f),f+=5,u.text(`Sucursal: ${eVe(a)}`,10,f),f+=5,u.text(`Autorizado: ${e}`,10,f),f+=5,l&&(u.text(`Vendedor: ${l}`,10,f),f+=5),typeof c=="number"){const A=Number(d||0).toFixed(2),h=c.toFixed(2);u.text(`Comisin vendedor: ${h}%  C$ ${A}`,10,f),f+=8}else f+=3;u.setFontSize(12),u.text("Producto",10,f),u.text("Paquetes",110,f,{align:"right"}),u.text("Precio.",150,f,{align:"right"}),u.text("Subtotal",190,f,{align:"right"}),f+=4,u.line(10,f,190,f),f+=4,s.forEach(A=>{f>270&&(u.addPage(),f=12);const h=(A.productName||"").length>50?A.productName.slice(0,47)+"...":A.productName;u.text(h,10,f),u.text(String(A.qty),110,f,{align:"right"}),u.text(`C$ ${Number(A.unitPrice||0).toFixed(2)}`,150,f,{align:"right"}),u.text(`C$ ${Number(A.total||0).toFixed(2)}`,190,f,{align:"right"}),f+=5}),f+=4,u.line(10,f,190,f),f+=6,u.setFontSize(13),u.text(`Total: C$ ${Number(o||0).toFixed(2)}`,190,f,{align:"right"}),f+=6,u.setFontSize(9),u.text("Gracias por su compra.",10,f),u.save(`venta_dulces_${e}.pdf`)}async function NG(t,e){if(!t||!e)return 0;const r=ar(xt(Ne,"inventory_candies_sellers"),lr("sellerId","==",e),lr("productId","==",t)),n=await Ut(r);let a=0;return n.forEach(s=>{const o=s.data(),l=Number(o.remainingUnits??o.remaining??o.totalUnits??0);l>0&&(a+=l)}),a}const CG=()=>{const t=new Date;return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t.toISOString().slice(0,10)};async function nVe(t){const{productId:e,vendorId:r,quantityUnits:n,saleDate:a,saleId:s}=t;let o=Math.max(0,Math.floor(Number(n||0)));const l=[];if(!e||!r||o<=0)return{allocations:[]};const c=ar(xt(Ne,"inventory_candies_sellers"),lr("sellerId","==",r),lr("productId","==",e),lr("remainingUnits",">",0),kn("date","asc"),kn("createdAt","asc")),d=await Ut(c);for(const u of d.docs){if(o<=0)break;const f=u.data(),A=Number(f.remainingUnits||0);if(A<=0)continue;const h=Math.min(A,o),m=A-h,p=Math.max(1,Math.floor(Number(f.unitsPerPackage||1))),x=Math.floor(m/p);await Mn(u.ref,{remainingUnits:m,remainingPackages:x}),l.push({inventorySellerId:u.id,productId:e,units:h,saleDate:a,saleId:s}),o-=h}return o>0&&console.warn("[allocateSaleFIFOCandyFromVendor] No alcanz el inventario del vendedor, faltaron unidades.",{productId:e,vendorId:r,remaining:o}),{allocations:l}}function _G(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}function aVe({role:t="",roles:e,sellerCandyId:r="",currentUserEmail:n}){const a=e&&e.length?e:t;Rn(a,"admin"),Rn(a,"vendedor_dulces");const[s,o]=g.useState([]),[l,c]=g.useState([]),[d,u]=g.useState([]),[f,A]=g.useState({}),[h,m]=g.useState("CONTADO"),[p,x]=g.useState("RIVAS"),[v,y]=g.useState(""),[b,w]=g.useState(""),[I,j]=g.useState(CG()),[N,S]=g.useState(""),[E,B]=g.useState(!1),[k,T]=g.useState(""),[P,q]=g.useState([]),[de,ce]=g.useState(!0),[le,he]=g.useState(!1),ae=g.useMemo(()=>P.reduce((Ae,Le)=>Ae+(Le.qtyPackages||0),0),[P]),Ce=g.useMemo(()=>P.reduce((Ae,Le)=>Ae+(Le.qtyPackages||0)*(Le.unitsPerPackage||1),0),[P]),De=g.useMemo(()=>{const Ae=P.reduce((Le,ut)=>{const ct=(Number(ut.pricePerPackage)||0)*(ut.qtyPackages||0),st=Number(ut.discount)||0,z=Math.max(0,ct-st);return Le+z},0);return Math.floor(Ae*100)/100},[P]),[O,R]=g.useState(0),[G,M]=g.useState(""),[K,Y]=g.useState(!1),[D,V]=g.useState(!1),[te,ve]=g.useState(""),[Q,Xe]=g.useState("+505 "),[se,Z]=g.useState(""),[ke,Se]=g.useState(""),[Ee,Ze]=g.useState("ACTIVO"),[ot,vt]=g.useState(0),[_t,Tt]=g.useState(""),Lt=()=>{ve(""),Xe("+505 "),Z(""),Se(""),Ze("ACTIVO"),vt(0)},[Rt,Et]=g.useState(!1),Re=async Ae=>{const Le=String(Ae||"").trim();if(!Le)return;const ut=Pt.find(X=>String(X.barcode||"")===Le),ct=Pt.find(X=>String(X.sku||"")===Le),st=Pt.find(X=>String(X.id||"")===Le),z=ut||ct||st||null;z?(await Me(z.id),M(" Producto agregado desde escner."),setTimeout(()=>M(""),2500)):(M(" Cdigo no corresponde a ningn producto disponible."),setTimeout(()=>M(""),2500))};function Te({open:Ae,onClose:Le,onDetected:ut}){const ct=g.useRef(null),st=g.useRef(null),[z,X]=g.useState(""),re=g.useRef("");return g.useEffect(()=>{if(!Ae)return;let H=!1;const L=new X2,ue=()=>{var xe,Ge,ze;try{(xe=st.current)==null||xe.stop()}catch{}st.current=null;try{const Ke=(Ge=ct.current)==null?void 0:Ge.srcObject;try{(ze=Ke==null?void 0:Ke.getTracks)==null||ze.call(Ke).forEach(pt=>pt.stop())}catch{}}catch{}try{ct.current&&(ct.current.srcObject=null)}catch{}};return(async()=>{X("");try{if(!ct.current)return;try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1})).getTracks().forEach(ze=>ze.stop())}catch{}const xe=await L.decodeFromConstraints({video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1},ct.current,Ge=>{if(!H&&Ge){const ze=String(Ge.getText()||"").trim().replace(/\s+/g,"");if(!ze||ze===re.current)return;re.current=ze,ue(),ut(ze),Le()}});st.current=xe}catch(xe){const Ge=String((xe==null?void 0:xe.message)||""),ze=String((xe==null?void 0:xe.name)||"");Ge.toLowerCase().includes("permission")||ze==="NotAllowedError"?X("Permiso de cmara denegado."):ze==="NotFoundError"||Ge.toLowerCase().includes("notfound")?X("No se encontr cmara en este dispositivo."):Ge.toLowerCase().includes("secure")||Ge.toLowerCase().includes("https")?X("La cmara requiere HTTPS (sitio seguro)."):X(Ge||"No se pudo iniciar el escner.")}})(),()=>{var xe;H=!0;try{(xe=st.current)==null||xe.stop()}catch{}st.current=null}},[Ae,Le,ut]),Ae?i.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 p-3 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-lg border overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[i.jsx("div",{className:"font-bold",children:"Escanear cdigo"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Le,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"relative w-full aspect-[3/4] bg-black rounded-xl overflow-hidden",children:[i.jsx("video",{ref:ct,className:"w-full h-full object-cover",muted:!0,playsInline:!0,autoPlay:!0}),i.jsx("div",{className:"absolute inset-0 pointer-events-none",children:i.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[85%] h-40 border-2 border-white/70 rounded-xl"})})]}),z&&i.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded p-2",children:z}),i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Apunt al cdigo de barras y mantenelo estable."})]})]})}):null}const Ye=g.useMemo(()=>s.find(Ae=>Ae.id===v),[s,v]),dt=g.useMemo(()=>E&&N?s.filter(Ae=>(Ae.vendorId??Ae.sellerId??"")===N):s,[s,E,N]),Fe=(Ye==null?void 0:Ye.balance)||0,je=h==="CREDITO"?Fe+Math.max(0,Number(De||0))-Math.max(0,Number(O||0)):0,We=g.useMemo(()=>{if(h!=="CREDITO")return 0;const Ae=Math.max(0,Number(Fe||0))+Math.max(0,Number(De||0));return Math.floor(Ae*100)/100},[h,Fe,De]),ee=Ae=>{const Le=Math.max(0,Number(Ae||0));return Math.min(Le,We)},Ve=g.useMemo(()=>d.find(Ae=>Ae.id===N)||null,[d,N]),rt=(Ve==null?void 0:Ve.commissionPercent)||0,$e=g.useMemo(()=>{const Ae=P.reduce((Le,ut)=>Le+Number(ut.margenVendedor||0),0);return Number(Ae.toFixed(2))},[P]);g.useEffect(()=>{(async()=>{const Ae=ar(xt(Ne,"customers_candies"),kn("createdAt","desc")),Le=await Ut(Ae),ut=[];Le.forEach(X=>{const re=X.data();ut.push({id:X.id,name:re.name??"",phone:re.phone??"+505 ",place:re.place??"",status:re.status??"ACTIVO",creditLimit:Number(re.creditLimit??0),balance:0,sellerId:re.sellerId??re.vendorId??"",vendorId:re.vendorId??re.sellerId??""})});for(const X of ut)try{const re=ar(xt(Ne,"ar_movements"),lr("customerId","==",X.id)),H=await Ut(re);let L=0;H.forEach(Pe=>L+=Number(Pe.data().amount||0));const ue=Number(X.initialDebt||0);X.balance=L+ue}catch{X.balance=0}o(ut);const ct=ar(xt(Ne,"products_candies"),kn("createdAt","desc")),st=await Ut(ct),z=[];st.forEach(X=>{const re=X.data();z.push({id:X.id,name:re.name??"(sin nombre)",sku:re.sku??"",unitsPerPackage:Number(re.unitsPerPackage??1),barcode:String(re.barcode||""),priceRivas:Number(re.unitPriceRivas??0),priceSanJorge:Number(re.unitPriceSanJorge??0),priceIsla:Number(re.unitPriceIsla??0),providerPrice:Number(re.providerPrice??0),providerPricePerUnit:Number(re.providerPricePerUnit??0)})}),c(z);try{const X=await Ut(xt(Ne,"sellers_candies")),re=[];X.forEach(H=>{const L=H.data(),ue=L.branch||"Rivas",Pe=tVe(ue);re.push({id:H.id,name:L.name??"(sin nombre)",branch:Pe,branchLabel:ue,commissionPercent:Number(L.commissionPercent??0)})}),u(re)}catch(X){console.error("Error cargando vendedores:",X)}A({})})()},[]),g.useEffect(()=>{var Le,ut;const Ae=e&&e.length?e:t;if(Ae&&((Le=Ae.includes)!=null&&Le.call(Ae,"vendedor_dulces"))&&r){S(r),B(!0);try{localStorage.setItem("pos_vendorId",r),localStorage.setItem("pos_role","VENDEDOR")}catch{}return}if(Ae&&((ut=Ae.includes)!=null&&ut.call(Ae,"admin"))){B(!1);return}try{const ct=localStorage.getItem("pos_vendorId")||"",st=localStorage.getItem("pos_role")||"";ct&&S(ct),st.toUpperCase()==="VENDEDOR"&&B(!0)}catch{}},[t,r]);const ie=async Ae=>{if(!Ae){A({});return}const Le=ar(xt(Ne,"inventory_candies_sellers"),lr("sellerId","==",Ae)),ut=await Ut(Le),ct={};ut.forEach(st=>{const z=st.data(),X=z.productId||"";if(!X)return;const re=Number(z.remainingUnits??z.remaining??z.totalUnits??0);re<=0||(ct[X]=(ct[X]||0)+re)}),A(ct),q(st=>{const z=[];for(const X of st){const re=ct[X.productId]??0;re>0&&z.push({...X,availableUnits:re})}return z})};g.useEffect(()=>{if(!N){A({});return}const Ae=d.find(Le=>Le.id===N);Ae&&x(Ae.branch),ie(N)},[N,d]),g.useEffect(()=>{q(Ae=>Ae.map(Le=>{const ut=l.find(st=>st.id===Le.productId);if(!ut)return Le;const ct=p==="RIVAS"?ut.priceRivas:p==="SAN_JORGE"?ut.priceSanJorge:ut.priceIsla;return{...Le,pricePerPackage:Number(ct)||0}}))},[p,l]);async function pe(Ae){const{productId:Le,vendorId:ut,branch:ct}=Ae;if(!Le||!ut)return 0;const st=ar(xt(Ne,"inventory_candies_sellers"),lr("sellerId","==",ut),lr("productId","==",Le)),z=await Ut(st);if(z.empty)return 0;const X=z.docs[0].data(),re=Number(X.unitPriceVendor??0);if(re>0)return re;const H=Number(ct==="RIVAS"?X.unitPriceRivas??0:ct==="SAN_JORGE"?X.unitPriceSanJorge??0:X.unitPriceIsla??0);return Number(H||0)}const fe=Ae=>{const Le=Number(rt||0),ut=Number(Ae||0)*Le/100;return Math.max(0,Number(ut.toFixed(2)))},Me=async Ae=>{var ue;if(!Ae)return;if(!N){M("Selecciona primero el vendedor para usar su inventario."),T("");return}if(P.some(Pe=>Pe.productId===Ae)){T("");return}const Le=l.find(Pe=>Pe.id===Ae);if(!Le){T("");return}const ut=await NG(Ae,N),ct=((ue=d.find(Pe=>Pe.id===N))==null?void 0:ue.branch)??p,st=await pe({productId:Ae,vendorId:N,branch:ct}),X=await(async Pe=>{const{productId:xe,vendorId:Ge}=Pe;if(!xe||!Ge)return 0;try{const ze=ar(xt(Ne,"inventory_candies_sellers"),lr("sellerId","==",Ge),lr("productId","==",xe)),Ke=await Ut(ze);if(Ke.empty)return 0;const pt=Ke.docs[0].data();return Number(pt.providerPrice??0)}catch{return 0}})({productId:Ae,vendorId:N}),re=(()=>{const Pe=Number(Le.providerPrice||0);if(Pe>0)return Pe;const xe=Number(Le.providerPricePerUnit||0);return xe>0?xe*Number(Le.unitsPerPackage||1):0})(),H=Number(X||0)>0?Number(X||0):Number(re||0),L={productId:Ae,productName:Le.name||"",sku:Le.sku||"",unitsPerPackage:Le.unitsPerPackage||1,pricePerPackage:Number(st)||0,availableUnits:Number(ut)||0,qtyPackages:0,discount:0,providerPricePerPackage:Number(H)||0,margenVendedor:0,uBruta:0};q(Pe=>[...Pe,L]),T("")},me=(Ae,Le)=>{q(ut=>ut.map(ct=>{if(ct.productId!==Ae)return ct;if(Le==="")return{...ct,qtyPackages:0};const st=Math.max(0,Math.floor(Number(Le))),z=f[Ae]??ct.availableUnits??0,X=Math.max(1,Number(ct.unitsPerPackage||1)),re=Math.floor(z/X);let H=st;st>re&&(H=re,M(` Solo hay ${re} paquetes disponibles.`),setTimeout(()=>M(""),2500));const L=Number(ct.pricePerPackage||0)*H,ue=Number(ct.providerPricePerPackage||0)*H,Pe=L-ue,xe=fe(Pe);return{...ct,qtyPackages:H,margenVendedor:xe,uBruta:Pe}}))},ye=(Ae,Le)=>{q(ut=>ut.map(ct=>{if(ct.productId!==Ae)return ct;if(Le==="")return{...ct,discount:0};const st=Math.max(0,Math.floor(Number(Le))),z=ct.qtyPackages||0,X=Number(ct.pricePerPackage||0)*z,re=Number(ct.providerPricePerPackage||0)*z,H=X-re,L=fe(H);return{...ct,discount:st,margenVendedor:L,uBruta:H}}))},mt=Ae=>q(Le=>Le.filter(ut=>ut.productId!==Ae)),gt=async()=>{if(!I)return"Selecciona la fecha.";if(!N)return"Selecciona el vendedor para esta venta.";if(P.length===0)return"Agrega al menos un producto.";const Ae=P.filter(Le=>(Le.qtyPackages||0)>0);if(Ae.length===0)return"Debes ingresar cantidades (> 0) en al menos un producto.";if(!(De>0))return"El total debe ser mayor a cero.";if(h==="CONTADO"){if(!b.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!v)return"Selecciona un cliente (crdito).";if(O<0)return"El pago inicial no puede ser negativo.";if(O>We)return"El pago inicial no puede superar el saldo a deber (saldo actual + venta).";if((Ye==null?void 0:Ye.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede facturar a crdito."}for(const Le of Ae){const ut=Le.unitsPerPackage||1,ct=(Le.qtyPackages||0)*ut,st=await NG(Le.productId,N),z=Math.floor(st/ut);if(ct>st)return`Inventario insuficiente en el pedido del vendedor para "${Le.productName}". Disponible: ${z} paquetes.`;const X=(Number(Le.pricePerPackage)||0)*(Le.qtyPackages||0),re=Number(Le.discount)||0;if(!Number.isInteger(re)||re<0)return`El descuento en "${Le.productName}" debe ser entero y  0.`;if(re>X)return`El descuento en "${Le.productName}" no puede exceder C$ ${X.toFixed(2)}.`}return null},yt=async Ae=>{Ae.preventDefault(),M("");const Le=await gt();if(Le){M(" "+Le);return}try{Y(!0);const ut=P.filter(re=>(re.qtyPackages||0)>0).map(re=>{const H=re.unitsPerPackage||1,L=re.qtyPackages||0,ue=L*H,Pe=(Number(re.pricePerPackage)||0)*(L||0),xe=Math.max(0,Math.floor(Number(re.discount)||0)),Ge=Math.max(0,Pe-xe),ze=Number(re.providerPricePerPackage||0),Ke=ze*L,pt=Pe-Ke,ne=fe(pt);return{productId:re.productId,productName:re.productName,sku:re.sku||"",qty:ue,packages:L,unitsPerPackage:H,branch:p,unitPricePackage:Number(re.pricePerPackage)||0,discount:xe,total:Math.floor(Ge*100)/100,providerPricePerPackage:ze,margenVendedor:ne,uBruta:pt}}),ct={type:h,branch:p,date:I,createdAt:Nr.now(),itemsTotal:Number(De)||0,total:Number(De)||0,quantity:Number(Ce)||0,packagesTotal:Number(ae)||0,items:ut,vendorId:N},st=d.find(re=>re.id===N);st&&(ct.vendorName=st.name,ct.vendorBranch=st.branch,ct.vendorBranchLabel=st.branchLabel,ct.vendorCommissionPercent=st.commissionPercent||0,ct.vendorCommissionAmount=$e||0),h==="CONTADO"?ct.customerName=b.trim():(ct.customerId=v,ct.downPayment=Number(O)||0);const z=await ta(xt(Ne,"sales_candies"),ct);if(h==="CONTADO"){const re=(b||"").trim();if(re)try{await ta(xt(Ne,"cash_customers"),{name:re,date:I,branch:p,vendorId:N,createdAt:Nr.now()})}catch(H){console.warn("No se pudo guardar cash_customer:",H)}}if(h==="CREDITO"&&v){const re={customerId:v,date:I,createdAt:Nr.now(),ref:{saleId:z.id}};await ta(xt(Ne,"ar_movements"),{...re,type:"CARGO",amount:Number(De)||0}),Number(O)>0&&await ta(xt(Ne,"ar_movements"),{...re,type:"ABONO",amount:-Number(O)})}const X={};for(const re of ut)if(re.qty>0){const{allocations:H}=await nVe({productId:re.productId,vendorId:N,quantityUnits:re.qty,saleDate:I,saleId:z.id});X[re.productId]={productId:re.productId,vendorId:N,allocations:H}}await Mn(Kt(Ne,"sales_candies",z.id),{allocationsByItem:X});try{const re=h==="CONTADO"?b.trim()||"Cliente Mostrador":(Ye==null?void 0:Ye.name)||"Cliente crdito";rVe({saleId:z.id,date:I,customerName:re,branch:p,items:ut.map(H=>({productName:H.productName,qty:H.packages,unitPrice:H.unitPricePackage,total:H.total})),total:Number(De)||0,vendorName:st==null?void 0:st.name,vendorCommissionPercent:(st==null?void 0:st.commissionPercent)||0,vendorCommissionAmount:$e})}catch(re){console.error("Error generando voucher PDF:",re)}m("CONTADO"),y(""),w(""),j(CG()),q([]),R(0),h==="CREDITO"&&v&&o(re=>re.map(H=>H.id===v?{...H,balance:(H.balance||0)+(Number(De)||0)-(Number(O)||0)}:H)),M(" Venta de dulces registrada"),N?await ie(N):A({})}catch(ut){console.error(ut),M(" Error al guardar la venta de dulces")}finally{Y(!1)}},Pt=g.useMemo(()=>l.filter(Ae=>{const Le=f[Ae.id]||0,ut=Math.max(1,Number(Ae.unitsPerPackage||1));return Math.floor(Le/ut)>0}).sort((Ae,Le)=>(Ae.name||"").localeCompare(Le.name||"")),[l,f]),[Ft,Oe]=g.useState(""),be=g.useMemo(()=>{const Ae=String(Ft||"").trim().toLowerCase();return Ae?Pt.filter(Le=>`${Le.name||""} ${Le.sku||""}`.toLowerCase().includes(Ae)||String(Le.id||"").includes(Ae)):Pt},[Ft,Pt]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Ventas (Dulces)"})}),i.jsxs("form",{onSubmit:yt,className:"bg-white p-3 sm:p-4 rounded shadow border mb-6",children:[i.jsxs("div",{className:"hidden md:grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:Ae=>m(Ae.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),h==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre del cliente (contado)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Cliente Mostrador",value:b,onChange:Ae=>w(Ae.target.value)})]}):i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[i.jsxs("select",{className:"w-full sm:flex-1 border p-2 rounded",value:v,onChange:Ae=>y(Ae.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),dt.map(Ae=>i.jsxs("option",{value:Ae.status==="ACTIVO"?Ae.id:"",disabled:Ae.status==="BLOQUEADO",children:[Ae.name," | ",Ae.phone," | Saldo: ",td(Ae.balance||0)]},Ae.id))]}),i.jsx("button",{type:"button",className:"w-full sm:w-auto px-4 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>V(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:td(Fe)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",max:We,className:"w-full border p-2 rounded",value:O===0?"":O,onChange:Ae=>{const Le=ee(Ae.target.value);R(Le)},placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:td(je)})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:I,onChange:Ae=>j(Ae.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:N,onChange:Ae=>{S(Ae.target.value),q([])},disabled:E,children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),d.map(Ae=>i.jsxs("option",{value:Ae.id,children:[Ae.name,"  ",Ae.branchLabel,"  ",Ae.commissionPercent.toFixed(2),"%"," comisin"]},Ae.id))]}),E&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Vendedor fijado por el usuario logueado."})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Lista de precios / Sucursal"}),i.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"RIVAS",checked:p==="RIVAS",readOnly:!0,disabled:!0}),i.jsx("span",{children:"Rivas"})]}),i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"SAN_JORGE",checked:p==="SAN_JORGE",readOnly:!0,disabled:!0}),i.jsx("span",{children:"San Jorge"})]}),i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"ISLA",checked:p==="ISLA",readOnly:!0,disabled:!0}),i.jsx("span",{children:"Isla de Ometepe"})]})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"La sucursal se toma automticamente del vendedor seleccionado."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("div",{className:"mt-1 mb-2 flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",placeholder:N?"Buscar producto por nombre o SKU":"Selecciona un vendedor primero",value:Ft,onChange:Ae=>Oe(Ae.target.value),disabled:!N}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>Et(!0),disabled:!N,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[i.jsx("rect",{x:"3",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"3",y:"15",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"15",width:"6",height:"6",rx:"1"})]})})]}),i.jsxs("select",{className:"w-full border p-2 rounded",value:k,onChange:async Ae=>{const Le=Ae.target.value;T(Le),await Me(Le)},disabled:!N,children:[i.jsx("option",{value:"",children:N?"Selecciona un producto":"Selecciona un vendedor primero"}),be.map(Ae=>{const Le=P.some(z=>z.productId===Ae.id),ut=f[Ae.id]||0,ct=Math.max(1,Number(Ae.unitsPerPackage||1)),st=Math.floor(ut/ct);return st<=0?null:i.jsxs("option",{value:Le?"":Ae.id,disabled:Le,children:[Ae.name," ",Ae.sku?` ${Ae.sku}`:""," (disp: ",st," ","paq.)",Le?" ":""]},Ae.id)})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"El selector solo muestra productos disponibles del pedido del vendedor seleccionado (sin ceros)."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("div",{className:"border rounded overflow-hidden min-w-[860px]",children:[i.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 px-3 py-2 text-xs font-semibold border-b",children:[i.jsx("div",{className:"col-span-4",children:"Producto"}),i.jsx("div",{className:"col-span-2 text-right",children:"Precio (paq.)"}),i.jsx("div",{className:"col-span-2 text-right",children:"Existencias (paq.)"}),i.jsx("div",{className:"col-span-1 text-right",children:"Cantidad (paq.)"}),i.jsx("div",{className:"col-span-1 text-right",children:"Descuento"}),i.jsx("div",{className:"col-span-1 text-right",children:"Monto"}),i.jsx("div",{className:"col-span-1 text-center",children:"Quitar"})]}),P.length===0?i.jsx("div",{className:"px-3 py-4 text-sm text-gray-500",children:"No hay productos agregados."}):P.map(Ae=>{const Le=f[Ae.productId]??Ae.availableUnits??0,ut=Ae.unitsPerPackage?Math.floor(Le/Ae.unitsPerPackage):0,ct=Math.max(0,ut-(Ae.qtyPackages||0)),st=(Number(Ae.pricePerPackage)||0)*(Ae.qtyPackages||0),z=Math.max(0,st-(Number(Ae.discount)||0));return i.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 border-b text-sm gap-x-2",children:[i.jsx("div",{className:"col-span-4",children:i.jsxs("div",{className:"font-medium",children:[Ae.productName,Ae.sku?`  ${Ae.sku}`:""]})}),i.jsx("div",{className:"col-span-2 text-right",children:td(Ae.pricePerPackage)}),i.jsxs("div",{className:"col-span-2 text-right",children:[ct," paq."]}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(Ae.qtyPackages)||Ae.qtyPackages===0?"":Ae.qtyPackages,onChange:X=>me(Ae.productId,X.target.value),inputMode:"numeric",placeholder:"0"})}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(Ae.discount)||Ae.discount===0?"":Ae.discount,onChange:X=>ye(Ae.productId,X.target.value),inputMode:"numeric",placeholder:"0"})}),i.jsx("div",{className:"col-span-1 text-right",children:td(z)}),i.jsx("div",{className:"col-span-1 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 hover:bg-red-200",onClick:()=>mt(Ae.productId),title:"Quitar producto",children:""})})]},Ae.productId)})]})}),P.length>0&&i.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-2 sm:gap-6 mt-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes totales: "}),i.jsx("span",{className:"font-semibold",children:ae})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Total: "}),i.jsx("span",{className:"font-semibold",children:td(De)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Comisin vendedor: "}),i.jsxs("span",{className:"font-semibold",children:[td($e)," ",rt?`(${rt.toFixed(2)}%)`:""]})]})]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{type:"submit",className:"w-full sm:w-auto bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",disabled:K,children:K?"Guardando...":"Registrar venta"})})]}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsxs("div",{className:"bg-white rounded-xl border shadow",children:[i.jsxs("button",{type:"button",onClick:()=>ce(Ae=>!Ae),className:"w-full flex justify-between items-center p-3 font-semibold",children:["Datos de venta",i.jsx("span",{className:"text-lg",children:de?"":"+"})]}),de&&i.jsxs("div",{className:"p-3 space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:I,onChange:Ae=>j(Ae.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:Ae=>m(Ae.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),h==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (Cash)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mario Bergoglio",value:b,onChange:Ae=>w(Ae.target.value)})]}):i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("select",{className:"w-full border p-2 rounded",value:v,onChange:Ae=>y(Ae.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),dt.map(Ae=>i.jsxs("option",{value:Ae.status==="ACTIVO"?Ae.id:"",disabled:Ae.status==="BLOQUEADO",children:[Ae.name," | Saldo: ",td(Ae.balance||0)]},Ae.id))]}),i.jsx("button",{type:"button",className:"w-full px-4 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>V(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-base font-semibold",children:td(Fe)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-base font-semibold",children:td(je)})]})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",max:We,className:"w-full border p-2 rounded",value:O===0?"":O,onChange:Ae=>{const Le=ee(Ae.target.value);R(Le)},placeholder:"0.00"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:N,onChange:Ae=>{S(Ae.target.value),q([])},disabled:E,children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),d.map(Ae=>i.jsxs("option",{value:Ae.id,children:[Ae.name,"  "," ",Ae.commissionPercent.toFixed(2),"%"]},Ae.id))]}),E&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Vendedor Logueado en esta app."})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl border shadow",children:[i.jsxs("button",{type:"button",onClick:()=>he(Ae=>!Ae),className:"w-full flex justify-between items-center p-3 font-semibold",children:["Agrega Productos",i.jsx("span",{className:"text-lg",children:le?"":"+"})]}),le&&i.jsxs("div",{className:"p-3 space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Productos"}),i.jsxs("div",{className:"mt-1 mb-2 flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",placeholder:N?"Buscar producto por nombre o SKU":"Selecciona un vendedor primero",value:Ft,onChange:Ae=>Oe(Ae.target.value),disabled:!N}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>Et(!0),disabled:!N,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[i.jsx("rect",{x:"3",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"3",y:"15",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"15",width:"6",height:"6",rx:"1"})]})})]}),i.jsxs("select",{className:"w-full border p-2 rounded",value:k,onChange:async Ae=>{const Le=Ae.target.value;T(Le),await Me(Le)},disabled:!N,children:[i.jsx("option",{value:"",children:N?"Selecciona un producto":"Selecciona un vendedor primero"}),be.map(Ae=>{const Le=P.some(z=>z.productId===Ae.id),ut=f[Ae.id]||0,ct=Math.max(1,Number(Ae.unitsPerPackage||1)),st=Math.floor(ut/ct);return st<=0?null:i.jsxs("option",{value:Le?"":Ae.id,disabled:Le,children:[Ae.name," ",Ae.sku?` ${Ae.sku}`:""," (disp:"," ",st," paq.)",Le?" ":""]},Ae.id)})]})]}),P.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"No hay productos agregados."}):i.jsx("div",{className:"space-y-2",children:P.map(Ae=>{const Le=f[Ae.productId]??Ae.availableUnits??0,ut=Ae.unitsPerPackage?Math.floor(Le/Ae.unitsPerPackage):0,ct=Math.max(0,ut-(Ae.qtyPackages||0)),st=(Number(Ae.pricePerPackage)||0)*(Ae.qtyPackages||0),z=Math.max(0,st-(Number(Ae.discount)||0));return i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50 space-y-2",children:[i.jsxs("div",{className:"font-semibold leading-tight",children:[Ae.productName,Ae.sku?`  ${Ae.sku}`:""]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"p-2 rounded border bg-white",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Precio x Paquete"}),i.jsx("div",{className:"font-bold",children:td(Ae.pricePerPackage)})]}),i.jsxs("div",{className:"p-2 rounded border bg-white",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Existencias"}),i.jsxs("div",{className:"font-bold",children:[ct," paq."]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Cantidad Paquetes"}),i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-2 rounded text-right",value:Number.isNaN(Ae.qtyPackages)||Ae.qtyPackages===0?"":Ae.qtyPackages,onChange:X=>me(Ae.productId,X.target.value),inputMode:"numeric",placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Descuento"}),i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-2 rounded text-right",value:Number.isNaN(Ae.discount)||Ae.discount===0?"":Ae.discount,onChange:X=>ye(Ae.productId,X.target.value),inputMode:"numeric",placeholder:"0"})]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"font-regular text-gray-600",children:["Total ",td(z)]}),i.jsxs("div",{className:"font-regular text-gray-600",children:["Comision ",td(Ae.margenVendedor||0)]}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded-lg bg-red-100 hover:bg-red-200",onClick:()=>mt(Ae.productId),children:"Quitar"})]})]},Ae.productId)})}),P.length>0&&i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("div",{className:"font-semibold",children:ae})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total"}),i.jsx("div",{className:"font-semibold",children:td(De)})]})]})]})]}),i.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white px-4 py-3 rounded-xl hover:bg-blue-700 disabled:opacity-60",disabled:K,children:K?"Guardando...":"Registrar venta"})]})]}),G&&i.jsx("p",{className:"mt-2 text-sm",children:G}),D&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-2 sm:p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[98%] sm:w-[95%] max-w-xl p-3 sm:p-4 max-h-[92vh] overflow-auto",children:[i.jsx("h3",{className:"text-lg font-bold mb-3",children:"Nuevo cliente"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:te,onChange:Ae=>ve(Ae.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:Q,onChange:Ae=>Xe(_G(Ae.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:se,onChange:Ae=>Z(Ae.target.value),children:[i.jsx("option",{value:"",children:""}),ZQe.map(Ae=>i.jsx("option",{value:Ae,children:Ae},Ae))]})]}),!E&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:_t,onChange:Ae=>Tt(Ae.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),d.filter(Ae=>(Ae.status??"ACTIVO")==="ACTIVO").map(Ae=>i.jsxs("option",{value:Ae.id,children:[Ae.name,"  ",Ae.branchLabel]},Ae.id))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:ke,onChange:Ae=>Se(Ae.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row justify-end gap-2",children:[i.jsx("button",{className:"w-full sm:w-auto px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{Lt(),V(!1)},children:"Cancelar"}),i.jsx("button",{className:"w-full sm:w-auto px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:async()=>{var ut;const Ae=E?N||r:_t;if(!Ae){M("Selecciona el vendedor para asociar este cliente.");return}if(M(""),!te.trim()){M("Ingresa el nombre del nuevo cliente.");return}const Le=_G(Q);try{const ct=await ta(xt(Ne,"customers_candies"),{name:te.trim(),phone:Le,place:se||"",notes:ke||"",status:Ee,creditLimit:Number(ot||0),createdAt:Nr.now(),sellerId:Ae,vendorId:Ae,vendorName:((ut=d.find(z=>z.id===Ae))==null?void 0:ut.name)||""}),st={id:ct.id,name:te.trim(),phone:Le,place:se||"",status:Ee,creditLimit:Number(ot||0),balance:0,sellerId:Ae};o(z=>[st,...z]),y(ct.id),Lt(),V(!1),M(" Cliente creado")}catch(ct){console.error(ct),M(" Error al crear cliente")}},children:"Guardar cliente"})]})]})}),i.jsx(Te,{open:Rt,onClose:()=>Et(!1),onDetected:Re}),K&&i.jsx("div",{className:"fixed inset-0 z-[70] bg-black/40 flex items-center justify-center p-2",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border px-4 py-3 flex items-center gap-3",children:[i.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-medium",children:"Guardando venta"})]})})]})}const EG=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal"],x_=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function sVe(){const[t,e]=g.useState(Kr(Gu(new Date),"yyyy-MM-dd")),[r,n]=g.useState(Kr($u(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Kr(new Date,"yyyy-MM-dd")),[o,l]=g.useState(""),[c,d]=g.useState(""),[u,f]=g.useState(0),[A,h]=g.useState("PENDIENTE"),[m,p]=g.useState(""),[x,v]=g.useState([]),[y,b]=g.useState(!0),[w,I]=g.useState(""),[j,N]=g.useState(null),[S,E]=g.useState(""),[B,k]=g.useState(""),[T,P]=g.useState(""),[q,de]=g.useState(0),[ce,le]=g.useState("PENDIENTE"),[he,ae]=g.useState("");g.useEffect(()=>{(async()=>{b(!0);try{const D=ar(xt(Ne,"expenses_candies"),kn("date","desc")),V=await Ut(D),te=[];V.forEach(ve=>{const Q=ve.data();te.push({id:ve.id,date:Q.date||Kr(new Date,"yyyy-MM-dd"),category:Q.category||"",description:Q.description||"",amount:Number(Q.amount||0),status:Q.status||"PENDIENTE",notes:Q.notes||"",createdAt:Q.createdAt??Nr.now()})}),v(te)}catch(D){console.error(D),I(" Error al cargar gastos")}finally{b(!1)}})()},[]);const Ce=g.useMemo(()=>x.filter(D=>!(t&&D.date<t||r&&D.date>r)),[x,t,r]),De=g.useMemo(()=>{const D=Ce.reduce((ve,Q)=>ve+(Q.amount||0),0),V=Ce.filter(ve=>ve.status==="PAGADO").reduce((ve,Q)=>ve+(Q.amount||0),0),te=D-V;return{total:D,pagado:V,pendiente:te}},[Ce]),O=()=>{s(Kr(new Date,"yyyy-MM-dd")),l(""),d(""),f(0),h("PENDIENTE"),p("")},R=async D=>{if(D.preventDefault(),I(""),!o){I("Selecciona una categora.");return}if(!c.trim()){I("Ingresa una descripcin.");return}if(!u||u<=0){I("Ingresa un monto vlido.");return}try{const V=await ta(xt(Ne,"expenses_candies"),{date:a,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:A,notes:m||"",createdAt:Nr.now()});v(te=>[{id:V.id,date:a,category:o,description:c.trim(),amount:Number(u.toFixed(2)),status:A,notes:m||"",createdAt:Nr.now()},...te]),O(),I(" Gasto registrado")}catch(V){console.error(V),I(" Error al guardar gasto")}},G=D=>{N(D.id),E(D.date),k(D.category||""),P(D.description||""),de(Number(D.amount||0)),le(D.status||"PENDIENTE"),ae(D.notes||"")},M=()=>{N(null),E(""),k(""),P(""),de(0),le("PENDIENTE"),ae("")},K=async()=>{if(j){if(!B){I("Selecciona una categora.");return}if(!T.trim()){I("Ingresa una descripcin.");return}if(!q||q<=0){I("Ingresa un monto vlido.");return}try{await Mn(Kt(Ne,"expenses_candies",j),{date:S,category:B,description:T.trim(),amount:Number(q.toFixed(2)),status:ce,notes:he||""}),v(D=>D.map(V=>V.id===j?{...V,date:S,category:B,description:T.trim(),amount:Number(q.toFixed(2)),status:ce,notes:he||""}:V)),M(),I(" Gasto actualizado")}catch(D){console.error(D),I(" Error al actualizar gasto")}}},Y=async D=>{confirm(`Eliminar el gasto "${D.description}"?`)&&(await na(Kt(Ne,"expenses_candies",D.id)),v(te=>te.filter(ve=>ve.id!==D.id)),I(" Gasto borrado"))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Dulces)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:D=>e(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:D=>n(D.target.value)})]}),i.jsxs("div",{className:"ml-auto text-sm",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",x_(De.total)]}),i.jsxs("div",{children:["Pagado: ",x_(De.pagado)]}),i.jsxs("div",{children:["Pendiente: ",x_(De.pendiente)]})]})]}),i.jsxs("form",{onSubmit:R,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:a,onChange:D=>s(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:D=>l(D.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),EG.map(D=>i.jsx("option",{value:D,children:D},D))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:D=>d(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:u===0?"":u,onChange:D=>f(Math.max(0,Number(D.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:A,onChange:D=>h(D.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:D=>p(D.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):Ce.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):Ce.slice().sort((D,V)=>D.date.localeCompare(V.date)).map(D=>{const V=j===D.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:V?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:S,onChange:te=>E(te.target.value)}):D.date}),i.jsx("td",{className:"p-2 border",children:V?i.jsxs("select",{className:"w-full border p-1 rounded",value:B,onChange:te=>k(te.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),EG.map(te=>i.jsx("option",{value:te,children:te},te))]}):D.category||""}),i.jsx("td",{className:"p-2 border",children:V?i.jsx("input",{className:"w-full border p-1 rounded",value:T,onChange:te=>P(te.target.value)}):i.jsx("span",{title:D.description,children:D.description.length>40?D.description.slice(0,40)+"":D.description})}),i.jsx("td",{className:"p-2 border",children:V?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(q)?"":q,onChange:te=>de(Math.max(0,Number(te.target.value||0)))}):x_(D.amount)}),i.jsx("td",{className:"p-2 border",children:V?i.jsxs("select",{className:"w-full border p-1 rounded",value:ce,onChange:te=>le(te.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${D.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:D.status})}),i.jsx("td",{className:"p-2 border",children:V?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:he,onChange:te=>ae(te.target.value),maxLength:500}):i.jsx("span",{title:D.notes||"",children:(D.notes||"").length>40?(D.notes||"").slice(0,40)+"":D.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:V?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:K,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:M,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>G(D),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Y(D),children:"Borrar"})]})})})]},D.id)})})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w})]})}const mo=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function iVe(t){var e;return t!=null&&t.date?t.date:(e=t==null?void 0:t.createdAt)!=null&&e.toDate?Kr(t.createdAt.toDate(),"yyyy-MM-dd"):""}function oVe(t,e){var c,d,u;const r=iVe(t);if(!r)return null;let n=0,a=0;const s=Array.isArray(t.items)&&t.items.length>0?t.items:t.item?[t.item]:[],o=s.length?s.map(f=>String(f.productName||f.name||"").trim()).filter(Boolean):t.productName?[String(t.productName).trim()]:[];let l=0;return s.length>0?(n=s.reduce((f,A)=>f+(Number(A.packages??A.qty??A.quantity??0)||0),0),a=Number(t.total??t.itemsTotal??0)||0,a||(a=s.reduce((f,A)=>f+(Number(A.total??A.lineFinal??0)||0),0)),l=s.reduce((f,A)=>f+(Number(A.margenVendedor||0)||0),0)):(n=Number(t.packagesTotal??t.quantity??((c=t.item)==null?void 0:c.packages)??((d=t.item)==null?void 0:d.qty)??0)||0,a=Number(t.total??((u=t.item)==null?void 0:u.total)??0)||0),{id:e,date:r,type:t.type||"CONTADO",total:a,quantity:n,customerId:t.customerId||void 0,customerName:t.customerName||void 0,downPayment:Number(t.downPayment||0),vendorId:t.vendorId||void 0,vendorName:t.vendorName||t.vendor||void 0,vendorCommissionPercent:Number(t.vendorCommissionPercent||0)||0,vendorCommissionAmount:Number(t.vendorCommissionAmount||0)||0,commissionFromItems:Number(l||0)||0,productNames:o}}async function lVe(t){const e=(t||"").trim();if(!e)return;const r=ar(xt(Ne,"ar_movements"),lr("ref.saleId","==",e)),n=await Ut(r);await Promise.all(n.docs.map(a=>na(Kt(Ne,"ar_movements",a.id))))}function cVe({role:t="",sellerCandyId:e="",roles:r}){const n=r&&r.length?r:t,a=Rn(n,"vendedor_dulces"),s=Rn(n,"admin"),o=s?8:7,[l,c]=g.useState(!1),[d,u]=g.useState(!1),[f,A]=g.useState(null),[h,m]=g.useState([]),p=async ee=>{c(!0),u(!0),A(ee),m([]);try{const Ve=await Es(Kt(Ne,"sales_candies",ee)),rt=Ve.exists()?Ve.data():null;if(!rt){m([]);return}const ie=(Array.isArray(rt==null?void 0:rt.items)?rt.items:rt!=null&&rt.item?[rt.item]:[]).map(pe=>({productName:String(pe.productName||""),qty:Number(pe.packages??pe.qty??pe.quantity??0),unitPrice:Number(pe.unitPricePackage??pe.unitPrice??0),discount:Number(pe.discount||0),total:Number(pe.total??pe.lineFinal??0),commission:Number(pe.margenVendedor||0)}));m(ie)}catch(Ve){console.error(Ve)}finally{u(!1)}},[x,v]=g.useState(Kr(new Date,"yyyy-MM-01")),[y,b]=g.useState(Kr(new Date,"yyyy-MM-dd")),[w,I]=g.useState([]),[j,N]=g.useState([]),[S,E]=g.useState(""),[B,k]=g.useState([]),[T,P]=g.useState(!0),[q,de]=g.useState(""),[ce,le]=g.useState(""),[he,ae]=g.useState(""),[Ce,De]=g.useState(""),[O,R]=g.useState(null),G=15,[M,K]=g.useState(1),[Y,D]=g.useState(!1),[V,te]=g.useState(!1),[ve,Q]=g.useState(!1),[Xe,se]=g.useState(!1),Z=g.useMemo(()=>{const ee={};return w.forEach(Ve=>ee[Ve.id]=Ve.name),ee},[w]),ke=g.useMemo(()=>{const ee={};return B.forEach(Ve=>{ee[Ve.id]=Ve}),ee},[B]),Se=g.useMemo(()=>{const ee=new Set;return j.forEach(Ve=>{(Ve.productNames||[]).forEach(rt=>ee.add(rt))}),Array.from(ee).sort((Ve,rt)=>Ve.localeCompare(rt))},[j]),Ee=async()=>{P(!0),de("");try{const ee=[];for(const Me of ot)try{const me=await Es(Kt(Ne,"sales_candies",Me.id)),ye=me.exists()?me.data():null;if(!ye)continue;const mt=Array.isArray(ye.items)?ye.items:ye.item?[ye.item]:[];if(mt.length>0)for(const gt of mt)ee.push({Fecha:Me.date,Venta:Me.id,Tipo:Me.type,Cliente:Me.customerName||"",Vendedor:Me.vendorName||"",Producto:gt.productName||gt.name||"",Paquetes:Number(gt.packages??gt.qty??gt.quantity??0),Precio:Number(gt.unitPricePackage??gt.unitPrice??0),Descuento:Number(gt.discount||0),Monto:Number(gt.total??gt.lineFinal??0),Comision:Number(gt.margenVendedor||0)});else ee.push({Fecha:Me.date,Venta:Me.id,Tipo:Me.type,Cliente:Me.customerName||"",Vendedor:Me.vendorName||"",Producto:Me.productNames&&Me.productNames[0]?Me.productNames[0]:"",Paquetes:Me.quantity,Precio:Me.total,Descuento:0,Monto:Me.total,Comision:Number(Me.commissionFromItems||Me.vendorCommissionAmount||0)})}catch(me){console.error("Error leyendo venta",Me.id,me)}const Ve=pa.json_to_sheet(ee),rt=pa.book_new();pa.book_append_sheet(rt,Ve,"Productos");const $e=I1(rt,{bookType:"xlsx",type:"array"}),ie=new Blob([$e],{type:"application/octet-stream"}),pe=URL.createObjectURL(ie),fe=document.createElement("a");fe.href=pe,fe.download=`ventas_productos_${x}_a_${y}.xlsx`,fe.click(),URL.revokeObjectURL(pe),de(` Exportado ${ee.length} fila(s)`)}catch(ee){console.error(ee),de(" Error exportando a Excel")}finally{P(!1)}},Ze=ee=>{const Ve=Number(ee.commissionFromItems||0);if(Ve>0)return Number(Ve.toFixed(2));const rt=Number(ee.vendorCommissionAmount||0);if(rt>0)return Number(rt.toFixed(2));if(!ee.vendorId)return 0;const $e=ke[ee.vendorId];if(!$e||!$e.commissionPercent)return 0;const ie=(Number(ee.total)||0)*(Number($e.commissionPercent)||0)/100;return Number(ie.toFixed(2))};g.useEffect(()=>{(async()=>{P(!0),de("");try{const ee=await Ut(xt(Ne,"customers_candies")),Ve=[];ee.forEach(fe=>Ve.push({id:fe.id,name:fe.data().name||""})),I(Ve);const rt=await Ut(xt(Ne,"sellers_candies")),$e=[];rt.forEach(fe=>{const Me=fe.data();$e.push({id:fe.id,name:Me.name||"",commissionPercent:Number(Me.commissionPercent||0)})}),k($e);const ie=await Ut(ar(xt(Ne,"sales_candies"),kn("createdAt","desc"))),pe=[];ie.forEach(fe=>{const Me=oVe(fe.data(),fe.id);Me&&Me.date>=x&&Me.date<=y&&pe.push(Me)}),N(pe.sort((fe,Me)=>Me.date.localeCompare(fe.date))),K(1)}catch(ee){console.error(ee),de(" Error cargando transacciones.")}finally{P(!1)}})()},[x,y]);const ot=g.useMemo(()=>j.filter(ee=>!(a&&(!e||!ee.vendorId||ee.vendorId!==e)||Ce&&(!ee.vendorId||ee.vendorId!==Ce)||ce&&ee.customerId!==ce||he&&ee.type!==he||S&&(!ee.productNames||!ee.productNames.includes(S)))),[j,ce,he,S,Ce,a,e]),vt=g.useMemo(()=>{let ee=0,Ve=0,rt=0,$e=0,ie=0,pe=0;for(const fe of ot)fe.type==="CONTADO"?(ee+=fe.quantity,rt+=fe.total,ie+=Ze(fe)):(Ve+=fe.quantity,$e+=fe.total,pe+=Ze(fe));return{packsCash:ee,packsCredito:Ve,montoCash:rt,montoCredito:$e,comisionCash:ie,comisionCredito:pe}},[ot]),_t=Math.max(1,Math.ceil(ot.length/G)),Tt=g.useMemo(()=>{const ee=(M-1)*G;return ot.slice(ee,ee+G)},[ot,M]),Lt=g.useMemo(()=>Tt.filter(ee=>ee.type==="CONTADO"),[Tt]),Rt=g.useMemo(()=>Tt.filter(ee=>ee.type==="CREDITO"),[Tt]),Et=g.useMemo(()=>f&&j.find(ee=>ee.id===f)||null,[f,j]),Re=async ee=>{if(s&&(R(null),!!window.confirm("Eliminar esta venta de dulces? Se restaurar el inventario asociado.")))try{P(!0);const Ve=ee.id.split("#")[0];await Y2(Ve),await lVe(Ve),N(rt=>rt.filter($e=>$e.id!==ee.id)),de(" Venta eliminada y saldo del cliente ajustado")}catch(Ve){console.error(Ve),de(" No se pudo eliminar la venta.")}finally{P(!1)}},Te=()=>{const ee=`Ventas del dia  ${x} a ${y}`,Ve=pe=>(pe||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),rt=ot.map(pe=>{const fe=pe.customerName||(pe.customerId?Z[pe.customerId]:"")||"Nombre cliente";return`<tr>
          <td>${pe.date}</td>
          <td>${Ve(fe)}</td>
          <td>${pe.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${pe.quantity}</td>
          <td style="text-align:right">${mo(pe.total)}</td>
        </tr>`}).join(""),$e=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${Ve(ee)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${Ve(ee)}</h1>
      <div class="kpis">
        <div><b>Paquetes Cash:</b> ${vt.packsCash}</div>
        <div><b>Paquetes Crdito:</b> ${vt.packsCredito}</div>
        <div><b>Monto Cash:</b> ${mo(vt.montoCash)}</div>
        <div><b>Monto Crdito:</b> ${mo(vt.montoCredito)}</div>
      </div>
      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Paquetes</th><th>Monto</th>
      </tr></thead><tbody>
      ${rt||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,ie=window.open("","_blank");ie&&(ie.document.open(),ie.document.write($e),ie.document.close())},Ye=()=>K(1),dt=()=>K(ee=>Math.max(1,ee-1)),Fe=()=>K(ee=>Math.min(_t,ee+1)),je=()=>K(_t),We=()=>{const ee=[];if(_t<=7)for(let rt=1;rt<=_t;rt++)ee.push(rt);else{const rt=Math.max(1,M-2),$e=Math.min(_t,M+2);ee.push(1),rt>2&&ee.push(-1);for(let ie=rt;ie<=$e;ie++)ie!==1&&ie!==_t&&ee.push(ie);$e<_t-1&&ee.push(-2),ee.push(_t)}return i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Ye,disabled:M===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:dt,disabled:M===1,children:" Anterior"}),ee.map((rt,$e)=>typeof rt=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${rt===M?"bg-blue-600 text-white":""}`,onClick:()=>K(rt),children:rt},$e):i.jsx("span",{className:"px-2",children:""},$e)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Fe,disabled:M===_t,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:je,disabled:M===_t,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",M," de ",_t,"  ",ot.length," transaccin(es)"]})]})};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas del dia"}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>D(ee=>!ee),"aria-expanded":Y,children:[i.jsx("span",{children:"Filtros"}),i.jsx("span",{className:`transition-transform ${Y?"rotate-180":""}`,children:""})]}),Y&&i.jsx("div",{className:"p-4 border-t",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:x,onChange:ee=>{v(ee.target.value),K(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:y,onChange:ee=>{b(ee.target.value),K(1)}})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:ce,onChange:ee=>{le(ee.target.value),K(1)},children:[i.jsx("option",{value:"",children:"Todos"}),w.map(ee=>i.jsx("option",{value:ee.id,children:ee.name},ee.id))]})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:Ce,onChange:ee=>{De(ee.target.value),K(1)},children:[i.jsx("option",{value:"",children:"Todos"}),B.map(ee=>i.jsx("option",{value:ee.id,children:ee.name},ee.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:he,onChange:ee=>{ae(ee.target.value),K(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:S,onChange:ee=>{E(ee.target.value),K(1)},disabled:Se.length===0,children:[i.jsx("option",{value:"",children:"Todos"}),Se.map(ee=>i.jsx("option",{value:ee,children:ee},ee))]})]}),i.jsx("button",{className:"sm:col-span-2 lg:col-span-1 px-2 py-1 text-sm sm:px-3 sm:py-2 rounded bg-blue-600 text-white hover:bg-blue-700 w-full",onClick:Te,children:"Exportar PDF"}),i.jsx("button",{className:"sm:col-span-2 lg:col-span-1 px-2 py-1 text-sm sm:px-3 sm:py-2 rounded bg-green-600 text-white hover:bg-green-700 w-full",onClick:Ee,children:"Exportar Excel (Sbana)"})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>te(ee=>!ee),"aria-expanded":V,children:[i.jsx("span",{children:"Indicadores"}),i.jsx("span",{className:`transition-transform ${V?"rotate-180":""}`,children:""})]}),V&&i.jsx("div",{className:"p-4 border-t",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:vt.packsCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:vt.packsCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:mo(vt.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:mo(vt.montoCredito)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:mo(vt.comisionCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:mo(vt.comisionCredito)})]})]})})]}),i.jsxs("div",{className:"block md:hidden space-y-3",children:[T?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Cargando"}):Tt.length===0?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Sin transacciones en el rango."}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white border rounded-xl shadow",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Q(ee=>!ee),"aria-expanded":ve,children:[i.jsx("span",{children:"Cash"}),i.jsx("span",{className:`transition-transform ${ve?"rotate-180":""}`,children:""})]}),ve&&i.jsx("div",{className:"p-3 border-t space-y-3",children:Lt.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"Sin transacciones cash."}):Lt.map(ee=>{const Ve=ee.customerName||(ee.customerId?Z[ee.customerId]:"")||"Nombre cliente",rt=Ze(ee);return i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:Ve}),i.jsx("div",{className:"text-xs text-gray-600 shrink-0",children:ee.date})]}),i.jsxs("div",{className:"mt-1 flex items-center gap-2 flex-wrap text-xs",children:[i.jsx("span",{className:"px-2 py-1 rounded-full border bg-green-50 border-green-200 text-green-700",children:"Cash"}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Paquetes:"})," ",i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:$e=>{$e.preventDefault(),p(ee.id)},title:"Ver detalle",children:ee.quantity})]}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Monto:"})," ",mo(ee.total)]})]})]}),i.jsx("div",{className:"text-gray-500 mt-1",children:i.jsx("span",{className:"inline-block transition-transform group-open:rotate-180",children:""})})]}),i.jsx("div",{className:"px-3 pb-3 pt-0 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2 border-t pt-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("span",{className:"font-medium text-right",children:Ve})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha"}),i.jsx("span",{className:"font-medium",children:ee.date})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("span",{className:"font-medium",children:"Cash"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes"}),i.jsx("span",{className:"font-medium",children:i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:()=>p(ee.id),title:"Ver detalle",children:ee.quantity})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Monto"}),i.jsx("span",{className:"font-semibold",children:mo(ee.total)})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("span",{className:"font-medium",children:rt>0?mo(rt):""})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("span",{className:"font-medium",children:ee.vendorName||""})]}),s&&i.jsxs("div",{className:"pt-2 flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border hover:bg-gray-50",onClick:()=>R($e=>$e===ee.id?null:ee.id),children:" Acciones"}),O===ee.id&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>Re(ee),children:"Eliminar"})]})]})})]})},ee.id)})})]}),i.jsxs("div",{className:"bg-white border rounded-xl shadow",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>se(ee=>!ee),"aria-expanded":Xe,children:[i.jsx("span",{children:"Crdito"}),i.jsx("span",{className:`transition-transform ${Xe?"rotate-180":""}`,children:""})]}),Xe&&i.jsx("div",{className:"p-3 border-t space-y-3",children:Rt.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"Sin transacciones crdito."}):Rt.map(ee=>{const Ve=ee.customerName||(ee.customerId?Z[ee.customerId]:"")||"Nombre cliente",rt=Ze(ee);return i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:Ve}),i.jsx("div",{className:"text-xs text-gray-600 shrink-0",children:ee.date})]}),i.jsxs("div",{className:"mt-1 flex items-center gap-2 flex-wrap text-xs",children:[i.jsx("span",{className:"px-2 py-1 rounded-full border bg-yellow-50 border-yellow-200 text-yellow-700",children:"Crdito"}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Paquetes:"})," ",i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:$e=>{$e.preventDefault(),p(ee.id)},title:"Ver detalle",children:ee.quantity})]}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Monto:"})," ",mo(ee.total)]})]})]}),i.jsx("div",{className:"text-gray-500 mt-1",children:i.jsx("span",{className:"inline-block transition-transform group-open:rotate-180",children:""})})]}),i.jsx("div",{className:"px-3 pb-3 pt-0 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2 border-t pt-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("span",{className:"font-medium text-right",children:Ve})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha"}),i.jsx("span",{className:"font-medium",children:ee.date})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("span",{className:"font-medium",children:"Crdito"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes"}),i.jsx("span",{className:"font-medium",children:i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:()=>p(ee.id),title:"Ver detalle",children:ee.quantity})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Monto"}),i.jsx("span",{className:"font-semibold",children:mo(ee.total)})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("span",{className:"font-medium",children:rt>0?mo(rt):""})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("span",{className:"font-medium",children:ee.vendorName||""})]}),s&&i.jsxs("div",{className:"pt-2 flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border hover:bg-gray-50",onClick:()=>R($e=>$e===ee.id?null:ee.id),children:" Acciones"}),O===ee.id&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>Re(ee),children:"Eliminar"})]})]})})]})},ee.id)})})]})]}),i.jsx("div",{className:"bg-white p-3 rounded shadow border",children:We()})]}),i.jsxs("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Comisin"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),s&&i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:T?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Cargando"})}):Tt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Sin transacciones en el rango."})}):Tt.map(ee=>{const Ve=ee.customerName||(ee.customerId?Z[ee.customerId]:"")||"Nombre cliente",rt=Ze(ee);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ee.date}),i.jsx("td",{className:"p-2 border",children:Ve}),i.jsx("td",{className:"p-2 border",children:ee.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver detalle de productos de esta venta",onClick:()=>p(ee.id),children:ee.quantity})}),i.jsx("td",{className:"p-2 border",children:mo(ee.total)}),i.jsx("td",{className:"p-2 border",children:rt>0?mo(rt):""}),i.jsx("td",{className:"p-2 border",children:ee.vendorName||""}),s&&i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>R($e=>$e===ee.id?null:ee.id),title:"Acciones",children:""}),O===ee.id&&i.jsx("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>Re(ee),children:"Eliminar"})})]})]},ee.id)})})]}),We()]}),q&&i.jsx("p",{className:"mt-2 text-sm",children:q}),l&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Productos/paquetes vendidos"," ",f?` #${f}`:""]}),Et&&i.jsxs("div",{className:"text-sm text-gray-700 mt-1",children:["Comisin de vendedor:"," ",i.jsx("span",{className:"font-semibold",children:Ze(Et)>0?mo(Ze(Et)):""})]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>c(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"}),i.jsx("th",{className:"p-2 border text-right",children:"Comisin"})]})}),i.jsx("tbody",{children:d?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):h.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin tems en esta venta."})}):h.map((ee,Ve)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:ee.productName}),i.jsx("td",{className:"p-2 border text-right",children:ee.qty}),i.jsx("td",{className:"p-2 border text-right",children:mo(ee.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:mo(ee.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:mo(ee.total)}),i.jsx("td",{className:"p-2 border text-right",children:mo(ee.commission||0)})]},Ve))})]})})]})})]})}const Tn=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function lb(t){var r;const e=t==null?void 0:t.date;return e||((r=t==null?void 0:t.createdAt)!=null&&r.toDate?Kr(t.createdAt.toDate(),"yyyy-MM-dd"):"")}function dVe(t){if(Array.isArray(t==null?void 0:t.items))return t.items.map(n=>{const a=Number((n==null?void 0:n.packages)??(n==null?void 0:n.qty)??(n==null?void 0:n.quantity)??0)||0,s=Number((n==null?void 0:n.unitPricePackage)??(n==null?void 0:n.unitPrice)??0)||(a>0?Number((n==null?void 0:n.total)??(n==null?void 0:n.lineFinal)??0)/a:0)||0;return{productId:String((n==null?void 0:n.productId)||""),productName:String((n==null?void 0:n.productName)||""),sku:(n==null?void 0:n.sku)||"",qty:a,unitPrice:Number(s||0),discount:Number((n==null?void 0:n.discount)||0),vendorCommissionAmount:Number((n==null?void 0:n.vendorCommissionAmount)??(n==null?void 0:n.commissionAmount)??0),uBruta:Number((n==null?void 0:n.uBruta)??(n==null?void 0:n.grossProfit)??0)}});if(t!=null&&t.item){const n=t.item,a=Number((n==null?void 0:n.packages)??(n==null?void 0:n.qty)??(n==null?void 0:n.quantity)??0)||Number((t==null?void 0:t.packagesTotal)??(t==null?void 0:t.quantity)??0)||0,s=Number((n==null?void 0:n.unitPricePackage)??(n==null?void 0:n.unitPrice)??0)||(a>0?Number((n==null?void 0:n.total)??(t==null?void 0:t.total)??0)/a:0)||0;return[{productId:String((n==null?void 0:n.productId)||""),productName:String((n==null?void 0:n.productName)||""),sku:(n==null?void 0:n.sku)||"",qty:a,unitPrice:Number(s||0),discount:Number((n==null?void 0:n.discount)||0),vendorCommissionAmount:Number((n==null?void 0:n.vendorCommissionAmount)??(n==null?void 0:n.commissionAmount)??0),uBruta:Number((n==null?void 0:n.uBruta)??(n==null?void 0:n.grossProfit)??0)}]}const e=Number((t==null?void 0:t.packagesTotal)??(t==null?void 0:t.quantity)??0)||0,r=e>0?Number((t==null?void 0:t.total)||0)/e:0;return e>0?[{productId:String((t==null?void 0:t.productId)||""),productName:String((t==null?void 0:t.productName)||""),sku:(t==null?void 0:t.sku)||"",qty:e,unitPrice:Number(r||0),discount:Number((t==null?void 0:t.discount)||0),vendorCommissionAmount:Number((t==null?void 0:t.vendorCommissionAmount)??(t==null?void 0:t.commissionAmount)??0),uBruta:Number((t==null?void 0:t.uBruta)??(t==null?void 0:t.grossProfit)??0)}]:[]}function uVe(t,e){const r=lb(t);if(!r)return null;const n=t.vendorId||t.sellerId||void 0,a=t.vendorName||t.sellerName||void 0,s=dVe(t);let o=Number(t.total??t.itemsTotal??0)||s.reduce((l,c)=>{const d=(Number(c.qty||0)||0)*(Number(c.unitPrice||0)||0),u=Math.max(0,Number(c.discount||0)),f=Math.max(0,d-u);return l+f},0);return o=Number(o||0),{id:e,date:r,type:t.type||"CONTADO",total:o,items:s,customerId:t.customerId||void 0,customerName:t.customerName||void 0,vendorId:n,vendorName:a,vendorCommissionAmount:Number(t.vendorCommissionAmount||0)||0}}function fVe(t,e,r,n){const a={};for(const l of t)a[l.productId]||(a[l.productId]={productName:l.productName,lots:[]}),a[l.productId].lots.push({date:l.date,qtyLeft:Number(l.quantity||0),cost:Number(l.purchasePrice||0)});for(const l of Object.keys(a))a[l].lots.sort((c,d)=>c.date.localeCompare(d.date));const s=[...e].sort((l,c)=>l.date.localeCompare(c.date));let o=0;for(const l of s)for(const c of l.items||[]){const d=a[c.productId];if(!d)continue;let u=Number(c.qty||0);if(!(u<=0))for(const f of d.lots){if(u<=0)break;if(f.qtyLeft<=0)continue;const A=Math.min(f.qtyLeft,u);l.date>=r&&l.date<=n&&(o+=A*f.cost),f.qtyLeft-=A,u-=A}}return o}async function hVe(t){const e=ar(xt(Ne,"ar_movements"),lr("ref.saleId","==",t)),r=await Ut(e);await Promise.all(r.docs.map(n=>na(Kt(Ne,"ar_movements",n.id))))}function AVe(){const{refreshKey:t,refresh:e}=bc(),[r,n]=g.useState(Kr(Gu(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Kr($u(new Date),"yyyy-MM-dd")),[o,l]=g.useState([]),[c,d]=g.useState([]),[u,f]=g.useState([]),[A,h]=g.useState([]),[m,p]=g.useState([]),[x,v]=g.useState([]),[y,b]=g.useState(!0),[w,I]=g.useState(""),[j,N]=g.useState([]),[S,E]=g.useState({}),[B,k]=g.useState({}),[T,P]=g.useState(!1),[q,de]=g.useState(null),[ce,le]=g.useState([]),[he,ae]=g.useState(!1),[Ce,De]=g.useState({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0}),[O,R]=g.useState(!1),[G,M]=g.useState(""),[K,Y]=g.useState([]),[D,V]=g.useState(!1),[te,ve]=g.useState("CASH"),[Q,Xe]=g.useState(1),se=10,[Z,ke]=g.useState(!1),[Se,Ee]=g.useState(null);g.useEffect(()=>{(async()=>{try{const ee=await Ut(xt(Ne,"sellers_candies")),Ve=[];ee.forEach(rt=>{const $e=rt.data();Ve.push({id:rt.id,name:$e.name||"",commissionPercent:Number($e.commissionPercent||0)})}),N(Ve)}catch(ee){console.error("Error cargando sellers_candies",ee)}})()},[]);const Ze=g.useMemo(()=>{const ee={};return j.forEach(Ve=>{ee[Ve.id]=Ve}),ee},[j]);g.useEffect(()=>{(async()=>{b(!0),I("");try{const ee=await Ut(xt(Ne,"sales_candies")),Ve=[],rt=[];ee.forEach(Oe=>{const be=Oe.data(),Ae=uVe(be,Oe.id);Ae&&(Ae.date<=a&&Ve.push(Ae),Ae.date>=r&&Ae.date<=a&&rt.push(Ae))}),d(Ve),l(rt);const $e=await Ut(xt(Ne,"inventory_candies")),ie=[];$e.forEach(Oe=>{const be=Oe.data(),Ae=lb(be);if(!Ae||Ae>a)return;const Le=Math.max(1,Math.floor(Number(be.unitsPerPackage||1))),ut=Number(be.totalUnits??be.quantity??0),ct=Number(be.packages??0),st=Number(be.remaining??0),z=Number(be.remainingPackages??0),X=ct>0?ct:ut>0?Math.floor(ut/Le):0,re=z>0?z:st>0?Math.floor(st/Le):0;ie.push({id:Oe.id,productId:be.productId,productName:be.productName||"",date:Ae,quantity:Number(X||0),remaining:Number(re||0),purchasePrice:Number(be.providerPrice||be.purchasePrice||0),unitsPerPackage:Le})}),f(ie);const pe=await Ut(xt(Ne,"expenses_candies")),fe=[];pe.forEach(Oe=>{const be=Oe.data(),Ae=lb(be);Ae&&Ae>=r&&Ae<=a&&fe.push({id:Oe.id,date:Ae,category:be.category||"",description:be.description||"",amount:Number(be.amount||0),status:be.status||""})}),h(fe);const Me=await Ut(xt(Ne,"ar_movements")),me=[],ye={};Me.forEach(Oe=>{const be=Oe.data(),Ae=lb(be);if(!Ae)return;const Le=be.customerId,ut=Number(be.amount||0);Le&&(ye[Le]=(ye[Le]||0)+ut),be.type==="ABONO"&&Ae>=r&&Ae<=a&&me.push({id:Oe.id,customerId:Le,type:"ABONO",amount:ut,date:Ae})}),p(me);const mt=await Ut(xt(Ne,"customers_candies")),gt=[];mt.forEach(Oe=>{const be=Oe.data();gt.push({id:Oe.id,name:be.name||"",balance:ye[Oe.id]||0})}),v(gt);const yt=await Ut(xt(Ne,"inventory_candies_sellers")),Pt={},Ft={};yt.forEach(Oe=>{const be=Oe.data(),Ae=lb(be);if(!Ae||Ae<r||Ae>a)return;const Le=be.sellerId||be.vendorId||"NO_VENDOR",ut=be.productName||"",ct=be.sku||"",st=Math.max(1,Math.floor(Number(be.unitsPerPackage||1))),z=Number(be.totalUnits??0),X=Number(be.packages??0),re=Number(be.remainingUnits??be.remaining??0),H=Number(be.remainingPackages??0),L=X>0?X:z>0?Math.floor(z/st):0,ue=H>0?H:re>0?Math.floor(re/st):0,Pe=Number(be.totalVendor??0),xe=Number(be.uVendor??0),Ge=Number(be.subtotal??0),ze=Number(be.uBruta??0),Ke=L,pt=Ke>0?Pe/Ke:0,ne=Ke>0?xe/Ke:0,Ue=Ke>0?Ge/Ke:0,tt=Ke>0?ze>0?ze/Ke:pt-Ue:0;if(Pt[Le]||(Pt[Le]={associated:[],remaining:[]}),L>0){const nt=L,wt=nt*pt,Bt=nt*Ue,tr=wt,Or=nt*ne,zr=nt*tt;Pt[Le].associated.push({saleId:Oe.id,date:Ae,productId:be.productId||be.id||"",productName:ut,sku:ct,qty:nt,unitPrice:pt,costTotal:Bt,lineTotal:wt,discount:0,lineFinal:tr,grossProfit:zr,vendorCommissionAmount:Or,type:"ASSOCIATED"}),Ft[Le]=(Ft[Le]||0)+nt}if(ue>0){const nt=ue,wt=nt*pt,Bt=nt*Ue,tr=wt,Or=nt*ne,zr=nt*tt;Pt[Le].remaining.push({saleId:Oe.id,date:Ae,productId:be.productId||be.id||"",productName:ut,sku:ct,qty:nt,unitPrice:pt,costTotal:Bt,lineTotal:wt,discount:0,lineFinal:tr,grossProfit:zr,vendorCommissionAmount:Or,type:"REMAINING"})}}),E(Pt),k(Ft)}catch(ee){console.error(ee),I(" Error cargando datos del dashboard.")}finally{b(!1)}})()},[r,a,t]);const ot=g.useCallback((ee,Ve)=>{const rt=Number(Ve.vendorCommissionAmount||0)||0;if(rt>0)return rt;const $e=Number(ee.vendorCommissionAmount||0)||0;if($e<=0)return 0;const ie=Number(Ve.qty||0),pe=Number(Ve.unitPrice||0),fe=ie*pe,Me=Math.max(0,Number(Ve.discount||0)),me=Math.max(0,fe-Me);return!me||!ee.total?0:$e*me/ee.total},[]),vt=g.useMemo(()=>{try{return fVe(u,c,r,a)}catch(ee){return console.error(ee),0}},[u,c,r,a]),_t=g.useMemo(()=>{const ee=o.reduce((yt,Pt)=>yt+(Pt.total||0),0),Ve=A.reduce((yt,Pt)=>yt+(Pt.amount||0),0),rt=ee-vt,$e=rt-Ve;let ie=0;for(const yt of o)for(const Pt of yt.items||[]){const Ft=Number(Pt.uBruta||0);Number.isFinite(Ft)&&(ie+=Ft)}const pe=m.reduce((yt,Pt)=>yt+Math.abs(Pt.amount||0),0),fe=x.filter(yt=>(yt.balance||0)>0),Me=fe.reduce((yt,Pt)=>yt+(Pt.balance||0),0);let me=0,ye=0,mt=0,gt=0;for(const yt of o){const Pt=(yt.items||[]).reduce((Oe,be)=>Oe+(Number(be.qty)||0),0),Ft=(yt.items||[]).reduce((Oe,be)=>Oe+ot(yt,be),0);yt.type==="CONTADO"?(me+=Pt,mt+=Ft):(ye+=Pt,gt+=Ft)}return{ventasTotales:ee,costoMercaderia:vt,gastosPeriodo:Ve,gananciaAntes:rt,utilidadBrutaOrdenes:ie,gananciaDespues:$e,abonosRecibidos:pe,saldosPendientes:Me,clientesConSaldo:fe.length,paquetesCash:me,paquetesCredito:ye,comisionCash:mt,comisionCredito:gt}},[o,A,m,x,vt,ot,S]),Tt=g.useMemo(()=>{const ee={},Ve={};for(const rt of o)if(!(rt.type!=="CREDITO"||!rt.customerId))for(const $e of rt.items||[]){const ie=Number($e.qty||0),pe=Number($e.unitPrice||0),fe=ie*pe,Me=Math.max(0,Number($e.discount||0)),me=Math.max(0,fe-Me);ee[rt.customerId]=(ee[rt.customerId]||0)+ie,Ve[rt.customerId]=(Ve[rt.customerId]||0)+me}return x.filter(rt=>(rt.balance||0)>0).map(rt=>({customerId:rt.id,name:rt.name,paquetesAsociados:ee[rt.id]||0,saldoTotal:Ve[rt.id]||0,saldoPendiente:rt.balance||0})).sort((rt,$e)=>$e.saldoPendiente-rt.saldoPendiente)},[x,o]),Lt=g.useMemo(()=>{const ee={};return x.forEach(Ve=>ee[Ve.id]=Ve.name),ee},[x]),Rt=g.useMemo(()=>[...o].sort((ee,Ve)=>Ve.date.localeCompare(ee.date)).map(ee=>{var ie;const Ve=(ee.items||[]).reduce((pe,fe)=>pe+(Number(fe.qty)||0),0);let rt="Cash";ee.type==="CREDITO"&&ee.customerId?rt=Lt[ee.customerId]||"":ee.type==="CONTADO"&&(rt=((ie=ee.customerName)==null?void 0:ie.trim())||"Cash");const $e=Ve>0?ee.total/Ve:0;return{id:ee.id,date:ee.date,type:ee.type==="CREDITO"?"Crdito":"Cash",customer:rt,paquetes:Ve,total:Number(ee.total||0),avgPrice:$e}}),[o,Lt]),Et=g.useMemo(()=>{var Ve,rt;const ee=new Map;for(const $e of o){const ie=$e.vendorId||"NO_VENDOR",pe=$e.vendorName||((Ve=Ze[ie])==null?void 0:Ve.name)||"Sin vendedor";ee.has(ie)||ee.set(ie,{vendorId:ie,vendorName:pe,paquetesAsociados:0,paquetesVendidos:0,paquetesFiados:0,totalVendido:0,totalFiado:0,comisionCash:0,comisionCredito:0,paquetesRestantes:0});const fe=ee.get(ie);for(const Me of $e.items||[]){const me=Number(Me.qty||0),ye=Number(Me.unitPrice||0),mt=me*ye,gt=Math.max(0,Number(Me.discount||0)),yt=Math.max(0,mt-gt),Pt=ot($e,Me);$e.type==="CONTADO"?(fe.paquetesVendidos+=me,fe.totalVendido+=yt,fe.comisionCash+=Pt):(fe.paquetesFiados+=me,fe.totalFiado+=yt,fe.comisionCredito+=Pt)}}for(const[$e,ie]of Object.entries(B)){const pe=ee.get($e),fe=(pe==null?void 0:pe.vendorName)||((rt=Ze[$e])==null?void 0:rt.name)||"Sin vendedor",Me=pe||{vendorId:$e,vendorName:fe,paquetesAsociados:0,paquetesVendidos:0,paquetesFiados:0,totalVendido:0,totalFiado:0,comisionCash:0,comisionCredito:0,paquetesRestantes:0};Me.paquetesAsociados=ie,Me.paquetesRestantes=Math.max(ie-Me.paquetesVendidos-Me.paquetesFiados,0),ee.set($e,Me)}return Array.from(ee.values()).sort(($e,ie)=>ie.totalVendido+ie.totalFiado-($e.totalVendido+$e.totalFiado))},[o,B,Ze,ot]),Re=async ee=>{P(!0),de({id:ee.customerId,name:ee.name}),le([]),ae(!0),De({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});try{const Ve=[];let rt=0,$e=0,ie=0;for(const me of o)if(!(me.type!=="CREDITO"||me.customerId!==ee.customerId))for(const ye of me.items||[]){const mt=Number(ye.qty||0),gt=Number(ye.unitPrice||0),yt=mt*gt,Pt=Math.max(0,Number(ye.discount||0)),Ft=Math.max(0,yt-Pt);Ve.push({saleId:me.id,date:me.date,productName:ye.productName,sku:ye.sku||"",qty:mt,unitPrice:gt,lineTotal:yt,discount:Pt,lineFinal:Ft}),rt+=yt,$e+=Pt,ie+=Ft}let pe=0;for(const me of m)me.customerId===ee.customerId&&(pe+=Math.abs(me.amount||0));const fe=x.find(me=>me.id===ee.customerId),Me=(fe==null?void 0:fe.balance)||0;le(Ve),De({totalBruto:rt,totalDescuento:$e,totalFiado:ie,saldoActual:Me,abonadoPeriodo:pe})}catch(Ve){console.error(Ve),I(" No se pudo cargar el detalle del cliente.")}finally{ae(!1)}},Te=(ee,Ve,rt)=>{R(!0),ve(rt),Xe(1);let $e="";rt==="ASSOCIATED"?$e=`Paquetes asociados  ${Ve}`:rt==="REMAINING"?$e=`Paquetes restantes  ${Ve}`:rt==="CASH"?$e=`Paquetes vendidos (Cash)  ${Ve}`:$e=`Paquetes fiados (Crdito)  ${Ve}`,M($e),Y([]),V(!0);try{if(rt==="ASSOCIATED"||rt==="REMAINING"){const pe=S[ee],fe=rt==="ASSOCIATED"?(pe==null?void 0:pe.associated)||[]:(pe==null?void 0:pe.remaining)||[];Y([...fe].sort((Me,me)=>(me.qty||0)-(Me.qty||0))),V(!1);return}const ie=[];for(const pe of o)if(((pe.vendorId||"NO_VENDOR")===ee||!pe.vendorId&&ee==="NO_VENDOR")&&!(rt==="CASH"&&pe.type!=="CONTADO")&&!(rt==="CREDIT"&&pe.type!=="CREDITO"))for(const Me of pe.items||[]){const me=Number(Me.qty||0),ye=Number(Me.unitPrice||0),mt=me*ye,gt=Math.max(0,Number(Me.discount||0)),yt=Math.max(0,mt-gt),Pt=ot(pe,Me);ie.push({saleId:pe.id,date:pe.date,productName:Me.productName,sku:Me.sku||"",qty:me,unitPrice:ye,lineTotal:mt,discount:gt,lineFinal:yt,vendorCommissionAmount:Pt,type:rt})}Y(ie.sort((pe,fe)=>pe.date.localeCompare(fe.date)))}catch(ie){console.error(ie),I(" No se pudo cargar el detalle del vendedor.")}finally{V(!1)}},Ye=g.useMemo(()=>te!=="ASSOCIATED"&&te!=="REMAINING"?1:Math.max(1,Math.ceil(K.length/se)),[te,K.length]),dt=g.useMemo(()=>{if(te!=="ASSOCIATED"&&te!=="REMAINING")return K;const ee=(Q-1)*se;return K.slice(ee,ee+se)},[te,Q,K]),Fe=te==="ASSOCIATED"||te==="REMAINING"?10:8;g.useEffect(()=>{te!=="ASSOCIATED"&&te!=="REMAINING"||Q>Ye&&Xe(Ye)},[te,Q,Ye]);const je=ee=>{const Ve=o.find(rt=>rt.id===ee)||null;Ee(Ve),ke(!0)},We=async ee=>{if(window.confirm("Eliminar esta venta? Esta accin no se puede deshacer."))try{await Y2(ee),await hVe(ee),l(Ve=>Ve.filter(rt=>rt.id!==ee)),d(Ve=>Ve.filter(rt=>rt.id!==ee)),ke(!1),Ee(null)}catch(Ve){console.error(Ve),alert("No se pudo eliminar la venta. Revisa la consola para ms detalles.")}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas (Dulces)"}),i.jsx(yc,{onClick:e,loading:y})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:ee=>n(ee.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:ee=>s(ee.target.value)})]})]}),i.jsx("div",{className:"md:hidden mb-4",children:i.jsxs("details",{className:"bg-white border rounded-lg shadow",open:!0,children:[i.jsx("summary",{className:"cursor-pointer px-3 py-2 font-semibold",children:"KPIs"}),i.jsx("div",{className:"p-3",children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:Tn(_t.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Contado + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:Tn(_t.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:Tn(_t.utilidadBrutaOrdenes||0)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos"}),i.jsx("div",{className:"text-xl font-semibold",children:Tn(_t.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Neta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:Tn(_t.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:Tn(_t.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:Tn(_t.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:_t.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:_t.paquetesCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito (vendidos)"}),i.jsx("div",{className:"text-xl font-semibold",children:_t.paquetesCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Tn(_t.comisionCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:Tn(_t.comisionCredito)})]})]})})]})}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:Tn(_t.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Contado + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:Tn(_t.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:Tn(_t.utilidadBrutaOrdenes||0)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos"}),i.jsx("div",{className:"text-xl font-semibold",children:Tn(_t.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Neta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:Tn(_t.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:Tn(_t.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:Tn(_t.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:_t.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:_t.paquetesCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito (vendidos)"}),i.jsx("div",{className:"text-xl font-semibold",children:_t.paquetesCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Tn(_t.comisionCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:Tn(_t.comisionCredito)})]})]}),i.jsx("div",{className:"md:hidden mb-6",children:i.jsxs("details",{className:"bg-white border rounded-lg shadow",children:[i.jsx("summary",{className:"cursor-pointer px-3 py-2 font-semibold",children:"Consolidado clientes y vendedores"}),i.jsxs("div",{className:"p-3",children:[i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Consolidado por cliente (Crdito)"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full mb-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Paquetes asociados"}),i.jsx("th",{className:"p-2 border",children:"Saldo total"}),i.jsx("th",{className:"p-2 border",children:"Saldo pendiente"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):Tt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin clientes con saldo"})}):Tt.map(ee=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ee.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Re({customerId:ee.customerId,name:ee.name}),title:"Ver paquetes fiados del periodo",children:ee.paquetesAsociados})}),i.jsx("td",{className:"p-2 border",children:Tn(ee.saldoTotal)}),i.jsx("td",{className:"p-2 border font-semibold",children:Tn(ee.saldoPendiente)})]},ee.customerId))})]})}),i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Consolidado vendedores"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes asociados"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes vendidos (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total vendido (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Cash"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes fiados (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total fiado (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Crdito"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):Et.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin datos de vendedores en el rango seleccionado."})}):Et.map(ee=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ee.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Te(ee.vendorId,ee.vendorName,"ASSOCIATED"),children:ee.paquetesAsociados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Te(ee.vendorId,ee.vendorName,"REMAINING"),children:ee.paquetesRestantes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Te(ee.vendorId,ee.vendorName,"CASH"),children:ee.paquetesVendidos})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Tn(ee.totalVendido)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Tn(ee.comisionCash)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Te(ee.vendorId,ee.vendorName,"CREDIT"),children:ee.paquetesFiados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Tn(ee.totalFiado)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Tn(ee.comisionCredito)})]},ee.vendorId))})]})})]})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Consolidado por cliente (Crdito)"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Paquetes asociados (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo total (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo pendiente"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):Tt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin clientes con saldo"})}):Tt.map(ee=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ee.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Re({customerId:ee.customerId,name:ee.name}),title:"Ver paquetes fiados del periodo",children:ee.paquetesAsociados})}),i.jsx("td",{className:"p-2 border",children:Tn(ee.saldoTotal)}),i.jsx("td",{className:"p-2 border font-semibold",children:Tn(ee.saldoPendiente)})]},ee.customerId))})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Consolidado vendedores"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full mb-6 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes asociados"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes vendidos (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total vendido (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Cash"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes fiados (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total fiado (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Crdito"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):Et.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin datos de vendedores en el rango seleccionado."})}):Et.map(ee=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ee.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Te(ee.vendorId,ee.vendorName,"ASSOCIATED"),children:ee.paquetesAsociados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Te(ee.vendorId,ee.vendorName,"REMAINING"),children:ee.paquetesRestantes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Te(ee.vendorId,ee.vendorName,"CASH"),children:ee.paquetesVendidos})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Tn(ee.totalVendido)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Tn(ee.comisionCash)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Te(ee.vendorId,ee.vendorName,"CREDIT"),children:ee.paquetesFiados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Tn(ee.totalFiado)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Tn(ee.comisionCredito)})]},ee.vendorId))})]})}),i.jsx("div",{className:"md:hidden mb-6",children:i.jsxs("details",{className:"bg-white border rounded-lg shadow",children:[i.jsx("summary",{className:"cursor-pointer px-3 py-2 font-semibold",children:"Transacciones y gastos"}),i.jsxs("div",{className:"p-3",children:[i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full mb-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cliente"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta (prom.)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):Rt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin transacciones en el rango seleccionado."})}):Rt.map(ee=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ee.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ee.customer}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ee.type}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>je(ee.id),children:ee.paquetes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Tn(ee.avgPrice)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Tn(ee.total)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>We(ee.id),children:"Eliminar"})})]},ee.id))})]})}),i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):A.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):A.sort((ee,Ve)=>ee.date.localeCompare(Ve.date)).map(ee=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ee.date}),i.jsx("td",{className:"p-2 border",children:ee.category||""}),i.jsx("td",{className:"p-2 border",children:ee.description?i.jsx("span",{title:ee.description,children:ee.description.length>40?ee.description.slice(0,40)+"":ee.description}):""}),i.jsx("td",{className:"p-2 border",children:Tn(ee.amount)}),i.jsx("td",{className:"p-2 border",children:ee.status||""})]},ee.id))})]})})]})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full mb-6 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cliente"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta (prom.)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):Rt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin transacciones en el rango seleccionado."})}):Rt.map(ee=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ee.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ee.customer}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ee.type}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>je(ee.id),children:ee.paquetes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Tn(ee.avgPrice)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Tn(ee.total)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>We(ee.id),children:"Eliminar"})})]},ee.id))})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):A.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):A.sort((ee,Ve)=>ee.date.localeCompare(Ve.date)).map(ee=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ee.date}),i.jsx("td",{className:"p-2 border",children:ee.category||""}),i.jsx("td",{className:"p-2 border",children:ee.description?i.jsx("span",{title:ee.description,children:ee.description.length>40?ee.description.slice(0,40)+"":ee.description}):""}),i.jsx("td",{className:"p-2 border",children:Tn(ee.amount)}),i.jsx("td",{className:"p-2 border",children:ee.status||""})]},ee.id))})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w}),T&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle cliente  ",(q==null?void 0:q.name)||""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>P(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total bruto (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:Tn(Ce.totalBruto)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Descuento (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:Tn(Ce.totalDescuento)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto total fiado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:Tn(Ce.totalFiado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:Tn(Ce.abonadoPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:Tn(Ce.saldoActual)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha compra"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio Paq"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Descuento"}),i.jsx("th",{className:"p-2 border",children:"Monto final"})]})}),i.jsx("tbody",{children:he?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Cargando"})}):ce.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Sin paquetes fiados en el periodo."})}):ce.sort((ee,Ve)=>ee.date.localeCompare(Ve.date)).map((ee,Ve)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ee.date}),i.jsx("td",{className:"p-2 border",children:ee.productName}),i.jsx("td",{className:"p-2 border",children:ee.qty}),i.jsx("td",{className:"p-2 border",children:Tn(ee.unitPrice)}),i.jsx("td",{className:"p-2 border",children:Tn(ee.lineTotal)}),i.jsx("td",{className:"p-2 border",children:Tn(ee.discount)}),i.jsx("td",{className:"p-2 border",children:Tn(ee.lineFinal)})]},`${ee.saleId}-${Ve}`))})]})})]})}),O&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:G}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>R(!1),children:"Cerrar"})]}),(te==="ASSOCIATED"||te==="REMAINING")&&!D&&i.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2 text-sm",children:[i.jsxs("div",{className:"text-gray-600",children:["Pgina ",Q," de ",Ye]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded border bg-white hover:bg-gray-50 disabled:opacity-50",onClick:()=>Xe(ee=>Math.max(1,ee-1)),disabled:Q<=1,children:"Anterior"}),i.jsx("button",{className:"px-3 py-1 rounded border bg-white hover:bg-gray-50 disabled:opacity-50",onClick:()=>Xe(ee=>Math.min(Ye,ee+1)),disabled:Q>=Ye,children:"Siguiente"})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha Orden"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio Paq"}),te==="ASSOCIATED"||te==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"p-2 border",children:"Costo"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]}):i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Descuento"}),i.jsx("th",{className:"p-2 border",children:"Monto final"}),te==="ASSOCIATED"||te==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Utilidad vendedor"})]}):i.jsx("th",{className:"p-2 border",children:"Comisin"})]})}),i.jsx("tbody",{children:D?i.jsx("tr",{children:i.jsx("td",{colSpan:Fe,className:"p-4 text-center",children:"Cargando"})}):K.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:Fe,className:"p-4 text-center",children:"Sin paquetes para este vendedor en el periodo."})}):dt.map((ee,Ve)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ee.date}),i.jsx("td",{className:"p-2 border",children:ee.productName}),i.jsx("td",{className:"p-2 border",children:ee.qty}),i.jsx("td",{className:"p-2 border",children:Tn(ee.unitPrice)}),te==="ASSOCIATED"||te==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"p-2 border",children:Tn(ee.costTotal??0)}),i.jsx("td",{className:"p-2 border",children:Tn(ee.lineTotal)})]}):i.jsx("td",{className:"p-2 border",children:Tn(ee.lineTotal)}),i.jsx("td",{className:"p-2 border",children:Tn(ee.discount)}),i.jsx("td",{className:"p-2 border",children:Tn(ee.lineFinal)}),te==="ASSOCIATED"||te==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"p-2 border",children:Tn(ee.grossProfit||0)}),i.jsx("td",{className:"p-2 border",children:Tn(ee.vendorCommissionAmount)})]}):i.jsx("td",{className:"p-2 border",children:Tn(ee.vendorCommissionAmount)})]},`${ee.saleId}-${Ve}`))})]})})]})}),Z&&Se&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-4xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle de venta  ",Se.date]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ke(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto mb-3",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio Paq"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Comisin"})]})}),i.jsx("tbody",{children:(Se.items||[]).map((ee,Ve)=>{const rt=Number(ee.qty||0),$e=Number(ee.unitPrice||0),ie=rt*$e,pe=ot(Se,ee);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ee.productName}),i.jsx("td",{className:"p-2 border",children:rt}),i.jsx("td",{className:"p-2 border",children:Tn($e)}),i.jsx("td",{className:"p-2 border",children:Tn(ie)}),i.jsx("td",{className:"p-2 border",children:Tn(pe)})]},Ve)})})]})}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"font-semibold",children:"Total venta:"}),Tn(Se.total)]}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700",onClick:()=>We(Se.id),children:"Eliminar venta"})]})]})})]})}const SG=["Rivas","Isla Ometepe","San Jorge"];function mVe(){const{refreshKey:t,refresh:e}=bc(),[r,n]=g.useState([]),[a,s]=g.useState(!0),[o,l]=g.useState(""),[c,d]=g.useState(!1),[u,f]=g.useState(""),[A,h]=g.useState("0"),[m,p]=g.useState("Rivas"),[x,v]=g.useState(null),[y,b]=g.useState(""),[w,I]=g.useState("0"),[j,N]=g.useState("Rivas");g.useEffect(()=>{(async()=>{s(!0),l("");try{const q=ar(xt(Ne,"sellers_candies"),kn("name","asc")),de=await Ut(q),ce=[];de.forEach(le=>{const he=le.data();ce.push({id:le.id,name:he.name||"",commissionPercent:Number(he.commissionPercent||0),branch:he.branch||"Rivas",createdAt:he.createdAt||Nr.now()})}),n(ce)}catch(q){console.error(q),l(" Error cargando vendedores.")}finally{s(!1)}})()},[t]);const S=()=>{f(""),h("0"),p("Rivas")},E=async q=>{q.preventDefault(),l("");const de=u.trim();if(!de){l("Ingresa el nombre y apellido del vendedor.");return}const ce=Number(A||0);if(ce<0){l("El margen no puede ser negativo.");return}try{const le={name:de,commissionPercent:ce,branch:m,createdAt:Nr.now()},he=await ta(xt(Ne,"sellers_candies"),le);n(ae=>[{id:he.id,...le},...ae]),l(" Vendedor creado correctamente."),S(),d(!1)}catch(le){console.error(le),l(" Error al crear el vendedor.")}},B=q=>{v(q.id),b(q.name),I(q.commissionPercent.toString()),N(q.branch)},k=()=>{v(null),b(""),I("0"),N("Rivas")},T=async()=>{if(!x)return;l("");const q=y.trim();if(!q){l("El nombre y apellido no pueden estar vacos.");return}const de=Number(w||0);if(de<0){l("El margen no puede ser negativo.");return}try{await Mn(Kt(Ne,"sellers_candies",x),{name:q,commissionPercent:de,branch:j}),n(ce=>ce.map(le=>le.id===x?{...le,name:q,commissionPercent:de,branch:j}:le)),l(" Vendedor actualizado."),k()}catch(ce){console.error(ce),l(" Error al actualizar el vendedor.")}},P=async q=>{if(window.confirm(`Eliminar al vendedor "${q.name}"? Esta accin no se puede deshacer.`))try{await na(Kt(Ne,"sellers_candies",q.id)),n(ce=>ce.filter(le=>le.id!==q.id)),l(" Vendedor eliminado.")}catch(ce){console.error(ce),l(" Error al eliminar el vendedor.")}};return i.jsxs("div",{className:"max-w-5xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Vendedores de Dulces"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(yc,{onClick:e,loading:a}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>d(!0),children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo vendedor"]})]})]}),c&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Nuevo vendedor de dulces"}),i.jsxs("form",{onSubmit:E,className:"space-y-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre y apellido"}),i.jsx("input",{className:"w-full border p-2 rounded",value:u,onChange:q=>f(q.target.value),placeholder:"Ej: Juan Prez"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Margen del vendedor (% sobre U Aproximada)"}),i.jsx("input",{type:"number",step:"0.01",min:0,className:"w-full border p-2 rounded",value:A,onChange:q=>h(q.target.value),placeholder:"Ej: 30"}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Este porcentaje YA NO es comisin sobre venta. Se aplica as: U. Vendedor = U. Aproximada  (margen/100). U. Inversionista = U. Aproximada  U. Vendedor."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Sucursal"}),i.jsx("select",{className:"w-full border p-2 rounded",value:m,onChange:q=>p(q.target.value),children:SG.map(q=>i.jsx("option",{value:q,children:q},q))})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[i.jsx("button",{type:"button",onClick:()=>{S(),d(!1)},className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Guardar vendedor"})]})]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-3",children:i.jsxs("table",{className:"min-w-[700px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Nombre y apellido"}),i.jsx("th",{className:"p-2 border",children:"Margen (% U Aproximada)"}),i.jsx("th",{className:"p-2 border",children:"Sucursal"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:a?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):r.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin vendedores registrados."})}):r.map(q=>{const de=x===q.id;return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:de?i.jsx("input",{className:"border p-1 rounded text-xs w-full",value:y,onChange:ce=>b(ce.target.value)}):q.name}),i.jsx("td",{className:"p-2 border",children:de?i.jsx("input",{type:"number",step:"0.01",min:0,className:"border p-1 rounded text-xs w-24 text-right",value:w,onChange:ce=>I(ce.target.value)}):`${q.commissionPercent.toFixed(2)} %`}),i.jsx("td",{className:"p-2 border",children:de?i.jsx("select",{className:"border p-1 rounded text-xs",value:j,onChange:ce=>N(ce.target.value),children:SG.map(ce=>i.jsx("option",{value:ce,children:ce},ce))}):q.branch}),i.jsx("td",{className:"p-2 border",children:de?i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:T,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:k,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600 text-xs",onClick:()=>B(q),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>P(q),children:"Borrar"})]})})]},q.id)})})]})}),o&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const Ca=t=>Math.max(0,Math.floor(Number(t||0)));function J2(t){return Math.max(1,Ca(t.unitsPerPackage||1))}function jG(t){const e=Number(t.remaining);if(Number.isFinite(e)&&e>0)return Math.floor(e);const r=Number(t.remainingPackages??t.remainingPacks??t.packagesRemaining??0);if(Number.isFinite(r)&&r>0){const l=J2(t);return Math.floor(r*l)}const n=J2(t),a=Number(t.totalUnits||0),s=Number(t.quantity||0),o=Number(t.packages||0);return a>0?Math.floor(a):s>0?Math.floor(s):o>0?Math.floor(o*n):0}async function pVe(t){const e=String(t.vendorInventoryId||"");let r=Ca(t.packagesToReturn);const n=!!t.deleteVendorAfter;if(!e||r<=0)return{restoredPackages:0,mode:"noop"};const a=ar(xt(Ne,"inventory_transfers_candies"),lr("toVendorRowId","==",e)),s=await Ut(a);if(s.empty)return{restoredPackages:0,mode:"noop"};const o=s.docs.map(f=>({id:f.id,...f.data()})).filter(f=>String(f.fromVendorRowId||"").trim()!=="").sort((f,A)=>{var p,x;const h=Number(((p=f.createdAt)==null?void 0:p.seconds)??0);return Number(((x=A.createdAt)==null?void 0:x.seconds)??0)-h});if(!o.length)return{restoredPackages:0,mode:"noop"};const l=[];let c=r;for(const f of o){if(c<=0)break;const A=Ca(f.packagesMoved||0);if(A<=0)continue;const h=Math.min(c,A);h<=0||(l.push({fromVendorRowId:String(f.fromVendorRowId),packs:h}),c-=h)}if(!l.length)return{restoredPackages:0,mode:"noop"};const d=Kt(Ne,"inventory_candies_sellers",e),u=l.map(f=>Kt(Ne,"inventory_candies_sellers",f.fromVendorRowId));return await fi(Ne,async f=>{const A=await Promise.all(u.map(h=>f.get(h)));for(let h=0;h<l.length;h++){const m=u[h],p=A[h];if(!p.exists())continue;const x=p.data(),v=Ca(l[h].packs||0);if(v<=0)continue;const y=Math.max(1,Ca(x.unitsPerPackage||1)),b=v*y,w=Number(x.remainingPackages||0),I=Number(x.packages||0);f.update(m,{packages:Math.max(0,I+v),remainingPackages:Math.max(0,w+v),...y>0?{remainingUnits:Number(x.remainingUnits||0)+b}:{},transferDelta:Number(x.transferDelta||0)+v,updatedAt:Nr.now()})}n&&f.delete(d)}),{restoredPackages:r-c,mode:"transfer"}}async function jF(t){const{orderId:e,productId:r}=t;let n=Ca(t.packagesToReturn);if(!e||!r||n<=0)return;const a=ar(xt(Ne,"inventory_candies"),lr("orderId","==",e),lr("productId","==",r),kn("createdAt","asc")),s=await Ut(a);if(s.empty)return;const o=s.docs.map(l=>l.ref);await fi(Ne,async l=>{const c=await Promise.all(o.map(d=>l.get(d)));for(let d=0;d<o.length&&n>0;d++){const u=c[d];if(!u.exists())continue;const f=u.data(),A=J2(f),h=n*A,p=Ca(f.remaining??0)+h,x=Math.floor(p/A);l.update(o[d],{remaining:p,remainingPackages:x,packages:x,updatedAt:Nr.now()}),n=0}})}async function IF(t){const{orderId:e,productId:r}=t,n=Ca(t.packagesToReturn);if(!e||!r||n<=0)return;const a=Kt(Ne,"candy_main_orders",e);await fi(Ne,async s=>{const o=await s.get(a);if(!o.exists())return;const l=o.data(),c=Array.isArray(l.items)?l.items:[];let d=!1;const u=c.map(f=>String((f==null?void 0:f.id)||"")!==String(r)?f:(d=!0,{...f,remainingPackages:Ca(f.remainingPackages)+n}));d&&s.update(a,{items:u,updatedAt:Nr.now()})})}function PF(t){if(!Array.isArray(t))return[];const e=[];for(const r of t){const n=String((r==null?void 0:r.batchId)||""),a=String((r==null?void 0:r.masterOrderId)||(r==null?void 0:r.orderId)||""),s=Ca((r==null?void 0:r.units)??(r==null?void 0:r.qty)??(r==null?void 0:r.quantity)??0),o=Math.max(1,Ca((r==null?void 0:r.unitsPerPackage)||1));!n||!a||s<=0||e.push({batchId:n,masterOrderId:a,units:s,unitsPerPackage:o})}return e}function Z2(t,e){const r=Ca(t),n=Math.max(1,Ca(e));return Math.floor(r/n)}async function IG(t){const e=String(t.productId||"");let r=Ca(t.packagesToAllocate);if(!e||r<=0)return{allocations:[]};const n=ar(xt(Ne,"inventory_candies"),lr("productId","==",e)),a=await Ut(n);if(a.empty)throw new Error("No hay inventario para este producto.");const o=a.docs.map(c=>({id:c.id,data:c.data()})).sort((c,d)=>{var m,p;const u=String(c.data.date||""),f=String(d.data.date||"");if(u!==f)return u<f?-1:1;const A=((m=c.data.createdAt)==null?void 0:m.seconds)??0,h=((p=d.data.createdAt)==null?void 0:p.seconds)??0;return A-h}).map(c=>Kt(Ne,"inventory_candies",c.id)),l=[];return await fi(Ne,async c=>{const d=await Promise.all(o.map(y=>c.get(y))),u=[];let f=r;for(let y=0;y<o.length&&f>0;y++){const b=o[y],w=d[y];if(!w.exists())continue;const I=w.data(),j=J2(I),N=jG(I);if(N<=0)continue;const S=Math.floor(N/j);if(S<=0)continue;const E=Math.min(S,f),B=E*j,k=Math.max(0,N-B),T=Math.floor(k/j),P=String(I.orderId||"");if(!P)throw new Error("Lote sin orderId (orden maestra).");l.push({batchId:b.id,masterOrderId:P,units:B,unitsPerPackage:j}),u.push({ref:b,newRemUnits:k,newRemPacks:T}),f-=E}if(f>0)throw new Error(`Inventario insuficiente. Faltan ${f} paquetes.`);const A={};for(const y of l){const b=Z2(y.units,y.unitsPerPackage);A[y.masterOrderId]=(A[y.masterOrderId]||0)+b}const h=new Map;for(let y=0;y<u.length;y++){const b=u[y];h.set(b.ref.id,b.newRemUnits)}const m={};for(let y=0;y<o.length;y++){const b=o[y],w=d[y];if(!w.exists())continue;const I=w.data(),j=String(I.orderId||""),N=String(I.productId||"");if(!j||!N)continue;const S=J2(I),E=h.get(b.id),B=typeof E=="number"?E:jG(I),k=Math.floor(B/S);m[j]||(m[j]={}),m[j][N]=(m[j][N]||0)+Math.max(0,k)}const p=Object.keys(A),x=p.map(y=>Kt(Ne,"candy_main_orders",y)),v=await Promise.all(x.map(y=>c.get(y)));for(let y=0;y<u.length;y++){const b=u[y];c.update(b.ref,{remaining:b.newRemUnits,remainingPackages:b.newRemPacks,packages:b.newRemPacks,updatedAt:Nr.now()})}for(let y=0;y<x.length;y++){const b=v[y];if(!b.exists())throw new Error("Orden maestra no existe.");const w=b.data(),I=Array.isArray(w.items)?w.items:[],j=p[y];if(Ca(A[j]||0)<=0)continue;let S=!1;const E=I.map(B=>{var T;if(String((B==null?void 0:B.id)||"")!==e)return B;S=!0;const k=((T=m[j])==null?void 0:T[e])??Ca(B.remainingPackages||0);return{...B,remainingPackages:Math.max(0,Ca(k||0))}});S&&c.update(x[y],{items:E,updatedAt:Nr.now()})}}),{allocations:l}}async function gVe(t){const e=String(t.vendorInventoryId||"");let r=Ca(t.packagesToReturn);if(!e)throw new Error("vendorInventoryId requerido");if(r<=0)return{restoredPackages:0,mode:"noop"};const n=Kt(Ne,"inventory_candies_sellers",e),a=await Es(n);if(!a.exists())throw new Error("No existe la orden del vendedor");const s=a.data(),o=String(s.productId||"");if(!o)throw new Error("La orden del vendedor no tiene productId");if(!PF(s.masterAllocations||s.allocations||s.allocationsByBatch).length){const d=String(s.orderId||"");if(!d)throw new Error("La orden del vendedor no tiene orderId");return await jF({orderId:d,productId:o,packagesToReturn:r}),await IF({orderId:d,productId:o,packagesToReturn:r}),{restoredPackages:r,mode:"legacy"}}let c=0;return await fi(Ne,async d=>{const u=await d.get(n);if(!u.exists())throw new Error("No existe la orden del vendedor");const f=u.data(),A=String(f.productId||"");if(!A)throw new Error("Doc vendedor sin productId");let h=PF(f.masterAllocations||f.allocations||f.allocationsByBatch);if(!h.length)throw new Error("No hay masterAllocations guardadas en este doc (no se puede restaurar blindado).");const m=[];let p=r;for(let E=h.length-1;E>=0&&p>0;E--){const B=h[E],k=Math.max(1,Ca(B.unitsPerPackage||1)),T=Z2(B.units,k);if(T<=0)continue;const P=Math.min(T,p),q=P*k;m.push({batchId:B.batchId,masterOrderId:B.masterOrderId,units:q,unitsPerPackage:k}),p-=P}const x=r-p;if(x<=0)return;c=x;const v=m.map(E=>Kt(Ne,"inventory_candies",E.batchId)),y={};for(const E of m){const B=Z2(E.units,E.unitsPerPackage);B>0&&(y[E.masterOrderId]=(y[E.masterOrderId]||0)+B)}const w=Object.keys(y).map(E=>Kt(Ne,"candy_main_orders",E)),[I,j]=await Promise.all([Promise.all(v.map(E=>d.get(E))),Promise.all(w.map(E=>d.get(E)))]);for(let E=0;E<m.length;E++){const B=m[E],k=I[E];if(!k.exists())continue;const T=k.data(),P=Math.max(1,Ca(B.unitsPerPackage||T.unitsPerPackage||1)),q=Ca(B.units),ce=Ca(T.remaining??0)+q,le=Math.floor(ce/P);d.update(v[E],{remaining:ce,remainingPackages:le,packages:le,updatedAt:Nr.now()})}for(let E=0;E<w.length;E++){const B=j[E];if(!B.exists())continue;const k=w[E].id,T=Ca(y[k]||0);if(T<=0)continue;const P=B.data(),q=Array.isArray(P.items)?P.items:[];let de=!1;const ce=q.map(le=>String((le==null?void 0:le.id)||"")!==String(A)?le:(de=!0,{...le,remainingPackages:Ca(le.remainingPackages)+T}));de&&d.update(w[E],{items:ce,updatedAt:Nr.now()})}const N=new Map;for(const E of m){const B=`${E.batchId}__${E.masterOrderId}__${E.unitsPerPackage}`;N.set(B,(N.get(B)||0)+Ca(E.units))}const S=[];for(const E of h){const B=Math.max(1,Ca(E.unitsPerPackage||1)),k=`${E.batchId}__${E.masterOrderId}__${B}`,T=Ca(N.get(k)||0);if(T<=0){S.push(E);continue}const q=Ca(E.units)-T;q>0&&S.push({...E,units:q,unitsPerPackage:B}),N.delete(k)}d.update(n,{masterAllocations:S,updatedAt:Nr.now()})}),{restoredPackages:c,mode:"blind"}}async function PG(t){if(!t)throw new Error("vendorInventoryId requerido");const e=Kt(Ne,"inventory_candies_sellers",t),r=await Es(e);if(!r.exists())throw new Error("No existe la orden del vendedor");const n=r.data(),a=String(n.productId||""),s=Ca(n.remainingPackages||n.packages||0),o=Ca(n.packages||n.remainingPackages||0),l=PF(n.masterAllocations||n.allocations||n.allocationsByBatch),c=await pVe({vendorInventoryId:t,packagesToReturn:s,deleteVendorAfter:!1});if(!l.length){const u=String(n.orderId||"");if(!u)throw new Error("La orden del vendedor no tiene orderId");if(!a)throw new Error("La orden del vendedor no tiene productId");if(c.restoredPackages>0){const f=Math.max(0,s-c.restoredPackages);return f<=0?(await fi(Ne,async A=>{A.delete(e)}),{restoredPackages:c.restoredPackages,mode:"transfer"}):(await jF({orderId:u,productId:a,packagesToReturn:f}),await IF({orderId:u,productId:a,packagesToReturn:f}),await fi(Ne,async A=>{A.delete(e)}),{restoredPackages:c.restoredPackages+f,mode:"transfer+legacy"})}return o<=0?(await fi(Ne,async f=>{f.delete(e)}),{restoredPackages:0,mode:"legacy"}):(await jF({orderId:u,productId:a,packagesToReturn:o}),await IF({orderId:u,productId:a,packagesToReturn:o}),await fi(Ne,async f=>{f.delete(e)}),{restoredPackages:o,mode:"legacy"})}let d=0;return await fi(Ne,async u=>{const f={};for(const y of l){const b=Math.max(1,Ca(y.unitsPerPackage||1)),w=Ca(y.units),I=Z2(w,b);I>0&&(f[y.masterOrderId]=(f[y.masterOrderId]||0)+I)}const A=l.map(y=>Kt(Ne,"inventory_candies",y.batchId)),m=Object.keys(f).map(y=>Kt(Ne,"candy_main_orders",y)),[p,x]=await Promise.all([Promise.all(A.map(y=>u.get(y))),Promise.all(m.map(y=>u.get(y)))]);let v=0;for(let y=0;y<l.length;y++){const b=l[y],w=p[y];if(!w.exists())continue;const I=w.data(),j=Math.max(1,Ca(b.unitsPerPackage||I.unitsPerPackage||1)),N=Ca(b.units),E=Ca(I.remaining??0)+N,B=Math.floor(E/j);u.update(A[y],{remaining:E,remainingPackages:B,packages:B,updatedAt:Nr.now()});const k=Z2(N,j);k>0&&(v+=k)}for(let y=0;y<m.length;y++){const b=x[y];if(!b.exists())continue;const w=m[y].id,I=Ca(f[w]||0);if(I<=0)continue;const j=b.data(),N=Array.isArray(j.items)?j.items:[];let S=!1;const E=N.map(B=>String((B==null?void 0:B.id)||"")!==String(a)?B:(S=!0,{...B,remainingPackages:Ca(B.remainingPackages)+I}));S&&u.update(m[y],{items:E,updatedAt:Nr.now()})}u.delete(e),d=v}),{restoredPackages:d,mode:"blind"}}const mT=t=>`C$ ${(Number(t)||0).toFixed(2)}`,eie=(t,e)=>`${t}__${e}`,xVe=t=>t?typeof t=="string"?t:t!=null&&t.seconds?new Date(t.seconds*1e3).toISOString().slice(0,10):t!=null&&t.toDate?t.toDate().toISOString().slice(0,10):"":"",vVe=t=>{const e=t.sellerId||"",r=xVe(t.date);return e&&r?eie(e,r):t.orderId?t.orderId:t.id},TG=(t,e=!1)=>{if(!t)return null;const r=new Date(t);return Number.isNaN(r.getTime())?null:(e?r.setHours(23,59,59,999):r.setHours(0,0,0,0),r)},yVe=t=>{var e,r;if((e=t.createdAt)!=null&&e.toDate)return t.createdAt.toDate();if((r=t.createdAt)!=null&&r.seconds)return new Date(t.createdAt.seconds*1e3);if(t.date){const n=new Date(t.date);if(!Number.isNaN(n.getTime()))return n}return null},BG=t=>{const e=String(t||"").trim().toUpperCase();if(e.includes("ISLA"))return"ISLA";if(e.includes("JORGE"))return"SAN_JORGE";if(e.includes("RIVAS"))return"RIVAS"},TF=t=>{const e=Number(t||0);return!isFinite(e)||e<0?0:e},kG=(t,e)=>{const r=TF(e),n=Number(t||0)*(r/100),a=Number(t||0)-n;return{vendorMarginPercent:r,uVendor:n,uInvestor:a}},FG=(t,e)=>e?e==="RIVAS"?t.unitPriceRivas||0:e==="SAN_JORGE"?t.unitPriceSanJorge||0:t.unitPriceIsla||0:t.unitPriceIsla||0,OG=(t,e)=>e?e==="RIVAS"?t.grossProfitPerPackRivas||0:e==="SAN_JORGE"?t.grossProfitPerPackSanJorge||0:t.grossProfitPerPackIsla||0:t.grossProfitPerPackIsla||0,DG=(t,e)=>e?e==="RIVAS"?t.uApproxPerPackRivas||0:e==="SAN_JORGE"?t.uApproxPerPackSanJorge||0:t.uApproxPerPackIsla||0:t.uApproxPerPackIsla||0;function bVe({open:t,onClose:e,orders:r,rows:n,setRows:a,isAdmin:s,currentUserEmail:o,currentUserName:l,sellerCandyId:c,sellers:d,products:u,transferAgg:f,setTransferAgg:A,setTransferRowDeltas:h}){const[m,p]=g.useState(!1),[x,v]=g.useState([]),[y,b]=g.useState(""),[w,I]=g.useState(""),[j,N]=g.useState(""),[S,E]=g.useState(""),[B,k]=g.useState("0"),[T,P]=g.useState(""),[q,de]=g.useState(!1),[ce,le]=g.useState(""),[he,ae]=g.useState(!1),[Ce,De]=g.useState(""),[O,R]=g.useState(()=>new Date().toISOString().slice(0,10)),[G,M]=g.useState(""),[K,Y]=g.useState(()=>{const Te=new Date;return new Date(Te.getFullYear(),Te.getMonth(),1).toISOString().slice(0,10)}),[D,V]=g.useState(()=>new Date().toISOString().slice(0,10)),te=g.useMemo(()=>{const Te={};return d.forEach(Ye=>{Te[Ye.id]=Ye}),Te},[d]),ve=g.useMemo(()=>{const Te={};return u.forEach(Ye=>{Te[Ye.id]=Ye}),Te},[u]),Q=Ce&&te[Ce]||null,Xe=g.useMemo(()=>r.map(Te=>Te.orderKey),[r]),se=g.useMemo(()=>{const Te={};return r.forEach(Ye=>Te[Ye.orderKey]=Ye),Te},[r]),Z=n,ke=g.useMemo(()=>{const Te={};return Z.forEach(Ye=>{const dt=vVe(Ye),Fe=new Set;dt&&Fe.add(dt),Ye.orderId&&Fe.add(String(Ye.orderId)),Fe.add(Ye.id),Fe.forEach(je=>{Te[je]||(Te[je]=[]),Te[je].push(Ye)})}),Te},[Z]),Se=g.useMemo(()=>y?ke[y]||[]:[],[ke,y]),Ee=g.useMemo(()=>Se.filter(Te=>{const Ye=Te.remainingPackages??Te.remaining??Te.packages??0;return Number(Ye||0)>0}),[Se]),Ze=g.useMemo(()=>{const Te=G.trim().toLowerCase();return Te?Ee.filter(Ye=>`${Ye.category||""} ${Ye.productName||""}`.toLowerCase().trim().includes(Te)):Ee},[Ee,G]),ot=g.useMemo(()=>w&&Z.find(Te=>Te.id===w)||null,[Z,w]),vt=g.useMemo(()=>{if(ot!=null&&ot.sellerId)return ot.sellerId;const Te=se[y];return(Te==null?void 0:Te.sellerId)||""},[ot,se,y]),_t=g.useMemo(()=>j?ke[j]||[]:[],[ke,j]),Tt=g.useMemo(()=>ot?_t.filter(Te=>Te.productId===ot.productId):[],[_t,ot]),Lt=async()=>{try{p(!0);let Te=[];if(!s&&c){const Ye=ar(xt(Ne,"inventory_transfers_candies"),lr("fromSellerId","==",c),kn("createdAt","desc")),dt=ar(xt(Ne,"inventory_transfers_candies"),lr("toSellerId","==",c),kn("createdAt","desc")),[Fe,je]=await Promise.all([Ut(Ye),Ut(dt)]),We=new Set,ee=Ve=>{Ve.forEach(rt=>{if(We.has(rt.id))return;We.add(rt.id);const $e=rt.data();Te.push({id:rt.id,...$e})})};ee(Fe),ee(je),Te.sort((Ve,rt)=>{var pe,fe;const $e=((pe=Ve.createdAt)==null?void 0:pe.seconds)||0;return(((fe=rt.createdAt)==null?void 0:fe.seconds)||0)-$e})}else{const Ye=ar(xt(Ne,"inventory_transfers_candies"),kn("createdAt","desc"));(await Ut(Ye)).forEach(Fe=>{const je=Fe.data();Te.push({id:Fe.id,...je})})}v(Te)}catch{le(" Error cargando traslados.")}finally{p(!1)}};g.useEffect(()=>{t&&Lt()},[t]);const Rt=g.useMemo(()=>{const Te=TG(K),Ye=TG(D,!0);return x.filter(dt=>{const Fe=yVe(dt);return Fe?!(Te&&Fe<Te||Ye&&Fe>Ye):!0})},[x,K,D]);g.useEffect(()=>{M("")},[y]),g.useEffect(()=>{if(he){if(!Ce){const Te=se[y];Te!=null&&Te.sellerId&&De(Te.sellerId)}O||R(new Date().toISOString().slice(0,10))}},[he,Ce,O,se,y]);const Et=()=>{b(""),I(""),N(""),E(""),k("0"),P(""),ae(!1),De(""),R(new Date().toISOString().slice(0,10))},Re=async()=>{if(!s){le("No tienes permiso para hacer traslados.");return}le("");const Te=Number(B||0);if(!(Te>0)){le("La cantidad de paquetes debe ser mayor a 0.");return}if(!T.trim()){le("Debes escribir el motivo de la movida.");return}if(!y||!w){le("Selecciona el pedido origen y el producto.");return}const Ye=he;if(!Ye&&!j){le("Selecciona el pedido destino.");return}if(Ye){if(!Ce){le("Selecciona el vendedor de la nueva orden.");return}if(!O){le("Selecciona la fecha de la nueva orden.");return}}const dt=!Ye&&j&&se[j]||null;if(!Ye&&!dt){le("Selecciona un pedido destino vlido.");return}const Fe=dt?te[dt.sellerId]||{id:dt.sellerId||"",name:dt.sellerName||"",email:dt.sellerEmail||"",branch:dt.branch,branchLabel:dt.branchLabel,commissionPercent:dt.vendorMarginPercent??dt.commissionPercent??0}:null,je=n.find(me=>me.id===w)||null,We=!Ye&&S&&n.find(me=>me.id===S)||null;if(!je){le("No se encontr la fila origen/destino.");return}if(!Ye&&We&&w===S){le("Origen y destino no pueden ser el mismo.");return}if(!Ye&&We&&je.productId!==We.productId){le("El producto destino no coincide con el producto origen.");return}if(Number(je.remainingPackages||0)<Te){le("El origen no tiene suficientes paquetes disponibles.");return}const ee=Ye?Q:null;if(Ye&&!ee){le("Selecciona un vendedor destino vlido.");return}const Ve=ve[je.productId]||null,rt=Ye?BG((ee==null?void 0:ee.branch)||(ee==null?void 0:ee.branchLabel)):void 0,$e=!Ye&&!S&&!!dt,ie=Ye||$e;let pe=null,fe=null,Me="";if(Ye&&ee){const me=TF(ee.commissionPercent??0),ye=rt,mt=Number((Ve==null?void 0:Ve.unitsPerPackage)??je.unitsPerPackage??0),gt=mt>0?mt*Te:0;Ve?FG(Ve,ye):Number(je.unitPriceRivas||je.unitPriceIsla||0);const Pt=(Ve?OG(Ve,ye):Number(je.grossProfit||0)/Math.max(1,je.packages||1))*Te,Ft=Ve?Number(Ve.logisticAllocatedPerPack||0)*Te:Number(je.logisticAllocated||0),be=(Ve?DG(Ve,ye):Number(je.uAproximada||0)/Math.max(1,je.packages||1))*Te,Ae=kG(Pt,me),Le=Number(Pt||0)-Number(Ft||0)-Number(Ae.uVendor||0),ut=((Ve==null?void 0:Ve.unitPriceRivas)||je.unitPriceRivas||0)*Te,ct=((Ve==null?void 0:Ve.unitPriceSanJorge)||je.unitPriceSanJorge||0)*Te,st=((Ve==null?void 0:Ve.unitPriceIsla)||je.unitPriceIsla||0)*Te;Me=eie(ee.id,O),pe={sellerId:ee.id,sellerName:ee.name,sellerEmail:ee.email||"",branch:ye||"",branchLabel:ee.branchLabel||"",productId:je.productId,productName:je.productName,category:je.category,orderId:Me,date:O,packages:Te,unitsPerPackage:mt,totalUnits:gt,remainingPackages:Te,remainingUnits:gt,totalRivas:ut,totalSanJorge:ct,totalIsla:st,unitPriceRivas:(Ve==null?void 0:Ve.unitPriceRivas)||je.unitPriceRivas||0,unitPriceSanJorge:(Ve==null?void 0:Ve.unitPriceSanJorge)||je.unitPriceSanJorge||0,unitPriceIsla:(Ve==null?void 0:Ve.unitPriceIsla)||je.unitPriceIsla||0,grossProfit:Pt,logisticAllocated:Ft,vendorMarginPercent:Ae.vendorMarginPercent,uVendor:Ae.uVendor,uInvestor:Ae.uInvestor,uAproximada:be,uNeta:Le,providerPrice:je.providerPrice,transferDelta:0}}if($e&&dt){const me=TF((Fe==null?void 0:Fe.commissionPercent)??dt.vendorMarginPercent??0),ye=BG((Fe==null?void 0:Fe.branch)||(Fe==null?void 0:Fe.branchLabel)||dt.branch||dt.branchLabel),mt=Number((Ve==null?void 0:Ve.unitsPerPackage)??je.unitsPerPackage??0),gt=mt>0?mt*Te:0;Ve?FG(Ve,ye):Number(je.unitPriceRivas||je.unitPriceIsla||0);const Pt=(Ve?OG(Ve,ye):Number(je.grossProfit||0)/Math.max(1,je.packages||1))*Te,Ft=Ve?Number(Ve.logisticAllocatedPerPack||0)*Te:Number(je.logisticAllocated||0),be=(Ve?DG(Ve,ye):Number(je.uAproximada||0)/Math.max(1,je.packages||1))*Te,Ae=kG(Pt,me),Le=Number(Pt||0)-Number(Ft||0)-Number(Ae.uVendor||0),ut=((Ve==null?void 0:Ve.unitPriceRivas)||je.unitPriceRivas||0)*Te,ct=((Ve==null?void 0:Ve.unitPriceSanJorge)||je.unitPriceSanJorge||0)*Te,st=((Ve==null?void 0:Ve.unitPriceIsla)||je.unitPriceIsla||0)*Te;fe={sellerId:dt.sellerId,sellerName:(Fe==null?void 0:Fe.name)||dt.sellerName||"",sellerEmail:(Fe==null?void 0:Fe.email)||dt.sellerEmail||"",branch:ye||dt.branch||"",branchLabel:(Fe==null?void 0:Fe.branchLabel)||dt.branchLabel||"",productId:je.productId,productName:je.productName,category:je.category,orderId:dt.orderKey||j,date:dt.date||new Date().toISOString().slice(0,10),packages:Te,unitsPerPackage:mt,totalUnits:gt,remainingPackages:Te,remainingUnits:gt,totalRivas:ut,totalSanJorge:ct,totalIsla:st,unitPriceRivas:(Ve==null?void 0:Ve.unitPriceRivas)||je.unitPriceRivas||0,unitPriceSanJorge:(Ve==null?void 0:Ve.unitPriceSanJorge)||je.unitPriceSanJorge||0,unitPriceIsla:(Ve==null?void 0:Ve.unitPriceIsla)||je.unitPriceIsla||0,grossProfit:Pt,logisticAllocated:Ft,vendorMarginPercent:Ae.vendorMarginPercent,uVendor:Ae.uVendor,uInvestor:Ae.uInvestor,uAproximada:be,uNeta:Le,providerPrice:je.providerPrice,transferDelta:0}}try{de(!0);const me=Kt(Ne,"inventory_candies_sellers",je.id),ye=Ye||$e?Kt(xt(Ne,"inventory_candies_sellers")):Kt(Ne,"inventory_candies_sellers",We.id),mt=Nr.now(),gt=new Date().toISOString().slice(0,10);let yt=null;await fi(Ne,async Pt=>{const Ft=await Pt.get(me);if(!Ft.exists())throw new Error("Orden origen no existe.");const Oe=Ft.data(),be=Number(Oe.remainingPackages||0);if(be<Te)throw new Error("Origen no tiene suficientes paquetes.");let Ae=null;if(!Ye&&!$e){const X=await Pt.get(ye);if(!X.exists())throw new Error("Orden destino no existe.");Ae=X.data()}const Le=Number(Oe.unitsPerPackage||je.unitsPerPackage||0),ut=Le>0?Te*Le:0,ct=Number(Oe.transferDelta||0);Pt.update(me,{packages:Math.max(0,Number(Oe.packages||0)-Te),remainingPackages:be-Te,...Le>0?{remainingUnits:Number(Oe.remainingUnits||0)-ut}:{},updatedAt:mt,transferDelta:ct-Te});let st=null;if(Ye){const X={...pe,createdAt:mt,updatedAt:mt,remainingPackages:Te,remainingUnits:Number((pe==null?void 0:pe.unitsPerPackage)||0)>0?Te*Number((pe==null?void 0:pe.unitsPerPackage)||0):pe==null?void 0:pe.remainingUnits,transferDelta:0};Pt.set(ye,X),st=X,yt={id:ye.id,...X}}else if($e&&fe){const X={...fe,createdAt:mt,updatedAt:mt,remainingPackages:Te,remainingUnits:Number(fe.unitsPerPackage||0)>0?Te*Number(fe.unitsPerPackage||0):fe.remainingUnits,transferDelta:0};Pt.set(ye,X),st=X,yt={id:ye.id,...X}}else{const X=Ae,re=Number(X.unitsPerPackage||je.unitsPerPackage||0),H=re>0?Te*re:0,L=Number(X.transferDelta||0);Pt.update(ye,{packages:Math.max(0,Number(X.packages||0)+Te),remainingPackages:Number(X.remainingPackages||0)+Te,...re>0?{remainingUnits:Number(X.remainingUnits||0)+H}:{},updatedAt:mt,transferDelta:L+Te}),st={...X,remainingPackages:Number(X.remainingPackages||0)+Te,remainingUnits:re>0?Number(X.remainingUnits||0)+H:X.remainingUnits,sellerId:X.sellerId,sellerName:X.sellerName,orderId:X.orderId||(We==null?void 0:We.id)||"",transferDelta:L+Te}}const z=Kt(xt(Ne,"inventory_transfers_candies"));Pt.set(z,{createdAt:mt,date:gt,createdByEmail:(o||"").trim(),createdByName:String(l||"").trim(),productId:String(Oe.productId||""),productName:String(Oe.productName||""),packagesMoved:Te,providerPrice:Number(Oe.providerPrice||0),unitPriceRivas:Number(Oe.unitPriceRivas||0),unitPriceIsla:Number(Oe.unitPriceIsla||0),fromSellerId:String(Oe.sellerId||""),fromSellerName:String(Oe.sellerName||""),fromOrderKey:String(Oe.orderId||je.id||""),fromOrderLabel:String(Oe.orderId||je.id||""),toSellerId:Ye?(ee==null?void 0:ee.id)||"":String((st==null?void 0:st.sellerId)||""),toSellerName:Ye?(ee==null?void 0:ee.name)||"":String((st==null?void 0:st.sellerName)||""),toOrderKey:Ye?Me:String((st==null?void 0:st.orderId)||j||""),toOrderLabel:Ye?Me:String((st==null?void 0:st.orderId)||j||""),fromVendorRowId:je.id,toVendorRowId:Ye||$e?ye.id:We.id,comment:T.trim(),destRowWasNew:ie})}),a(Pt=>{const Ft=Pt.reduce((Oe,be)=>{if(be.id===je.id){const Ae=Number(be.unitsPerPackage||0),Le=Ae>0?Te*Ae:0;return Oe.push({...be,packages:Math.max(0,Number(be.packages||0)-Te),remainingPackages:Number(be.remainingPackages||0)-Te,remainingUnits:Ae>0?Number(be.remainingUnits||0)-Le:be.remainingUnits,transferDelta:Number(be.transferDelta||0)-Te}),Oe}if(!Ye&&We&&be.id===We.id){const Ae=Number(be.unitsPerPackage||0),Le=Ae>0?Te*Ae:0;return Oe.push({...be,packages:Math.max(0,Number(be.packages||0)+Te),remainingPackages:Number(be.remainingPackages||0)+Te,remainingUnits:Ae>0?Number(be.remainingUnits||0)+Le:be.remainingUnits,transferDelta:Number(be.transferDelta||0)+Te}),Oe}return Oe.push(be),Oe},[]);return yt?[...Ft,yt]:Ft}),await Lt(),A(Pt=>{const Ft={...Pt},Oe=y,be=Ye?Me:j;return Oe&&(Ft[Oe]=Ft[Oe]||{out:0,in:0},Ft[Oe].out+=Te),be&&(Ft[be]=Ft[be]||{out:0,in:0},Ft[be].in+=Te),Ft}),h(Pt=>{const Ft={...Pt};if(je.id&&(Ft[je.id]=(Ft[je.id]||0)-Te),!ie){const Oe=$e||Ye?yt==null?void 0:yt.id:We==null?void 0:We.id;Oe&&(Ft[Oe]=(Ft[Oe]||0)+Te)}return Ft}),Et(),le(" Traslado realizado.")}catch(me){le((me==null?void 0:me.message)||" Error realizando el traslado.")}finally{de(!1)}};return t?i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[55]",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-7xl max-h-[90vh] overflow-y-auto text-sm relative",children:[q&&i.jsx("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-50",children:i.jsx("div",{className:"bg-white border rounded-lg px-4 py-3 shadow text-sm font-semibold",children:"Guardando traslado..."})}),i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Traslado de paquetes"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{e(),Et()},type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"border rounded p-3 bg-gray-50 mb-4",children:[i.jsx("div",{className:"text-sm font-semibold mb-2",children:"Crear traslado (requiere motivo)"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pedido origen"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:y,onChange:Te=>{b(Te.target.value),I(""),N(""),E(""),k("0")},disabled:!s,children:[i.jsx("option",{value:"",children:"Selecciona"}),Xe.map(Te=>{const Ye=se[Te];return i.jsxs("option",{value:Te,children:["Vendedor: ",(Ye==null?void 0:Ye.sellerName)||"","  Existencias:"," ",(Ye==null?void 0:Ye.totalRemainingPackages)||"0"," Paquetes - Fecha Orden:"," ",(Ye==null?void 0:Ye.date)||""]},Te)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (desde el pedido origen)"}),i.jsx("input",{type:"text",className:"mt-1 mb-2 w-full border p-2 rounded text-sm",placeholder:"Buscar producto...",value:G,onChange:Te=>M(Te.target.value),disabled:!s||!y}),i.jsxs("select",{className:"w-full border p-2 rounded",value:w,onChange:Te=>{I(Te.target.value),N(""),E(""),k("0")},disabled:!s||!y,children:[i.jsx("option",{value:"",children:"Selecciona"}),Ze.map(Te=>i.jsxs("option",{value:Te.id,children:[Te.productName,"  Existencias:"," ",Number(Te.remainingPackages??Te.packages??0)," Paquetes - Precio Costo: $",Te.providerPrice]},Te.id))]})]}),!he&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pedido destino"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:j,onChange:Te=>{N(Te.target.value),E("")},disabled:!s||!w,children:[i.jsx("option",{value:"",children:"Selecciona"}),Xe.filter(Te=>Te!==y).map(Te=>{const Ye=se[Te];return i.jsxs("option",{value:Te,children:["Vendedor: ",(Ye==null?void 0:Ye.sellerName)||"","  Existencias:"," ",(Ye==null?void 0:Ye.totalRemainingPackages)||"0"," - Fecha Orden:"," ",(Ye==null?void 0:Ye.date)||""]},Te)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto destino (mismo producto)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:S,onChange:Te=>E(Te.target.value),disabled:!s||!j||!ot,children:[i.jsx("option",{value:"",children:"Selecciona"}),Tt.map(Te=>i.jsxs("option",{value:Te.id,children:["Tipo: ",Te.category," - ",Te.productName,"  Existencias:"," ",Number(Te.remainingPackages??Te.packages??0),"Paquetes - Precio Costo: $",Te.providerPrice]},Te.id))]}),j&&ot&&Tt.length===0&&i.jsx("div",{className:"text-xs text-red-600 mt-1",children:" El pedido destino no tiene este producto. Si dejas este campo vaco se crear automticamente al moverlo."}),j&&i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este campo es opcional; salo solo si el pedido ya tiene el producto y quieres sumar a esa fila."})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:he,onChange:Te=>{const Ye=Te.target.checked;ae(Ye),Ye&&(N(""),E(""))},disabled:!s}),i.jsx("span",{className:"text-sm font-semibold",children:"Crear nueva orden destino (independiente)"})]}),he&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor destino (nueva orden)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:Ce,onChange:Te=>De(Te.target.value),disabled:!s,children:[i.jsx("option",{value:"",children:"Selecciona"}),d.map(Te=>i.jsxs("option",{value:Te.id,disabled:Te.id===vt,children:[Te.name,Te.id===vt?" (origen)":""]},Te.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de la nueva orden"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:O,onChange:Te=>R(Te.target.value),disabled:!s}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Esta orden ser independiente. Asegrate de usar una fecha que no tenga otro pedido activo para el mismo vendedor."})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad paquetes a mover"}),i.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:B,onChange:Te=>k(Te.target.value),disabled:!s||!w||!he&&!j})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Motivo de movida (obligatorio)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:T,onChange:Te=>P(Te.target.value),disabled:!s,placeholder:"Ej: Se cambi de ruta por reorganizacin",maxLength:250})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",onClick:Et,disabled:!s||q,children:"Limpiar"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-60",onClick:Re,disabled:!s||q||!w||!he&&!j||Number(B||0)<=0||!T.trim(),children:"Hacer traslado"})]}),ce&&i.jsx("div",{className:"text-sm text-red-600 mt-2",children:ce})]}),i.jsxs("div",{className:"bg-white rounded border overflow-x-auto",children:[i.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between p-2",children:[i.jsx("div",{className:"text-lg font-semibold",children:"Historial de traslados"}),i.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:K,onChange:Te=>Y(Te.target.value)}),i.jsx("span",{className:"text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:D,onChange:Te=>V(Te.target.value)}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Lt,disabled:m,type:"button",children:m?"Cargando...":"Recargar"})]})]}),i.jsxs("table",{className:"min-w-[1400px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha y hora"}),i.jsx("th",{className:"p-2 border",children:"Usuario"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Cantidad paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio Rivas"}),i.jsx("th",{className:"p-2 border",children:"Precio Isla"}),i.jsx("th",{className:"p-2 border",children:"Desde vendedor"}),i.jsx("th",{className:"p-2 border",children:"Desde orden"}),i.jsx("th",{className:"p-2 border",children:"Hacia vendedor"}),i.jsx("th",{className:"p-2 border",children:"Hacia orden"}),i.jsx("th",{className:"p-2 border",children:"Motivo de movida"})]})}),i.jsx("tbody",{children:m?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):Rt.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin traslados"})}):Rt.map(Te=>{var je,We;const Ye=((We=(je=Te.createdAt)==null?void 0:je.toDate)==null?void 0:We.call(je))||(Te.createdAt?new Date(Te.createdAt.seconds*1e3):null),dt=Ye?`${Ye.toISOString().slice(0,10)} ${Ye.toISOString().slice(11,19)}`:Te.date||"",Fe=(Te.createdByName||"").trim()||(Te.createdByEmail||"").trim()||"";return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:dt}),i.jsx("td",{className:"p-2 border",children:Fe}),i.jsx("td",{className:"p-2 border text-left",children:Te.productName||""}),i.jsx("td",{className:"p-2 border",children:Number(Te.packagesMoved||0)}),i.jsx("td",{className:"p-2 border",children:mT(Te.providerPrice||0)}),i.jsx("td",{className:"p-2 border",children:mT(Te.unitPriceRivas||0)}),i.jsx("td",{className:"p-2 border",children:mT(Te.unitPriceIsla||0)}),i.jsx("td",{className:"p-2 border",children:Te.fromSellerName||""}),i.jsx("td",{className:"p-2 border",children:Te.fromOrderLabel||Te.fromOrderKey||""}),i.jsx("td",{className:"p-2 border",children:Te.toSellerName||""}),i.jsx("td",{className:"p-2 border",children:Te.toOrderLabel||Te.toOrderKey||""}),i.jsx("td",{className:"p-2 border text-left",children:Te.comment||""})]},Te.id)})})]})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Nota: el traslado mueve EXISTENCIA (remainingPackages/remainingUnits) del pedido origen al destino."})]})}):null}const yi=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function RG(t){const e=String(t||"").trim().toUpperCase();if(e.includes("ISLA"))return"ISLA";if(e.includes("JORGE"))return"SAN_JORGE";if(e.includes("RIVAS"))return"RIVAS"}const $s=t=>Math.max(0,Math.floor(Number(t||0))),pu=t=>{const e=Number(t||0);return!isFinite(e)||e<0?0:e},Id=(t,e)=>{const r=pu(e),n=Number(t||0)*(r/100),a=Number(t||0)-n;return{vendorMarginPercent:r,uVendor:n,uInvestor:a}};function wVe({role:t="",sellerCandyId:e="",currentUserEmail:r,roles:n}){const{refreshKey:a,refresh:s}=bc(),o=n&&n.length?n:t,l=!o||Rn(o,"admin"),c=Rn(o,"vendedor_dulces"),d=(r||"").trim().toLowerCase(),u=!l&&c,[f,A]=g.useState(!0),[h,m]=g.useState(""),[p,x]=g.useState([]),[v,y]=g.useState([]),[b,w]=g.useState({}),[I,j]=g.useState([]),N=g.useRef({});g.useEffect(()=>{const we={};I.forEach(ft=>{we[ft.id]=ft}),N.current=we},[I]);const[S,E]=g.useState(!1),[B,k]=g.useState(null),[T,P]=g.useState(""),[q,de]=g.useState(""),[ce,le]=g.useState(""),[he,ae]=g.useState(""),[Ce,De]=g.useState("0"),[O,R]=g.useState([]),[G,M]=g.useState(""),[K,Y]=g.useState(""),[D,V]=g.useState(!1),[te,ve]=g.useState(!1),[Q,Xe]=g.useState(!1),se=20,[Z,ke]=g.useState(1),Se=20,[Ee,Ze]=g.useState(1),[ot,vt]=g.useState({}),[_t,Tt]=g.useState(!1),[Lt,Rt]=g.useState({}),[Et,Re]=g.useState({}),[Te,Ye]=g.useState(!1),[dt,Fe]=g.useState({}),[je,We]=g.useState({}),[ee,Ve]=g.useState({}),[rt,$e]=g.useState({}),[ie,pe]=g.useState({}),[fe,Me]=g.useState(null),me=(we,ft="success")=>{Me({msg:we,type:ft}),setTimeout(()=>Me(null),4e3)},ye=g.useMemo(()=>p.find(we=>we.id===T)||null,[T,p]);ye==null||ye.branch,g.useEffect(()=>{!S||!T||!O.length||R(we=>we.map(ft=>{const St=v.find(rn=>rn.id===ft.productId)||null,Ct=p.find(rn=>rn.id===T)||null,fr=Ct==null?void 0:Ct.branch,or=$s(ft.packages),Hr=St?Le(St,fr):Number(ft.pricePerPackage||0),hr=ct(St,ft,fr)*or,Ir=St?St.logisticAllocatedPerPack*or:Number(ft.logisticAllocated||0),sn=(St?st(St,fr):0)*or,da=z(T),Zn=ft.vendorMarginPercent!=null&&String(ft.vendorMarginPercent).trim()!==""?pu(ft.vendorMarginPercent):da,wn=Id(hr,Zn);return{...ft,pricePerPackage:Hr,totalExpected:Hr*or,grossProfit:hr,logisticAllocated:Ir,vendorMarginPercent:wn.vendorMarginPercent,uAproximada:sn,uVendor:wn.uVendor,uInvestor:wn.uInvestor,totalRivas:((St==null?void 0:St.unitPriceRivas)||ft.unitPriceRivas||0)*or,totalSanJorge:((St==null?void 0:St.unitPriceSanJorge)||ft.unitPriceSanJorge||0)*or,totalIsla:((St==null?void 0:St.unitPriceIsla)||ft.unitPriceIsla||0)*or,unitPriceRivas:(St==null?void 0:St.unitPriceRivas)||ft.unitPriceRivas||0,unitPriceSanJorge:(St==null?void 0:St.unitPriceSanJorge)||ft.unitPriceSanJorge||0,unitPriceIsla:(St==null?void 0:St.unitPriceIsla)||ft.unitPriceIsla||0}}))},[S,T,O.length,v,p]);const mt=g.useMemo(()=>!c||!d?null:p.find(we=>(we.email||"").trim().toLowerCase()===d)||null,[c,d,p]);g.useMemo(()=>new Set(O.map(we=>we.productId)),[O]);const gt=g.useMemo(()=>v.filter(we=>(b[we.id]??0)>1).sort((we,ft)=>`${we.category} ${we.name}`.localeCompare(`${ft.category} ${ft.name}`)),[v,b]),yt=g.useMemo(()=>{const we=G.trim().toLowerCase();return we?gt.filter(ft=>`${ft.category??""} ${ft.name??""}`.toLowerCase().includes(we)):gt},[gt,G]),Pt=g.useMemo(()=>v.find(we=>we.id===he)||null,[he,v]),Ft=g.useMemo(()=>c&&mt?I.filter(we=>we.sellerId===mt.id):I,[I,c,mt]),Oe=async()=>{try{const we=xt(Ne,"inventory_transfers_candies"),ft=(hr,Ir,en,sn)=>{Ir&&(hr[Ir]=hr[Ir]||{out:0,in:0},hr[Ir][en]+=sn)},St=(hr,Ir,en)=>{const sn=String(Ir||"");sn&&(hr[sn]=(hr[sn]||0)+en)},Ct={},fr={},or=N.current,Hr=hr=>{var rn,pr;if(hr.destRowWasNew!=null)return!!hr.destRowWasNew;const Ir=String(hr.toVendorRowId||"");if(!Ir)return!1;const en=or[Ir];if(!en)return!1;const sn=Number(((rn=en.createdAt)==null?void 0:rn.seconds)??0),da=Number(((pr=hr.createdAt)==null?void 0:pr.seconds)??0),Zn=sn>0&&da>0&&Math.abs(sn-da)<=1,wn=Math.max(0,Number(en.packages||0))===Math.max(0,Number(hr.packagesMoved||0));return Zn&&wn},br=hr=>{const Ir=hr.data(),en=Number(Ir.packagesMoved||0);en>0&&(ft(Ct,String(Ir.fromOrderKey||""),"out",en),ft(Ct,String(Ir.toOrderKey||""),"in",en),St(fr,Ir.fromVendorRowId,-en),Hr(Ir)||St(fr,Ir.toVendorRowId,en))};if(!c)(await Ut(we)).forEach(br);else{const hr=ar(we,lr("fromSellerId","==",e)),Ir=ar(we,lr("toSellerId","==",e)),[en,sn]=await Promise.all([Ut(hr),Ut(Ir)]),da=new Set,Zn=wn=>{wn.forEach(rn=>{da.has(rn.id)||(da.add(rn.id),br(rn))})};Zn(en.docs),Zn(sn.docs)}Rt(Ct),Re(fr)}catch(we){console.error(we),Rt({}),Re({})}};g.useEffect(()=>{(async()=>{A(!0),m("");try{const we=await Ut(ar(xt(Ne,"sellers_candies"),kn("name","asc"))),ft=[];we.forEach(rn=>{const pr=rn.data(),Sr=pr.branch||pr.branchLabel||pr.route||pr.sucursal||pr.location||"";ft.push({id:rn.id,name:pr.name||"",email:pr.email||"",commissionPercent:Number(pr.commissionPercent||0),branch:RG(Sr),branchLabel:Sr})}),x(ft);const St=await Ut(ar(xt(Ne,"candy_main_orders"),kn("createdAt","desc"))),Ct={},fr={},or=(rn,pr)=>`${rn}#${String(pr).padStart(10,"0")}`;St.forEach(rn=>{var Pr;const pr=rn.data(),Sr=Number(((Pr=pr.createdAt)==null?void 0:Pr.seconds)??0),Hn=String(pr.date||""),$r=Array.isArray(pr.items)?pr.items:[];for(const Gr of $r){const $n=String(Gr.id||Gr.productId||"");if(!$n)continue;const Nn=$s(Gr.remainingPackages??Gr.remainingPacks??0);Nn>0&&(Ct[$n]=(Ct[$n]||0)+Nn);const Fn=Math.max(1,$s(Gr.packages??0)),aa=Number(Gr.providerPrice??Gr.provider_price??Gr.priceProvider??Gr.costProvider??0),Wa=Number(Gr.unitPriceRivas||0),Zo=Number(Gr.unitPriceSanJorge||0),ki=Number(Gr.unitPriceIsla||0),el=Number(Gr.gainRivas??Gr.grossProfitRivas??Gr.grossProfit??0),Cc=Number(Gr.gainSanJorge??Gr.grossProfitSanJorge??Gr.grossProfit??0),ea=Number(Gr.gainIsla??Gr.grossProfitIsla??Gr.grossProfit??0),zc=Number(Gr.logisticAllocated??Gr.prorrateo??Gr.prorrateoLogistico??Gr.gastos??0),_e=Number(Gr.uAproximada??Gr.uApprox??Gr.netProfit??Gr.vendorProfit??Gr.gainVendor??0)/Fn,it=zc/Fn,bt={id:$n,name:String(Gr.name||Gr.productName||""),category:String(Gr.category||""),unitsPerPackage:$s(Gr.unitsPerPackage??0),providerPrice:aa,unitPriceRivas:Wa,unitPriceSanJorge:Zo,unitPriceIsla:ki,grossProfitPerPackRivas:el/Fn,grossProfitPerPackSanJorge:Cc/Fn,grossProfitPerPackIsla:ea/Fn,uApproxPerPackRivas:_e,uApproxPerPackSanJorge:_e,uApproxPerPackIsla:_e,logisticAllocatedPerPack:it,masterOrderId:rn.id,key:or(Hn,Sr)},Qt=fr[$n];(!Qt||bt.key>Qt.key)&&(fr[$n]=bt)}});const Hr=await Ut(ar(xt(Ne,"inventory_candies"),kn("createdAt","desc"))),br=rn=>{const pr=Math.max(1,$s(rn.unitsPerPackage||1)),Sr=Number(rn.remaining??0);if(Number.isFinite(Sr)&&Sr>0)return Math.floor(Sr/pr);const Hn=Number(rn.remainingPackages??0);return Number.isFinite(Hn)&&Hn>0?Math.floor(Hn):0},hr={};Hr.forEach(rn=>{const pr=rn.data(),Sr=String(pr.productId||"");if(!Sr)return;const Hn=br(pr);Hn<=0||(hr[Sr]=(hr[Sr]||0)+Hn)});const Ir={};(Object.keys(hr).length?Object.keys(hr):Object.keys(Ct)).forEach(rn=>{const pr=Object.keys(hr).length?hr[rn]:Ct[rn];Ir[rn]=Math.max(0,$s(pr))}),w(Ir);const sn=await Ut(c?ar(xt(Ne,"inventory_candies_sellers"),lr("sellerId","==",e),kn("createdAt","desc")):ar(xt(Ne,"inventory_candies_sellers"),kn("createdAt","desc"))),da=Object.keys(fr).map(rn=>{const pr=fr[rn];return{id:pr.id,name:pr.name,category:pr.category,unitsPerPackage:pr.unitsPerPackage,providerPrice:pr.providerPrice,unitPriceRivas:pr.unitPriceRivas,unitPriceSanJorge:pr.unitPriceSanJorge,unitPriceIsla:pr.unitPriceIsla,grossProfitPerPackRivas:pr.grossProfitPerPackRivas,grossProfitPerPackSanJorge:pr.grossProfitPerPackSanJorge,grossProfitPerPackIsla:pr.grossProfitPerPackIsla,uApproxPerPackRivas:pr.uApproxPerPackRivas,uApproxPerPackSanJorge:pr.uApproxPerPackSanJorge,uApproxPerPackIsla:pr.uApproxPerPackIsla,logisticAllocatedPerPack:pr.logisticAllocatedPerPack,existingPacks:Ir[pr.id]??0,masterOrderId:pr.masterOrderId}}).sort((rn,pr)=>`${rn.category} ${rn.name}`.localeCompare(`${pr.category} ${pr.name}`));y(da);const Zn=[];sn.forEach(rn=>{const pr=rn.data(),Sr=Object.prototype.hasOwnProperty.call(pr,"transferDelta"),Hn=ft.find(aa=>aa.id===pr.sellerId)||null,$r=pu(pr.vendorMarginPercent??pr.vendorMargin??pr.commissionPercent??(Hn==null?void 0:Hn.commissionPercent)??0),Pr=Number(pr.uAproximada??pr.uApprox??pr.netProfit??pr.uAprox??pr.uApproxTotal??0),Gr=pr.uVendor??pr.vendorProfit??pr.gainVendor??0,$n=pr.uVendor!=null,Nn=Id(Number(pr.grossProfit??pr.gainVendor??0),$r),Fn=$n?{uAproximada:Number(Pr||0),vendorMarginPercent:$r,uVendor:Number(Gr||0),uInvestor:Number(Pr||0)-Number(Gr||0)}:{uAproximada:Number(Pr||0),vendorMarginPercent:Nn.vendorMarginPercent,uVendor:Nn.uVendor,uInvestor:Nn.uInvestor};Zn.push({id:rn.id,sellerId:pr.sellerId,sellerName:pr.sellerName||"",orderName:pr.orderName||"",productId:pr.productId,productName:pr.productName||"",category:pr.category||"",orderId:pr.orderId||null,packages:Number(pr.packages||0),unitsPerPackage:Number(pr.unitsPerPackage||0),totalUnits:Number(pr.totalUnits||0),remainingPackages:Number(pr.remainingPackages||0),remainingUnits:Number(pr.remainingUnits||0),totalRivas:Number(pr.totalRivas||0),totalSanJorge:Number(pr.totalSanJorge||0),totalIsla:Number(pr.totalIsla||0),unitPriceRivas:Number(pr.unitPriceRivas||0),unitPriceSanJorge:Number(pr.unitPriceSanJorge||0),unitPriceIsla:Number(pr.unitPriceIsla||0),grossProfit:Number(pr.grossProfit??pr.gainVendor??0),logisticAllocated:Number(pr.logisticAllocated??pr.gastos??pr.gasto??0),vendorMarginPercent:Fn.vendorMarginPercent,uAproximada:Fn.uAproximada,uVendor:Fn.uVendor,uInvestor:Fn.uInvestor,vendorProfit:Number(pr.vendorProfit??Fn.uVendor??0),transferDelta:Sr&&typeof pr.transferDelta=="number"?Number(pr.transferDelta||0):void 0,subtotal:Number(pr.subtotal||0),providerPrice:Number(pr.providerPrice||0),date:pr.date||"",createdAt:pr.createdAt||Nr.now()})});const wn={};Zn.forEach(rn=>{wn[rn.id]=rn}),N.current=wn,j(Zn),await Oe()}catch(we){console.error(we),m(" Error cargando datos de vendedores / pedidos.")}finally{A(!1)}})()},[a,t,e]);const be=(we,ft)=>`${we}__${ft}`,Ae=we=>we.orderId||be(we.sellerId,we.date),Le=(we,ft)=>ft?ft==="RIVAS"?we.unitPriceRivas||0:ft==="SAN_JORGE"?we.unitPriceSanJorge||0:we.unitPriceIsla||0:we.unitPriceIsla||we.unitPriceRivas||we.unitPriceSanJorge||0,ut=(we,ft)=>ft?ft==="RIVAS"?we.grossProfitPerPackRivas||0:ft==="SAN_JORGE"?we.grossProfitPerPackSanJorge||0:we.grossProfitPerPackIsla||0:we.grossProfitPerPackIsla||we.grossProfitPerPackRivas||we.grossProfitPerPackSanJorge||0,ct=(we,ft,St)=>{const Ct=we?Le(we,St):Number((ft==null?void 0:ft.pricePerPackage)||0),fr=Number(we?we.providerPrice||(ft==null?void 0:ft.providerPrice)||0:(ft==null?void 0:ft.providerPrice)||0);return!!(we&&(we.grossProfitPerPackIsla!=null||we.grossProfitPerPackRivas!=null||we.grossProfitPerPackSanJorge!=null))&&we?ut(we,St):Ct-fr},st=(we,ft)=>ft?ft==="RIVAS"?we.uApproxPerPackRivas||0:ft==="SAN_JORGE"?we.uApproxPerPackSanJorge||0:we.uApproxPerPackIsla||0:we.uApproxPerPackIsla||we.uApproxPerPackRivas||we.uApproxPerPackSanJorge||0,z=we=>{const ft=p.find(St=>St.id===we)||null;return pu((ft==null?void 0:ft.commissionPercent)??0)},X=we=>{const ft=Et[we.id];return typeof ft=="number"&&Number.isFinite(ft)?ft:typeof we.transferDelta=="number"?Number(we.transferDelta||0):0},re=we=>{const ft=Math.max(0,Number(we.packages||0)),St=X(we);return Math.max(0,ft+St)},H=we=>{const ft=Math.max(1,$s(we.unitsPerPackage||1)),St=Number(we.remaining??0);if(Number.isFinite(St)&&St>0)return Math.floor(St/ft);const Ct=Number(we.remainingPackages??0);return Number.isFinite(Ct)&&Ct>0?Math.floor(Ct):0},L=async(we,ft)=>{const St=String(we||"").trim();if(!St)return{byId:0,byName:0};const Ct=await Ut(ar(xt(Ne,"inventory_candies"),lr("productId","==",St)));let fr=0;Ct.forEach(hr=>{fr+=H(hr.data())});const or=Math.max(0,fr);let Hr=0;const br=String(ft||"").trim();return or===0&&br&&((await Ut(ar(xt(Ne,"inventory_candies"),lr("productName","==",br)))).forEach(Ir=>{Hr+=H(Ir.data())}),Hr=Math.max(0,Hr)),{byId:or,byName:Hr}},ue=g.useMemo(()=>{const we=new Map;for(const St of Ft){const Ct=Ae(St),fr=we.get(Ct)||{orderKey:Ct,sellerId:St.sellerId,sellerName:St.sellerName,orderName:St.orderName||"",date:St.date,totalPackages:0,totalActivePackages:0,totalRemainingPackages:0,totalExpected:0,totalExpectedActive:0,grossProfit:0,grossProfitActive:0,vendorProfit:0,vendorProfitActive:0,gastos:0,gastosActive:0,transferredOut:0,transferredIn:0},or=Math.max(0,Number(St.packages||0)),Hr=Math.max(0,Number(St.remainingPackages||0)),br=re(St),hr=or>0?br/or:1;fr.totalPackages+=or,fr.totalRemainingPackages+=Hr,fr.totalActivePackages+=br;const Ir=p.find(Nn=>Nn.id===St.sellerId)||null,en=Ir==null?void 0:Ir.branch,sn=v.find(Nn=>Nn.id===String(St.productId))||null,da=sn?Le(sn,en):Number(en==="RIVAS"?St.unitPriceRivas||0:en==="SAN_JORGE"?St.unitPriceSanJorge||0:St.unitPriceIsla||0),Zn=da*or,wn=da*br;fr.totalExpected+=Number(Zn||0),fr.totalExpectedActive+=Number(wn||0);const rn=sn?ct(sn,St,en):or>0?Number(St.grossProfit||0)/or:0,pr=rn*or,Sr=rn*br;fr.grossProfit+=Number(pr||0),fr.grossProfitActive+=Number(Sr||0);const Hn=typeof(sn==null?void 0:sn.logisticAllocatedPerPack)=="number"?Number(sn.logisticAllocatedPerPack||0):(()=>{const Nn=Number(St.logisticAllocated??St.gastos??St.gasto??0),Fn=or>0?or:br||1;return Fn>0?Nn/Fn:0})(),$r=Hn*or,Pr=Hn*br;fr.gastos=(fr.gastos||0)+Number($r||0),fr.gastosActive=(fr.gastosActive||0)+Number(Pr||0);const Gr=z(St.sellerId),$n=Id(pr,Gr);fr.vendorProfit+=Number($n.uVendor||0),fr.vendorProfitActive+=Number($n.uVendor||0)*hr,we.set(Ct,fr)}const ft=[];for(const St of we.values()){const Ct=Lt[St.orderKey]||{out:0,in:0};St.transferredOut=Ct.out||0,St.transferredIn=Ct.in||0,Number.isFinite(St.totalExpectedActive)||(St.totalExpectedActive=St.totalExpected),Number.isFinite(St.grossProfitActive)||(St.grossProfitActive=St.grossProfit),Number.isFinite(St.vendorProfitActive)||(St.vendorProfitActive=St.vendorProfit),Number.isFinite(St.gastosActive||0)||(St.gastosActive=St.gastos),ft.push(St)}return ft.sort((St,Ct)=>(Ct.date||"").localeCompare(St.date||"")),ft},[Ft,p,Lt,v,Et]),Pe=g.useMemo(()=>Math.max(1,Math.ceil(ue.length/se)),[ue.length]);g.useEffect(()=>{Z>Pe&&ke(Pe)},[Pe]);const xe=g.useMemo(()=>{const we=(Z-1)*se;return ue.slice(we,we+se)},[ue,Z]),Ge=()=>ke(we=>Math.max(1,we-1)),ze=()=>ke(we=>Math.min(Pe,we+1)),Ke=g.useMemo(()=>{const we=K.trim().toLowerCase();return we?O.filter(ft=>{const St=String(ft.productName||"").toLowerCase(),Ct=String(ft.category||"").toLowerCase();return St.includes(we)||Ct.includes(we)}):O},[O,K]),pt=g.useMemo(()=>Math.max(1,Math.ceil(Ke.length/Se)),[Ke.length]);g.useEffect(()=>{Ee>pt&&Ze(pt)},[pt]);const ne=g.useMemo(()=>{const we=(Ee-1)*Se;return Ke.slice(we,we+Se)},[Ke,Ee]),Ue=g.useMemo(()=>{const we=new Map;for(const ft of ne){const St=(ft.category||"Sin categora").trim()||"Sin categora",Ct=we.get(St)||[];Ct.push(ft),we.set(St,Ct)}return Array.from(we.entries())},[ne]),tt=we=>{vt(ft=>({...ft,[we]:!ft[we]}))},nt=()=>Ze(we=>Math.max(1,we-1)),wt=()=>Ze(we=>Math.min(pt,we+1)),Bt=we=>{Fe(ft=>({...ft,[we]:!0}))},tr=we=>{Fe(ft=>({...ft,[we]:!1}))},Or=we=>{Ve(ft=>({...ft,[we]:!0}))},zr=async we=>{Ve(Ct=>({...Ct,[we]:!1}));const ft=O.find(Ct=>Ct.id===we)||null;if(!ft)return;const St=Number(ft.remainingPackages||0);if(!(!we||String(we).startsWith("tmp_")))try{$e(en=>({...en,[we]:!0}));const Ct=N.current?N.current[we]:null,fr=Kt(Ne,"inventory_candies_sellers",we);let or=Ct||{};try{const en=await Es(fr);en.exists()&&(or=en.data())}catch(en){console.warn("Could not read doc before update, using local values",en)}const Hr=Math.max(1,Math.floor(Number(or.unitsPerPackage??ft.unitsPerPackage??1))),br=Math.max(0,Math.floor(St*Hr)),hr=Number((Ct==null?void 0:Ct.remainingPackages)??0),Ir=Math.max(0,Math.floor(Number(or.remainingUnits??(Ct==null?void 0:Ct.remainingUnits)??0)));console.debug("[OrdenVendedor] saving remaining",{id:we,newRem:St,unitsPerPackage:Hr,newRemainingUnits:br,oldRem:hr,oldRemainingUnits:Ir}),await Mn(Kt(Ne,"inventory_candies_sellers",we),{remainingPackages:St,remainingUnits:br});try{await ta(xt(Ne,"inventory_candies_sellers_logs"),{vendorRowId:we,productId:ft.productId||null,sellerId:(Ct==null?void 0:Ct.sellerId)||null,orderId:(Ct==null?void 0:Ct.orderId)||null,orderName:(Ct==null?void 0:Ct.orderName)||null,oldRemainingPackages:hr,newRemainingPackages:St,oldRemainingUnits:Ir,newRemainingUnits:br,unitsPerPackage:Hr,user:Vi!=null&&Vi.currentUser?{uid:Vi.currentUser.uid,email:Vi.currentUser.email}:null,createdAt:tP()})}catch(en){console.warn("No se pudo escribir audit log:",en)}j(en=>en.map(sn=>sn.id===we?{...sn,remainingPackages:St,remainingUnits:br}:sn)),m(" Restante actualizado"),me(" Restante actualizado","success"),setTimeout(()=>m(""),3e3),N.current=N.current||{},N.current[we]&&(N.current[we]={...N.current[we],remainingPackages:St,remainingUnits:br});try{const en=(Ct==null?void 0:Ct.sellerId)||null,sn=ft.productId||null;window.dispatchEvent(new CustomEvent("vendorInventoryChanged",{detail:{sellerId:en,productId:sn}}))}catch{}}catch(Ct){console.error(Ct),m(" Error guardando restantes."),me(" Error guardando restantes.","error")}finally{$e(Ct=>({...Ct,[we]:!1}))}},ur=we=>{We(ft=>({...ft,[we]:!0}))},Dr=we=>{We(ft=>({...ft,[we]:!1}))},dn=async we=>{pe(ft=>({...ft,[we]:!0}));try{const ft=O.find(en=>en.id===we);if(!ft)return;const St=v.find(en=>en.id===ft.productId)||null,Ct=p.find(en=>en.id===T)||null,fr=Ct==null?void 0:Ct.branch,or=$s(ft.packages);console.log("[OV] recalcItem start",{id:we,productId:ft.productId,packs:ft.packages,pricePerPackage:ft.pricePerPackage,providerPrice:ft.providerPrice,grossProfitStored:ft.grossProfit});const Hr=Number(ft.pricePerPackage||0),br=Hr*or,hr=ct(St,ft,fr),Ir=hr*or;console.log("[OV] recalcItem computed",{id:we,productId:ft.productId,pricePerPackage:Hr,providerPrice:(St==null?void 0:St.providerPrice)??ft.providerPrice,grossPerPack:hr,grossProfit:Ir,totalExpected:br}),R(en=>en.map(sn=>sn.id===we?{...sn,totalExpected:br,grossProfit:Ir}:sn)),j(en=>en.map(sn=>sn.id===we?{...sn,grossProfit:Ir}:sn)),N.current&&N.current[we]&&(N.current[we]={...N.current[we],grossProfit:Ir}),String(we).startsWith("tmp_")||await Mn(Kt(Ne,"inventory_candies_sellers",we),{totalExpected:br,grossProfit:Ir,updatedAt:Nr.now()}),me("Total esperado recalculado","success")}catch(ft){console.error(ft),me("Error al recalcular utilidad bruta","error")}finally{pe(ft=>({...ft,[we]:!1}))}},mn=we=>{const ft=Math.max(0,Number(we.packages||0)),St=Number(we.transferDelta||0);return Math.max(0,ft+St)},kr=we=>{const ft=Math.max(0,Number(we.packages||0)),St=mn(we);return ft===0?St>0?1:0:Math.min(1,St/ft)},Qe=(we,ft)=>Number(ft||0)*kr(we),jt=we=>Number(we.logisticAllocated??we.logisticAllocated??we.gastos??we.gasto??0),wr=we=>{const ft=Number(we.totalExpected||0),St=Number(we.grossProfit||0),Ct=Qe(we,St),fr=Qe(we,jt(we)),or=pu(we.vendorMarginPercent||0),Hr=Id(St,or),br=Qe(we,Number(Hr.uVendor||0)),hr=Number(Ct||0)-Number(fr||0)-Number(br||0);return{totalExpected:ft,grossProfit:Ct,gastos:fr,uVendor:br,uNeta:hr}},ln=g.useMemo(()=>O.reduce((we,ft)=>{const St=Math.max(0,Number(ft.packages||0)),Ct=mn(ft),fr=wr(ft);return we.totalPackages+=St,we.totalActivePackages+=Ct,we.totalExpected+=fr.totalExpected,we.grossProfit+=fr.grossProfit,we.gastosTotal+=fr.gastos,we.uVendor+=fr.uVendor,we},{totalPackages:0,totalActivePackages:0,totalExpected:0,grossProfit:0,gastosTotal:0,uVendor:0}),[O]),cn=g.useMemo(()=>ln.grossProfit-ln.gastosTotal-ln.uVendor,[ln.grossProfit,ln.gastosTotal,ln.uVendor]),_r=()=>{k(null),P(""),de(""),le(""),ae(""),De("0"),R([]),M(""),Ze(1),Fe({}),We({})},Jt=()=>{m(""),_r(),c&&mt&&P(mt.id);const we=new Date,ft=we.getFullYear(),St=String(we.getMonth()+1).padStart(2,"0"),Ct=String(we.getDate()).padStart(2,"0");de(`${ft}-${St}-${Ct}`),le(""),E(!0)},ir=()=>{E(!1)},Fr=we=>{m(""),_r(),k(we);const[ft,St]=we.split("__");P(ft||""),de(St||"");const Ct=Ft.filter(hr=>Ae(hr)===we),fr=Ct[0]||null;le((fr==null?void 0:fr.orderName)||"");const or=p.find(hr=>hr.id===ft)||null,Hr=or==null?void 0:or.branch,br=Ct.map(hr=>{const Ir=v.find($n=>$n.id===String(hr.productId))||null,en=Number(hr.unitPriceRivas||(Ir==null?void 0:Ir.unitPriceRivas)||0),sn=Number(hr.unitPriceSanJorge||(Ir==null?void 0:Ir.unitPriceSanJorge)||0),da=Number(hr.unitPriceIsla||(Ir==null?void 0:Ir.unitPriceIsla)||0),Zn=Number(hr.packages||0),wn=Hr==="RIVAS"?en:Hr==="SAN_JORGE"?sn:da,rn=Number(hr.totalRivas||0),pr=Number(hr.totalSanJorge||0),Sr=Number(hr.totalIsla||0),Hn=Hr==="RIVAS"?rn:Hr==="SAN_JORGE"?pr:Sr,$r=pu(hr.vendorMarginPercent??z(ft)),Pr=Id(Number(hr.grossProfit||0),$r),Gr=Number(hr.logisticAllocated??hr.gastos??0)||(Ir?Ir.logisticAllocatedPerPack*Zn:0);return{id:hr.id,productId:String(hr.productId||""),productName:hr.productName||(Ir==null?void 0:Ir.name)||"",category:hr.category||(Ir==null?void 0:Ir.category)||"",unitsPerPackage:Number(hr.unitsPerPackage||(Ir==null?void 0:Ir.unitsPerPackage)||0),packages:Zn,totalExpected:Hn,pricePerPackage:wn,grossProfit:Number(hr.grossProfit||0),logisticAllocated:Gr,vendorMarginPercent:Pr.vendorMarginPercent,uAproximada:Number(hr.uAproximada||0),uVendor:Number(hr.uVendor??Pr.uVendor??0),uInvestor:Number(hr.uInvestor??Pr.uInvestor??0),totalRivas:rn,totalSanJorge:pr,totalIsla:Sr,unitPriceRivas:en,unitPriceSanJorge:sn,unitPriceIsla:da,providerPrice:Number(hr.providerPrice||0),remainingPackages:Number(hr.remainingPackages||0),transferDelta:X(hr)}});R(br);try{console.log("[OV] openOrder modal items",br.map(hr=>({id:hr.id,productId:hr.productId,packages:hr.packages,pricePerPackage:hr.pricePerPackage,providerPrice:hr.providerPrice,grossProfit:hr.grossProfit})))}catch{}E(!0)},Er=()=>{if(m(""),!T)return m(" Seleccion un vendedor.");if(!q)return m(" Seleccion una fecha.");if(!he)return m(" Seleccion un producto.");const we=$s(Ce);if(we<=0)return m(" Paquetes debe ser > 0.");const ft=v.find(wn=>wn.id===he);if(!ft)return m(" Producto no encontrado.");if(O.some(wn=>wn.productId===ft.id))return m(" Ese producto ya est agregado al pedido.");const St=p.find(wn=>wn.id===T)||null,Ct=St==null?void 0:St.branch,fr=Le(ft,Ct),or=ct(ft,void 0,Ct),br=st(ft,Ct)*we,hr=fr*we,Ir=or*we,en=ft.logisticAllocatedPerPack*we,sn=z(T),da=Id(Ir,sn),Zn={id:`tmp_${Date.now()}_${Math.random().toString(16).slice(2)}`,productId:ft.id,productName:ft.name,category:ft.category,unitsPerPackage:ft.unitsPerPackage,packages:we,totalExpected:hr,pricePerPackage:fr,grossProfit:Ir,logisticAllocated:en,providerPrice:ft.providerPrice,vendorMarginPercent:da.vendorMarginPercent,uAproximada:br,uVendor:da.uVendor,uInvestor:da.uInvestor,totalRivas:(ft.unitPriceRivas||0)*we,totalSanJorge:(ft.unitPriceSanJorge||0)*we,totalIsla:(ft.unitPriceIsla||0)*we,unitPriceRivas:ft.unitPriceRivas||0,unitPriceSanJorge:ft.unitPriceSanJorge||0,unitPriceIsla:ft.unitPriceIsla||0,remainingPackages:we,transferDelta:0};R(wn=>[Zn,...wn]),ae(""),De("0"),Ze(1)},Lr=we=>{R(ft=>ft.filter(St=>St.id!==we))},Ln=(we,ft)=>{const St=Math.max(0,$s(ft));R(Ct=>Ct.map(fr=>{if(fr.id!==we)return fr;const or=v.find(Sr=>Sr.id===fr.productId),Hr=p.find(Sr=>Sr.id===T)||null,br=Hr==null?void 0:Hr.branch,hr=or?Le(or,br):fr.pricePerPackage||0,en=ct(or,fr,br)*St,sn=or?or.logisticAllocatedPerPack*St:fr.logisticAllocated||0,Zn=(or?st(or,br):0)*St,wn=fr.vendorMarginPercent!=null?fr.vendorMarginPercent:z(T),rn=Id(en,wn),pr=String(fr.id||"").startsWith("tmp_")||Number(fr.remainingPackages||0)===Number(fr.packages||0);return{...fr,packages:St,pricePerPackage:hr,totalExpected:hr*St,grossProfit:en,logisticAllocated:sn,providerPrice:(or==null?void 0:or.providerPrice)??fr.providerPrice??Number(fr.providerPrice||0),vendorMarginPercent:rn.vendorMarginPercent,uAproximada:Zn,uVendor:rn.uVendor,uInvestor:rn.uInvestor,totalRivas:((or==null?void 0:or.unitPriceRivas)||fr.unitPriceRivas||0)*St,totalSanJorge:((or==null?void 0:or.unitPriceSanJorge)||fr.unitPriceSanJorge||0)*St,totalIsla:((or==null?void 0:or.unitPriceIsla)||fr.unitPriceIsla||0)*St,remainingPackages:pr?St:fr.remainingPackages}}))},Nt=(we,ft)=>{const St=pu(ft);R(Ct=>Ct.map(fr=>{if(fr.id!==we)return fr;const or=v.find(Zn=>Zn.id===fr.productId),Hr=p.find(Zn=>Zn.id===T)||null,br=Hr==null?void 0:Hr.branch,hr=$s(fr.packages),en=(or?st(or,br):0)*hr,sn=Number(fr.grossProfit||0),da=Id(sn,St);return{...fr,vendorMarginPercent:da.vendorMarginPercent,uAproximada:en,uVendor:da.uVendor,uInvestor:da.uInvestor}}))},nr=async()=>{if(l&&!te)try{ve(!0),m("");const we=I;if(!we.length){m(" No hay documentos para actualizar.");return}const ft=br=>v.find(hr=>hr.id===br)||null,St=br=>{const hr=p.find(Ir=>Ir.id===br)||null;return hr==null?void 0:hr.branch},Ct=(br,hr)=>Math.abs(Number(br||0)-Number(hr||0))>.01;let fr=Lc(Ne),or=0,Hr=0;for(const br of we){const hr=St(br.sellerId)||"ISLA",Ir=Math.max(1,Number(br.unitsPerPackage||0)||1),en=Number(br.totalUnits||0),sn=Number(br.remainingUnits||0),Zn=Math.max(0,en-sn)/Ir,wn=Number(br.remainingPackages||0),rn=Math.max(0,wn+Zn),pr=ft(String(br.productId||"")),Sr=pr&&rn>0?ct(pr,br,hr)*rn:Number(br.grossProfit||0),Hn=pr&&rn>0?pr.logisticAllocatedPerPack*rn:Number(br.logisticAllocated||0),$r=pr?st(pr,hr):0,Pr=rn>0?$r*rn:0,Gr=br.vendorMarginPercent!=null?pu(br.vendorMarginPercent):z(br.sellerId),$n=Id(Sr,Gr),Nn=$n.uVendor,Fn=$n.uInvestor,aa=Sr-Hn-Nn;if(!(Ct(br.packages,rn)||br.uVendor==null||br.uNeta==null||br.uAproximada==null||br.uInvestor==null||br.logisticAllocated==null||Ct(br.uVendor,Nn)||Ct(br.uNeta,aa)||Ct(br.uAproximada,Pr)||Ct(br.uInvestor,Fn)||Ct(br.logisticAllocated,Hn)))continue;const Zo=Kt(Ne,"inventory_candies_sellers",br.id);fr.update(Zo,{packages:rn,vendorMarginPercent:Gr,grossProfit:Sr,logisticAllocated:Hn,uAproximada:Pr,uVendor:Nn,uInvestor:Fn,uNeta:aa,vendorProfit:Nn,updatedAt:Nr.now()}),or+=1,Hr+=1,or>=400&&(await fr.commit(),fr=Lc(Ne),or=0)}or>0&&await fr.commit(),m(` Actualizados ${Hr} documentos.`),s()}catch(we){console.error(we),m(" Error actualizando documentos.")}finally{ve(!1)}},$t=(we,ft,St="Hoja1")=>{const Ct=pa.book_new(),fr=pa.aoa_to_sheet(ft);pa.book_append_sheet(Ct,fr,St),zv(Ct,we)},Mt=()=>{if(!l){m(" Solo admin puede exportar Excel.");return}const we=["Vendedor","Sucursal","Fecha","Producto ID","Producto","Categora","Paquetes","Paquetes restantes","Precio paquete","Precio proveedor","Total esperado","U. Bruta","U. Vendedor","U. Neta","P. Isla","Total Isla","Unidades x paquete","vendorMarginPercent"],ft=p.find(or=>or.id===T)||null,St=(ft==null?void 0:ft.branch)||RG(ft==null?void 0:ft.branchLabel)||"",Ct=[we,...O.map(or=>{const{totalExpected:Hr,grossProfit:br,uVendor:hr,uNeta:Ir}=wr(or);return[(ft==null?void 0:ft.name)||"",String(St),q||"",or.productId,or.productName,or.category,Number(or.packages||0),Number(or.remainingPackages||0),Number(or.pricePerPackage||0),Number(or.providerPrice||0),Number(Hr||0),Number(br||0),Number(hr||0),Number(Ir||0),Number(or.unitPriceIsla||0),Number(or.totalIsla||0),Number(or.unitsPerPackage||0),Number(or.vendorMarginPercent||0)]})],fr=`vendor_order_items_${((ft==null?void 0:ft.name)||"vendedor").replace(/\s+/g,"_")}_${q||"sin_fecha"}.xlsx`;$t(fr,Ct,"Productos")},Be=()=>{const we=["productId","productName","category","Existentes","Paquetes","vendorMarginPercent","uNeta"],ft=v.map(Ct=>({id:Ct.id,name:Ct.name,category:Ct.category,existentes:Number(Ct.existingPacks||0)})).filter(Ct=>Ct.existentes>0).sort((Ct,fr)=>`${Ct.category} ${Ct.name}`.localeCompare(`${fr.category} ${fr.name}`)),St=[we,...ft.map(Ct=>[Ct.id,Ct.name,Ct.category,Ct.existentes,"","",""])];$t("plantilla_orden_vendedor.xlsx",St,"Plantilla")},It=async we=>{try{m("");const ft=await we.arrayBuffer(),St=qv(ft,{type:"array"}),Ct=St.SheetNames||[],fr=St.Sheets.Plantilla||St.Sheets.Productos||St.Sheets[Ct[0]];if(!fr)return m(" Archivo sin hojas.");const or=pa.sheet_to_json(fr,{header:1,defval:""});if(!or.length)return m(" Archivo vaco.");const Hr=(or[0]||[]).map(wn=>String(wn||"").trim().toLowerCase()),br=Hr.findIndex(wn=>wn==="productid"||wn==="producto id"||wn==="id"),hr=Hr.findIndex(wn=>wn==="paquetes"||wn==="packages"),Ir=Hr.findIndex(wn=>wn==="vendormarginpercent"||wn==="vendor_margin_percent"||wn==="marginvendorpercent"||wn==="margen"||wn==="margen vendedor"||wn==="margen_del_vendedor");if(br<0||hr<0)return m(" Plantilla invlida: debe tener columnas productId y Paquetes.");if(!T)return m(" Seleccion un vendedor antes de importar.");if(!q)return m(" Seleccion una fecha antes de importar.");const en=p.find(wn=>wn.id===T)||null,sn=en==null?void 0:en.branch,da=z(T),Zn=[];for(let wn=1;wn<or.length;wn++){const rn=or[wn]||[],pr=String(rn[br]||"").trim();if(!pr)continue;const Sr=v.find(it=>it.id===pr)||null,Hn=O.find(it=>it.productId===pr)||{},$r=(Hn==null?void 0:Hn.id)||"",Pr=$s(Number(rn[hr]??Hn.packages??0)),Gr=Sr?Le(Sr,sn):Number(Hn.pricePerPackage||0),Nn=ct(Sr,Hn,sn)*Pr,Fn=Gr*Pr,aa=((Sr==null?void 0:Sr.unitPriceRivas)||Hn.unitPriceRivas||0)*Pr,Wa=((Sr==null?void 0:Sr.unitPriceSanJorge)||Hn.unitPriceSanJorge||0)*Pr,Zo=((Sr==null?void 0:Sr.unitPriceIsla)||Hn.unitPriceIsla||0)*Pr;R(it=>it.map(bt=>bt.id===$r?{...bt,grossProfit:Nn,totalExpected:Fn,pricePerPackage:Gr}:bt)),j(it=>it.map(bt=>bt.id===$r?{...bt,grossProfit:Nn,totalRivas:aa,totalSanJorge:Wa,totalIsla:Zo}:bt)),N.current&&N.current[$r]&&(N.current[$r]={...N.current[$r],grossProfit:Nn,totalRivas:aa,totalSanJorge:Wa,totalIsla:Zo}),String($r).startsWith("tmp_")||await Mn(Kt(Ne,"inventory_candies_sellers",$r),{grossProfit:Nn,totalExpected:Fn,pricePerPackage:Gr,totalRivas:aa,totalSanJorge:Wa,totalIsla:Zo,updatedAt:Nr.now()});const ki=Sr?Sr.logisticAllocatedPerPack*Pr:Number(Hn.logisticAllocated||0),Cc=(Sr?st(Sr,sn):0)*Pr,ea=Ir>=0&&String(rn[Ir]??"").trim()!==""?Number(rn[Ir]):(Hn==null?void 0:Hn.vendorMarginPercent)!=null&&String(Hn.vendorMarginPercent).trim()!==""?pu(Hn.vendorMarginPercent):da,zc=Id(Nn,ea),U=O.find(it=>it.productId===pr);if(U){const it=Ir>=0&&String(rn[Ir]??"").trim()!==""?ea:U.vendorMarginPercent,bt=Id(Nn,it);R(Qt=>Qt.map(cr=>cr.id===U.id?{...cr,packages:Pr,pricePerPackage:Gr,totalExpected:Fn,grossProfit:Nn,logisticAllocated:ki,vendorMarginPercent:bt.vendorMarginPercent,uAproximada:Cc,uVendor:bt.uVendor,uInvestor:bt.uInvestor,totalRivas:((Sr==null?void 0:Sr.unitPriceRivas)||cr.unitPriceRivas||0)*Pr,totalSanJorge:((Sr==null?void 0:Sr.unitPriceSanJorge)||cr.unitPriceSanJorge||0)*Pr,totalIsla:((Sr==null?void 0:Sr.unitPriceIsla)||cr.unitPriceIsla||0)*Pr}:cr));continue}const _e={id:`tmp_${Date.now()}_${Math.random().toString(16).slice(2)}`,productId:(Sr==null?void 0:Sr.id)||pr,productName:(Sr==null?void 0:Sr.name)||"",category:(Sr==null?void 0:Sr.category)||"",unitsPerPackage:(Sr==null?void 0:Sr.unitsPerPackage)||0,packages:Pr,pricePerPackage:Gr,totalExpected:Fn,grossProfit:Nn,logisticAllocated:ki,providerPrice:Sr==null?void 0:Sr.providerPrice,vendorMarginPercent:zc.vendorMarginPercent,uAproximada:Cc,uVendor:zc.uVendor,uInvestor:zc.uInvestor,totalRivas:((Sr==null?void 0:Sr.unitPriceRivas)||0)*Pr,totalSanJorge:((Sr==null?void 0:Sr.unitPriceSanJorge)||0)*Pr,totalIsla:((Sr==null?void 0:Sr.unitPriceIsla)||0)*Pr,unitPriceRivas:(Sr==null?void 0:Sr.unitPriceRivas)||0,unitPriceSanJorge:(Sr==null?void 0:Sr.unitPriceSanJorge)||0,unitPriceIsla:(Sr==null?void 0:Sr.unitPriceIsla)||0,remainingPackages:Pr};Zn.push(_e)}if(!Zn.length)return m(" No se encontraron filas con Paquetes > 0.");R(wn=>[...Zn,...wn]),Ze(1),m(` Importados ${Zn.length} productos desde plantilla.`)}catch(ft){console.error(ft),m(" Error importando Excel.")}},Vt=async()=>{var we;try{if(m(""),u)return m(" Solo lectura.");if(!T)return m(" Seleccion un vendedor.");if(!q)return m(" Seleccion una fecha.");if(!O.length)return m(" Agreg al menos 1 producto.");const ft=p.find($r=>$r.id===T)||null;if(!ft)return m(" Vendedor invlido.");const St=ft.branch,Ct=B?Ft.filter($r=>Ae($r)===B):[],fr=String(((we=Ct[0])==null?void 0:we.orderName)||"").trim(),or=String(ce||"").trim(),Hr=B?fr!==or:or!=="",br=$r=>String($r??"").trim(),hr=new Map;Ct.forEach($r=>hr.set(br($r.productId),$r));const Ir=$r=>hr.get(br($r))||null,en=$r=>{const Pr=Ir($r.productId),Gr=$s($r.packages),$n=Pr?$s(Pr.packages):0,Nn=!Pr||Gr!==$n,Fn=pu(Pr?Pr.vendorMarginPercent:$r.vendorMarginPercent),aa=pu($r.vendorMarginPercent);return{prev:Pr,newPacks:Gr,oldPacks:$n,packsChanged:Nn,marginChanged:Pr?Fn!==aa:!0}},sn=B?O.filter($r=>{const Pr=en($r);return!Pr.prev||Pr.packsChanged||Pr.marginChanged}):O;for(const $r of sn){const Pr=$s($r.packages),Gr=B?Ir($r.productId):null,$n=Gr?$s(Gr.packages):0,Nn=Pr-$n;if(Nn>0){let Fn=b[$r.productId]??0;const aa=v.find(Wa=>Wa.id===$r.productId)||null;if(Nn>Fn&&(aa!=null&&aa.masterOrderId))try{await SF(aa.masterOrderId);const Wa=await L($r.productId,$r.productName);Fn=Wa.byId,w(Zo=>({...Zo,[$r.productId]:Wa.byId}))}catch{}if(Nn>Fn){const Wa=await L($r.productId,$r.productName);return Wa.byId===0&&Wa.byName>0?m(` "${$r.productName}" no tiene inventario por ID (${$r.productId}). Pero existe por nombre: ${Wa.byName} paquetes. Revisa que el productId del inventario coincida con el catlogo.`):m(` "${$r.productName}" excede existencias de orden maestra. Existentes: ${Wa.byId} (faltan ${Nn})`)}}}V(!0);const da=Nr.now(),Zn=be(T,q),wn=z(T),rn=new Set(O.map($r=>String($r.id||""))),pr=B?Ct.filter($r=>!rn.has(String($r.id||""))):[];if(B&&sn.length===0&&!pr.length&&!Hr)return V(!1),m(" No hay cambios para guardar.");if(B&&sn.length===0&&!pr.length&&Hr){const $r=Lc(Ne);Ct.forEach(Pr=>{$r.update(Kt(Ne,"inventory_candies_sellers",Pr.id),{orderName:or,updatedAt:Nr.now()})}),await $r.commit(),j(Pr=>Pr.map(Gr=>Ae(Gr)===B?{...Gr,orderName:or}:Gr)),m(" Pedido guardado."),E(!1),_r(),s();return}if(B){const $r=[];for(const Pr of pr)await PG(Pr.id),$r.push(Pr.id);$r.length&&j(Pr=>Pr.filter(Gr=>!$r.includes(Gr.id)));for(const Pr of O){const Gr=Ir(Pr.productId);if(!Gr)continue;const $n=$s(Pr.packages),Nn=$s(Gr.packages),Fn=$n-Nn;if(Fn<0){const aa=Math.abs(Fn),Wa=$s(Gr.remainingPackages);if(aa>Wa)return m(` No pods bajar "${Pr.productName}" en ${aa} porque solo quedan ${Wa} paquetes restantes.`);await gVe({vendorInventoryId:Gr.id,packagesToReturn:aa})}}}const Sr=new Map;let Hn="";for(const $r of sn){const Pr=en($r),Gr=Pr.newPacks-Pr.oldPacks;if(Pr.packsChanged&&Gr>0)try{const{allocations:$n}=await IG({productId:$r.productId,packagesToAllocate:Gr});Sr.set($r.productId,$n||[])}catch{const Nn=v.find(Fn=>Fn.id===$r.productId)||null;if(Nn!=null&&Nn.masterOrderId)try{await SF(Nn.masterOrderId);const{allocations:Fn}=await IG({productId:$r.productId,packagesToAllocate:Gr});Sr.set($r.productId,Fn||[]);continue}catch{const aa=await L($r.productId,$r.productName);aa.byId===0&&aa.byName>0?Hn=` "${$r.productName}" no tiene inventario por ID (${$r.productId}). Pero existe por nombre: ${aa.byName} paquetes. Revisa que el productId del inventario coincida con el catlogo.`:Hn=` No hay paquetes disponibles en orden maestra para "${$r.productName}". Disponibles: ${aa.byId}.`;break}{const Fn=await L($r.productId,$r.productName);Fn.byId===0&&Fn.byName>0?Hn=` "${$r.productName}" no tiene inventario por ID (${$r.productId}). Pero existe por nombre: ${Fn.byName} paquetes. Revisa que el productId del inventario coincida con el catlogo.`:Hn=` No hay paquetes disponibles en orden maestra para "${$r.productName}". Disponibles: ${Fn.byId}.`}break}}if(Hn)return V(!1),m(Hn);if(await fi(Ne,async $r=>{for(const Pr of sn){const Gr=en(Pr),$n=Gr.prev;if(B&&$n&&!Gr.packsChanged){const Da=Pr.vendorMarginPercent!=null?Pr.vendorMarginPercent:wn,Va=Number($n.grossProfit??Pr.grossProfit??0),ti=Number($n.logisticAllocated??Pr.logisticAllocated??0),as=Id(Va,Da),ri=Number(Va||0)-Number(ti||0)-Number(as.uVendor||0),Qs=Kt(Ne,"inventory_candies_sellers",Pr.id);$r.update(Qs,{vendorMarginPercent:as.vendorMarginPercent,uVendor:as.uVendor,uInvestor:as.uInvestor,uNeta:ri,vendorProfit:as.uVendor});continue}const Nn=$s(Pr.packages),Fn=$s(Pr.unitsPerPackage),aa=Nn*Fn,Wa=$n?$s($n.packages):0,Zo=$n?$s($n.remainingPackages):0,ki=Nn-Wa,el=$n?Math.max(0,Zo+ki):Nn,Cc=el*Fn,ea=v.find(Da=>Da.id===Pr.productId),zc=ea?Le(ea,St):Number(Pr.pricePerPackage||0),_e=ct(ea,Pr,St)*Nn,it=ea?ea.logisticAllocatedPerPack*Nn:Pr.logisticAllocated||0,Qt=(ea?st(ea,St):0)*Nn,cr=Pr.vendorMarginPercent!=null?Pr.vendorMarginPercent:wn,jr=Id(_e,cr),fn=Number(_e||0)-Number(it||0)-Number(jr.uVendor||0),bn=((ea==null?void 0:ea.unitPriceRivas)||Pr.unitPriceRivas||0)*Nn,Un=((ea==null?void 0:ea.unitPriceSanJorge)||Pr.unitPriceSanJorge||0)*Nn,Xn=((ea==null?void 0:ea.unitPriceIsla)||Pr.unitPriceIsla||0)*Nn,oa={sellerId:ft.id,sellerName:ft.name,sellerEmail:ft.email||"",branch:ft.branch||"",branchLabel:ft.branchLabel||"",orderName:String(ce||"").trim(),productId:Pr.productId,productName:Pr.productName,category:Pr.category,orderId:Zn,date:q,createdAt:da,packages:Nn,unitsPerPackage:Fn,totalUnits:aa,remainingPackages:el,remainingUnits:Cc,totalRivas:bn,totalSanJorge:Un,totalIsla:Xn,unitPriceRivas:(ea==null?void 0:ea.unitPriceRivas)||Pr.unitPriceRivas||0,unitPriceSanJorge:(ea==null?void 0:ea.unitPriceSanJorge)||Pr.unitPriceSanJorge||0,unitPriceIsla:(ea==null?void 0:ea.unitPriceIsla)||Pr.unitPriceIsla||0,grossProfit:_e,logisticAllocated:it,vendorMarginPercent:jr.vendorMarginPercent,uVendor:jr.uVendor,uNeta:fn,uAproximada:Qt,uInvestor:jr.uInvestor,providerPrice:Number(Pr.providerPrice??(ea==null?void 0:ea.providerPrice)??0),vendorProfit:jr.uVendor,transferDelta:$n?Number($n.transferDelta||0):0},Ea=Sr.get(Pr.productId)||[];if(B)if(String(Pr.id||"").startsWith("tmp_")){const Da=Kt(xt(Ne,"inventory_candies_sellers"));oa.masterAllocations=Ea,$r.set(Da,oa)}else{const Da=Kt(Ne,"inventory_candies_sellers",Pr.id);Ea.length>0&&(oa.masterAllocations=$ee(...Ea)),$r.set(Da,oa,{merge:!0})}else{const Da=Kt(xt(Ne,"inventory_candies_sellers"));oa.masterAllocations=Ea,$r.set(Da,oa)}}}),B&&Hr){const $r=new Set(pr.map(Gr=>Gr.id)),Pr=Lc(Ne);Ct.forEach(Gr=>{$r.has(Gr.id)||Pr.update(Kt(Ne,"inventory_candies_sellers",Gr.id),{orderName:or,updatedAt:Nr.now()})}),await Pr.commit(),j(Gr=>Gr.map($n=>Ae($n)===B?{...$n,orderName:or}:$n))}m(" Pedido guardado."),E(!1),_r(),s()}catch(ft){console.error(ft),m(" Error guardando el pedido.")}finally{V(!1)}},Ot=async we=>{try{if(m(""),!l)return m(" Solo admin.");V(!0);const ft=Ft.filter(St=>Ae(St)===we);for(const St of ft)await PG(St.id);m(" Pedido eliminado."),s()}catch(ft){console.error(ft),m(" Error eliminando pedido.")}finally{V(!1)}},qt=wi.useRef(null),sr=()=>{var we;if(u)return m(" Solo lectura.");if(!T)return m(" Seleccion un vendedor.");if(!q)return m(" Seleccion una fecha.");(we=qt.current)==null||we.click()},vr=async we=>{var St;const ft=(St=we.target.files)==null?void 0:St[0];we.target.value="",ft&&await It(ft)},rr=!l,dr=l?12:9;return i.jsxs("div",{className:"p-3 md:p-6",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-2 md:gap-3 mb-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h2",{className:"text-lg md:text-2xl font-semibold",children:"rdenes de Vendedor (Dulces)"}),i.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Pedidos agrupados por vendedor + fecha. U. Bruta viene de la orden maestra. U. Neta = U. Bruta - Gastos - U. Vendedor."})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx(yc,{onClick:s}),l&&i.jsx("button",{onClick:()=>Ye(!0),className:"px-3 py-2 rounded bg-amber-600 text-white text-sm hover:bg-amber-700",children:"Traslados"}),!u&&i.jsx("button",{onClick:Jt,className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",children:"+ Nuevo pedido"})]})]}),h&&!S&&i.jsx("div",{className:"mb-3 p-2 rounded border text-sm bg-white",children:h}),fe&&i.jsx("div",{className:`fixed top-4 right-4 z-50 px-4 py-2 rounded shadow-lg text-sm ${fe.type==="success"?"bg-green-600 text-white":"bg-red-600 text-white"}`,children:fe.msg}),f?i.jsx("div",{className:"p-4 text-sm text-gray-600",children:"Cargando"}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"hidden md:block bg-white border rounded",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-700",children:["Total pedidos: ",i.jsx("b",{children:ue.length})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[l&&i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:()=>{if(!S){m(" Abr un pedido para exportar productos asociados.");return}Mt()},children:"Exportar asociados"}),l&&i.jsx(i.Fragment,{children:i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:nr,disabled:te,children:te?"Actualizando campos...":"Actualizar campos calculados"})})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-2 border-b",children:"Nombre"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Fecha"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Vendedor"}),i.jsx("th",{className:"text-right p-2 border-b",children:"P. Asociados"}),i.jsx("th",{className:"text-right p-2 border-b",children:"P. Restantes"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"Total esperado"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"U. Bruta"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"Gastos"}),i.jsx("th",{className:"text-right p-2 border-b",children:"U. Vendedor"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Trasl. Salida"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Trasl. Entrada"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Acciones"})]})}),i.jsxs("tbody",{children:[xe.map(we=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"p-2 border-b",children:we.orderName||""}),i.jsx("td",{className:"p-2 border-b",children:we.date}),i.jsx("td",{className:"p-2 border-b",children:we.sellerName}),i.jsx("td",{className:"p-2 border-b text-right",children:we.totalPackages}),i.jsx("td",{className:"p-2 border-b text-right",children:we.totalRemainingPackages}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:yi(we.totalExpectedActive??we.totalExpected)}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:yi(we.grossProfitActive??we.grossProfit)}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:yi((we.gastosActive??we.gastos)||0)}),i.jsx("td",{className:"p-2 border-b text-right",children:yi(we.vendorProfitActive??we.vendorProfit)}),i.jsx("td",{className:"p-2 border-b text-right",children:we.transferredOut}),i.jsx("td",{className:"p-2 border-b text-right",children:we.transferredIn}),i.jsx("td",{className:"p-2 border-b",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1.5 rounded bg-gray-900 text-white text-xs hover:bg-black",onClick:()=>Fr(we.orderKey),children:"Ver / Editar"}),l&&i.jsx("button",{className:"px-3 py-1.5 rounded bg-red-600 text-white text-xs hover:bg-red-700",onClick:()=>{confirm("Eliminar este pedido completo?")&&Ot(we.orderKey)},children:"Eliminar"})]})})]},we.orderKey)),!xe.length&&i.jsx("tr",{children:i.jsx("td",{className:"p-3 text-sm text-gray-600",colSpan:dr,children:"No hay pedidos."})})]})]})}),i.jsxs("div",{className:"p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Pgina ",Z," / ",Pe]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:Ge,disabled:Z<=1,children:""}),i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:ze,disabled:Z>=Pe,children:""})]})]})]}),i.jsxs("div",{className:"md:hidden space-y-2",children:[i.jsxs("div",{className:"bg-white border rounded p-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-700",children:["Total pedidos: ",i.jsx("b",{children:ue.length})]}),i.jsxs("div",{className:"text-xs text-gray-600",children:[Z,"/",Pe]})]}),xe.map(we=>i.jsxs("div",{className:"bg-white border rounded",role:"button",tabIndex:0,onClick:()=>Fr(we.orderKey),onKeyDown:ft=>{(ft.key==="Enter"||ft.key===" ")&&(ft.preventDefault(),Fr(we.orderKey))},children:[i.jsxs("div",{className:"p-2 flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-semibold",children:we.sellerName}),i.jsxs("div",{className:"text-xs text-gray-600",children:[we.orderName||"","  ",we.date]})]}),l&&i.jsx("button",{className:"px-3 py-2 rounded border text-sm text-red-600",onClick:ft=>{ft.stopPropagation(),confirm("Eliminar este pedido completo?")&&Ot(we.orderKey)},children:"Eliminar"})]}),i.jsx("div",{className:"px-2 pb-2",children:i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"P. Asociados"}),i.jsx("div",{className:"font-semibold",children:we.totalPackages})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"P. Restantes"}),i.jsx("div",{className:"font-semibold",children:we.totalRemainingPackages})]}),l&&i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"Total esperado"}),i.jsx("div",{className:"font-semibold",children:yi(we.totalExpectedActive??we.totalExpected)})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"U. Vendedor"}),i.jsx("div",{className:"font-semibold",children:yi(we.vendorProfitActive??we.vendorProfit)})]})]})})]},we.orderKey)),!xe.length&&i.jsx("div",{className:"p-3 text-sm text-gray-600 bg-white border rounded",children:"No hay pedidos."}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm",onClick:Ge,disabled:Z<=1,children:""}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm",onClick:ze,disabled:Z>=Pe,children:""})]})]})]}),S&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3 md:p-6",children:i.jsxs("div",{className:"bg-white w-full max-w-5xl max-h-[90vh] overflow-y-auto rounded shadow relative",children:[D&&i.jsx("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-50",children:i.jsx("div",{className:"text-sm font-semibold",children:"Guardando"})}),i.jsxs("div",{className:"p-3 md:p-5 border-b flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-lg font-semibold",children:B?"Editar pedido":"Nuevo pedido"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Nombre: ",ce||""]}),i.jsx("div",{className:"text-xs text-gray-600",children:"U. Bruta viene de Orden Maestra. U. Vendedor e Inversionista se calculan aqu. U. Neta = U. Bruta - Gastos - U. Vendedor."})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:ir,children:"Cerrar"}),!u&&i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",onClick:Vt,children:"Guardar"})]})]}),i.jsxs("div",{className:"p-3 md:p-5 space-y-3",children:[i.jsxs("button",{type:"button",className:"md:hidden w-full px-3 py-2 rounded border text-sm flex items-center justify-between",onClick:()=>Xe(we=>!we),children:[i.jsx("span",{children:"Filtros y KPIs"}),i.jsx("span",{children:Q?"":"+"})]}),i.jsxs("div",{className:`${Q?"block":"hidden"} md:block space-y-3`,children:[i.jsxs("div",{className:"grid md:grid-cols-3 gap-2",children:[i.jsxs("div",{className:"md:col-span-3",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Nombre"}),i.jsx("input",{className:"w-full border rounded p-2 text-sm",value:ce,onChange:we=>le(we.target.value),placeholder:"Nombre de la orden",disabled:u})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Vendedor"}),i.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:T,onChange:we=>P(we.target.value),disabled:rr,children:[i.jsx("option",{value:"",children:"-- Seleccionar --"}),p.map(we=>i.jsxs("option",{value:we.id,children:[we.name," ",we.branch?`(${we.branch})`:""]},we.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded p-2 text-sm",value:q,onChange:we=>de(we.target.value)})]}),i.jsxs("div",{className:"flex items-end gap-2",children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:Be,children:"Plantilla"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:sr,children:"Importar Excel"}),i.jsx("input",{ref:qt,type:"file",accept:".xlsx,.xls",className:"hidden",onChange:vr})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-2",children:[i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"P. asociados"}),i.jsx("div",{className:"text-lg font-semibold",children:ln.totalPackages})]}),l&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total esperado"}),i.jsx("div",{className:"text-lg font-semibold",children:yi(ln.totalExpected)})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"U. Bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:yi(ln.grossProfit)})]})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"U. Vendedor"}),i.jsx("div",{className:"text-lg font-semibold",children:yi(ln.uVendor)})]}),l&&i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"U. Neta"}),i.jsx("div",{className:"text-lg font-semibold",children:yi(cn)})]})]})]}),i.jsxs("div",{className:"border rounded p-3 space-y-2",children:[i.jsxs("button",{type:"button",className:"md:hidden w-full px-3 py-2 rounded border text-sm flex items-center justify-between",onClick:()=>Tt(we=>!we),children:[i.jsx("span",{children:"Agregar producto"}),i.jsx("span",{children:_t?"":"+"})]}),i.jsxs("div",{className:`${_t?"block":"hidden"} md:block space-y-2`,children:[i.jsx("div",{className:"text-sm font-semibold hidden md:block",children:"Agregar producto"}),i.jsxs("div",{className:"grid md:grid-cols-4 gap-2",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Buscar"}),i.jsx("input",{className:"w-full border rounded p-2 text-sm",value:G,onChange:we=>M(we.target.value),placeholder:"Buscar por categora o nombre"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Producto"}),i.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:he,onChange:we=>ae(we.target.value),children:[i.jsx("option",{value:"",children:"-- Seleccionar --"}),yt.map(we=>i.jsxs("option",{value:we.id,children:[we.category," - ",we.name," (exist:"," ",b[we.id]??0,")"]},we.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("input",{className:"w-full border rounded p-2 text-sm",value:Ce,onChange:we=>De(we.target.value),inputMode:"numeric"})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{className:"w-full px-3 py-2 rounded bg-gray-900 text-white text-sm hover:bg-black",onClick:Er,disabled:!Pt,children:"Agregar"})})]})]})]}),i.jsxs("div",{className:"border rounded",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm font-semibold",children:["Productos asociados (",O.length,")"]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"border rounded px-2 py-1 text-sm",placeholder:"Buscar producto",value:K,onChange:we=>{Y(we.target.value),Ze(1)}}),l&&i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:Mt,disabled:!O.length,children:"Exportar Excel"})]})]}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1400px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-2 border-b",children:"Categora"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Producto"}),i.jsxs("th",{className:"text-right p-2 border-b",children:["P. Asociados"," "]}),i.jsx("th",{className:"text-right p-2 border-b",children:"P. Restantes"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"Precio prov."}),i.jsx("th",{className:"text-right p-2 border-b",children:"Precio/paq"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Total esperado"}),l&&i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"text-right p-2 border-b",children:"U. Bruta"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Gastos"})]}),i.jsx("th",{className:"text-right p-2 border-b",children:"U. Vendedor"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"U. Neta"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Margen (%)"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Acciones"})]})}),i.jsxs("tbody",{children:[ne.map(we=>{const{totalExpected:ft,grossProfit:St,gastos:Ct,uVendor:fr,uNeta:or}=wr(we);return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"p-2 border-b",children:we.category}),i.jsx("td",{className:"p-2 border-b",children:we.productName}),i.jsx("td",{className:"p-2 border-b text-right",children:u?i.jsx("span",{children:we.packages}):dt[we.id]?i.jsx("input",{className:"w-20 border rounded p-1 text-right",value:String(we.packages),onChange:Hr=>Ln(we.id,Hr.target.value),onBlur:()=>tr(we.id),onKeyDown:Hr=>{(Hr.key==="Enter"||Hr.key==="Escape")&&tr(we.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:we.packages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Bt(we.id),"aria-label":"Editar paquetes",children:""})]})}),i.jsx("td",{className:"p-2 border-b text-right",children:l?ee[we.id]?i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("input",{className:"w-20 border rounded p-1 text-right",value:String(we.remainingPackages),onChange:Hr=>{const br=Math.max(0,$s(Hr.target.value));R(hr=>hr.map(Ir=>Ir.id===we.id?{...Ir,remainingPackages:br}:Ir))},onBlur:()=>zr(we.id),onKeyDown:Hr=>{(Hr.key==="Enter"||Hr.key==="Escape")&&zr(we.id)},inputMode:"numeric",autoFocus:!0}),rt[we.id]&&i.jsx("div",{className:"text-xs text-gray-500",children:"Guardando"})]}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:we.remainingPackages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Or(we.id),"aria-label":"Editar restantes",children:""})]}):i.jsx("span",{children:we.remainingPackages})}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:yi(we.providerPrice||0)}),i.jsx("td",{className:"p-2 border-b text-right",children:yi(we.pricePerPackage)}),i.jsx("td",{className:"p-2 border-b text-right",children:i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:yi(ft)}),l&&i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:async()=>dn(we.id),"aria-label":"Recalcular total esperado",children:""}),ie[we.id]&&i.jsx("div",{className:"text-xs text-gray-500",children:"Calc"})]})}),l&&i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"p-2 border-b text-right",children:yi(St)}),i.jsx("td",{className:"p-2 border-b text-right",children:yi(Ct)})]}),i.jsx("td",{className:"p-2 border-b text-right",children:yi(fr)}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:yi(or)}),i.jsx("td",{className:"p-2 border-b text-right",children:u?i.jsxs("span",{children:[Number(we.vendorMarginPercent??z(T)).toFixed(3),"%"]}):je[we.id]?i.jsx("input",{type:"number",step:"0.001",min:0,className:"w-20 border rounded p-1 text-right",value:String(we.vendorMarginPercent??z(T)),onChange:Hr=>Nt(we.id,Hr.target.value),onBlur:()=>Dr(we.id),onKeyDown:Hr=>{(Hr.key==="Enter"||Hr.key==="Escape")&&Dr(we.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsxs("span",{children:[Number(we.vendorMarginPercent??z(T)).toFixed(3),"%"]}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>ur(we.id),"aria-label":"Editar margen",children:""})]})}),i.jsx("td",{className:"p-2 border-b",children:!u&&i.jsx("button",{className:"px-3 py-1.5 rounded bg-red-600 text-white text-xs hover:bg-red-700",onClick:()=>{confirm("Eliminar este producto?")&&Lr(we.id)},children:""})})]},we.id)}),!ne.length&&i.jsx("tr",{children:i.jsx("td",{className:"p-3 text-sm text-gray-600",colSpan:l?13:9,children:"No hay productos asociados."})})]})]})}),i.jsxs("div",{className:"md:hidden p-3 space-y-2",children:[Ue.map(([we,ft])=>{const St=!!ot[we];return i.jsxs("div",{className:"border rounded",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-2 flex items-center justify-between text-sm",onClick:()=>tt(we),children:[i.jsx("span",{className:"font-semibold",children:we}),i.jsxs("span",{className:"text-xs text-gray-600",children:[ft.length," ",ft.length===1?"producto":"productos"]})]}),St&&i.jsx("div",{className:"px-3 pb-3 space-y-2",children:ft.map(Ct=>{const{totalExpected:fr,grossProfit:or,gastos:Hr,uVendor:br,uNeta:hr}=wr(Ct);return i.jsxs("div",{className:"border rounded p-2 text-xs space-y-2",children:[i.jsx("div",{className:"font-semibold text-sm",children:Ct.productName}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes"}),u?i.jsx("div",{className:"font-semibold",children:Ct.packages}):dt[Ct.id]?i.jsx("input",{className:"w-full border rounded p-1 text-right",value:String(Ct.packages),onChange:Ir=>Ln(Ct.id,Ir.target.value),onBlur:()=>tr(Ct.id),onKeyDown:Ir=>{(Ir.key==="Enter"||Ir.key==="Escape")&&tr(Ct.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Ct.packages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Bt(Ct.id),"aria-label":"Editar paquetes",children:""})]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Restantes"}),i.jsx("div",{className:"font-semibold",children:l?ee[Ct.id]?i.jsx("div",{className:"flex items-center justify-end gap-2",children:i.jsx("input",{className:"w-full border rounded p-1 text-right",value:String(Ct.remainingPackages),onChange:Ir=>{const en=Math.max(0,$s(Ir.target.value));R(sn=>sn.map(da=>da.id===Ct.id?{...da,remainingPackages:en}:da))},onBlur:()=>zr(Ct.id),onKeyDown:Ir=>{(Ir.key==="Enter"||Ir.key==="Escape")&&zr(Ct.id)},inputMode:"numeric",autoFocus:!0})}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Ct.remainingPackages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Or(Ct.id),"aria-label":"Editar restantes",children:""})]}):i.jsx("div",{className:"font-semibold",children:Ct.remainingPackages})})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Precio/paq"}),i.jsx("div",{className:"font-semibold",children:yi(Ct.pricePerPackage)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Total esperado"}),i.jsxs("div",{className:"font-semibold flex items-center justify-end gap-2",children:[i.jsx("div",{children:yi(fr)}),l&&i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:async Ir=>{Ir.stopPropagation(),await dn(Ct.id)},"aria-label":"Recalcular total esperado",children:""}),ie[Ct.id]&&i.jsx("div",{className:"text-xs text-gray-500",children:"Calc"})]})]}),l&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta"}),i.jsx("div",{className:"font-semibold",children:yi(or)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Gastos"}),i.jsx("div",{className:"font-semibold",children:yi(Hr)})]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"U. Vendedor"}),i.jsx("div",{className:"font-semibold",children:yi(br)})]}),l&&i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"U. Neta"}),i.jsx("div",{className:"font-semibold",children:yi(hr)})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"text-gray-600",children:"Margen (%)"}),u?i.jsxs("div",{className:"font-semibold",children:[Number(Ct.vendorMarginPercent??z(T)).toFixed(3),"%"]}):je[Ct.id]?i.jsx("input",{type:"number",step:"0.001",min:0,className:"w-full border rounded p-1 text-right",value:String(Ct.vendorMarginPercent??z(T)),onChange:Ir=>Nt(Ct.id,Ir.target.value),onBlur:()=>Dr(Ct.id),onKeyDown:Ir=>{(Ir.key==="Enter"||Ir.key==="Escape")&&Dr(Ct.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsxs("span",{className:"font-semibold",children:[Number(Ct.vendorMarginPercent??z(T)).toFixed(3),"%"]}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>ur(Ct.id),"aria-label":"Editar margen",children:""})]})]}),!u&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white text-xs",onClick:()=>{confirm("Eliminar este producto?")&&Lr(Ct.id)},children:""})]})]},Ct.id)})})]},we)}),!ne.length&&i.jsx("div",{className:"p-3 text-sm text-gray-600 text-center",children:"No hay productos asociados."})]}),i.jsxs("div",{className:"p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Pgina items ",Ee," / ",pt]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:nt,disabled:Ee<=1,children:""}),i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:wt,disabled:Ee>=pt,children:""})]})]})]}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-center md:justify-between",children:[i.jsx("div",{className:"text-xs text-gray-600",children:B?i.jsxs(i.Fragment,{children:["Editando: ",i.jsx("b",{children:B})]}):i.jsx(i.Fragment,{children:"Nuevo pedido (an no guardado)"})}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:ir,children:"Cancelar"}),!u&&i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",onClick:Vt,children:"Guardar pedido"})]})]}),h&&i.jsx("div",{className:"text-sm text-gray-700",children:h})]})]})}),i.jsx(bVe,{open:Te,onClose:()=>Ye(!1),orders:ue,rows:I,setRows:j,isAdmin:l,currentUserEmail:r||"",currentUserName:"",sellerCandyId:e,sellers:p,products:v,transferAgg:Lt,setTransferAgg:Rt,setTransferRowDeltas:Re})]})}const ra=t=>Math.max(0,Math.floor(Number(t)||0)),qb=t=>Math.round(t||0),jE=99.999;function tie(t){const e=Math.max(1,ra(t.unitsPerPackage||1)),r=ra(t.totalUnits||0),n=ra(t.quantity||0),a=ra(t.packages||0);return r>0?r:n>0?n:a>0?a*e:0}function NVe(t){const e=Number(t.remaining);return Number.isFinite(e)&&e>0?Math.floor(e):tie(t)}function MG(t){const e=Number(t.remainingPackages);if(Number.isFinite(e))return Math.max(0,Math.floor(e));const r=Math.max(1,ra(t.unitsPerPackage||1)),n=NVe(t);return Math.max(0,Math.floor(n/r))}function CVe(t){const e=Math.max(1,ra(t.unitsPerPackage||1)),r=tie(t);return Math.max(0,Math.floor(r/e))}function zb(t){return String(t??"").trim().toLowerCase().replace(/\s+/g," ")}function $f(t){const e=String(t??"").trim();if(!e)return 0;const r=e.replace(/,/g,"."),n=Number(r);return Number.isFinite(n)?n:0}function Rh(t,e){const r={};Object.keys(t||{}).forEach(n=>r[zb(n)]=t[n]);for(const n of e){const a=r[zb(n)];if(a!=null&&String(a).trim()!=="")return a}}function op(t,e,r){const n=t*e,a=jE,s=Math.min(Math.max(r.marginR,0),a)/100,o=Math.min(Math.max(r.marginSJ,0),a)/100,l=Math.min(Math.max(r.marginIsla,0),a)/100,c=e>0&&s<1?n/(1-s):n,d=e>0&&o<1?n/(1-o):n,u=e>0&&l<1?n/(1-l):n,f=c-n,A=d-n,h=u-n,m=e>0?qb(c/e):0,p=e>0?qb(d/e):0,x=e>0?qb(u/e):0;return{subtotal:n,totalRivas:c,totalSanJorge:d,totalIsla:u,gainRivas:f,gainSanJorge:A,gainIsla:h,unitPriceRivas:m,unitPriceSanJorge:p,unitPriceIsla:x}}function _Ve(t){return Number(t.gainRivas||0)}function EVe(t){return Number(t.gainIsla||0)}function pT(t,e,r){const n=_Ve(t),a=EVe(t),s=Number(t.subtotal||0),o=e>0&&r>0?e*s/r:0;return{...t,grossProfit:n,grossProfitIsla:a,logisticAllocated:o}}function SVe(){const{refreshKey:t,refresh:e}=bc(),[r,n]=g.useState(""),[a,s]=g.useState(!0),[o,l]=g.useState(!1),[c,d]=g.useState(!1),[u,f]=g.useState(!1),[A,h]=g.useState([]),[m,p]=g.useState(!1),[x,v]=g.useState([]),[y,b]=g.useState({}),[w,I]=g.useState(!1),[j,N]=g.useState(null),[S,E]=g.useState(""),[B,k]=g.useState(""),[T,P]=g.useState("20"),[q,de]=g.useState("15"),[ce,le]=g.useState("30"),[he,ae]=g.useState("0"),[Ce,De]=g.useState([]),[O,R]=g.useState({}),[G,M]=g.useState({}),[K,Y]=g.useState({}),[D,V]=g.useState({}),[te,ve]=g.useState({}),[Q,Xe]=g.useState({}),[se,Z]=g.useState({}),ke=Qe=>R(jt=>({...jt,[Qe]:!0})),Se=Qe=>R(jt=>({...jt,[Qe]:!1})),Ee=Qe=>M(jt=>({...jt,[Qe]:!0})),Ze=Qe=>M(jt=>({...jt,[Qe]:!1})),ot=Qe=>Y(jt=>({...jt,[Qe]:!0})),vt=Qe=>Y(jt=>({...jt,[Qe]:!1})),_t=Qe=>V(jt=>({...jt,[Qe]:!0})),Tt=Qe=>V(jt=>({...jt,[Qe]:!1})),Lt=Qe=>ve(jt=>({...jt,[Qe]:!0})),Rt=Qe=>ve(jt=>({...jt,[Qe]:!1})),Et=Qe=>Xe(jt=>({...jt,[Qe]:!0})),Re=Qe=>Xe(jt=>({...jt,[Qe]:!1})),Te=Qe=>Z(jt=>({...jt,[Qe]:!0})),Ye=Qe=>Z(jt=>({...jt,[Qe]:!1})),[dt,Fe]=g.useState(""),[je,We]=g.useState(""),[ee,Ve]=g.useState(""),[rt,$e]=g.useState("1"),[ie,pe]=g.useState("0"),[fe,Me]=g.useState("DATOS"),[me,ye]=g.useState(""),[mt,gt]=g.useState(1),yt=15,Pt=g.useMemo(()=>Math.max(1,Math.ceil(x.length/yt)),[x.length]);g.useEffect(()=>gt(1),[x.length]);const Ft=g.useMemo(()=>{const Qe=(mt-1)*yt;return x.slice(Qe,Qe+yt)},[x,mt]),Oe=g.useMemo(()=>{const Qe=new Set;for(const jt of A){const wr=String(jt.category||"").trim();wr&&Qe.add(wr)}return Array.from(Qe).sort((jt,wr)=>jt.localeCompare(wr,"es"))},[A]);g.useEffect(()=>{!dt&&Oe.length>0&&Fe(Oe[0])},[Oe]);const be=async()=>{p(!0);try{const Qe=await Ut(ar(xt(Ne,"products_candies"),kn("createdAt","desc"))),jt=[];Qe.forEach(wr=>{const ln=wr.data();jt.push({id:wr.id,name:String(ln.name??"").trim(),category:String(ln.category??"").trim()||"Caramelo",providerPrice:Number(ln.providerPrice??0),unitsPerPackage:Number(ln.unitsPerPackage??1)})}),h(jt)}catch(Qe){console.error(Qe),n(" Error cargando catlogo de dulces.")}finally{p(!1)}};g.useEffect(()=>{be()},[t]);const Ae=g.useMemo(()=>(dt.trim().length>0?A.filter(jt=>jt.category===dt):A).sort((jt,wr)=>jt.name.localeCompare(wr.name,"es")),[A,dt]);g.useEffect(()=>{if(!je){Ve(""),$e("1");return}const Qe=A.find(jt=>jt.id===je);Qe&&(Ve(String(Qe.providerPrice??0)),$e(String(Qe.unitsPerPackage??1)))},[je,A]);const Le=()=>{N(null),E(""),k(""),De([]),R({}),M({}),Y({}),V({}),ve({}),Xe({}),Z({}),Fe(Oe[0]||""),We(""),Ve(""),pe("0"),$e("1"),P("20"),de("15"),le("30"),ae("0"),Me("DATOS"),ye("")},ut=()=>{if(n(""),!je){n("Selecciona un producto del catlogo.");return}const Qe=A.find(Er=>Er.id===je);if(!Qe){n("Producto de catlogo no encontrado (refresca).");return}const jt=Number(Qe.providerPrice||0),wr=ra(ie||0),ln=ra(Qe.unitsPerPackage||0);if(jt<0){n("El precio proveedor no puede ser negativo.");return}if(wr<=0){n("Los paquetes deben ser mayor que 0.");return}if(ln<=0){n("Las unidades por paquete deben ser mayor que 0.");return}const cn=Number(T||0),_r=Number(q||0),Jt=Number(ce||0),ir=op(jt,wr,{marginR:cn,marginSJ:_r,marginIsla:Jt});if(Ce.find(Er=>Er.id===Qe.id))De(Er=>Er.map(Lr=>{if(Lr.id!==Qe.id)return Lr;const Ln=ra(Lr.packages||0)+wr,Nt=op(jt,Ln,{marginR:Number(Lr.marginRivas??cn),marginSJ:Number(Lr.marginSanJorge??_r),marginIsla:Number(Lr.marginIsla??Jt)}),$t=ra(Lr.remainingPackages??Lr.packages)+wr;return{...Lr,providerPrice:jt,unitsPerPackage:ln,packages:Ln,remainingPackages:$t,...Nt}}));else{const Er={id:Qe.id,name:Qe.name,category:Qe.category,providerPrice:jt,packages:wr,unitsPerPackage:ln,marginRivas:cn,marginSanJorge:_r,marginIsla:Jt,subtotal:ir.subtotal,totalRivas:ir.totalRivas,totalSanJorge:ir.totalSanJorge,totalIsla:ir.totalIsla,gainRivas:ir.gainRivas,gainSanJorge:ir.gainSanJorge,gainIsla:ir.gainIsla,unitPriceRivas:ir.unitPriceRivas,unitPriceSanJorge:ir.unitPriceSanJorge,unitPriceIsla:ir.unitPriceIsla,remainingPackages:wr};De(Lr=>[...Lr,Er])}We(""),pe("0"),Me("ITEMS")},ct=Qe=>{De(jt=>jt.filter(wr=>wr.id!==Qe))},st=(Qe,jt,wr)=>{De(ln=>ln.map(cn=>{if(cn.id!==Qe)return cn;let _r={...cn};if(jt==="packages"&&(_r.packages=ra(wr||0)),jt==="unitsPerPackage"&&(_r.unitsPerPackage=ra(wr||0)),jt==="remainingPackages"){const Jt=Math.max(0,ra(_r.packages||0)),ir=ra(wr||0);_r.remainingPackages=Math.min(Jt,Math.max(0,ir))}if(jt==="unitPriceRivas"||jt==="unitPriceIsla"){const Jt=Math.max(0,Number(wr)||0),ir=Math.max(0,ra(_r.packages||0)),Fr=Number(_r.providerPrice||0)*ir,Er=ir>0?Jt*ir:0;if(jt==="unitPriceRivas"){_r.unitPriceRivas=Jt,_r.totalRivas=Er,_r.gainRivas=Er-Fr;const Lr=Er>0?(1-Fr/Er)*100:0;_r.marginRivas=Math.min(Math.max(Lr,0),jE)}else{_r.unitPriceIsla=Jt,_r.totalIsla=Er,_r.gainIsla=Er-Fr;const Lr=Er>0?(1-Fr/Er)*100:0;_r.marginIsla=Math.min(Math.max(Lr,0),jE)}}if(jt==="marginRivas"&&(_r.marginRivas=Number(wr||0)),jt==="marginIsla"&&(_r.marginIsla=Number(wr||0)),jt==="marginSanJorge"&&(_r.marginSanJorge=Number(wr||0)),jt==="packages"||jt==="marginRivas"||jt==="marginIsla"||jt==="marginSanJorge"){const Jt=op(_r.providerPrice,_r.packages,{marginR:Number(_r.marginRivas||0),marginSJ:Number(_r.marginSanJorge||0),marginIsla:Number(_r.marginIsla||0)});_r={..._r,...Jt}}if(_r.remainingPackages===void 0||_r.remainingPackages===null)_r.remainingPackages=_r.packages;else if(jt==="packages"){const Jt=ra(_r.remainingPackages);_r.remainingPackages=Math.min(Jt,Math.max(0,_r.packages))}return _r}))},z=g.useMemo(()=>{const Qe=Ce.reduce((_r,Jt)=>_r+ra(Jt.packages),0),jt=Ce.reduce((_r,Jt)=>_r+Number(Jt.subtotal||0),0),wr=Ce.reduce((_r,Jt)=>_r+Number(Jt.totalRivas||0),0),ln=Ce.reduce((_r,Jt)=>_r+Number(Jt.totalSanJorge||0),0),cn=Ce.reduce((_r,Jt)=>_r+Number(Jt.totalIsla||0),0);return{totalPackages:Qe,subtotal:jt,totalRivas:wr,totalSanJorge:ln,totalIsla:cn}},[Ce]),X=g.useMemo(()=>{const Qe=Math.max(0,$f(he||0)),jt=Number(z.subtotal||0),wr=Ce.map(Jt=>pT(Jt,Qe,jt)),ln=wr.reduce((Jt,ir)=>Jt+Number(ir.grossProfit||0),0),cn=wr.reduce((Jt,ir)=>Jt+Number(ir.grossProfitIsla||0),0),_r=wr.reduce((Jt,ir)=>Jt+Number(ir.logisticAllocated||0),0);return{items:wr,logisticsTotal:Qe,grossTotal:ln,grossIslaTotal:cn,logisticAllocatedTotal:_r}},[Ce,he,z.subtotal]),re=g.useMemo(()=>{const Qe=String(me||"").trim().toLowerCase();return Qe?X.items.filter(jt=>{const wr=String(jt.name||"").toLowerCase(),ln=String(jt.category||"").toLowerCase();return wr.includes(Qe)||ln.includes(Qe)}):X.items},[X.items,me]),[H,L]=g.useState(1),ue=15,Pe=g.useMemo(()=>Math.max(1,Math.ceil(re.length/ue)),[re.length]);g.useEffect(()=>L(1),[re.length]);const xe=g.useMemo(()=>{const Qe=(H-1)*ue;return re.slice(Qe,Qe+ue)},[re,H]),[Ge,ze]=g.useState({});g.useEffect(()=>ze({}),[re.length]);const[Ke,pt]=g.useState({});g.useEffect(()=>{const Qe={};for(const jt of x)jt&&jt.id&&(Qe[jt.id]=!1);pt(Qe)},[x]);const ne=g.useMemo(()=>({totalPackages:z.totalPackages,subtotalCosto:z.subtotal,esperadoRivas:z.totalRivas,esperadoIsla:z.totalIsla,gastosLogisticos:X.logisticsTotal,utilidadBrutaRivas:X.grossTotal,utilidadBrutaIsla:X.grossIslaTotal}),[z,X]),Ue=()=>{if(n(""),!A.length){n(" No hay catlogo cargado para generar plantilla.");return}const Qe=Number(T||0),jt=Number(ce||0),wr=A.slice().sort((Fr,Er)=>Fr.name.localeCompare(Er.name,"es")).map(Fr=>({Producto:Fr.name,Paquetes:"","Margen rivas":Qe,"Margen Isla":jt,"P. unidad Rivas":"","P. unidad Isla":""})),ln=[{Campo:"Gastos logisticos",Valor:$f(he||0)}],cn=pa.book_new(),_r=pa.json_to_sheet(wr),Jt=pa.json_to_sheet(ln);pa.book_append_sheet(cn,_r,"Productos"),pa.book_append_sheet(cn,Jt,"Config");const ir=B&&String(B).trim()||new Date().toISOString().slice(0,10);zv(cn,`plantilla_orden_maestra_${ir}.xlsx`)},tt=()=>{if(n(""),!X.items.length){n(" No hay items para exportar.");return}const Qe=X.items.slice().sort((_r,Jt)=>_r.name.localeCompare(Jt.name,"es")).map(_r=>({Categora:_r.category,Producto:_r.name,Paquetes:ra(_r.packages),"Paquetes restantes":ra(_r.remainingPackages??_r.packages),"Und x Paquete":ra(_r.unitsPerPackage),"Precio proveedor":Number(_r.providerPrice||0),Facturado:Number(_r.subtotal||0),"Esperado Rivas":Number(_r.totalRivas||0),"Esperado Isla":Number(_r.totalIsla||0),"MV Rivas":Number(_r.marginRivas||0),"MV Isla":Number(_r.marginIsla||0),"Utilidad Bruta":Number(_r.grossProfit||0),"Utilidad Bruta Isla":Number(_r.grossProfitIsla||0),"Prorrateo logistico":Number(_r.logisticAllocated||0),"Precio Rivas":Number(_r.unitPriceRivas||0),"Precio Isla":Number(_r.unitPriceIsla||0)})),jt=[{KPI:"Paquetes totales",Valor:ne.totalPackages},{KPI:"Subtotal costo",Valor:ne.subtotalCosto},{KPI:"Esperado Rivas",Valor:ne.esperadoRivas},{KPI:"Esperado Isla",Valor:ne.esperadoIsla},{KPI:"Gastos logsticos",Valor:ne.gastosLogisticos},{KPI:"Utilidad Bruta Rivas",Valor:ne.utilidadBrutaRivas},{KPI:"Utilidad Bruta Isla",Valor:ne.utilidadBrutaIsla}],wr=pa.book_new();pa.book_append_sheet(wr,pa.json_to_sheet(Qe),"Productos"),pa.book_append_sheet(wr,pa.json_to_sheet(jt),"Resumen");const ln=B&&String(B).trim()||new Date().toISOString().slice(0,10),cn=S&&String(S).trim()||`Orden_${ln}`;zv(wr,`orden_maestra_${cn.replace(/[^\w\-]+/g,"_")}_${ln}.xlsx`)},nt=g.useRef(null),[wt,Bt]=g.useState(!1),tr=()=>{var Qe;if(!A.length){n(" Catlogo no cargado todava. Esper y prob de nuevo.");return}(Qe=nt.current)==null||Qe.click()},Or=async Qe=>{var wr;const jt=(wr=Qe.target.files)==null?void 0:wr[0];if(jt){Qe.target.value="",Bt(!0),n("");try{const ln=await jt.arrayBuffer(),cn=qv(ln,{type:"array"}),_r=cn.SheetNames||[],Jt=cn.Sheets.Productos||cn.Sheets.Plantilla||cn.Sheets[_r[0]];if(!Jt){n(" No se encontr hoja de Productos/Plantilla.");return}const ir=pa.sheet_to_json(Jt,{defval:""});if(!ir.length){n(" El Excel viene vaco.");return}let Fr=0;const Er=cn.Sheets.Config;if(Er){const $t=pa.sheet_to_json(Er,{defval:""}),Mt=new Map;for(const Be of $t){const It=zb(Rh(Be,["Campo","Key","Nombre"])??""),Vt=Rh(Be,["Valor","Value"]);It&&Mt.set(It,Vt)}Mt.has("gastos logisticos")&&(Fr=Math.max(0,$f(Mt.get("gastos logisticos"))))}else for(const $t of ir){const Mt=Rh($t,["Gastos","Gasto","Gastos logisticos","Logistica"]),Be=$f(Mt);if(Be>0){Fr=Be;break}}ae(String(Fr||0));const Lr=new Map;for(const $t of A)Lr.set(zb($t.name),$t);const Ln=[],Nt=new Map;for(let $t=0;$t<ir.length;$t++){const Mt=ir[$t],Be=Rh(Mt,["Producto","Product","Nombre","Name"]),It=Rh(Mt,["Paquetes","Packages"]),Vt=Rh(Mt,["Margen rivas","Margen Rivas","MV Rivas"]),Ot=Rh(Mt,["Margen Isla","Margen isla","MV Isla"]),qt=Rh(Mt,["P. unidad Rivas","P unidad Rivas","Precio Rivas"]),sr=Rh(Mt,["P. unidad Isla","P unidad Isla","Precio Isla"]),vr=zb(Be);if(!vr)continue;const rr=Lr.get(vr);if(!rr){Ln.push(`Fila ${$t+2}: Producto no existe en catlogo: "${String(Be).trim()}".`);continue}const dr=Math.floor($f(It));if(dr<=0){Ln.push(`Fila ${$t+2}: "Paquetes" invlido para "${rr.name}".`);continue}const we=String(Vt??"").trim()!==""?$f(Vt):Number(T||0),ft=String(Ot??"").trim()!==""?$f(Ot):Number(ce||0),St=Math.floor($f(qt)),Ct=Math.floor($f(sr)),fr=Nt.get(rr.id);fr?Nt.set(rr.id,{packages:fr.packages+dr,mR:we,mI:ft,puR:St>0?St:fr.puR,puI:Ct>0?Ct:fr.puI}):Nt.set(rr.id,{packages:dr,mR:we,mI:ft,puR:St>0?St:void 0,puI:Ct>0?Ct:void 0})}const nr=[];Nt.forEach(($t,Mt)=>{const Be=A.find(Ct=>Ct.id===Mt);if(!Be)return;const It=Number(Be.providerPrice||0),Vt=Math.max(1,ra(Be.unitsPerPackage||1)),Ot=Math.max(1,ra($t.packages)),qt=It*Ot,sr=Number($t.puR||0),vr=Number($t.puI||0),rr=sr>0||vr>0;let dr=$t.mR,we=$t.mI;const ft=Number(q||0);let St;if(rr){const Ct=op(It,Ot,{marginR:dr,marginSJ:ft,marginIsla:we}),fr=sr>0?sr*Ot:Ct.totalRivas,or=vr>0?vr*Ot:Ct.totalIsla,Hr=br=>{if(!Number.isFinite(br)||br<=0)return 0;const hr=(1-qt/br)*100;return Math.min(Math.max(hr,0),jE)};sr>0&&(dr=Hr(fr)),vr>0&&(we=Hr(or)),St={subtotal:qt,totalRivas:fr,totalSanJorge:Ct.totalSanJorge,totalIsla:or,gainRivas:fr-qt,gainSanJorge:Ct.gainSanJorge,gainIsla:or-qt,unitPriceRivas:Ot>0?qb(fr/Ot):0,unitPriceSanJorge:Ct.unitPriceSanJorge,unitPriceIsla:Ot>0?qb(or/Ot):0}}else St=op(It,Ot,{marginR:dr,marginSJ:ft,marginIsla:we});nr.push({id:Be.id,name:Be.name,category:Be.category,providerPrice:It,packages:Ot,unitsPerPackage:Vt,marginRivas:dr,marginSanJorge:ft,marginIsla:we,subtotal:St.subtotal,totalRivas:St.totalRivas,totalSanJorge:St.totalSanJorge,totalIsla:St.totalIsla,gainRivas:St.gainRivas,gainSanJorge:St.gainSanJorge,gainIsla:St.gainIsla,unitPriceRivas:St.unitPriceRivas,unitPriceSanJorge:St.unitPriceSanJorge,unitPriceIsla:St.unitPriceIsla,remainingPackages:Ot})}),De($t=>{const Mt=new Map;$t.forEach(Be=>Mt.set(Be.id,Be));for(const Be of nr){const It=Mt.get(Be.id);if(!It)Mt.set(Be.id,Be);else{const Vt=ra(It.packages)+ra(Be.packages),Ot=op(It.providerPrice,Vt,{marginR:Be.marginRivas,marginSJ:Number(It.marginSanJorge||0),marginIsla:Be.marginIsla});Mt.set(Be.id,{...It,packages:Vt,marginRivas:Be.marginRivas,marginIsla:Be.marginIsla,remainingPackages:ra(It.remainingPackages??It.packages)+ra(Be.packages),...Ot})}}return Array.from(Mt.values()).sort((Be,It)=>Be.name.localeCompare(It.name,"es"))}),Me("ITEMS"),Ln.length?(n(` Importado con detalles. Errores: ${Ln.length}.`),console.warn("Errores import:",Ln)):n(` Importacin lista: ${nr.length} productos agregados.`)}catch(ln){console.error(ln),n(" Error importando Excel. Revis hojas: Productos + Config (o Plantilla).")}finally{Bt(!1)}}};g.useEffect(()=>{(async()=>{s(!0);try{const Qe=ar(xt(Ne,"candy_main_orders"),kn("createdAt","desc")),jt=await Ut(Qe),wr=[];jt.forEach(_r=>{const Jt=_r.data();wr.push({id:_r.id,name:Jt.name??"",date:Jt.date??"",totalPackages:Number(Jt.totalPackages??0),subtotal:Number(Jt.subtotal??0),totalRivas:Number(Jt.totalRivas??0),totalSanJorge:Number(Jt.totalSanJorge??0),totalIsla:Number(Jt.totalIsla??0),marginRivas:Number(Jt.marginRivas??20),marginSanJorge:Number(Jt.marginSanJorge??15),marginIsla:Number(Jt.marginIsla??30),logisticsCost:Number(Jt.logisticsCost??0),createdAt:Jt.createdAt??Nr.now()})}),v(wr);const ln=await Ut(xt(Ne,"inventory_candies")),cn={};ln.forEach(_r=>{const Jt=_r.data(),ir=Jt.orderId;if(!ir)return;const Fr=CVe(Jt),Er=MG(Jt);cn[ir]||(cn[ir]={orderId:ir,totalPackages:0,remainingPackages:0}),cn[ir].totalPackages+=Fr,cn[ir].remainingPackages+=Er}),b(cn)}catch(Qe){console.error(Qe),n(" Error cargando pedidos generales.")}finally{s(!1)}})()},[t]);const zr=Qe=>{var jt;return Qe.date?Qe.date:(jt=Qe.createdAt)!=null&&jt.toDate?Qe.createdAt.toDate().toISOString().slice(0,10):""},ur=async Qe=>{if(Qe.preventDefault(),n(""),l(!0),!Ce.length){n("Agrega al menos un producto a la orden.");return}try{const jt=new Date().toISOString().slice(0,10),wr=B||jt,ln=Number(T||0),cn=Number(q||0),_r=Number(ce||0),Jt=Math.max(0,$f(he||0));for(const $t of Ce){if(!String($t.name||"").trim()){n("Hay un producto sin nombre en el pedido.");return}if(Number($t.providerPrice||0)<0){n(`El precio proveedor no puede ser negativo (producto: ${$t.name}).`);return}if(ra($t.packages)<=0){n(`Los paquetes deben ser mayor que 0 (producto: ${$t.name}).`);return}if(ra($t.unitsPerPackage)<=0){n(`Las unidades por paquete deben ser mayor que 0 (producto: ${$t.name}).`);return}}const ir=Number(z.subtotal||0),Fr=Ce.map($t=>pT($t,Jt,ir)),Er={totalPackages:z.totalPackages,subtotal:z.subtotal,totalRivas:z.totalRivas,totalSanJorge:z.totalSanJorge,totalIsla:z.totalIsla},Lr={name:S||`Pedido ${wr}`,date:wr,totalPackages:Er.totalPackages,subtotal:Er.subtotal,totalRivas:Er.totalRivas,totalSanJorge:Er.totalSanJorge,totalIsla:Er.totalIsla,marginRivas:ln,marginSanJorge:cn,marginIsla:_r,logisticsCost:Jt,uBrutaGlobal:X.grossTotal,items:Fr};if(j){await Mn(Kt(Ne,"candy_main_orders",j),{...Lr});for(const Be of Fr){const It=await Ut(ar(xt(Ne,"inventory_candies"),lr("orderId","==",j),lr("productId","==",Be.id))),Vt=Math.max(1,ra(Be.unitsPerPackage||1)),Ot=ra(Be.packages)*Vt,qt=Math.min(ra(Be.remainingPackages??Be.packages),ra(Be.packages)),sr=Math.max(0,qt*Vt);if(It.empty)await ta(xt(Ne,"inventory_candies"),{productId:Be.id,productName:Be.name,category:Be.category,measurement:"unidad",quantity:Ot,remaining:sr,packages:ra(Be.packages),remainingPackages:qt,unitsPerPackage:Vt,totalUnits:Ot,providerPrice:Be.providerPrice,subtotal:Be.subtotal,totalRivas:Be.totalRivas,totalSanJorge:Be.totalSanJorge,totalIsla:Be.totalIsla,gainRivas:Be.gainRivas,gainSanJorge:Be.gainSanJorge,gainIsla:Be.gainIsla,unitPriceRivas:Be.unitPriceRivas,unitPriceSanJorge:Be.unitPriceSanJorge,unitPriceIsla:Be.unitPriceIsla,date:wr,createdAt:Nr.now(),status:"PENDIENTE",orderId:j});else for(const vr of It.docs)await Mn(Kt(Ne,"inventory_candies",vr.id),{productName:Be.name,category:Be.category,unitsPerPackage:Vt,totalUnits:Ot,quantity:Ot,remaining:sr,packages:ra(Be.packages),remainingPackages:qt,providerPrice:Be.providerPrice,subtotal:Be.subtotal,totalRivas:Be.totalRivas,totalSanJorge:Be.totalSanJorge,totalIsla:Be.totalIsla,gainRivas:Be.gainRivas,gainSanJorge:Be.gainSanJorge,gainIsla:Be.gainIsla,unitPriceRivas:Be.unitPriceRivas,unitPriceSanJorge:Be.unitPriceSanJorge,unitPriceIsla:Be.unitPriceIsla,date:wr})}const $t=await Ut(ar(xt(Ne,"inventory_candies"),lr("orderId","==",j))),Mt=new Set(Fr.map(Be=>Be.id));for(const Be of $t.docs){const It=Be.data(),Vt=String(It.productId||"");Vt&&!Mt.has(Vt)&&await na(Kt(Ne,"inventory_candies",Be.id))}v(Be=>Be.map(It=>It.id===j?{...It,name:Lr.name,date:Lr.date,totalPackages:Lr.totalPackages,subtotal:Lr.subtotal,totalRivas:Lr.totalRivas,totalSanJorge:Lr.totalSanJorge,totalIsla:Lr.totalIsla,marginRivas:Lr.marginRivas,marginSanJorge:Lr.marginSanJorge,marginIsla:Lr.marginIsla,logisticsCost:Lr.logisticsCost}:It)),n(" Orden maestra actualizada (pedido + inventario)."),Le(),I(!1),e();return}const Nt=(await ta(xt(Ne,"candy_main_orders"),{...Lr,createdAt:Nr.now()})).id,nr=Lc(Ne);for(const $t of Fr){const Mt=Math.max(1,ra($t.unitsPerPackage||1)),Be=ra($t.packages)*Mt,It=Math.min(ra($t.remainingPackages??$t.packages),ra($t.packages)),Vt=Math.max(0,It*Mt),Ot=Kt(xt(Ne,"inventory_candies"));nr.set(Ot,{productId:$t.id,productName:$t.name,category:$t.category,measurement:"unidad",quantity:Be,remaining:Vt,packages:ra($t.packages),remainingPackages:It,unitsPerPackage:Mt,totalUnits:Be,providerPrice:$t.providerPrice,subtotal:$t.subtotal,totalRivas:$t.totalRivas,totalSanJorge:$t.totalSanJorge,totalIsla:$t.totalIsla,gainRivas:$t.gainRivas,gainSanJorge:$t.gainSanJorge,gainIsla:$t.gainIsla,unitPriceRivas:$t.unitPriceRivas,unitPriceSanJorge:$t.unitPriceSanJorge,unitPriceIsla:$t.unitPriceIsla,date:wr,createdAt:Nr.now(),status:"PENDIENTE",orderId:Nt})}await nr.commit(),n(" Orden maestra creada y registrada en inventario."),Le(),I(!1),e()}catch(jt){console.error(jt),n(" Error al guardar orden maestra.")}finally{l(!1)}},Dr=async Qe=>{try{s(!0),n(""),N(Qe.id),E(Qe.name),k(Qe.date),P(String(Qe.marginRivas??20)),de(String(Qe.marginSanJorge??15)),le(String(Qe.marginIsla??30));const jt=Number(Qe.logisticsCost??0);ae(String(jt||0)),Me("DATOS");const wr=Kt(Ne,"candy_main_orders",Qe.id),ln=await Es(wr);if(!ln.exists()){n(" No se encontr la orden.");return}const cn=ln.data(),_r=Array.isArray(cn.items)?cn.items:[],Jt=await Ut(ar(xt(Ne,"inventory_candies"),lr("orderId","==",Qe.id))),ir={};Jt.forEach(Er=>{const Lr=Er.data(),Ln=String(Lr.productId||"");if(!Ln)return;const Nt=MG(Lr);ir[Ln]=(ir[Ln]||0)+Nt});const Fr=_r.map(Er=>{const Lr=A.find(It=>It.id===Er.id),Ln=Number((Lr==null?void 0:Lr.providerPrice)??Er.providerPrice??0),Nt=Math.max(1,ra((Lr==null?void 0:Lr.unitsPerPackage)??Er.unitsPerPackage??1)),nr=Number(Er.marginRivas??0),$t=Number(Er.marginSanJorge??Number(q||0)),Mt=Number(Er.marginIsla??0),Be=op(Ln,ra(Er.packages||0),{marginR:nr,marginSJ:$t,marginIsla:Mt});return{...Er,name:String((Lr==null?void 0:Lr.name)??Er.name??"").trim(),category:String((Lr==null?void 0:Lr.category)??Er.category??"Caramelo").trim(),providerPrice:Ln,unitsPerPackage:Nt,remainingPackages:ir[Er.id]??Er.remainingPackages??Er.packages??0,...Be}});De(Fr),I(!0)}catch(jt){console.error(jt),n(" Error al abrir orden maestra.")}finally{s(!1)}},dn=async Qe=>{if(confirm(`Eliminar la orden "${Qe.name}" y todo su inventario asociado?`)){n("");try{const wr=await Ut(ar(xt(Ne,"inventory_candies"),lr("orderId","==",Qe.id)));for(const ln of wr.docs)await na(Kt(Ne,"inventory_candies",ln.id));await na(Kt(Ne,"candy_main_orders",Qe.id)),v(ln=>ln.filter(cn=>cn.id!==Qe.id)),n(" Orden maestra eliminada."),e()}catch(wr){console.error(wr),n(" Error al eliminar orden maestra.")}}},mn=async()=>{if(!c)try{d(!0),n("");const Qe=await Ut(xt(Ne,"candy_main_orders"));let jt=Lc(Ne),wr=0,ln=0;const cn=(_r,Jt)=>Math.abs(Number(_r||0)-Number(Jt||0))>.01;Qe.forEach(_r=>{const Jt=_r.data(),ir=Array.isArray(Jt.items)?Jt.items:[];if(!ir.length)return;const Fr=ir.reduce(($t,Mt)=>$t+Number(Mt.subtotal||0),0);let Er=Number(Jt.logisticsCost??Jt.gastosLogisticos??Jt.gastos??0);if(Number.isFinite(Er)||(Er=0),!Er){const $t=ir.reduce((Mt,Be)=>Mt+Number(Be.logisticAllocated??0),0);Er=Number($t||0)}const Lr=ir.map($t=>pT($t,Er,Fr)),Ln=Lr.reduce(($t,Mt)=>$t+Number(Mt.grossProfit||0),0);if(!(cn(Jt.logisticsCost,Er)||cn(Jt.uBrutaGlobal,Ln)||Lr.some(($t,Mt)=>{const Be=ir[Mt]||{};return cn(Be.logisticAllocated,$t.logisticAllocated)||cn(Be.grossProfit,$t.grossProfit)||cn(Be.grossProfitIsla,$t.grossProfitIsla)})))return;const nr=Kt(Ne,"candy_main_orders",_r.id);jt.update(nr,{logisticsCost:Er,uBrutaGlobal:Ln,items:Lr,updatedAt:Nr.now()}),wr+=1,ln+=1,wr>=400&&(jt.commit(),jt=Lc(Ne),wr=0)}),wr>0&&await jt.commit(),n(` Ordenes maestras actualizadas: ${ln}`),e()}catch(Qe){console.error(Qe),n(" Error actualizando prorrateo de rdenes maestras.")}finally{d(!1)}},kr=async()=>{if(j&&!u)try{f(!0),n("");const Qe=await SF(j);Qe.created>0||Qe.updated>0?n(` Inventario listo: ${Qe.created} creados, ${Qe.updated} reparados (de ${Qe.totalItems}).`):Qe.totalItems>0?n(" No haba inventario faltante para crear o reparar."):n(" La orden no tiene items para crear inventario."),e()}catch(Qe){console.error(Qe),n(" Error creando inventario faltante.")}finally{f(!1)}};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"mb-3",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Ordenes Maestras"})}),i.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[i.jsx("div",{}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(yc,{onClick:e,loading:a||m}),i.jsx("button",{className:"inline-flex items-center gap-2 bg-gray-200 text-gray-800 px-2 md:px-3 py-2 rounded-2xl hover:bg-gray-300 disabled:opacity-60",onClick:mn,disabled:c,children:c?"Actualizando prorrateo...":"Actualizar prorrateo"}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-indigo-600 text-white px-2 md:px-3 py-2 rounded-2xl hover:bg-indigo-700 w-full md:w-auto max-w-[220px] justify-center",onClick:()=>{Le(),I(!0)},children:[i.jsx("span",{className:"items-center gap-4 inline-block bg-indigo-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Orden"]})]})]}),r&&i.jsx("p",{className:"mt-2 text-sm",children:r})]}),w&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"relative bg-white p-4 md:p-6 rounded shadow-lg w-full max-w-6xl max-h-[90vh] overflow-y-auto text-sm",children:[o&&i.jsx("div",{className:"absolute inset-0 bg-white/70 z-50 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white border rounded-xl px-4 py-3 shadow flex items-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-5 w-5 text-gray-700",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-semibold",children:"Guardando orden"})]})}),i.jsxs("div",{className:"sticky top-0 bg-white z-20 pb-3 border-b",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("h3",{className:"text-lg md:text-xl font-bold",children:j?"Editar Orden Maestra":"Nueva Orden Maestra"}),i.jsxs("div",{className:"ml-auto flex gap-2",children:[j&&i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",disabled:o||u,onClick:kr,children:u?"Creando inventario...":"Crear inventario faltante"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",disabled:o,onClick:()=>{Le(),I(!1)},children:"Cerrar"})]})]}),i.jsx("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-1 gap-2",children:i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold",children:"Gastos logsticos (orden)"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:he,onChange:Qe=>ae(Qe.target.value),placeholder:"0",min:0})]})}),i.jsx("div",{className:"md:hidden mt-3",children:i.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[i.jsx("button",{type:"button",onClick:()=>Me("DATOS"),className:`px-2 py-2 rounded text-xs font-semibold border ${fe==="DATOS"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:"Datos"}),i.jsx("button",{type:"button",onClick:()=>Me("AGREGAR"),className:`px-2 py-2 rounded text-xs font-semibold border ${fe==="AGREGAR"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:"Agregar"}),i.jsxs("button",{type:"button",onClick:()=>Me("ITEMS"),className:`px-2 py-2 rounded text-xs font-semibold border ${fe==="ITEMS"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:["Items (",Ce.length,")"]}),i.jsx("button",{type:"button",onClick:()=>Me("TOTALES"),className:`px-2 py-2 rounded text-xs font-semibold border ${fe==="TOTALES"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:"Totales"})]})})]}),i.jsxs("form",{onSubmit:ur,className:"space-y-4 pt-4",children:[i.jsx("input",{ref:nt,type:"file",accept:".xlsx,.xls,.csv",className:"hidden",onChange:Or}),i.jsx("div",{className:`${fe==="DATOS"?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre de Orden"}),i.jsx("input",{className:"w-full border p-2 rounded",value:S,onChange:Qe=>E(Qe.target.value),placeholder:"Ej: Pedido enero 19"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del pedido"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:B,onChange:Qe=>k(Qe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia Rivas"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:T,onChange:Qe=>P(Qe.target.value)})]}),i.jsx("input",{type:"hidden",value:q,readOnly:!0}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia Isla Ometepe"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:ce,onChange:Qe=>le(Qe.target.value)})]})]})}),i.jsx("div",{className:`${fe==="AGREGAR"?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora (dinmica)"}),i.jsx("select",{className:"w-full border p-2 rounded",value:dt,onChange:Qe=>{Fe(Qe.target.value),We("")},disabled:m,children:Oe.length===0?i.jsx("option",{value:"",children:m?"Cargando...":"No hay categoras en catlogo"}):Oe.map(Qe=>i.jsx("option",{value:Qe,children:Qe},Qe))})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (catlogo)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:je,onChange:Qe=>We(Qe.target.value),children:[i.jsx("option",{value:"",children:m?"Cargando catlogo...":"Selecciona producto"}),Ae.map(Qe=>i.jsx("option",{value:Qe.id,children:Qe.name},Qe.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio proveedor (paq)"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded bg-gray-100",value:ee,readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Paquetes"}),i.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:ie,onChange:Qe=>pe(Qe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Unidades por paquete"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded bg-gray-100",value:rt,readOnly:!0})]})]}),i.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-end gap-2 mt-3",children:i.jsx("button",{type:"button",onClick:ut,className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Agregar producto"})})]})}),i.jsxs("div",{className:"hidden md:flex items-center justify-end gap-2",children:[i.jsx("button",{type:"button",onClick:Ue,className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",title:"Descarga plantilla (Productos + Config)",children:"Descargar plantilla"}),i.jsx("button",{type:"button",onClick:tr,disabled:wt,className:"px-3 py-2 rounded bg-emerald-600 text-white hover:bg-emerald-700 disabled:opacity-60",title:"Importa desde Excel (Productos + Config)",children:wt?"Importando...":"Importar Excel"}),i.jsx("button",{type:"button",onClick:tt,className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",title:"Exporta la orden actual (Productos + Resumen)",children:"Exportar Excel"})]}),i.jsx("div",{className:`${fe==="ITEMS"?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"mt-2",children:[i.jsxs("div",{className:"mb-2 flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Items:"," ",i.jsx("span",{className:"font-semibold",children:Ce.length}),me.trim()?i.jsxs(i.Fragment,{children:[" "," Mostrando"," ",i.jsx("span",{className:"font-semibold",children:re.length})]}):null]}),i.jsx("input",{value:me,onChange:Qe=>ye(Qe.target.value),placeholder:"Buscar producto o categora",className:"w-full md:w-80 border rounded px-3 py-2 text-sm"})]}),i.jsxs("div",{className:"hidden md:block",children:[i.jsx("div",{className:"overflow-x-auto border rounded pb-5",children:i.jsxs("table",{className:"min-w-[1400px] w-full text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-2",children:"Categora"}),i.jsx("th",{className:"text-left p-2",children:"Producto"}),i.jsx("th",{className:"text-right p-2",children:"Paquetes"}),i.jsx("th",{className:"text-right p-2",children:"Restantes"}),i.jsx("th",{className:"text-right p-2",children:"Und x Paq"}),i.jsx("th",{className:"text-right p-2",children:"Precio prov"}),i.jsx("th",{className:"text-right p-2",children:"Facturado"}),i.jsx("th",{className:"text-right p-2",children:"Esperado Rivas"}),i.jsx("th",{className:"text-right p-2",children:"Esperado Isla"}),i.jsx("th",{className:"text-right p-2",children:"MV Rivas"}),i.jsx("th",{className:"text-right p-2",children:"MV Isla"}),i.jsx("th",{className:"text-right p-2",children:"U. Bruta Rivas"}),i.jsx("th",{className:"text-right p-2",children:"U. Bruta Isla"}),i.jsx("th",{className:"text-right p-2",children:"Prorrateo"}),i.jsx("th",{className:"text-right p-2",children:"Precio Rivas"}),i.jsx("th",{className:"text-right p-2",children:"Precio Isla"}),i.jsx("th",{className:"text-center p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[xe.map(Qe=>i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"p-2",children:Qe.category}),i.jsx("td",{className:"p-2 font-semibold",children:Qe.name}),i.jsx("td",{className:"p-2 text-right",children:O[Qe.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:Qe.packages,onChange:jt=>st(Qe.id,"packages",jt.target.value),onBlur:()=>Se(Qe.id),onKeyDown:jt=>{(jt.key==="Enter"||jt.key==="Escape")&&Se(Qe.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Qe.packages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>ke(Qe.id),"aria-label":"Editar paquetes",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:K[Qe.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:ra(Qe.remainingPackages??Qe.packages),onChange:jt=>st(Qe.id,"remainingPackages",jt.target.value),onBlur:()=>vt(Qe.id),onKeyDown:jt=>{(jt.key==="Enter"||jt.key==="Escape")&&vt(Qe.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:ra(Qe.remainingPackages??Qe.packages)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>ot(Qe.id),"aria-label":"Editar paquetes restantes",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:G[Qe.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:Qe.unitsPerPackage,onChange:jt=>st(Qe.id,"unitsPerPackage",jt.target.value),onBlur:()=>Ze(Qe.id),onKeyDown:jt=>{(jt.key==="Enter"||jt.key==="Escape")&&Ze(Qe.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Qe.unitsPerPackage}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Ee(Qe.id),"aria-label":"Editar unidades por paquete",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:Number(Qe.providerPrice||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(Qe.subtotal||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(Qe.totalRivas||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(Qe.totalIsla||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Q[Qe.id]?i.jsx("input",{type:"number",step:"0.001",className:"w-16 border rounded p-1 text-right",value:Number(Qe.marginRivas??0),onChange:jt=>st(Qe.id,"marginRivas",jt.target.value),onBlur:()=>Re(Qe.id),onKeyDown:jt=>{(jt.key==="Enter"||jt.key==="Escape")&&Re(Qe.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Number(Qe.marginRivas??0).toFixed(3)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Et(Qe.id),"aria-label":"Editar margen Rivas",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:se[Qe.id]?i.jsx("input",{type:"number",step:"0.001",className:"w-16 border rounded p-1 text-right",value:Number(Qe.marginIsla??0),onChange:jt=>st(Qe.id,"marginIsla",jt.target.value),onBlur:()=>Ye(Qe.id),onKeyDown:jt=>{(jt.key==="Enter"||jt.key==="Escape")&&Ye(Qe.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Number(Qe.marginIsla??0).toFixed(3)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Te(Qe.id),"aria-label":"Editar margen Isla",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:Number(Qe.grossProfit||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(Qe.grossProfitIsla||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(Qe.logisticAllocated||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:D[Qe.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:Number(Qe.unitPriceRivas||0),onChange:jt=>st(Qe.id,"unitPriceRivas",jt.target.value),onBlur:()=>Tt(Qe.id),onKeyDown:jt=>{(jt.key==="Enter"||jt.key==="Escape")&&Tt(Qe.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Number(Qe.unitPriceRivas||0)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>_t(Qe.id),"aria-label":"Editar precio Rivas",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:te[Qe.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:Number(Qe.unitPriceIsla||0),onChange:jt=>st(Qe.id,"unitPriceIsla",jt.target.value),onBlur:()=>Rt(Qe.id),onKeyDown:jt=>{(jt.key==="Enter"||jt.key==="Escape")&&Rt(Qe.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Number(Qe.unitPriceIsla||0)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Lt(Qe.id),"aria-label":"Editar precio Isla",children:""})]})}),i.jsx("td",{className:"p-2 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>ct(Qe.id),children:"Quitar"})})]},Qe.id)),re.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center text-gray-500",children:"No hay productos en la orden."})})]})]})}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando"," ",Math.min((H-1)*ue+1,re.length),"-",Math.min(H*ue,re.length)," ","de ",re.length]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",disabled:H<=1,onClick:()=>L(Qe=>Math.max(1,Qe-1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Anterior"}),i.jsxs("div",{className:"px-3 py-1 border rounded text-sm",children:[H," / ",Pe]}),i.jsx("button",{type:"button",disabled:H>=Pe,onClick:()=>L(Qe=>Math.min(Pe,Qe+1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Siguiente"})]})]})]}),i.jsx("div",{className:"md:hidden space-y-3",children:re.length===0?i.jsx("div",{className:"p-4 border rounded bg-gray-50 text-gray-600",children:"No hay productos en esta orden."}):re.map(Qe=>i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm",children:[i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"font-semibold text-base leading-tight truncate",children:Qe.name}),i.jsx("div",{className:"text-xs text-gray-500 truncate",children:Qe.category})]}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ct(Qe.id),children:"Quitar"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Paquetes"}),O[Qe.id]?i.jsx("input",{type:"number",step:"0.001",className:"w-full border p-2 rounded text-right",value:Qe.packages,onChange:jt=>st(Qe.id,"packages",jt.target.value),onBlur:()=>Se(Qe.id),onKeyDown:jt=>{(jt.key==="Enter"||jt.key==="Escape")&&Se(Qe.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Qe.packages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>ke(Qe.id),"aria-label":"Editar paquetes",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Paquetes restantes"}),K[Qe.id]?i.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:ra(Qe.remainingPackages??Qe.packages),onChange:jt=>st(Qe.id,"remainingPackages",jt.target.value),onBlur:()=>vt(Qe.id),onKeyDown:jt=>{(jt.key==="Enter"||jt.key==="Escape")&&vt(Qe.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:ra(Qe.remainingPackages??Qe.packages)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>ot(Qe.id),"aria-label":"Editar paquetes restantes",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Und x Paquete"}),G[Qe.id]?i.jsx("input",{type:"number",step:"0.001",className:"w-full border p-2 rounded text-right",value:Qe.unitsPerPackage,onChange:jt=>st(Qe.id,"unitsPerPackage",jt.target.value),onBlur:()=>Ze(Qe.id),onKeyDown:jt=>{(jt.key==="Enter"||jt.key==="Escape")&&Ze(Qe.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Qe.unitsPerPackage}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Ee(Qe.id),"aria-label":"Editar unidades por paquete",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Precio proveedor"}),i.jsx("input",{className:"w-full border p-2 rounded text-right bg-gray-100",value:Number(Qe.providerPrice||0).toFixed(2),readOnly:!0})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"MV Rivas (%)"}),Q[Qe.id]?i.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:Qe.marginRivas??0,onChange:jt=>st(Qe.id,"marginRivas",jt.target.value),onBlur:()=>Re(Qe.id),onKeyDown:jt=>{(jt.key==="Enter"||jt.key==="Escape")&&Re(Qe.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Number(Qe.marginRivas??0).toFixed(3)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Et(Qe.id),"aria-label":"Editar margen Rivas",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"MV Isla (%)"}),se[Qe.id]?i.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:Qe.marginIsla??0,onChange:jt=>st(Qe.id,"marginIsla",jt.target.value),onBlur:()=>Ye(Qe.id),onKeyDown:jt=>{(jt.key==="Enter"||jt.key==="Escape")&&Ye(Qe.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Number(Qe.marginIsla??0).toFixed(3)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Te(Qe.id),"aria-label":"Editar margen Isla",children:""})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Facturado"}),i.jsx("div",{className:"font-semibold",children:Number(Qe.subtotal||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Esperado Rivas"}),i.jsx("div",{className:"font-semibold",children:Number(Qe.totalRivas||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Esperado Isla"}),i.jsx("div",{className:"font-semibold",children:Number(Qe.totalIsla||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prorrateo logstico"}),i.jsx("div",{className:"font-semibold",children:Number(Qe.logisticAllocated||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta Rivas"}),i.jsx("div",{className:"font-semibold",children:Number(Qe.grossProfit||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta Isla"}),i.jsx("div",{className:"font-semibold",children:Number(Qe.grossProfitIsla||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Precio Rivas (paq)"}),D[Qe.id]?i.jsx("input",{type:"number",className:"w-full border rounded p-2 text-right",value:Number(Qe.unitPriceRivas||0),onChange:jt=>st(Qe.id,"unitPriceRivas",jt.target.value),onBlur:()=>Tt(Qe.id),onKeyDown:jt=>{(jt.key==="Enter"||jt.key==="Escape")&&Tt(Qe.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Qe.unitPriceRivas}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>_t(Qe.id),"aria-label":"Editar precio Rivas",children:""})]})]}),i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Precio Isla (paq)"}),te[Qe.id]?i.jsx("input",{type:"number",className:"w-full border rounded p-2 text-right",value:Number(Qe.unitPriceIsla||0),onChange:jt=>st(Qe.id,"unitPriceIsla",jt.target.value),onBlur:()=>Rt(Qe.id),onKeyDown:jt=>{(jt.key==="Enter"||jt.key==="Escape")&&Rt(Qe.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Qe.unitPriceIsla}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Lt(Qe.id),"aria-label":"Editar precio Isla",children:""})]})]})]})]},Qe.id))})]})}),i.jsxs("div",{className:`${fe==="TOTALES"?"block":"hidden"} md:block`,children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mt-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes totales"}),i.jsx("div",{className:"text-lg font-semibold",children:ne.totalPackages})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal costo (facturado)"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(ne.subtotalCosto||0).toFixed(2)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Esperado (Rivas / Isla)"}),i.jsxs("div",{className:"text-sm font-semibold",children:["Rivas: ",Number(ne.esperadoRivas||0).toFixed(2),i.jsx("br",{}),"Isla: ",Number(ne.esperadoIsla||0).toFixed(2)]})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos logsticos"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(ne.gastosLogisticos||0).toFixed(2)})]})]}),i.jsxs("div",{className:"mt-3",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-emerald-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta Rivas"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(ne.utilidadBrutaRivas||0).toFixed(2)})]}),i.jsxs("div",{className:"p-3 border rounded bg-emerald-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta Isla"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(ne.utilidadBrutaIsla||0).toFixed(2)})]})]}),i.jsx("div",{className:"mt-3 border rounded p-3 bg-white",children:i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:tt,disabled:!X.items.length,title:"Exporta la orden actual (productos + resumen)",children:"Exportar orden a Excel"})})})]})]}),i.jsxs("div",{className:"sticky bottom-0 bg-white pt-3 mt-4 border-t",children:[i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx("button",{type:"button",onClick:Le,className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",children:"Limpiar orden"}),i.jsx("button",{type:"button",onClick:()=>{Le(),I(!1)},className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",children:"Cerrar"}),i.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",disabled:o||Ce.length===0,children:o?"Guardando...":"Guardar orden"})]}),i.jsx("div",{className:"md:hidden mt-2",children:i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 text-sm",onClick:()=>{Me(fe==="DATOS"&&!j?"AGREGAR":fe==="DATOS"||fe==="AGREGAR"?"ITEMS":fe==="ITEMS"?"TOTALES":"DATOS")},children:"Siguiente"})})]})]})]})}),i.jsxs("div",{className:"mt-4",children:[i.jsx("div",{className:"md:hidden space-y-3",children:a?i.jsx("div",{className:"p-4 border rounded bg-white text-center",children:"Cargando"}):x.length===0?i.jsx("div",{className:"p-4 border rounded bg-white text-center",children:"Sin ordenes maestras."}):x.map(Qe=>{const jt=y[Qe.id],wr=zr(Qe),ln=Qe.totalPackages>0?(Qe.subtotal/Qe.totalPackages).toFixed(2):"0.00",cn=Number(Qe.logisticsCost||0),_r=Number(Qe.totalRivas||0)-Number(Qe.subtotal||0);return i.jsxs("div",{className:"border rounded-xl p-3 bg-white shadow-sm",children:[i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"text-xs text-gray-500",children:wr}),i.jsx("div",{className:"font-semibold text-base leading-tight",children:Qe.name})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-xs",onClick:()=>Dr(Qe),children:"Ver"}),i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white text-xs",onClick:()=>dn(Qe),children:"Borrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("div",{className:"font-semibold",children:Qe.totalPackages})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Restantes"}),i.jsx("div",{className:"font-semibold",children:jt?jt.remainingPackages:0})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"P. Proveedor"}),i.jsx("div",{className:"font-semibold",children:ln})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal"}),i.jsx("div",{className:"font-semibold",children:Number(Qe.subtotal||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Esperado Rivas"}),i.jsx("div",{className:"font-semibold",children:Number(Qe.totalRivas||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Esperado Isla"}),i.jsx("div",{className:"font-semibold",children:Number(Qe.totalIsla||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Gastos log."}),i.jsx("div",{className:"font-semibold",children:cn.toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta (est)"}),i.jsx("div",{className:"font-semibold",children:_r.toFixed(2)})]})]})]},Qe.id)})}),i.jsxs("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full overflow-x-auto",children:[i.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Proveedor"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Esperado Rivas"}),i.jsx("th",{className:"p-2 border",children:"Esperado Isla"}),i.jsx("th",{className:"p-2 border",children:"Gastos log."}),i.jsx("th",{className:"p-2 border",children:"U. Bruta (est)"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):x.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin ordenes maestras."})}):Ft.map(Qe=>{const jt=y[Qe.id],wr=zr(Qe),ln=Qe.totalPackages>0?(Qe.subtotal/Qe.totalPackages).toFixed(2):"0.00",cn=Number(Qe.logisticsCost||0),_r=Number(Qe.totalRivas||0)-Number(Qe.subtotal||0);return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:wr}),i.jsx("td",{className:"p-2 border text-left",children:Qe.name}),i.jsx("td",{className:"p-2 border",children:Qe.totalPackages}),i.jsx("td",{className:"p-2 border",children:jt?jt.remainingPackages:0}),i.jsx("td",{className:"p-2 border",children:ln}),i.jsx("td",{className:"p-2 border",children:Number(Qe.subtotal||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Number(Qe.totalRivas||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Number(Qe.totalIsla||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:cn.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:_r.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>Dr(Qe),children:"Ver / Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>dn(Qe),children:"Borrar"})]})})]},Qe.id)})})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",Math.min((mt-1)*yt+1,x.length),"-",Math.min(mt*yt,x.length)," de ",x.length]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",disabled:mt<=1,onClick:()=>gt(Qe=>Math.max(1,Qe-1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Anterior"}),i.jsxs("div",{className:"px-3 py-1 border rounded text-sm",children:[mt," / ",Pt]}),i.jsx("button",{type:"button",disabled:mt>=Pt,onClick:()=>gt(Qe=>Math.min(Pt,Qe+1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Siguiente"})]})]})]})]})]})}const _0=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function gT(t){const e=Number(t.packages||0),r=Number(t.providerPrice||0),n=Number(t.unitsPerPackage||0),a=r*e,s=e>0&&n>0?e*n:1,o=Number(t.marginRivas||0),l=Number(t.marginSanJorge||0),c=Number(t.marginIsla||0),d=a*(1+o/100),u=a*(1+l/100),f=a*(1+c/100),A=d-a,h=u-a,m=f-a,p=d/s,x=u/s,v=f/s;return{...t,subtotal:Number(a.toFixed(2)),totalRivas:Number(d.toFixed(2)),totalSanJorge:Number(u.toFixed(2)),totalIsla:Number(f.toFixed(2)),gainRivas:Number(A.toFixed(2)),gainSanJorge:Number(h.toFixed(2)),gainIsla:Number(m.toFixed(2)),unitPriceRivas:Number(p.toFixed(2)),unitPriceSanJorge:Number(x.toFixed(2)),unitPriceIsla:Number(v.toFixed(2))}}function LG(t){return t.reduce((e,r)=>(e.totalPackages+=Number(r.packages||0),e.subtotal+=Number(r.subtotal||0),e.totalRivas+=Number(r.totalRivas||0),e.totalSanJorge+=Number(r.totalSanJorge||0),e.totalIsla+=Number(r.totalIsla||0),e),{totalPackages:0,subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0})}function rd(t,e=0){const r=Number(t);return Number.isFinite(r)?r:e}function xT(t){const{margin:e,gain:r,subtotal:n,orderMargin:a}=t;if(e!=null&&Number.isFinite(Number(e)))return Number(e);const s=Number(n||0),o=Number(r);return Number.isFinite(o)&&s>0?o/s*100:Number(a||0)}function jVe(){var M,K,Y;const[t,e]=g.useState([]),[r,n]=g.useState({}),[a,s]=g.useState(!0),[o,l]=g.useState(""),[c,d]=g.useState(Kr(Gu(new Date),"yyyy-MM-dd")),[u,f]=g.useState(Kr($u(new Date),"yyyy-MM-dd")),[A,h]=g.useState(!1),[m,p]=g.useState(!1),[x,v]=g.useState(null),[y,b]=g.useState([]),[w,I]=g.useState(0),[j,N]=g.useState(0),[S,E]=g.useState(0),[B,k]=g.useState(""),[T,P]=g.useState(""),[q,de]=g.useState(0),[ce,le]=g.useState(0),[he,ae]=g.useState(1);g.useEffect(()=>{(async()=>{try{s(!0),l("");const D=ar(xt(Ne,"candy_main_orders"),kn("createdAt","desc")),V=await Ut(D),te=[];V.forEach(Xe=>{const se=Xe.data();te.push({id:Xe.id,name:se.name??"",date:se.date??"",totalPackages:Number(se.totalPackages??0),subtotal:Number(se.subtotal??0),totalRivas:Number(se.totalRivas??0),totalSanJorge:Number(se.totalSanJorge??0),totalIsla:Number(se.totalIsla??0),marginRivas:Number(se.marginRivas??0),marginSanJorge:Number(se.marginSanJorge??0),marginIsla:Number(se.marginIsla??0),createdAt:se.createdAt??Nr.now()})}),e(te);const ve=await Ut(ar(xt(Ne,"inventory_candies"))),Q={};ve.forEach(Xe=>{const se=Xe.data(),Z=se.orderId;if(!Z)return;const ke=Number(se.unitsPerPackage||1)||1,Se=Number(se.totalUnits??(se.packages||0)*ke),Ee=Math.round(Se/ke),Ze=Number(se.remaining??se.totalUnits??Se),ot=Number(se.remainingPackages??NaN),vt=Number.isFinite(ot)?Math.round(ot):Math.round(Ze/ke);Q[Z]||(Q[Z]={orderId:Z,totalPackages:0,remainingPackages:0}),Q[Z].totalPackages+=Ee,Q[Z].remainingPackages+=vt}),n(Q)}catch(D){console.error(D),l(" Error cargando inventario de pedidos.")}finally{s(!1)}})()},[]);const Ce=g.useMemo(()=>t.filter(D=>{var te;const V=D.date||((te=D.createdAt)!=null&&te.toDate?D.createdAt.toDate().toISOString().slice(0,10):"");return!(!V||c&&V<c||u&&V>u)}),[t,c,u]),De=g.useMemo(()=>{let D=0,V=0,te=0,ve=0,Q=0,Xe=0;for(const se of Ce){D+=se.totalPackages,V+=se.subtotal,te+=se.totalRivas,ve+=se.totalSanJorge,Q+=se.totalIsla;const Z=r[se.id];Z&&(Xe+=Z.remainingPackages)}return{totalPaquetes:D,totalSubtotal:V,totalRivas:te,totalSJ:ve,totalIsla:Q,totalPaquetesRestantes:Xe,totalPedidos:Ce.length}},[Ce,r]),O=async(D,V,te)=>{if(!x)return;const ve=Number(te||0),Q=y.map(Z=>Z.id!==D?Z:gT({...Z,[V]:ve}));b(Q);const Xe=Q.find(Z=>Z.id===D);if(!Xe)return;const se=LG(Q);try{await Mn(Kt(Ne,"products_candies",D),{marginRivas:Xe.marginRivas,marginSanJorge:Xe.marginSanJorge,marginIsla:Xe.marginIsla,subtotal:Xe.subtotal,totalRivas:Xe.totalRivas,totalSanJorge:Xe.totalSanJorge,totalIsla:Xe.totalIsla,unitPriceRivas:Xe.unitPriceRivas,unitPriceSanJorge:Xe.unitPriceSanJorge,unitPriceIsla:Xe.unitPriceIsla,gainRivas:Xe.gainRivas,gainSanJorge:Xe.gainSanJorge,gainIsla:Xe.gainIsla}),await Mn(Kt(Ne,"candy_main_orders",x.id),{totalPackages:se.totalPackages,subtotal:Number(se.subtotal.toFixed(2)),totalRivas:Number(se.totalRivas.toFixed(2)),totalSanJorge:Number(se.totalSanJorge.toFixed(2)),totalIsla:Number(se.totalIsla.toFixed(2))}),v(Z=>Z&&{...Z,totalPackages:se.totalPackages,subtotal:Number(se.subtotal.toFixed(2)),totalRivas:Number(se.totalRivas.toFixed(2)),totalSanJorge:Number(se.totalSanJorge.toFixed(2)),totalIsla:Number(se.totalIsla.toFixed(2))}),l(" Mrgenes del producto actualizados.")}catch(Z){console.error(Z),l(" Error actualizando mrgenes del producto.")}},R=async()=>{if(x)try{l("");const D=Number.isFinite(w)&&w!==0?w:x.marginRivas||0,V=Number.isFinite(j)&&j!==0?j:x.marginSanJorge||0,te=Number.isFinite(S)&&S!==0?S:x.marginIsla||0,ve=gT({id:"tmp",name:B.trim(),category:T.trim(),providerPrice:Number(q||0),packages:Number(ce||0),unitsPerPackage:Number(he||1),marginRivas:Number(D||0),marginSanJorge:Number(V||0),marginIsla:Number(te||0),subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0,gainRivas:0,gainSanJorge:0,gainIsla:0,unitPriceRivas:0,unitPriceSanJorge:0,unitPriceIsla:0,remainingPackages:Number(ce||0)}),Q=await ta(xt(Ne,"products_candies"),{orderId:x.id,inventoryDate:x.date||"",name:ve.name,category:ve.category,providerPrice:ve.providerPrice,packages:ve.packages,unitsPerPackage:ve.unitsPerPackage,marginRivas:ve.marginRivas,marginSanJorge:ve.marginSanJorge,marginIsla:ve.marginIsla,gainRivas:ve.gainRivas,gainSanJorge:ve.gainSanJorge,gainIsla:ve.gainIsla,subtotal:ve.subtotal,totalRivas:ve.totalRivas,totalSanJorge:ve.totalSanJorge,totalIsla:ve.totalIsla,unitPriceRivas:ve.unitPriceRivas,unitPriceSanJorge:ve.unitPriceSanJorge,unitPriceIsla:ve.unitPriceIsla,createdAt:Nr.now()}),se=[{...ve,id:Q.id},...y];b(se);const Z=LG(se);await Mn(Kt(Ne,"candy_main_orders",x.id),{totalPackages:Z.totalPackages,subtotal:Number(Z.subtotal.toFixed(2)),totalRivas:Number(Z.totalRivas.toFixed(2)),totalSanJorge:Number(Z.totalSanJorge.toFixed(2)),totalIsla:Number(Z.totalIsla.toFixed(2))}),v(ke=>ke&&{...ke,totalPackages:Z.totalPackages,subtotal:Number(Z.subtotal.toFixed(2)),totalRivas:Number(Z.totalRivas.toFixed(2)),totalSanJorge:Number(Z.totalSanJorge.toFixed(2)),totalIsla:Number(Z.totalIsla.toFixed(2))}),I(0),N(0),E(0),k(""),P(""),de(0),le(0),ae(1),l(" Producto agregado con mrgenes por sucursal.")}catch(D){console.error(D),l(" Error agregando producto al pedido.")}},G=async D=>{try{v(D),b([]),h(!0),p(!0),l("");const V=await Ut(ar(xt(Ne,"inventory_candies"),lr("orderId","==",D.id))),te={};V.forEach(Xe=>{const se=Xe.data(),Z=se.productId;if(!Z)return;const ke=Number(se.unitsPerPackage||1)||1,Se=Number(se.remaining??se.totalUnits??0),Ee=Number(se.remainingPackages??NaN),Ze=Number.isFinite(Ee)?Math.round(Ee):Math.round(Se/ke);te[Z]=(te[Z]||0)+Ze});const ve=await Ut(ar(xt(Ne,"products_candies"),lr("orderId","==",D.id))),Q=[];ve.forEach(Xe=>{const se=Xe.data(),Z=rd(se.providerPrice,0),ke=rd(se.packages,0),Se=se.subtotal??Z*ke,Ee=xT({margin:se.marginRivas,gain:se.gainRivas,subtotal:Se,orderMargin:D.marginRivas||0}),Ze=xT({margin:se.marginSanJorge,gain:se.gainSanJorge,subtotal:Se,orderMargin:D.marginSanJorge||0}),ot=xT({margin:se.marginIsla,gain:se.gainIsla,subtotal:Se,orderMargin:D.marginIsla||0}),vt=gT({id:Xe.id,name:se.name??"",category:se.category??"",providerPrice:Z,packages:ke,unitsPerPackage:rd(se.unitsPerPackage,1),marginRivas:Number(Ee||0),marginSanJorge:Number(Ze||0),marginIsla:Number(ot||0),subtotal:rd(se.subtotal,0),totalRivas:rd(se.totalRivas,0),totalSanJorge:rd(se.totalSanJorge,0),totalIsla:rd(se.totalIsla,0),gainRivas:rd(se.gainRivas,0),gainSanJorge:rd(se.gainSanJorge,0),gainIsla:rd(se.gainIsla,0),unitPriceRivas:rd(se.unitPriceRivas,0),unitPriceSanJorge:rd(se.unitPriceSanJorge,0),unitPriceIsla:rd(se.unitPriceIsla,0),remainingPackages:te[Xe.id]??rd(se.packages,0)});Q.push(vt)}),b(Q)}catch(V){console.error(V),l(" Error cargando productos del pedido.")}finally{p(!1)}};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario Ordenes Maestras"})}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:D=>d(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:D=>f(D.target.value)})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{d(""),f("")},children:"Quitar filtro"}),i.jsxs("div",{className:"ml-auto text-xs md:text-sm text-gray-600",children:["Cantidad de pedidos:"," ",i.jsx("span",{className:"font-semibold",children:De.totalPedidos})]})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-sm md:text-base",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes totales:"})," ",De.totalPaquetes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes restantes:"})," ",De.totalPaquetesRestantes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Subtotal total:"})," ",_0(De.totalSubtotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Rivas (todo):"})," ",_0(De.totalRivas)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total San Jorge (todo):"})," ",_0(De.totalSJ)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Isla (todo):"})," ",_0(De.totalIsla)]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-2",children:i.jsxs("table",{className:"min-w-[900px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. prom. Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. prom. San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. prom. Isla"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):Ce.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin pedidos generales en este rango."})}):Ce.map(D=>{var se;const V=D.totalPackages>0?Math.round(D.totalRivas/D.totalPackages):0,te=D.totalPackages>0?Math.round(D.totalSanJorge/D.totalPackages):0,ve=D.totalPackages>0?Math.round(D.totalIsla/D.totalPackages):0,Q=D.date||((se=D.createdAt)!=null&&se.toDate?D.createdAt.toDate().toISOString().slice(0,10):""),Xe=r[D.id];return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:Q}),i.jsx("td",{className:"p-2 border",children:D.name}),i.jsx("td",{className:"p-2 border",children:D.totalPackages}),i.jsx("td",{className:"p-2 border",children:Xe?Xe.remainingPackages:0}),i.jsx("td",{className:"p-2 border",children:D.subtotal.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalRivas.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalSanJorge.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalIsla.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:V}),i.jsx("td",{className:"p-2 border",children:te}),i.jsx("td",{className:"p-2 border",children:ve}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>G(D),children:"Ver pedido"})})]},D.id)})})]})}),A&&x&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-5xl max-h-[90vh] overflow-y-auto text-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsxs("h3",{className:"text-xl font-bold",children:["Detalle: ",x.name]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:()=>{h(!1),v(null),b([]),l("")},children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4 text-xs md:text-sm",children:[i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Fecha del pedido"}),i.jsx("div",{className:"font-semibold",children:x.date||((M=x.createdAt)!=null&&M.toDate?x.createdAt.toDate().toISOString().slice(0,10):"")})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes totales"}),i.jsx("div",{className:"font-semibold",children:((K=r[x.id])==null?void 0:K.totalPackages)??x.totalPackages})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes restantes"}),i.jsx("div",{className:"font-semibold",children:((Y=r[x.id])==null?void 0:Y.remainingPackages)??0})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Subtotal (proveedor)"}),i.jsx("div",{className:"font-semibold",children:_0(x.subtotal)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total Rivas"}),i.jsx("div",{className:"font-semibold",children:_0(x.totalRivas)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total San Jorge"}),i.jsx("div",{className:"font-semibold",children:_0(x.totalSanJorge)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total Isla"}),i.jsx("div",{className:"font-semibold",children:_0(x.totalIsla)})]})]}),i.jsxs("div",{className:"bg-white border rounded p-3 mb-4",children:[i.jsx("div",{className:"font-semibold mb-2",children:"Agregar producto"}),i.jsxs("div",{className:"flex flex-wrap gap-2 items-end text-xs",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen Rivas"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:w,onChange:D=>I(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen SJ"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:j,onChange:D=>N(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen Isla"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:S,onChange:D=>E(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Producto"}),i.jsx("input",{className:"border rounded px-2 py-1 w-56",value:B,onChange:D=>k(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Categora"}),i.jsx("input",{className:"border rounded px-2 py-1 w-40",value:T,onChange:D=>P(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"P. proveedor (paq)"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-32 text-right",value:q,onChange:D=>de(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Paquetes"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",value:ce,onChange:D=>le(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Und x Paq"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",value:he,onChange:D=>ae(Number(D.target.value||1))})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:R,children:"Agregar producto"})]})]}),i.jsx("h4",{className:"font-semibold mb-2",children:"Productos del pedido"}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Und x Paq"}),i.jsx("th",{className:"p-2 border",children:"P. proveedor (paq)"}),i.jsx("th",{className:"p-2 border",children:"Margen Rivas (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen San Jorge (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen Isla (%)"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. unidad San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Isla"})]})}),i.jsx("tbody",{children:m?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"p-4 text-center",children:"Cargando productos"})}):y.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"p-4 text-center",children:"Este pedido no tiene productos registrados."})}):y.map(D=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:D.name}),i.jsx("td",{className:"p-2 border",children:D.category}),i.jsx("td",{className:"p-2 border",children:D.packages}),i.jsx("td",{className:"p-2 border",children:D.remainingPackages??D.packages}),i.jsx("td",{className:"p-2 border",children:D.unitsPerPackage}),i.jsx("td",{className:"p-2 border",children:D.providerPrice.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:D.marginRivas??0,onChange:V=>O(D.id,"marginRivas",V.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:D.marginSanJorge??0,onChange:V=>O(D.id,"marginSanJorge",V.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:D.marginIsla??0,onChange:V=>O(D.id,"marginIsla",V.target.value)})}),i.jsx("td",{className:"p-2 border",children:D.subtotal.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalRivas.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalSanJorge.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalIsla.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.unitPriceRivas}),i.jsx("td",{className:"p-2 border",children:D.unitPriceSanJorge}),i.jsx("td",{className:"p-2 border",children:D.unitPriceIsla})]},D.id))})]})}),o&&i.jsx("p",{className:"mt-3 text-sm",children:o})]})}),o&&!A&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const Fa=t=>Math.round((Number(t)||0)*100)/100,lp=t=>Math.round((Number(t)||0)*1e3)/1e3,Ya=t=>Number(t??0).toFixed(2),of=t=>Number(t??0).toFixed(3),UG=t=>String(t??"").trim().toLowerCase();async function IVe(t){if(!t)return;const e=ar(xt(Ne,"ar_movements"),lr("ref.saleId","==",t)),r=await Ut(e);await Promise.all(r.docs.map(n=>na(Kt(Ne,"ar_movements",n.id))))}const PVe=(t,e)=>{var v;const r=t.date??((v=t.timestamp)!=null&&v.toDate?Kr(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=t.userEmail??"",a=t.vendorName||t.vendor||n||t.vendorId||"(sin vendedor)",s=t.type||"CONTADO",o=t.vendorId,l=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,c=Number(t.vendorCommissionAmount??0)||0,d=t.processedDate??t.closureDate??"";if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((y,b)=>{const w=Number((y==null?void 0:y.packages)??(y==null?void 0:y.qty)??(y==null?void 0:y.quantity)??0),I=Number((y==null?void 0:y.lineFinal)??0)||Math.max(0,Number((y==null?void 0:y.unitPricePackage)||(y==null?void 0:y.unitPrice)||0)*w-Number((y==null?void 0:y.discount)||0));let j=0;c>0&&l>0&&Number(I||0)>0&&(j=Fa(c*Number(I||0)/l));const N=Number((y==null?void 0:y.margenVendedor)??(y==null?void 0:y.uBruta)??(y==null?void 0:y.grossProfit)??0)||0,S=Number((y==null?void 0:y.prorrateo)??0)||0,E=Number((y==null?void 0:y.uBruta)??0)||0,B=Fa(E-S-N);return{id:`${e}#${b}`,productName:String((y==null?void 0:y.productName)??"(sin nombre)"),quantity:w,amount:Fa(I),amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:a,sellerEmail:n,clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:Array.isArray(y==null?void 0:y.allocations)?y.allocations:t.allocations,avgUnitCost:Number((y==null?void 0:y.avgUnitCost)??t.avgUnitCost??0),cogsAmount:Number((y==null?void 0:y.cogsAmount)??0),type:s,vendorId:o,vendorCommissionAmount:j,vendorUtility:N,vendorNetUtility:B,commissionFromItems:Number((y==null?void 0:y.margenVendedor)??0)||0,processedDate:d||""}});const u=Number(t.packagesTotal??t.quantity??0),f=Number(t.amount??t.amountCharged??t.total??0)||0;let A=0;A=Fa(Number(t.vendorCommissionAmount??0)||0);const h=Number(t.margenVendedor??t.uBruta??t.grossProfit??0)||0,m=Number(t.prorrateo??0)||0,p=Number(t.uBruta??0)||0,x=Fa(p-m-h);return[{id:e,productName:t.productName??"(sin nombre)",quantity:u,amount:f,amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:a,sellerEmail:n,clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:t.allocations,avgUnitCost:t.avgUnitCost,cogsAmount:t.cogsAmount,type:s,vendorId:o,vendorCommissionAmount:A,vendorUtility:h,vendorNetUtility:x,commissionFromItems:Number(t.margenVendedor??0)||0,processedDate:d||""}]};function TVe({role:t,currentUserEmail:e,sellerCandyId:r,roles:n}){const[a,s]=g.useState([]),[o,l]=g.useState(null),[c,d]=g.useState(!0),[u,f]=g.useState(""),[A,h]=g.useState("ALL"),m=Kr(new Date,"yyyy-MM-dd"),[p,x]=g.useState(m),[v,y]=g.useState(m),[b,w]=g.useState("ALL"),[I,j]=g.useState("ALL"),[N,S]=g.useState(null),[E,B]=g.useState(0),[k,T]=g.useState(0),[P,q]=g.useState(""),[de,ce]=g.useState(0),[le,he]=g.useState("0"),[ae,Ce]=g.useState(!1),[De,O]=g.useState(!1),[R,G]=g.useState(!1),[M,K]=g.useState(!1),[Y,D]=g.useState(!1),[V,te]=g.useState(!1),ve=g.useRef(null),Q=n&&n.length?n:t,Xe=!Q||Rn(Q,"admin"),se=Rn(Q,"vendedor_dulces"),Z=(e||"").trim().toLowerCase(),[ke,Se]=g.useState([]),[Ee,Ze]=g.useState({}),[ot,vt]=g.useState({}),_t=wi.useMemo(()=>{const L=new Set;return a.forEach(ue=>{const Pe=(ue.productName||"").trim();Pe&&L.add(Pe)}),Array.from(L).sort((ue,Pe)=>ue.localeCompare(Pe))},[a]);g.useEffect(()=>{if(!p||!v)return;d(!0);const L=ar(xt(Ne,"sales_candies"),lr("date",">=",p),lr("date","<=",v),kn("date","asc")),ue=Fu(L,Pe=>{const xe=[];Pe.forEach(Ge=>{const ze=PVe(Ge.data(),Ge.id);xe.push(...ze)}),s(xe),d(!1)},Pe=>{console.error("Error cargando ventas por periodo:",Pe),s([]),d(!1)});return()=>ue()},[p,v]),g.useEffect(()=>{(async()=>{const ue=ar(xt(Ne,"daily_closures_candies"),lr("date","==",m)),Pe=await Ut(ue);if(Pe.empty)l(null);else{const xe=Pe.docs[0];l({id:xe.id,...xe.data()})}})()},[m]),g.useEffect(()=>{(async()=>{try{const ue=await Ut(xt(Ne,"sellers_candies")),Pe=[];ue.forEach(xe=>{const Ge=xe.data();Pe.push({id:xe.id,name:Ge.name||"",commissionPercent:Number(Ge.commissionPercent||0)})}),Se(Pe)}catch(ue){console.error("Error cargando sellers_candies",ue)}})()},[]),g.useEffect(()=>{(async()=>{try{const ue=await Ut(xt(Ne,"products_candies")),Pe={};ue.forEach(xe=>{const Ge=xe.data(),ze=UG(Ge==null?void 0:Ge.name);if(!ze)return;const Ke=String((Ge==null?void 0:Ge.category)||"").trim();Pe[ze]=Ke||"(sin categora)"}),Ze(Pe)}catch(ue){console.error("Error cargando products_candies",ue)}})()},[]);const Tt=L=>Fa(Number(L.vendorCommissionAmount??0)||0),Lt=L=>Fa(Number(L.vendorUtility??0)||0),Rt=L=>Fa(Number(L.vendorNetUtility??0)||0),Et=L=>Fa(Number(L.commissionFromItems??0)||0),Re=wi.useMemo(()=>{let L=[...a];return A==="FLOTANTE"&&(L=L.filter(ue=>ue.status==="FLOTANTE")),A==="PROCESADA"&&(L=L.filter(ue=>ue.status==="PROCESADA")),I!=="ALL"&&(L=L.filter(ue=>(ue.productName||"").trim()===I)),Xe&&b!=="ALL"&&(L=L.filter(ue=>(ue.vendorId||"")===b)),se&&(r?L=L.filter(ue=>(ue.vendorId||"")===r):Z?L=L.filter(ue=>(ue.sellerEmail||"").toLowerCase()===Z):L=[]),L},[A,a,I,Xe,b,se,r,Z]),Te=wi.useMemo(()=>Re.filter(L=>L.type!=="CREDITO"),[Re]),Ye=wi.useMemo(()=>Re.filter(L=>L.type==="CREDITO"),[Re]),dt=wi.useMemo(()=>Re.filter(L=>L.status==="FLOTANTE").length,[Re]),Fe=wi.useMemo(()=>Re.filter(L=>L.status==="PROCESADA").length,[Re]),je=wi.useMemo(()=>Re.filter(L=>L.type==="CREDITO").length,[Re]),We=wi.useMemo(()=>Re.filter(L=>L.type!=="CREDITO").length,[Re]),ee=lp(Re.reduce((L,ue)=>L+(ue.quantity||0),0)),Ve=Fa(Re.reduce((L,ue)=>L+Number(ue.cogsAmount??0),0)),rt=Fa(Re.reduce((L,ue)=>L+(ue.amount||0),0)),$e=Fa(rt-Ve);let ie=0,pe=0,fe=0,Me=0,me=0,ye=0,mt=0;Re.forEach(L=>{const ue=Number(L.amount||0),Pe=Number(L.amountReceived||0),xe=Tt(L);me+=xe,L.type==="CREDITO"?(ie+=L.quantity||0,fe+=ue-Pe,mt+=xe):(pe+=L.quantity||0,Me+=ue,ye+=xe)}),fe=Fa(fe),Me=Fa(Me),me=Fa(me),ye=Fa(ye),mt=Fa(mt);const gt=wi.useMemo(()=>{const L={};for(const ue of Re){const Pe=(ue.vendorId||"").trim();if(!Pe||ue.type==="CREDITO")continue;const xe=Tt(ue);if(!L[Pe]){const Ge=ke.find(ze=>ze.id===Pe);L[Pe]={vendorId:Pe,name:(Ge==null?void 0:Ge.name)||ue.userEmail||"(sin vendedor)",total:0}}L[Pe].total=Fa(L[Pe].total+xe)}return Object.values(L).filter(ue=>ue.total>0).sort((ue,Pe)=>Pe.total-ue.total)},[Re,ke]),yt=wi.useMemo(()=>{const L={};for(const ue of Re){const Pe=(ue.vendorId||"").trim();if(!Pe||ue.type!=="CREDITO")continue;const xe=Tt(ue);if(!L[Pe]){const Ge=ke.find(ze=>ze.id===Pe);L[Pe]={vendorId:Pe,name:(Ge==null?void 0:Ge.name)||ue.userEmail||"(sin vendedor)",total:0}}L[Pe].total=Fa(L[Pe].total+xe)}return Object.values(L).filter(ue=>ue.total>0).sort((ue,Pe)=>Pe.total-ue.total)},[Re,ke]),Pt={};Re.forEach(L=>{const ue=L.productName||"(sin nombre)";Pt[ue]||(Pt[ue]={totalQuantity:0,totalAmount:0,totalCommission:0}),Pt[ue].totalQuantity=lp(Pt[ue].totalQuantity+(L.quantity||0)),Pt[ue].totalAmount=Fa(Pt[ue].totalAmount+(L.amount||0)),Pt[ue].totalCommission=Fa(Pt[ue].totalCommission+Tt(L))});const Ft=Object.entries(Pt).map(([L,ue])=>({productName:L,category:Ee[UG(L)]||"(sin categora)",totalQuantity:ue.totalQuantity,totalAmount:ue.totalAmount,totalCommission:ue.totalCommission})),Oe=wi.useMemo(()=>{const L={};for(const ue of Ft){const Pe=ue.category||"(sin categora)";L[Pe]||(L[Pe]={category:Pe,rows:[],totalQuantity:0,totalAmount:0,totalCommission:0}),L[Pe].rows.push(ue),L[Pe].totalQuantity=lp(L[Pe].totalQuantity+(ue.totalQuantity||0)),L[Pe].totalAmount=Fa(L[Pe].totalAmount+(ue.totalAmount||0)),L[Pe].totalCommission=Fa(L[Pe].totalCommission+(ue.totalCommission||0))}return Object.values(L).map(ue=>({...ue,rows:[...ue.rows].sort((Pe,xe)=>xe.totalAmount-Pe.totalAmount)})).sort((ue,Pe)=>Pe.totalAmount-ue.totalAmount)},[Ft]),be=L=>{vt(ue=>({...ue,[L]:!ue[L]}))},Ae=async()=>{if(Xe)try{const L=Re.filter(ne=>ne.status==="FLOTANTE");if(L.length===0){f("No hay ventas flotantes para procesar en este perodo.");return}const ue={totalCharged:Fa(L.reduce((ne,Ue)=>ne+(Ue.amount||0),0)),totalSuggested:Fa(L.reduce((ne,Ue)=>ne+(Ue.amountSuggested||0),0)),totalUnits:lp(L.reduce((ne,Ue)=>ne+(Ue.quantity||0),0)),totalCOGS:Fa(L.reduce((ne,Ue)=>ne+Number(Ue.cogsAmount??0),0))},Pe=Fa(ue.totalCharged-ue.totalSuggested),xe=Fa(ue.totalCharged-ue.totalCOGS),Ge=L.reduce((ne,Ue)=>{const tt=Number(Ue.quantity||0),nt=Number(Ue.amount||0),wt=Number(Ue.vendorCommissionAmount||0);return Ue.type==="CREDITO"?(ne.packsCredit+=tt,ne.amountCredit+=nt,ne.comCredit+=wt):(ne.packsCash+=tt,ne.amountCash+=nt,ne.comCash+=wt),ne},{packsCash:0,packsCredit:0,amountCash:0,amountCredit:0,comCash:0,comCredit:0}),ze={totalPacksCash:lp(Ge.packsCash),totalPacksCredit:lp(Ge.packsCredit),totalAmountCash:Fa(Ge.amountCash),totalAmountCredit:Fa(Ge.amountCredit),totalCommissionCash:Fa(Ge.comCash),totalCommissionCredit:Fa(Ge.comCredit)},Ke=await ta(xt(Ne,"daily_closures_candies"),{date:m,createdAt:Nr.now(),periodStart:p,periodEnd:v,totalCharged:ue.totalCharged,totalSuggested:ue.totalSuggested,totalDifference:Pe,totalUnits:ue.totalUnits,totalCOGS:ue.totalCOGS,grossProfit:xe,...ze,products:L.map(ne=>({productName:ne.productName,quantity:ne.quantity,amount:ne.amount})),sales:L.map(ne=>({id:ne.id,productName:ne.productName,quantity:ne.quantity,amount:ne.amount,amountSuggested:ne.amountSuggested,userEmail:ne.userEmail,clientName:ne.clientName,amountReceived:ne.amountReceived,change:ne.change,status:ne.status,cogsAmount:ne.cogsAmount??0,avgUnitCost:ne.avgUnitCost??null,allocations:ne.allocations??[],date:ne.date,type:ne.type??"CONTADO",vendorId:ne.vendorId??"",vendorCommissionAmount:Number(ne.vendorCommissionAmount??0)||0,processedDate:m})),productSummary:Object.entries(L.reduce((ne,Ue)=>{const tt=Ue.productName||"(sin nombre)";return ne[tt]||(ne[tt]={totalQuantity:0,totalAmount:0}),ne[tt].totalQuantity=lp(ne[tt].totalQuantity+(Ue.quantity||0)),ne[tt].totalAmount=Fa(ne[tt].totalAmount+(Ue.amount||0)),ne},{})).map(([ne,Ue])=>({productName:ne,totalQuantity:Ue.totalQuantity,totalAmount:Ue.totalAmount}))}),pt=Lc(Ne);L.forEach(ne=>{pt.update(Kt(Ne,"sales_candies",ne.id.split("#")[0]),{status:"PROCESADA",closureId:Ke.id,closureDate:m,processedDate:m,processedAt:Nr.now()})}),await pt.commit(),f(` Cierre guardado. Ventas procesadas: ${L.length}. (Proceso: ${m})`)}catch(L){console.error(L),f(" Error al guardar el cierre de dulces.")}},Le=async L=>{if(Xe&&window.confirm("Revertir esta venta? Esta accin no se puede deshacer."))try{await Mn(Kt(Ne,"sales_candies",L.split("#")[0]),{status:"FLOTANTE",closureId:null,closureDate:null,processedDate:null,processedAt:null}),f(" Venta revertida a FLOTANTE.")}catch(ue){console.error(ue),f(" No se pudo revertir la venta.")}},ut=L=>{Xe&&(S(L),B(L.quantity),T(L.amount),q(L.clientName),ce(L.amountReceived),he(L.change))},ct=async()=>{if(!(!N||!Xe))try{await Mn(Kt(Ne,"sales_candies",N.id.split("#")[0]),{packagesTotal:E,amount:k,amountCharged:k,clientName:P,amountReceived:de,change:le}),S(null),f(" Venta de dulces actualizada.")}catch(L){console.error(L),f(" No se pudo actualizar la venta de dulces.")}},st=async L=>{if(Xe&&window.confirm("Eliminar esta venta? Se restaurar el stock (paquetes) en los lotes asignados."))try{const ue=L.split("#")[0],{restored:Pe}=await WQe(ue);await IVe(ue),f(` Venta eliminada. Stock restaurado (unidades internas): ${Number(Pe).toFixed(2)}. Estado de cuenta ajustado.`)}catch(ue){console.error(ue),f(" No se pudo eliminar la venta de dulces.")}},z=async()=>{if(ve.current){ve.current.classList.add("force-pdf-colors"),ve.current.classList.add("pdf-print-mode");try{const ue=(await $m(ve.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),Pe=new An;Pe.addImage(ue,"PNG",10,10,190,0),Pe.save(`cierre_dulces_${p}_a_${v}_proc_${m}.pdf`)}finally{ve.current.classList.remove("pdf-print-mode"),ve.current.classList.remove("force-pdf-colors")}}},X=L=>`"${String(L??"").replace(/\"/g,'""')}"`,re=()=>{const L=["id","productName","type","quantity","amount","commissionFromItems","vendorNetUtility","date","processedDate","vendor","status"],ue=Re.map(Ke=>[Ke.id,Ke.productName,Ke.type,Ke.quantity??0,Number(Ke.amount??0).toFixed(2),Number(Ke.commissionFromItems??0).toFixed(2),Number(Ke.vendorNetUtility??0).toFixed(2),Ke.date,Ke.processedDate??"",Ke.userEmail??"",Ke.status]),Pe=[L.join(","),...ue.map(Ke=>Ke.map(X).join(","))].join(`
`),xe=new Blob([Pe],{type:"text/csv;charset=utf-8;"}),Ge=URL.createObjectURL(xe),ze=document.createElement("a");ze.href=Ge,ze.download=`cierre_dulces_${p}_a_${v}.csv`,ze.click(),URL.revokeObjectURL(Ge)},H=()=>{const L=Re.map(pt=>({id:pt.id,productName:pt.productName,type:pt.type,quantity:pt.quantity??0,amount:Number(pt.amount??0).toFixed(2),commissionFromItems:Number(pt.commissionFromItems??0).toFixed(2),vendorNetUtility:Number(pt.vendorNetUtility??0).toFixed(2),date:pt.date,processedDate:pt.processedDate??"",vendor:pt.userEmail??"",status:pt.status})),ue=pa.json_to_sheet(L),Pe=pa.book_new();pa.book_append_sheet(Pe,ue,"Ventas");const xe=I1(Pe,{bookType:"xlsx",type:"array"}),Ge=new Blob([xe],{type:"application/octet-stream"}),ze=URL.createObjectURL(Ge),Ke=document.createElement("a");Ke.href=ze,Ke.download=`cierre_dulces_${p}_a_${v}.xlsx`,Ke.click(),URL.revokeObjectURL(ze)};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("style",{children:`
        .pdf-print-mode .pdf-desktop { display: block !important; }
        .pdf-print-mode .pdf-mobile  { display: none !important; }
        .pdf-print-mode .collapsible-content { display: block !important; }
      `}),i.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Cierre de Ventas de Dulces - Proceso: ",m]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Ce(L=>!L),"aria-expanded":ae,children:[i.jsx("span",{children:"Filtros"}),i.jsx("span",{className:`transition-transform ${ae?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${ae?"block":"hidden"} border-t p-4`,children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-end gap-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Desde:"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:p,onChange:L=>x(L.target.value)})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Hasta:"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:v,onChange:L=>y(L.target.value)})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Filtrar:"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:L=>h(L.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Venta Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Venta Procesada"})]})]}),Xe&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Vendedor:"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:b,onChange:L=>w(L.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),ke.map(L=>i.jsx("option",{value:L.id,children:L.name||L.id},L.id))]})]}),i.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[i.jsx("label",{className:"text-xs md:text-sm whitespace-nowrap",children:"Productos:"}),i.jsxs("select",{className:"border rounded px-2 py-1 text-xs w-full md:w-48 lg:w-56",value:I,onChange:L=>j(L.target.value),disabled:_t.length===0,children:[i.jsx("option",{value:"ALL",children:"Todos"}),_t.map(L=>i.jsx("option",{value:L,children:L},L))]})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>O(L=>!L),"aria-expanded":De,children:[i.jsx("span",{children:"KPIs"}),i.jsx("span",{className:`transition-transform ${De?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${De?"block":"hidden"} border-t p-4`,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-7 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas flotantes"}),i.jsx("div",{className:"text-2xl font-bold",children:dt}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas procesadas"}),i.jsx("div",{className:"text-2xl font-bold",children:Fe}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:je}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsx("div",{className:"text-2xl font-bold",children:We}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-2xl font-bold",children:of(pe)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:of(ie)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash (perodo)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Ya(ye)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito (perodo)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Ya(mt)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>G(L=>!L),"aria-expanded":R,children:[i.jsx("span",{children:"KPIs por vendedor"}),i.jsx("span",{className:`transition-transform ${R?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${R?"block":"hidden"} border-t p-4`,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin CASH del perodo)"}),gt.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:gt.map(L=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:L.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Ya(L.total)]})]},L.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin CRDITO del perodo)"}),yt.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:yt.map(L=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:L.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Ya(L.total)]})]},L.vendorId))})]})]})})]}),c?i.jsx("p",{children:"Cargando ventas..."}):i.jsxs("div",{ref:ve,children:[i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>K(L=>!L),"aria-expanded":M,children:[i.jsx("span",{children:"Transacciones Cash"}),i.jsx("span",{className:`transition-transform ${M?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${M?"block":"hidden"} border-t p-4`,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"U. Vendedor"}),i.jsx("th",{className:"border p-2",children:"U. Neta"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Fecha proceso"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[Te.map(L=>{Tt(L),Lt(L);const ue=(L.processedDate||"").trim();return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${L.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:L.status})}),i.jsx("td",{className:"border p-1",children:L.productName}),i.jsx("td",{className:"border p-1",children:"Cash"}),i.jsx("td",{className:"border p-1",children:of(L.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",Ya(L.amount)]}),i.jsx("td",{className:"border p-1",children:Et(L)>0?`C$${Ya(Et(L))}`:""}),i.jsx("td",{className:"border p-1",children:Rt(L)>0?`C$${Ya(Rt(L))}`:""}),i.jsx("td",{className:"border p-1",children:L.date}),i.jsx("td",{className:"border p-1",children:ue||""}),i.jsx("td",{className:"border p-1",children:L.userEmail}),i.jsx("td",{className:"border p-1",children:L.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2 justify-center",children:Xe?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>ut(L),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>st(L.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):L.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:Xe?i.jsx("button",{onClick:()=>Le(L.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},L.id)}),Te.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-3 text-center text-gray-500",children:"Sin ventas cash para mostrar."})})]})]})}),i.jsxs("div",{className:"pdf-mobile md:hidden space-y-3 mb-4",children:[Te.map(L=>{const ue=Tt(L);Lt(L);const Pe=(L.processedDate||"").trim();return i.jsxs("details",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("summary",{className:"px-4 py-3 flex justify-between items-center cursor-pointer",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:L.productName}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Cash  ",L.date]})]}),i.jsxs("div",{className:"text-right shrink-0 ml-3",children:[i.jsxs("div",{className:"font-bold",children:["C$",Ya(L.amount)]}),i.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${L.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:L.status})]})]}),i.jsxs("div",{className:"px-4 pb-4 pt-2 text-sm space-y-2",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"U. Vendedor"}),i.jsx("strong",{children:Et(L)>0?`C$${Ya(Et(L))}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"U. Neta"}),i.jsx("strong",{children:Rt(L)>0?`C$${Ya(Rt(L))}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("strong",{children:ue>0?`C$${Ya(ue)}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha proceso"}),i.jsx("strong",{children:Pe||""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("strong",{className:"text-right break-all",children:L.userEmail})]}),i.jsx("div",{className:"pt-2",children:L.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2",children:Xe?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>ut(L),className:"flex-1 text-xs bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>st(L.id),className:"flex-1 text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):L.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2",children:Xe?i.jsx("button",{onClick:()=>Le(L.id),className:"w-full text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:"No options"})})]})]},L.id)}),Te.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin ventas cash para mostrar."})]})]})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>D(L=>!L),"aria-expanded":Y,children:[i.jsx("span",{children:"Transacciones Crdito"}),i.jsx("span",{className:`transition-transform ${Y?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${Y?"block":"hidden"} border-t p-4`,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"U. Vendedor"}),i.jsx("th",{className:"border p-2",children:"U. Neta"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Fecha proceso"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[Ye.map(L=>{Tt(L),Lt(L);const ue=(L.processedDate||"").trim();return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${L.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:L.status})}),i.jsx("td",{className:"border p-1",children:L.productName}),i.jsx("td",{className:"border p-1",children:"Crdito"}),i.jsx("td",{className:"border p-1",children:of(L.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",Ya(L.amount)]}),i.jsx("td",{className:"border p-1",children:Et(L)>0?`C$${Ya(Et(L))}`:""}),i.jsx("td",{className:"border p-1",children:Rt(L)>0?`C$${Ya(Rt(L))}`:""}),i.jsx("td",{className:"border p-1",children:L.date}),i.jsx("td",{className:"border p-1",children:ue||""}),i.jsx("td",{className:"border p-1",children:L.userEmail}),i.jsx("td",{className:"border p-1",children:L.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2 justify-center",children:Xe?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>ut(L),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>st(L.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):L.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:Xe?i.jsx("button",{onClick:()=>Le(L.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},L.id)}),Ye.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-3 text-center text-gray-500",children:"Sin ventas crdito para mostrar."})})]})]})}),i.jsxs("div",{className:"pdf-mobile md:hidden space-y-3 mb-4",children:[Ye.map(L=>{const ue=Tt(L),Pe=Lt(L),xe=(L.processedDate||"").trim();return i.jsxs("details",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("summary",{className:"px-4 py-3 flex justify-between items-center cursor-pointer",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:L.productName}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Crdito  ",L.date]})]}),i.jsxs("div",{className:"text-right shrink-0 ml-3",children:[i.jsxs("div",{className:"font-bold",children:["C$",Ya(L.amount)]}),i.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${L.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:L.status})]})]}),i.jsxs("div",{className:"px-4 pb-4 pt-2 text-sm space-y-2",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes"}),i.jsx("strong",{children:of(L.quantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"U. Vendedor"}),i.jsx("strong",{children:Pe>0?`C$${Ya(Pe)}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"U. Vendedor"}),i.jsx("strong",{children:Et(L)>0?`C$${Ya(Et(L))}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"U. Neta"}),i.jsx("strong",{children:Rt(L)>0?`C$${Ya(Rt(L))}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("strong",{children:ue>0?`C$${Ya(ue)}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"U. Vendedor"}),i.jsx("strong",{children:Pe>0?`C$${Ya(Pe)}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha proceso"}),i.jsx("strong",{children:xe||""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("strong",{className:"text-right break-all",children:L.userEmail})]}),i.jsx("div",{className:"pt-2",children:L.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2",children:Xe?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>ut(L),className:"flex-1 text-xs bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>st(L.id),className:"flex-1 text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):L.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2",children:Xe?i.jsx("button",{onClick:()=>Le(L.id),className:"w-full text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:"No options"})})]})]},L.id)}),Ye.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin ventas crdito para mostrar."})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-2 text-sm mb-4",children:[i.jsxs("div",{children:["Total paquetes crdito: ",i.jsx("strong",{children:of(ie)})]}),i.jsxs("div",{children:["Total paquetes cash: ",i.jsx("strong",{children:of(pe)})]}),i.jsxs("div",{children:["Total pendiente crdito:"," ",i.jsxs("strong",{children:["C$",Ya(fe)]})]}),i.jsxs("div",{children:["Total cobrado cash: ",i.jsxs("strong",{children:["C$",Ya(Me)]})]}),i.jsxs("div",{children:["Total comisin: ",i.jsxs("strong",{children:["C$",Ya(me)]})]})]}),(Ve>0||$e!==rt)&&i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm mb-6",children:[i.jsxs("div",{children:["Costo total (COGS): ",i.jsxs("strong",{children:["C$",Ya(Ve)]})]}),i.jsxs("div",{children:["Ganancia antes de gasto:"," ",i.jsxs("strong",{children:["C$",Ya($e)]})]}),i.jsxs("div",{children:["Total paquetes (visibles):"," ",i.jsx("strong",{children:of(ee)})]})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>te(L=>!L),"aria-expanded":V,children:[i.jsx("span",{children:"Consolidado por producto"}),i.jsx("span",{className:`transition-transform ${V?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${V?"block":"hidden"} border-t p-4`,children:i.jsxs("div",{className:"space-y-3",children:[Oe.map(L=>{const ue=!!ot[L.category];return i.jsxs("div",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>be(L.category),"aria-expanded":ue,children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"truncate",children:L.category}),i.jsxs("div",{className:"text-xs text-gray-600",children:[of(L.totalQuantity)," paquetes  C$",Ya(L.totalAmount),"  Comisin"," ",L.totalCommission>0?`C$${Ya(L.totalCommission)}`:""]})]}),i.jsx("span",{className:`transition-transform ${ue?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${ue?"block":"hidden"} border-t p-3`,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-2",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes"}),i.jsx("th",{className:"border p-2",children:"Total dinero"}),i.jsx("th",{className:"border p-2",children:"Comisin"})]})}),i.jsx("tbody",{children:L.rows.map(Pe=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:Pe.productName}),i.jsx("td",{className:"border p-1",children:of(Pe.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",Ya(Pe.totalAmount)]}),i.jsx("td",{className:"border p-1",children:Pe.totalCommission>0?`C$${Ya(Pe.totalCommission)}`:""})]},Pe.productName))})]})}),i.jsx("div",{className:"pdf-mobile md:hidden space-y-2",children:L.rows.map(Pe=>i.jsxs("div",{className:"border rounded-xl bg-white shadow-sm p-3",children:[i.jsx("div",{className:"font-semibold",children:Pe.productName}),i.jsxs("div",{className:"mt-2 text-sm space-y-1",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Total paquetes"}),i.jsx("strong",{children:of(Pe.totalQuantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Total dinero"}),i.jsxs("strong",{children:["C$",Ya(Pe.totalAmount)]})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("strong",{children:Pe.totalCommission>0?`C$${Ya(Pe.totalCommission)}`:""})]})]})]},Pe.productName))})]})]},L.category)}),Oe.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin datos para consolidar."})]})})]})]}),i.jsxs("div",{className:"flex gap-2 mt-4",children:[Xe&&i.jsx("button",{onClick:Ae,className:"bg-blue-600 text-white px-2 py-0.5 text-xs sm:px-4 sm:py-2 rounded hover:bg-blue-700",children:"Procesar"}),i.jsx("button",{onClick:z,className:"bg-green-600 text-white px-2 py-0.5 text-xs sm:px-4 sm:py-2 rounded hover:bg-green-700",children:"PDF"}),i.jsx("button",{onClick:re,className:"bg-gray-700 text-white px-2 py-0.5 text-xs sm:px-4 sm:py-2 rounded hover:bg-gray-800",children:"CSV"}),i.jsx("button",{onClick:H,className:"bg-amber-600 text-white px-2 py-0.5 text-xs sm:px-4 sm:py-2 rounded hover:bg-amber-700",children:"Excel"})]}),u&&i.jsx("p",{className:"mt-2 text-sm",children:u}),N&&Xe&&i.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-4 space-y-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:"Editar venta de dulces"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[N.productName,"  ",N.userEmail]}),i.jsx("label",{className:"text-sm",children:"Paquetes"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:E,onChange:L=>B(parseFloat(L.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Monto cobrado"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:k,onChange:L=>T(parseFloat(L.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Cliente"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:P,onChange:L=>q(L.target.value)}),i.jsx("label",{className:"text-sm",children:"Paga con"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:de,onChange:L=>ce(parseFloat(L.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Vuelto"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:le,onChange:L=>he(L.target.value)}),i.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[i.jsx("button",{onClick:()=>S(null),className:"px-3 py-1 border rounded",children:"Cancelar"}),i.jsx("button",{onClick:ct,className:"px-3 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",children:"Guardar cambios"})]})]})})]})}const Mh=t=>`C$ ${(Number(t)||0).toFixed(2)}`,Pd=t=>Math.round((Number(t)||0)*100)/100;function BVe(t){if(!t)return"";switch(t){case"RIVAS":return"Rivas";case"SAN_JORGE":return"San Jorge";case"ISLA":return"Isla de Ometepe";default:return""}}function kVe(t){return t.toISOString().slice(0,10)}function FVe(){const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-01`}function OVe(){const t=new Date,e=new Date(t.getFullYear(),t.getMonth()+1,1),r=new Date(e.getTime()-24*60*60*1e3);return kVe(r)}function DVe(){const[t,e]=g.useState(FVe()),[r,n]=g.useState(OVe()),[a,s]=g.useState(!1),[o,l]=g.useState(""),[c,d]=g.useState({}),[u,f]=g.useState({}),[A,h]=g.useState([]),[m,p]=g.useState([]),[x,v]=g.useState({}),[y,b]=g.useState(!1),[w,I]=g.useState(null),[j,N]=g.useState(null),S=g.useMemo(()=>w&&A.find(ce=>ce.vendorId===w)||null,[w,A]),E=g.useMemo(()=>{var ce;return!w||!j?[]:((ce=x[w])==null?void 0:ce[j])||[]},[w,j,x]),B=g.useMemo(()=>Pd(A.reduce((ce,le)=>ce+(le.totalSoldMoney||0),0)),[A]),k=g.useMemo(()=>Pd(A.reduce((ce,le)=>ce+(le.totalCreditMoney||0),0)),[A]);g.useEffect(()=>{(async()=>{try{const ce=await Ut(xt(Ne,"sellers_candies")),le={};ce.forEach(Ce=>{const De=Ce.data(),O=De.branch||"Rivas";let R="RIVAS";O==="San Jorge"?R="SAN_JORGE":O==="Isla Ometepe"&&(R="ISLA"),le[Ce.id]={id:Ce.id,name:De.name??"(sin nombre)",branch:R,branchLabel:O,commissionPercent:Number(De.commissionPercent??0)}});const he=await Ut(xt(Ne,"products_candies")),ae={};he.forEach(Ce=>{const De=Ce.data();ae[Ce.id]={id:Ce.id,name:De.name??"(sin nombre)"}}),d(le),f(ae)}catch(ce){console.error(ce),l(" Error cargando catlogos de vendedores/productos.")}})()},[]);const T=async()=>{if(!t||!r){l("Selecciona rango de fechas vlido.");return}if(!Object.keys(c).length){l("Cargando vendedores, intenta de nuevo en unos segundos.");return}s(!0),l("");try{const ce={},le={},he=ar(xt(Ne,"inventory_candies_sellers"),lr("date",">=",t),lr("date","<=",r)),ae=await Ut(he),Ce={},De={},O={},R={};ae.forEach(Se=>{var Me,me;const Ee=Se.data(),Ze=Ee.sellerId||"";if(!Ze)return;const ot=Ee.productId||"",vt=Ee.productName||((Me=u[ot])==null?void 0:Me.name)||"(sin nombre)",_t=Math.max(1,Math.floor(Number(Ee.unitsPerPackage||1))),Tt=Number(Ee.totalUnits??0),Lt=Number(Ee.packages??0),Rt=Number(Ee.remainingUnits??Ee.remaining??0),Et=Number(Ee.remainingPackages??0),Re=Lt>0?Lt:Tt>0?Math.floor(Tt/_t):0,Te=Et>0?Et:Rt>0?Math.floor(Rt/_t):0;Ce[Ze]=(Ce[Ze]||0)+Re,De[Ze]=(De[Ze]||0)+Te;const Ye=Ee.orderId||Ee.vendorOrderId||Ee.orderNumber||Ee.order||Se.id;O[Ze]||(O[Ze]=new Set),O[Ze].add(Ye);const dt=((me=c[Ze])==null?void 0:me.name)||Ee.sellerName||"(sin vendedor)",Fe=String(Ee.date||""),je=Number(Ee.totalVendor??0),We=Number(Ee.gainVendor??0),ee=Lt>0?Lt:Tt>0?Math.floor(Tt/_t):0,Ve=ee>0?je/ee:0,rt=ee>0?We/ee:0,$e=Pd(Re*Ve),ie=Pd(Re*rt),pe=Pd(Te*Ve),fe=Pd(Te*rt);R[Ze]||(R[Ze]={ordered:[],remaining:[]}),Re>0&&R[Ze].ordered.push({date:Fe,vendorName:dt,productName:vt,packages:Re,totalMoney:$e,vendorCommission:ie}),Te>0&&R[Ze].remaining.push({date:Fe,vendorName:dt,productName:vt,packages:Te,totalMoney:pe,vendorCommission:fe})});const G={};Object.keys(O).forEach(Se=>{G[Se]=O[Se].size});const M=ar(xt(Ne,"sales_candies"),lr("date",">=",t),lr("date","<=",r)),K=await Ut(M),Y={},D={},V={},te={},ve={},Q={};K.forEach(Se=>{const Ee=Se.data(),Ze=Ee.date||"",ot=Ee.vendorId||Ee.sellerId||"";if(!ot)return;const vt=c[ot],_t=Ee.vendorName||(vt==null?void 0:vt.name)||"(sin vendedor)",Tt=Number(Ee.vendorCommissionPercent??(vt==null?void 0:vt.commissionPercent)??0)||0,Lt=Array.isArray(Ee.items)?Ee.items:[];if(!Lt.length)return;const Rt=String(Ee.type||"").toUpperCase()==="CREDITO";ve[ot]||(ve[ot]={sold:[],credit:[]}),Lt.forEach(Et=>{var $e;const Re=Et.productName||(($e=u[Et.productId||""])==null?void 0:$e.name)||"(sin nombre)",Te=Et.packages??Et.qty??Et.quantity??0,Ye=Number(Te||0);if(Ye<=0)return;const dt=Number(Et.unitPricePackage??Et.unitPrice??0)||0,Fe=Math.max(0,Number(Et.discount||0)),je=Ye*dt,We=Pd(Math.max(0,je-Fe));if(We<=0)return;console.log("DBG",{isCredit:Rt,vendorId:ot,commissionPercent:Tt,lineFinal:We,storedItemCommission:Number(Et.vendorCommissionAmount??0)});let ee=0;const Ve=Number(Et.vendorCommissionAmount??0);Ve?ee=Pd(Ve):Tt>0&&(ee=Pd(We*Tt/100)),Rt?(D[ot]=(D[ot]||0)+Ye,te[ot]=(te[ot]||0)+We):(Y[ot]=(Y[ot]||0)+Ye,V[ot]=(V[ot]||0)+We),Rt?le[ot]=(le[ot]||0)+ee:ce[ot]=(ce[ot]||0)+ee,Rt?ve[ot].credit.push({date:Ze,vendorName:_t,productName:Re,packages:Ye,totalMoney:We,vendorCommission:0}):ve[ot].sold.push({date:Ze,vendorName:_t,productName:Re,packages:Ye,totalMoney:We,vendorCommission:ee});const rt=Re;Q[rt]||(Q[rt]={productName:Re,packages:0,totalMoney:0}),Q[rt].packages+=Ye,Q[rt].totalMoney+=We})});const Xe=new Set([...Object.keys(Ce),...Object.keys(De),...Object.keys(Y),...Object.keys(D)]),se=[],Z={};Xe.forEach(Se=>{var Te,Ye,dt,Fe;const Ee=c[Se],Ze=(Ee==null?void 0:Ee.name)||"(sin vendedor)",ot=Ee?Ee.branchLabel||BVe(Ee.branch):"",vt=Ce[Se]||0,_t=De[Se]||0,Tt=Y[Se]||0,Lt=D[Se]||0,Rt=Pd(V[Se]||0),Et=Pd(te[Se]||0),Re=G[Se]||0;se.push({vendorId:Se,vendorName:Ze,branchLabel:ot,orderedPackages:vt,remainingPackages:_t,soldPackages:Tt,creditPackages:Lt,totalSoldMoney:Rt,totalCreditMoney:Et,ordersCreated:Re,commissionCash:Pd(ce[Se]||0),commissionCredit:0}),Z[Se]={ordered:(((Te=R[Se])==null?void 0:Te.ordered)||[]).sort((je,We)=>je.date.localeCompare(We.date)),remaining:(((Ye=R[Se])==null?void 0:Ye.remaining)||[]).sort((je,We)=>je.date.localeCompare(We.date)),sold:(((dt=ve[Se])==null?void 0:dt.sold)||[]).sort((je,We)=>je.date.localeCompare(We.date)),credit:(((Fe=ve[Se])==null?void 0:Fe.credit)||[]).sort((je,We)=>je.date.localeCompare(We.date))}}),se.sort((Se,Ee)=>Se.vendorName.localeCompare(Ee.vendorName,"es")),h(se),v(Z);const ke=Object.values(Q).map(Se=>({productName:Se.productName,packages:Se.packages,totalMoney:Pd(Se.totalMoney)})).sort((Se,Ee)=>Ee.packages-Se.packages).slice(0,10);p(ke),se.length||l("Sin datos para el rango seleccionado.")}catch(ce){console.error(ce),l(" Error cargando consolidado de vendedores.")}finally{s(!1)}};g.useEffect(()=>{Object.keys(c).length&&T()},[c]);const P=(ce,le)=>{I(ce),N(le),b(!0)},q=()=>{b(!1),I(null),N(null)},de=()=>{if(!A.length){l("No hay datos para exportar.");return}const ce=["Vendedor","Sucursal","Paquetes ordenados","Paquetes restantes","Paquetes vendidos","Paquetes fiados","Total vendidos (C$)","Comisin Cash (C$)","Total fiado (C$)","Comisin Crdito (C$)","rdenes creadas"],le=A.map(O=>[O.vendorName,O.branchLabel,O.orderedPackages.toString(),O.remainingPackages.toString(),O.soldPackages.toString(),O.creditPackages.toString(),O.totalSoldMoney.toFixed(2),O.commissionCash.toFixed(2),O.totalCreditMoney.toFixed(2),O.commissionCredit.toFixed(2),O.ordersCreated.toString()]),he=[ce,...le].map(O=>O.map(R=>`"${String(R).replace(/"/g,'""')}"`).join(",")).join(`
`),ae=new Blob([he],{type:"text/csv;charset=utf-8;"}),Ce=URL.createObjectURL(ae),De=document.createElement("a");De.href=Ce,De.download=`consolidado_vendedores_dulces_${t}_a_${r}.csv`,De.click(),URL.revokeObjectURL(Ce)};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Consolidado por Vendedor - Dulces"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:t,onChange:ce=>e(ce.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:r,onChange:ce=>n(ce.target.value)})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{type:"button",onClick:T,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",disabled:a,children:a?"Cargando...":"Aplicar filtros"})}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{type:"button",onClick:de,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 w-full",children:"Exportar CSV"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 text-sm",children:[i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Mh(B)})]}),i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas Credito"}),i.jsx("div",{className:"text-xl font-semibold",children:Mh(k)})]}),i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Vendedores con Inventario"}),i.jsx("div",{className:"text-xl font-semibold",children:A.length})]})]}),i.jsx("div",{className:"overflow-x-auto mb-6",children:i.jsxs("table",{className:"min-w-full border text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes ordenados"}),i.jsx("th",{className:"border p-2",children:"Paquetes restantes"}),i.jsx("th",{className:"border p-2",children:"Paquetes vendidos"}),i.jsx("th",{className:"border p-2",children:"Paquetes fiados"}),i.jsx("th",{className:"border p-2",children:"Total vendidos (C$)"}),i.jsx("th",{className:"border p-2",children:"Comisin Cash (C$)"}),i.jsx("th",{className:"border p-2",children:"Total fiado (C$)"}),i.jsx("th",{className:"border p-2",children:"Comisin Crdito (C$)"}),i.jsx("th",{className:"border p-2",children:"rdenes creadas"})]})}),i.jsxs("tbody",{children:[A.map(ce=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ce.vendorName}),i.jsx("td",{className:"border p-1",children:ce.branchLabel}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>P(ce.vendorId,"ordered"),children:ce.orderedPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>P(ce.vendorId,"remaining"),children:ce.remainingPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>P(ce.vendorId,"sold"),children:ce.soldPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>P(ce.vendorId,"credit"),children:ce.creditPackages})}),i.jsx("td",{className:"border p-1",children:Mh(ce.totalSoldMoney)}),i.jsx("td",{className:"border p-1",children:Mh(ce.commissionCash)}),i.jsx("td",{className:"border p-1",children:Mh(ce.totalCreditMoney)}),i.jsx("td",{className:"border p-1",children:Mh(ce.commissionCredit)}),i.jsx("td",{className:"border p-1",children:ce.ordersCreated})]},ce.vendorId)),A.length===0&&!a&&i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-3 text-center text-gray-500",children:"Sin datos para mostrar."})})]})]})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"font-semibold mb-2 text-sm",children:"Top 10 productos ms vendidos (paquetes)"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-xs shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"#"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Paquetes vendidos"}),i.jsx("th",{className:"border p-2",children:"Total dinero (C$)"})]})}),i.jsxs("tbody",{children:[m.map((ce,le)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:le+1}),i.jsx("td",{className:"border p-1",children:ce.productName}),i.jsx("td",{className:"border p-1",children:ce.packages}),i.jsx("td",{className:"border p-1",children:Mh(ce.totalMoney)})]},ce.productName)),m.length===0&&!a&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin productos para mostrar."})})]})]})})]}),o&&i.jsx("p",{className:"mt-2 text-sm text-gray-700",children:o}),y&&j&&w&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-[95%] max-w-4xl max-h-[90vh] flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"font-semibold text-lg",children:["Detalle"," ",j==="ordered"?"Paquetes ordenados":j==="remaining"?"Paquetes restantes":j==="sold"?"Paquetes vendidos":"Paquetes fiados"]}),i.jsxs("p",{className:"text-xs text-gray-500",children:[S==null?void 0:S.vendorName,"  ",S==null?void 0:S.branchLabel]})]}),i.jsx("button",{onClick:q,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 text-sm",children:"Cerrar"})]}),i.jsx("div",{className:"flex-1 overflow-auto p-4",children:i.jsxs("table",{className:"min-w-full border text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Total dinero (C$)"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Comisin vendedor (C$)"})]})}),i.jsxs("tbody",{children:[E.map((ce,le)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ce.date}),i.jsx("td",{className:"border p-1",children:ce.productName}),i.jsx("td",{className:"border p-1",children:ce.packages}),i.jsx("td",{className:"border p-1",children:Mh(ce.totalMoney)}),i.jsx("td",{className:"border p-1",children:ce.vendorName}),i.jsx("td",{className:"border p-1",children:Mh(ce.vendorCommission)})]},le)),E.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-3 text-center text-gray-500",children:"Sin registros para mostrar."})})]})]})})]})})]})}const ac=t=>`C$${Number(t||0).toFixed(2)}`,v_=t=>Number(t||0).toFixed(3),vT=()=>{const t=new Date;return Kr(new Date(t.getFullYear(),t.getMonth(),1),"yyyy-MM-dd")},y_=()=>Kr(new Date,"yyyy-MM-dd");function RVe({transactions:t=[],onClose:e,onCreated:r}){const n=Array.isArray(t)?t:[],[a,s]=g.useState([]),o=g.useMemo(()=>{const ie={};return a.forEach(pe=>{pe.email&&(ie[pe.email.trim().toLowerCase()]=pe)}),ie},[a]);g.useEffect(()=>{(async()=>{try{const ie=ar(xt(Ne,"sellers_candies"),kn("name","asc")),pe=await Ut(ie),fe=[];pe.forEach(Me=>{const me=Me.data();fe.push({id:Me.id,name:me.name||"",email:me.email||"",commissionPercent:Number(me.commissionPercent||0)})}),s(fe)}catch(ie){console.error(ie)}})()},[]);const[l,c]=g.useState(vT()),[d,u]=g.useState(y_()),[f,A]=g.useState(""),[h,m]=g.useState(""),p=g.useMemo(()=>{const ie=new Map;return n.forEach(pe=>{const fe=pe.productId||pe.productName;ie.set(fe,{key:fe,name:pe.productName})}),Array.from(ie.values()).sort((pe,fe)=>pe.name.localeCompare(fe.name))},[n]),x=g.useMemo(()=>{const ie=new Map;return n.forEach(pe=>{const fe=(pe.sellerEmail||"").trim().toLowerCase();if(!fe)return;const Me=o[fe],me=(Me==null?void 0:Me.name)||pe.vendorName||fe;ie.set(fe,{email:fe,label:me})}),Array.from(ie.values()).sort((pe,fe)=>pe.label.localeCompare(fe.label))},[n,o]),v=g.useMemo(()=>n.filter(ie=>!(l&&ie.date<l||d&&ie.date>d||f&&(ie.productId||ie.productName)!==f||h&&(ie.sellerEmail||"").trim().toLowerCase()!==h)),[n,l,d,f,h]),[y,b]=g.useState(y_()),[w,I]=g.useState(()=>`FAC-CANDY-${Date.now().toString().slice(-6)}`),[j,N]=g.useState(""),[S,E]=g.useState("0"),[B,k]=g.useState(()=>v.map(ie=>ie.id));g.useEffect(()=>{k(ie=>ie.filter(pe=>v.some(fe=>fe.id===pe)))},[v]);const[T,P]=g.useState([]),[q,de]=g.useState([]),[ce,le]=g.useState(!1),[he,ae]=g.useState(vT()),[Ce,De]=g.useState(y_());g.useEffect(()=>{(async()=>{try{le(!0);const ie=ar(xt(Ne,"expensesCandies"),kn("date","desc")),pe=await Ut(ie),fe=[];pe.forEach(Me=>{const me=Me.data();fe.push({id:Me.id,date:me.date,description:me.description,amount:Number(me.amount||0)})}),P(fe)}catch(ie){console.error(ie)}finally{le(!1)}})()},[]);const O=g.useMemo(()=>T.filter(ie=>!(!ie.date||he&&ie.date<he||Ce&&ie.date>Ce)),[T,he,Ce]),[R,G]=g.useState([]),[M,K]=g.useState(!1),[Y,D]=g.useState(""),[V,te]=g.useState("DEBITO"),[ve,Q]=g.useState(""),Xe=()=>{const ie=Number(ve);!Y.trim()||!isFinite(ie)||ie<=0||(G(pe=>[...pe,{id:`${Date.now()}_${pe.length+1}`,description:Y.trim(),type:V,amount:Number(ie.toFixed(2))}]),D(""),Q(""))},[se,Z]=g.useState(null),[ke,Se]=g.useState(""),[Ee,Ze]=g.useState("DEBITO"),[ot,vt]=g.useState(""),_t=ie=>{Z(ie.id),Se(ie.description),Ze(ie.type),vt(ie.amount.toFixed(2))},Tt=()=>{Z(null),Se(""),Ze("DEBITO"),vt("")},Lt=()=>{if(!se)return;const ie=Number(ot);!isFinite(ie)||ie<=0||(G(pe=>pe.map(fe=>fe.id===se?{...fe,description:ke.trim(),type:Ee,amount:Number(ie.toFixed(2))}:fe)),Tt())},Rt=ie=>{G(pe=>pe.filter(fe=>fe.id!==ie)),se===ie&&Tt()},Et=(ie,pe)=>{k(fe=>pe?[...new Set([...fe,ie])]:fe.filter(Me=>Me!==ie))},Re=ie=>{k(ie?v.map(pe=>pe.id):[])},Te=(ie,pe)=>{de(fe=>pe?[...new Set([...fe,ie])]:fe.filter(Me=>Me!==ie))},Ye=g.useMemo(()=>v.filter(ie=>B.includes(ie.id)),[v,B]),dt=g.useMemo(()=>R.filter(ie=>ie.type==="DEBITO").reduce((ie,pe)=>ie+pe.amount,0),[R]),Fe=g.useMemo(()=>R.filter(ie=>ie.type==="CREDITO").reduce((ie,pe)=>ie+pe.amount,0),[R]),je=g.useMemo(()=>{let ie=0,pe=0,fe=0,Me=0;for(const Pt of Ye){const Ft=Number(Pt.packages||0),Oe=Number(Pt.cogsAmount||0),be=Number(Pt.amount||0);ie+=Ft,pe+=Oe,fe+=be;const Ae=(Pt.sellerEmail||"").trim().toLowerCase(),Le=o[Ae],ut=Number((Le==null?void 0:Le.commissionPercent)||0),ct=be*ut/100;Me+=ct}const me=O.filter(Pt=>q.includes(Pt.id)).reduce((Pt,Ft)=>Pt+Number(Ft.amount||0),0),ye=fe-pe,mt=fe-me-dt+Fe-Me,gt=Number(S||0),yt=fe*gt/100;return{totalPackages:Number(v_(ie)),totalProvider:Number(pe.toFixed(2)),totalSale:Number(fe.toFixed(2)),totalGastos:Number(me.toFixed(2)),debits:Number(dt.toFixed(2)),credits:Number(Fe.toFixed(2)),grossProfit:Number(ye.toFixed(2)),finalAmount:Number(mt.toFixed(2)),totalCommissionVendors:Number(Me.toFixed(2)),branchProfit:Number(yt.toFixed(2)),branchFactor:gt}},[Ye,O,q,dt,Fe,o,S]),[We,ee]=g.useState(!1),[Ve,rt]=g.useState(""),$e=async()=>{if(rt(""),Ye.length===0){rt("Selecciona al menos 1 transaccin procesada.");return}try{ee(!0);const ie={number:w.trim(),date:y,description:j.trim(),status:"PENDIENTE",createdAt:Nr.now(),totalPackages:je.totalPackages,totalProvider:je.totalProvider,totalSale:je.totalSale,totalExpenses:je.totalGastos,totalDebits:je.debits,totalCredits:je.credits,grossProfit:je.grossProfit,totalCommissionVendors:je.totalCommissionVendors,branchFactorPercent:je.branchFactor,branchProfit:je.branchProfit,finalAmount:je.finalAmount,transactions:Ye.map(pe=>{const fe=Number(pe.packages||0)||1,Me=Number(pe.cogsAmount||0),me=Number(pe.amount||0),ye=Me/fe,mt=me/fe,gt=(pe.sellerEmail||"").trim().toLowerCase(),yt=o[gt],Pt=Number((yt==null?void 0:yt.commissionPercent)||0),Ft=me*Pt/100;return{id:pe.id,date:pe.date,productId:pe.productId||null,productName:pe.productName,vendorName:pe.vendorName,sellerEmail:pe.sellerEmail||null,packages:Number(v_(pe.packages)),providerPricePack:Number(ye.toFixed(4)),salePricePack:Number(mt.toFixed(4)),totalProvider:Number(Me.toFixed(2)),totalSale:Number(me.toFixed(2)),commissionPercent:Pt,commissionAmount:Number(Ft.toFixed(2))}}),expenses:O.filter(pe=>q.includes(pe.id)).map(pe=>({id:pe.id,date:pe.date||null,description:pe.description||"",amount:Number(Number(pe.amount||0).toFixed(2))})),adjustments:R.map(pe=>({id:pe.id,description:pe.description,type:pe.type,amount:Number(pe.amount.toFixed(2))}))};await ta(xt(Ne,"invoicesCandies"),ie),rt(" Factura de dulces creada."),r()}catch(ie){console.error(ie),rt(` Error al crear factura: ${(ie==null?void 0:ie.message)||"desconocido"}`)}finally{ee(!1)}};return i.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:[i.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-xl shadow-xl p-4 md:p-6 max-h-[90vh] overflow-auto relative",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Crear factura CandyShop"}),i.jsx("button",{onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:y,onChange:ie=>b(ie.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Nmero"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:w,onChange:ie=>I(ie.target.value),placeholder:"FAC-CANDY-001"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Factor sucursal (%)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:S,onChange:ie=>E(ie.target.value),placeholder:"Ej: 30"}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Se aplica sobre el total de ventas para calcular la ganancia de sucursal."})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Descripcin"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:j,onChange:ie=>N(ie.target.value),placeholder:"Comentarios de la factura"})]})]}),i.jsx("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:i.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Desde (transaccin)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:l,onChange:ie=>c(ie.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Hasta (transaccin)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:ie=>u(ie.target.value)})]}),i.jsxs("div",{className:"min-w-[180px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:f,onChange:ie=>A(ie.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),p.map(ie=>i.jsx("option",{value:ie.key,children:ie.name},ie.key))]})]}),i.jsxs("div",{className:"min-w-[180px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:h,onChange:ie=>m(ie.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),x.map(ie=>i.jsx("option",{value:ie.email,children:ie.label},ie.email))]})]}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{c(vT()),u(y_()),A(""),m("")},children:"Quitar filtro"})]})}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Transacciones procesadas"}),i.jsxs("label",{className:"text-sm flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:v.length>0&&B.length===v.length,onChange:ie=>Re(ie.target.checked)}),"Seleccionar todas (sobre el filtro)"]})]}),v.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay transacciones procesadas en el filtro actual."}):i.jsx("div",{className:"border rounded max-h-80 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total proveedor"}),i.jsx("th",{className:"p-2 border",children:"Total venta"}),i.jsx("th",{className:"p-2 border",children:"Comisin venta"})]})}),i.jsx("tbody",{children:v.map(ie=>{const pe=B.includes(ie.id),fe=Number(ie.packages||0)||1,Me=Number(ie.cogsAmount||0),me=Number(ie.amount||0),ye=Me/fe,mt=me/fe,gt=(ie.sellerEmail||"").trim().toLowerCase(),yt=o[gt],Pt=Number((yt==null?void 0:yt.commissionPercent)||0),Ft=me*Pt/100;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:pe,onChange:Oe=>Et(ie.id,Oe.target.checked)})}),i.jsx("td",{className:"p-2 border",children:ie.date}),i.jsx("td",{className:"p-2 border",children:(yt==null?void 0:yt.name)||ie.vendorName}),i.jsx("td",{className:"p-2 border",children:ie.productName}),i.jsx("td",{className:"p-2 border",children:v_(ie.packages)}),i.jsx("td",{className:"p-2 border",children:ac(ye)}),i.jsx("td",{className:"p-2 border",children:ac(mt)}),i.jsx("td",{className:"p-2 border",children:ac(Me)}),i.jsx("td",{className:"p-2 border",children:ac(me)}),i.jsx("td",{className:"p-2 border",children:Pt>0?`${ac(Ft)} (${Pt.toFixed(2)}%)`:""})]},ie.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Gastos a incluir (opcional)"}),ce&&i.jsx("span",{className:"text-xs text-gray-500",children:"Cargando"}),i.jsxs("div",{className:"ml-auto flex items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:he,onChange:ie=>ae(ie.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:Ce,onChange:ie=>De(ie.target.value)})]})]})]}),O.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay gastos en el rango seleccionado."}):i.jsx("div",{className:"border rounded max-h-48 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:O.map(ie=>{const pe=q.includes(ie.id);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:pe,onChange:fe=>Te(ie.id,fe.target.checked)})}),i.jsx("td",{className:"p-2 border",children:ie.date||""}),i.jsx("td",{className:"p-2 border",children:ie.description||""}),i.jsx("td",{className:"p-2 border",children:ac(Number(ie.amount||0))})]},ie.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Notas Crdito/Dbito (Cargos extras)"}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>K(!0),children:"Crear Cargo"})]}),R.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cargos agregados."}):i.jsx("div",{className:"border rounded max-h-40 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:R.map(ie=>{const pe=se===ie.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:pe?i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[70px]",value:ke,onChange:fe=>Se(fe.target.value)}):i.jsx("span",{title:ie.description,children:ie.description.length>60?`${ie.description.slice(0,60)}`:ie.description})}),i.jsx("td",{className:"p-2 border",children:pe?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Ee,onChange:fe=>Ze(fe.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ie.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:ie.type})}),i.jsx("td",{className:"p-2 border",children:pe?i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1 text-right",value:ot,onChange:fe=>vt(fe.target.value)}):ac(ie.amount)}),i.jsx("td",{className:"p-2 border",children:pe?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:Lt,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:Tt,children:"Cancelar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>Rt(ie.id),children:"Eliminar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 text-xs",onClick:()=>_t(ie),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>Rt(ie.id),children:"Eliminar"})]})})]},ie.id)})})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-4 justify-between",children:[i.jsx("div",{className:"space-y-1",children:i.jsxs("div",{children:["Total paquetes: ",i.jsx("strong",{children:v_(je.totalPackages)})]})}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Total proveedor (costo):"," ",i.jsx("strong",{children:ac(je.totalProvider)})]}),i.jsxs("div",{children:["Total venta: ",i.jsx("strong",{children:ac(je.totalSale)})]}),i.jsxs("div",{children:["Ganancia bruta (venta  costo):"," ",i.jsx("strong",{children:ac(je.grossProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:ac(je.totalGastos)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:ac(je.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:ac(je.credits)})]}),i.jsxs("div",{children:["Comisin total vendedores:"," ",i.jsx("strong",{children:ac(je.totalCommissionVendors)})]}),i.jsxs("div",{children:["Ganancia sucursal (ventas  factor):"," ",i.jsx("strong",{children:ac(je.branchProfit)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded text-center font-semibold text-lg",children:["Monto final (ventas  gastos  dbitos + crditos  comisin vendedores):"," ",i.jsx("span",{className:"text-blue-700",children:ac(je.finalAmount)})]})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{disabled:We,onClick:$e,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",children:We?"Creando":"Crear factura"}),i.jsx("button",{onClick:e,className:"px-4 py-2 border rounded",children:"Cancelar"}),Ve&&i.jsx("span",{className:"text-sm ml-2",children:Ve})]}),We&&i.jsxs("div",{className:"absolute inset-0 z-[11000] bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Creando factura"})]})]}),M&&i.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg_WHITE w-full max-w-lg rounded-xl shadow-xl p-4",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx("h4",{className:"font-semibold",children:"Nuevo cargo"}),i.jsx("button",{className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",onClick:()=>K(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[90px]",value:Y,onChange:ie=>D(ie.target.value),placeholder:"Detalle del cargo"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Tipo de cargo"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:V,onChange:ie=>te(ie.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:ve,onChange:ie=>Q(ie.target.value),placeholder:"0.00"})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:Xe,children:"Agregar"})})]})]})})]})}const ls=t=>`C$ ${Number(t??0).toFixed(2)}`,b_=t=>Number(t??0).toFixed(3);function yT(t){const e=t.transactions||[];let r=Number(t.totalPackages??0),n=Number(t.totalProvider??0),a=Number(t.totalSale??0),s=Number(t.totalCommissionVendors??0);if(e.length>0&&(a===0||r===0)){r=0,n=0,a=0,s=0;for(const v of e){const y=Number(v.packages??0);r+=y,n+=Number(v.totalProvider??y*(v.providerPricePack??0)),a+=Number(v.totalSale??y*(v.salePricePack??0));const b=v.commissionAmount??Number(v.totalSale??0)*Number(v.commissionPercent??0)/100;s+=Number(b||0)}}const o=t.expenses||[],l=t.adjustments||[],c=t.totalExpenses!==void 0?Number(t.totalExpenses):o.reduce((v,y)=>v+Number(y.amount||0),0),d=l.filter(v=>v.type==="DEBITO").reduce((v,y)=>v+Number(y.amount||0),0),u=l.filter(v=>v.type==="CREDITO").reduce((v,y)=>v+Number(y.amount||0),0),f=t.totalDebits!==void 0?Number(t.totalDebits):d,A=t.totalCredits!==void 0?Number(t.totalCredits):u,h=a-n,m=Number(t.branchFactorPercent??0),p=t.branchProfit!==void 0?Number(t.branchProfit):Number((h*m/100).toFixed(2)),x=t.finalAmount!==void 0?Number(t.finalAmount):a-s-c-f+A;return{totalPackages:r,totalProvider:n,totalSale:a,commissionTotal:s,expenses:c,debits:f,credits:A,grossProfit:h,branchProfit:p,finalAmount:x}}function QG(t){const e=t.transactions||[];if(e.length===0)return"";const r=Array.from(new Set(e.map(n=>n.vendorName||"Sin nombre")));return r.length===1?r[0]:"Varios"}function MVe(){const[t,e]=g.useState([]),[r,n]=g.useState(!0),[a,s]=g.useState(null),o=g.useRef(null),[l,c]=g.useState(!1),d=async()=>{n(!0);const h=ar(xt(Ne,"invoicesCandies"),kn("date","desc")),m=await Ut(h),p=[];m.forEach(x=>{const v=x.data();p.push({id:x.id,date:v.date,number:v.number,description:v.description,status:v.status||"PENDIENTE",totalPackages:v.totalPackages||0,totalProvider:v.totalProvider||0,totalSale:v.totalSale||0,totalExpenses:v.totalExpenses||0,totalDebits:v.totalDebits||0,totalCredits:v.totalCredits||0,totalCommissionVendors:v.totalCommissionVendors||0,finalAmount:v.finalAmount||0,branchFactorPercent:v.branchFactorPercent||0,branchProfit:v.branchProfit||0,transactions:(v.transactions||[]).map(y=>({id:y.id,date:y.date,vendorId:y.vendorId||null,vendorName:y.vendorName||"Sin nombre",sellerEmail:y.sellerEmail||null,productId:y.productId,productName:y.productName||"Sin nombre",packages:Number(y.packages||0),providerPricePack:Number(y.providerPricePack||0),salePricePack:Number(y.salePricePack||0),totalProvider:Number(y.totalProvider||0),totalSale:Number(y.totalSale||0),commissionPercent:Number(y.commissionPercent||0),commissionAmount:Number(y.commissionAmount||0)})),expenses:(v.expenses||[]).map(y=>({id:y.id,description:y.description||"",date:y.date||null,amount:Number(y.amount||0)})),adjustments:(v.adjustments||[]).map(y=>({id:y.id,description:y.description||"",type:y.type||"DEBITO",amount:Number(y.amount||0)}))})}),e(p),n(!1)};g.useEffect(()=>{d()},[]);const u=async h=>{const m=h.status==="PAGADA"?"PENDIENTE":"PAGADA";await Mn(Kt(Ne,"invoicesCandies",h.id),{status:m}),e(p=>p.map(x=>x.id===h.id?{...x,status:m}:x)),(a==null?void 0:a.id)===h.id&&s({...h,status:m})},f=async h=>{if(window.confirm(`Eliminar factura del ${h.date}?`))try{await na(Kt(Ne,"invoicesCandies",h.id)),e(m=>m.filter(p=>p.id!==h.id)),(a==null?void 0:a.id)===h.id&&s(null)}catch(m){console.error(m),alert("No se pudo eliminar la factura.")}},A=async()=>{if(!o.current||!a)return;const h=o.current,m=await $m(h,{backgroundColor:"#ffffff",onclone:b=>{const w=b.body;w.style.background="#ffffff",w.querySelectorAll("*").forEach(I=>{const j=b.defaultView.getComputedStyle(I);j.boxShadow&&j.boxShadow!=="none"&&(I.style.boxShadow="none")})},scale:2}),p=m.toDataURL("image/png"),x=new An("p","mm","a4"),v=x.internal.pageSize.getWidth(),y=m.height*v/m.width;x.addImage(p,"PNG",0,0,v,y),x.save(`factura_candy_${a.number||a.date}.pdf`)};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded shadow",children:[i.jsxs("div",{className:"flex items-center mb-4 gap-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Facturacin CandyShop"}),i.jsx("button",{className:"ml-auto bg-blue-600 text-white px-4 py-2 rounded-2xl hover:bg-blue-700 text-sm",onClick:()=>c(!0),children:"Crear factura Candy"})]}),l&&i.jsx(RVe,{onClose:()=>c(!1),onCreated:()=>{c(!1),d()}}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"N factura"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Sub total (sin gastos/ajustes)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Gastos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Dbitos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Crditos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Estado"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):t.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin facturas"})}):t.map(h=>{const m=yT(h),p=QG(h);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.number||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:p}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ls(m.commissionTotal)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:b_(m.totalPackages)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ls(m.totalSale)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ls(m.expenses)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ls(m.debits)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ls(m.credits)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ls(m.finalAmount)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h.status==="PAGADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:h.status})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",onClick:()=>s(h),children:"Ver"}),i.jsx("button",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",onClick:()=>u(h),children:h.status==="PAGADA"?"Marcar PENDIENTE":"Marcar PAGADA"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>f(h),children:"Eliminar"})]})})]},h.id)})})]})}),a&&i.jsxs("div",{ref:o,className:"bg-white p-4 rounded shadow-2xl",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsxs("h3",{className:"text-lg font-semibold",children:["Detalle ",a.date," ",a.number?` ${a.number}`:""]}),i.jsx("button",{className:"ml-auto px-3 py-1 border rounded",onClick:()=>s(null),children:"Cerrar"}),i.jsx("button",{onClick:A,className:"bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Imprimir PDF"})]}),(()=>{const h=yT(a),m=QG(a);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Estado:"})," ",a.status]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Vendedor:"})," ",m]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes:"})," ",b_(h.totalPackages)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total proveedor:"})," ",ls(h.totalProvider)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Sub total ventas:"})," ",ls(h.totalSale)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia bruta:"})," ",ls(h.grossProfit)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Comisin vendedores:"})," ",ls(h.commissionTotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Gastos:"})," ",ls(h.expenses)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Dbitos:"})," ",ls(h.debits)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Crditos:"})," ",ls(h.credits)]})]})]})})(),i.jsx("h4",{className:"font-semibold mb-1",children:"Transacciones"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total venta"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin venta"})]})}),i.jsx("tbody",{children:(a.transactions||[]).length>0?(a.transactions||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.productName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:b_(h.packages)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ls(h.providerPricePack)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ls(h.salePricePack)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ls(h.totalProvider)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ls(h.totalSale)}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:[ls(h.commissionAmount||0),h.commissionPercent?` (${h.commissionPercent.toFixed(2)}%)`:""]})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin transacciones"})})})]})}),i.jsx("h4",{className:"font-semibold mb-1",children:"Gastos"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descripcin"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"})]})}),i.jsx("tbody",{children:(a.expenses||[]).length>0?(a.expenses||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.description||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ls(h.amount)})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin gastos"})})})]})}),i.jsx("h4",{className:"font-semibold mb-1",children:"Cargos extras (Notas crdito/dbito)"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descripcin"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo de cargo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"})]})}),i.jsx("tbody",{children:(a.adjustments||[]).length>0?(a.adjustments||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.description}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:h.type})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ls(h.amount)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:a.date})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin cargos extras"})})})]})}),(()=>{const h=yT(a);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-2 justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:["Total paquetes: ",i.jsx("strong",{children:b_(h.totalPackages)})]}),i.jsxs("div",{children:["Total proveedor: ",i.jsx("strong",{children:ls(h.totalProvider)})]})]}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Sub total ventas: ",i.jsx("strong",{children:ls(h.totalSale)})]}),i.jsxs("div",{children:["Ganancia bruta: ",i.jsx("strong",{children:ls(h.grossProfit)})]}),i.jsxs("div",{children:["Ganancia sucursal: ",i.jsx("strong",{children:ls(h.branchProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Comisin vendedores:"," ",i.jsx("strong",{children:ls(h.commissionTotal)})]}),i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:ls(h.expenses)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:ls(h.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:ls(h.credits)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-4 text-center",children:[i.jsx("span",{className:"block text-lg font-semibold text-gray-800",children:"Total (sub total  comisin  gastos  dbitos + crditos):"}),i.jsx("span",{className:"block text-2xl font-bold text-blue-700 mt-1",children:ls(h.finalAmount)})]})})]})})()]})]})}const si=t=>Math.round((Number(t)||0)*100)/100,E0=t=>Math.round((Number(t)||0)*1e3)/1e3,To=t=>Number(t??0).toFixed(2),Lh=t=>Number(t??0).toFixed(3),LVe=(t,e)=>{var A;const r=t.date??((A=t.timestamp)!=null&&A.toDate?Kr(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=t.userEmail??"",a=t.vendorName||t.vendor||n||t.vendorId||"(sin vendedor)",s=t.type||"CONTADO",o=t.vendorId,l=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,c=Number(t.vendorCommissionAmount??0)||0;if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((h,m)=>{const p=Number((h==null?void 0:h.packages)??(h==null?void 0:h.qty)??(h==null?void 0:h.quantity)??0),x=Number((h==null?void 0:h.lineFinal)??0)||Math.max(0,Number((h==null?void 0:h.unitPricePackage)||(h==null?void 0:h.unitPrice)||0)*p-Number((h==null?void 0:h.discount)||0));let v=0;return c>0&&l>0&&Number(x||0)>0&&(v=si(c*Number(x||0)/l)),{id:`${e}#${m}`,productName:String((h==null?void 0:h.productName)??"(sin nombre)"),quantity:p,amount:si(x),date:r,type:s,vendorId:o,userEmail:a,vendorCommissionAmount:v}});const d=Number(t.packagesTotal??t.quantity??0),u=Number(t.amount??t.amountCharged??t.total??0)||0,f=si(Number(t.vendorCommissionAmount??0)||0);return[{id:e,productName:String((t==null?void 0:t.productName)??"(sin nombre)"),quantity:d,amount:si(u),date:r,type:s,vendorId:o,userEmail:a,vendorCommissionAmount:f}]};function UVe({role:t,roles:e,currentUserEmail:r,sellerCandyId:n}){const a=e&&e.length?e:t,s=!a||Rn(a,"admin"),o="daily_closures_candies",l="sales_candies",c="sellers_candies",[d,u]=g.useState(Kr(ste(new Date),"yyyy-MM-dd")),[f,A]=g.useState(Kr(new Date,"yyyy-MM-dd")),[h,m]=g.useState(!0),[p,x]=g.useState([]),[v,y]=g.useState(null),[b,w]=g.useState(""),[I,j]=g.useState([]),[N,S]=g.useState("ALL"),[E,B]=g.useState({}),k=g.useRef(null);if(!s)return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Liquidaciones"}),i.jsx("p",{className:"text-sm text-red-600",children:"Acceso denegado: solo admin."})]});const T=async()=>{try{const Y=await Ut(xt(Ne,c)),D=[];Y.forEach(V=>{const te=V.data();D.push({id:V.id,name:te.name||"",commissionPercent:Number(te.commissionPercent||0)})}),j(D)}catch(Y){console.error("Error cargando sellers_candies",Y)}},P=async()=>{const Y=performance.now();try{m(!0);const D=ar(xt(Ne,o),lr("date",">=",d),lr("date","<=",f)),V=await Ut(D),te=performance.now();console.log(" getDocs ms:",(te-Y).toFixed(1),"docs:",V.size);const ve=[];V.forEach(Z=>ve.push({id:Z.id,...Z.data()}));const Q=performance.now();console.log(" parse+set ms:",(Q-te).toFixed(1),"rows:",ve.length),ve.sort((Z,ke)=>Z.date<ke.date?1:Z.date>ke.date?-1:0),x(ve),y(null);const Xe=new Set;ve.forEach(Z=>{(Z.sales||[]).forEach(ke=>{const Se=String((ke==null?void 0:ke.id)??"").split("#")[0].trim();Se&&Xe.add(Se)})});const se=Array.from(Xe).filter(Z=>!E[Z]);if(se.length>0){const Z={};for(const ke of se)try{const Se=await Es(Kt(Ne,l,ke));if(Se.exists()){const Ee=Se.data();Z[ke]=LVe(Ee,ke)}else Z[ke]=[]}catch(Se){console.error("Error leyendo sale",ke,Se),Z[ke]=[]}B(ke=>({...ke,...Z}))}}catch(D){console.error(D),w(" Error cargando liquidaciones.")}finally{m(!1)}};g.useEffect(()=>{T()},[]),g.useEffect(()=>{P()},[]);const q=async Y=>{Y.preventDefault(),await P()},de=g.useMemo(()=>{const Y={};return I.forEach(D=>Y[D.id]=D.name||D.id),Y},[I]),ce=Y=>{const D=[];return(Y.sales||[]).forEach(V=>{const te=String((V==null?void 0:V.id)??"").trim();if(!te)return;const ve=te.split("#")[0],Xe=(E[ve]||[]).find(se=>se.id===te);Xe?D.push(Xe):D.push({id:te,productName:String((V==null?void 0:V.productName)??"(sin nombre)"),quantity:Number((V==null?void 0:V.quantity)??0),amount:si(Number((V==null?void 0:V.amount)??0)),date:String((V==null?void 0:V.date)??""),type:"CONTADO",vendorId:"",userEmail:String((V==null?void 0:V.userEmail)??"(sin vendedor)"),vendorCommissionAmount:0})}),D},le=Y=>N==="ALL"?Y:Y.filter(D=>(D.vendorId||"")===N),he=g.useMemo(()=>p.map(Y=>{const D=le(ce(Y));let V=0,te=0,ve=0,Q=0,Xe=0,se=0;for(const Z of D){const ke=Number(Z.quantity||0),Se=Number(Z.amount||0),Ee=Number(Z.vendorCommissionAmount||0);Z.type==="CREDITO"?(te+=ke,Q+=Se,se+=Ee):(V+=ke,ve+=Se,Xe+=Ee)}return{...Y,_sales:D,_packsCash:E0(V),_packsCredit:E0(te),_amountCash:si(ve),_amountCredit:si(Q),_comCash:si(Xe),_comCredit:si(se)}}),[p,E,N]),ae=g.useMemo(()=>{let Y=0,D=0,V=0,te=0,ve=0,Q=0;for(const Xe of he)Y+=Number(Xe._packsCash||0),D+=Number(Xe._packsCredit||0),V+=Number(Xe._amountCash||0),te+=Number(Xe._amountCredit||0),ve+=Number(Xe._comCash||0),Q+=Number(Xe._comCredit||0);return{packsCash:E0(Y),packsCredit:E0(D),totalSales:si(V+te),amountCash:si(V),amountCredit:si(te),comCash:si(ve),comCredit:si(Q)}},[he]),Ce=g.useMemo(()=>{const Y={},D={};for(const V of he){const te=V._sales||[];for(const ve of te){const Q=(ve.vendorId||"").trim();if(!Q)continue;const Xe=de[Q]||ve.userEmail||Q,se=si(Number(ve.vendorCommissionAmount||0));ve.type==="CREDITO"?(D[Q]||(D[Q]={vendorId:Q,name:Xe,total:0}),D[Q].total=si(D[Q].total+se)):(Y[Q]||(Y[Q]={vendorId:Q,name:Xe,total:0}),Y[Q].total=si(Y[Q].total+se))}}return{cashRows:Object.values(Y).filter(V=>V.total>0).sort((V,te)=>te.total-V.total),creditRows:Object.values(D).filter(V=>V.total>0).sort((V,te)=>te.total-V.total)}},[he,de]),De=g.useMemo(()=>I.map(Y=>({id:Y.id,label:Y.name||Y.id})).sort((Y,D)=>Y.label.localeCompare(D.label)),[I]),O=g.useMemo(()=>v&&he.find(Y=>Y.id===v.id)||null,[v,he]),R=g.useMemo(()=>O?O._sales||[]:[],[O]),G=g.useMemo(()=>{let Y=0,D=0,V=0,te=0;for(const ve of R)ve.type==="CREDITO"?(D+=Number(ve.quantity||0),te+=Number(ve.amount||0)):(Y+=Number(ve.quantity||0),V+=Number(ve.amount||0));return{packsCash:E0(Y),packsCredit:E0(D),amountCash:si(V),amountCredit:si(te)}},[R]),M=g.useMemo(()=>{const Y={};for(const D of R){const V=D.productName||"(sin nombre)";Y[V]||(Y[V]={productName:V,packsCash:0,packsCredit:0,amountCash:0,amountCredit:0,comCash:0,comCredit:0});const te=Number(D.quantity||0),ve=Number(D.amount||0),Q=Number(D.vendorCommissionAmount||0);D.type==="CREDITO"?(Y[V].packsCredit=E0(Y[V].packsCredit+te),Y[V].amountCredit=si(Y[V].amountCredit+ve),Y[V].comCredit=si(Y[V].comCredit+Q)):(Y[V].packsCash=E0(Y[V].packsCash+te),Y[V].amountCash=si(Y[V].amountCash+ve),Y[V].comCash=si(Y[V].comCash+Q))}return Object.values(Y)},[R]),K=async()=>{if(!k.current||!O)return;const Y=k.current;Y.classList.add("force-pdf-colors");try{const V=(await $m(Y,{backgroundColor:"#ffffff"})).toDataURL("image/png"),te=new An;te.addImage(V,"PNG",10,10,190,0),te.save(`liquidacion_${O.date}.pdf`)}finally{Y.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Liquidaciones"}),i.jsxs("form",{onSubmit:q,className:"flex flex-wrap items-end gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:Y=>u(Y.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:f,onChange:Y=>A(Y.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 min-w-[240px]",value:N,onChange:Y=>S(Y.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),De.map(Y=>i.jsx("option",{value:Y.id,children:Y.label},Y.id))]})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Aplicar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-3 mb-6",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"text-2xl font-bold",children:Lh(ae.packsCash)})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:Lh(ae.packsCredit)})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas totales"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",To(ae.totalSales)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",To(ae.amountCash)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",To(ae.amountCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",To(ae.comCash)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",To(ae.comCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin cash)"}),Ce.cashRows.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:Ce.cashRows.map(Y=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:Y.name}),i.jsxs("strong",{className:"ml-2",children:["C$",To(Y.total)]})]},Y.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin crdito)"}),Ce.creditRows.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:Ce.creditRows.map(Y=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:Y.name}),i.jsxs("strong",{className:"ml-2",children:["C$",To(Y.total)]})]},Y.vendorId))})]})]}),h?i.jsx("p",{children:"Cargando..."}):he.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cierres en el rango seleccionado."}):i.jsxs("table",{className:"min-w-full text-sm mb-6 shadow-lg p-4 bg-white border-gray-100",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total paquetes Cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Total Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Total Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"}),i.jsx("th",{className:"border p-2",children:"Opciones"})]})}),i.jsx("tbody",{children:he.map(Y=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:Y.date}),i.jsx("td",{className:"border p-1",children:Lh(Y._packsCash)}),i.jsx("td",{className:"border p-1",children:Lh(Y._packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",To(Y._amountCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",To(Y._amountCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",To(Y._comCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",To(Y._comCredit)]}),i.jsx("td",{className:"border p-1",children:i.jsx("div",{className:"flex items-center gap-2 justify-center",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>y(Y),children:"Ver detalle"})})})]},Y.id))})]}),O&&i.jsxs("div",{className:"mt-6 rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2 ",children:[i.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle ",O.date]}),i.jsx("button",{onClick:()=>y(null),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"}),i.jsx("button",{onClick:K,className:"ml-auto bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Descargar PDF"})]}),i.jsxs("div",{ref:k,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:[i.jsxs("div",{children:["Total Ventas cash:"," ",i.jsxs("strong",{children:["C$",To(G.amountCash)]})]}),i.jsxs("div",{children:["Total Ventas crdito:"," ",i.jsxs("strong",{children:["C$",To(G.amountCredit)]})]}),i.jsxs("div",{children:["Total paquetes cash:"," ",i.jsx("strong",{children:Lh(G.packsCash)})]}),i.jsxs("div",{children:["Total paquetes crdito:"," ",i.jsx("strong",{children:Lh(G.packsCredit)})]})]}),i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),R.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin ventas en este cierre."}):i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"})]})}),i.jsx("tbody",{children:R.map((Y,D)=>{const V=Y.vendorId&&de[Y.vendorId]?de[Y.vendorId]:Y.userEmail,te=si(Number(Y.vendorCommissionAmount||0));return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:V}),i.jsx("td",{className:"border p-1",children:Y.productName}),i.jsx("td",{className:"border p-1",children:Y.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:Lh(Y.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",To(Y.amount)]}),i.jsx("td",{className:"border p-1",children:te>0?`C$${To(te)}`:""}),i.jsx("td",{className:"border p-1",children:Y.date||""})]},D)})})]}),i.jsx("h3",{className:"font-semibold",children:"Consolidado por producto"}),M.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin datos para consolidar."}):i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"})]})}),i.jsx("tbody",{children:M.map((Y,D)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:Y.productName}),i.jsx("td",{className:"border p-1",children:Lh(Y.packsCash)}),i.jsx("td",{className:"border p-1",children:Lh(Y.packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",To(Y.amountCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",To(Y.amountCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",To(Y.comCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",To(Y.comCredit)]})]},D))})]})]})]}),b&&i.jsx("p",{className:"mt-3 text-sm",children:b})]})}const tn=t=>Math.round((Number(t)||0)*100)/100,El=t=>Math.round((Number(t)||0)*1e3)/1e3,Wr=t=>Number(t??0).toFixed(2),bi=t=>Number(t??0).toFixed(3),hj=t=>{const e=String(t||"").toUpperCase().trim();return e==="RIVAS"?"RIVAS":e==="SAN_JORGE"||e==="SANJORGE"||e==="SJ"?"SAN_JORGE":e==="ISLA"||e==="OMETEPE"?"ISLA":""},Vr=t=>{const e=Number(t);return Number.isFinite(e)?e:0},QVe=t=>Math.max(0,Math.min(1,t));function VG({title:t,series:e,valuePrefix:r="C$"}){const d=e.map(b=>Number(b.value||0)),u=d.length?Math.min(...d):0,f=d.length?Math.max(...d):0,A=f-u||1,h=840,m=204,p=e.map((b,w)=>{const I=44+(e.length<=1?h/2:w/(e.length-1)*h),j=18+(1-(Number(b.value||0)-u)/A)*m;return{x:I,y:j,...b}}),x=p.map((b,w)=>`${w===0?"M":"L"} ${b.x.toFixed(2)} ${b.y.toFixed(2)}`).join(" "),v=p[p.length-1],y=v?v.value:0;return i.jsxs("div",{className:"border rounded-2xl p-3 shadow-sm bg-white",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[i.jsx("div",{className:"font-semibold text-sm sm:text-base",children:t}),i.jsxs("div",{className:"text-xs text-gray-600 whitespace-nowrap",children:["ltimo: ",i.jsx("strong",{children:r+Wr(y)})]})]}),i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("svg",{viewBox:"0 0 900 260",className:"min-w-[720px] w-full h-auto",role:"img","aria-label":t,children:[[0,1,2,3].map(b=>{const w=18+b/3*m;return i.jsx("line",{x1:44,y1:w,x2:884,y2:w,stroke:"#e5e7eb",strokeWidth:"1"},b)}),i.jsxs("text",{x:8,y:28,fontSize:"12",fill:"#6b7280",children:[r,Wr(f)]}),i.jsxs("text",{x:8,y:18+m,fontSize:"12",fill:"#6b7280",children:[r,Wr(u)]}),i.jsx("path",{d:x,fill:"none",stroke:"#111827",strokeWidth:"2.5"}),p.map((b,w)=>i.jsx("circle",{cx:b.x,cy:b.y,r:"3.5",fill:"#111827"},w)),e.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("text",{x:44,y:246,fontSize:"12",fill:"#6b7280",textAnchor:"start",children:e[0].label}),i.jsx("text",{x:884,y:246,fontSize:"12",fill:"#6b7280",textAnchor:"end",children:e[e.length-1].label})]})]})})]})}function VVe({title:t,items:e}){const r=e.reduce((f,A)=>f+Number(A.value||0),0),n=240,a=86,s=120,o=120,l=r>0?r:1;let c=0;const d=["#111827","#374151","#6b7280","#9ca3af"],u=e.map((f,A)=>{const h=Math.max(0,Number(f.value||0)),m=c/l,p=h/l;c+=h;const x=m+p,v=m*Math.PI*2-Math.PI/2,y=x*Math.PI*2-Math.PI/2,b=s+a*Math.cos(v),w=o+a*Math.sin(v),I=s+a*Math.cos(y),j=o+a*Math.sin(y),N=p>.5?1:0;return{d:[`M ${s} ${o}`,`L ${b.toFixed(2)} ${w.toFixed(2)}`,`A ${a} ${a} 0 ${N} 1 ${I.toFixed(2)} ${j.toFixed(2)}`,"Z"].join(" "),fill:d[A%d.length],...f,frac:p}});return i.jsxs("div",{className:"border rounded-2xl p-3 shadow-sm bg-white",children:[i.jsx("div",{className:"font-semibold text-sm sm:text-base mb-2",children:t}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-center",children:[i.jsx("div",{className:"w-full md:w-auto overflow-x-auto",children:i.jsxs("svg",{viewBox:`0 0 ${n} ${n}`,className:"min-w-[240px] w-[260px] h-auto",role:"img","aria-label":t,children:[u.map((f,A)=>i.jsx("path",{d:f.d,fill:f.fill},A)),i.jsx("circle",{cx:s,cy:o,r:"48",fill:"#ffffff"}),i.jsx("text",{x:s,y:o-4,textAnchor:"middle",fontSize:"12",fill:"#6b7280",children:"Total"}),i.jsxs("text",{x:s,y:o+16,textAnchor:"middle",fontSize:"14",fill:"#111827",fontWeight:"700",children:["C$",Wr(r)]})]})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:e.map((f,A)=>{const h=Number(f.value||0),m=QVe(h/(r||1))*100;return i.jsxs("div",{className:"border rounded-xl p-2 bg-gray-50",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"text-sm font-semibold truncate",children:f.label}),i.jsxs("div",{className:"text-sm font-bold whitespace-nowrap",children:["C$",Wr(h)]})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[m.toFixed(1),"%"]}),i.jsx("div",{className:"h-2 bg-white border rounded-full mt-2 overflow-hidden",children:i.jsx("div",{className:"h-full",style:{width:`${m}%`,background:d[A%d.length]}})})]},f.label)})}),i.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"*Distribucin basada en ventas del perodo con los filtros actuales."})]})]})]})}const HVe=(t,e)=>{var x;const r=t.date??((x=t.timestamp)!=null&&x.toDate?Kr(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=String(t.processedDate??t.closureDate??"").trim(),a=t.status??"FLOTANTE",s=t.type||"CONTADO",o=String(t.vendorId??"").trim(),l=String(t.vendorName??"").trim()||String(t.userEmail??"").trim()||o||"(sin vendedor)",c=String(t.customerId??"").trim(),d=String(t.customerName??"").trim()||String(t.clientName??"").trim()||"",u=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,f=Number(t.vendorCommissionAmount??0)||0,A=hj(t.branch??t.vendorBranch);if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((v,y)=>{const b=Number((v==null?void 0:v.packages)??0)||0,w=Number((v==null?void 0:v.total)??0)||Math.max(0,Number((v==null?void 0:v.unitPricePackage)||0)*b-Number((v==null?void 0:v.discount)||0)),I=hj(v==null?void 0:v.branch)||A;let j=0;return f>0&&u>0&&w>0&&(j=tn(f*w/u)),{id:`${e}#${y}`,docId:e,productId:String((v==null?void 0:v.productId)??""),productName:String((v==null?void 0:v.productName)??"(sin nombre)"),date:r,processedDate:n,status:a,type:s,vendorId:o,vendorName:l,customerId:c,customerName:d,branch:I||"",packages:b,amount:tn(w),commission:tn(j)}});const h=Number(t.packagesTotal??0)||0,m=Number(t.total??t.amount??t.amountCharged??0)||0,p=tn(Number(t.vendorCommissionAmount??0)||0);return[{id:`${e}#0`,docId:e,productId:"",productName:"(sin nombre)",date:r,processedDate:n,status:a,type:s,vendorId:o,vendorName:l,customerId:c,customerName:d,branch:A||"",packages:h,amount:tn(m),commission:tn(p)}]};function $Ve({role:t,roles:e}){var pt;const r=e&&e.length?e:t,n=!r||Rn(r,"admin"),a=Kr(new Date,"yyyy-MM-dd"),[s,o]=g.useState(a),[l,c]=g.useState(a),[d,u]=g.useState("TODAS"),[f,A]=g.useState("AMBAS"),[h,m]=g.useState("ALL"),[p,x]=g.useState("ALL"),[v,y]=g.useState(""),[b,w]=g.useState(""),[I,j]=g.useState(""),[N,S]=g.useState(""),[E,B]=g.useState("DIA"),[k,T]=g.useState(!0),[P,q]=g.useState(""),[de,ce]=g.useState([]),[le,he]=g.useState([]),[ae,Ce]=g.useState([]),[De,O]=g.useState({}),[R,G]=g.useState([]),[M,K]=g.useState([]),[Y,D]=g.useState([]),[V,te]=g.useState([]),[ve,Q]=g.useState([]),[Xe,se]=g.useState([]),[Z,ke]=g.useState(""),[Se,Ee]=g.useState(""),[Ze,ot]=g.useState(null),vt=g.useRef(null),[_t,Tt]=g.useState([]),[Lt,Rt]=g.useState("DETALLE"),[Et,Re]=g.useState(!1),[Te,Ye]=g.useState(!1),[dt,Fe]=g.useState(!1),[je,We]=g.useState(!1),[ee,Ve]=g.useState(!1),[rt,$e]=g.useState(!1),ie=g.useMemo(()=>{const ne={};return M.forEach(Ue=>ne[Ue.id]=String(Ue.name||"").trim()),ne},[M]),pe=g.useMemo(()=>{const ne={};return le.forEach(Ue=>ne[Ue.id]=Ue),ne},[le]),fe=ne=>{const Ue=ne.customerId?ie[ne.customerId]:"";return(ne.customerName||Ue||"").trim()||(ne.customerId?ie[ne.customerId]||ne.customerId:"")||""};g.useEffect(()=>{if(!n)return;(async()=>{try{const Ue=await Ut(xt(Ne,"inventory_candies")),tt=[];Ue.forEach(nt=>tt.push({id:nt.id,...nt.data()})),Tt(tt)}catch(Ue){console.error("inventory_candies all error:",Ue),Tt([])}})()},[n]),g.useEffect(()=>{(async()=>{try{const Ue=await Ut(xt(Ne,"sellers_candies")),tt=[];Ue.forEach(wt=>{const Bt=wt.data();tt.push({id:wt.id,name:String(Bt.name||"").trim(),commissionPercent:Number(Bt.commissionPercent||0),branch:Bt.branch||""})});const nt=new Map;tt.forEach(wt=>nt.set(wt.id,wt)),he(Array.from(nt.values()).sort((wt,Bt)=>wt.name.localeCompare(Bt.name)))}catch(Ue){console.error(Ue)}})()},[]),g.useEffect(()=>{if(!n||!s||!l)return;T(!0),q("");const ne=ar(xt(Ne,"sales_candies"),lr("date",">=",s),lr("date","<=",l),kn("date","asc")),Ue=Fu(ne,tt=>{const nt=[];tt.forEach(wt=>nt.push(...HVe(wt.data(),wt.id))),ce(nt),T(!1)},tt=>{console.error("sales_candies periodo error:",tt),ce([]),T(!1),q(" Error cargando ventas del perodo (revis ndices si aplica).")});return()=>Ue()},[n,s,l]),g.useEffect(()=>{if(!n)return;(async()=>{try{const Ue=ar(xt(Ne,"candy_main_orders"),lr("date",">=",s),lr("date","<=",l)),tt=await Ut(Ue),nt=[];tt.forEach(wt=>nt.push({id:wt.id,...wt.data()})),Ce(nt)}catch(Ue){console.error("candy_main_orders error:",Ue),Ce([])}})()},[n,s,l]),g.useEffect(()=>{if(!n)return;(async()=>{try{const Ue=await Ut(ar(xt(Ne,"candy_main_orders"),kn("createdAt","desc"))),tt={},nt=(wt,Bt)=>`${wt}#${String(Bt).padStart(10,"0")}`;Ue.forEach(wt=>{var Dr;const Bt=wt.data(),tr=Number(((Dr=Bt.createdAt)==null?void 0:Dr.seconds)??0),Or=String(Bt.date||""),zr=nt(Or,tr),ur=Array.isArray(Bt.items)?Bt.items:[];for(const dn of ur){const mn=String(dn.id||dn.productId||"");if(!mn)continue;const kr={unitPriceRivas:Number(dn.unitPriceRivas||0),unitPriceSanJorge:Number(dn.unitPriceSanJorge||0),unitPriceIsla:Number(dn.unitPriceIsla||0),key:zr},Qe=tt[mn];(!Qe||kr.key>Qe.key)&&(tt[mn]=kr)}}),O(tt)}catch(Ue){console.error("candy_main_orders catalog error:",Ue),O({})}})()},[n]),g.useEffect(()=>{if(!n)return;const ne=ar(xt(Ne,"inventory_candies_sellers"),lr("date",">=",s),lr("date","<=",l)),Ue=Fu(ne,tt=>{const nt=[];tt.forEach(wt=>nt.push({id:wt.id,...wt.data()})),G(nt)},tt=>{console.error("inventory_candies_sellers error:",tt),G([])});return()=>Ue()},[n,s,l]),g.useEffect(()=>{if(!n)return;(async()=>{try{const Ue=ar(xt(Ne,"expenses_candies"),lr("date",">=",s),lr("date","<=",l),kn("date","asc")),tt=await Ut(Ue),nt=[];tt.forEach(wt=>nt.push({id:wt.id,...wt.data()})),te(nt)}catch(Ue){console.warn("expenses_candies sin ndice, usando fallback:",Ue);try{const tt=await Ut(xt(Ne,"expenses_candies")),nt=[];tt.forEach(wt=>nt.push({id:wt.id,...wt.data()})),te(nt.filter(wt=>String(wt.date||"")>=s&&String(wt.date||"")<=l))}catch(tt){console.error(tt),te([])}}})()},[n,s,l]),g.useEffect(()=>{if(!n)return;(async()=>{try{const Ue=await Ut(xt(Ne,"inventory_candies")),tt=[];Ue.forEach(nt=>tt.push({id:nt.id,...nt.data()})),Q(tt)}catch(Ue){console.error("inventory_candies global error:",Ue),Q([])}})()},[n]),g.useEffect(()=>{if(!n)return;(async()=>{try{const Ue=await Ut(xt(Ne,"inventory_candies_sellers")),tt=[];Ue.forEach(nt=>tt.push({id:nt.id,...nt.data()})),se(tt)}catch(Ue){console.error("inventory_candies_sellers global error:",Ue),se([])}})()},[n]),g.useEffect(()=>{if(!n)return;const ne=ar(xt(Ne,"customers_candies")),Ue=Fu(ne,tt=>{const nt=[];tt.forEach(wt=>{var Bt,tr,Or;return nt.push({id:wt.id,name:String(((Bt=wt.data())==null?void 0:Bt.name)||"").trim(),initialDebt:Number(((tr=wt.data())==null?void 0:tr.initialDebt)||0),initialDebtDate:String(((Or=wt.data())==null?void 0:Or.initialDebtDate)||"").trim()})}),K(nt)},tt=>{console.error("customers_candies snapshot error:",tt),K([])});return()=>Ue()},[n]),g.useEffect(()=>{if(!n)return;(async()=>{try{const Ue=ar(xt(Ne,"ar_movements"),lr("date","<=",l),kn("date","asc")),tt=await Ut(Ue),nt=[];tt.forEach(wt=>nt.push({id:wt.id,...wt.data()})),D(nt)}catch(Ue){console.warn("ar_movements sin ndice, usando fallback:",Ue);try{const tt=await Ut(xt(Ne,"ar_movements")),nt=[];tt.forEach(wt=>nt.push({id:wt.id,...wt.data()})),D(nt.filter(wt=>String(wt.date||"")<=l))}catch(tt){console.error(tt),D([])}}})()},[n,l]);const Me=g.useMemo(()=>{let ne=[...de];if(d!=="TODAS"&&(ne=ne.filter(nt=>nt.status===d)),f==="CASH"&&(ne=ne.filter(nt=>nt.type==="CONTADO")),f==="CREDITO"&&(ne=ne.filter(nt=>nt.type==="CREDITO")),h!=="ALL"&&(ne=ne.filter(nt=>(nt.vendorId||"")===h)),p!=="ALL"&&(ne=ne.filter(nt=>nt.branch===p)),v.trim()){const nt=v.trim().toLowerCase();ne=ne.filter(wt=>(wt.productName||"").toLowerCase().includes(nt))}if(b.trim()){const nt=b.trim().toLowerCase();ne=ne.filter(wt=>(fe(wt)||"").toLowerCase().includes(nt))}const Ue=I.trim()?Number(I):null,tt=N.trim()?Number(N):null;return Ue!==null&&!Number.isNaN(Ue)&&(ne=ne.filter(nt=>(nt.amount||0)>=Ue)),tt!==null&&!Number.isNaN(tt)&&(ne=ne.filter(nt=>(nt.amount||0)<=tt)),ne},[de,d,f,h,p,v,b,I,N,ie]),me=g.useMemo(()=>{let ne=0,Ue=0,tt=0,nt=0,wt=0,Bt=0;for(const Or of Me){const zr=Vr(Or.packages),ur=Vr(Or.amount),Dr=Vr(Or.commission);Or.type==="CREDITO"?(Ue+=zr,nt+=ur,Bt+=Dr):(ne+=zr,tt+=ur,wt+=Dr)}const tr=tn(tt+nt);return{packsCash:El(ne),packsCredit:El(Ue),salesCash:tn(tt),salesCredit:tn(nt),salesTotal:tr,commCash:tn(wt),commCredit:tn(Bt),commTotal:tn(wt+Bt)}},[Me]),ye=g.useMemo(()=>{let ne=0,Ue=0,tt=0,nt=0,wt=0,Bt=0;for(const tr of ae){const Or=Array.isArray(tr.items)?tr.items:[];for(const zr of Or)ne+=Vr(zr.totalRivas),Ue+=Vr(zr.totalSanJorge),tt+=Vr(zr.totalIsla),nt+=Vr(zr.gainRivas),wt+=Vr(zr.gainSanJorge),Bt+=Vr(zr.gainIsla)}return{expectedRivas:tn(ne),expectedSanJorge:tn(Ue),expectedIsla:tn(tt),grossRivas:tn(nt),grossSanJorge:tn(wt),grossIsla:tn(Bt),grossTotal:tn(nt+wt+Bt),expectedTotal:tn(ne+Ue+tt)}},[ae]),mt=g.useMemo(()=>{const ne={RIVAS:{sales:0,packages:0},SAN_JORGE:{sales:0,packages:0},ISLA:{sales:0,packages:0}};for(const Ue of Me){const tt=Ue.branch;tt&&(ne[tt].sales+=Vr(Ue.amount),ne[tt].packages+=Vr(Ue.packages))}return{RIVAS:{sales:tn(ne.RIVAS.sales),packages:El(ne.RIVAS.packages)},SAN_JORGE:{sales:tn(ne.SAN_JORGE.sales),packages:El(ne.SAN_JORGE.packages)},ISLA:{sales:tn(ne.ISLA.sales),packages:El(ne.ISLA.packages)}}},[Me]),gt=g.useMemo(()=>({RIVAS:tn(mt.RIVAS.sales-ye.expectedRivas),SAN_JORGE:tn(mt.SAN_JORGE.sales-ye.expectedSanJorge),ISLA:tn(mt.ISLA.sales-ye.expectedIsla)}),[mt,ye]),yt=g.useMemo(()=>{const ne={},Ue={};for(const wt of Me){const Bt=(wt.vendorId||"").trim();if(!Bt)continue;const tr=le.find(ur=>ur.id===Bt),Or=(tr==null?void 0:tr.name)||wt.vendorName||"(sin vendedor)",zr=Vr(wt.commission);wt.type==="CREDITO"?(Ue[Bt]||(Ue[Bt]={vendorId:Bt,name:Or,total:0}),Ue[Bt].total=tn(Ue[Bt].total+zr)):(ne[Bt]||(ne[Bt]={vendorId:Bt,name:Or,total:0}),ne[Bt].total=tn(ne[Bt].total+zr))}const tt=Object.values(ne).sort((wt,Bt)=>Bt.total-wt.total),nt=Object.values(Ue).sort((wt,Bt)=>Bt.total-wt.total);return{cashArr:tt,creditArr:nt}},[Me,le]),Pt=g.useMemo(()=>{const ne=(kr,Qe)=>kr.reduce((jt,wr)=>jt+Number((wr==null?void 0:wr[Qe])??0),0),Ue=kr=>{const Qe=Number(kr);return Number.isFinite(Qe)?Math.floor(Qe):0},tt=kr=>{const Qe=Number((kr==null?void 0:kr.totalPackages)??0);if(Qe>0)return Qe;const jt=Array.isArray(kr==null?void 0:kr.items)?kr.items:[];return ne(jt,"packages")};let nt=0,wt=0;for(const kr of ae){const Qe=Array.isArray(kr.items)?kr.items:[];if(Qe.length)for(const jt of Qe)nt+=Number((jt==null?void 0:jt.subtotal)??0);else nt+=Number(kr.subtotal??0);wt+=tt(kr)}let Bt=0,tr=0,Or=0;const zr=kr=>{const Qe=Number(kr==null?void 0:kr.remainingPackages);if(Number.isFinite(Qe)&&Qe>0)return Math.floor(Qe);const jt=Math.max(1,Ue((kr==null?void 0:kr.unitsPerPackage)??1)),wr=Ue((kr==null?void 0:kr.remainingUnits)??(kr==null?void 0:kr.remaining)??0);return wr>0?Math.max(0,Math.floor(wr/jt)):0};for(const kr of R)Bt+=Number(kr.subtotal??0),tr+=Number(kr.packages??0),Or+=zr(kr);const ur=new Set(ae.filter(kr=>String(kr.date||"")>=s&&String(kr.date||"")<=l).map(kr=>kr.id));let Dr=0;for(const kr of _t){const Qe=String(kr.orderId||"").trim();Qe&&ur.has(Qe)&&(Dr+=Number(kr.remainingPackages??0))}const dn=ve.reduce((kr,Qe)=>kr+Vr(Qe.remainingPackages),0),mn=Xe.reduce((kr,Qe)=>kr+Vr(Qe.remainingPackages),0);return{providerTotalMaster:tn(nt),providerTotalVendor:tn(Bt),orderedPacksMaster:El(wt),remainingPacksMaster:El(Dr),orderedPacksVendor:El(tr),remainingPacksVendor:El(Or),globalRemainingMaster:El(dn),globalRemainingVendor:El(mn)}},[ae,R,_t,s,l,ve,Xe]),Ft=g.useMemo(()=>{const ne={};let Ue=0;for(const tt of V){const nt=String(tt.date||"").trim();if(!nt)continue;const wt=Math.max(0,Vr(tt.amount));Ue+=wt,ne[nt]=tn((ne[nt]||0)+wt)}return{total:tn(Ue),byDay:ne}},[V]),Oe=g.useMemo(()=>{let ne=0;for(const Ue of ae){const tt=Array.isArray(Ue.items)?Ue.items:[];if(tt.length)for(const nt of tt)ne+=Vr(nt==null?void 0:nt.subtotal);else ne+=Vr(Ue.subtotal)}return tn(ne)},[ae]),be=g.useMemo(()=>{var zr;const ne=ur=>{const Dr=Math.max(1,Math.floor(Vr(ur.unitsPerPackage||1))),dn=Vr(ur.totalUnits)>0?Vr(ur.totalUnits):Vr(ur.packages)*Dr;let mn=0;Vr(ur.remainingUnits)>0?mn=Vr(ur.remainingUnits):Vr(ur.remainingPackages)>0?mn=Vr(ur.remainingPackages)*Dr:mn=0;const kr=Math.max(0,dn-mn);return{orderedUnits:dn,remainingUnits:mn,soldUnits:kr,upp:Dr}},Ue=ur=>{const Dr=pe[ur];return hj(Dr==null?void 0:Dr.branch)||"ISLA"},tt=(ur,Dr)=>{var dn,mn,kr;return Dr==="ISLA"?Vr(((dn=De[String(ur.productId||"")])==null?void 0:dn.unitPriceIsla)??ur.unitPriceIsla):Dr==="RIVAS"?Vr(((mn=De[String(ur.productId||"")])==null?void 0:mn.unitPriceRivas)??ur.unitPriceRivas):Dr==="SAN_JORGE"?Vr(((kr=De[String(ur.productId||"")])==null?void 0:kr.unitPriceSanJorge)??ur.unitPriceSanJorge):0},nt=(ur,Dr)=>{const dn=Math.max(0,Math.floor(Vr(ur.packages))),mn=tt(ur,Dr),kr=tn(mn*dn);if(kr>0)return kr;const Qe=Vr(ur.totalVendor)||(Dr==="ISLA"?Vr(ur.totalIsla):Dr==="RIVAS"?Vr(ur.totalRivas):Dr==="SAN_JORGE"?Vr(ur.totalSanJorge):0);if(Qe>0)return Qe;const jt=Vr(ur.unitPriceVendor);if(jt>0){const{orderedUnits:wr}=ne(ur);return jt*wr}return 0},wt=(ur,Dr)=>{const dn=tt(ur,Dr),{orderedUnits:mn,upp:kr}=ne(ur);if(dn>0&&kr>0)return dn/kr;const Qe=Vr(ur.unitPriceVendor);if(Qe>0)return Qe;const jt=nt(ur,Dr);return jt>0&&mn>0?jt/mn:0},Bt=new Map;for(const ur of R){const Dr=String(ur.orderId||"").trim(),dn=Dr||`DOC:${ur.id}`,mn=String(ur.sellerId||"").trim(),kr=String(ur.sellerName||"").trim()||mn&&((zr=pe[mn])==null?void 0:zr.name)||""||"(sin vendedor)",Qe=String(ur.date||"").trim(),jt=mn?Ue(mn):"",{orderedUnits:wr,remainingUnits:ln,soldUnits:cn}=ne(ur),_r=nt(ur,jt),Jt=wt(ur,jt),ir=Jt>0?Jt*cn:wr>0?_r*cn/wr:0,Fr=tn(_r-ir);Bt.has(dn)||Bt.set(dn,{orderKey:dn,orderId:Dr||dn,date:Qe,sellerId:mn,sellerName:kr,branch:jt,totalOrden:0,vendido:0,restante:0,comision:0,totalEsperado:0,lines:[]});const Er=Bt.get(dn);Er.lines.push({...ur,orderedUnits:wr,soldUnits:cn,remainingUnits:ln,lineTotal:tn(_r),lineSoldValue:tn(ir),lineRemainingValue:tn(Fr)}),Er.totalOrden+=_r,Er.vendido+=ir,Er.restante+=Fr,Er.comision+=Vr(ur.uVendor??ur.vendorProfit??ur.gainVendor)}for(const ur of Bt.values())ur.comision=tn(ur.comision),ur.totalEsperado=tn(ur.totalOrden-ur.comision),ur.totalOrden=tn(ur.totalOrden),ur.vendido=tn(ur.vendido),ur.restante=tn(ur.restante);const tr=Array.from(Bt.values()).sort((ur,Dr)=>ur.date&&Dr.date?ur.date<Dr.date?1:-1:Dr.totalOrden-ur.totalOrden),Or=tr.reduce((ur,Dr)=>(ur.totalOrden+=Vr(Dr.totalOrden),ur.vendido+=Vr(Dr.vendido),ur.restante+=Vr(Dr.restante),ur.comision+=Vr(Dr.comision),ur.totalEsperado+=Vr(Dr.totalEsperado),ur),{totalOrden:0,vendido:0,restante:0,comision:0,totalEsperado:0});return{global:{totalOrden:tn(Or.totalOrden),vendido:tn(Or.vendido),restante:tn(Or.restante),comision:tn(Or.comision),totalEsperado:tn(Or.totalEsperado)},orders:tr}},[R,pe,De]),Ae=g.useMemo(()=>{var nt,wt,Bt;let ne=0,Ue=0;for(const tr of R){const Or=String(tr.sellerId||"").trim(),zr=Or?pe[Or]:void 0,ur=hj(zr==null?void 0:zr.branch)||"ISLA",Dr=Math.max(0,Math.floor(Vr(tr.packages)));if(!Dr)continue;const dn=Vr(ur==="ISLA"?((nt=De[String(tr.productId||"")])==null?void 0:nt.unitPriceIsla)??tr.unitPriceIsla:ur==="RIVAS"?((wt=De[String(tr.productId||"")])==null?void 0:wt.unitPriceRivas)??tr.unitPriceRivas:((Bt=De[String(tr.productId||"")])==null?void 0:Bt.unitPriceSanJorge)??tr.unitPriceSanJorge);let mn=tn(dn*Dr);mn||(mn=Vr(ur==="ISLA"?tr.totalIsla:ur==="RIVAS"?tr.totalRivas:tr.totalSanJorge)),mn&&(ne+=mn,Ue+=mn)}const tt=tn(Vr(ye.expectedIsla)-Ue);return{dispersedTotal:tn(ne),dispersedIsla:tn(Ue),totalExistenteIsla:tt}},[R,pe,ye.expectedIsla,De]),Le=g.useMemo(()=>({net:tn(R.reduce((Ue,tt)=>{const nt=tt.uNeta,wt=Vr(nt);if(wt!==0||nt===0)return Ue+wt;const Bt=Vr(tt.grossProfit),tr=Vr(tt.logisticAllocated??tt.gastos??tt.gasto),Or=Vr(tt.uVendor??tt.vendorProfit);return Ue+(Bt-tr-Or)},0))}),[R]),ut=g.useMemo(()=>{let ne=0,Ue=0,tt=0;for(const nt of Me){if(nt.type!=="CREDITO")continue;const wt=Vr(nt.amount),Bt=Vr(nt.commission);ne+=wt,Ue+=wt-Bt}for(const nt of Y){const wt=String(nt.date||"").trim();if(!wt||wt<s||wt>l)continue;const Bt=Vr(nt.amount);(nt.type||(Bt<0?"ABONO":"CARGO"))==="ABONO"&&(tt+=Math.abs(Bt))}return{cxc:tn(ne),recaudado:tn(tt),utilidadBruta:tn(Ue)}},[Me,Y,s,l]),ct=g.useMemo(()=>{if(!Se)return null;const ne=be.orders.find(nt=>nt.orderKey===Se);if(!ne)return null;const Ue={};for(const nt of ne.lines){const wt=String(nt.productName||"(sin nombre)");Ue[wt]||(Ue[wt]={productName:wt,asociados:0,vendidos:0,restantes:0});const Bt=Math.max(0,Math.floor(Vr(nt.packages))),tr=Math.max(1,Math.floor(Vr(nt.unitsPerPackage||1))),Or=Math.max(0,Math.floor(Vr(nt.remainingPackages)||(Vr(nt.remainingUnits)>0?Vr(nt.remainingUnits)/tr:0))),zr=Math.max(0,Bt-Or);Ue[wt].asociados+=Bt,Ue[wt].vendidos+=zr,Ue[wt].restantes+=Or}const tt=Object.values(Ue).map(nt=>({...nt,asociados:Math.floor(nt.asociados),vendidos:Math.floor(nt.vendidos),restantes:Math.floor(nt.restantes)})).sort((nt,wt)=>wt.asociados-nt.asociados);return{...ne,products:tt}},[Se,be.orders]),st=g.useMemo(()=>{const ne=ve.reduce((tt,nt)=>tt+Vr(nt.remainingPackages),0),Ue=Xe.reduce((tt,nt)=>tt+Vr(nt.remainingPackages),0);return{masterRemainingPackages:El(ne),vendorRemainingPackages:El(Ue)}},[ve,Xe]),z=g.useMemo(()=>{const ne=new Map,Ue=nt=>E==="DIA"?{key:nt.date,label:nt.date}:E==="VENDEDOR"?{key:nt.vendorId||"",label:nt.vendorName||""}:E==="PRODUCTO"?{key:nt.productName||"",label:nt.productName||""}:{key:nt.branch||"",label:nt.branch||""};for(const nt of Me){const{key:wt,label:Bt}=Ue(nt);ne.has(wt)||ne.set(wt,{key:wt,label:Bt,packsCash:0,packsCredit:0,salesCash:0,salesCredit:0,commCash:0,commCredit:0,rows:[]});const tr=ne.get(wt);tr.rows.push(nt),nt.type==="CREDITO"?(tr.packsCredit+=Vr(nt.packages),tr.salesCredit+=Vr(nt.amount),tr.commCredit+=Vr(nt.commission)):(tr.packsCash+=Vr(nt.packages),tr.salesCash+=Vr(nt.amount),tr.commCash+=Vr(nt.commission))}const tt=Array.from(ne.values()).map(nt=>({...nt,packsCash:El(nt.packsCash),packsCredit:El(nt.packsCredit),salesCash:tn(nt.salesCash),salesCredit:tn(nt.salesCredit),commCash:tn(nt.commCash),commCredit:tn(nt.commCredit)}));return E==="DIA"?tt.sort((nt,wt)=>nt.key<wt.key?1:-1):tt.sort((nt,wt)=>wt.salesCash+wt.salesCredit-(nt.salesCash+nt.salesCredit)),tt},[Me,E]),X=g.useMemo(()=>{if(!Z)return[];const ne=z.find(Ue=>Ue.key===Z);return(ne==null?void 0:ne.rows)||[]},[Z,z]),re=g.useMemo(()=>{const ne={};for(const Ue of X){const tt=Ue.productName||"(sin nombre)";ne[tt]||(ne[tt]={productName:tt,packsCash:0,packsCredit:0,salesCash:0,salesCredit:0,commCash:0,commCredit:0}),Ue.type==="CREDITO"?(ne[tt].packsCredit+=Vr(Ue.packages),ne[tt].salesCredit+=Vr(Ue.amount),ne[tt].commCredit+=Vr(Ue.commission)):(ne[tt].packsCash+=Vr(Ue.packages),ne[tt].salesCash+=Vr(Ue.amount),ne[tt].commCash+=Vr(Ue.commission))}return Object.values(ne).map(Ue=>({...Ue,packsCash:El(Ue.packsCash),packsCredit:El(Ue.packsCredit),salesCash:tn(Ue.salesCash),salesCredit:tn(Ue.salesCredit),commCash:tn(Ue.commCash),commCredit:tn(Ue.commCredit)})).sort((Ue,tt)=>tt.salesCash+tt.salesCredit-(Ue.salesCash+Ue.salesCredit))},[X]),H=g.useMemo(()=>{const ne={},Ue=Bt=>(ie[Bt]||"").trim()||Bt;for(const Bt of M){const tr=String(Bt.id||"").trim();tr&&(ne[tr]={customerId:tr,name:Ue(tr),balance:0,lastPayment:"",lastPaymentAmount:0,initialDebt:Vr(Bt.initialDebt),initialDebtDate:String(Bt.initialDebtDate||"").trim(),movements:[]})}for(const Bt of Y){const tr=String(Bt.customerId||"").trim();if(!tr)continue;const Or=String(Bt.date||"");Or&&Or>l||(ne[tr]||(ne[tr]={customerId:tr,name:Ue(tr),balance:0,lastPayment:"",lastPaymentAmount:0,initialDebt:0,initialDebtDate:"",movements:[]}),ne[tr].movements.push(Bt))}const tt=(Bt,tr,Or)=>{const zr=Number(Bt||0);if(!zr)return 0;const ur=String(tr||"").trim();return ur&&Or.some(dn=>{var wr;const mn=Number(dn.amount||0);if(!(mn>0))return!1;const kr=Math.abs(mn-zr)<.01,Qe=String(dn.date||"").trim()===ur,jt=!!((wr=dn.ref)!=null&&wr.saleId);return kr&&Qe&&jt})?0:zr},nt=Object.values(ne).map(Bt=>{const tr=Bt.movements.reduce((Dr,dn)=>Dr+Vr(dn.amount),0),Or=tt(Bt.initialDebt,Bt.initialDebtDate,Bt.movements);let zr="",ur=0;for(const Dr of Bt.movements){const dn=Dr.type||(Vr(Dr.amount)<0?"ABONO":"CARGO"),mn=String(Dr.date||"");if(dn==="ABONO"){const kr=Math.abs(Vr(Dr.amount));(!zr||mn>zr)&&(zr=mn,ur=kr)}}return{customerId:Bt.customerId,name:Bt.name,balance:tn(Or+tr),lastPayment:zr,lastPaymentAmount:tn(ur)}}).filter(Bt=>Bt.balance>0).sort((Bt,tr)=>tr.balance-Bt.balance),wt=tn(nt.reduce((Bt,tr)=>Bt+tr.balance,0));return{count:nt.length,totalPending:wt,list:nt.slice(0,20)}},[Y,ie,M,l]),L=g.useMemo(()=>{if(!Ze)return[];const ne=Y.filter(tt=>(tt.customerId||"").trim()===Ze.customerId).filter(tt=>!tt.date||String(tt.date)<=l).map(tt=>({id:tt.id,date:String(tt.date||""),type:String(tt.type||""),amount:tn(Vr(tt.amount))})).sort((tt,nt)=>tt.date<nt.date?-1:tt.date>nt.date?1:0);let Ue=0;return ne.map(tt=>{const nt=tt.type==="ABONO"?-tt.amount:tt.amount;return Ue=tn(Ue+nt),{...tt,running:Ue}})},[Ze,Y,l]),ue=g.useMemo(()=>Ze?de.filter(ne=>(ne.customerId||"").trim()===Ze.customerId).filter(ne=>!ne.date||String(ne.date)<=l).sort((ne,Ue)=>ne.date<Ue.date?-1:ne.date>Ue.date?1:0):[],[Ze,de,l]),Pe=g.useMemo(()=>{const ne=tn(me.salesTotal),Ue=tn(me.commTotal),tt=tn(Ft.total),nt=tn(ne-Ue-tt),wt=new Set;for(const Dr of Me)Dr.date&&wt.add(Dr.date);const Bt=Math.max(1,wt.size),tr=tn(ne/Bt),Or=tn(Ue/Bt),zr=tn(tt/Bt),ur=tn(nt/Bt);return{ingreso:ne,comision:Ue,gastos:tt,gananciaNeta:nt,daysCount:Bt,ingresoDia:tr,comisionDia:Or,gastosDia:zr,netaDia:ur}},[me,Ft.total,Me]),xe=g.useMemo(()=>{const ne={};for(const wt of Me){const Bt=wt.date;Bt&&(ne[Bt]||(ne[Bt]={date:Bt,ingreso:0,comision:0}),ne[Bt].ingreso+=Vr(wt.amount),ne[Bt].comision+=Vr(wt.commission))}const Ue=Object.keys(ne).sort((wt,Bt)=>wt<Bt?-1:1),tt=Ue.map(wt=>({label:wt.slice(5),value:tn(ne[wt].ingreso)})),nt=Ue.map(wt=>{var ur,Dr;const Bt=Vr((ur=ne[wt])==null?void 0:ur.ingreso),tr=Vr((Dr=ne[wt])==null?void 0:Dr.comision),Or=Vr(Ft.byDay[wt]||0),zr=Bt-tr-Or;return{label:wt.slice(5),value:tn(zr)}});return{seriesIngreso:tt,seriesNeta:nt,datesCount:Ue.length}},[Me,Ft.byDay]),Ge=g.useMemo(()=>[{label:"Rivas",value:Vr(mt.RIVAS.sales)},{label:"San Jorge",value:Vr(mt.SAN_JORGE.sales)},{label:"Isla",value:Vr(mt.ISLA.sales)}].map(ne=>({...ne,value:tn(ne.value)})),[mt]),ze=async()=>{if(vt.current){vt.current.classList.add("force-pdf-colors");try{const Ue=(await $m(vt.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),tt=new An;tt.addImage(Ue,"PNG",10,10,190,0),tt.save(`data_center_dulces_${s}_a_${l}.pdf`)}finally{vt.current.classList.remove("force-pdf-colors")}}},Ke=()=>{const Ue=[["date","processedDate","status","type","vendorId","vendorName","branch","productName","packages","amount","commission","customerId","customerName"].join(","),...Me.map(Bt=>[Bt.date,Bt.processedDate||"",Bt.status,Bt.type,Bt.vendorId,`"${String(Bt.vendorName||"").replace(/"/g,'""')}"`,Bt.branch||"",`"${String(Bt.productName||"").replace(/"/g,'""')}"`,bi(Bt.packages),Wr(Bt.amount),Wr(Bt.commission),Bt.customerId||"",`"${String(fe(Bt)||"").replace(/"/g,'""')}"`].join(","))],tt=new Blob([Ue.join(`
`)],{type:"text/csv;charset=utf-8;"}),nt=URL.createObjectURL(tt),wt=document.createElement("a");wt.href=nt,wt.download=`data_center_dulces_${s}_a_${l}.csv`,wt.click(),URL.revokeObjectURL(nt)};return n?i.jsxs("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 md:px-0",children:[i.jsxs("div",{className:"bg-white p-3 sm:p-4 md:p-6 rounded-2xl shadow-2xl",children:[i.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between mb-4",children:[i.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold",children:"Data Center - Dulces"}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:items-center sm:justify-end",children:[i.jsx("button",{onClick:ze,className:`\r
                inline-flex items-center justify-center gap-2\r
                w-full sm:w-auto\r
                px-3 py-2 text-sm font-semibold\r
                rounded-lg md:rounded-md\r
                bg-green-600 text-white hover:bg-green-700 transition-colors\r
              `,children:"Exportar PDF"}),i.jsx("button",{onClick:Ke,className:`\r
                inline-flex items-center justify-center gap-2\r
                w-full sm:w-auto\r
                px-3 py-2 text-sm font-semibold\r
                rounded-lg md:rounded-md\r
                bg-gray-800 text-white hover:bg-black transition-colors\r
              `,children:"Exportar CSV"})]})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-3",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Re(ne=>!ne),"aria-expanded":Et,children:[i.jsx("span",{children:"Filtros"}),i.jsx("span",{className:`transition-transform ${Et?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${Et?"block":"hidden"} border-t p-3 sm:p-4`,children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded-lg px-3 py-2 w-full text-sm",value:s,onChange:ne=>o(ne.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded-lg px-3 py-2 w-full text-sm",value:l,onChange:ne=>c(ne.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Estado"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:d,onChange:ne=>u(ne.target.value),children:[i.jsx("option",{value:"TODAS",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Procesada"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Tipo"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:f,onChange:ne=>A(ne.target.value),children:[i.jsx("option",{value:"AMBAS",children:"Ambas"}),i.jsx("option",{value:"CASH",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Vendedor"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:h,onChange:ne=>m(ne.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),le.map(ne=>i.jsx("option",{value:ne.id,children:ne.name||ne.id},ne.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Sucursal"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:p,onChange:ne=>x(ne.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"RIVAS",children:"Rivas"}),i.jsx("option",{value:"SAN_JORGE",children:"San Jorge"}),i.jsx("option",{value:"ISLA",children:"Isla"})]})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Producto (opcional)"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:v,onChange:ne=>y(ne.target.value),placeholder:"Ej: Conitos"})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Cliente (opcional)"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:b,onChange:ne=>w(ne.target.value),placeholder:"Ej: Javier"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Monto min"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:I,onChange:ne=>j(ne.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Monto max"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:N,onChange:ne=>S(ne.target.value),placeholder:"999999"})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Agrupar por"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:E,onChange:ne=>{ke(""),B(ne.target.value)},children:[i.jsx("option",{value:"DIA",children:"Da"}),i.jsx("option",{value:"VENDEDOR",children:"Vendedor"}),i.jsx("option",{value:"PRODUCTO",children:"Producto"}),i.jsx("option",{value:"SUCURSAL",children:"Sucursal"})]})]})]})})]}),i.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between mb-4",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>{Ee(""),Rt("MACRO")},className:["px-3 py-2 rounded-full text-sm font-semibold border transition-colors",Lt==="MACRO"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-800 border-gray-200 hover:bg-gray-50"].join(" "),children:"Data Macro"}),i.jsx("button",{onClick:()=>{Ee(""),Rt("DETALLE")},className:["px-3 py-2 rounded-full text-sm font-semibold border transition-colors",Lt==="DETALLE"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-800 border-gray-200 hover:bg-gray-50"].join(" "),children:"Data Detalle"})]}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Gastos del perodo (expenses_candies):"," ",i.jsxs("strong",{children:["C$",Wr(Ft.total)]})]})]}),i.jsxs("div",{ref:vt,children:[Lt==="MACRO"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Ye(ne=>!ne),"aria-expanded":Te,children:[i.jsx("span",{children:"KPI"}),i.jsx("span",{className:`transition-transform ${Te?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${Te?"block":"hidden"} border-t p-3`,children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ingreso (ventas)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Wr(Pe.ingreso)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin vendedor (ventas)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["-C$",Wr(Pe.comision)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",Wr(me.commCash),"  Crdito: C$",Wr(me.commCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos (expenses_candies)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["-C$",Wr(Pe.gastos)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se calcula automtico por fechas"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia neta (real)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Wr(Pe.gananciaNeta)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Ingreso  Comisin  Gastos"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Promedio neto por da"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Wr(Pe.netaDia)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Das con ventas: ",i.jsx("strong",{children:Pe.daysCount})]})]})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 mb-3",children:[i.jsx(VG,{title:"Ventas por da (Ingreso)",series:xe.seriesIngreso,valuePrefix:"C$"}),i.jsx(VG,{title:"Ganancia neta por da (real)",series:xe.seriesNeta,valuePrefix:"C$"})]}),i.jsx("div",{className:"mb-6",children:i.jsx(VVe,{title:"Distribucin de ventas por sucursal",items:Ge})})]}),Lt==="DETALLE"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Ye(ne=>!ne),"aria-expanded":Te,children:[i.jsx("span",{children:"KPI"}),i.jsx("span",{className:`transition-transform ${Te?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${Te?"block":"hidden"} border-t p-3`,children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:bi(me.packsCash)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:bi(me.packsCredit)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas totales"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Wr(me.salesTotal)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",Wr(me.salesCash),"  Crdito: C$",Wr(me.salesCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Wr(me.commTotal)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",Wr(me.commCash),"  Crdito: C$",Wr(me.commCredit)]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta Aprox. (rdenes maestras)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Wr(ye.grossIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total esperado (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold mt-2",children:["C$",Wr(ye.expectedIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Actual ventas (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold mt-2",children:["C$",Wr(mt.ISLA.sales)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Diferencia vs esperado (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold mt-2",children:["C$",Wr(gt.ISLA)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado (precio proveedor)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Wr(Oe)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Sumatoria rdenes maestras (perodo)"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad neta (rdenes vendedor)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Wr(Le.net)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"U bruta  Gastos  U vendedor"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados (maestras)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:bi(Pt.orderedPacksMaster)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Restantes (perodo):"," ",i.jsx("strong",{children:bi(Pt.remainingPacksMaster)})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Existencia global (todas):"," ",i.jsx("strong",{children:bi(st.masterRemainingPackages)})]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados (rdenes vendedor)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:bi(Pt.orderedPacksVendor)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Restantes (perodo):"," ",i.jsx("strong",{children:bi(Pt.remainingPacksVendor)})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Existencia global (todas):"," ",i.jsx("strong",{children:bi(st.vendorRemainingPackages)})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado a precio proveedor (rdenes vendedor)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Wr(Pt.providerTotalVendor)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Productos dispersados (precio venta)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Wr(Ae.dispersedTotal)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Sumatoria rdenes de vendedores (perodo)"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Dispersado Isla (precio venta)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Wr(Ae.dispersedIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Usado para Total existente"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total existente en productos (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Wr(Ae.totalExistenteIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Esperado Isla  Dispersado Isla"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"CxC (ventas crdito)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Wr(ut.cxc)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Wr(me.commCredit)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Recaudacin (abonos)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Wr(ut.recaudado)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"abonos en ar_movements"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad bruta crdito (ventas  comisin)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Wr(ut.utilidadBruta)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Paquetes vendidos al crdito"})]})]})]})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Fe(ne=>!ne),"aria-expanded":dt,children:[i.jsx("span",{children:"rdenes vendedores"}),i.jsx("span",{className:`transition-transform ${dt?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${dt?"block":"hidden"} border-t p-3 sm:p-4`,children:[i.jsxs("div",{className:"border rounded-2xl p-3 sm:p-4 mb-4 shadow-sm bg-white border-gray-100",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[i.jsx("h3",{className:"font-semibold text-sm sm:text-base",children:"rdenes de vendedores (Global)"}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Basado en ",i.jsx("strong",{children:"precio de venta"})," (por sucursal del vendedor)"]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-2 text-sm",children:[i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total orden:"," ",i.jsxs("strong",{children:["C$",Wr(be.global.totalOrden)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Vendido:"," ",i.jsxs("strong",{children:["C$",Wr(be.global.vendido)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Restante:"," ",i.jsxs("strong",{children:["C$",Wr(be.global.restante)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Comisin:"," ",i.jsxs("strong",{children:["C$",Wr(be.global.comision)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total esperado:"," ",i.jsxs("strong",{children:["C$",Wr(be.global.totalEsperado)]})]})]})]}),i.jsxs("div",{className:"border rounded-2xl p-3 sm:p-4 mb-6 shadow-sm bg-white border-gray-100",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2 mb-3",children:[i.jsx("h3",{className:"font-semibold text-sm sm:text-base",children:"rdenes de vendedores (Detalle por orden)"}),i.jsx("div",{className:"text-xs text-gray-500",children:"Click/Tap en una orden para ver productos asociados/vendidos/restantes"})]}),be.orders.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:""}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"md:hidden space-y-2",children:be.orders.map(ne=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:ne.orderId}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1 truncate",children:[ne.sellerName," ",ne.branch?` ${ne.branch}`:""," ",ne.date?` ${ne.date}`:""]})]}),i.jsx("button",{className:"px-3 py-2 rounded-lg bg-gray-800 text-white text-sm font-semibold",onClick:()=>Ee(ne.orderKey),children:"Ver"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total"}),i.jsxs("div",{className:"font-bold",children:["C$",Wr(ne.totalOrden)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendido"}),i.jsxs("div",{className:"font-bold",children:["C$",Wr(ne.vendido)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Restante"}),i.jsxs("div",{className:"font-bold",children:["C$",Wr(ne.restante)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),i.jsxs("div",{className:"font-bold",children:["C$",Wr(ne.comision)]})]})]})]},ne.orderKey))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total orden"}),i.jsx("th",{className:"border p-2",children:"Vendido"}),i.jsx("th",{className:"border p-2",children:"Restante"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Total esperado"}),i.jsx("th",{className:"border p-2",children:"Accin"})]})}),i.jsx("tbody",{children:be.orders.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:ne.sellerName}),i.jsx("td",{className:"border p-2",children:ne.branch||""}),i.jsx("td",{className:"border p-2",children:ne.date||""}),i.jsxs("td",{className:"border p-2",children:["C$",Wr(ne.totalOrden)]}),i.jsxs("td",{className:"border p-2",children:["C$",Wr(ne.vendido)]}),i.jsxs("td",{className:"border p-2",children:["C$",Wr(ne.restante)]}),i.jsxs("td",{className:"border p-2",children:["C$",Wr(ne.comision)]}),i.jsxs("td",{className:"border p-2",children:["C$",Wr(ne.totalEsperado)]}),i.jsx("td",{className:"border p-2",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-3 py-2 rounded-lg hover:bg-black",onClick:()=>Ee(ne.orderKey),children:"Ver detalle"})})]},ne.orderKey))})]})}),ct&&i.jsxs("div",{className:"mt-4 rounded-2xl border-2 border-gray-100 p-3 sm:p-4 shadow-lg bg-white",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-3",children:[i.jsxs("h4",{className:"text-base sm:text-xl font-semibold truncate",children:["Detalle orden vendedor "," ",ct.orderId]}),i.jsx("button",{onClick:()=>Ee(""),className:"w-full sm:w-auto text-sm px-3 py-2 border rounded-lg hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-2 text-sm mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total orden:"," ",i.jsxs("strong",{children:["C$",Wr(ct.totalOrden)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Vendido:"," ",i.jsxs("strong",{children:["C$",Wr(ct.vendido)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Restante:"," ",i.jsxs("strong",{children:["C$",Wr(ct.restante)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Comisin:"," ",i.jsxs("strong",{children:["C$",Wr(ct.comision)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total esperado:"," ",i.jsxs("strong",{children:["C$",Wr(ct.totalEsperado)]})]})]}),i.jsx("h5",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Productos asociados (Nombre - Asociados - Vendidos - Restantes)"}),i.jsx("div",{className:"md:hidden space-y-2",children:ct.products.map(ne=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsx("div",{className:"font-semibold",children:ne.productName}),i.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Asociados"}),i.jsx("div",{className:"font-bold",children:ne.asociados})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendidos"}),i.jsx("div",{className:"font-bold",children:ne.vendidos})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Restantes"}),i.jsx("div",{className:"font-bold",children:ne.restantes})]})]})]},ne.productName))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:"Nombre producto"}),i.jsx("th",{className:"border p-2",children:"Asociados"}),i.jsx("th",{className:"border p-2",children:"Vendidos"}),i.jsx("th",{className:"border p-2",children:"Restantes"})]})}),i.jsxs("tbody",{children:[ct.products.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:ne.productName}),i.jsx("td",{className:"border p-2",children:ne.asociados}),i.jsx("td",{className:"border p-2",children:ne.vendidos}),i.jsx("td",{className:"border p-2",children:ne.restantes})]},ne.productName)),ct.products.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center text-gray-500",children:"Sin productos."})})]})]})})]})]})]})]})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>We(ne=>!ne),"aria-expanded":je,children:[i.jsx("span",{children:"Existencias"}),i.jsx("span",{className:`transition-transform ${je?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${je?"block":"hidden"} border-t p-3`,children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Existencia global (maestras)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:bi(st.masterRemainingPackages)}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"remainingPackages (todas)"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Existencia global (vendedores)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:bi(st.vendorRemainingPackages)}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"remainingPackages (todas)"})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Ve(ne=>!ne),"aria-expanded":ee,children:[i.jsx("span",{children:"Vendedores"}),i.jsx("span",{className:`transition-transform ${ee?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${ee?"block":"hidden"} border-t p-3`,children:i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin cash)"}),yt.cashArr.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-auto pr-1",children:yt.cashArr.map(ne=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:ne.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Wr(ne.total)]})]},ne.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin crdito)"}),yt.creditArr.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-auto pr-1",children:yt.creditArr.map(ne=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:ne.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Wr(ne.total)]})]},ne.vendorId))})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-6",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>$e(ne=>!ne),"aria-expanded":rt,children:[i.jsx("span",{children:"Saldos pendientes"}),i.jsx("span",{className:`transition-transform ${rt?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${rt?"block":"hidden"} border-t p-3 sm:p-4`,children:[i.jsxs("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:["Saldos pendientes (hasta ",l,")"]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 text-sm mb-3",children:[i.jsxs("div",{children:["Clientes con saldo: ",i.jsx("strong",{children:H.count})]}),i.jsxs("div",{children:["Saldo total pendiente:"," ",i.jsxs("strong",{children:["C$",Wr(H.totalPending)]})]}),i.jsx("div",{className:"text-gray-500",children:"*Muestra top 20 por monto"})]}),H.list.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:""}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"md:hidden space-y-2",children:H.list.map(ne=>i.jsxs("div",{className:"border rounded-xl p-3",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:ne.name}),i.jsxs("div",{className:"text-sm font-bold whitespace-nowrap",children:["C$",Wr(ne.balance)]})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["ltimo abono:"," ",i.jsxs("b",{children:["C$",Wr(ne.lastPaymentAmount)]})]}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Fecha ult. abono:"," ",i.jsx("span",{className:"font-medium",children:ne.lastPayment||""})]}),i.jsx("div",{className:"mt-2",children:i.jsx("button",{type:"button",onClick:()=>ot(ne),className:"px-3 py-1 rounded bg-indigo-600 text-white text-xs hover:bg-indigo-700",children:"Ver"})})]},ne.customerId))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Saldo pendiente"}),i.jsx("th",{className:"border p-2",children:"ltimo abono"}),i.jsx("th",{className:"border p-2",children:"Fecha ult. abono"}),i.jsx("th",{className:"border p-2",children:"Ver"})]})}),i.jsx("tbody",{children:H.list.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:ne.name}),i.jsxs("td",{className:"border p-2",children:["C$",Wr(ne.balance)]}),i.jsxs("td",{className:"border p-2",children:["C$",Wr(ne.lastPaymentAmount)]}),i.jsx("td",{className:"border p-2",children:ne.lastPayment||""}),i.jsx("td",{className:"border p-2",children:i.jsx("button",{type:"button",onClick:()=>ot(ne),className:"px-3 py-1 rounded bg-indigo-600 text-white text-xs hover:bg-indigo-700",children:"Ver"})})]},ne.customerId))})]})})]})]})]}),i.jsxs("div",{className:"mb-3 flex flex-col sm:flex-row sm:items-center gap-2",children:[i.jsxs("h3",{className:"font-semibold text-sm sm:text-base",children:["Tabla principal (Agrupar por: ",E,")"]}),i.jsx("span",{className:"text-xs text-gray-500 sm:ml-auto",children:"Tap/Click en Ver detalle para drill-down"})]}),k?i.jsx("p",{className:"text-sm",children:"Cargando..."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"md:hidden space-y-2 mb-6",children:z.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-center text-gray-500",children:"Sin datos con los filtros seleccionados."}):z.map(ne=>i.jsxs("div",{className:"border rounded-2xl p-3 shadow-sm bg-white",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:ne.label}),i.jsx("button",{className:"px-3 py-2 rounded-lg bg-gray-800 text-white text-sm font-semibold",onClick:()=>ke(ne.key),children:"Ver detalle"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"font-bold",children:bi(ne.packsCash)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"font-bold",children:bi(ne.packsCredit)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsxs("div",{className:"font-bold",children:["C$",Wr(ne.salesCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",Wr(ne.salesCredit)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash"}),i.jsxs("div",{className:"font-bold",children:["C$",Wr(ne.commCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",Wr(ne.commCredit)]})]})]})]},ne.key))}),i.jsx("div",{className:"hidden md:block overflow-x-auto mb-6 shadow-2xl rounded-xl border",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:E==="DIA"?"Da":E==="VENDEDOR"?"Vendedor":E==="PRODUCTO"?"Producto":"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"}),i.jsx("th",{className:"border p-2",children:"Opciones"})]})}),i.jsxs("tbody",{children:[z.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:ne.label}),i.jsx("td",{className:"border p-2",children:bi(ne.packsCash)}),i.jsx("td",{className:"border p-2",children:bi(ne.packsCredit)}),i.jsxs("td",{className:"border p-2",children:["C$",Wr(ne.salesCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",Wr(ne.salesCredit)]}),i.jsxs("td",{className:"border p-2",children:["C$",Wr(ne.commCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",Wr(ne.commCredit)]}),i.jsx("td",{className:"border p-2",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-3 py-2 rounded-lg hover:bg-black",onClick:()=>ke(ne.key),children:"Ver detalle"})})]},ne.key)),z.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Sin datos con los filtros seleccionados."})})]})]})})]}),Z&&i.jsxs("div",{className:"rounded-2xl shadow-lg p-3 sm:p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-3",children:[i.jsxs("h2",{className:"text-base sm:text-xl font-semibold truncate",children:["Detalle "," ",((pt=z.find(ne=>ne.key===Z))==null?void 0:pt.label)||Z]}),i.jsx("button",{onClick:()=>ke(""),className:"w-full sm:w-auto text-sm px-3 py-2 border rounded-lg hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 text-sm mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total Ventas cash:"," ",i.jsxs("strong",{children:["C$",Wr(X.filter(ne=>ne.type==="CONTADO").reduce((ne,Ue)=>ne+Vr(Ue.amount),0))]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total Ventas crdito:"," ",i.jsxs("strong",{children:["C$",Wr(X.filter(ne=>ne.type==="CREDITO").reduce((ne,Ue)=>ne+Vr(Ue.amount),0))]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total paquetes cash:"," ",i.jsx("strong",{children:bi(X.filter(ne=>ne.type==="CONTADO").reduce((ne,Ue)=>ne+Vr(Ue.packages),0))})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total paquetes crdito:"," ",i.jsx("strong",{children:bi(X.filter(ne=>ne.type==="CREDITO").reduce((ne,Ue)=>ne+Vr(Ue.packages),0))})]})]}),i.jsx("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Ventas incluidas"}),i.jsx("div",{className:"md:hidden space-y-2 mb-4",children:X.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-center text-gray-500",children:"Sin detalle."}):X.map(ne=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:ne.productName}),i.jsxs("div",{className:"text-sm font-bold whitespace-nowrap",children:["C$",Wr(ne.amount)]})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Vendedor:"," ",i.jsx("span",{className:"font-medium",children:ne.vendorName})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Tipo"}),i.jsx("div",{className:"font-bold",children:ne.type==="CREDITO"?"Crdito":"Cash"})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Sucursal"}),i.jsx("div",{className:"font-bold",children:ne.branch||""})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("div",{className:"font-bold",children:bi(ne.packages)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),i.jsxs("div",{className:"font-bold",children:["C$",Wr(ne.commission)]})]})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Fecha: ",ne.date]})]},ne.id))}),i.jsx("div",{className:"hidden md:block overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"})]})}),i.jsxs("tbody",{children:[X.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2",children:ne.vendorName}),i.jsx("td",{className:"border p-2",children:ne.productName}),i.jsx("td",{className:"border p-2",children:ne.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-2",children:ne.branch||""}),i.jsx("td",{className:"border p-2",children:bi(ne.packages)}),i.jsxs("td",{className:"border p-2",children:["C$",Wr(ne.amount)]}),i.jsxs("td",{className:"border p-2",children:["C$",Wr(ne.commission)]}),i.jsx("td",{className:"border p-2",children:ne.date})]},ne.id)),X.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Sin detalle."})})]})]})}),i.jsx("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Consolidado por producto"}),i.jsx("div",{className:"md:hidden space-y-2",children:re.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-center text-gray-500",children:"Sin consolidado."}):re.map(ne=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsx("div",{className:"font-semibold",children:ne.productName}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paq cash"}),i.jsx("div",{className:"font-bold",children:bi(ne.packsCash)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paq crdito"}),i.jsx("div",{className:"font-bold",children:bi(ne.packsCredit)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsxs("div",{className:"font-bold",children:["C$",Wr(ne.salesCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",Wr(ne.salesCredit)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Com cash"}),i.jsxs("div",{className:"font-bold",children:["C$",Wr(ne.commCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Com crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",Wr(ne.commCredit)]})]})]})]},ne.productName))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"})]})}),i.jsxs("tbody",{children:[re.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:ne.productName}),i.jsx("td",{className:"border p-2",children:bi(ne.packsCash)}),i.jsx("td",{className:"border p-2",children:bi(ne.packsCredit)}),i.jsxs("td",{className:"border p-2",children:["C$",Wr(ne.salesCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",Wr(ne.salesCredit)]}),i.jsxs("td",{className:"border p-2",children:["C$",Wr(ne.commCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",Wr(ne.commCredit)]})]},ne.productName)),re.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"p-4 text-center text-gray-500",children:"Sin consolidado."})})]})]})})]})]})]}),P&&i.jsx("p",{className:"mt-3 text-sm",children:P})]}),Ze&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-lg",children:Ze.name}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Saldo pendiente: ",i.jsxs("b",{children:["C$",Wr(Ze.balance)]})]})]}),i.jsx("button",{type:"button",onClick:()=>ot(null),className:"text-sm text-gray-500 hover:text-gray-700",children:""})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Saldo"})]})}),i.jsx("tbody",{children:L.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"border p-2 text-center text-gray-500",children:"Sin movimientos."})}):L.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ne.date||""}),i.jsx("td",{className:"border p-1",children:ne.type||""}),i.jsxs("td",{className:"border p-1",children:["C$",Wr(ne.amount)]}),i.jsxs("td",{className:"border p-1",children:["C$",Wr(ne.running)]})]},ne.id))})]})}),i.jsx("div",{className:"mt-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Monto"})]})}),i.jsx("tbody",{children:ue.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"border p-2 text-center text-gray-500",children:"Sin ventas asociadas."})}):ue.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ne.date||""}),i.jsx("td",{className:"border p-1",children:ne.productName||""}),i.jsx("td",{className:"border p-1",children:ne.vendorName||""}),i.jsx("td",{className:"border p-1",children:ne.type||""}),i.jsxs("td",{className:"border p-1",children:["C$",Wr(ne.amount)]})]},ne.id))})]})})]})})]}):i.jsxs("div",{className:"max-w-5xl mx-auto p-3 sm:p-4 md:p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-lg md:text-xl font-bold",children:"Data Center - Dulces"}),i.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"No autorizado."})]})}function rie(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(r=rie(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function vs(){for(var t,e,r=0,n="",a=arguments.length;r<a;r++)(t=arguments[r])&&(e=rie(t))&&(n&&(n+=" "),n+=e);return n}var GVe=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function eM(t){if(typeof t!="string")return!1;var e=GVe;return e.includes(t)}var KVe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],qVe=new Set(KVe);function nie(t){return typeof t!="string"?!1:qVe.has(t)}function aie(t){return typeof t=="string"&&t.startsWith("data-")}function hh(t){if(typeof t!="object"||t===null)return{};var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(nie(r)||aie(r))&&(e[r]=t[r]);return e}function ew(t){if(t==null)return null;if(g.isValidElement(t)&&typeof t.props=="object"&&t.props!==null){var e=t.props;return hh(e)}return typeof t=="object"&&!Array.isArray(t)?hh(t):null}function Qu(t){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(nie(r)||aie(r)||eM(r))&&(e[r]=t[r]);return e}var zVe=["children","width","height","viewBox","className","style","title","desc"];function BF(){return BF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},BF.apply(null,arguments)}function WVe(t,e){if(t==null)return{};var r,n,a=XVe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function XVe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var tM=g.forwardRef((t,e)=>{var{children:r,width:n,height:a,viewBox:s,className:o,style:l,title:c,desc:d}=t,u=WVe(t,zVe),f=s||{width:n,height:a,x:0,y:0},A=vs("recharts-surface",o);return g.createElement("svg",BF({},Qu(u),{className:A,width:n,height:a,style:l,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:e}),g.createElement("title",null,c),g.createElement("desc",null,d),r)}),YVe=["children","className"];function kF(){return kF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},kF.apply(null,arguments)}function JVe(t,e){if(t==null)return{};var r,n,a=ZVe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function ZVe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var $c=g.forwardRef((t,e)=>{var{children:r,className:n}=t,a=JVe(t,YVe),s=vs("recharts-layer",n);return g.createElement("g",kF({className:s},Qu(a),{ref:e}),r)}),sie=g.createContext(null),eHe=()=>g.useContext(sie);function Os(t){return function(){return t}}const iie=Math.cos,Aj=Math.sin,Df=Math.sqrt,mj=Math.PI,jP=2*mj,FF=Math.PI,OF=2*FF,gp=1e-6,tHe=OF-gp;function oie(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function rHe(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return oie;const r=10**e;return function(n){this._+=n[0];for(let a=1,s=n.length;a<s;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class nHe{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?oie:rHe(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,a){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(e,r,n,a,s,o){this._append`C${+e},${+r},${+n},${+a},${this._x1=+s},${this._y1=+o}`}arcTo(e,r,n,a,s){if(e=+e,r=+r,n=+n,a=+a,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,l=this._y1,c=n-e,d=a-r,u=o-e,f=l-r,A=u*u+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(A>gp)if(!(Math.abs(f*c-d*u)>gp)||!s)this._append`L${this._x1=e},${this._y1=r}`;else{let h=n-o,m=a-l,p=c*c+d*d,x=h*h+m*m,v=Math.sqrt(p),y=Math.sqrt(A),b=s*Math.tan((FF-Math.acos((p+A-x)/(2*v*y)))/2),w=b/y,I=b/v;Math.abs(w-1)>gp&&this._append`L${e+w*u},${r+w*f}`,this._append`A${s},${s},0,0,${+(f*h>u*m)},${this._x1=e+I*c},${this._y1=r+I*d}`}}arc(e,r,n,a,s,o){if(e=+e,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),d=e+l,u=r+c,f=1^o,A=o?a-s:s-a;this._x1===null?this._append`M${d},${u}`:(Math.abs(this._x1-d)>gp||Math.abs(this._y1-u)>gp)&&this._append`L${d},${u}`,n&&(A<0&&(A=A%OF+OF),A>tHe?this._append`A${n},${n},0,1,${f},${e-l},${r-c}A${n},${n},0,1,${f},${this._x1=d},${this._y1=u}`:A>gp&&this._append`A${n},${n},0,${+(A>=FF)},${f},${this._x1=e+n*Math.cos(s)},${this._y1=r+n*Math.sin(s)}`)}rect(e,r,n,a){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function rM(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new nHe(e)}function nM(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function lie(t){this._context=t}lie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function IP(t){return new lie(t)}function cie(t){return t[0]}function die(t){return t[1]}function uie(t,e){var r=Os(!0),n=null,a=IP,s=null,o=rM(l);t=typeof t=="function"?t:t===void 0?cie:Os(t),e=typeof e=="function"?e:e===void 0?die:Os(e);function l(c){var d,u=(c=nM(c)).length,f,A=!1,h;for(n==null&&(s=a(h=o())),d=0;d<=u;++d)!(d<u&&r(f=c[d],d,c))===A&&((A=!A)?s.lineStart():s.lineEnd()),A&&s.point(+t(f,d,c),+e(f,d,c));if(h)return s=null,h+""||null}return l.x=function(c){return arguments.length?(t=typeof c=="function"?c:Os(+c),l):t},l.y=function(c){return arguments.length?(e=typeof c=="function"?c:Os(+c),l):e},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Os(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(s=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=s=null:s=a(n=c),l):n},l}function w_(t,e,r){var n=null,a=Os(!0),s=null,o=IP,l=null,c=rM(d);t=typeof t=="function"?t:t===void 0?cie:Os(+t),e=typeof e=="function"?e:Os(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?die:Os(+r);function d(f){var A,h,m,p=(f=nM(f)).length,x,v=!1,y,b=new Array(p),w=new Array(p);for(s==null&&(l=o(y=c())),A=0;A<=p;++A){if(!(A<p&&a(x=f[A],A,f))===v)if(v=!v)h=A,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),m=A-1;m>=h;--m)l.point(b[m],w[m]);l.lineEnd(),l.areaEnd()}v&&(b[A]=+t(x,A,f),w[A]=+e(x,A,f),l.point(n?+n(x,A,f):b[A],r?+r(x,A,f):w[A]))}if(y)return l=null,y+""||null}function u(){return uie().defined(a).curve(o).context(s)}return d.x=function(f){return arguments.length?(t=typeof f=="function"?f:Os(+f),n=null,d):t},d.x0=function(f){return arguments.length?(t=typeof f=="function"?f:Os(+f),d):t},d.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Os(+f),d):n},d.y=function(f){return arguments.length?(e=typeof f=="function"?f:Os(+f),r=null,d):e},d.y0=function(f){return arguments.length?(e=typeof f=="function"?f:Os(+f),d):e},d.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:Os(+f),d):r},d.lineX0=d.lineY0=function(){return u().x(t).y(e)},d.lineY1=function(){return u().x(t).y(r)},d.lineX1=function(){return u().x(n).y(e)},d.defined=function(f){return arguments.length?(a=typeof f=="function"?f:Os(!!f),d):a},d.curve=function(f){return arguments.length?(o=f,s!=null&&(l=o(s)),d):o},d.context=function(f){return arguments.length?(f==null?s=l=null:l=o(s=f),d):s},d}class fie{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function aHe(t){return new fie(t,!0)}function sHe(t){return new fie(t,!1)}const aM={draw(t,e){const r=Df(e/mj);t.moveTo(r,0),t.arc(0,0,r,0,jP)}},iHe={draw(t,e){const r=Df(e/5)/2;t.moveTo(-3*r,-r),t.lineTo(-r,-r),t.lineTo(-r,-3*r),t.lineTo(r,-3*r),t.lineTo(r,-r),t.lineTo(3*r,-r),t.lineTo(3*r,r),t.lineTo(r,r),t.lineTo(r,3*r),t.lineTo(-r,3*r),t.lineTo(-r,r),t.lineTo(-3*r,r),t.closePath()}},hie=Df(1/3),oHe=hie*2,lHe={draw(t,e){const r=Df(e/oHe),n=r*hie;t.moveTo(0,-r),t.lineTo(n,0),t.lineTo(0,r),t.lineTo(-n,0),t.closePath()}},cHe={draw(t,e){const r=Df(e),n=-r/2;t.rect(n,n,r,r)}},dHe=.8908130915292852,Aie=Aj(mj/10)/Aj(7*mj/10),uHe=Aj(jP/10)*Aie,fHe=-iie(jP/10)*Aie,hHe={draw(t,e){const r=Df(e*dHe),n=uHe*r,a=fHe*r;t.moveTo(0,-r),t.lineTo(n,a);for(let s=1;s<5;++s){const o=jP*s/5,l=iie(o),c=Aj(o);t.lineTo(c*r,-l*r),t.lineTo(l*n-c*a,c*n+l*a)}t.closePath()}},bT=Df(3),AHe={draw(t,e){const r=-Df(e/(bT*3));t.moveTo(0,r*2),t.lineTo(-bT*r,-r),t.lineTo(bT*r,-r),t.closePath()}},uu=-.5,fu=Df(3)/2,DF=1/Df(12),mHe=(DF/2+1)*3,pHe={draw(t,e){const r=Df(e/mHe),n=r/2,a=r*DF,s=n,o=r*DF+r,l=-s,c=o;t.moveTo(n,a),t.lineTo(s,o),t.lineTo(l,c),t.lineTo(uu*n-fu*a,fu*n+uu*a),t.lineTo(uu*s-fu*o,fu*s+uu*o),t.lineTo(uu*l-fu*c,fu*l+uu*c),t.lineTo(uu*n+fu*a,uu*a-fu*n),t.lineTo(uu*s+fu*o,uu*o-fu*s),t.lineTo(uu*l+fu*c,uu*c-fu*l),t.closePath()}};function gHe(t,e){let r=null,n=rM(a);t=typeof t=="function"?t:Os(t||aM),e=typeof e=="function"?e:Os(e===void 0?64:+e);function a(){let s;if(r||(r=s=n()),t.apply(this,arguments).draw(r,+e.apply(this,arguments)),s)return r=null,s+""||null}return a.type=function(s){return arguments.length?(t=typeof s=="function"?s:Os(s),a):t},a.size=function(s){return arguments.length?(e=typeof s=="function"?s:Os(+s),a):e},a.context=function(s){return arguments.length?(r=s??null,a):r},a}function pj(){}function gj(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function mie(t){this._context=t}mie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:gj(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:gj(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function xHe(t){return new mie(t)}function pie(t){this._context=t}pie.prototype={areaStart:pj,areaEnd:pj,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:gj(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function vHe(t){return new pie(t)}function gie(t){this._context=t}gie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:gj(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function yHe(t){return new gie(t)}function xie(t){this._context=t}xie.prototype={areaStart:pj,areaEnd:pj,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function bHe(t){return new xie(t)}function HG(t){return t<0?-1:1}function $G(t,e,r){var n=t._x1-t._x0,a=e-t._x1,s=(t._y1-t._y0)/(n||a<0&&-0),o=(r-t._y1)/(a||n<0&&-0),l=(s*a+o*n)/(n+a);return(HG(s)+HG(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(l))||0}function GG(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function wT(t,e,r){var n=t._x0,a=t._y0,s=t._x1,o=t._y1,l=(s-n)/3;t._context.bezierCurveTo(n+l,a+l*e,s-l,o-l*r,s,o)}function xj(t){this._context=t}xj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:wT(this,this._t0,GG(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,wT(this,GG(this,r=$G(this,t,e)),r);break;default:wT(this,this._t0,r=$G(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function vie(t){this._context=new yie(t)}(vie.prototype=Object.create(xj.prototype)).point=function(t,e){xj.prototype.point.call(this,e,t)};function yie(t){this._context=t}yie.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,a,s){this._context.bezierCurveTo(e,t,n,r,s,a)}};function wHe(t){return new xj(t)}function NHe(t){return new vie(t)}function bie(t){this._context=t}bie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=KG(t),a=KG(e),s=0,o=1;o<r;++s,++o)this._context.bezierCurveTo(n[0][s],a[0][s],n[1][s],a[1][s],t[o],e[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function KG(t){var e,r=t.length-1,n,a=new Array(r),s=new Array(r),o=new Array(r);for(a[0]=0,s[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)a[e]=1,s[e]=4,o[e]=4*t[e]+2*t[e+1];for(a[r-1]=2,s[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=a[e]/s[e-1],s[e]-=n,o[e]-=n*o[e-1];for(a[r-1]=o[r-1]/s[r-1],e=r-2;e>=0;--e)a[e]=(o[e]-a[e+1])/s[e];for(s[r-1]=(t[r]+a[r-1])/2,e=0;e<r-1;++e)s[e]=2*t[e+1]-a[e+1];return[a,s]}function CHe(t){return new bie(t)}function PP(t,e){this._context=t,this._t=e}PP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function _He(t){return new PP(t,.5)}function EHe(t){return new PP(t,0)}function SHe(t){return new PP(t,1)}function Cg(t,e){if((o=t.length)>1)for(var r=1,n,a,s=t[e[0]],o,l=s.length;r<o;++r)for(a=s,s=t[e[r]],n=0;n<l;++n)s[n][1]+=s[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function RF(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function jHe(t,e){return t[e]}function IHe(t){const e=[];return e.key=t,e}function PHe(){var t=Os([]),e=RF,r=Cg,n=jHe;function a(s){var o=Array.from(t.apply(this,arguments),IHe),l,c=o.length,d=-1,u;for(const f of s)for(l=0,++d;l<c;++l)(o[l][d]=[0,+n(f,o[l].key,d,s)]).data=f;for(l=0,u=nM(e(o));l<c;++l)o[u[l]].index=l;return r(o,u),o}return a.keys=function(s){return arguments.length?(t=typeof s=="function"?s:Os(Array.from(s)),a):t},a.value=function(s){return arguments.length?(n=typeof s=="function"?s:Os(+s),a):n},a.order=function(s){return arguments.length?(e=s==null?RF:typeof s=="function"?s:Os(Array.from(s)),a):e},a.offset=function(s){return arguments.length?(r=s??Cg,a):r},a}function THe(t,e){if((n=t.length)>0){for(var r,n,a=0,s=t[0].length,o;a<s;++a){for(o=r=0;r<n;++r)o+=t[r][a][1]||0;if(o)for(r=0;r<n;++r)t[r][a][1]/=o}Cg(t,e)}}function BHe(t,e){if((a=t.length)>0){for(var r=0,n=t[e[0]],a,s=n.length;r<s;++r){for(var o=0,l=0;o<a;++o)l+=t[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}Cg(t,e)}}function kHe(t,e){if(!(!((o=t.length)>0)||!((s=(a=t[e[0]]).length)>0))){for(var r=0,n=1,a,s,o;n<s;++n){for(var l=0,c=0,d=0;l<o;++l){for(var u=t[e[l]],f=u[n][1]||0,A=u[n-1][1]||0,h=(f-A)/2,m=0;m<l;++m){var p=t[e[m]],x=p[n][1]||0,v=p[n-1][1]||0;h+=x-v}c+=f,d+=h*f}a[n-1][1]+=a[n-1][0]=r,c&&(r-=d/c)}a[n-1][1]+=a[n-1][0]=r,Cg(t,e)}}var TP={},wie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==="__proto__"}t.isUnsafeProperty=e})(wie);var sM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}t.isDeepKey=e})(sM);var BP={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}t.toKey=e})(BP);var kP={},Nie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(e).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}t.toString=e})(Nie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Nie,r=BP;function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=e.toString(a);const s=[],o=a.length;if(o===0)return s;let l=0,c="",d="",u=!1;for(a.charCodeAt(0)===46&&(s.push(""),l++);l<o;){const f=a[l];d?f==="\\"&&l+1<o?(l++,c+=a[l]):f===d?d="":c+=f:u?f==='"'||f==="'"?d=f:f==="]"?(u=!1,s.push(c),c=""):c+=f:f==="["?(u=!0,c&&(s.push(c),c="")):f==="."?c&&(s.push(c),c=""):c+=f,l++}return c&&s.push(c),s}t.toPath=n})(kP);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=wie,r=sM,n=BP,a=kP;function s(l,c,d){if(l==null)return d;switch(typeof c){case"string":{if(e.isUnsafeProperty(c))return d;const u=l[c];return u===void 0?r.isDeepKey(c)?s(l,a.toPath(c),d):d:u}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const u=l[c];return u===void 0?d:u}default:{if(Array.isArray(c))return o(l,c,d);if(Object.is(c==null?void 0:c.valueOf(),-0)?c="-0":c=String(c),e.isUnsafeProperty(c))return d;const u=l[c];return u===void 0?d:u}}}function o(l,c,d){if(c.length===0)return d;let u=l;for(let f=0;f<c.length;f++){if(u==null||e.isUnsafeProperty(c[f]))return d;u=u[c[f]]}return u===void 0?d:u}t.get=s})(TP);var FHe=TP.get;const _g=kA(FHe);var OHe=4;function tm(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:OHe,r=10**e,n=Math.round(t*r)/r;return Object.is(n,-0)?0:n}function Mi(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t.reduce((a,s,o)=>{var l=r[o-1];return typeof l=="string"?a+l+s:l!==void 0?a+tm(l)+s:a+s},"")}var Hl=t=>t===0?0:t>0?1:-1,Ah=t=>typeof t=="number"&&t!=+t,EA=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,On=t=>(typeof t=="number"||t instanceof Number)&&!Ah(t),mh=t=>On(t)||typeof t=="string",DHe=0,tw=t=>{var e=++DHe;return"".concat(t||"").concat(e)},gc=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!On(e)&&typeof e!="string")return n;var s;if(EA(e)){if(r==null)return n;var o=e.indexOf("%");s=r*parseFloat(e.slice(0,o))/100}else s=+e;return Ah(s)&&(s=n),a&&r!=null&&s>r&&(s=r),s},Cie=t=>{if(!Array.isArray(t))return!1;for(var e=t.length,r={},n=0;n<e;n++)if(!r[String(t[n])])r[String(t[n])]=!0;else return!0;return!1};function Mo(t,e,r){return On(t)&&On(e)?tm(t+r*(e-t)):e}function RHe(t,e,r){if(!(!t||!t.length))return t.find(n=>n&&(typeof e=="function"?e(n):_g(n,e))===r)}var vl=t=>t===null||typeof t>"u",Jw=t=>vl(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1));function MHe(t){return t!=null}function Zw(){}var LHe=["type","size","sizeType"];function MF(){return MF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},MF.apply(null,arguments)}function qG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function zG(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qG(Object(r),!0).forEach(function(n){UHe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function UHe(t,e,r){return(e=QHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QHe(t){var e=VHe(t,"string");return typeof e=="symbol"?e:e+""}function VHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HHe(t,e){if(t==null)return{};var r,n,a=$He(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function $He(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var _ie={symbolCircle:aM,symbolCross:iHe,symbolDiamond:lHe,symbolSquare:cHe,symbolStar:hHe,symbolTriangle:AHe,symbolWye:pHe},GHe=Math.PI/180,KHe=t=>{var e="symbol".concat(Jw(t));return _ie[e]||aM},qHe=(t,e,r)=>{if(e==="area")return t;switch(r){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var n=18*GHe;return 1.25*t*t*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},zHe=(t,e)=>{_ie["symbol".concat(Jw(t))]=e},iM=t=>{var{type:e="circle",size:r=64,sizeType:n="area"}=t,a=HHe(t,LHe),s=zG(zG({},a),{},{type:e,size:r,sizeType:n}),o="circle";typeof e=="string"&&(o=e);var l=()=>{var A=KHe(o),h=gHe().type(A).size(qHe(r,n,o)),m=h();if(m!==null)return m},{className:c,cx:d,cy:u}=s,f=Qu(s);return On(d)&&On(u)&&On(r)?g.createElement("path",MF({},f,{className:vs("recharts-symbols",c),transform:"translate(".concat(d,", ").concat(u,")"),d:l()})):null};iM.registerSymbol=zHe;var Eie=t=>"radius"in t&&"startAngle"in t&&"endAngle"in t,WHe=(t,e)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(g.isValidElement(t)&&(r=t.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{eM(a)&&(n[a]=s=>r[a](r,s))}),n},XHe=(t,e,r)=>n=>(t(e,r,n),null),eN=(t,e,r)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var n=null;return Object.keys(t).forEach(a=>{var s=t[a];eM(a)&&typeof s=="function"&&(n||(n={}),n[a]=XHe(s,e,r))}),n};function WG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function YHe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?WG(Object(r),!0).forEach(function(n){JHe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):WG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function JHe(t,e,r){return(e=ZHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZHe(t){var e=e$e(t,"string");return typeof e=="symbol"?e:e+""}function e$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kl(t,e){var r=YHe({},t),n=e,a=Object.keys(e),s=a.reduce((o,l)=>(o[l]===void 0&&n[l]!==void 0&&(o[l]=n[l]),o),r);return s}function vj(){return vj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},vj.apply(null,arguments)}function XG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function t$e(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?XG(Object(r),!0).forEach(function(n){r$e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):XG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function r$e(t,e,r){return(e=n$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n$e(t){var e=a$e(t,"string");return typeof e=="symbol"?e:e+""}function a$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var vu=32,s$e={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function i$e(t){var{data:e,iconType:r,inactiveColor:n}=t,a=vu/2,s=vu/6,o=vu/3,l=e.inactive?n:e.color,c=r??e.type;if(c==="none")return null;if(c==="plainline"){var d;return g.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:(d=e.payload)===null||d===void 0?void 0:d.strokeDasharray,x1:0,y1:a,x2:vu,y2:a,className:"recharts-legend-icon"})}if(c==="line")return g.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(a,"h").concat(o,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*o,",").concat(a,`
            H`).concat(vu,"M").concat(2*o,",").concat(a,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(o,",").concat(a),className:"recharts-legend-icon"});if(c==="rect")return g.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(vu/8,"h").concat(vu,"v").concat(vu*3/4,"h").concat(-vu,"z"),className:"recharts-legend-icon"});if(g.isValidElement(e.legendIcon)){var u=t$e({},e);return delete u.legendIcon,g.cloneElement(e.legendIcon,u)}return g.createElement(iM,{fill:l,cx:a,cy:a,size:vu,sizeType:"diameter",type:c})}function o$e(t){var{payload:e,iconSize:r,layout:n,formatter:a,inactiveColor:s,iconType:o}=t,l={x:0,y:0,width:vu,height:vu},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return e.map((u,f)=>{var A=u.formatter||a,h=vs({"recharts-legend-item":!0,["legend-item-".concat(f)]:!0,inactive:u.inactive});if(u.type==="none")return null;var m=u.inactive?s:u.color,p=A?A(u.value,u,f):u.value;return g.createElement("li",vj({className:h,style:c,key:"legend-item-".concat(f)},eN(t,u,f)),g.createElement(tM,{width:r,height:r,viewBox:l,style:d,"aria-label":"".concat(p," legend icon")},g.createElement(i$e,{data:u,iconType:o,inactiveColor:s})),g.createElement("span",{className:"recharts-legend-item-text",style:{color:m}},p))})}var l$e=t=>{var e=Kl(t,s$e),{payload:r,layout:n,align:a}=e;if(!r||!r.length)return null;var s={padding:0,margin:0,textAlign:n==="horizontal"?a:"left"};return g.createElement("ul",{className:"recharts-default-legend",style:s},g.createElement(o$e,vj({},e,{payload:r})))},Sie={},jie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){const a=new Map;for(let s=0;s<r.length;s++){const o=r[s],l=n(o);a.has(l)||a.set(l,o)}return Array.from(a.values())}t.uniqBy=e})(jie);var oM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r}t.identity=e})(oM);var Iie={},FP={},Pie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Number.isSafeInteger(r)&&r>=0}t.isLength=e})(Pie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Pie;function r(n){return n!=null&&typeof n!="function"&&e.isLength(n.length)}t.isArrayLike=r})(FP);var Tie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="object"&&r!==null}t.isObjectLike=e})(Tie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=FP,r=Tie;function n(a){return r.isObjectLike(a)&&e.isArrayLike(a)}t.isArrayLikeObject=n})(Iie);var Bie={},kie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=TP;function r(n){return function(a){return e.get(a,n)}}t.property=r})(kie);var Fie={},lM={},Oie={},cM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r!==null&&(typeof r=="object"||typeof r=="function")}t.isObject=e})(cM);var dM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null||typeof r!="object"&&typeof r!="function"}t.isPrimitive=e})(dM);var uM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}t.eq=e})(uM);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=cM,r=dM,n=uM;function a(u,f,A){return typeof A!="function"?a(u,f,()=>{}):s(u,f,function h(m,p,x,v,y,b){const w=A(m,p,x,v,y,b);return w!==void 0?!!w:s(m,p,h,b)},new Map)}function s(u,f,A,h){if(f===u)return!0;switch(typeof f){case"object":return o(u,f,A,h);case"function":return Object.keys(f).length>0?s(u,{...f},A,h):n.eq(u,f);default:return e.isObject(u)?typeof f=="string"?f==="":!0:n.eq(u,f)}}function o(u,f,A,h){if(f==null)return!0;if(Array.isArray(f))return c(u,f,A,h);if(f instanceof Map)return l(u,f,A,h);if(f instanceof Set)return d(u,f,A,h);const m=Object.keys(f);if(u==null||r.isPrimitive(u))return m.length===0;if(m.length===0)return!0;if(h!=null&&h.has(f))return h.get(f)===u;h==null||h.set(f,u);try{for(let p=0;p<m.length;p++){const x=m[p];if(!r.isPrimitive(u)&&!(x in u)||f[x]===void 0&&u[x]!==void 0||f[x]===null&&u[x]!==null||!A(u[x],f[x],x,u,f,h))return!1}return!0}finally{h==null||h.delete(f)}}function l(u,f,A,h){if(f.size===0)return!0;if(!(u instanceof Map))return!1;for(const[m,p]of f.entries()){const x=u.get(m);if(A(x,p,m,u,f,h)===!1)return!1}return!0}function c(u,f,A,h){if(f.length===0)return!0;if(!Array.isArray(u))return!1;const m=new Set;for(let p=0;p<f.length;p++){const x=f[p];let v=!1;for(let y=0;y<u.length;y++){if(m.has(y))continue;const b=u[y];let w=!1;if(A(b,x,p,u,f,h)&&(w=!0),w){m.add(y),v=!0;break}}if(!v)return!1}return!0}function d(u,f,A,h){return f.size===0?!0:u instanceof Set?c([...u],[...f],A,h):!1}t.isMatchWith=a,t.isSetMatch=d})(Oie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Oie;function r(n,a){return e.isMatchWith(n,a,()=>{})}t.isMatch=r})(lM);var Die={},fM={},Rie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}t.getSymbols=e})(Rie);var hM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}t.getTag=e})(hM);var AM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",s="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",d="[object Set]",u="[object Array]",f="[object Function]",A="[object ArrayBuffer]",h="[object Object]",m="[object Error]",p="[object DataView]",x="[object Uint8Array]",v="[object Uint8ClampedArray]",y="[object Uint16Array]",b="[object Uint32Array]",w="[object BigUint64Array]",I="[object Int8Array]",j="[object Int16Array]",N="[object Int32Array]",S="[object BigInt64Array]",E="[object Float32Array]",B="[object Float64Array]";t.argumentsTag=s,t.arrayBufferTag=A,t.arrayTag=u,t.bigInt64ArrayTag=S,t.bigUint64ArrayTag=w,t.booleanTag=a,t.dataViewTag=p,t.dateTag=l,t.errorTag=m,t.float32ArrayTag=E,t.float64ArrayTag=B,t.functionTag=f,t.int16ArrayTag=j,t.int32ArrayTag=N,t.int8ArrayTag=I,t.mapTag=c,t.numberTag=n,t.objectTag=h,t.regexpTag=e,t.setTag=d,t.stringTag=r,t.symbolTag=o,t.uint16ArrayTag=y,t.uint32ArrayTag=b,t.uint8ArrayTag=x,t.uint8ClampedArrayTag=v})(AM);var Mie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}t.isTypedArray=e})(Mie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Rie,r=hM,n=AM,a=dM,s=Mie;function o(u,f){return l(u,void 0,u,new Map,f)}function l(u,f,A,h=new Map,m=void 0){const p=m==null?void 0:m(u,f,A,h);if(p!==void 0)return p;if(a.isPrimitive(u))return u;if(h.has(u))return h.get(u);if(Array.isArray(u)){const x=new Array(u.length);h.set(u,x);for(let v=0;v<u.length;v++)x[v]=l(u[v],v,A,h,m);return Object.hasOwn(u,"index")&&(x.index=u.index),Object.hasOwn(u,"input")&&(x.input=u.input),x}if(u instanceof Date)return new Date(u.getTime());if(u instanceof RegExp){const x=new RegExp(u.source,u.flags);return x.lastIndex=u.lastIndex,x}if(u instanceof Map){const x=new Map;h.set(u,x);for(const[v,y]of u)x.set(v,l(y,v,A,h,m));return x}if(u instanceof Set){const x=new Set;h.set(u,x);for(const v of u)x.add(l(v,void 0,A,h,m));return x}if(typeof Buffer<"u"&&Buffer.isBuffer(u))return u.subarray();if(s.isTypedArray(u)){const x=new(Object.getPrototypeOf(u)).constructor(u.length);h.set(u,x);for(let v=0;v<u.length;v++)x[v]=l(u[v],v,A,h,m);return x}if(u instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&u instanceof SharedArrayBuffer)return u.slice(0);if(u instanceof DataView){const x=new DataView(u.buffer.slice(0),u.byteOffset,u.byteLength);return h.set(u,x),c(x,u,A,h,m),x}if(typeof File<"u"&&u instanceof File){const x=new File([u],u.name,{type:u.type});return h.set(u,x),c(x,u,A,h,m),x}if(typeof Blob<"u"&&u instanceof Blob){const x=new Blob([u],{type:u.type});return h.set(u,x),c(x,u,A,h,m),x}if(u instanceof Error){const x=new u.constructor;return h.set(u,x),x.message=u.message,x.name=u.name,x.stack=u.stack,x.cause=u.cause,c(x,u,A,h,m),x}if(u instanceof Boolean){const x=new Boolean(u.valueOf());return h.set(u,x),c(x,u,A,h,m),x}if(u instanceof Number){const x=new Number(u.valueOf());return h.set(u,x),c(x,u,A,h,m),x}if(u instanceof String){const x=new String(u.valueOf());return h.set(u,x),c(x,u,A,h,m),x}if(typeof u=="object"&&d(u)){const x=Object.create(Object.getPrototypeOf(u));return h.set(u,x),c(x,u,A,h,m),x}return u}function c(u,f,A=u,h,m){const p=[...Object.keys(f),...e.getSymbols(f)];for(let x=0;x<p.length;x++){const v=p[x],y=Object.getOwnPropertyDescriptor(u,v);(y==null||y.writable)&&(u[v]=l(f[v],v,A,h,m))}}function d(u){switch(r.getTag(u)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=o,t.cloneDeepWithImpl=l,t.copyProperties=c})(fM);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=fM;function r(n){return e.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}t.cloneDeep=r})(Die);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=lM,r=Die;function n(a){return a=r.cloneDeep(a),s=>e.isMatch(s,a)}t.matches=n})(Fie);var Lie={},Uie={},Qie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=fM,r=AM;function n(a,s){return e.cloneDeepWith(a,(o,l,c,d)=>{const u=s==null?void 0:s(o,l,c,d);if(u!==void 0)return u;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const f=new a.constructor(a==null?void 0:a.valueOf());return e.copyProperties(f,a),f}case r.argumentsTag:{const f={};return e.copyProperties(f,a),f.length=a.length,f[Symbol.iterator]=a[Symbol.iterator],f}default:return}})}t.cloneDeepWith=n})(Qie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Qie;function r(n){return e.cloneDeepWith(n)}t.cloneDeep=r})(Uie);var Vie={},mM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return e.test(n)}}t.isIndex=r})(mM);var Hie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=hM;function r(n){return n!==null&&typeof n=="object"&&e.getTag(n)==="[object Arguments]"}t.isArguments=r})(Hie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=sM,r=mM,n=Hie,a=kP;function s(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&e.isDeepKey(l)&&(o==null?void 0:o[l])==null?c=a.toPath(l):c=[l],c.length===0)return!1;let d=o;for(let u=0;u<c.length;u++){const f=c[u];if((d==null||!Object.hasOwn(d,f))&&!((Array.isArray(d)||n.isArguments(d))&&r.isIndex(f)&&f<d.length))return!1;d=d[f]}return!0}t.has=s})(Vie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=lM,r=BP,n=Uie,a=TP,s=Vie;function o(l,c){switch(typeof l){case"object":{Object.is(l==null?void 0:l.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=n.cloneDeep(c),function(d){const u=a.get(d,l);return u===void 0?s.has(d,l):c===void 0?u===void 0:e.isMatch(u,c)}}t.matchesProperty=o})(Lie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=oM,r=kie,n=Fie,a=Lie;function s(o){if(o==null)return e.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?a.matchesProperty(o[0],o[1]):n.matches(o);case"string":case"symbol":case"number":return r.property(o)}}t.iteratee=s})(Bie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=jie,r=oM,n=Iie,a=Bie;function s(o,l=r.identity){return n.isArrayLikeObject(o)?e.uniqBy(Array.from(o),a.iteratee(l)):[]}t.uniqBy=s})(Sie);var c$e=Sie.uniqBy;const YG=kA(c$e);function $ie(t,e,r){return e===!0?YG(t,r):typeof e=="function"?YG(t,e):t}var Gie={exports:{}},Kie={},qie={exports:{}},zie={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xv=g;function d$e(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var u$e=typeof Object.is=="function"?Object.is:d$e,f$e=Xv.useState,h$e=Xv.useEffect,A$e=Xv.useLayoutEffect,m$e=Xv.useDebugValue;function p$e(t,e){var r=e(),n=f$e({inst:{value:r,getSnapshot:e}}),a=n[0].inst,s=n[1];return A$e(function(){a.value=r,a.getSnapshot=e,NT(a)&&s({inst:a})},[t,r,e]),h$e(function(){return NT(a)&&s({inst:a}),t(function(){NT(a)&&s({inst:a})})},[t]),m$e(r),r}function NT(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!u$e(t,r)}catch{return!0}}function g$e(t,e){return e()}var x$e=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?g$e:p$e;zie.useSyncExternalStore=Xv.useSyncExternalStore!==void 0?Xv.useSyncExternalStore:x$e;qie.exports=zie;var v$e=qie.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OP=g,y$e=v$e;function b$e(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var w$e=typeof Object.is=="function"?Object.is:b$e,N$e=y$e.useSyncExternalStore,C$e=OP.useRef,_$e=OP.useEffect,E$e=OP.useMemo,S$e=OP.useDebugValue;Kie.useSyncExternalStoreWithSelector=function(t,e,r,n,a){var s=C$e(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=E$e(function(){function c(h){if(!d){if(d=!0,u=h,h=n(h),a!==void 0&&o.hasValue){var m=o.value;if(a(m,h))return f=m}return f=h}if(m=f,w$e(u,h))return m;var p=n(h);return a!==void 0&&a(m,p)?(u=h,m):(u=h,f=p)}var d=!1,u,f,A=r===void 0?null:r;return[function(){return c(e())},A===null?void 0:function(){return c(A())}]},[e,r,n,a]);var l=N$e(t,s[0],s[1]);return _$e(function(){o.hasValue=!0,o.value=l},[l]),S$e(l),l};Gie.exports=Kie;var j$e=Gie.exports,pM=g.createContext(null),I$e=t=>t,Us=()=>{var t=g.useContext(pM);return t?t.store.dispatch:I$e},IE=()=>{},P$e=()=>IE,T$e=(t,e)=>t===e;function In(t){var e=g.useContext(pM);return j$e.useSyncExternalStoreWithSelector(e?e.subscription.addNestedSub:P$e,e?e.store.getState:IE,e?e.store.getState:IE,e?t:IE,T$e)}function B$e(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function k$e(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function F$e(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var JG=t=>Array.isArray(t)?t:[t];function O$e(t){const e=Array.isArray(t[0])?t[0]:t;return F$e(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function D$e(t,e){const r=[],{length:n}=t;for(let a=0;a<n;a++)r.push(t[a].apply(null,e));return r}var R$e=class{constructor(t){this.value=t}deref(){return this.value}},M$e=typeof WeakRef<"u"?WeakRef:R$e,L$e=0,ZG=1;function N_(){return{s:L$e,v:void 0,o:null,p:null}}function Wie(t,e={}){let r=N_();const{resultEqualityCheck:n}=e;let a,s=0;function o(){var f;let l=r;const{length:c}=arguments;for(let A=0,h=c;A<h;A++){const m=arguments[A];if(typeof m=="function"||typeof m=="object"&&m!==null){let p=l.o;p===null&&(l.o=p=new WeakMap);const x=p.get(m);x===void 0?(l=N_(),p.set(m,l)):l=x}else{let p=l.p;p===null&&(l.p=p=new Map);const x=p.get(m);x===void 0?(l=N_(),p.set(m,l)):l=x}}const d=l;let u;if(l.s===ZG)u=l.v;else if(u=t.apply(null,arguments),s++,n){const A=((f=a==null?void 0:a.deref)==null?void 0:f.call(a))??a;A!=null&&n(A,u)&&(u=A,s!==0&&s--),a=typeof u=="object"&&u!==null||typeof u=="function"?new M$e(u):u}return d.s=ZG,d.v=u,u}return o.clearCache=()=>{r=N_(),o.resetResultsCount()},o.resultsCount=()=>s,o.resetResultsCount=()=>{s=0},o}function U$e(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...a)=>{let s=0,o=0,l,c={},d=a.pop();typeof d=="object"&&(c=d,d=a.pop()),B$e(d,`createSelector expects an output function after the inputs, but received: [${typeof d}]`);const u={...r,...c},{memoize:f,memoizeOptions:A=[],argsMemoize:h=Wie,argsMemoizeOptions:m=[]}=u,p=JG(A),x=JG(m),v=O$e(a),y=f(function(){return s++,d.apply(null,arguments)},...p),b=h(function(){o++;const I=D$e(v,arguments);return l=y.apply(null,I),l},...x);return Object.assign(b,{resultFunc:d,memoizedResultFunc:y,dependencies:v,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:f,argsMemoize:h})};return Object.assign(n,{withTypes:()=>n}),n}var Zt=U$e(Wie),Q$e=Object.assign((t,e=Zt)=>{k$e(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(s=>t[s]);return e(n,(...s)=>s.reduce((o,l,c)=>(o[r[c]]=l,o),{}))},{withTypes:()=>Q$e}),Xie={},Yie={},Jie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,s)=>{if(n!==a){const o=e(n),l=e(a);if(o===l&&o===0){if(n<a)return s==="desc"?1:-1;if(n>a)return s==="desc"?-1:1}return s==="desc"?l-o:o-l}return 0};t.compareValues=r})(Jie);var Zie={},gM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="symbol"||r instanceof Symbol}t.isSymbol=e})(gM);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=gM,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(s,o){return Array.isArray(s)?!1:typeof s=="number"||typeof s=="boolean"||s==null||e.isSymbol(s)?!0:typeof s=="string"&&(n.test(s)||!r.test(s))||o!=null&&Object.hasOwn(o,s)}t.isKey=a})(Zie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Jie,r=Zie,n=kP;function a(s,o,l,c){if(s==null)return[];l=c?void 0:l,Array.isArray(s)||(s=Object.values(s)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(h=>String(h));const d=(h,m)=>{let p=h;for(let x=0;x<m.length&&p!=null;++x)p=p[m[x]];return p},u=(h,m)=>m==null||h==null?m:typeof h=="object"&&"key"in h?Object.hasOwn(m,h.key)?m[h.key]:d(m,h.path):typeof h=="function"?h(m):Array.isArray(h)?d(m,h):typeof m=="object"?m[h]:m,f=o.map(h=>(Array.isArray(h)&&h.length===1&&(h=h[0]),h==null||typeof h=="function"||Array.isArray(h)||r.isKey(h)?h:{key:h,path:n.toPath(h)}));return s.map(h=>({original:h,criteria:f.map(m=>u(m,h))})).slice().sort((h,m)=>{for(let p=0;p<f.length;p++){const x=e.compareValues(h.criteria[p],m.criteria[p],l[p]);if(x!==0)return x}return 0}).map(h=>h.original)}t.orderBy=a})(Yie);var eoe={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=1){const a=[],s=Math.floor(n),o=(l,c)=>{for(let d=0;d<l.length;d++){const u=l[d];Array.isArray(u)&&c<s?o(u,c+1):a.push(u)}};return o(r,0),a}t.flatten=e})(eoe);var xM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=mM,r=FP,n=cM,a=uM;function s(o,l,c){return n.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&e.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?a.eq(c[l],o):!1}t.isIterateeCall=s})(xM);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Yie,r=eoe,n=xM;function a(s,...o){const l=o.length;return l>1&&n.isIterateeCall(s,o[0],o[1])?o=[]:l>2&&n.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),e.orderBy(s,r.flatten(o),["asc"])}t.sortBy=a})(Xie);var V$e=Xie.sortBy;const DP=kA(V$e);var toe=t=>t.legend.settings,H$e=t=>t.legend.size,$$e=t=>t.legend.payload,G$e=Zt([$$e,toe],(t,e)=>{var{itemSorter:r}=e,n=t.flat(1);return r?DP(n,r):n});function K$e(){return In(G$e)}var C_=1;function roe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[e,r]=g.useState({height:0,left:0,top:0,width:0}),n=g.useCallback(a=>{if(a!=null){var s=a.getBoundingClientRect(),o={height:s.height,left:s.left,top:s.top,width:s.width};(Math.abs(o.height-e.height)>C_||Math.abs(o.left-e.left)>C_||Math.abs(o.top-e.top)>C_||Math.abs(o.width-e.width)>C_)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[e.width,e.height,e.top,e.left,...t]);return[e,n]}function Bl(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var q$e=typeof Symbol=="function"&&Symbol.observable||"@@observable",eK=q$e,CT=()=>Math.random().toString(36).substring(7).split("").join("."),z$e={INIT:`@@redux/INIT${CT()}`,REPLACE:`@@redux/REPLACE${CT()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${CT()}`},yj=z$e;function vM(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function noe(t,e,r){if(typeof t!="function")throw new Error(Bl(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Bl(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Bl(1));return r(noe)(t,e)}let n=t,a=e,s=new Map,o=s,l=0,c=!1;function d(){o===s&&(o=new Map,s.forEach((x,v)=>{o.set(v,x)}))}function u(){if(c)throw new Error(Bl(3));return a}function f(x){if(typeof x!="function")throw new Error(Bl(4));if(c)throw new Error(Bl(5));let v=!0;d();const y=l++;return o.set(y,x),function(){if(v){if(c)throw new Error(Bl(6));v=!1,d(),o.delete(y),s=null}}}function A(x){if(!vM(x))throw new Error(Bl(7));if(typeof x.type>"u")throw new Error(Bl(8));if(typeof x.type!="string")throw new Error(Bl(17));if(c)throw new Error(Bl(9));try{c=!0,a=n(a,x)}finally{c=!1}return(s=o).forEach(y=>{y()}),x}function h(x){if(typeof x!="function")throw new Error(Bl(10));n=x,A({type:yj.REPLACE})}function m(){const x=f;return{subscribe(v){if(typeof v!="object"||v===null)throw new Error(Bl(11));function y(){const w=v;w.next&&w.next(u())}return y(),{unsubscribe:x(y)}},[eK](){return this}}}return A({type:yj.INIT}),{dispatch:A,subscribe:f,getState:u,replaceReducer:h,[eK]:m}}function W$e(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:yj.INIT})>"u")throw new Error(Bl(12));if(typeof r(void 0,{type:yj.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Bl(13))})}function aoe(t){const e=Object.keys(t),r={};for(let s=0;s<e.length;s++){const o=e[s];typeof t[o]=="function"&&(r[o]=t[o])}const n=Object.keys(r);let a;try{W$e(r)}catch(s){a=s}return function(o={},l){if(a)throw a;let c=!1;const d={};for(let u=0;u<n.length;u++){const f=n[u],A=r[f],h=o[f],m=A(h,l);if(typeof m>"u")throw l&&l.type,new Error(Bl(14));d[f]=m,c=c||m!==h}return c=c||n.length!==Object.keys(o).length,c?d:o}}function bj(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function X$e(...t){return e=>(r,n)=>{const a=e(r,n);let s=()=>{throw new Error(Bl(15))};const o={getState:a.getState,dispatch:(c,...d)=>s(c,...d)},l=t.map(c=>c(o));return s=bj(...l)(a.dispatch),{...a,dispatch:s}}}function soe(t){return vM(t)&&"type"in t&&typeof t.type=="string"}var ioe=Symbol.for("immer-nothing"),tK=Symbol.for("immer-draftable"),Gc=Symbol.for("immer-state");function mf(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Vd=Object,Yv=Vd.getPrototypeOf,wj="constructor",RP="prototype",LF="configurable",Nj="enumerable",PE="writable",rw="value",SA=t=>!!t&&!!t[Gc];function Pf(t){var e;return t?ooe(t)||LP(t)||!!t[tK]||!!((e=t[wj])!=null&&e[tK])||UP(t)||QP(t):!1}var Y$e=Vd[RP][wj].toString(),rK=new WeakMap;function ooe(t){if(!t||!yM(t))return!1;const e=Yv(t);if(e===null||e===Vd[RP])return!0;const r=Vd.hasOwnProperty.call(e,wj)&&e[wj];if(r===Object)return!0;if(!Mx(r))return!1;let n=rK.get(r);return n===void 0&&(n=Function.toString.call(r),rK.set(r,n)),n===Y$e}function MP(t,e,r=!0){tN(t)===0?(r?Reflect.ownKeys(t):Vd.keys(t)).forEach(a=>{e(a,t[a],t)}):t.forEach((n,a)=>e(a,n,t))}function tN(t){const e=t[Gc];return e?e.type_:LP(t)?1:UP(t)?2:QP(t)?3:0}var nK=(t,e,r=tN(t))=>r===2?t.has(e):Vd[RP].hasOwnProperty.call(t,e),UF=(t,e,r=tN(t))=>r===2?t.get(e):t[e],Cj=(t,e,r,n=tN(t))=>{n===2?t.set(e,r):n===3?t.add(r):t[e]=r};function J$e(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}var LP=Array.isArray,UP=t=>t instanceof Map,QP=t=>t instanceof Set,yM=t=>typeof t=="object",Mx=t=>typeof t=="function",_T=t=>typeof t=="boolean";function Z$e(t){const e=+t;return Number.isInteger(e)&&String(e)===t}var Gh=t=>t.copy_||t.base_,bM=t=>t.modified_?t.copy_:t.base_;function QF(t,e){if(UP(t))return new Map(t);if(QP(t))return new Set(t);if(LP(t))return Array[RP].slice.call(t);const r=ooe(t);if(e===!0||e==="class_only"&&!r){const n=Vd.getOwnPropertyDescriptors(t);delete n[Gc];let a=Reflect.ownKeys(n);for(let s=0;s<a.length;s++){const o=a[s],l=n[o];l[PE]===!1&&(l[PE]=!0,l[LF]=!0),(l.get||l.set)&&(n[o]={[LF]:!0,[PE]:!0,[Nj]:l[Nj],[rw]:t[o]})}return Vd.create(Yv(t),n)}else{const n=Yv(t);if(n!==null&&r)return{...t};const a=Vd.create(n);return Vd.assign(a,t)}}function wM(t,e=!1){return VP(t)||SA(t)||!Pf(t)||(tN(t)>1&&Vd.defineProperties(t,{set:__,add:__,clear:__,delete:__}),Vd.freeze(t),e&&MP(t,(r,n)=>{wM(n,!0)},!1)),t}function eGe(){mf(2)}var __={[rw]:eGe};function VP(t){return t===null||!yM(t)?!0:Vd.isFrozen(t)}var _j="MapSet",VF="Patches",aK="ArrayMethods",loe={};function Eg(t){const e=loe[t];return e||mf(0,t),e}var sK=t=>!!loe[t],nw,coe=()=>nw,tGe=(t,e)=>({drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:sK(_j)?Eg(_j):void 0,arrayMethodsPlugin_:sK(aK)?Eg(aK):void 0});function iK(t,e){e&&(t.patchPlugin_=Eg(VF),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function HF(t){$F(t),t.drafts_.forEach(rGe),t.drafts_=null}function $F(t){t===nw&&(nw=t.parent_)}var oK=t=>nw=tGe(nw,t);function rGe(t){const e=t[Gc];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function lK(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];if(t!==void 0&&t!==r){r[Gc].modified_&&(HF(e),mf(4)),Pf(t)&&(t=cK(e,t));const{patchPlugin_:a}=e;a&&a.generateReplacementPatches_(r[Gc].base_,t,e)}else t=cK(e,r);return nGe(e,t,!0),HF(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==ioe?t:void 0}function cK(t,e){if(VP(e))return e;const r=e[Gc];if(!r)return Ej(e,t.handledSet_,t);if(!HP(r,t))return e;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(t);foe(r,t)}return r.copy_}function nGe(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&wM(e,r)}function doe(t){t.finalized_=!0,t.scope_.unfinalizedDrafts_--}var HP=(t,e)=>t.scope_===e,aGe=[];function uoe(t,e,r,n){const a=Gh(t),s=t.type_;if(n!==void 0&&UF(a,n,s)===e){Cj(a,n,r,s);return}if(!t.draftLocations_){const l=t.draftLocations_=new Map;MP(a,(c,d)=>{if(SA(d)){const u=l.get(d)||[];u.push(c),l.set(d,u)}})}const o=t.draftLocations_.get(e)??aGe;for(const l of o)Cj(a,l,r,s)}function sGe(t,e,r){t.callbacks_.push(function(a){var l;const s=e;if(!s||!HP(s,a))return;(l=a.mapSetPlugin_)==null||l.fixSetContents(s);const o=bM(s);uoe(t,s.draft_??s,o,r),foe(s,a)})}function foe(t,e){var n;if(t.modified_&&!t.finalized_&&(t.type_===3||t.type_===1&&t.allIndicesReassigned_||(((n=t.assigned_)==null?void 0:n.size)??0)>0)){const{patchPlugin_:a}=e;if(a){const s=a.getPath(t);s&&a.generatePatches_(t,s,e)}doe(t)}}function iGe(t,e,r){const{scope_:n}=t;if(SA(r)){const a=r[Gc];HP(a,n)&&a.callbacks_.push(function(){TE(t);const o=bM(a);uoe(t,r,o,e)})}else Pf(r)&&t.callbacks_.push(function(){const s=Gh(t);t.type_===3?s.has(r)&&Ej(r,n.handledSet_,n):UF(s,e,t.type_)===r&&n.drafts_.length>1&&(t.assigned_.get(e)??!1)===!0&&t.copy_&&Ej(UF(t.copy_,e,t.type_),n.handledSet_,n)})}function Ej(t,e,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||SA(t)||e.has(t)||!Pf(t)||VP(t)||(e.add(t),MP(t,(n,a)=>{if(SA(a)){const s=a[Gc];if(HP(s,r)){const o=bM(s);Cj(t,n,o,t.type_),doe(s)}}else Pf(a)&&Ej(a,e,r)})),t}function oGe(t,e){const r=LP(t),n={type_:r?1:0,scope_:e?e.scope_:coe(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let a=n,s=Sj;r&&(a=[n],s=aw);const{revoke:o,proxy:l}=Proxy.revocable(a,s);return n.draft_=l,n.revoke_=o,[l,n]}var Sj={get(t,e){if(e===Gc)return t;let r=t.scope_.arrayMethodsPlugin_;const n=t.type_===1&&typeof e=="string";if(n&&r!=null&&r.isArrayOperationMethod(e))return r.createMethodInterceptor(t,e);const a=Gh(t);if(!nK(a,e,t.type_))return lGe(t,a,e);const s=a[e];if(t.finalized_||!Pf(s)||n&&t.operationMethod&&(r!=null&&r.isMutatingArrayMethod(t.operationMethod))&&Z$e(e))return s;if(s===ET(t.base_,e)){TE(t);const o=t.type_===1?+e:e,l=KF(t.scope_,s,t,o);return t.copy_[o]=l}return s},has(t,e){return e in Gh(t)},ownKeys(t){return Reflect.ownKeys(Gh(t))},set(t,e,r){const n=hoe(Gh(t),e);if(n!=null&&n.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const a=ET(Gh(t),e),s=a==null?void 0:a[Gc];if(s&&s.base_===r)return t.copy_[e]=r,t.assigned_.set(e,!1),!0;if(J$e(r,a)&&(r!==void 0||nK(t.base_,e,t.type_)))return!0;TE(t),GF(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_.set(e,!0),iGe(t,e,r)),!0},deleteProperty(t,e){return TE(t),ET(t.base_,e)!==void 0||e in t.base_?(t.assigned_.set(e,!1),GF(t)):t.assigned_.delete(e),t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Gh(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{[PE]:!0,[LF]:t.type_!==1||e!=="length",[Nj]:n[Nj],[rw]:r[e]}},defineProperty(){mf(11)},getPrototypeOf(t){return Yv(t.base_)},setPrototypeOf(){mf(12)}},aw={};for(let t in Sj){let e=Sj[t];aw[t]=function(){const r=arguments;return r[0]=r[0][0],e.apply(this,r)}}aw.deleteProperty=function(t,e){return aw.set.call(this,t,e,void 0)};aw.set=function(t,e,r){return Sj.set.call(this,t[0],e,r,t[0])};function ET(t,e){const r=t[Gc];return(r?Gh(r):t)[e]}function lGe(t,e,r){var a;const n=hoe(e,r);return n?rw in n?n[rw]:(a=n.get)==null?void 0:a.call(t.draft_):void 0}function hoe(t,e){if(!(e in t))return;let r=Yv(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=Yv(r)}}function GF(t){t.modified_||(t.modified_=!0,t.parent_&&GF(t.parent_))}function TE(t){t.copy_||(t.assigned_=new Map,t.copy_=QF(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var cGe=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,a)=>{if(Mx(r)&&!Mx(n)){const o=n;n=r;const l=this;return function(d=o,...u){return l.produce(d,f=>n.call(this,f,...u))}}Mx(n)||mf(6),a!==void 0&&!Mx(a)&&mf(7);let s;if(Pf(r)){const o=oK(this),l=KF(o,r,void 0);let c=!0;try{s=n(l),c=!1}finally{c?HF(o):$F(o)}return iK(o,a),lK(s,o)}else if(!r||!yM(r)){if(s=n(r),s===void 0&&(s=r),s===ioe&&(s=void 0),this.autoFreeze_&&wM(s,!0),a){const o=[],l=[];Eg(VF).generateReplacementPatches_(r,s,{patches_:o,inversePatches_:l}),a(o,l)}return s}else mf(1,r)},this.produceWithPatches=(r,n)=>{if(Mx(r))return(l,...c)=>this.produceWithPatches(l,d=>r(d,...c));let a,s;return[this.produce(r,n,(l,c)=>{a=l,s=c}),a,s]},_T(e==null?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),_T(e==null?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),_T(e==null?void 0:e.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Pf(e)||mf(8),SA(e)&&(e=_f(e));const r=oK(this),n=KF(r,e,void 0);return n[Gc].isManual_=!0,$F(r),n}finishDraft(e,r){const n=e&&e[Gc];(!n||!n.isManual_)&&mf(9);const{scope_:a}=n;return iK(a,r),lK(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,r){let n;for(n=r.length-1;n>=0;n--){const s=r[n];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}n>-1&&(r=r.slice(n+1));const a=Eg(VF).applyPatches_;return SA(e)?a(e,r):this.produce(e,s=>a(s,r))}};function KF(t,e,r,n){const[a,s]=UP(e)?Eg(_j).proxyMap_(e,r):QP(e)?Eg(_j).proxySet_(e,r):oGe(e,r);return((r==null?void 0:r.scope_)??coe()).drafts_.push(a),s.callbacks_=(r==null?void 0:r.callbacks_)??[],s.key_=n,r&&n!==void 0?sGe(r,s,n):s.callbacks_.push(function(c){var u;(u=c.mapSetPlugin_)==null||u.fixSetContents(s);const{patchPlugin_:d}=c;s.modified_&&d&&d.generatePatches_(s,[],c)}),a}function _f(t){return SA(t)||mf(10,t),Aoe(t)}function Aoe(t){if(!Pf(t)||VP(t))return t;const e=t[Gc];let r,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=QF(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else r=QF(t,!0);return MP(r,(a,s)=>{Cj(r,a,Aoe(s))},n),e&&(e.finalized_=!1),r}var dGe=new cGe,moe=dGe.produce;function poe(t){return({dispatch:r,getState:n})=>a=>s=>typeof s=="function"?s(r,n,t):a(s)}var uGe=poe(),fGe=poe,hGe=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?bj:bj.apply(null,arguments)};function Vu(t,e){function r(...n){if(e){let a=e(...n);if(!a)throw new Error(Gd(0));return{type:t,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>soe(n)&&n.type===t,r}var goe=class cb extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,cb.prototype)}static get[Symbol.species](){return cb}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new cb(...e[0].concat(this)):new cb(...e.concat(this))}};function dK(t){return Pf(t)?moe(t,()=>{}):t}function E_(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function AGe(t){return typeof t=="boolean"}var mGe=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:s=!0}=e??{};let o=new goe;return r&&(AGe(r)?o.push(uGe):o.push(fGe(r.extraArgument))),o},xoe="RTK_autoBatch",ii=()=>t=>({payload:t,meta:{[xoe]:!0}}),uK=t=>e=>{setTimeout(e,t)},voe=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let a=!0,s=!1,o=!1;const l=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:uK(10):t.type==="callback"?t.queueNotification:uK(t.timeout),d=()=>{o=!1,s&&(s=!1,l.forEach(u=>u()))};return Object.assign({},n,{subscribe(u){const f=()=>a&&u(),A=n.subscribe(f);return l.add(u),()=>{A(),l.delete(u)}},dispatch(u){var f;try{return a=!((f=u==null?void 0:u.meta)!=null&&f[xoe]),s=!a,s&&(o||(o=!0,c(d))),n.dispatch(u)}finally{a=!0}}})},pGe=t=>function(r){const{autoBatch:n=!0}=r??{};let a=new goe(t);return n&&a.push(voe(typeof n=="object"?n:void 0)),a};function gGe(t){const e=mGe(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:s=void 0,enhancers:o=void 0}=t||{};let l;if(typeof r=="function")l=r;else if(vM(r))l=aoe(r);else throw new Error(Gd(1));let c;typeof n=="function"?c=n(e):c=e();let d=bj;a&&(d=hGe({trace:!1,...typeof a=="object"&&a}));const u=X$e(...c),f=pGe(u);let A=typeof o=="function"?o(f):f();const h=d(...A);return noe(l,s,h)}function yoe(t){const e={},r=[];let n;const a={addCase(s,o){const l=typeof s=="string"?s:s.type;if(!l)throw new Error(Gd(28));if(l in e)throw new Error(Gd(29));return e[l]=o,a},addAsyncThunk(s,o){return o.pending&&(e[s.pending.type]=o.pending),o.rejected&&(e[s.rejected.type]=o.rejected),o.fulfilled&&(e[s.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:s.settled,reducer:o.settled}),a},addMatcher(s,o){return r.push({matcher:s,reducer:o}),a},addDefaultCase(s){return n=s,a}};return t(a),[e,r,n]}function xGe(t){return typeof t=="function"}function vGe(t,e){let[r,n,a]=yoe(e),s;if(xGe(t))s=()=>dK(t());else{const l=dK(t);s=()=>l}function o(l=s(),c){let d=[r[c.type],...n.filter(({matcher:u})=>u(c)).map(({reducer:u})=>u)];return d.filter(u=>!!u).length===0&&(d=[a]),d.reduce((u,f)=>{if(f)if(SA(u)){const h=f(u,c);return h===void 0?u:h}else{if(Pf(u))return moe(u,A=>f(A,c));{const A=f(u,c);if(A===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return A}}return u},l)}return o.getInitialState=s,o}var yGe="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",bGe=(t=21)=>{let e="",r=t;for(;r--;)e+=yGe[Math.random()*64|0];return e},wGe=Symbol.for("rtk-slice-createasyncthunk");function NGe(t,e){return`${t}/${e}`}function CGe({creators:t}={}){var r;const e=(r=t==null?void 0:t.asyncThunk)==null?void 0:r[wGe];return function(a){const{name:s,reducerPath:o=s}=a;if(!s)throw new Error(Gd(11));const l=(typeof a.reducers=="function"?a.reducers(EGe()):a.reducers)||{},c=Object.keys(l),d={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(w,I){const j=typeof w=="string"?w:w.type;if(!j)throw new Error(Gd(12));if(j in d.sliceCaseReducersByType)throw new Error(Gd(13));return d.sliceCaseReducersByType[j]=I,u},addMatcher(w,I){return d.sliceMatchers.push({matcher:w,reducer:I}),u},exposeAction(w,I){return d.actionCreators[w]=I,u},exposeCaseReducer(w,I){return d.sliceCaseReducersByName[w]=I,u}};c.forEach(w=>{const I=l[w],j={reducerName:w,type:NGe(s,w),createNotation:typeof a.reducers=="function"};jGe(I)?PGe(j,I,u,e):SGe(j,I,u)});function f(){const[w={},I=[],j=void 0]=typeof a.extraReducers=="function"?yoe(a.extraReducers):[a.extraReducers],N={...w,...d.sliceCaseReducersByType};return vGe(a.initialState,S=>{for(let E in N)S.addCase(E,N[E]);for(let E of d.sliceMatchers)S.addMatcher(E.matcher,E.reducer);for(let E of I)S.addMatcher(E.matcher,E.reducer);j&&S.addDefaultCase(j)})}const A=w=>w,h=new Map,m=new WeakMap;let p;function x(w,I){return p||(p=f()),p(w,I)}function v(){return p||(p=f()),p.getInitialState()}function y(w,I=!1){function j(S){let E=S[w];return typeof E>"u"&&I&&(E=E_(m,j,v)),E}function N(S=A){const E=E_(h,I,()=>new WeakMap);return E_(E,S,()=>{const B={};for(const[k,T]of Object.entries(a.selectors??{}))B[k]=_Ge(T,S,()=>E_(m,S,v),I);return B})}return{reducerPath:w,getSelectors:N,get selectors(){return N(j)},selectSlice:j}}const b={name:s,reducer:x,actions:d.actionCreators,caseReducers:d.sliceCaseReducersByName,getInitialState:v,...y(o),injectInto(w,{reducerPath:I,...j}={}){const N=I??o;return w.inject({reducerPath:N,reducer:x},j),{...b,...y(N,!0)}}};return b}}function _Ge(t,e,r,n){function a(s,...o){let l=e(s);return typeof l>"u"&&n&&(l=r()),t(l,...o)}return a.unwrapped=t,a}var xd=CGe();function EGe(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function SGe({type:t,reducerName:e,createNotation:r},n,a){let s,o;if("reducer"in n){if(r&&!IGe(n))throw new Error(Gd(17));s=n.reducer,o=n.prepare}else s=n;a.addCase(t,s).exposeCaseReducer(e,s).exposeAction(e,o?Vu(t,o):Vu(t))}function jGe(t){return t._reducerDefinitionType==="asyncThunk"}function IGe(t){return t._reducerDefinitionType==="reducerWithPrepare"}function PGe({type:t,reducerName:e},r,n,a){if(!a)throw new Error(Gd(18));const{payloadCreator:s,fulfilled:o,pending:l,rejected:c,settled:d,options:u}=r,f=a(t,s,u);n.exposeAction(e,f),o&&n.addCase(f.fulfilled,o),l&&n.addCase(f.pending,l),c&&n.addCase(f.rejected,c),d&&n.addMatcher(f.settled,d),n.exposeCaseReducer(e,{fulfilled:o||S_,pending:l||S_,rejected:c||S_,settled:d||S_})}function S_(){}var TGe="task",boe="listener",woe="completed",NM="cancelled",BGe=`task-${NM}`,kGe=`task-${woe}`,qF=`${boe}-${NM}`,FGe=`${boe}-${woe}`,$P=class{constructor(t){Rr(this,"name","TaskAbortError");Rr(this,"message");this.code=t,this.message=`${TGe} ${NM} (reason: ${t})`}},CM=(t,e)=>{if(typeof t!="function")throw new TypeError(Gd(32))},jj=()=>{},Noe=(t,e=jj)=>(t.catch(e),t),Coe=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),Yp=t=>{if(t.aborted)throw new $P(t.reason)};function _oe(t,e){let r=jj;return new Promise((n,a)=>{const s=()=>a(new $P(t.reason));if(t.aborted){s();return}r=Coe(t,s),e.finally(()=>r()).then(n,a)}).finally(()=>{r=jj})}var OGe=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof $P?"cancelled":"rejected",error:r}}finally{e==null||e()}},Ij=t=>e=>Noe(_oe(t,e).then(r=>(Yp(t),r))),Eoe=t=>{const e=Ij(t);return r=>e(new Promise(n=>setTimeout(n,r)))},{assign:Nv}=Object,fK={},GP="listenerMiddleware",DGe=(t,e)=>{const r=n=>Coe(t,()=>n.abort(t.reason));return(n,a)=>{CM(n);const s=new AbortController;r(s);const o=OGe(async()=>{Yp(t),Yp(s.signal);const l=await n({pause:Ij(s.signal),delay:Eoe(s.signal),signal:s.signal});return Yp(s.signal),l},()=>s.abort(kGe));return a!=null&&a.autoJoin&&e.push(o.catch(jj)),{result:Ij(t)(o),cancel(){s.abort(BGe)}}}},RGe=(t,e)=>{const r=async(n,a)=>{Yp(e);let s=()=>{};const l=[new Promise((c,d)=>{let u=t({predicate:n,effect:(f,A)=>{A.unsubscribe(),c([f,A.getState(),A.getOriginalState()])}});s=()=>{u(),d()}})];a!=null&&l.push(new Promise(c=>setTimeout(c,a,null)));try{const c=await _oe(e,Promise.race(l));return Yp(e),c}finally{s()}};return(n,a)=>Noe(r(n,a))},Soe=t=>{let{type:e,actionCreator:r,matcher:n,predicate:a,effect:s}=t;if(e)a=Vu(e).match;else if(r)e=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(Gd(21));return CM(s),{predicate:a,type:e,effect:s}},joe=Nv(t=>{const{type:e,predicate:r,effect:n}=Soe(t);return{id:bGe(),effect:n,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Gd(22))}}},{withTypes:()=>joe}),hK=(t,e)=>{const{type:r,effect:n,predicate:a}=Soe(e);return Array.from(t.values()).find(s=>(typeof r=="string"?s.type===r:s.predicate===a)&&s.effect===n)},zF=t=>{t.pending.forEach(e=>{e.abort(qF)})},MGe=(t,e)=>()=>{for(const r of e.keys())zF(r);t.clear()},AK=(t,e,r)=>{try{t(e,r)}catch(n){setTimeout(()=>{throw n},0)}},Ioe=Nv(Vu(`${GP}/add`),{withTypes:()=>Ioe}),LGe=Vu(`${GP}/removeAll`),Poe=Nv(Vu(`${GP}/remove`),{withTypes:()=>Poe}),UGe=(...t)=>{console.error(`${GP}/error`,...t)},rN=(t={})=>{const e=new Map,r=new Map,n=h=>{const m=r.get(h)??0;r.set(h,m+1)},a=h=>{const m=r.get(h)??1;m===1?r.delete(h):r.set(h,m-1)},{extra:s,onError:o=UGe}=t;CM(o);const l=h=>(h.unsubscribe=()=>e.delete(h.id),e.set(h.id,h),m=>{h.unsubscribe(),m!=null&&m.cancelActive&&zF(h)}),c=h=>{const m=hK(e,h)??joe(h);return l(m)};Nv(c,{withTypes:()=>c});const d=h=>{const m=hK(e,h);return m&&(m.unsubscribe(),h.cancelActive&&zF(m)),!!m};Nv(d,{withTypes:()=>d});const u=async(h,m,p,x)=>{const v=new AbortController,y=RGe(c,v.signal),b=[];try{h.pending.add(v),n(h),await Promise.resolve(h.effect(m,Nv({},p,{getOriginalState:x,condition:(w,I)=>y(w,I).then(Boolean),take:y,delay:Eoe(v.signal),pause:Ij(v.signal),extra:s,signal:v.signal,fork:DGe(v.signal,b),unsubscribe:h.unsubscribe,subscribe:()=>{e.set(h.id,h)},cancelActiveListeners:()=>{h.pending.forEach((w,I,j)=>{w!==v&&(w.abort(qF),j.delete(w))})},cancel:()=>{v.abort(qF),h.pending.delete(v)},throwIfCancelled:()=>{Yp(v.signal)}})))}catch(w){w instanceof $P||AK(o,w,{raisedBy:"effect"})}finally{await Promise.all(b),v.abort(FGe),a(h),h.pending.delete(v)}},f=MGe(e,r);return{middleware:h=>m=>p=>{if(!soe(p))return m(p);if(Ioe.match(p))return c(p.payload);if(LGe.match(p)){f();return}if(Poe.match(p))return d(p.payload);let x=h.getState();const v=()=>{if(x===fK)throw new Error(Gd(23));return x};let y;try{if(y=m(p),e.size>0){const b=h.getState(),w=Array.from(e.values());for(const I of w){let j=!1;try{j=I.predicate(p,b,x)}catch(N){j=!1,AK(o,N,{raisedBy:"predicate"})}j&&u(I,p,h,v)}}}finally{x=fK}return y},startListening:c,stopListening:d,clearListeners:f}};function Gd(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var QGe={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},Toe=xd({name:"chartLayout",initialState:QGe,reducers:{setLayout(t,e){t.layoutType=e.payload},setChartSize(t,e){t.width=e.payload.width,t.height=e.payload.height},setMargin(t,e){var r,n,a,s;t.margin.top=(r=e.payload.top)!==null&&r!==void 0?r:0,t.margin.right=(n=e.payload.right)!==null&&n!==void 0?n:0,t.margin.bottom=(a=e.payload.bottom)!==null&&a!==void 0?a:0,t.margin.left=(s=e.payload.left)!==null&&s!==void 0?s:0},setScale(t,e){t.scale=e.payload}}}),{setMargin:VGe,setLayout:HGe,setChartSize:$Ge,setScale:GGe}=Toe.actions,KGe=Toe.reducer;function Boe(t,e,r){return Array.isArray(t)&&t&&e+r!==0?t.slice(e,r+1):t}function Ti(t){return Number.isFinite(t)}function Om(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function mK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function sv(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?mK(Object(r),!0).forEach(function(n){qGe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):mK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qGe(t,e,r){return(e=zGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zGe(t){var e=WGe(t,"string");return typeof e=="symbol"?e:e+""}function WGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Js(t,e,r){return vl(t)||vl(e)?r:mh(e)?_g(t,e,r):typeof e=="function"?e(t):r}var XGe=(t,e,r)=>{if(e&&r){var{width:n,height:a}=r,{align:s,verticalAlign:o,layout:l}=e;if((l==="vertical"||l==="horizontal"&&o==="middle")&&s!=="center"&&On(t[s]))return sv(sv({},t),{},{[s]:t[s]+(n||0)});if((l==="horizontal"||l==="vertical"&&s==="center")&&o!=="middle"&&On(t[o]))return sv(sv({},t),{},{[o]:t[o]+(a||0)})}return t},zg=(t,e)=>t==="horizontal"&&e==="xAxis"||t==="vertical"&&e==="yAxis"||t==="centric"&&e==="angleAxis"||t==="radial"&&e==="radiusAxis",pK=1e-4,YGe=t=>{var e=t.domain();if(!(!e||e.length<=2)){var r=e.length,n=t.range(),a=Math.min(n[0],n[1])-pK,s=Math.max(n[0],n[1])+pK,o=t(e[0]),l=t(e[r-1]);(o<a||o>s||l<a||l>s)&&t.domain([e[0],e[r-1]])}},JGe=(t,e)=>{if(!e||e.length!==2||!On(e[0])||!On(e[1]))return t;var r=Math.min(e[0],e[1]),n=Math.max(e[0],e[1]),a=[t[0],t[1]];return(!On(t[0])||t[0]<r)&&(a[0]=r),(!On(t[1])||t[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},ZGe=t=>{var e,r=t.length;if(!(r<=0)){var n=(e=t[0])===null||e===void 0?void 0:e.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var s=0,o=0,l=0;l<r;++l){var c=t[l],d=c==null?void 0:c[a];if(d!=null){var u=d[1],f=d[0],A=Ah(u)?f:u;A>=0?(d[0]=s,d[1]=s+A,s=u):(d[0]=o,d[1]=o+A,o=u)}}}},eKe=t=>{var e,r=t.length;if(!(r<=0)){var n=(e=t[0])===null||e===void 0?void 0:e.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var s=0,o=0;o<r;++o){var l=t[o],c=l==null?void 0:l[a];if(c!=null){var d=Ah(c[1])?c[0]:c[1];d>=0?(c[0]=s,c[1]=s+d,s=c[1]):(c[0]=0,c[1]=0)}}}},tKe={sign:ZGe,expand:THe,none:Cg,silhouette:BHe,wiggle:kHe,positive:eKe},rKe=(t,e,r)=>{var n,a=(n=tKe[r])!==null&&n!==void 0?n:Cg,s=PHe().keys(e).value((l,c)=>Number(Js(l,c,0))).order(RF).offset(a),o=s(t);return o.forEach((l,c)=>{l.forEach((d,u)=>{var f=Js(t[u],e[c],0);Array.isArray(f)&&f.length===2&&On(f[0])&&On(f[1])&&(d[0]=f[0],d[1]=f[1])})}),o};function nKe(t){return t==null?void 0:String(t)}var gK=t=>{var{axis:e,ticks:r,offset:n,bandSize:a,entry:s,index:o}=t;if(e.type==="category")return r[o]?r[o].coordinate+n:null;var l=Js(s,e.dataKey,e.scale.domain()[o]);return vl(l)?null:e.scale(l)-a/2+n},aKe=t=>{var{numericAxis:e}=t,r=e.scale.domain();if(e.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},sKe=t=>{var e=t.flat(2).filter(On);return[Math.min(...e),Math.max(...e)]},iKe=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],oKe=(t,e,r)=>{if(t!=null)return iKe(Object.keys(t).reduce((n,a)=>{var s=t[a];if(!s)return n;var{stackedData:o}=s,l=o.reduce((c,d)=>{var u=Boe(d,e,r),f=sKe(u);return!Ti(f[0])||!Ti(f[1])?c:[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},xK=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,vK=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Pj=(t,e,r)=>{if(t&&t.scale&&t.scale.bandwidth){var n=t.scale.bandwidth();if(!r||n>0)return n}if(t&&e&&e.length>=2){for(var a=DP(e,u=>u.coordinate),s=1/0,o=1,l=a.length;o<l;o++){var c=a[o],d=a[o-1];s=Math.min(((c==null?void 0:c.coordinate)||0)-((d==null?void 0:d.coordinate)||0),s)}return s===1/0?0:s}return r?void 0:0};function yK(t){var{tooltipEntrySettings:e,dataKey:r,payload:n,value:a,name:s}=t;return sv(sv({},e),{},{dataKey:r,payload:n,value:a,name:s})}function KP(t,e){if(t)return String(t);if(typeof e=="string")return e}var lKe=(t,e)=>{if(e==="horizontal")return t.chartX;if(e==="vertical")return t.chartY},cKe=(t,e)=>e==="centric"?t.angle:t.radius,HA=t=>t.layout.width,$A=t=>t.layout.height,dKe=t=>t.layout.scale,koe=t=>t.layout.margin,qP=Zt(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),zP=Zt(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),Foe="data-recharts-item-index",Ooe="data-recharts-item-id",nN=60;function bK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function j_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bK(Object(r),!0).forEach(function(n){uKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function uKe(t,e,r){return(e=fKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fKe(t){var e=hKe(t,"string");return typeof e=="symbol"?e:e+""}function hKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var AKe=t=>t.brush.height;function mKe(t){var e=zP(t);return e.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:nN;return r+a}return r},0)}function pKe(t){var e=zP(t);return e.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:nN;return r+a}return r},0)}function gKe(t){var e=qP(t);return e.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function xKe(t){var e=qP(t);return e.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Wo=Zt([HA,$A,koe,AKe,mKe,pKe,gKe,xKe,toe,H$e],(t,e,r,n,a,s,o,l,c,d)=>{var u={left:(r.left||0)+a,right:(r.right||0)+s},f={top:(r.top||0)+o,bottom:(r.bottom||0)+l},A=j_(j_({},f),u),h=A.bottom;A.bottom+=n,A=XGe(A,c,d);var m=t-A.left-A.right,p=e-A.top-A.bottom;return j_(j_({brushBottom:h},A),{},{width:Math.max(m,0),height:Math.max(p,0)})}),vKe=Zt(Wo,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),_M=Zt(HA,$A,(t,e)=>({x:0,y:0,width:t,height:e})),yKe=g.createContext(null),Zd=()=>g.useContext(yKe)!=null,WP=t=>t.brush,XP=Zt([WP,Wo,koe],(t,e,r)=>({height:t.height,x:On(t.x)?t.x:e.left,y:On(t.y)?t.y:e.top+e.height+e.brushBottom-((r==null?void 0:r.bottom)||0),width:On(t.width)?t.width:e.width})),Doe={},Roe={},Moe={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n,{signal:a,edges:s}={}){let o,l=null;const c=s!=null&&s.includes("leading"),d=s==null||s.includes("trailing"),u=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},f=()=>{d&&u(),p()};let A=null;const h=()=>{A!=null&&clearTimeout(A),A=setTimeout(()=>{A=null,f()},n)},m=()=>{A!==null&&(clearTimeout(A),A=null)},p=()=>{m(),o=void 0,l=null},x=()=>{u()},v=function(...y){if(a!=null&&a.aborted)return;o=this,l=y;const b=A==null;h(),c&&b&&u()};return v.schedule=h,v.cancel=p,v.flush=x,a==null||a.addEventListener("abort",p,{once:!0}),v}t.debounce=e})(Moe);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Moe;function r(n,a=0,s={}){typeof s!="object"&&(s={});const{leading:o=!1,trailing:l=!0,maxWait:c}=s,d=Array(2);o&&(d[0]="leading"),l&&(d[1]="trailing");let u,f=null;const A=e.debounce(function(...p){u=n.apply(this,p),f=null},a,{edges:d}),h=function(...p){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(u=n.apply(this,p),f=Date.now(),A.cancel(),A.schedule(),u):(A.apply(this,p),u)},m=()=>(A.flush(),u);return h.cancel=A.cancel,h.flush=m,h}t.debounce=r})(Roe);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Roe;function r(n,a=0,s={}){const{leading:o=!0,trailing:l=!0}=s;return e.debounce(n,a,{leading:o,maxWait:a,trailing:l})}t.throttle=r})(Doe);var bKe=Doe.throttle;const wKe=kA(bKe);var wK=function(e,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!e))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(r.replace(/%s/g,()=>a[o++]))}},Loe=(t,e,r)=>{var{width:n="100%",height:a="100%",aspect:s,maxHeight:o}=r,l=EA(n)?t:Number(n),c=EA(a)?e:Number(a);return s&&s>0&&(l?c=l/s:c&&(l=c*s),o&&c!=null&&c>o&&(c=o)),{calculatedWidth:l,calculatedHeight:c}},NKe={width:0,height:0,overflow:"visible"},CKe={width:0,overflowX:"visible"},_Ke={height:0,overflowY:"visible"},EKe={},SKe=t=>{var{width:e,height:r}=t,n=EA(e),a=EA(r);return n&&a?NKe:n?CKe:a?_Ke:EKe};function jKe(t){var{width:e,height:r,aspect:n}=t,a=e,s=r;return a===void 0&&s===void 0?(a="100%",s="100%"):a===void 0?a=n&&n>0?void 0:"100%":s===void 0&&(s=n&&n>0?void 0:"100%"),{width:a,height:s}}function WF(){return WF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},WF.apply(null,arguments)}function NK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function CK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?NK(Object(r),!0).forEach(function(n){IKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):NK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function IKe(t,e,r){return(e=PKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PKe(t){var e=TKe(t,"string");return typeof e=="symbol"?e:e+""}function TKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Uoe=g.createContext({width:-1,height:-1});function BKe(t){return Om(t.width)&&Om(t.height)}function Qoe(t){var{children:e,width:r,height:n}=t,a=g.useMemo(()=>({width:r,height:n}),[r,n]);return BKe(a)?g.createElement(Uoe.Provider,{value:a},e):null}var EM=()=>g.useContext(Uoe),kKe=g.forwardRef((t,e)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a,height:s,minWidth:o=0,minHeight:l,maxHeight:c,children:d,debounce:u=0,id:f,className:A,onResize:h,style:m={}}=t,p=g.useRef(null),x=g.useRef();x.current=h,g.useImperativeHandle(e,()=>p.current);var[v,y]=g.useState({containerWidth:n.width,containerHeight:n.height}),b=g.useCallback((S,E)=>{y(B=>{var k=Math.round(S),T=Math.round(E);return B.containerWidth===k&&B.containerHeight===T?B:{containerWidth:k,containerHeight:T}})},[]);g.useEffect(()=>{if(p.current==null||typeof ResizeObserver>"u")return Zw;var S=T=>{var P,{width:q,height:de}=T[0].contentRect;b(q,de),(P=x.current)===null||P===void 0||P.call(x,q,de)};u>0&&(S=wKe(S,u,{trailing:!0,leading:!1}));var E=new ResizeObserver(S),{width:B,height:k}=p.current.getBoundingClientRect();return b(B,k),E.observe(p.current),()=>{E.disconnect()}},[b,u]);var{containerWidth:w,containerHeight:I}=v;wK(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:j,calculatedHeight:N}=Loe(w,I,{width:a,height:s,aspect:r,maxHeight:c});return wK(j!=null&&j>0||N!=null&&N>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,j,N,a,s,o,l,r),g.createElement("div",{id:f?"".concat(f):void 0,className:vs("recharts-responsive-container",A),style:CK(CK({},m),{},{width:a,height:s,minWidth:o,minHeight:l,maxHeight:c}),ref:p},g.createElement("div",{style:SKe({width:a,height:s})},g.createElement(Qoe,{width:j,height:N},d)))}),_K=g.forwardRef((t,e)=>{var r=EM();if(Om(r.width)&&Om(r.height))return t.children;var{width:n,height:a}=jKe({width:t.width,height:t.height,aspect:t.aspect}),{calculatedWidth:s,calculatedHeight:o}=Loe(void 0,void 0,{width:n,height:a,aspect:t.aspect,maxHeight:t.maxHeight});return On(s)&&On(o)?g.createElement(Qoe,{width:s,height:o},t.children):g.createElement(kKe,WF({},t,{width:n,height:a,ref:e}))});function Voe(t){if(t)return{x:t.x,y:t.y,upperWidth:"upperWidth"in t?t.upperWidth:t.width,lowerWidth:"lowerWidth"in t?t.lowerWidth:t.width,width:t.width,height:t.height}}var YP=()=>{var t,e=Zd(),r=In(vKe),n=In(XP),a=(t=In(WP))===null||t===void 0?void 0:t.padding;return!e||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},FKe={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},OKe=()=>{var t;return(t=In(Wo))!==null&&t!==void 0?t:FKe},Hoe=()=>In(HA),$oe=()=>In($A),DKe=()=>In(t=>t.layout.margin),za=t=>t.layout.layoutType,aN=()=>In(za),RKe=()=>{var t=aN();return t!==void 0},JP=t=>{var e=Us(),r=Zd(),{width:n,height:a}=t,s=EM(),o=n,l=a;return s&&(o=s.width>0?s.width:n,l=s.height>0?s.height:a),g.useEffect(()=>{!r&&Om(o)&&Om(l)&&e($Ge({width:o,height:l}))},[e,r,o,l]),null},Goe=Symbol.for("immer-nothing"),EK=Symbol.for("immer-draftable"),Xd=Symbol.for("immer-state");function pf(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var sw=Object.getPrototypeOf;function Jv(t){return!!t&&!!t[Xd]}function Sg(t){var e;return t?Koe(t)||Array.isArray(t)||!!t[EK]||!!((e=t.constructor)!=null&&e[EK])||sN(t)||e3(t):!1}var MKe=Object.prototype.constructor.toString(),SK=new WeakMap;function Koe(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);if(e===null||e===Object.prototype)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=SK.get(r);return n===void 0&&(n=Function.toString.call(r),SK.set(r,n)),n===MKe}function Tj(t,e,r=!0){ZP(t)===0?(r?Reflect.ownKeys(t):Object.keys(t)).forEach(a=>{e(a,t[a],t)}):t.forEach((n,a)=>e(a,n,t))}function ZP(t){const e=t[Xd];return e?e.type_:Array.isArray(t)?1:sN(t)?2:e3(t)?3:0}function XF(t,e){return ZP(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function qoe(t,e,r){const n=ZP(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function LKe(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function sN(t){return t instanceof Map}function e3(t){return t instanceof Set}function xp(t){return t.copy_||t.base_}function YF(t,e){if(sN(t))return new Map(t);if(e3(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=Koe(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[Xd];let a=Reflect.ownKeys(n);for(let s=0;s<a.length;s++){const o=a[s],l=n[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:t[o]})}return Object.create(sw(t),n)}else{const n=sw(t);if(n!==null&&r)return{...t};const a=Object.create(n);return Object.assign(a,t)}}function SM(t,e=!1){return t3(t)||Jv(t)||!Sg(t)||(ZP(t)>1&&Object.defineProperties(t,{set:I_,add:I_,clear:I_,delete:I_}),Object.freeze(t),e&&Object.values(t).forEach(r=>SM(r,!0))),t}function UKe(){pf(2)}var I_={value:UKe};function t3(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var QKe={};function jg(t){const e=QKe[t];return e||pf(0,t),e}var iw;function zoe(){return iw}function VKe(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function jK(t,e){e&&(jg("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function JF(t){ZF(t),t.drafts_.forEach(HKe),t.drafts_=null}function ZF(t){t===iw&&(iw=t.parent_)}function IK(t){return iw=VKe(iw,t)}function HKe(t){const e=t[Xd];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function PK(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[Xd].modified_&&(JF(e),pf(4)),Sg(t)&&(t=Bj(e,t),e.parent_||kj(e,t)),e.patches_&&jg("Patches").generateReplacementPatches_(r[Xd].base_,t,e.patches_,e.inversePatches_)):t=Bj(e,r,[]),JF(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==Goe?t:void 0}function Bj(t,e,r){if(t3(e))return e;const n=t.immer_.shouldUseStrictIteration(),a=e[Xd];if(!a)return Tj(e,(s,o)=>TK(t,a,e,s,o,r),n),e;if(a.scope_!==t)return e;if(!a.modified_)return kj(t,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const s=a.copy_;let o=s,l=!1;a.type_===3&&(o=new Set(s),s.clear(),l=!0),Tj(o,(c,d)=>TK(t,a,s,c,d,r,l),n),kj(t,s,!1),r&&t.patches_&&jg("Patches").generatePatches_(a,r,t.patches_,t.inversePatches_)}return a.copy_}function TK(t,e,r,n,a,s,o){if(a==null||typeof a!="object"&&!o)return;const l=t3(a);if(!(l&&!o)){if(Jv(a)){const c=s&&e&&e.type_!==3&&!XF(e.assigned_,n)?s.concat(n):void 0,d=Bj(t,a,c);if(qoe(r,n,d),Jv(d))t.canAutoFreeze_=!1;else return}else o&&r.add(a);if(Sg(a)&&!l){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||e&&e.base_&&e.base_[n]===a&&l)return;Bj(t,a),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&(sN(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&kj(t,a)}}}function kj(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&SM(e,r)}function $Ke(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:zoe(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,s=jM;r&&(a=[n],s=ow);const{revoke:o,proxy:l}=Proxy.revocable(a,s);return n.draft_=l,n.revoke_=o,l}var jM={get(t,e){if(e===Xd)return t;const r=xp(t);if(!XF(r,e))return GKe(t,r,e);const n=r[e];return t.finalized_||!Sg(n)?n:n===ST(t.base_,e)?(jT(t),t.copy_[e]=tO(n,t)):n},has(t,e){return e in xp(t)},ownKeys(t){return Reflect.ownKeys(xp(t))},set(t,e,r){const n=Woe(xp(t),e);if(n!=null&&n.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const a=ST(xp(t),e),s=a==null?void 0:a[Xd];if(s&&s.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(LKe(r,a)&&(r!==void 0||XF(t.base_,e)))return!0;jT(t),eO(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return ST(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,jT(t),eO(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=xp(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){pf(11)},getPrototypeOf(t){return sw(t.base_)},setPrototypeOf(){pf(12)}},ow={};Tj(jM,(t,e)=>{ow[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});ow.deleteProperty=function(t,e){return ow.set.call(this,t,e,void 0)};ow.set=function(t,e,r){return jM.set.call(this,t[0],e,r,t[0])};function ST(t,e){const r=t[Xd];return(r?xp(r):t)[e]}function GKe(t,e,r){var a;const n=Woe(e,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(t.draft_):void 0}function Woe(t,e){if(!(e in t))return;let r=sw(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=sw(r)}}function eO(t){t.modified_||(t.modified_=!0,t.parent_&&eO(t.parent_))}function jT(t){t.copy_||(t.copy_=YF(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var KKe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const s=r;r=e;const o=this;return function(c=s,...d){return o.produce(c,u=>r.call(this,u,...d))}}typeof r!="function"&&pf(6),n!==void 0&&typeof n!="function"&&pf(7);let a;if(Sg(e)){const s=IK(this),o=tO(e,void 0);let l=!0;try{a=r(o),l=!1}finally{l?JF(s):ZF(s)}return jK(s,n),PK(a,s)}else if(!e||typeof e!="object"){if(a=r(e),a===void 0&&(a=e),a===Goe&&(a=void 0),this.autoFreeze_&&SM(a,!0),n){const s=[],o=[];jg("Patches").generateReplacementPatches_(e,a,s,o),n(s,o)}return a}else pf(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,c=>e(c,...l));let n,a;return[this.produce(e,r,(o,l)=>{n=o,a=l}),n,a]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof(t==null?void 0:t.useStrictIteration)=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){Sg(t)||pf(8),Jv(t)&&(t=qKe(t));const e=IK(this),r=tO(t,void 0);return r[Xd].isManual_=!0,ZF(e),r}finishDraft(t,e){const r=t&&t[Xd];(!r||!r.isManual_)&&pf(9);const{scope_:n}=r;return jK(n,e),PK(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const a=e[r];if(a.path.length===0&&a.op==="replace"){t=a.value;break}}r>-1&&(e=e.slice(r+1));const n=jg("Patches").applyPatches_;return Jv(t)?n(t,e):this.produce(t,a=>n(a,e))}};function tO(t,e){const r=sN(t)?jg("MapSet").proxyMap_(t,e):e3(t)?jg("MapSet").proxySet_(t,e):$Ke(t,e);return(e?e.scope_:zoe()).drafts_.push(r),r}function qKe(t){return Jv(t)||pf(10,t),Xoe(t)}function Xoe(t){if(!Sg(t)||t3(t))return t;const e=t[Xd];let r,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=YF(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else r=YF(t,!0);return Tj(r,(a,s)=>{qoe(r,a,Xoe(s))},n),e&&(e.finalized_=!1),r}var zKe=new KKe;zKe.produce;var WKe={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},Yoe=xd({name:"legend",initialState:WKe,reducers:{setLegendSize(t,e){t.size.width=e.payload.width,t.size.height=e.payload.height},setLegendSettings(t,e){t.settings.align=e.payload.align,t.settings.layout=e.payload.layout,t.settings.verticalAlign=e.payload.verticalAlign,t.settings.itemSorter=e.payload.itemSorter},addLegendPayload:{reducer(t,e){t.payload.push(e.payload)},prepare:ii()},replaceLegendPayload:{reducer(t,e){var{prev:r,next:n}=e.payload,a=_f(t).payload.indexOf(r);a>-1&&(t.payload[a]=n)},prepare:ii()},removeLegendPayload:{reducer(t,e){var r=_f(t).payload.indexOf(e.payload);r>-1&&t.payload.splice(r,1)},prepare:ii()}}}),{setLegendSize:BK,setLegendSettings:XKe,addLegendPayload:Joe,replaceLegendPayload:Zoe,removeLegendPayload:ele}=Yoe.actions,YKe=Yoe.reducer,JKe=["contextPayload"];function rO(){return rO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},rO.apply(null,arguments)}function kK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Zv(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kK(Object(r),!0).forEach(function(n){ZKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ZKe(t,e,r){return(e=eqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eqe(t){var e=tqe(t,"string");return typeof e=="symbol"?e:e+""}function tqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rqe(t,e){if(t==null)return{};var r,n,a=nqe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function nqe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function aqe(t){return t.value}function sqe(t){var{contextPayload:e}=t,r=rqe(t,JKe),n=$ie(e,t.payloadUniqBy,aqe),a=Zv(Zv({},r),{},{payload:n});return g.isValidElement(t.content)?g.cloneElement(t.content,a):typeof t.content=="function"?g.createElement(t.content,a):g.createElement(l$e,a)}function iqe(t,e,r,n,a,s){var{layout:o,align:l,verticalAlign:c}=e,d,u;return(!t||(t.left===void 0||t.left===null)&&(t.right===void 0||t.right===null))&&(l==="center"&&o==="vertical"?d={left:((n||0)-s.width)/2}:d=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!t||(t.top===void 0||t.top===null)&&(t.bottom===void 0||t.bottom===null))&&(c==="middle"?u={top:((a||0)-s.height)/2}:u=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),Zv(Zv({},d),u)}function oqe(t){var e=Us();return g.useEffect(()=>{e(XKe(t))},[e,t]),null}function lqe(t){var e=Us();return g.useEffect(()=>(e(BK(t)),()=>{e(BK({width:0,height:0}))}),[e,t]),null}function cqe(t,e,r,n){return t==="vertical"&&On(e)?{height:e}:t==="horizontal"?{width:r||n}:null}var dqe={align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function nO(t){var e=Kl(t,dqe),r=K$e(),n=eHe(),a=DKe(),{width:s,height:o,wrapperStyle:l,portal:c}=e,[d,u]=roe([r]),f=Hoe(),A=$oe();if(f==null||A==null)return null;var h=f-((a==null?void 0:a.left)||0)-((a==null?void 0:a.right)||0),m=cqe(e.layout,o,s,h),p=c?l:Zv(Zv({position:"absolute",width:(m==null?void 0:m.width)||s||"auto",height:(m==null?void 0:m.height)||o||"auto"},iqe(l,e,a,f,A,d)),l),x=c??n;if(x==null||r==null)return null;var v=g.createElement("div",{className:"recharts-legend-wrapper",style:p,ref:u},g.createElement(oqe,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),!c&&g.createElement(lqe,{width:d.width,height:d.height}),g.createElement(sqe,rO({},e,m,{margin:a,chartWidth:f,chartHeight:A,contextPayload:r})));return $d.createPortal(v,x)}nO.displayName="Legend";function aO(){return aO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},aO.apply(null,arguments)}function FK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function IT(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?FK(Object(r),!0).forEach(function(n){uqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):FK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function uqe(t,e,r){return(e=fqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fqe(t){var e=hqe(t,"string");return typeof e=="symbol"?e:e+""}function hqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Aqe(t){return Array.isArray(t)&&mh(t[0])&&mh(t[1])?t.join(" ~ "):t}var mqe=t=>{var{separator:e=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:s,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:d,label:u,labelFormatter:f,accessibilityLayer:A=!1}=t,h=()=>{if(s&&s.length){var I={padding:0,margin:0},j=(l?DP(s,l):s).map((N,S)=>{if(N.type==="none")return null;var E=N.formatter||o||Aqe,{value:B,name:k}=N,T=B,P=k;if(E){var q=E(B,k,N,S,s);if(Array.isArray(q))[T,P]=q;else if(q!=null)T=q;else return null}var de=IT({display:"block",paddingTop:4,paddingBottom:4,color:N.color||"#000"},n);return g.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(S),style:de},mh(P)?g.createElement("span",{className:"recharts-tooltip-item-name"},P):null,mh(P)?g.createElement("span",{className:"recharts-tooltip-item-separator"},e):null,g.createElement("span",{className:"recharts-tooltip-item-value"},T),g.createElement("span",{className:"recharts-tooltip-item-unit"},N.unit||""))});return g.createElement("ul",{className:"recharts-tooltip-item-list",style:I},j)}return null},m=IT({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),p=IT({margin:0},a),x=!vl(u),v=x?u:"",y=vs("recharts-default-tooltip",c),b=vs("recharts-tooltip-label",d);x&&f&&s!==void 0&&s!==null&&(v=f(u,s));var w=A?{role:"status","aria-live":"assertive"}:{};return g.createElement("div",aO({className:y,style:m},w),g.createElement("p",{className:b,style:p},g.isValidElement(v)?v:"".concat(v)),h())},Ty="recharts-tooltip-wrapper",pqe={visibility:"hidden"};function gqe(t){var{coordinate:e,translateX:r,translateY:n}=t;return vs(Ty,{["".concat(Ty,"-right")]:On(r)&&e&&On(e.x)&&r>=e.x,["".concat(Ty,"-left")]:On(r)&&e&&On(e.x)&&r<e.x,["".concat(Ty,"-bottom")]:On(n)&&e&&On(e.y)&&n>=e.y,["".concat(Ty,"-top")]:On(n)&&e&&On(e.y)&&n<e.y})}function OK(t){var{allowEscapeViewBox:e,coordinate:r,key:n,offsetTopLeft:a,position:s,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:d}=t;if(s&&On(s[n]))return s[n];var u=r[n]-l-(a>0?a:0),f=r[n]+a;if(e[n])return o[n]?u:f;var A=c[n];if(A==null)return 0;if(o[n]){var h=u,m=A;return h<m?Math.max(f,A):Math.max(u,A)}if(d==null)return 0;var p=f+l,x=A+d;return p>x?Math.max(u,A):Math.max(f,A)}function xqe(t){var{translateX:e,translateY:r,useTranslate3d:n}=t;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function vqe(t){var{allowEscapeViewBox:e,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:s,tooltipBox:o,useTranslate3d:l,viewBox:c}=t,d,u,f;return o.height>0&&o.width>0&&r?(u=OK({allowEscapeViewBox:e,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:s,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),f=OK({allowEscapeViewBox:e,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:s,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),d=xqe({translateX:u,translateY:f,useTranslate3d:l})):d=pqe,{cssProperties:d,cssClasses:gqe({translateX:u,translateY:f,coordinate:r})}}function DK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function P_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?DK(Object(r),!0).forEach(function(n){sO(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):DK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function sO(t,e,r){return(e=yqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yqe(t){var e=bqe(t,"string");return typeof e=="symbol"?e:e+""}function bqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wqe extends g.PureComponent{constructor(){super(...arguments),sO(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),sO(this,"handleKeyDown",e=>{if(e.key==="Escape"){var r,n,a,s;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,r;this.state.dismissed&&(((e=this.props.coordinate)===null||e===void 0?void 0:e.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:e,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:s,coordinate:o,hasPayload:l,isAnimationActive:c,offset:d,position:u,reverseDirection:f,useTranslate3d:A,viewBox:h,wrapperStyle:m,lastBoundingBox:p,innerRef:x,hasPortalFromProps:v}=this.props,{cssClasses:y,cssProperties:b}=vqe({allowEscapeViewBox:r,coordinate:o,offsetTopLeft:d,position:u,reverseDirection:f,tooltipBox:{height:p.height,width:p.width},useTranslate3d:A,viewBox:h}),w=v?{}:P_(P_({transition:c&&e?"transform ".concat(n,"ms ").concat(a):void 0},b),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&l?"visible":"hidden",position:"absolute",top:0,left:0}),I=P_(P_({},w),{},{visibility:!this.state.dismissed&&e&&l?"visible":"hidden"},m);return g.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:y,style:I,ref:x},s)}}var tle=()=>{var t;return(t=In(e=>e.rootProps.accessibilityLayer))!==null&&t!==void 0?t:!0};function iO(){return iO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},iO.apply(null,arguments)}function RK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function MK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?RK(Object(r),!0).forEach(function(n){Nqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):RK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Nqe(t,e,r){return(e=Cqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Cqe(t){var e=_qe(t,"string");return typeof e=="symbol"?e:e+""}function _qe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var LK={curveBasisClosed:vHe,curveBasisOpen:yHe,curveBasis:xHe,curveBumpX:aHe,curveBumpY:sHe,curveLinearClosed:bHe,curveLinear:IP,curveMonotoneX:wHe,curveMonotoneY:NHe,curveNatural:CHe,curveStep:_He,curveStepAfter:SHe,curveStepBefore:EHe},Fj=t=>Ti(t.x)&&Ti(t.y),UK=t=>t.base!=null&&Fj(t.base)&&Fj(t),By=t=>t.x,ky=t=>t.y,Eqe=(t,e)=>{if(typeof t=="function")return t;var r="curve".concat(Jw(t));return(r==="curveMonotone"||r==="curveBump")&&e?LK["".concat(r).concat(e==="vertical"?"Y":"X")]:LK[r]||IP},Sqe=t=>{var{type:e="linear",points:r=[],baseLine:n,layout:a,connectNulls:s=!1}=t,o=Eqe(e,a),l=s?r.filter(Fj):r,c;if(Array.isArray(n)){var d=r.map((h,m)=>MK(MK({},h),{},{base:n[m]}));a==="vertical"?c=w_().y(ky).x1(By).x0(h=>h.base.x):c=w_().x(By).y1(ky).y0(h=>h.base.y);var u=c.defined(UK).curve(o),f=s?d.filter(UK):d;return u(f)}a==="vertical"&&On(n)?c=w_().y(ky).x1(By).x0(n):On(n)?c=w_().x(By).y1(ky).y0(n):c=uie().x(By).y(ky);var A=c.defined(Fj).curve(o);return A(l)},IM=t=>{var{className:e,points:r,path:n,pathRef:a}=t,s=aN();if((!r||!r.length)&&!n)return null;var o={type:t.type,points:t.points,baseLine:t.baseLine,layout:t.layout||s,connectNulls:t.connectNulls},l=r&&r.length?Sqe(o):n;return g.createElement("path",iO({},hh(t),WHe(t),{className:vs("recharts-curve",e),d:l===null?void 0:l,ref:a}))},jqe=["x","y","top","left","width","height","className"];function oO(){return oO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},oO.apply(null,arguments)}function QK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Iqe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?QK(Object(r),!0).forEach(function(n){Pqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):QK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Pqe(t,e,r){return(e=Tqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Tqe(t){var e=Bqe(t,"string");return typeof e=="symbol"?e:e+""}function Bqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kqe(t,e){if(t==null)return{};var r,n,a=Fqe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Fqe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Oqe=(t,e,r,n,a,s)=>"M".concat(t,",").concat(a,"v").concat(n,"M").concat(s,",").concat(e,"h").concat(r),Dqe=t=>{var{x:e=0,y:r=0,top:n=0,left:a=0,width:s=0,height:o=0,className:l}=t,c=kqe(t,jqe),d=Iqe({x:e,y:r,top:n,left:a,width:s,height:o},c);return!On(e)||!On(r)||!On(s)||!On(o)||!On(n)||!On(a)?null:g.createElement("path",oO({},Qu(d),{className:vs("recharts-cross",l),d:Oqe(e,r,s,o,n,a)}))};function Rqe(t,e,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-a:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-a,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function VK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function HK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?VK(Object(r),!0).forEach(function(n){Mqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):VK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Mqe(t,e,r){return(e=Lqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lqe(t){var e=Uqe(t,"string");return typeof e=="symbol"?e:e+""}function Uqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Qqe=t=>t.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())),rle=(t,e,r)=>t.map(n=>"".concat(Qqe(n)," ").concat(e,"ms ").concat(r)).join(","),Vqe=(t,e)=>[Object.keys(t),Object.keys(e)].reduce((r,n)=>r.filter(a=>n.includes(a))),lw=(t,e)=>Object.keys(e).reduce((r,n)=>HK(HK({},r),{},{[n]:t(n,e[n])}),{});function $K(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Lo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$K(Object(r),!0).forEach(function(n){Hqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$K(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Hqe(t,e,r){return(e=$qe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $qe(t){var e=Gqe(t,"string");return typeof e=="symbol"?e:e+""}function Gqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Oj=(t,e,r)=>t+(e-t)*r,lO=t=>{var{from:e,to:r}=t;return e!==r},nle=(t,e,r)=>{var n=lw((a,s)=>{if(lO(s)){var[o,l]=t(s.from,s.to,s.velocity);return Lo(Lo({},s),{},{from:o,velocity:l})}return s},e);return r<1?lw((a,s)=>lO(s)&&n[a]!=null?Lo(Lo({},s),{},{velocity:Oj(s.velocity,n[a].velocity,r),from:Oj(s.from,n[a].from,r)}):s,e):nle(t,n,r-1)};function Kqe(t,e,r,n,a,s){var o,l=n.reduce((A,h)=>Lo(Lo({},A),{},{[h]:{from:t[h],velocity:0,to:e[h]}}),{}),c=()=>lw((A,h)=>h.from,l),d=()=>!Object.values(l).filter(lO).length,u=null,f=A=>{o||(o=A);var h=A-o,m=h/r.dt;l=nle(r,l,m),a(Lo(Lo(Lo({},t),e),c())),o=A,d()||(u=s.setTimeout(f))};return()=>(u=s.setTimeout(f),()=>{var A;(A=u)===null||A===void 0||A()})}function qqe(t,e,r,n,a,s,o){var l=null,c=a.reduce((f,A)=>{var h=t[A],m=e[A];return h==null||m==null?f:Lo(Lo({},f),{},{[A]:[h,m]})},{}),d,u=f=>{d||(d=f);var A=(f-d)/n,h=lw((p,x)=>Oj(...x,r(A)),c);if(s(Lo(Lo(Lo({},t),e),h)),A<1)l=o.setTimeout(u);else{var m=lw((p,x)=>Oj(...x,r(1)),c);s(Lo(Lo(Lo({},t),e),m))}};return()=>(l=o.setTimeout(u),()=>{var f;(f=l)===null||f===void 0||f()})}const zqe=(t,e,r,n,a,s)=>{var o=Vqe(t,e);return r==null?()=>(a(Lo(Lo({},t),e)),()=>{}):r.isStepper===!0?Kqe(t,e,r,o,a,s):qqe(t,e,r,n,o,a,s)};var Dj=1e-4,ale=(t,e)=>[0,3*t,3*e-6*t,3*t-3*e+1],sle=(t,e)=>t.map((r,n)=>r*e**n).reduce((r,n)=>r+n),GK=(t,e)=>r=>{var n=ale(t,e);return sle(n,r)},Wqe=(t,e)=>r=>{var n=ale(t,e),a=[...n.map((s,o)=>s*o).slice(1),0];return sle(a,r)},Xqe=t=>{var e,r=t.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(e=r[1])===null||e===void 0||(e=e.split(")")[0])===null||e===void 0?void 0:e.split(",");if(n==null||n.length!==4)return null;var a=n.map(s=>parseFloat(s));return[a[0],a[1],a[2],a[3]]},Yqe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var a=Xqe(r[0]);if(a)return a}}return r.length===4?r:[0,0,1,1]},Jqe=(t,e,r,n)=>{var a=GK(t,r),s=GK(e,n),o=Wqe(t,r),l=d=>d>1?1:d<0?0:d,c=d=>{for(var u=d>1?1:d,f=u,A=0;A<8;++A){var h=a(f)-u,m=o(f);if(Math.abs(h-u)<Dj||m<Dj)return s(f);f=l(f-h/m)}return s(f)};return c.isStepper=!1,c},KK=function(){return Jqe(...Yqe(...arguments))},Zqe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=e,s=(o,l,c)=>{var d=-(o-l)*r,u=c*n,f=c+(d-u)*a/1e3,A=c*a/1e3+o;return Math.abs(A-l)<Dj&&Math.abs(f)<Dj?[l,0]:[A,f]};return s.isStepper=!0,s.dt=a,s},eze=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return KK(t);case"spring":return Zqe();default:if(t.split("(")[0]==="cubic-bezier")return KK(t)}return typeof t=="function"?t:null};function tze(t){var e,r=()=>null,n=!1,a=null,s=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...d]=l;if(typeof c=="number"){a=t.setTimeout(s.bind(null,d),c);return}s(c),a=t.setTimeout(s.bind(null,d));return}typeof o=="string"&&(e=o,r(e)),typeof o=="object"&&(e=o,r(e)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,a&&(a(),a=null),s(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>t}}class rze{setTimeout(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,s=o=>{o-n>=r?e(o):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(s))};return a=requestAnimationFrame(s),()=>{a!=null&&cancelAnimationFrame(a)}}}function nze(){return tze(new rze)}var aze=g.createContext(nze);function sze(t,e){var r=g.useContext(aze);return g.useMemo(()=>e??r(t),[t,e,r])}var ize=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),r3={isSsr:ize()},oze={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},qK={t:0},PT={t:1};function n3(t){var e=Kl(t,oze),{isActive:r,canBegin:n,duration:a,easing:s,begin:o,onAnimationEnd:l,onAnimationStart:c,children:d}=e,u=r==="auto"?!r3.isSsr:r,f=sze(e.animationId,e.animationManager),[A,h]=g.useState(u?qK:PT),m=g.useRef(null);return g.useEffect(()=>{u||h(PT)},[u]),g.useEffect(()=>{if(!u||!n)return Zw;var p=zqe(qK,PT,eze(s),a,h,f.getTimeoutController()),x=()=>{m.current=p()};return f.start([c,o,x,a,l]),()=>{f.stop(),m.current&&m.current(),l()}},[u,n,a,s,o,c,l,f]),d(A.t)}function a3(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=g.useRef(tw(e)),n=g.useRef(t);return n.current!==t&&(r.current=tw(e),n.current=t),r.current}var lze=["radius"],cze=["radius"],zK,WK,XK,YK,JK,ZK,eq,tq,rq,nq;function aq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function sq(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?aq(Object(r),!0).forEach(function(n){dze(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):aq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function dze(t,e,r){return(e=uze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uze(t){var e=fze(t,"string");return typeof e=="symbol"?e:e+""}function fze(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rj(){return Rj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Rj.apply(null,arguments)}function iq(t,e){if(t==null)return{};var r,n,a=hze(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function hze(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Gf(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var oq=(t,e,r,n,a)=>{var s=tm(r),o=tm(n),l=Math.min(Math.abs(s)/2,Math.abs(o)/2),c=o>=0?1:-1,d=s>=0?1:-1,u=o>=0&&s>=0||o<0&&s<0?1:0,f;if(l>0&&a instanceof Array){for(var A=[0,0,0,0],h=0,m=4;h<m;h++)A[h]=a[h]>l?l:a[h];f=Mi(zK||(zK=Gf(["M",",",""])),t,e+c*A[0]),A[0]>0&&(f+=Mi(WK||(WK=Gf(["A ",",",",0,0,",",",",",""])),A[0],A[0],u,t+d*A[0],e)),f+=Mi(XK||(XK=Gf(["L ",",",""])),t+r-d*A[1],e),A[1]>0&&(f+=Mi(YK||(YK=Gf(["A ",",",",0,0,",`,
        `,",",""])),A[1],A[1],u,t+r,e+c*A[1])),f+=Mi(JK||(JK=Gf(["L ",",",""])),t+r,e+n-c*A[2]),A[2]>0&&(f+=Mi(ZK||(ZK=Gf(["A ",",",",0,0,",`,
        `,",",""])),A[2],A[2],u,t+r-d*A[2],e+n)),f+=Mi(eq||(eq=Gf(["L ",",",""])),t+d*A[3],e+n),A[3]>0&&(f+=Mi(tq||(tq=Gf(["A ",",",",0,0,",`,
        `,",",""])),A[3],A[3],u,t,e+n-c*A[3])),f+="Z"}else if(l>0&&a===+a&&a>0){var p=Math.min(l,a);f=Mi(rq||(rq=Gf(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),t,e+c*p,p,p,u,t+d*p,e,t+r-d*p,e,p,p,u,t+r,e+c*p,t+r,e+n-c*p,p,p,u,t+r-d*p,e+n,t+d*p,e+n,p,p,u,t,e+n-c*p)}else f=Mi(nq||(nq=Gf(["M ",","," h "," v "," h "," Z"])),t,e,r,n,-r);return f},lq={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},ile=t=>{var e=Kl(t,lq),r=g.useRef(null),[n,a]=g.useState(-1);g.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var le=r.current.getTotalLength();le&&a(le)}catch{}},[]);var{x:s,y:o,width:l,height:c,radius:d,className:u}=e,{animationEasing:f,animationDuration:A,animationBegin:h,isAnimationActive:m,isUpdateAnimationActive:p}=e,x=g.useRef(l),v=g.useRef(c),y=g.useRef(s),b=g.useRef(o),w=g.useMemo(()=>({x:s,y:o,width:l,height:c,radius:d}),[s,o,l,c,d]),I=a3(w,"rectangle-");if(s!==+s||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var j=vs("recharts-rectangle",u);if(!p){var N=Qu(e),{radius:S}=N,E=iq(N,lze);return g.createElement("path",Rj({},E,{x:tm(s),y:tm(o),width:tm(l),height:tm(c),radius:typeof d=="number"?d:void 0,className:j,d:oq(s,o,l,c,d)}))}var B=x.current,k=v.current,T=y.current,P=b.current,q="0px ".concat(n===-1?1:n,"px"),de="".concat(n,"px 0px"),ce=rle(["strokeDasharray"],A,typeof f=="string"?f:lq.animationEasing);return g.createElement(n3,{animationId:I,key:I,canBegin:n>0,duration:A,easing:f,isActive:p,begin:h},le=>{var he=Mo(B,l,le),ae=Mo(k,c,le),Ce=Mo(T,s,le),De=Mo(P,o,le);r.current&&(x.current=he,v.current=ae,y.current=Ce,b.current=De);var O;m?le>0?O={transition:ce,strokeDasharray:de}:O={strokeDasharray:q}:O={strokeDasharray:de};var R=Qu(e),{radius:G}=R,M=iq(R,cze);return g.createElement("path",Rj({},M,{radius:typeof d=="number"?d:void 0,className:j,d:oq(Ce,De,he,ae,d),ref:r,style:sq(sq({},O),e.style)}))})};function cq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function dq(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?cq(Object(r),!0).forEach(function(n){Aze(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):cq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Aze(t,e,r){return(e=mze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mze(t){var e=pze(t,"string");return typeof e=="symbol"?e:e+""}function pze(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Mj=Math.PI/180,gze=t=>t*180/Math.PI,No=(t,e,r,n)=>({x:t+Math.cos(-Mj*n)*r,y:e+Math.sin(-Mj*n)*r}),ole=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},xze=(t,e)=>{var{x:r,y:n}=t,{x:a,y:s}=e;return Math.sqrt((r-a)**2+(n-s)**2)},vze=(t,e)=>{var{x:r,y:n}=t,{cx:a,cy:s}=e,o=xze({x:r,y:n},{x:a,y:s});if(o<=0)return{radius:o,angle:0};var l=(r-a)/o,c=Math.acos(l);return n>s&&(c=2*Math.PI-c),{radius:o,angle:gze(c),angleInRadian:c}},yze=t=>{var{startAngle:e,endAngle:r}=t,n=Math.floor(e/360),a=Math.floor(r/360),s=Math.min(n,a);return{startAngle:e-s*360,endAngle:r-s*360}},bze=(t,e)=>{var{startAngle:r,endAngle:n}=e,a=Math.floor(r/360),s=Math.floor(n/360),o=Math.min(a,s);return t+o*360},wze=(t,e)=>{var{chartX:r,chartY:n}=t,{radius:a,angle:s}=vze({x:r,y:n},e),{innerRadius:o,outerRadius:l}=e;if(a<o||a>l||a===0)return null;var{startAngle:c,endAngle:d}=yze(e),u=s,f;if(c<=d){for(;u>d;)u-=360;for(;u<c;)u+=360;f=u>=c&&u<=d}else{for(;u>c;)u-=360;for(;u<d;)u+=360;f=u>=d&&u<=c}return f?dq(dq({},e),{},{radius:a,angle:bze(u,e)}):null};function lle(t){var{cx:e,cy:r,radius:n,startAngle:a,endAngle:s}=t,o=No(e,r,n,a),l=No(e,r,n,s);return{points:[o,l],cx:e,cy:r,radius:n,startAngle:a,endAngle:s}}var uq,fq,hq,Aq,mq,pq,gq;function cO(){return cO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},cO.apply(null,arguments)}function Fp(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var Nze=(t,e)=>{var r=Hl(e-t),n=Math.min(Math.abs(e-t),359.999);return r*n},T_=t=>{var{cx:e,cy:r,radius:n,angle:a,sign:s,isExternal:o,cornerRadius:l,cornerIsExternal:c}=t,d=l*(o?1:-1)+n,u=Math.asin(l/d)/Mj,f=c?a:a+s*u,A=No(e,r,d,f),h=No(e,r,n,f),m=c?a-s*u:a,p=No(e,r,d*Math.cos(u*Mj),m);return{center:A,circleTangency:h,lineTangency:p,theta:u}},cle=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:a,startAngle:s,endAngle:o}=t,l=Nze(s,o),c=s+l,d=No(e,r,a,s),u=No(e,r,a,c),f=Mi(uq||(uq=Fp(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),d.x,d.y,a,a,+(Math.abs(l)>180),+(s>c),u.x,u.y);if(n>0){var A=No(e,r,n,s),h=No(e,r,n,c);f+=Mi(fq||(fq=Fp(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),h.x,h.y,n,n,+(Math.abs(l)>180),+(s<=c),A.x,A.y)}else f+=Mi(hq||(hq=Fp(["L ",","," Z"])),e,r);return f},Cze=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:a,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:d}=t,u=Hl(d-c),{circleTangency:f,lineTangency:A,theta:h}=T_({cx:e,cy:r,radius:a,angle:c,sign:u,cornerRadius:s,cornerIsExternal:l}),{circleTangency:m,lineTangency:p,theta:x}=T_({cx:e,cy:r,radius:a,angle:d,sign:-u,cornerRadius:s,cornerIsExternal:l}),v=l?Math.abs(c-d):Math.abs(c-d)-h-x;if(v<0)return o?Mi(Aq||(Aq=Fp(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),A.x,A.y,s,s,s*2,s,s,-s*2):cle({cx:e,cy:r,innerRadius:n,outerRadius:a,startAngle:c,endAngle:d});var y=Mi(mq||(mq=Fp(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),A.x,A.y,s,s,+(u<0),f.x,f.y,a,a,+(v>180),+(u<0),m.x,m.y,s,s,+(u<0),p.x,p.y);if(n>0){var{circleTangency:b,lineTangency:w,theta:I}=T_({cx:e,cy:r,radius:n,angle:c,sign:u,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),{circleTangency:j,lineTangency:N,theta:S}=T_({cx:e,cy:r,radius:n,angle:d,sign:-u,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),E=l?Math.abs(c-d):Math.abs(c-d)-I-S;if(E<0&&s===0)return"".concat(y,"L").concat(e,",").concat(r,"Z");y+=Mi(pq||(pq=Fp(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),N.x,N.y,s,s,+(u<0),j.x,j.y,n,n,+(E>180),+(u>0),b.x,b.y,s,s,+(u<0),w.x,w.y)}else y+=Mi(gq||(gq=Fp(["L",",","Z"])),e,r);return y},_ze={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},dle=t=>{var e=Kl(t,_ze),{cx:r,cy:n,innerRadius:a,outerRadius:s,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u,className:f}=e;if(s<a||d===u)return null;var A=vs("recharts-sector",f),h=s-a,m=gc(o,h,0,!0),p;return m>0&&Math.abs(d-u)<360?p=Cze({cx:r,cy:n,innerRadius:a,outerRadius:s,cornerRadius:Math.min(m,h/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u}):p=cle({cx:r,cy:n,innerRadius:a,outerRadius:s,startAngle:d,endAngle:u}),g.createElement("path",cO({},Qu(e),{className:A,d:p}))};function Eze(t,e,r){if(t==="horizontal")return[{x:e.x,y:r.top},{x:e.x,y:r.top+r.height}];if(t==="vertical")return[{x:r.left,y:e.y},{x:r.left+r.width,y:e.y}];if(Eie(e)){if(t==="centric"){var{cx:n,cy:a,innerRadius:s,outerRadius:o,angle:l}=e,c=No(n,a,s,l),d=No(n,a,o,l);return[{x:c.x,y:c.y},{x:d.x,y:d.y}]}return lle(e)}}var ule={},fle={},hle={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=gM;function r(n){return e.isSymbol(n)?NaN:Number(n)}t.toNumber=r})(hle);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=hle;function r(n){return n?(n=e.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}t.toFinite=r})(fle);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=xM,r=fle;function n(a,s,o){o&&typeof o!="number"&&e.isIterateeCall(a,s,o)&&(s=o=void 0),a=r.toFinite(a),s===void 0?(s=a,a=0):s=r.toFinite(s),o=o===void 0?a<s?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((s-a)/(o||1)),0),c=new Array(l);for(let d=0;d<l;d++)c[d]=a,a+=o;return c}t.range=n})(ule);var Sze=ule.range;const Ale=kA(Sze);function vm(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function jze(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function PM(t){let e,r,n;t.length!==2?(e=vm,r=(l,c)=>vm(t(l),c),n=(l,c)=>t(l)-c):(e=t===vm||t===jze?t:Ize,r=t,n=t);function a(l,c,d=0,u=l.length){if(d<u){if(e(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<0?d=f+1:u=f}while(d<u)}return d}function s(l,c,d=0,u=l.length){if(d<u){if(e(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<=0?d=f+1:u=f}while(d<u)}return d}function o(l,c,d=0,u=l.length){const f=a(l,c,d,u-1);return f>d&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:a,center:o,right:s}}function Ize(){return 0}function mle(t){return t===null?NaN:+t}function*Pze(t,e){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const Tze=PM(vm),iN=Tze.right;PM(mle).center;class xq extends Map{constructor(e,r=Fze){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,a]of e)this.set(n,a)}get(e){return super.get(vq(this,e))}has(e){return super.has(vq(this,e))}set(e,r){return super.set(Bze(this,e),r)}delete(e){return super.delete(kze(this,e))}}function vq({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function Bze({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function kze({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function Fze(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Oze(t=vm){if(t===vm)return ple;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function ple(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const Dze=Math.sqrt(50),Rze=Math.sqrt(10),Mze=Math.sqrt(2);function Lj(t,e,r){const n=(e-t)/Math.max(0,r),a=Math.floor(Math.log10(n)),s=n/Math.pow(10,a),o=s>=Dze?10:s>=Rze?5:s>=Mze?2:1;let l,c,d;return a<0?(d=Math.pow(10,-a)/o,l=Math.round(t*d),c=Math.round(e*d),l/d<t&&++l,c/d>e&&--c,d=-d):(d=Math.pow(10,a)*o,l=Math.round(t/d),c=Math.round(e/d),l*d<t&&++l,c*d>e&&--c),c<l&&.5<=r&&r<2?Lj(t,e,r*2):[l,c,d]}function dO(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[a,s,o]=n?Lj(e,t,r):Lj(t,e,r);if(!(s>=a))return[];const l=s-a+1,c=new Array(l);if(n)if(o<0)for(let d=0;d<l;++d)c[d]=(s-d)/-o;else for(let d=0;d<l;++d)c[d]=(s-d)*o;else if(o<0)for(let d=0;d<l;++d)c[d]=(a+d)/-o;else for(let d=0;d<l;++d)c[d]=(a+d)*o;return c}function uO(t,e,r){return e=+e,t=+t,r=+r,Lj(t,e,r)[2]}function fO(t,e,r){e=+e,t=+t,r=+r;const n=e<t,a=n?uO(e,t,r):uO(t,e,r);return(n?-1:1)*(a<0?1/-a:a)}function yq(t,e){let r;for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function bq(t,e){let r;for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function gle(t,e,r=0,n=1/0,a){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(a=a===void 0?ple:Oze(a);n>r;){if(n-r>600){const c=n-r+1,d=e-r+1,u=Math.log(c),f=.5*Math.exp(2*u/3),A=.5*Math.sqrt(u*f*(c-f)/c)*(d-c/2<0?-1:1),h=Math.max(r,Math.floor(e-d*f/c+A)),m=Math.min(n,Math.floor(e+(c-d)*f/c+A));gle(t,e,h,m,a)}const s=t[e];let o=r,l=n;for(Fy(t,r,e),a(t[n],s)>0&&Fy(t,r,n);o<l;){for(Fy(t,o,l),++o,--l;a(t[o],s)<0;)++o;for(;a(t[l],s)>0;)--l}a(t[r],s)===0?Fy(t,r,l):(++l,Fy(t,l,n)),l<=e&&(r=l+1),e<=l&&(n=l-1)}return t}function Fy(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function Lze(t,e,r){if(t=Float64Array.from(Pze(t)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return bq(t);if(e>=1)return yq(t);var n,a=(n-1)*e,s=Math.floor(a),o=yq(gle(t,s).subarray(0,s+1)),l=bq(t.subarray(s+1));return o+(l-o)*(a-s)}}function Uze(t,e,r=mle){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,a=(n-1)*e,s=Math.floor(a),o=+r(t[s],s,t),l=+r(t[s+1],s+1,t);return o+(l-o)*(a-s)}}function Qze(t,e,r){t=+t,e=+e,r=(a=arguments.length)<2?(e=t,t=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((e-t)/r))|0,s=new Array(a);++n<a;)s[n]=t+n*r;return s}function qu(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function GA(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const hO=Symbol("implicit");function TM(){var t=new xq,e=[],r=[],n=hO;function a(s){let o=t.get(s);if(o===void 0){if(n!==hO)return n;t.set(s,o=e.push(s)-1)}return r[o%r.length]}return a.domain=function(s){if(!arguments.length)return e.slice();e=[],t=new xq;for(const o of s)t.has(o)||t.set(o,e.push(o)-1);return a},a.range=function(s){return arguments.length?(r=Array.from(s),a):r.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return TM(e,r).unknown(n)},qu.apply(a,arguments),a}function BM(){var t=TM().unknown(void 0),e=t.domain,r=t.range,n=0,a=1,s,o,l=!1,c=0,d=0,u=.5;delete t.unknown;function f(){var A=e().length,h=a<n,m=h?a:n,p=h?n:a;s=(p-m)/Math.max(1,A-c+d*2),l&&(s=Math.floor(s)),m+=(p-m-s*(A-c))*u,o=s*(1-c),l&&(m=Math.round(m),o=Math.round(o));var x=Qze(A).map(function(v){return m+s*v});return r(h?x.reverse():x)}return t.domain=function(A){return arguments.length?(e(A),f()):e()},t.range=function(A){return arguments.length?([n,a]=A,n=+n,a=+a,f()):[n,a]},t.rangeRound=function(A){return[n,a]=A,n=+n,a=+a,l=!0,f()},t.bandwidth=function(){return o},t.step=function(){return s},t.round=function(A){return arguments.length?(l=!!A,f()):l},t.padding=function(A){return arguments.length?(c=Math.min(1,d=+A),f()):c},t.paddingInner=function(A){return arguments.length?(c=Math.min(1,A),f()):c},t.paddingOuter=function(A){return arguments.length?(d=+A,f()):d},t.align=function(A){return arguments.length?(u=Math.max(0,Math.min(1,A)),f()):u},t.copy=function(){return BM(e(),[n,a]).round(l).paddingInner(c).paddingOuter(d).align(u)},qu.apply(f(),arguments)}function xle(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return xle(e())},t}function Vze(){return xle(BM.apply(null,arguments).paddingInner(1))}function kM(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function vle(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function oN(){}var cw=.7,Uj=1/cw,Cv="\\s*([+-]?\\d+)\\s*",dw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",dh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Hze=/^#([0-9a-f]{3,8})$/,$ze=new RegExp(`^rgb\\(${Cv},${Cv},${Cv}\\)$`),Gze=new RegExp(`^rgb\\(${dh},${dh},${dh}\\)$`),Kze=new RegExp(`^rgba\\(${Cv},${Cv},${Cv},${dw}\\)$`),qze=new RegExp(`^rgba\\(${dh},${dh},${dh},${dw}\\)$`),zze=new RegExp(`^hsl\\(${dw},${dh},${dh}\\)$`),Wze=new RegExp(`^hsla\\(${dw},${dh},${dh},${dw}\\)$`),wq={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};kM(oN,uw,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Nq,formatHex:Nq,formatHex8:Xze,formatHsl:Yze,formatRgb:Cq,toString:Cq});function Nq(){return this.rgb().formatHex()}function Xze(){return this.rgb().formatHex8()}function Yze(){return yle(this).formatHsl()}function Cq(){return this.rgb().formatRgb()}function uw(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=Hze.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?_q(e):r===3?new dd(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?B_(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?B_(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=$ze.exec(t))?new dd(e[1],e[2],e[3],1):(e=Gze.exec(t))?new dd(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Kze.exec(t))?B_(e[1],e[2],e[3],e[4]):(e=qze.exec(t))?B_(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=zze.exec(t))?jq(e[1],e[2]/100,e[3]/100,1):(e=Wze.exec(t))?jq(e[1],e[2]/100,e[3]/100,e[4]):wq.hasOwnProperty(t)?_q(wq[t]):t==="transparent"?new dd(NaN,NaN,NaN,0):null}function _q(t){return new dd(t>>16&255,t>>8&255,t&255,1)}function B_(t,e,r,n){return n<=0&&(t=e=r=NaN),new dd(t,e,r,n)}function Jze(t){return t instanceof oN||(t=uw(t)),t?(t=t.rgb(),new dd(t.r,t.g,t.b,t.opacity)):new dd}function AO(t,e,r,n){return arguments.length===1?Jze(t):new dd(t,e,r,n??1)}function dd(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}kM(dd,AO,vle(oN,{brighter(t){return t=t==null?Uj:Math.pow(Uj,t),new dd(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?cw:Math.pow(cw,t),new dd(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new dd(Jp(this.r),Jp(this.g),Jp(this.b),Qj(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Eq,formatHex:Eq,formatHex8:Zze,formatRgb:Sq,toString:Sq}));function Eq(){return`#${Op(this.r)}${Op(this.g)}${Op(this.b)}`}function Zze(){return`#${Op(this.r)}${Op(this.g)}${Op(this.b)}${Op((isNaN(this.opacity)?1:this.opacity)*255)}`}function Sq(){const t=Qj(this.opacity);return`${t===1?"rgb(":"rgba("}${Jp(this.r)}, ${Jp(this.g)}, ${Jp(this.b)}${t===1?")":`, ${t})`}`}function Qj(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Jp(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Op(t){return t=Jp(t),(t<16?"0":"")+t.toString(16)}function jq(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new gf(t,e,r,n)}function yle(t){if(t instanceof gf)return new gf(t.h,t.s,t.l,t.opacity);if(t instanceof oN||(t=uw(t)),!t)return new gf;if(t instanceof gf)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,a=Math.min(e,r,n),s=Math.max(e,r,n),o=NaN,l=s-a,c=(s+a)/2;return l?(e===s?o=(r-n)/l+(r<n)*6:r===s?o=(n-e)/l+2:o=(e-r)/l+4,l/=c<.5?s+a:2-s-a,o*=60):l=c>0&&c<1?0:o,new gf(o,l,c,t.opacity)}function eWe(t,e,r,n){return arguments.length===1?yle(t):new gf(t,e,r,n??1)}function gf(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}kM(gf,eWe,vle(oN,{brighter(t){return t=t==null?Uj:Math.pow(Uj,t),new gf(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?cw:Math.pow(cw,t),new gf(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,a=2*r-n;return new dd(TT(t>=240?t-240:t+120,a,n),TT(t,a,n),TT(t<120?t+240:t-120,a,n),this.opacity)},clamp(){return new gf(Iq(this.h),k_(this.s),k_(this.l),Qj(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Qj(this.opacity);return`${t===1?"hsl(":"hsla("}${Iq(this.h)}, ${k_(this.s)*100}%, ${k_(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Iq(t){return t=(t||0)%360,t<0?t+360:t}function k_(t){return Math.max(0,Math.min(1,t||0))}function TT(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const FM=t=>()=>t;function tWe(t,e){return function(r){return t+r*e}}function rWe(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function nWe(t){return(t=+t)==1?ble:function(e,r){return r-e?rWe(e,r,t):FM(isNaN(e)?r:e)}}function ble(t,e){var r=e-t;return r?tWe(t,r):FM(isNaN(t)?e:t)}const Pq=function t(e){var r=nWe(e);function n(a,s){var o=r((a=AO(a)).r,(s=AO(s)).r),l=r(a.g,s.g),c=r(a.b,s.b),d=ble(a.opacity,s.opacity);return function(u){return a.r=o(u),a.g=l(u),a.b=c(u),a.opacity=d(u),a+""}}return n.gamma=t,n}(1);function aWe(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),a;return function(s){for(a=0;a<r;++a)n[a]=t[a]*(1-s)+e[a]*s;return n}}function sWe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function iWe(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,a=new Array(n),s=new Array(r),o;for(o=0;o<n;++o)a[o]=B1(t[o],e[o]);for(;o<r;++o)s[o]=e[o];return function(l){for(o=0;o<n;++o)s[o]=a[o](l);return s}}function oWe(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function Vj(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function lWe(t,e){var r={},n={},a;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in t?r[a]=B1(t[a],e[a]):n[a]=e[a];return function(s){for(a in r)n[a]=r[a](s);return n}}var mO=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,BT=new RegExp(mO.source,"g");function cWe(t){return function(){return t}}function dWe(t){return function(e){return t(e)+""}}function uWe(t,e){var r=mO.lastIndex=BT.lastIndex=0,n,a,s,o=-1,l=[],c=[];for(t=t+"",e=e+"";(n=mO.exec(t))&&(a=BT.exec(e));)(s=a.index)>r&&(s=e.slice(r,s),l[o]?l[o]+=s:l[++o]=s),(n=n[0])===(a=a[0])?l[o]?l[o]+=a:l[++o]=a:(l[++o]=null,c.push({i:o,x:Vj(n,a)})),r=BT.lastIndex;return r<e.length&&(s=e.slice(r),l[o]?l[o]+=s:l[++o]=s),l.length<2?c[0]?dWe(c[0].x):cWe(e):(e=c.length,function(d){for(var u=0,f;u<e;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}function B1(t,e){var r=typeof e,n;return e==null||r==="boolean"?FM(e):(r==="number"?Vj:r==="string"?(n=uw(e))?(e=n,Pq):uWe:e instanceof uw?Pq:e instanceof Date?oWe:sWe(e)?aWe:Array.isArray(e)?iWe:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?lWe:Vj)(t,e)}function OM(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function fWe(t,e){e===void 0&&(e=t,t=B1);for(var r=0,n=e.length-1,a=e[0],s=new Array(n<0?0:n);r<n;)s[r]=t(a,a=e[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return s[l](o-l)}}function hWe(t){return function(){return t}}function Hj(t){return+t}var Tq=[0,1];function Uc(t){return t}function pO(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:hWe(isNaN(e)?NaN:.5)}function AWe(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function mWe(t,e,r){var n=t[0],a=t[1],s=e[0],o=e[1];return a<n?(n=pO(a,n),s=r(o,s)):(n=pO(n,a),s=r(s,o)),function(l){return s(n(l))}}function pWe(t,e,r){var n=Math.min(t.length,e.length)-1,a=new Array(n),s=new Array(n),o=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<n;)a[o]=pO(t[o],t[o+1]),s[o]=r(e[o],e[o+1]);return function(l){var c=iN(t,l,1,n)-1;return s[c](a[c](l))}}function lN(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function s3(){var t=Tq,e=Tq,r=B1,n,a,s,o=Uc,l,c,d;function u(){var A=Math.min(t.length,e.length);return o!==Uc&&(o=AWe(t[0],t[A-1])),l=A>2?pWe:mWe,c=d=null,f}function f(A){return A==null||isNaN(A=+A)?s:(c||(c=l(t.map(n),e,r)))(n(o(A)))}return f.invert=function(A){return o(a((d||(d=l(e,t.map(n),Vj)))(A)))},f.domain=function(A){return arguments.length?(t=Array.from(A,Hj),u()):t.slice()},f.range=function(A){return arguments.length?(e=Array.from(A),u()):e.slice()},f.rangeRound=function(A){return e=Array.from(A),r=OM,u()},f.clamp=function(A){return arguments.length?(o=A?!0:Uc,u()):o!==Uc},f.interpolate=function(A){return arguments.length?(r=A,u()):r},f.unknown=function(A){return arguments.length?(s=A,f):s},function(A,h){return n=A,a=h,u()}}function DM(){return s3()(Uc,Uc)}function gWe(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function $j(t,e){if(!isFinite(t)||t===0)return null;var r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"),n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function e1(t){return t=$j(Math.abs(t)),t?t[1]:NaN}function xWe(t,e){return function(r,n){for(var a=r.length,s=[],o=0,l=t[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),s.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=t[o=(o+1)%t.length];return s.reverse().join(e)}}function vWe(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var yWe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function fw(t){if(!(e=yWe.exec(t)))throw new Error("invalid format: "+t);var e;return new RM({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}fw.prototype=RM.prototype;function RM(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}RM.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function bWe(t){e:for(var e=t.length,r=1,n=-1,a;r<e;++r)switch(t[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(a+1):t}var Gj;function wWe(t,e){var r=$j(t,e);if(!r)return Gj=void 0,t.toPrecision(e);var n=r[0],a=r[1],s=a-(Gj=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return s===o?n:s>o?n+new Array(s-o+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+$j(t,Math.max(0,e+s-1))[0]}function Bq(t,e){var r=$j(t,e);if(!r)return t+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const kq={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:gWe,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Bq(t*100,e),r:Bq,s:wWe,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Fq(t){return t}var Oq=Array.prototype.map,Dq=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function NWe(t){var e=t.grouping===void 0||t.thousands===void 0?Fq:xWe(Oq.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",a=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?Fq:vWe(Oq.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",l=t.minus===void 0?"":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function d(f,A){f=fw(f);var h=f.fill,m=f.align,p=f.sign,x=f.symbol,v=f.zero,y=f.width,b=f.comma,w=f.precision,I=f.trim,j=f.type;j==="n"?(b=!0,j="g"):kq[j]||(w===void 0&&(w=12),I=!0,j="g"),(v||h==="0"&&m==="=")&&(v=!0,h="0",m="=");var N=(A&&A.prefix!==void 0?A.prefix:"")+(x==="$"?r:x==="#"&&/[boxX]/.test(j)?"0"+j.toLowerCase():""),S=(x==="$"?n:/[%p]/.test(j)?o:"")+(A&&A.suffix!==void 0?A.suffix:""),E=kq[j],B=/[defgprs%]/.test(j);w=w===void 0?6:/[gprs]/.test(j)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function k(T){var P=N,q=S,de,ce,le;if(j==="c")q=E(T)+q,T="";else{T=+T;var he=T<0||1/T<0;if(T=isNaN(T)?c:E(Math.abs(T),w),I&&(T=bWe(T)),he&&+T==0&&p!=="+"&&(he=!1),P=(he?p==="("?p:l:p==="-"||p==="("?"":p)+P,q=(j==="s"&&!isNaN(T)&&Gj!==void 0?Dq[8+Gj/3]:"")+q+(he&&p==="("?")":""),B){for(de=-1,ce=T.length;++de<ce;)if(le=T.charCodeAt(de),48>le||le>57){q=(le===46?a+T.slice(de+1):T.slice(de))+q,T=T.slice(0,de);break}}}b&&!v&&(T=e(T,1/0));var ae=P.length+T.length+q.length,Ce=ae<y?new Array(y-ae+1).join(h):"";switch(b&&v&&(T=e(Ce+T,Ce.length?y-q.length:1/0),Ce=""),m){case"<":T=P+T+q+Ce;break;case"=":T=P+Ce+T+q;break;case"^":T=Ce.slice(0,ae=Ce.length>>1)+P+T+q+Ce.slice(ae);break;default:T=Ce+P+T+q;break}return s(T)}return k.toString=function(){return f+""},k}function u(f,A){var h=Math.max(-8,Math.min(8,Math.floor(e1(A)/3)))*3,m=Math.pow(10,-h),p=d((f=fw(f),f.type="f",f),{suffix:Dq[8+h/3]});return function(x){return p(m*x)}}return{format:d,formatPrefix:u}}var F_,MM,wle;CWe({thousands:",",grouping:[3],currency:["$",""]});function CWe(t){return F_=NWe(t),MM=F_.format,wle=F_.formatPrefix,F_}function _We(t){return Math.max(0,-e1(Math.abs(t)))}function EWe(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(e1(e)/3)))*3-e1(Math.abs(t)))}function SWe(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,e1(e)-e1(t))+1}function Nle(t,e,r,n){var a=fO(t,e,r),s;switch(n=fw(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(s=EWe(a,o))&&(n.precision=s),wle(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=SWe(a,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=_We(a))&&(n.precision=s-(n.type==="%")*2);break}}return MM(n)}function zm(t){var e=t.domain;return t.ticks=function(r){var n=e();return dO(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var a=e();return Nle(a[0],a[a.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),a=0,s=n.length-1,o=n[a],l=n[s],c,d,u=10;for(l<o&&(d=o,o=l,l=d,d=a,a=s,s=d);u-- >0;){if(d=uO(o,l,r),d===c)return n[a]=o,n[s]=l,e(n);if(d>0)o=Math.floor(o/d)*d,l=Math.ceil(l/d)*d;else if(d<0)o=Math.ceil(o*d)/d,l=Math.floor(l*d)/d;else break;c=d}return t},t}function Cle(){var t=DM();return t.copy=function(){return lN(t,Cle())},qu.apply(t,arguments),zm(t)}function _le(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,Hj),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return _le(t).unknown(e)},t=arguments.length?Array.from(t,Hj):[0,1],zm(r)}function Ele(t,e){t=t.slice();var r=0,n=t.length-1,a=t[r],s=t[n],o;return s<a&&(o=r,r=n,n=o,o=a,a=s,s=o),t[r]=e.floor(a),t[n]=e.ceil(s),t}function Rq(t){return Math.log(t)}function Mq(t){return Math.exp(t)}function jWe(t){return-Math.log(-t)}function IWe(t){return-Math.exp(-t)}function PWe(t){return isFinite(t)?+("1e"+t):t<0?0:t}function TWe(t){return t===10?PWe:t===Math.E?Math.exp:e=>Math.pow(t,e)}function BWe(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function Lq(t){return(e,r)=>-t(-e,r)}function LM(t){const e=t(Rq,Mq),r=e.domain;let n=10,a,s;function o(){return a=BWe(n),s=TWe(n),r()[0]<0?(a=Lq(a),s=Lq(s),t(jWe,IWe)):t(Rq,Mq),e}return e.base=function(l){return arguments.length?(n=+l,o()):n},e.domain=function(l){return arguments.length?(r(l),o()):r()},e.ticks=l=>{const c=r();let d=c[0],u=c[c.length-1];const f=u<d;f&&([d,u]=[u,d]);let A=a(d),h=a(u),m,p;const x=l==null?10:+l;let v=[];if(!(n%1)&&h-A<x){if(A=Math.floor(A),h=Math.ceil(h),d>0){for(;A<=h;++A)for(m=1;m<n;++m)if(p=A<0?m/s(-A):m*s(A),!(p<d)){if(p>u)break;v.push(p)}}else for(;A<=h;++A)for(m=n-1;m>=1;--m)if(p=A>0?m/s(-A):m*s(A),!(p<d)){if(p>u)break;v.push(p)}v.length*2<x&&(v=dO(d,u,x))}else v=dO(A,h,Math.min(h-A,x)).map(s);return f?v.reverse():v},e.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=fw(c)).precision==null&&(c.trim=!0),c=MM(c)),l===1/0)return c;const d=Math.max(1,n*l/e.ticks().length);return u=>{let f=u/s(Math.round(a(u)));return f*n<n-.5&&(f*=n),f<=d?c(u):""}},e.nice=()=>r(Ele(r(),{floor:l=>s(Math.floor(a(l))),ceil:l=>s(Math.ceil(a(l)))})),e}function Sle(){const t=LM(s3()).domain([1,10]);return t.copy=()=>lN(t,Sle()).base(t.base()),qu.apply(t,arguments),t}function Uq(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Qq(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function UM(t){var e=1,r=t(Uq(e),Qq(e));return r.constant=function(n){return arguments.length?t(Uq(e=+n),Qq(e)):e},zm(r)}function jle(){var t=UM(s3());return t.copy=function(){return lN(t,jle()).constant(t.constant())},qu.apply(t,arguments)}function Vq(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function kWe(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function FWe(t){return t<0?-t*t:t*t}function QM(t){var e=t(Uc,Uc),r=1;function n(){return r===1?t(Uc,Uc):r===.5?t(kWe,FWe):t(Vq(r),Vq(1/r))}return e.exponent=function(a){return arguments.length?(r=+a,n()):r},zm(e)}function VM(){var t=QM(s3());return t.copy=function(){return lN(t,VM()).exponent(t.exponent())},qu.apply(t,arguments),t}function OWe(){return VM.apply(null,arguments).exponent(.5)}function Hq(t){return Math.sign(t)*t*t}function DWe(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function Ile(){var t=DM(),e=[0,1],r=!1,n;function a(s){var o=DWe(t(s));return isNaN(o)?n:r?Math.round(o):o}return a.invert=function(s){return t.invert(Hq(s))},a.domain=function(s){return arguments.length?(t.domain(s),a):t.domain()},a.range=function(s){return arguments.length?(t.range((e=Array.from(s,Hj)).map(Hq)),a):e.slice()},a.rangeRound=function(s){return a.range(s).round(!0)},a.round=function(s){return arguments.length?(r=!!s,a):r},a.clamp=function(s){return arguments.length?(t.clamp(s),a):t.clamp()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return Ile(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},qu.apply(a,arguments),zm(a)}function Ple(){var t=[],e=[],r=[],n;function a(){var o=0,l=Math.max(1,e.length);for(r=new Array(l-1);++o<l;)r[o-1]=Uze(t,o/l);return s}function s(o){return o==null||isNaN(o=+o)?n:e[iN(r,o)]}return s.invertExtent=function(o){var l=e.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:t[0],l<r.length?r[l]:t[t.length-1]]},s.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let l of o)l!=null&&!isNaN(l=+l)&&t.push(l);return t.sort(vm),a()},s.range=function(o){return arguments.length?(e=Array.from(o),a()):e.slice()},s.unknown=function(o){return arguments.length?(n=o,s):n},s.quantiles=function(){return r.slice()},s.copy=function(){return Ple().domain(t).range(e).unknown(n)},qu.apply(s,arguments)}function Tle(){var t=0,e=1,r=1,n=[.5],a=[0,1],s;function o(c){return c!=null&&c<=c?a[iN(n,c,0,r)]:s}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*e-(c-r)*t)/(r+1);return o}return o.domain=function(c){return arguments.length?([t,e]=c,t=+t,e=+e,l()):[t,e]},o.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},o.invertExtent=function(c){var d=a.indexOf(c);return d<0?[NaN,NaN]:d<1?[t,n[0]]:d>=r?[n[r-1],e]:[n[d-1],n[d]]},o.unknown=function(c){return arguments.length&&(s=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return Tle().domain([t,e]).range(a).unknown(s)},qu.apply(zm(o),arguments)}function Ble(){var t=[.5],e=[0,1],r,n=1;function a(s){return s!=null&&s<=s?e[iN(t,s,0,n)]:r}return a.domain=function(s){return arguments.length?(t=Array.from(s),n=Math.min(t.length,e.length-1),a):t.slice()},a.range=function(s){return arguments.length?(e=Array.from(s),n=Math.min(t.length,e.length-1),a):e.slice()},a.invertExtent=function(s){var o=e.indexOf(s);return[t[o-1],t[o]]},a.unknown=function(s){return arguments.length?(r=s,a):r},a.copy=function(){return Ble().domain(t).range(e).unknown(r)},qu.apply(a,arguments)}const kT=new Date,FT=new Date;function Xo(t,e,r,n){function a(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return a.floor=s=>(t(s=new Date(+s)),s),a.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),a.round=s=>{const o=a(s),l=a.ceil(s);return s-o<l-s?o:l},a.offset=(s,o)=>(e(s=new Date(+s),o==null?1:Math.floor(o)),s),a.range=(s,o,l)=>{const c=[];if(s=a.ceil(s),l=l==null?1:Math.floor(l),!(s<o)||!(l>0))return c;let d;do c.push(d=new Date(+s)),e(s,l),t(s);while(d<s&&s<o);return c},a.filter=s=>Xo(o=>{if(o>=o)for(;t(o),!s(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;e(o,-1),!s(o););else for(;--l>=0;)for(;e(o,1),!s(o););}),r&&(a.count=(s,o)=>(kT.setTime(+s),FT.setTime(+o),t(kT),t(FT),Math.floor(r(kT,FT))),a.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?a.filter(n?o=>n(o)%s===0:o=>a.count(0,o)%s===0):a)),a}const Kj=Xo(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Kj.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Xo(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):Kj);Kj.range;const rA=1e3,Tu=rA*60,nA=Tu*60,jA=nA*24,HM=jA*7,$q=jA*30,OT=jA*365,Dp=Xo(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*rA)},(t,e)=>(e-t)/rA,t=>t.getUTCSeconds());Dp.range;const $M=Xo(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*rA)},(t,e)=>{t.setTime(+t+e*Tu)},(t,e)=>(e-t)/Tu,t=>t.getMinutes());$M.range;const GM=Xo(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Tu)},(t,e)=>(e-t)/Tu,t=>t.getUTCMinutes());GM.range;const KM=Xo(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*rA-t.getMinutes()*Tu)},(t,e)=>{t.setTime(+t+e*nA)},(t,e)=>(e-t)/nA,t=>t.getHours());KM.range;const qM=Xo(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*nA)},(t,e)=>(e-t)/nA,t=>t.getUTCHours());qM.range;const cN=Xo(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Tu)/jA,t=>t.getDate()-1);cN.range;const i3=Xo(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/jA,t=>t.getUTCDate()-1);i3.range;const kle=Xo(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/jA,t=>Math.floor(t/jA));kle.range;function Wg(t){return Xo(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*Tu)/HM)}const o3=Wg(0),qj=Wg(1),RWe=Wg(2),MWe=Wg(3),t1=Wg(4),LWe=Wg(5),UWe=Wg(6);o3.range;qj.range;RWe.range;MWe.range;t1.range;LWe.range;UWe.range;function Xg(t){return Xo(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/HM)}const l3=Xg(0),zj=Xg(1),QWe=Xg(2),VWe=Xg(3),r1=Xg(4),HWe=Xg(5),$We=Xg(6);l3.range;zj.range;QWe.range;VWe.range;r1.range;HWe.range;$We.range;const zM=Xo(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());zM.range;const WM=Xo(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());WM.range;const IA=Xo(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());IA.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Xo(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});IA.range;const PA=Xo(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());PA.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Xo(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});PA.range;function Fle(t,e,r,n,a,s){const o=[[Dp,1,rA],[Dp,5,5*rA],[Dp,15,15*rA],[Dp,30,30*rA],[s,1,Tu],[s,5,5*Tu],[s,15,15*Tu],[s,30,30*Tu],[a,1,nA],[a,3,3*nA],[a,6,6*nA],[a,12,12*nA],[n,1,jA],[n,2,2*jA],[r,1,HM],[e,1,$q],[e,3,3*$q],[t,1,OT]];function l(d,u,f){const A=u<d;A&&([d,u]=[u,d]);const h=f&&typeof f.range=="function"?f:c(d,u,f),m=h?h.range(d,+u+1):[];return A?m.reverse():m}function c(d,u,f){const A=Math.abs(u-d)/f,h=PM(([,,x])=>x).right(o,A);if(h===o.length)return t.every(fO(d/OT,u/OT,f));if(h===0)return Kj.every(Math.max(fO(d,u,f),1));const[m,p]=o[A/o[h-1][2]<o[h][2]/A?h-1:h];return m.every(p)}return[l,c]}const[GWe,KWe]=Fle(PA,WM,l3,kle,qM,GM),[qWe,zWe]=Fle(IA,zM,o3,cN,KM,$M);function DT(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function RT(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Oy(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function WWe(t){var e=t.dateTime,r=t.date,n=t.time,a=t.periods,s=t.days,o=t.shortDays,l=t.months,c=t.shortMonths,d=Dy(a),u=Ry(a),f=Dy(s),A=Ry(s),h=Dy(o),m=Ry(o),p=Dy(l),x=Ry(l),v=Dy(c),y=Ry(c),b={a:le,A:he,b:ae,B:Ce,c:null,d:Xq,e:Xq,f:xXe,g:jXe,G:PXe,H:mXe,I:pXe,j:gXe,L:Ole,m:vXe,M:yXe,p:De,q:O,Q:Zq,s:ez,S:bXe,u:wXe,U:NXe,V:CXe,w:_Xe,W:EXe,x:null,X:null,y:SXe,Y:IXe,Z:TXe,"%":Jq},w={a:R,A:G,b:M,B:K,c:null,d:Yq,e:Yq,f:OXe,g:GXe,G:qXe,H:BXe,I:kXe,j:FXe,L:Rle,m:DXe,M:RXe,p:Y,q:D,Q:Zq,s:ez,S:MXe,u:LXe,U:UXe,V:QXe,w:VXe,W:HXe,x:null,X:null,y:$Xe,Y:KXe,Z:zXe,"%":Jq},I={a:B,A:k,b:T,B:P,c:q,d:zq,e:zq,f:uXe,g:qq,G:Kq,H:Wq,I:Wq,j:oXe,L:dXe,m:iXe,M:lXe,p:E,q:sXe,Q:hXe,s:AXe,S:cXe,u:eXe,U:tXe,V:rXe,w:ZWe,W:nXe,x:de,X:ce,y:qq,Y:Kq,Z:aXe,"%":fXe};b.x=j(r,b),b.X=j(n,b),b.c=j(e,b),w.x=j(r,w),w.X=j(n,w),w.c=j(e,w);function j(V,te){return function(ve){var Q=[],Xe=-1,se=0,Z=V.length,ke,Se,Ee;for(ve instanceof Date||(ve=new Date(+ve));++Xe<Z;)V.charCodeAt(Xe)===37&&(Q.push(V.slice(se,Xe)),(Se=Gq[ke=V.charAt(++Xe)])!=null?ke=V.charAt(++Xe):Se=ke==="e"?" ":"0",(Ee=te[ke])&&(ke=Ee(ve,Se)),Q.push(ke),se=Xe+1);return Q.push(V.slice(se,Xe)),Q.join("")}}function N(V,te){return function(ve){var Q=Oy(1900,void 0,1),Xe=S(Q,V,ve+="",0),se,Z;if(Xe!=ve.length)return null;if("Q"in Q)return new Date(Q.Q);if("s"in Q)return new Date(Q.s*1e3+("L"in Q?Q.L:0));if(te&&!("Z"in Q)&&(Q.Z=0),"p"in Q&&(Q.H=Q.H%12+Q.p*12),Q.m===void 0&&(Q.m="q"in Q?Q.q:0),"V"in Q){if(Q.V<1||Q.V>53)return null;"w"in Q||(Q.w=1),"Z"in Q?(se=RT(Oy(Q.y,0,1)),Z=se.getUTCDay(),se=Z>4||Z===0?zj.ceil(se):zj(se),se=i3.offset(se,(Q.V-1)*7),Q.y=se.getUTCFullYear(),Q.m=se.getUTCMonth(),Q.d=se.getUTCDate()+(Q.w+6)%7):(se=DT(Oy(Q.y,0,1)),Z=se.getDay(),se=Z>4||Z===0?qj.ceil(se):qj(se),se=cN.offset(se,(Q.V-1)*7),Q.y=se.getFullYear(),Q.m=se.getMonth(),Q.d=se.getDate()+(Q.w+6)%7)}else("W"in Q||"U"in Q)&&("w"in Q||(Q.w="u"in Q?Q.u%7:"W"in Q?1:0),Z="Z"in Q?RT(Oy(Q.y,0,1)).getUTCDay():DT(Oy(Q.y,0,1)).getDay(),Q.m=0,Q.d="W"in Q?(Q.w+6)%7+Q.W*7-(Z+5)%7:Q.w+Q.U*7-(Z+6)%7);return"Z"in Q?(Q.H+=Q.Z/100|0,Q.M+=Q.Z%100,RT(Q)):DT(Q)}}function S(V,te,ve,Q){for(var Xe=0,se=te.length,Z=ve.length,ke,Se;Xe<se;){if(Q>=Z)return-1;if(ke=te.charCodeAt(Xe++),ke===37){if(ke=te.charAt(Xe++),Se=I[ke in Gq?te.charAt(Xe++):ke],!Se||(Q=Se(V,ve,Q))<0)return-1}else if(ke!=ve.charCodeAt(Q++))return-1}return Q}function E(V,te,ve){var Q=d.exec(te.slice(ve));return Q?(V.p=u.get(Q[0].toLowerCase()),ve+Q[0].length):-1}function B(V,te,ve){var Q=h.exec(te.slice(ve));return Q?(V.w=m.get(Q[0].toLowerCase()),ve+Q[0].length):-1}function k(V,te,ve){var Q=f.exec(te.slice(ve));return Q?(V.w=A.get(Q[0].toLowerCase()),ve+Q[0].length):-1}function T(V,te,ve){var Q=v.exec(te.slice(ve));return Q?(V.m=y.get(Q[0].toLowerCase()),ve+Q[0].length):-1}function P(V,te,ve){var Q=p.exec(te.slice(ve));return Q?(V.m=x.get(Q[0].toLowerCase()),ve+Q[0].length):-1}function q(V,te,ve){return S(V,e,te,ve)}function de(V,te,ve){return S(V,r,te,ve)}function ce(V,te,ve){return S(V,n,te,ve)}function le(V){return o[V.getDay()]}function he(V){return s[V.getDay()]}function ae(V){return c[V.getMonth()]}function Ce(V){return l[V.getMonth()]}function De(V){return a[+(V.getHours()>=12)]}function O(V){return 1+~~(V.getMonth()/3)}function R(V){return o[V.getUTCDay()]}function G(V){return s[V.getUTCDay()]}function M(V){return c[V.getUTCMonth()]}function K(V){return l[V.getUTCMonth()]}function Y(V){return a[+(V.getUTCHours()>=12)]}function D(V){return 1+~~(V.getUTCMonth()/3)}return{format:function(V){var te=j(V+="",b);return te.toString=function(){return V},te},parse:function(V){var te=N(V+="",!1);return te.toString=function(){return V},te},utcFormat:function(V){var te=j(V+="",w);return te.toString=function(){return V},te},utcParse:function(V){var te=N(V+="",!0);return te.toString=function(){return V},te}}}var Gq={"-":"",_:" ",0:"0"},yl=/^\s*\d+/,XWe=/^%/,YWe=/[\\^$*+?|[\]().{}]/g;function qa(t,e,r){var n=t<0?"-":"",a=(n?-t:t)+"",s=a.length;return n+(s<r?new Array(r-s+1).join(e)+a:a)}function JWe(t){return t.replace(YWe,"\\$&")}function Dy(t){return new RegExp("^(?:"+t.map(JWe).join("|")+")","i")}function Ry(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function ZWe(t,e,r){var n=yl.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function eXe(t,e,r){var n=yl.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function tXe(t,e,r){var n=yl.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function rXe(t,e,r){var n=yl.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function nXe(t,e,r){var n=yl.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function Kq(t,e,r){var n=yl.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function qq(t,e,r){var n=yl.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function aXe(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function sXe(t,e,r){var n=yl.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function iXe(t,e,r){var n=yl.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function zq(t,e,r){var n=yl.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function oXe(t,e,r){var n=yl.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function Wq(t,e,r){var n=yl.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function lXe(t,e,r){var n=yl.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function cXe(t,e,r){var n=yl.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function dXe(t,e,r){var n=yl.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function uXe(t,e,r){var n=yl.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function fXe(t,e,r){var n=XWe.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function hXe(t,e,r){var n=yl.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function AXe(t,e,r){var n=yl.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function Xq(t,e){return qa(t.getDate(),e,2)}function mXe(t,e){return qa(t.getHours(),e,2)}function pXe(t,e){return qa(t.getHours()%12||12,e,2)}function gXe(t,e){return qa(1+cN.count(IA(t),t),e,3)}function Ole(t,e){return qa(t.getMilliseconds(),e,3)}function xXe(t,e){return Ole(t,e)+"000"}function vXe(t,e){return qa(t.getMonth()+1,e,2)}function yXe(t,e){return qa(t.getMinutes(),e,2)}function bXe(t,e){return qa(t.getSeconds(),e,2)}function wXe(t){var e=t.getDay();return e===0?7:e}function NXe(t,e){return qa(o3.count(IA(t)-1,t),e,2)}function Dle(t){var e=t.getDay();return e>=4||e===0?t1(t):t1.ceil(t)}function CXe(t,e){return t=Dle(t),qa(t1.count(IA(t),t)+(IA(t).getDay()===4),e,2)}function _Xe(t){return t.getDay()}function EXe(t,e){return qa(qj.count(IA(t)-1,t),e,2)}function SXe(t,e){return qa(t.getFullYear()%100,e,2)}function jXe(t,e){return t=Dle(t),qa(t.getFullYear()%100,e,2)}function IXe(t,e){return qa(t.getFullYear()%1e4,e,4)}function PXe(t,e){var r=t.getDay();return t=r>=4||r===0?t1(t):t1.ceil(t),qa(t.getFullYear()%1e4,e,4)}function TXe(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+qa(e/60|0,"0",2)+qa(e%60,"0",2)}function Yq(t,e){return qa(t.getUTCDate(),e,2)}function BXe(t,e){return qa(t.getUTCHours(),e,2)}function kXe(t,e){return qa(t.getUTCHours()%12||12,e,2)}function FXe(t,e){return qa(1+i3.count(PA(t),t),e,3)}function Rle(t,e){return qa(t.getUTCMilliseconds(),e,3)}function OXe(t,e){return Rle(t,e)+"000"}function DXe(t,e){return qa(t.getUTCMonth()+1,e,2)}function RXe(t,e){return qa(t.getUTCMinutes(),e,2)}function MXe(t,e){return qa(t.getUTCSeconds(),e,2)}function LXe(t){var e=t.getUTCDay();return e===0?7:e}function UXe(t,e){return qa(l3.count(PA(t)-1,t),e,2)}function Mle(t){var e=t.getUTCDay();return e>=4||e===0?r1(t):r1.ceil(t)}function QXe(t,e){return t=Mle(t),qa(r1.count(PA(t),t)+(PA(t).getUTCDay()===4),e,2)}function VXe(t){return t.getUTCDay()}function HXe(t,e){return qa(zj.count(PA(t)-1,t),e,2)}function $Xe(t,e){return qa(t.getUTCFullYear()%100,e,2)}function GXe(t,e){return t=Mle(t),qa(t.getUTCFullYear()%100,e,2)}function KXe(t,e){return qa(t.getUTCFullYear()%1e4,e,4)}function qXe(t,e){var r=t.getUTCDay();return t=r>=4||r===0?r1(t):r1.ceil(t),qa(t.getUTCFullYear()%1e4,e,4)}function zXe(){return"+0000"}function Jq(){return"%"}function Zq(t){return+t}function ez(t){return Math.floor(+t/1e3)}var Cx,Lle,Ule;WXe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function WXe(t){return Cx=WWe(t),Lle=Cx.format,Cx.parse,Ule=Cx.utcFormat,Cx.utcParse,Cx}function XXe(t){return new Date(t)}function YXe(t){return t instanceof Date?+t:+new Date(+t)}function XM(t,e,r,n,a,s,o,l,c,d){var u=DM(),f=u.invert,A=u.domain,h=d(".%L"),m=d(":%S"),p=d("%I:%M"),x=d("%I %p"),v=d("%a %d"),y=d("%b %d"),b=d("%B"),w=d("%Y");function I(j){return(c(j)<j?h:l(j)<j?m:o(j)<j?p:s(j)<j?x:n(j)<j?a(j)<j?v:y:r(j)<j?b:w)(j)}return u.invert=function(j){return new Date(f(j))},u.domain=function(j){return arguments.length?A(Array.from(j,YXe)):A().map(XXe)},u.ticks=function(j){var N=A();return t(N[0],N[N.length-1],j??10)},u.tickFormat=function(j,N){return N==null?I:d(N)},u.nice=function(j){var N=A();return(!j||typeof j.range!="function")&&(j=e(N[0],N[N.length-1],j??10)),j?A(Ele(N,j)):u},u.copy=function(){return lN(u,XM(t,e,r,n,a,s,o,l,c,d))},u}function JXe(){return qu.apply(XM(qWe,zWe,IA,zM,o3,cN,KM,$M,Dp,Lle).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function ZXe(){return qu.apply(XM(GWe,KWe,PA,WM,l3,i3,qM,GM,Dp,Ule).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function c3(){var t=0,e=1,r,n,a,s,o=Uc,l=!1,c;function d(f){return f==null||isNaN(f=+f)?c:o(a===0?.5:(f=(s(f)-r)*a,l?Math.max(0,Math.min(1,f)):f))}d.domain=function(f){return arguments.length?([t,e]=f,r=s(t=+t),n=s(e=+e),a=r===n?0:1/(n-r),d):[t,e]},d.clamp=function(f){return arguments.length?(l=!!f,d):l},d.interpolator=function(f){return arguments.length?(o=f,d):o};function u(f){return function(A){var h,m;return arguments.length?([h,m]=A,o=f(h,m),d):[o(0),o(1)]}}return d.range=u(B1),d.rangeRound=u(OM),d.unknown=function(f){return arguments.length?(c=f,d):c},function(f){return s=f,r=f(t),n=f(e),a=r===n?0:1/(n-r),d}}function Wm(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Qle(){var t=zm(c3()(Uc));return t.copy=function(){return Wm(t,Qle())},GA.apply(t,arguments)}function Vle(){var t=LM(c3()).domain([1,10]);return t.copy=function(){return Wm(t,Vle()).base(t.base())},GA.apply(t,arguments)}function Hle(){var t=UM(c3());return t.copy=function(){return Wm(t,Hle()).constant(t.constant())},GA.apply(t,arguments)}function YM(){var t=QM(c3());return t.copy=function(){return Wm(t,YM()).exponent(t.exponent())},GA.apply(t,arguments)}function eYe(){return YM.apply(null,arguments).exponent(.5)}function $le(){var t=[],e=Uc;function r(n){if(n!=null&&!isNaN(n=+n))return e((iN(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let a of n)a!=null&&!isNaN(a=+a)&&t.push(a);return t.sort(vm),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,a)=>e(a/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,s)=>Lze(t,s/n))},r.copy=function(){return $le(e).domain(t)},GA.apply(r,arguments)}function d3(){var t=0,e=.5,r=1,n=1,a,s,o,l,c,d=Uc,u,f=!1,A;function h(p){return isNaN(p=+p)?A:(p=.5+((p=+u(p))-s)*(n*p<n*s?l:c),d(f?Math.max(0,Math.min(1,p)):p))}h.domain=function(p){return arguments.length?([t,e,r]=p,a=u(t=+t),s=u(e=+e),o=u(r=+r),l=a===s?0:.5/(s-a),c=s===o?0:.5/(o-s),n=s<a?-1:1,h):[t,e,r]},h.clamp=function(p){return arguments.length?(f=!!p,h):f},h.interpolator=function(p){return arguments.length?(d=p,h):d};function m(p){return function(x){var v,y,b;return arguments.length?([v,y,b]=x,d=fWe(p,[v,y,b]),h):[d(0),d(.5),d(1)]}}return h.range=m(B1),h.rangeRound=m(OM),h.unknown=function(p){return arguments.length?(A=p,h):A},function(p){return u=p,a=p(t),s=p(e),o=p(r),l=a===s?0:.5/(s-a),c=s===o?0:.5/(o-s),n=s<a?-1:1,h}}function Gle(){var t=zm(d3()(Uc));return t.copy=function(){return Wm(t,Gle())},GA.apply(t,arguments)}function Kle(){var t=LM(d3()).domain([.1,1,10]);return t.copy=function(){return Wm(t,Kle()).base(t.base())},GA.apply(t,arguments)}function qle(){var t=UM(d3());return t.copy=function(){return Wm(t,qle()).constant(t.constant())},GA.apply(t,arguments)}function JM(){var t=QM(d3());return t.copy=function(){return Wm(t,JM()).exponent(t.exponent())},GA.apply(t,arguments)}function tYe(){return JM.apply(null,arguments).exponent(.5)}const db=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:BM,scaleDiverging:Gle,scaleDivergingLog:Kle,scaleDivergingPow:JM,scaleDivergingSqrt:tYe,scaleDivergingSymlog:qle,scaleIdentity:_le,scaleImplicit:hO,scaleLinear:Cle,scaleLog:Sle,scaleOrdinal:TM,scalePoint:Vze,scalePow:VM,scaleQuantile:Ple,scaleQuantize:Tle,scaleRadial:Ile,scaleSequential:Qle,scaleSequentialLog:Vle,scaleSequentialPow:YM,scaleSequentialQuantile:$le,scaleSequentialSqrt:eYe,scaleSequentialSymlog:Hle,scaleSqrt:OWe,scaleSymlog:jle,scaleThreshold:Ble,scaleTime:JXe,scaleUtc:ZXe,tickFormat:Nle},Symbol.toStringTag,{value:"Module"}));var KA=t=>t.chartData,u3=Zt([KA],t=>{var e=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:e,dataStartIndex:0}}),zle=(t,e,r,n)=>n?u3(t):KA(t),rYe=(t,e,r)=>r?u3(t):KA(t);function Dm(t){if(Array.isArray(t)&&t.length===2){var[e,r]=t;if(Ti(e)&&Ti(r))return!0}return!1}function tz(t,e,r){return r?t:[Math.min(t[0],e[0]),Math.max(t[1],e[1])]}function Wle(t,e){if(e&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[r,n]=t,a,s;if(Ti(r))a=r;else if(typeof r=="function")return;if(Ti(n))s=n;else if(typeof n=="function")return;var o=[a,s];if(Dm(o))return o}}function nYe(t,e,r){if(!(!r&&e==null)){if(typeof t=="function"&&e!=null)try{var n=t(e,r);if(Dm(n))return tz(n,e,r)}catch{}if(Array.isArray(t)&&t.length===2){var[a,s]=t,o,l;if(a==="auto")e!=null&&(o=Math.min(...e));else if(On(a))o=a;else if(typeof a=="function")try{e!=null&&(o=a(e==null?void 0:e[0]))}catch{}else if(typeof a=="string"&&xK.test(a)){var c=xK.exec(a);if(c==null||c[1]==null||e==null)o=void 0;else{var d=+c[1];o=e[0]-d}}else o=e==null?void 0:e[0];if(s==="auto")e!=null&&(l=Math.max(...e));else if(On(s))l=s;else if(typeof s=="function")try{e!=null&&(l=s(e==null?void 0:e[1]))}catch{}else if(typeof s=="string"&&vK.test(s)){var u=vK.exec(s);if(u==null||u[1]==null||e==null)l=void 0;else{var f=+u[1];l=e[1]+f}}else l=e==null?void 0:e[1];var A=[o,l];if(Dm(A))return e==null?A:tz(A,e,r)}}}var k1=1e9,aYe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},e8,hi=!0,Hu="[DecimalError] ",Zp=Hu+"Invalid argument: ",ZM=Hu+"Exponent out of range: ",F1=Math.floor,vp=Math.pow,sYe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Md,dl=1e7,zs=7,Xle=9007199254740991,Wj=F1(Xle/zs),gn={};gn.absoluteValue=gn.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};gn.comparedTo=gn.cmp=function(t){var e,r,n,a,s=this;if(t=new s.constructor(t),s.s!==t.s)return s.s||-t.s;if(s.e!==t.e)return s.e>t.e^s.s<0?1:-1;for(n=s.d.length,a=t.d.length,e=0,r=n<a?n:a;e<r;++e)if(s.d[e]!==t.d[e])return s.d[e]>t.d[e]^s.s<0?1:-1;return n===a?0:n>a^s.s<0?1:-1};gn.decimalPlaces=gn.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*zs;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};gn.dividedBy=gn.div=function(t){return AA(this,new this.constructor(t))};gn.dividedToIntegerBy=gn.idiv=function(t){var e=this,r=e.constructor;return Ts(AA(e,new r(t),0,1),r.precision)};gn.equals=gn.eq=function(t){return!this.cmp(t)};gn.exponent=function(){return Co(this)};gn.greaterThan=gn.gt=function(t){return this.cmp(t)>0};gn.greaterThanOrEqualTo=gn.gte=function(t){return this.cmp(t)>=0};gn.isInteger=gn.isint=function(){return this.e>this.d.length-2};gn.isNegative=gn.isneg=function(){return this.s<0};gn.isPositive=gn.ispos=function(){return this.s>0};gn.isZero=function(){return this.s===0};gn.lessThan=gn.lt=function(t){return this.cmp(t)<0};gn.lessThanOrEqualTo=gn.lte=function(t){return this.cmp(t)<1};gn.logarithm=gn.log=function(t){var e,r=this,n=r.constructor,a=n.precision,s=a+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(Md))throw Error(Hu+"NaN");if(r.s<1)throw Error(Hu+(r.s?"NaN":"-Infinity"));return r.eq(Md)?new n(0):(hi=!1,e=AA(hw(r,s),hw(t,s),s),hi=!0,Ts(e,a))};gn.minus=gn.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?Zle(e,t):Yle(e,(t.s=-t.s,t))};gn.modulo=gn.mod=function(t){var e,r=this,n=r.constructor,a=n.precision;if(t=new n(t),!t.s)throw Error(Hu+"NaN");return r.s?(hi=!1,e=AA(r,t,0,1).times(t),hi=!0,r.minus(e)):Ts(new n(r),a)};gn.naturalExponential=gn.exp=function(){return Jle(this)};gn.naturalLogarithm=gn.ln=function(){return hw(this)};gn.negated=gn.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};gn.plus=gn.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?Yle(e,t):Zle(e,(t.s=-t.s,t))};gn.precision=gn.sd=function(t){var e,r,n,a=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Zp+t);if(e=Co(a)+1,n=a.d.length-1,r=n*zs+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};gn.squareRoot=gn.sqrt=function(){var t,e,r,n,a,s,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(Hu+"NaN")}for(t=Co(l),hi=!1,a=Math.sqrt(+l),a==0||a==1/0?(e=sh(l.d),(e.length+t)%2==0&&(e+="0"),a=Math.sqrt(e),t=F1((t+1)/2)-(t<0||t%2),a==1/0?e="5e"+t:(e=a.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new c(e)):n=new c(a.toString()),r=c.precision,a=o=r+3;;)if(s=n,n=s.plus(AA(l,s,o+2)).times(.5),sh(s.d).slice(0,o)===(e=sh(n.d)).slice(0,o)){if(e=e.slice(o-3,o+1),a==o&&e=="4999"){if(Ts(s,r+1,0),s.times(s).eq(l)){n=s;break}}else if(e!="9999")break;o+=4}return hi=!0,Ts(n,r)};gn.times=gn.mul=function(t){var e,r,n,a,s,o,l,c,d,u=this,f=u.constructor,A=u.d,h=(t=new f(t)).d;if(!u.s||!t.s)return new f(0);for(t.s*=u.s,r=u.e+t.e,c=A.length,d=h.length,c<d&&(s=A,A=h,h=s,o=c,c=d,d=o),s=[],o=c+d,n=o;n--;)s.push(0);for(n=d;--n>=0;){for(e=0,a=c+n;a>n;)l=s[a]+h[n]*A[a-n-1]+e,s[a--]=l%dl|0,e=l/dl|0;s[a]=(s[a]+e)%dl|0}for(;!s[--o];)s.pop();return e?++r:s.shift(),t.d=s,t.e=r,hi?Ts(t,f.precision):t};gn.toDecimalPlaces=gn.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:(ph(t,0,k1),e===void 0?e=n.rounding:ph(e,0,8),Ts(r,t+Co(r)+1,e))};gn.toExponential=function(t,e){var r,n=this,a=n.constructor;return t===void 0?r=Ig(n,!0):(ph(t,0,k1),e===void 0?e=a.rounding:ph(e,0,8),n=Ts(new a(n),t+1,e),r=Ig(n,!0,t+1)),r};gn.toFixed=function(t,e){var r,n,a=this,s=a.constructor;return t===void 0?Ig(a):(ph(t,0,k1),e===void 0?e=s.rounding:ph(e,0,8),n=Ts(new s(a),t+Co(a)+1,e),r=Ig(n.abs(),!1,t+Co(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};gn.toInteger=gn.toint=function(){var t=this,e=t.constructor;return Ts(new e(t),Co(t)+1,e.rounding)};gn.toNumber=function(){return+this};gn.toPower=gn.pow=function(t){var e,r,n,a,s,o,l=this,c=l.constructor,d=12,u=+(t=new c(t));if(!t.s)return new c(Md);if(l=new c(l),!l.s){if(t.s<1)throw Error(Hu+"Infinity");return l}if(l.eq(Md))return l;if(n=c.precision,t.eq(Md))return Ts(l,n);if(e=t.e,r=t.d.length-1,o=e>=r,s=l.s,o){if((r=u<0?-u:u)<=Xle){for(a=new c(Md),e=Math.ceil(n/zs+4),hi=!1;r%2&&(a=a.times(l),nz(a.d,e)),r=F1(r/2),r!==0;)l=l.times(l),nz(l.d,e);return hi=!0,t.s<0?new c(Md).div(a):Ts(a,n)}}else if(s<0)throw Error(Hu+"NaN");return s=s<0&&t.d[Math.max(e,r)]&1?-1:1,l.s=1,hi=!1,a=t.times(hw(l,n+d)),hi=!0,a=Jle(a),a.s=s,a};gn.toPrecision=function(t,e){var r,n,a=this,s=a.constructor;return t===void 0?(r=Co(a),n=Ig(a,r<=s.toExpNeg||r>=s.toExpPos)):(ph(t,1,k1),e===void 0?e=s.rounding:ph(e,0,8),a=Ts(new s(a),t,e),r=Co(a),n=Ig(a,t<=r||r<=s.toExpNeg,t)),n};gn.toSignificantDigits=gn.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):(ph(t,1,k1),e===void 0?e=n.rounding:ph(e,0,8)),Ts(new n(r),t,e)};gn.toString=gn.valueOf=gn.val=gn.toJSON=gn[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=Co(t),r=t.constructor;return Ig(t,e<=r.toExpNeg||e>=r.toExpPos)};function Yle(t,e){var r,n,a,s,o,l,c,d,u=t.constructor,f=u.precision;if(!t.s||!e.s)return e.s||(e=new u(t)),hi?Ts(e,f):e;if(c=t.d,d=e.d,o=t.e,a=e.e,c=c.slice(),s=o-a,s){for(s<0?(n=c,s=-s,l=d.length):(n=d,a=o,l=c.length),o=Math.ceil(f/zs),l=o>l?o+1:l+1,s>l&&(s=l,n.length=1),n.reverse();s--;)n.push(0);n.reverse()}for(l=c.length,s=d.length,l-s<0&&(s=l,n=d,d=c,c=n),r=0;s;)r=(c[--s]=c[s]+d[s]+r)/dl|0,c[s]%=dl;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return e.d=c,e.e=a,hi?Ts(e,f):e}function ph(t,e,r){if(t!==~~t||t<e||t>r)throw Error(Zp+t)}function sh(t){var e,r,n,a=t.length-1,s="",o=t[0];if(a>0){for(s+=o,e=1;e<a;e++)n=t[e]+"",r=zs-n.length,r&&(s+=k0(r)),s+=n;o=t[e],n=o+"",r=zs-n.length,r&&(s+=k0(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var AA=function(){function t(n,a){var s,o=0,l=n.length;for(n=n.slice();l--;)s=n[l]*a+o,n[l]=s%dl|0,o=s/dl|0;return o&&n.unshift(o),n}function e(n,a,s,o){var l,c;if(s!=o)c=s>o?1:-1;else for(l=c=0;l<s;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,s){for(var o=0;s--;)n[s]-=o,o=n[s]<a[s]?1:0,n[s]=o*dl+n[s]-a[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,s,o){var l,c,d,u,f,A,h,m,p,x,v,y,b,w,I,j,N,S,E=n.constructor,B=n.s==a.s?1:-1,k=n.d,T=a.d;if(!n.s)return new E(n);if(!a.s)throw Error(Hu+"Division by zero");for(c=n.e-a.e,N=T.length,I=k.length,h=new E(B),m=h.d=[],d=0;T[d]==(k[d]||0);)++d;if(T[d]>(k[d]||0)&&--c,s==null?y=s=E.precision:o?y=s+(Co(n)-Co(a))+1:y=s,y<0)return new E(0);if(y=y/zs+2|0,d=0,N==1)for(u=0,T=T[0],y++;(d<I||u)&&y--;d++)b=u*dl+(k[d]||0),m[d]=b/T|0,u=b%T|0;else{for(u=dl/(T[0]+1)|0,u>1&&(T=t(T,u),k=t(k,u),N=T.length,I=k.length),w=N,p=k.slice(0,N),x=p.length;x<N;)p[x++]=0;S=T.slice(),S.unshift(0),j=T[0],T[1]>=dl/2&&++j;do u=0,l=e(T,p,N,x),l<0?(v=p[0],N!=x&&(v=v*dl+(p[1]||0)),u=v/j|0,u>1?(u>=dl&&(u=dl-1),f=t(T,u),A=f.length,x=p.length,l=e(f,p,A,x),l==1&&(u--,r(f,N<A?S:T,A))):(u==0&&(l=u=1),f=T.slice()),A=f.length,A<x&&f.unshift(0),r(p,f,x),l==-1&&(x=p.length,l=e(T,p,N,x),l<1&&(u++,r(p,N<x?S:T,x))),x=p.length):l===0&&(u++,p=[0]),m[d++]=u,l&&p[0]?p[x++]=k[w]||0:(p=[k[w]],x=1);while((w++<I||p[0]!==void 0)&&y--)}return m[0]||m.shift(),h.e=c,Ts(h,o?s+Co(h)+1:s)}}();function Jle(t,e){var r,n,a,s,o,l,c=0,d=0,u=t.constructor,f=u.precision;if(Co(t)>16)throw Error(ZM+Co(t));if(!t.s)return new u(Md);for(hi=!1,l=f,o=new u(.03125);t.abs().gte(.1);)t=t.times(o),d+=5;for(n=Math.log(vp(2,d))/Math.LN10*2+5|0,l+=n,r=a=s=new u(Md),u.precision=l;;){if(a=Ts(a.times(t),l),r=r.times(++c),o=s.plus(AA(a,r,l)),sh(o.d).slice(0,l)===sh(s.d).slice(0,l)){for(;d--;)s=Ts(s.times(s),l);return u.precision=f,e==null?(hi=!0,Ts(s,f)):s}s=o}}function Co(t){for(var e=t.e*zs,r=t.d[0];r>=10;r/=10)e++;return e}function MT(t,e,r){if(e>t.LN10.sd())throw hi=!0,r&&(t.precision=r),Error(Hu+"LN10 precision limit exceeded");return Ts(new t(t.LN10),e)}function k0(t){for(var e="";t--;)e+="0";return e}function hw(t,e){var r,n,a,s,o,l,c,d,u,f=1,A=10,h=t,m=h.d,p=h.constructor,x=p.precision;if(h.s<1)throw Error(Hu+(h.s?"NaN":"-Infinity"));if(h.eq(Md))return new p(0);if(e==null?(hi=!1,d=x):d=e,h.eq(10))return e==null&&(hi=!0),MT(p,d);if(d+=A,p.precision=d,r=sh(m),n=r.charAt(0),s=Co(h),Math.abs(s)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)h=h.times(t),r=sh(h.d),n=r.charAt(0),f++;s=Co(h),n>1?(h=new p("0."+r),s++):h=new p(n+"."+r.slice(1))}else return c=MT(p,d+2,x).times(s+""),h=hw(new p(n+"."+r.slice(1)),d-A).plus(c),p.precision=x,e==null?(hi=!0,Ts(h,x)):h;for(l=o=h=AA(h.minus(Md),h.plus(Md),d),u=Ts(h.times(h),d),a=3;;){if(o=Ts(o.times(u),d),c=l.plus(AA(o,new p(a),d)),sh(c.d).slice(0,d)===sh(l.d).slice(0,d))return l=l.times(2),s!==0&&(l=l.plus(MT(p,d+2,x).times(s+""))),l=AA(l,new p(f),d),p.precision=x,e==null?(hi=!0,Ts(l,x)):l;l=c,a+=2}}function rz(t,e){var r,n,a;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(a=e.length;e.charCodeAt(a-1)===48;)--a;if(e=e.slice(n,a),e){if(a-=n,r=r-n-1,t.e=F1(r/zs),t.d=[],n=(r+1)%zs,r<0&&(n+=zs),n<a){for(n&&t.d.push(+e.slice(0,n)),a-=zs;n<a;)t.d.push(+e.slice(n,n+=zs));e=e.slice(n),n=zs-e.length}else n-=a;for(;n--;)e+="0";if(t.d.push(+e),hi&&(t.e>Wj||t.e<-Wj))throw Error(ZM+r)}else t.s=0,t.e=0,t.d=[0];return t}function Ts(t,e,r){var n,a,s,o,l,c,d,u,f=t.d;for(o=1,s=f[0];s>=10;s/=10)o++;if(n=e-o,n<0)n+=zs,a=e,d=f[u=0];else{if(u=Math.ceil((n+1)/zs),s=f.length,u>=s)return t;for(d=s=f[u],o=1;s>=10;s/=10)o++;n%=zs,a=n-zs+o}if(r!==void 0&&(s=vp(10,o-a-1),l=d/s%10|0,c=e<0||f[u+1]!==void 0||d%s,c=r<4?(l||c)&&(r==0||r==(t.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?d/vp(10,o-a):0:f[u-1])%10&1||r==(t.s<0?8:7))),e<1||!f[0])return c?(s=Co(t),f.length=1,e=e-s-1,f[0]=vp(10,(zs-e%zs)%zs),t.e=F1(-e/zs)||0):(f.length=1,f[0]=t.e=t.s=0),t;if(n==0?(f.length=u,s=1,u--):(f.length=u+1,s=vp(10,zs-n),f[u]=a>0?(d/vp(10,o-a)%vp(10,a)|0)*s:0),c)for(;;)if(u==0){(f[0]+=s)==dl&&(f[0]=1,++t.e);break}else{if(f[u]+=s,f[u]!=dl)break;f[u--]=0,s=1}for(n=f.length;f[--n]===0;)f.pop();if(hi&&(t.e>Wj||t.e<-Wj))throw Error(ZM+Co(t));return t}function Zle(t,e){var r,n,a,s,o,l,c,d,u,f,A=t.constructor,h=A.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new A(t),hi?Ts(e,h):e;if(c=t.d,f=e.d,n=e.e,d=t.e,c=c.slice(),o=d-n,o){for(u=o<0,u?(r=c,o=-o,l=f.length):(r=f,n=d,l=c.length),a=Math.max(Math.ceil(h/zs),l)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=f.length,u=a<l,u&&(l=a),a=0;a<l;a++)if(c[a]!=f[a]){u=c[a]<f[a];break}o=0}for(u&&(r=c,c=f,f=r,e.s=-e.s),l=c.length,a=f.length-l;a>0;--a)c[l++]=0;for(a=f.length;a>o;){if(c[--a]<f[a]){for(s=a;s&&c[--s]===0;)c[s]=dl-1;--c[s],c[a]+=dl}c[a]-=f[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(e.d=c,e.e=n,hi?Ts(e,h):e):new A(0)}function Ig(t,e,r){var n,a=Co(t),s=sh(t.d),o=s.length;return e?(r&&(n=r-o)>0?s=s.charAt(0)+"."+s.slice(1)+k0(n):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(a<0?"e":"e+")+a):a<0?(s="0."+k0(-a-1)+s,r&&(n=r-o)>0&&(s+=k0(n))):a>=o?(s+=k0(a+1-o),r&&(n=r-a-1)>0&&(s=s+"."+k0(n))):((n=a+1)<o&&(s=s.slice(0,n)+"."+s.slice(n)),r&&(n=r-o)>0&&(a+1===o&&(s+="."),s+=k0(n))),t.s<0?"-"+s:s}function nz(t,e){if(t.length>e)return t.length=e,!0}function ece(t){var e,r,n;function a(s){var o=this;if(!(o instanceof a))return new a(s);if(o.constructor=a,s instanceof a){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(Zp+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return rz(o,s.toString())}else if(typeof s!="string")throw Error(Zp+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,sYe.test(s))rz(o,s);else throw Error(Zp+s)}if(a.prototype=gn,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=ece,a.config=a.set=iYe,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return a.config(t),a}function iYe(t){if(!t||typeof t!="object")throw Error(Hu+"Object expected");var e,r,n,a=["precision",1,k1,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<a.length;e+=3)if((n=t[r=a[e]])!==void 0)if(F1(n)===n&&n>=a[e+1]&&n<=a[e+2])this[r]=n;else throw Error(Zp+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Zp+r+": "+n);return this}var e8=ece(aYe);Md=new e8(1);const As=e8;var oYe=t=>t,tce={},rce=t=>t===tce,az=t=>function e(){return arguments.length===0||arguments.length===1&&rce(arguments.length<=0?void 0:arguments[0])?e:t(...arguments)},nce=(t,e)=>t===1?e:az(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var s=n.filter(o=>o!==tce).length;return s>=t?e(...n):nce(t-s,az(function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var d=n.map(u=>rce(u)?l.shift():u);return e(...d,...l)}))}),lYe=t=>nce(t.length,t),gO=(t,e)=>{for(var r=[],n=t;n<e;++n)r[n-t]=n;return r},cYe=lYe((t,e)=>Array.isArray(e)?e.map(t):Object.keys(e).map(r=>e[r]).map(t)),dYe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return oYe;var a=r.reverse(),s=a[0],o=a.slice(1);return function(){return o.reduce((l,c)=>c(l),s(...arguments))}};function ace(t){var e;return t===0?e=1:e=Math.floor(new As(t).abs().log(10).toNumber())+1,e}function sce(t,e,r){for(var n=new As(t),a=0,s=[];n.lt(e)&&a<1e5;)s.push(n.toNumber()),n=n.add(r),a++;return s}var ice=t=>{var[e,r]=t,[n,a]=[e,r];return e>r&&([n,a]=[r,e]),[n,a]},oce=(t,e,r)=>{if(t.lte(0))return new As(0);var n=ace(t.toNumber()),a=new As(10).pow(n),s=t.div(a),o=n!==1?.05:.1,l=new As(Math.ceil(s.div(o).toNumber())).add(r).mul(o),c=l.mul(a);return e?new As(c.toNumber()):new As(Math.ceil(c.toNumber()))},uYe=(t,e,r)=>{var n=new As(1),a=new As(t);if(!a.isint()&&r){var s=Math.abs(t);s<1?(n=new As(10).pow(ace(t)-1),a=new As(Math.floor(a.div(n).toNumber())).mul(n)):s>1&&(a=new As(Math.floor(t)))}else t===0?a=new As(Math.floor((e-1)/2)):r||(a=new As(Math.floor(t)));var o=Math.floor((e-1)/2),l=dYe(cYe(c=>a.add(new As(c-o).mul(n)).toNumber()),gO);return l(0,e)},lce=function(e,r,n,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-e)/(n-1)))return{step:new As(0),tickMin:new As(0),tickMax:new As(0)};var o=oce(new As(r).sub(e).div(n-1),a,s),l;e<=0&&r>=0?l=new As(0):(l=new As(e).add(r).div(2),l=l.sub(new As(l).mod(o)));var c=Math.ceil(l.sub(e).div(o).toNumber()),d=Math.ceil(new As(r).sub(l).div(o).toNumber()),u=c+d+1;return u>n?lce(e,r,n,a,s+1):(u<n&&(d=r>0?d+(n-u):d,c=r>0?c:c+(n-u)),{step:o,tickMin:l.sub(new As(c).mul(o)),tickMax:l.add(new As(d).mul(o))})},fYe=function(e){var[r,n]=e,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),[l,c]=ice([r,n]);if(l===-1/0||c===1/0){var d=c===1/0?[l,...gO(0,a-1).map(()=>1/0)]:[...gO(0,a-1).map(()=>-1/0),c];return r>n?d.reverse():d}if(l===c)return uYe(l,a,s);var{step:u,tickMin:f,tickMax:A}=lce(l,c,o,s,0),h=sce(f,A.add(new As(.1).mul(u)),u);return r>n?h.reverse():h},hYe=function(e,r){var[n,a]=e,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,l]=ice([n,a]);if(o===-1/0||l===1/0)return[n,a];if(o===l)return[o];var c=Math.max(r,2),d=oce(new As(l).sub(o).div(c-1),s,0),u=[...sce(new As(o),new As(l),d),l];return s===!1&&(u=u.map(f=>Math.round(f))),n>a?u.reverse():u},cce=t=>t.rootProps.maxBarSize,AYe=t=>t.rootProps.barGap,dce=t=>t.rootProps.barCategoryGap,mYe=t=>t.rootProps.barSize,dN=t=>t.rootProps.stackOffset,uce=t=>t.rootProps.reverseStackOrder,t8=t=>t.options.chartName,r8=t=>t.rootProps.syncId,fce=t=>t.rootProps.syncMethod,n8=t=>t.options.eventEmitter,mc={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Kh={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},kd={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},f3=(t,e)=>{if(!(!t||!e))return t!=null&&t.reversed?[e[1],e[0]]:e},pYe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Kh.angleAxisId,includeHidden:!1,name:void 0,reversed:Kh.reversed,scale:Kh.scale,tick:Kh.tick,tickCount:void 0,ticks:void 0,type:Kh.type,unit:void 0},gYe={allowDataOverflow:kd.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:kd.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:kd.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:kd.scale,tick:kd.tick,tickCount:kd.tickCount,ticks:void 0,type:kd.type,unit:void 0},xYe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Kh.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Kh.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Kh.scale,tick:Kh.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},vYe={allowDataOverflow:kd.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:kd.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:kd.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:kd.scale,tick:kd.tick,tickCount:kd.tickCount,ticks:void 0,type:"category",unit:void 0},a8=(t,e)=>t.polarAxis.angleAxis[e]!=null?t.polarAxis.angleAxis[e]:t.layout.layoutType==="radial"?xYe:pYe,s8=(t,e)=>t.polarAxis.radiusAxis[e]!=null?t.polarAxis.radiusAxis[e]:t.layout.layoutType==="radial"?vYe:gYe,h3=t=>t.polarOptions,i8=Zt([HA,$A,Wo],ole),hce=Zt([h3,i8],(t,e)=>{if(t!=null)return gc(t.innerRadius,e,0)}),Ace=Zt([h3,i8],(t,e)=>{if(t!=null)return gc(t.outerRadius,e,e*.8)}),yYe=t=>{if(t==null)return[0,0];var{startAngle:e,endAngle:r}=t;return[e,r]},mce=Zt([h3],yYe);Zt([a8,mce],f3);var pce=Zt([i8,hce,Ace],(t,e,r)=>{if(!(t==null||e==null||r==null))return[e,r]});Zt([s8,pce],f3);var gce=Zt([za,h3,hce,Ace,HA,$A],(t,e,r,n,a,s)=>{if(!(t!=="centric"&&t!=="radial"||e==null||r==null||n==null)){var{cx:o,cy:l,startAngle:c,endAngle:d}=e;return{cx:gc(o,a,a/2),cy:gc(l,s,s/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:d,clockWise:!1}}}),pi=(t,e)=>e,uN=(t,e,r)=>r;function o8(t){return t==null?void 0:t.id}function xce(t,e,r){var{chartData:n=[]}=e,{allowDuplicatedCategory:a,dataKey:s}=r,o=new Map;return t.forEach(l=>{var c,d=(c=l.data)!==null&&c!==void 0?c:n;if(!(d==null||d.length===0)){var u=o8(l);d.forEach((f,A)=>{var h=s==null||a?A:String(Js(f,s,null)),m=Js(f,l.dataKey,0),p;o.has(h)?p=o.get(h):p={},Object.assign(p,{[u]:m}),o.set(h,p)})}}),Array.from(o.values())}function A3(t){return"stackId"in t&&t.stackId!=null&&t.dataKey!=null}var m3=(t,e)=>t===e?!0:t==null||e==null?!1:t[0]===e[0]&&t[1]===e[1];function p3(t,e){return Array.isArray(t)&&Array.isArray(e)&&t.length===0&&e.length===0?!0:t===e}function bYe(t,e){if(t.length===e.length){for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}return!1}var Yo=t=>{var e=za(t);return e==="horizontal"?"xAxis":e==="vertical"?"yAxis":e==="centric"?"angleAxis":"radiusAxis"},O1=t=>t.tooltip.settings.axisId;function sz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Xj(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sz(Object(r),!0).forEach(function(n){wYe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function wYe(t,e,r){return(e=NYe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NYe(t){var e=CYe(t,"string");return typeof e=="symbol"?e:e+""}function CYe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xO=[0,"auto"],sl={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},vce=(t,e)=>t.cartesianAxis.xAxis[e],qA=(t,e)=>{var r=vce(t,e);return r??sl},il={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:xO,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:nN},yce=(t,e)=>t.cartesianAxis.yAxis[e],zA=(t,e)=>{var r=yce(t,e);return r??il},_Ye={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},l8=(t,e)=>{var r=t.cartesianAxis.zAxis[e];return r??_Ye},Bi=(t,e,r)=>{switch(e){case"xAxis":return qA(t,r);case"yAxis":return zA(t,r);case"zAxis":return l8(t,r);case"angleAxis":return a8(t,r);case"radiusAxis":return s8(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},EYe=(t,e,r)=>{switch(e){case"xAxis":return qA(t,r);case"yAxis":return zA(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},fN=(t,e,r)=>{switch(e){case"xAxis":return qA(t,r);case"yAxis":return zA(t,r);case"angleAxis":return a8(t,r);case"radiusAxis":return s8(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},bce=t=>t.graphicalItems.cartesianItems.some(e=>e.type==="bar")||t.graphicalItems.polarItems.some(e=>e.type==="radialBar");function c8(t,e){return r=>{switch(t){case"xAxis":return"xAxisId"in r&&r.xAxisId===e;case"yAxis":return"yAxisId"in r&&r.yAxisId===e;case"zAxis":return"zAxisId"in r&&r.zAxisId===e;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===e;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===e;default:return!1}}}var d8=t=>t.graphicalItems.cartesianItems,SYe=Zt([pi,uN],c8),u8=(t,e,r)=>t.filter(r).filter(n=>(e==null?void 0:e.includeHidden)===!0?!0:!n.hide),hN=Zt([d8,Bi,SYe],u8,{memoizeOptions:{resultEqualityCheck:p3}}),wce=Zt([hN],t=>t.filter(e=>e.type==="area"||e.type==="bar").filter(A3)),Nce=t=>t.filter(e=>!("stackId"in e)||e.stackId===void 0),jYe=Zt([hN],Nce),f8=t=>t.map(e=>e.data).filter(Boolean).flat(1),IYe=Zt([hN],f8,{memoizeOptions:{resultEqualityCheck:p3}}),h8=(t,e)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=e;return t.length>0?t:r.slice(n,a+1)},A8=Zt([IYe,zle],h8),m8=(t,e,r)=>(e==null?void 0:e.dataKey)!=null?t.map(n=>({value:Js(n,e.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>t.map(a=>({value:Js(a,n)}))):t.map(n=>({value:n})),g3=Zt([A8,Bi,hN],m8);function Cce(t,e){switch(t){case"xAxis":return e.direction==="x";case"yAxis":return e.direction==="y";default:return!1}}function BE(t){if(mh(t)||t instanceof Date){var e=Number(t);if(Ti(e))return e}}function iz(t){if(Array.isArray(t)){var e=[BE(t[0]),BE(t[1])];return Dm(e)?e:void 0}var r=BE(t);if(r!=null)return[r,r]}function TA(t){return t.map(BE).filter(MHe)}function PYe(t,e,r){return!r||typeof e!="number"||Ah(e)?[]:r.length?TA(r.flatMap(n=>{var a=Js(t,n.dataKey),s,o;if(Array.isArray(a)?[s,o]=a:s=o=a,!(!Ti(s)||!Ti(o)))return[e-s,e+o]})):[]}var Jo=t=>{var e=Yo(t),r=O1(t);return fN(t,e,r)},AN=Zt([Jo],t=>t==null?void 0:t.dataKey),TYe=Zt([wce,zle,Jo],xce),_ce=(t,e,r,n)=>{var a={},s=e.reduce((o,l)=>{if(l.stackId==null)return o;var c=o[l.stackId];return c==null&&(c=[]),c.push(l),o[l.stackId]=c,o},a);return Object.fromEntries(Object.entries(s).map(o=>{var[l,c]=o,d=n?[...c].reverse():c,u=d.map(o8);return[l,{stackedData:rKe(t,u,r),graphicalItems:d}]}))},vO=Zt([TYe,wce,dN,uce],_ce),Ece=(t,e,r,n)=>{var{dataStartIndex:a,dataEndIndex:s}=e;if(n==null&&r!=="zAxis"){var o=oKe(t,a,s);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},BYe=Zt([Bi],t=>t.allowDataOverflow),p8=t=>{var e;if(t==null||!("domain"in t))return xO;if(t.domain!=null)return t.domain;if("ticks"in t&&t.ticks!=null){if(t.type==="number"){var r=TA(t.ticks);return[Math.min(...r),Math.max(...r)]}if(t.type==="category")return t.ticks.map(String)}return(e=t==null?void 0:t.domain)!==null&&e!==void 0?e:xO},g8=Zt([Bi],p8),x8=Zt([g8,BYe],Wle),kYe=Zt([vO,KA,pi,x8],Ece,{memoizeOptions:{resultEqualityCheck:m3}}),x3=t=>t.errorBars,FYe=(t,e,r)=>t.flatMap(n=>e[n.id]).filter(Boolean).filter(n=>Cce(r,n)),Yj=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var s=a.flat(),o=Math.min(...s),l=Math.max(...s);return[o,l]}},v8=(t,e,r,n,a)=>{var s,o;if(r.length>0&&t.forEach(l=>{r.forEach(c=>{var d,u,f=(d=n[c.id])===null||d===void 0?void 0:d.filter(v=>Cce(a,v)),A=Js(l,(u=e.dataKey)!==null&&u!==void 0?u:c.dataKey),h=PYe(l,A,f);if(h.length>=2){var m=Math.min(...h),p=Math.max(...h);(s==null||m<s)&&(s=m),(o==null||p>o)&&(o=p)}var x=iz(A);x!=null&&(s=s==null?x[0]:Math.min(s,x[0]),o=o==null?x[1]:Math.max(o,x[1]))})}),(e==null?void 0:e.dataKey)!=null&&t.forEach(l=>{var c=iz(Js(l,e.dataKey));c!=null&&(s=s==null?c[0]:Math.min(s,c[0]),o=o==null?c[1]:Math.max(o,c[1]))}),Ti(s)&&Ti(o))return[s,o]},OYe=Zt([A8,Bi,jYe,x3,pi],v8,{memoizeOptions:{resultEqualityCheck:m3}});function DYe(t){var{value:e}=t;if(mh(e)||e instanceof Date)return e}var RYe=(t,e,r)=>{var n=t.map(DYe).filter(a=>a!=null);return r&&(e.dataKey==null||e.allowDuplicatedCategory&&Cie(n))?Ale(0,t.length):e.allowDuplicatedCategory?n:Array.from(new Set(n))},Sce=t=>t.referenceElements.dots,D1=(t,e,r)=>t.filter(n=>n.ifOverflow==="extendDomain").filter(n=>e==="xAxis"?n.xAxisId===r:n.yAxisId===r),MYe=Zt([Sce,pi,uN],D1),jce=t=>t.referenceElements.areas,LYe=Zt([jce,pi,uN],D1),Ice=t=>t.referenceElements.lines,UYe=Zt([Ice,pi,uN],D1),Pce=(t,e)=>{if(t!=null){var r=TA(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},QYe=Zt(MYe,pi,Pce),Tce=(t,e)=>{if(t!=null){var r=TA(t.flatMap(n=>[e==="xAxis"?n.x1:n.y1,e==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},VYe=Zt([LYe,pi],Tce);function HYe(t){var e;if(t.x!=null)return TA([t.x]);var r=(e=t.segment)===null||e===void 0?void 0:e.map(n=>n.x);return r==null||r.length===0?[]:TA(r)}function $Ye(t){var e;if(t.y!=null)return TA([t.y]);var r=(e=t.segment)===null||e===void 0?void 0:e.map(n=>n.y);return r==null||r.length===0?[]:TA(r)}var Bce=(t,e)=>{if(t!=null){var r=t.flatMap(n=>e==="xAxis"?HYe(n):$Ye(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},GYe=Zt([UYe,pi],Bce),KYe=Zt(QYe,GYe,VYe,(t,e,r)=>Yj(t,r,e)),y8=(t,e,r,n,a,s,o,l)=>{if(r!=null)return r;var c=o==="vertical"&&l==="xAxis"||o==="horizontal"&&l==="yAxis",d=c?Yj(n,s,a):Yj(s,a);return nYe(e,d,t.allowDataOverflow)},qYe=Zt([Bi,g8,x8,kYe,OYe,KYe,za,pi],y8,{memoizeOptions:{resultEqualityCheck:m3}}),zYe=[0,1],b8=(t,e,r,n,a,s,o)=>{if(!((t==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:c}=t,d=zg(e,s);if(d&&l==null){var u;return Ale(0,(u=r==null?void 0:r.length)!==null&&u!==void 0?u:0)}return c==="category"?RYe(n,t,d):a==="expand"?zYe:o}},w8=Zt([Bi,za,A8,g3,dN,pi,qYe],b8),kce=(t,e,r,n,a)=>{if(t!=null){var{scale:s,type:o}=t;if(s==="auto")return e==="radial"&&a==="radiusAxis"?"band":e==="radial"&&a==="angleAxis"?"linear":o==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":o==="category"?"band":"linear";if(typeof s=="string"){var l="scale".concat(Jw(s));return l in db?l:"point"}}},R1=Zt([Bi,za,bce,t8,pi],kce);function WYe(t){if(t!=null){if(t in db)return db[t]();var e="scale".concat(Jw(t));if(e in db)return db[e]()}}function N8(t,e,r,n){if(!(r==null||n==null)){if(typeof t.scale=="function")return t.scale.copy().domain(r).range(n);var a=WYe(e);if(a!=null){var s=a.domain(r).range(n);return YGe(s),s}}}var C8=(t,e,r)=>{var n=p8(e);if(!(r!=="auto"&&r!=="linear")){if(e!=null&&e.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Dm(t))return fYe(t,e.tickCount,e.allowDecimals);if(e!=null&&e.tickCount&&e.type==="number"&&Dm(t))return hYe(t,e.tickCount,e.allowDecimals)}},_8=Zt([w8,fN,R1],C8),E8=(t,e,r,n)=>{if(n!=="angleAxis"&&(t==null?void 0:t.type)==="number"&&Dm(e)&&Array.isArray(r)&&r.length>0){var a=e[0],s=r[0],o=e[1],l=r[r.length-1];return[Math.min(a,s),Math.max(o,l)]}return e},XYe=Zt([Bi,w8,_8,pi],E8),YYe=Zt(g3,Bi,(t,e)=>{if(!(!e||e.type!=="number")){var r=1/0,n=Array.from(TA(t.map(f=>f.value))).sort((f,A)=>f-A),a=n[0],s=n[n.length-1];if(a==null||s==null)return 1/0;var o=s-a;if(o===0)return 1/0;for(var l=0;l<n.length-1;l++){var c=n[l],d=n[l+1];if(!(c==null||d==null)){var u=d-c;r=Math.min(r,u)}}return r/o}}),Fce=Zt(YYe,za,dce,Wo,(t,e,r,n,a)=>a,(t,e,r,n,a)=>{if(!Ti(t))return 0;var s=e==="vertical"?n.height:n.width;if(a==="gap")return t*s/2;if(a==="no-gap"){var o=gc(r,t*s),l=t*s/2;return l-o-(l-o)/s*o}return 0}),JYe=(t,e,r)=>{var n=qA(t,e);return n==null||typeof n.padding!="string"?0:Fce(t,"xAxis",e,r,n.padding)},ZYe=(t,e,r)=>{var n=zA(t,e);return n==null||typeof n.padding!="string"?0:Fce(t,"yAxis",e,r,n.padding)},eJe=Zt(qA,JYe,(t,e)=>{var r,n;if(t==null)return{left:0,right:0};var{padding:a}=t;return typeof a=="string"?{left:e,right:e}:{left:((r=a.left)!==null&&r!==void 0?r:0)+e,right:((n=a.right)!==null&&n!==void 0?n:0)+e}}),tJe=Zt(zA,ZYe,(t,e)=>{var r,n;if(t==null)return{top:0,bottom:0};var{padding:a}=t;return typeof a=="string"?{top:e,bottom:e}:{top:((r=a.top)!==null&&r!==void 0?r:0)+e,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+e}}),rJe=Zt([Wo,eJe,XP,WP,(t,e,r)=>r],(t,e,r,n,a)=>{var{padding:s}=n;return a?[s.left,r.width-s.right]:[t.left+e.left,t.left+t.width-e.right]}),nJe=Zt([Wo,za,tJe,XP,WP,(t,e,r)=>r],(t,e,r,n,a,s)=>{var{padding:o}=a;return s?[n.height-o.bottom,o.top]:e==="horizontal"?[t.top+t.height-r.bottom,t.top+r.top]:[t.top+r.top,t.top+t.height-r.bottom]}),mN=(t,e,r,n)=>{var a;switch(e){case"xAxis":return rJe(t,r,n);case"yAxis":return nJe(t,r,n);case"zAxis":return(a=l8(t,r))===null||a===void 0?void 0:a.range;case"angleAxis":return mce(t);case"radiusAxis":return pce(t,r);default:return}},Oce=Zt([Bi,mN],f3),v3=Zt([Bi,R1,XYe,Oce],N8);Zt([hN,x3,pi],FYe);function Dce(t,e){return t.id<e.id?-1:t.id>e.id?1:0}var y3=(t,e)=>e,b3=(t,e,r)=>r,aJe=Zt(qP,y3,b3,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(Dce)),sJe=Zt(zP,y3,b3,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(Dce)),Rce=(t,e)=>({width:t.width,height:e.height}),iJe=(t,e)=>{var r=typeof e.width=="number"?e.width:nN;return{width:r,height:t.height}},Mce=Zt(Wo,qA,Rce),oJe=(t,e,r)=>{switch(e){case"top":return t.top;case"bottom":return r-t.bottom;default:return 0}},lJe=(t,e,r)=>{switch(e){case"left":return t.left;case"right":return r-t.right;default:return 0}},cJe=Zt($A,Wo,aJe,y3,b3,(t,e,r,n,a)=>{var s={},o;return r.forEach(l=>{var c=Rce(e,l);o==null&&(o=oJe(e,n,t));var d=n==="top"&&!a||n==="bottom"&&a;s[l.id]=o-Number(d)*c.height,o+=(d?-1:1)*c.height}),s}),dJe=Zt(HA,Wo,sJe,y3,b3,(t,e,r,n,a)=>{var s={},o;return r.forEach(l=>{var c=iJe(e,l);o==null&&(o=lJe(e,n,t));var d=n==="left"&&!a||n==="right"&&a;s[l.id]=o-Number(d)*c.width,o+=(d?-1:1)*c.width}),s}),uJe=(t,e)=>{var r=qA(t,e);if(r!=null)return cJe(t,r.orientation,r.mirror)},fJe=Zt([Wo,qA,uJe,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var a=r==null?void 0:r[n];return a==null?{x:t.left,y:0}:{x:t.left,y:a}}}),hJe=(t,e)=>{var r=zA(t,e);if(r!=null)return dJe(t,r.orientation,r.mirror)},AJe=Zt([Wo,zA,hJe,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var a=r==null?void 0:r[n];return a==null?{x:0,y:t.top}:{x:a,y:t.top}}}),Lce=Zt(Wo,zA,(t,e)=>{var r=typeof e.width=="number"?e.width:nN;return{width:r,height:t.height}}),oz=(t,e,r)=>{switch(e){case"xAxis":return Mce(t,r).width;case"yAxis":return Lce(t,r).height;default:return}},Uce=(t,e,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:s,dataKey:o}=r,l=zg(t,n),c=e.map(d=>d.value);if(o&&l&&s==="category"&&a&&Cie(c))return c}},S8=Zt([za,g3,Bi,pi],Uce),Qce=(t,e,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:s}=r,o=zg(t,n);if(o&&(a==="number"||s!=="auto"))return e.map(l=>l.value)}},j8=Zt([za,g3,fN,pi],Qce);Zt([za,EYe,R1,v3,S8,j8,mN,_8,pi],(t,e,r,n,a,s,o,l,c)=>{if(e!=null){var d=zg(t,c);return{angle:e.angle,interval:e.interval,minTickGap:e.minTickGap,orientation:e.orientation,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit,axisType:c,categoricalDomain:s,duplicateDomain:a,isCategorical:d,niceTicks:l,range:o,realScaleType:r,scale:n}}});var mJe=(t,e,r,n,a,s,o,l,c)=>{if(!(e==null||n==null)){var d=zg(t,c),{type:u,ticks:f,tickCount:A}=e,h=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,m=u==="category"&&n.bandwidth?n.bandwidth()/h:0;m=c==="angleAxis"&&s!=null&&s.length>=2?Hl(s[0]-s[1])*2*m:m;var p=f||a;if(p){var x=p.map((v,y)=>{var b=o?o.indexOf(v):v;return{index:y,coordinate:n(b)+m,value:v,offset:m}});return x.filter(v=>Ti(v.coordinate))}return d&&l?l.map((v,y)=>({coordinate:n(v)+m,value:v,index:y,offset:m})).filter(v=>Ti(v.coordinate)):n.ticks?n.ticks(A).map(v=>({coordinate:n(v)+m,value:v,offset:m})):n.domain().map((v,y)=>({coordinate:n(v)+m,value:o?o[v]:v,index:y,offset:m}))}},Vce=Zt([za,fN,R1,v3,_8,mN,S8,j8,pi],mJe),pJe=(t,e,r,n,a,s,o)=>{if(!(e==null||r==null||n==null||n[0]===n[1])){var l=zg(t,o),{tickCount:c}=e,d=0;return d=o==="angleAxis"&&(n==null?void 0:n.length)>=2?Hl(n[0]-n[1])*2*d:d,l&&s?s.map((u,f)=>({coordinate:r(u)+d,value:u,index:f,offset:d})):r.ticks?r.ticks(c).map(u=>({coordinate:r(u)+d,value:u,offset:d})):r.domain().map((u,f)=>({coordinate:r(u)+d,value:a?a[u]:u,index:f,offset:d}))}},n1=Zt([za,fN,v3,mN,S8,j8,pi],pJe),a1=Zt(Bi,v3,(t,e)=>{if(!(t==null||e==null))return Xj(Xj({},t),{},{scale:e})}),gJe=Zt([Bi,R1,w8,Oce],N8);Zt((t,e,r)=>l8(t,r),gJe,(t,e)=>{if(!(t==null||e==null))return Xj(Xj({},t),{},{scale:e})});var xJe=Zt([za,qP,zP],(t,e,r)=>{switch(t){case"horizontal":return e.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),Hce=t=>t.options.defaultTooltipEventType,$ce=t=>t.options.validateTooltipEventTypes;function Gce(t,e,r){if(t==null)return e;var n=t?"axis":"item";return r==null?e:r.includes(n)?n:e}function I8(t,e){var r=Hce(t),n=$ce(t);return Gce(e,r,n)}function vJe(t){return In(e=>I8(e,t))}var Kce=(t,e)=>{var r,n=Number(e);if(!(Ah(n)||e==null))return n>=0?t==null||(r=t[n])===null||r===void 0?void 0:r.value:void 0},yJe=t=>t.tooltip.settings,G0={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},bJe={itemInteraction:{click:G0,hover:G0},axisInteraction:{click:G0,hover:G0},keyboardInteraction:G0,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},qce=xd({name:"tooltip",initialState:bJe,reducers:{addTooltipEntrySettings:{reducer(t,e){t.tooltipItemPayloads.push(e.payload)},prepare:ii()},replaceTooltipEntrySettings:{reducer(t,e){var{prev:r,next:n}=e.payload,a=_f(t).tooltipItemPayloads.indexOf(r);a>-1&&(t.tooltipItemPayloads[a]=n)},prepare:ii()},removeTooltipEntrySettings:{reducer(t,e){var r=_f(t).tooltipItemPayloads.indexOf(e.payload);r>-1&&t.tooltipItemPayloads.splice(r,1)},prepare:ii()},setTooltipSettingsState(t,e){t.settings=e.payload},setActiveMouseOverItemIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=e.payload.activeIndex,t.itemInteraction.hover.dataKey=e.payload.activeDataKey,t.itemInteraction.hover.graphicalItemId=e.payload.activeGraphicalItemId,t.itemInteraction.hover.coordinate=e.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,e){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=e.payload.activeIndex,t.itemInteraction.click.dataKey=e.payload.activeDataKey,t.itemInteraction.click.graphicalItemId=e.payload.activeGraphicalItemId,t.itemInteraction.click.coordinate=e.payload.activeCoordinate},setMouseOverAxisIndex(t,e){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=e.payload.activeIndex,t.axisInteraction.hover.dataKey=e.payload.activeDataKey,t.axisInteraction.hover.coordinate=e.payload.activeCoordinate},setMouseClickAxisIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=e.payload.activeIndex,t.axisInteraction.click.dataKey=e.payload.activeDataKey,t.axisInteraction.click.coordinate=e.payload.activeCoordinate},setSyncInteraction(t,e){t.syncInteraction=e.payload},setKeyboardInteraction(t,e){t.keyboardInteraction.active=e.payload.active,t.keyboardInteraction.index=e.payload.activeIndex,t.keyboardInteraction.coordinate=e.payload.activeCoordinate}}}),{addTooltipEntrySettings:wJe,replaceTooltipEntrySettings:NJe,removeTooltipEntrySettings:CJe,setTooltipSettingsState:_Je,setActiveMouseOverItemIndex:zce,mouseLeaveItem:EJe,mouseLeaveChart:Wce,setActiveClickItemIndex:SJe,setMouseOverAxisIndex:Xce,setMouseClickAxisIndex:jJe,setSyncInteraction:yO,setKeyboardInteraction:bO}=qce.actions,IJe=qce.reducer;function lz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function O_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?lz(Object(r),!0).forEach(function(n){PJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):lz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function PJe(t,e,r){return(e=TJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TJe(t){var e=BJe(t,"string");return typeof e=="symbol"?e:e+""}function BJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kJe(t,e,r){return e==="axis"?r==="click"?t.axisInteraction.click:t.axisInteraction.hover:r==="click"?t.itemInteraction.click:t.itemInteraction.hover}function FJe(t){return t.index!=null}var Yce=(t,e,r,n)=>{if(e==null)return G0;var a=kJe(t,e,r);if(a==null)return G0;if(a.active)return a;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var s=t.settings.active===!0;if(FJe(a)){if(s)return O_(O_({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return O_(O_({},G0),{},{coordinate:a.coordinate})};function OJe(t){if(typeof t=="number")return Number.isFinite(t)?t:void 0;if(t instanceof Date){var e=t.valueOf();return Number.isFinite(e)?e:void 0}var r=Number(t);return Number.isFinite(r)?r:void 0}function DJe(t,e){var r=OJe(t),n=e[0],a=e[1];if(r===void 0)return!1;var s=Math.min(n,a),o=Math.max(n,a);return r>=s&&r<=o}function RJe(t,e,r){if(r==null||e==null)return!0;var n=Js(t,e);return n==null||!Dm(r)?!0:DJe(n,r)}var P8=(t,e,r,n)=>{var a=t==null?void 0:t.index;if(a==null)return null;var s=Number(a);if(!Ti(s))return a;var o=0,l=1/0;e.length>0&&(l=e.length-1);var c=Math.max(o,Math.min(s,l)),d=e[c];return d==null||RJe(d,r,n)?String(c):null},Jce=(t,e,r,n,a,s,o,l)=>{if(!(s==null||l==null)){var c=o[0],d=c==null?void 0:l(c.positions,s);if(d!=null)return d;var u=a==null?void 0:a[Number(s)];if(u)switch(r){case"horizontal":return{x:u.coordinate,y:(n.top+e)/2};default:return{x:(n.left+t)/2,y:u.coordinate}}}},Zce=(t,e,r,n)=>{if(e==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var a;if(r==="hover"?a=t.itemInteraction.hover.graphicalItemId:a=t.itemInteraction.click.graphicalItemId,a==null&&n!=null){var s=t.tooltipItemPayloads[0];return s!=null?[s]:[]}return t.tooltipItemPayloads.filter(o=>{var l;return((l=o.settings)===null||l===void 0?void 0:l.graphicalItemId)===a})},pN=t=>t.options.tooltipPayloadSearcher,M1=t=>t.tooltip;function cz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function dz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?cz(Object(r),!0).forEach(function(n){MJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):cz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function MJe(t,e,r){return(e=LJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LJe(t){var e=UJe(t,"string");return typeof e=="symbol"?e:e+""}function UJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function QJe(t,e){return t??e}var ede=(t,e,r,n,a,s,o)=>{if(!(e==null||s==null)){var{chartData:l,computedData:c,dataStartIndex:d,dataEndIndex:u}=r,f=[];return t.reduce((A,h)=>{var m,{dataDefinedOnItem:p,settings:x}=h,v=QJe(p,l),y=Array.isArray(v)?Boe(v,d,u):v,b=(m=x==null?void 0:x.dataKey)!==null&&m!==void 0?m:n,w=x==null?void 0:x.nameKey,I;if(n&&Array.isArray(y)&&!Array.isArray(y[0])&&o==="axis"?I=RHe(y,n,a):I=s(y,e,c,w),Array.isArray(I))I.forEach(N=>{var S=dz(dz({},x),{},{name:N.name,unit:N.unit,color:void 0,fill:void 0});A.push(yK({tooltipEntrySettings:S,dataKey:N.dataKey,payload:N.payload,value:Js(N.payload,N.dataKey),name:N.name}))});else{var j;A.push(yK({tooltipEntrySettings:x,dataKey:b,payload:I,value:Js(I,b),name:(j=Js(I,w))!==null&&j!==void 0?j:x==null?void 0:x.name}))}return A},f)}},T8=Zt([Jo,za,bce,t8,Yo],kce),VJe=Zt([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,e)=>[...t,...e]),HJe=Zt([Yo,O1],c8),L1=Zt([VJe,Jo,HJe],u8,{memoizeOptions:{resultEqualityCheck:p3}}),$Je=Zt([L1],t=>t.filter(A3)),GJe=Zt([L1],f8,{memoizeOptions:{resultEqualityCheck:p3}}),U1=Zt([GJe,KA],h8),KJe=Zt([$Je,KA,Jo],xce),B8=Zt([U1,Jo,L1],m8),tde=Zt([Jo],p8),qJe=Zt([Jo],t=>t.allowDataOverflow),rde=Zt([tde,qJe],Wle),zJe=Zt([L1],t=>t.filter(A3)),WJe=Zt([KJe,zJe,dN,uce],_ce),XJe=Zt([WJe,KA,Yo,rde],Ece),YJe=Zt([L1],Nce),JJe=Zt([U1,Jo,YJe,x3,Yo],v8,{memoizeOptions:{resultEqualityCheck:m3}}),ZJe=Zt([Sce,Yo,O1],D1),eZe=Zt([ZJe,Yo],Pce),tZe=Zt([jce,Yo,O1],D1),rZe=Zt([tZe,Yo],Tce),nZe=Zt([Ice,Yo,O1],D1),aZe=Zt([nZe,Yo],Bce),sZe=Zt([eZe,aZe,rZe],Yj),iZe=Zt([Jo,tde,rde,XJe,JJe,sZe,za,Yo],y8),gN=Zt([Jo,za,U1,B8,dN,Yo,iZe],b8),oZe=Zt([gN,Jo,T8],C8),lZe=Zt([Jo,gN,oZe,Yo],E8),nde=t=>{var e=Yo(t),r=O1(t),n=!1;return mN(t,e,r,n)},ade=Zt([Jo,nde],f3),sde=Zt([Jo,T8,lZe,ade],N8),cZe=Zt([za,B8,Jo,Yo],Uce),dZe=Zt([za,B8,Jo,Yo],Qce),uZe=(t,e,r,n,a,s,o,l)=>{if(e){var{type:c}=e,d=zg(t,l);if(n){var u=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/u:0;return f=l==="angleAxis"&&a!=null&&(a==null?void 0:a.length)>=2?Hl(a[0]-a[1])*2*f:f,d&&o?o.map((A,h)=>({coordinate:n(A)+f,value:A,index:h,offset:f})):n.domain().map((A,h)=>({coordinate:n(A)+f,value:s?s[A]:A,index:h,offset:f}))}}},WA=Zt([za,Jo,T8,sde,nde,cZe,dZe,Yo],uZe),k8=Zt([Hce,$ce,yJe],(t,e,r)=>Gce(r.shared,t,e)),ide=t=>t.tooltip.settings.trigger,F8=t=>t.tooltip.settings.defaultIndex,xN=Zt([M1,k8,ide,F8],Yce),Pg=Zt([xN,U1,AN,gN],P8),ode=Zt([WA,Pg],Kce),O8=Zt([xN],t=>{if(t)return t.dataKey}),fZe=Zt([xN],t=>{if(t)return t.graphicalItemId}),lde=Zt([M1,k8,ide,F8],Zce),hZe=Zt([HA,$A,za,Wo,WA,F8,lde,pN],Jce),AZe=Zt([xN,hZe],(t,e)=>t!=null&&t.coordinate?t.coordinate:e),mZe=Zt([xN],t=>{var e;return(e=t==null?void 0:t.active)!==null&&e!==void 0?e:!1}),pZe=Zt([lde,Pg,KA,AN,ode,pN,k8],ede);Zt([pZe],t=>{if(t!=null){var e=t.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(e))}});function uz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function fz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?uz(Object(r),!0).forEach(function(n){gZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):uz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function gZe(t,e,r){return(e=xZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xZe(t){var e=vZe(t,"string");return typeof e=="symbol"?e:e+""}function vZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var yZe=()=>In(Jo),bZe=()=>{var t=yZe(),e=In(WA),r=In(sde);return Pj(!t||!r?void 0:fz(fz({},t),{},{scale:r}),e)};function hz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function _x(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?hz(Object(r),!0).forEach(function(n){wZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function wZe(t,e,r){return(e=NZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NZe(t){var e=CZe(t,"string");return typeof e=="symbol"?e:e+""}function CZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _Ze=(t,e,r,n)=>{var a=e.find(s=>s&&s.index===r);if(a){if(t==="horizontal")return{x:a.coordinate,y:n.chartY};if(t==="vertical")return{x:n.chartX,y:a.coordinate}}return{x:0,y:0}},EZe=(t,e,r,n)=>{var a=e.find(d=>d&&d.index===r);if(a){if(t==="centric"){var s=a.coordinate,{radius:o}=n;return _x(_x(_x({},n),No(n.cx,n.cy,o,s)),{},{angle:s,radius:o})}var l=a.coordinate,{angle:c}=n;return _x(_x(_x({},n),No(n.cx,n.cy,l,c)),{},{angle:c,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function SZe(t,e){var{chartX:r,chartY:n}=t;return r>=e.left&&r<=e.left+e.width&&n>=e.top&&n<=e.top+e.height}var cde=(t,e,r,n,a)=>{var s,o=(s=e==null?void 0:e.length)!==null&&s!==void 0?s:0;if(o<=1||t==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var l=0;l<o;l++){var c,d,u,f,A,h=l>0?(c=r[l-1])===null||c===void 0?void 0:c.coordinate:(d=r[o-1])===null||d===void 0?void 0:d.coordinate,m=(u=r[l])===null||u===void 0?void 0:u.coordinate,p=l>=o-1?(f=r[0])===null||f===void 0?void 0:f.coordinate:(A=r[l+1])===null||A===void 0?void 0:A.coordinate,x=void 0;if(!(h==null||m==null||p==null))if(Hl(m-h)!==Hl(p-m)){var v=[];if(Hl(p-m)===Hl(a[1]-a[0])){x=p;var y=m+a[1]-a[0];v[0]=Math.min(y,(y+h)/2),v[1]=Math.max(y,(y+h)/2)}else{x=h;var b=p+a[1]-a[0];v[0]=Math.min(m,(b+m)/2),v[1]=Math.max(m,(b+m)/2)}var w=[Math.min(m,(x+m)/2),Math.max(m,(x+m)/2)];if(t>w[0]&&t<=w[1]||t>=v[0]&&t<=v[1]){var I;return(I=r[l])===null||I===void 0?void 0:I.index}}else{var j=Math.min(h,p),N=Math.max(h,p);if(t>(j+m)/2&&t<=(N+m)/2){var S;return(S=r[l])===null||S===void 0?void 0:S.index}}}else if(e)for(var E=0;E<o;E++){var B=e[E];if(B!=null){var k=e[E+1],T=e[E-1];if(E===0&&k!=null&&t<=(B.coordinate+k.coordinate)/2||E===o-1&&T!=null&&t>(B.coordinate+T.coordinate)/2||E>0&&E<o-1&&T!=null&&k!=null&&t>(B.coordinate+T.coordinate)/2&&t<=(B.coordinate+k.coordinate)/2)return B.index}}return-1},jZe=()=>In(t8),D8=(t,e)=>e,dde=(t,e,r)=>r,R8=(t,e,r,n)=>n,IZe=Zt(WA,t=>DP(t,e=>e.coordinate)),M8=Zt([M1,D8,dde,R8],Yce),L8=Zt([M8,U1,AN,gN],P8),PZe=(t,e,r)=>{if(e!=null){var n=M1(t);return e==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},ude=Zt([M1,D8,dde,R8],Zce),Jj=Zt([HA,$A,za,Wo,WA,R8,ude,pN],Jce),TZe=Zt([M8,Jj],(t,e)=>{var r;return(r=t.coordinate)!==null&&r!==void 0?r:e}),fde=Zt([WA,L8],Kce),BZe=Zt([ude,L8,KA,AN,fde,pN,D8],ede),kZe=Zt([M8,L8],(t,e)=>({isActive:t.active&&e!=null,activeIndex:e})),FZe=(t,e,r,n,a,s,o)=>{if(!(!t||!r||!n||!a)&&SZe(t,o)){var l=lKe(t,e),c=cde(l,s,a,r,n),d=_Ze(e,a,c,t);return{activeIndex:String(c),activeCoordinate:d}}},OZe=(t,e,r,n,a,s,o)=>{if(!(!t||!n||!a||!s||!r)){var l=wze(t,r);if(l){var c=cKe(l,e),d=cde(c,o,s,n,a),u=EZe(e,s,d,l);return{activeIndex:String(d),activeCoordinate:u}}}},DZe=(t,e,r,n,a,s,o,l)=>{if(!(!t||!e||!n||!a||!s))return e==="horizontal"||e==="vertical"?FZe(t,e,n,a,s,o,l):OZe(t,e,r,n,a,s,o)},RZe=Zt(t=>t.zIndex.zIndexMap,(t,e)=>e,(t,e,r)=>r,(t,e,r)=>{if(e!=null){var n=t[e];if(n!=null)return r?n.panoramaElement:n.element}}),MZe=Zt(t=>t.zIndex.zIndexMap,t=>{var e=Object.keys(t).map(n=>parseInt(n,10)).concat(Object.values(mc)),r=Array.from(new Set(e));return r.sort((n,a)=>n-a)},{memoizeOptions:{resultEqualityCheck:bYe}});function Az(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function mz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Az(Object(r),!0).forEach(function(n){LZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Az(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function LZe(t,e,r){return(e=UZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UZe(t){var e=QZe(t,"string");return typeof e=="symbol"?e:e+""}function QZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var VZe={},HZe={zIndexMap:Object.values(mc).reduce((t,e)=>mz(mz({},t),{},{[e]:{element:void 0,panoramaElement:void 0,consumers:0}}),VZe)},$Ze=new Set(Object.values(mc));function GZe(t){return $Ze.has(t)}var hde=xd({name:"zIndex",initialState:HZe,reducers:{registerZIndexPortal:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]?t.zIndexMap[r].consumers+=1:t.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:ii()},unregisterZIndexPortal:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]&&(t.zIndexMap[r].consumers-=1,t.zIndexMap[r].consumers<=0&&!GZe(r)&&delete t.zIndexMap[r])},prepare:ii()},registerZIndexPortalElement:{reducer:(t,e)=>{var{zIndex:r,element:n,isPanorama:a}=e.payload;t.zIndexMap[r]?a?t.zIndexMap[r].panoramaElement=n:t.zIndexMap[r].element=n:t.zIndexMap[r]={consumers:0,element:a?void 0:n,panoramaElement:a?n:void 0}},prepare:ii()},unregisterZIndexPortalElement:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]&&(e.payload.isPanorama?t.zIndexMap[r].panoramaElement=void 0:t.zIndexMap[r].element=void 0)},prepare:ii()}}}),{registerZIndexPortal:KZe,unregisterZIndexPortal:qZe,registerZIndexPortalElement:zZe,unregisterZIndexPortalElement:WZe}=hde.actions,XZe=hde.reducer;function Nh(t){var{zIndex:e,children:r}=t,n=RKe(),a=n&&e!==void 0&&e!==0,s=Zd(),o=Us();g.useLayoutEffect(()=>a?(o(KZe({zIndex:e})),()=>{o(qZe({zIndex:e}))}):Zw,[o,e,a]);var l=In(c=>RZe(c,e,s));return a?l?$d.createPortal(r,l):null:r}function wO(){return wO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},wO.apply(null,arguments)}function pz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function D_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pz(Object(r),!0).forEach(function(n){YZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function YZe(t,e,r){return(e=JZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JZe(t){var e=ZZe(t,"string");return typeof e=="symbol"?e:e+""}function ZZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eet(t){var{cursor:e,cursorComp:r,cursorProps:n}=t;return g.isValidElement(e)?g.cloneElement(e,n):g.createElement(r,n)}function tet(t){var e,{coordinate:r,payload:n,index:a,offset:s,tooltipAxisBandSize:o,layout:l,cursor:c,tooltipEventType:d,chartName:u}=t,f=r,A=n,h=a;if(!c||!f||u!=="ScatterChart"&&d!=="axis")return null;var m,p,x;if(u==="ScatterChart")m=f,p=Dqe,x=mc.cursorLine;else if(u==="BarChart")m=Rqe(l,f,s,o),p=ile,x=mc.cursorRectangle;else if(l==="radial"&&Eie(f)){var{cx:v,cy:y,radius:b,startAngle:w,endAngle:I}=lle(f);m={cx:v,cy:y,startAngle:w,endAngle:I,innerRadius:b,outerRadius:b},p=dle,x=mc.cursorLine}else m={points:Eze(l,f,s)},p=IM,x=mc.cursorLine;var j=typeof c=="object"&&"className"in c?c.className:void 0,N=D_(D_(D_(D_({stroke:"#ccc",pointerEvents:"none"},s),m),ew(c)),{},{payload:A,payloadIndex:h,className:vs("recharts-tooltip-cursor",j)});return g.createElement(Nh,{zIndex:(e=t.zIndex)!==null&&e!==void 0?e:x},g.createElement(eet,{cursor:c,cursorComp:p,cursorProps:N}))}function ret(t){var e=bZe(),r=OKe(),n=aN(),a=jZe();return e==null||r==null||n==null||a==null?null:g.createElement(tet,wO({},t,{offset:r,layout:n,tooltipAxisBandSize:e,chartName:a}))}var Ade=g.createContext(null),net=()=>g.useContext(Ade),mde={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,d,u){this.fn=c,this.context=d,this.once=u||!1}function s(c,d,u,f,A){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new a(u,f||c,A),m=r?r+d:d;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],h]:c._events[m].push(h):(c._events[m]=h,c._eventsCount++),c}function o(c,d){--c._eventsCount===0?c._events=new n:delete c._events[d]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],u,f;if(this._eventsCount===0)return d;for(f in u=this._events)e.call(u,f)&&d.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},l.prototype.listeners=function(d){var u=r?r+d:d,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var A=0,h=f.length,m=new Array(h);A<h;A++)m[A]=f[A].fn;return m},l.prototype.listenerCount=function(d){var u=r?r+d:d,f=this._events[u];return f?f.fn?1:f.length:0},l.prototype.emit=function(d,u,f,A,h,m){var p=r?r+d:d;if(!this._events[p])return!1;var x=this._events[p],v=arguments.length,y,b;if(x.fn){switch(x.once&&this.removeListener(d,x.fn,void 0,!0),v){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,u),!0;case 3:return x.fn.call(x.context,u,f),!0;case 4:return x.fn.call(x.context,u,f,A),!0;case 5:return x.fn.call(x.context,u,f,A,h),!0;case 6:return x.fn.call(x.context,u,f,A,h,m),!0}for(b=1,y=new Array(v-1);b<v;b++)y[b-1]=arguments[b];x.fn.apply(x.context,y)}else{var w=x.length,I;for(b=0;b<w;b++)switch(x[b].once&&this.removeListener(d,x[b].fn,void 0,!0),v){case 1:x[b].fn.call(x[b].context);break;case 2:x[b].fn.call(x[b].context,u);break;case 3:x[b].fn.call(x[b].context,u,f);break;case 4:x[b].fn.call(x[b].context,u,f,A);break;default:if(!y)for(I=1,y=new Array(v-1);I<v;I++)y[I-1]=arguments[I];x[b].fn.apply(x[b].context,y)}}return!0},l.prototype.on=function(d,u,f){return s(this,d,u,f,!1)},l.prototype.once=function(d,u,f){return s(this,d,u,f,!0)},l.prototype.removeListener=function(d,u,f,A){var h=r?r+d:d;if(!this._events[h])return this;if(!u)return o(this,h),this;var m=this._events[h];if(m.fn)m.fn===u&&(!A||m.once)&&(!f||m.context===f)&&o(this,h);else{for(var p=0,x=[],v=m.length;p<v;p++)(m[p].fn!==u||A&&!m[p].once||f&&m[p].context!==f)&&x.push(m[p]);x.length?this._events[h]=x.length===1?x[0]:x:o(this,h)}return this},l.prototype.removeAllListeners=function(d){var u;return d?(u=r?r+d:d,this._events[u]&&o(this,u)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,t.exports=l})(mde);var aet=mde.exports;const set=kA(aet);var Aw=new set,NO="recharts.syncEvent.tooltip",gz="recharts.syncEvent.brush";function pde(t,e){if(e){var r=Number.parseInt(e,10);if(!Ah(r))return t==null?void 0:t[r]}}var iet={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},gde=xd({name:"options",initialState:iet,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),oet=gde.reducer,{createEventEmitter:cet}=gde.actions;function det(t){return t.tooltip.syncInteraction}var uet={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},xde=xd({name:"chartData",initialState:uet,reducers:{setChartData(t,e){if(t.chartData=e.payload,e.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}e.payload.length>0&&t.dataEndIndex!==e.payload.length-1&&(t.dataEndIndex=e.payload.length-1)},setComputedData(t,e){t.computedData=e.payload},setDataStartEndIndexes(t,e){var{startIndex:r,endIndex:n}=e.payload;r!=null&&(t.dataStartIndex=r),n!=null&&(t.dataEndIndex=n)}}}),{setChartData:xz,setDataStartEndIndexes:fet,setComputedData:hot}=xde.actions,het=xde.reducer,Aet=["x","y"];function vz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ex(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vz(Object(r),!0).forEach(function(n){met(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function met(t,e,r){return(e=pet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pet(t){var e=get(t,"string");return typeof e=="symbol"?e:e+""}function get(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xet(t,e){if(t==null)return{};var r,n,a=vet(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function vet(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function yet(){var t=In(r8),e=In(n8),r=Us(),n=In(fce),a=In(WA),s=aN(),o=YP(),l=In(c=>c.rootProps.className);g.useEffect(()=>{if(t==null)return Zw;var c=(d,u,f)=>{if(e!==f&&t===d){if(n==="index"){var A;if(o&&u!==null&&u!==void 0&&(A=u.payload)!==null&&A!==void 0&&A.coordinate&&u.payload.sourceViewBox){var h=u.payload.coordinate,{x:m,y:p}=h,x=xet(h,Aet),{x:v,y,width:b,height:w}=u.payload.sourceViewBox,I=Ex(Ex({},x),{},{x:o.x+(b?(m-v)/b:0)*o.width,y:o.y+(w?(p-y)/w:0)*o.height});r(Ex(Ex({},u),{},{payload:Ex(Ex({},u.payload),{},{coordinate:I})}))}else r(u);return}if(a!=null){var j;if(typeof n=="function"){var N={activeTooltipIndex:u.payload.index==null?void 0:Number(u.payload.index),isTooltipActive:u.payload.active,activeIndex:u.payload.index==null?void 0:Number(u.payload.index),activeLabel:u.payload.label,activeDataKey:u.payload.dataKey,activeCoordinate:u.payload.coordinate},S=n(a,N);j=a[S]}else n==="value"&&(j=a.find(ce=>String(ce.value)===u.payload.label));var{coordinate:E}=u.payload;if(j==null||u.payload.active===!1||E==null||o==null){r(yO({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:B,y:k}=E,T=Math.min(B,o.x+o.width),P=Math.min(k,o.y+o.height),q={x:s==="horizontal"?j.coordinate:T,y:s==="horizontal"?P:j.coordinate},de=yO({active:u.payload.active,coordinate:q,dataKey:u.payload.dataKey,index:String(j.index),label:u.payload.label,sourceViewBox:u.payload.sourceViewBox,graphicalItemId:u.payload.graphicalItemId});r(de)}}};return Aw.on(NO,c),()=>{Aw.off(NO,c)}},[l,r,e,t,n,a,s,o])}function bet(){var t=In(r8),e=In(n8),r=Us();g.useEffect(()=>{if(t==null)return Zw;var n=(a,s,o)=>{e!==o&&t===a&&r(fet(s))};return Aw.on(gz,n),()=>{Aw.off(gz,n)}},[r,e,t])}function wet(){var t=Us();g.useEffect(()=>{t(cet())},[t]),yet(),bet()}function Net(t,e,r,n,a,s){var o=In(h=>PZe(h,t,e)),l=In(n8),c=In(r8),d=In(fce),u=In(det),f=u==null?void 0:u.active,A=YP();g.useEffect(()=>{if(!f&&c!=null&&l!=null){var h=yO({active:s,coordinate:r,dataKey:o,index:a,label:typeof n=="number"?String(n):n,sourceViewBox:A,graphicalItemId:void 0});Aw.emit(NO,c,h,l)}},[f,r,o,a,n,l,c,d,s,A])}function yz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function bz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yz(Object(r),!0).forEach(function(n){Cet(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Cet(t,e,r){return(e=_et(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _et(t){var e=Eet(t,"string");return typeof e=="symbol"?e:e+""}function Eet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jet(t){return t.dataKey}function Iet(t,e){return g.isValidElement(t)?g.cloneElement(t,e):typeof t=="function"?g.createElement(t,e):g.createElement(mqe,e)}var wz=[],Pet={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Nz(t){var e,r,n=Kl(t,Pet),{active:a,allowEscapeViewBox:s,animationDuration:o,animationEasing:l,content:c,filterNull:d,isAnimationActive:u,offset:f,payloadUniqBy:A,position:h,reverseDirection:m,useTranslate3d:p,wrapperStyle:x,cursor:v,shared:y,trigger:b,defaultIndex:w,portal:I,axisId:j}=n,N=Us(),S=typeof w=="number"?String(w):w;g.useEffect(()=>{N(_Je({shared:y,trigger:b,axisId:j,active:a,defaultIndex:S}))},[N,y,b,j,a,S]);var E=YP(),B=tle(),k=vJe(y),{activeIndex:T,isActive:P}=(e=In(Y=>kZe(Y,k,b,S)))!==null&&e!==void 0?e:{},q=In(Y=>BZe(Y,k,b,S)),de=In(Y=>fde(Y,k,b,S)),ce=In(Y=>TZe(Y,k,b,S)),le=q,he=net(),ae=(r=a??P)!==null&&r!==void 0?r:!1,[Ce,De]=roe([le,ae]),O=k==="axis"?de:void 0;Net(k,b,ce,O,T,ae);var R=I??he;if(R==null||E==null||k==null)return null;var G=le??wz;ae||(G=wz),d&&G.length&&(G=$ie(G.filter(Y=>Y.value!=null&&(Y.hide!==!0||n.includeHidden)),A,jet));var M=G.length>0,K=g.createElement(wqe,{allowEscapeViewBox:s,animationDuration:o,animationEasing:l,isAnimationActive:u,active:ae,coordinate:ce,hasPayload:M,offset:f,position:h,reverseDirection:m,useTranslate3d:p,viewBox:E,wrapperStyle:x,lastBoundingBox:Ce,innerRef:De,hasPortalFromProps:!!I},Iet(c,bz(bz({},n),{},{payload:G,label:O,active:ae,activeIndex:T,coordinate:ce,accessibilityLayer:B})));return g.createElement(g.Fragment,null,$d.createPortal(K,R),ae&&g.createElement(ret,{cursor:v,tooltipEventType:k,coordinate:ce,payload:G,index:T}))}var vN=t=>null;vN.displayName="Cell";function Tet(t,e,r){return(e=Bet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bet(t){var e=ket(t,"string");return typeof e=="symbol"?e:e+""}function ket(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fet{constructor(e){Tet(this,"cache",new Map),this.maxSize=e}get(e){var r=this.cache.get(e);return r!==void 0&&(this.cache.delete(e),this.cache.set(e,r)),r}set(e,r){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(e,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function Cz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Oet(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Cz(Object(r),!0).forEach(function(n){Det(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Cz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Det(t,e,r){return(e=Ret(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ret(t){var e=Met(t,"string");return typeof e=="symbol"?e:e+""}function Met(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Let={cacheSize:2e3,enableCache:!0},vde=Oet({},Let),_z=new Fet(vde.cacheSize),Uet={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Ez="recharts_measurement_span";function Qet(t,e){var r=e.fontSize||"",n=e.fontFamily||"",a=e.fontWeight||"",s=e.fontStyle||"",o=e.letterSpacing||"",l=e.textTransform||"";return"".concat(t,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(s,"|").concat(o,"|").concat(l)}var Sz=(t,e)=>{try{var r=document.getElementById(Ez);r||(r=document.createElement("span"),r.setAttribute("id",Ez),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,Uet,e),r.textContent="".concat(t);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Wb=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||r3.isSsr)return{width:0,height:0};if(!vde.enableCache)return Sz(e,r);var n=Qet(e,r),a=_z.get(n);if(a)return a;var s=Sz(e,r);return _z.set(n,s),s},yde;function Vet(t,e,r){return(e=Het(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Het(t){var e=$et(t,"string");return typeof e=="symbol"?e:e+""}function $et(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var jz=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Iz=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Get=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Ket=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,qet={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},zet=["cm","mm","pt","pc","in","Q","px"];function Wet(t){return zet.includes(t)}var iv="NaN";function Xet(t,e){return t*qet[e]}class Fl{static parse(e){var r,[,n,a]=(r=Ket.exec(e))!==null&&r!==void 0?r:[];return n==null?Fl.NaN:new Fl(parseFloat(n),a??"")}constructor(e,r){this.num=e,this.unit=r,this.num=e,this.unit=r,Ah(e)&&(this.unit=""),r!==""&&!Get.test(r)&&(this.num=NaN,this.unit=""),Wet(r)&&(this.num=Xet(e,r),this.unit="px")}add(e){return this.unit!==e.unit?new Fl(NaN,""):new Fl(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new Fl(NaN,""):new Fl(this.num-e.num,this.unit)}multiply(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new Fl(NaN,""):new Fl(this.num*e.num,this.unit||e.unit)}divide(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new Fl(NaN,""):new Fl(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Ah(this.num)}}yde=Fl;Vet(Fl,"NaN",new yde(NaN,""));function bde(t){if(t==null||t.includes(iv))return iv;for(var e=t;e.includes("*")||e.includes("/");){var r,[,n,a,s]=(r=jz.exec(e))!==null&&r!==void 0?r:[],o=Fl.parse(n??""),l=Fl.parse(s??""),c=a==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return iv;e=e.replace(jz,c.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var d,[,u,f,A]=(d=Iz.exec(e))!==null&&d!==void 0?d:[],h=Fl.parse(u??""),m=Fl.parse(A??""),p=f==="+"?h.add(m):h.subtract(m);if(p.isNaN())return iv;e=e.replace(Iz,p.toString())}return e}var Pz=/\(([^()]*)\)/;function Yet(t){for(var e=t,r;(r=Pz.exec(e))!=null;){var[,n]=r;e=e.replace(Pz,bde(n))}return e}function Jet(t){var e=t.replace(/\s+/g,"");return e=Yet(e),e=bde(e),e}function Zet(t){try{return Jet(t)}catch{return iv}}function LT(t){var e=Zet(t.slice(5,-1));return e===iv?"":e}var ett=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],ttt=["dx","dy","angle","className","breakAll"];function CO(){return CO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},CO.apply(null,arguments)}function Tz(t,e){if(t==null)return{};var r,n,a=rtt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function rtt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var wde=/[ \f\n\r\t\v\u2028\u2029]+/,Nde=t=>{var{children:e,breakAll:r,style:n}=t;try{var a=[];vl(e)||(r?a=e.toString().split(""):a=e.toString().split(wde));var s=a.map(l=>({word:l,width:Wb(l,n).width})),o=r?0:Wb("",n).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}};function ntt(t){return t==="start"||t==="middle"||t==="end"||t==="inherit"}var Cde=(t,e,r,n)=>t.reduce((a,s)=>{var{word:o,width:l}=s,c=a[a.length-1];if(c&&l!=null&&(e==null||n||c.width+l+r<Number(e)))c.words.push(o),c.width+=l+r;else{var d={words:[o],width:l};a.push(d)}return a},[]),_de=t=>t.reduce((e,r)=>e.width>r.width?e:r),att="",Bz=(t,e,r,n,a,s,o,l)=>{var c=t.slice(0,e),d=Nde({breakAll:r,style:n,children:c+att});if(!d)return[!1,[]];var u=Cde(d.wordsWithComputedWidth,s,o,l),f=u.length>a||_de(u).width>Number(s);return[f,u]},stt=(t,e,r,n,a)=>{var{maxLines:s,children:o,style:l,breakAll:c}=t,d=On(s),u=String(o),f=Cde(e,n,r,a);if(!d||a)return f;var A=f.length>s||_de(f).width>Number(n);if(!A)return f;for(var h=0,m=u.length-1,p=0,x;h<=m&&p<=u.length-1;){var v=Math.floor((h+m)/2),y=v-1,[b,w]=Bz(u,y,c,l,s,n,r,a),[I]=Bz(u,v,c,l,s,n,r,a);if(!b&&!I&&(h=v+1),b&&I&&(m=v-1),!b&&I){x=w;break}p++}return x||f},kz=t=>{var e=vl(t)?[]:t.toString().split(wde);return[{words:e,width:void 0}]},itt=t=>{var{width:e,scaleToFit:r,children:n,style:a,breakAll:s,maxLines:o}=t;if((e||r)&&!r3.isSsr){var l,c,d=Nde({breakAll:s,children:n,style:a});if(d){var{wordsWithComputedWidth:u,spaceWidth:f}=d;l=u,c=f}else return kz(n);return stt({breakAll:s,children:n,maxLines:o,style:a},l,c,e,!!r)}return kz(n)},Ede="#808080",ott={angle:0,breakAll:!1,capHeight:"0.71em",fill:Ede,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},w3=g.forwardRef((t,e)=>{var r=Kl(t,ott),{x:n,y:a,lineHeight:s,capHeight:o,fill:l,scaleToFit:c,textAnchor:d,verticalAnchor:u}=r,f=Tz(r,ett),A=g.useMemo(()=>itt({breakAll:f.breakAll,children:f.children,maxLines:f.maxLines,scaleToFit:c,style:f.style,width:f.width}),[f.breakAll,f.children,f.maxLines,c,f.style,f.width]),{dx:h,dy:m,angle:p,className:x,breakAll:v}=f,y=Tz(f,ttt);if(!mh(n)||!mh(a)||A.length===0)return null;var b=Number(n)+(On(h)?h:0),w=Number(a)+(On(m)?m:0);if(!Ti(b)||!Ti(w))return null;var I;switch(u){case"start":I=LT("calc(".concat(o,")"));break;case"middle":I=LT("calc(".concat((A.length-1)/2," * -").concat(s," + (").concat(o," / 2))"));break;default:I=LT("calc(".concat(A.length-1," * -").concat(s,")"));break}var j=[];if(c){var N=A[0].width,{width:S}=f;j.push("scale(".concat(On(S)&&On(N)?S/N:1,")"))}return p&&j.push("rotate(".concat(p,", ").concat(b,", ").concat(w,")")),j.length&&(y.transform=j.join(" ")),g.createElement("text",CO({},Qu(y),{ref:e,x:b,y:w,className:vs("recharts-text",x),textAnchor:d,fill:l.includes("url")?Ede:l}),A.map((E,B)=>{var k=E.words.join(v?"":" ");return g.createElement("tspan",{x:b,dy:B===0?I:s,key:"".concat(k,"-").concat(B)},k)}))});w3.displayName="Text";var ltt=["labelRef"],ctt=["content"];function Fz(t,e){if(t==null)return{};var r,n,a=dtt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function dtt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Oz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function to(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Oz(Object(r),!0).forEach(function(n){utt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Oz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function utt(t,e,r){return(e=ftt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ftt(t){var e=htt(t,"string");return typeof e=="symbol"?e:e+""}function htt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qh(){return qh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},qh.apply(null,arguments)}var Sde=g.createContext(null),Att=t=>{var{x:e,y:r,upperWidth:n,lowerWidth:a,width:s,height:o,children:l}=t,c=g.useMemo(()=>({x:e,y:r,upperWidth:n,lowerWidth:a,width:s,height:o}),[e,r,n,a,s,o]);return g.createElement(Sde.Provider,{value:c},l)},jde=()=>{var t=g.useContext(Sde),e=YP();return t||Voe(e)},mtt=g.createContext(null),ptt=()=>{var t=g.useContext(mtt),e=In(gce);return t||e},gtt=t=>{var{value:e,formatter:r}=t,n=vl(t.children)?e:t.children;return typeof r=="function"?r(n):n},U8=t=>t!=null&&typeof t=="function",xtt=(t,e)=>{var r=Hl(e-t),n=Math.min(Math.abs(e-t),360);return r*n},vtt=(t,e,r,n,a)=>{var{offset:s,className:o}=t,{cx:l,cy:c,innerRadius:d,outerRadius:u,startAngle:f,endAngle:A,clockWise:h}=a,m=(d+u)/2,p=xtt(f,A),x=p>=0?1:-1,v,y;switch(e){case"insideStart":v=f+x*s,y=h;break;case"insideEnd":v=A-x*s,y=!h;break;case"end":v=A+x*s,y=h;break;default:throw new Error("Unsupported position ".concat(e))}y=p<=0?y:!y;var b=No(l,c,m,v),w=No(l,c,m,v+(y?1:-1)*359),I="M".concat(b.x,",").concat(b.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(y?0:1,`,
    `).concat(w.x,",").concat(w.y),j=vl(t.id)?tw("recharts-radial-line-"):t.id;return g.createElement("text",qh({},n,{dominantBaseline:"central",className:vs("recharts-radial-bar-label",o)}),g.createElement("defs",null,g.createElement("path",{id:j,d:I})),g.createElement("textPath",{xlinkHref:"#".concat(j)},r))},ytt=(t,e,r)=>{var{cx:n,cy:a,innerRadius:s,outerRadius:o,startAngle:l,endAngle:c}=t,d=(l+c)/2;if(r==="outside"){var{x:u,y:f}=No(n,a,o+e,d);return{x:u,y:f,textAnchor:u>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var A=(s+o)/2,{x:h,y:m}=No(n,a,A,d);return{x:h,y:m,textAnchor:"middle",verticalAnchor:"middle"}},_O=t=>"cx"in t&&On(t.cx),btt=(t,e)=>{var{parentViewBox:r,offset:n,position:a}=t,s;r!=null&&!_O(r)&&(s=r);var{x:o,y:l,upperWidth:c,lowerWidth:d,height:u}=e,f=o,A=o+(c-d)/2,h=(f+A)/2,m=(c+d)/2,p=f+c/2,x=u>=0?1:-1,v=x*n,y=x>0?"end":"start",b=x>0?"start":"end",w=c>=0?1:-1,I=w*n,j=w>0?"end":"start",N=w>0?"start":"end";if(a==="top"){var S={x:f+c/2,y:l-v,textAnchor:"middle",verticalAnchor:y};return to(to({},S),s?{height:Math.max(l-s.y,0),width:c}:{})}if(a==="bottom"){var E={x:A+d/2,y:l+u+v,textAnchor:"middle",verticalAnchor:b};return to(to({},E),s?{height:Math.max(s.y+s.height-(l+u),0),width:d}:{})}if(a==="left"){var B={x:h-I,y:l+u/2,textAnchor:j,verticalAnchor:"middle"};return to(to({},B),s?{width:Math.max(B.x-s.x,0),height:u}:{})}if(a==="right"){var k={x:h+m+I,y:l+u/2,textAnchor:N,verticalAnchor:"middle"};return to(to({},k),s?{width:Math.max(s.x+s.width-k.x,0),height:u}:{})}var T=s?{width:m,height:u}:{};return a==="insideLeft"?to({x:h+I,y:l+u/2,textAnchor:N,verticalAnchor:"middle"},T):a==="insideRight"?to({x:h+m-I,y:l+u/2,textAnchor:j,verticalAnchor:"middle"},T):a==="insideTop"?to({x:f+c/2,y:l+v,textAnchor:"middle",verticalAnchor:b},T):a==="insideBottom"?to({x:A+d/2,y:l+u-v,textAnchor:"middle",verticalAnchor:y},T):a==="insideTopLeft"?to({x:f+I,y:l+v,textAnchor:N,verticalAnchor:b},T):a==="insideTopRight"?to({x:f+c-I,y:l+v,textAnchor:j,verticalAnchor:b},T):a==="insideBottomLeft"?to({x:A+I,y:l+u-v,textAnchor:N,verticalAnchor:y},T):a==="insideBottomRight"?to({x:A+d-I,y:l+u-v,textAnchor:j,verticalAnchor:y},T):a&&typeof a=="object"&&(On(a.x)||EA(a.x))&&(On(a.y)||EA(a.y))?to({x:o+gc(a.x,m),y:l+gc(a.y,u),textAnchor:"end",verticalAnchor:"end"},T):to({x:p,y:l+u/2,textAnchor:"middle",verticalAnchor:"middle"},T)},wtt={angle:0,offset:5,zIndex:mc.label,position:"middle",textBreakAll:!1};function F0(t){var e=Kl(t,wtt),{viewBox:r,position:n,value:a,children:s,content:o,className:l="",textBreakAll:c,labelRef:d}=e,u=ptt(),f=jde(),A=n==="center"?f:u??f,h,m,p;if(r==null?h=A:_O(r)?h=r:h=Voe(r),!h||vl(a)&&vl(s)&&!g.isValidElement(o)&&typeof o!="function")return null;var x=to(to({},e),{},{viewBox:h});if(g.isValidElement(o)){var{labelRef:v}=x,y=Fz(x,ltt);return g.cloneElement(o,y)}if(typeof o=="function"){var{content:b}=x,w=Fz(x,ctt);if(m=g.createElement(o,w),g.isValidElement(m))return m}else m=gtt(e);var I=Qu(e);if(_O(h)){if(n==="insideStart"||n==="insideEnd"||n==="end")return vtt(e,n,m,I,h);p=ytt(h,e.offset,e.position)}else p=btt(e,h);return g.createElement(Nh,{zIndex:e.zIndex},g.createElement(w3,qh({ref:d,className:vs("recharts-label",l)},I,p,{textAnchor:ntt(I.textAnchor)?I.textAnchor:p.textAnchor,breakAll:c}),m))}F0.displayName="Label";var Ntt=(t,e,r)=>{if(!t)return null;var n={viewBox:e,labelRef:r};return t===!0?g.createElement(F0,qh({key:"label-implicit"},n)):mh(t)?g.createElement(F0,qh({key:"label-implicit",value:t},n)):g.isValidElement(t)?t.type===F0?g.cloneElement(t,to({key:"label-implicit"},n)):g.createElement(F0,qh({key:"label-implicit",content:t},n)):U8(t)?g.createElement(F0,qh({key:"label-implicit",content:t},n)):t&&typeof t=="object"?g.createElement(F0,qh({},t,{key:"label-implicit"},n)):null};function Ctt(t){var{label:e,labelRef:r}=t,n=jde();return Ntt(e,n,r)||null}var Ide={},Pde={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r[r.length-1]}t.last=e})(Pde);var Tde={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Array.isArray(r)?r:Array.from(r)}t.toArray=e})(Tde);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Pde,r=Tde,n=FP;function a(s){if(n.isArrayLike(s))return e.last(r.toArray(s))}t.last=a})(Ide);var _tt=Ide.last;const Ett=kA(_tt);var Stt=["valueAccessor"],jtt=["dataKey","clockWise","id","textBreakAll","zIndex"];function Zj(){return Zj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Zj.apply(null,arguments)}function Dz(t,e){if(t==null)return{};var r,n,a=Itt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Itt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Ptt=t=>Array.isArray(t.value)?Ett(t.value):t.value,Bde=g.createContext(void 0),Ttt=Bde.Provider,kde=g.createContext(void 0),Btt=kde.Provider;function ktt(){return g.useContext(Bde)}function Ftt(){return g.useContext(kde)}function kE(t){var{valueAccessor:e=Ptt}=t,r=Dz(t,Stt),{dataKey:n,clockWise:a,id:s,textBreakAll:o,zIndex:l}=r,c=Dz(r,jtt),d=ktt(),u=Ftt(),f=d||u;return!f||!f.length?null:g.createElement(Nh,{zIndex:l??mc.label},g.createElement($c,{className:"recharts-label-list"},f.map((A,h)=>{var m,p=vl(n)?e(A,h):Js(A&&A.payload,n),x=vl(s)?{}:{id:"".concat(s,"-").concat(h)};return g.createElement(F0,Zj({key:"label-".concat(h)},Qu(A),c,x,{fill:(m=r.fill)!==null&&m!==void 0?m:A.fill,parentViewBox:A.parentViewBox,value:p,textBreakAll:o,viewBox:A.viewBox,index:h,zIndex:0}))})))}kE.displayName="LabelList";function Fde(t){var{label:e}=t;return e?e===!0?g.createElement(kE,{key:"labelList-implicit"}):g.isValidElement(e)||U8(e)?g.createElement(kE,{key:"labelList-implicit",content:e}):typeof e=="object"?g.createElement(kE,Zj({key:"labelList-implicit"},e,{type:String(e.type)})):null:null}var Ode=t=>t.graphicalItems.polarItems,Ott=Zt([pi,uN],c8),N3=Zt([Ode,Bi,Ott],u8),Dtt=Zt([N3],f8),C3=Zt([Dtt,u3],h8),Rtt=Zt([C3,Bi,N3],m8);Zt([C3,Bi,N3],(t,e,r)=>r.length>0?t.flatMap(n=>r.flatMap(a=>{var s,o=Js(n,(s=e.dataKey)!==null&&s!==void 0?s:a.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):(e==null?void 0:e.dataKey)!=null?t.map(n=>({value:Js(n,e.dataKey),errorDomain:[]})):t.map(n=>({value:n,errorDomain:[]})));var Rz=()=>{},Mtt=Zt([C3,Bi,N3,x3,pi],v8),Ltt=Zt([Bi,g8,x8,Rz,Mtt,Rz,za,pi],y8),Dde=Zt([Bi,za,C3,Rtt,dN,pi,Ltt],b8),Utt=Zt([Dde,Bi,R1],C8);Zt([Bi,Dde,Utt,pi],E8);var Qtt={radiusAxis:{},angleAxis:{}},Rde=xd({name:"polarAxis",initialState:Qtt,reducers:{addRadiusAxis(t,e){t.radiusAxis[e.payload.id]=e.payload},removeRadiusAxis(t,e){delete t.radiusAxis[e.payload.id]},addAngleAxis(t,e){t.angleAxis[e.payload.id]=e.payload},removeAngleAxis(t,e){delete t.angleAxis[e.payload.id]}}}),{addRadiusAxis:Aot,removeRadiusAxis:mot,addAngleAxis:pot,removeAngleAxis:got}=Rde.actions,Vtt=Rde.reducer;function Mz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Lz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Mz(Object(r),!0).forEach(function(n){Htt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Mz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Htt(t,e,r){return(e=$tt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $tt(t){var e=Gtt(t,"string");return typeof e=="symbol"?e:e+""}function Gtt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ktt=(t,e)=>e,Q8=Zt([Ode,Ktt],(t,e)=>t.filter(r=>r.type==="pie").find(r=>r.id===e)),qtt=[],V8=(t,e,r)=>(r==null?void 0:r.length)===0?qtt:r,Mde=Zt([u3,Q8,V8],(t,e,r)=>{var{chartData:n}=t;if(e!=null){var a;if((e==null?void 0:e.data)!=null&&e.data.length>0?a=e.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(s=>Lz(Lz({},e.presentationProps),s.props))),a!=null)return a}}),ztt=Zt([Mde,Q8,V8],(t,e,r)=>{if(!(t==null||e==null))return t.map((n,a)=>{var s,o=Js(n,e.nameKey,e.name),l;return r!=null&&(s=r[a])!==null&&s!==void 0&&(s=s.props)!==null&&s!==void 0&&s.fill?l=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=e.fill,{value:KP(o,e.dataKey),color:l,payload:n,type:e.legendType}})}),Wtt=Zt([Mde,Q8,V8,Wo],(t,e,r,n)=>{if(!(e==null||t==null))return Yrt({offset:n,pieSettings:e,displayedData:t,cells:r})}),Lde={exports:{}},Bs={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H8=Symbol.for("react.transitional.element"),$8=Symbol.for("react.portal"),_3=Symbol.for("react.fragment"),E3=Symbol.for("react.strict_mode"),S3=Symbol.for("react.profiler"),j3=Symbol.for("react.consumer"),I3=Symbol.for("react.context"),P3=Symbol.for("react.forward_ref"),T3=Symbol.for("react.suspense"),B3=Symbol.for("react.suspense_list"),k3=Symbol.for("react.memo"),F3=Symbol.for("react.lazy"),Xtt=Symbol.for("react.view_transition"),Ytt=Symbol.for("react.client.reference");function zu(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case H8:switch(t=t.type,t){case _3:case S3:case E3:case T3:case B3:case Xtt:return t;default:switch(t=t&&t.$$typeof,t){case I3:case P3:case F3:case k3:return t;case j3:return t;default:return e}}case $8:return e}}}Bs.ContextConsumer=j3;Bs.ContextProvider=I3;Bs.Element=H8;Bs.ForwardRef=P3;Bs.Fragment=_3;Bs.Lazy=F3;Bs.Memo=k3;Bs.Portal=$8;Bs.Profiler=S3;Bs.StrictMode=E3;Bs.Suspense=T3;Bs.SuspenseList=B3;Bs.isContextConsumer=function(t){return zu(t)===j3};Bs.isContextProvider=function(t){return zu(t)===I3};Bs.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===H8};Bs.isForwardRef=function(t){return zu(t)===P3};Bs.isFragment=function(t){return zu(t)===_3};Bs.isLazy=function(t){return zu(t)===F3};Bs.isMemo=function(t){return zu(t)===k3};Bs.isPortal=function(t){return zu(t)===$8};Bs.isProfiler=function(t){return zu(t)===S3};Bs.isStrictMode=function(t){return zu(t)===E3};Bs.isSuspense=function(t){return zu(t)===T3};Bs.isSuspenseList=function(t){return zu(t)===B3};Bs.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===_3||t===S3||t===E3||t===T3||t===B3||typeof t=="object"&&t!==null&&(t.$$typeof===F3||t.$$typeof===k3||t.$$typeof===I3||t.$$typeof===j3||t.$$typeof===P3||t.$$typeof===Ytt||t.getModuleId!==void 0)};Bs.typeOf=zu;Lde.exports=Bs;var Jtt=Lde.exports,Uz=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",Qz=null,UT=null,Ude=t=>{if(t===Qz&&Array.isArray(UT))return UT;var e=[];return g.Children.forEach(t,r=>{vl(r)||(Jtt.isFragment(r)?e=e.concat(Ude(r.props.children)):e.push(r))}),UT=e,Qz=t,e};function G8(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(a=>Uz(a)):n=[Uz(e)],Ude(t).forEach(a=>{var s=_g(a,"type.displayName")||_g(a,"type.name");s&&n.indexOf(s)!==-1&&r.push(a)}),r}var Qde={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){var a;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const s=r[Symbol.toStringTag];return s==null||!((a=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&a.writable)?!1:r.toString()===`[object ${s}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}t.isPlainObject=e})(Qde);var Ztt=Qde.isPlainObject;const ert=kA(Ztt);var Vz,Hz,$z,Gz,Kz;function qz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function zz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qz(Object(r),!0).forEach(function(n){trt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function trt(t,e,r){return(e=rrt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rrt(t){var e=nrt(t,"string");return typeof e=="symbol"?e:e+""}function nrt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eI(){return eI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},eI.apply(null,arguments)}function My(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var Wz=(t,e,r,n,a)=>{var s=r-n,o;return o=Mi(Vz||(Vz=My(["M ",",",""])),t,e),o+=Mi(Hz||(Hz=My(["L ",",",""])),t+r,e),o+=Mi($z||($z=My(["L ",",",""])),t+r-s/2,e+a),o+=Mi(Gz||(Gz=My(["L ",",",""])),t+r-s/2-n,e+a),o+=Mi(Kz||(Kz=My(["L ",","," Z"])),t,e),o},art={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},srt=t=>{var e=Kl(t,art),{x:r,y:n,upperWidth:a,lowerWidth:s,height:o,className:l}=e,{animationEasing:c,animationDuration:d,animationBegin:u,isUpdateAnimationActive:f}=e,A=g.useRef(null),[h,m]=g.useState(-1),p=g.useRef(a),x=g.useRef(s),v=g.useRef(o),y=g.useRef(r),b=g.useRef(n),w=a3(t,"trapezoid-");if(g.useEffect(()=>{if(A.current&&A.current.getTotalLength)try{var q=A.current.getTotalLength();q&&m(q)}catch{}},[]),r!==+r||n!==+n||a!==+a||s!==+s||o!==+o||a===0&&s===0||o===0)return null;var I=vs("recharts-trapezoid",l);if(!f)return g.createElement("g",null,g.createElement("path",eI({},Qu(e),{className:I,d:Wz(r,n,a,s,o)})));var j=p.current,N=x.current,S=v.current,E=y.current,B=b.current,k="0px ".concat(h===-1?1:h,"px"),T="".concat(h,"px 0px"),P=rle(["strokeDasharray"],d,c);return g.createElement(n3,{animationId:w,key:w,canBegin:h>0,duration:d,easing:c,isActive:f,begin:u},q=>{var de=Mo(j,a,q),ce=Mo(N,s,q),le=Mo(S,o,q),he=Mo(E,r,q),ae=Mo(B,n,q);A.current&&(p.current=de,x.current=ce,v.current=le,y.current=he,b.current=ae);var Ce=q>0?{transition:P,strokeDasharray:T}:{strokeDasharray:k};return g.createElement("path",eI({},Qu(e),{className:I,d:Wz(he,ae,de,ce,le),ref:A,style:zz(zz({},Ce),e.style)}))})},irt=["option","shapeType","activeClassName"];function ort(t,e){if(t==null)return{};var r,n,a=lrt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function lrt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Xz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function tI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Xz(Object(r),!0).forEach(function(n){crt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Xz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function crt(t,e,r){return(e=drt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function drt(t){var e=urt(t,"string");return typeof e=="symbol"?e:e+""}function urt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function frt(t,e){return tI(tI({},e),t)}function hrt(t,e){return t==="symbols"}function Yz(t){var{shapeType:e,elementProps:r}=t;switch(e){case"rectangle":return g.createElement(ile,r);case"trapezoid":return g.createElement(srt,r);case"sector":return g.createElement(dle,r);case"symbols":if(hrt(e))return g.createElement(iM,r);break;case"curve":return g.createElement(IM,r);default:return null}}function Art(t){return g.isValidElement(t)?t.props:t}function Vde(t){var{option:e,shapeType:r,activeClassName:n="recharts-active-shape"}=t,a=ort(t,irt),s;if(g.isValidElement(e))s=g.cloneElement(e,tI(tI({},a),Art(e)));else if(typeof e=="function")s=e(a,a.index);else if(ert(e)&&typeof e!="boolean"){var o=frt(e,a);s=g.createElement(Yz,{shapeType:r,elementProps:o})}else{var l=a;s=g.createElement(Yz,{shapeType:r,elementProps:l})}return a.isActive?g.createElement($c,{className:n},s):s}var K8=(t,e,r)=>{var n=Us();return(a,s)=>o=>{t==null||t(a,s,o),n(zce({activeIndex:String(s),activeDataKey:e,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}},q8=t=>{var e=Us();return(r,n)=>a=>{t==null||t(r,n,a),e(EJe())}},z8=(t,e,r)=>{var n=Us();return(a,s)=>o=>{t==null||t(a,s,o),n(SJe({activeIndex:String(s),activeDataKey:e,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}};function Hde(t){var{tooltipEntrySettings:e}=t,r=Us(),n=Zd(),a=g.useRef(null);return g.useLayoutEffect(()=>{n||(a.current===null?r(wJe(e)):a.current!==e&&r(NJe({prev:a.current,next:e})),a.current=e)},[e,r,n]),g.useLayoutEffect(()=>()=>{a.current&&(r(CJe(a.current)),a.current=null)},[r]),null}function mrt(t){var{legendPayload:e}=t,r=Us(),n=Zd(),a=g.useRef(null);return g.useLayoutEffect(()=>{n||(a.current===null?r(Joe(e)):a.current!==e&&r(Zoe({prev:a.current,next:e})),a.current=e)},[r,n,e]),g.useLayoutEffect(()=>()=>{a.current&&(r(ele(a.current)),a.current=null)},[r]),null}function prt(t){var{legendPayload:e}=t,r=Us(),n=In(za),a=g.useRef(null);return g.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(a.current===null?r(Joe(e)):a.current!==e&&r(Zoe({prev:a.current,next:e})),a.current=e)},[r,n,e]),g.useLayoutEffect(()=>()=>{a.current&&(r(ele(a.current)),a.current=null)},[r]),null}var QT,grt=()=>{var[t]=g.useState(()=>tw("uid-"));return t},xrt=(QT=_fe.useId)!==null&&QT!==void 0?QT:grt;function vrt(t,e){var r=xrt();return e||(t?"".concat(t,"-").concat(r):r)}var yrt=g.createContext(void 0),$de=t=>{var{id:e,type:r,children:n}=t,a=vrt("recharts-".concat(r),e);return g.createElement(yrt.Provider,{value:a},n(a))},brt={cartesianItems:[],polarItems:[]},Gde=xd({name:"graphicalItems",initialState:brt,reducers:{addCartesianGraphicalItem:{reducer(t,e){t.cartesianItems.push(e.payload)},prepare:ii()},replaceCartesianGraphicalItem:{reducer(t,e){var{prev:r,next:n}=e.payload,a=_f(t).cartesianItems.indexOf(r);a>-1&&(t.cartesianItems[a]=n)},prepare:ii()},removeCartesianGraphicalItem:{reducer(t,e){var r=_f(t).cartesianItems.indexOf(e.payload);r>-1&&t.cartesianItems.splice(r,1)},prepare:ii()},addPolarGraphicalItem:{reducer(t,e){t.polarItems.push(e.payload)},prepare:ii()},removePolarGraphicalItem:{reducer(t,e){var r=_f(t).polarItems.indexOf(e.payload);r>-1&&t.polarItems.splice(r,1)},prepare:ii()}}}),{addCartesianGraphicalItem:wrt,replaceCartesianGraphicalItem:Nrt,removeCartesianGraphicalItem:Crt,addPolarGraphicalItem:_rt,removePolarGraphicalItem:Ert}=Gde.actions,Srt=Gde.reducer,jrt=t=>{var e=Us(),r=g.useRef(null);return g.useLayoutEffect(()=>{r.current===null?e(wrt(t)):r.current!==t&&e(Nrt({prev:r.current,next:t})),r.current=t},[e,t]),g.useLayoutEffect(()=>()=>{r.current&&(e(Crt(r.current)),r.current=null)},[e]),null},Irt=g.memo(jrt);function Prt(t){var e=Us();return g.useLayoutEffect(()=>(e(_rt(t)),()=>{e(Ert(t))}),[e,t]),null}var Trt=["key"],Brt=["onMouseEnter","onClick","onMouseLeave"],krt=["id"],Frt=["id"];function Jz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Qi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Jz(Object(r),!0).forEach(function(n){Ort(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Jz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ort(t,e,r){return(e=Drt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Drt(t){var e=Rrt(t,"string");return typeof e=="symbol"?e:e+""}function Rrt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rm(){return Rm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Rm.apply(null,arguments)}function O3(t,e){if(t==null)return{};var r,n,a=Mrt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Mrt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Lrt(t){var e=g.useMemo(()=>G8(t.children,vN),[t.children]),r=In(n=>ztt(n,t.id,e));return r==null?null:g.createElement(prt,{legendPayload:r})}var Urt=g.memo(t=>{var{dataKey:e,nameKey:r,sectors:n,stroke:a,strokeWidth:s,fill:o,name:l,hide:c,tooltipType:d,id:u}=t,f={dataDefinedOnItem:n.map(A=>A.tooltipPayload),positions:n.map(A=>A.tooltipPosition),settings:{stroke:a,strokeWidth:s,fill:o,dataKey:e,nameKey:r,name:KP(l,e),hide:c,type:d,color:o,unit:"",graphicalItemId:u}};return g.createElement(Hde,{tooltipEntrySettings:f})}),Qrt=(t,e)=>t>e?"start":t<e?"end":"middle",Vrt=(t,e,r)=>gc(typeof e=="function"?e(t):e,r,r*.8),Hrt=(t,e,r)=>{var{top:n,left:a,width:s,height:o}=e,l=ole(s,o),c=a+gc(t.cx,s,s/2),d=n+gc(t.cy,o,o/2),u=gc(t.innerRadius,l,0),f=Vrt(r,t.outerRadius,l),A=t.maxRadius||Math.sqrt(s*s+o*o)/2;return{cx:c,cy:d,innerRadius:u,outerRadius:f,maxRadius:A}},$rt=(t,e)=>{var r=Hl(e-t),n=Math.min(Math.abs(e-t),360);return r*n};function Grt(t){return t&&typeof t=="object"&&"className"in t&&typeof t.className=="string"?t.className:""}var Krt=(t,e)=>{if(g.isValidElement(t))return g.cloneElement(t,e);if(typeof t=="function")return t(e);var r=vs("recharts-pie-label-line",typeof t!="boolean"?t.className:""),{key:n}=e,a=O3(e,Trt);return g.createElement(IM,Rm({},a,{type:"linear",className:r}))},qrt=(t,e,r)=>{if(g.isValidElement(t))return g.cloneElement(t,e);var n=r;if(typeof t=="function"&&(n=t(e),g.isValidElement(n)))return n;var a=vs("recharts-pie-label-text",Grt(t));return g.createElement(w3,Rm({},e,{alignmentBaseline:"middle",className:a}),n)};function zrt(t){var{sectors:e,props:r,showLabels:n}=t,{label:a,labelLine:s,dataKey:o}=r;if(!n||!a||!e)return null;var l=hh(r),c=ew(a),d=ew(s),u=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,f=e.map((A,h)=>{var m=(A.startAngle+A.endAngle)/2,p=No(A.cx,A.cy,A.outerRadius+u,m),x=Qi(Qi(Qi(Qi({},l),A),{},{stroke:"none"},c),{},{index:h,textAnchor:Qrt(p.x,A.cx)},p),v=Qi(Qi(Qi(Qi({},l),A),{},{fill:"none",stroke:A.fill},d),{},{index:h,points:[No(A.cx,A.cy,A.outerRadius,m),p],key:"line"});return g.createElement(Nh,{zIndex:mc.label,key:"label-".concat(A.startAngle,"-").concat(A.endAngle,"-").concat(A.midAngle,"-").concat(h)},g.createElement($c,null,s&&Krt(s,v),qrt(a,x,Js(A,o))))});return g.createElement($c,{className:"recharts-pie-labels"},f)}function Wrt(t){var{sectors:e,props:r,showLabels:n}=t,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?g.createElement(Fde,{label:a}):g.createElement(zrt,{sectors:e,props:r,showLabels:n})}function Xrt(t){var{sectors:e,activeShape:r,inactiveShape:n,allOtherPieProps:a,shape:s,id:o}=t,l=In(Pg),c=In(O8),d=In(fZe),{onMouseEnter:u,onClick:f,onMouseLeave:A}=a,h=O3(a,Brt),m=K8(u,a.dataKey,o),p=q8(A),x=z8(f,a.dataKey,o);return e==null||e.length===0?null:g.createElement(g.Fragment,null,e.map((v,y)=>{if((v==null?void 0:v.startAngle)===0&&(v==null?void 0:v.endAngle)===0&&e.length!==1)return null;var b=d==null||d===o,w=String(y)===l&&(c==null||a.dataKey===c)&&b,I=l?n:null,j=r&&w?r:I,N=Qi(Qi({},v),{},{stroke:v.stroke,tabIndex:-1,[Foe]:y,[Ooe]:o});return g.createElement($c,Rm({key:"sector-".concat(v==null?void 0:v.startAngle,"-").concat(v==null?void 0:v.endAngle,"-").concat(v.midAngle,"-").concat(y),tabIndex:-1,className:"recharts-pie-sector"},eN(h,v,y),{onMouseEnter:m(v,y),onMouseLeave:p(v,y),onClick:x(v,y)}),g.createElement(Vde,Rm({option:s??j,index:y,shapeType:"sector",isActive:w},N)))}))}function Yrt(t){var e,{pieSettings:r,displayedData:n,cells:a,offset:s}=t,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:d,nameKey:u,tooltipType:f}=r,A=Math.abs(r.minAngle),h=$rt(l,c),m=Math.abs(h),p=n.length<=1?0:(e=r.paddingAngle)!==null&&e!==void 0?e:0,x=n.filter(j=>Js(j,d,0)!==0).length,v=(m>=360?x:x-1)*p,y=m-x*A-v,b=n.reduce((j,N)=>{var S=Js(N,d,0);return j+(On(S)?S:0)},0),w;if(b>0){var I;w=n.map((j,N)=>{var S=Js(j,d,0),E=Js(j,u,N),B=Hrt(r,s,j),k=(On(S)?S:0)/b,T,P=Qi(Qi({},j),a&&a[N]&&a[N].props);N?T=I.endAngle+Hl(h)*p*(S!==0?1:0):T=l;var q=T+Hl(h)*((S!==0?A:0)+k*y),de=(T+q)/2,ce=(B.innerRadius+B.outerRadius)/2,le=[{name:E,value:S,payload:P,dataKey:d,type:f,graphicalItemId:r.id}],he=No(B.cx,B.cy,ce,de);return I=Qi(Qi(Qi(Qi({},r.presentationProps),{},{percent:k,cornerRadius:typeof o=="string"?parseFloat(o):o,name:E,tooltipPayload:le,midAngle:de,middleRadius:ce,tooltipPosition:he},P),B),{},{value:S,dataKey:d,startAngle:T,endAngle:q,payload:P,paddingAngle:Hl(h)*p}),I})}return w}function Jrt(t){var{showLabels:e,sectors:r,children:n}=t,a=g.useMemo(()=>!e||!r?[]:r.map(s=>({value:s.value,payload:s.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:s.cx,cy:s.cy,innerRadius:s.innerRadius,outerRadius:s.outerRadius,startAngle:s.startAngle,endAngle:s.endAngle,clockWise:!1},fill:s.fill})),[r,e]);return g.createElement(Btt,{value:e?a:void 0},n)}function Zrt(t){var{props:e,previousSectorsRef:r,id:n}=t,{sectors:a,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,activeShape:d,inactiveShape:u,onAnimationStart:f,onAnimationEnd:A}=e,h=a3(e,"recharts-pie-"),m=r.current,[p,x]=g.useState(!1),v=g.useCallback(()=>{typeof A=="function"&&A(),x(!1)},[A]),y=g.useCallback(()=>{typeof f=="function"&&f(),x(!0)},[f]);return g.createElement(Jrt,{showLabels:!p,sectors:a},g.createElement(n3,{animationId:h,begin:o,duration:l,isActive:s,easing:c,onAnimationStart:y,onAnimationEnd:v,key:h},b=>{var w=[],I=a&&a[0],j=I==null?void 0:I.startAngle;return a==null||a.forEach((N,S)=>{var E=m&&m[S],B=S>0?_g(N,"paddingAngle",0):0;if(E){var k=Mo(E.endAngle-E.startAngle,N.endAngle-N.startAngle,b),T=Qi(Qi({},N),{},{startAngle:j+B,endAngle:j+k+B});w.push(T),j=T.endAngle}else{var{endAngle:P,startAngle:q}=N,de=Mo(0,P-q,b),ce=Qi(Qi({},N),{},{startAngle:j+B,endAngle:j+de+B});w.push(ce),j=ce.endAngle}}),r.current=w,g.createElement($c,null,g.createElement(Xrt,{sectors:w,activeShape:d,inactiveShape:u,allOtherPieProps:e,shape:e.shape,id:n}))}),g.createElement(Wrt,{showLabels:!p,sectors:a,props:e}),e.children)}var ent={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:mc.area};function tnt(t){var{id:e}=t,r=O3(t,krt),{hide:n,className:a,rootTabIndex:s}=t,o=g.useMemo(()=>G8(t.children,vN),[t.children]),l=In(u=>Wtt(u,e,o)),c=g.useRef(null),d=vs("recharts-pie",a);return n||l==null?(c.current=null,g.createElement($c,{tabIndex:s,className:d})):g.createElement(Nh,{zIndex:t.zIndex},g.createElement(Urt,{dataKey:t.dataKey,nameKey:t.nameKey,sectors:l,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,tooltipType:t.tooltipType,id:e}),g.createElement($c,{tabIndex:s,className:d},g.createElement(Zrt,{props:Qi(Qi({},r),{},{sectors:l}),previousSectorsRef:c,id:e})))}function Kde(t){var e=Kl(t,ent),{id:r}=e,n=O3(e,Frt),a=hh(n);return g.createElement($de,{id:r,type:"pie"},s=>g.createElement(g.Fragment,null,g.createElement(Prt,{type:"pie",id:s,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:e.maxRadius}),g.createElement(Lrt,Rm({},n,{id:s})),g.createElement(tnt,Rm({},n,{id:s}))))}Kde.displayName="Pie";function Zz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function eW(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Zz(Object(r),!0).forEach(function(n){rnt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Zz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function rnt(t,e,r){return(e=nnt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nnt(t){var e=ant(t,"string");return typeof e=="symbol"?e:e+""}function ant(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var qde=0,snt={xAxis:{},yAxis:{},zAxis:{}},zde=xd({name:"cartesianAxis",initialState:snt,reducers:{addXAxis:{reducer(t,e){t.xAxis[e.payload.id]=e.payload},prepare:ii()},replaceXAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.xAxis[r.id],t.xAxis[n.id]=n)},prepare:ii()},removeXAxis:{reducer(t,e){delete t.xAxis[e.payload.id]},prepare:ii()},addYAxis:{reducer(t,e){t.yAxis[e.payload.id]=e.payload},prepare:ii()},replaceYAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.yAxis[r.id],t.yAxis[n.id]=n)},prepare:ii()},removeYAxis:{reducer(t,e){delete t.yAxis[e.payload.id]},prepare:ii()},addZAxis:{reducer(t,e){t.zAxis[e.payload.id]=e.payload},prepare:ii()},replaceZAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.zAxis[r.id],t.zAxis[n.id]=n)},prepare:ii()},removeZAxis:{reducer(t,e){delete t.zAxis[e.payload.id]},prepare:ii()},updateYAxisWidth(t,e){var{id:r,width:n}=e.payload,a=t.yAxis[r];if(a){var s=a.widthHistory||[];if(s.length===3&&s[0]===s[2]&&n===s[1]&&n!==a.width&&Math.abs(n-s[0])<=1)return;var o=[...s,n].slice(-3);t.yAxis[r]=eW(eW({},t.yAxis[r]),{},{width:n,widthHistory:o})}}}}),{addXAxis:int,replaceXAxis:ont,removeXAxis:lnt,addYAxis:cnt,replaceYAxis:dnt,removeYAxis:unt,addZAxis:xot,replaceZAxis:vot,removeZAxis:yot,updateYAxisWidth:fnt}=zde.actions,hnt=zde.reducer,Ant=Zt([Wo],t=>({top:t.top,bottom:t.bottom,left:t.left,right:t.right})),mnt=Zt([Ant,HA,$A],(t,e,r)=>{if(!(!t||e==null||r==null))return{x:t.left,y:t.top,width:Math.max(0,e-t.left-t.right),height:Math.max(0,r-t.top-t.bottom)}}),Wde=()=>In(mnt),tW=(t,e,r)=>{var n=r??t;if(!vl(n))return gc(n,e,0)},pnt=(t,e,r)=>{var n={},a=t.filter(A3),s=t.filter(d=>d.stackId==null),o=a.reduce((d,u)=>(d[u.stackId]||(d[u.stackId]=[]),d[u.stackId].push(u),d),n),l=Object.entries(o).map(d=>{var[u,f]=d,A=f.map(m=>m.dataKey),h=tW(e,r,f[0].barSize);return{stackId:u,dataKeys:A,barSize:h}}),c=s.map(d=>{var u=[d.dataKey].filter(A=>A!=null),f=tW(e,r,d.barSize);return{stackId:void 0,dataKeys:u,barSize:f}});return[...l,...c]};function rW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function R_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rW(Object(r),!0).forEach(function(n){gnt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function gnt(t,e,r){return(e=xnt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xnt(t){var e=vnt(t,"string");return typeof e=="symbol"?e:e+""}function vnt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ynt(t,e,r,n,a){var s=n.length;if(!(s<1)){var o=gc(t,r,0,!0),l,c=[];if(Ti(n[0].barSize)){var d=!1,u=r/s,f=n.reduce((v,y)=>v+(y.barSize||0),0);f+=(s-1)*o,f>=r&&(f-=(s-1)*o,o=0),f>=r&&u>0&&(d=!0,u*=.9,f=s*u);var A=(r-f)/2>>0,h={offset:A-o,size:0};l=n.reduce((v,y)=>{var b,w={stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:h.offset+h.size+o,size:d?u:(b=y.barSize)!==null&&b!==void 0?b:0}},I=[...v,w];return h=I[I.length-1].position,I},c)}else{var m=gc(e,r,0,!0);r-2*m-(s-1)*o<=0&&(o=0);var p=(r-2*m-(s-1)*o)/s;p>1&&(p>>=0);var x=Ti(a)?Math.min(p,a):p;l=n.reduce((v,y,b)=>[...v,{stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:m+(p+o)*b+(p-x)/2,size:x}}],c)}return l}}var bnt=(t,e,r,n,a,s,o)=>{var l=vl(o)?e:o,c=ynt(r,n,a!==s?a:s,t,l);return a!==s&&c!=null&&(c=c.map(d=>R_(R_({},d),{},{position:R_(R_({},d.position),{},{offset:d.position.offset-a/2})}))),c},wnt=(t,e)=>{var r=o8(e);if(!(!t||r==null||e==null)){var{stackId:n}=e;if(n!=null){var a=t[n];if(a){var{stackedData:s}=a;if(s)return s.find(o=>o.key===r)}}}};function Nnt(t,e){return t&&typeof t=="object"&&"zIndex"in t&&typeof t.zIndex=="number"&&Ti(t.zIndex)?t.zIndex:e}var Xde=t=>{var{chartData:e}=t,r=Us(),n=Zd();return g.useEffect(()=>n?()=>{}:(r(xz(e)),()=>{r(xz(void 0))}),[e,r,n]),null},nW={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},Yde=xd({name:"brush",initialState:nW,reducers:{setBrushSettings(t,e){return e.payload==null?nW:e.payload}}}),{setBrushSettings:bot}=Yde.actions,Cnt=Yde.reducer;function _nt(t,e,r){return(e=Ent(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ent(t){var e=Snt(t,"string");return typeof e=="symbol"?e:e+""}function Snt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class W8{static create(e){return new W8(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e!==void 0){if(n)switch(n){case"start":return this.scale(e);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+a}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(e)+s}default:return this.scale(e)}if(r){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+o}return this.scale(e)}}isInRange(e){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?e>=n&&e<=a:e>=a&&e<=n}}_nt(W8,"EPS",1e-4);function jnt(t){return(t%180+180)%180}var Int=function(e){var{width:r,height:n}=e,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=jnt(a),o=s*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},Pnt={dots:[],areas:[],lines:[]},Jde=xd({name:"referenceElements",initialState:Pnt,reducers:{addDot:(t,e)=>{t.dots.push(e.payload)},removeDot:(t,e)=>{var r=_f(t).dots.findIndex(n=>n===e.payload);r!==-1&&t.dots.splice(r,1)},addArea:(t,e)=>{t.areas.push(e.payload)},removeArea:(t,e)=>{var r=_f(t).areas.findIndex(n=>n===e.payload);r!==-1&&t.areas.splice(r,1)},addLine:(t,e)=>{t.lines.push(e.payload)},removeLine:(t,e)=>{var r=_f(t).lines.findIndex(n=>n===e.payload);r!==-1&&t.lines.splice(r,1)}}}),{addDot:wot,removeDot:Not,addArea:Cot,removeArea:_ot,addLine:Eot,removeLine:Sot}=Jde.actions,Tnt=Jde.reducer,Bnt=g.createContext(void 0),knt=t=>{var{children:e}=t,[r]=g.useState("".concat(tw("recharts"),"-clip")),n=Wde();if(n==null)return null;var{x:a,y:s,width:o,height:l}=n;return g.createElement(Bnt.Provider,{value:r},g.createElement("defs",null,g.createElement("clipPath",{id:r},g.createElement("rect",{x:a,y:s,height:l,width:o}))),e)};function Zde(t,e){if(e<1)return[];if(e===1)return t;for(var r=[],n=0;n<t.length;n+=e){var a=t[n];a!==void 0&&r.push(a)}return r}function Fnt(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return Int(n,r)}function Ont(t,e,r){var n=r==="width",{x:a,y:s,width:o,height:l}=t;return e===1?{start:n?a:s,end:n?a+o:s+l}:{start:n?a+o:s+l,end:n?a:s}}function mw(t,e,r,n,a){if(t*e<t*n||t*e>t*a)return!1;var s=r();return t*(e-t*s/2-n)>=0&&t*(e+t*s/2-a)<=0}function Dnt(t,e){return Zde(t,e+1)}function Rnt(t,e,r,n,a){for(var s=(n||[]).slice(),{start:o,end:l}=e,c=0,d=1,u=o,f=function(){var m=n==null?void 0:n[c];if(m===void 0)return{v:Zde(n,d)};var p=c,x,v=()=>(x===void 0&&(x=r(m,p)),x),y=m.coordinate,b=c===0||mw(t,y,v,u,l);b||(c=0,u=o,d+=1),b&&(u=y+t*(v()/2+a),c+=d)},A;d<=s.length;)if(A=f(),A)return A.v;return[]}function Mnt(t,e,r,n,a){var s=(n||[]).slice(),o=s.length;if(o===0)return[];for(var{start:l,end:c}=e,d=1;d<=o;d++){for(var u=(o-1)%d,f=l,A=!0,h=function(){var y=n[m],b=m,w,I=()=>(w===void 0&&(w=r(y,b)),w),j=y.coordinate,N=m===u||mw(t,j,I,f,c);if(!N)return A=!1,1;N&&(f=j+t*(I()/2+a))},m=u;m<o&&!h();m+=d);if(A){for(var p=[],x=u;x<o;x+=d)p.push(n[x]);return p}}return[]}function aW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function lc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?aW(Object(r),!0).forEach(function(n){Lnt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):aW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Lnt(t,e,r){return(e=Unt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Unt(t){var e=Qnt(t,"string");return typeof e=="symbol"?e:e+""}function Qnt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vnt(t,e,r,n,a){for(var s=(n||[]).slice(),o=s.length,{start:l}=e,{end:c}=e,d=function(A){var h=s[A],m,p=()=>(m===void 0&&(m=r(h,A)),m);if(A===o-1){var x=t*(h.coordinate+t*p()/2-c);s[A]=h=lc(lc({},h),{},{tickCoord:x>0?h.coordinate-x*t:h.coordinate})}else s[A]=h=lc(lc({},h),{},{tickCoord:h.coordinate});if(h.tickCoord!=null){var v=mw(t,h.tickCoord,p,l,c);v&&(c=h.tickCoord-t*(p()/2+a),s[A]=lc(lc({},h),{},{isShow:!0}))}},u=o-1;u>=0;u--)d(u);return s}function Hnt(t,e,r,n,a,s){var o=(n||[]).slice(),l=o.length,{start:c,end:d}=e;if(s){var u=n[l-1],f=r(u,l-1),A=t*(u.coordinate+t*f/2-d);if(o[l-1]=u=lc(lc({},u),{},{tickCoord:A>0?u.coordinate-A*t:u.coordinate}),u.tickCoord!=null){var h=mw(t,u.tickCoord,()=>f,c,d);h&&(d=u.tickCoord-t*(f/2+a),o[l-1]=lc(lc({},u),{},{isShow:!0}))}}for(var m=s?l-1:l,p=function(y){var b=o[y],w,I=()=>(w===void 0&&(w=r(b,y)),w);if(y===0){var j=t*(b.coordinate-t*I()/2-c);o[y]=b=lc(lc({},b),{},{tickCoord:j<0?b.coordinate-j*t:b.coordinate})}else o[y]=b=lc(lc({},b),{},{tickCoord:b.coordinate});if(b.tickCoord!=null){var N=mw(t,b.tickCoord,I,c,d);N&&(c=b.tickCoord+t*(I()/2+a),o[y]=lc(lc({},b),{},{isShow:!0}))}},x=0;x<m;x++)p(x);return o}function $nt(t,e,r){var{tick:n,ticks:a,viewBox:s,minTickGap:o,orientation:l,interval:c,tickFormatter:d,unit:u,angle:f}=t;if(!a||!a.length||!n)return[];if(On(c)||r3.isSsr){var A;return(A=Dnt(a,On(c)?c:0))!==null&&A!==void 0?A:[]}var h=[],m=l==="top"||l==="bottom"?"width":"height",p=u&&m==="width"?Wb(u,{fontSize:e,letterSpacing:r}):{width:0,height:0},x=(b,w)=>{var I=typeof d=="function"?d(b.value,w):b.value;return m==="width"?Fnt(Wb(I,{fontSize:e,letterSpacing:r}),p,f):Wb(I,{fontSize:e,letterSpacing:r})[m]},v=a.length>=2?Hl(a[1].coordinate-a[0].coordinate):1,y=Ont(s,v,m);return c==="equidistantPreserveStart"?Rnt(v,y,x,a,o):c==="equidistantPreserveEnd"?Mnt(v,y,x,a,o):(c==="preserveStart"||c==="preserveStartEnd"?h=Hnt(v,y,x,a,o,c==="preserveStartEnd"):h=Vnt(v,y,x,a,o),h.filter(b=>b.isShow))}var Gnt=t=>{var{ticks:e,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:s=0}=t,o=0;if(e){Array.from(e).forEach(u=>{if(u){var f=u.getBoundingClientRect();f.width>o&&(o=f.width)}});var l=r?r.getBoundingClientRect().width:0,c=a+s,d=o+c+l+(r?n:0);return Math.round(d)}return 0},Knt=["axisLine","width","height","className","hide","ticks","axisType"];function qnt(t,e){if(t==null)return{};var r,n,a=znt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function znt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Tg(){return Tg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Tg.apply(null,arguments)}function sW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function vo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sW(Object(r),!0).forEach(function(n){Wnt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Wnt(t,e,r){return(e=Xnt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Xnt(t){var e=Ynt(t,"string");return typeof e=="symbol"?e:e+""}function Ynt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var eg={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:mc.axis};function Jnt(t){var{x:e,y:r,width:n,height:a,orientation:s,mirror:o,axisLine:l,otherSvgProps:c}=t;if(!l)return null;var d=vo(vo(vo({},c),hh(l)),{},{fill:"none"});if(s==="top"||s==="bottom"){var u=+(s==="top"&&!o||s==="bottom"&&o);d=vo(vo({},d),{},{x1:e,y1:r+u*a,x2:e+n,y2:r+u*a})}else{var f=+(s==="left"&&!o||s==="right"&&o);d=vo(vo({},d),{},{x1:e+f*n,y1:r,x2:e+f*n,y2:r+a})}return g.createElement("line",Tg({},d,{className:vs("recharts-cartesian-axis-line",_g(l,"className"))}))}function Znt(t,e,r,n,a,s,o,l,c){var d,u,f,A,h,m,p=l?-1:1,x=t.tickSize||o,v=On(t.tickCoord)?t.tickCoord:t.coordinate;switch(s){case"top":d=u=t.coordinate,A=r+ +!l*a,f=A-p*x,m=f-p*c,h=v;break;case"left":f=A=t.coordinate,u=e+ +!l*n,d=u-p*x,h=d-p*c,m=v;break;case"right":f=A=t.coordinate,u=e+ +l*n,d=u+p*x,h=d+p*c,m=v;break;default:d=u=t.coordinate,A=r+ +l*a,f=A+p*x,m=f+p*c,h=v;break}return{line:{x1:d,y1:f,x2:u,y2:A},tick:{x:h,y:m}}}function eat(t,e){switch(t){case"left":return e?"start":"end";case"right":return e?"end":"start";default:return"middle"}}function tat(t,e){switch(t){case"left":case"right":return"middle";case"top":return e?"start":"end";default:return e?"end":"start"}}function rat(t){var{option:e,tickProps:r,value:n}=t,a,s=vs(r.className,"recharts-cartesian-axis-tick-value");if(g.isValidElement(e))a=g.cloneElement(e,vo(vo({},r),{},{className:s}));else if(typeof e=="function")a=e(vo(vo({},r),{},{className:s}));else{var o="recharts-cartesian-axis-tick-value";typeof e!="boolean"&&(o=vs(o,e==null?void 0:e.className)),a=g.createElement(w3,Tg({},r,{className:o}),n)}return a}var nat=g.forwardRef((t,e)=>{var{ticks:r=[],tick:n,tickLine:a,stroke:s,tickFormatter:o,unit:l,padding:c,tickTextProps:d,orientation:u,mirror:f,x:A,y:h,width:m,height:p,tickSize:x,tickMargin:v,fontSize:y,letterSpacing:b,getTicksConfig:w,events:I,axisType:j}=t,N=$nt(vo(vo({},w),{},{ticks:r}),y,b),S=eat(u,f),E=tat(u,f),B=hh(w),k=ew(n),T={};typeof a=="object"&&(T=a);var P=vo(vo({},B),{},{fill:"none"},T),q=N.map(le=>vo({entry:le},Znt(le,A,h,m,p,u,x,f,v))),de=q.map(le=>{var{entry:he,line:ae}=le;return g.createElement($c,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(he.value,"-").concat(he.coordinate,"-").concat(he.tickCoord)},a&&g.createElement("line",Tg({},P,ae,{className:vs("recharts-cartesian-axis-tick-line",_g(a,"className"))})))}),ce=q.map((le,he)=>{var{entry:ae,tick:Ce}=le,De=vo(vo(vo(vo({textAnchor:S,verticalAnchor:E},B),{},{stroke:"none",fill:s},k),Ce),{},{index:he,payload:ae,visibleTicksCount:N.length,tickFormatter:o,padding:c},d);return g.createElement($c,Tg({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(ae.value,"-").concat(ae.coordinate,"-").concat(ae.tickCoord)},eN(I,ae,he)),n&&g.createElement(rat,{option:n,tickProps:De,value:"".concat(typeof o=="function"?o(ae.value,he):ae.value).concat(l||"")}))});return g.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(j,"-ticks")},ce.length>0&&g.createElement(Nh,{zIndex:mc.label},g.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(j,"-tick-labels"),ref:e},ce)),de.length>0&&g.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(j,"-tick-lines")},de))}),aat=g.forwardRef((t,e)=>{var{axisLine:r,width:n,height:a,className:s,hide:o,ticks:l,axisType:c}=t,d=qnt(t,Knt),[u,f]=g.useState(""),[A,h]=g.useState(""),m=g.useRef(null);g.useImperativeHandle(e,()=>({getCalculatedWidth:()=>{var x;return Gnt({ticks:m.current,label:(x=t.labelRef)===null||x===void 0?void 0:x.current,labelGapWithTick:5,tickSize:t.tickSize,tickMargin:t.tickMargin})}}));var p=g.useCallback(x=>{if(x){var v=x.getElementsByClassName("recharts-cartesian-axis-tick-value");m.current=v;var y=v[0];if(y){var b=window.getComputedStyle(y),w=b.fontSize,I=b.letterSpacing;(w!==u||I!==A)&&(f(w),h(I))}}},[u,A]);return o||n!=null&&n<=0||a!=null&&a<=0?null:g.createElement(Nh,{zIndex:t.zIndex},g.createElement($c,{className:vs("recharts-cartesian-axis",s)},g.createElement(Jnt,{x:t.x,y:t.y,width:n,height:a,orientation:t.orientation,mirror:t.mirror,axisLine:r,otherSvgProps:hh(t)}),g.createElement(nat,{ref:p,axisType:c,events:d,fontSize:u,getTicksConfig:t,height:t.height,letterSpacing:A,mirror:t.mirror,orientation:t.orientation,padding:t.padding,stroke:t.stroke,tick:t.tick,tickFormatter:t.tickFormatter,tickLine:t.tickLine,tickMargin:t.tickMargin,tickSize:t.tickSize,tickTextProps:t.tickTextProps,ticks:l,unit:t.unit,width:t.width,x:t.x,y:t.y}),g.createElement(Att,{x:t.x,y:t.y,width:t.width,height:t.height,lowerWidth:t.width,upperWidth:t.width},g.createElement(Ctt,{label:t.label,labelRef:t.labelRef}),t.children)))}),X8=g.forwardRef((t,e)=>{var r=Kl(t,eg);return g.createElement(aat,Tg({},r,{ref:e}))});X8.displayName="CartesianAxis";var sat={},eue=xd({name:"errorBars",initialState:sat,reducers:{addErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]||(t[r]=[]),t[r].push(n)},replaceErrorBar:(t,e)=>{var{itemId:r,prev:n,next:a}=e.payload;t[r]&&(t[r]=t[r].map(s=>s.dataKey===n.dataKey&&s.direction===n.direction?a:s))},removeErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]&&(t[r]=t[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:jot,replaceErrorBar:Iot,removeErrorBar:Pot}=eue.actions,iat=eue.reducer,oat=["children"];function lat(t,e){if(t==null)return{};var r,n,a=cat(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function cat(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var dat={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},uat=g.createContext(dat);function fat(t){var{children:e}=t,r=lat(t,oat);return g.createElement(uat.Provider,{value:r},e)}function tue(t,e){var r,n,a=In(d=>qA(d,t)),s=In(d=>zA(d,e)),o=(r=a==null?void 0:a.allowDataOverflow)!==null&&r!==void 0?r:sl.allowDataOverflow,l=(n=s==null?void 0:s.allowDataOverflow)!==null&&n!==void 0?n:il.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function hat(t){var{xAxisId:e,yAxisId:r,clipPathId:n}=t,a=Wde(),{needClipX:s,needClipY:o,needClip:l}=tue(e,r);if(!l||!a)return null;var{x:c,y:d,width:u,height:f}=a;return g.createElement("clipPath",{id:"clipPath-".concat(n)},g.createElement("rect",{x:s?c:c-u/2,y:o?d:d-f/2,width:s?u:u*2,height:o?f:f*2}))}var Aat={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yN=g;function mat(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var pat=typeof Object.is=="function"?Object.is:mat,gat=yN.useSyncExternalStore,xat=yN.useRef,vat=yN.useEffect,yat=yN.useMemo,bat=yN.useDebugValue;Aat.useSyncExternalStoreWithSelector=function(t,e,r,n,a){var s=xat(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=yat(function(){function c(h){if(!d){if(d=!0,u=h,h=n(h),a!==void 0&&o.hasValue){var m=o.value;if(a(m,h))return f=m}return f=h}if(m=f,pat(u,h))return m;var p=n(h);return a!==void 0&&a(m,p)?(u=h,m):(u=h,f=p)}var d=!1,u,f,A=r===void 0?null:r;return[function(){return c(e())},A===null?void 0:function(){return c(A())}]},[e,r,n,a]);var l=gat(t,s[0],s[1]);return vat(function(){o.hasValue=!0,o.value=l},[l]),bat(l),l};function wat(t){t()}function Nat(){let t=null,e=null;return{clear(){t=null,e=null},notify(){wat(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=e={callback:r,next:null,prev:e};return a.prev?a.prev.next=a:t=a,function(){!n||t===null||(n=!1,a.next?a.next.prev=a.prev:e=a.prev,a.prev?a.prev.next=a.next:t=a.next)}}}}var iW={notify(){},get:()=>[]};function Cat(t,e){let r,n=iW,a=0,s=!1;function o(p){u();const x=n.subscribe(p);let v=!1;return()=>{v||(v=!0,x(),f())}}function l(){n.notify()}function c(){m.onStateChange&&m.onStateChange()}function d(){return s}function u(){a++,r||(r=t.subscribe(c),n=Nat())}function f(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=iW)}function A(){s||(s=!0,u())}function h(){s&&(s=!1,f())}const m={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:d,trySubscribe:A,tryUnsubscribe:h,getListeners:()=>n};return m}var _at=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Eat=_at(),Sat=()=>typeof navigator<"u"&&navigator.product==="ReactNative",jat=Sat(),Iat=()=>Eat||jat?g.useLayoutEffect:g.useEffect,Pat=Iat();function oW(t,e){return t===e?t!==0||e!==0||1/t===1/e:t!==t&&e!==e}function Tat(t,e){if(oW(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(e,r[a])||!oW(t[r[a]],e[r[a]]))return!1;return!0}var VT=Symbol.for("react-redux-context"),HT=typeof globalThis<"u"?globalThis:{};function Bat(){if(!g.createContext)return{};const t=HT[VT]??(HT[VT]=new Map);let e=t.get(g.createContext);return e||(e=g.createContext(null),t.set(g.createContext,e)),e}var kat=Bat();function Fat(t){const{children:e,context:r,serverState:n,store:a}=t,s=g.useMemo(()=>{const c=Cat(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0}},[a,n]),o=g.useMemo(()=>a.getState(),[a]);Pat(()=>{const{subscription:c}=s;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[s,o]);const l=r||kat;return g.createElement(l.Provider,{value:s},e)}var Oat=Fat,Dat=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function Rat(t,e){return t==null&&e==null?!0:typeof t=="number"&&typeof e=="number"?t===e||t!==t&&e!==e:t===e}function Y8(t,e){var r=new Set([...Object.keys(t),...Object.keys(e)]);for(var n of r)if(Dat.has(n)){if(t[n]==null&&e[n]==null)continue;if(!Tat(t[n],e[n]))return!1}else if(!Rat(t[n],e[n]))return!1;return!0}function Yg(t,e){var r,n;return(r=(n=t.graphicalItems.cartesianItems.find(a=>a.id===e))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:qde}function Jg(t,e){var r,n;return(r=(n=t.graphicalItems.cartesianItems.find(a=>a.id===e))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:qde}var Mat="Invariant failed";function Lat(t,e){throw new Error(Mat)}function EO(){return EO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},EO.apply(null,arguments)}function rI(t){return g.createElement(Vde,EO({shapeType:"rectangle",activeClassName:"recharts-active-bar"},t))}var Uat=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(On(e))return e;var s=On(n)||vl(n);return s?e(n,a):(s||Lat(),r)}},Qat=(t,e,r)=>r,Vat=(t,e)=>e,bN=Zt([d8,Vat],(t,e)=>t.filter(r=>r.type==="bar").find(r=>r.id===e)),Hat=Zt([bN],t=>t==null?void 0:t.maxBarSize),$at=(t,e,r,n)=>n,Gat=Zt([za,d8,Yg,Jg,Qat],(t,e,r,n,a)=>e.filter(s=>t==="horizontal"?s.xAxisId===r:s.yAxisId===n).filter(s=>s.isPanorama===a).filter(s=>s.hide===!1).filter(s=>s.type==="bar")),Kat=(t,e,r)=>{var n=za(t),a=Yg(t,e),s=Jg(t,e);if(!(a==null||s==null))return n==="horizontal"?vO(t,"yAxis",s,r):vO(t,"xAxis",a,r)},qat=(t,e)=>{var r=za(t),n=Yg(t,e),a=Jg(t,e);if(!(n==null||a==null))return r==="horizontal"?oz(t,"xAxis",n):oz(t,"yAxis",a)},zat=Zt([Gat,mYe,qat],pnt),Wat=(t,e,r)=>{var n,a,s=bN(t,e);if(s!=null){var o=Yg(t,e),l=Jg(t,e);if(!(o==null||l==null)){var c=za(t),d=cce(t),{maxBarSize:u}=s,f=vl(u)?d:u,A,h;return c==="horizontal"?(A=a1(t,"xAxis",o,r),h=n1(t,"xAxis",o,r)):(A=a1(t,"yAxis",l,r),h=n1(t,"yAxis",l,r)),(n=(a=Pj(A,h,!0))!==null&&a!==void 0?a:f)!==null&&n!==void 0?n:0}}},rue=(t,e,r)=>{var n=za(t),a=Yg(t,e),s=Jg(t,e);if(!(a==null||s==null)){var o,l;return n==="horizontal"?(o=a1(t,"xAxis",a,r),l=n1(t,"xAxis",a,r)):(o=a1(t,"yAxis",s,r),l=n1(t,"yAxis",s,r)),Pj(o,l)}},Xat=Zt([zat,cce,AYe,dce,Wat,rue,Hat],bnt),Yat=(t,e,r)=>{var n=Yg(t,e);if(n!=null)return a1(t,"xAxis",n,r)},Jat=(t,e,r)=>{var n=Jg(t,e);if(n!=null)return a1(t,"yAxis",n,r)},Zat=(t,e,r)=>{var n=Yg(t,e);if(n!=null)return n1(t,"xAxis",n,r)},est=(t,e,r)=>{var n=Jg(t,e);if(n!=null)return n1(t,"yAxis",n,r)},tst=Zt([Xat,bN],(t,e)=>{if(!(t==null||e==null)){var r=t.find(n=>n.stackId===e.stackId&&e.dataKey!=null&&n.dataKeys.includes(e.dataKey));if(r!=null)return r.position}}),rst=Zt([Kat,bN],wnt),nst=Zt([Wo,_M,Yat,Jat,Zat,est,tst,za,rYe,rue,rst,bN,$at],(t,e,r,n,a,s,o,l,c,d,u,f,A)=>{var{chartData:h,dataStartIndex:m,dataEndIndex:p}=c;if(!(f==null||o==null||e==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||a==null||s==null||d==null)){var{data:x}=f,v;if(x!=null&&x.length>0?v=x:v=h==null?void 0:h.slice(m,p+1),v!=null)return Bst({layout:l,barSettings:f,pos:o,parentViewBox:e,bandSize:d,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:s,stackedData:u,displayedData:v,offset:t,cells:A,dataStartIndex:m})}}),ast=["index"];function SO(){return SO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},SO.apply(null,arguments)}function sst(t,e){if(t==null)return{};var r,n,a=ist(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function ist(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var nue=g.createContext(void 0),ost=t=>{var e=g.useContext(nue);if(e!=null)return e.stackId;if(t!=null)return nKe(t)},lst=(t,e)=>"recharts-bar-stack-clip-path-".concat(t,"-").concat(e),cst=t=>{var e=g.useContext(nue);if(e!=null){var{stackId:r}=e;return"url(#".concat(lst(r,t),")")}},dst=t=>{var{index:e}=t,r=sst(t,ast),n=cst(e);return g.createElement($c,SO({className:"recharts-bar-stack-layer",clipPath:n},r))},ust=["onMouseEnter","onMouseLeave","onClick"],fst=["value","background","tooltipPosition"],hst=["id"],Ast=["onMouseEnter","onClick","onMouseLeave"];function BA(){return BA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},BA.apply(null,arguments)}function lW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Rc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?lW(Object(r),!0).forEach(function(n){mst(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):lW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mst(t,e,r){return(e=pst(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pst(t){var e=gst(t,"string");return typeof e=="symbol"?e:e+""}function gst(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nI(t,e){if(t==null)return{};var r,n,a=xst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function xst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var vst=t=>{var{dataKey:e,name:r,fill:n,legendType:a,hide:s}=t;return[{inactive:s,dataKey:e,type:a,color:n,value:KP(r,e),payload:t}]},yst=g.memo(t=>{var{dataKey:e,stroke:r,strokeWidth:n,fill:a,name:s,hide:o,unit:l,tooltipType:c,id:d}=t,u={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:e,nameKey:void 0,name:KP(s,e),hide:o,type:c,color:a,unit:l,graphicalItemId:d}};return g.createElement(Hde,{tooltipEntrySettings:u})});function bst(t){var e=In(Pg),{data:r,dataKey:n,background:a,allOtherBarProps:s}=t,{onMouseEnter:o,onMouseLeave:l,onClick:c}=s,d=nI(s,ust),u=K8(o,n,s.id),f=q8(l),A=z8(c,n,s.id);if(!a||r==null)return null;var h=ew(a);return g.createElement(Nh,{zIndex:Nnt(a,mc.barBackground)},r.map((m,p)=>{var{value:x,background:v,tooltipPosition:y}=m,b=nI(m,fst);if(!v)return null;var w=u(m,p),I=f(m,p),j=A(m,p),N=Rc(Rc(Rc(Rc(Rc({option:a,isActive:String(p)===e},b),{},{fill:"#eee"},v),h),eN(d,m,p)),{},{onMouseEnter:w,onMouseLeave:I,onClick:j,dataKey:n,index:p,className:"recharts-bar-background-rectangle"});return g.createElement(rI,BA({key:"background-bar-".concat(p)},N))}))}function wst(t){var{showLabels:e,children:r,rects:n}=t,a=n==null?void 0:n.map(s=>{var o={x:s.x,y:s.y,width:s.width,lowerWidth:s.width,upperWidth:s.width,height:s.height};return Rc(Rc({},o),{},{value:s.value,payload:s.payload,parentViewBox:s.parentViewBox,viewBox:o,fill:s.fill})});return g.createElement(Ttt,{value:e?a:void 0},r)}function Nst(t){var{shape:e,activeBar:r,baseProps:n,entry:a,index:s,dataKey:o}=t,l=In(Pg),c=In(O8),d=r&&String(s)===l&&(c==null||o===c),u=d?r:e;return d?g.createElement(Nh,{zIndex:mc.activeBar},g.createElement(rI,BA({},n,{name:String(n.name)},a,{isActive:d,option:u,index:s,dataKey:o}))):g.createElement(rI,BA({},n,{name:String(n.name)},a,{isActive:d,option:u,index:s,dataKey:o}))}function Cst(t){var{shape:e,baseProps:r,entry:n,index:a,dataKey:s}=t;return g.createElement(rI,BA({},r,{name:String(r.name)},n,{isActive:!1,option:e,index:a,dataKey:s}))}function _st(t){var e,{data:r,props:n}=t,a=(e=hh(n))!==null&&e!==void 0?e:{},{id:s}=a,o=nI(a,hst),{shape:l,dataKey:c,activeBar:d}=n,{onMouseEnter:u,onClick:f,onMouseLeave:A}=n,h=nI(n,Ast),m=K8(u,c,s),p=q8(A),x=z8(f,c,s);return r?g.createElement(g.Fragment,null,r.map((v,y)=>g.createElement(dst,BA({index:y,key:"rectangle-".concat(v==null?void 0:v.x,"-").concat(v==null?void 0:v.y,"-").concat(v==null?void 0:v.value,"-").concat(y),className:"recharts-bar-rectangle"},eN(h,v,y),{onMouseEnter:m(v,y),onMouseLeave:p(v,y),onClick:x(v,y)}),d?g.createElement(Nst,{shape:l,activeBar:d,baseProps:o,entry:v,index:y,dataKey:c}):g.createElement(Cst,{shape:l,baseProps:o,entry:v,index:y,dataKey:c})))):null}function Est(t){var{props:e,previousRectanglesRef:r}=t,{data:n,layout:a,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:d,onAnimationStart:u}=e,f=r.current,A=a3(e,"recharts-bar-"),[h,m]=g.useState(!1),p=!h,x=g.useCallback(()=>{typeof d=="function"&&d(),m(!1)},[d]),v=g.useCallback(()=>{typeof u=="function"&&u(),m(!0)},[u]);return g.createElement(wst,{showLabels:p,rects:n},g.createElement(n3,{animationId:A,begin:o,duration:l,isActive:s,easing:c,onAnimationEnd:x,onAnimationStart:v,key:A},y=>{var b=y===1?n:n==null?void 0:n.map((w,I)=>{var j=f&&f[I];if(j)return Rc(Rc({},w),{},{x:Mo(j.x,w.x,y),y:Mo(j.y,w.y,y),width:Mo(j.width,w.width,y),height:Mo(j.height,w.height,y)});if(a==="horizontal"){var N=Mo(0,w.height,y),S=Mo(w.stackedBarStart,w.y,y);return Rc(Rc({},w),{},{y:S,height:N})}var E=Mo(0,w.width,y),B=Mo(w.stackedBarStart,w.x,y);return Rc(Rc({},w),{},{width:E,x:B})});return y>0&&(r.current=b??null),b==null?null:g.createElement($c,null,g.createElement(_st,{props:e,data:b}))}),g.createElement(Fde,{label:e.label}),e.children)}function Sst(t){var e=g.useRef(null);return g.createElement(Est,{previousRectanglesRef:e,props:t})}var aue=0,jst=(t,e)=>{var r=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:r,errorVal:Js(t,e)}};class Ist extends g.PureComponent{render(){var{hide:e,data:r,dataKey:n,className:a,xAxisId:s,yAxisId:o,needClip:l,background:c,id:d}=this.props;if(e||r==null)return null;var u=vs("recharts-bar",a),f=d;return g.createElement($c,{className:u,id:d},l&&g.createElement("defs",null,g.createElement(hat,{clipPathId:f,xAxisId:s,yAxisId:o})),g.createElement($c,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(f,")"):void 0},g.createElement(bst,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),g.createElement(Sst,this.props)))}}var Pst={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:aue,xAxisId:0,yAxisId:0,zIndex:mc.bar};function Tst(t){var{xAxisId:e,yAxisId:r,hide:n,legendType:a,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:d,isAnimationActive:u}=t,{needClip:f}=tue(e,r),A=aN(),h=Zd(),m=G8(t.children,vN),p=In(y=>nst(y,t.id,h,m));if(A!=="vertical"&&A!=="horizontal")return null;var x,v=p==null?void 0:p[0];return v==null||v.height==null||v.width==null?x=0:x=A==="vertical"?v.height/2:v.width/2,g.createElement(fat,{xAxisId:e,yAxisId:r,data:p,dataPointFormatter:jst,errorBarOffset:x},g.createElement(Ist,BA({},t,{layout:A,needClip:f,data:p,xAxisId:e,yAxisId:r,hide:n,legendType:a,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:d,isAnimationActive:u})))}function Bst(t){var{layout:e,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:s,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:d,stackedData:u,displayedData:f,offset:A,cells:h,parentViewBox:m,dataStartIndex:p}=t,x=e==="horizontal"?l:o,v=u?x.scale.domain():null,y=aKe({numericAxis:x}),b=x.scale(y);return f.map((w,I)=>{var j,N,S,E,B,k;if(u){var T=u[I+p];if(T==null)return null;j=JGe(T,v)}else j=Js(w,r),Array.isArray(j)||(j=[y,j]);var P=Uat(n,aue)(j[1],I);if(e==="horizontal"){var q,[de,ce]=[l.scale(j[0]),l.scale(j[1])];N=gK({axis:o,ticks:c,bandSize:s,offset:a.offset,entry:w,index:I}),S=(q=ce??de)!==null&&q!==void 0?q:void 0,E=a.size;var le=de-ce;if(B=Ah(le)?0:le,k={x:N,y:A.top,width:E,height:A.height},Math.abs(P)>0&&Math.abs(B)<Math.abs(P)){var he=Hl(B||P)*(Math.abs(P)-Math.abs(B));S-=he,B+=he}}else{var[ae,Ce]=[o.scale(j[0]),o.scale(j[1])];if(N=ae,S=gK({axis:l,ticks:d,bandSize:s,offset:a.offset,entry:w,index:I}),E=Ce-ae,B=a.size,k={x:A.left,y:S,width:A.width,height:B},Math.abs(P)>0&&Math.abs(E)<Math.abs(P)){var De=Hl(E||P)*(Math.abs(P)-Math.abs(E));E+=De}}if(N==null||S==null||E==null||B==null)return null;var O=Rc(Rc({},w),{},{stackedBarStart:b,x:N,y:S,width:E,height:B,value:u?j:j[1],payload:w,background:k,tooltipPosition:{x:N+E/2,y:S+B/2},parentViewBox:m},h&&h[I]&&h[I].props);return O}).filter(Boolean)}function kst(t){var e=Kl(t,Pst),r=ost(e.stackId),n=Zd();return g.createElement($de,{id:e.id,type:"bar"},a=>g.createElement(g.Fragment,null,g.createElement(mrt,{legendPayload:vst(e)}),g.createElement(yst,{dataKey:e.dataKey,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,unit:e.unit,tooltipType:e.tooltipType,id:a}),g.createElement(Irt,{type:"bar",id:a,data:void 0,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,stackId:r,hide:e.hide,barSize:e.barSize,minPointSize:e.minPointSize,maxBarSize:e.maxBarSize,isPanorama:n}),g.createElement(Nh,{zIndex:e.zIndex},g.createElement(Tst,BA({},e,{id:a})))))}var jO=g.memo(kst,Y8);jO.displayName="Bar";var Fst=["domain","range"],Ost=["domain","range"];function cW(t,e){if(t==null)return{};var r,n,a=Dst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Dst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function dW(t,e){return t===e?!0:Array.isArray(t)&&t.length===2&&Array.isArray(e)&&e.length===2?t[0]===e[0]&&t[1]===e[1]:!1}function sue(t,e){if(t===e)return!0;var{domain:r,range:n}=t,a=cW(t,Fst),{domain:s,range:o}=e,l=cW(e,Ost);return!dW(r,s)||!dW(n,o)?!1:Y8(a,l)}var Rst=["dangerouslySetInnerHTML","ticks","scale"],Mst=["id","scale"];function IO(){return IO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},IO.apply(null,arguments)}function uW(t,e){if(t==null)return{};var r,n,a=Lst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Lst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Ust(t){var e=Us(),r=g.useRef(null);return g.useLayoutEffect(()=>{r.current===null?e(int(t)):r.current!==t&&e(ont({prev:r.current,next:t})),r.current=t},[t,e]),g.useLayoutEffect(()=>()=>{r.current&&(e(lnt(r.current)),r.current=null)},[e]),null}var Qst=t=>{var{xAxisId:e,className:r}=t,n=In(_M),a=Zd(),s="xAxis",o=In(v=>Vce(v,s,e,a)),l=In(v=>Mce(v,e)),c=In(v=>fJe(v,e)),d=In(v=>vce(v,e));if(l==null||c==null||d==null)return null;var{dangerouslySetInnerHTML:u,ticks:f,scale:A}=t,h=uW(t,Rst),{id:m,scale:p}=d,x=uW(d,Mst);return g.createElement(X8,IO({},h,x,{x:c.x,y:c.y,width:l.width,height:l.height,className:vs("recharts-".concat(s," ").concat(s),r),viewBox:n,ticks:o,axisType:s}))},Vst={allowDataOverflow:sl.allowDataOverflow,allowDecimals:sl.allowDecimals,allowDuplicatedCategory:sl.allowDuplicatedCategory,angle:sl.angle,axisLine:eg.axisLine,height:sl.height,hide:!1,includeHidden:sl.includeHidden,interval:sl.interval,minTickGap:sl.minTickGap,mirror:sl.mirror,orientation:sl.orientation,padding:sl.padding,reversed:sl.reversed,scale:sl.scale,tick:sl.tick,tickCount:sl.tickCount,tickLine:eg.tickLine,tickSize:eg.tickSize,type:sl.type,xAxisId:0},Hst=t=>{var e=Kl(t,Vst);return g.createElement(g.Fragment,null,g.createElement(Ust,{allowDataOverflow:e.allowDataOverflow,allowDecimals:e.allowDecimals,allowDuplicatedCategory:e.allowDuplicatedCategory,angle:e.angle,dataKey:e.dataKey,domain:e.domain,height:e.height,hide:e.hide,id:e.xAxisId,includeHidden:e.includeHidden,interval:e.interval,minTickGap:e.minTickGap,mirror:e.mirror,name:e.name,orientation:e.orientation,padding:e.padding,reversed:e.reversed,scale:e.scale,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit}),g.createElement(Qst,e))},iue=g.memo(Hst,sue);iue.displayName="XAxis";var $st=["dangerouslySetInnerHTML","ticks","scale"],Gst=["id","scale"];function PO(){return PO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},PO.apply(null,arguments)}function fW(t,e){if(t==null)return{};var r,n,a=Kst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Kst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function qst(t){var e=Us(),r=g.useRef(null);return g.useLayoutEffect(()=>{r.current===null?e(cnt(t)):r.current!==t&&e(dnt({prev:r.current,next:t})),r.current=t},[t,e]),g.useLayoutEffect(()=>()=>{r.current&&(e(unt(r.current)),r.current=null)},[e]),null}var zst=t=>{var{yAxisId:e,className:r,width:n,label:a}=t,s=g.useRef(null),o=g.useRef(null),l=In(_M),c=Zd(),d=Us(),u="yAxis",f=In(j=>Lce(j,e)),A=In(j=>AJe(j,e)),h=In(j=>Vce(j,u,e,c)),m=In(j=>yce(j,e));if(g.useLayoutEffect(()=>{if(!(n!=="auto"||!f||U8(a)||g.isValidElement(a)||m==null)){var j=s.current;if(j){var N=j.getCalculatedWidth();Math.round(f.width)!==Math.round(N)&&d(fnt({id:e,width:N}))}}},[h,f,d,a,e,n,m]),f==null||A==null||m==null)return null;var{dangerouslySetInnerHTML:p,ticks:x,scale:v}=t,y=fW(t,$st),{id:b,scale:w}=m,I=fW(m,Gst);return g.createElement(X8,PO({},y,I,{ref:s,labelRef:o,x:A.x,y:A.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:f.width,height:f.height,className:vs("recharts-".concat(u," ").concat(u),r),viewBox:l,ticks:h,axisType:u}))},Wst={allowDataOverflow:il.allowDataOverflow,allowDecimals:il.allowDecimals,allowDuplicatedCategory:il.allowDuplicatedCategory,angle:il.angle,axisLine:eg.axisLine,hide:!1,includeHidden:il.includeHidden,interval:il.interval,minTickGap:il.minTickGap,mirror:il.mirror,orientation:il.orientation,padding:il.padding,reversed:il.reversed,scale:il.scale,tick:il.tick,tickCount:il.tickCount,tickLine:eg.tickLine,tickSize:eg.tickSize,type:il.type,width:il.width,yAxisId:0},Xst=t=>{var e=Kl(t,Wst);return g.createElement(g.Fragment,null,g.createElement(qst,{interval:e.interval,id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:e.includeHidden,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:e.angle,minTickGap:e.minTickGap,tick:e.tick,tickFormatter:e.tickFormatter}),g.createElement(zst,e))},oue=g.memo(Xst,sue);oue.displayName="YAxis";var Yst=(t,e)=>e,J8=Zt([Yst,za,gce,Yo,ade,WA,IZe,Wo],DZe),Z8=t=>{var e=t.currentTarget.getBoundingClientRect(),r=e.width/t.currentTarget.offsetWidth,n=e.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-e.left)/r),chartY:Math.round((t.clientY-e.top)/n)}},lue=Vu("mouseClick"),cue=rN();cue.startListening({actionCreator:lue,effect:(t,e)=>{var r=t.payload,n=J8(e.getState(),Z8(r));(n==null?void 0:n.activeIndex)!=null&&e.dispatch(jJe({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var TO=Vu("mouseMove"),due=rN(),M_=null;due.startListening({actionCreator:TO,effect:(t,e)=>{var r=t.payload;M_!==null&&cancelAnimationFrame(M_);var n=Z8(r);M_=requestAnimationFrame(()=>{var a=e.getState(),s=I8(a,a.tooltip.settings.shared);if(s==="axis"){var o=J8(a,n);(o==null?void 0:o.activeIndex)!=null?e.dispatch(Xce({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):e.dispatch(Wce())}M_=null})}});function Jst(t,e){return e instanceof HTMLElement?"HTMLElement <".concat(e.tagName,' class="').concat(e.className,'">'):e===window?"global.window":t==="children"&&typeof e=="object"&&e!==null?"<<CHILDREN>>":e}var hW={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},uue=xd({name:"rootProps",initialState:hW,reducers:{updateOptions:(t,e)=>{var r;t.accessibilityLayer=e.payload.accessibilityLayer,t.barCategoryGap=e.payload.barCategoryGap,t.barGap=(r=e.payload.barGap)!==null&&r!==void 0?r:hW.barGap,t.barSize=e.payload.barSize,t.maxBarSize=e.payload.maxBarSize,t.stackOffset=e.payload.stackOffset,t.syncId=e.payload.syncId,t.syncMethod=e.payload.syncMethod,t.className=e.payload.className,t.baseValue=e.payload.baseValue,t.reverseStackOrder=e.payload.reverseStackOrder}}}),Zst=uue.reducer,{updateOptions:eit}=uue.actions,fue=xd({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,e)=>e.payload}}),{updatePolarOptions:tit}=fue.actions,rit=fue.reducer,hue=Vu("keyDown"),Aue=Vu("focus"),eL=rN();eL.startListening({actionCreator:hue,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,s=t.payload;if(!(s!=="ArrowRight"&&s!=="ArrowLeft"&&s!=="Enter")){var o=P8(a,U1(r),AN(r),gN(r)),l=o==null?-1:Number(o);if(!(!Number.isFinite(l)||l<0)){var c=WA(r);if(s==="Enter"){var d=Jj(r,"axis","hover",String(a.index));e.dispatch(bO({active:!a.active,activeIndex:a.index,activeCoordinate:d}));return}var u=xJe(r),f=u==="left-to-right"?1:-1,A=s==="ArrowRight"?1:-1,h=l+A*f;if(!(c==null||h>=c.length||h<0)){var m=Jj(r,"axis","hover",String(h));e.dispatch(bO({active:!0,activeIndex:h.toString(),activeCoordinate:m}))}}}}}});eL.startListening({actionCreator:Aue,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var s="0",o=Jj(r,"axis","hover",String(s));e.dispatch(bO({active:!0,activeIndex:s,activeCoordinate:o}))}}}});var gu=Vu("externalEvent"),mue=rN(),$T=new Map;mue.startListening({actionCreator:gu,effect:(t,e)=>{var{handler:r,reactEvent:n}=t.payload;if(r!=null){n.persist();var a=n.type,s=$T.get(a);s!==void 0&&cancelAnimationFrame(s);var o=requestAnimationFrame(()=>{try{var l=e.getState(),c={activeCoordinate:AZe(l),activeDataKey:O8(l),activeIndex:Pg(l),activeLabel:ode(l),activeTooltipIndex:Pg(l),isTooltipActive:mZe(l)};r(c,n)}finally{$T.delete(a)}});$T.set(a,o)}}});var nit=Zt([M1],t=>t.tooltipItemPayloads),ait=Zt([nit,pN,(t,e)=>e,(t,e,r)=>r],(t,e,r,n)=>{var a=t.find(l=>l.settings.graphicalItemId===n);if(a!=null){var{positions:s}=a;if(s!=null){var o=e(s,r);return o}}}),pue=Vu("touchMove"),gue=rN();gue.startListening({actionCreator:pue,effect:(t,e)=>{var r=t.payload;if(!(r.touches==null||r.touches.length===0)){var n=e.getState(),a=I8(n,n.tooltip.settings.shared);if(a==="axis"){var s=r.touches[0];if(s==null)return;var o=J8(n,Z8({clientX:s.clientX,clientY:s.clientY,currentTarget:r.currentTarget}));(o==null?void 0:o.activeIndex)!=null&&e.dispatch(Xce({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(a==="item"){var l,c=r.touches[0];if(document.elementFromPoint==null||c==null)return;var d=document.elementFromPoint(c.clientX,c.clientY);if(!d||!d.getAttribute)return;var u=d.getAttribute(Foe),f=(l=d.getAttribute(Ooe))!==null&&l!==void 0?l:void 0,A=L1(n).find(p=>p.id===f);if(u==null||A==null||f==null)return;var{dataKey:h}=A,m=ait(n,u,f);e.dispatch(zce({activeDataKey:h,activeIndex:u,activeCoordinate:m,activeGraphicalItemId:f}))}}}});var sit=aoe({brush:Cnt,cartesianAxis:hnt,chartData:het,errorBars:iat,graphicalItems:Srt,layout:KGe,legend:YKe,options:oet,polarAxis:Vtt,polarOptions:rit,referenceElements:Tnt,rootProps:Zst,tooltip:IJe,zIndex:XZe}),iit=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return gGe({reducer:sit,preloadedState:e,middleware:n=>{var a;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((a="es6")!==null&&a!==void 0?a:"")}).concat([cue.middleware,due.middleware,eL.middleware,mue.middleware,gue.middleware])},enhancers:n=>{var a=n;return typeof n=="function"&&(a=n()),a.concat(voe({type:"raf"}))},devTools:{serialize:{replacer:Jst},name:"recharts-".concat(r)}})};function xue(t){var{preloadedState:e,children:r,reduxStoreName:n}=t,a=Zd(),s=g.useRef(null);if(a)return r;s.current==null&&(s.current=iit(e,n));var o=pM;return g.createElement(Oat,{context:o,store:s.current},r)}function oit(t){var{layout:e,margin:r}=t,n=Us(),a=Zd();return g.useEffect(()=>{a||(n(HGe(e)),n(VGe(r)))},[n,a,e,r]),null}var vue=g.memo(oit,Y8);function yue(t){var e=Us();return g.useEffect(()=>{e(eit(t))},[e,t]),null}function AW(t){var{zIndex:e,isPanorama:r}=t,n=g.useRef(null),a=Us();return g.useLayoutEffect(()=>(n.current&&a(zZe({zIndex:e,element:n.current,isPanorama:r})),()=>{a(WZe({zIndex:e,isPanorama:r}))}),[a,e,r]),g.createElement("g",{tabIndex:-1,ref:n})}function mW(t){var{children:e,isPanorama:r}=t,n=In(MZe);if(!n||n.length===0)return e;var a=n.filter(o=>o<0),s=n.filter(o=>o>0);return g.createElement(g.Fragment,null,a.map(o=>g.createElement(AW,{key:o,zIndex:o,isPanorama:r})),e,s.map(o=>g.createElement(AW,{key:o,zIndex:o,isPanorama:r})))}var lit=["children"];function cit(t,e){if(t==null)return{};var r,n,a=dit(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function dit(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function aI(){return aI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},aI.apply(null,arguments)}var uit={width:"100%",height:"100%",display:"block"},fit=g.forwardRef((t,e)=>{var r=Hoe(),n=$oe(),a=tle();if(!Om(r)||!Om(n))return null;var{children:s,otherAttributes:o,title:l,desc:c}=t,d,u;return o!=null&&(typeof o.tabIndex=="number"?d=o.tabIndex:d=a?0:void 0,typeof o.role=="string"?u=o.role:u=a?"application":void 0),g.createElement(tM,aI({},o,{title:l,desc:c,role:u,tabIndex:d,width:r,height:n,style:uit,ref:e}),s)}),hit=t=>{var{children:e}=t,r=In(XP);if(!r)return null;var{width:n,height:a,y:s,x:o}=r;return g.createElement(tM,{width:n,height:a,x:o,y:s},e)},pW=g.forwardRef((t,e)=>{var{children:r}=t,n=cit(t,lit),a=Zd();return a?g.createElement(hit,null,g.createElement(mW,{isPanorama:!0},r)):g.createElement(fit,aI({ref:e},n),g.createElement(mW,{isPanorama:!1},r))});function Ait(){var t=Us(),[e,r]=g.useState(null),n=In(dKe);return g.useEffect(()=>{if(e!=null){var a=e.getBoundingClientRect(),s=a.width/e.offsetWidth;Ti(s)&&s!==n&&t(GGe(s))}},[e,t,n]),r}function gW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function mit(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gW(Object(r),!0).forEach(function(n){pit(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function pit(t,e,r){return(e=git(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function git(t){var e=xit(t,"string");return typeof e=="symbol"?e:e+""}function xit(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bg(){return Bg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Bg.apply(null,arguments)}var vit=()=>(wet(),null);function sI(t){if(typeof t=="number")return t;if(typeof t=="string"){var e=parseFloat(t);if(!Number.isNaN(e))return e}return 0}var yit=g.forwardRef((t,e)=>{var r,n,a=g.useRef(null),[s,o]=g.useState({containerWidth:sI((r=t.style)===null||r===void 0?void 0:r.width),containerHeight:sI((n=t.style)===null||n===void 0?void 0:n.height)}),l=g.useCallback((d,u)=>{o(f=>{var A=Math.round(d),h=Math.round(u);return f.containerWidth===A&&f.containerHeight===h?f:{containerWidth:A,containerHeight:h}})},[]),c=g.useCallback(d=>{if(typeof e=="function"&&e(d),d!=null&&typeof ResizeObserver<"u"){var{width:u,height:f}=d.getBoundingClientRect();l(u,f);var A=m=>{var{width:p,height:x}=m[0].contentRect;l(p,x)},h=new ResizeObserver(A);h.observe(d),a.current=h}},[e,l]);return g.useEffect(()=>()=>{var d=a.current;d!=null&&d.disconnect()},[l]),g.createElement(g.Fragment,null,g.createElement(JP,{width:s.containerWidth,height:s.containerHeight}),g.createElement("div",Bg({ref:c},t)))}),bit=g.forwardRef((t,e)=>{var{width:r,height:n}=t,[a,s]=g.useState({containerWidth:sI(r),containerHeight:sI(n)}),o=g.useCallback((c,d)=>{s(u=>{var f=Math.round(c),A=Math.round(d);return u.containerWidth===f&&u.containerHeight===A?u:{containerWidth:f,containerHeight:A}})},[]),l=g.useCallback(c=>{if(typeof e=="function"&&e(c),c!=null){var{width:d,height:u}=c.getBoundingClientRect();o(d,u)}},[e,o]);return g.createElement(g.Fragment,null,g.createElement(JP,{width:a.containerWidth,height:a.containerHeight}),g.createElement("div",Bg({ref:l},t)))}),wit=g.forwardRef((t,e)=>{var{width:r,height:n}=t;return g.createElement(g.Fragment,null,g.createElement(JP,{width:r,height:n}),g.createElement("div",Bg({ref:e},t)))}),Nit=g.forwardRef((t,e)=>{var{width:r,height:n}=t;return EA(r)||EA(n)?g.createElement(bit,Bg({},t,{ref:e})):g.createElement(wit,Bg({},t,{ref:e}))});function Cit(t){return t===!0?yit:Nit}var _it=g.forwardRef((t,e)=>{var{children:r,className:n,height:a,onClick:s,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:d,onMouseLeave:u,onMouseMove:f,onMouseUp:A,onTouchEnd:h,onTouchMove:m,onTouchStart:p,style:x,width:v,responsive:y,dispatchTouchEvents:b=!0}=t,w=g.useRef(null),I=Us(),[j,N]=g.useState(null),[S,E]=g.useState(null),B=Ait(),k=EM(),T=(k==null?void 0:k.width)>0?k.width:v,P=(k==null?void 0:k.height)>0?k.height:a,q=g.useCallback(V=>{B(V),typeof e=="function"&&e(V),N(V),E(V),V!=null&&(w.current=V)},[B,e,N,E]),de=g.useCallback(V=>{I(lue(V)),I(gu({handler:s,reactEvent:V}))},[I,s]),ce=g.useCallback(V=>{I(TO(V)),I(gu({handler:d,reactEvent:V}))},[I,d]),le=g.useCallback(V=>{I(Wce()),I(gu({handler:u,reactEvent:V}))},[I,u]),he=g.useCallback(V=>{I(TO(V)),I(gu({handler:f,reactEvent:V}))},[I,f]),ae=g.useCallback(()=>{I(Aue())},[I]),Ce=g.useCallback(V=>{I(hue(V.key))},[I]),De=g.useCallback(V=>{I(gu({handler:o,reactEvent:V}))},[I,o]),O=g.useCallback(V=>{I(gu({handler:l,reactEvent:V}))},[I,l]),R=g.useCallback(V=>{I(gu({handler:c,reactEvent:V}))},[I,c]),G=g.useCallback(V=>{I(gu({handler:A,reactEvent:V}))},[I,A]),M=g.useCallback(V=>{I(gu({handler:p,reactEvent:V}))},[I,p]),K=g.useCallback(V=>{b&&I(pue(V)),I(gu({handler:m,reactEvent:V}))},[I,b,m]),Y=g.useCallback(V=>{I(gu({handler:h,reactEvent:V}))},[I,h]),D=Cit(y);return g.createElement(Ade.Provider,{value:j},g.createElement(sie.Provider,{value:S},g.createElement(D,{width:T??(x==null?void 0:x.width),height:P??(x==null?void 0:x.height),className:vs("recharts-wrapper",n),style:mit({position:"relative",cursor:"default",width:T,height:P},x),onClick:de,onContextMenu:De,onDoubleClick:O,onFocus:ae,onKeyDown:Ce,onMouseDown:R,onMouseEnter:ce,onMouseLeave:le,onMouseMove:he,onMouseUp:G,onTouchEnd:Y,onTouchMove:K,onTouchStart:M,ref:q},g.createElement(vit,null),r)))}),Eit=["width","height","responsive","children","className","style","compact","title","desc"];function Sit(t,e){if(t==null)return{};var r,n,a=jit(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function jit(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var bue=g.forwardRef((t,e)=>{var{width:r,height:n,responsive:a,children:s,className:o,style:l,compact:c,title:d,desc:u}=t,f=Sit(t,Eit),A=hh(f);return c?g.createElement(g.Fragment,null,g.createElement(JP,{width:r,height:n}),g.createElement(pW,{otherAttributes:A,title:d,desc:u},s)):g.createElement(_it,{className:o,style:l,width:r,height:n,responsive:a??!1,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},g.createElement(pW,{otherAttributes:A,title:d,desc:u,ref:e},g.createElement(knt,null,s)))});function BO(){return BO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},BO.apply(null,arguments)}var Iit={top:5,right:5,bottom:5,left:5},Pit={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:Iit,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},Tit=g.forwardRef(function(e,r){var n,a=Kl(e.categoricalChartProps,Pit),{chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,categoricalChartProps:d}=e,u={chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0};return g.createElement(xue,{preloadedState:{options:u},reduxStoreName:(n=d.id)!==null&&n!==void 0?n:s},g.createElement(Xde,{chartData:d.data}),g.createElement(vue,{layout:a.layout,margin:a.margin}),g.createElement(yue,{baseValue:a.baseValue,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),g.createElement(bue,BO({},a,{ref:r})))}),Bit=["axis","item"],kit=g.forwardRef((t,e)=>g.createElement(Tit,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Bit,tooltipPayloadSearcher:pde,categoricalChartProps:t,ref:e}));function Fit(t){var e=Us();return g.useEffect(()=>{e(tit(t))},[e,t]),null}var Oit=["layout"];function kO(){return kO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},kO.apply(null,arguments)}function Dit(t,e){if(t==null)return{};var r,n,a=Rit(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Rit(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Mit={top:5,right:5,bottom:5,left:5},wue={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Mit,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Lit=g.forwardRef(function(e,r){var n,a=Kl(e.categoricalChartProps,wue),{layout:s}=a,o=Dit(a,Oit),{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:d,tooltipPayloadSearcher:u}=e,f={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:d,tooltipPayloadSearcher:u,eventEmitter:void 0};return g.createElement(xue,{preloadedState:{options:f},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:l},g.createElement(Xde,{chartData:a.data}),g.createElement(vue,{layout:s,margin:a.margin}),g.createElement(yue,{baseValue:void 0,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),g.createElement(Fit,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),g.createElement(bue,kO({},o,{ref:r})))});function xW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function vW(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?xW(Object(r),!0).forEach(function(n){Uit(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Uit(t,e,r){return(e=Qit(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qit(t){var e=Vit(t,"string");return typeof e=="symbol"?e:e+""}function Vit(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Hit=["item"],$it=vW(vW({},wue),{},{layout:"centric",startAngle:0,endAngle:360}),Git=g.forwardRef((t,e)=>{var r=Kl(t,$it);return g.createElement(Lit,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Hit,tooltipPayloadSearcher:pde,categoricalChartProps:r,ref:e})});const Kit="sellers_candies",L_="cash_deliveries_candies";function Ja(t){const e=typeof t=="number"?t:parseFloat(String(t??"").replace(/,/g,""));return Number.isFinite(e)?e:0}function Ji(t){return Number.isFinite(t)?t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"}function U_(t,e){return t*e/100}function Q_(t,e,r){return t-e-r}function yW(t){return t?Kr(t.toDate(),"yyyy-MM-dd"):""}function V_(t){if(!t)return Nr.fromDate(new Date);const[e,r,n]=t.split("-").map(s=>parseInt(s,10)),a=new Date(e,(r||1)-1,n||1,0,0,0,0);return Nr.fromDate(a)}function qit(){const t=new Date,[e,r]=g.useState(Kr(Gu(t),"yyyy-MM-dd")),[n,a]=g.useState(Kr($u(t),"yyyy-MM-dd")),[s,o]=g.useState([]),l=g.useMemo(()=>{const D=new Map;return s.forEach(V=>D.set(V.id,V)),D},[s]),[c,d]=g.useState([]),[u,f]=g.useState(!0),[A,h]=g.useState(()=>Kr(new Date,"yyyy-MM-dd")),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState("0"),[w,I]=g.useState(""),[j,N]=g.useState(null),[S,E]=g.useState({}),B=g.useRef(null);g.useEffect(()=>{const D=ar(xt(Ne,Kit),kn("name","asc")),V=Fu(D,te=>{const ve=te.docs.map(Q=>{const Xe=Q.data();return{id:Q.id,name:String((Xe==null?void 0:Xe.name)??""),branch:Xe!=null&&Xe.branch?String(Xe.branch):"",commissionPercent:Ja((Xe==null?void 0:Xe.commissionPercent)??0)}});o(ve)},()=>o([]));return()=>V()},[]),g.useEffect(()=>{f(!0);const D=V_(e),V=new Date(V_(n).toDate().getTime());V.setDate(V.getDate()+1);const te=Nr.fromDate(V),ve=ar(xt(Ne,L_),lr("date",">=",D),lr("date","<",te),kn("date","desc")),Q=Fu(ve,Xe=>{const se=Xe.docs.map(Z=>{const ke=Z.data();return{id:Z.id,date:ke==null?void 0:ke.date,sellerId:String((ke==null?void 0:ke.sellerId)??""),sellerName:String((ke==null?void 0:ke.sellerName)??""),amountDelivered:Ja(ke==null?void 0:ke.amountDelivered),commissionPercent:Ja(ke==null?void 0:ke.commissionPercent),commissionPaid:Ja(ke==null?void 0:ke.commissionPaid),extraExpenses:Ja(ke==null?void 0:ke.extraExpenses),totalFinal:Ja(ke==null?void 0:ke.totalFinal),comment:String((ke==null?void 0:ke.comment)??""),createdAt:ke==null?void 0:ke.createdAt,updatedAt:ke==null?void 0:ke.updatedAt}});d(se),f(!1)},Xe=>{console.error("Firestore deliveries query error:",Xe),d([]),f(!1),alert("Firestore query fall. Revis consola (probable ndice).")});return()=>Q()},[e,n]);const k=g.useMemo(()=>m?l.get(m):void 0,[m,l]),T=Ja((k==null?void 0:k.commissionPercent)??0),P=Ja(x),q=Ja(y),de=U_(P,T),ce=Q_(P,de,q),le=g.useMemo(()=>{var V;const D=new Map;for(const te of c){const ve=te.sellerId||te.sellerName||"UNKNOWN",Q=D.get(ve)??{sellerId:te.sellerId,sellerName:te.sellerName||((V=l.get(te.sellerId))==null?void 0:V.name)||"Sin nombre",delivered:0,commission:0,totalFinal:0};Q.delivered+=Ja(te.amountDelivered),Q.commission+=Ja(te.commissionPaid),Q.totalFinal+=Ja(te.totalFinal),D.set(ve,Q)}return Array.from(D.values()).sort((te,ve)=>te.sellerName.localeCompare(ve.sellerName))},[c,l]),he=g.useMemo(()=>{let D=0,V=0,te=0,ve=0;for(const Q of c)D+=Ja(Q.amountDelivered),V+=Ja(Q.commissionPaid),te+=Ja(Q.extraExpenses),ve+=Ja(Q.totalFinal);return{delivered:D,commission:V,expenses:te,totalFinal:ve}},[c]),ae=g.useMemo(()=>le.map(D=>({name:D.sellerName,Entregado:Number(D.delivered.toFixed(2)),Comision:Number(D.commission.toFixed(2))})),[le]),Ce=g.useMemo(()=>[{name:"Total Entregado (Bruto)",value:Number(he.delivered.toFixed(2))},{name:"Total Comisin",value:Number(he.commission.toFixed(2))},{name:"Total Gastos",value:Number(he.expenses.toFixed(2))}].filter(D=>D.value>0),[he]),De=["#3B82F6","#F59E0B","#EF4444"];async function O(){if(!m)return alert("Seleccion un vendedor.");if(P<=0)return alert("Ingres un Monto entregado vlido (> 0).");const D=l.get(m),V=(D==null?void 0:D.name)??"Sin nombre",te=Ja((D==null?void 0:D.commissionPercent)??0),ve=U_(P,te),Q=Q_(P,ve,q);await ta(xt(Ne,L_),{date:V_(A),sellerId:m,sellerName:V,amountDelivered:P,commissionPercent:te,commissionPaid:ve,extraExpenses:q,totalFinal:Q,comment:w??"",createdAt:Nr.now()}),v(""),b("0"),I("")}function R(D){N(D.id),E({...D,dateInput:yW(D.date)})}function G(){N(null),E({})}async function M(D){const V=S,te=String(V.sellerId??""),ve=l.get(te),Q=String(V.sellerName??(ve==null?void 0:ve.name)??"Sin nombre"),Xe=Ja(V.amountDelivered),se=Ja(V.extraExpenses),Z=Ja(V.commissionPercent??(ve==null?void 0:ve.commissionPercent)??0),ke=U_(Xe,Z),Se=Q_(Xe,ke,se),Ee=V_(String(V.dateInput??yW(V.date)));await Mn(Kt(Ne,L_,D),{date:Ee,sellerId:te,sellerName:Q,amountDelivered:Xe,commissionPercent:Z,commissionPaid:ke,extraExpenses:se,totalFinal:Se,comment:String(V.comment??""),updatedAt:Nr.now()}),G()}async function K(D){confirm("Eliminar este registro?")&&await na(Kt(Ne,L_,D))}async function Y(){if(!B.current)return;const D=await $m(B.current,{scale:2,useCORS:!0,backgroundColor:"#ffffff",scrollX:0,scrollY:-window.scrollY}),V=D.toDataURL("image/png"),te=new An("p","mm","a4"),ve=te.internal.pageSize.getWidth(),Q=te.internal.pageSize.getHeight(),Xe=ve,se=D.height*Xe/D.width;let Z=se,ke=0;for(te.addImage(V,"PNG",0,ke,Xe,se),Z-=Q;Z>0;)te.addPage(),ke=-(se-Z),te.addImage(V,"PNG",0,ke,Xe,se),Z-=Q;te.save(`Entregas_Dulces_${e}_a_${n}.pdf`)}return i.jsxs("div",{className:"p-3 md:p-6 max-w-7xl mx-auto space-y-3 md:space-y-4",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg md:text-2xl font-black text-gray-900",children:"Control Contable - Entregas de Vendedores (Dulces)"}),i.jsxs("p",{className:"text-xs md:text-sm text-gray-600",children:["Periodo: ",i.jsx("span",{className:"font-bold",children:e})," "," ",i.jsx("span",{className:"font-bold",children:n})]})]}),i.jsx("button",{onClick:Y,className:"h-10 px-4 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800 active:scale-[0.99] transition",children:"Exportar a PDF"})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Filtros de periodo"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",value:e,onChange:D=>r(D.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",value:n,onChange:D=>a(D.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]})]})]}),i.jsxs("div",{ref:B,className:"space-y-3 md:space-y-4",children:[i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"KPIs Consolidados"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"KPI Entradas (Neto)"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",Ji(he.totalFinal)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Entregado - Comisin - Gastos"})]}),i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"KPI Comisiones"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",Ji(he.commission)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Suma de comisin pagada"})]}),i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"KPI Gastos extras"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",Ji(he.expenses)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Suma de gastos registrados"})]}),i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"Total entregado (Bruto)"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",Ji(he.delivered)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Sin restar nada"})]})]}),i.jsx("div",{className:"font-black text-sm text-gray-900 mt-4 mb-2",children:"KPI Vendedores (sumatoria del periodo)"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-[520px] w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-50 text-gray-700",children:[i.jsx("th",{className:"text-left p-2 font-black",children:"Vendedor"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Entregado"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Comisin"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Total final"})]})}),i.jsx("tbody",{children:le.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-2 text-gray-500",colSpan:4,children:"Sin datos en el periodo seleccionado."})}):le.map(D=>i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"p-2",children:D.sellerName}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Ji(D.delivered)]}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Ji(D.commission)]}),i.jsxs("td",{className:"p-2 text-right font-extrabold",children:["$ ",Ji(D.totalFinal)]})]},D.sellerId||D.sellerName))})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Entregas y Comisin por vendedor (Barras)"}),i.jsx("div",{className:"w-full h-[320px]",children:i.jsx(_K,{children:i.jsxs(kit,{data:ae,children:[i.jsx(iue,{dataKey:"name",interval:0,angle:-12,height:70}),i.jsx(oue,{}),i.jsx(Nz,{}),i.jsx(nO,{}),i.jsx(jO,{dataKey:"Entregado"}),i.jsx(jO,{dataKey:"Comision"})]})})})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Distribucin (Pastel)"}),i.jsx("div",{className:"w-full h-[320px]",children:i.jsx(_K,{children:i.jsxs(Git,{children:[i.jsx(Kde,{data:Ce,dataKey:"value",nameKey:"name",outerRadius:110,label:!0,children:Ce.map((D,V)=>i.jsx(vN,{fill:De[V%De.length]},V))}),i.jsx(Nz,{}),i.jsx(nO,{})]})})})]})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Agregar movimiento"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Fecha"}),i.jsx("input",{type:"date",value:A,onChange:D=>h(D.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Vendedor"}),i.jsxs("select",{value:m,onChange:D=>p(D.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10 bg-white",children:[i.jsx("option",{value:"",children:"Seleccionar..."}),s.map(D=>i.jsxs("option",{value:D.id,children:[D.name," ",D.branch?`(${D.branch})`:""]},D.id))]})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Monto entregado"}),i.jsx("input",{type:"number",inputMode:"decimal",value:x,onChange:D=>v(D.target.value),placeholder:"0.00",className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comisin configurada"}),i.jsx("input",{value:`${T}%`,readOnly:!0,className:"w-full h-10 rounded-xl border border-gray-200 px-3 bg-gray-50 text-gray-800"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comisin pagada"}),i.jsx("input",{value:`$ ${Ji(de)}`,readOnly:!0,className:"w-full h-10 rounded-xl border border-gray-200 px-3 bg-gray-50 text-gray-800"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Gastos extras"}),i.jsx("input",{type:"number",inputMode:"decimal",value:y,onChange:D=>b(D.target.value),placeholder:"0.00",className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Total final"}),i.jsx("input",{value:`$ ${Ji(ce)}`,readOnly:!0,className:"w-full h-10 rounded-xl border border-gray-200 px-3 bg-gray-50 text-gray-900 font-extrabold"})]}),i.jsxs("label",{className:"space-y-1 md:col-span-2",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comentario"}),i.jsx("input",{value:w,onChange:D=>I(D.target.value),placeholder:"Opcional...",className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]})]}),i.jsx("div",{className:"mt-3",children:i.jsx("button",{onClick:O,className:"w-full md:w-auto h-10 px-4 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800 active:scale-[0.99] transition",children:"Guardar movimiento"})})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Registro detallado"}),u?i.jsx("div",{className:"text-sm text-gray-500",children:"Cargando..."}):c.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"No hay registros en el periodo."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-50 text-gray-700",children:[i.jsx("th",{className:"text-left p-2 font-black",children:"Fecha"}),i.jsx("th",{className:"text-left p-2 font-black",children:"Vendedor"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Monto entregado"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Comisin %"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Comisin pagada"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Gastos"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Total final"}),i.jsx("th",{className:"text-left p-2 font-black",children:"Comentario"}),i.jsx("th",{className:"text-left p-2 font-black",children:"Acciones"})]})}),i.jsx("tbody",{children:c.map(D=>{if(!(j===D.id))return i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"p-2",children:Kr(D.date.toDate(),"yyyy-MM-dd")}),i.jsx("td",{className:"p-2 font-semibold",children:D.sellerName}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Ji(D.amountDelivered)]}),i.jsxs("td",{className:"p-2 text-right",children:[Ji(D.commissionPercent),"%"]}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Ji(D.commissionPaid)]}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Ji(D.extraExpenses)]}),i.jsxs("td",{className:"p-2 text-right font-extrabold",children:["$ ",Ji(D.totalFinal)]}),i.jsx("td",{className:"p-2",children:D.comment}),i.jsx("td",{className:"p-2",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>R(D),className:"h-8 px-3 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Editar"}),i.jsx("button",{onClick:()=>K(D.id),className:"h-8 px-3 rounded-xl border border-gray-200 font-extrabold text-red-700 hover:bg-red-50",children:"Eliminar"})]})})]},D.id);const te=Ja(S.amountDelivered??D.amountDelivered),ve=Ja(S.commissionPercent??D.commissionPercent),Q=Ja(S.extraExpenses??D.extraExpenses),Xe=U_(te,ve),se=Q_(te,Xe,Q);return i.jsxs("tr",{className:"border-t bg-yellow-50/40",children:[i.jsx("td",{className:"p-2",children:i.jsx("input",{type:"date",value:String(S.dateInput??""),onChange:Z=>E(ke=>({...ke,dateInput:Z.target.value})),className:"h-9 px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsx("td",{className:"p-2",children:i.jsxs("select",{value:String(S.sellerId??D.sellerId),onChange:Z=>{const ke=Z.target.value,Se=l.get(ke);E(Ee=>({...Ee,sellerId:ke,sellerName:(Se==null?void 0:Se.name)??"",commissionPercent:Ja((Se==null?void 0:Se.commissionPercent)??0)}))},className:"h-9 px-3 rounded-xl border border-gray-200 bg-white outline-none",children:[i.jsx("option",{value:"",children:"Seleccionar..."}),s.map(Z=>i.jsxs("option",{value:Z.id,children:[Z.name," ",Z.branch?`(${Z.branch})`:""]},Z.id))]})}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",value:String(te),onChange:Z=>E(ke=>({...ke,amountDelivered:Ja(Z.target.value)})),className:"h-9 w-32 text-right px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",value:String(ve),onChange:Z=>E(ke=>({...ke,commissionPercent:Ja(Z.target.value)})),className:"h-9 w-24 text-right px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsxs("td",{className:"p-2 text-right font-semibold",children:["$ ",Ji(Xe)]}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",value:String(Q),onChange:Z=>E(ke=>({...ke,extraExpenses:Ja(Z.target.value)})),className:"h-9 w-32 text-right px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsxs("td",{className:"p-2 text-right font-extrabold",children:["$ ",Ji(se)]}),i.jsx("td",{className:"p-2",children:i.jsx("input",{type:"text",value:String(S.comment??D.comment),onChange:Z=>E(ke=>({...ke,comment:Z.target.value})),className:"h-9 w-full px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsx("td",{className:"p-2",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>M(D.id),className:"h-8 px-3 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800",children:"Guardar"}),i.jsx("button",{onClick:G,className:"h-8 px-3 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Cancelar"})]})})]},D.id)})})]})}),i.jsxs("div",{className:"md:hidden space-y-3",children:[c.map(D=>i.jsxs("div",{className:"rounded-2xl border border-gray-100 p-3 bg-white",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-black text-gray-900",children:D.sellerName}),i.jsx("div",{className:"text-xs font-extrabold bg-gray-100 rounded-full px-3 py-1",children:Kr(D.date.toDate(),"yyyy-MM-dd")})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Monto entregado"}),i.jsxs("div",{className:"font-extrabold",children:["$ ",Ji(D.amountDelivered)]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Comisin %"}),i.jsxs("div",{className:"font-semibold",children:[Ji(D.commissionPercent),"%"]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Comisin pagada"}),i.jsxs("div",{className:"font-semibold",children:["$ ",Ji(D.commissionPaid)]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Gastos"}),i.jsxs("div",{className:"font-semibold",children:["$ ",Ji(D.extraExpenses)]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Total final"}),i.jsxs("div",{className:"text-base font-black",children:["$ ",Ji(D.totalFinal)]})]}),D.comment?i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Comentario"}),i.jsx("div",{className:"text-sm text-gray-800",children:D.comment})]}):null]}),i.jsxs("div",{className:"mt-3 flex gap-2",children:[i.jsx("button",{onClick:()=>R(D),className:"flex-1 h-10 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Editar"}),i.jsx("button",{onClick:()=>K(D.id),className:"flex-1 h-10 rounded-xl border border-gray-200 font-extrabold text-red-700 hover:bg-red-50",children:"Eliminar"})]})]},D.id)),j?i.jsxs("div",{className:"rounded-2xl border border-yellow-200 bg-yellow-50 p-3",children:[i.jsx("div",{className:"font-black text-gray-900 mb-3",children:"Editando registro"}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Fecha"}),i.jsx("input",{type:"date",value:String(S.dateInput??""),onChange:D=>E(V=>({...V,dateInput:D.target.value})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Vendedor"}),i.jsxs("select",{value:String(S.sellerId??""),onChange:D=>{const V=D.target.value,te=l.get(V);E(ve=>({...ve,sellerId:V,sellerName:(te==null?void 0:te.name)??"",commissionPercent:Ja((te==null?void 0:te.commissionPercent)??0)}))},className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white",children:[i.jsx("option",{value:"",children:"Seleccionar..."}),s.map(D=>i.jsxs("option",{value:D.id,children:[D.name," ",D.branch?`(${D.branch})`:""]},D.id))]})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Monto entregado"}),i.jsx("input",{type:"number",value:String(S.amountDelivered??""),onChange:D=>E(V=>({...V,amountDelivered:Ja(D.target.value)})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Gastos extras"}),i.jsx("input",{type:"number",value:String(S.extraExpenses??""),onChange:D=>E(V=>({...V,extraExpenses:Ja(D.target.value)})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comisin %"}),i.jsx("input",{type:"number",value:String(S.commissionPercent??""),onChange:D=>E(V=>({...V,commissionPercent:Ja(D.target.value)})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comentario"}),i.jsx("input",{type:"text",value:String(S.comment??""),onChange:D=>E(V=>({...V,comment:D.target.value})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>M(j),className:"flex-1 h-10 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800",children:"Guardar"}),i.jsx("button",{onClick:G,className:"flex-1 h-10 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Cancelar"})]})]})]}):null]})]})]})]})]})}const cp=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function zit(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function bW(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function Wit(t){const e=String(t||"").trim();if(!e)return 0;const r=Date.parse(e);return Number.isFinite(r)?r:0}function Xit({open:t,onClose:e,onDetected:r}){const n=g.useRef(null),a=g.useRef(null),[s,o]=g.useState(""),l=g.useRef("");return g.useEffect(()=>{if(!t)return;let c=!1;const d=new X2,u=()=>{var A,h,m;try{(A=a.current)==null||A.stop()}catch{}a.current=null;try{const p=(h=n.current)==null?void 0:h.srcObject;(m=p==null?void 0:p.getTracks)==null||m.call(p).forEach(x=>x.stop())}catch{}try{n.current&&(n.current.srcObject=null)}catch{}};return(async()=>{o("");try{if(!n.current)return;try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1})).getTracks().forEach(m=>m.stop())}catch{}const A=await d.decodeFromConstraints({video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1},n.current,h=>{if(!c&&h){const m=String(h.getText()||"").trim().replace(/\s+/g,"");if(!m||m===l.current)return;l.current=m,u(),r(m),e()}});a.current=A}catch(A){const h=String((A==null?void 0:A.message)||""),m=String((A==null?void 0:A.name)||"");h.toLowerCase().includes("permission")||m==="NotAllowedError"?o("Permiso de cmara denegado."):m==="NotFoundError"||h.toLowerCase().includes("notfound")?o("No se encontr cmara en este dispositivo."):h.toLowerCase().includes("secure")||h.toLowerCase().includes("https")?o("La cmara requiere HTTPS (sitio seguro)."):o(h||"No se pudo iniciar el escner.")}})(),()=>{c=!0,u()}},[t,e,r]),t?i.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 p-3 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-lg border overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[i.jsx("div",{className:"font-bold",children:"Escanear cdigo"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:e,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"relative w-full aspect-[3/4] bg-black rounded-xl overflow-hidden",children:[i.jsx("video",{ref:n,className:"w-full h-full object-cover",muted:!0,playsInline:!0,autoPlay:!0}),i.jsx("div",{className:"absolute inset-0 pointer-events-none",children:i.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[85%] h-40 border-2 border-white/70 rounded-xl"})})]}),s&&i.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded p-2",children:s}),i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Apunt al cdigo de barras y mantenelo estable."})]})]})}):null}function Yit(){const{refreshKey:t,refresh:e}=bc(),[r,n]=g.useState(!0),[a,s]=g.useState(""),[o,l]=g.useState([]),[c,d]=g.useState(""),[u,f]=g.useState(""),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState("ANY"),[y,b]=g.useState(!1),[w,I]=g.useState({});g.useEffect(()=>{(async()=>{n(!0),s("");try{const fe=await Ut(ar(xt(Ne,"candy_main_orders"))),Me=new Map;fe.forEach(ye=>{var Oe,be,Ae;const mt=ye.data(),gt=Wit(mt.date),yt=((be=(Oe=mt==null?void 0:mt.createdAt)==null?void 0:Oe.toMillis)==null?void 0:be.call(Oe))||((Ae=mt==null?void 0:mt.createdAt)!=null&&Ae.seconds?mt.createdAt.seconds*1e3:0)||0,Pt=Math.max(gt,yt),Ft=Array.isArray(mt.items)?mt.items:[];for(const Le of Ft){const ut=String((Le==null?void 0:Le.id)||(Le==null?void 0:Le.productId)||"").trim();if(!ut)continue;const ct=String((Le==null?void 0:Le.name)||(Le==null?void 0:Le.productName)||"").trim(),st=String((Le==null?void 0:Le.category)||"").trim(),z=Number((Le==null?void 0:Le.unitPriceIsla)||0),X=Number((Le==null?void 0:Le.unitPriceRivas)||0),re=Number((Le==null?void 0:Le.unitsPerPackage)||(Le==null?void 0:Le.unitsPerPack)||1),H=Me.get(ut);(!H||Pt>=H._sortKey)&&Me.set(ut,{productId:ut,category:st,productName:ct,priceIsla:z,priceRivas:X,unitsPerPackage:re,_sortKey:Pt})}});const me=Array.from(Me.values()).sort((ye,mt)=>ye.productName.localeCompare(mt.productName,"es"));l(me)}catch(fe){console.error(fe),s(" Error cargando precios desde rdenes maestras."),l([])}finally{n(!1)}})()},[t]),g.useEffect(()=>{const fe=xt(Ne,"products_candies"),Me=ar(fe),me=Fu(Me,ye=>{const mt={},gt={},yt={},Pt={};ye.forEach(Ft=>{const Oe=Ft.data();mt[Ft.id]=Number((Oe==null?void 0:Oe.providerPrice)||(Oe==null?void 0:Oe.providerPricePerUnit)||0),yt[Ft.id]=Number((Oe==null?void 0:Oe.unitsPerPackage)||(Oe==null?void 0:Oe.unitsPerPack)||1)||1;const be=String((Oe==null?void 0:Oe.barcode)||"").trim();be&&(gt[Ft.id]=be);const Ae=String((Oe==null?void 0:Oe.packaging)||(Oe==null?void 0:Oe.empaque)||"").trim();Ae&&(Pt[Ft.id]=Ae)});try{const Ft=S.current||{};let Oe=!1;for(const ut of Object.keys(gt))if((gt[ut]||"")!==(Ft[ut]||"")){Oe=!0;break}const be=B.current||{};let Ae=!1;for(const ut of Object.keys(yt))if((yt[ut]||0)!==(be[ut]||0)){Ae=!0;break}q(mt),ce(yt);const Le={...gt,...Ft};N(Le),S.current=Le,B.current={...yt},Ce(Pt),l(ut=>ut.map(ct=>({...ct,unitsPerPackage:yt[ct.productId]??ct.unitsPerPackage}))),!E.current&&Oe&&(s(" Cdigo actualizado."),setTimeout(()=>s(""),3e3)),!E.current&&Ae&&(s(" Unidades x paquete actualizadas."),setTimeout(()=>s(""),3e3)),E.current=!1}catch{q(mt),ce(yt),N(Oe=>({...gt,...Oe})),B.current={...yt},Ce(Pt),l(Oe=>Oe.map(be=>({...be,unitsPerPackage:yt[be.productId]??be.unitsPerPackage})))}},ye=>console.error(ye));return()=>me()},[]);const[j,N]=g.useState({}),S=g.useRef({}),E=g.useRef(!0),B=g.useRef({}),k=g.useRef({}),T=g.useRef(!0),[P,q]=g.useState({}),[de,ce]=g.useState({}),[le,he]=g.useState({}),[ae,Ce]=g.useState({}),[De,O]=g.useState("");g.useEffect(()=>{const fe=xt(Ne,"inventory_candies"),Me=ar(fe),me=Fu(Me,ye=>{try{const mt={};ye.forEach(yt=>{var Le,ut,ct;const Pt=yt.data(),Ft=String(Pt.productId||"").trim();if(!Ft)return;const Oe=Number(Pt.unitsPerPackage||Pt.unitsPerPack||0)||0,be=((ut=(Le=Pt==null?void 0:Pt.createdAt)==null?void 0:Le.toMillis)==null?void 0:ut.call(Le))||((ct=Pt==null?void 0:Pt.createdAt)!=null&&ct.seconds?Pt.createdAt.seconds*1e3:0)||0,Ae=mt[Ft];(!Ae||be>=Ae.ts)&&(mt[Ft]={val:Oe||0,ts:be})});const gt={};for(const yt of Object.keys(mt))gt[yt]=mt[yt].val||0;he(gt);try{const yt=k.current||{};let Pt=!1;for(const Ft of Object.keys(gt))if((gt[Ft]||0)!==(yt[Ft]||0)){Pt=!0;break}k.current={...gt},!T.current&&Pt&&(s(" Inventario: unidades por paquete actualizadas."),setTimeout(()=>s(""),3e3)),T.current=!1}catch{}l(yt=>yt.map(Pt=>({...Pt,unitsPerPackage:gt[Pt.productId]??de[Pt.productId]??Pt.unitsPerPackage})))}catch(mt){console.error("inventory_candies snapshot error:",mt)}},ye=>console.error(ye));return()=>me()},[de]),g.useEffect(()=>{l(fe=>fe.map(Me=>({...Me,unitsPerPackage:le[Me.productId]??de[Me.productId]??Me.unitsPerPackage})))},[de,le]);const R=g.useMemo(()=>{const fe=zit(c),Me=String(u||"").trim(),me=String(De||"").trim().toLowerCase(),ye=A.trim()===""?null:bW(A,NaN),mt=m.trim()===""?null:bW(m,NaN);return o.filter(gt=>{const yt=String(ae[gt.productId]||"").trim().toLowerCase();if(me)return yt===me;if(fe&&!`${gt.category} ${gt.productName}`.toLowerCase().includes(fe))return!1;if(Me){const be=String(gt.productId||""),Ae=String(j[gt.productId]||"");if(!be.includes(Me)&&!Ae.includes(Me))return!1}const Pt=x==="ISLA"?[gt.priceIsla]:x==="RIVAS"?[gt.priceRivas]:[gt.priceIsla,gt.priceRivas],Ft=ye==null||!Number.isFinite(ye)?!0:Pt.some(be=>be>=ye),Oe=mt==null||!Number.isFinite(mt)?!0:Pt.some(be=>be<=mt);return Ft&&Oe})},[o,c,A,m,x,j,De,ae]),G=g.useMemo(()=>{const fe=new Map;for(const Me of R){const me=(Me.category||"Sin categora").trim()||"Sin categora",ye=fe.get(me)||[];ye.push(Me),fe.set(me,ye)}return Array.from(fe.entries()).sort(([Me],[me])=>Me.localeCompare(me,"es"))},[R]),M=5,[K,Y]=g.useState(1),D=Math.max(1,Math.ceil(G.length/M)),V=g.useMemo(()=>{const fe=(K-1)*M;return G.slice(fe,fe+M)},[G,K]);g.useEffect(()=>{Y(1)},[c,u,A,m,x,De]),g.useEffect(()=>{Y(fe=>Math.min(fe,D))},[D]);const te=()=>Y(1),ve=()=>Y(fe=>Math.max(1,fe-1)),Q=()=>Y(fe=>Math.min(D,fe+1)),Xe=()=>Y(D),se=()=>i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:te,disabled:K===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:ve,disabled:K===1,children:" Anterior"}),i.jsxs("span",{className:"px-2 text-sm",children:["Pgina ",K," de ",D]}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Q,disabled:K===D,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Xe,disabled:K===D,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[G.length," categora(s)"]})]}),Z=fe=>{I(Me=>({...Me,[fe]:!Me[fe]}))},ke=()=>{d(""),h(""),p(""),v("ANY"),O("")},[Se,Ee]=g.useState(!1),[Ze,ot]=g.useState("search"),[vt,_t]=g.useState(null),[Tt,Lt]=g.useState(0),[Rt,Et]=g.useState(0),[Re,Te]=g.useState(null),[Ye,dt]=g.useState(""),[Fe,je]=g.useState(""),We=g.useMemo(()=>c.trim()!==""||A.trim()!==""||m.trim()!==""||x!=="ANY"||De.trim()!=="",[c,A,m,x,De]),[ee,Ve]=g.useState(!1);g.useEffect(()=>{var me;const fe=window.matchMedia("(max-width: 900px)"),Me=()=>Ve(fe.matches);return Me(),(me=fe.addEventListener)==null||me.call(fe,"change",Me),()=>{var ye;return(ye=fe.removeEventListener)==null?void 0:ye.call(fe,"change",Me)}},[]);const[rt,$e]=g.useState(!1);g.useEffect(()=>{const fe=EI(Vi,async Me=>{if(!Me)return $e(!1);try{const me=await Es(Kt(Ne,"users",Me.uid)),ye=me.exists()?me.data():null,mt=ye?Array.isArray(ye.roles)?ye.roles:ye.role?[ye.role]:[]:[];$e(Rn(mt,"admin"))}catch(me){console.error(me),$e(!1)}});return()=>fe()},[]);const ie=async fe=>{var Me;if(Ze==="search"){f(fe);const me=Object.keys(j).find(gt=>(j[gt]||"")===fe),ye=(Me=o.find(gt=>String(gt.productId||"").includes(fe)))==null?void 0:Me.productId,mt=me||ye||null;mt&&(Te(mt),b(!1)),Ee(!1);return}if(Ze==="edit"&&vt)try{const me=xt(Ne,"products_candies"),ye=Kt(me,vt);await Mn(ye,{barcode:fe}),N(mt=>({...mt,[vt]:fe})),dt(fe),Ee(!1),ot("search"),s(" Producto guardado.")}catch(me){console.error(me),s(" Error guardando el cdigo.")}},pe=async fe=>{l(Me=>Me.map(me=>me.productId===fe?{...me,priceIsla:Number(Tt||0),priceRivas:Number(Rt||0)}:me));try{const Me=String(Fe||"").trim();await Mn(Kt(xt(Ne,"products_candies"),fe),{packaging:Me||""}),Ce(me=>({...me,[fe]:Me||""}))}catch(Me){console.error("Error updating packaging:",Me),s(" Error guardando empaque.")}_t(null),s(ee?" Producto guardado.":"")};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Precio Ventas"}),i.jsx("div",{className:"flex gap-2",children:i.jsx(yc,{onClick:e,loading:r})})]}),i.jsxs("div",{className:"md:hidden mb-3",children:[i.jsxs("button",{type:"button",onClick:()=>b(fe=>!fe),className:`w-full px-3 py-3 rounded-xl border shadow-sm flex items-center justify-between ${We?"bg-yellow-50 border-yellow-200":"bg-white"}`,children:[i.jsxs("div",{className:"text-left",children:[i.jsx("div",{className:"font-semibold",children:"Filtros"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[We?"Activos":"Ninguno","  ","Mostrando ",i.jsx("b",{children:R.length})]})]}),i.jsx("div",{className:"text-sm font-semibold",children:y?"Cerrar":"Abrir"})]}),y&&i.jsx("div",{className:"mt-2 bg-white border rounded-xl shadow-sm p-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:c,onChange:fe=>d(fe.target.value),placeholder:"Ej: Conitos, Gomitas"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:De,onChange:fe=>O(fe.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Buscar por EAN"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",value:u,onChange:fe=>f(fe.target.value),placeholder:"Cdigo EAN"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{ot("search"),Ee(!0)},children:"Escanear"})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{ke(),f("")},children:"Limpiar filtros"}),i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",onClick:()=>b(!1),children:"Aplicar"})]})]})})]}),i.jsxs("div",{className:"hidden md:block bg-white p-3 rounded shadow border mb-3 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-6 gap-3 items-end",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Filtrar por producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:c,onChange:fe=>d(fe.target.value),placeholder:"Ej: Conitos, Gomitas"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:De,onChange:fe=>O(fe.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio mn"}),i.jsx("input",{className:"w-full border rounded px-2 py-1 text-right",inputMode:"decimal",value:A,onChange:fe=>h(fe.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio mx"}),i.jsx("input",{className:"w-full border rounded px-2 py-1 text-right",inputMode:"decimal",value:m,onChange:fe=>p(fe.target.value),placeholder:"0"})]}),i.jsx("div",{className:"text-right",children:i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:ke,children:"Limpiar"})})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Fuente: ",i.jsx("b",{children:"candy_main_orders.items[]"}),"  Muestra el"," ",i.jsx("b",{children:"ltimo precio"})," registrado por producto."]}),i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Mostrando:"})," ",i.jsx("b",{children:R.length})]})]})]}),i.jsxs("div",{className:"md:hidden",children:[r?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Cargando"}):R.length===0?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Sin resultados."}):i.jsx("div",{className:"space-y-2",children:V.map(([fe,Me])=>{const me=!!w[fe];return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>Z(fe),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[13px] font-semibold truncate",children:fe}),i.jsxs("div",{className:"text-[10px] text-gray-600 truncate",children:[Me.length," ",Me.length===1?"producto":"productos"]})]}),i.jsx("div",{className:"text-sm font-semibold",children:me?"":"+"})]}),me&&i.jsx("div",{className:"px-3 pb-3 border-t space-y-2",children:Me.map(ye=>{const mt=Re===ye.productId,gt=vt===ye.productId,yt=P[ye.productId]||0,Pt=ye.priceIsla-yt,Ft=Pt*.25;return i.jsxs("div",{className:"bg-white border rounded-xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>Te(Oe=>Oe===ye.productId?null:ye.productId),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[13px] font-semibold truncate",children:ye.productName}),i.jsx("div",{className:"text-[10px] text-gray-600 truncate",children:ye.category})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"P. Paquete"}),i.jsx("div",{className:"text-sm font-semibold tabular-nums",children:cp(ye.priceIsla)})]})]}),mt&&i.jsx("div",{className:"px-3 pb-3 border-t",children:i.jsxs("div",{className:"pt-3 space-y-2 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Categora"}),i.jsx("div",{className:"text-sm",children:ye.category}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Unidades x paquete"}),i.jsx("div",{className:"text-sm",children:String(ye.unitsPerPackage||1)})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Precio Unidad"}),i.jsx("div",{className:"text-sm tabular-nums",children:cp(ye.priceIsla/(ye.unitsPerPackage||1))})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Precio Paquete"}),gt?i.jsx("input",{className:"w-full border rounded px-2 py-2 text-right",inputMode:"decimal",value:String(Tt),onChange:Oe=>Lt(Number(Oe.target.value||0))}):i.jsx("div",{className:"text-sm font-semibold tabular-nums",children:cp(ye.priceIsla)})]})]}),i.jsxs("div",{children:[rt&&i.jsxs("div",{children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Utilidad Bruta"}),i.jsx("div",{className:"text-sm tabular-nums",children:cp(Pt)})]}),i.jsxs("div",{className:"mt-1",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Comisin"}),i.jsx("div",{className:"text-sm tabular-nums",children:cp(Ft)})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Cdigo EAN"}),gt?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",value:Ye,readOnly:!0}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white",onClick:()=>{ot("edit"),Ee(!0)},type:"button",children:"Escanear"})]}):i.jsx("div",{children:j[ye.productId]||""})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Tipo Empaque"}),gt?i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:Fe,onChange:Oe=>je(Oe.target.value),children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):i.jsx("div",{className:"text-sm",children:ae[ye.productId]||""})]})]})]}),i.jsx("div",{className:"flex gap-2",children:gt?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white",onClick:()=>{pe(ye.productId),Te(null)},type:"button",children:"Guardar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{ot("edit"),Ee(!0)},type:"button",children:"Escanear"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200",onClick:()=>_t(null),type:"button",children:"Cancelar"})]}):rt&&i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-3 py-2 rounded bg-yellow-400",onClick:()=>{_t(ye.productId),Lt(ye.priceIsla||0),Et(ye.priceRivas||0),dt(j[ye.productId]||""),je(ae[ye.productId]||"")},type:"button",children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white",onClick:()=>l(Oe=>Oe.filter(be=>be.productId!==ye.productId)),type:"button",children:"Borrar"})]})})]})})]},ye.productId)})})]},fe)})}),!r&&G.length>0&&se(),a&&i.jsx("p",{className:"mt-2 text-sm",children:a})]}),i.jsx(Xit,{open:Se,onClose:()=>Ee(!1),onDetected:ie}),i.jsx("div",{className:"hidden md:block bg-white rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[900px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-left",children:"Empaque"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio Isla"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio Rivas"}),i.jsx("th",{className:"p-2 border text-right",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Cargando"})}):R.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Sin resultados."})}):R.map(fe=>i.jsxs("tr",{children:[i.jsx("td",{className:"p-2 border",children:fe.category}),i.jsx("td",{className:"p-2 border",children:fe.productName}),i.jsx("td",{className:"p-2 border",children:vt===fe.productId?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Fe,onChange:Me=>je(Me.target.value),children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):ae[fe.productId]||""}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:vt===fe.productId?i.jsx("input",{className:"w-24 border rounded px-2 py-1 text-right",inputMode:"decimal",value:String(Tt),onChange:Me=>Lt(Number(Me.target.value||0))}):cp(fe.priceIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:vt===fe.productId?i.jsx("input",{className:"w-24 border rounded px-2 py-1 text-right",inputMode:"decimal",value:String(Rt),onChange:Me=>Et(Number(Me.target.value||0))}):cp(fe.priceRivas)}),i.jsx("td",{className:"p-2 border text-right",children:vt===fe.productId?i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white text-sm",onClick:()=>pe(fe.productId),type:"button",children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 text-sm",onClick:()=>_t(null),type:"button",children:"Cancelar"})]}):rt&&i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 text-sm",onClick:()=>{_t(fe.productId),Lt(fe.priceIsla||0),Et(fe.priceRivas||0),dt(j[fe.productId]||"")},type:"button",children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white text-sm",onClick:()=>{_t(fe.productId),ot("edit"),Ee(!0)},type:"button",children:"Escanear"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white text-sm",onClick:()=>l(Me=>Me.filter(me=>me.productId!==fe.productId)),type:"button",children:"Borrar"})]})})]},fe.productId))})]})}),a&&i.jsx("p",{className:"hidden md:block mt-2 text-sm",children:a})]})}const H_=["Cuaderno","Block","Lapicero","Lpiz","Tajador","Borrador","Corrector","Cartucheras"],wW=["Lider","Scribe","Smarty","Pointer","Paper Mate","Otro"],GT=["Hombre","Mujer","Variado","NA"],Jit=["Universitario Cocido","5 Materia","2 Materia","Doble Raya","Rayado","Cuadriculado","Subrayado","Sublineado","Liso"],sc=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Fo(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function kc(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function FE(t,e=1){const r=Math.floor(kc(t,e));return r>0?r:e}function Nue(t){return!Number.isFinite(t)||t<=0?0:t}function KT(t){const e=String(t??"").trim();return e||""}function lf(t,e){const r=Object.keys(t||{}),n=new Map;r.forEach(a=>n.set(Fo(a),a));for(const a of e){const s=n.get(Fo(a));if(s!=null)return t[s]}}function Zit(t){return Object.values(t||{}).every(r=>Fo(r)==="")}function Sx(t){const e=Math.max(0,kc(t.providerPrice,0)),r=Math.max(1,FE(t.quantity,1)),n=Nue(kc(t.margin,0)),a=Math.max(0,kc(t.salePrice,0)),s=n>0?e/n:e,o=a>0?a:s,l=o>0?e/o:n,c=e*r,d=(o-e)*r,u=o*r;return{providerPrice:e,quantity:r,margin:l,salePrice:o,facturado:c,gain:d,totalEsperado:u}}function eot(){const{refreshKey:t,refresh:e}=bc(),[r,n]=g.useState(!0),[a,s]=g.useState(""),[o,l]=g.useState([]),[c,d]=g.useState(!1),[u,f]=g.useState(""),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(!1),[w,I]=g.useState(null),[j,N]=g.useState(!1),[S,E]=g.useState(null),[B,k]=g.useState(H_[0]),[T,P]=g.useState(wW[0]),[q,de]=g.useState(""),[ce,le]=g.useState(0),[he,ae]=g.useState(1),[Ce,De]=g.useState(.7),[O,R]=g.useState(0),[G,M]=g.useState("NA"),[K,Y]=g.useState(""),[D,V]=g.useState(""),[te,ve]=g.useState(!1),[Q,Xe]=g.useState(""),[se,Z]=g.useState([]),[ke,Se]=g.useState([]),[Ee,Ze]=g.useState(!1);g.useEffect(()=>{(async()=>{n(!0),s("");try{const ie=await Ut(ar(xt(Ne,"products_stationery"))),pe=[];ie.forEach(fe=>{const Me=fe.data();pe.push({id:fe.id,category:Me.category||"",brand:Me.brand||"",name:Me.name||"",providerPrice:Number(Me.providerPrice||0),quantity:Number(Me.quantity||1),facturado:Number(Me.facturado||0),margin:Number(Me.margin||0),salePrice:Number(Me.salePrice||0),gain:Number(Me.gain||0),gender:Me.gender||"NA",typeProduct:Me.typeProduct||"",code:Me.code??"",createdAt:Me.createdAt,updatedAt:Me.updatedAt,totalEsperado:Number(Me.totalEsperado||Number(Me.salePrice||0)*Number(Me.quantity||1))})}),l(pe)}catch(ie){console.error(ie),s(" Error cargando productos (papelera).")}finally{n(!1)}})()},[t]);const ot=g.useMemo(()=>{const ie=Fo(u),pe=Fo(A),fe=m.trim()===""?null:kc(m,NaN),Me=x.trim()===""?null:kc(x,NaN);return o.filter(me=>!(ie&&!`${me.category} ${me.name}`.toLowerCase().includes(ie)||pe&&!String(me.code||"").toLowerCase().includes(pe)||fe!=null&&Number.isFinite(fe)&&me.salePrice<fe||Me!=null&&Number.isFinite(Me)&&me.salePrice>Me))},[o,u,A,m,x]),vt=g.useMemo(()=>u.trim()!==""||A.trim()!==""||m.trim()!==""||x.trim()!=="",[u,A,m,x]),_t=g.useMemo(()=>{const ie=o.length,pe=o.reduce((me,ye)=>me+(ye.facturado||0),0),fe=o.reduce((me,ye)=>me+Number(ye.totalEsperado||Number(ye.salePrice||0)*Number(ye.quantity||1)),0),Me=o.reduce((me,ye)=>me+(ye.gain||0),0);return{count:ie,sumFact:pe,sumEsperado:fe,sumGain:Me}},[o]),Tt=()=>{k(H_[0]),de(""),le(0),ae(1),De(.7),R(0),M("NA"),Y(""),V(""),I(null)},Lt=()=>{Tt(),b(!0)},Rt=ie=>{I(ie),k(ie.category||H_[0]),P(ie.brand||wW[0]),de(ie.name||""),le(Number(ie.providerPrice||0)),ae(Number(ie.quantity||1)),De(Number(ie.margin||.7)),R(Number(ie.salePrice||0)),M(ie.gender||"NA"),Y(ie.typeProduct||""),V(String(ie.code||"")),b(!0)},Et=async()=>{s("");const ie=String(B||"").trim(),pe=String(T||"").trim(),fe=String(q||"").trim(),{providerPrice:Me,quantity:me,margin:ye,salePrice:mt,facturado:gt,totalEsperado:yt,gain:Pt}=Sx({providerPrice:ce,quantity:he,margin:Ce,salePrice:O});if(!ie)return s(" Categora requerida.");if(!fe)return s(" Producto requerido.");if(Me<=0)return s(" Precio proveedor debe ser > 0.");if(me<=0)return s(" Cantidad debe ser > 0.");if(mt<=0)return s(" Precio venta invlido.");if(ye<=0)return s(" Margen invlido.");const Ft={category:ie,brand:pe,name:fe,providerPrice:Me,quantity:me,facturado:gt,margin:ye,salePrice:mt,gain:Pt,gender:G||"NA",typeProduct:String(K||"").trim(),code:KT(D)||null,updatedAt:Nr.now(),totalEsperado:yt};try{n(!0),w?(await Mn(Kt(Ne,"products_stationery",w.id),Ft),s(" Producto actualizado.")):(await ta(xt(Ne,"products_stationery"),{...Ft,createdAt:Nr.now()}),s(" Producto creado.")),b(!1),I(null),Tt(),e()}catch(Oe){console.error(Oe),s(" Error guardando producto.")}finally{n(!1)}},Re=async()=>{var ie;try{const pe=new X2,fe=await X2.listVideoInputDevices(),Me=(ie=fe[fe.length-1])==null?void 0:ie.deviceId;if(!Me)return null;const me=document.createElement("div");me.className="fixed inset-0 z-[9999] bg-black/70 flex items-center justify-center p-3";const ye=document.createElement("div");ye.className="bg-white w-full max-w-md rounded-xl overflow-hidden shadow-xl";const mt=document.createElement("div");mt.className="p-3 flex items-center justify-between border-b",mt.innerHTML="<div style='font-weight:700'>Escanear cdigo</div>";const gt=document.createElement("button");gt.textContent="Cerrar",gt.className="px-3 py-1 rounded bg-gray-200";const yt=document.createElement("div");yt.className="p-3";const Pt=document.createElement("video");return Pt.style.width="100%",Pt.style.borderRadius="12px",yt.appendChild(Pt),mt.appendChild(gt),ye.appendChild(mt),ye.appendChild(yt),me.appendChild(ye),document.body.appendChild(me),await new Promise(async Ft=>{const Oe=()=>{me.remove(),Ft(null)};gt.onclick=Oe;const be=await pe.decodeFromVideoDevice(Me,Pt,Ae=>{if(Ae){const Le=Ae.getText();try{be.stop()}catch{}me.remove(),Ft(Le)}})})}catch(pe){return console.error(pe),null}},Te=async()=>{const ie=await Re();ie&&V(ie)},Ye=async()=>{const ie=await Re();if(!ie)return;const pe=o.find(fe=>String(fe.code||"")===String(ie));pe?(E(pe),N(!0),s("")):(E(null),N(!0),s(""))},dt=(ie,pe)=>{const fe=ie.map(ye=>({Id:ye.id,Categoria:ye.category,brand:ye.brand,Producto:ye.name,PrecioProveedor:ye.providerPrice,Cantidad:ye.quantity,Facturado:ye.facturado,TotalEsperado:ye.totalEsperado||ye.salePrice*ye.quantity,Margen:ye.margin,PrecioVenta:ye.salePrice,Ganancia:ye.gain,Genero:ye.gender,TipoProducto:ye.typeProduct,Codigo:ye.code||""})),Me=pa.json_to_sheet(fe),me=pa.book_new();pa.book_append_sheet(me,Me,"Productos"),zv(me,pe)},Fe=()=>{const ie=[{Id:"",Categoria:"Cuaderno",brand:"Lider",Producto:"Cuaderno Norma 100 hojas",PrecioProveedor:120,Cantidad:12,Margen:.7,PrecioVenta:"",Genero:"NA",TipoProducto:"Universitario Cocido",Codigo:"1234567890123"}],pe=pa.json_to_sheet(ie),fe=pa.book_new();pa.book_append_sheet(fe,pe,"Productos");const Me=I1(fe,{type:"array",bookType:"xlsx"}),me=new Blob([Me],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),ye=URL.createObjectURL(me),mt=document.createElement("a");mt.href=ye,mt.download="template_products_stationery.xlsx",document.body.appendChild(mt),mt.click(),mt.remove(),URL.revokeObjectURL(ye)},je=ie=>{const pe=[],fe=[];ie.forEach((me,ye)=>{if(!me||typeof me!="object"||Zit(me))return;const mt=ye+2,gt=String(lf(me,["Id","ID","docId","DocId"])??"").trim(),yt=String(lf(me,["Categoria","Categora","Category","category"])??"").trim(),Pt=String(lf(me,["Brand","Marca","brand","marca"])??"").trim(),Ft=String(lf(me,["Producto","Product","Nombre","Name","name"])??"").trim(),Oe=lf(me,["PrecioProveedor","Precio Prov","Precio Prov.","ProviderPrice","Costo","providerPrice"]),be=lf(me,["Cantidad","Qty","quantity","cantidad"]),Ae=lf(me,["Margen","Margin","margen","margin"]),Le=lf(me,["PrecioVenta","Precio Venta","SalePrice","salePrice"]),ut=String(lf(me,["Genero","Gnero","Gender","gender"])??"NA").trim(),ct=String(lf(me,["TipoProducto","Tipo","TypeProduct","typeProduct","Tipo producto"])??"").trim(),st=lf(me,["Codigo","Cdigo","Code","Barcode","code"]),z=KT(st),X=Math.max(0,kc(Oe,0)),re=Math.max(1,FE(be,1)),H=Nue(kc(Ae,0)),L=Math.max(0,kc(Le,0));yt||fe.push(`Fila ${mt}: falta Categoria.`),Ft||fe.push(`Fila ${mt}: falta Producto.`),X<=0&&fe.push(`Fila ${mt}: PrecioProveedor debe ser > 0.`),re<=0&&fe.push(`Fila ${mt}: Cantidad debe ser > 0.`),H<=0&&L<=0&&fe.push(`Fila ${mt}: Margen debe ser > 0 (o enviar PrecioVenta).`);const Pe=GT.includes(ut||"NA")?ut:"NA";yt&&Ft&&X>0&&re>0&&(H>0||L>0)&&pe.push({id:gt||void 0,category:yt,brand:Pt,name:Ft,providerPrice:X,quantity:re,margin:H>0?H:.7,salePrice:L>0?L:void 0,gender:Pe,typeProduct:ct,code:z||"",_raw:me})});const Me=new Map;for(const me of pe){const ye=me.id?`id::${me.id}`:`${Fo(me.category)}::${Fo(me.name)}`;Me.set(ye,me)}return{rows:Array.from(Me.values()),errors:fe}},We=async ie=>{if(s(""),Se([]),Z([]),Xe((ie==null?void 0:ie.name)||""),!ie)return;const pe=ie.name.toLowerCase(),fe=pe.endsWith(".xlsx")||pe.endsWith(".xls"),Me=pe.endsWith(".csv");if(!fe&&!Me){Se(["Solo se permiten archivos .xlsx, .xls o .csv"]);return}try{Ze(!0);const me=new FileReader,ye=await new Promise((be,Ae)=>{me.onerror=()=>Ae(new Error("No se pudo leer el archivo.")),me.onload=()=>be(me.result),me.readAsArrayBuffer(ie)}),mt=qv(new Uint8Array(ye),{type:"array"}),gt=mt.SheetNames[0],yt=mt.Sheets[gt],Pt=pa.sheet_to_json(yt,{defval:""}),{rows:Ft,errors:Oe}=je(Pt);Z(Ft),Se(Oe),Ft.length===0&&Oe.length===0&&Se(["No se encontraron filas vlidas para importar."])}catch(me){console.error(me),Se(["Error leyendo el archivo. Revis que no est corrupto."])}finally{Ze(!1)}},ee=(ie,pe)=>{Z(fe=>{const Me=[...fe],me=Me[ie];return me?(Me[ie]={...me,...pe},Me):fe})},Ve=g.useMemo(()=>{const ie=new Set(o.map(me=>me.id)),pe=new Set(o.map(me=>`${Fo(me.category)}::${Fo(me.name)}`));let fe=0,Me=0;for(const me of se){if(me.id&&ie.has(me.id)){fe+=1;continue}const ye=`${Fo(me.category)}::${Fo(me.name)}`;pe.has(ye)?fe+=1:Me+=1}return{total:se.length,willCreate:Me,willUpdate:fe}},[se,o]),rt=async()=>{if(s(""),ke.length>0){s(" Correg los errores antes de importar.");return}if(se.length===0){s(" No hay filas para importar.");return}try{Ze(!0);const ie={},pe={};o.forEach(ye=>{ie[ye.id]=ye,pe[`${Fo(ye.category)}::${Fo(ye.name)}`]=ye});const fe=Lc(Ne);let Me=0,me=0;for(const ye of se){const mt=String(ye.category||"").trim(),gt=String(ye.name||"").trim(),{providerPrice:yt,quantity:Pt,margin:Ft,salePrice:Oe,facturado:be,totalEsperado:Ae,gain:Le}=Sx({providerPrice:ye.providerPrice,quantity:ye.quantity,margin:ye.margin,salePrice:ye.salePrice});if(!mt||!gt||yt<=0||Pt<=0||Oe<=0||Ft<=0)continue;const ut={category:mt,name:gt,providerPrice:yt,quantity:Pt,facturado:be,totalEsperado:Ae,margin:Ft,salePrice:Oe,gain:Le,gender:ye.gender||"NA",typeProduct:String(ye.typeProduct||"").trim(),code:KT(ye.code)||null,updatedAt:Nr.now()};let ct;if(ye.id&&ie[ye.id])ct=ie[ye.id];else{const st=`${Fo(mt)}::${Fo(gt)}`;ct=pe[st]}if(ct)fe.update(Kt(Ne,"products_stationery",ct.id),ut),me+=1;else{const st=Kt(xt(Ne,"products_stationery"));fe.set(st,{...ut,createdAt:Nr.now()}),Me+=1}}await fe.commit(),s(` Importacin lista. Creados: ${Me}, Actualizados: ${me}`),ve(!1),Z([]),Se([]),Xe(""),e()}catch(ie){console.error(ie),s(" Error importando productos a Firestore.")}finally{Ze(!1)}},$e=()=>{f(""),h(""),p(""),v("")};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Papelera"}),i.jsxs("div",{className:"flex gap-2 flex-wrap justify-end",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-900 text-white hover:bg-black",onClick:Ye,type:"button",children:"Escanear"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:Lt,type:"button",children:"+ Nuevo"}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",onClick:()=>{ve(!0),Z([]),Se([]),Xe("")},type:"button",children:"Importar (.xlsx)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>dt(o,"products_stationery_todo.xlsx"),type:"button",children:"Exportar (todo)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>dt(ot,"products_stationery_filtrado.xlsx"),type:"button",children:"Exportar (filtrado)"}),i.jsx(yc,{onClick:e,loading:r||Ee})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[i.jsx($_,{label:"Productos",value:_t.count}),i.jsx($_,{label:"Facturado",value:sc(_t.sumFact)}),i.jsx($_,{label:"Esperado",value:sc(_t.sumEsperado)}),i.jsx($_,{label:"Ganancia",value:sc(_t.sumGain)})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{className:`w-full md:w-auto px-3 py-2 rounded border bg-white hover:bg-gray-50 ${vt?"border-yellow-300 bg-yellow-50":""}`,type:"button",onClick:()=>d(ie=>!ie),children:[c?"Cerrar filtros":"Abrir filtros"," ",vt?"(activos)":""]}),c&&i.jsxs("div",{className:"mt-2 bg-white border rounded-xl shadow-sm p-3 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 items-end",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:u,onChange:ie=>f(ie.target.value),placeholder:"Ej: Cuaderno Norma"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cdigo"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:A,onChange:ie=>h(ie.target.value),placeholder:"Barcode"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio venta mn"}),i.jsx("input",{className:"w-full border rounded px-2 py-2 text-right",inputMode:"decimal",value:m,onChange:ie=>p(ie.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio venta mx"}),i.jsx("input",{className:"w-full border rounded px-2 py-2 text-right",inputMode:"decimal",value:x,onChange:ie=>v(ie.target.value),placeholder:"0"})]}),i.jsxs("div",{className:"md:col-span-4 flex gap-2 justify-end",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:$e,children:"Limpiar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",type:"button",onClick:()=>d(!1),children:"Aplicar"})]})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-gray-600",children:[i.jsxs("div",{children:["Mostrando: ",i.jsx("b",{children:ot.length})]}),i.jsxs("div",{children:["Coleccin: ",i.jsx("b",{children:"products_stationery"})]})]})]})]}),i.jsx("div",{className:"md:hidden space-y-2",children:r?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Cargando"}):ot.length===0?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Sin resultados."}):ot.map(ie=>i.jsxs("div",{className:"bg-white border rounded-xl p-3 shadow-sm",children:[i.jsx("div",{className:"text-xs text-gray-600",children:ie.category}),i.jsx("div",{className:"text-base font-bold leading-tight",children:ie.name}),i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Venta"}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:sc(ie.salePrice)})]}),i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Ganancia"}),i.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["Esperado:"," ",i.jsx("b",{children:sc(ie.totalEsperado||ie.salePrice*ie.quantity)})]}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:sc(ie.gain)})]})]}),i.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["Cdigo: ",i.jsx("b",{children:ie.code||""})]}),i.jsx("div",{className:"mt-2 flex gap-2",children:i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-yellow-400 hover:bg-yellow-500",type:"button",onClick:()=>Rt(ie),children:"Editar"})})]},ie.id))}),i.jsx("div",{className:"hidden md:block bg-white border rounded overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Facturado"}),i.jsx("th",{className:"p-2 border text-right",children:"Esperado"}),i.jsx("th",{className:"p-2 border text-right",children:"Margen"}),i.jsx("th",{className:"p-2 border text-right",children:"Venta"}),i.jsx("th",{className:"p-2 border text-right",children:"Ganancia"}),i.jsx("th",{className:"p-2 border text-left",children:"Gnero"}),i.jsx("th",{className:"p-2 border text-left",children:"Tipo"}),i.jsx("th",{className:"p-2 border text-left",children:"Cdigo"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:12,children:"Cargando"})}):ot.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:12,children:"Sin resultados."})}):ot.map(ie=>i.jsxs("tr",{className:"align-top",children:[i.jsx("td",{className:"p-2 border",children:ie.category}),i.jsx("td",{className:"p-2 border",children:ie.name}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:sc(ie.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:ie.quantity}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:sc(ie.facturado)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:sc(ie.totalEsperado||ie.salePrice*ie.quantity)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Number(ie.margin||0).toFixed(2)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:sc(ie.salePrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:sc(ie.gain)}),i.jsx("td",{className:"p-2 border",children:ie.gender}),i.jsx("td",{className:"p-2 border",children:ie.typeProduct}),i.jsx("td",{className:"p-2 border",children:ie.code||""}),i.jsx("td",{className:"p-2 border text-center",children:i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 hover:bg-yellow-500",type:"button",onClick:()=>Rt(ie),children:"Editar"})})]},ie.id))})]})}),a&&i.jsx("p",{className:"mt-2 text-sm",children:a}),y&&i.jsxs(NW,{onClose:()=>b(!1),title:w?"Editar producto":"Nuevo producto",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Categora"}),i.jsx("select",{className:"w-full border rounded px-2 py-2",value:B,onChange:ie=>k(ie.target.value),children:H_.map(ie=>i.jsx("option",{value:ie,children:ie},ie))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:q,onChange:ie=>de(ie.target.value),placeholder:"Ej: Cuaderno Norma..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio proveedor"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-2 text-right",value:Number.isNaN(ce)?"":ce,onChange:ie=>le(Math.max(0,kc(ie.target.value,0)))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cantidad"}),i.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-2 text-right",value:he,onChange:ie=>ae(FE(ie.target.value,1))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Facturado (auto)"}),i.jsx("div",{className:"w-full border rounded px-2 py-2 text-right bg-gray-50 tabular-nums",children:sc(Sx({providerPrice:ce,quantity:he,margin:Ce,salePrice:O}).facturado)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Margen"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-2 text-right",value:Number.isNaN(Ce)?"":Ce,onChange:ie=>De(Math.max(0,kc(ie.target.value,0)))}),i.jsx("div",{className:"text-[11px] text-gray-600 mt-1",children:"Ej: 0.70 / 0.80"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio venta (editable)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-2 text-right",value:Number.isNaN(Sx({providerPrice:ce,quantity:he,margin:Ce,salePrice:O}).salePrice)?"":Sx({providerPrice:ce,quantity:he,margin:Ce,salePrice:O}).salePrice,onChange:ie=>{R(Math.max(0,kc(ie.target.value,0)))}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Ganancia (auto)"}),i.jsx("div",{className:"w-full border rounded px-2 py-2 text-right bg-gray-50 tabular-nums",children:sc(Sx({providerPrice:ce,quantity:he,margin:Ce,salePrice:O}).gain)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Gnero"}),i.jsx("select",{className:"w-full border rounded px-2 py-2",value:G,onChange:ie=>M(ie.target.value),children:GT.map(ie=>i.jsx("option",{value:ie,children:ie},ie))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo producto"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:K,onChange:ie=>Y(ie.target.value),children:[i.jsx("option",{value:"",children:""}),Jit.map(ie=>i.jsx("option",{value:ie,children:ie},ie))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Cdigo"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",value:D,onChange:ie=>V(ie.target.value),placeholder:"Escane o peg el cdigo"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:Te,children:"Escanear"})]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:()=>{b(!1),I(null)},children:"Cancelar"}),i.jsx("button",{className:"px-4 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",type:"button",onClick:Et,disabled:r,children:"Guardar"})]})]}),j&&i.jsx(NW,{onClose:()=>N(!1),title:"Resultado de escaneo",children:S?i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"text-xs text-gray-600",children:S.category}),i.jsx("div",{className:"text-lg font-bold",children:S.name}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Precio venta"}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:sc(S.salePrice)})]}),i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Ganancia"}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:sc(S.gain)})]})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"rounded-lg border p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Proveedor"}),i.jsx("div",{className:"font-semibold tabular-nums",children:sc(S.providerPrice)})]}),i.jsxs("div",{className:"rounded-lg border p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Cantidad"}),i.jsx("div",{className:"font-semibold tabular-nums",children:S.quantity})]}),i.jsxs("div",{className:"rounded-lg border p-2 col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Cdigo"}),i.jsx("div",{className:"font-semibold tabular-nums",children:S.code||""})]})]}),i.jsx("div",{className:"mt-4 flex justify-end",children:i.jsx("button",{className:"px-4 py-2 rounded bg-yellow-400 hover:bg-yellow-500",type:"button",onClick:()=>{N(!1),Rt(S)},children:"Editar"})})]}):i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"font-semibold",children:"No encontrado"}),i.jsxs("div",{className:"text-gray-600 mt-1",children:["Ese cdigo no existe en ",i.jsx("b",{children:"products_stationery"}),"."]})]})}),te&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-6xl max-h-[90vh] overflow-y-auto rounded shadow-lg p-5 text-sm",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Importar papelera (.xlsx / .csv)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ve(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:[i.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-end md:justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"1) Sub tu archivo"}),i.jsx("div",{className:"text-xs text-gray-600",children:"Columnas esperadas: Id (opcional), Categoria, Producto, PrecioProveedor, Cantidad, Margen (o PrecioVenta), Genero, TipoProducto, Codigo."})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:Fe,type:"button",children:"Descargar template .xlsx"})]}),i.jsxs("div",{className:"mt-3 flex flex-col md:flex-row gap-3 md:items-center",children:[i.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:ie=>{var pe;return We(((pe=ie.target.files)==null?void 0:pe[0])||null)}}),Q&&i.jsxs("span",{className:"text-xs text-gray-600",children:["Archivo: ",i.jsx("b",{children:Q})]}),Ee&&i.jsx("span",{className:"text-xs",children:"Procesando"})]})]}),ke.length>0&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3 mb-3",children:[i.jsx("div",{className:"font-semibold text-red-700 mb-2",children:"Errores encontrados"}),i.jsx("ul",{className:"list-disc pl-5 text-red-700 text-xs space-y-1",children:ke.slice(0,60).map((ie,pe)=>i.jsx("li",{children:ie},pe))})]}),i.jsxs("div",{className:"bg-white border rounded p-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"2) Previsualizacin (editable)"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Se importarn ",Ve.total," filas (Crear:"," ",Ve.willCreate," / Actualizar:"," ",Ve.willUpdate,")"]})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50",onClick:rt,disabled:Ee||se.length===0||ke.length>0,type:"button",children:"Importar a Firestore"})]}),i.jsxs("div",{className:"overflow-x-auto border rounded",children:[i.jsxs("table",{className:"min-w-[1500px] w-full text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Id (opcional)"}),i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Margen"}),i.jsx("th",{className:"p-2 border text-right",children:"PrecioVenta"}),i.jsx("th",{className:"p-2 border text-left",children:"Gnero"}),i.jsx("th",{className:"p-2 border text-left",children:"Tipo"}),i.jsx("th",{className:"p-2 border text-left",children:"Cdigo"}),i.jsx("th",{className:"p-2 border text-center",children:"Accin"})]})}),i.jsx("tbody",{children:se.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center text-gray-500",children:"Sub un archivo para ver la previsualizacin."})}):se.slice(0,300).map((ie,pe)=>{const fe=ie.id?o.some(ye=>ye.id===ie.id):!1,Me=o.some(ye=>`${Fo(ye.category)}::${Fo(ye.name)}`==`${Fo(ie.category)}::${Fo(ie.name)}`),me=fe||Me;return i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:ie.id||"",onChange:ye=>ee(pe,{id:ye.target.value.trim()||void 0}),placeholder:"docId (update exacto)"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-44 border rounded px-2 py-1",value:ie.category,onChange:ye=>ee(pe,{category:ye.target.value})})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-72 border rounded px-2 py-1",value:ie.name,onChange:ye=>ee(pe,{name:ye.target.value})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",className:"w-28 border rounded px-2 py-1 text-right",value:ie.providerPrice,onChange:ye=>ee(pe,{providerPrice:Math.max(0,kc(ye.target.value,0))})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:ie.quantity,onChange:ye=>ee(pe,{quantity:FE(ye.target.value,1)})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",className:"w-24 border rounded px-2 py-1 text-right",value:ie.margin,onChange:ye=>ee(pe,{margin:Math.max(0,kc(ye.target.value,0))})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",className:"w-28 border rounded px-2 py-1 text-right",value:ie.salePrice??"",onChange:ye=>ee(pe,{salePrice:Math.max(0,kc(ye.target.value,0))||void 0}),placeholder:"Opcional"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("select",{className:"w-28 border rounded px-2 py-1",value:ie.gender,onChange:ye=>ee(pe,{gender:ye.target.value}),children:GT.map(ye=>i.jsx("option",{value:ye,children:ye},ye))})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:ie.typeProduct,onChange:ye=>ee(pe,{typeProduct:ye.target.value})})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:ie.code||"",onChange:ye=>ee(pe,{code:ye.target.value})})}),i.jsx("td",{className:"p-2 border text-center",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] ${me?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:me?"ACTUALIZA":"CREA"})})]},`${ie.id||""}-${pe}`)})})]}),se.length>300&&i.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:["Mostrando 300 de ",se.length," filas (importa todas)."]})]})]})]})})]})}function $_({label:t,value:e}){return i.jsxs("div",{className:"bg-white border rounded p-3 shadow-sm",children:[i.jsx("div",{className:"text-xs text-gray-500",children:t}),i.jsx("div",{className:"text-lg font-extrabold",children:e})]})}function NW({title:t,children:e,onClose:r}){return i.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-3xl p-4 relative",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:t}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:r,type:"button",children:"Cerrar"})]}),e]})})}function tot(){const[t,e]=g.useState(!1);return g.useEffect(()=>{var a;const r=window.matchMedia("(max-width: 900px)"),n=()=>e(r.matches);return n(),(a=r.addEventListener)==null||a.call(r,"change",n),()=>{var s;return(s=r.removeEventListener)==null?void 0:s.call(r,"change",n)}},[]),t}function rot(){const[t,e]=g.useState(null),[r,n]=g.useState(""),[a,s]=g.useState([]),[o,l]=g.useState(""),[c,d]=g.useState(!0),u=tot(),f=g.useMemo(()=>u?i.jsx(xbe,{role:r,roles:a}):i.jsx(gbe,{role:r,roles:a}),[u,r,a]),A=(t==null?void 0:t.email)||"";if(g.useEffect(()=>{const m=EI(Vi,async p=>{if(d(!0),p){e(p);try{const x=Kt(Ne,"users",p.uid),v=await Es(x);if(v.exists()){const y=v.data(),b=Array.isArray(y.roles)?y.roles:y.role?[y.role]:[],w=y.sellerCandyId||"";s(b),n(b[0]||""),l(w||"")}else n(""),s([]),l("")}catch{n(""),l("")}}else e(null),n(""),l("");d(!1)});return()=>m()},[]),c)return i.jsx("div",{className:"p-6 text-center",children:"Cargando..."});const h=()=>{const m=a&&a.length?a:r;return Rn(m,"admin")?i.jsx(Uh,{to:"financialDashboard",replace:!0}):Rn(m,"vendedor_pollo")?i.jsx(Uh,{to:"salesV2",replace:!0}):Rn(m,"supervisor_pollo")?i.jsx(Uh,{to:"batches",replace:!0}):Rn(m,"contador")?i.jsx(Uh,{to:"batches",replace:!0}):Rn(m,"vendedor_ropa")?i.jsx(Uh,{to:"salesClothes",replace:!0}):Rn(m,"vendedor_dulces")?i.jsx(Uh,{to:"salesCandies",replace:!0}):i.jsx(Uh,{to:"/",replace:!0})};return i.jsx(X0e,{children:i.jsxs(S0e,{children:[i.jsx(qn,{path:"/",element:i.jsx(hbe,{})}),i.jsxs(qn,{path:"/admin",element:i.jsx(sa,{allowedRoles:["admin","vendedor_pollo","vendedor_ropa","vendedor_dulces","supervisor_pollo","contador"],children:f}),children:[i.jsx(qn,{index:!0,element:i.jsx(h,{})}),i.jsx(qn,{path:"bills",element:i.jsx(sa,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx($Pe,{role:r,roles:a})})}),i.jsx(qn,{path:"salesV2",element:i.jsx(sa,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(cH,{user:t})})}),i.jsx(qn,{path:"financialDashboard",element:i.jsx(sa,{allowedRoles:["admin","contador","supervisor_pollo"],children:i.jsx(V3e,{})})}),i.jsx(qn,{path:"expenses",element:i.jsx(sa,{allowedRoles:["admin","contador"],children:i.jsx($3e,{})})}),i.jsx(qn,{path:"polloCashAudits",element:i.jsx(sa,{allowedRoles:["admin","contador"],children:i.jsx(uLe,{})})}),i.jsx(qn,{path:"statusAccount",element:i.jsx(sa,{allowedRoles:["admin","contador"],children:i.jsx(pLe,{role:r,roles:a})})}),i.jsx(qn,{path:"transactionsPollo",element:i.jsx(sa,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(J3e,{role:r,roles:a})})}),i.jsx(qn,{path:"batches",element:i.jsx(sa,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(L3e,{role:r,roles:a})})}),i.jsx(qn,{path:"paidBatches",element:i.jsx(sa,{allowedRoles:["admin"],children:i.jsx(r4e,{})})}),i.jsx(qn,{path:"fix",element:i.jsx(sa,{allowedRoles:["admin"],children:i.jsx(q3e,{})})}),i.jsx(qn,{path:"billing",element:i.jsx(sa,{allowedRoles:["admin","contador"],children:i.jsx(hLe,{})})}),i.jsx(qn,{path:"transactionclose",element:i.jsx(sa,{allowedRoles:["admin"],children:i.jsx(U3e,{})})}),i.jsx(qn,{path:"billhistoric",element:i.jsx(sa,{allowedRoles:["admin"],children:i.jsx(GPe,{})})}),i.jsx(qn,{path:"users",element:i.jsx(sa,{allowedRoles:["admin"],children:i.jsx(KPe,{})})}),i.jsx(qn,{path:"products",element:i.jsx(sa,{allowedRoles:["admin"],children:i.jsx(qPe,{})})}),i.jsx(qn,{path:"customersPollo",element:i.jsx(sa,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(zLe,{role:r,roles:a,currentUserEmail:A,sellerPolloId:o})})}),i.jsx(qn,{path:"datacenter",element:i.jsx(sa,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx($Ve,{})})}),i.jsx(qn,{path:"productsCandies",element:i.jsx(sa,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx($Qe,{})})}),i.jsx(qn,{path:"mainordersCandies",element:i.jsx(sa,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(SVe,{})})}),i.jsx(qn,{path:"productsPricesCandies",element:i.jsx(sa,{roles:a,allowedRoles:["admin","vendedor_dulces"],children:i.jsx(Yit,{})})}),i.jsx(qn,{path:"inventoryMainOrderCandies",element:i.jsx(sa,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(jVe,{})})}),i.jsx(qn,{path:"inventoryCandies",element:i.jsx(sa,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(YQe,{})})}),i.jsx(qn,{path:"billingsCandies",element:i.jsx(sa,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(MVe,{})})}),i.jsx(qn,{path:"cashDeliveries",element:i.jsx(sa,{allowedRoles:["admin"],children:i.jsx(qit,{})})}),i.jsx(qn,{path:"customersCandies",element:i.jsx(sa,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(JQe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(qn,{path:"salesCandies",element:i.jsx(sa,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(aVe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(qn,{path:"expensesCandies",element:i.jsx(sa,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(sVe,{})})}),i.jsx(qn,{path:"dashboardCandies",element:i.jsx(sa,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(AVe,{})})}),i.jsx(qn,{path:"transactionCandies",element:i.jsx(sa,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(cVe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(qn,{path:"vendorsCandies",element:i.jsx(sa,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(mVe,{})})}),i.jsx(qn,{path:"productsVendorsCandies",element:i.jsx(sa,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(wVe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(qn,{path:"cierreVentasCandies",element:i.jsx(sa,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(TVe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(qn,{path:"reporteCierresCandies",element:i.jsx(sa,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(UVe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(qn,{path:"consolidatedVendors",element:i.jsx(sa,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(DVe,{})})}),i.jsx(qn,{path:"salesClothes",element:i.jsx(sa,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(DLe,{})})}),i.jsx(qn,{path:"notebooksInventory",element:i.jsx(sa,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(eot,{})})}),i.jsx(qn,{path:"TransactionsReportClothes",element:i.jsx(sa,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(KLe,{})})}),i.jsx(qn,{path:"financialDashboardClothes",element:i.jsx(sa,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(LLe,{})})}),i.jsx(qn,{path:"ExpensesClothes",element:i.jsx(sa,{allowedRoles:["admin"],children:i.jsx(ULe,{})})}),i.jsx(qn,{path:"inventoryClothesBatches",element:i.jsx(sa,{allowedRoles:["admin"],children:i.jsx(yLe,{})})}),i.jsx(qn,{path:"productsClothes",element:i.jsx(sa,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(TLe,{})})}),i.jsx(qn,{path:"CustomersClothes",element:i.jsx(sa,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(kLe,{})})})]}),i.jsx(qn,{path:"/salesV2",element:i.jsx(sa,{allowedRoles:["admin","vendedor_pollo","contador"],children:i.jsx(cH,{user:t})})}),i.jsx(qn,{path:"*",element:i.jsx(Uh,{to:"/"})})]})})}fbe.then(t=>{console.info("Auth persistence mode:",t)}).catch(()=>{}).finally(()=>{qT.createRoot(document.getElementById("root")).render(i.jsx(wi.StrictMode,{children:i.jsx(rot,{})}))});export{ms as _,aot as c,kA as g};
