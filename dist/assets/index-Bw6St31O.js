var Ide=Object.defineProperty;var jde=(t,e,r)=>e in t?Ide(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var pr=(t,e,r)=>jde(t,typeof e!="symbol"?e+"":e,r);function Pde(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in t)){const s=Object.getOwnPropertyDescriptor(n,a);s&&Object.defineProperty(t,a,s.get?s:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var uit=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function mA(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var $z={exports:{}},UI={},Gz={exports:{}},Gn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tw=Symbol.for("react.element"),Bde=Symbol.for("react.portal"),Tde=Symbol.for("react.fragment"),kde=Symbol.for("react.strict_mode"),Fde=Symbol.for("react.profiler"),Ode=Symbol.for("react.provider"),Dde=Symbol.for("react.context"),Rde=Symbol.for("react.forward_ref"),Mde=Symbol.for("react.suspense"),Lde=Symbol.for("react.memo"),Ude=Symbol.for("react.lazy"),uL=Symbol.iterator;function Qde(t){return t===null||typeof t!="object"?null:(t=uL&&t[uL]||t["@@iterator"],typeof t=="function"?t:null)}var Kz={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},qz=Object.assign,zz={};function Gv(t,e,r){this.props=t,this.context=e,this.refs=zz,this.updater=r||Kz}Gv.prototype.isReactComponent={};Gv.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Gv.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Wz(){}Wz.prototype=Gv.prototype;function oO(t,e,r){this.props=t,this.context=e,this.refs=zz,this.updater=r||Kz}var lO=oO.prototype=new Wz;lO.constructor=oO;qz(lO,Gv.prototype);lO.isPureReactComponent=!0;var dL=Array.isArray,Xz=Object.prototype.hasOwnProperty,cO={current:null},Yz={key:!0,ref:!0,__self:!0,__source:!0};function Jz(t,e,r){var n,a={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)Xz.call(e,n)&&!Yz.hasOwnProperty(n)&&(a[n]=e[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:tw,type:t,key:s,ref:o,props:a,_owner:cO.current}}function Vde(t,e){return{$$typeof:tw,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function uO(t){return typeof t=="object"&&t!==null&&t.$$typeof===tw}function Hde(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var fL=/\/+/g;function B4(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Hde(""+t.key):e.toString(36)}function S_(t,e,r,n,a){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case tw:case Bde:o=!0}}if(o)return o=t,a=a(o),t=n===""?"."+B4(o,0):n,dL(a)?(r="",t!=null&&(r=t.replace(fL,"$&/")+"/"),S_(a,e,r,"",function(u){return u})):a!=null&&(uO(a)&&(a=Vde(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(fL,"$&/")+"/")+t)),e.push(a)),1;if(o=0,n=n===""?".":n+":",dL(t))for(var l=0;l<t.length;l++){s=t[l];var c=n+B4(s,l);o+=S_(s,e,r,c,a)}else if(c=Qde(t),typeof c=="function")for(t=c.call(t),l=0;!(s=t.next()).done;)s=s.value,c=n+B4(s,l++),o+=S_(s,e,r,c,a);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function EN(t,e,r){if(t==null)return t;var n=[],a=0;return S_(t,n,"","",function(s){return e.call(r,s,a++)}),n}function $de(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ac={current:null},I_={transition:null},Gde={ReactCurrentDispatcher:Ac,ReactCurrentBatchConfig:I_,ReactCurrentOwner:cO};function Zz(){throw Error("act(...) is not supported in production builds of React.")}Gn.Children={map:EN,forEach:function(t,e,r){EN(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return EN(t,function(){e++}),e},toArray:function(t){return EN(t,function(e){return e})||[]},only:function(t){if(!uO(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Gn.Component=Gv;Gn.Fragment=Tde;Gn.Profiler=Fde;Gn.PureComponent=oO;Gn.StrictMode=kde;Gn.Suspense=Mde;Gn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Gde;Gn.act=Zz;Gn.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=qz({},t.props),a=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=cO.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)Xz.call(e,c)&&!Yz.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:tw,type:t.type,key:a,ref:s,props:n,_owner:o}};Gn.createContext=function(t){return t={$$typeof:Dde,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Ode,_context:t},t.Consumer=t};Gn.createElement=Jz;Gn.createFactory=function(t){var e=Jz.bind(null,t);return e.type=t,e};Gn.createRef=function(){return{current:null}};Gn.forwardRef=function(t){return{$$typeof:Rde,render:t}};Gn.isValidElement=uO;Gn.lazy=function(t){return{$$typeof:Ude,_payload:{_status:-1,_result:t},_init:$de}};Gn.memo=function(t,e){return{$$typeof:Lde,type:t,compare:e===void 0?null:e}};Gn.startTransition=function(t){var e=I_.transition;I_.transition={};try{t()}finally{I_.transition=e}};Gn.unstable_act=Zz;Gn.useCallback=function(t,e){return Ac.current.useCallback(t,e)};Gn.useContext=function(t){return Ac.current.useContext(t)};Gn.useDebugValue=function(){};Gn.useDeferredValue=function(t){return Ac.current.useDeferredValue(t)};Gn.useEffect=function(t,e){return Ac.current.useEffect(t,e)};Gn.useId=function(){return Ac.current.useId()};Gn.useImperativeHandle=function(t,e,r){return Ac.current.useImperativeHandle(t,e,r)};Gn.useInsertionEffect=function(t,e){return Ac.current.useInsertionEffect(t,e)};Gn.useLayoutEffect=function(t,e){return Ac.current.useLayoutEffect(t,e)};Gn.useMemo=function(t,e){return Ac.current.useMemo(t,e)};Gn.useReducer=function(t,e,r){return Ac.current.useReducer(t,e,r)};Gn.useRef=function(t){return Ac.current.useRef(t)};Gn.useState=function(t){return Ac.current.useState(t)};Gn.useSyncExternalStore=function(t,e,r){return Ac.current.useSyncExternalStore(t,e,r)};Gn.useTransition=function(){return Ac.current.useTransition()};Gn.version="18.3.1";Gz.exports=Gn;var x=Gz.exports;const ko=mA(x),Kde=Pde({__proto__:null,default:ko},[x]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qde=x,zde=Symbol.for("react.element"),Wde=Symbol.for("react.fragment"),Xde=Object.prototype.hasOwnProperty,Yde=qde.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Jde={key:!0,ref:!0,__self:!0,__source:!0};function eW(t,e,r){var n,a={},s=null,o=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)Xde.call(e,n)&&!Jde.hasOwnProperty(n)&&(a[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)a[n]===void 0&&(a[n]=e[n]);return{$$typeof:zde,type:t,key:s,ref:o,props:a,_owner:Yde.current}}UI.Fragment=Wde;UI.jsx=eW;UI.jsxs=eW;$z.exports=UI;var i=$z.exports,NB={},tW={exports:{}},Nu={},rW={exports:{}},nW={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(xe,ae){var Se=xe.length;xe.push(ae);e:for(;0<Se;){var Te=Se-1>>>1,O=xe[Te];if(0<a(O,ae))xe[Te]=ae,xe[Se]=O,Se=Te;else break e}}function r(xe){return xe.length===0?null:xe[0]}function n(xe){if(xe.length===0)return null;var ae=xe[0],Se=xe.pop();if(Se!==ae){xe[0]=Se;e:for(var Te=0,O=xe.length,G=O>>>1;Te<G;){var z=2*(Te+1)-1,L=xe[z],Z=z+1,ee=xe[Z];if(0>a(L,Se))Z<O&&0>a(ee,L)?(xe[Te]=ee,xe[Z]=Se,Te=Z):(xe[Te]=L,xe[z]=Se,Te=z);else if(Z<O&&0>a(ee,Se))xe[Te]=ee,xe[Z]=Se,Te=Z;else break e}}return ae}function a(xe,ae){var Se=xe.sortIndex-ae.sortIndex;return Se!==0?Se:xe.id-ae.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,A=3,h=!1,m=!1,p=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(xe){for(var ae=r(u);ae!==null;){if(ae.callback===null)n(u);else if(ae.startTime<=xe)n(u),ae.sortIndex=ae.expirationTime,e(c,ae);else break;ae=r(u)}}function w(xe){if(p=!1,b(xe),!m)if(r(c)!==null)m=!0,ge(j);else{var ae=r(u);ae!==null&&fe(w,ae.startTime-xe)}}function j(xe,ae){m=!1,p&&(p=!1,v(S),S=-1),h=!0;var Se=A;try{for(b(ae),f=r(c);f!==null&&(!(f.expirationTime>ae)||xe&&!k());){var Te=f.callback;if(typeof Te=="function"){f.callback=null,A=f.priorityLevel;var O=Te(f.expirationTime<=ae);ae=t.unstable_now(),typeof O=="function"?f.callback=O:f===r(c)&&n(c),b(ae)}else n(c);f=r(c)}if(f!==null)var G=!0;else{var z=r(u);z!==null&&fe(w,z.startTime-ae),G=!1}return G}finally{f=null,A=Se,h=!1}}var I=!1,_=null,S=-1,E=5,F=-1;function k(){return!(t.unstable_now()-F<E)}function P(){if(_!==null){var xe=t.unstable_now();F=xe;var ae=!0;try{ae=_(!0,xe)}finally{ae?D():(I=!1,_=null)}}else I=!1}var D;if(typeof y=="function")D=function(){y(P)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,pe=X.port2;X.port1.onmessage=P,D=function(){pe.postMessage(null)}}else D=function(){g(P,0)};function ge(xe){_=xe,I||(I=!0,D())}function fe(xe,ae){S=g(function(){xe(t.unstable_now())},ae)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(xe){xe.callback=null},t.unstable_continueExecution=function(){m||h||(m=!0,ge(j))},t.unstable_forceFrameRate=function(xe){0>xe||125<xe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<xe?Math.floor(1e3/xe):5},t.unstable_getCurrentPriorityLevel=function(){return A},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(xe){switch(A){case 1:case 2:case 3:var ae=3;break;default:ae=A}var Se=A;A=ae;try{return xe()}finally{A=Se}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(xe,ae){switch(xe){case 1:case 2:case 3:case 4:case 5:break;default:xe=3}var Se=A;A=xe;try{return ae()}finally{A=Se}},t.unstable_scheduleCallback=function(xe,ae,Se){var Te=t.unstable_now();switch(typeof Se=="object"&&Se!==null?(Se=Se.delay,Se=typeof Se=="number"&&0<Se?Te+Se:Te):Se=Te,xe){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=Se+O,xe={id:d++,callback:ae,priorityLevel:xe,startTime:Se,expirationTime:O,sortIndex:-1},Se>Te?(xe.sortIndex=Se,e(u,xe),r(c)===null&&xe===r(u)&&(p?(v(S),S=-1):p=!0,fe(w,Se-Te))):(xe.sortIndex=O,e(c,xe),m||h||(m=!0,ge(j))),xe},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(xe){var ae=A;return function(){var Se=A;A=ae;try{return xe.apply(this,arguments)}finally{A=Se}}}})(nW);rW.exports=nW;var Zde=rW.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var efe=x,xu=Zde;function vr(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var aW=new Set,Fb={};function gg(t,e){Av(t,e),Av(t+"Capture",e)}function Av(t,e){for(Fb[t]=e,t=0;t<e.length;t++)aW.add(e[t])}var Yh=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),CB=Object.prototype.hasOwnProperty,tfe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,hL={},AL={};function rfe(t){return CB.call(AL,t)?!0:CB.call(hL,t)?!1:tfe.test(t)?AL[t]=!0:(hL[t]=!0,!1)}function nfe(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function afe(t,e,r,n){if(e===null||typeof e>"u"||nfe(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function mc(t,e,r,n,a,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var hl={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){hl[t]=new mc(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];hl[e]=new mc(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){hl[t]=new mc(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){hl[t]=new mc(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){hl[t]=new mc(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){hl[t]=new mc(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){hl[t]=new mc(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){hl[t]=new mc(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){hl[t]=new mc(t,5,!1,t.toLowerCase(),null,!1,!1)});var dO=/[\-:]([a-z])/g;function fO(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(dO,fO);hl[e]=new mc(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(dO,fO);hl[e]=new mc(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(dO,fO);hl[e]=new mc(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){hl[t]=new mc(t,1,!1,t.toLowerCase(),null,!1,!1)});hl.xlinkHref=new mc("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){hl[t]=new mc(t,1,!1,t.toLowerCase(),null,!0,!0)});function hO(t,e,r,n){var a=hl.hasOwnProperty(e)?hl[e]:null;(a!==null?a.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(afe(e,r,a,n)&&(r=null),n||a===null?rfe(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):a.mustUseProperty?t[a.propertyName]=r===null?a.type===3?!1:"":r:(e=a.attributeName,n=a.attributeNamespace,r===null?t.removeAttribute(e):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var pA=efe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,SN=Symbol.for("react.element"),Ix=Symbol.for("react.portal"),jx=Symbol.for("react.fragment"),AO=Symbol.for("react.strict_mode"),_B=Symbol.for("react.profiler"),sW=Symbol.for("react.provider"),iW=Symbol.for("react.context"),mO=Symbol.for("react.forward_ref"),EB=Symbol.for("react.suspense"),SB=Symbol.for("react.suspense_list"),pO=Symbol.for("react.memo"),f0=Symbol.for("react.lazy"),oW=Symbol.for("react.offscreen"),mL=Symbol.iterator;function U1(t){return t===null||typeof t!="object"?null:(t=mL&&t[mL]||t["@@iterator"],typeof t=="function"?t:null)}var Xs=Object.assign,T4;function Ny(t){if(T4===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);T4=e&&e[1]||""}return`
`+T4+t}var k4=!1;function F4(t,e){if(!t||k4)return"";k4=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),s=n.stack.split(`
`),o=a.length-1,l=s.length-1;1<=o&&0<=l&&a[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==s[l]){var c=`
`+a[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{k4=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Ny(t):""}function sfe(t){switch(t.tag){case 5:return Ny(t.type);case 16:return Ny("Lazy");case 13:return Ny("Suspense");case 19:return Ny("SuspenseList");case 0:case 2:case 15:return t=F4(t.type,!1),t;case 11:return t=F4(t.type.render,!1),t;case 1:return t=F4(t.type,!0),t;default:return""}}function IB(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case jx:return"Fragment";case Ix:return"Portal";case _B:return"Profiler";case AO:return"StrictMode";case EB:return"Suspense";case SB:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case iW:return(t.displayName||"Context")+".Consumer";case sW:return(t._context.displayName||"Context")+".Provider";case mO:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case pO:return e=t.displayName||null,e!==null?e:IB(t.type)||"Memo";case f0:e=t._payload,t=t._init;try{return IB(t(e))}catch{}}return null}function ife(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return IB(e);case 8:return e===AO?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function rm(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function lW(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function ofe(t){var e=lW(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function IN(t){t._valueTracker||(t._valueTracker=ofe(t))}function cW(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=lW(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function pE(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function jB(t,e){var r=e.checked;return Xs({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function pL(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=rm(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function uW(t,e){e=e.checked,e!=null&&hO(t,"checked",e,!1)}function PB(t,e){uW(t,e);var r=rm(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?BB(t,e.type,r):e.hasOwnProperty("defaultValue")&&BB(t,e.type,rm(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function gL(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function BB(t,e,r){(e!=="number"||pE(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Cy=Array.isArray;function Xx(t,e,r,n){if(t=t.options,e){e={};for(var a=0;a<r.length;a++)e["$"+r[a]]=!0;for(r=0;r<t.length;r++)a=e.hasOwnProperty("$"+t[r].value),t[r].selected!==a&&(t[r].selected=a),a&&n&&(t[r].defaultSelected=!0)}else{for(r=""+rm(r),e=null,a=0;a<t.length;a++){if(t[a].value===r){t[a].selected=!0,n&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function TB(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(vr(91));return Xs({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function xL(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(vr(92));if(Cy(r)){if(1<r.length)throw Error(vr(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:rm(r)}}function dW(t,e){var r=rm(e.value),n=rm(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function vL(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function fW(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function kB(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?fW(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var jN,hW=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,a){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(jN=jN||document.createElement("div"),jN.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=jN.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ob(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Wy={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},lfe=["Webkit","ms","Moz","O"];Object.keys(Wy).forEach(function(t){lfe.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Wy[e]=Wy[t]})});function AW(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Wy.hasOwnProperty(t)&&Wy[t]?(""+e).trim():e+"px"}function mW(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=AW(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,a):t[r]=a}}var cfe=Xs({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function FB(t,e){if(e){if(cfe[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(vr(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(vr(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(vr(61))}if(e.style!=null&&typeof e.style!="object")throw Error(vr(62))}}function OB(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var DB=null;function gO(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var RB=null,Yx=null,Jx=null;function yL(t){if(t=aw(t)){if(typeof RB!="function")throw Error(vr(280));var e=t.stateNode;e&&(e=GI(e),RB(t.stateNode,t.type,e))}}function pW(t){Yx?Jx?Jx.push(t):Jx=[t]:Yx=t}function gW(){if(Yx){var t=Yx,e=Jx;if(Jx=Yx=null,yL(t),e)for(t=0;t<e.length;t++)yL(e[t])}}function xW(t,e){return t(e)}function vW(){}var O4=!1;function yW(t,e,r){if(O4)return t(e,r);O4=!0;try{return xW(t,e,r)}finally{O4=!1,(Yx!==null||Jx!==null)&&(vW(),gW())}}function Db(t,e){var r=t.stateNode;if(r===null)return null;var n=GI(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(vr(231,e,typeof r));return r}var MB=!1;if(Yh)try{var Q1={};Object.defineProperty(Q1,"passive",{get:function(){MB=!0}}),window.addEventListener("test",Q1,Q1),window.removeEventListener("test",Q1,Q1)}catch{MB=!1}function ufe(t,e,r,n,a,s,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(d){this.onError(d)}}var Xy=!1,gE=null,xE=!1,LB=null,dfe={onError:function(t){Xy=!0,gE=t}};function ffe(t,e,r,n,a,s,o,l,c){Xy=!1,gE=null,ufe.apply(dfe,arguments)}function hfe(t,e,r,n,a,s,o,l,c){if(ffe.apply(this,arguments),Xy){if(Xy){var u=gE;Xy=!1,gE=null}else throw Error(vr(198));xE||(xE=!0,LB=u)}}function xg(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function bW(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function bL(t){if(xg(t)!==t)throw Error(vr(188))}function Afe(t){var e=t.alternate;if(!e){if(e=xg(t),e===null)throw Error(vr(188));return e!==t?null:t}for(var r=t,n=e;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return bL(a),t;if(s===n)return bL(a),e;s=s.sibling}throw Error(vr(188))}if(r.return!==n.return)r=a,n=s;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=s;break}if(l===n){o=!0,n=a,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=a;break}if(l===n){o=!0,n=s,r=a;break}l=l.sibling}if(!o)throw Error(vr(189))}}if(r.alternate!==n)throw Error(vr(190))}if(r.tag!==3)throw Error(vr(188));return r.stateNode.current===r?t:e}function wW(t){return t=Afe(t),t!==null?NW(t):null}function NW(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=NW(t);if(e!==null)return e;t=t.sibling}return null}var CW=xu.unstable_scheduleCallback,wL=xu.unstable_cancelCallback,mfe=xu.unstable_shouldYield,pfe=xu.unstable_requestPaint,Ci=xu.unstable_now,gfe=xu.unstable_getCurrentPriorityLevel,xO=xu.unstable_ImmediatePriority,_W=xu.unstable_UserBlockingPriority,vE=xu.unstable_NormalPriority,xfe=xu.unstable_LowPriority,EW=xu.unstable_IdlePriority,QI=null,Uf=null;function vfe(t){if(Uf&&typeof Uf.onCommitFiberRoot=="function")try{Uf.onCommitFiberRoot(QI,t,void 0,(t.current.flags&128)===128)}catch{}}var Wd=Math.clz32?Math.clz32:wfe,yfe=Math.log,bfe=Math.LN2;function wfe(t){return t>>>=0,t===0?32:31-(yfe(t)/bfe|0)|0}var PN=64,BN=4194304;function _y(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function yE(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,a=t.suspendedLanes,s=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~a;l!==0?n=_y(l):(s&=o,s!==0&&(n=_y(s)))}else o=r&~a,o!==0?n=_y(o):s!==0&&(n=_y(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&a)&&(a=n&-n,s=e&-e,a>=s||a===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Wd(e),a=1<<r,n|=t[r],e&=~a;return n}function Nfe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Cfe(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,a=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Wd(s),l=1<<o,c=a[o];c===-1?(!(l&r)||l&n)&&(a[o]=Nfe(l,e)):c<=e&&(t.expiredLanes|=l),s&=~l}}function UB(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function SW(){var t=PN;return PN<<=1,!(PN&4194240)&&(PN=64),t}function D4(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function rw(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Wd(e),t[e]=r}function _fe(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var a=31-Wd(r),s=1<<a;e[a]=0,n[a]=-1,t[a]=-1,r&=~s}}function vO(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Wd(r),a=1<<n;a&e|t[n]&e&&(t[n]|=e),r&=~a}}var Ma=0;function IW(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var jW,yO,PW,BW,TW,QB=!1,TN=[],M0=null,L0=null,U0=null,Rb=new Map,Mb=new Map,x0=[],Efe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function NL(t,e){switch(t){case"focusin":case"focusout":M0=null;break;case"dragenter":case"dragleave":L0=null;break;case"mouseover":case"mouseout":U0=null;break;case"pointerover":case"pointerout":Rb.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mb.delete(e.pointerId)}}function V1(t,e,r,n,a,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},e!==null&&(e=aw(e),e!==null&&yO(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function Sfe(t,e,r,n,a){switch(e){case"focusin":return M0=V1(M0,t,e,r,n,a),!0;case"dragenter":return L0=V1(L0,t,e,r,n,a),!0;case"mouseover":return U0=V1(U0,t,e,r,n,a),!0;case"pointerover":var s=a.pointerId;return Rb.set(s,V1(Rb.get(s)||null,t,e,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,Mb.set(s,V1(Mb.get(s)||null,t,e,r,n,a)),!0}return!1}function kW(t){var e=up(t.target);if(e!==null){var r=xg(e);if(r!==null){if(e=r.tag,e===13){if(e=bW(r),e!==null){t.blockedOn=e,TW(t.priority,function(){PW(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function j_(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=VB(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);DB=n,r.target.dispatchEvent(n),DB=null}else return e=aw(r),e!==null&&yO(e),t.blockedOn=r,!1;e.shift()}return!0}function CL(t,e,r){j_(t)&&r.delete(e)}function Ife(){QB=!1,M0!==null&&j_(M0)&&(M0=null),L0!==null&&j_(L0)&&(L0=null),U0!==null&&j_(U0)&&(U0=null),Rb.forEach(CL),Mb.forEach(CL)}function H1(t,e){t.blockedOn===e&&(t.blockedOn=null,QB||(QB=!0,xu.unstable_scheduleCallback(xu.unstable_NormalPriority,Ife)))}function Lb(t){function e(a){return H1(a,t)}if(0<TN.length){H1(TN[0],t);for(var r=1;r<TN.length;r++){var n=TN[r];n.blockedOn===t&&(n.blockedOn=null)}}for(M0!==null&&H1(M0,t),L0!==null&&H1(L0,t),U0!==null&&H1(U0,t),Rb.forEach(e),Mb.forEach(e),r=0;r<x0.length;r++)n=x0[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<x0.length&&(r=x0[0],r.blockedOn===null);)kW(r),r.blockedOn===null&&x0.shift()}var Zx=pA.ReactCurrentBatchConfig,bE=!0;function jfe(t,e,r,n){var a=Ma,s=Zx.transition;Zx.transition=null;try{Ma=1,bO(t,e,r,n)}finally{Ma=a,Zx.transition=s}}function Pfe(t,e,r,n){var a=Ma,s=Zx.transition;Zx.transition=null;try{Ma=4,bO(t,e,r,n)}finally{Ma=a,Zx.transition=s}}function bO(t,e,r,n){if(bE){var a=VB(t,e,r,n);if(a===null)K4(t,e,n,wE,r),NL(t,n);else if(Sfe(a,t,e,r,n))n.stopPropagation();else if(NL(t,n),e&4&&-1<Efe.indexOf(t)){for(;a!==null;){var s=aw(a);if(s!==null&&jW(s),s=VB(t,e,r,n),s===null&&K4(t,e,n,wE,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else K4(t,e,n,null,r)}}var wE=null;function VB(t,e,r,n){if(wE=null,t=gO(n),t=up(t),t!==null)if(e=xg(t),e===null)t=null;else if(r=e.tag,r===13){if(t=bW(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return wE=t,null}function FW(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gfe()){case xO:return 1;case _W:return 4;case vE:case xfe:return 16;case EW:return 536870912;default:return 16}default:return 16}}var I0=null,wO=null,P_=null;function OW(){if(P_)return P_;var t,e=wO,r=e.length,n,a="value"in I0?I0.value:I0.textContent,s=a.length;for(t=0;t<r&&e[t]===a[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===a[s-n];n++);return P_=a.slice(t,1<n?1-n:void 0)}function B_(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function kN(){return!0}function _L(){return!1}function Cu(t){function e(r,n,a,s,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?kN:_L,this.isPropagationStopped=_L,this}return Xs(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=kN)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=kN)},persist:function(){},isPersistent:kN}),e}var Kv={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},NO=Cu(Kv),nw=Xs({},Kv,{view:0,detail:0}),Bfe=Cu(nw),R4,M4,$1,VI=Xs({},nw,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:CO,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==$1&&($1&&t.type==="mousemove"?(R4=t.screenX-$1.screenX,M4=t.screenY-$1.screenY):M4=R4=0,$1=t),R4)},movementY:function(t){return"movementY"in t?t.movementY:M4}}),EL=Cu(VI),Tfe=Xs({},VI,{dataTransfer:0}),kfe=Cu(Tfe),Ffe=Xs({},nw,{relatedTarget:0}),L4=Cu(Ffe),Ofe=Xs({},Kv,{animationName:0,elapsedTime:0,pseudoElement:0}),Dfe=Cu(Ofe),Rfe=Xs({},Kv,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Mfe=Cu(Rfe),Lfe=Xs({},Kv,{data:0}),SL=Cu(Lfe),Ufe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qfe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Vfe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Hfe(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Vfe[t])?!!e[t]:!1}function CO(){return Hfe}var $fe=Xs({},nw,{key:function(t){if(t.key){var e=Ufe[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=B_(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Qfe[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:CO,charCode:function(t){return t.type==="keypress"?B_(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?B_(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Gfe=Cu($fe),Kfe=Xs({},VI,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),IL=Cu(Kfe),qfe=Xs({},nw,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:CO}),zfe=Cu(qfe),Wfe=Xs({},Kv,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xfe=Cu(Wfe),Yfe=Xs({},VI,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Jfe=Cu(Yfe),Zfe=[9,13,27,32],_O=Yh&&"CompositionEvent"in window,Yy=null;Yh&&"documentMode"in document&&(Yy=document.documentMode);var ehe=Yh&&"TextEvent"in window&&!Yy,DW=Yh&&(!_O||Yy&&8<Yy&&11>=Yy),jL=" ",PL=!1;function RW(t,e){switch(t){case"keyup":return Zfe.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function MW(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Px=!1;function the(t,e){switch(t){case"compositionend":return MW(e);case"keypress":return e.which!==32?null:(PL=!0,jL);case"textInput":return t=e.data,t===jL&&PL?null:t;default:return null}}function rhe(t,e){if(Px)return t==="compositionend"||!_O&&RW(t,e)?(t=OW(),P_=wO=I0=null,Px=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return DW&&e.locale!=="ko"?null:e.data;default:return null}}var nhe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function BL(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!nhe[t.type]:e==="textarea"}function LW(t,e,r,n){pW(n),e=NE(e,"onChange"),0<e.length&&(r=new NO("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Jy=null,Ub=null;function ahe(t){XW(t,0)}function HI(t){var e=kx(t);if(cW(e))return t}function she(t,e){if(t==="change")return e}var UW=!1;if(Yh){var U4;if(Yh){var Q4="oninput"in document;if(!Q4){var TL=document.createElement("div");TL.setAttribute("oninput","return;"),Q4=typeof TL.oninput=="function"}U4=Q4}else U4=!1;UW=U4&&(!document.documentMode||9<document.documentMode)}function kL(){Jy&&(Jy.detachEvent("onpropertychange",QW),Ub=Jy=null)}function QW(t){if(t.propertyName==="value"&&HI(Ub)){var e=[];LW(e,Ub,t,gO(t)),yW(ahe,e)}}function ihe(t,e,r){t==="focusin"?(kL(),Jy=e,Ub=r,Jy.attachEvent("onpropertychange",QW)):t==="focusout"&&kL()}function ohe(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return HI(Ub)}function lhe(t,e){if(t==="click")return HI(e)}function che(t,e){if(t==="input"||t==="change")return HI(e)}function uhe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var nf=typeof Object.is=="function"?Object.is:uhe;function Qb(t,e){if(nf(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!CB.call(e,a)||!nf(t[a],e[a]))return!1}return!0}function FL(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function OL(t,e){var r=FL(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=FL(r)}}function VW(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?VW(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function HW(){for(var t=window,e=pE();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=pE(t.document)}return e}function EO(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function dhe(t){var e=HW(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&VW(r.ownerDocument.documentElement,r)){if(n!==null&&EO(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!t.extend&&s>n&&(a=n,n=s,s=a),a=OL(r,s);var o=OL(r,n);a&&o&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var fhe=Yh&&"documentMode"in document&&11>=document.documentMode,Bx=null,HB=null,Zy=null,$B=!1;function DL(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;$B||Bx==null||Bx!==pE(n)||(n=Bx,"selectionStart"in n&&EO(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Zy&&Qb(Zy,n)||(Zy=n,n=NE(HB,"onSelect"),0<n.length&&(e=new NO("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Bx)))}function FN(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Tx={animationend:FN("Animation","AnimationEnd"),animationiteration:FN("Animation","AnimationIteration"),animationstart:FN("Animation","AnimationStart"),transitionend:FN("Transition","TransitionEnd")},V4={},$W={};Yh&&($W=document.createElement("div").style,"AnimationEvent"in window||(delete Tx.animationend.animation,delete Tx.animationiteration.animation,delete Tx.animationstart.animation),"TransitionEvent"in window||delete Tx.transitionend.transition);function $I(t){if(V4[t])return V4[t];if(!Tx[t])return t;var e=Tx[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in $W)return V4[t]=e[r];return t}var GW=$I("animationend"),KW=$I("animationiteration"),qW=$I("animationstart"),zW=$I("transitionend"),WW=new Map,RL="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ym(t,e){WW.set(t,e),gg(e,[t])}for(var H4=0;H4<RL.length;H4++){var $4=RL[H4],hhe=$4.toLowerCase(),Ahe=$4[0].toUpperCase()+$4.slice(1);ym(hhe,"on"+Ahe)}ym(GW,"onAnimationEnd");ym(KW,"onAnimationIteration");ym(qW,"onAnimationStart");ym("dblclick","onDoubleClick");ym("focusin","onFocus");ym("focusout","onBlur");ym(zW,"onTransitionEnd");Av("onMouseEnter",["mouseout","mouseover"]);Av("onMouseLeave",["mouseout","mouseover"]);Av("onPointerEnter",["pointerout","pointerover"]);Av("onPointerLeave",["pointerout","pointerover"]);gg("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gg("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gg("onBeforeInput",["compositionend","keypress","textInput","paste"]);gg("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gg("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gg("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ey="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mhe=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ey));function ML(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,hfe(n,e,void 0,t),t.currentTarget=null}function XW(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],a=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==s&&a.isPropagationStopped())break e;ML(a,l,u),s=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==s&&a.isPropagationStopped())break e;ML(a,l,u),s=c}}}if(xE)throw t=LB,xE=!1,LB=null,t}function cs(t,e){var r=e[WB];r===void 0&&(r=e[WB]=new Set);var n=t+"__bubble";r.has(n)||(YW(e,t,2,!1),r.add(n))}function G4(t,e,r){var n=0;e&&(n|=4),YW(r,t,n,e)}var ON="_reactListening"+Math.random().toString(36).slice(2);function Vb(t){if(!t[ON]){t[ON]=!0,aW.forEach(function(r){r!=="selectionchange"&&(mhe.has(r)||G4(r,!1,t),G4(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ON]||(e[ON]=!0,G4("selectionchange",!1,e))}}function YW(t,e,r,n){switch(FW(e)){case 1:var a=jfe;break;case 4:a=Pfe;break;default:a=bO}r=a.bind(null,e,r,t),a=void 0,!MB||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),n?a!==void 0?t.addEventListener(e,r,{capture:!0,passive:a}):t.addEventListener(e,r,!0):a!==void 0?t.addEventListener(e,r,{passive:a}):t.addEventListener(e,r,!1)}function K4(t,e,r,n,a){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;o=o.return}for(;l!==null;){if(o=up(l),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}l=l.parentNode}}n=n.return}yW(function(){var u=s,d=gO(r),f=[];e:{var A=WW.get(t);if(A!==void 0){var h=NO,m=t;switch(t){case"keypress":if(B_(r)===0)break e;case"keydown":case"keyup":h=Gfe;break;case"focusin":m="focus",h=L4;break;case"focusout":m="blur",h=L4;break;case"beforeblur":case"afterblur":h=L4;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=EL;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=kfe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=zfe;break;case GW:case KW:case qW:h=Dfe;break;case zW:h=Xfe;break;case"scroll":h=Bfe;break;case"wheel":h=Jfe;break;case"copy":case"cut":case"paste":h=Mfe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=IL}var p=(e&4)!==0,g=!p&&t==="scroll",v=p?A!==null?A+"Capture":null:A;p=[];for(var y=u,b;y!==null;){b=y;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,v!==null&&(w=Db(y,v),w!=null&&p.push(Hb(y,w,b)))),g)break;y=y.return}0<p.length&&(A=new h(A,m,null,r,d),f.push({event:A,listeners:p}))}}if(!(e&7)){e:{if(A=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",A&&r!==DB&&(m=r.relatedTarget||r.fromElement)&&(up(m)||m[Jh]))break e;if((h||A)&&(A=d.window===d?d:(A=d.ownerDocument)?A.defaultView||A.parentWindow:window,h?(m=r.relatedTarget||r.toElement,h=u,m=m?up(m):null,m!==null&&(g=xg(m),m!==g||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=u),h!==m)){if(p=EL,w="onMouseLeave",v="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(p=IL,w="onPointerLeave",v="onPointerEnter",y="pointer"),g=h==null?A:kx(h),b=m==null?A:kx(m),A=new p(w,y+"leave",h,r,d),A.target=g,A.relatedTarget=b,w=null,up(d)===u&&(p=new p(v,y+"enter",m,r,d),p.target=b,p.relatedTarget=g,w=p),g=w,h&&m)t:{for(p=h,v=m,y=0,b=p;b;b=Hg(b))y++;for(b=0,w=v;w;w=Hg(w))b++;for(;0<y-b;)p=Hg(p),y--;for(;0<b-y;)v=Hg(v),b--;for(;y--;){if(p===v||v!==null&&p===v.alternate)break t;p=Hg(p),v=Hg(v)}p=null}else p=null;h!==null&&LL(f,A,h,p,!1),m!==null&&g!==null&&LL(f,g,m,p,!0)}}e:{if(A=u?kx(u):window,h=A.nodeName&&A.nodeName.toLowerCase(),h==="select"||h==="input"&&A.type==="file")var j=she;else if(BL(A))if(UW)j=che;else{j=ohe;var I=ihe}else(h=A.nodeName)&&h.toLowerCase()==="input"&&(A.type==="checkbox"||A.type==="radio")&&(j=lhe);if(j&&(j=j(t,u))){LW(f,j,r,d);break e}I&&I(t,A,u),t==="focusout"&&(I=A._wrapperState)&&I.controlled&&A.type==="number"&&BB(A,"number",A.value)}switch(I=u?kx(u):window,t){case"focusin":(BL(I)||I.contentEditable==="true")&&(Bx=I,HB=u,Zy=null);break;case"focusout":Zy=HB=Bx=null;break;case"mousedown":$B=!0;break;case"contextmenu":case"mouseup":case"dragend":$B=!1,DL(f,r,d);break;case"selectionchange":if(fhe)break;case"keydown":case"keyup":DL(f,r,d)}var _;if(_O)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Px?RW(t,r)&&(S="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(DW&&r.locale!=="ko"&&(Px||S!=="onCompositionStart"?S==="onCompositionEnd"&&Px&&(_=OW()):(I0=d,wO="value"in I0?I0.value:I0.textContent,Px=!0)),I=NE(u,S),0<I.length&&(S=new SL(S,t,null,r,d),f.push({event:S,listeners:I}),_?S.data=_:(_=MW(r),_!==null&&(S.data=_)))),(_=ehe?the(t,r):rhe(t,r))&&(u=NE(u,"onBeforeInput"),0<u.length&&(d=new SL("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=_))}XW(f,e)})}function Hb(t,e,r){return{instance:t,listener:e,currentTarget:r}}function NE(t,e){for(var r=e+"Capture",n=[];t!==null;){var a=t,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=Db(t,r),s!=null&&n.unshift(Hb(t,s,a)),s=Db(t,e),s!=null&&n.push(Hb(t,s,a))),t=t.return}return n}function Hg(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function LL(t,e,r,n,a){for(var s=e._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,a?(c=Db(r,s),c!=null&&o.unshift(Hb(r,c,l))):a||(c=Db(r,s),c!=null&&o.push(Hb(r,c,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var phe=/\r\n?/g,ghe=/\u0000|\uFFFD/g;function UL(t){return(typeof t=="string"?t:""+t).replace(phe,`
`).replace(ghe,"")}function DN(t,e,r){if(e=UL(e),UL(t)!==e&&r)throw Error(vr(425))}function CE(){}var GB=null,KB=null;function qB(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var zB=typeof setTimeout=="function"?setTimeout:void 0,xhe=typeof clearTimeout=="function"?clearTimeout:void 0,QL=typeof Promise=="function"?Promise:void 0,vhe=typeof queueMicrotask=="function"?queueMicrotask:typeof QL<"u"?function(t){return QL.resolve(null).then(t).catch(yhe)}:zB;function yhe(t){setTimeout(function(){throw t})}function q4(t,e){var r=e,n=0;do{var a=r.nextSibling;if(t.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){t.removeChild(a),Lb(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Lb(e)}function Q0(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function VL(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var qv=Math.random().toString(36).slice(2),Pf="__reactFiber$"+qv,$b="__reactProps$"+qv,Jh="__reactContainer$"+qv,WB="__reactEvents$"+qv,bhe="__reactListeners$"+qv,whe="__reactHandles$"+qv;function up(t){var e=t[Pf];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Jh]||r[Pf]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=VL(t);t!==null;){if(r=t[Pf])return r;t=VL(t)}return e}t=r,r=t.parentNode}return null}function aw(t){return t=t[Pf]||t[Jh],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function kx(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(vr(33))}function GI(t){return t[$b]||null}var XB=[],Fx=-1;function bm(t){return{current:t}}function ms(t){0>Fx||(t.current=XB[Fx],XB[Fx]=null,Fx--)}function as(t,e){Fx++,XB[Fx]=t.current,t.current=e}var nm={},Ul=bm(nm),Oc=bm(!1),Lp=nm;function mv(t,e){var r=t.type.contextTypes;if(!r)return nm;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function Dc(t){return t=t.childContextTypes,t!=null}function _E(){ms(Oc),ms(Ul)}function HL(t,e,r){if(Ul.current!==nm)throw Error(vr(168));as(Ul,e),as(Oc,r)}function JW(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in e))throw Error(vr(108,ife(t)||"Unknown",a));return Xs({},r,n)}function EE(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||nm,Lp=Ul.current,as(Ul,t),as(Oc,Oc.current),!0}function $L(t,e,r){var n=t.stateNode;if(!n)throw Error(vr(169));r?(t=JW(t,e,Lp),n.__reactInternalMemoizedMergedChildContext=t,ms(Oc),ms(Ul),as(Ul,t)):ms(Oc),as(Oc,r)}var _h=null,KI=!1,z4=!1;function ZW(t){_h===null?_h=[t]:_h.push(t)}function Nhe(t){KI=!0,ZW(t)}function wm(){if(!z4&&_h!==null){z4=!0;var t=0,e=Ma;try{var r=_h;for(Ma=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}_h=null,KI=!1}catch(a){throw _h!==null&&(_h=_h.slice(t+1)),CW(xO,wm),a}finally{Ma=e,z4=!1}}return null}var Ox=[],Dx=0,SE=null,IE=0,Ju=[],Zu=0,Up=null,Ph=1,Bh="";function qm(t,e){Ox[Dx++]=IE,Ox[Dx++]=SE,SE=t,IE=e}function eX(t,e,r){Ju[Zu++]=Ph,Ju[Zu++]=Bh,Ju[Zu++]=Up,Up=t;var n=Ph;t=Bh;var a=32-Wd(n)-1;n&=~(1<<a),r+=1;var s=32-Wd(e)+a;if(30<s){var o=a-a%5;s=(n&(1<<o)-1).toString(32),n>>=o,a-=o,Ph=1<<32-Wd(e)+a|r<<a|n,Bh=s+t}else Ph=1<<s|r<<a|n,Bh=t}function SO(t){t.return!==null&&(qm(t,1),eX(t,1,0))}function IO(t){for(;t===SE;)SE=Ox[--Dx],Ox[Dx]=null,IE=Ox[--Dx],Ox[Dx]=null;for(;t===Up;)Up=Ju[--Zu],Ju[Zu]=null,Bh=Ju[--Zu],Ju[Zu]=null,Ph=Ju[--Zu],Ju[Zu]=null}var mu=null,du=null,_s=!1,Qd=null;function tX(t,e){var r=td(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function GL(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,mu=t,du=Q0(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,mu=t,du=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Up!==null?{id:Ph,overflow:Bh}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=td(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,mu=t,du=null,!0):!1;default:return!1}}function YB(t){return(t.mode&1)!==0&&(t.flags&128)===0}function JB(t){if(_s){var e=du;if(e){var r=e;if(!GL(t,e)){if(YB(t))throw Error(vr(418));e=Q0(r.nextSibling);var n=mu;e&&GL(t,e)?tX(n,r):(t.flags=t.flags&-4097|2,_s=!1,mu=t)}}else{if(YB(t))throw Error(vr(418));t.flags=t.flags&-4097|2,_s=!1,mu=t}}}function KL(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;mu=t}function RN(t){if(t!==mu)return!1;if(!_s)return KL(t),_s=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!qB(t.type,t.memoizedProps)),e&&(e=du)){if(YB(t))throw rX(),Error(vr(418));for(;e;)tX(t,e),e=Q0(e.nextSibling)}if(KL(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(vr(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){du=Q0(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}du=null}}else du=mu?Q0(t.stateNode.nextSibling):null;return!0}function rX(){for(var t=du;t;)t=Q0(t.nextSibling)}function pv(){du=mu=null,_s=!1}function jO(t){Qd===null?Qd=[t]:Qd.push(t)}var Che=pA.ReactCurrentBatchConfig;function G1(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(vr(309));var n=r.stateNode}if(!n)throw Error(vr(147,t));var a=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=a.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(vr(284));if(!r._owner)throw Error(vr(290,t))}return t}function MN(t,e){throw t=Object.prototype.toString.call(e),Error(vr(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function qL(t){var e=t._init;return e(t._payload)}function nX(t){function e(v,y){if(t){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function r(v,y){if(!t)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function n(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function a(v,y){return v=G0(v,y),v.index=0,v.sibling=null,v}function s(v,y,b){return v.index=b,t?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function l(v,y,b,w){return y===null||y.tag!==6?(y=t3(b,v.mode,w),y.return=v,y):(y=a(y,b),y.return=v,y)}function c(v,y,b,w){var j=b.type;return j===jx?d(v,y,b.props.children,w,b.key):y!==null&&(y.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===f0&&qL(j)===y.type)?(w=a(y,b.props),w.ref=G1(v,y,b),w.return=v,w):(w=M_(b.type,b.key,b.props,null,v.mode,w),w.ref=G1(v,y,b),w.return=v,w)}function u(v,y,b,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=r3(b,v.mode,w),y.return=v,y):(y=a(y,b.children||[]),y.return=v,y)}function d(v,y,b,w,j){return y===null||y.tag!==7?(y=wp(b,v.mode,w,j),y.return=v,y):(y=a(y,b),y.return=v,y)}function f(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=t3(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case SN:return b=M_(y.type,y.key,y.props,null,v.mode,b),b.ref=G1(v,null,y),b.return=v,b;case Ix:return y=r3(y,v.mode,b),y.return=v,y;case f0:var w=y._init;return f(v,w(y._payload),b)}if(Cy(y)||U1(y))return y=wp(y,v.mode,b,null),y.return=v,y;MN(v,y)}return null}function A(v,y,b,w){var j=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return j!==null?null:l(v,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case SN:return b.key===j?c(v,y,b,w):null;case Ix:return b.key===j?u(v,y,b,w):null;case f0:return j=b._init,A(v,y,j(b._payload),w)}if(Cy(b)||U1(b))return j!==null?null:d(v,y,b,w,null);MN(v,b)}return null}function h(v,y,b,w,j){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(b)||null,l(y,v,""+w,j);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case SN:return v=v.get(w.key===null?b:w.key)||null,c(y,v,w,j);case Ix:return v=v.get(w.key===null?b:w.key)||null,u(y,v,w,j);case f0:var I=w._init;return h(v,y,b,I(w._payload),j)}if(Cy(w)||U1(w))return v=v.get(b)||null,d(y,v,w,j,null);MN(y,w)}return null}function m(v,y,b,w){for(var j=null,I=null,_=y,S=y=0,E=null;_!==null&&S<b.length;S++){_.index>S?(E=_,_=null):E=_.sibling;var F=A(v,_,b[S],w);if(F===null){_===null&&(_=E);break}t&&_&&F.alternate===null&&e(v,_),y=s(F,y,S),I===null?j=F:I.sibling=F,I=F,_=E}if(S===b.length)return r(v,_),_s&&qm(v,S),j;if(_===null){for(;S<b.length;S++)_=f(v,b[S],w),_!==null&&(y=s(_,y,S),I===null?j=_:I.sibling=_,I=_);return _s&&qm(v,S),j}for(_=n(v,_);S<b.length;S++)E=h(_,v,S,b[S],w),E!==null&&(t&&E.alternate!==null&&_.delete(E.key===null?S:E.key),y=s(E,y,S),I===null?j=E:I.sibling=E,I=E);return t&&_.forEach(function(k){return e(v,k)}),_s&&qm(v,S),j}function p(v,y,b,w){var j=U1(b);if(typeof j!="function")throw Error(vr(150));if(b=j.call(b),b==null)throw Error(vr(151));for(var I=j=null,_=y,S=y=0,E=null,F=b.next();_!==null&&!F.done;S++,F=b.next()){_.index>S?(E=_,_=null):E=_.sibling;var k=A(v,_,F.value,w);if(k===null){_===null&&(_=E);break}t&&_&&k.alternate===null&&e(v,_),y=s(k,y,S),I===null?j=k:I.sibling=k,I=k,_=E}if(F.done)return r(v,_),_s&&qm(v,S),j;if(_===null){for(;!F.done;S++,F=b.next())F=f(v,F.value,w),F!==null&&(y=s(F,y,S),I===null?j=F:I.sibling=F,I=F);return _s&&qm(v,S),j}for(_=n(v,_);!F.done;S++,F=b.next())F=h(_,v,S,F.value,w),F!==null&&(t&&F.alternate!==null&&_.delete(F.key===null?S:F.key),y=s(F,y,S),I===null?j=F:I.sibling=F,I=F);return t&&_.forEach(function(P){return e(v,P)}),_s&&qm(v,S),j}function g(v,y,b,w){if(typeof b=="object"&&b!==null&&b.type===jx&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case SN:e:{for(var j=b.key,I=y;I!==null;){if(I.key===j){if(j=b.type,j===jx){if(I.tag===7){r(v,I.sibling),y=a(I,b.props.children),y.return=v,v=y;break e}}else if(I.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===f0&&qL(j)===I.type){r(v,I.sibling),y=a(I,b.props),y.ref=G1(v,I,b),y.return=v,v=y;break e}r(v,I);break}else e(v,I);I=I.sibling}b.type===jx?(y=wp(b.props.children,v.mode,w,b.key),y.return=v,v=y):(w=M_(b.type,b.key,b.props,null,v.mode,w),w.ref=G1(v,y,b),w.return=v,v=w)}return o(v);case Ix:e:{for(I=b.key;y!==null;){if(y.key===I)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(v,y.sibling),y=a(y,b.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else e(v,y);y=y.sibling}y=r3(b,v.mode,w),y.return=v,v=y}return o(v);case f0:return I=b._init,g(v,y,I(b._payload),w)}if(Cy(b))return m(v,y,b,w);if(U1(b))return p(v,y,b,w);MN(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(v,y.sibling),y=a(y,b),y.return=v,v=y):(r(v,y),y=t3(b,v.mode,w),y.return=v,v=y),o(v)):r(v,y)}return g}var gv=nX(!0),aX=nX(!1),jE=bm(null),PE=null,Rx=null,PO=null;function BO(){PO=Rx=PE=null}function TO(t){var e=jE.current;ms(jE),t._currentValue=e}function ZB(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function ev(t,e){PE=t,PO=Rx=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Tc=!0),t.firstContext=null)}function fd(t){var e=t._currentValue;if(PO!==t)if(t={context:t,memoizedValue:e,next:null},Rx===null){if(PE===null)throw Error(vr(308));Rx=t,PE.dependencies={lanes:0,firstContext:t}}else Rx=Rx.next=t;return e}var dp=null;function kO(t){dp===null?dp=[t]:dp.push(t)}function sX(t,e,r,n){var a=e.interleaved;return a===null?(r.next=r,kO(e)):(r.next=a.next,a.next=r),e.interleaved=r,Zh(t,n)}function Zh(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var h0=!1;function FO(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function iX(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Uh(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function V0(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,sa&2){var a=n.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),n.pending=e,Zh(t,r)}return a=n.interleaved,a===null?(e.next=e,kO(n)):(e.next=a.next,a.next=e),n.interleaved=e,Zh(t,r)}function T_(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,vO(t,r)}}function zL(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?a=s=e:s=s.next=e}else a=s=e;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function BE(t,e,r,n){var a=t.updateQueue;h0=!1;var s=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(s!==null){var f=a.baseState;o=0,d=u=c=null,l=s;do{var A=l.lane,h=l.eventTime;if((n&A)===A){d!==null&&(d=d.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=t,p=l;switch(A=e,h=r,p.tag){case 1:if(m=p.payload,typeof m=="function"){f=m.call(h,f,A);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,A=typeof m=="function"?m.call(h,f,A):m,A==null)break e;f=Xs({},f,A);break e;case 2:h0=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,A=a.effects,A===null?a.effects=[l]:A.push(l))}else h={eventTime:h,lane:A,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=h,c=f):d=d.next=h,o|=A;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;A=l,l=A.next,A.next=null,a.lastBaseUpdate=A,a.shared.pending=null}}while(!0);if(d===null&&(c=f),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=d,e=a.shared.interleaved,e!==null){a=e;do o|=a.lane,a=a.next;while(a!==e)}else s===null&&(a.shared.lanes=0);Vp|=o,t.lanes=o,t.memoizedState=f}}function WL(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(vr(191,a));a.call(n)}}}var sw={},Qf=bm(sw),Gb=bm(sw),Kb=bm(sw);function fp(t){if(t===sw)throw Error(vr(174));return t}function OO(t,e){switch(as(Kb,e),as(Gb,t),as(Qf,sw),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:kB(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=kB(e,t)}ms(Qf),as(Qf,e)}function xv(){ms(Qf),ms(Gb),ms(Kb)}function oX(t){fp(Kb.current);var e=fp(Qf.current),r=kB(e,t.type);e!==r&&(as(Gb,t),as(Qf,r))}function DO(t){Gb.current===t&&(ms(Qf),ms(Gb))}var Gs=bm(0);function TE(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var W4=[];function RO(){for(var t=0;t<W4.length;t++)W4[t]._workInProgressVersionPrimary=null;W4.length=0}var k_=pA.ReactCurrentDispatcher,X4=pA.ReactCurrentBatchConfig,Qp=0,Ws=null,ro=null,To=null,kE=!1,eb=!1,qb=0,_he=0;function gl(){throw Error(vr(321))}function MO(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!nf(t[r],e[r]))return!1;return!0}function LO(t,e,r,n,a,s){if(Qp=s,Ws=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,k_.current=t===null||t.memoizedState===null?jhe:Phe,t=r(n,a),eb){s=0;do{if(eb=!1,qb=0,25<=s)throw Error(vr(301));s+=1,To=ro=null,e.updateQueue=null,k_.current=Bhe,t=r(n,a)}while(eb)}if(k_.current=FE,e=ro!==null&&ro.next!==null,Qp=0,To=ro=Ws=null,kE=!1,e)throw Error(vr(300));return t}function UO(){var t=qb!==0;return qb=0,t}function jf(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return To===null?Ws.memoizedState=To=t:To=To.next=t,To}function hd(){if(ro===null){var t=Ws.alternate;t=t!==null?t.memoizedState:null}else t=ro.next;var e=To===null?Ws.memoizedState:To.next;if(e!==null)To=e,ro=t;else{if(t===null)throw Error(vr(310));ro=t,t={memoizedState:ro.memoizedState,baseState:ro.baseState,baseQueue:ro.baseQueue,queue:ro.queue,next:null},To===null?Ws.memoizedState=To=t:To=To.next=t}return To}function zb(t,e){return typeof e=="function"?e(t):e}function Y4(t){var e=hd(),r=e.queue;if(r===null)throw Error(vr(311));r.lastRenderedReducer=t;var n=ro,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var o=a.next;a.next=s.next,s.next=o}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var l=o=null,c=null,u=s;do{var d=u.lane;if((Qp&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,Ws.lanes|=d,Vp|=d}u=u.next}while(u!==null&&u!==s);c===null?o=n:c.next=l,nf(n,e.memoizedState)||(Tc=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){a=t;do s=a.lane,Ws.lanes|=s,Vp|=s,a=a.next;while(a!==t)}else a===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function J4(t){var e=hd(),r=e.queue;if(r===null)throw Error(vr(311));r.lastRenderedReducer=t;var n=r.dispatch,a=r.pending,s=e.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do s=t(s,o.action),o=o.next;while(o!==a);nf(s,e.memoizedState)||(Tc=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function lX(){}function cX(t,e){var r=Ws,n=hd(),a=e(),s=!nf(n.memoizedState,a);if(s&&(n.memoizedState=a,Tc=!0),n=n.queue,QO(fX.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||To!==null&&To.memoizedState.tag&1){if(r.flags|=2048,Wb(9,dX.bind(null,r,n,a,e),void 0,null),Ro===null)throw Error(vr(349));Qp&30||uX(r,e,a)}return a}function uX(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Ws.updateQueue,e===null?(e={lastEffect:null,stores:null},Ws.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function dX(t,e,r,n){e.value=r,e.getSnapshot=n,hX(e)&&AX(t)}function fX(t,e,r){return r(function(){hX(e)&&AX(t)})}function hX(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!nf(t,r)}catch{return!0}}function AX(t){var e=Zh(t,1);e!==null&&Xd(e,t,1,-1)}function XL(t){var e=jf();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zb,lastRenderedState:t},e.queue=t,t=t.dispatch=Ihe.bind(null,Ws,t),[e.memoizedState,t]}function Wb(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Ws.updateQueue,e===null?(e={lastEffect:null,stores:null},Ws.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function mX(){return hd().memoizedState}function F_(t,e,r,n){var a=jf();Ws.flags|=t,a.memoizedState=Wb(1|e,r,void 0,n===void 0?null:n)}function qI(t,e,r,n){var a=hd();n=n===void 0?null:n;var s=void 0;if(ro!==null){var o=ro.memoizedState;if(s=o.destroy,n!==null&&MO(n,o.deps)){a.memoizedState=Wb(e,r,s,n);return}}Ws.flags|=t,a.memoizedState=Wb(1|e,r,s,n)}function YL(t,e){return F_(8390656,8,t,e)}function QO(t,e){return qI(2048,8,t,e)}function pX(t,e){return qI(4,2,t,e)}function gX(t,e){return qI(4,4,t,e)}function xX(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function vX(t,e,r){return r=r!=null?r.concat([t]):null,qI(4,4,xX.bind(null,e,t),r)}function VO(){}function yX(t,e){var r=hd();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&MO(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function bX(t,e){var r=hd();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&MO(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function wX(t,e,r){return Qp&21?(nf(r,e)||(r=SW(),Ws.lanes|=r,Vp|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Tc=!0),t.memoizedState=r)}function Ehe(t,e){var r=Ma;Ma=r!==0&&4>r?r:4,t(!0);var n=X4.transition;X4.transition={};try{t(!1),e()}finally{Ma=r,X4.transition=n}}function NX(){return hd().memoizedState}function She(t,e,r){var n=$0(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},CX(t))_X(e,r);else if(r=sX(t,e,r,n),r!==null){var a=cc();Xd(r,t,n,a),EX(r,e,n)}}function Ihe(t,e,r){var n=$0(t),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(CX(t))_X(e,a);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,r);if(a.hasEagerState=!0,a.eagerState=l,nf(l,o)){var c=e.interleaved;c===null?(a.next=a,kO(e)):(a.next=c.next,c.next=a),e.interleaved=a;return}}catch{}finally{}r=sX(t,e,a,n),r!==null&&(a=cc(),Xd(r,t,n,a),EX(r,e,n))}}function CX(t){var e=t.alternate;return t===Ws||e!==null&&e===Ws}function _X(t,e){eb=kE=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function EX(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,vO(t,r)}}var FE={readContext:fd,useCallback:gl,useContext:gl,useEffect:gl,useImperativeHandle:gl,useInsertionEffect:gl,useLayoutEffect:gl,useMemo:gl,useReducer:gl,useRef:gl,useState:gl,useDebugValue:gl,useDeferredValue:gl,useTransition:gl,useMutableSource:gl,useSyncExternalStore:gl,useId:gl,unstable_isNewReconciler:!1},jhe={readContext:fd,useCallback:function(t,e){return jf().memoizedState=[t,e===void 0?null:e],t},useContext:fd,useEffect:YL,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,F_(4194308,4,xX.bind(null,e,t),r)},useLayoutEffect:function(t,e){return F_(4194308,4,t,e)},useInsertionEffect:function(t,e){return F_(4,2,t,e)},useMemo:function(t,e){var r=jf();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=jf();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=She.bind(null,Ws,t),[n.memoizedState,t]},useRef:function(t){var e=jf();return t={current:t},e.memoizedState=t},useState:XL,useDebugValue:VO,useDeferredValue:function(t){return jf().memoizedState=t},useTransition:function(){var t=XL(!1),e=t[0];return t=Ehe.bind(null,t[1]),jf().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Ws,a=jf();if(_s){if(r===void 0)throw Error(vr(407));r=r()}else{if(r=e(),Ro===null)throw Error(vr(349));Qp&30||uX(n,e,r)}a.memoizedState=r;var s={value:r,getSnapshot:e};return a.queue=s,YL(fX.bind(null,n,s,t),[t]),n.flags|=2048,Wb(9,dX.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=jf(),e=Ro.identifierPrefix;if(_s){var r=Bh,n=Ph;r=(n&~(1<<32-Wd(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=qb++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=_he++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Phe={readContext:fd,useCallback:yX,useContext:fd,useEffect:QO,useImperativeHandle:vX,useInsertionEffect:pX,useLayoutEffect:gX,useMemo:bX,useReducer:Y4,useRef:mX,useState:function(){return Y4(zb)},useDebugValue:VO,useDeferredValue:function(t){var e=hd();return wX(e,ro.memoizedState,t)},useTransition:function(){var t=Y4(zb)[0],e=hd().memoizedState;return[t,e]},useMutableSource:lX,useSyncExternalStore:cX,useId:NX,unstable_isNewReconciler:!1},Bhe={readContext:fd,useCallback:yX,useContext:fd,useEffect:QO,useImperativeHandle:vX,useInsertionEffect:pX,useLayoutEffect:gX,useMemo:bX,useReducer:J4,useRef:mX,useState:function(){return J4(zb)},useDebugValue:VO,useDeferredValue:function(t){var e=hd();return ro===null?e.memoizedState=t:wX(e,ro.memoizedState,t)},useTransition:function(){var t=J4(zb)[0],e=hd().memoizedState;return[t,e]},useMutableSource:lX,useSyncExternalStore:cX,useId:NX,unstable_isNewReconciler:!1};function Ld(t,e){if(t&&t.defaultProps){e=Xs({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function eT(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Xs({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var zI={isMounted:function(t){return(t=t._reactInternals)?xg(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=cc(),a=$0(t),s=Uh(n,a);s.payload=e,r!=null&&(s.callback=r),e=V0(t,s,a),e!==null&&(Xd(e,t,a,n),T_(e,t,a))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=cc(),a=$0(t),s=Uh(n,a);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=V0(t,s,a),e!==null&&(Xd(e,t,a,n),T_(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=cc(),n=$0(t),a=Uh(r,n);a.tag=2,e!=null&&(a.callback=e),e=V0(t,a,n),e!==null&&(Xd(e,t,n,r),T_(e,t,n))}};function JL(t,e,r,n,a,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!Qb(r,n)||!Qb(a,s):!0}function SX(t,e,r){var n=!1,a=nm,s=e.contextType;return typeof s=="object"&&s!==null?s=fd(s):(a=Dc(e)?Lp:Ul.current,n=e.contextTypes,s=(n=n!=null)?mv(t,a):nm),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=zI,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=s),e}function ZL(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&zI.enqueueReplaceState(e,e.state,null)}function tT(t,e,r,n){var a=t.stateNode;a.props=r,a.state=t.memoizedState,a.refs={},FO(t);var s=e.contextType;typeof s=="object"&&s!==null?a.context=fd(s):(s=Dc(e)?Lp:Ul.current,a.context=mv(t,s)),a.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(eT(t,e,s,r),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&zI.enqueueReplaceState(a,a.state,null),BE(t,r,a,n),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function vv(t,e){try{var r="",n=e;do r+=sfe(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:a,digest:null}}function Z4(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function rT(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var The=typeof WeakMap=="function"?WeakMap:Map;function IX(t,e,r){r=Uh(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){DE||(DE=!0,fT=n),rT(t,e)},r}function jX(t,e,r){r=Uh(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var a=e.value;r.payload=function(){return n(a)},r.callback=function(){rT(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){rT(t,e),typeof n!="function"&&(H0===null?H0=new Set([this]):H0.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function eU(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new The;var a=new Set;n.set(e,a)}else a=n.get(e),a===void 0&&(a=new Set,n.set(e,a));a.has(r)||(a.add(r),t=Khe.bind(null,t,e,r),e.then(t,t))}function tU(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function rU(t,e,r,n,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Uh(-1,1),e.tag=2,V0(r,e,1))),r.lanes|=1),t)}var khe=pA.ReactCurrentOwner,Tc=!1;function nc(t,e,r,n){e.child=t===null?aX(e,null,r,n):gv(e,t.child,r,n)}function nU(t,e,r,n,a){r=r.render;var s=e.ref;return ev(e,a),n=LO(t,e,r,n,s,a),r=UO(),t!==null&&!Tc?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,eA(t,e,a)):(_s&&r&&SO(e),e.flags|=1,nc(t,e,n,a),e.child)}function aU(t,e,r,n,a){if(t===null){var s=r.type;return typeof s=="function"&&!XO(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,PX(t,e,s,n,a)):(t=M_(r.type,null,n,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&a)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Qb,r(o,n)&&t.ref===e.ref)return eA(t,e,a)}return e.flags|=1,t=G0(s,n),t.ref=e.ref,t.return=e,e.child=t}function PX(t,e,r,n,a){if(t!==null){var s=t.memoizedProps;if(Qb(s,n)&&t.ref===e.ref)if(Tc=!1,e.pendingProps=n=s,(t.lanes&a)!==0)t.flags&131072&&(Tc=!0);else return e.lanes=t.lanes,eA(t,e,a)}return nT(t,e,r,n,a)}function BX(t,e,r){var n=e.pendingProps,a=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},as(Lx,au),au|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,as(Lx,au),au|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,as(Lx,au),au|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,as(Lx,au),au|=n;return nc(t,e,a,r),e.child}function TX(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function nT(t,e,r,n,a){var s=Dc(r)?Lp:Ul.current;return s=mv(e,s),ev(e,a),r=LO(t,e,r,n,s,a),n=UO(),t!==null&&!Tc?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,eA(t,e,a)):(_s&&n&&SO(e),e.flags|=1,nc(t,e,r,a),e.child)}function sU(t,e,r,n,a){if(Dc(r)){var s=!0;EE(e)}else s=!1;if(ev(e,a),e.stateNode===null)O_(t,e),SX(e,r,n),tT(e,r,n,a),n=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=fd(u):(u=Dc(r)?Lp:Ul.current,u=mv(e,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&ZL(e,o,n,u),h0=!1;var A=e.memoizedState;o.state=A,BE(e,n,o,a),c=e.memoizedState,l!==n||A!==c||Oc.current||h0?(typeof d=="function"&&(eT(e,r,d,n),c=e.memoizedState),(l=h0||JL(e,r,l,n,A,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,iX(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Ld(e.type,l),o.props=u,f=e.pendingProps,A=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=fd(c):(c=Dc(r)?Lp:Ul.current,c=mv(e,c));var h=r.getDerivedStateFromProps;(d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||A!==c)&&ZL(e,o,n,c),h0=!1,A=e.memoizedState,o.state=A,BE(e,n,o,a);var m=e.memoizedState;l!==f||A!==m||Oc.current||h0?(typeof h=="function"&&(eT(e,r,h,n),m=e.memoizedState),(u=h0||JL(e,r,u,n,A,m,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=m),o.props=n,o.state=m,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=1024),n=!1)}return aT(t,e,r,n,s,a)}function aT(t,e,r,n,a,s){TX(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return a&&$L(e,r,!1),eA(t,e,s);n=e.stateNode,khe.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=gv(e,t.child,null,s),e.child=gv(e,null,l,s)):nc(t,e,l,s),e.memoizedState=n.state,a&&$L(e,r,!0),e.child}function kX(t){var e=t.stateNode;e.pendingContext?HL(t,e.pendingContext,e.pendingContext!==e.context):e.context&&HL(t,e.context,!1),OO(t,e.containerInfo)}function iU(t,e,r,n,a){return pv(),jO(a),e.flags|=256,nc(t,e,r,n),e.child}var sT={dehydrated:null,treeContext:null,retryLane:0};function iT(t){return{baseLanes:t,cachePool:null,transitions:null}}function FX(t,e,r){var n=e.pendingProps,a=Gs.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(a&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),as(Gs,a&1),t===null)return JB(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=YI(o,n,0,null),t=wp(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=iT(r),e.memoizedState=sT,t):HO(e,o));if(a=t.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return Fhe(t,e,o,n,l,a,r);if(s){s=n.fallback,o=e.mode,a=t.child,l=a.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==a?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=G0(a,c),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?s=G0(l,s):(s=wp(s,o,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?iT(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~r,e.memoizedState=sT,n}return s=t.child,t=s.sibling,n=G0(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function HO(t,e){return e=YI({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function LN(t,e,r,n){return n!==null&&jO(n),gv(e,t.child,null,r),t=HO(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Fhe(t,e,r,n,a,s,o){if(r)return e.flags&256?(e.flags&=-257,n=Z4(Error(vr(422))),LN(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,a=e.mode,n=YI({mode:"visible",children:n.children},a,0,null),s=wp(s,a,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&gv(e,t.child,null,o),e.child.memoizedState=iT(o),e.memoizedState=sT,s);if(!(e.mode&1))return LN(t,e,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(vr(419)),n=Z4(s,n,void 0),LN(t,e,o,n)}if(l=(o&t.childLanes)!==0,Tc||l){if(n=Ro,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,Zh(t,a),Xd(n,t,a,-1))}return WO(),n=Z4(Error(vr(421))),LN(t,e,o,n)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=qhe.bind(null,t),a._reactRetry=e,null):(t=s.treeContext,du=Q0(a.nextSibling),mu=e,_s=!0,Qd=null,t!==null&&(Ju[Zu++]=Ph,Ju[Zu++]=Bh,Ju[Zu++]=Up,Ph=t.id,Bh=t.overflow,Up=e),e=HO(e,n.children),e.flags|=4096,e)}function oU(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),ZB(t.return,e,r)}function e3(t,e,r,n,a){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function OX(t,e,r){var n=e.pendingProps,a=n.revealOrder,s=n.tail;if(nc(t,e,n.children,r),n=Gs.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&oU(t,r,e);else if(t.tag===19)oU(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(as(Gs,n),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(r=e.child,a=null;r!==null;)t=r.alternate,t!==null&&TE(t)===null&&(a=r),r=r.sibling;r=a,r===null?(a=e.child,e.child=null):(a=r.sibling,r.sibling=null),e3(e,!1,a,r,s);break;case"backwards":for(r=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&TE(t)===null){e.child=a;break}t=a.sibling,a.sibling=r,r=a,a=t}e3(e,!0,r,null,s);break;case"together":e3(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function O_(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function eA(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Vp|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(vr(153));if(e.child!==null){for(t=e.child,r=G0(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=G0(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function Ohe(t,e,r){switch(e.tag){case 3:kX(e),pv();break;case 5:oX(e);break;case 1:Dc(e.type)&&EE(e);break;case 4:OO(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,a=e.memoizedProps.value;as(jE,n._currentValue),n._currentValue=a;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(as(Gs,Gs.current&1),e.flags|=128,null):r&e.child.childLanes?FX(t,e,r):(as(Gs,Gs.current&1),t=eA(t,e,r),t!==null?t.sibling:null);as(Gs,Gs.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return OX(t,e,r);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),as(Gs,Gs.current),n)break;return null;case 22:case 23:return e.lanes=0,BX(t,e,r)}return eA(t,e,r)}var DX,oT,RX,MX;DX=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};oT=function(){};RX=function(t,e,r,n){var a=t.memoizedProps;if(a!==n){t=e.stateNode,fp(Qf.current);var s=null;switch(r){case"input":a=jB(t,a),n=jB(t,n),s=[];break;case"select":a=Xs({},a,{value:void 0}),n=Xs({},n,{value:void 0}),s=[];break;case"textarea":a=TB(t,a),n=TB(t,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=CE)}FB(r,n);var o;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var l=a[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Fb.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(l=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Fb.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&cs("scroll",t),s||l===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};MX=function(t,e,r,n){r!==n&&(e.flags|=4)};function K1(t,e){if(!_s)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function xl(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var a=t.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function Dhe(t,e,r){var n=e.pendingProps;switch(IO(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xl(e),null;case 1:return Dc(e.type)&&_E(),xl(e),null;case 3:return n=e.stateNode,xv(),ms(Oc),ms(Ul),RO(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(RN(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Qd!==null&&(mT(Qd),Qd=null))),oT(t,e),xl(e),null;case 5:DO(e);var a=fp(Kb.current);if(r=e.type,t!==null&&e.stateNode!=null)RX(t,e,r,n,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(vr(166));return xl(e),null}if(t=fp(Qf.current),RN(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Pf]=e,n[$b]=s,t=(e.mode&1)!==0,r){case"dialog":cs("cancel",n),cs("close",n);break;case"iframe":case"object":case"embed":cs("load",n);break;case"video":case"audio":for(a=0;a<Ey.length;a++)cs(Ey[a],n);break;case"source":cs("error",n);break;case"img":case"image":case"link":cs("error",n),cs("load",n);break;case"details":cs("toggle",n);break;case"input":pL(n,s),cs("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},cs("invalid",n);break;case"textarea":xL(n,s),cs("invalid",n)}FB(r,s),a=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&DN(n.textContent,l,t),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&DN(n.textContent,l,t),a=["children",""+l]):Fb.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&cs("scroll",n)}switch(r){case"input":IN(n),gL(n,s,!0);break;case"textarea":IN(n),vL(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=CE)}n=a,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=fW(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[Pf]=e,t[$b]=n,DX(t,e,!1,!1),e.stateNode=t;e:{switch(o=OB(r,n),r){case"dialog":cs("cancel",t),cs("close",t),a=n;break;case"iframe":case"object":case"embed":cs("load",t),a=n;break;case"video":case"audio":for(a=0;a<Ey.length;a++)cs(Ey[a],t);a=n;break;case"source":cs("error",t),a=n;break;case"img":case"image":case"link":cs("error",t),cs("load",t),a=n;break;case"details":cs("toggle",t),a=n;break;case"input":pL(t,n),a=jB(t,n),cs("invalid",t);break;case"option":a=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},a=Xs({},n,{value:void 0}),cs("invalid",t);break;case"textarea":xL(t,n),a=TB(t,n),cs("invalid",t);break;default:a=n}FB(r,a),l=a;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?mW(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&hW(t,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Ob(t,c):typeof c=="number"&&Ob(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Fb.hasOwnProperty(s)?c!=null&&s==="onScroll"&&cs("scroll",t):c!=null&&hO(t,s,c,o))}switch(r){case"input":IN(t),gL(t,n,!1);break;case"textarea":IN(t),vL(t);break;case"option":n.value!=null&&t.setAttribute("value",""+rm(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?Xx(t,!!n.multiple,s,!1):n.defaultValue!=null&&Xx(t,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=CE)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return xl(e),null;case 6:if(t&&e.stateNode!=null)MX(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(vr(166));if(r=fp(Kb.current),fp(Qf.current),RN(e)){if(n=e.stateNode,r=e.memoizedProps,n[Pf]=e,(s=n.nodeValue!==r)&&(t=mu,t!==null))switch(t.tag){case 3:DN(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&DN(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Pf]=e,e.stateNode=n}return xl(e),null;case 13:if(ms(Gs),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(_s&&du!==null&&e.mode&1&&!(e.flags&128))rX(),pv(),e.flags|=98560,s=!1;else if(s=RN(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(vr(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(vr(317));s[Pf]=e}else pv(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;xl(e),s=!1}else Qd!==null&&(mT(Qd),Qd=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Gs.current&1?fo===0&&(fo=3):WO())),e.updateQueue!==null&&(e.flags|=4),xl(e),null);case 4:return xv(),oT(t,e),t===null&&Vb(e.stateNode.containerInfo),xl(e),null;case 10:return TO(e.type._context),xl(e),null;case 17:return Dc(e.type)&&_E(),xl(e),null;case 19:if(ms(Gs),s=e.memoizedState,s===null)return xl(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)K1(s,!1);else{if(fo!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=TE(t),o!==null){for(e.flags|=128,K1(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return as(Gs,Gs.current&1|2),e.child}t=t.sibling}s.tail!==null&&Ci()>yv&&(e.flags|=128,n=!0,K1(s,!1),e.lanes=4194304)}else{if(!n)if(t=TE(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),K1(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!_s)return xl(e),null}else 2*Ci()-s.renderingStartTime>yv&&r!==1073741824&&(e.flags|=128,n=!0,K1(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(r=s.last,r!==null?r.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ci(),e.sibling=null,r=Gs.current,as(Gs,n?r&1|2:r&1),e):(xl(e),null);case 22:case 23:return zO(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?au&1073741824&&(xl(e),e.subtreeFlags&6&&(e.flags|=8192)):xl(e),null;case 24:return null;case 25:return null}throw Error(vr(156,e.tag))}function Rhe(t,e){switch(IO(e),e.tag){case 1:return Dc(e.type)&&_E(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return xv(),ms(Oc),ms(Ul),RO(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return DO(e),null;case 13:if(ms(Gs),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(vr(340));pv()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ms(Gs),null;case 4:return xv(),null;case 10:return TO(e.type._context),null;case 22:case 23:return zO(),null;case 24:return null;default:return null}}var UN=!1,Fl=!1,Mhe=typeof WeakSet=="function"?WeakSet:Set,Mr=null;function Mx(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){li(t,e,n)}else r.current=null}function lT(t,e,r){try{r()}catch(n){li(t,e,n)}}var lU=!1;function Lhe(t,e){if(GB=bE,t=HW(),EO(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=t,A=null;t:for(;;){for(var h;f!==r||a!==0&&f.nodeType!==3||(l=o+a),f!==s||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(h=f.firstChild)!==null;)A=f,f=h;for(;;){if(f===t)break t;if(A===r&&++u===a&&(l=o),A===s&&++d===n&&(c=o),(h=f.nextSibling)!==null)break;f=A,A=f.parentNode}f=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(KB={focusedElem:t,selectionRange:r},bE=!1,Mr=e;Mr!==null;)if(e=Mr,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Mr=t;else for(;Mr!==null;){e=Mr;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var p=m.memoizedProps,g=m.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?p:Ld(e.type,p),g);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(vr(163))}}catch(w){li(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,Mr=t;break}Mr=e.return}return m=lU,lU=!1,m}function tb(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&t)===t){var s=a.destroy;a.destroy=void 0,s!==void 0&&lT(e,r,s)}a=a.next}while(a!==n)}}function WI(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function cT(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function LX(t){var e=t.alternate;e!==null&&(t.alternate=null,LX(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Pf],delete e[$b],delete e[WB],delete e[bhe],delete e[whe])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function UX(t){return t.tag===5||t.tag===3||t.tag===4}function cU(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||UX(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function uT(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=CE));else if(n!==4&&(t=t.child,t!==null))for(uT(t,e,r),t=t.sibling;t!==null;)uT(t,e,r),t=t.sibling}function dT(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(dT(t,e,r),t=t.sibling;t!==null;)dT(t,e,r),t=t.sibling}var tl=null,Ud=!1;function WA(t,e,r){for(r=r.child;r!==null;)QX(t,e,r),r=r.sibling}function QX(t,e,r){if(Uf&&typeof Uf.onCommitFiberUnmount=="function")try{Uf.onCommitFiberUnmount(QI,r)}catch{}switch(r.tag){case 5:Fl||Mx(r,e);case 6:var n=tl,a=Ud;tl=null,WA(t,e,r),tl=n,Ud=a,tl!==null&&(Ud?(t=tl,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):tl.removeChild(r.stateNode));break;case 18:tl!==null&&(Ud?(t=tl,r=r.stateNode,t.nodeType===8?q4(t.parentNode,r):t.nodeType===1&&q4(t,r),Lb(t)):q4(tl,r.stateNode));break;case 4:n=tl,a=Ud,tl=r.stateNode.containerInfo,Ud=!0,WA(t,e,r),tl=n,Ud=a;break;case 0:case 11:case 14:case 15:if(!Fl&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&lT(r,e,o),a=a.next}while(a!==n)}WA(t,e,r);break;case 1:if(!Fl&&(Mx(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){li(r,e,l)}WA(t,e,r);break;case 21:WA(t,e,r);break;case 22:r.mode&1?(Fl=(n=Fl)||r.memoizedState!==null,WA(t,e,r),Fl=n):WA(t,e,r);break;default:WA(t,e,r)}}function uU(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new Mhe),e.forEach(function(n){var a=zhe.bind(null,t,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Pd(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:tl=l.stateNode,Ud=!1;break e;case 3:tl=l.stateNode.containerInfo,Ud=!0;break e;case 4:tl=l.stateNode.containerInfo,Ud=!0;break e}l=l.return}if(tl===null)throw Error(vr(160));QX(s,o,a),tl=null,Ud=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){li(a,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)VX(e,t),e=e.sibling}function VX(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Pd(e,t),yf(t),n&4){try{tb(3,t,t.return),WI(3,t)}catch(p){li(t,t.return,p)}try{tb(5,t,t.return)}catch(p){li(t,t.return,p)}}break;case 1:Pd(e,t),yf(t),n&512&&r!==null&&Mx(r,r.return);break;case 5:if(Pd(e,t),yf(t),n&512&&r!==null&&Mx(r,r.return),t.flags&32){var a=t.stateNode;try{Ob(a,"")}catch(p){li(t,t.return,p)}}if(n&4&&(a=t.stateNode,a!=null)){var s=t.memoizedProps,o=r!==null?r.memoizedProps:s,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&uW(a,s),OB(l,o);var u=OB(l,s);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d==="style"?mW(a,f):d==="dangerouslySetInnerHTML"?hW(a,f):d==="children"?Ob(a,f):hO(a,d,f,u)}switch(l){case"input":PB(a,s);break;case"textarea":dW(a,s);break;case"select":var A=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?Xx(a,!!s.multiple,h,!1):A!==!!s.multiple&&(s.defaultValue!=null?Xx(a,!!s.multiple,s.defaultValue,!0):Xx(a,!!s.multiple,s.multiple?[]:"",!1))}a[$b]=s}catch(p){li(t,t.return,p)}}break;case 6:if(Pd(e,t),yf(t),n&4){if(t.stateNode===null)throw Error(vr(162));a=t.stateNode,s=t.memoizedProps;try{a.nodeValue=s}catch(p){li(t,t.return,p)}}break;case 3:if(Pd(e,t),yf(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Lb(e.containerInfo)}catch(p){li(t,t.return,p)}break;case 4:Pd(e,t),yf(t);break;case 13:Pd(e,t),yf(t),a=t.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(KO=Ci())),n&4&&uU(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(Fl=(u=Fl)||d,Pd(e,t),Fl=u):Pd(e,t),yf(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(Mr=t,d=t.child;d!==null;){for(f=Mr=d;Mr!==null;){switch(A=Mr,h=A.child,A.tag){case 0:case 11:case 14:case 15:tb(4,A,A.return);break;case 1:Mx(A,A.return);var m=A.stateNode;if(typeof m.componentWillUnmount=="function"){n=A,r=A.return;try{e=n,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(p){li(n,r,p)}}break;case 5:Mx(A,A.return);break;case 22:if(A.memoizedState!==null){fU(f);continue}}h!==null?(h.return=A,Mr=h):fU(f)}d=d.sibling}e:for(d=null,f=t;;){if(f.tag===5){if(d===null){d=f;try{a=f.stateNode,u?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=AW("display",o))}catch(p){li(t,t.return,p)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(p){li(t,t.return,p)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Pd(e,t),yf(t),n&4&&uU(t);break;case 21:break;default:Pd(e,t),yf(t)}}function yf(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(UX(r)){var n=r;break e}r=r.return}throw Error(vr(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Ob(a,""),n.flags&=-33);var s=cU(t);dT(t,s,a);break;case 3:case 4:var o=n.stateNode.containerInfo,l=cU(t);uT(t,l,o);break;default:throw Error(vr(161))}}catch(c){li(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Uhe(t,e,r){Mr=t,HX(t)}function HX(t,e,r){for(var n=(t.mode&1)!==0;Mr!==null;){var a=Mr,s=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||UN;if(!o){var l=a.alternate,c=l!==null&&l.memoizedState!==null||Fl;l=UN;var u=Fl;if(UN=o,(Fl=c)&&!u)for(Mr=a;Mr!==null;)o=Mr,c=o.child,o.tag===22&&o.memoizedState!==null?hU(a):c!==null?(c.return=o,Mr=c):hU(a);for(;s!==null;)Mr=s,HX(s),s=s.sibling;Mr=a,UN=l,Fl=u}dU(t)}else a.subtreeFlags&8772&&s!==null?(s.return=a,Mr=s):dU(t)}}function dU(t){for(;Mr!==null;){var e=Mr;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Fl||WI(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Fl)if(r===null)n.componentDidMount();else{var a=e.elementType===e.type?r.memoizedProps:Ld(e.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&WL(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}WL(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Lb(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(vr(163))}Fl||e.flags&512&&cT(e)}catch(A){li(e,e.return,A)}}if(e===t){Mr=null;break}if(r=e.sibling,r!==null){r.return=e.return,Mr=r;break}Mr=e.return}}function fU(t){for(;Mr!==null;){var e=Mr;if(e===t){Mr=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Mr=r;break}Mr=e.return}}function hU(t){for(;Mr!==null;){var e=Mr;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{WI(4,e)}catch(c){li(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var a=e.return;try{n.componentDidMount()}catch(c){li(e,a,c)}}var s=e.return;try{cT(e)}catch(c){li(e,s,c)}break;case 5:var o=e.return;try{cT(e)}catch(c){li(e,o,c)}}}catch(c){li(e,e.return,c)}if(e===t){Mr=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Mr=l;break}Mr=e.return}}var Qhe=Math.ceil,OE=pA.ReactCurrentDispatcher,$O=pA.ReactCurrentOwner,od=pA.ReactCurrentBatchConfig,sa=0,Ro=null,Qi=null,fl=0,au=0,Lx=bm(0),fo=0,Xb=null,Vp=0,XI=0,GO=0,rb=null,Pc=null,KO=0,yv=1/0,Ch=null,DE=!1,fT=null,H0=null,QN=!1,j0=null,RE=0,nb=0,hT=null,D_=-1,R_=0;function cc(){return sa&6?Ci():D_!==-1?D_:D_=Ci()}function $0(t){return t.mode&1?sa&2&&fl!==0?fl&-fl:Che.transition!==null?(R_===0&&(R_=SW()),R_):(t=Ma,t!==0||(t=window.event,t=t===void 0?16:FW(t.type)),t):1}function Xd(t,e,r,n){if(50<nb)throw nb=0,hT=null,Error(vr(185));rw(t,r,n),(!(sa&2)||t!==Ro)&&(t===Ro&&(!(sa&2)&&(XI|=r),fo===4&&v0(t,fl)),Rc(t,n),r===1&&sa===0&&!(e.mode&1)&&(yv=Ci()+500,KI&&wm()))}function Rc(t,e){var r=t.callbackNode;Cfe(t,e);var n=yE(t,t===Ro?fl:0);if(n===0)r!==null&&wL(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&wL(r),e===1)t.tag===0?Nhe(AU.bind(null,t)):ZW(AU.bind(null,t)),vhe(function(){!(sa&6)&&wm()}),r=null;else{switch(IW(n)){case 1:r=xO;break;case 4:r=_W;break;case 16:r=vE;break;case 536870912:r=EW;break;default:r=vE}r=YX(r,$X.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function $X(t,e){if(D_=-1,R_=0,sa&6)throw Error(vr(327));var r=t.callbackNode;if(tv()&&t.callbackNode!==r)return null;var n=yE(t,t===Ro?fl:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=ME(t,n);else{e=n;var a=sa;sa|=2;var s=KX();(Ro!==t||fl!==e)&&(Ch=null,yv=Ci()+500,bp(t,e));do try{$he();break}catch(l){GX(t,l)}while(!0);BO(),OE.current=s,sa=a,Qi!==null?e=0:(Ro=null,fl=0,e=fo)}if(e!==0){if(e===2&&(a=UB(t),a!==0&&(n=a,e=AT(t,a))),e===1)throw r=Xb,bp(t,0),v0(t,n),Rc(t,Ci()),r;if(e===6)v0(t,n);else{if(a=t.current.alternate,!(n&30)&&!Vhe(a)&&(e=ME(t,n),e===2&&(s=UB(t),s!==0&&(n=s,e=AT(t,s))),e===1))throw r=Xb,bp(t,0),v0(t,n),Rc(t,Ci()),r;switch(t.finishedWork=a,t.finishedLanes=n,e){case 0:case 1:throw Error(vr(345));case 2:zm(t,Pc,Ch);break;case 3:if(v0(t,n),(n&130023424)===n&&(e=KO+500-Ci(),10<e)){if(yE(t,0)!==0)break;if(a=t.suspendedLanes,(a&n)!==n){cc(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=zB(zm.bind(null,t,Pc,Ch),e);break}zm(t,Pc,Ch);break;case 4:if(v0(t,n),(n&4194240)===n)break;for(e=t.eventTimes,a=-1;0<n;){var o=31-Wd(n);s=1<<o,o=e[o],o>a&&(a=o),n&=~s}if(n=a,n=Ci()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Qhe(n/1960))-n,10<n){t.timeoutHandle=zB(zm.bind(null,t,Pc,Ch),n);break}zm(t,Pc,Ch);break;case 5:zm(t,Pc,Ch);break;default:throw Error(vr(329))}}}return Rc(t,Ci()),t.callbackNode===r?$X.bind(null,t):null}function AT(t,e){var r=rb;return t.current.memoizedState.isDehydrated&&(bp(t,e).flags|=256),t=ME(t,e),t!==2&&(e=Pc,Pc=r,e!==null&&mT(e)),t}function mT(t){Pc===null?Pc=t:Pc.push.apply(Pc,t)}function Vhe(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!nf(s(),a))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function v0(t,e){for(e&=~GO,e&=~XI,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Wd(e),n=1<<r;t[r]=-1,e&=~n}}function AU(t){if(sa&6)throw Error(vr(327));tv();var e=yE(t,0);if(!(e&1))return Rc(t,Ci()),null;var r=ME(t,e);if(t.tag!==0&&r===2){var n=UB(t);n!==0&&(e=n,r=AT(t,n))}if(r===1)throw r=Xb,bp(t,0),v0(t,e),Rc(t,Ci()),r;if(r===6)throw Error(vr(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,zm(t,Pc,Ch),Rc(t,Ci()),null}function qO(t,e){var r=sa;sa|=1;try{return t(e)}finally{sa=r,sa===0&&(yv=Ci()+500,KI&&wm())}}function Hp(t){j0!==null&&j0.tag===0&&!(sa&6)&&tv();var e=sa;sa|=1;var r=od.transition,n=Ma;try{if(od.transition=null,Ma=1,t)return t()}finally{Ma=n,od.transition=r,sa=e,!(sa&6)&&wm()}}function zO(){au=Lx.current,ms(Lx)}function bp(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,xhe(r)),Qi!==null)for(r=Qi.return;r!==null;){var n=r;switch(IO(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&_E();break;case 3:xv(),ms(Oc),ms(Ul),RO();break;case 5:DO(n);break;case 4:xv();break;case 13:ms(Gs);break;case 19:ms(Gs);break;case 10:TO(n.type._context);break;case 22:case 23:zO()}r=r.return}if(Ro=t,Qi=t=G0(t.current,null),fl=au=e,fo=0,Xb=null,GO=XI=Vp=0,Pc=rb=null,dp!==null){for(e=0;e<dp.length;e++)if(r=dp[e],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=a,n.next=o}r.pending=n}dp=null}return t}function GX(t,e){do{var r=Qi;try{if(BO(),k_.current=FE,kE){for(var n=Ws.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}kE=!1}if(Qp=0,To=ro=Ws=null,eb=!1,qb=0,$O.current=null,r===null||r.return===null){fo=1,Xb=e,Qi=null;break}e:{var s=t,o=r.return,l=r,c=e;if(e=fl,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var A=d.alternate;A?(d.updateQueue=A.updateQueue,d.memoizedState=A.memoizedState,d.lanes=A.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=tU(o);if(h!==null){h.flags&=-257,rU(h,o,l,s,e),h.mode&1&&eU(s,u,e),e=h,c=u;var m=e.updateQueue;if(m===null){var p=new Set;p.add(c),e.updateQueue=p}else m.add(c);break e}else{if(!(e&1)){eU(s,u,e),WO();break e}c=Error(vr(426))}}else if(_s&&l.mode&1){var g=tU(o);if(g!==null){!(g.flags&65536)&&(g.flags|=256),rU(g,o,l,s,e),jO(vv(c,l));break e}}s=c=vv(c,l),fo!==4&&(fo=2),rb===null?rb=[s]:rb.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=IX(s,c,e);zL(s,v);break e;case 1:l=c;var y=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(H0===null||!H0.has(b)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=jX(s,l,e);zL(s,w);break e}}s=s.return}while(s!==null)}zX(r)}catch(j){e=j,Qi===r&&r!==null&&(Qi=r=r.return);continue}break}while(!0)}function KX(){var t=OE.current;return OE.current=FE,t===null?FE:t}function WO(){(fo===0||fo===3||fo===2)&&(fo=4),Ro===null||!(Vp&268435455)&&!(XI&268435455)||v0(Ro,fl)}function ME(t,e){var r=sa;sa|=2;var n=KX();(Ro!==t||fl!==e)&&(Ch=null,bp(t,e));do try{Hhe();break}catch(a){GX(t,a)}while(!0);if(BO(),sa=r,OE.current=n,Qi!==null)throw Error(vr(261));return Ro=null,fl=0,fo}function Hhe(){for(;Qi!==null;)qX(Qi)}function $he(){for(;Qi!==null&&!mfe();)qX(Qi)}function qX(t){var e=XX(t.alternate,t,au);t.memoizedProps=t.pendingProps,e===null?zX(t):Qi=e,$O.current=null}function zX(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=Rhe(r,e),r!==null){r.flags&=32767,Qi=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{fo=6,Qi=null;return}}else if(r=Dhe(r,e,au),r!==null){Qi=r;return}if(e=e.sibling,e!==null){Qi=e;return}Qi=e=t}while(e!==null);fo===0&&(fo=5)}function zm(t,e,r){var n=Ma,a=od.transition;try{od.transition=null,Ma=1,Ghe(t,e,r,n)}finally{od.transition=a,Ma=n}return null}function Ghe(t,e,r,n){do tv();while(j0!==null);if(sa&6)throw Error(vr(327));r=t.finishedWork;var a=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(vr(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(_fe(t,s),t===Ro&&(Qi=Ro=null,fl=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||QN||(QN=!0,YX(vE,function(){return tv(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=od.transition,od.transition=null;var o=Ma;Ma=1;var l=sa;sa|=4,$O.current=null,Lhe(t,r),VX(r,t),dhe(KB),bE=!!GB,KB=GB=null,t.current=r,Uhe(r),pfe(),sa=l,Ma=o,od.transition=s}else t.current=r;if(QN&&(QN=!1,j0=t,RE=a),s=t.pendingLanes,s===0&&(H0=null),vfe(r.stateNode),Rc(t,Ci()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)a=e[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(DE)throw DE=!1,t=fT,fT=null,t;return RE&1&&t.tag!==0&&tv(),s=t.pendingLanes,s&1?t===hT?nb++:(nb=0,hT=t):nb=0,wm(),null}function tv(){if(j0!==null){var t=IW(RE),e=od.transition,r=Ma;try{if(od.transition=null,Ma=16>t?16:t,j0===null)var n=!1;else{if(t=j0,j0=null,RE=0,sa&6)throw Error(vr(331));var a=sa;for(sa|=4,Mr=t.current;Mr!==null;){var s=Mr,o=s.child;if(Mr.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Mr=u;Mr!==null;){var d=Mr;switch(d.tag){case 0:case 11:case 15:tb(8,d,s)}var f=d.child;if(f!==null)f.return=d,Mr=f;else for(;Mr!==null;){d=Mr;var A=d.sibling,h=d.return;if(LX(d),d===u){Mr=null;break}if(A!==null){A.return=h,Mr=A;break}Mr=h}}}var m=s.alternate;if(m!==null){var p=m.child;if(p!==null){m.child=null;do{var g=p.sibling;p.sibling=null,p=g}while(p!==null)}}Mr=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Mr=o;else e:for(;Mr!==null;){if(s=Mr,s.flags&2048)switch(s.tag){case 0:case 11:case 15:tb(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,Mr=v;break e}Mr=s.return}}var y=t.current;for(Mr=y;Mr!==null;){o=Mr;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,Mr=b;else e:for(o=y;Mr!==null;){if(l=Mr,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:WI(9,l)}}catch(j){li(l,l.return,j)}if(l===o){Mr=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,Mr=w;break e}Mr=l.return}}if(sa=a,wm(),Uf&&typeof Uf.onPostCommitFiberRoot=="function")try{Uf.onPostCommitFiberRoot(QI,t)}catch{}n=!0}return n}finally{Ma=r,od.transition=e}}return!1}function mU(t,e,r){e=vv(r,e),e=IX(t,e,1),t=V0(t,e,1),e=cc(),t!==null&&(rw(t,1,e),Rc(t,e))}function li(t,e,r){if(t.tag===3)mU(t,t,r);else for(;e!==null;){if(e.tag===3){mU(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(H0===null||!H0.has(n))){t=vv(r,t),t=jX(e,t,1),e=V0(e,t,1),t=cc(),e!==null&&(rw(e,1,t),Rc(e,t));break}}e=e.return}}function Khe(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=cc(),t.pingedLanes|=t.suspendedLanes&r,Ro===t&&(fl&r)===r&&(fo===4||fo===3&&(fl&130023424)===fl&&500>Ci()-KO?bp(t,0):GO|=r),Rc(t,e)}function WX(t,e){e===0&&(t.mode&1?(e=BN,BN<<=1,!(BN&130023424)&&(BN=4194304)):e=1);var r=cc();t=Zh(t,e),t!==null&&(rw(t,e,r),Rc(t,r))}function qhe(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),WX(t,r)}function zhe(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,a=t.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(vr(314))}n!==null&&n.delete(e),WX(t,r)}var XX;XX=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Oc.current)Tc=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Tc=!1,Ohe(t,e,r);Tc=!!(t.flags&131072)}else Tc=!1,_s&&e.flags&1048576&&eX(e,IE,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;O_(t,e),t=e.pendingProps;var a=mv(e,Ul.current);ev(e,r),a=LO(null,e,n,t,a,r);var s=UO();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Dc(n)?(s=!0,EE(e)):s=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,FO(e),a.updater=zI,e.stateNode=a,a._reactInternals=e,tT(e,n,t,r),e=aT(null,e,n,!0,s,r)):(e.tag=0,_s&&s&&SO(e),nc(null,e,a,r),e=e.child),e;case 16:n=e.elementType;e:{switch(O_(t,e),t=e.pendingProps,a=n._init,n=a(n._payload),e.type=n,a=e.tag=Xhe(n),t=Ld(n,t),a){case 0:e=nT(null,e,n,t,r);break e;case 1:e=sU(null,e,n,t,r);break e;case 11:e=nU(null,e,n,t,r);break e;case 14:e=aU(null,e,n,Ld(n.type,t),r);break e}throw Error(vr(306,n,""))}return e;case 0:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:Ld(n,a),nT(t,e,n,a,r);case 1:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:Ld(n,a),sU(t,e,n,a,r);case 3:e:{if(kX(e),t===null)throw Error(vr(387));n=e.pendingProps,s=e.memoizedState,a=s.element,iX(t,e),BE(e,n,null,r);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){a=vv(Error(vr(423)),e),e=iU(t,e,n,r,a);break e}else if(n!==a){a=vv(Error(vr(424)),e),e=iU(t,e,n,r,a);break e}else for(du=Q0(e.stateNode.containerInfo.firstChild),mu=e,_s=!0,Qd=null,r=aX(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(pv(),n===a){e=eA(t,e,r);break e}nc(t,e,n,r)}e=e.child}return e;case 5:return oX(e),t===null&&JB(e),n=e.type,a=e.pendingProps,s=t!==null?t.memoizedProps:null,o=a.children,qB(n,a)?o=null:s!==null&&qB(n,s)&&(e.flags|=32),TX(t,e),nc(t,e,o,r),e.child;case 6:return t===null&&JB(e),null;case 13:return FX(t,e,r);case 4:return OO(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=gv(e,null,n,r):nc(t,e,n,r),e.child;case 11:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:Ld(n,a),nU(t,e,n,a,r);case 7:return nc(t,e,e.pendingProps,r),e.child;case 8:return nc(t,e,e.pendingProps.children,r),e.child;case 12:return nc(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,a=e.pendingProps,s=e.memoizedProps,o=a.value,as(jE,n._currentValue),n._currentValue=o,s!==null)if(nf(s.value,o)){if(s.children===a.children&&!Oc.current){e=eA(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=Uh(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),ZB(s.return,r,e),l.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(vr(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),ZB(o,r,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}nc(t,e,a.children,r),e=e.child}return e;case 9:return a=e.type,n=e.pendingProps.children,ev(e,r),a=fd(a),n=n(a),e.flags|=1,nc(t,e,n,r),e.child;case 14:return n=e.type,a=Ld(n,e.pendingProps),a=Ld(n.type,a),aU(t,e,n,a,r);case 15:return PX(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:Ld(n,a),O_(t,e),e.tag=1,Dc(n)?(t=!0,EE(e)):t=!1,ev(e,r),SX(e,n,a),tT(e,n,a,r),aT(null,e,n,!0,t,r);case 19:return OX(t,e,r);case 22:return BX(t,e,r)}throw Error(vr(156,e.tag))};function YX(t,e){return CW(t,e)}function Whe(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function td(t,e,r,n){return new Whe(t,e,r,n)}function XO(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Xhe(t){if(typeof t=="function")return XO(t)?1:0;if(t!=null){if(t=t.$$typeof,t===mO)return 11;if(t===pO)return 14}return 2}function G0(t,e){var r=t.alternate;return r===null?(r=td(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function M_(t,e,r,n,a,s){var o=2;if(n=t,typeof t=="function")XO(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case jx:return wp(r.children,a,s,e);case AO:o=8,a|=8;break;case _B:return t=td(12,r,e,a|2),t.elementType=_B,t.lanes=s,t;case EB:return t=td(13,r,e,a),t.elementType=EB,t.lanes=s,t;case SB:return t=td(19,r,e,a),t.elementType=SB,t.lanes=s,t;case oW:return YI(r,a,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case sW:o=10;break e;case iW:o=9;break e;case mO:o=11;break e;case pO:o=14;break e;case f0:o=16,n=null;break e}throw Error(vr(130,t==null?t:typeof t,""))}return e=td(o,r,e,a),e.elementType=t,e.type=n,e.lanes=s,e}function wp(t,e,r,n){return t=td(7,t,n,e),t.lanes=r,t}function YI(t,e,r,n){return t=td(22,t,n,e),t.elementType=oW,t.lanes=r,t.stateNode={isHidden:!1},t}function t3(t,e,r){return t=td(6,t,null,e),t.lanes=r,t}function r3(t,e,r){return e=td(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Yhe(t,e,r,n,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=D4(0),this.expirationTimes=D4(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=D4(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function YO(t,e,r,n,a,s,o,l,c){return t=new Yhe(t,e,r,l,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=td(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},FO(s),t}function Jhe(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ix,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function JX(t){if(!t)return nm;t=t._reactInternals;e:{if(xg(t)!==t||t.tag!==1)throw Error(vr(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Dc(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(vr(171))}if(t.tag===1){var r=t.type;if(Dc(r))return JW(t,r,e)}return e}function ZX(t,e,r,n,a,s,o,l,c){return t=YO(r,n,!0,t,a,s,o,l,c),t.context=JX(null),r=t.current,n=cc(),a=$0(r),s=Uh(n,a),s.callback=e??null,V0(r,s,a),t.current.lanes=a,rw(t,a,n),Rc(t,n),t}function JI(t,e,r,n){var a=e.current,s=cc(),o=$0(a);return r=JX(r),e.context===null?e.context=r:e.pendingContext=r,e=Uh(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=V0(a,e,o),t!==null&&(Xd(t,a,o,s),T_(t,a,o)),o}function LE(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function pU(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function JO(t,e){pU(t,e),(t=t.alternate)&&pU(t,e)}function Zhe(){return null}var eY=typeof reportError=="function"?reportError:function(t){console.error(t)};function ZO(t){this._internalRoot=t}ZI.prototype.render=ZO.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(vr(409));JI(t,e,null,null)};ZI.prototype.unmount=ZO.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Hp(function(){JI(null,t,null,null)}),e[Jh]=null}};function ZI(t){this._internalRoot=t}ZI.prototype.unstable_scheduleHydration=function(t){if(t){var e=BW();t={blockedOn:null,target:t,priority:e};for(var r=0;r<x0.length&&e!==0&&e<x0[r].priority;r++);x0.splice(r,0,t),r===0&&kW(t)}};function eD(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ej(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function gU(){}function eAe(t,e,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var u=LE(o);s.call(u)}}var o=ZX(e,n,t,0,null,!1,!1,"",gU);return t._reactRootContainer=o,t[Jh]=o.current,Vb(t.nodeType===8?t.parentNode:t),Hp(),o}for(;a=t.lastChild;)t.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var u=LE(c);l.call(u)}}var c=YO(t,0,!1,null,null,!1,!1,"",gU);return t._reactRootContainer=c,t[Jh]=c.current,Vb(t.nodeType===8?t.parentNode:t),Hp(function(){JI(e,c,r,n)}),c}function tj(t,e,r,n,a){var s=r._reactRootContainer;if(s){var o=s;if(typeof a=="function"){var l=a;a=function(){var c=LE(o);l.call(c)}}JI(e,o,t,a)}else o=eAe(r,e,t,a,n);return LE(o)}jW=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=_y(e.pendingLanes);r!==0&&(vO(e,r|1),Rc(e,Ci()),!(sa&6)&&(yv=Ci()+500,wm()))}break;case 13:Hp(function(){var n=Zh(t,1);if(n!==null){var a=cc();Xd(n,t,1,a)}}),JO(t,1)}};yO=function(t){if(t.tag===13){var e=Zh(t,134217728);if(e!==null){var r=cc();Xd(e,t,134217728,r)}JO(t,134217728)}};PW=function(t){if(t.tag===13){var e=$0(t),r=Zh(t,e);if(r!==null){var n=cc();Xd(r,t,e,n)}JO(t,e)}};BW=function(){return Ma};TW=function(t,e){var r=Ma;try{return Ma=t,e()}finally{Ma=r}};RB=function(t,e,r){switch(e){case"input":if(PB(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var a=GI(n);if(!a)throw Error(vr(90));cW(n),PB(n,a)}}}break;case"textarea":dW(t,r);break;case"select":e=r.value,e!=null&&Xx(t,!!r.multiple,e,!1)}};xW=qO;vW=Hp;var tAe={usingClientEntryPoint:!1,Events:[aw,kx,GI,pW,gW,qO]},q1={findFiberByHostInstance:up,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rAe={bundleType:q1.bundleType,version:q1.version,rendererPackageName:q1.rendererPackageName,rendererConfig:q1.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:pA.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=wW(t),t===null?null:t.stateNode},findFiberByHostInstance:q1.findFiberByHostInstance||Zhe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var VN=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!VN.isDisabled&&VN.supportsFiber)try{QI=VN.inject(rAe),Uf=VN}catch{}}Nu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tAe;Nu.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!eD(e))throw Error(vr(200));return Jhe(t,e,null,r)};Nu.createRoot=function(t,e){if(!eD(t))throw Error(vr(299));var r=!1,n="",a=eY;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=YO(t,1,!1,null,null,r,!1,n,a),t[Jh]=e.current,Vb(t.nodeType===8?t.parentNode:t),new ZO(e)};Nu.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(vr(188)):(t=Object.keys(t).join(","),Error(vr(268,t)));return t=wW(e),t=t===null?null:t.stateNode,t};Nu.flushSync=function(t){return Hp(t)};Nu.hydrate=function(t,e,r){if(!ej(e))throw Error(vr(200));return tj(null,t,e,!0,r)};Nu.hydrateRoot=function(t,e,r){if(!eD(t))throw Error(vr(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",o=eY;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=ZX(e,null,t,1,r??null,a,!1,s,o),t[Jh]=e.current,Vb(t),n)for(t=0;t<n.length;t++)r=n[t],a=r._getVersion,a=a(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,a]:e.mutableSourceEagerHydrationData.push(r,a);return new ZI(e)};Nu.render=function(t,e,r){if(!ej(e))throw Error(vr(200));return tj(null,t,e,!1,r)};Nu.unmountComponentAtNode=function(t){if(!ej(t))throw Error(vr(40));return t._reactRootContainer?(Hp(function(){tj(null,null,t,!1,function(){t._reactRootContainer=null,t[Jh]=null})}),!0):!1};Nu.unstable_batchedUpdates=qO;Nu.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!ej(r))throw Error(vr(200));if(t==null||t._reactInternals===void 0)throw Error(vr(38));return tj(t,e,r,!1,n)};Nu.version="18.3.1-next-f1338f8080-20240426";function tY(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(tY)}catch(t){console.error(t)}}tY(),tW.exports=Nu;var pu=tW.exports,xU=pu;NB.createRoot=xU.createRoot,NB.hydrateRoot=xU.hydrateRoot;/**
 * react-router v7.8.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var vU="popstate";function nAe(t={}){function e(n,a){let{pathname:s,search:o,hash:l}=n.location;return pT("",{pathname:s,search:o,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:Yb(a)}return sAe(e,r,null,t)}function Ps(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function af(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function aAe(){return Math.random().toString(36).substring(2,10)}function yU(t,e){return{usr:t.state,key:t.key,idx:e}}function pT(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?zv(e):e,state:r,key:e&&e.key||n||aAe()}}function Yb({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function zv(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function sAe(t,e,r,n={}){let{window:a=document.defaultView,v5Compat:s=!1}=n,o=a.history,l="POP",c=null,u=d();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function d(){return(o.state||{idx:null}).idx}function f(){l="POP";let g=d(),v=g==null?null:g-u;u=g,c&&c({action:l,location:p.location,delta:v})}function A(g,v){l="PUSH";let y=pT(p.location,g,v);u=d()+1;let b=yU(y,u),w=p.createHref(y);try{o.pushState(b,"",w)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;a.location.assign(w)}s&&c&&c({action:l,location:p.location,delta:1})}function h(g,v){l="REPLACE";let y=pT(p.location,g,v);u=d();let b=yU(y,u),w=p.createHref(y);o.replaceState(b,"",w),s&&c&&c({action:l,location:p.location,delta:0})}function m(g){return iAe(g)}let p={get action(){return l},get location(){return t(a,o)},listen(g){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(vU,f),c=g,()=>{a.removeEventListener(vU,f),c=null}},createHref(g){return e(a,g)},createURL:m,encodeLocation(g){let v=m(g);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:A,replace:h,go(g){return o.go(g)}};return p}function iAe(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Ps(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:Yb(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function rY(t,e,r="/"){return oAe(t,e,r,!1)}function oAe(t,e,r,n){let a=typeof e=="string"?zv(e):e,s=tA(a.pathname||"/",r);if(s==null)return null;let o=nY(t);lAe(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=vAe(s);l=gAe(o[c],u,n)}return l}function nY(t,e=[],r=[],n="",a=!1){let s=(o,l,c=a,u)=>{let d={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(n)&&c)return;Ps(d.relativePath.startsWith(n),`Absolute route path "${d.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(n.length)}let f=Qh([n,d.relativePath]),A=r.concat(d);o.children&&o.children.length>0&&(Ps(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),nY(o.children,e,A,f,c)),!(o.path==null&&!o.index)&&e.push({path:f,score:mAe(f,o.index),routesMeta:A})};return t.forEach((o,l)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))s(o,l);else for(let u of aY(o.path))s(o,l,!0,u)}),e}function aY(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let o=aY(n.join("/")),l=[];return l.push(...o.map(c=>c===""?s:[s,c].join("/"))),a&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function lAe(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:pAe(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var cAe=/^:[\w-]+$/,uAe=3,dAe=2,fAe=1,hAe=10,AAe=-2,bU=t=>t==="*";function mAe(t,e){let r=t.split("/"),n=r.length;return r.some(bU)&&(n+=AAe),e&&(n+=dAe),r.filter(a=>!bU(a)).reduce((a,s)=>a+(cAe.test(s)?uAe:s===""?fAe:hAe),n)}function pAe(t,e){return t.length===e.length&&t.slice(0,-1).every((n,a)=>n===e[a])?t[t.length-1]-e[e.length-1]:0}function gAe(t,e,r=!1){let{routesMeta:n}=t,a={},s="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=s==="/"?e:e.slice(s.length)||"/",f=UE({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),A=c.route;if(!f&&u&&r&&!n[n.length-1].route.index&&(f=UE({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!f)return null;Object.assign(a,f.params),o.push({params:a,pathname:Qh([s,f.pathname]),pathnameBase:NAe(Qh([s,f.pathnameBase])),route:A}),f.pathnameBase!=="/"&&(s=Qh([s,f.pathnameBase]))}return o}function UE(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=xAe(t.path,t.caseSensitive,t.end),a=e.match(r);if(!a)return null;let s=a[0],o=s.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((u,{paramName:d,isOptional:f},A)=>{if(d==="*"){let m=l[A]||"";o=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const h=l[A];return f&&!h?u[d]=void 0:u[d]=(h||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:t}}function xAe(t,e=!1,r=!0){af(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function vAe(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return af(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function tA(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function yAe(t,e="/"){let{pathname:r,search:n="",hash:a=""}=typeof t=="string"?zv(t):t;return{pathname:r?r.startsWith("/")?r:bAe(r,e):e,search:CAe(n),hash:_Ae(a)}}function bAe(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function n3(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function wAe(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function tD(t){let e=wAe(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function rD(t,e,r,n=!1){let a;typeof t=="string"?a=zv(t):(a={...t},Ps(!a.pathname||!a.pathname.includes("?"),n3("?","pathname","search",a)),Ps(!a.pathname||!a.pathname.includes("#"),n3("#","pathname","hash",a)),Ps(!a.search||!a.search.includes("#"),n3("#","search","hash",a)));let s=t===""||a.pathname==="",o=s?"/":a.pathname,l;if(o==null)l=r;else{let f=e.length-1;if(!n&&o.startsWith("..")){let A=o.split("/");for(;A[0]==="..";)A.shift(),f-=1;a.pathname=A.join("/")}l=f>=0?e[f]:"/"}let c=yAe(a,l),u=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}var Qh=t=>t.join("/").replace(/\/\/+/g,"/"),NAe=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),CAe=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,_Ae=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function EAe(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var sY=["POST","PUT","PATCH","DELETE"];new Set(sY);var SAe=["GET",...sY];new Set(SAe);var Wv=x.createContext(null);Wv.displayName="DataRouter";var rj=x.createContext(null);rj.displayName="DataRouterState";x.createContext(!1);var iY=x.createContext({isTransitioning:!1});iY.displayName="ViewTransition";var IAe=x.createContext(new Map);IAe.displayName="Fetchers";var jAe=x.createContext(null);jAe.displayName="Await";var cf=x.createContext(null);cf.displayName="Navigation";var iw=x.createContext(null);iw.displayName="Location";var uf=x.createContext({outlet:null,matches:[],isDataRoute:!1});uf.displayName="Route";var nD=x.createContext(null);nD.displayName="RouteError";function PAe(t,{relative:e}={}){Ps(Xv(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=x.useContext(cf),{hash:a,pathname:s,search:o}=lw(t,{relative:e}),l=s;return r!=="/"&&(l=s==="/"?r:Qh([r,s])),n.createHref({pathname:l,search:o,hash:a})}function Xv(){return x.useContext(iw)!=null}function gA(){return Ps(Xv(),"useLocation() may be used only in the context of a <Router> component."),x.useContext(iw).location}var oY="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function lY(t){x.useContext(cf).static||x.useLayoutEffect(t)}function ow(){let{isDataRoute:t}=x.useContext(uf);return t?GAe():BAe()}function BAe(){Ps(Xv(),"useNavigate() may be used only in the context of a <Router> component.");let t=x.useContext(Wv),{basename:e,navigator:r}=x.useContext(cf),{matches:n}=x.useContext(uf),{pathname:a}=gA(),s=JSON.stringify(tD(n)),o=x.useRef(!1);return lY(()=>{o.current=!0}),x.useCallback((c,u={})=>{if(af(o.current,oY),!o.current)return;if(typeof c=="number"){r.go(c);return}let d=rD(c,JSON.parse(s),a,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Qh([e,d.pathname])),(u.replace?r.replace:r.push)(d,u.state,u)},[e,r,s,a,t])}var TAe=x.createContext(null);function kAe(t){let e=x.useContext(uf).outlet;return e&&x.createElement(TAe.Provider,{value:t},e)}function lw(t,{relative:e}={}){let{matches:r}=x.useContext(uf),{pathname:n}=gA(),a=JSON.stringify(tD(r));return x.useMemo(()=>rD(t,JSON.parse(a),n,e==="path"),[t,a,n,e])}function FAe(t,e){return cY(t,e)}function cY(t,e,r,n){var v;Ps(Xv(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=x.useContext(cf),{matches:s}=x.useContext(uf),o=s[s.length-1],l=o?o.params:{},c=o?o.pathname:"/",u=o?o.pathnameBase:"/",d=o&&o.route;{let y=d&&d.path||"";uY(c,!d||y.endsWith("*")||y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${y}"> to <Route path="${y==="/"?"*":`${y}/*`}">.`)}let f=gA(),A;if(e){let y=typeof e=="string"?zv(e):e;Ps(u==="/"||((v=y.pathname)==null?void 0:v.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${y.pathname}" was given in the \`location\` prop.`),A=y}else A=f;let h=A.pathname||"/",m=h;if(u!=="/"){let y=u.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let p=rY(t,{pathname:m});af(d||p!=null,`No routes matched location "${A.pathname}${A.search}${A.hash}" `),af(p==null||p[p.length-1].route.element!==void 0||p[p.length-1].route.Component!==void 0||p[p.length-1].route.lazy!==void 0,`Matched leaf route at location "${A.pathname}${A.search}${A.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let g=LAe(p&&p.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:Qh([u,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?u:Qh([u,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,r,n);return e&&g?x.createElement(iw.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...A},navigationType:"POP"}},g):g}function OAe(){let t=$Ae(),e=EAe(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=x.createElement(x.Fragment,null,x.createElement("p",null," Hey developer "),x.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",x.createElement("code",{style:s},"ErrorBoundary")," or"," ",x.createElement("code",{style:s},"errorElement")," prop on your route.")),x.createElement(x.Fragment,null,x.createElement("h2",null,"Unexpected Application Error!"),x.createElement("h3",{style:{fontStyle:"italic"}},e),r?x.createElement("pre",{style:a},r):null,o)}var DAe=x.createElement(OAe,null),RAe=class extends x.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?x.createElement(uf.Provider,{value:this.props.routeContext},x.createElement(nD.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function MAe({routeContext:t,match:e,children:r}){let n=x.useContext(Wv);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),x.createElement(uf.Provider,{value:t},r)}function LAe(t,e=[],r=null,n=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,s=r==null?void 0:r.errors;if(s!=null){let c=a.findIndex(u=>u.route.id&&(s==null?void 0:s[u.route.id])!==void 0);Ps(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let o=!1,l=-1;if(r)for(let c=0;c<a.length;c++){let u=a[c];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(l=c),u.route.id){let{loaderData:d,errors:f}=r,A=u.route.loader&&!d.hasOwnProperty(u.route.id)&&(!f||f[u.route.id]===void 0);if(u.route.lazy||A){o=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((c,u,d)=>{let f,A=!1,h=null,m=null;r&&(f=s&&u.route.id?s[u.route.id]:void 0,h=u.route.errorElement||DAe,o&&(l<0&&d===0?(uY("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),A=!0,m=null):l===d&&(A=!0,m=u.route.hydrateFallbackElement||null)));let p=e.concat(a.slice(0,d+1)),g=()=>{let v;return f?v=h:A?v=m:u.route.Component?v=x.createElement(u.route.Component,null):u.route.element?v=u.route.element:v=c,x.createElement(MAe,{match:u,routeContext:{outlet:c,matches:p,isDataRoute:r!=null},children:v})};return r&&(u.route.ErrorBoundary||u.route.errorElement||d===0)?x.createElement(RAe,{location:r.location,revalidation:r.revalidation,component:h,error:f,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):g()},null)}function aD(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function UAe(t){let e=x.useContext(Wv);return Ps(e,aD(t)),e}function QAe(t){let e=x.useContext(rj);return Ps(e,aD(t)),e}function VAe(t){let e=x.useContext(uf);return Ps(e,aD(t)),e}function sD(t){let e=VAe(t),r=e.matches[e.matches.length-1];return Ps(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function HAe(){return sD("useRouteId")}function $Ae(){var n;let t=x.useContext(nD),e=QAe("useRouteError"),r=sD("useRouteError");return t!==void 0?t:(n=e.errors)==null?void 0:n[r]}function GAe(){let{router:t}=UAe("useNavigate"),e=sD("useNavigate"),r=x.useRef(!1);return lY(()=>{r.current=!0}),x.useCallback(async(a,s={})=>{af(r.current,oY),r.current&&(typeof a=="number"?t.navigate(a):await t.navigate(a,{fromRouteId:e,...s}))},[t,e])}var wU={};function uY(t,e,r){!e&&!wU[t]&&(wU[t]=!0,af(!1,r))}x.memo(KAe);function KAe({routes:t,future:e,state:r}){return cY(t,void 0,r,e)}function wh({to:t,replace:e,state:r,relative:n}){Ps(Xv(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=x.useContext(cf);af(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=x.useContext(uf),{pathname:o}=gA(),l=ow(),c=rD(t,tD(s),o,n==="path"),u=JSON.stringify(c);return x.useEffect(()=>{l(JSON.parse(u),{replace:e,state:r,relative:n})},[l,u,n,e,r]),null}function dY(t){return kAe(t.context)}function wn(t){Ps(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function qAe({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:a,static:s=!1}){Ps(!Xv(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),l=x.useMemo(()=>({basename:o,navigator:a,static:s,future:{}}),[o,a,s]);typeof r=="string"&&(r=zv(r));let{pathname:c="/",search:u="",hash:d="",state:f=null,key:A="default"}=r,h=x.useMemo(()=>{let m=tA(c,o);return m==null?null:{location:{pathname:m,search:u,hash:d,state:f,key:A},navigationType:n}},[o,c,u,d,f,A,n]);return af(h!=null,`<Router basename="${o}"> is not able to match the URL "${c}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:x.createElement(cf.Provider,{value:l},x.createElement(iw.Provider,{children:e,value:h}))}function zAe({children:t,location:e}){return FAe(gT(t),e)}function gT(t,e=[]){let r=[];return x.Children.forEach(t,(n,a)=>{if(!x.isValidElement(n))return;let s=[...e,a];if(n.type===x.Fragment){r.push.apply(r,gT(n.props.children,s));return}Ps(n.type===wn,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ps(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=gT(n.props.children,s)),r.push(o)}),r}var L_="get",U_="application/x-www-form-urlencoded";function nj(t){return t!=null&&typeof t.tagName=="string"}function WAe(t){return nj(t)&&t.tagName.toLowerCase()==="button"}function XAe(t){return nj(t)&&t.tagName.toLowerCase()==="form"}function YAe(t){return nj(t)&&t.tagName.toLowerCase()==="input"}function JAe(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function ZAe(t,e){return t.button===0&&(!e||e==="_self")&&!JAe(t)}var HN=null;function e0e(){if(HN===null)try{new FormData(document.createElement("form"),0),HN=!1}catch{HN=!0}return HN}var t0e=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function a3(t){return t!=null&&!t0e.has(t)?(af(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${U_}"`),null):t}function r0e(t,e){let r,n,a,s,o;if(XAe(t)){let l=t.getAttribute("action");n=l?tA(l,e):null,r=t.getAttribute("method")||L_,a=a3(t.getAttribute("enctype"))||U_,s=new FormData(t)}else if(WAe(t)||YAe(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||l.getAttribute("action");if(n=c?tA(c,e):null,r=t.getAttribute("formmethod")||l.getAttribute("method")||L_,a=a3(t.getAttribute("formenctype"))||a3(l.getAttribute("enctype"))||U_,s=new FormData(l,t),!e0e()){let{name:u,type:d,value:f}=t;if(d==="image"){let A=u?`${u}.`:"";s.append(`${A}x`,"0"),s.append(`${A}y`,"0")}else u&&s.append(u,f)}}else{if(nj(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=L_,n=null,a=U_,o=t}return s&&a==="text/plain"&&(o=s,s=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:s,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function iD(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function n0e(t,e,r){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${r}`:e&&tA(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function a0e(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function s0e(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function i0e(t,e,r){let n=await Promise.all(t.map(async a=>{let s=e.routes[a.route.id];if(s){let o=await a0e(s,r);return o.links?o.links():[]}return[]}));return u0e(n.flat(1).filter(s0e).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function NU(t,e,r,n,a,s){let o=(c,u)=>r[u]?c.route.id!==r[u].route.id:!0,l=(c,u)=>{var d;return r[u].pathname!==c.pathname||((d=r[u].route.path)==null?void 0:d.endsWith("*"))&&r[u].params["*"]!==c.params["*"]};return s==="assets"?e.filter((c,u)=>o(c,u)||l(c,u)):s==="data"?e.filter((c,u)=>{var f;let d=n.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(o(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let A=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((f=r[0])==null?void 0:f.params)||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof A=="boolean")return A}return!0}):[]}function o0e(t,e,{includeHydrateFallback:r}={}){return l0e(t.map(n=>{let a=e.routes[n.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1))}function l0e(t){return[...new Set(t)]}function c0e(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function u0e(t,e){let r=new Set;return new Set(e),t.reduce((n,a)=>{let s=JSON.stringify(c0e(a));return r.has(s)||(r.add(s),n.push({key:s,link:a})),n},[])}function fY(){let t=x.useContext(Wv);return iD(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function d0e(){let t=x.useContext(rj);return iD(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var oD=x.createContext(void 0);oD.displayName="FrameworkContext";function hY(){let t=x.useContext(oD);return iD(t,"You must render this element inside a <HydratedRouter> element"),t}function f0e(t,e){let r=x.useContext(oD),[n,a]=x.useState(!1),[s,o]=x.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:f}=e,A=x.useRef(null);x.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let p=v=>{v.forEach(y=>{o(y.isIntersecting)})},g=new IntersectionObserver(p,{threshold:.5});return A.current&&g.observe(A.current),()=>{g.disconnect()}}},[t]),x.useEffect(()=>{if(n){let p=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(p)}}},[n]);let h=()=>{a(!0)},m=()=>{a(!1),o(!1)};return r?t!=="intent"?[s,A,{}]:[s,A,{onFocus:z1(l,h),onBlur:z1(c,m),onMouseEnter:z1(u,h),onMouseLeave:z1(d,m),onTouchStart:z1(f,h)}]:[!1,A,{}]}function z1(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function h0e({page:t,...e}){let{router:r}=fY(),n=x.useMemo(()=>rY(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?x.createElement(m0e,{page:t,matches:n,...e}):null}function A0e(t){let{manifest:e,routeModules:r}=hY(),[n,a]=x.useState([]);return x.useEffect(()=>{let s=!1;return i0e(t,e,r).then(o=>{s||a(o)}),()=>{s=!0}},[t,e,r]),n}function m0e({page:t,matches:e,...r}){let n=gA(),{manifest:a,routeModules:s}=hY(),{basename:o}=fY(),{loaderData:l,matches:c}=d0e(),u=x.useMemo(()=>NU(t,e,c,a,n,"data"),[t,e,c,a,n]),d=x.useMemo(()=>NU(t,e,c,a,n,"assets"),[t,e,c,a,n]),f=x.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let m=new Set,p=!1;if(e.forEach(v=>{var b;let y=a.routes[v.route.id];!y||!y.hasLoader||(!u.some(w=>w.route.id===v.route.id)&&v.route.id in l&&((b=s[v.route.id])!=null&&b.shouldRevalidate)||y.hasClientLoader?p=!0:m.add(v.route.id))}),m.size===0)return[];let g=n0e(t,o,"data");return p&&m.size>0&&g.searchParams.set("_routes",e.filter(v=>m.has(v.route.id)).map(v=>v.route.id).join(",")),[g.pathname+g.search]},[o,l,n,a,u,e,t,s]),A=x.useMemo(()=>o0e(d,a),[d,a]),h=A0e(d);return x.createElement(x.Fragment,null,f.map(m=>x.createElement("link",{key:m,rel:"prefetch",as:"fetch",href:m,...r})),A.map(m=>x.createElement("link",{key:m,rel:"modulepreload",href:m,...r})),h.map(({key:m,link:p})=>x.createElement("link",{key:m,nonce:r.nonce,...p})))}function p0e(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var AY=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{AY&&(window.__reactRouterVersion="7.8.1")}catch{}function g0e({basename:t,children:e,window:r}){let n=x.useRef();n.current==null&&(n.current=nAe({window:r,v5Compat:!0}));let a=n.current,[s,o]=x.useState({action:a.action,location:a.location}),l=x.useCallback(c=>{x.startTransition(()=>o(c))},[o]);return x.useLayoutEffect(()=>a.listen(l),[a,l]),x.createElement(qAe,{basename:t,children:e,location:s.location,navigationType:s.action,navigator:a})}var mY=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,pY=x.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:a,reloadDocument:s,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:f,...A},h){let{basename:m}=x.useContext(cf),p=typeof u=="string"&&mY.test(u),g,v=!1;if(typeof u=="string"&&p&&(g=u,AY))try{let E=new URL(window.location.href),F=u.startsWith("//")?new URL(E.protocol+u):new URL(u),k=tA(F.pathname,m);F.origin===E.origin&&k!=null?u=k+F.search+F.hash:v=!0}catch{af(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let y=PAe(u,{relative:a}),[b,w,j]=f0e(n,A),I=y0e(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:a,viewTransition:f});function _(E){e&&e(E),E.defaultPrevented||I(E)}let S=x.createElement("a",{...A,...j,href:g||y,onClick:v||s?e:_,ref:p0e(h,w),target:c,"data-discover":!p&&r==="render"?"true":void 0});return b&&!p?x.createElement(x.Fragment,null,S,x.createElement(h0e,{page:y})):S});pY.displayName="Link";var an=x.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:a=!1,style:s,to:o,viewTransition:l,children:c,...u},d){let f=lw(o,{relative:u.relative}),A=gA(),h=x.useContext(rj),{navigator:m,basename:p}=x.useContext(cf),g=h!=null&&_0e(f)&&l===!0,v=m.encodeLocation?m.encodeLocation(f).pathname:f.pathname,y=A.pathname,b=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;r||(y=y.toLowerCase(),b=b?b.toLowerCase():null,v=v.toLowerCase()),b&&p&&(b=tA(b,p)||b);const w=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let j=y===v||!a&&y.startsWith(v)&&y.charAt(w)==="/",I=b!=null&&(b===v||!a&&b.startsWith(v)&&b.charAt(v.length)==="/"),_={isActive:j,isPending:I,isTransitioning:g},S=j?e:void 0,E;typeof n=="function"?E=n(_):E=[n,j?"active":null,I?"pending":null,g?"transitioning":null].filter(Boolean).join(" ");let F=typeof s=="function"?s(_):s;return x.createElement(pY,{...u,"aria-current":S,className:E,ref:d,style:F,to:o,viewTransition:l},typeof c=="function"?c(_):c)});an.displayName="NavLink";var x0e=x.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:a,state:s,method:o=L_,action:l,onSubmit:c,relative:u,preventScrollReset:d,viewTransition:f,...A},h)=>{let m=N0e(),p=C0e(l,{relative:u}),g=o.toLowerCase()==="get"?"get":"post",v=typeof l=="string"&&mY.test(l),y=b=>{if(c&&c(b),b.defaultPrevented)return;b.preventDefault();let w=b.nativeEvent.submitter,j=(w==null?void 0:w.getAttribute("formmethod"))||o;m(w||b.currentTarget,{fetcherKey:e,method:j,navigate:r,replace:a,state:s,relative:u,preventScrollReset:d,viewTransition:f})};return x.createElement("form",{ref:h,method:g,action:p,onSubmit:n?c:y,...A,"data-discover":!v&&t==="render"?"true":void 0})});x0e.displayName="Form";function v0e(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function gY(t){let e=x.useContext(Wv);return Ps(e,v0e(t)),e}function y0e(t,{target:e,replace:r,state:n,preventScrollReset:a,relative:s,viewTransition:o}={}){let l=ow(),c=gA(),u=lw(t,{relative:s});return x.useCallback(d=>{if(ZAe(d,e)){d.preventDefault();let f=r!==void 0?r:Yb(c)===Yb(u);l(t,{replace:f,state:n,preventScrollReset:a,relative:s,viewTransition:o})}},[c,l,u,r,n,e,t,a,s,o])}var b0e=0,w0e=()=>`__${String(++b0e)}__`;function N0e(){let{router:t}=gY("useSubmit"),{basename:e}=x.useContext(cf),r=HAe();return x.useCallback(async(n,a={})=>{let{action:s,method:o,encType:l,formData:c,body:u}=r0e(n,e);if(a.navigate===!1){let d=a.fetcherKey||w0e();await t.fetch(d,r,a.action||s,{preventScrollReset:a.preventScrollReset,formData:c,body:u,formMethod:a.method||o,formEncType:a.encType||l,flushSync:a.flushSync})}else await t.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:c,body:u,formMethod:a.method||o,formEncType:a.encType||l,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,e,r])}function C0e(t,{relative:e}={}){let{basename:r}=x.useContext(cf),n=x.useContext(uf);Ps(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),s={...lw(t||".",{relative:e})},o=gA();if(t==null){s.search=o.search;let l=new URLSearchParams(s.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(f=>f).forEach(f=>l.append("index",f));let d=l.toString();s.search=d?`?${d}`:""}}return(!t||t===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(s.pathname=s.pathname==="/"?r:Qh([r,s.pathname])),Yb(s)}function _0e(t,{relative:e}={}){let r=x.useContext(iY);Ps(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=gY("useViewTransitionState"),a=lw(t,{relative:e});if(!r.isTransitioning)return!1;let s=tA(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=tA(r.nextLocation.pathname,n)||r.nextLocation.pathname;return UE(a.pathname,o)!=null||UE(a.pathname,s)!=null}function sn(t,e){if(!t)return!1;const r=String(e);if(Array.isArray(t))return t.map(String).includes(r);const n=String(t);return n===r||n==="vendedor"&&r==="vendedor_pollo"}var CU={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xY=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},E0e=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const s=t[r++];e[n++]=String.fromCharCode((a&31)<<6|s&63)}else if(a>239&&a<365){const s=t[r++],o=t[r++],l=t[r++],c=((a&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const s=t[r++],o=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(s&63)<<6|o&63)}}return e.join("")},vY={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<t.length;a+=3){const s=t[a],o=a+1<t.length,l=o?t[a+1]:0,c=a+2<t.length,u=c?t[a+2]:0,d=s>>2,f=(s&3)<<4|l>>4;let A=(l&15)<<2|u>>6,h=u&63;c||(h=64,o||(A=64)),n.push(r[d],r[f],r[A],r[h])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(xY(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):E0e(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<t.length;){const s=r[t.charAt(a++)],l=a<t.length?r[t.charAt(a)]:0;++a;const u=a<t.length?r[t.charAt(a)]:64;++a;const f=a<t.length?r[t.charAt(a)]:64;if(++a,s==null||l==null||u==null||f==null)throw new S0e;const A=s<<2|l>>4;if(n.push(A),u!==64){const h=l<<4&240|u>>2;if(n.push(h),f!==64){const m=u<<6&192|f;n.push(m)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class S0e extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const I0e=function(t){const e=xY(t);return vY.encodeByteArray(e,!0)},QE=function(t){return I0e(t).replace(/\./g,"")},yY=function(t){try{return vY.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j0e(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P0e=()=>j0e().__FIREBASE_DEFAULTS__,B0e=()=>{if(typeof process>"u"||typeof CU>"u")return;const t=CU.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},T0e=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&yY(t[1]);return e&&JSON.parse(e)},aj=()=>{try{return P0e()||B0e()||T0e()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},bY=t=>{var e,r;return(r=(e=aj())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},k0e=t=>{const e=bY(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},wY=()=>{var t;return(t=aj())===null||t===void 0?void 0:t.config},NY=t=>{var e;return(e=aj())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0e{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O0e(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",a=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[QE(JSON.stringify(r)),QE(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ao(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function D0e(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ao())}function R0e(){var t;const e=(t=aj())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function M0e(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function L0e(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function U0e(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Q0e(){const t=Ao();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function CY(){return!R0e()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _Y(){try{return typeof indexedDB=="object"}catch{return!1}}function V0e(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{var s;e(((s=a.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H0e="FirebaseError";class xA extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=H0e,Object.setPrototypeOf(this,xA.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,cw.prototype.create)}}class cw{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},a=`${this.service}/${e}`,s=this.errors[e],o=s?$0e(s,n):"Error",l=`${this.serviceName}: ${o} (${a}).`;return new xA(a,l,n)}}function $0e(t,e){return t.replace(G0e,(r,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const G0e=/\{\$([^}]+)}/g;function K0e(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Jb(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const a of r){if(!n.includes(a))return!1;const s=t[a],o=e[a];if(_U(s)&&_U(o)){if(!Jb(s,o))return!1}else if(s!==o)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function _U(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uw(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Sy(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[a,s]=n.split("=");e[decodeURIComponent(a)]=decodeURIComponent(s)}}),e}function Iy(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function q0e(t,e){const r=new z0e(t,e);return r.subscribe.bind(r)}class z0e{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let a;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");W0e(e,["next","error","complete"])?a=e:a={next:e,error:r,complete:n},a.next===void 0&&(a.next=s3),a.error===void 0&&(a.error=s3),a.complete===void 0&&(a.complete=s3);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function W0e(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function s3(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ys(t){return t&&t._delegate?t._delegate:t}class $p{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wm="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let X0e=class{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new F0e;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(a)return null;throw s}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(J0e(e))try{this.getOrInitializeService({instanceIdentifier:Wm})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:a});n.resolve(s)}catch{}}}}clearInstance(e=Wm){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Wm){return this.instances.has(e)}getOptions(e=Wm){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);n===l&&o.resolve(a)}return a}onInit(e,r){var n;const a=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(a))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(a,s);const o=this.instances.get(a);return o&&e(o,a),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const a of n)try{a(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Y0e(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Wm){return this.component?this.component.multipleInstances?e:Wm:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Y0e(t){return t===Wm?void 0:t}function J0e(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z0e{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new X0e(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Xn||(Xn={}));const eme={debug:Xn.DEBUG,verbose:Xn.VERBOSE,info:Xn.INFO,warn:Xn.WARN,error:Xn.ERROR,silent:Xn.SILENT},tme=Xn.INFO,rme={[Xn.DEBUG]:"log",[Xn.VERBOSE]:"log",[Xn.INFO]:"info",[Xn.WARN]:"warn",[Xn.ERROR]:"error"},nme=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),a=rme[e];if(a)console[a](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let lD=class{constructor(e){this.name=e,this._logLevel=tme,this._logHandler=nme,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Xn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?eme[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Xn.DEBUG,...e),this._logHandler(this,Xn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Xn.VERBOSE,...e),this._logHandler(this,Xn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Xn.INFO,...e),this._logHandler(this,Xn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Xn.WARN,...e),this._logHandler(this,Xn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Xn.ERROR,...e),this._logHandler(this,Xn.ERROR,...e)}};const ame=(t,e)=>e.some(r=>t instanceof r);let EU,SU;function sme(){return EU||(EU=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ime(){return SU||(SU=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const EY=new WeakMap,xT=new WeakMap,SY=new WeakMap,i3=new WeakMap,cD=new WeakMap;function ome(t){const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{r(K0(t.result)),a()},o=()=>{n(t.error),a()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&EY.set(r,t)}).catch(()=>{}),cD.set(e,t),e}function lme(t){if(xT.has(t))return;const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{r(),a()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});xT.set(t,e)}let vT={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return xT.get(t);if(e==="objectStoreNames")return t.objectStoreNames||SY.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return K0(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function cme(t){vT=t(vT)}function ume(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(o3(this),e,...r);return SY.set(n,e.sort?e.sort():[e]),K0(n)}:ime().includes(t)?function(...e){return t.apply(o3(this),e),K0(EY.get(this))}:function(...e){return K0(t.apply(o3(this),e))}}function dme(t){return typeof t=="function"?ume(t):(t instanceof IDBTransaction&&lme(t),ame(t,sme())?new Proxy(t,vT):t)}function K0(t){if(t instanceof IDBRequest)return ome(t);if(i3.has(t))return i3.get(t);const e=dme(t);return e!==t&&(i3.set(t,e),cD.set(e,t)),e}const o3=t=>cD.get(t);function fme(t,e,{blocked:r,upgrade:n,blocking:a,terminated:s}={}){const o=indexedDB.open(t,e),l=K0(o);return n&&o.addEventListener("upgradeneeded",c=>{n(K0(o.result),c.oldVersion,c.newVersion,K0(o.transaction),c)}),r&&o.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{s&&c.addEventListener("close",()=>s()),a&&c.addEventListener("versionchange",u=>a(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const hme=["get","getKey","getAll","getAllKeys","count"],Ame=["put","add","delete","clear"],l3=new Map;function IU(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(l3.get(e))return l3.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,a=Ame.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||hme.includes(r)))return;const s=async function(o,...l){const c=this.transaction(o,a?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(l.shift())),(await Promise.all([u[r](...l),a&&c.done]))[0]};return l3.set(e,s),s}cme(t=>({...t,get:(e,r,n)=>IU(e,r)||t.get(e,r,n),has:(e,r)=>!!IU(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mme{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(pme(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function pme(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const yT="@firebase/app",jU="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rA=new lD("@firebase/app"),gme="@firebase/app-compat",xme="@firebase/analytics-compat",vme="@firebase/analytics",yme="@firebase/app-check-compat",bme="@firebase/app-check",wme="@firebase/auth",Nme="@firebase/auth-compat",Cme="@firebase/database",_me="@firebase/data-connect",Eme="@firebase/database-compat",Sme="@firebase/functions",Ime="@firebase/functions-compat",jme="@firebase/installations",Pme="@firebase/installations-compat",Bme="@firebase/messaging",Tme="@firebase/messaging-compat",kme="@firebase/performance",Fme="@firebase/performance-compat",Ome="@firebase/remote-config",Dme="@firebase/remote-config-compat",Rme="@firebase/storage",Mme="@firebase/storage-compat",Lme="@firebase/firestore",Ume="@firebase/vertexai-preview",Qme="@firebase/firestore-compat",Vme="firebase",Hme="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bT="[DEFAULT]",$me={[yT]:"fire-core",[gme]:"fire-core-compat",[vme]:"fire-analytics",[xme]:"fire-analytics-compat",[bme]:"fire-app-check",[yme]:"fire-app-check-compat",[wme]:"fire-auth",[Nme]:"fire-auth-compat",[Cme]:"fire-rtdb",[_me]:"fire-data-connect",[Eme]:"fire-rtdb-compat",[Sme]:"fire-fn",[Ime]:"fire-fn-compat",[jme]:"fire-iid",[Pme]:"fire-iid-compat",[Bme]:"fire-fcm",[Tme]:"fire-fcm-compat",[kme]:"fire-perf",[Fme]:"fire-perf-compat",[Ome]:"fire-rc",[Dme]:"fire-rc-compat",[Rme]:"fire-gcs",[Mme]:"fire-gcs-compat",[Lme]:"fire-fst",[Qme]:"fire-fst-compat",[Ume]:"fire-vertex","fire-js":"fire-js",[Vme]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bv=new Map,wT=new Map,NT=new Map;function PU(t,e){try{t.container.addComponent(e)}catch(r){rA.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function wv(t){const e=t.name;if(NT.has(e))return rA.debug(`There were multiple attempts to register component ${e}.`),!1;NT.set(e,t);for(const r of bv.values())PU(r,t);for(const r of wT.values())PU(r,t);return!0}function uD(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function kf(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gme={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},q0=new cw("app","Firebase",Gme);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kme{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new $p("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw q0.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yv=Hme;function dD(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:bT,automaticDataCollectionEnabled:!1},e),a=n.name;if(typeof a!="string"||!a)throw q0.create("bad-app-name",{appName:String(a)});if(r||(r=wY()),!r)throw q0.create("no-options");const s=bv.get(a);if(s){if(Jb(r,s.options)&&Jb(n,s.config))return s;throw q0.create("duplicate-app",{appName:a})}const o=new Z0e(a);for(const c of NT.values())o.addComponent(c);const l=new Kme(r,n,o);return bv.set(a,l),l}function fD(t=bT){const e=bv.get(t);if(!e&&t===bT&&wY())return dD();if(!e)throw q0.create("no-app",{appName:t});return e}async function qme(t){let e=!1;const r=t.name;bv.has(r)?(e=!0,bv.delete(r)):wT.has(r)&&t.decRefCount()<=0&&(wT.delete(r),e=!0),e&&(await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function z0(t,e,r){var n;let a=(n=$me[t])!==null&&n!==void 0?n:t;r&&(a+=`-${r}`);const s=a.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${a}" with version "${e}":`];s&&l.push(`library name "${a}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),rA.warn(l.join(" "));return}wv(new $p(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zme="firebase-heartbeat-database",Wme=1,Zb="firebase-heartbeat-store";let c3=null;function IY(){return c3||(c3=fme(zme,Wme,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Zb)}catch(r){console.warn(r)}}}}).catch(t=>{throw q0.create("idb-open",{originalErrorMessage:t.message})})),c3}async function Xme(t){try{const r=(await IY()).transaction(Zb),n=await r.objectStore(Zb).get(jY(t));return await r.done,n}catch(e){if(e instanceof xA)rA.warn(e.message);else{const r=q0.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});rA.warn(r.message)}}}async function BU(t,e){try{const n=(await IY()).transaction(Zb,"readwrite");await n.objectStore(Zb).put(e,jY(t)),await n.done}catch(r){if(r instanceof xA)rA.warn(r.message);else{const n=q0.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});rA.warn(n.message)}}}function jY(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yme=1024,Jme=30*24*60*60*1e3;class Zme{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new tpe(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=TU();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:a}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=Jme}),this._storage.overwrite(this._heartbeatsCache))}catch(n){rA.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=TU(),{heartbeatsToSend:n,unsentEntries:a}=epe(this._heartbeatsCache.heartbeats),s=QE(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return rA.warn(r),""}}}function TU(){return new Date().toISOString().substring(0,10)}function epe(t,e=Yme){const r=[];let n=t.slice();for(const a of t){const s=r.find(o=>o.agent===a.agent);if(s){if(s.dates.push(a.date),kU(r)>e){s.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),kU(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class tpe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return _Y()?V0e().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Xme(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return BU(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return BU(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function kU(t){return QE(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rpe(t){wv(new $p("platform-logger",e=>new mme(e),"PRIVATE")),wv(new $p("heartbeat",e=>new Zme(e),"PRIVATE")),z0(yT,jU,t),z0(yT,jU,"esm2017"),z0("fire-js","")}rpe("");function hD(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r}function PY(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const npe=PY,BY=new cw("auth","Firebase",PY());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VE=new lD("@firebase/auth");function ape(t,...e){VE.logLevel<=Xn.WARN&&VE.warn(`Auth (${Yv}): ${t}`,...e)}function Q_(t,...e){VE.logLevel<=Xn.ERROR&&VE.error(`Auth (${Yv}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sf(t,...e){throw AD(t,...e)}function Vf(t,...e){return AD(t,...e)}function TY(t,e,r){const n=Object.assign(Object.assign({},npe()),{[e]:r});return new cw("auth","Firebase",n).create(e,{appName:t.name})}function Vh(t){return TY(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function AD(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return BY.create(t,...e)}function mn(t,e,...r){if(!t)throw AD(e,...r)}function Th(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Q_(e),new Error(e)}function nA(t,e){t||Th(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CT(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function spe(){return FU()==="http:"||FU()==="https:"}function FU(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ipe(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(spe()||L0e()||"connection"in navigator)?navigator.onLine:!0}function ope(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dw{constructor(e,r){this.shortDelay=e,this.longDelay=r,nA(r>e,"Short delay should be less than long delay!"),this.isMobile=D0e()||U0e()}get(){return ipe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mD(t,e){nA(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kY{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Th("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Th("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Th("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lpe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cpe=new dw(3e4,6e4);function vA(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function yA(t,e,r,n,a={}){return FY(t,a,async()=>{let s={},o={};n&&(e==="GET"?o=n:s={body:JSON.stringify(n)});const l=uw(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},s);return M0e()||(u.referrerPolicy="no-referrer"),kY.fetch()(OY(t,t.config.apiHost,r,l),u)})}async function FY(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},lpe),e);try{const a=new dpe(t),s=await Promise.race([r(),a.promise]);a.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw $N(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw $N(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw $N(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw $N(t,"user-disabled",o);const d=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw TY(t,d,u);sf(t,d)}}catch(a){if(a instanceof xA)throw a;sf(t,"network-request-failed",{message:String(a)})}}async function fw(t,e,r,n,a={}){const s=await yA(t,e,r,n,a);return"mfaPendingCredential"in s&&sf(t,"multi-factor-auth-required",{_serverResponse:s}),s}function OY(t,e,r,n){const a=`${e}${r}?${n}`;return t.config.emulator?mD(t.config,a):`${t.config.apiScheme}://${a}`}function upe(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class dpe{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Vf(this.auth,"network-request-failed")),cpe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function $N(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=Vf(t,e,n);return a.customData._tokenResponse=r,a}function OU(t){return t!==void 0&&t.enterprise!==void 0}class fpe{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return upe(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function hpe(t,e){return yA(t,"GET","/v2/recaptchaConfig",vA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ape(t,e){return yA(t,"POST","/v1/accounts:delete",e)}async function DY(t,e){return yA(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ab(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function mpe(t,e=!1){const r=Ys(t),n=await r.getIdToken(e),a=pD(n);mn(a&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error");const s=typeof a.firebase=="object"?a.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:a,token:n,authTime:ab(u3(a.auth_time)),issuedAtTime:ab(u3(a.iat)),expirationTime:ab(u3(a.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function u3(t){return Number(t)*1e3}function pD(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Q_("JWT malformed, contained fewer than 3 sections"),null;try{const a=yY(r);return a?JSON.parse(a):(Q_("Failed to decode base64 JWT payload"),null)}catch(a){return Q_("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function DU(t){const e=pD(t);return mn(e,"internal-error"),mn(typeof e.exp<"u","internal-error"),mn(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e2(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof xA&&ppe(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function ppe({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gpe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const a=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _T{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=ab(this.lastLoginAt),this.creationTime=ab(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HE(t){var e;const r=t.auth,n=await t.getIdToken(),a=await e2(t,DY(r,{idToken:n}));mn(a==null?void 0:a.users.length,r,"internal-error");const s=a.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?RY(s.providerUserInfo):[],l=vpe(t.providerData,o),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new _T(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function xpe(t){const e=Ys(t);await HE(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function vpe(t,e){return[...t.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function RY(t){return t.map(e=>{var{providerId:r}=e,n=hD(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ype(t,e){const r=await FY(t,{},async()=>{const n=uw({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:s}=t.config,o=OY(t,a,"/v1/token",`key=${s}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",kY.fetch()(o,{method:"POST",headers:l,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function bpe(t,e){return yA(t,"POST","/v2/accounts:revokeToken",vA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){mn(e.idToken,"internal-error"),mn(typeof e.idToken<"u","internal-error"),mn(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):DU(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){mn(e.length!==0,"internal-error");const r=DU(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(mn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:a,expiresIn:s}=await ype(e,r);this.updateTokensAndExpiration(n,a,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:a,expirationTime:s}=r,o=new rv;return n&&(mn(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),a&&(mn(typeof a=="string","internal-error",{appName:e}),o.accessToken=a),s&&(mn(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new rv,this.toJSON())}_performRefresh(){return Th("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XA(t,e){mn(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class kh{constructor(e){var{uid:r,auth:n,stsTokenManager:a}=e,s=hD(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new gpe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new _T(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await e2(this,this.stsTokenManager.getToken(this.auth,e));return mn(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return mpe(this,e)}reload(){return xpe(this)}_assign(e){this!==e&&(mn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new kh(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){mn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await HE(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(kf(this.auth.app))return Promise.reject(Vh(this.auth));const e=await this.getIdToken();return await e2(this,Ape(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,a,s,o,l,c,u,d;const f=(n=r.displayName)!==null&&n!==void 0?n:void 0,A=(a=r.email)!==null&&a!==void 0?a:void 0,h=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,m=(o=r.photoURL)!==null&&o!==void 0?o:void 0,p=(l=r.tenantId)!==null&&l!==void 0?l:void 0,g=(c=r._redirectEventId)!==null&&c!==void 0?c:void 0,v=(u=r.createdAt)!==null&&u!==void 0?u:void 0,y=(d=r.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:b,emailVerified:w,isAnonymous:j,providerData:I,stsTokenManager:_}=r;mn(b&&_,e,"internal-error");const S=rv.fromJSON(this.name,_);mn(typeof b=="string",e,"internal-error"),XA(f,e.name),XA(A,e.name),mn(typeof w=="boolean",e,"internal-error"),mn(typeof j=="boolean",e,"internal-error"),XA(h,e.name),XA(m,e.name),XA(p,e.name),XA(g,e.name),XA(v,e.name),XA(y,e.name);const E=new kh({uid:b,auth:e,email:A,emailVerified:w,displayName:f,isAnonymous:j,photoURL:m,phoneNumber:h,tenantId:p,stsTokenManager:S,createdAt:v,lastLoginAt:y});return I&&Array.isArray(I)&&(E.providerData=I.map(F=>Object.assign({},F))),g&&(E._redirectEventId=g),E}static async _fromIdTokenResponse(e,r,n=!1){const a=new rv;a.updateFromServerResponse(r);const s=new kh({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await HE(s),s}static async _fromGetAccountInfoResponse(e,r,n){const a=r.users[0];mn(a.localId!==void 0,"internal-error");const s=a.providerUserInfo!==void 0?RY(a.providerUserInfo):[],o=!(a.email&&a.passwordHash)&&!(s!=null&&s.length),l=new rv;l.updateFromIdToken(n);const c=new kh({uid:a.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:s,metadata:new _T(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RU=new Map;function Fh(t){nA(t instanceof Function,"Expected a class definition");let e=RU.get(t);return e?(nA(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,RU.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MY{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}MY.type="NONE";const MU=MY;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V_(t,e,r){return`firebase:${t}:${e}:${r}`}class nv{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:a,name:s}=this.auth;this.fullUserKey=V_(this.userKey,a.apiKey,s),this.fullPersistenceKey=V_("persistence",a.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?kh._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new nv(Fh(MU),e,n);const a=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=a[0]||Fh(MU);const o=V_(n,e.config.apiKey,e.name);let l=null;for(const u of r)try{const d=await u._get(o);if(d){const f=kh._fromJSON(e,d);u!==s&&(l=f),s=u;break}}catch{}const c=a.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new nv(s,e,n):(s=c[0],l&&await s._set(o,l.toJSON()),await Promise.all(r.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new nv(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LU(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(VY(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(LY(e))return"Firefox";if(e.includes("silk/"))return"Silk";if($Y(e))return"Blackberry";if(GY(e))return"Webos";if(UY(e))return"Safari";if((e.includes("chrome/")||QY(e))&&!e.includes("edge/"))return"Chrome";if(HY(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function LY(t=Ao()){return/firefox\//i.test(t)}function UY(t=Ao()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function QY(t=Ao()){return/crios\//i.test(t)}function VY(t=Ao()){return/iemobile/i.test(t)}function HY(t=Ao()){return/android/i.test(t)}function $Y(t=Ao()){return/blackberry/i.test(t)}function GY(t=Ao()){return/webos/i.test(t)}function gD(t=Ao()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function wpe(t=Ao()){var e;return gD(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Npe(){return Q0e()&&document.documentMode===10}function KY(t=Ao()){return gD(t)||HY(t)||GY(t)||$Y(t)||/windows phone/i.test(t)||VY(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qY(t,e=[]){let r;switch(t){case"Browser":r=LU(Ao());break;case"Worker":r=`${LU(Ao())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Yv}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cpe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((o,l)=>{try{const c=e(s);o(c)}catch(c){l(c)}});n.onAbort=r,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const a of r)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _pe(t,e={}){return yA(t,"GET","/v2/passwordPolicy",vA(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Epe=6;class Spe{constructor(e){var r,n,a,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=o.minPasswordLength)!==null&&r!==void 0?r:Epe,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,a,s,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(r=c.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(n=c.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(a=c.containsLowercaseLetter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),a&&(r.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,a,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ipe{constructor(e,r,n,a){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new UU(this),this.idTokenSubscription=new UU(this),this.beforeStateQueue=new Cpe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=BY,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Fh(r)),this._initializationPromise=this.queue(async()=>{var n,a;if(!this._deleted&&(this.persistenceManager=await nv.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await DY(this,{idToken:e}),n=await kh._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(kf(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let a=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,l=a==null?void 0:a._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(a=c.user,s=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(a)}catch(o){a=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return mn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await HE(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ope()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(kf(this.app))return Promise.reject(Vh(this));const r=e?Ys(e):null;return r&&mn(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&mn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return kf(this.app)?Promise.reject(Vh(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return kf(this.app)?Promise.reject(Vh(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Fh(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await _pe(this),r=new Spe(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new cw("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await bpe(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Fh(e)||this._popupRedirectResolver;mn(r,this,"argument-error"),this.redirectPersistenceManager=await nv.create(this,[Fh(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,a){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(mn(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,a);return()=>{o=!0,c()}}else{const c=e.addObserver(r);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return mn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=qY(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const a=await this._getAppCheckToken();return a&&(r["X-Firebase-AppCheck"]=a),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&ape(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Nm(t){return Ys(t)}class UU{constructor(e){this.auth=e,this.observer=null,this.addObserver=q0e(r=>this.observer=r)}get next(){return mn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sj={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function jpe(t){sj=t}function zY(t){return sj.loadJS(t)}function Ppe(){return sj.recaptchaEnterpriseScript}function Bpe(){return sj.gapiScript}function Tpe(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const kpe="recaptcha-enterprise",Fpe="NO_RECAPTCHA";class Ope{constructor(e){this.type=kpe,this.auth=Nm(e)}async verify(e="verify",r=!1){async function n(s){if(!r){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,l)=>{hpe(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new fpe(c);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function a(s,o,l){const c=window.grecaptcha;OU(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(Fpe)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{n(this.auth).then(l=>{if(!r&&OU(window.grecaptcha))a(l,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=Ppe();c.length!==0&&(c+=l),zY(c).then(()=>{a(l,s,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function QU(t,e,r,n=!1){const a=new Ope(t);let s;try{s=await a.verify(r)}catch{s=await a.verify(r,!0)}const o=Object.assign({},e);return n?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function $E(t,e,r,n){var a;if(!((a=t._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await QU(t,e,r,r==="getOobCode");return n(t,s)}else return n(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await QU(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dpe(t,e){const r=uD(t,"auth");if(r.isInitialized()){const a=r.getImmediate(),s=r.getOptions();if(Jb(s,e??{}))return a;sf(a,"already-initialized")}return r.initialize({options:e})}function Rpe(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Fh);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function Mpe(t,e,r){const n=Nm(t);mn(n._canInitEmulator,n,"emulator-config-failed"),mn(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,s=WY(e),{host:o,port:l}=Lpe(e),c=l===null?"":`:${l}`;n.config.emulator={url:`${s}//${o}${c}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:a})}),Upe()}function WY(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Lpe(t){const e=WY(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const s=a[1];return{host:s,port:VU(n.substr(s.length+1))}}else{const[s,o]=n.split(":");return{host:s,port:VU(o)}}}function VU(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Upe(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xD{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Th("not implemented")}_getIdTokenResponse(e){return Th("not implemented")}_linkToIdToken(e,r){return Th("not implemented")}_getReauthenticationResolver(e){return Th("not implemented")}}async function Qpe(t,e){return yA(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vpe(t,e){return fw(t,"POST","/v1/accounts:signInWithPassword",vA(t,e))}async function Hpe(t,e){return yA(t,"POST","/v1/accounts:sendOobCode",vA(t,e))}async function $pe(t,e){return Hpe(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gpe(t,e){return fw(t,"POST","/v1/accounts:signInWithEmailLink",vA(t,e))}async function Kpe(t,e){return fw(t,"POST","/v1/accounts:signInWithEmailLink",vA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t2 extends xD{constructor(e,r,n,a=null){super("password",n),this._email=e,this._password=r,this._tenantId=a}static _fromEmailAndPassword(e,r){return new t2(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new t2(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return $E(e,r,"signInWithPassword",Vpe);case"emailLink":return Gpe(e,{email:this._email,oobCode:this._password});default:sf(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return $E(e,n,"signUpPassword",Qpe);case"emailLink":return Kpe(e,{idToken:r,email:this._email,oobCode:this._password});default:sf(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function av(t,e){return fw(t,"POST","/v1/accounts:signInWithIdp",vA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qpe="http://localhost";class Gp extends xD{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Gp(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):sf("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a}=r,s=hD(r,["providerId","signInMethod"]);if(!n||!a)return null;const o=new Gp(n,a);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return av(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,av(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,av(e,r)}buildRequest(){const e={requestUri:qpe,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=uw(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zpe(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Wpe(t){const e=Sy(Iy(t)).link,r=e?Sy(Iy(e)).deep_link_id:null,n=Sy(Iy(t)).deep_link_id;return(n?Sy(Iy(n)).link:null)||n||r||e||t}class vD{constructor(e){var r,n,a,s,o,l;const c=Sy(Iy(e)),u=(r=c.apiKey)!==null&&r!==void 0?r:null,d=(n=c.oobCode)!==null&&n!==void 0?n:null,f=zpe((a=c.mode)!==null&&a!==void 0?a:null);mn(u&&d&&f,"argument-error"),this.apiKey=u,this.operation=f,this.code=d,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const r=Wpe(e);try{return new vD(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jv{constructor(){this.providerId=Jv.PROVIDER_ID}static credential(e,r){return t2._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=vD.parseLink(r);return mn(n,"argument-error"),t2._fromEmailAndCode(e,n.code,n.tenantId)}}Jv.PROVIDER_ID="password";Jv.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Jv.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XY{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hw extends XY{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0 extends hw{constructor(){super("facebook.com")}static credential(e){return Gp._fromParams({providerId:y0.PROVIDER_ID,signInMethod:y0.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return y0.credentialFromTaggedObject(e)}static credentialFromError(e){return y0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return y0.credential(e.oauthAccessToken)}catch{return null}}}y0.FACEBOOK_SIGN_IN_METHOD="facebook.com";y0.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b0 extends hw{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Gp._fromParams({providerId:b0.PROVIDER_ID,signInMethod:b0.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return b0.credentialFromTaggedObject(e)}static credentialFromError(e){return b0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return b0.credential(r,n)}catch{return null}}}b0.GOOGLE_SIGN_IN_METHOD="google.com";b0.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0 extends hw{constructor(){super("github.com")}static credential(e){return Gp._fromParams({providerId:w0.PROVIDER_ID,signInMethod:w0.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return w0.credentialFromTaggedObject(e)}static credentialFromError(e){return w0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return w0.credential(e.oauthAccessToken)}catch{return null}}}w0.GITHUB_SIGN_IN_METHOD="github.com";w0.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0 extends hw{constructor(){super("twitter.com")}static credential(e,r){return Gp._fromParams({providerId:N0.PROVIDER_ID,signInMethod:N0.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return N0.credentialFromTaggedObject(e)}static credentialFromError(e){return N0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return N0.credential(r,n)}catch{return null}}}N0.TWITTER_SIGN_IN_METHOD="twitter.com";N0.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xpe(t,e){return fw(t,"POST","/v1/accounts:signUp",vA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,a=!1){const s=await kh._fromIdTokenResponse(e,n,a),o=HU(n);return new Kp({user:s,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const a=HU(n);return new Kp({user:e,providerId:a,_tokenResponse:n,operationType:r})}}function HU(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GE extends xA{constructor(e,r,n,a){var s;super(r.code,r.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,GE.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,a){return new GE(e,r,n,a)}}function YY(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?GE._fromErrorAndOperation(t,s,e,n):s})}async function Ype(t,e,r=!1){const n=await e2(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Kp._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jpe(t,e,r=!1){const{auth:n}=t;if(kf(n.app))return Promise.reject(Vh(n));const a="reauthenticate";try{const s=await e2(t,YY(n,a,e,t),r);mn(s.idToken,n,"internal-error");const o=pD(s.idToken);mn(o,n,"internal-error");const{sub:l}=o;return mn(t.uid===l,n,"user-mismatch"),Kp._forOperation(t,a,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&sf(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JY(t,e,r=!1){if(kf(t.app))return Promise.reject(Vh(t));const n="signIn",a=await YY(t,n,e),s=await Kp._fromIdTokenResponse(t,n,a);return r||await t._updateCurrentUser(s.user),s}async function Zpe(t,e){return JY(Nm(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZY(t){const e=Nm(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function ege(t,e,r){const n=Nm(t);await $E(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",$pe)}async function tge(t,e,r){if(kf(t.app))return Promise.reject(Vh(t));const n=Nm(t),o=await $E(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Xpe).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&ZY(t),c}),l=await Kp._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(l.user),l}function rge(t,e,r){return kf(t.app)?Promise.reject(Vh(t)):Zpe(Ys(t),Jv.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&ZY(t),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H_(t,e){return Ys(t).setPersistence(e)}function nge(t,e,r,n){return Ys(t).onIdTokenChanged(e,r,n)}function age(t,e,r){return Ys(t).beforeAuthStateChanged(e,r)}function ij(t,e,r,n){return Ys(t).onAuthStateChanged(e,r,n)}function yD(t){return Ys(t).signOut()}const KE="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eJ{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(KE,"1"),this.storage.removeItem(KE),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sge=1e3,ige=10;class tJ extends eJ{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=KY(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),a=this.localCache[r];n!==a&&e(r,a,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const a=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},s=this.storage.getItem(n);Npe()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,ige):a()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},sge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}tJ.type="LOCAL";const bD=tJ;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rJ extends eJ{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}rJ.type="SESSION";const wD=rJ;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oge(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oj{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(a=>a.isListeningto(e));if(r)return r;const n=new oj(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:a,data:s}=r.data,o=this.handlersMap[a];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const l=Array.from(o).map(async u=>u(r.origin,s)),c=await oge(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}oj.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ND(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lge{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let s,o;return new Promise((l,c)=>{const u=ND("",20);a.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},n);o={messageChannel:a,onMessage(f){const A=f;if(A.data.eventId===u)switch(A.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(A.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),a.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[a.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hf(){return window}function cge(t){Hf().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nJ(){return typeof Hf().WorkerGlobalScope<"u"&&typeof Hf().importScripts=="function"}async function uge(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function dge(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function fge(){return nJ()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aJ="firebaseLocalStorageDb",hge=1,qE="firebaseLocalStorage",sJ="fbase_key";class Aw{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function lj(t,e){return t.transaction([qE],e?"readwrite":"readonly").objectStore(qE)}function Age(){const t=indexedDB.deleteDatabase(aJ);return new Aw(t).toPromise()}function ET(){const t=indexedDB.open(aJ,hge);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(qE,{keyPath:sJ})}catch(a){r(a)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(qE)?e(n):(n.close(),await Age(),e(await ET()))})})}async function $U(t,e,r){const n=lj(t,!0).put({[sJ]:e,value:r});return new Aw(n).toPromise()}async function mge(t,e){const r=lj(t,!1).get(e),n=await new Aw(r).toPromise();return n===void 0?null:n.value}function GU(t,e){const r=lj(t,!0).delete(e);return new Aw(r).toPromise()}const pge=800,gge=3;class iJ{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ET(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>gge)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return nJ()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=oj._getInstance(fge()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await uge(),!this.activeServiceWorker)return;this.sender=new lge(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||dge()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ET();return await $U(e,KE,"1"),await GU(e,KE),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>$U(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>mge(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>GU(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const s=lj(a,!1).getAll();return new Aw(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:s}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(s)&&(this.notifyListeners(a,s),r.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),r.push(a));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),pge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}iJ.type="LOCAL";const oJ=iJ;new dw(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xge(t,e){return e?Fh(e):(mn(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CD extends xD{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return av(e,this._buildIdpRequest())}_linkToIdToken(e,r){return av(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return av(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function vge(t){return JY(t.auth,new CD(t),t.bypassAuthState)}function yge(t){const{auth:e,user:r}=t;return mn(r,e,"internal-error"),Jpe(r,new CD(t),t.bypassAuthState)}async function bge(t){const{auth:e,user:r}=t;return mn(r,e,"internal-error"),Ype(r,new CD(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lJ{constructor(e,r,n,a,s=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:a,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return vge;case"linkViaPopup":case"linkViaRedirect":return bge;case"reauthViaPopup":case"reauthViaRedirect":return yge;default:sf(this.auth,"internal-error")}}resolve(e){nA(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){nA(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wge=new dw(2e3,1e4);class Ux extends lJ{constructor(e,r,n,a,s){super(e,r,a,s),this.provider=n,this.authWindow=null,this.pollId=null,Ux.currentPopupAction&&Ux.currentPopupAction.cancel(),Ux.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return mn(e,this.auth,"internal-error"),e}async onExecution(){nA(this.filter.length===1,"Popup operations only handle one event");const e=ND();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Vf(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Vf(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ux.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Vf(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,wge.get())};e()}}Ux.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nge="pendingRedirect",$_=new Map;class Cge extends lJ{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=$_.get(this.auth._key());if(!e){try{const n=await _ge(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}$_.set(this.auth._key(),e)}return this.bypassAuthState||$_.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _ge(t,e){const r=Ige(e),n=Sge(t);if(!await n._isAvailable())return!1;const a=await n._get(r)==="true";return await n._remove(r),a}function Ege(t,e){$_.set(t._key(),e)}function Sge(t){return Fh(t._redirectPersistence)}function Ige(t){return V_(Nge,t.config.apiKey,t.name)}async function jge(t,e,r=!1){if(kf(t.app))return Promise.reject(Vh(t));const n=Nm(t),a=xge(n,e),o=await new Cge(n,a,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pge=10*60*1e3;class Bge{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Tge(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!cJ(e)){const a=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Vf(this.auth,a))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Pge&&this.cachedEventUids.clear(),this.cachedEventUids.has(KU(e))}saveEventToCache(e){this.cachedEventUids.add(KU(e)),this.lastProcessedEventTime=Date.now()}}function KU(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function cJ({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Tge(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return cJ(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kge(t,e={}){return yA(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fge=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Oge=/^https?/;async function Dge(t){if(t.config.emulator)return;const{authorizedDomains:e}=await kge(t);for(const r of e)try{if(Rge(r))return}catch{}sf(t,"unauthorized-domain")}function Rge(t){const e=CT(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!Oge.test(r))return!1;if(Fge.test(t))return n===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mge=new dw(3e4,6e4);function qU(){const t=Hf().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function Lge(t){return new Promise((e,r)=>{var n,a,s;function o(){qU(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{qU(),r(Vf(t,"network-request-failed"))},timeout:Mge.get()})}if(!((a=(n=Hf().gapi)===null||n===void 0?void 0:n.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((s=Hf().gapi)===null||s===void 0)&&s.load)o();else{const l=Tpe("iframefcb");return Hf()[l]=()=>{gapi.load?o():r(Vf(t,"network-request-failed"))},zY(`${Bpe()}?onload=${l}`).catch(c=>r(c))}}).catch(e=>{throw G_=null,e})}let G_=null;function Uge(t){return G_=G_||Lge(t),G_}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qge=new dw(5e3,15e3),Vge="__/auth/iframe",Hge="emulator/auth/iframe",$ge={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Gge=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Kge(t){const e=t.config;mn(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?mD(e,Hge):`https://${t.config.authDomain}/${Vge}`,n={apiKey:e.apiKey,appName:t.name,v:Yv},a=Gge.get(t.config.apiHost);a&&(n.eid=a);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${uw(n).slice(1)}`}async function qge(t){const e=await Uge(t),r=Hf().gapi;return mn(r,t,"internal-error"),e.open({where:document.body,url:Kge(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:$ge,dontclear:!0},n=>new Promise(async(a,s)=>{await n.restyle({setHideOnLeave:!1});const o=Vf(t,"network-request-failed"),l=Hf().setTimeout(()=>{s(o)},Qge.get());function c(){Hf().clearTimeout(l),a(n)}n.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zge={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Wge=500,Xge=600,Yge="_blank",Jge="http://localhost";class zU{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Zge(t,e,r,n=Wge,a=Xge){const s=Math.max((window.screen.availHeight-a)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c=Object.assign(Object.assign({},zge),{width:n.toString(),height:a.toString(),top:s,left:o}),u=Ao().toLowerCase();r&&(l=QY(u)?Yge:r),LY(u)&&(e=e||Jge,c.scrollbars="yes");const d=Object.entries(c).reduce((A,[h,m])=>`${A}${h}=${m},`,"");if(wpe(u)&&l!=="_self")return exe(e||"",l),new zU(null);const f=window.open(e||"",l,d);mn(f,t,"popup-blocked");try{f.focus()}catch{}return new zU(f)}function exe(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const txe="__/auth/handler",rxe="emulator/auth/handler",nxe=encodeURIComponent("fac");async function WU(t,e,r,n,a,s){mn(t.config.authDomain,t,"auth-domain-config-required"),mn(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Yv,eventId:a};if(e instanceof XY){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",K0e(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries({}))o[d]=f}if(e instanceof hw){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${nxe}=${encodeURIComponent(c)}`:"";return`${axe(t)}?${uw(l).slice(1)}${u}`}function axe({config:t}){return t.emulator?mD(t,rxe):`https://${t.authDomain}/${txe}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d3="webStorageSupport";class sxe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=wD,this._completeRedirectFn=jge,this._overrideRedirectResult=Ege}async _openPopup(e,r,n,a){var s;nA((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await WU(e,r,n,CT(),a);return Zge(e,o,ND())}async _openRedirect(e,r,n,a){await this._originValidation(e);const s=await WU(e,r,n,CT(),a);return cge(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:a,promise:s}=this.eventManagers[r];return a?Promise.resolve(a):(nA(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await qge(e),n=new Bge(e);return r.register("authEvent",a=>(mn(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(d3,{type:d3},a=>{var s;const o=(s=a==null?void 0:a[0])===null||s===void 0?void 0:s[d3];o!==void 0&&r(!!o),sf(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=Dge(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return KY()||UY()||gD()}}const ixe=sxe;var XU="@firebase/auth",YU="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oxe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){mn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lxe(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function cxe(t){wv(new $p("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=n.options;mn(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:qY(t)},u=new Ipe(n,a,s,c);return Rpe(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),wv(new $p("auth-internal",e=>{const r=Nm(e.getProvider("auth").getImmediate());return(n=>new oxe(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),z0(XU,YU,lxe(t)),z0(XU,YU,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uxe=5*60,dxe=NY("authIdTokenMaxAge")||uxe;let JU=null;const fxe=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>dxe)return;const a=r==null?void 0:r.token;JU!==a&&(JU=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function ST(t=fD()){const e=uD(t,"auth");if(e.isInitialized())return e.getImmediate();const r=Dpe(t,{popupRedirectResolver:ixe,persistence:[oJ,bD,wD]}),n=NY("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const o=fxe(s.toString());age(r,o,()=>o(r.currentUser)),nge(r,l=>o(l))}}const a=bY("auth");return a&&Mpe(r,`http://${a}`),r}function hxe(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}jpe({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=a=>{const s=Vf("internal-error");s.customData=a,r(s)},n.type="text/javascript",n.charset="UTF-8",hxe().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});cxe("Browser");var Axe="firebase",mxe="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */z0(Axe,mxe,"app");var ZU=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Np,uJ;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(_,S){function E(){}E.prototype=S.prototype,_.D=S.prototype,_.prototype=new E,_.prototype.constructor=_,_.C=function(F,k,P){for(var D=Array(arguments.length-2),X=2;X<arguments.length;X++)D[X-2]=arguments[X];return S.prototype[k].apply(F,D)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(_,S,E){E||(E=0);var F=Array(16);if(typeof S=="string")for(var k=0;16>k;++k)F[k]=S.charCodeAt(E++)|S.charCodeAt(E++)<<8|S.charCodeAt(E++)<<16|S.charCodeAt(E++)<<24;else for(k=0;16>k;++k)F[k]=S[E++]|S[E++]<<8|S[E++]<<16|S[E++]<<24;S=_.g[0],E=_.g[1],k=_.g[2];var P=_.g[3],D=S+(P^E&(k^P))+F[0]+3614090360&4294967295;S=E+(D<<7&4294967295|D>>>25),D=P+(k^S&(E^k))+F[1]+3905402710&4294967295,P=S+(D<<12&4294967295|D>>>20),D=k+(E^P&(S^E))+F[2]+606105819&4294967295,k=P+(D<<17&4294967295|D>>>15),D=E+(S^k&(P^S))+F[3]+3250441966&4294967295,E=k+(D<<22&4294967295|D>>>10),D=S+(P^E&(k^P))+F[4]+4118548399&4294967295,S=E+(D<<7&4294967295|D>>>25),D=P+(k^S&(E^k))+F[5]+1200080426&4294967295,P=S+(D<<12&4294967295|D>>>20),D=k+(E^P&(S^E))+F[6]+2821735955&4294967295,k=P+(D<<17&4294967295|D>>>15),D=E+(S^k&(P^S))+F[7]+4249261313&4294967295,E=k+(D<<22&4294967295|D>>>10),D=S+(P^E&(k^P))+F[8]+1770035416&4294967295,S=E+(D<<7&4294967295|D>>>25),D=P+(k^S&(E^k))+F[9]+2336552879&4294967295,P=S+(D<<12&4294967295|D>>>20),D=k+(E^P&(S^E))+F[10]+4294925233&4294967295,k=P+(D<<17&4294967295|D>>>15),D=E+(S^k&(P^S))+F[11]+2304563134&4294967295,E=k+(D<<22&4294967295|D>>>10),D=S+(P^E&(k^P))+F[12]+1804603682&4294967295,S=E+(D<<7&4294967295|D>>>25),D=P+(k^S&(E^k))+F[13]+4254626195&4294967295,P=S+(D<<12&4294967295|D>>>20),D=k+(E^P&(S^E))+F[14]+2792965006&4294967295,k=P+(D<<17&4294967295|D>>>15),D=E+(S^k&(P^S))+F[15]+1236535329&4294967295,E=k+(D<<22&4294967295|D>>>10),D=S+(k^P&(E^k))+F[1]+4129170786&4294967295,S=E+(D<<5&4294967295|D>>>27),D=P+(E^k&(S^E))+F[6]+3225465664&4294967295,P=S+(D<<9&4294967295|D>>>23),D=k+(S^E&(P^S))+F[11]+643717713&4294967295,k=P+(D<<14&4294967295|D>>>18),D=E+(P^S&(k^P))+F[0]+3921069994&4294967295,E=k+(D<<20&4294967295|D>>>12),D=S+(k^P&(E^k))+F[5]+3593408605&4294967295,S=E+(D<<5&4294967295|D>>>27),D=P+(E^k&(S^E))+F[10]+38016083&4294967295,P=S+(D<<9&4294967295|D>>>23),D=k+(S^E&(P^S))+F[15]+3634488961&4294967295,k=P+(D<<14&4294967295|D>>>18),D=E+(P^S&(k^P))+F[4]+3889429448&4294967295,E=k+(D<<20&4294967295|D>>>12),D=S+(k^P&(E^k))+F[9]+568446438&4294967295,S=E+(D<<5&4294967295|D>>>27),D=P+(E^k&(S^E))+F[14]+3275163606&4294967295,P=S+(D<<9&4294967295|D>>>23),D=k+(S^E&(P^S))+F[3]+4107603335&4294967295,k=P+(D<<14&4294967295|D>>>18),D=E+(P^S&(k^P))+F[8]+1163531501&4294967295,E=k+(D<<20&4294967295|D>>>12),D=S+(k^P&(E^k))+F[13]+2850285829&4294967295,S=E+(D<<5&4294967295|D>>>27),D=P+(E^k&(S^E))+F[2]+4243563512&4294967295,P=S+(D<<9&4294967295|D>>>23),D=k+(S^E&(P^S))+F[7]+1735328473&4294967295,k=P+(D<<14&4294967295|D>>>18),D=E+(P^S&(k^P))+F[12]+2368359562&4294967295,E=k+(D<<20&4294967295|D>>>12),D=S+(E^k^P)+F[5]+4294588738&4294967295,S=E+(D<<4&4294967295|D>>>28),D=P+(S^E^k)+F[8]+2272392833&4294967295,P=S+(D<<11&4294967295|D>>>21),D=k+(P^S^E)+F[11]+1839030562&4294967295,k=P+(D<<16&4294967295|D>>>16),D=E+(k^P^S)+F[14]+4259657740&4294967295,E=k+(D<<23&4294967295|D>>>9),D=S+(E^k^P)+F[1]+2763975236&4294967295,S=E+(D<<4&4294967295|D>>>28),D=P+(S^E^k)+F[4]+1272893353&4294967295,P=S+(D<<11&4294967295|D>>>21),D=k+(P^S^E)+F[7]+4139469664&4294967295,k=P+(D<<16&4294967295|D>>>16),D=E+(k^P^S)+F[10]+3200236656&4294967295,E=k+(D<<23&4294967295|D>>>9),D=S+(E^k^P)+F[13]+681279174&4294967295,S=E+(D<<4&4294967295|D>>>28),D=P+(S^E^k)+F[0]+3936430074&4294967295,P=S+(D<<11&4294967295|D>>>21),D=k+(P^S^E)+F[3]+3572445317&4294967295,k=P+(D<<16&4294967295|D>>>16),D=E+(k^P^S)+F[6]+76029189&4294967295,E=k+(D<<23&4294967295|D>>>9),D=S+(E^k^P)+F[9]+3654602809&4294967295,S=E+(D<<4&4294967295|D>>>28),D=P+(S^E^k)+F[12]+3873151461&4294967295,P=S+(D<<11&4294967295|D>>>21),D=k+(P^S^E)+F[15]+530742520&4294967295,k=P+(D<<16&4294967295|D>>>16),D=E+(k^P^S)+F[2]+3299628645&4294967295,E=k+(D<<23&4294967295|D>>>9),D=S+(k^(E|~P))+F[0]+4096336452&4294967295,S=E+(D<<6&4294967295|D>>>26),D=P+(E^(S|~k))+F[7]+1126891415&4294967295,P=S+(D<<10&4294967295|D>>>22),D=k+(S^(P|~E))+F[14]+2878612391&4294967295,k=P+(D<<15&4294967295|D>>>17),D=E+(P^(k|~S))+F[5]+4237533241&4294967295,E=k+(D<<21&4294967295|D>>>11),D=S+(k^(E|~P))+F[12]+1700485571&4294967295,S=E+(D<<6&4294967295|D>>>26),D=P+(E^(S|~k))+F[3]+2399980690&4294967295,P=S+(D<<10&4294967295|D>>>22),D=k+(S^(P|~E))+F[10]+4293915773&4294967295,k=P+(D<<15&4294967295|D>>>17),D=E+(P^(k|~S))+F[1]+2240044497&4294967295,E=k+(D<<21&4294967295|D>>>11),D=S+(k^(E|~P))+F[8]+1873313359&4294967295,S=E+(D<<6&4294967295|D>>>26),D=P+(E^(S|~k))+F[15]+4264355552&4294967295,P=S+(D<<10&4294967295|D>>>22),D=k+(S^(P|~E))+F[6]+2734768916&4294967295,k=P+(D<<15&4294967295|D>>>17),D=E+(P^(k|~S))+F[13]+1309151649&4294967295,E=k+(D<<21&4294967295|D>>>11),D=S+(k^(E|~P))+F[4]+4149444226&4294967295,S=E+(D<<6&4294967295|D>>>26),D=P+(E^(S|~k))+F[11]+3174756917&4294967295,P=S+(D<<10&4294967295|D>>>22),D=k+(S^(P|~E))+F[2]+718787259&4294967295,k=P+(D<<15&4294967295|D>>>17),D=E+(P^(k|~S))+F[9]+3951481745&4294967295,_.g[0]=_.g[0]+S&4294967295,_.g[1]=_.g[1]+(k+(D<<21&4294967295|D>>>11))&4294967295,_.g[2]=_.g[2]+k&4294967295,_.g[3]=_.g[3]+P&4294967295}n.prototype.u=function(_,S){S===void 0&&(S=_.length);for(var E=S-this.blockSize,F=this.B,k=this.h,P=0;P<S;){if(k==0)for(;P<=E;)a(this,_,P),P+=this.blockSize;if(typeof _=="string"){for(;P<S;)if(F[k++]=_.charCodeAt(P++),k==this.blockSize){a(this,F),k=0;break}}else for(;P<S;)if(F[k++]=_[P++],k==this.blockSize){a(this,F),k=0;break}}this.h=k,this.o+=S},n.prototype.v=function(){var _=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);_[0]=128;for(var S=1;S<_.length-8;++S)_[S]=0;var E=8*this.o;for(S=_.length-8;S<_.length;++S)_[S]=E&255,E/=256;for(this.u(_),_=Array(16),S=E=0;4>S;++S)for(var F=0;32>F;F+=8)_[E++]=this.g[S]>>>F&255;return _};function s(_,S){var E=l;return Object.prototype.hasOwnProperty.call(E,_)?E[_]:E[_]=S(_)}function o(_,S){this.h=S;for(var E=[],F=!0,k=_.length-1;0<=k;k--){var P=_[k]|0;F&&P==S||(E[k]=P,F=!1)}this.g=E}var l={};function c(_){return-128<=_&&128>_?s(_,function(S){return new o([S|0],0>S?-1:0)}):new o([_|0],0>_?-1:0)}function u(_){if(isNaN(_)||!isFinite(_))return f;if(0>_)return g(u(-_));for(var S=[],E=1,F=0;_>=E;F++)S[F]=_/E|0,E*=4294967296;return new o(S,0)}function d(_,S){if(_.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(_.charAt(0)=="-")return g(d(_.substring(1),S));if(0<=_.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=u(Math.pow(S,8)),F=f,k=0;k<_.length;k+=8){var P=Math.min(8,_.length-k),D=parseInt(_.substring(k,k+P),S);8>P?(P=u(Math.pow(S,P)),F=F.j(P).add(u(D))):(F=F.j(E),F=F.add(u(D)))}return F}var f=c(0),A=c(1),h=c(16777216);t=o.prototype,t.m=function(){if(p(this))return-g(this).m();for(var _=0,S=1,E=0;E<this.g.length;E++){var F=this.i(E);_+=(0<=F?F:4294967296+F)*S,S*=4294967296}return _},t.toString=function(_){if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(m(this))return"0";if(p(this))return"-"+g(this).toString(_);for(var S=u(Math.pow(_,6)),E=this,F="";;){var k=w(E,S).g;E=v(E,k.j(S));var P=((0<E.g.length?E.g[0]:E.h)>>>0).toString(_);if(E=k,m(E))return P+F;for(;6>P.length;)P="0"+P;F=P+F}},t.i=function(_){return 0>_?0:_<this.g.length?this.g[_]:this.h};function m(_){if(_.h!=0)return!1;for(var S=0;S<_.g.length;S++)if(_.g[S]!=0)return!1;return!0}function p(_){return _.h==-1}t.l=function(_){return _=v(this,_),p(_)?-1:m(_)?0:1};function g(_){for(var S=_.g.length,E=[],F=0;F<S;F++)E[F]=~_.g[F];return new o(E,~_.h).add(A)}t.abs=function(){return p(this)?g(this):this},t.add=function(_){for(var S=Math.max(this.g.length,_.g.length),E=[],F=0,k=0;k<=S;k++){var P=F+(this.i(k)&65535)+(_.i(k)&65535),D=(P>>>16)+(this.i(k)>>>16)+(_.i(k)>>>16);F=D>>>16,P&=65535,D&=65535,E[k]=D<<16|P}return new o(E,E[E.length-1]&-2147483648?-1:0)};function v(_,S){return _.add(g(S))}t.j=function(_){if(m(this)||m(_))return f;if(p(this))return p(_)?g(this).j(g(_)):g(g(this).j(_));if(p(_))return g(this.j(g(_)));if(0>this.l(h)&&0>_.l(h))return u(this.m()*_.m());for(var S=this.g.length+_.g.length,E=[],F=0;F<2*S;F++)E[F]=0;for(F=0;F<this.g.length;F++)for(var k=0;k<_.g.length;k++){var P=this.i(F)>>>16,D=this.i(F)&65535,X=_.i(k)>>>16,pe=_.i(k)&65535;E[2*F+2*k]+=D*pe,y(E,2*F+2*k),E[2*F+2*k+1]+=P*pe,y(E,2*F+2*k+1),E[2*F+2*k+1]+=D*X,y(E,2*F+2*k+1),E[2*F+2*k+2]+=P*X,y(E,2*F+2*k+2)}for(F=0;F<S;F++)E[F]=E[2*F+1]<<16|E[2*F];for(F=S;F<2*S;F++)E[F]=0;return new o(E,0)};function y(_,S){for(;(_[S]&65535)!=_[S];)_[S+1]+=_[S]>>>16,_[S]&=65535,S++}function b(_,S){this.g=_,this.h=S}function w(_,S){if(m(S))throw Error("division by zero");if(m(_))return new b(f,f);if(p(_))return S=w(g(_),S),new b(g(S.g),g(S.h));if(p(S))return S=w(_,g(S)),new b(g(S.g),S.h);if(30<_.g.length){if(p(_)||p(S))throw Error("slowDivide_ only works with positive integers.");for(var E=A,F=S;0>=F.l(_);)E=j(E),F=j(F);var k=I(E,1),P=I(F,1);for(F=I(F,2),E=I(E,2);!m(F);){var D=P.add(F);0>=D.l(_)&&(k=k.add(E),P=D),F=I(F,1),E=I(E,1)}return S=v(_,k.j(S)),new b(k,S)}for(k=f;0<=_.l(S);){for(E=Math.max(1,Math.floor(_.m()/S.m())),F=Math.ceil(Math.log(E)/Math.LN2),F=48>=F?1:Math.pow(2,F-48),P=u(E),D=P.j(S);p(D)||0<D.l(_);)E-=F,P=u(E),D=P.j(S);m(P)&&(P=A),k=k.add(P),_=v(_,D)}return new b(k,_)}t.A=function(_){return w(this,_).h},t.and=function(_){for(var S=Math.max(this.g.length,_.g.length),E=[],F=0;F<S;F++)E[F]=this.i(F)&_.i(F);return new o(E,this.h&_.h)},t.or=function(_){for(var S=Math.max(this.g.length,_.g.length),E=[],F=0;F<S;F++)E[F]=this.i(F)|_.i(F);return new o(E,this.h|_.h)},t.xor=function(_){for(var S=Math.max(this.g.length,_.g.length),E=[],F=0;F<S;F++)E[F]=this.i(F)^_.i(F);return new o(E,this.h^_.h)};function j(_){for(var S=_.g.length+1,E=[],F=0;F<S;F++)E[F]=_.i(F)<<1|_.i(F-1)>>>31;return new o(E,_.h)}function I(_,S){var E=S>>5;S%=32;for(var F=_.g.length-E,k=[],P=0;P<F;P++)k[P]=0<S?_.i(P+E)>>>S|_.i(P+E+1)<<32-S:_.i(P+E);return new o(k,_.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,uJ=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,Np=o}).apply(typeof ZU<"u"?ZU:typeof self<"u"?self:typeof window<"u"?window:{});var GN=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var dJ,jy,fJ,K_,IT,hJ,AJ,mJ;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(C,J,ye){return C==Array.prototype||C==Object.prototype||(C[J]=ye.value),C};function r(C){C=[typeof globalThis=="object"&&globalThis,C,typeof window=="object"&&window,typeof self=="object"&&self,typeof GN=="object"&&GN];for(var J=0;J<C.length;++J){var ye=C[J];if(ye&&ye.Math==Math)return ye}throw Error("Cannot find global object")}var n=r(this);function a(C,J){if(J)e:{var ye=n;C=C.split(".");for(var qe=0;qe<C.length-1;qe++){var Dt=C[qe];if(!(Dt in ye))break e;ye=ye[Dt]}C=C[C.length-1],qe=ye[C],J=J(qe),J!=qe&&J!=null&&e(ye,C,{configurable:!0,writable:!0,value:J})}}function s(C,J){C instanceof String&&(C+="");var ye=0,qe=!1,Dt={next:function(){if(!qe&&ye<C.length){var zt=ye++;return{value:J(zt,C[zt]),done:!1}}return qe=!0,{done:!0,value:void 0}}};return Dt[Symbol.iterator]=function(){return Dt},Dt}a("Array.prototype.values",function(C){return C||function(){return s(this,function(J,ye){return ye})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(C){var J=typeof C;return J=J!="object"?J:C?Array.isArray(C)?"array":J:"null",J=="array"||J=="object"&&typeof C.length=="number"}function u(C){var J=typeof C;return J=="object"&&C!=null||J=="function"}function d(C,J,ye){return C.call.apply(C.bind,arguments)}function f(C,J,ye){if(!C)throw Error();if(2<arguments.length){var qe=Array.prototype.slice.call(arguments,2);return function(){var Dt=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Dt,qe),C.apply(J,Dt)}}return function(){return C.apply(J,arguments)}}function A(C,J,ye){return A=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,A.apply(null,arguments)}function h(C,J){var ye=Array.prototype.slice.call(arguments,1);return function(){var qe=ye.slice();return qe.push.apply(qe,arguments),C.apply(this,qe)}}function m(C,J){function ye(){}ye.prototype=J.prototype,C.aa=J.prototype,C.prototype=new ye,C.prototype.constructor=C,C.Qb=function(qe,Dt,zt){for(var br=Array(arguments.length-2),Jn=2;Jn<arguments.length;Jn++)br[Jn-2]=arguments[Jn];return J.prototype[Dt].apply(qe,br)}}function p(C){const J=C.length;if(0<J){const ye=Array(J);for(let qe=0;qe<J;qe++)ye[qe]=C[qe];return ye}return[]}function g(C,J){for(let ye=1;ye<arguments.length;ye++){const qe=arguments[ye];if(c(qe)){const Dt=C.length||0,zt=qe.length||0;C.length=Dt+zt;for(let br=0;br<zt;br++)C[Dt+br]=qe[br]}else C.push(qe)}}class v{constructor(J,ye){this.i=J,this.j=ye,this.h=0,this.g=null}get(){let J;return 0<this.h?(this.h--,J=this.g,this.g=J.next,J.next=null):J=this.i(),J}}function y(C){return/^[\s\xa0]*$/.test(C)}function b(){var C=l.navigator;return C&&(C=C.userAgent)?C:""}function w(C){return w[" "](C),C}w[" "]=function(){};var j=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function I(C,J,ye){for(const qe in C)J.call(ye,C[qe],qe,C)}function _(C,J){for(const ye in C)J.call(void 0,C[ye],ye,C)}function S(C){const J={};for(const ye in C)J[ye]=C[ye];return J}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function F(C,J){let ye,qe;for(let Dt=1;Dt<arguments.length;Dt++){qe=arguments[Dt];for(ye in qe)C[ye]=qe[ye];for(let zt=0;zt<E.length;zt++)ye=E[zt],Object.prototype.hasOwnProperty.call(qe,ye)&&(C[ye]=qe[ye])}}function k(C){var J=1;C=C.split(":");const ye=[];for(;0<J&&C.length;)ye.push(C.shift()),J--;return C.length&&ye.push(C.join(":")),ye}function P(C){l.setTimeout(()=>{throw C},0)}function D(){var C=ae;let J=null;return C.g&&(J=C.g,C.g=C.g.next,C.g||(C.h=null),J.next=null),J}class X{constructor(){this.h=this.g=null}add(J,ye){const qe=pe.get();qe.set(J,ye),this.h?this.h.next=qe:this.g=qe,this.h=qe}}var pe=new v(()=>new ge,C=>C.reset());class ge{constructor(){this.next=this.g=this.h=null}set(J,ye){this.h=J,this.g=ye,this.next=null}reset(){this.next=this.g=this.h=null}}let fe,xe=!1,ae=new X,Se=()=>{const C=l.Promise.resolve(void 0);fe=()=>{C.then(Te)}};var Te=()=>{for(var C;C=D();){try{C.h.call(C.g)}catch(ye){P(ye)}var J=pe;J.j(C),100>J.h&&(J.h++,C.next=J.g,J.g=C)}xe=!1};function O(){this.s=this.s,this.C=this.C}O.prototype.s=!1,O.prototype.ma=function(){this.s||(this.s=!0,this.N())},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function G(C,J){this.type=C,this.g=this.target=J,this.defaultPrevented=!1}G.prototype.h=function(){this.defaultPrevented=!0};var z=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var C=!1,J=Object.defineProperty({},"passive",{get:function(){C=!0}});try{const ye=()=>{};l.addEventListener("test",ye,J),l.removeEventListener("test",ye,J)}catch{}return C}();function L(C,J){if(G.call(this,C?C.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,C){var ye=this.type=C.type,qe=C.changedTouches&&C.changedTouches.length?C.changedTouches[0]:null;if(this.target=C.target||C.srcElement,this.g=J,J=C.relatedTarget){if(j){e:{try{w(J.nodeName);var Dt=!0;break e}catch{}Dt=!1}Dt||(J=null)}}else ye=="mouseover"?J=C.fromElement:ye=="mouseout"&&(J=C.toElement);this.relatedTarget=J,qe?(this.clientX=qe.clientX!==void 0?qe.clientX:qe.pageX,this.clientY=qe.clientY!==void 0?qe.clientY:qe.pageY,this.screenX=qe.screenX||0,this.screenY=qe.screenY||0):(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0),this.button=C.button,this.key=C.key||"",this.ctrlKey=C.ctrlKey,this.altKey=C.altKey,this.shiftKey=C.shiftKey,this.metaKey=C.metaKey,this.pointerId=C.pointerId||0,this.pointerType=typeof C.pointerType=="string"?C.pointerType:Z[C.pointerType]||"",this.state=C.state,this.i=C,C.defaultPrevented&&L.aa.h.call(this)}}m(L,G);var Z={2:"touch",3:"pen",4:"mouse"};L.prototype.h=function(){L.aa.h.call(this);var C=this.i;C.preventDefault?C.preventDefault():C.returnValue=!1};var ee="closure_listenable_"+(1e6*Math.random()|0),R=0;function H(C,J,ye,qe,Dt){this.listener=C,this.proxy=null,this.src=J,this.type=ye,this.capture=!!qe,this.ha=Dt,this.key=++R,this.da=this.fa=!1}function ne(C){C.da=!0,C.listener=null,C.proxy=null,C.src=null,C.ha=null}function ve(C){this.src=C,this.g={},this.h=0}ve.prototype.add=function(C,J,ye,qe,Dt){var zt=C.toString();C=this.g[zt],C||(C=this.g[zt]=[],this.h++);var br=He(C,J,qe,Dt);return-1<br?(J=C[br],ye||(J.fa=!1)):(J=new H(J,this.src,zt,!!qe,Dt),J.fa=ye,C.push(J)),J};function U(C,J){var ye=J.type;if(ye in C.g){var qe=C.g[ye],Dt=Array.prototype.indexOf.call(qe,J,void 0),zt;(zt=0<=Dt)&&Array.prototype.splice.call(qe,Dt,1),zt&&(ne(J),C.g[ye].length==0&&(delete C.g[ye],C.h--))}}function He(C,J,ye,qe){for(var Dt=0;Dt<C.length;++Dt){var zt=C[Dt];if(!zt.da&&zt.listener==J&&zt.capture==!!ye&&zt.ha==qe)return Dt}return-1}var se="closure_lm_"+(1e6*Math.random()|0),re={};function Pe(C,J,ye,qe,Dt){if(Array.isArray(J)){for(var zt=0;zt<J.length;zt++)Pe(C,J[zt],ye,qe,Dt);return null}return ye=At(ye),C&&C[ee]?C.K(J,ye,u(qe)?!!qe.capture:!1,Dt):ue(C,J,ye,!1,qe,Dt)}function ue(C,J,ye,qe,Dt,zt){if(!J)throw Error("Invalid event type");var br=u(Dt)?!!Dt.capture:!!Dt,Jn=Ke(C);if(Jn||(C[se]=Jn=new ve(C)),ye=Jn.add(J,ye,qe,br,zt),ye.proxy)return ye;if(qe=we(),ye.proxy=qe,qe.src=C,qe.listener=ye,C.addEventListener)z||(Dt=br),Dt===void 0&&(Dt=!1),C.addEventListener(J.toString(),qe,Dt);else if(C.attachEvent)C.attachEvent(yt(J.toString()),qe);else if(C.addListener&&C.removeListener)C.addListener(qe);else throw Error("addEventListener and attachEvent are unavailable.");return ye}function we(){function C(ye){return J.call(C.src,C.listener,ye)}const J=It;return C}function Me(C,J,ye,qe,Dt){if(Array.isArray(J))for(var zt=0;zt<J.length;zt++)Me(C,J[zt],ye,qe,Dt);else qe=u(qe)?!!qe.capture:!!qe,ye=At(ye),C&&C[ee]?(C=C.i,J=String(J).toString(),J in C.g&&(zt=C.g[J],ye=He(zt,ye,qe,Dt),-1<ye&&(ne(zt[ye]),Array.prototype.splice.call(zt,ye,1),zt.length==0&&(delete C.g[J],C.h--)))):C&&(C=Ke(C))&&(J=C.g[J.toString()],C=-1,J&&(C=He(J,ye,qe,Dt)),(ye=-1<C?J[C]:null)&&ze(ye))}function ze(C){if(typeof C!="number"&&C&&!C.da){var J=C.src;if(J&&J[ee])U(J.i,C);else{var ye=C.type,qe=C.proxy;J.removeEventListener?J.removeEventListener(ye,qe,C.capture):J.detachEvent?J.detachEvent(yt(ye),qe):J.addListener&&J.removeListener&&J.removeListener(qe),(ye=Ke(J))?(U(ye,C),ye.h==0&&(ye.src=null,J[se]=null)):ne(C)}}}function yt(C){return C in re?re[C]:re[C]="on"+C}function It(C,J){if(C.da)C=!0;else{J=new L(J,this);var ye=C.listener,qe=C.ha||C.src;C.fa&&ze(C),C=ye.call(qe,J)}return C}function Ke(C){return C=C[se],C instanceof ve?C:null}var wt="__closure_events_fn_"+(1e9*Math.random()>>>0);function At(C){return typeof C=="function"?C:(C[wt]||(C[wt]=function(J){return C.handleEvent(J)}),C[wt])}function bt(){O.call(this),this.i=new ve(this),this.M=this,this.F=null}m(bt,O),bt.prototype[ee]=!0,bt.prototype.removeEventListener=function(C,J,ye,qe){Me(this,C,J,ye,qe)};function ke(C,J){var ye,qe=C.F;if(qe)for(ye=[];qe;qe=qe.F)ye.push(qe);if(C=C.M,qe=J.type||J,typeof J=="string")J=new G(J,C);else if(J instanceof G)J.target=J.target||C;else{var Dt=J;J=new G(qe,C),F(J,Dt)}if(Dt=!0,ye)for(var zt=ye.length-1;0<=zt;zt--){var br=J.g=ye[zt];Dt=Ne(br,qe,!0,J)&&Dt}if(br=J.g=C,Dt=Ne(br,qe,!0,J)&&Dt,Dt=Ne(br,qe,!1,J)&&Dt,ye)for(zt=0;zt<ye.length;zt++)br=J.g=ye[zt],Dt=Ne(br,qe,!1,J)&&Dt}bt.prototype.N=function(){if(bt.aa.N.call(this),this.i){var C=this.i,J;for(J in C.g){for(var ye=C.g[J],qe=0;qe<ye.length;qe++)ne(ye[qe]);delete C.g[J],C.h--}}this.F=null},bt.prototype.K=function(C,J,ye,qe){return this.i.add(String(C),J,!1,ye,qe)},bt.prototype.L=function(C,J,ye,qe){return this.i.add(String(C),J,!0,ye,qe)};function Ne(C,J,ye,qe){if(J=C.i.g[String(J)],!J)return!0;J=J.concat();for(var Dt=!0,zt=0;zt<J.length;++zt){var br=J[zt];if(br&&!br.da&&br.capture==ye){var Jn=br.listener,Ls=br.ha||br.src;br.fa&&U(C.i,br),Dt=Jn.call(Ls,qe)!==!1&&Dt}}return Dt&&!qe.defaultPrevented}function Ve(C,J,ye){if(typeof C=="function")ye&&(C=A(C,ye));else if(C&&typeof C.handleEvent=="function")C=A(C.handleEvent,C);else throw Error("Invalid listener argument");return 2147483647<Number(J)?-1:l.setTimeout(C,J||0)}function he(C){C.g=Ve(()=>{C.g=null,C.i&&(C.i=!1,he(C))},C.l);const J=C.h;C.h=null,C.m.apply(null,J)}class le extends O{constructor(J,ye){super(),this.m=J,this.l=ye,this.h=null,this.i=!1,this.g=null}j(J){this.h=arguments,this.g?this.i=!0:he(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Be(C){O.call(this),this.h=C,this.g={}}m(Be,O);var je=[];function Ae(C){I(C.g,function(J,ye){this.g.hasOwnProperty(ye)&&ze(J)},C),C.g={}}Be.prototype.N=function(){Be.aa.N.call(this),Ae(this)},Be.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Qe=l.JSON.stringify,Ct=l.JSON.parse,pt=class{stringify(C){return l.JSON.stringify(C,void 0)}parse(C){return l.JSON.parse(C,void 0)}};function me(){}me.prototype.h=null;function te(C){return C.h||(C.h=C.i())}function ie(){}var $e={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function de(){G.call(this,"d")}m(de,G);function Ce(){G.call(this,"c")}m(Ce,G);var nt={},vt=null;function ht(){return vt=vt||new bt}nt.La="serverreachability";function xt(C){G.call(this,nt.La,C)}m(xt,G);function Xe(C){const J=ht();ke(J,new xt(J))}nt.STAT_EVENT="statevent";function be(C,J){G.call(this,nt.STAT_EVENT,C),this.stat=J}m(be,G);function st(C){const J=ht();ke(J,new be(J,C))}nt.Ma="timingevent";function K(C,J){G.call(this,nt.Ma,C),this.size=J}m(K,G);function Ie(C,J){if(typeof C!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){C()},J)}function Ze(){this.g=!0}Ze.prototype.xa=function(){this.g=!1};function at(C,J,ye,qe,Dt,zt){C.info(function(){if(C.g)if(zt)for(var br="",Jn=zt.split("&"),Ls=0;Ls<Jn.length;Ls++){var Qn=Jn[Ls].split("=");if(1<Qn.length){var ca=Qn[0];Qn=Qn[1];var es=ca.split("_");br=2<=es.length&&es[1]=="type"?br+(ca+"="+Qn+"&"):br+(ca+"=redacted&")}}else br=null;else br=zt;return"XMLHTTP REQ ("+qe+") [attempt "+Dt+"]: "+J+`
`+ye+`
`+br})}function it(C,J,ye,qe,Dt,zt,br){C.info(function(){return"XMLHTTP RESP ("+qe+") [ attempt "+Dt+"]: "+J+`
`+ye+`
`+zt+" "+br})}function T(C,J,ye,qe){C.info(function(){return"XMLHTTP TEXT ("+J+"): "+V(C,ye)+(qe?" "+qe:"")})}function M(C,J){C.info(function(){return"TIMEOUT: "+J})}Ze.prototype.info=function(){};function V(C,J){if(!C.g)return J;if(!J)return null;try{var ye=JSON.parse(J);if(ye){for(C=0;C<ye.length;C++)if(Array.isArray(ye[C])){var qe=ye[C];if(!(2>qe.length)){var Dt=qe[1];if(Array.isArray(Dt)&&!(1>Dt.length)){var zt=Dt[0];if(zt!="noop"&&zt!="stop"&&zt!="close")for(var br=1;br<Dt.length;br++)Dt[br]=""}}}}return Qe(ye)}catch{return J}}var q={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Y={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},oe;function De(){}m(De,me),De.prototype.g=function(){return new XMLHttpRequest},De.prototype.i=function(){return{}},oe=new De;function We(C,J,ye,qe){this.j=C,this.i=J,this.l=ye,this.R=qe||1,this.U=new Be(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new dt}function dt(){this.i=null,this.g="",this.h=!1}var Oe={},et={};function mt(C,J,ye){C.L=1,C.v=Jt(Et(J)),C.m=ye,C.P=!0,Tt(C,null)}function Tt(C,J){C.F=Date.now(),Xt(C),C.A=Et(C.v);var ye=C.A,qe=C.R;Array.isArray(qe)||(qe=[String(qe)]),$l(ye.i,"t",qe),C.C=0,ye=C.j.J,C.h=new dt,C.g=ri(C.j,ye?J:null,!C.m),0<C.O&&(C.M=new le(A(C.Y,C,C.g),C.O)),J=C.U,ye=C.g,qe=C.ca;var Dt="readystatechange";Array.isArray(Dt)||(Dt&&(je[0]=Dt.toString()),Dt=je);for(var zt=0;zt<Dt.length;zt++){var br=Pe(ye,Dt[zt],qe||J.handleEvent,!1,J.h||J);if(!br)break;J.g[br.key]=br}J=C.H?S(C.H):{},C.m?(C.u||(C.u="POST"),J["Content-Type"]="application/x-www-form-urlencoded",C.g.ea(C.A,C.u,C.m,J)):(C.u="GET",C.g.ea(C.A,C.u,null,J)),Xe(),at(C.i,C.u,C.A,C.l,C.R,C.m)}We.prototype.ca=function(C){C=C.target;const J=this.M;J&&Kl(C)==3?J.j():this.Y(C)},We.prototype.Y=function(C){try{if(C==this.g)e:{const es=Kl(this.g);var J=this.g.Ba();const $c=this.g.Z();if(!(3>es)&&(es!=3||this.g&&(this.h.h||this.g.oa()||km(this.g)))){this.J||es!=4||J==7||(J==8||0>=$c?Xe(3):Xe(2)),Yr(this);var ye=this.g.Z();this.X=ye;t:if(Pt(this)){var qe=km(this.g);C="";var Dt=qe.length,zt=Kl(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Fr(this),Br(this);var br="";break t}this.h.i=new l.TextDecoder}for(J=0;J<Dt;J++)this.h.h=!0,C+=this.h.i.decode(qe[J],{stream:!(zt&&J==Dt-1)});qe.length=0,this.h.g+=C,this.C=0,br=this.h.g}else br=this.g.oa();if(this.o=ye==200,it(this.i,this.u,this.A,this.l,this.R,es,ye),this.o){if(this.T&&!this.K){t:{if(this.g){var Jn,Ls=this.g;if((Jn=Ls.g?Ls.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(Jn)){var Qn=Jn;break t}}Qn=null}if(ye=Qn)T(this.i,this.l,ye,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,vn(this,ye);else{this.o=!1,this.s=3,st(12),Fr(this),Br(this);break e}}if(this.P){ye=!0;let ml;for(;!this.J&&this.C<br.length;)if(ml=Ft(this,br),ml==et){es==4&&(this.s=4,st(14),ye=!1),T(this.i,this.l,null,"[Incomplete Response]");break}else if(ml==Oe){this.s=4,st(15),T(this.i,this.l,br,"[Invalid Chunk]"),ye=!1;break}else T(this.i,this.l,ml,null),vn(this,ml);if(Pt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),es!=4||br.length!=0||this.h.h||(this.s=1,st(16),ye=!1),this.o=this.o&&ye,!ye)T(this.i,this.l,br,"[Invalid Chunked Response]"),Fr(this),Br(this);else if(0<br.length&&!this.W){this.W=!0;var ca=this.j;ca.g==this&&ca.ba&&!ca.M&&(ca.j.info("Great, no buffering proxy detected. Bytes received: "+br.length),Dr(ca),ca.M=!0,st(11))}}else T(this.i,this.l,br,null),vn(this,br);es==4&&Fr(this),this.o&&!this.J&&(es==4?bn(this.j,this):(this.o=!1,Xt(this)))}else Lg(this.g),ye==400&&0<br.indexOf("Unknown SID")?(this.s=3,st(12)):(this.s=0,st(13)),Fr(this),Br(this)}}}catch{}finally{}};function Pt(C){return C.g?C.u=="GET"&&C.L!=2&&C.j.Ca:!1}function Ft(C,J){var ye=C.C,qe=J.indexOf(`
`,ye);return qe==-1?et:(ye=Number(J.substring(ye,qe)),isNaN(ye)?Oe:(qe+=1,qe+ye>J.length?et:(J=J.slice(qe,qe+ye),C.C=qe+ye,J)))}We.prototype.cancel=function(){this.J=!0,Fr(this)};function Xt(C){C.S=Date.now()+C.I,mr(C,C.I)}function mr(C,J){if(C.B!=null)throw Error("WatchDog timer not null");C.B=Ie(A(C.ba,C),J)}function Yr(C){C.B&&(l.clearTimeout(C.B),C.B=null)}We.prototype.ba=function(){this.B=null;const C=Date.now();0<=C-this.S?(M(this.i,this.A),this.L!=2&&(Xe(),st(17)),Fr(this),this.s=2,Br(this)):mr(this,this.S-C)};function Br(C){C.j.G==0||C.J||bn(C.j,C)}function Fr(C){Yr(C);var J=C.M;J&&typeof J.ma=="function"&&J.ma(),C.M=null,Ae(C.U),C.g&&(J=C.g,C.g=null,J.abort(),J.ma())}function vn(C,J){try{var ye=C.j;if(ye.G!=0&&(ye.g==C||Je(ye.h,C))){if(!C.K&&Je(ye.h,C)&&ye.G==3){try{var qe=ye.Da.g.parse(J)}catch{qe=null}if(Array.isArray(qe)&&qe.length==3){var Dt=qe;if(Dt[0]==0){e:if(!ye.u){if(ye.g)if(ye.g.F+3e3<C.F)un(ye),ju(ye);else break e;ur(ye),st(18)}}else ye.za=Dt[1],0<ye.za-ye.T&&37500>Dt[2]&&ye.F&&ye.v==0&&!ye.C&&(ye.C=Ie(A(ye.Za,ye),6e3));if(1>=Ua(ye.h)&&ye.ca){try{ye.ca()}catch{}ye.ca=void 0}}else ma(ye,11)}else if((C.K||ye.g==C)&&un(ye),!y(J))for(Dt=ye.Da.g.parse(J),J=0;J<Dt.length;J++){let Qn=Dt[J];if(ye.T=Qn[0],Qn=Qn[1],ye.G==2)if(Qn[0]=="c"){ye.K=Qn[1],ye.ia=Qn[2];const ca=Qn[3];ca!=null&&(ye.la=ca,ye.j.info("VER="+ye.la));const es=Qn[4];es!=null&&(ye.Aa=es,ye.j.info("SVER="+ye.Aa));const $c=Qn[5];$c!=null&&typeof $c=="number"&&0<$c&&(qe=1.5*$c,ye.L=qe,ye.j.info("backChannelRequestTimeoutMs_="+qe)),qe=ye;const ml=C.g;if(ml){const Ho=ml.g?ml.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ho){var zt=qe.h;zt.g||Ho.indexOf("spdy")==-1&&Ho.indexOf("quic")==-1&&Ho.indexOf("h2")==-1||(zt.j=zt.l,zt.g=new Set,zt.h&&(Ot(zt,zt.h),zt.h=null))}if(qe.D){const Ed=ml.g?ml.g.getResponseHeader("X-HTTP-Session-Id"):null;Ed&&(qe.ya=Ed,Rt(qe.I,qe.D,Ed))}}ye.G=3,ye.l&&ye.l.ua(),ye.ba&&(ye.R=Date.now()-C.F,ye.j.info("Handshake RTT: "+ye.R+"ms")),qe=ye;var br=C;if(qe.qa=_a(qe,qe.J?qe.ia:null,qe.W),br.K){Kt(qe.h,br);var Jn=br,Ls=qe.L;Ls&&(Jn.I=Ls),Jn.B&&(Yr(Jn),Xt(Jn)),qe.g=br}else sr(qe);0<ye.i.length&&Q(ye)}else Qn[0]!="stop"&&Qn[0]!="close"||ma(ye,7);else ye.G==3&&(Qn[0]=="stop"||Qn[0]=="close"?Qn[0]=="stop"?ma(ye,7):OA(ye):Qn[0]!="noop"&&ye.l&&ye.l.ta(Qn),ye.v=0)}}Xe(4)}catch{}}var Ln=class{constructor(C,J){this.g=C,this.map=J}};function yn(C){this.l=C||10,l.PerformanceNavigationTiming?(C=l.performance.getEntriesByType("navigation"),C=0<C.length&&(C[0].nextHopProtocol=="hq"||C[0].nextHopProtocol=="h2")):C=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=C?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function In(C){return C.h?!0:C.g?C.g.size>=C.j:!1}function Ua(C){return C.h?1:C.g?C.g.size:0}function Je(C,J){return C.h?C.h==J:C.g?C.g.has(J):!1}function Ot(C,J){C.g?C.g.add(J):C.h=J}function Kt(C,J){C.h&&C.h==J?C.h=null:C.g&&C.g.has(J)&&C.g.delete(J)}yn.prototype.cancel=function(){if(this.i=ar(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const C of this.g.values())C.cancel();this.g.clear()}};function ar(C){if(C.h!=null)return C.i.concat(C.h.D);if(C.g!=null&&C.g.size!==0){let J=C.i;for(const ye of C.g.values())J=J.concat(ye.D);return J}return p(C.i)}function Ar(C){if(C.V&&typeof C.V=="function")return C.V();if(typeof Map<"u"&&C instanceof Map||typeof Set<"u"&&C instanceof Set)return Array.from(C.values());if(typeof C=="string")return C.split("");if(c(C)){for(var J=[],ye=C.length,qe=0;qe<ye;qe++)J.push(C[qe]);return J}J=[],ye=0;for(qe in C)J[ye++]=C[qe];return J}function ft(C){if(C.na&&typeof C.na=="function")return C.na();if(!C.V||typeof C.V!="function"){if(typeof Map<"u"&&C instanceof Map)return Array.from(C.keys());if(!(typeof Set<"u"&&C instanceof Set)){if(c(C)||typeof C=="string"){var J=[];C=C.length;for(var ye=0;ye<C;ye++)J.push(ye);return J}J=[],ye=0;for(const qe in C)J[ye++]=qe;return J}}}function lr(C,J){if(C.forEach&&typeof C.forEach=="function")C.forEach(J,void 0);else if(c(C)||typeof C=="string")Array.prototype.forEach.call(C,J,void 0);else for(var ye=ft(C),qe=Ar(C),Dt=qe.length,zt=0;zt<Dt;zt++)J.call(void 0,qe[zt],ye&&ye[zt],C)}var Le=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function tt(C,J){if(C){C=C.split("&");for(var ye=0;ye<C.length;ye++){var qe=C[ye].indexOf("="),Dt=null;if(0<=qe){var zt=C[ye].substring(0,qe);Dt=C[ye].substring(qe+1)}else zt=C[ye];J(zt,Dt?decodeURIComponent(Dt.replace(/\+/g," ")):"")}}}function Nt(C){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,C instanceof Nt){this.h=C.h,gt(this,C.j),this.o=C.o,this.g=C.g,ut(this,C.s),this.l=C.l;var J=C.i,ye=new jn;ye.i=J.i,J.g&&(ye.g=new Map(J.g),ye.h=J.h),Mt(this,ye),this.m=C.m}else C&&(J=String(C).match(Le))?(this.h=!1,gt(this,J[1]||"",!0),this.o=Lt(J[2]||""),this.g=Lt(J[3]||"",!0),ut(this,J[4]),this.l=Lt(J[5]||"",!0),Mt(this,J[6]||"",!0),this.m=Lt(J[7]||"")):(this.h=!1,this.i=new jn(null,this.h))}Nt.prototype.toString=function(){var C=[],J=this.j;J&&C.push(Wt(J,Ur,!0),":");var ye=this.g;return(ye||J=="file")&&(C.push("//"),(J=this.o)&&C.push(Wt(J,Ur,!0),"@"),C.push(encodeURIComponent(String(ye)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),ye=this.s,ye!=null&&C.push(":",String(ye))),(ye=this.l)&&(this.g&&ye.charAt(0)!="/"&&C.push("/"),C.push(Wt(ye,ye.charAt(0)=="/"?Nn:on,!0))),(ye=this.i.toString())&&C.push("?",ye),(ye=this.m)&&C.push("#",Wt(ye,Kn)),C.join("")};function Et(C){return new Nt(C)}function gt(C,J,ye){C.j=ye?Lt(J,!0):J,C.j&&(C.j=C.j.replace(/:$/,""))}function ut(C,J){if(J){if(J=Number(J),isNaN(J)||0>J)throw Error("Bad port number "+J);C.s=J}else C.s=null}function Mt(C,J,ye){J instanceof jn?(C.i=J,Cd(C.i,C.h)):(ye||(J=Wt(J,la)),C.i=new jn(J,C.h))}function Rt(C,J,ye){C.i.set(J,ye)}function Jt(C){return Rt(C,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),C}function Lt(C,J){return C?J?decodeURI(C.replace(/%25/g,"%2525")):decodeURIComponent(C):""}function Wt(C,J,ye){return typeof C=="string"?(C=encodeURI(C).replace(J,Tr),ye&&(C=C.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C):null}function Tr(C){return C=C.charCodeAt(0),"%"+(C>>4&15).toString(16)+(C&15).toString(16)}var Ur=/[#\/\?@]/g,on=/[#\?:]/g,Nn=/[#\?]/g,la=/[#\?@]/g,Kn=/#/g;function jn(C,J){this.h=this.g=null,this.i=C||null,this.j=!!J}function Un(C){C.g||(C.g=new Map,C.h=0,C.i&&tt(C.i,function(J,ye){C.add(decodeURIComponent(J.replace(/\+/g," ")),ye)}))}t=jn.prototype,t.add=function(C,J){Un(this),this.i=null,C=$r(this,C);var ye=this.g.get(C);return ye||this.g.set(C,ye=[]),ye.push(J),this.h+=1,this};function ti(C,J){Un(C),J=$r(C,J),C.g.has(J)&&(C.i=null,C.h-=C.g.get(J).length,C.g.delete(J))}function Fs(C,J){return Un(C),J=$r(C,J),C.g.has(J)}t.forEach=function(C,J){Un(this),this.g.forEach(function(ye,qe){ye.forEach(function(Dt){C.call(J,Dt,qe,this)},this)},this)},t.na=function(){Un(this);const C=Array.from(this.g.values()),J=Array.from(this.g.keys()),ye=[];for(let qe=0;qe<J.length;qe++){const Dt=C[qe];for(let zt=0;zt<Dt.length;zt++)ye.push(J[qe])}return ye},t.V=function(C){Un(this);let J=[];if(typeof C=="string")Fs(this,C)&&(J=J.concat(this.g.get($r(this,C))));else{C=Array.from(this.g.values());for(let ye=0;ye<C.length;ye++)J=J.concat(C[ye])}return J},t.set=function(C,J){return Un(this),this.i=null,C=$r(this,C),Fs(this,C)&&(this.h-=this.g.get(C).length),this.g.set(C,[J]),this.h+=1,this},t.get=function(C,J){return C?(C=this.V(C),0<C.length?String(C[0]):J):J};function $l(C,J,ye){ti(C,J),0<ye.length&&(C.i=null,C.g.set($r(C,J),p(ye)),C.h+=ye.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const C=[],J=Array.from(this.g.keys());for(var ye=0;ye<J.length;ye++){var qe=J[ye];const zt=encodeURIComponent(String(qe)),br=this.V(qe);for(qe=0;qe<br.length;qe++){var Dt=zt;br[qe]!==""&&(Dt+="="+encodeURIComponent(String(br[qe]))),C.push(Dt)}}return this.i=C.join("&")};function $r(C,J){return J=String(J),C.j&&(J=J.toLowerCase()),J}function Cd(C,J){J&&!C.j&&(Un(C),C.i=null,C.g.forEach(function(ye,qe){var Dt=qe.toLowerCase();qe!=Dt&&(ti(this,qe),$l(this,Dt,ye))},C)),C.j=J}function xc(C,J){const ye=new Ze;if(l.Image){const qe=new Image;qe.onload=h(Os,ye,"TestLoadImage: loaded",!0,J,qe),qe.onerror=h(Os,ye,"TestLoadImage: error",!1,J,qe),qe.onabort=h(Os,ye,"TestLoadImage: abort",!1,J,qe),qe.ontimeout=h(Os,ye,"TestLoadImage: timeout",!1,J,qe),l.setTimeout(function(){qe.ontimeout&&qe.ontimeout()},1e4),qe.src=C}else J(!1)}function Gl(C,J){const ye=new Ze,qe=new AbortController,Dt=setTimeout(()=>{qe.abort(),Os(ye,"TestPingServer: timeout",!1,J)},1e4);fetch(C,{signal:qe.signal}).then(zt=>{clearTimeout(Dt),zt.ok?Os(ye,"TestPingServer: ok",!0,J):Os(ye,"TestPingServer: server error",!1,J)}).catch(()=>{clearTimeout(Dt),Os(ye,"TestPingServer: error",!1,J)})}function Os(C,J,ye,qe,Dt){try{Dt&&(Dt.onload=null,Dt.onerror=null,Dt.onabort=null,Dt.ontimeout=null),qe(ye)}catch{}}function Ki(){this.g=new pt}function _1(C,J,ye){const qe=ye||"";try{lr(C,function(Dt,zt){let br=Dt;u(Dt)&&(br=Qe(Dt)),J.push(qe+zt+"="+encodeURIComponent(br))})}catch(Dt){throw J.push(qe+"type="+encodeURIComponent("_badmap")),Dt}}function TA(C){this.l=C.Ub||null,this.j=C.eb||!1}m(TA,me),TA.prototype.g=function(){return new _d(this.l,this.j)},TA.prototype.i=function(C){return function(){return C}}({});function _d(C,J){bt.call(this),this.D=C,this.o=J,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}m(_d,bt),t=_d.prototype,t.open=function(C,J){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=C,this.A=J,this.readyState=1,ah(this)},t.send=function(C){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const J={headers:this.u,method:this.B,credentials:this.m,cache:void 0};C&&(J.body=C),(this.D||l).fetch(new Request(this.A,J)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Hc(this)),this.readyState=0},t.Sa=function(C){if(this.g&&(this.l=C,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=C.headers,this.readyState=2,ah(this)),this.g&&(this.readyState=3,ah(this),this.g)))if(this.responseType==="arraybuffer")C.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in C){if(this.j=C.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;kA(this)}else C.text().then(this.Ra.bind(this),this.ga.bind(this))};function kA(C){C.j.read().then(C.Pa.bind(C)).catch(C.ga.bind(C))}t.Pa=function(C){if(this.g){if(this.o&&C.value)this.response.push(C.value);else if(!this.o){var J=C.value?C.value:new Uint8Array(0);(J=this.v.decode(J,{stream:!C.done}))&&(this.response=this.responseText+=J)}C.done?Hc(this):ah(this),this.readyState==3&&kA(this)}},t.Ra=function(C){this.g&&(this.response=this.responseText=C,Hc(this))},t.Qa=function(C){this.g&&(this.response=C,Hc(this))},t.ga=function(){this.g&&Hc(this)};function Hc(C){C.readyState=4,C.l=null,C.j=null,C.v=null,ah(C)}t.setRequestHeader=function(C,J){this.u.append(C,J)},t.getResponseHeader=function(C){return this.h&&this.h.get(C.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const C=[],J=this.h.entries();for(var ye=J.next();!ye.done;)ye=ye.value,C.push(ye[0]+": "+ye[1]),ye=J.next();return C.join(`\r
`)};function ah(C){C.onreadystatechange&&C.onreadystatechange.call(C)}Object.defineProperty(_d.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(C){this.m=C?"include":"same-origin"}});function Eu(C){let J="";return I(C,function(ye,qe){J+=qe,J+=":",J+=ye,J+=`\r
`}),J}function Bm(C,J,ye){e:{for(qe in ye){var qe=!1;break e}qe=!0}qe||(ye=Eu(ye),typeof C=="string"?ye!=null&&encodeURIComponent(String(ye)):Rt(C,J,ye))}function Qa(C){bt.call(this),this.headers=new Map,this.o=C||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}m(Qa,bt);var Tm=/^https?$/i,Mg=["POST","PUT"];t=Qa.prototype,t.Ha=function(C){this.J=C},t.ea=function(C,J,ye,qe){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+C);J=J?J.toUpperCase():"GET",this.D=C,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():oe.g(),this.v=this.o?te(this.o):te(oe),this.g.onreadystatechange=A(this.Ea,this);try{this.B=!0,this.g.open(J,String(C),!0),this.B=!1}catch(zt){Su(this,zt);return}if(C=ye||"",ye=new Map(this.headers),qe)if(Object.getPrototypeOf(qe)===Object.prototype)for(var Dt in qe)ye.set(Dt,qe[Dt]);else if(typeof qe.keys=="function"&&typeof qe.get=="function")for(const zt of qe.keys())ye.set(zt,qe.get(zt));else throw Error("Unknown input type for opt_headers: "+String(qe));qe=Array.from(ye.keys()).find(zt=>zt.toLowerCase()=="content-type"),Dt=l.FormData&&C instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Mg,J,void 0))||qe||Dt||ye.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[zt,br]of ye)this.g.setRequestHeader(zt,br);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{pf(this),this.u=!0,this.g.send(C),this.u=!1}catch(zt){Su(this,zt)}};function Su(C,J){C.h=!1,C.g&&(C.j=!0,C.g.abort(),C.j=!1),C.l=J,C.m=5,FA(C),mf(C)}function FA(C){C.A||(C.A=!0,ke(C,"complete"),ke(C,"error"))}t.abort=function(C){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=C||7,ke(this,"complete"),ke(this,"abort"),mf(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),mf(this,!0)),Qa.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?sh(this):this.bb())},t.bb=function(){sh(this)};function sh(C){if(C.h&&typeof o<"u"&&(!C.v[1]||Kl(C)!=4||C.Z()!=2)){if(C.u&&Kl(C)==4)Ve(C.Ea,0,C);else if(ke(C,"readystatechange"),Kl(C)==4){C.h=!1;try{const br=C.Z();e:switch(br){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var J=!0;break e;default:J=!1}var ye;if(!(ye=J)){var qe;if(qe=br===0){var Dt=String(C.D).match(Le)[1]||null;!Dt&&l.self&&l.self.location&&(Dt=l.self.location.protocol.slice(0,-1)),qe=!Tm.test(Dt?Dt.toLowerCase():"")}ye=qe}if(ye)ke(C,"complete"),ke(C,"success");else{C.m=6;try{var zt=2<Kl(C)?C.g.statusText:""}catch{zt=""}C.l=zt+" ["+C.Z()+"]",FA(C)}}finally{mf(C)}}}}function mf(C,J){if(C.g){pf(C);const ye=C.g,qe=C.v[0]?()=>{}:null;C.g=null,C.v=null,J||ke(C,"ready");try{ye.onreadystatechange=qe}catch{}}}function pf(C){C.I&&(l.clearTimeout(C.I),C.I=null)}t.isActive=function(){return!!this.g};function Kl(C){return C.g?C.g.readyState:0}t.Z=function(){try{return 2<Kl(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(C){if(this.g){var J=this.g.responseText;return C&&J.indexOf(C)==0&&(J=J.substring(C.length)),Ct(J)}};function km(C){try{if(!C.g)return null;if("response"in C.g)return C.g.response;switch(C.H){case"":case"text":return C.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in C.g)return C.g.mozResponseArrayBuffer}return null}catch{return null}}function Lg(C){const J={};C=(C.g&&2<=Kl(C)&&C.g.getAllResponseHeaders()||"").split(`\r
`);for(let qe=0;qe<C.length;qe++){if(y(C[qe]))continue;var ye=k(C[qe]);const Dt=ye[0];if(ye=ye[1],typeof ye!="string")continue;ye=ye.trim();const zt=J[Dt]||[];J[Dt]=zt,zt.push(ye)}_(J,function(qe){return qe.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ql(C,J,ye){return ye&&ye.internalChannelParams&&ye.internalChannelParams[C]||J}function Iu(C){this.Aa=0,this.i=[],this.j=new Ze,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ql("failFast",!1,C),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ql("baseRetryDelayMs",5e3,C),this.cb=ql("retryDelaySeedMs",1e4,C),this.Wa=ql("forwardChannelMaxRetries",2,C),this.wa=ql("forwardChannelRequestTimeoutMs",2e4,C),this.pa=C&&C.xmlHttpFactory||void 0,this.Xa=C&&C.Tb||void 0,this.Ca=C&&C.useFetchStreams||!1,this.L=void 0,this.J=C&&C.supportsCrossDomainXhr||!1,this.K="",this.h=new yn(C&&C.concurrentRequestLimit),this.Da=new Ki,this.P=C&&C.fastHandshake||!1,this.O=C&&C.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=C&&C.Rb||!1,C&&C.xa&&this.j.xa(),C&&C.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&C&&C.detectBufferingProxy||!1,this.ja=void 0,C&&C.longPollingTimeout&&0<C.longPollingTimeout&&(this.ja=C.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Iu.prototype,t.la=8,t.G=1,t.connect=function(C,J,ye,qe){st(0),this.W=C,this.H=J||{},ye&&qe!==void 0&&(this.H.OSID=ye,this.H.OAID=qe),this.F=this.X,this.I=_a(this,null,this.W),Q(this)};function OA(C){if(Fm(C),C.G==3){var J=C.U++,ye=Et(C.I);if(Rt(ye,"SID",C.K),Rt(ye,"RID",J),Rt(ye,"TYPE","terminate"),St(C,ye),J=new We(C,C.j,J),J.L=2,J.v=Jt(Et(ye)),ye=!1,l.navigator&&l.navigator.sendBeacon)try{ye=l.navigator.sendBeacon(J.v.toString(),"")}catch{}!ye&&l.Image&&(new Image().src=J.v,ye=!0),ye||(J.g=ri(J.j,null),J.g.ea(J.v)),J.F=Date.now(),Xt(J)}Ds(C)}function ju(C){C.g&&(Dr(C),C.g.cancel(),C.g=null)}function Fm(C){ju(C),C.u&&(l.clearTimeout(C.u),C.u=null),un(C),C.h.cancel(),C.s&&(typeof C.s=="number"&&l.clearTimeout(C.s),C.s=null)}function Q(C){if(!In(C.h)&&!C.s){C.s=!0;var J=C.Ga;fe||Se(),xe||(fe(),xe=!0),ae.add(J,C),C.B=0}}function _e(C,J){return Ua(C.h)>=C.h.j-(C.s?1:0)?!1:C.s?(C.i=J.D.concat(C.i),!0):C.G==1||C.G==2||C.B>=(C.Va?0:C.Wa)?!1:(C.s=Ie(A(C.Ga,C,J),qn(C,C.B)),C.B++,!0)}t.Ga=function(C){if(this.s)if(this.s=null,this.G==1){if(!C){this.U=Math.floor(1e5*Math.random()),C=this.U++;const Dt=new We(this,this.j,C);let zt=this.o;if(this.S&&(zt?(zt=S(zt),F(zt,this.S)):zt=this.S),this.m!==null||this.O||(Dt.H=zt,zt=null),this.P)e:{for(var J=0,ye=0;ye<this.i.length;ye++){t:{var qe=this.i[ye];if("__data__"in qe.map&&(qe=qe.map.__data__,typeof qe=="string")){qe=qe.length;break t}qe=void 0}if(qe===void 0)break;if(J+=qe,4096<J){J=ye;break e}if(J===4096||ye===this.i.length-1){J=ye+1;break e}}J=1e3}else J=1e3;J=kt(this,Dt,J),ye=Et(this.I),Rt(ye,"RID",C),Rt(ye,"CVER",22),this.D&&Rt(ye,"X-HTTP-Session-Id",this.D),St(this,ye),zt&&(this.O?J="headers="+encodeURIComponent(String(Eu(zt)))+"&"+J:this.m&&Bm(ye,this.m,zt)),Ot(this.h,Dt),this.Ua&&Rt(ye,"TYPE","init"),this.P?(Rt(ye,"$req",J),Rt(ye,"SID","null"),Dt.T=!0,mt(Dt,ye,null)):mt(Dt,ye,J),this.G=2}}else this.G==3&&(C?ot(this,C):this.i.length==0||In(this.h)||ot(this))};function ot(C,J){var ye;J?ye=J.l:ye=C.U++;const qe=Et(C.I);Rt(qe,"SID",C.K),Rt(qe,"RID",ye),Rt(qe,"AID",C.T),St(C,qe),C.m&&C.o&&Bm(qe,C.m,C.o),ye=new We(C,C.j,ye,C.B+1),C.m===null&&(ye.H=C.o),J&&(C.i=J.D.concat(C.i)),J=kt(C,ye,1e3),ye.I=Math.round(.5*C.wa)+Math.round(.5*C.wa*Math.random()),Ot(C.h,ye),mt(ye,qe,J)}function St(C,J){C.H&&I(C.H,function(ye,qe){Rt(J,qe,ye)}),C.l&&lr({},function(ye,qe){Rt(J,qe,ye)})}function kt(C,J,ye){ye=Math.min(C.i.length,ye);var qe=C.l?A(C.l.Na,C.l,C):null;e:{var Dt=C.i;let zt=-1;for(;;){const br=["count="+ye];zt==-1?0<ye?(zt=Dt[0].g,br.push("ofs="+zt)):zt=0:br.push("ofs="+zt);let Jn=!0;for(let Ls=0;Ls<ye;Ls++){let Qn=Dt[Ls].g;const ca=Dt[Ls].map;if(Qn-=zt,0>Qn)zt=Math.max(0,Dt[Ls].g-100),Jn=!1;else try{_1(ca,br,"req"+Qn+"_")}catch{qe&&qe(ca)}}if(Jn){qe=br.join("&");break e}}}return C=C.i.splice(0,ye),J.D=C,qe}function sr(C){if(!C.g&&!C.u){C.Y=1;var J=C.Fa;fe||Se(),xe||(fe(),xe=!0),ae.add(J,C),C.v=0}}function ur(C){return C.g||C.u||3<=C.v?!1:(C.Y++,C.u=Ie(A(C.Fa,C),qn(C,C.v)),C.v++,!0)}t.Fa=function(){if(this.u=null,Gr(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var C=2*this.R;this.j.info("BP detection timer enabled: "+C),this.A=Ie(A(this.ab,this),C)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,st(10),ju(this),Gr(this))};function Dr(C){C.A!=null&&(l.clearTimeout(C.A),C.A=null)}function Gr(C){C.g=new We(C,C.j,"rpc",C.Y),C.m===null&&(C.g.H=C.o),C.g.O=0;var J=Et(C.qa);Rt(J,"RID","rpc"),Rt(J,"SID",C.K),Rt(J,"AID",C.T),Rt(J,"CI",C.F?"0":"1"),!C.F&&C.ja&&Rt(J,"TO",C.ja),Rt(J,"TYPE","xmlhttp"),St(C,J),C.m&&C.o&&Bm(J,C.m,C.o),C.L&&(C.g.I=C.L);var ye=C.g;C=C.ia,ye.L=1,ye.v=Jt(Et(J)),ye.m=null,ye.P=!0,Tt(ye,C)}t.Za=function(){this.C!=null&&(this.C=null,ju(this),ur(this),st(19))};function un(C){C.C!=null&&(l.clearTimeout(C.C),C.C=null)}function bn(C,J){var ye=null;if(C.g==J){un(C),Dr(C),C.g=null;var qe=2}else if(Je(C.h,J))ye=J.D,Kt(C.h,J),qe=1;else return;if(C.G!=0){if(J.o)if(qe==1){ye=J.m?J.m.length:0,J=Date.now()-J.F;var Dt=C.B;qe=ht(),ke(qe,new K(qe,ye)),Q(C)}else sr(C);else if(Dt=J.s,Dt==3||Dt==0&&0<J.X||!(qe==1&&_e(C,J)||qe==2&&ur(C)))switch(ye&&0<ye.length&&(J=C.h,J.i=J.i.concat(ye)),Dt){case 1:ma(C,5);break;case 4:ma(C,10);break;case 3:ma(C,6);break;default:ma(C,2)}}}function qn(C,J){let ye=C.Ta+Math.floor(Math.random()*C.cb);return C.isActive()||(ye*=2),ye*J}function ma(C,J){if(C.j.info("Error code "+J),J==2){var ye=A(C.fb,C),qe=C.Xa;const Dt=!qe;qe=new Nt(qe||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||gt(qe,"https"),Jt(qe),Dt?xc(qe.toString(),ye):Gl(qe.toString(),ye)}else st(2);C.G=0,C.l&&C.l.sa(J),Ds(C),Fm(C)}t.fb=function(C){C?(this.j.info("Successfully pinged google.com"),st(2)):(this.j.info("Failed to ping google.com"),st(1))};function Ds(C){if(C.G=0,C.ka=[],C.l){const J=ar(C.h);(J.length!=0||C.i.length!=0)&&(g(C.ka,J),g(C.ka,C.i),C.h.i.length=0,p(C.i),C.i.length=0),C.l.ra()}}function _a(C,J,ye){var qe=ye instanceof Nt?Et(ye):new Nt(ye);if(qe.g!="")J&&(qe.g=J+"."+qe.g),ut(qe,qe.s);else{var Dt=l.location;qe=Dt.protocol,J=J?J+"."+Dt.hostname:Dt.hostname,Dt=+Dt.port;var zt=new Nt(null);qe&&gt(zt,qe),J&&(zt.g=J),Dt&&ut(zt,Dt),ye&&(zt.l=ye),qe=zt}return ye=C.D,J=C.ya,ye&&J&&Rt(qe,ye,J),Rt(qe,"VER",C.la),St(C,qe),qe}function ri(C,J,ye){if(J&&!C.J)throw Error("Can't create secondary domain capable XhrIo object.");return J=C.Ca&&!C.pa?new Qa(new TA({eb:ye})):new Qa(C.pa),J.Ha(C.J),J}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Rs(){}t=Rs.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ni(){}ni.prototype.g=function(C,J){return new Ms(C,J)};function Ms(C,J){bt.call(this),this.g=new Iu(J),this.l=C,this.h=J&&J.messageUrlParams||null,C=J&&J.messageHeaders||null,J&&J.clientProtocolHeaderRequired&&(C?C["X-Client-Protocol"]="webchannel":C={"X-Client-Protocol":"webchannel"}),this.g.o=C,C=J&&J.initMessageHeaders||null,J&&J.messageContentType&&(C?C["X-WebChannel-Content-Type"]=J.messageContentType:C={"X-WebChannel-Content-Type":J.messageContentType}),J&&J.va&&(C?C["X-WebChannel-Client-Profile"]=J.va:C={"X-WebChannel-Client-Profile":J.va}),this.g.S=C,(C=J&&J.Sb)&&!y(C)&&(this.g.m=C),this.v=J&&J.supportsCrossDomainXhr||!1,this.u=J&&J.sendRawJson||!1,(J=J&&J.httpSessionIdParam)&&!y(J)&&(this.g.D=J,C=this.h,C!==null&&J in C&&(C=this.h,J in C&&delete C[J])),this.j=new Bu(this)}m(Ms,bt),Ms.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ms.prototype.close=function(){OA(this.g)},Ms.prototype.o=function(C){var J=this.g;if(typeof C=="string"){var ye={};ye.__data__=C,C=ye}else this.u&&(ye={},ye.__data__=Qe(C),C=ye);J.i.push(new Ln(J.Ya++,C)),J.G==3&&Q(J)},Ms.prototype.N=function(){this.g.l=null,delete this.j,OA(this.g),delete this.g,Ms.aa.N.call(this)};function vc(C){de.call(this),C.__headers__&&(this.headers=C.__headers__,this.statusCode=C.__status__,delete C.__headers__,delete C.__status__);var J=C.__sm__;if(J){e:{for(const ye in J){C=ye;break e}C=void 0}(this.i=C)&&(C=this.i,J=J!==null&&C in J?J[C]:void 0),this.data=J}else this.data=C}m(vc,de);function Pu(){Ce.call(this),this.status=1}m(Pu,Ce);function Bu(C){this.g=C}m(Bu,Rs),Bu.prototype.ua=function(){ke(this.g,"a")},Bu.prototype.ta=function(C){ke(this.g,new vc(C))},Bu.prototype.sa=function(C){ke(this.g,new Pu)},Bu.prototype.ra=function(){ke(this.g,"b")},ni.prototype.createWebChannel=ni.prototype.g,Ms.prototype.send=Ms.prototype.o,Ms.prototype.open=Ms.prototype.m,Ms.prototype.close=Ms.prototype.close,mJ=function(){return new ni},AJ=function(){return ht()},hJ=nt,IT={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},q.NO_ERROR=0,q.TIMEOUT=8,q.HTTP_ERROR=6,K_=q,Y.COMPLETE="complete",fJ=Y,ie.EventType=$e,$e.OPEN="a",$e.CLOSE="b",$e.ERROR="c",$e.MESSAGE="d",bt.prototype.listen=bt.prototype.K,jy=ie,Qa.prototype.listenOnce=Qa.prototype.L,Qa.prototype.getLastError=Qa.prototype.Ka,Qa.prototype.getLastErrorCode=Qa.prototype.Ba,Qa.prototype.getStatus=Qa.prototype.Z,Qa.prototype.getResponseJson=Qa.prototype.Oa,Qa.prototype.getResponseText=Qa.prototype.oa,Qa.prototype.send=Qa.prototype.ea,Qa.prototype.setWithCredentials=Qa.prototype.Ha,dJ=Qa}).apply(typeof GN<"u"?GN:typeof self<"u"?self:typeof window<"u"?window:{});const e7="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}al.UNAUTHENTICATED=new al(null),al.GOOGLE_CREDENTIALS=new al("google-credentials-uid"),al.FIRST_PARTY=new al("first-party-uid"),al.MOCK_USER=new al("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zv="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qp=new lD("@firebase/firestore");function gx(){return qp.logLevel}function xr(t,...e){if(qp.logLevel<=Xn.DEBUG){const r=e.map(_D);qp.debug(`Firestore (${Zv}): ${t}`,...r)}}function oc(t,...e){if(qp.logLevel<=Xn.ERROR){const r=e.map(_D);qp.error(`Firestore (${Zv}): ${t}`,...r)}}function am(t,...e){if(qp.logLevel<=Xn.WARN){const r=e.map(_D);qp.warn(`Firestore (${Zv}): ${t}`,...r)}}function _D(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hr(t="Unexpected state"){const e=`FIRESTORE (${Zv}) INTERNAL ASSERTION FAILED: `+t;throw oc(e),new Error(e)}function Wr(t,e){t||Hr()}function xn(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Cr extends xA{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yd{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pJ{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class gJ{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(al.UNAUTHENTICATED))}shutdown(){}}class pxe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class gxe{constructor(e){this.t=e,this.currentUser=al.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Wr(this.o===void 0);let n=this.i;const a=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let s=new Yd;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Yd,e.enqueueRetryable(()=>a(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await a(this.currentUser)})},l=c=>{xr("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(xr("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Yd)}},0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(xr("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Wr(typeof n.accessToken=="string"),new pJ(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Wr(e===null||typeof e=="string"),new al(e)}}class xxe{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=al.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class vxe{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new xxe(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(al.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class yxe{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class bxe{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){Wr(this.o===void 0);const n=s=>{s.error!=null&&xr("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,xr("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const a=s=>{xr("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>a(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?a(s):xr("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Wr(typeof r.token=="string"),this.R=r.token,new yxe(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wxe(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ED{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const a=wxe(40);for(let s=0;s<a.length;++s)n.length<20&&a[s]<r&&(n+=e.charAt(a[s]%e.length))}return n}}function En(t,e){return t<e?-1:t>e?1:0}function Nv(t,e,r){return t.length===e.length&&t.every((n,a)=>r(n,e[a]))}function xJ(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Cr(nr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Cr(nr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Cr(nr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Cr(nr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return dr.fromMillis(Date.now())}static fromDate(e){return dr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new dr(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?En(this.nanoseconds,e.nanoseconds):En(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e){this.timestamp=e}static fromTimestamp(e){return new tn(e)}static min(){return new tn(new dr(0,0))}static max(){return new tn(new dr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r2{constructor(e,r,n){r===void 0?r=0:r>e.length&&Hr(),n===void 0?n=e.length-r:n>e.length-r&&Hr(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return r2.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof r2?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let a=0;a<n;a++){const s=e.get(a),o=r.get(a);if(s<o)return-1;if(s>o)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class fa extends r2{construct(e,r,n){return new fa(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Cr(nr.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(a=>a.length>0))}return new fa(r)}static emptyPath(){return new fa([])}}const Nxe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ss extends r2{construct(e,r,n){return new Ss(e,r,n)}static isValidIdentifier(e){return Nxe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ss.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ss(["__name__"])}static fromServerFormat(e){const r=[];let n="",a=0;const s=()=>{if(n.length===0)throw new Cr(nr.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;a<e.length;){const l=e[a];if(l==="\\"){if(a+1===e.length)throw new Cr(nr.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[a+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Cr(nr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,a+=2}else l==="`"?(o=!o,a++):l!=="."||o?(n+=l,a++):(s(),a++)}if(s(),o)throw new Cr(nr.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ss(r)}static emptyPath(){return new Ss([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e){this.path=e}static fromPath(e){return new Pr(fa.fromString(e))}static fromName(e){return new Pr(fa.fromString(e).popFirst(5))}static empty(){return new Pr(fa.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&fa.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return fa.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Pr(new fa(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE{constructor(e,r,n,a){this.indexId=e,this.collectionGroup=r,this.fields=n,this.indexState=a}}function jT(t){return t.fields.find(e=>e.kind===2)}function Xm(t){return t.fields.filter(e=>e.kind!==2)}zE.UNKNOWN_ID=-1;class q_{constructor(e,r){this.fieldPath=e,this.kind=r}}class n2{constructor(e,r){this.sequenceNumber=e,this.offset=r}static empty(){return new n2(0,vu.min())}}function Cxe(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,a=tn.fromTimestamp(n===1e9?new dr(r+1,0):new dr(r,n));return new vu(a,Pr.empty(),e)}function vJ(t){return new vu(t.readTime,t.key,-1)}class vu{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new vu(tn.min(),Pr.empty(),-1)}static max(){return new vu(tn.max(),Pr.empty(),-1)}}function SD(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Pr.comparator(t.documentKey,e.documentKey),r!==0?r:En(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yJ="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class bJ{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vg(t){if(t.code!==nr.FAILED_PRECONDITION||t.message!==yJ)throw t;xr("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Hr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Gt((n,a)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,a)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,a)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Gt?r:Gt.resolve(r)}catch(r){return Gt.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Gt.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Gt.reject(r)}static resolve(e){return new Gt((r,n)=>{r(e)})}static reject(e){return new Gt((r,n)=>{n(e)})}static waitFor(e){return new Gt((r,n)=>{let a=0,s=0,o=!1;e.forEach(l=>{++a,l.next(()=>{++s,o&&s===a&&r()},c=>n(c))}),o=!0,s===a&&r()})}static or(e){let r=Gt.resolve(!1);for(const n of e)r=r.next(a=>a?Gt.resolve(a):n());return r}static forEach(e,r){const n=[];return e.forEach((a,s)=>{n.push(r.call(this,a,s))}),this.waitFor(n)}static mapArray(e,r){return new Gt((n,a)=>{const s=e.length,o=new Array(s);let l=0;for(let c=0;c<s;c++){const u=c;r(e[u]).next(d=>{o[u]=d,++l,l===s&&n(o)},d=>a(d))}})}static doWhile(e,r){return new Gt((n,a)=>{const s=()=>{e()===!0?r().next(()=>{s()},a):n()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cj{constructor(e,r){this.action=e,this.transaction=r,this.aborted=!1,this.V=new Yd,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{r.error?this.V.reject(new sb(e,r.error)):this.V.resolve()},this.transaction.onerror=n=>{const a=ID(n.target.error);this.V.reject(new sb(e,a))}}static open(e,r,n,a){try{return new cj(r,e.transaction(a,n))}catch(s){throw new sb(r,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(xr("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const r=this.transaction.objectStore(e);return new Exe(r)}}class W0{constructor(e,r,n){this.name=e,this.version=r,this.p=n,W0.S(Ao())===12.2&&oc("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return xr("SimpleDb","Removing database:",e),ap(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!_Y())return!1;if(W0.v())return!0;const e=Ao(),r=W0.S(e),n=0<r&&r<10,a=wJ(e),s=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,r){return e.store(r)}static S(e){const r=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=r?r[1].split("_").slice(0,2).join("."):"-1";return Number(n)}async M(e){return this.db||(xr("SimpleDb","Opening database:",this.name),this.db=await new Promise((r,n)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=s=>{const o=s.target.result;r(o)},a.onblocked=()=>{n(new sb(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=s=>{const o=s.target.error;o.name==="VersionError"?n(new Cr(nr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?n(new Cr(nr.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):n(new sb(e,o))},a.onupgradeneeded=s=>{xr("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.p.O(o,a.transaction,s.oldVersion,this.version).next(()=>{xr("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=r=>this.N(r)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=r=>e(r))}async runTransaction(e,r,n,a){const s=r==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const l=cj.open(this.db,e,s?"readonly":"readwrite",n),c=a(l).next(u=>(l.g(),u)).catch(u=>(l.abort(u),Gt.reject(u))).toPromise();return c.catch(()=>{}),await l.m,c}catch(l){const c=l,u=c.name!=="FirebaseError"&&o<3;if(xr("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function wJ(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}class _xe{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return ap(this.B.delete())}}class sb extends Cr{constructor(e,r){super(nr.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${r}`),this.name="IndexedDbTransactionError"}}function Cm(t){return t.name==="IndexedDbTransactionError"}class Exe{constructor(e){this.store=e}put(e,r){let n;return r!==void 0?(xr("SimpleDb","PUT",this.store.name,e,r),n=this.store.put(r,e)):(xr("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),ap(n)}add(e){return xr("SimpleDb","ADD",this.store.name,e,e),ap(this.store.add(e))}get(e){return ap(this.store.get(e)).next(r=>(r===void 0&&(r=null),xr("SimpleDb","GET",this.store.name,e,r),r))}delete(e){return xr("SimpleDb","DELETE",this.store.name,e),ap(this.store.delete(e))}count(){return xr("SimpleDb","COUNT",this.store.name),ap(this.store.count())}U(e,r){const n=this.options(e,r),a=n.index?this.store.index(n.index):this.store;if(typeof a.getAll=="function"){const s=a.getAll(n.range);return new Gt((o,l)=>{s.onerror=c=>{l(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{const s=this.cursor(n),o=[];return this.W(s,(l,c)=>{o.push(c)}).next(()=>o)}}G(e,r){const n=this.store.getAll(e,r===null?void 0:r);return new Gt((a,s)=>{n.onerror=o=>{s(o.target.error)},n.onsuccess=o=>{a(o.target.result)}})}j(e,r){xr("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,r);n.H=!1;const a=this.cursor(n);return this.W(a,(s,o,l)=>l.delete())}J(e,r){let n;r?n=e:(n={},r=e);const a=this.cursor(n);return this.W(a,r)}Y(e){const r=this.cursor({});return new Gt((n,a)=>{r.onerror=s=>{const o=ID(s.target.error);a(o)},r.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():n()}):n()}})}W(e,r){const n=[];return new Gt((a,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void a();const c=new _xe(l),u=r(l.primaryKey,l.value,c);if(u instanceof Gt){const d=u.catch(f=>(c.done(),Gt.reject(f)));n.push(d)}c.isDone?a():c.K===null?l.continue():l.continue(c.K)}}).next(()=>Gt.waitFor(n))}options(e,r){let n;return e!==void 0&&(typeof e=="string"?n=e:r=e),{index:n,range:r}}cursor(e){let r="next";if(e.reverse&&(r="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,r):n.openCursor(e.range,r)}return this.store.openCursor(e.range,r)}}function ap(t){return new Gt((e,r)=>{t.onsuccess=n=>{const a=n.target.result;e(a)},t.onerror=n=>{const a=ID(n.target.error);r(a)}})}let t7=!1;function ID(t){const e=W0.S(Ao());if(e>=12.2&&e<13){const r="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(r)>=0){const n=new Cr("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${r}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return t7||(t7=!0,setTimeout(()=>{throw n},0)),n}}return t}class Sxe{constructor(e,r){this.asyncQueue=e,this.Z=r,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){xr("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{xr("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(r){Cm(r)?xr("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",r):await vg(r)}await this.X(6e4)})}}class Ixe{constructor(e,r){this.localStore=e,this.persistence=r}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>this.te(r,e))}te(e,r){const n=new Set;let a=r,s=!0;return Gt.doWhile(()=>s===!0&&a>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!n.has(o))return xr("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,a).next(l=>{a-=l,n.add(o)});s=!1})).next(()=>r-a)}ne(e,r,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,r).next(a=>this.localStore.localDocuments.getNextDocuments(e,r,a,n).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(a,s)).next(l=>(xr("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,r,l))).next(()=>o.size)}))}re(e,r){let n=e;return r.changes.forEach((a,s)=>{const o=vJ(s);SD(o,n)>0&&(n=o)}),new vu(n.readTime,n.documentKey,Math.max(r.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}rd.oe=-1;function mw(t){return t==null}function a2(t){return t===0&&1/t==-1/0}function jxe(t){return typeof t=="number"&&Number.isInteger(t)&&!a2(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uc(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=r7(e)),e=Pxe(t.get(r),e);return r7(e)}function Pxe(t,e){let r=e;const n=t.length;for(let a=0;a<n;a++){const s=t.charAt(a);switch(s){case"\0":r+="";break;case"":r+="";break;default:r+=s}}return r}function r7(t){return t+""}function Ff(t){const e=t.length;if(Wr(e>=2),e===2)return Wr(t.charAt(0)===""&&t.charAt(1)===""),fa.emptyPath();const r=e-2,n=[];let a="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>r)&&Hr(),t.charAt(o+1)){case"":const l=t.substring(s,o);let c;a.length===0?c=l:(a+=l,c=a,a=""),n.push(c);break;case"":a+=t.substring(s,o),a+="\0";break;case"":a+=t.substring(s,o+1);break;default:Hr()}s=o+2}return new fa(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n7=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z_(t,e){return[t,uc(e)]}function NJ(t,e,r){return[t,uc(e),r]}const Bxe={},Txe=["prefixPath","collectionGroup","readTime","documentId"],kxe=["prefixPath","collectionGroup","documentId"],Fxe=["collectionGroup","readTime","prefixPath","documentId"],Oxe=["canonicalId","targetId"],Dxe=["targetId","path"],Rxe=["path","targetId"],Mxe=["collectionId","parent"],Lxe=["indexId","uid"],Uxe=["uid","sequenceNumber"],Qxe=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Vxe=["indexId","uid","orderedDocumentKey"],Hxe=["userId","collectionPath","documentId"],$xe=["userId","collectionPath","largestBatchId"],Gxe=["userId","collectionGroup","largestBatchId"],CJ=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Kxe=[...CJ,"documentOverlays"],_J=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],EJ=_J,jD=[...EJ,"indexConfiguration","indexState","indexEntries"],qxe=jD,zxe=[...jD,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PT extends bJ{constructor(e,r){super(),this._e=e,this.currentSequenceNumber=r}}function po(t,e){const r=xn(t);return W0.F(r._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a7(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function yg(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function SJ(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e,r){this.comparator=e,this.root=r||sl.EMPTY}insert(e,r){return new Ts(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,sl.BLACK,null,null))}remove(e){return new Ts(this.comparator,this.root.remove(e,this.comparator).copy(null,null,sl.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return r+n.left.size;a<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new KN(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new KN(this.root,e,this.comparator,!1)}getReverseIterator(){return new KN(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new KN(this.root,e,this.comparator,!0)}}class KN{constructor(e,r,n,a){this.isReverse=a,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&a&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class sl{constructor(e,r,n,a,s){this.key=e,this.value=r,this.color=n??sl.RED,this.left=a??sl.EMPTY,this.right=s??sl.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,a,s){return new sl(e??this.key,r??this.value,n??this.color,a??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let a=this;const s=n(e,a.key);return a=s<0?a.copy(null,null,null,a.left.insert(e,r,n),null):s===0?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(e,r,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return sl.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,a=this;if(r(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),r(e,a.key)===0){if(a.right.isEmpty())return sl.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,sl.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,sl.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Hr();const e=this.left.check();if(e!==this.right.check())throw Hr();return e+(this.isRed()?0:1)}}sl.EMPTY=null,sl.RED=!0,sl.BLACK=!1;sl.EMPTY=new class{constructor(){this.size=0}get key(){throw Hr()}get value(){throw Hr()}get color(){throw Hr()}get left(){throw Hr()}get right(){throw Hr()}copy(e,r,n,a,s){return this}insert(e,r,n){return new sl(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ka{constructor(e){this.comparator=e,this.data=new Ts(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;r(a.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new s7(this.data.getIterator())}getIteratorFrom(e){return new s7(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Ka)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,s=n.getNext().key;if(this.comparator(a,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Ka(this.comparator);return r.data=e,r}}class s7{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function $g(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc{constructor(e){this.fields=e,e.sort(Ss.comparator)}static empty(){return new kc([])}unionWith(e){let r=new Ka(Ss.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new kc(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Nv(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IJ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(a){try{return atob(a)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new IJ("Invalid base64 string: "+s):s}}(e);return new Ti(r)}static fromUint8Array(e){const r=function(a){let s="";for(let o=0;o<a.length;++o)s+=String.fromCharCode(a[o]);return s}(e);return new Ti(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return En(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ti.EMPTY_BYTE_STRING=new Ti("");const Wxe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function aA(t){if(Wr(!!t),typeof t=="string"){let e=0;const r=Wxe.exec(t);if(Wr(!!r),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Cs(t.seconds),nanos:Cs(t.nanos)}}function Cs(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function sm(t){return typeof t=="string"?Ti.fromBase64String(t):Ti.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PD(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function BD(t){const e=t.mapValue.fields.__previous_value__;return PD(e)?BD(e):e}function s2(t){const e=aA(t.mapValue.fields.__local_write_time__.timestampValue);return new dr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xxe{constructor(e,r,n,a,s,o,l,c,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=a,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class im{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new im("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof im&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P0={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},W_={nullValue:"NULL_VALUE"};function zp(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?PD(t)?4:jJ(t)?9007199254740991:uj(t)?10:11:Hr()}function Gf(t,e){if(t===e)return!0;const r=zp(t);if(r!==zp(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return s2(t).isEqual(s2(e));case 3:return function(a,s){if(typeof a.timestampValue=="string"&&typeof s.timestampValue=="string"&&a.timestampValue.length===s.timestampValue.length)return a.timestampValue===s.timestampValue;const o=aA(a.timestampValue),l=aA(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(a,s){return sm(a.bytesValue).isEqual(sm(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(a,s){return Cs(a.geoPointValue.latitude)===Cs(s.geoPointValue.latitude)&&Cs(a.geoPointValue.longitude)===Cs(s.geoPointValue.longitude)}(t,e);case 2:return function(a,s){if("integerValue"in a&&"integerValue"in s)return Cs(a.integerValue)===Cs(s.integerValue);if("doubleValue"in a&&"doubleValue"in s){const o=Cs(a.doubleValue),l=Cs(s.doubleValue);return o===l?a2(o)===a2(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Nv(t.arrayValue.values||[],e.arrayValue.values||[],Gf);case 10:case 11:return function(a,s){const o=a.mapValue.fields||{},l=s.mapValue.fields||{};if(a7(o)!==a7(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!Gf(o[c],l[c])))return!1;return!0}(t,e);default:return Hr()}}function i2(t,e){return(t.values||[]).find(r=>Gf(r,e))!==void 0}function om(t,e){if(t===e)return 0;const r=zp(t),n=zp(e);if(r!==n)return En(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return En(t.booleanValue,e.booleanValue);case 2:return function(s,o){const l=Cs(s.integerValue||s.doubleValue),c=Cs(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return i7(t.timestampValue,e.timestampValue);case 4:return i7(s2(t),s2(e));case 5:return En(t.stringValue,e.stringValue);case 6:return function(s,o){const l=sm(s),c=sm(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=En(l[u],c[u]);if(d!==0)return d}return En(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const l=En(Cs(s.latitude),Cs(o.latitude));return l!==0?l:En(Cs(s.longitude),Cs(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return o7(t.arrayValue,e.arrayValue);case 10:return function(s,o){var l,c,u,d;const f=s.fields||{},A=o.fields||{},h=(l=f.value)===null||l===void 0?void 0:l.arrayValue,m=(c=A.value)===null||c===void 0?void 0:c.arrayValue,p=En(((u=h==null?void 0:h.values)===null||u===void 0?void 0:u.length)||0,((d=m==null?void 0:m.values)===null||d===void 0?void 0:d.length)||0);return p!==0?p:o7(h,m)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===P0.mapValue&&o===P0.mapValue)return 0;if(s===P0.mapValue)return 1;if(o===P0.mapValue)return-1;const l=s.fields||{},c=Object.keys(l),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let f=0;f<c.length&&f<d.length;++f){const A=En(c[f],d[f]);if(A!==0)return A;const h=om(l[c[f]],u[d[f]]);if(h!==0)return h}return En(c.length,d.length)}(t.mapValue,e.mapValue);default:throw Hr()}}function i7(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return En(t,e);const r=aA(t),n=aA(e),a=En(r.seconds,n.seconds);return a!==0?a:En(r.nanos,n.nanos)}function o7(t,e){const r=t.values||[],n=e.values||[];for(let a=0;a<r.length&&a<n.length;++a){const s=om(r[a],n[a]);if(s)return s}return En(r.length,n.length)}function Cv(t){return BT(t)}function BT(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=aA(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return sm(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Pr.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",a=!0;for(const s of r.values||[])a?a=!1:n+=",",n+=BT(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let a="{",s=!0;for(const o of n)s?s=!1:a+=",",a+=`${o}:${BT(r.fields[o])}`;return a+"}"}(t.mapValue):Hr()}function o2(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function TT(t){return!!t&&"integerValue"in t}function l2(t){return!!t&&"arrayValue"in t}function l7(t){return!!t&&"nullValue"in t}function c7(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function X_(t){return!!t&&"mapValue"in t}function uj(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function ib(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return yg(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=ib(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=ib(t.arrayValue.values[r]);return e}return Object.assign({},t)}function jJ(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const PJ={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function Yxe(t){return"nullValue"in t?W_:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?o2(im.empty(),Pr.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?uj(t)?PJ:{mapValue:{}}:Hr()}function Jxe(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?o2(im.empty(),Pr.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?PJ:"mapValue"in t?uj(t)?{mapValue:{}}:P0:Hr()}function u7(t,e){const r=om(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function d7(t,e){const r=om(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{constructor(e){this.value=e}static empty(){return new ol({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!X_(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=ib(r)}setAll(e){let r=Ss.emptyPath(),n={},a=[];e.forEach((o,l)=>{if(!r.isImmediateParentOf(l)){const c=this.getFieldsMap(r);this.applyChanges(c,n,a),n={},a=[],r=l.popLast()}o?n[l.lastSegment()]=ib(o):a.push(l.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,a)}delete(e){const r=this.field(e.popLast());X_(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Gf(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=r.mapValue.fields[e.get(n)];X_(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=a),r=a}return r.mapValue.fields}applyChanges(e,r,n){yg(r,(a,s)=>e[a]=s);for(const a of n)delete e[a]}clone(){return new ol(ib(this.value))}}function BJ(t){const e=[];return yg(t.fields,(r,n)=>{const a=new Ss([r]);if(X_(n)){const s=BJ(n.mapValue).fields;if(s.length===0)e.push(a);else for(const o of s)e.push(a.child(o))}else e.push(a)}),new kc(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(e,r,n,a,s,o,l){this.key=e,this.documentType=r,this.version=n,this.readTime=a,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Es(e,0,tn.min(),tn.min(),tn.min(),ol.empty(),0)}static newFoundDocument(e,r,n,a){return new Es(e,1,r,tn.min(),n,a,0)}static newNoDocument(e,r){return new Es(e,2,r,tn.min(),tn.min(),ol.empty(),0)}static newUnknownDocument(e,r){return new Es(e,3,r,tn.min(),tn.min(),ol.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(tn.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ol.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ol.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=tn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Es&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Es(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e,r){this.position=e,this.inclusive=r}}function f7(t,e,r){let n=0;for(let a=0;a<t.position.length;a++){const s=e[a],o=t.position[a];if(s.field.isKeyField()?n=Pr.comparator(Pr.fromName(o.referenceValue),r.key):n=om(o,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function h7(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Gf(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c2{constructor(e,r="asc"){this.field=e,this.dir=r}}function Zxe(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TJ{}class Yn extends TJ{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new eve(e,r,n):r==="array-contains"?new nve(e,n):r==="in"?new MJ(e,n):r==="not-in"?new ave(e,n):r==="array-contains-any"?new sve(e,n):new Yn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new tve(e,n):new rve(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(om(r,this.value)):r!==null&&zp(this.value)===zp(r)&&this.matchesComparison(om(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Hr()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Da extends TJ{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new Da(e,r)}matches(e){return Ev(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Ev(t){return t.op==="and"}function kT(t){return t.op==="or"}function TD(t){return kJ(t)&&Ev(t)}function kJ(t){for(const e of t.filters)if(e instanceof Da)return!1;return!0}function FT(t){if(t instanceof Yn)return t.field.canonicalString()+t.op.toString()+Cv(t.value);if(TD(t))return t.filters.map(e=>FT(e)).join(",");{const e=t.filters.map(r=>FT(r)).join(",");return`${t.op}(${e})`}}function FJ(t,e){return t instanceof Yn?function(n,a){return a instanceof Yn&&n.op===a.op&&n.field.isEqual(a.field)&&Gf(n.value,a.value)}(t,e):t instanceof Da?function(n,a){return a instanceof Da&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce((s,o,l)=>s&&FJ(o,a.filters[l]),!0):!1}(t,e):void Hr()}function OJ(t,e){const r=t.filters.concat(e);return Da.create(r,t.op)}function DJ(t){return t instanceof Yn?function(r){return`${r.field.canonicalString()} ${r.op} ${Cv(r.value)}`}(t):t instanceof Da?function(r){return r.op.toString()+" {"+r.getFilters().map(DJ).join(" ,")+"}"}(t):"Filter"}class eve extends Yn{constructor(e,r,n){super(e,r,n),this.key=Pr.fromName(n.referenceValue)}matches(e){const r=Pr.comparator(e.key,this.key);return this.matchesComparison(r)}}class tve extends Yn{constructor(e,r){super(e,"in",r),this.keys=RJ("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class rve extends Yn{constructor(e,r){super(e,"not-in",r),this.keys=RJ("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function RJ(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Pr.fromName(n.referenceValue))}class nve extends Yn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return l2(r)&&i2(r.arrayValue,this.value)}}class MJ extends Yn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&i2(this.value.arrayValue,r)}}class ave extends Yn{constructor(e,r){super(e,"not-in",r)}matches(e){if(i2(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!i2(this.value.arrayValue,r)}}class sve extends Yn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!l2(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>i2(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ive{constructor(e,r=null,n=[],a=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=a,this.limit=s,this.startAt=o,this.endAt=l,this.ue=null}}function OT(t,e=null,r=[],n=[],a=null,s=null,o=null){return new ive(t,e,r,n,a,s,o)}function Wp(t){const e=xn(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>FT(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),mw(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Cv(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Cv(n)).join(",")),e.ue=r}return e.ue}function pw(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!Zxe(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!FJ(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!h7(t.startAt,e.startAt)&&h7(t.endAt,e.endAt)}function WE(t){return Pr.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function XE(t,e){return t.filters.filter(r=>r instanceof Yn&&r.field.isEqual(e))}function A7(t,e,r){let n=W_,a=!0;for(const s of XE(t,e)){let o=W_,l=!0;switch(s.op){case"<":case"<=":o=Yxe(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=W_}u7({value:n,inclusive:a},{value:o,inclusive:l})<0&&(n=o,a=l)}if(r!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=r.position[s];u7({value:n,inclusive:a},{value:o,inclusive:r.inclusive})<0&&(n=o,a=r.inclusive);break}}return{value:n,inclusive:a}}function m7(t,e,r){let n=P0,a=!0;for(const s of XE(t,e)){let o=P0,l=!0;switch(s.op){case">=":case">":o=Jxe(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=P0}d7({value:n,inclusive:a},{value:o,inclusive:l})>0&&(n=o,a=l)}if(r!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=r.position[s];d7({value:n,inclusive:a},{value:o,inclusive:r.inclusive})>0&&(n=o,a=r.inclusive);break}}return{value:n,inclusive:a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1{constructor(e,r=null,n=[],a=[],s=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=a,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function ove(t,e,r,n,a,s,o,l){return new e1(t,e,r,n,a,s,o,l)}function gw(t){return new e1(t)}function p7(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function LJ(t){return t.collectionGroup!==null}function ob(t){const e=xn(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Ka(Ss.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new c2(s,n))}),r.has(Ss.keyField().canonicalString())||e.ce.push(new c2(Ss.keyField(),n))}return e.ce}function ld(t){const e=xn(t);return e.le||(e.le=lve(e,ob(t))),e.le}function lve(t,e){if(t.limitType==="F")return OT(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(a=>{const s=a.dir==="desc"?"asc":"desc";return new c2(a.field,s)});const r=t.endAt?new _v(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new _v(t.startAt.position,t.startAt.inclusive):null;return OT(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function DT(t,e){const r=t.filters.concat([e]);return new e1(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function YE(t,e,r){return new e1(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function dj(t,e){return pw(ld(t),ld(e))&&t.limitType===e.limitType}function UJ(t){return`${Wp(ld(t))}|lt:${t.limitType}`}function xx(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(a=>DJ(a)).join(", ")}]`),mw(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(a=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(a)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(a=>Cv(a)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(a=>Cv(a)).join(",")),`Target(${n})`}(ld(t))}; limitType=${t.limitType})`}function xw(t,e){return e.isFoundDocument()&&function(n,a){const s=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Pr.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,a){for(const s of ob(n))if(!s.field.isKeyField()&&a.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,a){for(const s of n.filters)if(!s.matches(a))return!1;return!0}(t,e)&&function(n,a){return!(n.startAt&&!function(o,l,c){const u=f7(o,l,c);return o.inclusive?u<=0:u<0}(n.startAt,ob(n),a)||n.endAt&&!function(o,l,c){const u=f7(o,l,c);return o.inclusive?u>=0:u>0}(n.endAt,ob(n),a))}(t,e)}function cve(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function QJ(t){return(e,r)=>{let n=!1;for(const a of ob(t)){const s=uve(a,e,r);if(s!==0)return s;n=n||a.field.isKeyField()}return 0}}function uve(t,e,r){const n=t.field.isKeyField()?Pr.comparator(e.key,r.key):function(s,o,l){const c=o.data.field(s),u=l.data.field(s);return c!==null&&u!==null?om(c,u):Hr()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Hr()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _m{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[a,s]of n)if(this.equalsFn(a,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<a.length;s++)if(this.equalsFn(a[s][0],e))return void(a[s]=[e,r]);a.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[r]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){yg(this.inner,(r,n)=>{for(const[a,s]of n)e(a,s)})}isEmpty(){return SJ(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dve=new Ts(Pr.comparator);function fu(){return dve}const VJ=new Ts(Pr.comparator);function Py(...t){let e=VJ;for(const r of t)e=e.insert(r.key,r);return e}function HJ(t){let e=VJ;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Of(){return lb()}function $J(){return lb()}function lb(){return new _m(t=>t.toString(),(t,e)=>t.isEqual(e))}const fve=new Ts(Pr.comparator),hve=new Ka(Pr.comparator);function Mn(...t){let e=hve;for(const r of t)e=e.add(r);return e}const Ave=new Ka(En);function mve(){return Ave}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kD(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:a2(e)?"-0":e}}function GJ(t){return{integerValue:""+t}}function pve(t,e){return jxe(e)?GJ(e):kD(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fj{constructor(){this._=void 0}}function gve(t,e,r){return t instanceof u2?function(a,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return s&&PD(s)&&(s=BD(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(r,e):t instanceof Xp?qJ(t,e):t instanceof Sv?zJ(t,e):function(a,s){const o=KJ(a,s),l=g7(o)+g7(a.Pe);return TT(o)&&TT(a.Pe)?GJ(l):kD(a.serializer,l)}(t,e)}function xve(t,e,r){return t instanceof Xp?qJ(t,e):t instanceof Sv?zJ(t,e):r}function KJ(t,e){return t instanceof d2?function(n){return TT(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class u2 extends fj{}class Xp extends fj{constructor(e){super(),this.elements=e}}function qJ(t,e){const r=WJ(e);for(const n of t.elements)r.some(a=>Gf(a,n))||r.push(n);return{arrayValue:{values:r}}}class Sv extends fj{constructor(e){super(),this.elements=e}}function zJ(t,e){let r=WJ(e);for(const n of t.elements)r=r.filter(a=>!Gf(a,n));return{arrayValue:{values:r}}}class d2 extends fj{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function g7(t){return Cs(t.integerValue||t.doubleValue)}function WJ(t){return l2(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XJ{constructor(e,r){this.field=e,this.transform=r}}function vve(t,e){return t.field.isEqual(e.field)&&function(n,a){return n instanceof Xp&&a instanceof Xp||n instanceof Sv&&a instanceof Sv?Nv(n.elements,a.elements,Gf):n instanceof d2&&a instanceof d2?Gf(n.Pe,a.Pe):n instanceof u2&&a instanceof u2}(t.transform,e.transform)}class yve{constructor(e,r){this.version=e,this.transformResults=r}}class Is{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Is}static exists(e){return new Is(void 0,e)}static updateTime(e){return new Is(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Y_(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class hj{}function YJ(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new r1(t.key,Is.none()):new t1(t.key,t.data,Is.none());{const r=t.data,n=ol.empty();let a=new Ka(Ss.comparator);for(let s of e.fields)if(!a.has(s)){let o=r.field(s);o===null&&s.length>1&&(s=s.popLast(),o=r.field(s)),o===null?n.delete(s):n.set(s,o),a=a.add(s)}return new bA(t.key,n,new kc(a.toArray()),Is.none())}}function bve(t,e,r){t instanceof t1?function(a,s,o){const l=a.value.clone(),c=v7(a.fieldTransforms,s,o.transformResults);l.setAll(c),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,r):t instanceof bA?function(a,s,o){if(!Y_(a.precondition,s))return void s.convertToUnknownDocument(o.version);const l=v7(a.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(JJ(a)),c.setAll(l),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,r):function(a,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,r)}function cb(t,e,r,n){return t instanceof t1?function(s,o,l,c){if(!Y_(s.precondition,o))return l;const u=s.value.clone(),d=y7(s.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof bA?function(s,o,l,c){if(!Y_(s.precondition,o))return l;const u=y7(s.fieldTransforms,c,o),d=o.data;return d.setAll(JJ(s)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,r,n):function(s,o,l){return Y_(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,r)}function wve(t,e){let r=null;for(const n of t.fieldTransforms){const a=e.data.field(n.field),s=KJ(n.transform,a||null);s!=null&&(r===null&&(r=ol.empty()),r.set(n.field,s))}return r||null}function x7(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&Nv(n,a,(s,o)=>vve(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class t1 extends hj{constructor(e,r,n,a=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class bA extends hj{constructor(e,r,n,a,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=a,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function JJ(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function v7(t,e,r){const n=new Map;Wr(t.length===r.length);for(let a=0;a<r.length;a++){const s=t[a],o=s.transform,l=e.data.field(s.field);n.set(s.field,xve(o,l,r[a]))}return n}function y7(t,e,r){const n=new Map;for(const a of t){const s=a.transform,o=r.data.field(a.field);n.set(a.field,gve(s,o,e))}return n}class r1 extends hj{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class FD extends hj{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(e,r,n,a){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const s=this.mutations[a];s.key.isEqual(e.key)&&bve(s,e,n[a])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=cb(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=cb(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=$J();return this.mutations.forEach(a=>{const s=e.get(a.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=r.has(a.key)?null:l;const c=YJ(o,l);c!==null&&n.set(a.key,c),o.isValidDocument()||o.convertToNoDocument(tn.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Mn())}isEqual(e){return this.batchId===e.batchId&&Nv(this.mutations,e.mutations,(r,n)=>x7(r,n))&&Nv(this.baseMutations,e.baseMutations,(r,n)=>x7(r,n))}}class DD{constructor(e,r,n,a){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=a}static from(e,r,n){Wr(e.mutations.length===n.length);let a=function(){return fve}();const s=e.mutations;for(let o=0;o<s.length;o++)a=a.insert(s[o].key,n[o].version);return new DD(e,r,n,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nve{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Di,ta;function ZJ(t){switch(t){default:return Hr();case nr.CANCELLED:case nr.UNKNOWN:case nr.DEADLINE_EXCEEDED:case nr.RESOURCE_EXHAUSTED:case nr.INTERNAL:case nr.UNAVAILABLE:case nr.UNAUTHENTICATED:return!1;case nr.INVALID_ARGUMENT:case nr.NOT_FOUND:case nr.ALREADY_EXISTS:case nr.PERMISSION_DENIED:case nr.FAILED_PRECONDITION:case nr.ABORTED:case nr.OUT_OF_RANGE:case nr.UNIMPLEMENTED:case nr.DATA_LOSS:return!0}}function eZ(t){if(t===void 0)return oc("GRPC error has no .code"),nr.UNKNOWN;switch(t){case Di.OK:return nr.OK;case Di.CANCELLED:return nr.CANCELLED;case Di.UNKNOWN:return nr.UNKNOWN;case Di.DEADLINE_EXCEEDED:return nr.DEADLINE_EXCEEDED;case Di.RESOURCE_EXHAUSTED:return nr.RESOURCE_EXHAUSTED;case Di.INTERNAL:return nr.INTERNAL;case Di.UNAVAILABLE:return nr.UNAVAILABLE;case Di.UNAUTHENTICATED:return nr.UNAUTHENTICATED;case Di.INVALID_ARGUMENT:return nr.INVALID_ARGUMENT;case Di.NOT_FOUND:return nr.NOT_FOUND;case Di.ALREADY_EXISTS:return nr.ALREADY_EXISTS;case Di.PERMISSION_DENIED:return nr.PERMISSION_DENIED;case Di.FAILED_PRECONDITION:return nr.FAILED_PRECONDITION;case Di.ABORTED:return nr.ABORTED;case Di.OUT_OF_RANGE:return nr.OUT_OF_RANGE;case Di.UNIMPLEMENTED:return nr.UNIMPLEMENTED;case Di.DATA_LOSS:return nr.DATA_LOSS;default:return Hr()}}(ta=Di||(Di={}))[ta.OK=0]="OK",ta[ta.CANCELLED=1]="CANCELLED",ta[ta.UNKNOWN=2]="UNKNOWN",ta[ta.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ta[ta.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ta[ta.NOT_FOUND=5]="NOT_FOUND",ta[ta.ALREADY_EXISTS=6]="ALREADY_EXISTS",ta[ta.PERMISSION_DENIED=7]="PERMISSION_DENIED",ta[ta.UNAUTHENTICATED=16]="UNAUTHENTICATED",ta[ta.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ta[ta.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ta[ta.ABORTED=10]="ABORTED",ta[ta.OUT_OF_RANGE=11]="OUT_OF_RANGE",ta[ta.UNIMPLEMENTED=12]="UNIMPLEMENTED",ta[ta.INTERNAL=13]="INTERNAL",ta[ta.UNAVAILABLE=14]="UNAVAILABLE",ta[ta.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cve(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _ve=new Np([4294967295,4294967295],0);function b7(t){const e=Cve().encode(t),r=new uJ;return r.update(e),new Uint8Array(r.digest())}function w7(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Np([r,n],0),new Np([a,s],0)]}class MD{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new By(`Invalid padding: ${r}`);if(n<0)throw new By(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new By(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new By(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Np.fromNumber(this.Ie)}Ee(e,r,n){let a=e.add(r.multiply(Np.fromNumber(n)));return a.compare(_ve)===1&&(a=new Np([a.getBits(0),a.getBits(1)],0)),a.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=b7(e),[n,a]=w7(r);for(let s=0;s<this.hashCount;s++){const o=this.Ee(n,a,s);if(!this.de(o))return!1}return!0}static create(e,r,n){const a=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new MD(s,a,r);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const r=b7(e),[n,a]=w7(r);for(let s=0;s<this.hashCount;s++){const o=this.Ee(n,a,s);this.Ae(o)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class By extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(e,r,n,a,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const a=new Map;return a.set(e,vw.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Aj(tn.min(),a,new Ts(En),fu(),Mn())}}class vw{constructor(e,r,n,a,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new vw(n,r,Mn(),Mn(),Mn())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J_{constructor(e,r,n,a){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=a}}class tZ{constructor(e,r){this.targetId=e,this.me=r}}class rZ{constructor(e,r,n=Ti.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=a}}class N7{constructor(){this.fe=0,this.ge=_7(),this.pe=Ti.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Mn(),r=Mn(),n=Mn();return this.ge.forEach((a,s)=>{switch(s){case 0:e=e.add(a);break;case 2:r=r.add(a);break;case 1:n=n.add(a);break;default:Hr()}}),new vw(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=_7()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Wr(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Eve{constructor(e){this.Le=e,this.Be=new Map,this.ke=fu(),this.qe=C7(),this.Qe=new Ts(En)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:Hr()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,a)=>{this.ze(a)&&r(a)})}He(e){const r=e.targetId,n=e.me.count,a=this.Je(r);if(a){const s=a.target;if(WE(s))if(n===0){const o=new Pr(s.path);this.Ue(r,o,Es.newNoDocument(o,tn.min()))}else Wr(n===1);else{const o=this.Ye(r);if(o!==n){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(r);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,u)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:s=0}=r;let o,l;try{o=sm(n).toUint8Array()}catch(c){if(c instanceof IJ)return am("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new MD(o,a,s)}catch(c){return am(c instanceof By?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let a=0;return n.forEach(s=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(r,s,null),a++)}),a}rt(e){const r=new Map;this.Be.forEach((s,o)=>{const l=this.Je(o);if(l){if(s.current&&WE(l.target)){const c=new Pr(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Es.newNoDocument(c,e))}s.be&&(r.set(o,s.ve()),s.Ce())}});let n=Mn();this.qe.forEach((s,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const a=new Aj(e,r,this.Qe,this.ke,n);return this.ke=fu(),this.qe=C7(),this.Qe=new Ts(En),a}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const a=this.Ge(e);this.it(e,r)?a.Fe(r,1):a.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new N7,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Ka(En),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||xr("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new N7),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function C7(){return new Ts(Pr.comparator)}function _7(){return new Ts(Pr.comparator)}const Sve={asc:"ASCENDING",desc:"DESCENDING"},Ive={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},jve={and:"AND",or:"OR"};class Pve{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function RT(t,e){return t.useProto3Json||mw(e)?e:{value:e}}function Iv(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function nZ(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Bve(t,e){return Iv(t,e.toTimestamp())}function Mo(t){return Wr(!!t),tn.fromTimestamp(function(r){const n=aA(r);return new dr(n.seconds,n.nanos)}(t))}function LD(t,e){return MT(t,e).canonicalString()}function MT(t,e){const r=function(a){return new fa(["projects",a.projectId,"databases",a.database])}(t).child("documents");return e===void 0?r:r.child(e)}function aZ(t){const e=fa.fromString(t);return Wr(hZ(e)),e}function f2(t,e){return LD(t.databaseId,e.path)}function Hh(t,e){const r=aZ(e);if(r.get(1)!==t.databaseId.projectId)throw new Cr(nr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Cr(nr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Pr(oZ(r))}function sZ(t,e){return LD(t.databaseId,e)}function iZ(t){const e=aZ(t);return e.length===4?fa.emptyPath():oZ(e)}function LT(t){return new fa(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function oZ(t){return Wr(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function E7(t,e,r){return{name:f2(t,e),fields:r.value.mapValue.fields}}function Tve(t,e,r){const n=Hh(t,e.name),a=Mo(e.updateTime),s=e.createTime?Mo(e.createTime):tn.min(),o=new ol({mapValue:{fields:e.fields}}),l=Es.newFoundDocument(n,a,s,o);return r&&l.setHasCommittedMutations(),r?l.setHasCommittedMutations():l}function kve(t,e){return"found"in e?function(n,a){Wr(!!a.found),a.found.name,a.found.updateTime;const s=Hh(n,a.found.name),o=Mo(a.found.updateTime),l=a.found.createTime?Mo(a.found.createTime):tn.min(),c=new ol({mapValue:{fields:a.found.fields}});return Es.newFoundDocument(s,o,l,c)}(t,e):"missing"in e?function(n,a){Wr(!!a.missing),Wr(!!a.readTime);const s=Hh(n,a.missing),o=Mo(a.readTime);return Es.newNoDocument(s,o)}(t,e):Hr()}function Fve(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Hr()}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],s=function(u,d){return u.useProto3Json?(Wr(d===void 0||typeof d=="string"),Ti.fromBase64String(d||"")):(Wr(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Ti.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const d=u.code===void 0?nr.UNKNOWN:eZ(u.code);return new Cr(d,u.message||"")}(o);r=new rZ(n,a,s,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=Hh(t,n.document.name),s=Mo(n.document.updateTime),o=n.document.createTime?Mo(n.document.createTime):tn.min(),l=new ol({mapValue:{fields:n.document.fields}}),c=Es.newFoundDocument(a,s,o,l),u=n.targetIds||[],d=n.removedTargetIds||[];r=new J_(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=Hh(t,n.document),s=n.readTime?Mo(n.readTime):tn.min(),o=Es.newNoDocument(a,s),l=n.removedTargetIds||[];r=new J_([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=Hh(t,n.document),s=n.removedTargetIds||[];r=new J_([],s,a,null)}else{if(!("filter"in e))return Hr();{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:s}=n,o=new Nve(a,s),l=n.targetId;r=new tZ(l,o)}}return r}function h2(t,e){let r;if(e instanceof t1)r={update:E7(t,e.key,e.value)};else if(e instanceof r1)r={delete:f2(t,e.key)};else if(e instanceof bA)r={update:E7(t,e.key,e.data),updateMask:Uve(e.fieldMask)};else{if(!(e instanceof FD))return Hr();r={verify:f2(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,o){const l=o.transform;if(l instanceof u2)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Xp)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Sv)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof d2)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw Hr()}(0,n))),e.precondition.isNone||(r.currentDocument=function(a,s){return s.updateTime!==void 0?{updateTime:Bve(a,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Hr()}(t,e.precondition)),r}function UT(t,e){const r=e.currentDocument?function(s){return s.updateTime!==void 0?Is.updateTime(Mo(s.updateTime)):s.exists!==void 0?Is.exists(s.exists):Is.none()}(e.currentDocument):Is.none(),n=e.updateTransforms?e.updateTransforms.map(a=>function(o,l){let c=null;if("setToServerValue"in l)Wr(l.setToServerValue==="REQUEST_TIME"),c=new u2;else if("appendMissingElements"in l){const d=l.appendMissingElements.values||[];c=new Xp(d)}else if("removeAllFromArray"in l){const d=l.removeAllFromArray.values||[];c=new Sv(d)}else"increment"in l?c=new d2(o,l.increment):Hr();const u=Ss.fromServerFormat(l.fieldPath);return new XJ(u,c)}(t,a)):[];if(e.update){e.update.name;const a=Hh(t,e.update.name),s=new ol({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const u=c.fieldPaths||[];return new kc(u.map(d=>Ss.fromServerFormat(d)))}(e.updateMask);return new bA(a,s,o,r,n)}return new t1(a,s,r,n)}if(e.delete){const a=Hh(t,e.delete);return new r1(a,r)}if(e.verify){const a=Hh(t,e.verify);return new FD(a,r)}return Hr()}function Ove(t,e){return t&&t.length>0?(Wr(e!==void 0),t.map(r=>function(a,s){let o=a.updateTime?Mo(a.updateTime):Mo(s);return o.isEqual(tn.min())&&(o=Mo(s)),new yve(o,a.transformResults||[])}(r,e))):[]}function lZ(t,e){return{documents:[sZ(t,e.path)]}}function cZ(t,e){const r={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=sZ(t,a);const s=function(u){if(u.length!==0)return fZ(Da.create(u,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(d=>function(A){return{field:vx(A.field),direction:Rve(A.dir)}}(d))}(e.orderBy);o&&(r.structuredQuery.orderBy=o);const l=RT(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:r,parent:a}}function uZ(t){let e=iZ(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){Wr(n===1);const d=r.from[0];d.allDescendants?a=d.collectionId:e=e.child(d.collectionId)}let s=[];r.where&&(s=function(f){const A=dZ(f);return A instanceof Da&&TD(A)?A.getFilters():[A]}(r.where));let o=[];r.orderBy&&(o=function(f){return f.map(A=>function(m){return new c2(yx(m.field),function(g){switch(g){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(A))}(r.orderBy));let l=null;r.limit&&(l=function(f){let A;return A=typeof f=="object"?f.value:f,mw(A)?null:A}(r.limit));let c=null;r.startAt&&(c=function(f){const A=!!f.before,h=f.values||[];return new _v(h,A)}(r.startAt));let u=null;return r.endAt&&(u=function(f){const A=!f.before,h=f.values||[];return new _v(h,A)}(r.endAt)),ove(e,a,o,s,l,"F",c,u)}function Dve(t,e){const r=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Hr()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function dZ(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=yx(r.unaryFilter.field);return Yn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=yx(r.unaryFilter.field);return Yn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=yx(r.unaryFilter.field);return Yn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=yx(r.unaryFilter.field);return Yn.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Hr()}}(t):t.fieldFilter!==void 0?function(r){return Yn.create(yx(r.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Hr()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Da.create(r.compositeFilter.filters.map(n=>dZ(n)),function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Hr()}}(r.compositeFilter.op))}(t):Hr()}function Rve(t){return Sve[t]}function Mve(t){return Ive[t]}function Lve(t){return jve[t]}function vx(t){return{fieldPath:t.canonicalString()}}function yx(t){return Ss.fromServerFormat(t.fieldPath)}function fZ(t){return t instanceof Yn?function(r){if(r.op==="=="){if(c7(r.value))return{unaryFilter:{field:vx(r.field),op:"IS_NAN"}};if(l7(r.value))return{unaryFilter:{field:vx(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(c7(r.value))return{unaryFilter:{field:vx(r.field),op:"IS_NOT_NAN"}};if(l7(r.value))return{unaryFilter:{field:vx(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:vx(r.field),op:Mve(r.op),value:r.value}}}(t):t instanceof Da?function(r){const n=r.getFilters().map(a=>fZ(a));return n.length===1?n[0]:{compositeFilter:{op:Lve(r.op),filters:n}}}(t):Hr()}function Uve(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function hZ(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(e,r,n,a,s=tn.min(),o=tn.min(),l=Ti.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Oh(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Oh(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Oh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Oh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AZ{constructor(e){this.ct=e}}function Qve(t,e){let r;if(e.document)r=Tve(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=Pr.fromSegments(e.noDocument.path),a=Jp(e.noDocument.readTime);r=Es.newNoDocument(n,a),e.hasCommittedMutations&&r.setHasCommittedMutations()}else{if(!e.unknownDocument)return Hr();{const n=Pr.fromSegments(e.unknownDocument.path),a=Jp(e.unknownDocument.version);r=Es.newUnknownDocument(n,a)}}return e.readTime&&r.setReadTime(function(a){const s=new dr(a[0],a[1]);return tn.fromTimestamp(s)}(e.readTime)),r}function S7(t,e){const r=e.key,n={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:JE(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(s,o){return{name:f2(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Iv(s,o.version.toTimestamp()),createTime:Iv(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())n.noDocument={path:r.path.toArray(),readTime:Yp(e.version)};else{if(!e.isUnknownDocument())return Hr();n.unknownDocument={path:r.path.toArray(),version:Yp(e.version)}}return n}function JE(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Yp(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Jp(t){const e=new dr(t.seconds,t.nanoseconds);return tn.fromTimestamp(e)}function sp(t,e){const r=(e.baseMutations||[]).map(s=>UT(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const n=e.mutations.map(s=>UT(t.ct,s)),a=dr.fromMillis(e.localWriteTimeMs);return new OD(e.batchId,a,r,n)}function Ty(t){const e=Jp(t.readTime),r=t.lastLimboFreeSnapshotVersion!==void 0?Jp(t.lastLimboFreeSnapshotVersion):tn.min();let n;return n=function(s){return s.documents!==void 0}(t.query)?function(s){return Wr(s.documents.length===1),ld(gw(iZ(s.documents[0])))}(t.query):function(s){return ld(uZ(s))}(t.query),new Oh(n,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,r,Ti.fromBase64String(t.resumeToken))}function mZ(t,e){const r=Yp(e.snapshotVersion),n=Yp(e.lastLimboFreeSnapshotVersion);let a;a=WE(e.target)?lZ(t.ct,e.target):cZ(t.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Wp(e.target),readTime:r,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:a}}function pZ(t){const e=uZ({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?YE(e,e.limit,"L"):e}function f3(t,e){return new RD(e.largestBatchId,UT(t.ct,e.overlayMutation))}function I7(t,e){const r=e.path.lastSegment();return[t,uc(e.path.popLast()),r]}function j7(t,e,r,n){return{indexId:t,uid:e,sequenceNumber:r,readTime:Yp(n.readTime),documentKey:uc(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vve{getBundleMetadata(e,r){return P7(e).get(r).next(n=>{if(n)return function(s){return{id:s.bundleId,createTime:Jp(s.createTime),version:s.version}}(n)})}saveBundleMetadata(e,r){return P7(e).put(function(a){return{bundleId:a.id,createTime:Yp(Mo(a.createTime)),version:a.version}}(r))}getNamedQuery(e,r){return B7(e).get(r).next(n=>{if(n)return function(s){return{name:s.name,query:pZ(s.bundledQuery),readTime:Jp(s.readTime)}}(n)})}saveNamedQuery(e,r){return B7(e).put(function(a){return{name:a.name,readTime:Yp(Mo(a.readTime)),bundledQuery:a.bundledQuery}}(r))}}function P7(t){return po(t,"bundles")}function B7(t){return po(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mj{constructor(e,r){this.serializer=e,this.userId=r}static lt(e,r){const n=r.uid||"";return new mj(e,n)}getOverlay(e,r){return W1(e).get(I7(this.userId,r)).next(n=>n?f3(this.serializer,n):null)}getOverlays(e,r){const n=Of();return Gt.forEach(r,a=>this.getOverlay(e,a).next(s=>{s!==null&&n.set(a,s)})).next(()=>n)}saveOverlays(e,r,n){const a=[];return n.forEach((s,o)=>{const l=new RD(r,o);a.push(this.ht(e,l))}),Gt.waitFor(a)}removeOverlaysForBatchId(e,r,n){const a=new Set;r.forEach(o=>a.add(uc(o.getCollectionPath())));const s=[];return a.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,n+1],!1,!0);s.push(W1(e).j("collectionPathOverlayIndex",l))}),Gt.waitFor(s)}getOverlaysForCollection(e,r,n){const a=Of(),s=uc(r),o=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return W1(e).U("collectionPathOverlayIndex",o).next(l=>{for(const c of l){const u=f3(this.serializer,c);a.set(u.getKey(),u)}return a})}getOverlaysForCollectionGroup(e,r,n,a){const s=Of();let o;const l=IDBKeyRange.bound([this.userId,r,n],[this.userId,r,Number.POSITIVE_INFINITY],!0);return W1(e).J({index:"collectionGroupOverlayIndex",range:l},(c,u,d)=>{const f=f3(this.serializer,u);s.size()<a||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>s)}ht(e,r){return W1(e).put(function(a,s,o){const[l,c,u]=I7(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:h2(a.ct,o.mutation)}}(this.serializer,this.userId,r))}}function W1(t){return po(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hve{Pt(e){return po(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(r=>{const n=r==null?void 0:r.value;return n?Ti.fromUint8Array(n):Ti.EMPTY_BYTE_STRING})}setSessionToken(e,r){return this.Pt(e).put({name:"sessionToken",value:r.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{constructor(){}It(e,r){this.Tt(e,r),r.Et()}Tt(e,r){if("nullValue"in e)this.dt(r,5);else if("booleanValue"in e)this.dt(r,10),r.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(r,15),r.At(Cs(e.integerValue));else if("doubleValue"in e){const n=Cs(e.doubleValue);isNaN(n)?this.dt(r,13):(this.dt(r,15),a2(n)?r.At(0):r.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(r,20),typeof n=="string"&&(n=aA(n)),r.Rt(`${n.seconds||""}`),r.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,r),this.ft(r);else if("bytesValue"in e)this.dt(r,30),r.gt(sm(e.bytesValue)),this.ft(r);else if("referenceValue"in e)this.yt(e.referenceValue,r);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(r,45),r.At(n.latitude||0),r.At(n.longitude||0)}else"mapValue"in e?jJ(e)?this.dt(r,Number.MAX_SAFE_INTEGER):uj(e)?this.wt(e.mapValue,r):(this.St(e.mapValue,r),this.ft(r)):"arrayValue"in e?(this.bt(e.arrayValue,r),this.ft(r)):Hr()}Vt(e,r){this.dt(r,25),this.Dt(e,r)}Dt(e,r){r.Rt(e)}St(e,r){const n=e.fields||{};this.dt(r,55);for(const a of Object.keys(n))this.Vt(a,r),this.Tt(n[a],r)}wt(e,r){var n,a;const s=e.fields||{};this.dt(r,53);const o="value",l=((a=(n=s[o].arrayValue)===null||n===void 0?void 0:n.values)===null||a===void 0?void 0:a.length)||0;this.dt(r,15),r.At(Cs(l)),this.Vt(o,r),this.Tt(s[o],r)}bt(e,r){const n=e.values||[];this.dt(r,50);for(const a of n)this.Tt(a,r)}yt(e,r){this.dt(r,37),Pr.fromName(e).path.forEach(n=>{this.dt(r,60),this.Dt(n,r)})}dt(e,r){e.At(r)}ft(e){e.At(2)}}ip.vt=new ip;function $ve(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function T7(t){const e=64-function(n){let a=0;for(let s=0;s<8;++s){const o=$ve(255&n[s]);if(a+=o,o!==8)break}return a}(t);return Math.ceil(e/8)}class Gve{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ft(n.value),n=r.next();this.Mt()}xt(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ot(n.value),n=r.next();this.Nt()}Lt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ft(n);else if(n<2048)this.Ft(960|n>>>6),this.Ft(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ft(480|n>>>12),this.Ft(128|63&n>>>6),this.Ft(128|63&n);else{const a=r.codePointAt(0);this.Ft(240|a>>>18),this.Ft(128|63&a>>>12),this.Ft(128|63&a>>>6),this.Ft(128|63&a)}}this.Mt()}Bt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ot(n);else if(n<2048)this.Ot(960|n>>>6),this.Ot(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ot(480|n>>>12),this.Ot(128|63&n>>>6),this.Ot(128|63&n);else{const a=r.codePointAt(0);this.Ot(240|a>>>18),this.Ot(128|63&a>>>12),this.Ot(128|63&a>>>6),this.Ot(128|63&a)}}this.Nt()}kt(e){const r=this.qt(e),n=T7(r);this.Qt(1+n),this.buffer[this.position++]=255&n;for(let a=r.length-n;a<r.length;++a)this.buffer[this.position++]=255&r[a]}Kt(e){const r=this.qt(e),n=T7(r);this.Qt(1+n),this.buffer[this.position++]=~(255&n);for(let a=r.length-n;a<r.length;++a)this.buffer[this.position++]=~(255&r[a])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const r=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),n=(128&r[0])!=0;r[0]^=n?255:128;for(let a=1;a<r.length;++a)r[a]^=n?255:0;return r}Ft(e){const r=255&e;r===0?(this.Ut(0),this.Ut(255)):r===255?(this.Ut(255),this.Ut(0)):this.Ut(r)}Ot(e){const r=255&e;r===0?(this.Gt(0),this.Gt(255)):r===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const r=e+this.position;if(r<=this.buffer.length)return;let n=2*this.buffer.length;n<r&&(n=r);const a=new Uint8Array(n);a.set(this.buffer),this.buffer=a}}class Kve{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class qve{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class X1{constructor(){this.jt=new Gve,this.Ht=new Kve(this.jt),this.Jt=new qve(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{constructor(e,r,n,a){this.indexId=e,this.documentKey=r,this.arrayValue=n,this.directionalValue=a}Zt(){const e=this.directionalValue.length,r=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(r);return n.set(this.directionalValue,0),r!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new op(this.indexId,this.documentKey,this.arrayValue,n)}}function YA(t,e){let r=t.indexId-e.indexId;return r!==0?r:(r=k7(t.arrayValue,e.arrayValue),r!==0?r:(r=k7(t.directionalValue,e.directionalValue),r!==0?r:Pr.comparator(t.documentKey,e.documentKey)))}function k7(t,e){for(let r=0;r<t.length&&r<e.length;++r){const n=t[r]-e[r];if(n!==0)return n}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F7{constructor(e){this.Xt=new Ka((r,n)=>Ss.comparator(r.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const r of e.filters){const n=r;n.isInequality()?this.Xt=this.Xt.add(n):this.tn.push(n)}}get nn(){return this.Xt.size>1}rn(e){if(Wr(e.collectionGroup===this.collectionId),this.nn)return!1;const r=jT(e);if(r!==void 0&&!this.sn(r))return!1;const n=Xm(e);let a=new Set,s=0,o=0;for(;s<n.length&&this.sn(n[s]);++s)a=a.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.Xt.size>0){const l=this.Xt.getIterator().getNext();if(!a.has(l.field.canonicalString())){const c=n[s];if(!this.on(l,c)||!this._n(this.en[o++],c))return!1}++s}for(;s<n.length;++s){const l=n[s];if(o>=this.en.length||!this._n(this.en[o++],l))return!1}return!0}an(){if(this.nn)return null;let e=new Ka(Ss.comparator);const r=[];for(const n of this.tn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")r.push(new q_(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),r.push(new q_(n.field,0))}for(const n of this.en)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),r.push(new q_(n.field,n.dir==="asc"?0:1)));return new zE(zE.UNKNOWN_ID,this.collectionId,r,n2.empty())}sn(e){for(const r of this.tn)if(this.on(r,e))return!0;return!1}on(e,r){if(e===void 0||!e.field.isEqual(r.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return r.kind===2===n}_n(e,r){return!!e.field.isEqual(r.fieldPath)&&(r.kind===0&&e.dir==="asc"||r.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gZ(t){var e,r;if(Wr(t instanceof Yn||t instanceof Da),t instanceof Yn){if(t instanceof MJ){const a=((r=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||r===void 0?void 0:r.map(s=>Yn.create(t.field,"==",s)))||[];return Da.create(a,"or")}return t}const n=t.filters.map(a=>gZ(a));return Da.create(n,t.op)}function zve(t){if(t.getFilters().length===0)return[];const e=HT(gZ(t));return Wr(xZ(e)),QT(e)||VT(e)?[e]:e.getFilters()}function QT(t){return t instanceof Yn}function VT(t){return t instanceof Da&&TD(t)}function xZ(t){return QT(t)||VT(t)||function(r){if(r instanceof Da&&kT(r)){for(const n of r.getFilters())if(!QT(n)&&!VT(n))return!1;return!0}return!1}(t)}function HT(t){if(Wr(t instanceof Yn||t instanceof Da),t instanceof Yn)return t;if(t.filters.length===1)return HT(t.filters[0]);const e=t.filters.map(n=>HT(n));let r=Da.create(e,t.op);return r=ZE(r),xZ(r)?r:(Wr(r instanceof Da),Wr(Ev(r)),Wr(r.filters.length>1),r.filters.reduce((n,a)=>UD(n,a)))}function UD(t,e){let r;return Wr(t instanceof Yn||t instanceof Da),Wr(e instanceof Yn||e instanceof Da),r=t instanceof Yn?e instanceof Yn?function(a,s){return Da.create([a,s],"and")}(t,e):O7(t,e):e instanceof Yn?O7(e,t):function(a,s){if(Wr(a.filters.length>0&&s.filters.length>0),Ev(a)&&Ev(s))return OJ(a,s.getFilters());const o=kT(a)?a:s,l=kT(a)?s:a,c=o.filters.map(u=>UD(u,l));return Da.create(c,"or")}(t,e),ZE(r)}function O7(t,e){if(Ev(e))return OJ(e,t.getFilters());{const r=e.filters.map(n=>UD(t,n));return Da.create(r,"or")}}function ZE(t){if(Wr(t instanceof Yn||t instanceof Da),t instanceof Yn)return t;const e=t.getFilters();if(e.length===1)return ZE(e[0]);if(kJ(t))return t;const r=e.map(a=>ZE(a)),n=[];return r.forEach(a=>{a instanceof Yn?n.push(a):a instanceof Da&&(a.op===t.op?n.push(...a.filters):n.push(a))}),n.length===1?n[0]:Da.create(n,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wve{constructor(){this.un=new QD}addToCollectionParentIndex(e,r){return this.un.add(r),Gt.resolve()}getCollectionParents(e,r){return Gt.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Gt.resolve()}deleteFieldIndex(e,r){return Gt.resolve()}deleteAllFieldIndexes(e){return Gt.resolve()}createTargetIndexes(e,r){return Gt.resolve()}getDocumentsMatchingTarget(e,r){return Gt.resolve(null)}getIndexType(e,r){return Gt.resolve(0)}getFieldIndexes(e,r){return Gt.resolve([])}getNextCollectionGroupToUpdate(e){return Gt.resolve(null)}getMinOffset(e,r){return Gt.resolve(vu.min())}getMinOffsetFromCollectionGroup(e,r){return Gt.resolve(vu.min())}updateCollectionGroup(e,r,n){return Gt.resolve()}updateIndexEntries(e,r){return Gt.resolve()}}class QD{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r]||new Ka(fa.comparator),s=!a.has(n);return this.index[r]=a.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r];return a&&a.has(n)}getEntries(e){return(this.index[e]||new Ka(fa.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qN=new Uint8Array(0);class Xve{constructor(e,r){this.databaseId=r,this.cn=new QD,this.ln=new _m(n=>Wp(n),(n,a)=>pw(n,a)),this.uid=e.uid||""}addToCollectionParentIndex(e,r){if(!this.cn.has(r)){const n=r.lastSegment(),a=r.popLast();e.addOnCommittedListener(()=>{this.cn.add(r)});const s={collectionId:n,parent:uc(a)};return D7(e).put(s)}return Gt.resolve()}getCollectionParents(e,r){const n=[],a=IDBKeyRange.bound([r,""],[xJ(r),""],!1,!0);return D7(e).U(a).next(s=>{for(const o of s){if(o.collectionId!==r)break;n.push(Ff(o.parent))}return n})}addFieldIndex(e,r){const n=Y1(e),a=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(r);delete a.indexId;const s=n.add(a);if(r.indexState){const o=Kg(e);return s.next(l=>{o.put(j7(l,this.uid,r.indexState.sequenceNumber,r.indexState.offset))})}return s.next()}deleteFieldIndex(e,r){const n=Y1(e),a=Kg(e),s=Gg(e);return n.delete(r.indexId).next(()=>a.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const r=Y1(e),n=Gg(e),a=Kg(e);return r.j().next(()=>n.j()).next(()=>a.j())}createTargetIndexes(e,r){return Gt.forEach(this.hn(r),n=>this.getIndexType(e,n).next(a=>{if(a===0||a===1){const s=new F7(n).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,r){const n=Gg(e);let a=!0;const s=new Map;return Gt.forEach(this.hn(r),o=>this.Pn(e,o).next(l=>{a&&(a=!!l),s.set(o,l)})).next(()=>{if(a){let o=Mn();const l=[];return Gt.forEach(s,(c,u)=>{xr("IndexedDbIndexManager",`Using index ${function(b){return`id=${b.indexId}|cg=${b.collectionGroup}|f=${b.fields.map(w=>`${w.fieldPath}:${w.kind}`).join(",")}`}(c)} to execute ${Wp(r)}`);const d=function(b,w){const j=jT(w);if(j===void 0)return null;for(const I of XE(b,j.fieldPath))switch(I.op){case"array-contains-any":return I.value.arrayValue.values||[];case"array-contains":return[I.value]}return null}(u,c),f=function(b,w){const j=new Map;for(const I of Xm(w))for(const _ of XE(b,I.fieldPath))switch(_.op){case"==":case"in":j.set(I.fieldPath.canonicalString(),_.value);break;case"not-in":case"!=":return j.set(I.fieldPath.canonicalString(),_.value),Array.from(j.values())}return null}(u,c),A=function(b,w){const j=[];let I=!0;for(const _ of Xm(w)){const S=_.kind===0?A7(b,_.fieldPath,b.startAt):m7(b,_.fieldPath,b.startAt);j.push(S.value),I&&(I=S.inclusive)}return new _v(j,I)}(u,c),h=function(b,w){const j=[];let I=!0;for(const _ of Xm(w)){const S=_.kind===0?m7(b,_.fieldPath,b.endAt):A7(b,_.fieldPath,b.endAt);j.push(S.value),I&&(I=S.inclusive)}return new _v(j,I)}(u,c),m=this.In(c,u,A),p=this.In(c,u,h),g=this.Tn(c,u,f),v=this.En(c.indexId,d,m,A.inclusive,p,h.inclusive,g);return Gt.forEach(v,y=>n.G(y,r.limit).next(b=>{b.forEach(w=>{const j=Pr.fromSegments(w.documentKey);o.has(j)||(o=o.add(j),l.push(j))})}))}).next(()=>l)}return Gt.resolve(null)})}hn(e){let r=this.ln.get(e);return r||(e.filters.length===0?r=[e]:r=zve(Da.create(e.filters,"and")).map(n=>OT(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,r),r)}En(e,r,n,a,s,o,l){const c=(r!=null?r.length:1)*Math.max(n.length,s.length),u=c/(r!=null?r.length:1),d=[];for(let f=0;f<c;++f){const A=r?this.dn(r[f/u]):qN,h=this.An(e,A,n[f%u],a),m=this.Rn(e,A,s[f%u],o),p=l.map(g=>this.An(e,A,g,!0));d.push(...this.createRange(h,m,p))}return d}An(e,r,n,a){const s=new op(e,Pr.empty(),r,n);return a?s:s.Zt()}Rn(e,r,n,a){const s=new op(e,Pr.empty(),r,n);return a?s.Zt():s}Pn(e,r){const n=new F7(r),a=r.collectionGroup!=null?r.collectionGroup:r.path.lastSegment();return this.getFieldIndexes(e,a).next(s=>{let o=null;for(const l of s)n.rn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,r){let n=2;const a=this.hn(r);return Gt.forEach(a,s=>this.Pn(e,s).next(o=>{o?n!==0&&o.fields.length<function(c){let u=new Ka(Ss.comparator),d=!1;for(const f of c.filters)for(const A of f.getFlattenedFilters())A.field.isKeyField()||(A.op==="array-contains"||A.op==="array-contains-any"?d=!0:u=u.add(A.field));for(const f of c.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(d?1:0)}(s)&&(n=1):n=0})).next(()=>function(o){return o.limit!==null}(r)&&a.length>1&&n===2?1:n)}Vn(e,r){const n=new X1;for(const a of Xm(e)){const s=r.data.field(a.fieldPath);if(s==null)return null;const o=n.Yt(a.kind);ip.vt.It(s,o)}return n.zt()}dn(e){const r=new X1;return ip.vt.It(e,r.Yt(0)),r.zt()}mn(e,r){const n=new X1;return ip.vt.It(o2(this.databaseId,r),n.Yt(function(s){const o=Xm(s);return o.length===0?0:o[o.length-1].kind}(e))),n.zt()}Tn(e,r,n){if(n===null)return[];let a=[];a.push(new X1);let s=0;for(const o of Xm(e)){const l=n[s++];for(const c of a)if(this.fn(r,o.fieldPath)&&l2(l))a=this.gn(a,o,l);else{const u=c.Yt(o.kind);ip.vt.It(l,u)}}return this.pn(a)}In(e,r,n){return this.Tn(e,r,n.position)}pn(e){const r=[];for(let n=0;n<e.length;++n)r[n]=e[n].zt();return r}gn(e,r,n){const a=[...e],s=[];for(const o of n.arrayValue.values||[])for(const l of a){const c=new X1;c.seed(l.zt()),ip.vt.It(o,c.Yt(r.kind)),s.push(c)}return s}fn(e,r){return!!e.filters.find(n=>n instanceof Yn&&n.field.isEqual(r)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,r){const n=Y1(e),a=Kg(e);return(r?n.U("collectionGroupIndex",IDBKeyRange.bound(r,r)):n.U()).next(s=>{const o=[];return Gt.forEach(s,l=>a.get([l.indexId,this.uid]).next(c=>{o.push(function(d,f){const A=f?new n2(f.sequenceNumber,new vu(Jp(f.readTime),new Pr(Ff(f.documentKey)),f.largestBatchId)):n2.empty(),h=d.fields.map(([m,p])=>new q_(Ss.fromServerFormat(m),p));return new zE(d.indexId,d.collectionGroup,h,A)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(r=>r.length===0?null:(r.sort((n,a)=>{const s=n.indexState.sequenceNumber-a.indexState.sequenceNumber;return s!==0?s:En(n.collectionGroup,a.collectionGroup)}),r[0].collectionGroup))}updateCollectionGroup(e,r,n){const a=Y1(e),s=Kg(e);return this.yn(e).next(o=>a.U("collectionGroupIndex",IDBKeyRange.bound(r,r)).next(l=>Gt.forEach(l,c=>s.put(j7(c.indexId,this.uid,o,n)))))}updateIndexEntries(e,r){const n=new Map;return Gt.forEach(r,(a,s)=>{const o=n.get(a.collectionGroup);return(o?Gt.resolve(o):this.getFieldIndexes(e,a.collectionGroup)).next(l=>(n.set(a.collectionGroup,l),Gt.forEach(l,c=>this.wn(e,a,c).next(u=>{const d=this.Sn(s,c);return u.isEqual(d)?Gt.resolve():this.bn(e,s,c,u,d)}))))})}Dn(e,r,n,a){return Gg(e).put({indexId:a.indexId,uid:this.uid,arrayValue:a.arrayValue,directionalValue:a.directionalValue,orderedDocumentKey:this.mn(n,r.key),documentKey:r.key.path.toArray()})}vn(e,r,n,a){return Gg(e).delete([a.indexId,this.uid,a.arrayValue,a.directionalValue,this.mn(n,r.key),r.key.path.toArray()])}wn(e,r,n){const a=Gg(e);let s=new Ka(YA);return a.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,r)])},(o,l)=>{s=s.add(new op(n.indexId,r,l.arrayValue,l.directionalValue))}).next(()=>s)}Sn(e,r){let n=new Ka(YA);const a=this.Vn(r,e);if(a==null)return n;const s=jT(r);if(s!=null){const o=e.data.field(s.fieldPath);if(l2(o))for(const l of o.arrayValue.values||[])n=n.add(new op(r.indexId,e.key,this.dn(l),a))}else n=n.add(new op(r.indexId,e.key,qN,a));return n}bn(e,r,n,a,s){xr("IndexedDbIndexManager","Updating index entries for document '%s'",r.key);const o=[];return function(c,u,d,f,A){const h=c.getIterator(),m=u.getIterator();let p=$g(h),g=$g(m);for(;p||g;){let v=!1,y=!1;if(p&&g){const b=d(p,g);b<0?y=!0:b>0&&(v=!0)}else p!=null?y=!0:v=!0;v?(f(g),g=$g(m)):y?(A(p),p=$g(h)):(p=$g(h),g=$g(m))}}(a,s,YA,l=>{o.push(this.Dn(e,r,n,l))},l=>{o.push(this.vn(e,r,n,l))}),Gt.waitFor(o)}yn(e){let r=1;return Kg(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,a,s)=>{s.done(),r=a.sequenceNumber+1}).next(()=>r)}createRange(e,r,n){n=n.sort((o,l)=>YA(o,l)).filter((o,l,c)=>!l||YA(o,c[l-1])!==0);const a=[];a.push(e);for(const o of n){const l=YA(o,e),c=YA(o,r);if(l===0)a[0]=e.Zt();else if(l>0&&c<0)a.push(o),a.push(o.Zt());else if(c>0)break}a.push(r);const s=[];for(let o=0;o<a.length;o+=2){if(this.Cn(a[o],a[o+1]))return[];const l=[a[o].indexId,this.uid,a[o].arrayValue,a[o].directionalValue,qN,[]],c=[a[o+1].indexId,this.uid,a[o+1].arrayValue,a[o+1].directionalValue,qN,[]];s.push(IDBKeyRange.bound(l,c))}return s}Cn(e,r){return YA(e,r)>0}getMinOffsetFromCollectionGroup(e,r){return this.getFieldIndexes(e,r).next(R7)}getMinOffset(e,r){return Gt.mapArray(this.hn(r),n=>this.Pn(e,n).next(a=>a||Hr())).next(R7)}}function D7(t){return po(t,"collectionParents")}function Gg(t){return po(t,"indexEntries")}function Y1(t){return po(t,"indexConfiguration")}function Kg(t){return po(t,"indexState")}function R7(t){Wr(t.length!==0);let e=t[0].indexState.offset,r=e.largestBatchId;for(let n=1;n<t.length;n++){const a=t[n].indexState.offset;SD(a,e)<0&&(e=a),r<a.largestBatchId&&(r=a.largestBatchId)}return new vu(e.readTime,e.documentKey,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M7={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Ic{constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Ic(e,Ic.DEFAULT_COLLECTION_PERCENTILE,Ic.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vZ(t,e,r){const n=t.store("mutations"),a=t.store("documentMutations"),s=[],o=IDBKeyRange.only(r.batchId);let l=0;const c=n.J({range:o},(d,f,A)=>(l++,A.delete()));s.push(c.next(()=>{Wr(l===1)}));const u=[];for(const d of r.mutations){const f=NJ(e,d.key.path,r.batchId);s.push(a.delete(f)),u.push(d.key)}return Gt.waitFor(s).next(()=>u)}function eS(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Hr();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ic.DEFAULT_COLLECTION_PERCENTILE=10,Ic.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ic.DEFAULT=new Ic(41943040,Ic.DEFAULT_COLLECTION_PERCENTILE,Ic.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ic.DISABLED=new Ic(-1,0,0);class pj{constructor(e,r,n,a){this.userId=e,this.serializer=r,this.indexManager=n,this.referenceDelegate=a,this.Fn={}}static lt(e,r,n,a){Wr(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new pj(s,r,n,a)}checkEmpty(e){let r=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return JA(e).J({index:"userMutationsIndex",range:n},(a,s,o)=>{r=!1,o.done()}).next(()=>r)}addMutationBatch(e,r,n,a){const s=bx(e),o=JA(e);return o.add({}).next(l=>{Wr(typeof l=="number");const c=new OD(l,r,n,a),u=function(h,m,p){const g=p.baseMutations.map(y=>h2(h.ct,y)),v=p.mutations.map(y=>h2(h.ct,y));return{userId:m,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:g,mutations:v}}(this.serializer,this.userId,c),d=[];let f=new Ka((A,h)=>En(A.canonicalString(),h.canonicalString()));for(const A of a){const h=NJ(this.userId,A.key.path,l);f=f.add(A.key.path.popLast()),d.push(o.put(u)),d.push(s.put(h,Bxe))}return f.forEach(A=>{d.push(this.indexManager.addToCollectionParentIndex(e,A))}),e.addOnCommittedListener(()=>{this.Fn[l]=c.keys()}),Gt.waitFor(d).next(()=>c)})}lookupMutationBatch(e,r){return JA(e).get(r).next(n=>n?(Wr(n.userId===this.userId),sp(this.serializer,n)):null)}Mn(e,r){return this.Fn[r]?Gt.resolve(this.Fn[r]):this.lookupMutationBatch(e,r).next(n=>{if(n){const a=n.keys();return this.Fn[r]=a,a}return null})}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return JA(e).J({index:"userMutationsIndex",range:a},(o,l,c)=>{l.userId===this.userId&&(Wr(l.batchId>=n),s=sp(this.serializer,l)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const r=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return JA(e).J({index:"userMutationsIndex",range:r,reverse:!0},(a,s,o)=>{n=s.batchId,o.done()}).next(()=>n)}getAllMutationBatches(e){const r=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return JA(e).U("userMutationsIndex",r).next(n=>n.map(a=>sp(this.serializer,a)))}getAllMutationBatchesAffectingDocumentKey(e,r){const n=z_(this.userId,r.path),a=IDBKeyRange.lowerBound(n),s=[];return bx(e).J({range:a},(o,l,c)=>{const[u,d,f]=o,A=Ff(d);if(u===this.userId&&r.path.isEqual(A))return JA(e).get(f).next(h=>{if(!h)throw Hr();Wr(h.userId===this.userId),s.push(sp(this.serializer,h))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Ka(En);const a=[];return r.forEach(s=>{const o=z_(this.userId,s.path),l=IDBKeyRange.lowerBound(o),c=bx(e).J({range:l},(u,d,f)=>{const[A,h,m]=u,p=Ff(h);A===this.userId&&s.path.isEqual(p)?n=n.add(m):f.done()});a.push(c)}),Gt.waitFor(a).next(()=>this.xn(e,n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1,s=z_(this.userId,n),o=IDBKeyRange.lowerBound(s);let l=new Ka(En);return bx(e).J({range:o},(c,u,d)=>{const[f,A,h]=c,m=Ff(A);f===this.userId&&n.isPrefixOf(m)?m.length===a&&(l=l.add(h)):d.done()}).next(()=>this.xn(e,l))}xn(e,r){const n=[],a=[];return r.forEach(s=>{a.push(JA(e).get(s).next(o=>{if(o===null)throw Hr();Wr(o.userId===this.userId),n.push(sp(this.serializer,o))}))}),Gt.waitFor(a).next(()=>n)}removeMutationBatch(e,r){return vZ(e._e,this.userId,r).next(n=>(e.addOnCommittedListener(()=>{this.On(r.batchId)}),Gt.forEach(n,a=>this.referenceDelegate.markPotentiallyOrphaned(e,a))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(r=>{if(!r)return Gt.resolve();const n=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),a=[];return bx(e).J({range:n},(s,o,l)=>{if(s[0]===this.userId){const c=Ff(s[1]);a.push(c)}else l.done()}).next(()=>{Wr(a.length===0)})})}containsKey(e,r){return yZ(e,this.userId,r)}Nn(e){return bZ(e).get(this.userId).next(r=>r||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function yZ(t,e,r){const n=z_(e,r.path),a=n[1],s=IDBKeyRange.lowerBound(n);let o=!1;return bx(t).J({range:s,H:!0},(l,c,u)=>{const[d,f,A]=l;d===e&&f===a&&(o=!0),u.done()}).next(()=>o)}function JA(t){return po(t,"mutations")}function bx(t){return po(t,"documentMutations")}function bZ(t){return po(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zp{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Zp(0)}static kn(){return new Zp(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yve{constructor(e,r){this.referenceDelegate=e,this.serializer=r}allocateTargetId(e){return this.qn(e).next(r=>{const n=new Zp(r.highestTargetId);return r.highestTargetId=n.next(),this.Qn(e,r).next(()=>r.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(r=>tn.fromTimestamp(new dr(r.lastRemoteSnapshotVersion.seconds,r.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(r=>r.highestListenSequenceNumber)}setTargetsMetadata(e,r,n){return this.qn(e).next(a=>(a.highestListenSequenceNumber=r,n&&(a.lastRemoteSnapshotVersion=n.toTimestamp()),r>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=r),this.Qn(e,a)))}addTargetData(e,r){return this.Kn(e,r).next(()=>this.qn(e).next(n=>(n.targetCount+=1,this.$n(r,n),this.Qn(e,n))))}updateTargetData(e,r){return this.Kn(e,r)}removeTargetData(e,r){return this.removeMatchingKeysForTargetId(e,r.targetId).next(()=>qg(e).delete(r.targetId)).next(()=>this.qn(e)).next(n=>(Wr(n.targetCount>0),n.targetCount-=1,this.Qn(e,n)))}removeTargets(e,r,n){let a=0;const s=[];return qg(e).J((o,l)=>{const c=Ty(l);c.sequenceNumber<=r&&n.get(c.targetId)===null&&(a++,s.push(this.removeTargetData(e,c)))}).next(()=>Gt.waitFor(s)).next(()=>a)}forEachTarget(e,r){return qg(e).J((n,a)=>{const s=Ty(a);r(s)})}qn(e){return L7(e).get("targetGlobalKey").next(r=>(Wr(r!==null),r))}Qn(e,r){return L7(e).put("targetGlobalKey",r)}Kn(e,r){return qg(e).put(mZ(this.serializer,r))}$n(e,r){let n=!1;return e.targetId>r.highestTargetId&&(r.highestTargetId=e.targetId,n=!0),e.sequenceNumber>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.qn(e).next(r=>r.targetCount)}getTargetData(e,r){const n=Wp(r),a=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return qg(e).J({range:a,index:"queryTargetsIndex"},(o,l,c)=>{const u=Ty(l);pw(r,u.target)&&(s=u,c.done())}).next(()=>s)}addMatchingKeys(e,r,n){const a=[],s=C0(e);return r.forEach(o=>{const l=uc(o.path);a.push(s.put({targetId:n,path:l})),a.push(this.referenceDelegate.addReference(e,n,o))}),Gt.waitFor(a)}removeMatchingKeys(e,r,n){const a=C0(e);return Gt.forEach(r,s=>{const o=uc(s.path);return Gt.waitFor([a.delete([n,o]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,r){const n=C0(e),a=IDBKeyRange.bound([r],[r+1],!1,!0);return n.delete(a)}getMatchingKeysForTargetId(e,r){const n=IDBKeyRange.bound([r],[r+1],!1,!0),a=C0(e);let s=Mn();return a.J({range:n,H:!0},(o,l,c)=>{const u=Ff(o[1]),d=new Pr(u);s=s.add(d)}).next(()=>s)}containsKey(e,r){const n=uc(r.path),a=IDBKeyRange.bound([n],[xJ(n)],!1,!0);let s=0;return C0(e).J({index:"documentTargetsIndex",H:!0,range:a},([o,l],c,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}ot(e,r){return qg(e).get(r).next(n=>n?Ty(n):null)}}function qg(t){return po(t,"targets")}function L7(t){return po(t,"targetGlobal")}function C0(t){return po(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U7([t,e],[r,n]){const a=En(t,r);return a===0?En(e,n):a}class Jve{constructor(e){this.Un=e,this.buffer=new Ka(U7),this.Wn=0}Gn(){return++this.Wn}zn(e){const r=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();U7(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class Zve{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){xr("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Cm(r)?xr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):await vg(r)}await this.Hn(3e5)})}}class e1e{constructor(e,r){this.Jn=e,this.params=r}calculateTargetCount(e,r){return this.Jn.Yn(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Gt.resolve(rd.oe);const n=new Jve(r);return this.Jn.forEachTarget(e,a=>n.zn(a.sequenceNumber)).next(()=>this.Jn.Zn(e,a=>n.zn(a))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Jn.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Jn.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(xr("LruGarbageCollector","Garbage collection skipped; disabled"),Gt.resolve(M7)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(xr("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),M7):this.Xn(e,r))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,r){let n,a,s,o,l,c,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(xr("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),a=this.params.maximumSequenceNumbersToCollect):a=f,o=Date.now(),this.nthSequenceNumber(e,a))).next(f=>(n=f,l=Date.now(),this.removeTargets(e,n,r))).next(f=>(s=f,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(f=>(u=Date.now(),gx()<=Xn.DEBUG&&xr("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${a} in `+(l-o)+`ms
	Removed ${s} targets in `+(c-l)+`ms
	Removed ${f} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),Gt.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:s,documentsRemoved:f})))}}function t1e(t,e){return new e1e(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r1e{constructor(e,r){this.db=e,this.garbageCollector=t1e(this,r)}Yn(e){const r=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(n=>r.next(a=>n+a))}er(e){let r=0;return this.Zn(e,n=>{r++}).next(()=>r)}forEachTarget(e,r){return this.db.getTargetCache().forEachTarget(e,r)}Zn(e,r){return this.tr(e,(n,a)=>r(a))}addReference(e,r,n){return zN(e,n)}removeReference(e,r,n){return zN(e,n)}removeTargets(e,r,n){return this.db.getTargetCache().removeTargets(e,r,n)}markPotentiallyOrphaned(e,r){return zN(e,r)}nr(e,r){return function(a,s){let o=!1;return bZ(a).Y(l=>yZ(a,l,s).next(c=>(c&&(o=!0),Gt.resolve(!c)))).next(()=>o)}(e,r)}removeOrphanedDocuments(e,r){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let s=0;return this.tr(e,(o,l)=>{if(l<=r){const c=this.nr(e,o).next(u=>{if(!u)return s++,n.getEntry(e,o).next(()=>(n.removeEntry(o,tn.min()),C0(e).delete(function(f){return[0,uc(f.path)]}(o))))});a.push(c)}}).next(()=>Gt.waitFor(a)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,r){return zN(e,r)}tr(e,r){const n=C0(e);let a,s=rd.oe;return n.J({index:"documentTargetsIndex"},([o,l],{path:c,sequenceNumber:u})=>{o===0?(s!==rd.oe&&r(new Pr(Ff(a)),s),s=u,a=c):s=rd.oe}).next(()=>{s!==rd.oe&&r(new Pr(Ff(a)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function zN(t,e){return C0(t).put(function(n,a){return{targetId:0,path:uc(n.path),sequenceNumber:a}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wZ{constructor(){this.changes=new _m(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Es.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Gt.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n1e{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,r,n){return Lm(e).put(n)}removeEntry(e,r,n){return Lm(e).delete(function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],JE(o),l[l.length-1]]}(r,n))}updateMetadata(e,r){return this.getMetadata(e).next(n=>(n.byteSize+=r,this.rr(e,n)))}getEntry(e,r){let n=Es.newInvalidDocument(r);return Lm(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(J1(r))},(a,s)=>{n=this.ir(r,s)}).next(()=>n)}sr(e,r){let n={size:0,document:Es.newInvalidDocument(r)};return Lm(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(J1(r))},(a,s)=>{n={document:this.ir(r,s),size:eS(s)}}).next(()=>n)}getEntries(e,r){let n=fu();return this._r(e,r,(a,s)=>{const o=this.ir(a,s);n=n.insert(a,o)}).next(()=>n)}ar(e,r){let n=fu(),a=new Ts(Pr.comparator);return this._r(e,r,(s,o)=>{const l=this.ir(s,o);n=n.insert(s,l),a=a.insert(s,eS(o))}).next(()=>({documents:n,ur:a}))}_r(e,r,n){if(r.isEmpty())return Gt.resolve();let a=new Ka(H7);r.forEach(c=>a=a.add(c));const s=IDBKeyRange.bound(J1(a.first()),J1(a.last())),o=a.getIterator();let l=o.getNext();return Lm(e).J({index:"documentKeyIndex",range:s},(c,u,d)=>{const f=Pr.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;l&&H7(l,f)<0;)n(l,null),l=o.getNext();l&&l.isEqual(f)&&(n(l,u),l=o.hasNext()?o.getNext():null),l?d.$(J1(l)):d.done()}).next(()=>{for(;l;)n(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,r,n,a,s){const o=r.path,l=[o.popLast().toArray(),o.lastSegment(),JE(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Lm(e).U(IDBKeyRange.bound(l,c,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let d=fu();for(const f of u){const A=this.ir(Pr.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);A.isFoundDocument()&&(xw(r,A)||a.has(A.key))&&(d=d.insert(A.key,A))}return d})}getAllFromCollectionGroup(e,r,n,a){let s=fu();const o=V7(r,n),l=V7(r,vu.max());return Lm(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,l,!0)},(c,u,d)=>{const f=this.ir(Pr.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(f.key,f),s.size===a&&d.done()}).next(()=>s)}newChangeBuffer(e){return new a1e(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(r=>r.byteSize)}getMetadata(e){return Q7(e).get("remoteDocumentGlobalKey").next(r=>(Wr(!!r),r))}rr(e,r){return Q7(e).put("remoteDocumentGlobalKey",r)}ir(e,r){if(r){const n=Qve(this.serializer,r);if(!(n.isNoDocument()&&n.version.isEqual(tn.min())))return n}return Es.newInvalidDocument(e)}}function NZ(t){return new n1e(t)}class a1e extends wZ{constructor(e,r){super(),this.cr=e,this.trackRemovals=r,this.lr=new _m(n=>n.toString(),(n,a)=>n.isEqual(a))}applyChanges(e){const r=[];let n=0,a=new Ka((s,o)=>En(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const l=this.lr.get(s);if(r.push(this.cr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const c=S7(this.cr.serializer,o);a=a.add(s.path.popLast());const u=eS(c);n+=u-l.size,r.push(this.cr.addEntry(e,s,c))}else if(n-=l.size,this.trackRemovals){const c=S7(this.cr.serializer,o.convertToNoDocument(tn.min()));r.push(this.cr.addEntry(e,s,c))}}),a.forEach(s=>{r.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),r.push(this.cr.updateMetadata(e,n)),Gt.waitFor(r)}getFromCache(e,r){return this.cr.sr(e,r).next(n=>(this.lr.set(r,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,r){return this.cr.ar(e,r).next(({documents:n,ur:a})=>(a.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:n.get(s).readTime})}),n))}}function Q7(t){return po(t,"remoteDocumentGlobal")}function Lm(t){return po(t,"remoteDocumentsV14")}function J1(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function V7(t,e){const r=e.documentKey.path.toArray();return[t,JE(e.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function H7(t,e){const r=t.path.toArray(),n=e.path.toArray();let a=0;for(let s=0;s<r.length-2&&s<n.length-2;++s)if(a=En(r[s],n[s]),a)return a;return a=En(r.length,n.length),a||(a=En(r[r.length-2],n[n.length-2]),a||En(r[r.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1e{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CZ{constructor(e,r,n,a){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(a=>(n=a,this.remoteDocumentCache.getEntry(e,r))).next(a=>(n!==null&&cb(n.mutation,a,kc.empty(),dr.now()),a))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Mn()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Mn()){const a=Of();return this.populateOverlays(e,a,r).next(()=>this.computeViews(e,r,a,n).next(s=>{let o=Py();return s.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,r){const n=Of();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Mn()))}populateOverlays(e,r,n){const a=[];return n.forEach(s=>{r.has(s)||a.push(s)}),this.documentOverlayCache.getOverlays(e,a).next(s=>{s.forEach((o,l)=>{r.set(o,l)})})}computeViews(e,r,n,a){let s=fu();const o=lb(),l=function(){return lb()}();return r.forEach((c,u)=>{const d=n.get(u.key);a.has(u.key)&&(d===void 0||d.mutation instanceof bA)?s=s.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),cb(d.mutation,u,d.mutation.getFieldMask(),dr.now())):o.set(u.key,kc.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,d)=>o.set(u,d)),r.forEach((u,d)=>{var f;return l.set(u,new s1e(d,(f=o.get(u))!==null&&f!==void 0?f:null))}),l))}recalculateAndSaveOverlays(e,r){const n=lb();let a=new Ts((o,l)=>o-l),s=Mn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=r.get(c);if(u===null)return;let d=n.get(c)||kc.empty();d=l.applyToLocalView(u,d),n.set(c,d);const f=(a.get(l.batchId)||Mn()).add(c);a=a.insert(l.batchId,f)})}).next(()=>{const o=[],l=a.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,f=$J();d.forEach(A=>{if(!s.has(A)){const h=YJ(r.get(A),n.get(A));h!==null&&f.set(A,h),s=s.add(A)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return Gt.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,a){return function(o){return Pr.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):LJ(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,a):this.getDocumentsMatchingCollectionQuery(e,r,n,a)}getNextDocuments(e,r,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,a).next(s=>{const o=a-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,a-s.size):Gt.resolve(Of());let l=-1,c=s;return o.next(u=>Gt.forEach(u,(d,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),s.get(d)?Gt.resolve():this.remoteDocumentCache.getEntry(e,d).next(A=>{c=c.insert(d,A)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,Mn())).next(d=>({batchId:l,changes:HJ(d)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Pr(r)).next(n=>{let a=Py();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a})}getDocumentsMatchingCollectionGroupQuery(e,r,n,a){const s=r.collectionGroup;let o=Py();return this.indexManager.getCollectionParents(e,s).next(l=>Gt.forEach(l,c=>{const u=function(f,A){return new e1(A,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(r,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,n,a).next(d=>{d.forEach((f,A)=>{o=o.insert(f,A)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,r,n,a){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,a))).next(o=>{s.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,Es.newInvalidDocument(d)))});let l=Py();return o.forEach((c,u)=>{const d=s.get(c);d!==void 0&&cb(d.mutation,u,kc.empty(),dr.now()),xw(r,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1e{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Gt.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(a){return{id:a.id,version:a.version,createTime:Mo(a.createTime)}}(r)),Gt.resolve()}getNamedQuery(e,r){return Gt.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(a){return{name:a.name,query:pZ(a.bundledQuery),readTime:Mo(a.readTime)}}(r)),Gt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1e{constructor(){this.overlays=new Ts(Pr.comparator),this.Ir=new Map}getOverlay(e,r){return Gt.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Of();return Gt.forEach(r,a=>this.getOverlay(e,a).next(s=>{s!==null&&n.set(a,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((a,s)=>{this.ht(e,r,s)}),Gt.resolve()}removeOverlaysForBatchId(e,r,n){const a=this.Ir.get(n);return a!==void 0&&(a.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),Gt.resolve()}getOverlaysForCollection(e,r,n){const a=Of(),s=r.length+1,o=new Pr(r.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>n&&a.set(c.getKey(),c)}return Gt.resolve(a)}getOverlaysForCollectionGroup(e,r,n,a){let s=new Ts((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let d=s.get(u.largestBatchId);d===null&&(d=Of(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=Of(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=a)););return Gt.resolve(l)}ht(e,r,n){const a=this.overlays.get(n.key);if(a!==null){const o=this.Ir.get(a.largestBatchId).delete(n.key);this.Ir.set(a.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new RD(r,n));let s=this.Ir.get(r);s===void 0&&(s=Mn(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1e{constructor(){this.sessionToken=Ti.EMPTY_BYTE_STRING}getSessionToken(e){return Gt.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Gt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(){this.Tr=new Ka(jo.Er),this.dr=new Ka(jo.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new jo(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new jo(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new Pr(new fa([])),n=new jo(r,e),a=new jo(r,e+1),s=[];return this.dr.forEachInRange([n,a],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new Pr(new fa([])),n=new jo(r,e),a=new jo(r,e+1);let s=Mn();return this.dr.forEachInRange([n,a],o=>{s=s.add(o.key)}),s}containsKey(e){const r=new jo(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class jo{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return Pr.comparator(e.key,r.key)||En(e.wr,r.wr)}static Ar(e,r){return En(e.wr,r.wr)||Pr.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1e{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Ka(jo.Er)}checkEmpty(e){return Gt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,a){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new OD(s,r,n,a);this.mutationQueue.push(o);for(const l of a)this.br=this.br.add(new jo(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Gt.resolve(o)}lookupMutationBatch(e,r){return Gt.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=this.vr(n),s=a<0?0:a;return Gt.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Gt.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Gt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new jo(r,0),a=new jo(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,a],o=>{const l=this.Dr(o.wr);s.push(l)}),Gt.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Ka(En);return r.forEach(a=>{const s=new jo(a,0),o=new jo(a,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],l=>{n=n.add(l.wr)})}),Gt.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1;let s=n;Pr.isDocumentKey(s)||(s=s.child(""));const o=new jo(new Pr(s),0);let l=new Ka(En);return this.br.forEachWhile(c=>{const u=c.key.path;return!!n.isPrefixOf(u)&&(u.length===a&&(l=l.add(c.wr)),!0)},o),Gt.resolve(this.Cr(l))}Cr(e){const r=[];return e.forEach(n=>{const a=this.Dr(n);a!==null&&r.push(a)}),r}removeMutationBatch(e,r){Wr(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Gt.forEach(r.mutations,a=>{const s=new jo(a.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new jo(r,0),a=this.br.firstAfterOrEqual(n);return Gt.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,Gt.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1e{constructor(e){this.Mr=e,this.docs=function(){return new Ts(Pr.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,a=this.docs.get(n),s=a?a.size:0,o=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Gt.resolve(n?n.document.mutableCopy():Es.newInvalidDocument(r))}getEntries(e,r){let n=fu();return r.forEach(a=>{const s=this.docs.get(a);n=n.insert(a,s?s.document.mutableCopy():Es.newInvalidDocument(a))}),Gt.resolve(n)}getDocumentsMatchingQuery(e,r,n,a){let s=fu();const o=r.path,l=new Pr(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||SD(vJ(d),n)<=0||(a.has(d.key)||xw(r,d))&&(s=s.insert(d.key,d.mutableCopy()))}return Gt.resolve(s)}getAllFromCollectionGroup(e,r,n,a){Hr()}Or(e,r){return Gt.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new d1e(this)}getSize(e){return Gt.resolve(this.size)}}class d1e extends wZ{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,a)=>{a.isValidDocument()?r.push(this.cr.addEntry(e,a)):this.cr.removeEntry(n)}),Gt.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f1e{constructor(e){this.persistence=e,this.Nr=new _m(r=>Wp(r),pw),this.lastRemoteSnapshotVersion=tn.min(),this.highestTargetId=0,this.Lr=0,this.Br=new VD,this.targetCount=0,this.kr=Zp.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,a)=>r(a)),Gt.resolve()}getLastRemoteSnapshotVersion(e){return Gt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Gt.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Gt.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Gt.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new Zp(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Gt.resolve()}updateTargetData(e,r){return this.Kn(r),Gt.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Gt.resolve()}removeTargets(e,r,n){let a=0;const s=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),a++)}),Gt.waitFor(s).next(()=>a)}getTargetCount(e){return Gt.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Gt.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Gt.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const a=this.persistence.referenceDelegate,s=[];return a&&r.forEach(o=>{s.push(a.markPotentiallyOrphaned(e,o))}),Gt.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Gt.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Gt.resolve(n)}containsKey(e,r){return Gt.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _Z{constructor(e,r){this.qr={},this.overlays={},this.Qr=new rd(0),this.Kr=!1,this.Kr=!0,this.$r=new l1e,this.referenceDelegate=e(this),this.Ur=new f1e(this),this.indexManager=new Wve,this.remoteDocumentCache=function(a){return new u1e(a)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new AZ(r),this.Gr=new i1e(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new o1e,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new c1e(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){xr("MemoryPersistence","Starting transaction:",e);const a=new h1e(this.Qr.next());return this.referenceDelegate.zr(),n(a).next(s=>this.referenceDelegate.jr(a).next(()=>s)).toPromise().then(s=>(a.raiseOnCommittedEvent(),s))}Hr(e,r){return Gt.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class h1e extends bJ{constructor(e){super(),this.currentSequenceNumber=e}}class gj{constructor(e){this.persistence=e,this.Jr=new VD,this.Yr=null}static Zr(e){return new gj(e)}get Xr(){if(this.Yr)return this.Yr;throw Hr()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Gt.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Gt.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Gt.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(a=>this.Xr.add(a.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(a=>{a.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Gt.forEach(this.Xr,n=>{const a=Pr.fromPath(n);return this.ei(e,a).next(s=>{s||r.removeEntry(a,tn.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Gt.or([()=>Gt.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1e{constructor(e){this.serializer=e}O(e,r,n,a){const s=new cj("createOrUpgrade",r);n<1&&a>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",n7,{unique:!0}),c.createObjectStore("documentMutations")}(e),$7(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=Gt.resolve();return n<3&&a>=3&&(n!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),$7(e)),o=o.next(()=>function(c){const u=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:tn.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",d)}(s))),n<4&&a>=4&&(n!==0&&(o=o.next(()=>function(c,u){return u.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",n7,{unique:!0});const f=u.store("mutations"),A=d.map(h=>f.put(h));return Gt.waitFor(A)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),n<5&&a>=5&&(o=o.next(()=>this.ni(s))),n<6&&a>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),n<7&&a>=7&&(o=o.next(()=>this.ii(s))),n<8&&a>=8&&(o=o.next(()=>this.si(e,s))),n<9&&a>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&a>=10&&(o=o.next(()=>this.oi(s))),n<11&&a>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&a>=12&&(o=o.next(()=>{(function(c){const u=c.createObjectStore("documentOverlays",{keyPath:Hxe});u.createIndex("collectionPathOverlayIndex",$xe,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",Gxe,{unique:!1})})(e)})),n<13&&a>=13&&(o=o.next(()=>function(c){const u=c.createObjectStore("remoteDocumentsV14",{keyPath:Txe});u.createIndex("documentKeyIndex",kxe),u.createIndex("collectionGroupIndex",Fxe)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&a>=14&&(o=o.next(()=>this.ai(e,s))),n<15&&a>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:Lxe}).createIndex("sequenceNumberIndex",Uxe,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:Qxe}).createIndex("documentKeyIndex",Vxe,{unique:!1})}(e))),n<16&&a>=16&&(o=o.next(()=>{r.objectStore("indexState").clear()}).next(()=>{r.objectStore("indexEntries").clear()})),n<17&&a>=17&&(o=o.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let r=0;return e.store("remoteDocuments").J((n,a)=>{r+=eS(a)}).next(()=>{const n={byteSize:r};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}ni(e){const r=e.store("mutationQueues"),n=e.store("mutations");return r.U().next(a=>Gt.forEach(a,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",o).next(l=>Gt.forEach(l,c=>{Wr(c.userId===s.userId);const u=sp(this.serializer,c);return vZ(e,s.userId,u).next(()=>{})}))}))}ii(e){const r=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(a=>{const s=[];return n.J((o,l)=>{const c=new fa(o),u=function(f){return[0,uc(f)]}(c);s.push(r.get(u).next(d=>d?Gt.resolve():(f=>r.put({targetId:0,path:uc(f),sequenceNumber:a.highestListenSequenceNumber}))(c)))}).next(()=>Gt.waitFor(s))})}si(e,r){e.createObjectStore("collectionParents",{keyPath:Mxe});const n=r.store("collectionParents"),a=new QD,s=o=>{if(a.add(o)){const l=o.lastSegment(),c=o.popLast();return n.put({collectionId:l,parent:uc(c)})}};return r.store("remoteDocuments").J({H:!0},(o,l)=>{const c=new fa(o);return s(c.popLast())}).next(()=>r.store("documentMutations").J({H:!0},([o,l,c],u)=>{const d=Ff(l);return s(d.popLast())}))}oi(e){const r=e.store("targets");return r.J((n,a)=>{const s=Ty(a),o=mZ(this.serializer,s);return r.put(o)})}_i(e,r){const n=r.store("remoteDocuments"),a=[];return n.J((s,o)=>{const l=r.store("remoteDocumentsV14"),c=function(f){return f.document?new Pr(fa.fromString(f.document.name).popFirst(5)):f.noDocument?Pr.fromSegments(f.noDocument.path):f.unknownDocument?Pr.fromSegments(f.unknownDocument.path):Hr()}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};a.push(l.put(u))}).next(()=>Gt.waitFor(a))}ai(e,r){const n=r.store("mutations"),a=NZ(this.serializer),s=new _Z(gj.Zr,this.serializer.ct);return n.U().next(o=>{const l=new Map;return o.forEach(c=>{var u;let d=(u=l.get(c.userId))!==null&&u!==void 0?u:Mn();sp(this.serializer,c).keys().forEach(f=>d=d.add(f)),l.set(c.userId,d)}),Gt.forEach(l,(c,u)=>{const d=new al(u),f=mj.lt(this.serializer,d),A=s.getIndexManager(d),h=pj.lt(d,this.serializer,A,s.referenceDelegate);return new CZ(a,h,f,A).recalculateAndSaveOverlaysForDocumentKeys(new PT(r,rd.oe),c).next()})})}}function $7(t){t.createObjectStore("targetDocuments",{keyPath:Dxe}).createIndex("documentTargetsIndex",Rxe,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Oxe,{unique:!0}),t.createObjectStore("targetGlobal")}const h3="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class HD{constructor(e,r,n,a,s,o,l,c,u,d,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=r,this.clientId=n,this.ui=s,this.window=o,this.document=l,this.ci=u,this.li=d,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=A=>Promise.resolve(),!HD.D())throw new Cr(nr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new r1e(this,a),this.Ai=r+"main",this.serializer=new AZ(c),this.Ri=new W0(this.Ai,this.hi,new A1e(this.serializer)),this.$r=new Hve,this.Ur=new Yve(this.referenceDelegate,this.serializer),this.remoteDocumentCache=NZ(this.serializer),this.Gr=new Vve,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&oc("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Cr(nr.FAILED_PRECONDITION,h3);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new rd(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async r=>{if(this.started)return e(r)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async r=>{r.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>WN(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(r=>{r||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(r=>this.isPrimary&&!r?this.bi(e).next(()=>!1):!!r&&this.Di(e).next(()=>!0))).catch(e=>{if(Cm(e))return xr("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return xr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Z1(e).get("owner").next(r=>Gt.resolve(this.vi(r)))}Ci(e){return WN(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const n=po(r,"clientMetadata");return n.U().next(a=>{const s=this.xi(a,18e5),o=a.filter(l=>s.indexOf(l)===-1);return Gt.forEach(o,l=>n.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const r of e)this.Vi.removeItem(this.Oi(r.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?Gt.resolve(!0):Z1(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)){if(this.vi(r)&&this.networkEnabled)return!0;if(!this.vi(r)){if(!r.allowTabSynchronization)throw new Cr(nr.FAILED_PRECONDITION,h3);return!1}}return!(!this.networkEnabled||!this.inForeground)||WN(e).U().next(n=>this.xi(n,5e3).find(a=>{if(this.clientId!==a.clientId){const s=!this.networkEnabled&&a.networkEnabled,o=!this.inForeground&&a.inForeground,l=this.networkEnabled===a.networkEnabled;if(s||o&&l)return!0}return!1})===void 0)}).next(r=>(this.isPrimary!==r&&xr("IndexedDbPersistence",`Client ${r?"is":"is not"} eligible for a primary lease.`),r))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const r=new PT(e,rd.oe);return this.bi(r).next(()=>this.Ci(r))}),this.Ri.close(),this.qi()}xi(e,r){return e.filter(n=>this.Mi(n.updateTimeMs,r)&&!this.Ni(n.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>WN(e).U().next(r=>this.xi(r,18e5).map(n=>n.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,r){return pj.lt(e,this.serializer,r,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Xve(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return mj.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,r,n){xr("IndexedDbPersistence","Starting transaction:",e);const a=r==="readonly"?"readonly":"readwrite",s=function(c){return c===17?zxe:c===16?qxe:c===15?jD:c===14?EJ:c===13?_J:c===12?Kxe:c===11?CJ:void Hr()}(this.hi);let o;return this.Ri.runTransaction(e,a,s,l=>(o=new PT(l,this.Qr?this.Qr.next():rd.oe),r==="readwrite-primary"?this.wi(o).next(c=>!!c||this.Si(o)).next(c=>{if(!c)throw oc(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new Cr(nr.FAILED_PRECONDITION,yJ);return n(o)}).next(c=>this.Di(o).next(()=>c)):this.Ki(o).next(()=>n(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Ki(e){return Z1(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)&&!this.vi(r)&&!(this.li||this.allowTabSynchronization&&r.allowTabSynchronization))throw new Cr(nr.FAILED_PRECONDITION,h3)})}Di(e){const r={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Z1(e).put("owner",r)}static D(){return W0.D()}bi(e){const r=Z1(e);return r.get("owner").next(n=>this.vi(n)?(xr("IndexedDbPersistence","Releasing primary lease."),r.delete("owner")):Gt.resolve())}Mi(e,r){const n=Date.now();return!(e<n-r)&&(!(e>n)||(oc(`Detected an update time that is in the future: ${e} > ${n}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const r=/(?:Version|Mobile)\/1[456]/;CY()&&(navigator.appVersion.match(r)||navigator.userAgent.match(r))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var r;try{const n=((r=this.Vi)===null||r===void 0?void 0:r.getItem(this.Oi(e)))!==null;return xr("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return oc("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){oc("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Z1(t){return po(t,"owner")}function WN(t){return po(t,"clientMetadata")}function m1e(t,e){let r=t.projectId;return t.isDefaultDatabase||(r+="."+t.database),"firestore/"+e+"/"+r+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $D{constructor(e,r,n,a){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=a}static Wi(e,r){let n=Mn(),a=Mn();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}return new $D(e,r.fromCache,n,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1e{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EZ{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return CY()?8:wJ(Ao())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,a){const s={result:null};return this.Yi(e,r).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,r,a,n).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new p1e;return this.Xi(e,r,o).next(l=>{if(s.result=l,this.zi)return this.es(e,r,o,l.size)})}).next(()=>s.result)}es(e,r,n,a){return n.documentReadCount<this.ji?(gx()<=Xn.DEBUG&&xr("QueryEngine","SDK will not create cache indexes for query:",xx(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Gt.resolve()):(gx()<=Xn.DEBUG&&xr("QueryEngine","Query:",xx(r),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.Hi*a?(gx()<=Xn.DEBUG&&xr("QueryEngine","The SDK decides to create cache indexes for query:",xx(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ld(r))):Gt.resolve())}Yi(e,r){if(p7(r))return Gt.resolve(null);let n=ld(r);return this.indexManager.getIndexType(e,n).next(a=>a===0?null:(r.limit!==null&&a===1&&(r=YE(r,null,"F"),n=ld(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=Mn(...s);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(c=>{const u=this.ts(r,l);return this.ns(r,u,o,c.readTime)?this.Yi(e,YE(r,null,"F")):this.rs(e,u,r,c)}))})))}Zi(e,r,n,a){return p7(r)||a.isEqual(tn.min())?Gt.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const o=this.ts(r,s);return this.ns(r,o,n,a)?Gt.resolve(null):(gx()<=Xn.DEBUG&&xr("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),xx(r)),this.rs(e,o,r,Cxe(a,-1)).next(l=>l))})}ts(e,r){let n=new Ka(QJ(e));return r.forEach((a,s)=>{xw(e,s)&&(n=n.add(s))}),n}ns(e,r,n,a){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(a)>0)}Xi(e,r,n){return gx()<=Xn.DEBUG&&xr("QueryEngine","Using full collection scan to execute query:",xx(r)),this.Ji.getDocumentsMatchingQuery(e,r,vu.min(),n)}rs(e,r,n,a){return this.Ji.getDocumentsMatchingQuery(e,n,a).next(s=>(r.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g1e{constructor(e,r,n,a){this.persistence=e,this.ss=r,this.serializer=a,this.os=new Ts(En),this._s=new _m(s=>Wp(s),pw),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new CZ(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function SZ(t,e,r,n){return new g1e(t,e,r,n)}async function IZ(t,e){const r=xn(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let a;return r.mutationQueue.getAllMutationBatches(n).next(s=>(a=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],l=[];let c=Mn();for(const u of a){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of s){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return r.localDocuments.getDocuments(n,c).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:l}))})})}function x1e(t,e){const r=xn(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const a=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const f=u.batch,A=f.keys();let h=Gt.resolve();return A.forEach(m=>{h=h.next(()=>d.getEntry(c,m)).next(p=>{const g=u.docVersions.get(m);Wr(g!==null),p.version.compareTo(g)<0&&(f.applyToRemoteDocument(p,u),p.isValidDocument()&&(p.setReadTime(u.commitVersion),d.addEntry(p)))})}),h.next(()=>l.mutationQueue.removeMutationBatch(c,f))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let c=Mn();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,a))})}function jZ(t){const e=xn(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function v1e(t,e){const r=xn(t),n=e.snapshotVersion;let a=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=r.cs.newChangeBuffer({trackRemovals:!0});a=r.os;const l=[];e.targetChanges.forEach((d,f)=>{const A=a.get(f);if(!A)return;l.push(r.Ur.removeMatchingKeys(s,d.removedDocuments,f).next(()=>r.Ur.addMatchingKeys(s,d.addedDocuments,f)));let h=A.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?h=h.withResumeToken(Ti.EMPTY_BYTE_STRING,tn.min()).withLastLimboFreeSnapshotVersion(tn.min()):d.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(d.resumeToken,n)),a=a.insert(f,h),function(p,g,v){return p.resumeToken.approximateByteSize()===0||g.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(A,h,d)&&l.push(r.Ur.updateTargetData(s,h))});let c=fu(),u=Mn();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(s,d))}),l.push(y1e(s,o,e.documentUpdates).next(d=>{c=d.Ps,u=d.Is})),!n.isEqual(tn.min())){const d=r.Ur.getLastRemoteSnapshotVersion(s).next(f=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));l.push(d)}return Gt.waitFor(l).next(()=>o.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(r.os=a,s))}function y1e(t,e,r){let n=Mn(),a=Mn();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let o=fu();return r.forEach((l,c)=>{const u=s.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(a=a.add(l)),c.isNoDocument()&&c.version.isEqual(tn.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):xr("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ps:o,Is:a}})}function b1e(t,e){const r=xn(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function w1e(t,e){const r=xn(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let a;return r.Ur.getTargetData(n,e).next(s=>s?(a=s,Gt.resolve(a)):r.Ur.allocateTargetId(n).next(o=>(a=new Oh(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,a).next(()=>a))))}).then(n=>{const a=r.os.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function $T(t,e,r){const n=xn(t),a=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,a))}catch(o){if(!Cm(o))throw o;xr("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.os=n.os.remove(e),n._s.delete(a.target)}function G7(t,e,r){const n=xn(t);let a=tn.min(),s=Mn();return n.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const f=xn(c),A=f._s.get(d);return A!==void 0?Gt.resolve(f.os.get(A)):f.Ur.getTargetData(u,d)}(n,o,ld(e)).next(l=>{if(l)return a=l.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{s=c})}).next(()=>n.ss.getDocumentsMatchingQuery(o,e,r?a:tn.min(),r?s:Mn())).next(l=>(N1e(n,cve(e),l),{documents:l,Ts:s})))}function N1e(t,e,r){let n=t.us.get(e)||tn.min();r.forEach((a,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class K7{constructor(){this.activeTargetIds=mve()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class PZ{constructor(){this.so=new K7,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new K7,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C1e{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q7{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){xr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){xr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let XN=null;function A3(){return XN===null?XN=function(){return 268435456+Math.round(2147483648*Math.random())}():XN++,"0x"+XN.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _1e={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1e{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vl="WebChannelConnection";class S1e extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${a}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${a}`:`project_id=${a}&database_id=${s}`}get Fo(){return!1}Mo(r,n,a,s,o){const l=A3(),c=this.xo(r,n.toUriEncodedString());xr("RestConnection",`Sending RPC '${r}' ${l}:`,c,a);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,o),this.No(r,c,u,a).then(d=>(xr("RestConnection",`Received RPC '${r}' ${l}: `,d),d),d=>{throw am("RestConnection",`RPC '${r}' ${l} failed with error: `,d,"url: ",c,"request:",a),d})}Lo(r,n,a,s,o,l){return this.Mo(r,n,a,s,o)}Oo(r,n,a){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Zv}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,o)=>r[o]=s),a&&a.headers.forEach((s,o)=>r[o]=s)}xo(r,n){const a=_1e[r];return`${this.Do}/v1/${n}:${a}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,a){const s=A3();return new Promise((o,l)=>{const c=new dJ;c.setWithCredentials(!0),c.listenOnce(fJ.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case K_.NO_ERROR:const d=c.getResponseJson();xr(vl,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case K_.TIMEOUT:xr(vl,`RPC '${e}' ${s} timed out`),l(new Cr(nr.DEADLINE_EXCEEDED,"Request time out"));break;case K_.HTTP_ERROR:const f=c.getStatus();if(xr(vl,`RPC '${e}' ${s} failed with status:`,f,"response text:",c.getResponseText()),f>0){let A=c.getResponseJson();Array.isArray(A)&&(A=A[0]);const h=A==null?void 0:A.error;if(h&&h.status&&h.message){const m=function(g){const v=g.toLowerCase().replace(/_/g,"-");return Object.values(nr).indexOf(v)>=0?v:nr.UNKNOWN}(h.status);l(new Cr(m,h.message))}else l(new Cr(nr.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Cr(nr.UNAVAILABLE,"Connection failed."));break;default:Hr()}}finally{xr(vl,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(a);xr(vl,`RPC '${e}' ${s} sending request:`,a),c.send(r,"POST",u,n,15)})}Bo(e,r,n){const a=A3(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=mJ(),l=AJ(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const d=s.join("");xr(vl,`Creating RPC '${e}' stream ${a}: ${d}`,c);const f=o.createWebChannel(d,c);let A=!1,h=!1;const m=new E1e({Io:g=>{h?xr(vl,`Not sending because RPC '${e}' stream ${a} is closed:`,g):(A||(xr(vl,`Opening RPC '${e}' stream ${a} transport.`),f.open(),A=!0),xr(vl,`RPC '${e}' stream ${a} sending:`,g),f.send(g))},To:()=>f.close()}),p=(g,v,y)=>{g.listen(v,b=>{try{y(b)}catch(w){setTimeout(()=>{throw w},0)}})};return p(f,jy.EventType.OPEN,()=>{h||(xr(vl,`RPC '${e}' stream ${a} transport opened.`),m.yo())}),p(f,jy.EventType.CLOSE,()=>{h||(h=!0,xr(vl,`RPC '${e}' stream ${a} transport closed`),m.So())}),p(f,jy.EventType.ERROR,g=>{h||(h=!0,am(vl,`RPC '${e}' stream ${a} transport errored:`,g),m.So(new Cr(nr.UNAVAILABLE,"The operation could not be completed")))}),p(f,jy.EventType.MESSAGE,g=>{var v;if(!h){const y=g.data[0];Wr(!!y);const b=y,w=b.error||((v=b[0])===null||v===void 0?void 0:v.error);if(w){xr(vl,`RPC '${e}' stream ${a} received error:`,w);const j=w.status;let I=function(E){const F=Di[E];if(F!==void 0)return eZ(F)}(j),_=w.message;I===void 0&&(I=nr.INTERNAL,_="Unknown error status: "+j+" with message "+w.message),h=!0,m.So(new Cr(I,_)),f.close()}else xr(vl,`RPC '${e}' stream ${a} received:`,y),m.bo(y)}}),p(l,hJ.STAT_EVENT,g=>{g.stat===IT.PROXY?xr(vl,`RPC '${e}' stream ${a} detected buffering proxy`):g.stat===IT.NOPROXY&&xr(vl,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{m.wo()},0),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I1e(){return typeof window<"u"?window:null}function Z_(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xj(t){return new Pve(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(e,r,n=1e3,a=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=a,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),a=Math.max(0,r-n);a>0&&xr("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,a,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BZ{constructor(e,r,n,a,s,o,l,c){this.ui=e,this.Ho=n,this.Jo=a,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new GD(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===nr.RESOURCE_EXHAUSTED?(oc(r.toString()),oc("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===nr.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,a])=>{this.Yo===r&&this.P_(n,a)},n=>{e(()=>{const a=new Cr(nr.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(a)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(a=>{n(()=>this.I_(a))}),this.stream.onMessage(a=>{n(()=>++this.e_==1?this.E_(a):this.onNext(a))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return xr("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(xr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class j1e extends BZ{constructor(e,r,n,a,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,a,o),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=Fve(this.serializer,e),n=function(s){if(!("targetChange"in s))return tn.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?tn.min():o.readTime?Mo(o.readTime):tn.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=LT(this.serializer),r.addTarget=function(s,o){let l;const c=o.target;if(l=WE(c)?{documents:lZ(s,c)}:{query:cZ(s,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=nZ(s,o.resumeToken);const u=RT(s,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(tn.min())>0){l.readTime=Iv(s,o.snapshotVersion.toTimestamp());const u=RT(s,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const n=Dve(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=LT(this.serializer),r.removeTarget=e,this.a_(r)}}class P1e extends BZ{constructor(e,r,n,a,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,a,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return Wr(!!e.streamToken),this.lastStreamToken=e.streamToken,Wr(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Wr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=Ove(e.writeResults,e.commitTime),n=Mo(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=LT(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>h2(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B1e extends class{}{constructor(e,r,n,a){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=a,this.y_=!1}w_(){if(this.y_)throw new Cr(nr.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,MT(r,n),a,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===nr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Cr(nr.UNKNOWN,s.toString())})}Lo(e,r,n,a,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,MT(r,n),a,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===nr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Cr(nr.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class T1e{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(oc(r),this.D_=!1):xr("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1e{constructor(e,r,n,a,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{n.enqueueAndForget(async()=>{bg(this)&&(xr("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=xn(c);u.L_.add(4),await yw(u),u.q_.set("Unknown"),u.L_.delete(4),await vj(u)}(this))})}),this.q_=new T1e(n,a)}}async function vj(t){if(bg(t))for(const e of t.B_)await e(!0)}async function yw(t){for(const e of t.B_)await e(!1)}function TZ(t,e){const r=xn(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),WD(r)?zD(r):n1(r).r_()&&qD(r,e))}function KD(t,e){const r=xn(t),n=n1(r);r.N_.delete(e),n.r_()&&kZ(r,e),r.N_.size===0&&(n.r_()?n.o_():bg(r)&&r.q_.set("Unknown"))}function qD(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(tn.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}n1(t).A_(e)}function kZ(t,e){t.Q_.xe(e),n1(t).R_(e)}function zD(t){t.Q_=new Eve({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),n1(t).start(),t.q_.v_()}function WD(t){return bg(t)&&!n1(t).n_()&&t.N_.size>0}function bg(t){return xn(t).L_.size===0}function FZ(t){t.Q_=void 0}async function F1e(t){t.q_.set("Online")}async function O1e(t){t.N_.forEach((e,r)=>{qD(t,e)})}async function D1e(t,e){FZ(t),WD(t)?(t.q_.M_(e),zD(t)):t.q_.set("Unknown")}async function R1e(t,e,r){if(t.q_.set("Online"),e instanceof rZ&&e.state===2&&e.cause)try{await async function(a,s){const o=s.cause;for(const l of s.targetIds)a.N_.has(l)&&(await a.remoteSyncer.rejectListen(l,o),a.N_.delete(l),a.Q_.removeTarget(l))}(t,e)}catch(n){xr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await tS(t,n)}else if(e instanceof J_?t.Q_.Ke(e):e instanceof tZ?t.Q_.He(e):t.Q_.We(e),!r.isEqual(tn.min()))try{const n=await jZ(t.localStore);r.compareTo(n)>=0&&await function(s,o){const l=s.Q_.rt(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=s.N_.get(u);d&&s.N_.set(u,d.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const d=s.N_.get(c);if(!d)return;s.N_.set(c,d.withResumeToken(Ti.EMPTY_BYTE_STRING,d.snapshotVersion)),kZ(s,c);const f=new Oh(d.target,c,u,d.sequenceNumber);qD(s,f)}),s.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(n){xr("RemoteStore","Failed to raise snapshot:",n),await tS(t,n)}}async function tS(t,e,r){if(!Cm(e))throw e;t.L_.add(1),await yw(t),t.q_.set("Offline"),r||(r=()=>jZ(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{xr("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await vj(t)})}function OZ(t,e){return e().catch(r=>tS(t,r,e))}async function bw(t){const e=xn(t),r=lm(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;M1e(e);)try{const a=await b1e(e.localStore,n);if(a===null){e.O_.length===0&&r.o_();break}n=a.batchId,L1e(e,a)}catch(a){await tS(e,a)}DZ(e)&&RZ(e)}function M1e(t){return bg(t)&&t.O_.length<10}function L1e(t,e){t.O_.push(e);const r=lm(t);r.r_()&&r.V_&&r.m_(e.mutations)}function DZ(t){return bg(t)&&!lm(t).n_()&&t.O_.length>0}function RZ(t){lm(t).start()}async function U1e(t){lm(t).p_()}async function Q1e(t){const e=lm(t);for(const r of t.O_)e.m_(r.mutations)}async function V1e(t,e,r){const n=t.O_.shift(),a=DD.from(n,e,r);await OZ(t,()=>t.remoteSyncer.applySuccessfulWrite(a)),await bw(t)}async function H1e(t,e){e&&lm(t).V_&&await async function(n,a){if(function(o){return ZJ(o)&&o!==nr.ABORTED}(a.code)){const s=n.O_.shift();lm(n).s_(),await OZ(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,a)),await bw(n)}}(t,e),DZ(t)&&RZ(t)}async function z7(t,e){const r=xn(t);r.asyncQueue.verifyOperationInProgress(),xr("RemoteStore","RemoteStore received new credentials");const n=bg(r);r.L_.add(3),await yw(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await vj(r)}async function $1e(t,e){const r=xn(t);e?(r.L_.delete(2),await vj(r)):e||(r.L_.add(2),await yw(r),r.q_.set("Unknown"))}function n1(t){return t.K_||(t.K_=function(r,n,a){const s=xn(r);return s.w_(),new j1e(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,a)}(t.datastore,t.asyncQueue,{Eo:F1e.bind(null,t),Ro:O1e.bind(null,t),mo:D1e.bind(null,t),d_:R1e.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),WD(t)?zD(t):t.q_.set("Unknown")):(await t.K_.stop(),FZ(t))})),t.K_}function lm(t){return t.U_||(t.U_=function(r,n,a){const s=xn(r);return s.w_(),new P1e(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,a)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:U1e.bind(null,t),mo:H1e.bind(null,t),f_:Q1e.bind(null,t),g_:V1e.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await bw(t)):(await t.U_.stop(),t.O_.length>0&&(xr("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(e,r,n,a,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=a,this.removalCallback=s,this.deferred=new Yd,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,a,s){const o=Date.now()+n,l=new XD(e,r,o,a,s);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Cr(nr.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function YD(t,e){if(oc("AsyncQueue",`${e}: ${t}`),Cm(t))return new Cr(nr.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e){this.comparator=e?(r,n)=>e(r,n)||Pr.comparator(r.key,n.key):(r,n)=>Pr.comparator(r.key,n.key),this.keyedMap=Py(),this.sortedSet=new Ts(this.comparator)}static emptySet(e){return new sv(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof sv)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,s=n.getNext().key;if(!a.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new sv;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W7{constructor(){this.W_=new Ts(Pr.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):Hr():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class jv{constructor(e,r,n,a,s,o,l,c,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,a,s){const o=[];return r.forEach(l=>{o.push({type:0,doc:l})}),new jv(e,r,sv.emptySet(r),o,n,a,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&dj(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==n[a].type||!r[a].doc.isEqual(n[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1e{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class K1e{constructor(){this.queries=X7(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const a=xn(r),s=a.queries;a.queries=X7(),s.forEach((o,l)=>{for(const c of l.j_)c.onError(n)})})(this,new Cr(nr.ABORTED,"Firestore shutting down"))}}function X7(){return new _m(t=>UJ(t),dj)}async function JD(t,e){const r=xn(t);let n=3;const a=e.query;let s=r.queries.get(a);s?!s.H_()&&e.J_()&&(n=2):(s=new G1e,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(a,!0);break;case 1:s.z_=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(o){const l=YD(o,`Initialization of query '${xx(e.query)}' failed`);return void e.onError(l)}r.queries.set(a,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&e6(r)}async function ZD(t,e){const r=xn(t),n=e.query;let a=3;const s=r.queries.get(n);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?a=e.J_()?0:1:!s.H_()&&e.J_()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function q1e(t,e){const r=xn(t);let n=!1;for(const a of e){const s=a.query,o=r.queries.get(s);if(o){for(const l of o.j_)l.X_(a)&&(n=!0);o.z_=a}}n&&e6(r)}function z1e(t,e,r){const n=xn(t),a=n.queries.get(e);if(a)for(const s of a.j_)s.onError(r);n.queries.delete(e)}function e6(t){t.Y_.forEach(e=>{e.next()})}var GT,Y7;(Y7=GT||(GT={})).ea="default",Y7.Cache="cache";class t6{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new jv(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=jv.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==GT.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MZ{constructor(e){this.key=e}}class LZ{constructor(e){this.key=e}}class W1e{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Mn(),this.mutatedKeys=Mn(),this.Aa=QJ(e),this.Ra=new sv(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new W7,a=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,o=a,l=!1;const c=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,u=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((d,f)=>{const A=a.get(d),h=xw(this.query,f)?f:null,m=!!A&&this.mutatedKeys.has(A.key),p=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let g=!1;A&&h?A.data.isEqual(h.data)?m!==p&&(n.track({type:3,doc:h}),g=!0):this.ga(A,h)||(n.track({type:2,doc:h}),g=!0,(c&&this.Aa(h,c)>0||u&&this.Aa(h,u)<0)&&(l=!0)):!A&&h?(n.track({type:0,doc:h}),g=!0):A&&!h&&(n.track({type:1,doc:A}),g=!0,(c||u)&&(l=!0)),g&&(h?(o=o.add(h),s=p?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),n.track({type:1,doc:d})}return{Ra:o,fa:n,ns:l,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,a){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,f)=>function(h,m){const p=g=>{switch(g){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Hr()}};return p(h)-p(m)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(n),a=a!=null&&a;const l=r&&!a?this.ya():[],c=this.da.size===0&&this.current&&!a?1:0,u=c!==this.Ea;return this.Ea=c,o.length!==0||u?{snapshot:new jv(this.query,e.Ra,s,o,e.mutatedKeys,c===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new W7,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Mn(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new LZ(n))}),this.da.forEach(n=>{e.has(n)||r.push(new MZ(n))}),r}ba(e){this.Ta=e.Ts,this.da=Mn();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return jv.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class X1e{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class Y1e{constructor(e){this.key=e,this.va=!1}}class J1e{constructor(e,r,n,a,s,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=a,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new _m(l=>UJ(l),dj),this.Ma=new Map,this.xa=new Set,this.Oa=new Ts(Pr.comparator),this.Na=new Map,this.La=new VD,this.Ba={},this.ka=new Map,this.qa=Zp.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function Z1e(t,e,r=!0){const n=GZ(t);let a;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),a=s.view.Da()):a=await UZ(n,e,r,!0),a}async function eye(t,e){const r=GZ(t);await UZ(r,e,!0,!1)}async function UZ(t,e,r,n){const a=await w1e(t.localStore,ld(e)),s=a.targetId,o=t.sharedClientState.addLocalQueryTarget(s,r);let l;return n&&(l=await tye(t,e,s,o==="current",a.resumeToken)),t.isPrimaryClient&&r&&TZ(t.remoteStore,a),l}async function tye(t,e,r,n,a){t.Ka=(f,A,h)=>async function(p,g,v,y){let b=g.view.ma(v);b.ns&&(b=await G7(p.localStore,g.query,!1).then(({documents:_})=>g.view.ma(_,b)));const w=y&&y.targetChanges.get(g.targetId),j=y&&y.targetMismatches.get(g.targetId)!=null,I=g.view.applyChanges(b,p.isPrimaryClient,w,j);return Z7(p,g.targetId,I.wa),I.snapshot}(t,f,A,h);const s=await G7(t.localStore,e,!0),o=new W1e(e,s.Ts),l=o.ma(s.documents),c=vw.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",a),u=o.applyChanges(l,t.isPrimaryClient,c);Z7(t,r,u.wa);const d=new X1e(e,r,o);return t.Fa.set(e,d),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),u.snapshot}async function rye(t,e,r){const n=xn(t),a=n.Fa.get(e),s=n.Ma.get(a.targetId);if(s.length>1)return n.Ma.set(a.targetId,s.filter(o=>!dj(o,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await $T(n.localStore,a.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(a.targetId),r&&KD(n.remoteStore,a.targetId),KT(n,a.targetId)}).catch(vg)):(KT(n,a.targetId),await $T(n.localStore,a.targetId,!0))}async function nye(t,e){const r=xn(t),n=r.Fa.get(e),a=r.Ma.get(n.targetId);r.isPrimaryClient&&a.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),KD(r.remoteStore,n.targetId))}async function aye(t,e,r){const n=KZ(t);try{const a=await function(o,l){const c=xn(o),u=dr.now(),d=l.reduce((h,m)=>h.add(m.key),Mn());let f,A;return c.persistence.runTransaction("Locally write mutations","readwrite",h=>{let m=fu(),p=Mn();return c.cs.getEntries(h,d).next(g=>{m=g,m.forEach((v,y)=>{y.isValidDocument()||(p=p.add(v))})}).next(()=>c.localDocuments.getOverlayedDocuments(h,m)).next(g=>{f=g;const v=[];for(const y of l){const b=wve(y,f.get(y.key).overlayedDocument);b!=null&&v.push(new bA(y.key,b,BJ(b.value.mapValue),Is.exists(!0)))}return c.mutationQueue.addMutationBatch(h,u,v,l)}).next(g=>{A=g;const v=g.applyToLocalDocumentSet(f,p);return c.documentOverlayCache.saveOverlays(h,g.batchId,v)})}).then(()=>({batchId:A.batchId,changes:HJ(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),function(o,l,c){let u=o.Ba[o.currentUser.toKey()];u||(u=new Ts(En)),u=u.insert(l,c),o.Ba[o.currentUser.toKey()]=u}(n,a.batchId,r),await ww(n,a.changes),await bw(n.remoteStore)}catch(a){const s=YD(a,"Failed to persist write");r.reject(s)}}async function QZ(t,e){const r=xn(t);try{const n=await v1e(r.localStore,e);e.targetChanges.forEach((a,s)=>{const o=r.Na.get(s);o&&(Wr(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1),a.addedDocuments.size>0?o.va=!0:a.modifiedDocuments.size>0?Wr(o.va):a.removedDocuments.size>0&&(Wr(o.va),o.va=!1))}),await ww(r,n,e)}catch(n){await vg(n)}}function J7(t,e,r){const n=xn(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const a=[];n.Fa.forEach((s,o)=>{const l=o.view.Z_(e);l.snapshot&&a.push(l.snapshot)}),function(o,l){const c=xn(o);c.onlineState=l;let u=!1;c.queries.forEach((d,f)=>{for(const A of f.j_)A.Z_(l)&&(u=!0)}),u&&e6(c)}(n.eventManager,e),a.length&&n.Ca.d_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function sye(t,e,r){const n=xn(t);n.sharedClientState.updateQueryState(e,"rejected",r);const a=n.Na.get(e),s=a&&a.key;if(s){let o=new Ts(Pr.comparator);o=o.insert(s,Es.newNoDocument(s,tn.min()));const l=Mn().add(s),c=new Aj(tn.min(),new Map,new Ts(En),o,l);await QZ(n,c),n.Oa=n.Oa.remove(s),n.Na.delete(e),r6(n)}else await $T(n.localStore,e,!1).then(()=>KT(n,e,r)).catch(vg)}async function iye(t,e){const r=xn(t),n=e.batch.batchId;try{const a=await x1e(r.localStore,e);HZ(r,n,null),VZ(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await ww(r,a)}catch(a){await vg(a)}}async function oye(t,e,r){const n=xn(t);try{const a=await function(o,l){const c=xn(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(f=>(Wr(f!==null),d=f.keys(),c.mutationQueue.removeMutationBatch(u,f))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(n.localStore,e);HZ(n,e,r),VZ(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await ww(n,a)}catch(a){await vg(a)}}function VZ(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function HZ(t,e,r){const n=xn(t);let a=n.Ba[n.currentUser.toKey()];if(a){const s=a.get(e);s&&(r?s.reject(r):s.resolve(),a=a.remove(e)),n.Ba[n.currentUser.toKey()]=a}}function KT(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||$Z(t,n)})}function $Z(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(KD(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),r6(t))}function Z7(t,e,r){for(const n of r)n instanceof MZ?(t.La.addReference(n.key,e),lye(t,n)):n instanceof LZ?(xr("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||$Z(t,n.key)):Hr()}function lye(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(xr("SyncEngine","New document in limbo: "+r),t.xa.add(n),r6(t))}function r6(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new Pr(fa.fromString(e)),n=t.qa.next();t.Na.set(n,new Y1e(r)),t.Oa=t.Oa.insert(r,n),TZ(t.remoteStore,new Oh(ld(gw(r.path)),n,"TargetPurposeLimboResolution",rd.oe))}}async function ww(t,e,r){const n=xn(t),a=[],s=[],o=[];n.Fa.isEmpty()||(n.Fa.forEach((l,c)=>{o.push(n.Ka(c,e,r).then(u=>{var d;if((u||r)&&n.isPrimaryClient){const f=u?!u.fromCache:(d=r==null?void 0:r.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;n.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(u){a.push(u);const f=$D.Wi(c.targetId,u);s.push(f)}}))}),await Promise.all(o),n.Ca.d_(a),await async function(c,u){const d=xn(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>Gt.forEach(u,A=>Gt.forEach(A.$i,h=>d.persistence.referenceDelegate.addReference(f,A.targetId,h)).next(()=>Gt.forEach(A.Ui,h=>d.persistence.referenceDelegate.removeReference(f,A.targetId,h)))))}catch(f){if(!Cm(f))throw f;xr("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const A=f.targetId;if(!f.fromCache){const h=d.os.get(A),m=h.snapshotVersion,p=h.withLastLimboFreeSnapshotVersion(m);d.os=d.os.insert(A,p)}}}(n.localStore,s))}async function cye(t,e){const r=xn(t);if(!r.currentUser.isEqual(e)){xr("SyncEngine","User change. New user:",e.toKey());const n=await IZ(r.localStore,e);r.currentUser=e,function(s,o){s.ka.forEach(l=>{l.forEach(c=>{c.reject(new Cr(nr.CANCELLED,o))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await ww(r,n.hs)}}function uye(t,e){const r=xn(t),n=r.Na.get(e);if(n&&n.va)return Mn().add(n.key);{let a=Mn();const s=r.Ma.get(e);if(!s)return a;for(const o of s){const l=r.Fa.get(o);a=a.unionWith(l.view.Va)}return a}}function GZ(t){const e=xn(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=QZ.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=uye.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=sye.bind(null,e),e.Ca.d_=q1e.bind(null,e.eventManager),e.Ca.$a=z1e.bind(null,e.eventManager),e}function KZ(t){const e=xn(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=iye.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=oye.bind(null,e),e}class A2{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=xj(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return SZ(this.persistence,new EZ,e.initialUser,this.serializer)}Ga(e){return new _Z(gj.Zr,this.serializer)}Wa(e){return new PZ}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}A2.provider={build:()=>new A2};class dye extends A2{constructor(e,r,n){super(),this.Ja=e,this.cacheSizeBytes=r,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await KZ(this.Ja.syncEngine),await bw(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return SZ(this.persistence,new EZ,e.initialUser,this.serializer)}ja(e,r){const n=this.persistence.referenceDelegate.garbageCollector;return new Zve(n,e.asyncQueue,r)}Ha(e,r){const n=new Ixe(r,this.persistence);return new Sxe(e.asyncQueue,n)}Ga(e){const r=m1e(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Ic.withCacheSize(this.cacheSizeBytes):Ic.DEFAULT;return new HD(this.synchronizeTabs,r,e.clientId,n,e.asyncQueue,I1e(),Z_(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new PZ}}class rS{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>J7(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=cye.bind(null,this.syncEngine),await $1e(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new K1e}()}createDatastore(e){const r=xj(e.databaseInfo.databaseId),n=function(s){return new S1e(s)}(e.databaseInfo);return function(s,o,l,c){return new B1e(s,o,l,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,a,s,o,l){return new k1e(n,a,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,r=>J7(this.syncEngine,r,0),function(){return q7.D()?new q7:new C1e}())}createSyncEngine(e,r){return function(a,s,o,l,c,u,d){const f=new J1e(a,s,o,l,c,u);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(a){const s=xn(a);xr("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await yw(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}rS.provider={build:()=>new rS};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n6{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):oc("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fye{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Cr(nr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const r=await async function(a,s){const o=xn(a),l={documents:s.map(f=>f2(o.serializer,f))},c=await o.Lo("BatchGetDocuments",o.serializer.databaseId,fa.emptyPath(),l,s.length),u=new Map;c.forEach(f=>{const A=kve(o.serializer,f);u.set(A.key.toString(),A)});const d=[];return s.forEach(f=>{const A=u.get(f.toString());Wr(!!A),d.push(A)}),d}(this.datastore,e);return r.forEach(n=>this.recordVersion(n)),r}set(e,r){this.write(r.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,r){try{this.write(r.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new r1(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(r=>{e.delete(r.key.toString())}),e.forEach((r,n)=>{const a=Pr.fromPath(n);this.mutations.push(new FD(a,this.precondition(a)))}),await async function(n,a){const s=xn(n),o={writes:a.map(l=>h2(s.serializer,l))};await s.Mo("Commit",s.serializer.databaseId,fa.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let r;if(e.isFoundDocument())r=e.version;else{if(!e.isNoDocument())throw Hr();r=tn.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!r.isEqual(n))throw new Cr(nr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),r)}precondition(e){const r=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&r?r.isEqual(tn.min())?Is.exists(!1):Is.updateTime(r):Is.none()}preconditionForUpdate(e){const r=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&r){if(r.isEqual(tn.min()))throw new Cr(nr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Is.updateTime(r)}return Is.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hye{constructor(e,r,n,a,s){this.asyncQueue=e,this.datastore=r,this.options=n,this.updateFunction=a,this.deferred=s,this._u=n.maxAttempts,this.t_=new GD(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new fye(this.datastore),r=this.cu(e);r&&r.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(a=>{this.lu(a)}))}).catch(n=>{this.lu(n)})})}cu(e){try{const r=this.updateFunction(e);return!mw(r)&&r.catch&&r.then?r:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(r){return this.deferred.reject(r),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const r=e.code;return r==="aborted"||r==="failed-precondition"||r==="already-exists"||!ZJ(r)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aye{constructor(e,r,n,a,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=a,this.user=al.UNAUTHENTICATED,this.clientId=ED.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async o=>{xr("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(xr("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Yd;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=YD(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function m3(t,e){t.asyncQueue.verifyOperationInProgress(),xr("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async a=>{n.isEqual(a)||(await IZ(e.localStore,a),n=a)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function e9(t,e){t.asyncQueue.verifyOperationInProgress();const r=await mye(t);xr("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>z7(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,a)=>z7(e.remoteStore,a)),t._onlineComponents=e}async function mye(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){xr("FirestoreClient","Using user provided OfflineComponentProvider");try{await m3(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(a){return a.name==="FirebaseError"?a.code===nr.FAILED_PRECONDITION||a.code===nr.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11}(r))throw r;am("Error using user provided cache. Falling back to memory cache: "+r),await m3(t,new A2)}}else xr("FirestoreClient","Using default OfflineComponentProvider"),await m3(t,new A2);return t._offlineComponents}async function a6(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(xr("FirestoreClient","Using user provided OnlineComponentProvider"),await e9(t,t._uninitializedComponentsProvider._online)):(xr("FirestoreClient","Using default OnlineComponentProvider"),await e9(t,new rS))),t._onlineComponents}function pye(t){return a6(t).then(e=>e.syncEngine)}function gye(t){return a6(t).then(e=>e.datastore)}async function nS(t){const e=await a6(t),r=e.eventManager;return r.onListen=Z1e.bind(null,e.syncEngine),r.onUnlisten=rye.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=eye.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=nye.bind(null,e.syncEngine),r}function xye(t,e,r={}){const n=new Yd;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,u){const d=new n6({next:A=>{d.Za(),o.enqueueAndForget(()=>ZD(s,f));const h=A.docs.has(l);!h&&A.fromCache?u.reject(new Cr(nr.UNAVAILABLE,"Failed to get document because the client is offline.")):h&&A.fromCache&&c&&c.source==="server"?u.reject(new Cr(nr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(A)},error:A=>u.reject(A)}),f=new t6(gw(l.path),d,{includeMetadataChanges:!0,_a:!0});return JD(s,f)}(await nS(t),t.asyncQueue,e,r,n)),n.promise}function vye(t,e,r={}){const n=new Yd;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,u){const d=new n6({next:A=>{d.Za(),o.enqueueAndForget(()=>ZD(s,f)),A.fromCache&&c.source==="server"?u.reject(new Cr(nr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(A)},error:A=>u.reject(A)}),f=new t6(l,d,{includeMetadataChanges:!0,_a:!0});return JD(s,f)}(await nS(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qZ(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t9=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zZ(t,e,r){if(!r)throw new Cr(nr.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function WZ(t,e,r,n){if(e===!0&&n===!0)throw new Cr(nr.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function r9(t){if(!Pr.isDocumentKey(t))throw new Cr(nr.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function n9(t){if(Pr.isDocumentKey(t))throw new Cr(nr.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function yj(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Hr()}function Lo(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Cr(nr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=yj(t);throw new Cr(nr.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a9{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Cr(nr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Cr(nr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}WZ("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=qZ((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Cr(nr.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Cr(nr.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Cr(nr.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,a){return n.timeoutSeconds===a.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class bj{constructor(e,r,n,a){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new a9({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Cr(nr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Cr(nr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new a9(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new gJ;switch(n.type){case"firstParty":return new vxe(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Cr(nr.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=t9.get(r);n&&(xr("ComponentProvider","Removing Datastore"),t9.delete(r),n.terminate())}(this),Promise.resolve()}}function XZ(t,e,r,n={}){var a;const s=(t=Lo(t,bj))._getSettings(),o=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&am("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),n.mockUserToken){let l,c;if(typeof n.mockUserToken=="string")l=n.mockUserToken,c=al.MOCK_USER;else{l=O0e(n.mockUserToken,(a=t._app)===null||a===void 0?void 0:a.options.projectId);const u=n.mockUserToken.sub||n.mockUserToken.user_id;if(!u)throw new Cr(nr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new al(u)}t._authCredentials=new pxe(new pJ(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yf{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Yf(this.firestore,e,this._query)}}class Uo{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $h(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Uo(this.firestore,e,this._key)}}class $h extends Yf{constructor(e,r,n){super(e,r,gw(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Uo(this.firestore,null,new Pr(e))}withConverter(e){return new $h(this.firestore,e,this._path)}}function _t(t,e,...r){if(t=Ys(t),zZ("collection","path",e),t instanceof bj){const n=fa.fromString(e,...r);return n9(n),new $h(t,null,n)}{if(!(t instanceof Uo||t instanceof $h))throw new Cr(nr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(fa.fromString(e,...r));return n9(n),new $h(t.firestore,null,n)}}function Yt(t,e,...r){if(t=Ys(t),arguments.length===1&&(e=ED.newId()),zZ("doc","path",e),t instanceof bj){const n=fa.fromString(e,...r);return r9(n),new Uo(t,null,new Pr(n))}{if(!(t instanceof Uo||t instanceof $h))throw new Cr(nr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(fa.fromString(e,...r));return r9(n),new Uo(t.firestore,t instanceof $h?t.converter:null,new Pr(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s9{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new GD(this,"async_queue_retry"),this.Vu=()=>{const n=Z_();n&&xr("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=Z_();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=Z_();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Yd;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Cm(e))throw e;xr("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const a=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(n);throw oc("INTERNAL UNHANDLED ERROR: ",a),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const a=XD.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(a),a}fu(){this.Eu&&Hr()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function i9(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const a=r;for(const s of n)if(s in a&&typeof a[s]=="function")return!0;return!1}(t,["next","error","complete"])}class yu extends bj{constructor(e,r,n,a){super(e,r,n,a),this.type="firestore",this._queue=new s9,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new s9(e),this._firestoreClient=void 0,await e}}}function YZ(t,e){const r=typeof t=="object"?t:fD(),n=typeof t=="string"?t:"(default)",a=uD(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const s=k0e("firestore");s&&XZ(a,...s)}return a}function wg(t){if(t._terminated)throw new Cr(nr.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||JZ(t),t._firestoreClient}function JZ(t){var e,r,n;const a=t._freezeSettings(),s=function(l,c,u,d){return new Xxe(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,qZ(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,a);t._componentsProvider||!((r=a.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=a.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),t._firestoreClient=new Aye(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}function ZZ(t,e){am("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings();return yye(t,rS.provider,{build:n=>new dye(n,r.cacheSizeBytes,void 0)}),Promise.resolve()}function yye(t,e,r){if((t=Lo(t,yu))._firestoreClient||t._terminated)throw new Cr(nr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new Cr(nr.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:r},JZ(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm{constructor(e){this._byteString=e}static fromBase64String(e){try{return new cm(Ti.fromBase64String(e))}catch(r){throw new Cr(nr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new cm(Ti.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ng{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Cr(nr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ss(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nw{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wj{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Cr(nr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Cr(nr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return En(this._lat,e._lat)||En(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nj{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,a){if(n.length!==a.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==a[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bye=/^__.*__$/;class wye{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new bA(e,this.data,this.fieldMask,r,this.fieldTransforms):new t1(e,this.data,r,this.fieldTransforms)}}class eee{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new bA(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function tee(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Hr()}}class Cj{constructor(e,r,n,a,s,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=a,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Cj(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.Fu({path:n,xu:!1});return a.Ou(e),a}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.Fu({path:n,xu:!1});return a.vu(),a}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return aS(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(tee(this.Cu)&&bye.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class Nye{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||xj(e)}Qu(e,r,n,a=!1){return new Cj({Cu:e,methodName:r,qu:n,path:Ss.emptyPath(),xu:!1,ku:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function a1(t){const e=t._freezeSettings(),r=xj(t._databaseId);return new Nye(t._databaseId,!!e.ignoreUndefinedProperties,r)}function _j(t,e,r,n,a,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,r,a);l6("Data must be an object, but it was:",o,n);const l=ree(n,o);let c,u;if(s.merge)c=new kc(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const f of s.mergeFields){const A=qT(e,f,r);if(!o.contains(A))throw new Cr(nr.INVALID_ARGUMENT,`Field '${A}' is specified in your field mask but missing from your input data.`);aee(d,A)||d.push(A)}c=new kc(d),u=o.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,u=o.fieldTransforms;return new wye(new ol(l),c,u)}class Ej extends Nw{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ej}}function Cye(t,e,r){return new Cj({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:r},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class s6 extends Nw{constructor(e,r){super(e),this.Ku=r}_toFieldTransform(e){const r=Cye(this,e,!0),n=this.Ku.map(s=>s1(s,r)),a=new Xp(n);return new XJ(e.path,a)}isEqual(e){return e instanceof s6&&Jb(this.Ku,e.Ku)}}function i6(t,e,r,n){const a=t.Qu(1,e,r);l6("Data must be an object, but it was:",a,n);const s=[],o=ol.empty();yg(n,(c,u)=>{const d=c6(e,c,r);u=Ys(u);const f=a.Nu(d);if(u instanceof Ej)s.push(d);else{const A=s1(u,f);A!=null&&(s.push(d),o.set(d,A))}});const l=new kc(s);return new eee(o,l,a.fieldTransforms)}function o6(t,e,r,n,a,s){const o=t.Qu(1,e,r),l=[qT(e,n,r)],c=[a];if(s.length%2!=0)throw new Cr(nr.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let A=0;A<s.length;A+=2)l.push(qT(e,s[A])),c.push(s[A+1]);const u=[],d=ol.empty();for(let A=l.length-1;A>=0;--A)if(!aee(u,l[A])){const h=l[A];let m=c[A];m=Ys(m);const p=o.Nu(h);if(m instanceof Ej)u.push(h);else{const g=s1(m,p);g!=null&&(u.push(h),d.set(h,g))}}const f=new kc(u);return new eee(d,f,o.fieldTransforms)}function _ye(t,e,r,n=!1){return s1(r,t.Qu(n?4:3,e))}function s1(t,e){if(nee(t=Ys(t)))return l6("Unsupported field value:",e,t),ree(t,e);if(t instanceof Nw)return function(n,a){if(!tee(a.Cu))throw a.Bu(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(a);s&&a.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,a){const s=[];let o=0;for(const l of n){let c=s1(l,a.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(n,a){if((n=Ys(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return pve(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=dr.fromDate(n);return{timestampValue:Iv(a.serializer,s)}}if(n instanceof dr){const s=new dr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Iv(a.serializer,s)}}if(n instanceof wj)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof cm)return{bytesValue:nZ(a.serializer,n._byteString)};if(n instanceof Uo){const s=a.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw a.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:LD(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof Nj)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return kD(l.serializer,c)})}}}}}}(n,a);throw a.Bu(`Unsupported field value: ${yj(n)}`)}(t,e)}function ree(t,e){const r={};return SJ(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):yg(t,(n,a)=>{const s=s1(a,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function nee(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof dr||t instanceof wj||t instanceof cm||t instanceof Uo||t instanceof Nw||t instanceof Nj)}function l6(t,e,r){if(!nee(r)||!function(a){return typeof a=="object"&&a!==null&&(Object.getPrototypeOf(a)===Object.prototype||Object.getPrototypeOf(a)===null)}(r)){const n=yj(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function qT(t,e,r){if((e=Ys(e))instanceof Ng)return e._internalPath;if(typeof e=="string")return c6(t,e);throw aS("Field path arguments must be of type string or ",t,!1,void 0,r)}const Eye=new RegExp("[~\\*/\\[\\]]");function c6(t,e,r){if(e.search(Eye)>=0)throw aS(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Ng(...e.split("."))._internalPath}catch{throw aS(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function aS(t,e,r,n,a){const s=n&&!n.isEmpty(),o=a!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${n}`),o&&(c+=` in document ${a}`),c+=")"),new Cr(nr.INVALID_ARGUMENT,l+t+c)}function aee(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e,r,n,a,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=a,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Uo(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Sye(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Sj("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class Sye extends sS{data(){return super.data()}}function Sj(t,e){return typeof e=="string"?c6(t,e):e instanceof Ng?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function see(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Cr(nr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class u6{}class Ij extends u6{}function er(t,e,...r){let n=[];e instanceof u6&&n.push(e),n=n.concat(r),function(s){const o=s.filter(c=>c instanceof jj).length,l=s.filter(c=>c instanceof Cw).length;if(o>1||o>0&&l>0)throw new Cr(nr.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const a of n)t=a._apply(t);return t}class Cw extends Ij{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Cw(e,r,n)}_apply(e){const r=this._parse(e);return iee(e._query,r),new Yf(e.firestore,e.converter,DT(e._query,r))}_parse(e){const r=a1(e.firestore);return function(s,o,l,c,u,d,f){let A;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Cr(nr.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){l9(f,d);const h=[];for(const m of f)h.push(o9(c,s,m));A={arrayValue:{values:h}}}else A=o9(c,s,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||l9(f,d),A=_ye(l,o,f,d==="in"||d==="not-in");return Yn.create(u,d,A)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function cr(t,e,r){const n=e,a=Sj("where",t);return Cw._create(a,n,r)}class jj extends u6{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new jj(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Da.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(a,s){let o=a;const l=s.getFlattenedFilters();for(const c of l)iee(o,c),o=DT(o,c)}(e._query,r),new Yf(e.firestore,e.converter,DT(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Pj extends Ij{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Pj(e,r)}_apply(e){const r=function(a,s,o){if(a.startAt!==null)throw new Cr(nr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new Cr(nr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new c2(s,o)}(e._query,this._field,this._direction);return new Yf(e.firestore,e.converter,function(a,s){const o=a.explicitOrderBy.concat([s]);return new e1(a.path,a.collectionGroup,o,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)}(e._query,r))}}function dn(t,e="asc"){const r=e,n=Sj("orderBy",t);return Pj._create(n,r)}class Bj extends Ij{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new Bj(e,r,n)}_apply(e){return new Yf(e.firestore,e.converter,YE(e._query,this._limit,this._limitType))}}function iS(t){return Bj._create("limit",t,"F")}function o9(t,e,r){if(typeof(r=Ys(r))=="string"){if(r==="")throw new Cr(nr.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!LJ(e)&&r.indexOf("/")!==-1)throw new Cr(nr.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(fa.fromString(r));if(!Pr.isDocumentKey(n))throw new Cr(nr.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return o2(t,new Pr(n))}if(r instanceof Uo)return o2(t,r._key);throw new Cr(nr.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${yj(r)}.`)}function l9(t,e){if(!Array.isArray(t)||t.length===0)throw new Cr(nr.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function iee(t,e){const r=function(a,s){for(const o of a)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Cr(nr.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Cr(nr.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class d6{convertValue(e,r="none"){switch(zp(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Cs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(sm(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Hr()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return yg(e,(a,s)=>{n[a]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,a;const s=(a=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||a===void 0?void 0:a.map(o=>Cs(o.doubleValue));return new Nj(s)}convertGeoPoint(e){return new wj(Cs(e.latitude),Cs(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=BD(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(s2(e));default:return null}}convertTimestamp(e){const r=aA(e);return new dr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=fa.fromString(e);Wr(hZ(n));const a=new im(n.get(1),n.get(3)),s=new Pr(n.popFirst(5));return a.isEqual(r)||oc(`Document ${s} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tj(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class Iye extends d6{constructor(e){super(),this.firestore=e}convertBytes(e){return new cm(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Uo(this.firestore,null,r)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class kj extends sS{constructor(e,r,n,a,s,o){super(e,r,n,a,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new ub(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Sj("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class ub extends kj{data(e={}){return super.data(e)}}class f6{constructor(e,r,n,a){this._firestore=e,this._userDataWriter=r,this._snapshot=a,this.metadata=new hp(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new ub(this._firestore,this._userDataWriter,n.key,n,new hp(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Cr(nr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(a,s){if(a._snapshot.oldDocs.isEmpty()){let o=0;return a._snapshot.docChanges.map(l=>{const c=new ub(a._firestore,a._userDataWriter,l.doc.key,l.doc,new hp(a._snapshot.mutatedKeys.has(l.doc.key),a._snapshot.fromCache),a.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const c=new ub(a._firestore,a._userDataWriter,l.doc.key,l.doc,new hp(a._snapshot.mutatedKeys.has(l.doc.key),a._snapshot.fromCache),a.query.converter);let u=-1,d=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:jye(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function jye(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Hr()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bs(t){t=Lo(t,Uo);const e=Lo(t.firestore,yu);return xye(wg(e),t._key).then(r=>lee(e,t,r))}class Fj extends d6{constructor(e){super(),this.firestore=e}convertBytes(e){return new cm(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Uo(this.firestore,null,r)}}function Qt(t){t=Lo(t,Yf);const e=Lo(t.firestore,yu),r=wg(e),n=new Fj(e);return see(t._query),vye(r,t._query).then(a=>new f6(e,n,t,a))}function oee(t,e,r){t=Lo(t,Uo);const n=Lo(t.firestore,yu),a=Tj(t.converter,e,r);return i1(n,[_j(a1(n),"setDoc",t._key,a,t.converter!==null,r).toMutation(t._key,Is.none())])}function pn(t,e,r,...n){t=Lo(t,Uo);const a=Lo(t.firestore,yu),s=a1(a);let o;return o=typeof(e=Ys(e))=="string"||e instanceof Ng?o6(s,"updateDoc",t._key,e,r,n):i6(s,"updateDoc",t._key,e),i1(a,[o.toMutation(t._key,Is.exists(!0))])}function Fn(t){return i1(Lo(t.firestore,yu),[new r1(t._key,Is.none())])}function On(t,e){const r=Lo(t.firestore,yu),n=Yt(t),a=Tj(t.converter,e);return i1(r,[_j(a1(t.firestore),"addDoc",n._key,a,t.converter!==null,{}).toMutation(n._key,Is.exists(!1))]).then(()=>n)}function cd(t,...e){var r,n,a;t=Ys(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||i9(e[o])||(s=e[o],o++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(i9(e[o])){const f=e[o];e[o]=(r=f.next)===null||r===void 0?void 0:r.bind(f),e[o+1]=(n=f.error)===null||n===void 0?void 0:n.bind(f),e[o+2]=(a=f.complete)===null||a===void 0?void 0:a.bind(f)}let c,u,d;if(t instanceof Uo)u=Lo(t.firestore,yu),d=gw(t._key.path),c={next:f=>{e[o]&&e[o](lee(u,t,f))},error:e[o+1],complete:e[o+2]};else{const f=Lo(t,Yf);u=Lo(f.firestore,yu),d=f._query;const A=new Fj(u);c={next:h=>{e[o]&&e[o](new f6(u,A,f,h))},error:e[o+1],complete:e[o+2]},see(t._query)}return function(A,h,m,p){const g=new n6(p),v=new t6(h,g,m);return A.asyncQueue.enqueueAndForget(async()=>JD(await nS(A),v)),()=>{g.Za(),A.asyncQueue.enqueueAndForget(async()=>ZD(await nS(A),v))}}(wg(u),d,l,c)}function i1(t,e){return function(n,a){const s=new Yd;return n.asyncQueue.enqueueAndForget(async()=>aye(await pye(n),a,s)),s.promise}(wg(t),e)}function lee(t,e,r){const n=r.docs.get(e._key),a=new Fj(t);return new kj(t,a,e._key,n,new hp(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pye={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cee{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=a1(e)}set(e,r,n){this._verifyNotCommitted();const a=_0(e,this._firestore),s=Tj(a.converter,r,n),o=_j(this._dataReader,"WriteBatch.set",a._key,s,a.converter!==null,n);return this._mutations.push(o.toMutation(a._key,Is.none())),this}update(e,r,n,...a){this._verifyNotCommitted();const s=_0(e,this._firestore);let o;return o=typeof(r=Ys(r))=="string"||r instanceof Ng?o6(this._dataReader,"WriteBatch.update",s._key,r,n,a):i6(this._dataReader,"WriteBatch.update",s._key,r),this._mutations.push(o.toMutation(s._key,Is.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=_0(e,this._firestore);return this._mutations=this._mutations.concat(new r1(r._key,Is.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Cr(nr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function _0(t,e){if((t=Ys(t)).firestore!==e)throw new Cr(nr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uee extends class{constructor(r,n){this._firestore=r,this._transaction=n,this._dataReader=a1(r)}get(r){const n=_0(r,this._firestore),a=new Iye(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return Hr();const o=s[0];if(o.isFoundDocument())return new sS(this._firestore,a,o.key,o,n.converter);if(o.isNoDocument())return new sS(this._firestore,a,n._key,null,n.converter);throw Hr()})}set(r,n,a){const s=_0(r,this._firestore),o=Tj(s.converter,n,a),l=_j(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,a);return this._transaction.set(s._key,l),this}update(r,n,a,...s){const o=_0(r,this._firestore);let l;return l=typeof(n=Ys(n))=="string"||n instanceof Ng?o6(this._dataReader,"Transaction.update",o._key,n,a,s):i6(this._dataReader,"Transaction.update",o._key,n),this._transaction.update(o._key,l),this}delete(r){const n=_0(r,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,r){super(e,r),this._firestore=e}get(e){const r=_0(e,this._firestore),n=new Fj(this._firestore);return super.get(e).then(a=>new kj(this._firestore,n,r._key,a._document,new hp(!1,!1),r.converter))}}function Ii(t,e,r){t=Lo(t,yu);const n=Object.assign(Object.assign({},Pye),r);return function(s){if(s.maxAttempts<1)throw new Cr(nr.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(s,o,l){const c=new Yd;return s.asyncQueue.enqueueAndForget(async()=>{const u=await gye(s);new hye(s.asyncQueue,u,l,o,c).au()}),c.promise}(wg(t),a=>e(new uee(t,a)),n)}function dee(...t){return new s6("arrayUnion",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jd(t){return wg(t=Lo(t,yu)),new cee(t,e=>i1(t,e))}(function(e,r=!0){(function(a){Zv=a})(Yv),wv(new $p("firestore",(n,{instanceIdentifier:a,options:s})=>{const o=n.getProvider("app").getImmediate(),l=new yu(new gxe(n.getProvider("auth-internal")),new bxe(n.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Cr(nr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new im(u.options.projectId,d)}(o,a),o);return s=Object.assign({useFetchStreams:r},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),z0(e7,"4.7.3",e),z0(e7,"4.7.3","esm2017")})();const Bye=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:d6,Bytes:cm,CollectionReference:$h,DocumentReference:Uo,DocumentSnapshot:kj,FieldPath:Ng,FieldValue:Nw,Firestore:yu,FirestoreError:Cr,GeoPoint:wj,Query:Yf,QueryCompositeFilterConstraint:jj,QueryConstraint:Ij,QueryDocumentSnapshot:ub,QueryFieldFilterConstraint:Cw,QueryLimitConstraint:Bj,QueryOrderByConstraint:Pj,QuerySnapshot:f6,SnapshotMetadata:hp,Timestamp:dr,Transaction:uee,VectorValue:Nj,WriteBatch:cee,_AutoId:ED,_ByteString:Ti,_DatabaseId:im,_DocumentKey:Pr,_EmptyAuthCredentialsProvider:gJ,_FieldPath:Ss,_cast:Lo,_logWarn:am,_validateIsNotUsedTogether:WZ,addDoc:On,arrayUnion:dee,collection:_t,connectFirestoreEmulator:XZ,deleteDoc:Fn,doc:Yt,enableIndexedDbPersistence:ZZ,ensureFirestoreConfigured:wg,executeWrite:i1,getDoc:Bs,getDocs:Qt,getFirestore:YZ,limit:iS,onSnapshot:cd,orderBy:dn,query:er,runTransaction:Ii,setDoc:oee,updateDoc:pn,where:cr,writeBatch:Jd},Symbol.toStringTag,{value:"Module"})),Tye={apiKey:"AIzaSyA_ZzeP_DAoXeRuallrOaJ4xFaxjnuhw-8",authDomain:"posys-103de.firebaseapp.com",projectId:"posys-103de",storageBucket:"posys-103de.firebasestorage.app",messagingSenderId:"401054148688",appId:"1:401054148688:web:1c2aea9e8b40958b514955",measurementId:"G-Q2GWQXMFLX"},fee=dD(Tye),Fe=YZ(fee),Zd=ST(fee),kye=(async()=>{try{return await H_(Zd,bD),console.info(" Auth persistence: browserLocalPersistence enabled"),"local"}catch(t){console.warn(" browserLocalPersistence failed:",(t==null?void 0:t.code)||t)}try{return await H_(Zd,oJ),console.info(" Auth persistence: indexedDBLocalPersistence enabled"),"indexeddb"}catch(t){console.warn(" indexedDBLocalPersistence failed:",(t==null?void 0:t.code)||t)}try{return await H_(Zd,wD),console.info(" Auth persistence: browserSessionPersistence enabled (session only)"),"session"}catch(t){console.warn(" browserSessionPersistence failed:",(t==null?void 0:t.code)||t)}return console.warn(" No se pudo establecer ninguna persistencia para Auth."),"none"})();ZZ(Fe).catch(t=>{t.code==="failed-precondition"?console.warn(" Ya hay otra pestaa usando persistencia."):t.code==="unimplemented"?console.warn(" El navegador no soporta persistencia offline."):console.error(" Error en persistencia offline:",t)});function Fye(){const[t,e]=x.useState(""),[r,n]=x.useState(""),[a,s]=x.useState(!1),[o,l]=x.useState(""),[c,u]=x.useState(!1),d=ow();x.useEffect(()=>{let h=!0;const m=ij(Zd,async p=>{if(!(!p||!h))try{const g=await Bs(Yt(Fe,"users",p.uid));if(!g.exists())return;const v=g.data(),y=Array.isArray(v.roles)?v.roles:v.role?[v.role]:[],b=y[0]||"",w=v.name||"";localStorage.setItem("user_email",p.email||""),w&&localStorage.setItem("user_name",w),localStorage.setItem("roles",JSON.stringify(y)),y.length===1?f(b):d("/admin",{replace:!0})}catch{}});return()=>{h=!1,m()}},[d]);const f=h=>{if(Array.isArray(h)){if(h.length!==1)return localStorage.setItem("role",h[0]||""),d("/admin");h=h[0]||""}const m=String(h||"");if(localStorage.setItem("role",m),sn(m,"admin"))return d("/admin");if(sn(m,"vendedor_pollo"))return d("/admin/salesV2");if(sn(m,"vendedor_ropa"))return d("/admin/salesClothes");if(sn(m,"vendedor_dulces"))return d("/admin/salesCandies");if(sn(m,"supervisor_pollo")||sn(m,"contador"))return d("/admin/batches")},A=async h=>{if(h.preventDefault(),l(""),!t.trim()){l("Ingresa el correo.");return}if(r.length<6){l("La contrasea debe tener al menos 6 caracteres.");return}try{u(!0),console.info&&console.info("[Login] attempting signIn",{email:t}),await H_(Zd,bD);const m=await rge(Zd,t,r);console.info&&console.info("[Login] signInWithEmailAndPassword success",{uid:m.user.uid,email:m.user.email});const p=m.user.uid;localStorage.setItem("POSYS_LOGIN_AT",String(Date.now()));const g=await Bs(Yt(Fe,"users",p));if(console.info&&console.info("[Login] firestore users doc snap: exists=",g.exists()),!g.exists()){console.warn&&console.warn("[Login] user doc missing for uid",p),l("Tu usuario no tiene perfil en la base de datos.");return}const v=g.data();console.info&&console.info("[Login] user profile:",v);const y=Array.isArray(v.roles)?v.roles:v.role?[v.role]:[],b=y[0]||"",w=v.name||"",j=["admin","vendedor_pollo","vendedor_ropa","vendedor_dulces","supervisor_pollo","contador"];if(!y.some(I=>j.includes(I))){l("Rol no vlido. Consulta al administrador.");return}localStorage.setItem("user_email",m.user.email||""),w&&localStorage.setItem("user_name",w),localStorage.setItem("roles",JSON.stringify(y)),y.length===1?f(b):d("/admin")}catch(m){console.error&&console.error("[Login] sign-in error:",m);const p=String((m==null?void 0:m.code)||"");l(p==="auth/invalid-credential"||p==="auth/wrong-password"?"Credenciales incorrectas. ("+p+")":p==="auth/user-not-found"?"Usuario no encontrado. ("+p+")":p==="auth/too-many-requests"?"Demasiados intentos. Intenta ms tarde. ("+p+")":((m==null?void 0:m.message)||"Error al iniciar sesin.")+(p?` (${p})`:""))}finally{u(!1)}};return i.jsx("div",{className:"min-h-screen grid place-items-center ",children:i.jsxs("form",{onSubmit:A,className:"w-[92%] max-w-md bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-2xl font-bold text-center mb-4",children:"Iniciar Sesin"}),i.jsx("label",{className:"block text-sm font-semibold",children:"Correo electrnico"}),i.jsx("input",{type:"email",className:"w-full border rounded-2xl px-3 py-2 mb-3 shadow-2xl",value:t,onChange:h=>e(h.target.value),autoComplete:"username"}),i.jsx("label",{className:"block text-sm font-semibold",children:"Contrasea"}),i.jsxs("div",{className:"flex gap-2 mb-2",children:[i.jsx("input",{type:a?"text":"password",className:"flex-1 border rounded-2xl px-3 py-2 shadow-2xl",value:r,onChange:h=>n(h.target.value),minLength:6,autoComplete:"current-password"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded-2xl shadow-2xl bg-gray-200 hover:bg-gray-300",onClick:()=>s(h=>!h),children:a?"Ocultar":"Mostrar"})]}),i.jsx("div",{className:"text-xs text-gray-600 mb-3",children:"Mnimo 6 caracteres (requisito de Firebase)."}),i.jsx("button",{className:"w-full bg-blue-600 text-white px-4 py-2 rounded-2xl shadow-2xl hover:bg-blue-700 disabled:opacity-60",disabled:c,children:c?"Entrando...":"Entrar"}),o&&i.jsx("p",{className:`mt-3 text-sm ${o.startsWith("Error")||o.includes("no vlido")?"text-red-600":"text-gray-700"}`,children:o})]})})}function Tn({children:t,allowedRoles:e}){const[r,n]=x.useState(!0),[a,s]=x.useState(!1);return x.useEffect(()=>{const o=ij(Zd,async l=>{if(l){const c=Yt(Fe,"users",l.uid),u=await Bs(c);if(u.exists()){const d=u.data(),f=Array.isArray(d.roles)?d.roles:d.role?[d.role]:[];try{typeof window<"u"&&window.location&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?console.info&&console.info("[PrivateRoute] uid:",l.uid,"roleFromDoc:",role,"allowedRoles:",e):console.debug&&console.debug("[PrivateRoute] uid:",l.uid,"roleFromDoc:",role,"allowedRoles:",e)}catch{}let A=!1;for(const h of e)if(sn(f,h)){A=!0;break}s(A)}else try{typeof window<"u"&&window.location&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?console.info&&console.info("[PrivateRoute] no user doc for uid:",l.uid):console.debug&&console.debug("[PrivateRoute] no user doc for uid:",l.uid)}catch{}}n(!1)});return()=>o()},[e]),r?i.jsx("div",{className:"p-4",children:"Cargando..."}):a?t:i.jsx(wh,{to:"/"})}const Oye={admin:{},supervisor_pollo:{bills:{view:!0,edit:!1},customersPollo:{view:!0,edit:!1},transactionsPollo:{view:!0,edit:!1},batches:{view:!0,edit:!1}},contador:{salesV2:{view:!0,edit:!0},customersPollo:{view:!0,edit:!0},batches:{view:!0,edit:!0},transactionsPollo:{view:!0,edit:!1},bills:{view:!0,edit:!1},financialDashboard:{view:!0,edit:!1}},vendedor_pollo:{salesV2:{view:!0,edit:!0},transactionsPollo:{view:!0,edit:!1},bills:{view:!0,edit:!1},customersPollo:{view:!0,edit:!0}},vendedor_dulces:{salesCandies:{view:!0,edit:!0},productsVendorsCandies:{view:!0,edit:!1},productsPricesCandies:{view:!0,edit:!1},transactionCandies:{view:!0,edit:!1},cierreVentasCandies:{view:!0,edit:!1},customersCandies:{view:!0,edit:!0}},vendedor_ropa:{}};function hee(t){return t?Array.isArray(t)?t.filter(Boolean):[t].filter(Boolean):[]}function Wn(t,e,r="view"){const n=hee(t);return n.some(a=>a==="admin")?!0:n.some(a=>{var s,o;return!!((o=(s=Oye[a])==null?void 0:s[e])!=null&&o[r])})}const Dye={admin:{},supervisor_pollo:{bills:{cerrarVentas:!1},batches:{create:!1,update:!1,delete:!1,export:!1}},contador:{batches:{create:!0,update:!1,delete:!1,export:!0},bills:{cerrarVentas:!1}},vendedor_pollo:{salesV2:{create:!0,update:!0},customersPollo:{update:!0},bills:{cerrarVentas:!0}},vendedor_dulces:{salesCandies:{create:!0,update:!0},productsVendorsCandies:{create:!0,update:!1,delete:!1},customersCandies:{update:!0},productsPricesCandies:{price_edit:!1}},vendedor_ropa:{}};function Rye(t,e,r){const n=hee(t);return n.some(a=>a==="admin")?!0:Wn(t,e,"view")?n.some(a=>{var o;const s=(o=Dye[a])==null?void 0:o[e];return!!(s!=null&&s[r])}):!1}function Mye({role:t,roles:e}){const r="/admin",n=({isActive:se})=>`block rounded px-3 py-2 text-sm ${se?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"}`,a=ow(),[s,o]=x.useState(!1),[l,c]=x.useState(!1),[u,d]=x.useState(!1),[f,A]=x.useState(!1),[h,m]=x.useState(!1),[p,g]=x.useState(!1),[v,y]=x.useState(!1),[b,w]=x.useState(!1),[j,I]=x.useState(!1),[_,S]=x.useState(!1),[E,F]=x.useState(!1),[k,P]=x.useState(!1),[D,X]=x.useState(!1),[pe,ge]=x.useState(!1),[fe,xe]=x.useState(!1),[ae,Se]=x.useState(!1),[Te,O]=x.useState(!1),[G,z]=x.useState(!1),L=async()=>{z(!0)},Z=async()=>{try{await yD(Zd)}catch(se){console.error("signOut error:",se)}finally{try{localStorage.removeItem("user_name"),localStorage.removeItem("user_email"),localStorage.removeItem("roles"),localStorage.removeItem("role")}catch{}z(!1),a("/")}},ee=({open:se,onClick:re,children:Pe})=>i.jsxs("button",{type:"button",onClick:re,className:"w-full flex items-center justify-between px-3 py-2 text-left text-sm font-semibold rounded hover:bg-gray-100",children:[i.jsx("span",{children:Pe}),i.jsx("span",{className:"text-xs",children:se?"":""})]}),R=({open:se,onClick:re,title:Pe})=>i.jsxs("button",{type:"button",onClick:re,className:"ml-2 w-[calc(100%-0.5rem)] flex items-center justify-between px-3 py-2 text-left text-sm rounded hover:bg-gray-100",children:[i.jsx("span",{className:"text-blue-500 font-medium ",children:Pe}),i.jsx("span",{className:"text-xs",children:se?"":""})]}),H=e&&e.length?e:t,ne=sn(H,"admin");sn(H,"vendedor_pollo");const ve=sn(H,"vendedor_ropa");sn(H,"vendedor_dulces"),sn(H,"supervisor_pollo")||sn(H,"contador"),sn(H,"contador");const U=Wn(H,"salesV2","view")||Wn(H,"customersPollo","view")||Wn(H,"transactionsPollo","view")||Wn(H,"bills","view")||Wn(H,"batches","view"),He=Wn(H,"salesCandies","view")||Wn(H,"productsVendorsCandies","view")||Wn(H,"customersCandies","view")||Wn(H,"productsPricesCandies","view")||Wn(H,"transactionCandies","view")||Wn(H,"cierreVentasCandies","view");return i.jsxs("div",{className:"min-h-screen flex",children:[i.jsxs("aside",{className:`${s?"w-15 bg-gray-50 border-r p-3 transition-all duration-300 flex flex-col items-center":"w-55"} bg-[#f1f3f7] border-r p-3 transition-all duration-300 flex flex-col`,children:[i.jsx("button",{onClick:()=>o(!s),className:"mb-2 p-2 rounded-2xl shadow-2xl bg-gray-300 hover:bg-gray-400","aria-label":s?"Expandir men":"Colapsar men",children:s?i.jsx("span",{title:"Expandir men",children:"Menu "}):i.jsx("span",{title:"Colapsar men",children:"Cerrar "})}),!s&&i.jsxs(i.Fragment,{children:[i.jsxs("nav",{className:"space-y-1",children:[ne&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(ee,{open:l,onClick:()=>c(se=>!se),children:"Pollos Bea"}),l&&i.jsxs("div",{className:"pb-2",children:[i.jsx(R,{open:p,onClick:()=>g(se=>!se),title:"Operaciones"}),p&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(an,{to:`${r}/salesV2`,className:n,children:"Vender"}),i.jsx(an,{to:`${r}/customersPollo`,className:n,children:"Saldo Pendientes"}),i.jsx(an,{to:`${r}/transactionsPollo`,className:n,children:"Transacciones"}),i.jsx(an,{to:`${r}/bills`,className:n,children:"Cierre Ventas"})]}),i.jsx(R,{open:u,onClick:()=>d(se=>!se),title:"Inventarios"}),u&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(an,{to:`${r}/batches`,className:n,children:"Inventario Pollo"}),i.jsx(an,{to:`${r}/paidBatches`,className:n,children:"Inventarios Pagados"})]}),i.jsx(R,{open:f,onClick:()=>A(se=>!se),title:"Finanzas"}),f&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(an,{to:`${r}/financialDashboard`,className:n,children:"Dashboard"}),i.jsx(an,{to:`${r}/billing`,className:n,children:"Facturacion"}),i.jsx(an,{to:`${r}/expenses`,className:n,children:"Gastos"}),i.jsx(an,{to:`${r}/salesV2`,className:n,children:"Venta"}),i.jsx(an,{to:`${r}/bills`,className:n,children:"Cierre Ventas"}),i.jsx(an,{to:`${r}/billhistoric`,className:n,children:"Historial de Cierres"})]}),i.jsx(R,{open:h,onClick:()=>m(se=>!se),title:"Productos"}),h&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/products`,className:n,children:"Productos"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(ee,{open:v,onClick:()=>y(se=>!se),children:"Gonper"}),v&&i.jsxs("div",{className:"pb-2",children:[i.jsx(R,{open:b,onClick:()=>w(se=>!se),title:"Inventarios"}),b&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/notebooksInventory`,className:n,children:"Productos y Precios"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(ee,{open:D,onClick:()=>X(se=>!se),children:"CandyShop"}),D&&i.jsxs("div",{className:"pb-2",children:[i.jsx(R,{open:fe,onClick:()=>xe(se=>!se),title:"Vendedores"}),fe&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/salesCandies`,className:n,children:"Venta"})}),fe&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/productsVendorsCandies`,className:n,children:"Sub ordenes"})}),fe&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/productsPricesCandies`,className:n,children:"Precios Venta"})}),i.jsx(R,{open:pe,onClick:()=>ge(se=>!se),title:"Inventario"}),pe&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/mainordersCandies`,className:n,children:"Ordenes Maestras"})}),pe&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/inventoryMainOrderCandies`,className:n,children:"Lista de Ordenes"})}),pe&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/inventoryCandies`,className:n,children:"Lista Productos"})}),pe&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/productsCandies`,className:n,children:"Productos"})}),i.jsx(R,{open:ae,onClick:()=>Se(se=>!se),title:"Finanzas"}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/datacenter`,className:n,children:"Data Center"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/cashDeliveries`,className:n,children:"Entregas Cash"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/transactionCandies`,className:n,children:"Transacciones"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/cierreVentasCandies`,className:n,children:"Cierres"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/reporteCierresCandies`,className:n,children:"Reporte Cierres"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/billingsCandies`,className:n,children:"Facturas"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/consolidatedVendors`,className:n,children:"Consolidado Vendedores"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/dashboardCandies`,className:n,children:"Dashboard"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/customersCandies`,className:n,children:"Clientes"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/vendorsCandies`,className:n,children:"Vendedores"})}),ae&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/expensesCandies`,className:n,children:"Gastos"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(ee,{open:Te,onClick:()=>O(se=>!se),children:"Operaciones Otras"}),Te&&i.jsxs("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:[i.jsx(an,{to:`${r}/users`,className:n,children:"Usuarios"}),i.jsx(an,{to:`${r}/fix`,className:n,children:"Fix de lotes"}),i.jsx(an,{to:`${r}/transactionclose`,className:n,children:"Liquidaciones"})]})]})]}),!ne&&U&&i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(ee,{open:l,onClick:()=>c(se=>!se),children:"Pollos Bea"}),l&&i.jsxs("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:[Wn(H,"salesV2")&&i.jsx(an,{to:`${r}/salesV2`,className:n,children:"Vender"}),Wn(H,"financialDashboard")&&i.jsx(an,{to:`${r}/financialDashboard`,className:n,children:"Dashboard"}),Wn(H,"batches")&&i.jsx(an,{to:`${r}/batches`,className:n,children:"Inventario Pollo"}),Wn(H,"bills")&&i.jsx(an,{to:`${r}/bills`,className:n,children:"Cierre Ventas"}),Wn(H,"transactionsPollo")&&i.jsx(an,{to:`${r}/transactionsPollo`,className:n,children:"Transacciones"}),Wn(H,"customersPollo")&&i.jsx(an,{to:`${r}/customersPollo`,className:n,children:"Saldos Pendientes"})]})]}),!ne&&He&&i.jsxs("div",{className:"border rounded",children:[i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:Wn(H,"salesCandies")&&i.jsx(an,{to:`${r}/salesCandies`,className:n,children:"Venta"})}),i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:Wn(H,"transactionCandies")&&i.jsx(an,{to:`${r}/transactionCandies`,className:n,children:"Ventas del dia"})}),i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:Wn(H,"cierreVentasCandies")&&i.jsx(an,{to:`${r}/cierreVentasCandies`,className:n,children:"Cierre de Ventas"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:Wn(H,"productsVendorsCandies")&&i.jsx(an,{to:`${r}/productsVendorsCandies`,className:n,children:"Pedidos"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:Wn(H,"customersCandies")&&i.jsx(an,{to:`${r}/customersCandies`,className:n,children:"Clientes"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:Wn(H,"productsPricesCandies")&&i.jsx(an,{to:`${r}/productsPricesCandies`,className:n,children:"Precios Venta"})})]}),ve&&i.jsxs("div",{className:"border rounded",children:[i.jsx(ee,{open:v,onClick:()=>y(se=>!se),children:"Operaciones Ropa"}),v&&i.jsxs("div",{className:"pb-2",children:[i.jsx(R,{open:E,onClick:()=>F(se=>!se),title:"Ventas"}),E&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(an,{to:`${r}/salesClothes`,className:n,children:"Venta Ropa"}),i.jsx(an,{to:`${r}/TransactionsReportClothes`,className:n,children:"Transacciones"})]}),i.jsx(R,{open:j,onClick:()=>I(se=>!se),title:"Productos"}),j&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/productsClothes`,className:n,children:"Agregar Productos"})}),i.jsx(R,{open:_,onClick:()=>S(se=>!se),title:"Clientes"}),_&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(an,{to:`${r}/CustomersClothes`,className:n,children:"Listado de Clientes"})})]})]})]}),i.jsx("button",{onClick:L,className:"mt-4 bg-red-500 text-white px-3 py-2 rounded-2xl shadow-2xl hover:bg-red-600",children:"Cerrar sesin"}),i.jsx("div",{className:"mt-2 text-[20px] text-gray-700",children:typeof window<"u"&&(localStorage.getItem("user_name")||localStorage.getItem("user_email"))}),G&&i.jsxs("div",{className:"fixed inset-0 z-[120] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/20",onClick:()=>z(!1)}),i.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-lg z-[130] w-[90%] max-w-sm",children:[i.jsx("div",{className:"font-semibold mb-3",children:"Ests seguro de cerrar sesin?"}),i.jsxs("div",{className:"flex gap-2 justify-end",children:[i.jsx("button",{onClick:()=>z(!1),className:"px-3 py-2 rounded bg-gray-200",children:"No"}),i.jsx("button",{onClick:Z,className:"px-3 py-2 rounded bg-red-500 text-white",children:"SI"})]})]})]})]})]}),i.jsx("main",{className:"flex-1 p-6",children:i.jsx(dY,{})})]})}function ey(...t){return t.filter(Boolean).join(" ")}function Lye({role:t,roles:e}){const r=ow(),n=gA(),a="/admin",s=e&&e.length?e:t,o=sn(s,"admin"),l=sn(s,"vendedor_pollo"),c=sn(s,"vendedor_dulces"),u=sn(s,"supervisor_pollo")||sn(s,"contador"),d=sn(s,"contador"),f=Wn(s,"salesV2","view")||Wn(s,"batches","view")||Wn(s,"bills","view")||Wn(s,"transactionsPollo","view")||Wn(s,"customersPollo","view"),A=Wn(s,"salesCandies","view")||Wn(s,"productsVendorsCandies","view")||Wn(s,"customersCandies","view")||Wn(s,"productsPricesCandies","view")||Wn(s,"transactionCandies","view")||Wn(s,"cierreVentasCandies","view"),h=f&&A,[m,p]=x.useState(()=>{try{const F=typeof window<"u"?localStorage.getItem("rubro"):null;if(F==="POLLO"||F==="DULCES")return F}catch{}return f?"POLLO":A?"DULCES":"POLLO"}),[g,v]=x.useState(!1),[y,b]=x.useState(!1),w=x.useMemo(()=>{let F=[];if(o||h){if(m==="POLLO")if(o)F=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos pendientes",to:`${a}/customersPollo`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`},{key:"inv",label:"Inventario",to:`${a}/batches`},{key:"invPag",label:"Factura",to:`${a}/paidBatches`},{key:"gastos",label:"Gastos",to:`${a}/expenses`}];else if(u){const D=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos pendientes",to:`${a}/customersPollo`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"inv",label:"Inventario",to:`${a}/batches`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`}];sn(s,"contador")&&(F=D)}else l?F=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos Pendientes",to:`${a}/customersPollo`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`}]:d?F=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos Pendientes",to:`${a}/customersPollo`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`}]:F=[{key:"home",label:"Inicio",to:`${a}`}];m==="DULCES"&&(o?F=[{key:"dc",label:"Data Center Reporte",to:`${a}/datacenter`},{key:"maes",label:"Inventario Maestro",to:`${a}/mainordersCandies`},{key:"ord",label:"Inventario Vendedor",to:`${a}/productsVendorsCandies`},{key:"cli",label:"Saldos Pendientes",to:`${a}/customersCandies`},{key:"trx",label:"Ventas del dia",to:`${a}/transactionCandies`},{key:"cier",label:"Cierre de ventas",to:`${a}/cierreVentasCandies`},{key:"cash",label:"Entregas Efectivo ",to:`${a}/cashDeliveries`},{key:"items",label:"Productos",to:`${a}/productsCandies`},{key:"precios",label:"Precio Ventas",to:`${a}/productsPricesCandies`},{key:"gonper",label:"Productos Gonper",to:`${a}/notebooksInventory`}]:c?F=[{key:"venta",label:"Vender",to:`${a}/salesCandies`},{key:"precios",label:"Precios",to:`${a}/productsPricesCandies`},{key:"ped",label:"Inventario",to:`${a}/productsVendorsCandies`},{key:"cli",label:"Saldos Pendientes",to:`${a}/customersCandies`},{key:"trx",label:"Ventas",to:`${a}/transactionCandies`},{key:"cier",label:"Cierre",to:`${a}/cierreVentasCandies`}]:F=[{key:"home",label:"Inicio",to:`${a}`}])}else if(u){const D=[{key:"venta",label:"Venta",to:`${a}/salesV2`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"inv",label:"Inventario",to:`${a}/batches`},{key:"clientes",label:"Saldos Pendientes",to:`${a}/customersPollo`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`},{key:"cierre",label:"Cierre",to:`${a}/bills`}];sn(s,"contador"),F=D}else l?F=[{key:"venta",label:"Venta",to:`${a}/salesV2`},{key:"cierre",label:"Cierre",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`}]:c?F=[{key:"venta",label:"Vender",to:`${a}/salesCandies`},{key:"precios",label:"Precios",to:`${a}/productsPricesCandies`},{key:"ped",label:"Inventario",to:`${a}/productsVendorsCandies`},{key:"cli",label:"Saldos Pendientes",to:`${a}/customersCandies`},{key:"trx",label:"Ventas",to:`${a}/transactionCandies`},{key:"cier",label:"Cierre",to:`${a}/cierreVentasCandies`}]:F=[{key:"home",label:"Inicio",to:`${a}`}];const k=new Set(["bills","customersPollo","transactionsPollo","batches","salesV2","financialDashboard","salesCandies","productsVendorsCandies","productsPricesCandies","transactionCandies","cierreVentasCandies","customersCandies"]);return F.filter(D=>{const pe=D.to.replace(`${a}/`,"");return k.has(pe)?Wn(s,pe,"view"):!0})},[a,m,o,h,u,l,c,d,s]);x.useEffect(()=>{if((o||h)&&w.length){try{localStorage.setItem("rubro",m)}catch{}r(w[0].to,{replace:!0})}},[m]),x.useEffect(()=>{g&&v(!1)},[n.pathname]),x.useEffect(()=>{const F=k=>{k.key==="Escape"&&v(!1)};return g&&window.addEventListener("keydown",F),()=>window.removeEventListener("keydown",F)},[g]);const j=async()=>{b(!0)},I=async()=>{try{await yD(Zd)}catch(F){console.error("signOut error:",F)}finally{try{localStorage.removeItem("user_name"),localStorage.removeItem("user_email"),localStorage.removeItem("roles"),localStorage.removeItem("role")}catch{}b(!1),v(!1),r("/")}},_=({isActive:F})=>ey("flex-1 text-center text-[11px] py-1.5 rounded-lg","leading-none select-none",F?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),S=w.length<=2,E=({isActive:F})=>ey("w-full flex items-center justify-between px-4 py-3 rounded-xl border",F?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-800 border-gray-200 hover:bg-gray-50");return i.jsxs("div",{className:"min-h-screen bg-[#f1f3f7] flex flex-col",children:[i.jsx("header",{className:"sticky top-0 z-50 bg-white border-b shadow-sm",children:i.jsxs("div",{className:"px-3 py-3 flex items-center gap-2",children:[o||h?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",onClick:()=>p("POLLO"),className:ey("px-3 py-2 rounded-2xl text-sm font-semibold",m==="POLLO"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:"Carniceria"}),i.jsx("button",{type:"button",onClick:()=>p("DULCES"),className:ey("px-3 py-2 rounded-2xl text-sm font-semibold",m==="DULCES"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:"Mr. Candy"})]}):i.jsx("div",{className:"text-sm font-semibold text-gray-800",children:l?"Pollos Bea":c?"CandyShop":"Posys"}),i.jsx("div",{className:"ml-auto flex items-center gap-2",children:i.jsx("button",{type:"button",onClick:()=>v(!0),className:"px-3 py-2 rounded-2xl bg-gray-100 text-gray-800 text-sm font-bold shadow hover:bg-gray-200","aria-label":"Abrir men",title:"Men",children:""})})]})}),g&&i.jsxs("div",{className:"fixed inset-0 z-[80]",children:[i.jsx("button",{type:"button",className:"absolute inset-0 bg-black/40",onClick:()=>v(!1),"aria-label":"Cerrar men"}),i.jsxs("aside",{className:"absolute right-0 top-0 h-full w-[86%] max-w-sm bg-white shadow-2xl border-l flex flex-col",children:[i.jsxs("div",{className:"p-4 border-b",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"font-bold text-gray-900",children:"Men"}),i.jsx("button",{type:"button",onClick:()=>v(!1),className:"px-3 py-2 rounded-xl bg-gray-100 hover:bg-gray-200",children:""})]}),i.jsx("div",{className:"mt-2 text-[20px] text-gray-600",children:typeof window<"u"&&(localStorage.getItem("user_name")||localStorage.getItem("user_email"))})]}),i.jsx("div",{className:"p-3 flex-1 overflow-y-auto space-y-2",children:w.map(F=>i.jsxs(an,{to:F.to,className:E,children:[i.jsx("span",{className:"font-semibold",children:F.label}),i.jsx("span",{className:"text-sm opacity-80",children:""})]},F.key))}),i.jsxs("div",{className:"p-3 border-t space-y-2 pb-[calc(12px+env(safe-area-inset-bottom))]",children:[i.jsx("button",{onClick:j,className:"w-full px-4 py-3 rounded-xl bg-red-500 text-white font-semibold shadow hover:bg-red-600",children:"Cerrar sesin"}),y&&i.jsxs("div",{className:"fixed inset-0 z-[120] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/20",onClick:()=>b(!1)}),i.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-lg z-[130] w-[90%] max-w-sm",children:[i.jsx("div",{className:"font-semibold mb-3",children:"Ests seguro de cerrar sesin?"}),i.jsxs("div",{className:"flex gap-2 justify-end",children:[i.jsx("button",{onClick:()=>b(!1),className:"px-3 py-2 rounded bg-gray-200",children:"No"}),i.jsx("button",{onClick:I,className:"px-3 py-2 rounded bg-red-500 text-white",children:"SI"})]})]})]})]})]})]}),i.jsx("main",{className:ey("flex-1 overflow-y-auto px-3 pt-3",S?"pb-[calc(92px+env(safe-area-inset-bottom))]":"pb-[calc(16px+env(safe-area-inset-bottom))]"),children:i.jsx(dY,{})}),S&&i.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-50 bg-white border-t shadow-md pb-[env(safe-area-inset-bottom)]",children:i.jsx("div",{className:"max-w-3xl mx-auto px-2 py-1.5 flex gap-1.5",children:w.map(F=>i.jsx(an,{to:F.to,className:_,children:F.label},F.key))})})]})}const Aee=6048e5,Uye=864e5,Qye=6e4,Vye=36e5,Hye=1e3,c9=Symbol.for("constructDateFrom");function Gi(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&c9 in t?t[c9](e):t instanceof Date?new t.constructor(e):new Date(e)}function Js(t,e){return Gi(e||t,t)}function h6(t,e,r){const n=Js(t,r==null?void 0:r.in);return isNaN(e)?Gi((r==null?void 0:r.in)||t,NaN):(e&&n.setDate(n.getDate()+e),n)}function $ye(t,e,r){const n=Js(t,r==null?void 0:r.in);if(isNaN(e))return Gi(t,NaN);const a=n.getDate(),s=Gi(t,n.getTime());s.setMonth(n.getMonth()+e+1,0);const o=s.getDate();return a>=o?s:(n.setFullYear(s.getFullYear(),s.getMonth(),a),n)}let Gye={};function o1(){return Gye}function um(t,e){var l,c,u,d;const r=o1(),n=(e==null?void 0:e.weekStartsOn)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,a=Js(t,e==null?void 0:e.in),s=a.getDay(),o=(s<n?7:0)+s-n;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function Pv(t,e){return um(t,{...e,weekStartsOn:1})}function mee(t,e){const r=Js(t,e==null?void 0:e.in),n=r.getFullYear(),a=Gi(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const s=Pv(a),o=Gi(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=Pv(o);return r.getTime()>=s.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function oS(t){const e=Js(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function Kye(t,...e){const r=Gi.bind(null,e.find(n=>typeof n=="object"));return e.map(r)}function u9(t,e){const r=Js(t,e==null?void 0:e.in);return r.setHours(0,0,0,0),r}function qye(t,e,r){const[n,a]=Kye(r==null?void 0:r.in,t,e),s=u9(n),o=u9(a),l=+s-oS(s),c=+o-oS(o);return Math.round((l-c)/Uye)}function zye(t,e){const r=mee(t,e),n=Gi(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),Pv(n)}function Wye(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function A6(t){return!(!Wye(t)&&typeof t!="number"||isNaN(+Js(t)))}function vd(t,e){const r=Js(t,e==null?void 0:e.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function yd(t,e){const r=Js(t,e==null?void 0:e.in);return r.setDate(1),r.setHours(0,0,0,0),r}function Xye(t,e){const r=Js(t,e==null?void 0:e.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const Yye={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Jye=(t,e,r)=>{let n;const a=Yye[t];return typeof a=="string"?n=a:e===1?n=a.one:n=a.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function p3(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const Zye={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},ebe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},tbe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},rbe={date:p3({formats:Zye,defaultWidth:"full"}),time:p3({formats:ebe,defaultWidth:"full"}),dateTime:p3({formats:tbe,defaultWidth:"full"})},nbe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},abe=(t,e,r,n)=>nbe[t];function ty(t){return(e,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=r!=null&&r.width?String(r.width):o;a=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;a=t.values[l]||t.values[o]}const s=t.argumentCallback?t.argumentCallback(e):e;return a[s]}}const sbe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},ibe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},obe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},lbe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},cbe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},ube={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},dbe=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},fbe={ordinalNumber:dbe,era:ty({values:sbe,defaultWidth:"wide"}),quarter:ty({values:ibe,defaultWidth:"wide",argumentCallback:t=>t-1}),month:ty({values:obe,defaultWidth:"wide"}),day:ty({values:lbe,defaultWidth:"wide"}),dayPeriod:ty({values:cbe,defaultWidth:"wide",formattingValues:ube,defaultFormattingWidth:"wide"})};function ry(t){return(e,r={})=>{const n=r.width,a=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],s=e.match(a);if(!s)return null;const o=s[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?Abe(l,f=>f.test(o)):hbe(l,f=>f.test(o));let u;u=t.valueCallback?t.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;const d=e.slice(o.length);return{value:u,rest:d}}}function hbe(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function Abe(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function mbe(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const a=n[0],s=e.match(t.parsePattern);if(!s)return null;let o=t.valueCallback?t.valueCallback(s[0]):s[0];o=r.valueCallback?r.valueCallback(o):o;const l=e.slice(a.length);return{value:o,rest:l}}}const pbe=/^(\d+)(th|st|nd|rd)?/i,gbe=/\d+/i,xbe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},vbe={any:[/^b/i,/^(a|c)/i]},ybe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},bbe={any:[/1/i,/2/i,/3/i,/4/i]},wbe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Nbe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Cbe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},_be={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Ebe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Sbe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Ibe={ordinalNumber:mbe({matchPattern:pbe,parsePattern:gbe,valueCallback:t=>parseInt(t,10)}),era:ry({matchPatterns:xbe,defaultMatchWidth:"wide",parsePatterns:vbe,defaultParseWidth:"any"}),quarter:ry({matchPatterns:ybe,defaultMatchWidth:"wide",parsePatterns:bbe,defaultParseWidth:"any",valueCallback:t=>t+1}),month:ry({matchPatterns:wbe,defaultMatchWidth:"wide",parsePatterns:Nbe,defaultParseWidth:"any"}),day:ry({matchPatterns:Cbe,defaultMatchWidth:"wide",parsePatterns:_be,defaultParseWidth:"any"}),dayPeriod:ry({matchPatterns:Ebe,defaultMatchWidth:"any",parsePatterns:Sbe,defaultParseWidth:"any"})},pee={code:"en-US",formatDistance:Jye,formatLong:rbe,formatRelative:abe,localize:fbe,match:Ibe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function jbe(t,e){const r=Js(t,e==null?void 0:e.in);return qye(r,Xye(r))+1}function gee(t,e){const r=Js(t,e==null?void 0:e.in),n=+Pv(r)-+zye(r);return Math.round(n/Aee)+1}function m6(t,e){var d,f,A,h;const r=Js(t,e==null?void 0:e.in),n=r.getFullYear(),a=o1(),s=(e==null?void 0:e.firstWeekContainsDate)??((f=(d=e==null?void 0:e.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??a.firstWeekContainsDate??((h=(A=a.locale)==null?void 0:A.options)==null?void 0:h.firstWeekContainsDate)??1,o=Gi((e==null?void 0:e.in)||t,0);o.setFullYear(n+1,0,s),o.setHours(0,0,0,0);const l=um(o,e),c=Gi((e==null?void 0:e.in)||t,0);c.setFullYear(n,0,s),c.setHours(0,0,0,0);const u=um(c,e);return+r>=+l?n+1:+r>=+u?n:n-1}function Pbe(t,e){var l,c,u,d;const r=o1(),n=(e==null?void 0:e.firstWeekContainsDate)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,a=m6(t,e),s=Gi((e==null?void 0:e.in)||t,0);return s.setFullYear(a,0,n),s.setHours(0,0,0,0),um(s,e)}function xee(t,e){const r=Js(t,e==null?void 0:e.in),n=+um(r,e)-+Pbe(r,e);return Math.round(n/Aee)+1}function Ta(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const ZA={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return Ta(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):Ta(r+1,2)},d(t,e){return Ta(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return Ta(t.getHours()%12||12,e.length)},H(t,e){return Ta(t.getHours(),e.length)},m(t,e){return Ta(t.getMinutes(),e.length)},s(t,e){return Ta(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Ta(a,e.length)}},zg={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},d9={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return ZA.y(t,e)},Y:function(t,e,r,n){const a=m6(t,n),s=a>0?a:1-a;if(e==="YY"){const o=s%100;return Ta(o,2)}return e==="Yo"?r.ordinalNumber(s,{unit:"year"}):Ta(s,e.length)},R:function(t,e){const r=mee(t);return Ta(r,e.length)},u:function(t,e){const r=t.getFullYear();return Ta(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return Ta(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return Ta(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return ZA.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return Ta(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const a=xee(t,n);return e==="wo"?r.ordinalNumber(a,{unit:"week"}):Ta(a,e.length)},I:function(t,e,r){const n=gee(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):Ta(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):ZA.d(t,e)},D:function(t,e,r){const n=jbe(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Ta(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const a=t.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(s);case"ee":return Ta(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const a=t.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(s);case"cc":return Ta(s,e.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),a=n===0?7:n;switch(e){case"i":return String(a);case"ii":return Ta(a,e.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const a=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let a;switch(n===12?a=zg.noon:n===0?a=zg.midnight:a=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let a;switch(n>=17?a=zg.evening:n>=12?a=zg.afternoon:n>=4?a=zg.morning:a=zg.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return ZA.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):ZA.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Ta(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):Ta(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):ZA.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):ZA.s(t,e)},S:function(t,e){return ZA.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return h9(n);case"XXXX":case"XX":return Ym(n);case"XXXXX":case"XXX":default:return Ym(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return h9(n);case"xxxx":case"xx":return Ym(n);case"xxxxx":case"xxx":default:return Ym(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+f9(n,":");case"OOOO":default:return"GMT"+Ym(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+f9(n,":");case"zzzz":default:return"GMT"+Ym(n,":")}},t:function(t,e,r){const n=Math.trunc(+t/1e3);return Ta(n,e.length)},T:function(t,e,r){return Ta(+t,e.length)}};function f9(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),a=Math.trunc(n/60),s=n%60;return s===0?r+String(a):r+String(a)+e+Ta(s,2)}function h9(t,e){return t%60===0?(t>0?"-":"+")+Ta(Math.abs(t)/60,2):Ym(t,e)}function Ym(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),a=Ta(Math.trunc(n/60),2),s=Ta(n%60,2);return r+a+e+s}const A9=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},vee=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},Bbe=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return A9(t,e);let s;switch(n){case"P":s=e.dateTime({width:"short"});break;case"PP":s=e.dateTime({width:"medium"});break;case"PPP":s=e.dateTime({width:"long"});break;case"PPPP":default:s=e.dateTime({width:"full"});break}return s.replace("{{date}}",A9(n,e)).replace("{{time}}",vee(a,e))},zT={p:vee,P:Bbe},Tbe=/^D+$/,kbe=/^Y+$/,Fbe=["D","DD","YY","YYYY"];function yee(t){return Tbe.test(t)}function bee(t){return kbe.test(t)}function WT(t,e,r){const n=Obe(t,e,r);if(console.warn(n),Fbe.includes(t))throw new RangeError(n)}function Obe(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Dbe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Rbe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Mbe=/^'([^]*?)'?$/,Lbe=/''/g,Ube=/[a-zA-Z]/;function Nr(t,e,r){var d,f,A,h;const n=o1(),a=n.locale??pee,s=n.firstWeekContainsDate??((f=(d=n.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??1,o=n.weekStartsOn??((h=(A=n.locale)==null?void 0:A.options)==null?void 0:h.weekStartsOn)??0,l=Js(t,r==null?void 0:r.in);if(!A6(l))throw new RangeError("Invalid time value");let c=e.match(Rbe).map(m=>{const p=m[0];if(p==="p"||p==="P"){const g=zT[p];return g(m,a.formatLong)}return m}).join("").match(Dbe).map(m=>{if(m==="''")return{isToken:!1,value:"'"};const p=m[0];if(p==="'")return{isToken:!1,value:Qbe(m)};if(d9[p])return{isToken:!0,value:m};if(p.match(Ube))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:m}});a.localize.preprocessor&&(c=a.localize.preprocessor(l,c));const u={firstWeekContainsDate:s,weekStartsOn:o,locale:a};return c.map(m=>{if(!m.isToken)return m.value;const p=m.value;(bee(p)||yee(p))&&WT(p,e,String(t));const g=d9[p[0]];return g(l,p,a.localize,u)}).join("")}function Qbe(t){const e=t.match(Mbe);return e?e[1].replace(Lbe,"'"):t}function Vbe(){return Object.assign({},o1())}function Hbe(t,e){const r=Js(t,e==null?void 0:e.in).getDay();return r===0?7:r}function $be(t,e){const r=Gbe(e)?new e(0):Gi(e,0);return r.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),r.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),r}function Gbe(t){var e;return typeof t=="function"&&((e=t.prototype)==null?void 0:e.constructor)===t}const Kbe=10;class wee{constructor(){pr(this,"subPriority",0)}validate(e,r){return!0}}class qbe extends wee{constructor(e,r,n,a,s){super(),this.value=e,this.validateValue=r,this.setValue=n,this.priority=a,s&&(this.subPriority=s)}validate(e,r){return this.validateValue(e,this.value,r)}set(e,r,n){return this.setValue(e,r,this.value,n)}}class zbe extends wee{constructor(r,n){super();pr(this,"priority",Kbe);pr(this,"subPriority",-1);this.context=r||(a=>Gi(n,a))}set(r,n){return n.timestampIsSet?r:Gi(r,$be(r,this.context))}}let ya=class{run(e,r,n,a){const s=this.parse(e,r,n,a);return s?{setter:new qbe(s.value,this.validate,this.set,this.priority,this.subPriority),rest:s.rest}:null}validate(e,r,n){return!0}};class Wbe extends ya{constructor(){super(...arguments);pr(this,"priority",140);pr(this,"incompatibleTokens",["R","u","t","T"])}parse(r,n,a){switch(n){case"G":case"GG":case"GGG":return a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"});case"GGGGG":return a.era(r,{width:"narrow"});case"GGGG":default:return a.era(r,{width:"wide"})||a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"})}}set(r,n,a){return n.era=a,r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}}const ji={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Bf={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Pi(t,e){return t&&{value:e(t.value),rest:t.rest}}function Ks(t,e){const r=e.match(t);return r?{value:parseInt(r[0],10),rest:e.slice(r[0].length)}:null}function Tf(t,e){const r=e.match(t);if(!r)return null;if(r[0]==="Z")return{value:0,rest:e.slice(1)};const n=r[1]==="+"?1:-1,a=r[2]?parseInt(r[2],10):0,s=r[3]?parseInt(r[3],10):0,o=r[5]?parseInt(r[5],10):0;return{value:n*(a*Vye+s*Qye+o*Hye),rest:e.slice(r[0].length)}}function Nee(t){return Ks(ji.anyDigitsSigned,t)}function fi(t,e){switch(t){case 1:return Ks(ji.singleDigit,e);case 2:return Ks(ji.twoDigits,e);case 3:return Ks(ji.threeDigits,e);case 4:return Ks(ji.fourDigits,e);default:return Ks(new RegExp("^\\d{1,"+t+"}"),e)}}function lS(t,e){switch(t){case 1:return Ks(ji.singleDigitSigned,e);case 2:return Ks(ji.twoDigitsSigned,e);case 3:return Ks(ji.threeDigitsSigned,e);case 4:return Ks(ji.fourDigitsSigned,e);default:return Ks(new RegExp("^-?\\d{1,"+t+"}"),e)}}function p6(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function Cee(t,e){const r=e>0,n=r?e:1-e;let a;if(n<=50)a=t||100;else{const s=n+50,o=Math.trunc(s/100)*100,l=t>=s%100;a=t+o-(l?100:0)}return r?a:1-a}function _ee(t){return t%400===0||t%4===0&&t%100!==0}class Xbe extends ya{constructor(){super(...arguments);pr(this,"priority",130);pr(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(r,n,a){const s=o=>({year:o,isTwoDigitYear:n==="yy"});switch(n){case"y":return Pi(fi(4,r),s);case"yo":return Pi(a.ordinalNumber(r,{unit:"year"}),s);default:return Pi(fi(n.length,r),s)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,a){const s=r.getFullYear();if(a.isTwoDigitYear){const l=Cee(a.year,s);return r.setFullYear(l,0,1),r.setHours(0,0,0,0),r}const o=!("era"in n)||n.era===1?a.year:1-a.year;return r.setFullYear(o,0,1),r.setHours(0,0,0,0),r}}class Ybe extends ya{constructor(){super(...arguments);pr(this,"priority",130);pr(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(r,n,a){const s=o=>({year:o,isTwoDigitYear:n==="YY"});switch(n){case"Y":return Pi(fi(4,r),s);case"Yo":return Pi(a.ordinalNumber(r,{unit:"year"}),s);default:return Pi(fi(n.length,r),s)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,a,s){const o=m6(r,s);if(a.isTwoDigitYear){const c=Cee(a.year,o);return r.setFullYear(c,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),um(r,s)}const l=!("era"in n)||n.era===1?a.year:1-a.year;return r.setFullYear(l,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),um(r,s)}}class Jbe extends ya{constructor(){super(...arguments);pr(this,"priority",130);pr(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(r,n){return lS(n==="R"?4:n.length,r)}set(r,n,a){const s=Gi(r,0);return s.setFullYear(a,0,4),s.setHours(0,0,0,0),Pv(s)}}class Zbe extends ya{constructor(){super(...arguments);pr(this,"priority",130);pr(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(r,n){return lS(n==="u"?4:n.length,r)}set(r,n,a){return r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}}class e2e extends ya{constructor(){super(...arguments);pr(this,"priority",120);pr(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"Q":case"QQ":return fi(n.length,r);case"Qo":return a.ordinalNumber(r,{unit:"quarter"});case"QQQ":return a.quarter(r,{width:"abbreviated",context:"formatting"})||a.quarter(r,{width:"narrow",context:"formatting"});case"QQQQQ":return a.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(r,{width:"wide",context:"formatting"})||a.quarter(r,{width:"abbreviated",context:"formatting"})||a.quarter(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=1&&n<=4}set(r,n,a){return r.setMonth((a-1)*3,1),r.setHours(0,0,0,0),r}}class t2e extends ya{constructor(){super(...arguments);pr(this,"priority",120);pr(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"q":case"qq":return fi(n.length,r);case"qo":return a.ordinalNumber(r,{unit:"quarter"});case"qqq":return a.quarter(r,{width:"abbreviated",context:"standalone"})||a.quarter(r,{width:"narrow",context:"standalone"});case"qqqqq":return a.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(r,{width:"wide",context:"standalone"})||a.quarter(r,{width:"abbreviated",context:"standalone"})||a.quarter(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=1&&n<=4}set(r,n,a){return r.setMonth((a-1)*3,1),r.setHours(0,0,0,0),r}}class r2e extends ya{constructor(){super(...arguments);pr(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);pr(this,"priority",110)}parse(r,n,a){const s=o=>o-1;switch(n){case"M":return Pi(Ks(ji.month,r),s);case"MM":return Pi(fi(2,r),s);case"Mo":return Pi(a.ordinalNumber(r,{unit:"month"}),s);case"MMM":return a.month(r,{width:"abbreviated",context:"formatting"})||a.month(r,{width:"narrow",context:"formatting"});case"MMMMM":return a.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(r,{width:"wide",context:"formatting"})||a.month(r,{width:"abbreviated",context:"formatting"})||a.month(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=11}set(r,n,a){return r.setMonth(a,1),r.setHours(0,0,0,0),r}}class n2e extends ya{constructor(){super(...arguments);pr(this,"priority",110);pr(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(r,n,a){const s=o=>o-1;switch(n){case"L":return Pi(Ks(ji.month,r),s);case"LL":return Pi(fi(2,r),s);case"Lo":return Pi(a.ordinalNumber(r,{unit:"month"}),s);case"LLL":return a.month(r,{width:"abbreviated",context:"standalone"})||a.month(r,{width:"narrow",context:"standalone"});case"LLLLL":return a.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(r,{width:"wide",context:"standalone"})||a.month(r,{width:"abbreviated",context:"standalone"})||a.month(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=11}set(r,n,a){return r.setMonth(a,1),r.setHours(0,0,0,0),r}}function a2e(t,e,r){const n=Js(t,r==null?void 0:r.in),a=xee(n,r)-e;return n.setDate(n.getDate()-a*7),Js(n,r==null?void 0:r.in)}class s2e extends ya{constructor(){super(...arguments);pr(this,"priority",100);pr(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(r,n,a){switch(n){case"w":return Ks(ji.week,r);case"wo":return a.ordinalNumber(r,{unit:"week"});default:return fi(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,a,s){return um(a2e(r,a,s),s)}}function i2e(t,e,r){const n=Js(t,r==null?void 0:r.in),a=gee(n,r)-e;return n.setDate(n.getDate()-a*7),n}class o2e extends ya{constructor(){super(...arguments);pr(this,"priority",100);pr(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(r,n,a){switch(n){case"I":return Ks(ji.week,r);case"Io":return a.ordinalNumber(r,{unit:"week"});default:return fi(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,a){return Pv(i2e(r,a))}}const l2e=[31,28,31,30,31,30,31,31,30,31,30,31],c2e=[31,29,31,30,31,30,31,31,30,31,30,31];class u2e extends ya{constructor(){super(...arguments);pr(this,"priority",90);pr(this,"subPriority",1);pr(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"d":return Ks(ji.date,r);case"do":return a.ordinalNumber(r,{unit:"date"});default:return fi(n.length,r)}}validate(r,n){const a=r.getFullYear(),s=_ee(a),o=r.getMonth();return s?n>=1&&n<=c2e[o]:n>=1&&n<=l2e[o]}set(r,n,a){return r.setDate(a),r.setHours(0,0,0,0),r}}class d2e extends ya{constructor(){super(...arguments);pr(this,"priority",90);pr(this,"subpriority",1);pr(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(r,n,a){switch(n){case"D":case"DD":return Ks(ji.dayOfYear,r);case"Do":return a.ordinalNumber(r,{unit:"date"});default:return fi(n.length,r)}}validate(r,n){const a=r.getFullYear();return _ee(a)?n>=1&&n<=366:n>=1&&n<=365}set(r,n,a){return r.setMonth(0,a),r.setHours(0,0,0,0),r}}function g6(t,e,r){var f,A,h,m;const n=o1(),a=(r==null?void 0:r.weekStartsOn)??((A=(f=r==null?void 0:r.locale)==null?void 0:f.options)==null?void 0:A.weekStartsOn)??n.weekStartsOn??((m=(h=n.locale)==null?void 0:h.options)==null?void 0:m.weekStartsOn)??0,s=Js(t,r==null?void 0:r.in),o=s.getDay(),c=(e%7+7)%7,u=7-a,d=e<0||e>6?e-(o+u)%7:(c+u)%7-(o+u)%7;return h6(s,d,r)}class f2e extends ya{constructor(){super(...arguments);pr(this,"priority",90);pr(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"E":case"EE":case"EEE":return a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"EEEEE":return a.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"EEEE":default:return a.day(r,{width:"wide",context:"formatting"})||a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,a,s){return r=g6(r,a,s),r.setHours(0,0,0,0),r}}class h2e extends ya{constructor(){super(...arguments);pr(this,"priority",90);pr(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(r,n,a,s){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+s.weekStartsOn+6)%7+c};switch(n){case"e":case"ee":return Pi(fi(n.length,r),o);case"eo":return Pi(a.ordinalNumber(r,{unit:"day"}),o);case"eee":return a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"eeeee":return a.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"eeee":default:return a.day(r,{width:"wide",context:"formatting"})||a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,a,s){return r=g6(r,a,s),r.setHours(0,0,0,0),r}}class A2e extends ya{constructor(){super(...arguments);pr(this,"priority",90);pr(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(r,n,a,s){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+s.weekStartsOn+6)%7+c};switch(n){case"c":case"cc":return Pi(fi(n.length,r),o);case"co":return Pi(a.ordinalNumber(r,{unit:"day"}),o);case"ccc":return a.day(r,{width:"abbreviated",context:"standalone"})||a.day(r,{width:"short",context:"standalone"})||a.day(r,{width:"narrow",context:"standalone"});case"ccccc":return a.day(r,{width:"narrow",context:"standalone"});case"cccccc":return a.day(r,{width:"short",context:"standalone"})||a.day(r,{width:"narrow",context:"standalone"});case"cccc":default:return a.day(r,{width:"wide",context:"standalone"})||a.day(r,{width:"abbreviated",context:"standalone"})||a.day(r,{width:"short",context:"standalone"})||a.day(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=6}set(r,n,a,s){return r=g6(r,a,s),r.setHours(0,0,0,0),r}}function m2e(t,e,r){const n=Js(t,r==null?void 0:r.in),a=Hbe(n,r),s=e-a;return h6(n,s,r)}class p2e extends ya{constructor(){super(...arguments);pr(this,"priority",90);pr(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(r,n,a){const s=o=>o===0?7:o;switch(n){case"i":case"ii":return fi(n.length,r);case"io":return a.ordinalNumber(r,{unit:"day"});case"iii":return Pi(a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"}),s);case"iiiii":return Pi(a.day(r,{width:"narrow",context:"formatting"}),s);case"iiiiii":return Pi(a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"}),s);case"iiii":default:return Pi(a.day(r,{width:"wide",context:"formatting"})||a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"}),s)}}validate(r,n){return n>=1&&n<=7}set(r,n,a){return r=m2e(r,a),r.setHours(0,0,0,0),r}}class g2e extends ya{constructor(){super(...arguments);pr(this,"priority",80);pr(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(r,n,a){switch(n){case"a":case"aa":case"aaa":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaaa":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})||a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,a){return r.setHours(p6(a),0,0,0),r}}class x2e extends ya{constructor(){super(...arguments);pr(this,"priority",80);pr(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(r,n,a){switch(n){case"b":case"bb":case"bbb":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbbb":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})||a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,a){return r.setHours(p6(a),0,0,0),r}}class v2e extends ya{constructor(){super(...arguments);pr(this,"priority",80);pr(this,"incompatibleTokens",["a","b","t","T"])}parse(r,n,a){switch(n){case"B":case"BB":case"BBB":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBBB":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})||a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,a){return r.setHours(p6(a),0,0,0),r}}class y2e extends ya{constructor(){super(...arguments);pr(this,"priority",70);pr(this,"incompatibleTokens",["H","K","k","t","T"])}parse(r,n,a){switch(n){case"h":return Ks(ji.hour12h,r);case"ho":return a.ordinalNumber(r,{unit:"hour"});default:return fi(n.length,r)}}validate(r,n){return n>=1&&n<=12}set(r,n,a){const s=r.getHours()>=12;return s&&a<12?r.setHours(a+12,0,0,0):!s&&a===12?r.setHours(0,0,0,0):r.setHours(a,0,0,0),r}}class b2e extends ya{constructor(){super(...arguments);pr(this,"priority",70);pr(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(r,n,a){switch(n){case"H":return Ks(ji.hour23h,r);case"Ho":return a.ordinalNumber(r,{unit:"hour"});default:return fi(n.length,r)}}validate(r,n){return n>=0&&n<=23}set(r,n,a){return r.setHours(a,0,0,0),r}}class w2e extends ya{constructor(){super(...arguments);pr(this,"priority",70);pr(this,"incompatibleTokens",["h","H","k","t","T"])}parse(r,n,a){switch(n){case"K":return Ks(ji.hour11h,r);case"Ko":return a.ordinalNumber(r,{unit:"hour"});default:return fi(n.length,r)}}validate(r,n){return n>=0&&n<=11}set(r,n,a){return r.getHours()>=12&&a<12?r.setHours(a+12,0,0,0):r.setHours(a,0,0,0),r}}class N2e extends ya{constructor(){super(...arguments);pr(this,"priority",70);pr(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(r,n,a){switch(n){case"k":return Ks(ji.hour24h,r);case"ko":return a.ordinalNumber(r,{unit:"hour"});default:return fi(n.length,r)}}validate(r,n){return n>=1&&n<=24}set(r,n,a){const s=a<=24?a%24:a;return r.setHours(s,0,0,0),r}}class C2e extends ya{constructor(){super(...arguments);pr(this,"priority",60);pr(this,"incompatibleTokens",["t","T"])}parse(r,n,a){switch(n){case"m":return Ks(ji.minute,r);case"mo":return a.ordinalNumber(r,{unit:"minute"});default:return fi(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,a){return r.setMinutes(a,0,0),r}}class _2e extends ya{constructor(){super(...arguments);pr(this,"priority",50);pr(this,"incompatibleTokens",["t","T"])}parse(r,n,a){switch(n){case"s":return Ks(ji.second,r);case"so":return a.ordinalNumber(r,{unit:"second"});default:return fi(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,a){return r.setSeconds(a,0),r}}class E2e extends ya{constructor(){super(...arguments);pr(this,"priority",30);pr(this,"incompatibleTokens",["t","T"])}parse(r,n){const a=s=>Math.trunc(s*Math.pow(10,-n.length+3));return Pi(fi(n.length,r),a)}set(r,n,a){return r.setMilliseconds(a),r}}class S2e extends ya{constructor(){super(...arguments);pr(this,"priority",10);pr(this,"incompatibleTokens",["t","T","x"])}parse(r,n){switch(n){case"X":return Tf(Bf.basicOptionalMinutes,r);case"XX":return Tf(Bf.basic,r);case"XXXX":return Tf(Bf.basicOptionalSeconds,r);case"XXXXX":return Tf(Bf.extendedOptionalSeconds,r);case"XXX":default:return Tf(Bf.extended,r)}}set(r,n,a){return n.timestampIsSet?r:Gi(r,r.getTime()-oS(r)-a)}}class I2e extends ya{constructor(){super(...arguments);pr(this,"priority",10);pr(this,"incompatibleTokens",["t","T","X"])}parse(r,n){switch(n){case"x":return Tf(Bf.basicOptionalMinutes,r);case"xx":return Tf(Bf.basic,r);case"xxxx":return Tf(Bf.basicOptionalSeconds,r);case"xxxxx":return Tf(Bf.extendedOptionalSeconds,r);case"xxx":default:return Tf(Bf.extended,r)}}set(r,n,a){return n.timestampIsSet?r:Gi(r,r.getTime()-oS(r)-a)}}class j2e extends ya{constructor(){super(...arguments);pr(this,"priority",40);pr(this,"incompatibleTokens","*")}parse(r){return Nee(r)}set(r,n,a){return[Gi(r,a*1e3),{timestampIsSet:!0}]}}class P2e extends ya{constructor(){super(...arguments);pr(this,"priority",20);pr(this,"incompatibleTokens","*")}parse(r){return Nee(r)}set(r,n,a){return[Gi(r,a),{timestampIsSet:!0}]}}const B2e={G:new Wbe,y:new Xbe,Y:new Ybe,R:new Jbe,u:new Zbe,Q:new e2e,q:new t2e,M:new r2e,L:new n2e,w:new s2e,I:new o2e,d:new u2e,D:new d2e,E:new f2e,e:new h2e,c:new A2e,i:new p2e,a:new g2e,b:new x2e,B:new v2e,h:new y2e,H:new b2e,K:new w2e,k:new N2e,m:new C2e,s:new _2e,S:new E2e,X:new S2e,x:new I2e,t:new j2e,T:new P2e},T2e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,k2e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,F2e=/^'([^]*?)'?$/,O2e=/''/g,D2e=/\S/,R2e=/[a-zA-Z]/;function cS(t,e,r,n){var g,v,y,b;const a=()=>Gi(r,NaN),s=Vbe(),o=s.locale??pee,l=s.firstWeekContainsDate??((v=(g=s.locale)==null?void 0:g.options)==null?void 0:v.firstWeekContainsDate)??1,c=s.weekStartsOn??((b=(y=s.locale)==null?void 0:y.options)==null?void 0:b.weekStartsOn)??0;if(!e)return t?a():Js(r,n==null?void 0:n.in);const u={firstWeekContainsDate:l,weekStartsOn:c,locale:o},d=[new zbe(n==null?void 0:n.in,r)],f=e.match(k2e).map(w=>{const j=w[0];if(j in zT){const I=zT[j];return I(w,o.formatLong)}return w}).join("").match(T2e),A=[];for(let w of f){bee(w)&&WT(w,e,t),yee(w)&&WT(w,e,t);const j=w[0],I=B2e[j];if(I){const{incompatibleTokens:_}=I;if(Array.isArray(_)){const E=A.find(F=>_.includes(F.token)||F.token===j);if(E)throw new RangeError(`The format string mustn't contain \`${E.fullToken}\` and \`${w}\` at the same time`)}else if(I.incompatibleTokens==="*"&&A.length>0)throw new RangeError(`The format string mustn't contain \`${w}\` and any other token at the same time`);A.push({token:j,fullToken:w});const S=I.run(t,w,o.match,u);if(!S)return a();d.push(S.setter),t=S.rest}else{if(j.match(R2e))throw new RangeError("Format string contains an unescaped latin alphabet character `"+j+"`");if(w==="''"?w="'":j==="'"&&(w=M2e(w)),t.indexOf(w)===0)t=t.slice(w.length);else return a()}}if(t.length>0&&D2e.test(t))return a();const h=d.map(w=>w.priority).sort((w,j)=>j-w).filter((w,j,I)=>I.indexOf(w)===j).map(w=>d.filter(j=>j.priority===w).sort((j,I)=>I.subPriority-j.subPriority)).map(w=>w[0]);let m=Js(r,n==null?void 0:n.in);if(isNaN(+m))return a();const p={};for(const w of h){if(!w.validate(m,u))return a();const j=w.set(m,p,u);Array.isArray(j)?(m=j[0],Object.assign(p,j[1])):m=j}return m}function M2e(t){return t.match(F2e)[1].replace(O2e,"'")}function Eee(t,e,r){return h6(t,-14,r)}function L2e(t,e,r){return $ye(t,-1,r)}/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var XT=function(t,e){return XT=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},XT(t,e)};function df(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");XT(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var YT=function(){return YT=Object.assign||function(e){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},YT.apply(this,arguments)};function tc(t,e,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?s(d.value):a(d.value).then(l,c)}u((n=n.apply(t,[])).next())})}function jl(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=u[0]&2?a.return:u[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,u[1])).done)return s;switch(a=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],a=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function YN(t,e,r){if(arguments.length===2)for(var n=0,a=e.length,s;n<a;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||e)}var sA=function(){function t(e,r,n,a){this.left=e,this.top=r,this.width=n,this.height=a}return t.prototype.add=function(e,r,n,a){return new t(this.left+e,this.top+r,this.width+n,this.height+a)},t.fromClientRect=function(e,r){return new t(r.left+e.windowBounds.left,r.top+e.windowBounds.top,r.width,r.height)},t.fromDOMRectList=function(e,r){var n=Array.from(r).find(function(a){return a.width!==0});return n?new t(n.left+e.windowBounds.left,n.top+e.windowBounds.top,n.width,n.height):t.EMPTY},t.EMPTY=new t(0,0,0,0),t}(),Oj=function(t,e){return sA.fromClientRect(t,e.getBoundingClientRect())},U2e=function(t){var e=t.body,r=t.documentElement;if(!e||!r)throw new Error("Unable to get document size");var n=Math.max(Math.max(e.scrollWidth,r.scrollWidth),Math.max(e.offsetWidth,r.offsetWidth),Math.max(e.clientWidth,r.clientWidth)),a=Math.max(Math.max(e.scrollHeight,r.scrollHeight),Math.max(e.offsetHeight,r.offsetHeight),Math.max(e.clientHeight,r.clientHeight));return new sA(0,0,n,a)},Dj=function(t){for(var e=[],r=0,n=t.length;r<n;){var a=t.charCodeAt(r++);if(a>=55296&&a<=56319&&r<n){var s=t.charCodeAt(r++);(s&64512)===56320?e.push(((a&1023)<<10)+(s&1023)+65536):(e.push(a),r--)}else e.push(a)}return e},wi=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var n=[],a=-1,s="";++a<r;){var o=t[a];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(a+1===r||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},m9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Q2e=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var JN=0;JN<m9.length;JN++)Q2e[m9.charCodeAt(JN)]=JN;var p9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ky=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var ZN=0;ZN<p9.length;ZN++)ky[p9.charCodeAt(ZN)]=ZN;var V2e=function(t){var e=t.length*.75,r=t.length,n,a=0,s,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var u=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),d=Array.isArray(u)?u:new Uint8Array(u);for(n=0;n<r;n+=4)s=ky[t.charCodeAt(n)],o=ky[t.charCodeAt(n+1)],l=ky[t.charCodeAt(n+2)],c=ky[t.charCodeAt(n+3)],d[a++]=s<<2|o>>4,d[a++]=(o&15)<<4|l>>2,d[a++]=(l&3)<<6|c&63;return u},H2e=function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r.push(t[n+1]<<8|t[n]);return r},$2e=function(t){for(var e=t.length,r=[],n=0;n<e;n+=4)r.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return r},Cp=5,x6=11,g3=2,G2e=x6-Cp,See=65536>>Cp,K2e=1<<Cp,x3=K2e-1,q2e=1024>>Cp,z2e=See+q2e,W2e=z2e,X2e=32,Y2e=W2e+X2e,J2e=65536>>x6,Z2e=1<<G2e,ewe=Z2e-1,g9=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},twe=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},rwe=function(t,e){var r=V2e(t),n=Array.isArray(r)?$2e(r):new Uint32Array(r),a=Array.isArray(r)?H2e(r):new Uint16Array(r),s=24,o=g9(a,s/2,n[4]/2),l=n[5]===2?g9(a,(s+n[4])/2):twe(n,Math.ceil((s+n[4])/4));return new nwe(n[0],n[1],n[2],n[3],o,l)},nwe=function(){function t(e,r,n,a,s,o){this.initialValue=e,this.errorValue=r,this.highStart=n,this.highValueIndex=a,this.index=s,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>Cp],r=(r<<g3)+(e&x3),this.data[r];if(e<=65535)return r=this.index[See+(e-55296>>Cp)],r=(r<<g3)+(e&x3),this.data[r];if(e<this.highStart)return r=Y2e-J2e+(e>>x6),r=this.index[r],r+=e>>Cp&ewe,r=this.index[r],r=(r<<g3)+(e&x3),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),x9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",awe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var eC=0;eC<x9.length;eC++)awe[x9.charCodeAt(eC)]=eC;var swe="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",v9=50,iwe=1,Iee=2,jee=3,owe=4,lwe=5,y9=7,Pee=8,b9=9,B0=10,JT=11,w9=12,ZT=13,cwe=14,Fy=15,ek=16,tC=17,ny=18,uwe=19,N9=20,tk=21,ay=22,v3=23,Wg=24,nu=25,Oy=26,Dy=27,Xg=28,dwe=29,lp=30,fwe=31,rC=32,nC=33,rk=34,nk=35,ak=36,m2=37,sk=38,eE=39,tE=40,y3=41,Bee=42,hwe=43,Awe=[9001,65288],Tee="!",zn="",aC="",ik=rwe(swe),dh=[lp,ak],ok=[iwe,Iee,jee,lwe],kee=[B0,Pee],C9=[Dy,Oy],mwe=ok.concat(kee),_9=[sk,eE,tE,rk,nk],pwe=[Fy,ZT],gwe=function(t,e){e===void 0&&(e="strict");var r=[],n=[],a=[];return t.forEach(function(s,o){var l=ik.get(s);if(l>v9?(a.push(!0),l-=v9):a.push(!1),["normal","auto","loose"].indexOf(e)!==-1&&[8208,8211,12316,12448].indexOf(s)!==-1)return n.push(o),r.push(ek);if(l===owe||l===JT){if(o===0)return n.push(o),r.push(lp);var c=r[o-1];return mwe.indexOf(c)===-1?(n.push(n[o-1]),r.push(c)):(n.push(o),r.push(lp))}if(n.push(o),l===fwe)return r.push(e==="strict"?tk:m2);if(l===Bee||l===dwe)return r.push(lp);if(l===hwe)return s>=131072&&s<=196605||s>=196608&&s<=262141?r.push(m2):r.push(lp);r.push(l)}),[n,r,a]},b3=function(t,e,r,n){var a=n[r];if(Array.isArray(t)?t.indexOf(a)!==-1:t===a)for(var s=r;s<=n.length;){s++;var o=n[s];if(o===e)return!0;if(o!==B0)break}if(a===B0)for(var s=r;s>0;){s--;var l=n[s];if(Array.isArray(t)?t.indexOf(l)!==-1:t===l)for(var c=r;c<=n.length;){c++;var o=n[c];if(o===e)return!0;if(o!==B0)break}if(l!==B0)break}return!1},E9=function(t,e){for(var r=t;r>=0;){var n=e[r];if(n===B0)r--;else return n}return 0},xwe=function(t,e,r,n,a){if(r[n]===0)return zn;var s=n-1;if(Array.isArray(a)&&a[s]===!0)return zn;var o=s-1,l=s+1,c=e[s],u=o>=0?e[o]:0,d=e[l];if(c===Iee&&d===jee)return zn;if(ok.indexOf(c)!==-1)return Tee;if(ok.indexOf(d)!==-1||kee.indexOf(d)!==-1)return zn;if(E9(s,e)===Pee)return aC;if(ik.get(t[s])===JT||(c===rC||c===nC)&&ik.get(t[l])===JT||c===y9||d===y9||c===b9||[B0,ZT,Fy].indexOf(c)===-1&&d===b9||[tC,ny,uwe,Wg,Xg].indexOf(d)!==-1||E9(s,e)===ay||b3(v3,ay,s,e)||b3([tC,ny],tk,s,e)||b3(w9,w9,s,e))return zn;if(c===B0)return aC;if(c===v3||d===v3)return zn;if(d===ek||c===ek)return aC;if([ZT,Fy,tk].indexOf(d)!==-1||c===cwe||u===ak&&pwe.indexOf(c)!==-1||c===Xg&&d===ak||d===N9||dh.indexOf(d)!==-1&&c===nu||dh.indexOf(c)!==-1&&d===nu||c===Dy&&[m2,rC,nC].indexOf(d)!==-1||[m2,rC,nC].indexOf(c)!==-1&&d===Oy||dh.indexOf(c)!==-1&&C9.indexOf(d)!==-1||C9.indexOf(c)!==-1&&dh.indexOf(d)!==-1||[Dy,Oy].indexOf(c)!==-1&&(d===nu||[ay,Fy].indexOf(d)!==-1&&e[l+1]===nu)||[ay,Fy].indexOf(c)!==-1&&d===nu||c===nu&&[nu,Xg,Wg].indexOf(d)!==-1)return zn;if([nu,Xg,Wg,tC,ny].indexOf(d)!==-1)for(var f=s;f>=0;){var A=e[f];if(A===nu)return zn;if([Xg,Wg].indexOf(A)!==-1)f--;else break}if([Dy,Oy].indexOf(d)!==-1)for(var f=[tC,ny].indexOf(c)!==-1?o:s;f>=0;){var A=e[f];if(A===nu)return zn;if([Xg,Wg].indexOf(A)!==-1)f--;else break}if(sk===c&&[sk,eE,rk,nk].indexOf(d)!==-1||[eE,rk].indexOf(c)!==-1&&[eE,tE].indexOf(d)!==-1||[tE,nk].indexOf(c)!==-1&&d===tE||_9.indexOf(c)!==-1&&[N9,Oy].indexOf(d)!==-1||_9.indexOf(d)!==-1&&c===Dy||dh.indexOf(c)!==-1&&dh.indexOf(d)!==-1||c===Wg&&dh.indexOf(d)!==-1||dh.concat(nu).indexOf(c)!==-1&&d===ay&&Awe.indexOf(t[l])===-1||dh.concat(nu).indexOf(d)!==-1&&c===ny)return zn;if(c===y3&&d===y3){for(var h=r[s],m=1;h>0&&(h--,e[h]===y3);)m++;if(m%2!==0)return zn}return c===rC&&d===nC?zn:aC},vwe=function(t,e){e||(e={lineBreak:"normal",wordBreak:"normal"});var r=gwe(t,e.lineBreak),n=r[0],a=r[1],s=r[2];(e.wordBreak==="break-all"||e.wordBreak==="break-word")&&(a=a.map(function(l){return[nu,lp,Bee].indexOf(l)!==-1?m2:l}));var o=e.wordBreak==="keep-all"?s.map(function(l,c){return l&&t[c]>=19968&&t[c]<=40959}):void 0;return[n,a,o]},ywe=function(){function t(e,r,n,a){this.codePoints=e,this.required=r===Tee,this.start=n,this.end=a}return t.prototype.slice=function(){return wi.apply(void 0,this.codePoints.slice(this.start,this.end))},t}(),bwe=function(t,e){var r=Dj(t),n=vwe(r,e),a=n[0],s=n[1],o=n[2],l=r.length,c=0,u=0;return{next:function(){if(u>=l)return{done:!0,value:null};for(var d=zn;u<l&&(d=xwe(r,s,a,++u,o))===zn;);if(d!==zn||u===l){var f=new ywe(r,d,c,u);return c=u,{value:f,done:!1}}return{done:!0,value:null}}}},wwe=1,Nwe=2,_w=4,S9=8,uS=10,I9=47,db=92,Cwe=9,_we=32,sC=34,sy=61,Ewe=35,Swe=36,Iwe=37,iC=39,oC=40,iy=41,jwe=95,jc=45,Pwe=33,Bwe=60,Twe=62,kwe=64,Fwe=91,Owe=93,Dwe=61,Rwe=123,lC=63,Mwe=125,j9=124,Lwe=126,Uwe=128,P9=65533,w3=42,Ap=43,Qwe=44,Vwe=58,Hwe=59,p2=46,$we=0,Gwe=8,Kwe=11,qwe=14,zwe=31,Wwe=127,bf=-1,Fee=48,Oee=97,Dee=101,Xwe=102,Ywe=117,Jwe=122,Ree=65,Mee=69,Lee=70,Zwe=85,eNe=90,Tl=function(t){return t>=Fee&&t<=57},tNe=function(t){return t>=55296&&t<=57343},Yg=function(t){return Tl(t)||t>=Ree&&t<=Lee||t>=Oee&&t<=Xwe},rNe=function(t){return t>=Oee&&t<=Jwe},nNe=function(t){return t>=Ree&&t<=eNe},aNe=function(t){return rNe(t)||nNe(t)},sNe=function(t){return t>=Uwe},cC=function(t){return t===uS||t===Cwe||t===_we},dS=function(t){return aNe(t)||sNe(t)||t===jwe},B9=function(t){return dS(t)||Tl(t)||t===jc},iNe=function(t){return t>=$we&&t<=Gwe||t===Kwe||t>=qwe&&t<=zwe||t===Wwe},A0=function(t,e){return t!==db?!1:e!==uS},uC=function(t,e,r){return t===jc?dS(e)||A0(e,r):dS(t)?!0:!!(t===db&&A0(t,e))},N3=function(t,e,r){return t===Ap||t===jc?Tl(e)?!0:e===p2&&Tl(r):Tl(t===p2?e:t)},oNe=function(t){var e=0,r=1;(t[e]===Ap||t[e]===jc)&&(t[e]===jc&&(r=-1),e++);for(var n=[];Tl(t[e]);)n.push(t[e++]);var a=n.length?parseInt(wi.apply(void 0,n),10):0;t[e]===p2&&e++;for(var s=[];Tl(t[e]);)s.push(t[e++]);var o=s.length,l=o?parseInt(wi.apply(void 0,s),10):0;(t[e]===Mee||t[e]===Dee)&&e++;var c=1;(t[e]===Ap||t[e]===jc)&&(t[e]===jc&&(c=-1),e++);for(var u=[];Tl(t[e]);)u.push(t[e++]);var d=u.length?parseInt(wi.apply(void 0,u),10):0;return r*(a+l*Math.pow(10,-o))*Math.pow(10,c*d)},lNe={type:2},cNe={type:3},uNe={type:4},dNe={type:13},fNe={type:8},hNe={type:21},ANe={type:9},mNe={type:10},pNe={type:11},gNe={type:12},xNe={type:14},dC={type:23},vNe={type:1},yNe={type:25},bNe={type:24},wNe={type:26},NNe={type:27},CNe={type:28},_Ne={type:29},ENe={type:31},lk={type:32},Uee=function(){function t(){this._value=[]}return t.prototype.write=function(e){this._value=this._value.concat(Dj(e))},t.prototype.read=function(){for(var e=[],r=this.consumeToken();r!==lk;)e.push(r),r=this.consumeToken();return e},t.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case sC:return this.consumeStringToken(sC);case Ewe:var r=this.peekCodePoint(0),n=this.peekCodePoint(1),a=this.peekCodePoint(2);if(B9(r)||A0(n,a)){var s=uC(r,n,a)?Nwe:wwe,o=this.consumeName();return{type:5,value:o,flags:s}}break;case Swe:if(this.peekCodePoint(0)===sy)return this.consumeCodePoint(),dNe;break;case iC:return this.consumeStringToken(iC);case oC:return lNe;case iy:return cNe;case w3:if(this.peekCodePoint(0)===sy)return this.consumeCodePoint(),xNe;break;case Ap:if(N3(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case Qwe:return uNe;case jc:var l=e,c=this.peekCodePoint(0),u=this.peekCodePoint(1);if(N3(l,c,u))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(uC(l,c,u))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(c===jc&&u===Twe)return this.consumeCodePoint(),this.consumeCodePoint(),bNe;break;case p2:if(N3(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case I9:if(this.peekCodePoint(0)===w3)for(this.consumeCodePoint();;){var d=this.consumeCodePoint();if(d===w3&&(d=this.consumeCodePoint(),d===I9))return this.consumeToken();if(d===bf)return this.consumeToken()}break;case Vwe:return wNe;case Hwe:return NNe;case Bwe:if(this.peekCodePoint(0)===Pwe&&this.peekCodePoint(1)===jc&&this.peekCodePoint(2)===jc)return this.consumeCodePoint(),this.consumeCodePoint(),yNe;break;case kwe:var f=this.peekCodePoint(0),A=this.peekCodePoint(1),h=this.peekCodePoint(2);if(uC(f,A,h)){var o=this.consumeName();return{type:7,value:o}}break;case Fwe:return CNe;case db:if(A0(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case Owe:return _Ne;case Dwe:if(this.peekCodePoint(0)===sy)return this.consumeCodePoint(),fNe;break;case Rwe:return pNe;case Mwe:return gNe;case Ywe:case Zwe:var m=this.peekCodePoint(0),p=this.peekCodePoint(1);return m===Ap&&(Yg(p)||p===lC)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case j9:if(this.peekCodePoint(0)===sy)return this.consumeCodePoint(),ANe;if(this.peekCodePoint(0)===j9)return this.consumeCodePoint(),hNe;break;case Lwe:if(this.peekCodePoint(0)===sy)return this.consumeCodePoint(),mNe;break;case bf:return lk}return cC(e)?(this.consumeWhiteSpace(),ENe):Tl(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):dS(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:wi(e)}},t.prototype.consumeCodePoint=function(){var e=this._value.shift();return typeof e>"u"?-1:e},t.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},t.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},t.prototype.consumeUnicodeRangeToken=function(){for(var e=[],r=this.consumeCodePoint();Yg(r)&&e.length<6;)e.push(r),r=this.consumeCodePoint();for(var n=!1;r===lC&&e.length<6;)e.push(r),r=this.consumeCodePoint(),n=!0;if(n){var a=parseInt(wi.apply(void 0,e.map(function(c){return c===lC?Fee:c})),16),s=parseInt(wi.apply(void 0,e.map(function(c){return c===lC?Lee:c})),16);return{type:30,start:a,end:s}}var o=parseInt(wi.apply(void 0,e),16);if(this.peekCodePoint(0)===jc&&Yg(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var l=[];Yg(r)&&l.length<6;)l.push(r),r=this.consumeCodePoint();var s=parseInt(wi.apply(void 0,l),16);return{type:30,start:o,end:s}}else return{type:30,start:o,end:o}},t.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return e.toLowerCase()==="url"&&this.peekCodePoint(0)===oC?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===oC?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},t.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===bf)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===iC||r===sC){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===bf||this.peekCodePoint(0)===iy)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),dC)}for(;;){var a=this.consumeCodePoint();if(a===bf||a===iy)return{type:22,value:wi.apply(void 0,e)};if(cC(a))return this.consumeWhiteSpace(),this.peekCodePoint(0)===bf||this.peekCodePoint(0)===iy?(this.consumeCodePoint(),{type:22,value:wi.apply(void 0,e)}):(this.consumeBadUrlRemnants(),dC);if(a===sC||a===iC||a===oC||iNe(a))return this.consumeBadUrlRemnants(),dC;if(a===db)if(A0(a,this.peekCodePoint(0)))e.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),dC;else e.push(a)}},t.prototype.consumeWhiteSpace=function(){for(;cC(this.peekCodePoint(0));)this.consumeCodePoint()},t.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===iy||e===bf)return;A0(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},t.prototype.consumeStringSlice=function(e){for(var r=5e4,n="";e>0;){var a=Math.min(r,e);n+=wi.apply(void 0,this._value.splice(0,a)),e-=a}return this._value.shift(),n},t.prototype.consumeStringToken=function(e){var r="",n=0;do{var a=this._value[n];if(a===bf||a===void 0||a===e)return r+=this.consumeStringSlice(n),{type:0,value:r};if(a===uS)return this._value.splice(0,n),vNe;if(a===db){var s=this._value[n+1];s!==bf&&s!==void 0&&(s===uS?(r+=this.consumeStringSlice(n),n=-1,this._value.shift()):A0(a,s)&&(r+=this.consumeStringSlice(n),r+=wi(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},t.prototype.consumeNumber=function(){var e=[],r=_w,n=this.peekCodePoint(0);for((n===Ap||n===jc)&&e.push(this.consumeCodePoint());Tl(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0);var a=this.peekCodePoint(1);if(n===p2&&Tl(a))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=S9;Tl(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0),a=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((n===Mee||n===Dee)&&((a===Ap||a===jc)&&Tl(s)||Tl(a)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=S9;Tl(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[oNe(e),r]},t.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),r=e[0],n=e[1],a=this.peekCodePoint(0),s=this.peekCodePoint(1),o=this.peekCodePoint(2);if(uC(a,s,o)){var l=this.consumeName();return{type:15,number:r,flags:n,unit:l}}return a===Iwe?(this.consumeCodePoint(),{type:16,number:r,flags:n}):{type:17,number:r,flags:n}},t.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(Yg(e)){for(var r=wi(e);Yg(this.peekCodePoint(0))&&r.length<6;)r+=wi(this.consumeCodePoint());cC(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(r,16);return n===0||tNe(n)||n>1114111?P9:n}return e===bf?P9:e},t.prototype.consumeName=function(){for(var e="";;){var r=this.consumeCodePoint();if(B9(r))e+=wi(r);else if(A0(r,this.peekCodePoint(0)))e+=wi(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),e}},t}(),Qee=function(){function t(e){this._tokens=e}return t.create=function(e){var r=new Uee;return r.write(e),new t(r.read())},t.parseValue=function(e){return t.create(e).parseComponentValue()},t.parseValues=function(e){return t.create(e).parseComponentValues()},t.prototype.parseComponentValue=function(){for(var e=this.consumeToken();e.type===31;)e=this.consumeToken();if(e.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var r=this.consumeComponentValue();do e=this.consumeToken();while(e.type===31);if(e.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},t.prototype.parseComponentValues=function(){for(var e=[];;){var r=this.consumeComponentValue();if(r.type===32)return e;e.push(r),e.push()}},t.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},t.prototype.consumeSimpleBlock=function(e){for(var r={type:e,values:[]},n=this.consumeToken();;){if(n.type===32||INe(n,e))return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue()),n=this.consumeToken()}},t.prototype.consumeFunction=function(e){for(var r={name:e.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue())}},t.prototype.consumeToken=function(){var e=this._tokens.shift();return typeof e>"u"?lk:e},t.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},t}(),Ew=function(t){return t.type===15},l1=function(t){return t.type===17},$a=function(t){return t.type===20},SNe=function(t){return t.type===0},ck=function(t,e){return $a(t)&&t.value===e},Vee=function(t){return t.type!==31},Bv=function(t){return t.type!==31&&t.type!==4},Jf=function(t){var e=[],r=[];return t.forEach(function(n){if(n.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");e.push(r),r=[];return}n.type!==31&&r.push(n)}),r.length&&e.push(r),e},INe=function(t,e){return e===11&&t.type===12||e===28&&t.type===29?!0:e===2&&t.type===3},dm=function(t){return t.type===17||t.type===15},Ui=function(t){return t.type===16||dm(t)},Hee=function(t){return t.length>1?[t[0],t[1]]:[t[0]]},cl={type:17,number:0,flags:_w},v6={type:16,number:50,flags:_w},T0={type:16,number:100,flags:_w},Ry=function(t,e,r){var n=t[0],a=t[1];return[ns(n,e),ns(typeof a<"u"?a:n,r)]},ns=function(t,e){if(t.type===16)return t.number/100*e;if(Ew(t))switch(t.unit){case"rem":case"em":return 16*t.number;case"px":default:return t.number}return t.number},$ee="deg",Gee="grad",Kee="rad",qee="turn",Rj={name:"angle",parse:function(t,e){if(e.type===15)switch(e.unit){case $ee:return Math.PI*e.number/180;case Gee:return Math.PI/200*e.number;case Kee:return e.number;case qee:return Math.PI*2*e.number}throw new Error("Unsupported angle type")}},zee=function(t){return t.type===15&&(t.unit===$ee||t.unit===Gee||t.unit===Kee||t.unit===qee)},Wee=function(t){var e=t.filter($a).map(function(r){return r.value}).join(" ");switch(e){case"to bottom right":case"to right bottom":case"left top":case"top left":return[cl,cl];case"to top":case"bottom":return nd(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[cl,T0];case"to right":case"left":return nd(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[T0,T0];case"to bottom":case"top":return nd(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[T0,cl];case"to left":case"right":return nd(270)}return 0},nd=function(t){return Math.PI*t/180},X0={name:"color",parse:function(t,e){if(e.type===18){var r=jNe[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return r(t,e.values)}if(e.type===5){if(e.value.length===3){var n=e.value.substring(0,1),a=e.value.substring(1,2),s=e.value.substring(2,3);return k0(parseInt(n+n,16),parseInt(a+a,16),parseInt(s+s,16),1)}if(e.value.length===4){var n=e.value.substring(0,1),a=e.value.substring(1,2),s=e.value.substring(2,3),o=e.value.substring(3,4);return k0(parseInt(n+n,16),parseInt(a+a,16),parseInt(s+s,16),parseInt(o+o,16)/255)}if(e.value.length===6){var n=e.value.substring(0,2),a=e.value.substring(2,4),s=e.value.substring(4,6);return k0(parseInt(n,16),parseInt(a,16),parseInt(s,16),1)}if(e.value.length===8){var n=e.value.substring(0,2),a=e.value.substring(2,4),s=e.value.substring(4,6),o=e.value.substring(6,8);return k0(parseInt(n,16),parseInt(a,16),parseInt(s,16),parseInt(o,16)/255)}}if(e.type===20){var l=Gh[e.value.toUpperCase()];if(typeof l<"u")return l}return Gh.TRANSPARENT}},Y0=function(t){return(255&t)===0},Co=function(t){var e=255&t,r=255&t>>8,n=255&t>>16,a=255&t>>24;return e<255?"rgba("+a+","+n+","+r+","+e/255+")":"rgb("+a+","+n+","+r+")"},k0=function(t,e,r,n){return(t<<24|e<<16|r<<8|Math.round(n*255)<<0)>>>0},T9=function(t,e){if(t.type===17)return t.number;if(t.type===16){var r=e===3?1:255;return e===3?t.number/100*r:Math.round(t.number/100*r)}return 0},k9=function(t,e){var r=e.filter(Bv);if(r.length===3){var n=r.map(T9),a=n[0],s=n[1],o=n[2];return k0(a,s,o,1)}if(r.length===4){var l=r.map(T9),a=l[0],s=l[1],o=l[2],c=l[3];return k0(a,s,o,c)}return 0};function C3(t,e,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(e-t)*r*6+t:r<1/2?e:r<2/3?(e-t)*6*(2/3-r)+t:t}var F9=function(t,e){var r=e.filter(Bv),n=r[0],a=r[1],s=r[2],o=r[3],l=(n.type===17?nd(n.number):Rj.parse(t,n))/(Math.PI*2),c=Ui(a)?a.number/100:0,u=Ui(s)?s.number/100:0,d=typeof o<"u"&&Ui(o)?ns(o,1):1;if(c===0)return k0(u*255,u*255,u*255,1);var f=u<=.5?u*(c+1):u+c-u*c,A=u*2-f,h=C3(A,f,l+1/3),m=C3(A,f,l),p=C3(A,f,l-1/3);return k0(h*255,m*255,p*255,d)},jNe={hsl:F9,hsla:F9,rgb:k9,rgba:k9},fb=function(t,e){return X0.parse(t,Qee.create(e).parseComponentValue())},Gh={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},PNe={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if($a(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},BNe={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Mj=function(t,e){var r=X0.parse(t,e[0]),n=e[1];return n&&Ui(n)?{color:r,stop:n}:{color:r,stop:null}},O9=function(t,e){var r=t[0],n=t[t.length-1];r.stop===null&&(r.stop=cl),n.stop===null&&(n.stop=T0);for(var a=[],s=0,o=0;o<t.length;o++){var l=t[o].stop;if(l!==null){var c=ns(l,e);c>s?a.push(c):a.push(s),s=c}else a.push(null)}for(var u=null,o=0;o<a.length;o++){var d=a[o];if(d===null)u===null&&(u=o);else if(u!==null){for(var f=o-u,A=a[u-1],h=(d-A)/(f+1),m=1;m<=f;m++)a[u+m-1]=h*m;u=null}}return t.map(function(p,g){var v=p.color;return{color:v,stop:Math.max(Math.min(1,a[g]/e),0)}})},TNe=function(t,e,r){var n=e/2,a=r/2,s=ns(t[0],e)-n,o=a-ns(t[1],r);return(Math.atan2(o,s)+Math.PI*2)%(Math.PI*2)},kNe=function(t,e,r){var n=typeof t=="number"?t:TNe(t,e,r),a=Math.abs(e*Math.sin(n))+Math.abs(r*Math.cos(n)),s=e/2,o=r/2,l=a/2,c=Math.sin(n-Math.PI/2)*l,u=Math.cos(n-Math.PI/2)*l;return[a,s-u,s+u,o-c,o+c]},Md=function(t,e){return Math.sqrt(t*t+e*e)},D9=function(t,e,r,n,a){var s=[[0,0],[0,e],[t,0],[t,e]];return s.reduce(function(o,l){var c=l[0],u=l[1],d=Md(r-c,n-u);return(a?d<o.optimumDistance:d>o.optimumDistance)?{optimumCorner:l,optimumDistance:d}:o},{optimumDistance:a?1/0:-1/0,optimumCorner:null}).optimumCorner},FNe=function(t,e,r,n,a){var s=0,o=0;switch(t.size){case 0:t.shape===0?s=o=Math.min(Math.abs(e),Math.abs(e-n),Math.abs(r),Math.abs(r-a)):t.shape===1&&(s=Math.min(Math.abs(e),Math.abs(e-n)),o=Math.min(Math.abs(r),Math.abs(r-a)));break;case 2:if(t.shape===0)s=o=Math.min(Md(e,r),Md(e,r-a),Md(e-n,r),Md(e-n,r-a));else if(t.shape===1){var l=Math.min(Math.abs(r),Math.abs(r-a))/Math.min(Math.abs(e),Math.abs(e-n)),c=D9(n,a,e,r,!0),u=c[0],d=c[1];s=Md(u-e,(d-r)/l),o=l*s}break;case 1:t.shape===0?s=o=Math.max(Math.abs(e),Math.abs(e-n),Math.abs(r),Math.abs(r-a)):t.shape===1&&(s=Math.max(Math.abs(e),Math.abs(e-n)),o=Math.max(Math.abs(r),Math.abs(r-a)));break;case 3:if(t.shape===0)s=o=Math.max(Md(e,r),Md(e,r-a),Md(e-n,r),Md(e-n,r-a));else if(t.shape===1){var l=Math.max(Math.abs(r),Math.abs(r-a))/Math.max(Math.abs(e),Math.abs(e-n)),f=D9(n,a,e,r,!1),u=f[0],d=f[1];s=Md(u-e,(d-r)/l),o=l*s}break}return Array.isArray(t.size)&&(s=ns(t.size[0],n),o=t.size.length===2?ns(t.size[1],a):s),[s,o]},ONe=function(t,e){var r=nd(180),n=[];return Jf(e).forEach(function(a,s){if(s===0){var o=a[0];if(o.type===20&&o.value==="to"){r=Wee(a);return}else if(zee(o)){r=Rj.parse(t,o);return}}var l=Mj(t,a);n.push(l)}),{angle:r,stops:n,type:1}},fC=function(t,e){var r=nd(180),n=[];return Jf(e).forEach(function(a,s){if(s===0){var o=a[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){r=Wee(a);return}else if(zee(o)){r=(Rj.parse(t,o)+nd(270))%nd(360);return}}var l=Mj(t,a);n.push(l)}),{angle:r,stops:n,type:1}},DNe=function(t,e){var r=nd(180),n=[],a=1,s=0,o=3,l=[];return Jf(e).forEach(function(c,u){var d=c[0];if(u===0){if($a(d)&&d.value==="linear"){a=1;return}else if($a(d)&&d.value==="radial"){a=2;return}}if(d.type===18){if(d.name==="from"){var f=X0.parse(t,d.values[0]);n.push({stop:cl,color:f})}else if(d.name==="to"){var f=X0.parse(t,d.values[0]);n.push({stop:T0,color:f})}else if(d.name==="color-stop"){var A=d.values.filter(Bv);if(A.length===2){var f=X0.parse(t,A[1]),h=A[0];l1(h)&&n.push({stop:{type:16,number:h.number*100,flags:h.flags},color:f})}}}}),a===1?{angle:(r+nd(180))%nd(360),stops:n,type:a}:{size:o,shape:s,stops:n,position:l,type:a}},Xee="closest-side",Yee="farthest-side",Jee="closest-corner",Zee="farthest-corner",ete="circle",tte="ellipse",rte="cover",nte="contain",RNe=function(t,e){var r=0,n=3,a=[],s=[];return Jf(e).forEach(function(o,l){var c=!0;if(l===0){var u=!1;c=o.reduce(function(f,A){if(u)if($a(A))switch(A.value){case"center":return s.push(v6),f;case"top":case"left":return s.push(cl),f;case"right":case"bottom":return s.push(T0),f}else(Ui(A)||dm(A))&&s.push(A);else if($a(A))switch(A.value){case ete:return r=0,!1;case tte:return r=1,!1;case"at":return u=!0,!1;case Xee:return n=0,!1;case rte:case Yee:return n=1,!1;case nte:case Jee:return n=2,!1;case Zee:return n=3,!1}else if(dm(A)||Ui(A))return Array.isArray(n)||(n=[]),n.push(A),!1;return f},c)}if(c){var d=Mj(t,o);a.push(d)}}),{size:n,shape:r,stops:a,position:s,type:2}},hC=function(t,e){var r=0,n=3,a=[],s=[];return Jf(e).forEach(function(o,l){var c=!0;if(l===0?c=o.reduce(function(d,f){if($a(f))switch(f.value){case"center":return s.push(v6),!1;case"top":case"left":return s.push(cl),!1;case"right":case"bottom":return s.push(T0),!1}else if(Ui(f)||dm(f))return s.push(f),!1;return d},c):l===1&&(c=o.reduce(function(d,f){if($a(f))switch(f.value){case ete:return r=0,!1;case tte:return r=1,!1;case nte:case Xee:return n=0,!1;case Yee:return n=1,!1;case Jee:return n=2,!1;case rte:case Zee:return n=3,!1}else if(dm(f)||Ui(f))return Array.isArray(n)||(n=[]),n.push(f),!1;return d},c)),c){var u=Mj(t,o);a.push(u)}}),{size:n,shape:r,stops:a,position:s,type:2}},MNe=function(t){return t.type===1},LNe=function(t){return t.type===2},y6={name:"image",parse:function(t,e){if(e.type===22){var r={url:e.value,type:0};return t.cache.addImage(e.value),r}if(e.type===18){var n=ate[e.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return n(t,e.values)}throw new Error("Unsupported image type "+e.type)}};function UNe(t){return!(t.type===20&&t.value==="none")&&(t.type!==18||!!ate[t.name])}var ate={"linear-gradient":ONe,"-moz-linear-gradient":fC,"-ms-linear-gradient":fC,"-o-linear-gradient":fC,"-webkit-linear-gradient":fC,"radial-gradient":RNe,"-moz-radial-gradient":hC,"-ms-radial-gradient":hC,"-o-radial-gradient":hC,"-webkit-radial-gradient":hC,"-webkit-gradient":DNe},QNe={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e.filter(function(n){return Bv(n)&&UNe(n)}).map(function(n){return y6.parse(t,n)})}},VNe={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if($a(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},HNe={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(t,e){return Jf(e).map(function(r){return r.filter(Ui)}).map(Hee)}},$Ne={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(t,e){return Jf(e).map(function(r){return r.filter($a).map(function(n){return n.value}).join(" ")}).map(GNe)}},GNe=function(t){switch(t){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},iv;(function(t){t.AUTO="auto",t.CONTAIN="contain",t.COVER="cover"})(iv||(iv={}));var KNe={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(t,e){return Jf(e).map(function(r){return r.filter(qNe)})}},qNe=function(t){return $a(t)||Ui(t)},Lj=function(t){return{name:"border-"+t+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},zNe=Lj("top"),WNe=Lj("right"),XNe=Lj("bottom"),YNe=Lj("left"),Uj=function(t){return{name:"border-radius-"+t,initialValue:"0 0",prefix:!1,type:1,parse:function(e,r){return Hee(r.filter(Ui))}}},JNe=Uj("top-left"),ZNe=Uj("top-right"),eCe=Uj("bottom-right"),tCe=Uj("bottom-left"),Qj=function(t){return{name:"border-"+t+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(e,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},rCe=Qj("top"),nCe=Qj("right"),aCe=Qj("bottom"),sCe=Qj("left"),Vj=function(t){return{name:"border-"+t+"-width",initialValue:"0",type:0,prefix:!1,parse:function(e,r){return Ew(r)?r.number:0}}},iCe=Vj("top"),oCe=Vj("right"),lCe=Vj("bottom"),cCe=Vj("left"),uCe={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},dCe={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(t,e){switch(e){case"rtl":return 1;case"ltr":default:return 0}}},fCe={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(t,e){return e.filter($a).reduce(function(r,n){return r|hCe(n.value)},0)}},hCe=function(t){switch(t){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},ACe={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},mCe={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(t,e){return e.type===20&&e.value==="normal"?0:e.type===17||e.type===15?e.number:0}},fS;(function(t){t.NORMAL="normal",t.STRICT="strict"})(fS||(fS={}));var pCe={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"strict":return fS.STRICT;case"normal":default:return fS.NORMAL}}},gCe={name:"line-height",initialValue:"normal",prefix:!1,type:4},R9=function(t,e){return $a(t)&&t.value==="normal"?1.2*e:t.type===17?e*t.number:Ui(t)?ns(t,e):e},xCe={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(t,e){return e.type===20&&e.value==="none"?null:y6.parse(t,e)}},vCe={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(t,e){switch(e){case"inside":return 0;case"outside":default:return 1}}},uk={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},Hj=function(t){return{name:"margin-"+t,initialValue:"0",prefix:!1,type:4}},yCe=Hj("top"),bCe=Hj("right"),wCe=Hj("bottom"),NCe=Hj("left"),CCe={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(t,e){return e.filter($a).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},_Ce={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-word":return"break-word";case"normal":default:return"normal"}}},$j=function(t){return{name:"padding-"+t,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},ECe=$j("top"),SCe=$j("right"),ICe=$j("bottom"),jCe=$j("left"),PCe={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(t,e){switch(e){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},BCe={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(t,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},TCe={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&ck(e[0],"none")?[]:Jf(e).map(function(r){for(var n={color:Gh.TRANSPARENT,offsetX:cl,offsetY:cl,blur:cl},a=0,s=0;s<r.length;s++){var o=r[s];dm(o)?(a===0?n.offsetX=o:a===1?n.offsetY=o:n.blur=o,a++):n.color=X0.parse(t,o)}return n})}},kCe={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},FCe={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(t,e){if(e.type===20&&e.value==="none")return null;if(e.type===18){var r=RCe[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return r(e.values)}return null}},OCe=function(t){var e=t.filter(function(r){return r.type===17}).map(function(r){return r.number});return e.length===6?e:null},DCe=function(t){var e=t.filter(function(c){return c.type===17}).map(function(c){return c.number}),r=e[0],n=e[1];e[2],e[3];var a=e[4],s=e[5];e[6],e[7],e[8],e[9],e[10],e[11];var o=e[12],l=e[13];return e[14],e[15],e.length===16?[r,n,a,s,o,l]:null},RCe={matrix:OCe,matrix3d:DCe},M9={type:16,number:50,flags:_w},MCe=[M9,M9],LCe={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(t,e){var r=e.filter(Ui);return r.length!==2?MCe:[r[0],r[1]]}},UCe={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},hb;(function(t){t.NORMAL="normal",t.BREAK_ALL="break-all",t.KEEP_ALL="keep-all"})(hb||(hb={}));var QCe={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-all":return hb.BREAK_ALL;case"keep-all":return hb.KEEP_ALL;case"normal":default:return hb.NORMAL}}},VCe={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(t,e){if(e.type===20)return{auto:!0,order:0};if(l1(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},ste={name:"time",parse:function(t,e){if(e.type===15)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")}},HCe={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(t,e){return l1(e)?e.number:1}},$Ce={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},GCe={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(t,e){return e.filter($a).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},KCe={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(t,e){var r=[],n=[];return e.forEach(function(a){switch(a.type){case 20:case 0:r.push(a.value);break;case 17:r.push(a.number.toString());break;case 4:n.push(r.join(" ")),r.length=0;break}}),r.length&&n.push(r.join(" ")),n.map(function(a){return a.indexOf(" ")===-1?a:"'"+a+"'"})}},qCe={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},zCe={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(t,e){if(l1(e))return e.number;if($a(e))switch(e.value){case"bold":return 700;case"normal":default:return 400}return 400}},WCe={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.filter($a).map(function(r){return r.value})}},XCe={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},oo=function(t,e){return(t&e)!==0},YCe={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e}},JCe={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;for(var n=[],a=e.filter(Vee),s=0;s<a.length;s++){var o=a[s],l=a[s+1];if(o.type===20){var c=l&&l1(l)?l.number:1;n.push({counter:o.value,increment:c})}}return n}},ZCe={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return[];for(var r=[],n=e.filter(Vee),a=0;a<n.length;a++){var s=n[a],o=n[a+1];if($a(s)&&s.value!=="none"){var l=o&&l1(o)?o.number:0;r.push({counter:s.value,reset:l})}}return r}},e_e={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(t,e){return e.filter(Ew).map(function(r){return ste.parse(t,r)})}},t_e={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;var n=[],a=e.filter(SNe);if(a.length%2!==0)return null;for(var s=0;s<a.length;s+=2){var o=a[s].value,l=a[s+1].value;n.push({open:o,close:l})}return n}},L9=function(t,e,r){if(!t)return"";var n=t[Math.min(e,t.length-1)];return n?r?n.open:n.close:""},r_e={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&ck(e[0],"none")?[]:Jf(e).map(function(r){for(var n={color:255,offsetX:cl,offsetY:cl,blur:cl,spread:cl,inset:!1},a=0,s=0;s<r.length;s++){var o=r[s];ck(o,"inset")?n.inset=!0:dm(o)?(a===0?n.offsetX=o:a===1?n.offsetY=o:a===2?n.blur=o:n.spread=o,a++):n.color=X0.parse(t,o)}return n})}},n_e={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(t,e){var r=[0,1,2],n=[];return e.filter($a).forEach(function(a){switch(a.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),r.forEach(function(a){n.indexOf(a)===-1&&n.push(a)}),n}},a_e={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},s_e={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return Ew(e)?e.number:0}},i_e=function(){function t(e,r){var n,a;this.animationDuration=Or(e,e_e,r.animationDuration),this.backgroundClip=Or(e,PNe,r.backgroundClip),this.backgroundColor=Or(e,BNe,r.backgroundColor),this.backgroundImage=Or(e,QNe,r.backgroundImage),this.backgroundOrigin=Or(e,VNe,r.backgroundOrigin),this.backgroundPosition=Or(e,HNe,r.backgroundPosition),this.backgroundRepeat=Or(e,$Ne,r.backgroundRepeat),this.backgroundSize=Or(e,KNe,r.backgroundSize),this.borderTopColor=Or(e,zNe,r.borderTopColor),this.borderRightColor=Or(e,WNe,r.borderRightColor),this.borderBottomColor=Or(e,XNe,r.borderBottomColor),this.borderLeftColor=Or(e,YNe,r.borderLeftColor),this.borderTopLeftRadius=Or(e,JNe,r.borderTopLeftRadius),this.borderTopRightRadius=Or(e,ZNe,r.borderTopRightRadius),this.borderBottomRightRadius=Or(e,eCe,r.borderBottomRightRadius),this.borderBottomLeftRadius=Or(e,tCe,r.borderBottomLeftRadius),this.borderTopStyle=Or(e,rCe,r.borderTopStyle),this.borderRightStyle=Or(e,nCe,r.borderRightStyle),this.borderBottomStyle=Or(e,aCe,r.borderBottomStyle),this.borderLeftStyle=Or(e,sCe,r.borderLeftStyle),this.borderTopWidth=Or(e,iCe,r.borderTopWidth),this.borderRightWidth=Or(e,oCe,r.borderRightWidth),this.borderBottomWidth=Or(e,lCe,r.borderBottomWidth),this.borderLeftWidth=Or(e,cCe,r.borderLeftWidth),this.boxShadow=Or(e,r_e,r.boxShadow),this.color=Or(e,uCe,r.color),this.direction=Or(e,dCe,r.direction),this.display=Or(e,fCe,r.display),this.float=Or(e,ACe,r.cssFloat),this.fontFamily=Or(e,KCe,r.fontFamily),this.fontSize=Or(e,qCe,r.fontSize),this.fontStyle=Or(e,XCe,r.fontStyle),this.fontVariant=Or(e,WCe,r.fontVariant),this.fontWeight=Or(e,zCe,r.fontWeight),this.letterSpacing=Or(e,mCe,r.letterSpacing),this.lineBreak=Or(e,pCe,r.lineBreak),this.lineHeight=Or(e,gCe,r.lineHeight),this.listStyleImage=Or(e,xCe,r.listStyleImage),this.listStylePosition=Or(e,vCe,r.listStylePosition),this.listStyleType=Or(e,uk,r.listStyleType),this.marginTop=Or(e,yCe,r.marginTop),this.marginRight=Or(e,bCe,r.marginRight),this.marginBottom=Or(e,wCe,r.marginBottom),this.marginLeft=Or(e,NCe,r.marginLeft),this.opacity=Or(e,HCe,r.opacity);var s=Or(e,CCe,r.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=Or(e,_Ce,r.overflowWrap),this.paddingTop=Or(e,ECe,r.paddingTop),this.paddingRight=Or(e,SCe,r.paddingRight),this.paddingBottom=Or(e,ICe,r.paddingBottom),this.paddingLeft=Or(e,jCe,r.paddingLeft),this.paintOrder=Or(e,n_e,r.paintOrder),this.position=Or(e,BCe,r.position),this.textAlign=Or(e,PCe,r.textAlign),this.textDecorationColor=Or(e,$Ce,(n=r.textDecorationColor)!==null&&n!==void 0?n:r.color),this.textDecorationLine=Or(e,GCe,(a=r.textDecorationLine)!==null&&a!==void 0?a:r.textDecoration),this.textShadow=Or(e,TCe,r.textShadow),this.textTransform=Or(e,kCe,r.textTransform),this.transform=Or(e,FCe,r.transform),this.transformOrigin=Or(e,LCe,r.transformOrigin),this.visibility=Or(e,UCe,r.visibility),this.webkitTextStrokeColor=Or(e,a_e,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=Or(e,s_e,r.webkitTextStrokeWidth),this.wordBreak=Or(e,QCe,r.wordBreak),this.zIndex=Or(e,VCe,r.zIndex)}return t.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},t.prototype.isTransparent=function(){return Y0(this.backgroundColor)},t.prototype.isTransformed=function(){return this.transform!==null},t.prototype.isPositioned=function(){return this.position!==0},t.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},t.prototype.isFloating=function(){return this.float!==0},t.prototype.isInlineLevel=function(){return oo(this.display,4)||oo(this.display,33554432)||oo(this.display,268435456)||oo(this.display,536870912)||oo(this.display,67108864)||oo(this.display,134217728)},t}(),o_e=function(){function t(e,r){this.content=Or(e,YCe,r.content),this.quotes=Or(e,t_e,r.quotes)}return t}(),U9=function(){function t(e,r){this.counterIncrement=Or(e,JCe,r.counterIncrement),this.counterReset=Or(e,ZCe,r.counterReset)}return t}(),Or=function(t,e,r){var n=new Uee,a=r!==null&&typeof r<"u"?r.toString():e.initialValue;n.write(a);var s=new Qee(n.read());switch(e.type){case 2:var o=s.parseComponentValue();return e.parse(t,$a(o)?o.value:e.initialValue);case 0:return e.parse(t,s.parseComponentValue());case 1:return e.parse(t,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(e.format){case"angle":return Rj.parse(t,s.parseComponentValue());case"color":return X0.parse(t,s.parseComponentValue());case"image":return y6.parse(t,s.parseComponentValue());case"length":var l=s.parseComponentValue();return dm(l)?l:cl;case"length-percentage":var c=s.parseComponentValue();return Ui(c)?c:cl;case"time":return ste.parse(t,s.parseComponentValue())}break}},l_e="data-html2canvas-debug",c_e=function(t){var e=t.getAttribute(l_e);switch(e){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},dk=function(t,e){var r=c_e(t);return r===1||e===r},Zf=function(){function t(e,r){if(this.context=e,this.textNodes=[],this.elements=[],this.flags=0,dk(r,3))debugger;this.styles=new i_e(e,window.getComputedStyle(r,null)),Ak(r)&&(this.styles.animationDuration.some(function(n){return n>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=Oj(this.context,r),dk(r,4)&&(this.flags|=16)}return t}(),u_e="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",Q9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",My=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var AC=0;AC<Q9.length;AC++)My[Q9.charCodeAt(AC)]=AC;var d_e=function(t){var e=t.length*.75,r=t.length,n,a=0,s,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var u=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),d=Array.isArray(u)?u:new Uint8Array(u);for(n=0;n<r;n+=4)s=My[t.charCodeAt(n)],o=My[t.charCodeAt(n+1)],l=My[t.charCodeAt(n+2)],c=My[t.charCodeAt(n+3)],d[a++]=s<<2|o>>4,d[a++]=(o&15)<<4|l>>2,d[a++]=(l&3)<<6|c&63;return u},f_e=function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r.push(t[n+1]<<8|t[n]);return r},h_e=function(t){for(var e=t.length,r=[],n=0;n<e;n+=4)r.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return r},_p=5,b6=11,_3=2,A_e=b6-_p,ite=65536>>_p,m_e=1<<_p,E3=m_e-1,p_e=1024>>_p,g_e=ite+p_e,x_e=g_e,v_e=32,y_e=x_e+v_e,b_e=65536>>b6,w_e=1<<A_e,N_e=w_e-1,V9=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},C_e=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},__e=function(t,e){var r=d_e(t),n=Array.isArray(r)?h_e(r):new Uint32Array(r),a=Array.isArray(r)?f_e(r):new Uint16Array(r),s=24,o=V9(a,s/2,n[4]/2),l=n[5]===2?V9(a,(s+n[4])/2):C_e(n,Math.ceil((s+n[4])/4));return new E_e(n[0],n[1],n[2],n[3],o,l)},E_e=function(){function t(e,r,n,a,s,o){this.initialValue=e,this.errorValue=r,this.highStart=n,this.highValueIndex=a,this.index=s,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>_p],r=(r<<_3)+(e&E3),this.data[r];if(e<=65535)return r=this.index[ite+(e-55296>>_p)],r=(r<<_3)+(e&E3),this.data[r];if(e<this.highStart)return r=y_e-b_e+(e>>b6),r=this.index[r],r+=e>>_p&N_e,r=this.index[r],r=(r<<_3)+(e&E3),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),H9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",S_e=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var mC=0;mC<H9.length;mC++)S_e[H9.charCodeAt(mC)]=mC;var I_e=1,S3=2,I3=3,$9=4,G9=5,j_e=7,K9=8,j3=9,P3=10,q9=11,z9=12,W9=13,X9=14,B3=15,P_e=function(t){for(var e=[],r=0,n=t.length;r<n;){var a=t.charCodeAt(r++);if(a>=55296&&a<=56319&&r<n){var s=t.charCodeAt(r++);(s&64512)===56320?e.push(((a&1023)<<10)+(s&1023)+65536):(e.push(a),r--)}else e.push(a)}return e},B_e=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var n=[],a=-1,s="";++a<r;){var o=t[a];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(a+1===r||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},T_e=__e(u_e),Wu="",T3="",k_e=function(t){return T_e.get(t)},F_e=function(t,e,r){var n=r-2,a=e[n],s=e[r-1],o=e[r];if(s===S3&&o===I3)return Wu;if(s===S3||s===I3||s===$9||o===S3||o===I3||o===$9)return T3;if(s===K9&&[K9,j3,q9,z9].indexOf(o)!==-1||(s===q9||s===j3)&&(o===j3||o===P3)||(s===z9||s===P3)&&o===P3||o===W9||o===G9||o===j_e||s===I_e)return Wu;if(s===W9&&o===X9){for(;a===G9;)a=e[--n];if(a===X9)return Wu}if(s===B3&&o===B3){for(var l=0;a===B3;)l++,a=e[--n];if(l%2===0)return Wu}return T3},O_e=function(t){var e=P_e(t),r=e.length,n=0,a=0,s=e.map(k_e);return{next:function(){if(n>=r)return{done:!0,value:null};for(var o=Wu;n<r&&(o=F_e(e,s,++n))===Wu;);if(o!==Wu||n===r){var l=B_e.apply(null,e.slice(a,n));return a=n,{value:l,done:!1}}return{done:!0,value:null}}}},D_e=function(t){for(var e=O_e(t),r=[],n;!(n=e.next()).done;)n.value&&r.push(n.value.slice());return r},R_e=function(t){var e=123;if(t.createRange){var r=t.createRange();if(r.getBoundingClientRect){var n=t.createElement("boundtest");n.style.height=e+"px",n.style.display="block",t.body.appendChild(n),r.selectNode(n);var a=r.getBoundingClientRect(),s=Math.round(a.height);if(t.body.removeChild(n),s===e)return!0}}return!1},M_e=function(t){var e=t.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",t.body.appendChild(e);var r=t.createRange();e.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=e.firstChild,a=Dj(n.data).map(function(c){return wi(c)}),s=0,o={},l=a.every(function(c,u){r.setStart(n,s),r.setEnd(n,s+c.length);var d=r.getBoundingClientRect();s+=c.length;var f=d.x>o.x||d.y>o.y;return o=d,u===0?!0:f});return t.body.removeChild(e),l},L_e=function(){return typeof new Image().crossOrigin<"u"},U_e=function(){return typeof new XMLHttpRequest().responseType=="string"},Q_e=function(t){var e=new Image,r=t.createElement("canvas"),n=r.getContext("2d");if(!n)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(e,0,0),r.toDataURL()}catch{return!1}return!0},Y9=function(t){return t[0]===0&&t[1]===255&&t[2]===0&&t[3]===255},V_e=function(t){var e=t.createElement("canvas"),r=100;e.width=r,e.height=r;var n=e.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,r,r);var a=new Image,s=e.toDataURL();a.src=s;var o=fk(r,r,0,0,a);return n.fillStyle="red",n.fillRect(0,0,r,r),J9(o).then(function(l){n.drawImage(l,0,0);var c=n.getImageData(0,0,r,r).data;n.fillStyle="red",n.fillRect(0,0,r,r);var u=t.createElement("div");return u.style.backgroundImage="url("+s+")",u.style.height=r+"px",Y9(c)?J9(fk(r,r,0,0,u)):Promise.reject(!1)}).then(function(l){return n.drawImage(l,0,0),Y9(n.getImageData(0,0,r,r).data)}).catch(function(){return!1})},fk=function(t,e,r,n,a){var s="http://www.w3.org/2000/svg",o=document.createElementNS(s,"svg"),l=document.createElementNS(s,"foreignObject");return o.setAttributeNS(null,"width",t.toString()),o.setAttributeNS(null,"height",e.toString()),l.setAttributeNS(null,"width","100%"),l.setAttributeNS(null,"height","100%"),l.setAttributeNS(null,"x",r.toString()),l.setAttributeNS(null,"y",n.toString()),l.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(l),l.appendChild(a),o},J9=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){return e(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},nl={get SUPPORT_RANGE_BOUNDS(){var t=R_e(document);return Object.defineProperty(nl,"SUPPORT_RANGE_BOUNDS",{value:t}),t},get SUPPORT_WORD_BREAKING(){var t=nl.SUPPORT_RANGE_BOUNDS&&M_e(document);return Object.defineProperty(nl,"SUPPORT_WORD_BREAKING",{value:t}),t},get SUPPORT_SVG_DRAWING(){var t=Q_e(document);return Object.defineProperty(nl,"SUPPORT_SVG_DRAWING",{value:t}),t},get SUPPORT_FOREIGNOBJECT_DRAWING(){var t=typeof Array.from=="function"&&typeof window.fetch=="function"?V_e(document):Promise.resolve(!1);return Object.defineProperty(nl,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:t}),t},get SUPPORT_CORS_IMAGES(){var t=L_e();return Object.defineProperty(nl,"SUPPORT_CORS_IMAGES",{value:t}),t},get SUPPORT_RESPONSE_TYPE(){var t=U_e();return Object.defineProperty(nl,"SUPPORT_RESPONSE_TYPE",{value:t}),t},get SUPPORT_CORS_XHR(){var t="withCredentials"in new XMLHttpRequest;return Object.defineProperty(nl,"SUPPORT_CORS_XHR",{value:t}),t},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var t=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(nl,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:t}),t}},Ab=function(){function t(e,r){this.text=e,this.bounds=r}return t}(),H_e=function(t,e,r,n){var a=K_e(e,r),s=[],o=0;return a.forEach(function(l){if(r.textDecorationLine.length||l.trim().length>0)if(nl.SUPPORT_RANGE_BOUNDS){var c=Z9(n,o,l.length).getClientRects();if(c.length>1){var u=w6(l),d=0;u.forEach(function(A){s.push(new Ab(A,sA.fromDOMRectList(t,Z9(n,d+o,A.length).getClientRects()))),d+=A.length})}else s.push(new Ab(l,sA.fromDOMRectList(t,c)))}else{var f=n.splitText(l.length);s.push(new Ab(l,$_e(t,n))),n=f}else nl.SUPPORT_RANGE_BOUNDS||(n=n.splitText(l.length));o+=l.length}),s},$_e=function(t,e){var r=e.ownerDocument;if(r){var n=r.createElement("html2canvaswrapper");n.appendChild(e.cloneNode(!0));var a=e.parentNode;if(a){a.replaceChild(n,e);var s=Oj(t,n);return n.firstChild&&a.replaceChild(n.firstChild,n),s}}return sA.EMPTY},Z9=function(t,e,r){var n=t.ownerDocument;if(!n)throw new Error("Node has no owner document");var a=n.createRange();return a.setStart(t,e),a.setEnd(t,e+r),a},w6=function(t){if(nl.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(t)).map(function(r){return r.segment})}return D_e(t)},G_e=function(t,e){if(nl.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(t)).map(function(n){return n.segment})}return z_e(t,e)},K_e=function(t,e){return e.letterSpacing!==0?w6(t):G_e(t,e)},q_e=[32,160,4961,65792,65793,4153,4241],z_e=function(t,e){for(var r=bwe(t,{lineBreak:e.lineBreak,wordBreak:e.overflowWrap==="break-word"?"break-word":e.wordBreak}),n=[],a,s=function(){if(a.value){var o=a.value.slice(),l=Dj(o),c="";l.forEach(function(u){q_e.indexOf(u)===-1?c+=wi(u):(c.length&&n.push(c),n.push(wi(u)),c="")}),c.length&&n.push(c)}};!(a=r.next()).done;)s();return n},W_e=function(){function t(e,r,n){this.text=X_e(r.data,n.textTransform),this.textBounds=H_e(e,this.text,n,r)}return t}(),X_e=function(t,e){switch(e){case 1:return t.toLowerCase();case 3:return t.replace(Y_e,J_e);case 2:return t.toUpperCase();default:return t}},Y_e=/(^|\s|:|-|\(|\))([a-z])/g,J_e=function(t,e,r){return t.length>0?e+r.toUpperCase():t},ote=function(t){df(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.src=n.currentSrc||n.src,a.intrinsicWidth=n.naturalWidth,a.intrinsicHeight=n.naturalHeight,a.context.cache.addImage(a.src),a}return e}(Zf),lte=function(t){df(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.canvas=n,a.intrinsicWidth=n.width,a.intrinsicHeight=n.height,a}return e}(Zf),cte=function(t){df(e,t);function e(r,n){var a=t.call(this,r,n)||this,s=new XMLSerializer,o=Oj(r,n);return n.setAttribute("width",o.width+"px"),n.setAttribute("height",o.height+"px"),a.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(n)),a.intrinsicWidth=n.width.baseVal.value,a.intrinsicHeight=n.height.baseVal.value,a.context.cache.addImage(a.svg),a}return e}(Zf),ute=function(t){df(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.value=n.value,a}return e}(Zf),hk=function(t){df(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.start=n.start,a.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,a}return e}(Zf),Z_e=[{type:15,flags:0,unit:"px",number:3}],eEe=[{type:16,flags:0,number:50}],tEe=function(t){return t.width>t.height?new sA(t.left+(t.width-t.height)/2,t.top,t.height,t.height):t.width<t.height?new sA(t.left,t.top+(t.height-t.width)/2,t.width,t.width):t},rEe=function(t){var e=t.type===nEe?new Array(t.value.length+1).join(""):t.value;return e.length===0?t.placeholder||"":e},hS="checkbox",AS="radio",nEe="password",eQ=707406591,N6=function(t){df(e,t);function e(r,n){var a=t.call(this,r,n)||this;switch(a.type=n.type.toLowerCase(),a.checked=n.checked,a.value=rEe(n),(a.type===hS||a.type===AS)&&(a.styles.backgroundColor=3739148031,a.styles.borderTopColor=a.styles.borderRightColor=a.styles.borderBottomColor=a.styles.borderLeftColor=2779096575,a.styles.borderTopWidth=a.styles.borderRightWidth=a.styles.borderBottomWidth=a.styles.borderLeftWidth=1,a.styles.borderTopStyle=a.styles.borderRightStyle=a.styles.borderBottomStyle=a.styles.borderLeftStyle=1,a.styles.backgroundClip=[0],a.styles.backgroundOrigin=[0],a.bounds=tEe(a.bounds)),a.type){case hS:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=Z_e;break;case AS:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=eEe;break}return a}return e}(Zf),dte=function(t){df(e,t);function e(r,n){var a=t.call(this,r,n)||this,s=n.options[n.selectedIndex||0];return a.value=s&&s.text||"",a}return e}(Zf),fte=function(t){df(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.value=n.value,a}return e}(Zf),hte=function(t){df(e,t);function e(r,n){var a=t.call(this,r,n)||this;a.src=n.src,a.width=parseInt(n.width,10)||0,a.height=parseInt(n.height,10)||0,a.backgroundColor=a.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){a.tree=mte(r,n.contentWindow.document.documentElement);var s=n.contentWindow.document.documentElement?fb(r,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):Gh.TRANSPARENT,o=n.contentWindow.document.body?fb(r,getComputedStyle(n.contentWindow.document.body).backgroundColor):Gh.TRANSPARENT;a.backgroundColor=Y0(s)?Y0(o)?a.styles.backgroundColor:o:s}}catch{}return a}return e}(Zf),aEe=["OL","UL","MENU"],rE=function(t,e,r,n){for(var a=e.firstChild,s=void 0;a;a=s)if(s=a.nextSibling,pte(a)&&a.data.trim().length>0)r.textNodes.push(new W_e(t,a,r.styles));else if(Qx(a))if(yte(a)&&a.assignedNodes)a.assignedNodes().forEach(function(l){return rE(t,l,r,n)});else{var o=Ate(t,a);o.styles.isVisible()&&(sEe(a,o,n)?o.flags|=4:iEe(o.styles)&&(o.flags|=2),aEe.indexOf(a.tagName)!==-1&&(o.flags|=8),r.elements.push(o),a.slot,a.shadowRoot?rE(t,a.shadowRoot,o,n):!mS(a)&&!gte(a)&&!pS(a)&&rE(t,a,o,n))}},Ate=function(t,e){return mk(e)?new ote(t,e):xte(e)?new lte(t,e):gte(e)?new cte(t,e):oEe(e)?new ute(t,e):lEe(e)?new hk(t,e):cEe(e)?new N6(t,e):pS(e)?new dte(t,e):mS(e)?new fte(t,e):vte(e)?new hte(t,e):new Zf(t,e)},mte=function(t,e){var r=Ate(t,e);return r.flags|=4,rE(t,e,r,r),r},sEe=function(t,e,r){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||C6(t)&&r.styles.isTransparent()},iEe=function(t){return t.isPositioned()||t.isFloating()},pte=function(t){return t.nodeType===Node.TEXT_NODE},Qx=function(t){return t.nodeType===Node.ELEMENT_NODE},Ak=function(t){return Qx(t)&&typeof t.style<"u"&&!nE(t)},nE=function(t){return typeof t.className=="object"},oEe=function(t){return t.tagName==="LI"},lEe=function(t){return t.tagName==="OL"},cEe=function(t){return t.tagName==="INPUT"},uEe=function(t){return t.tagName==="HTML"},gte=function(t){return t.tagName==="svg"},C6=function(t){return t.tagName==="BODY"},xte=function(t){return t.tagName==="CANVAS"},tQ=function(t){return t.tagName==="VIDEO"},mk=function(t){return t.tagName==="IMG"},vte=function(t){return t.tagName==="IFRAME"},rQ=function(t){return t.tagName==="STYLE"},dEe=function(t){return t.tagName==="SCRIPT"},mS=function(t){return t.tagName==="TEXTAREA"},pS=function(t){return t.tagName==="SELECT"},yte=function(t){return t.tagName==="SLOT"},nQ=function(t){return t.tagName.indexOf("-")>0},fEe=function(){function t(){this.counters={}}return t.prototype.getCounterValue=function(e){var r=this.counters[e];return r&&r.length?r[r.length-1]:1},t.prototype.getCounterValues=function(e){var r=this.counters[e];return r||[]},t.prototype.pop=function(e){var r=this;e.forEach(function(n){return r.counters[n].pop()})},t.prototype.parse=function(e){var r=this,n=e.counterIncrement,a=e.counterReset,s=!0;n!==null&&n.forEach(function(l){var c=r.counters[l.counter];c&&l.increment!==0&&(s=!1,c.length||c.push(1),c[Math.max(0,c.length-1)]+=l.increment)});var o=[];return s&&a.forEach(function(l){var c=r.counters[l.counter];o.push(l.counter),c||(c=r.counters[l.counter]=[]),c.push(l.reset)}),o},t}(),aQ={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},sQ={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},hEe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},AEe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Jg=function(t,e,r,n,a,s){return t<e||t>r?g2(t,a,s.length>0):n.integers.reduce(function(o,l,c){for(;t>=l;)t-=l,o+=n.values[c];return o},"")+s},bte=function(t,e,r,n){var a="";do r||t--,a=n(t)+a,t/=e;while(t*e>=e);return a},xi=function(t,e,r,n,a){var s=r-e+1;return(t<0?"-":"")+(bte(Math.abs(t),s,n,function(o){return wi(Math.floor(o%s)+e)})+a)},Um=function(t,e,r){r===void 0&&(r=". ");var n=e.length;return bte(Math.abs(t),n,!1,function(a){return e[Math.floor(a%n)]})+r},wx=1,u0=2,d0=4,Ly=8,fh=function(t,e,r,n,a,s){if(t<-9999||t>9999)return g2(t,4,a.length>0);var o=Math.abs(t),l=a;if(o===0)return e[0]+l;for(var c=0;o>0&&c<=4;c++){var u=o%10;u===0&&oo(s,wx)&&l!==""?l=e[u]+l:u>1||u===1&&c===0||u===1&&c===1&&oo(s,u0)||u===1&&c===1&&oo(s,d0)&&t>100||u===1&&c>1&&oo(s,Ly)?l=e[u]+(c>0?r[c-1]:"")+l:u===1&&c>0&&(l=r[c-1]+l),o=Math.floor(o/10)}return(t<0?n:"")+l},iQ="",oQ="",lQ="",k3="",g2=function(t,e,r){var n=r?". ":"",a=r?"":"",s=r?", ":"",o=r?" ":"";switch(e){case 0:return""+o;case 1:return""+o;case 2:return""+o;case 5:var l=xi(t,48,57,!0,n);return l.length<4?"0"+l:l;case 4:return Um(t,"",a);case 6:return Jg(t,1,3999,aQ,3,n).toLowerCase();case 7:return Jg(t,1,3999,aQ,3,n);case 8:return xi(t,945,969,!1,n);case 9:return xi(t,97,122,!1,n);case 10:return xi(t,65,90,!1,n);case 11:return xi(t,1632,1641,!0,n);case 12:case 49:return Jg(t,1,9999,sQ,3,n);case 35:return Jg(t,1,9999,sQ,3,n).toLowerCase();case 13:return xi(t,2534,2543,!0,n);case 14:case 30:return xi(t,6112,6121,!0,n);case 15:return Um(t,"",a);case 16:return Um(t,"",a);case 17:case 48:return fh(t,"",iQ,"",a,u0|d0|Ly);case 47:return fh(t,"",oQ,"",a,wx|u0|d0|Ly);case 42:return fh(t,"",iQ,"",a,u0|d0|Ly);case 41:return fh(t,"",oQ,"",a,wx|u0|d0|Ly);case 26:return fh(t,"","",lQ,a,0);case 25:return fh(t,"","",lQ,a,wx|u0|d0);case 31:return fh(t,"","",k3,s,wx|u0|d0);case 33:return fh(t,"","",k3,s,0);case 32:return fh(t,"","",k3,s,wx|u0|d0);case 18:return xi(t,2406,2415,!0,n);case 20:return Jg(t,1,19999,AEe,3,n);case 21:return xi(t,2790,2799,!0,n);case 22:return xi(t,2662,2671,!0,n);case 22:return Jg(t,1,10999,hEe,3,n);case 23:return Um(t,"");case 24:return Um(t,"");case 27:return xi(t,3302,3311,!0,n);case 28:return Um(t,"",a);case 29:return Um(t,"",a);case 34:return xi(t,3792,3801,!0,n);case 37:return xi(t,6160,6169,!0,n);case 38:return xi(t,4160,4169,!0,n);case 39:return xi(t,2918,2927,!0,n);case 40:return xi(t,1776,1785,!0,n);case 43:return xi(t,3046,3055,!0,n);case 44:return xi(t,3174,3183,!0,n);case 45:return xi(t,3664,3673,!0,n);case 46:return xi(t,3872,3881,!0,n);case 3:default:return xi(t,48,57,!0,n)}},wte="data-html2canvas-ignore",cQ=function(){function t(e,r,n){if(this.context=e,this.options=n,this.scrolledElements=[],this.referenceElement=r,this.counters=new fEe,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return t.prototype.toIFrame=function(e,r){var n=this,a=mEe(e,r);if(!a.contentWindow)return Promise.reject("Unable to find iframe window");var s=e.defaultView.pageXOffset,o=e.defaultView.pageYOffset,l=a.contentWindow,c=l.document,u=xEe(a).then(function(){return tc(n,void 0,void 0,function(){var d,f;return jl(this,function(A){switch(A.label){case 0:return this.scrolledElements.forEach(wEe),l&&(l.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(l.scrollY!==r.top||l.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(l.scrollX-r.left,l.scrollY-r.top,0,0))),d=this.options.onclone,f=this.clonedReferenceElement,typeof f>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:c.fonts&&c.fonts.ready?[4,c.fonts.ready]:[3,2];case 1:A.sent(),A.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,gEe(c)]:[3,4];case 3:A.sent(),A.label=4;case 4:return typeof d=="function"?[2,Promise.resolve().then(function(){return d(c,f)}).then(function(){return a})]:[2,a]}})})});return c.open(),c.write(yEe(document.doctype)+"<html></html>"),bEe(this.referenceElement.ownerDocument,s,o),c.replaceChild(c.adoptNode(this.documentElement),c.documentElement),c.close(),u},t.prototype.createElementClone=function(e){if(dk(e,2))debugger;if(xte(e))return this.createCanvasClone(e);if(tQ(e))return this.createVideoClone(e);if(rQ(e))return this.createStyleClone(e);var r=e.cloneNode(!1);return mk(r)&&(mk(e)&&e.currentSrc&&e.currentSrc!==e.src&&(r.src=e.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),nQ(r)?this.createCustomElementClone(r):r},t.prototype.createCustomElementClone=function(e){var r=document.createElement("html2canvascustomelement");return F3(e.style,r),r},t.prototype.createStyleClone=function(e){try{var r=e.sheet;if(r&&r.cssRules){var n=[].slice.call(r.cssRules,0).reduce(function(s,o){return o&&typeof o.cssText=="string"?s+o.cssText:s},""),a=e.cloneNode(!1);return a.textContent=n,a}}catch(s){if(this.context.logger.error("Unable to access cssRules property",s),s.name!=="SecurityError")throw s}return e.cloneNode(!1)},t.prototype.createCanvasClone=function(e){var r;if(this.options.inlineImages&&e.ownerDocument){var n=e.ownerDocument.createElement("img");try{return n.src=e.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var a=e.cloneNode(!1);try{a.width=e.width,a.height=e.height;var s=e.getContext("2d"),o=a.getContext("2d");if(o)if(!this.options.allowTaint&&s)o.putImageData(s.getImageData(0,0,e.width,e.height),0,0);else{var l=(r=e.getContext("webgl2"))!==null&&r!==void 0?r:e.getContext("webgl");if(l){var c=l.getContextAttributes();(c==null?void 0:c.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}o.drawImage(e,0,0)}return a}catch{this.context.logger.info("Unable to clone canvas as it is tainted",e)}return a},t.prototype.createVideoClone=function(e){var r=e.ownerDocument.createElement("canvas");r.width=e.offsetWidth,r.height=e.offsetHeight;var n=r.getContext("2d");try{return n&&(n.drawImage(e,0,0,r.width,r.height),this.options.allowTaint||n.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",e)}var a=e.ownerDocument.createElement("canvas");return a.width=e.offsetWidth,a.height=e.offsetHeight,a},t.prototype.appendChildNode=function(e,r,n){(!Qx(r)||!dEe(r)&&!r.hasAttribute(wte)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!Qx(r)||!rQ(r))&&e.appendChild(this.cloneNode(r,n))},t.prototype.cloneChildNodes=function(e,r,n){for(var a=this,s=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;s;s=s.nextSibling)if(Qx(s)&&yte(s)&&typeof s.assignedNodes=="function"){var o=s.assignedNodes();o.length&&o.forEach(function(l){return a.appendChildNode(r,l,n)})}else this.appendChildNode(r,s,n)},t.prototype.cloneNode=function(e,r){if(pte(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var n=e.ownerDocument.defaultView;if(n&&Qx(e)&&(Ak(e)||nE(e))){var a=this.createElementClone(e);a.style.transitionProperty="none";var s=n.getComputedStyle(e),o=n.getComputedStyle(e,":before"),l=n.getComputedStyle(e,":after");this.referenceElement===e&&Ak(a)&&(this.clonedReferenceElement=a),C6(a)&&_Ee(a);var c=this.counters.parse(new U9(this.context,s)),u=this.resolvePseudoContent(e,a,o,mb.BEFORE);nQ(e)&&(r=!0),tQ(e)||this.cloneChildNodes(e,a,r),u&&a.insertBefore(u,a.firstChild);var d=this.resolvePseudoContent(e,a,l,mb.AFTER);return d&&a.appendChild(d),this.counters.pop(c),(s&&(this.options.copyStyles||nE(e))&&!vte(e)||r)&&F3(s,a),(e.scrollTop!==0||e.scrollLeft!==0)&&this.scrolledElements.push([a,e.scrollLeft,e.scrollTop]),(mS(e)||pS(e))&&(mS(a)||pS(a))&&(a.value=e.value),a}return e.cloneNode(!1)},t.prototype.resolvePseudoContent=function(e,r,n,a){var s=this;if(n){var o=n.content,l=r.ownerDocument;if(!(!l||!o||o==="none"||o==="-moz-alt-content"||n.display==="none")){this.counters.parse(new U9(this.context,n));var c=new o_e(this.context,n),u=l.createElement("html2canvaspseudoelement");F3(n,u),c.content.forEach(function(f){if(f.type===0)u.appendChild(l.createTextNode(f.value));else if(f.type===22){var A=l.createElement("img");A.src=f.value,A.style.opacity="1",u.appendChild(A)}else if(f.type===18){if(f.name==="attr"){var h=f.values.filter($a);h.length&&u.appendChild(l.createTextNode(e.getAttribute(h[0].value)||""))}else if(f.name==="counter"){var m=f.values.filter(Bv),p=m[0],g=m[1];if(p&&$a(p)){var v=s.counters.getCounterValue(p.value),y=g&&$a(g)?uk.parse(s.context,g.value):3;u.appendChild(l.createTextNode(g2(v,y,!1)))}}else if(f.name==="counters"){var b=f.values.filter(Bv),p=b[0],w=b[1],g=b[2];if(p&&$a(p)){var j=s.counters.getCounterValues(p.value),I=g&&$a(g)?uk.parse(s.context,g.value):3,_=w&&w.type===0?w.value:"",S=j.map(function(k){return g2(k,I,!1)}).join(_);u.appendChild(l.createTextNode(S))}}}else if(f.type===20)switch(f.value){case"open-quote":u.appendChild(l.createTextNode(L9(c.quotes,s.quoteDepth++,!0)));break;case"close-quote":u.appendChild(l.createTextNode(L9(c.quotes,--s.quoteDepth,!1)));break;default:u.appendChild(l.createTextNode(f.value))}}),u.className=pk+" "+gk;var d=a===mb.BEFORE?" "+pk:" "+gk;return nE(r)?r.className.baseValue+=d:r.className+=d,u}}},t.destroy=function(e){return e.parentNode?(e.parentNode.removeChild(e),!0):!1},t}(),mb;(function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER"})(mb||(mb={}));var mEe=function(t,e){var r=t.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=e.width.toString(),r.height=e.height.toString(),r.scrolling="no",r.setAttribute(wte,"true"),t.body.appendChild(r),r},pEe=function(t){return new Promise(function(e){if(t.complete){e();return}if(!t.src){e();return}t.onload=e,t.onerror=e})},gEe=function(t){return Promise.all([].slice.call(t.images,0).map(pEe))},xEe=function(t){return new Promise(function(e,r){var n=t.contentWindow;if(!n)return r("No window assigned for iframe");var a=n.document;n.onload=t.onload=function(){n.onload=t.onload=null;var s=setInterval(function(){a.body.childNodes.length>0&&a.readyState==="complete"&&(clearInterval(s),e(t))},50)}})},vEe=["all","d","content"],F3=function(t,e){for(var r=t.length-1;r>=0;r--){var n=t.item(r);vEe.indexOf(n)===-1&&e.style.setProperty(n,t.getPropertyValue(n))}return e},yEe=function(t){var e="";return t&&(e+="<!DOCTYPE ",t.name&&(e+=t.name),t.internalSubset&&(e+=t.internalSubset),t.publicId&&(e+='"'+t.publicId+'"'),t.systemId&&(e+='"'+t.systemId+'"'),e+=">"),e},bEe=function(t,e,r){t&&t.defaultView&&(e!==t.defaultView.pageXOffset||r!==t.defaultView.pageYOffset)&&t.defaultView.scrollTo(e,r)},wEe=function(t){var e=t[0],r=t[1],n=t[2];e.scrollLeft=r,e.scrollTop=n},NEe=":before",CEe=":after",pk="___html2canvas___pseudoelement_before",gk="___html2canvas___pseudoelement_after",uQ=`{
    content: "" !important;
    display: none !important;
}`,_Ee=function(t){EEe(t,"."+pk+NEe+uQ+`
         .`+gk+CEe+uQ)},EEe=function(t,e){var r=t.ownerDocument;if(r){var n=r.createElement("style");n.textContent=e,t.appendChild(n)}},Nte=function(){function t(){}return t.getOrigin=function(e){var r=t._link;return r?(r.href=e,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},t.isSameOrigin=function(e){return t.getOrigin(e)===t._origin},t.setContext=function(e){t._link=e.document.createElement("a"),t._origin=t.getOrigin(e.location.href)},t._origin="about:blank",t}(),SEe=function(){function t(e,r){this.context=e,this._options=r,this._cache={}}return t.prototype.addImage=function(e){var r=Promise.resolve();return this.has(e)||(D3(e)||BEe(e))&&(this._cache[e]=this.loadImage(e)).catch(function(){}),r},t.prototype.match=function(e){return this._cache[e]},t.prototype.loadImage=function(e){return tc(this,void 0,void 0,function(){var r,n,a,s,o=this;return jl(this,function(l){switch(l.label){case 0:return r=Nte.isSameOrigin(e),n=!O3(e)&&this._options.useCORS===!0&&nl.SUPPORT_CORS_IMAGES&&!r,a=!O3(e)&&!r&&!D3(e)&&typeof this._options.proxy=="string"&&nl.SUPPORT_CORS_XHR&&!n,!r&&this._options.allowTaint===!1&&!O3(e)&&!D3(e)&&!a&&!n?[2]:(s=e,a?[4,this.proxy(s)]:[3,2]);case 1:s=l.sent(),l.label=2;case 2:return this.context.logger.debug("Added image "+e.substring(0,256)),[4,new Promise(function(c,u){var d=new Image;d.onload=function(){return c(d)},d.onerror=u,(TEe(s)||n)&&(d.crossOrigin="anonymous"),d.src=s,d.complete===!0&&setTimeout(function(){return c(d)},500),o._options.imageTimeout>0&&setTimeout(function(){return u("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,l.sent()]}})})},t.prototype.has=function(e){return typeof this._cache[e]<"u"},t.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},t.prototype.proxy=function(e){var r=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var a=e.substring(0,256);return new Promise(function(s,o){var l=nl.SUPPORT_RESPONSE_TYPE?"blob":"text",c=new XMLHttpRequest;c.onload=function(){if(c.status===200)if(l==="text")s(c.response);else{var f=new FileReader;f.addEventListener("load",function(){return s(f.result)},!1),f.addEventListener("error",function(A){return o(A)},!1),f.readAsDataURL(c.response)}else o("Failed to proxy resource "+a+" with status code "+c.status)},c.onerror=o;var u=n.indexOf("?")>-1?"&":"?";if(c.open("GET",""+n+u+"url="+encodeURIComponent(e)+"&responseType="+l),l!=="text"&&c instanceof XMLHttpRequest&&(c.responseType=l),r._options.imageTimeout){var d=r._options.imageTimeout;c.timeout=d,c.ontimeout=function(){return o("Timed out ("+d+"ms) proxying "+a)}}c.send()})},t}(),IEe=/^data:image\/svg\+xml/i,jEe=/^data:image\/.*;base64,/i,PEe=/^data:image\/.*/i,BEe=function(t){return nl.SUPPORT_SVG_DRAWING||!kEe(t)},O3=function(t){return PEe.test(t)},TEe=function(t){return jEe.test(t)},D3=function(t){return t.substr(0,4)==="blob"},kEe=function(t){return t.substr(-3).toLowerCase()==="svg"||IEe.test(t)},kr=function(){function t(e,r){this.type=0,this.x=e,this.y=r}return t.prototype.add=function(e,r){return new t(this.x+e,this.y+r)},t}(),Zg=function(t,e,r){return new kr(t.x+(e.x-t.x)*r,t.y+(e.y-t.y)*r)},pC=function(){function t(e,r,n,a){this.type=1,this.start=e,this.startControl=r,this.endControl=n,this.end=a}return t.prototype.subdivide=function(e,r){var n=Zg(this.start,this.startControl,e),a=Zg(this.startControl,this.endControl,e),s=Zg(this.endControl,this.end,e),o=Zg(n,a,e),l=Zg(a,s,e),c=Zg(o,l,e);return r?new t(this.start,n,o,c):new t(c,l,s,this.end)},t.prototype.add=function(e,r){return new t(this.start.add(e,r),this.startControl.add(e,r),this.endControl.add(e,r),this.end.add(e,r))},t.prototype.reverse=function(){return new t(this.end,this.endControl,this.startControl,this.start)},t}(),ed=function(t){return t.type===1},FEe=function(){function t(e){var r=e.styles,n=e.bounds,a=Ry(r.borderTopLeftRadius,n.width,n.height),s=a[0],o=a[1],l=Ry(r.borderTopRightRadius,n.width,n.height),c=l[0],u=l[1],d=Ry(r.borderBottomRightRadius,n.width,n.height),f=d[0],A=d[1],h=Ry(r.borderBottomLeftRadius,n.width,n.height),m=h[0],p=h[1],g=[];g.push((s+c)/n.width),g.push((m+f)/n.width),g.push((o+p)/n.height),g.push((u+A)/n.height);var v=Math.max.apply(Math,g);v>1&&(s/=v,o/=v,c/=v,u/=v,f/=v,A/=v,m/=v,p/=v);var y=n.width-c,b=n.height-A,w=n.width-f,j=n.height-p,I=r.borderTopWidth,_=r.borderRightWidth,S=r.borderBottomWidth,E=r.borderLeftWidth,F=ns(r.paddingTop,e.bounds.width),k=ns(r.paddingRight,e.bounds.width),P=ns(r.paddingBottom,e.bounds.width),D=ns(r.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||o>0?vs(n.left+E/3,n.top+I/3,s-E/3,o-I/3,Ca.TOP_LEFT):new kr(n.left+E/3,n.top+I/3),this.topRightBorderDoubleOuterBox=s>0||o>0?vs(n.left+y,n.top+I/3,c-_/3,u-I/3,Ca.TOP_RIGHT):new kr(n.left+n.width-_/3,n.top+I/3),this.bottomRightBorderDoubleOuterBox=f>0||A>0?vs(n.left+w,n.top+b,f-_/3,A-S/3,Ca.BOTTOM_RIGHT):new kr(n.left+n.width-_/3,n.top+n.height-S/3),this.bottomLeftBorderDoubleOuterBox=m>0||p>0?vs(n.left+E/3,n.top+j,m-E/3,p-S/3,Ca.BOTTOM_LEFT):new kr(n.left+E/3,n.top+n.height-S/3),this.topLeftBorderDoubleInnerBox=s>0||o>0?vs(n.left+E*2/3,n.top+I*2/3,s-E*2/3,o-I*2/3,Ca.TOP_LEFT):new kr(n.left+E*2/3,n.top+I*2/3),this.topRightBorderDoubleInnerBox=s>0||o>0?vs(n.left+y,n.top+I*2/3,c-_*2/3,u-I*2/3,Ca.TOP_RIGHT):new kr(n.left+n.width-_*2/3,n.top+I*2/3),this.bottomRightBorderDoubleInnerBox=f>0||A>0?vs(n.left+w,n.top+b,f-_*2/3,A-S*2/3,Ca.BOTTOM_RIGHT):new kr(n.left+n.width-_*2/3,n.top+n.height-S*2/3),this.bottomLeftBorderDoubleInnerBox=m>0||p>0?vs(n.left+E*2/3,n.top+j,m-E*2/3,p-S*2/3,Ca.BOTTOM_LEFT):new kr(n.left+E*2/3,n.top+n.height-S*2/3),this.topLeftBorderStroke=s>0||o>0?vs(n.left+E/2,n.top+I/2,s-E/2,o-I/2,Ca.TOP_LEFT):new kr(n.left+E/2,n.top+I/2),this.topRightBorderStroke=s>0||o>0?vs(n.left+y,n.top+I/2,c-_/2,u-I/2,Ca.TOP_RIGHT):new kr(n.left+n.width-_/2,n.top+I/2),this.bottomRightBorderStroke=f>0||A>0?vs(n.left+w,n.top+b,f-_/2,A-S/2,Ca.BOTTOM_RIGHT):new kr(n.left+n.width-_/2,n.top+n.height-S/2),this.bottomLeftBorderStroke=m>0||p>0?vs(n.left+E/2,n.top+j,m-E/2,p-S/2,Ca.BOTTOM_LEFT):new kr(n.left+E/2,n.top+n.height-S/2),this.topLeftBorderBox=s>0||o>0?vs(n.left,n.top,s,o,Ca.TOP_LEFT):new kr(n.left,n.top),this.topRightBorderBox=c>0||u>0?vs(n.left+y,n.top,c,u,Ca.TOP_RIGHT):new kr(n.left+n.width,n.top),this.bottomRightBorderBox=f>0||A>0?vs(n.left+w,n.top+b,f,A,Ca.BOTTOM_RIGHT):new kr(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=m>0||p>0?vs(n.left,n.top+j,m,p,Ca.BOTTOM_LEFT):new kr(n.left,n.top+n.height),this.topLeftPaddingBox=s>0||o>0?vs(n.left+E,n.top+I,Math.max(0,s-E),Math.max(0,o-I),Ca.TOP_LEFT):new kr(n.left+E,n.top+I),this.topRightPaddingBox=c>0||u>0?vs(n.left+Math.min(y,n.width-_),n.top+I,y>n.width+_?0:Math.max(0,c-_),Math.max(0,u-I),Ca.TOP_RIGHT):new kr(n.left+n.width-_,n.top+I),this.bottomRightPaddingBox=f>0||A>0?vs(n.left+Math.min(w,n.width-E),n.top+Math.min(b,n.height-S),Math.max(0,f-_),Math.max(0,A-S),Ca.BOTTOM_RIGHT):new kr(n.left+n.width-_,n.top+n.height-S),this.bottomLeftPaddingBox=m>0||p>0?vs(n.left+E,n.top+Math.min(j,n.height-S),Math.max(0,m-E),Math.max(0,p-S),Ca.BOTTOM_LEFT):new kr(n.left+E,n.top+n.height-S),this.topLeftContentBox=s>0||o>0?vs(n.left+E+D,n.top+I+F,Math.max(0,s-(E+D)),Math.max(0,o-(I+F)),Ca.TOP_LEFT):new kr(n.left+E+D,n.top+I+F),this.topRightContentBox=c>0||u>0?vs(n.left+Math.min(y,n.width+E+D),n.top+I+F,y>n.width+E+D?0:c-E+D,u-(I+F),Ca.TOP_RIGHT):new kr(n.left+n.width-(_+k),n.top+I+F),this.bottomRightContentBox=f>0||A>0?vs(n.left+Math.min(w,n.width-(E+D)),n.top+Math.min(b,n.height+I+F),Math.max(0,f-(_+k)),A-(S+P),Ca.BOTTOM_RIGHT):new kr(n.left+n.width-(_+k),n.top+n.height-(S+P)),this.bottomLeftContentBox=m>0||p>0?vs(n.left+E+D,n.top+j,Math.max(0,m-(E+D)),p-(S+P),Ca.BOTTOM_LEFT):new kr(n.left+E+D,n.top+n.height-(S+P))}return t}(),Ca;(function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",t[t.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Ca||(Ca={}));var vs=function(t,e,r,n,a){var s=4*((Math.sqrt(2)-1)/3),o=r*s,l=n*s,c=t+r,u=e+n;switch(a){case Ca.TOP_LEFT:return new pC(new kr(t,u),new kr(t,u-l),new kr(c-o,e),new kr(c,e));case Ca.TOP_RIGHT:return new pC(new kr(t,e),new kr(t+o,e),new kr(c,u-l),new kr(c,u));case Ca.BOTTOM_RIGHT:return new pC(new kr(c,e),new kr(c,e+l),new kr(t+o,u),new kr(t,u));case Ca.BOTTOM_LEFT:default:return new pC(new kr(c,u),new kr(c-o,u),new kr(t,e+l),new kr(t,e))}},gS=function(t){return[t.topLeftBorderBox,t.topRightBorderBox,t.bottomRightBorderBox,t.bottomLeftBorderBox]},OEe=function(t){return[t.topLeftContentBox,t.topRightContentBox,t.bottomRightContentBox,t.bottomLeftContentBox]},xS=function(t){return[t.topLeftPaddingBox,t.topRightPaddingBox,t.bottomRightPaddingBox,t.bottomLeftPaddingBox]},DEe=function(){function t(e,r,n){this.offsetX=e,this.offsetY=r,this.matrix=n,this.type=0,this.target=6}return t}(),gC=function(){function t(e,r){this.path=e,this.target=r,this.type=1}return t}(),REe=function(){function t(e){this.opacity=e,this.type=2,this.target=6}return t}(),MEe=function(t){return t.type===0},Cte=function(t){return t.type===1},LEe=function(t){return t.type===2},dQ=function(t,e){return t.length===e.length?t.some(function(r,n){return r===e[n]}):!1},UEe=function(t,e,r,n,a){return t.map(function(s,o){switch(o){case 0:return s.add(e,r);case 1:return s.add(e+n,r);case 2:return s.add(e+n,r+a);case 3:return s.add(e,r+a)}return s})},_te=function(){function t(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return t}(),Ete=function(){function t(e,r){if(this.container=e,this.parent=r,this.effects=[],this.curves=new FEe(this.container),this.container.styles.opacity<1&&this.effects.push(new REe(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,a=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new DEe(n,a,s))}if(this.container.styles.overflowX!==0){var o=gS(this.curves),l=xS(this.curves);dQ(o,l)?this.effects.push(new gC(o,6)):(this.effects.push(new gC(o,2)),this.effects.push(new gC(l,4)))}}return t.prototype.getEffects=function(e){for(var r=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,a=this.effects.slice(0);n;){var s=n.effects.filter(function(c){return!Cte(c)});if(r||n.container.styles.position!==0||!n.parent){if(a.unshift.apply(a,s),r=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var o=gS(n.curves),l=xS(n.curves);dQ(o,l)||a.unshift(new gC(l,6))}}else a.unshift.apply(a,s);n=n.parent}return a.filter(function(c){return oo(c.target,e)})},t}(),xk=function(t,e,r,n){t.container.elements.forEach(function(a){var s=oo(a.flags,4),o=oo(a.flags,2),l=new Ete(a,t);oo(a.styles.display,2048)&&n.push(l);var c=oo(a.flags,8)?[]:n;if(s||o){var u=s||a.styles.isPositioned()?r:e,d=new _te(l);if(a.styles.isPositioned()||a.styles.opacity<1||a.styles.isTransformed()){var f=a.styles.zIndex.order;if(f<0){var A=0;u.negativeZIndex.some(function(m,p){return f>m.element.container.styles.zIndex.order?(A=p,!1):A>0}),u.negativeZIndex.splice(A,0,d)}else if(f>0){var h=0;u.positiveZIndex.some(function(m,p){return f>=m.element.container.styles.zIndex.order?(h=p+1,!1):h>0}),u.positiveZIndex.splice(h,0,d)}else u.zeroOrAutoZIndexOrTransformedOrOpacity.push(d)}else a.styles.isFloating()?u.nonPositionedFloats.push(d):u.nonPositionedInlineLevel.push(d);xk(l,d,s?d:r,c)}else a.styles.isInlineLevel()?e.inlineLevel.push(l):e.nonInlineLevel.push(l),xk(l,e,r,c);oo(a.flags,8)&&Ste(a,c)})},Ste=function(t,e){for(var r=t instanceof hk?t.start:1,n=t instanceof hk?t.reversed:!1,a=0;a<e.length;a++){var s=e[a];s.container instanceof ute&&typeof s.container.value=="number"&&s.container.value!==0&&(r=s.container.value),s.listValue=g2(r,s.container.styles.listStyleType,!0),r+=n?-1:1}},QEe=function(t){var e=new Ete(t,null),r=new _te(e),n=[];return xk(e,r,r,n),Ste(e.container,n),r},fQ=function(t,e){switch(e){case 0:return ad(t.topLeftBorderBox,t.topLeftPaddingBox,t.topRightBorderBox,t.topRightPaddingBox);case 1:return ad(t.topRightBorderBox,t.topRightPaddingBox,t.bottomRightBorderBox,t.bottomRightPaddingBox);case 2:return ad(t.bottomRightBorderBox,t.bottomRightPaddingBox,t.bottomLeftBorderBox,t.bottomLeftPaddingBox);case 3:default:return ad(t.bottomLeftBorderBox,t.bottomLeftPaddingBox,t.topLeftBorderBox,t.topLeftPaddingBox)}},VEe=function(t,e){switch(e){case 0:return ad(t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox,t.topRightBorderBox,t.topRightBorderDoubleOuterBox);case 1:return ad(t.topRightBorderBox,t.topRightBorderDoubleOuterBox,t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox);case 2:return ad(t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox,t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox);case 3:default:return ad(t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox,t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox)}},HEe=function(t,e){switch(e){case 0:return ad(t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox,t.topRightBorderDoubleInnerBox,t.topRightPaddingBox);case 1:return ad(t.topRightBorderDoubleInnerBox,t.topRightPaddingBox,t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox);case 2:return ad(t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox,t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox);case 3:default:return ad(t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox,t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox)}},$Ee=function(t,e){switch(e){case 0:return xC(t.topLeftBorderStroke,t.topRightBorderStroke);case 1:return xC(t.topRightBorderStroke,t.bottomRightBorderStroke);case 2:return xC(t.bottomRightBorderStroke,t.bottomLeftBorderStroke);case 3:default:return xC(t.bottomLeftBorderStroke,t.topLeftBorderStroke)}},xC=function(t,e){var r=[];return ed(t)?r.push(t.subdivide(.5,!1)):r.push(t),ed(e)?r.push(e.subdivide(.5,!0)):r.push(e),r},ad=function(t,e,r,n){var a=[];return ed(t)?a.push(t.subdivide(.5,!1)):a.push(t),ed(r)?a.push(r.subdivide(.5,!0)):a.push(r),ed(n)?a.push(n.subdivide(.5,!0).reverse()):a.push(n),ed(e)?a.push(e.subdivide(.5,!1).reverse()):a.push(e),a},Ite=function(t){var e=t.bounds,r=t.styles;return e.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},vS=function(t){var e=t.styles,r=t.bounds,n=ns(e.paddingLeft,r.width),a=ns(e.paddingRight,r.width),s=ns(e.paddingTop,r.width),o=ns(e.paddingBottom,r.width);return r.add(n+e.borderLeftWidth,s+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+n+a),-(e.borderTopWidth+e.borderBottomWidth+s+o))},GEe=function(t,e){return t===0?e.bounds:t===2?vS(e):Ite(e)},KEe=function(t,e){return t===0?e.bounds:t===2?vS(e):Ite(e)},R3=function(t,e,r){var n=GEe(Nx(t.styles.backgroundOrigin,e),t),a=KEe(Nx(t.styles.backgroundClip,e),t),s=qEe(Nx(t.styles.backgroundSize,e),r,n),o=s[0],l=s[1],c=Ry(Nx(t.styles.backgroundPosition,e),n.width-o,n.height-l),u=zEe(Nx(t.styles.backgroundRepeat,e),c,s,n,a),d=Math.round(n.left+c[0]),f=Math.round(n.top+c[1]);return[u,d,f,o,l]},ex=function(t){return $a(t)&&t.value===iv.AUTO},vC=function(t){return typeof t=="number"},qEe=function(t,e,r){var n=e[0],a=e[1],s=e[2],o=t[0],l=t[1];if(!o)return[0,0];if(Ui(o)&&l&&Ui(l))return[ns(o,r.width),ns(l,r.height)];var c=vC(s);if($a(o)&&(o.value===iv.CONTAIN||o.value===iv.COVER)){if(vC(s)){var u=r.width/r.height;return u<s!=(o.value===iv.COVER)?[r.width,r.width/s]:[r.height*s,r.height]}return[r.width,r.height]}var d=vC(n),f=vC(a),A=d||f;if(ex(o)&&(!l||ex(l))){if(d&&f)return[n,a];if(!c&&!A)return[r.width,r.height];if(A&&c){var h=d?n:a*s,m=f?a:n/s;return[h,m]}var p=d?n:r.width,g=f?a:r.height;return[p,g]}if(c){var v=0,y=0;return Ui(o)?v=ns(o,r.width):Ui(l)&&(y=ns(l,r.height)),ex(o)?v=y*s:(!l||ex(l))&&(y=v/s),[v,y]}var b=null,w=null;if(Ui(o)?b=ns(o,r.width):l&&Ui(l)&&(w=ns(l,r.height)),b!==null&&(!l||ex(l))&&(w=d&&f?b/n*a:r.height),w!==null&&ex(o)&&(b=d&&f?w/a*n:r.width),b!==null&&w!==null)return[b,w];throw new Error("Unable to calculate background-size for element")},Nx=function(t,e){var r=t[e];return typeof r>"u"?t[0]:r},zEe=function(t,e,r,n,a){var s=e[0],o=e[1],l=r[0],c=r[1];switch(t){case 2:return[new kr(Math.round(n.left),Math.round(n.top+o)),new kr(Math.round(n.left+n.width),Math.round(n.top+o)),new kr(Math.round(n.left+n.width),Math.round(c+n.top+o)),new kr(Math.round(n.left),Math.round(c+n.top+o))];case 3:return[new kr(Math.round(n.left+s),Math.round(n.top)),new kr(Math.round(n.left+s+l),Math.round(n.top)),new kr(Math.round(n.left+s+l),Math.round(n.height+n.top)),new kr(Math.round(n.left+s),Math.round(n.height+n.top))];case 1:return[new kr(Math.round(n.left+s),Math.round(n.top+o)),new kr(Math.round(n.left+s+l),Math.round(n.top+o)),new kr(Math.round(n.left+s+l),Math.round(n.top+o+c)),new kr(Math.round(n.left+s),Math.round(n.top+o+c))];default:return[new kr(Math.round(a.left),Math.round(a.top)),new kr(Math.round(a.left+a.width),Math.round(a.top)),new kr(Math.round(a.left+a.width),Math.round(a.height+a.top)),new kr(Math.round(a.left),Math.round(a.height+a.top))]}},WEe="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",hQ="Hidden Text",XEe=function(){function t(e){this._data={},this._document=e}return t.prototype.parseMetrics=function(e,r){var n=this._document.createElement("div"),a=this._document.createElement("img"),s=this._document.createElement("span"),o=this._document.body;n.style.visibility="hidden",n.style.fontFamily=e,n.style.fontSize=r,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",o.appendChild(n),a.src=WEe,a.width=1,a.height=1,a.style.margin="0",a.style.padding="0",a.style.verticalAlign="baseline",s.style.fontFamily=e,s.style.fontSize=r,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(hQ)),n.appendChild(s),n.appendChild(a);var l=a.offsetTop-s.offsetTop+2;n.removeChild(s),n.appendChild(this._document.createTextNode(hQ)),n.style.lineHeight="normal",a.style.verticalAlign="super";var c=a.offsetTop-n.offsetTop+2;return o.removeChild(n),{baseline:l,middle:c}},t.prototype.getMetrics=function(e,r){var n=e+" "+r;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(e,r)),this._data[n]},t}(),jte=function(){function t(e,r){this.context=e,this.options=r}return t}(),YEe=1e4,JEe=function(t){df(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a._activeEffects=[],a.canvas=n.canvas?n.canvas:document.createElement("canvas"),a.ctx=a.canvas.getContext("2d"),n.canvas||(a.canvas.width=Math.floor(n.width*n.scale),a.canvas.height=Math.floor(n.height*n.scale),a.canvas.style.width=n.width+"px",a.canvas.style.height=n.height+"px"),a.fontMetrics=new XEe(document),a.ctx.scale(a.options.scale,a.options.scale),a.ctx.translate(-n.x,-n.y),a.ctx.textBaseline="bottom",a._activeEffects=[],a.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),a}return e.prototype.applyEffects=function(r){for(var n=this;this._activeEffects.length;)this.popEffect();r.forEach(function(a){return n.applyEffect(a)})},e.prototype.applyEffect=function(r){this.ctx.save(),LEe(r)&&(this.ctx.globalAlpha=r.opacity),MEe(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),Cte(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(r){return tc(this,void 0,void 0,function(){var n;return jl(this,function(a){switch(a.label){case 0:return n=r.element.container.styles,n.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},e.prototype.renderNode=function(r){return tc(this,void 0,void 0,function(){return jl(this,function(n){switch(n.label){case 0:if(oo(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(r)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.renderTextWithLetterSpacing=function(r,n,a){var s=this;if(n===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+a);else{var o=w6(r.text);o.reduce(function(l,c){return s.ctx.fillText(c,l,r.bounds.top+a),l+s.ctx.measureText(c).width},r.bounds.left)}},e.prototype.createFontStyle=function(r){var n=r.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),a=nSe(r.fontFamily).join(", "),s=Ew(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,n,r.fontWeight,s,a].join(" "),a,s]},e.prototype.renderTextNode=function(r,n){return tc(this,void 0,void 0,function(){var a,s,o,l,c,u,d,f,A=this;return jl(this,function(h){return a=this.createFontStyle(n),s=a[0],o=a[1],l=a[2],this.ctx.font=s,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",c=this.fontMetrics.getMetrics(o,l),u=c.baseline,d=c.middle,f=n.paintOrder,r.textBounds.forEach(function(m){f.forEach(function(p){switch(p){case 0:A.ctx.fillStyle=Co(n.color),A.renderTextWithLetterSpacing(m,n.letterSpacing,u);var g=n.textShadow;g.length&&m.text.trim().length&&(g.slice(0).reverse().forEach(function(v){A.ctx.shadowColor=Co(v.color),A.ctx.shadowOffsetX=v.offsetX.number*A.options.scale,A.ctx.shadowOffsetY=v.offsetY.number*A.options.scale,A.ctx.shadowBlur=v.blur.number,A.renderTextWithLetterSpacing(m,n.letterSpacing,u)}),A.ctx.shadowColor="",A.ctx.shadowOffsetX=0,A.ctx.shadowOffsetY=0,A.ctx.shadowBlur=0),n.textDecorationLine.length&&(A.ctx.fillStyle=Co(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(v){switch(v){case 1:A.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top+u),m.bounds.width,1);break;case 2:A.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top),m.bounds.width,1);break;case 3:A.ctx.fillRect(m.bounds.left,Math.ceil(m.bounds.top+d),m.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&m.text.trim().length&&(A.ctx.strokeStyle=Co(n.webkitTextStrokeColor),A.ctx.lineWidth=n.webkitTextStrokeWidth,A.ctx.lineJoin=window.chrome?"miter":"round",A.ctx.strokeText(m.text,m.bounds.left,m.bounds.top+u)),A.ctx.strokeStyle="",A.ctx.lineWidth=0,A.ctx.lineJoin="miter";break}})}),[2]})})},e.prototype.renderReplacedElement=function(r,n,a){if(a&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var s=vS(r),o=xS(n);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(a,0,0,r.intrinsicWidth,r.intrinsicHeight,s.left,s.top,s.width,s.height),this.ctx.restore()}},e.prototype.renderNodeContent=function(r){return tc(this,void 0,void 0,function(){var n,a,s,o,l,c,y,y,u,d,f,A,w,h,m,j,p,g,v,y,b,w,j;return jl(this,function(I){switch(I.label){case 0:this.applyEffects(r.getEffects(4)),n=r.container,a=r.curves,s=n.styles,o=0,l=n.textNodes,I.label=1;case 1:return o<l.length?(c=l[o],[4,this.renderTextNode(c,s)]):[3,4];case 2:I.sent(),I.label=3;case 3:return o++,[3,1];case 4:if(!(n instanceof ote))return[3,8];I.label=5;case 5:return I.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return y=I.sent(),this.renderReplacedElement(n,a,y),[3,8];case 7:return I.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof lte&&this.renderReplacedElement(n,a,n.canvas),!(n instanceof cte))return[3,12];I.label=9;case 9:return I.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return y=I.sent(),this.renderReplacedElement(n,a,y),[3,12];case 11:return I.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof hte&&n.tree?(u=new e(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,u.render(n.tree)]):[3,14];case 13:d=I.sent(),n.width&&n.height&&this.ctx.drawImage(d,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),I.label=14;case 14:if(n instanceof N6&&(f=Math.min(n.bounds.width,n.bounds.height),n.type===hS?n.checked&&(this.ctx.save(),this.path([new kr(n.bounds.left+f*.39363,n.bounds.top+f*.79),new kr(n.bounds.left+f*.16,n.bounds.top+f*.5549),new kr(n.bounds.left+f*.27347,n.bounds.top+f*.44071),new kr(n.bounds.left+f*.39694,n.bounds.top+f*.5649),new kr(n.bounds.left+f*.72983,n.bounds.top+f*.23),new kr(n.bounds.left+f*.84,n.bounds.top+f*.34085),new kr(n.bounds.left+f*.39363,n.bounds.top+f*.79)]),this.ctx.fillStyle=Co(eQ),this.ctx.fill(),this.ctx.restore()):n.type===AS&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+f/2,n.bounds.top+f/2,f/4,0,Math.PI*2,!0),this.ctx.fillStyle=Co(eQ),this.ctx.fill(),this.ctx.restore())),ZEe(n)&&n.value.length){switch(A=this.createFontStyle(s),w=A[0],h=A[1],m=this.fontMetrics.getMetrics(w,h).baseline,this.ctx.font=w,this.ctx.fillStyle=Co(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=tSe(n.styles.textAlign),j=vS(n),p=0,n.styles.textAlign){case 1:p+=j.width/2;break;case 2:p+=j.width;break}g=j.add(p,0,0,-j.height/2+1),this.ctx.save(),this.path([new kr(j.left,j.top),new kr(j.left+j.width,j.top),new kr(j.left+j.width,j.top+j.height),new kr(j.left,j.top+j.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Ab(n.value,g),s.letterSpacing,m),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!oo(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(v=n.styles.listStyleImage,v.type!==0)return[3,18];y=void 0,b=v.url,I.label=15;case 15:return I.trys.push([15,17,,18]),[4,this.context.cache.match(b)];case 16:return y=I.sent(),this.ctx.drawImage(y,n.bounds.left-(y.width+10),n.bounds.top),[3,18];case 17:return I.sent(),this.context.logger.error("Error loading list-style-image "+b),[3,18];case 18:return[3,20];case 19:r.listValue&&n.styles.listStyleType!==-1&&(w=this.createFontStyle(s)[0],this.ctx.font=w,this.ctx.fillStyle=Co(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",j=new sA(n.bounds.left,n.bounds.top+ns(n.styles.paddingTop,n.bounds.width),n.bounds.width,R9(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Ab(r.listValue,j),s.letterSpacing,R9(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),I.label=20;case 20:return[2]}})})},e.prototype.renderStackContent=function(r){return tc(this,void 0,void 0,function(){var n,a,v,s,o,v,l,c,v,u,d,v,f,A,v,h,m,v,p,g,v;return jl(this,function(y){switch(y.label){case 0:if(oo(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:y.sent(),n=0,a=r.negativeZIndex,y.label=2;case 2:return n<a.length?(v=a[n],[4,this.renderStack(v)]):[3,5];case 3:y.sent(),y.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:y.sent(),s=0,o=r.nonInlineLevel,y.label=7;case 7:return s<o.length?(v=o[s],[4,this.renderNode(v)]):[3,10];case 8:y.sent(),y.label=9;case 9:return s++,[3,7];case 10:l=0,c=r.nonPositionedFloats,y.label=11;case 11:return l<c.length?(v=c[l],[4,this.renderStack(v)]):[3,14];case 12:y.sent(),y.label=13;case 13:return l++,[3,11];case 14:u=0,d=r.nonPositionedInlineLevel,y.label=15;case 15:return u<d.length?(v=d[u],[4,this.renderStack(v)]):[3,18];case 16:y.sent(),y.label=17;case 17:return u++,[3,15];case 18:f=0,A=r.inlineLevel,y.label=19;case 19:return f<A.length?(v=A[f],[4,this.renderNode(v)]):[3,22];case 20:y.sent(),y.label=21;case 21:return f++,[3,19];case 22:h=0,m=r.zeroOrAutoZIndexOrTransformedOrOpacity,y.label=23;case 23:return h<m.length?(v=m[h],[4,this.renderStack(v)]):[3,26];case 24:y.sent(),y.label=25;case 25:return h++,[3,23];case 26:p=0,g=r.positiveZIndex,y.label=27;case 27:return p<g.length?(v=g[p],[4,this.renderStack(v)]):[3,30];case 28:y.sent(),y.label=29;case 29:return p++,[3,27];case 30:return[2]}})})},e.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},e.prototype.formatPath=function(r){var n=this;r.forEach(function(a,s){var o=ed(a)?a.start:a;s===0?n.ctx.moveTo(o.x,o.y):n.ctx.lineTo(o.x,o.y),ed(a)&&n.ctx.bezierCurveTo(a.startControl.x,a.startControl.y,a.endControl.x,a.endControl.y,a.end.x,a.end.y)})},e.prototype.renderRepeat=function(r,n,a,s){this.path(r),this.ctx.fillStyle=n,this.ctx.translate(a,s),this.ctx.fill(),this.ctx.translate(-a,-s)},e.prototype.resizeImage=function(r,n,a){var s;if(r.width===n&&r.height===a)return r;var o=(s=this.canvas.ownerDocument)!==null&&s!==void 0?s:document,l=o.createElement("canvas");l.width=Math.max(1,n),l.height=Math.max(1,a);var c=l.getContext("2d");return c.drawImage(r,0,0,r.width,r.height,0,0,n,a),l},e.prototype.renderBackgroundImage=function(r){return tc(this,void 0,void 0,function(){var n,a,s,o,l,c;return jl(this,function(u){switch(u.label){case 0:n=r.styles.backgroundImage.length-1,a=function(d){var f,A,h,F,ge,fe,D,X,S,m,F,ge,fe,D,X,p,g,v,y,b,w,j,I,_,S,E,F,k,P,D,X,pe,ge,fe,xe,ae,Se,Te,O,G,z,L;return jl(this,function(Z){switch(Z.label){case 0:if(d.type!==0)return[3,5];f=void 0,A=d.url,Z.label=1;case 1:return Z.trys.push([1,3,,4]),[4,s.context.cache.match(A)];case 2:return f=Z.sent(),[3,4];case 3:return Z.sent(),s.context.logger.error("Error loading background-image "+A),[3,4];case 4:return f&&(h=R3(r,n,[f.width,f.height,f.width/f.height]),F=h[0],ge=h[1],fe=h[2],D=h[3],X=h[4],S=s.ctx.createPattern(s.resizeImage(f,D,X),"repeat"),s.renderRepeat(F,S,ge,fe)),[3,6];case 5:MNe(d)?(m=R3(r,n,[null,null,null]),F=m[0],ge=m[1],fe=m[2],D=m[3],X=m[4],p=kNe(d.angle,D,X),g=p[0],v=p[1],y=p[2],b=p[3],w=p[4],j=document.createElement("canvas"),j.width=D,j.height=X,I=j.getContext("2d"),_=I.createLinearGradient(v,b,y,w),O9(d.stops,g).forEach(function(ee){return _.addColorStop(ee.stop,Co(ee.color))}),I.fillStyle=_,I.fillRect(0,0,D,X),D>0&&X>0&&(S=s.ctx.createPattern(j,"repeat"),s.renderRepeat(F,S,ge,fe))):LNe(d)&&(E=R3(r,n,[null,null,null]),F=E[0],k=E[1],P=E[2],D=E[3],X=E[4],pe=d.position.length===0?[v6]:d.position,ge=ns(pe[0],D),fe=ns(pe[pe.length-1],X),xe=FNe(d,ge,fe,D,X),ae=xe[0],Se=xe[1],ae>0&&Se>0&&(Te=s.ctx.createRadialGradient(k+ge,P+fe,0,k+ge,P+fe,ae),O9(d.stops,ae*2).forEach(function(ee){return Te.addColorStop(ee.stop,Co(ee.color))}),s.path(F),s.ctx.fillStyle=Te,ae!==Se?(O=r.bounds.left+.5*r.bounds.width,G=r.bounds.top+.5*r.bounds.height,z=Se/ae,L=1/z,s.ctx.save(),s.ctx.translate(O,G),s.ctx.transform(1,0,0,z,0,0),s.ctx.translate(-O,-G),s.ctx.fillRect(k,L*(P-G)+G,D,X*L),s.ctx.restore()):s.ctx.fill())),Z.label=6;case 6:return n--,[2]}})},s=this,o=0,l=r.styles.backgroundImage.slice(0).reverse(),u.label=1;case 1:return o<l.length?(c=l[o],[5,a(c)]):[3,4];case 2:u.sent(),u.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},e.prototype.renderSolidBorder=function(r,n,a){return tc(this,void 0,void 0,function(){return jl(this,function(s){return this.path(fQ(a,n)),this.ctx.fillStyle=Co(r),this.ctx.fill(),[2]})})},e.prototype.renderDoubleBorder=function(r,n,a,s){return tc(this,void 0,void 0,function(){var o,l;return jl(this,function(c){switch(c.label){case 0:return n<3?[4,this.renderSolidBorder(r,a,s)]:[3,2];case 1:return c.sent(),[2];case 2:return o=VEe(s,a),this.path(o),this.ctx.fillStyle=Co(r),this.ctx.fill(),l=HEe(s,a),this.path(l),this.ctx.fill(),[2]}})})},e.prototype.renderNodeBackgroundAndBorders=function(r){return tc(this,void 0,void 0,function(){var n,a,s,o,l,c,u,d,f=this;return jl(this,function(A){switch(A.label){case 0:return this.applyEffects(r.getEffects(2)),n=r.container.styles,a=!Y0(n.backgroundColor)||n.backgroundImage.length,s=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],o=eSe(Nx(n.backgroundClip,0),r.curves),a||n.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),Y0(n.backgroundColor)||(this.ctx.fillStyle=Co(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:A.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(h){f.ctx.save();var m=gS(r.curves),p=h.inset?0:YEe,g=UEe(m,-p+(h.inset?1:-1)*h.spread.number,(h.inset?1:-1)*h.spread.number,h.spread.number*(h.inset?-2:2),h.spread.number*(h.inset?-2:2));h.inset?(f.path(m),f.ctx.clip(),f.mask(g)):(f.mask(m),f.ctx.clip(),f.path(g)),f.ctx.shadowOffsetX=h.offsetX.number+p,f.ctx.shadowOffsetY=h.offsetY.number,f.ctx.shadowColor=Co(h.color),f.ctx.shadowBlur=h.blur.number,f.ctx.fillStyle=h.inset?Co(h.color):"rgba(0,0,0,1)",f.ctx.fill(),f.ctx.restore()}),A.label=2;case 2:l=0,c=0,u=s,A.label=3;case 3:return c<u.length?(d=u[c],d.style!==0&&!Y0(d.color)&&d.width>0?d.style!==2?[3,5]:[4,this.renderDashedDottedBorder(d.color,d.width,l,r.curves,2)]:[3,11]):[3,13];case 4:return A.sent(),[3,11];case 5:return d.style!==3?[3,7]:[4,this.renderDashedDottedBorder(d.color,d.width,l,r.curves,3)];case 6:return A.sent(),[3,11];case 7:return d.style!==4?[3,9]:[4,this.renderDoubleBorder(d.color,d.width,l,r.curves)];case 8:return A.sent(),[3,11];case 9:return[4,this.renderSolidBorder(d.color,l,r.curves)];case 10:A.sent(),A.label=11;case 11:l++,A.label=12;case 12:return c++,[3,3];case 13:return[2]}})})},e.prototype.renderDashedDottedBorder=function(r,n,a,s,o){return tc(this,void 0,void 0,function(){var l,c,u,d,f,A,h,m,p,g,v,y,b,w,j,I,j,I;return jl(this,function(_){return this.ctx.save(),l=$Ee(s,a),c=fQ(s,a),o===2&&(this.path(c),this.ctx.clip()),ed(c[0])?(u=c[0].start.x,d=c[0].start.y):(u=c[0].x,d=c[0].y),ed(c[1])?(f=c[1].end.x,A=c[1].end.y):(f=c[1].x,A=c[1].y),a===0||a===2?h=Math.abs(u-f):h=Math.abs(d-A),this.ctx.beginPath(),o===3?this.formatPath(l):this.formatPath(c.slice(0,2)),m=n<3?n*3:n*2,p=n<3?n*2:n,o===3&&(m=n,p=n),g=!0,h<=m*2?g=!1:h<=m*2+p?(v=h/(2*m+p),m*=v,p*=v):(y=Math.floor((h+p)/(m+p)),b=(h-y*m)/(y-1),w=(h-(y+1)*m)/y,p=w<=0||Math.abs(p-b)<Math.abs(p-w)?b:w),g&&(o===3?this.ctx.setLineDash([0,m+p]):this.ctx.setLineDash([m,p])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=Co(r),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(ed(c[0])&&(j=c[3],I=c[0],this.ctx.beginPath(),this.formatPath([new kr(j.end.x,j.end.y),new kr(I.start.x,I.start.y)]),this.ctx.stroke()),ed(c[1])&&(j=c[1],I=c[2],this.ctx.beginPath(),this.formatPath([new kr(j.end.x,j.end.y),new kr(I.start.x,I.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},e.prototype.render=function(r){return tc(this,void 0,void 0,function(){var n;return jl(this,function(a){switch(a.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Co(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=QEe(r),[4,this.renderStack(n)];case 1:return a.sent(),this.applyEffects([]),[2,this.canvas]}})})},e}(jte),ZEe=function(t){return t instanceof fte||t instanceof dte?!0:t instanceof N6&&t.type!==AS&&t.type!==hS},eSe=function(t,e){switch(t){case 0:return gS(e);case 2:return OEe(e);case 1:default:return xS(e)}},tSe=function(t){switch(t){case 1:return"center";case 2:return"right";case 0:default:return"left"}},rSe=["-apple-system","system-ui"],nSe=function(t){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?t.filter(function(e){return rSe.indexOf(e)===-1}):t},aSe=function(t){df(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.canvas=n.canvas?n.canvas:document.createElement("canvas"),a.ctx=a.canvas.getContext("2d"),a.options=n,a.canvas.width=Math.floor(n.width*n.scale),a.canvas.height=Math.floor(n.height*n.scale),a.canvas.style.width=n.width+"px",a.canvas.style.height=n.height+"px",a.ctx.scale(a.options.scale,a.options.scale),a.ctx.translate(-n.x,-n.y),a.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),a}return e.prototype.render=function(r){return tc(this,void 0,void 0,function(){var n,a;return jl(this,function(s){switch(s.label){case 0:return n=fk(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,sSe(n)];case 1:return a=s.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Co(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(a,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},e}(jte),sSe=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){e(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},iSe=function(){function t(e){var r=e.id,n=e.enabled;this.id=r,this.enabled=n,this.start=Date.now()}return t.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,YN([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.getTime=function(){return Date.now()-this.start},t.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,YN([this.id,this.getTime()+"ms"],e))},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,YN([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,YN([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.instances={},t}(),oSe=function(){function t(e,r){var n;this.windowBounds=r,this.instanceName="#"+t.instanceCount++,this.logger=new iSe({id:this.instanceName,enabled:e.logging}),this.cache=(n=e.cache)!==null&&n!==void 0?n:new SEe(this,e)}return t.instanceCount=1,t}(),Cg=function(t,e){return e===void 0&&(e={}),lSe(t,e)};typeof window<"u"&&Nte.setContext(window);var lSe=function(t,e){return tc(void 0,void 0,void 0,function(){var r,n,a,s,o,l,c,u,d,f,A,h,m,p,g,v,y,b,w,j,_,I,_,S,E,F,k,P,D,X,pe,ge,fe,xe,ae,Se,Te,O,G,z;return jl(this,function(L){switch(L.label){case 0:if(!t||typeof t!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=t.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(n=r.defaultView,!n)throw new Error("Document is not attached to a Window");return a={allowTaint:(S=e.allowTaint)!==null&&S!==void 0?S:!1,imageTimeout:(E=e.imageTimeout)!==null&&E!==void 0?E:15e3,proxy:e.proxy,useCORS:(F=e.useCORS)!==null&&F!==void 0?F:!1},s=YT({logging:(k=e.logging)!==null&&k!==void 0?k:!0,cache:e.cache},a),o={windowWidth:(P=e.windowWidth)!==null&&P!==void 0?P:n.innerWidth,windowHeight:(D=e.windowHeight)!==null&&D!==void 0?D:n.innerHeight,scrollX:(X=e.scrollX)!==null&&X!==void 0?X:n.pageXOffset,scrollY:(pe=e.scrollY)!==null&&pe!==void 0?pe:n.pageYOffset},l=new sA(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),c=new oSe(s,l),u=(ge=e.foreignObjectRendering)!==null&&ge!==void 0?ge:!1,d={allowTaint:(fe=e.allowTaint)!==null&&fe!==void 0?fe:!1,onclone:e.onclone,ignoreElements:e.ignoreElements,inlineImages:u,copyStyles:u},c.logger.debug("Starting document clone with size "+l.width+"x"+l.height+" scrolled to "+-l.left+","+-l.top),f=new cQ(c,t,d),A=f.clonedReferenceElement,A?[4,f.toIFrame(r,l)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return h=L.sent(),m=C6(A)||uEe(A)?U2e(A.ownerDocument):Oj(c,A),p=m.width,g=m.height,v=m.left,y=m.top,b=cSe(c,A,e.backgroundColor),w={canvas:e.canvas,backgroundColor:b,scale:(ae=(xe=e.scale)!==null&&xe!==void 0?xe:n.devicePixelRatio)!==null&&ae!==void 0?ae:1,x:((Se=e.x)!==null&&Se!==void 0?Se:0)+v,y:((Te=e.y)!==null&&Te!==void 0?Te:0)+y,width:(O=e.width)!==null&&O!==void 0?O:Math.ceil(p),height:(G=e.height)!==null&&G!==void 0?G:Math.ceil(g)},u?(c.logger.debug("Document cloned, using foreign object rendering"),_=new aSe(c,w),[4,_.render(A)]):[3,3];case 2:return j=L.sent(),[3,5];case 3:return c.logger.debug("Document cloned, element located at "+v+","+y+" with size "+p+"x"+g+" using computed rendering"),c.logger.debug("Starting DOM parsing"),I=mte(c,A),b===I.styles.backgroundColor&&(I.styles.backgroundColor=Gh.TRANSPARENT),c.logger.debug("Starting renderer for element at "+w.x+","+w.y+" with size "+w.width+"x"+w.height),_=new JEe(c,w),[4,_.render(I)];case 4:j=L.sent(),L.label=5;case 5:return(!((z=e.removeContainer)!==null&&z!==void 0)||z)&&(cQ.destroy(h)||c.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.logger.debug("Finished rendering"),[2,j]}})})},cSe=function(t,e,r){var n=e.ownerDocument,a=n.documentElement?fb(t,getComputedStyle(n.documentElement).backgroundColor):Gh.TRANSPARENT,s=n.body?fb(t,getComputedStyle(n.body).backgroundColor):Gh.TRANSPARENT,o=typeof r=="string"?fb(t,r):r===null?Gh.TRANSPARENT:4294967295;return e===n.documentElement?Y0(a)?Y0(s)?o:s:a:o};const _6=Object.freeze(Object.defineProperty({__proto__:null,default:Cg},Symbol.toStringTag,{value:"Module"})),uSe="modulepreload",dSe=function(t){return"/"+t},AQ={},Kh=function(e,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=dSe(c),c in AQ)return;AQ[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":uSe,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((A,h)=>{f.addEventListener("load",A),f.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};function Oa(t){"@babel/helpers - typeof";return Oa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oa(t)}var of=Uint8Array,hu=Uint16Array,E6=Int32Array,S6=new of([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),I6=new of([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),mQ=new of([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Pte=function(t,e){for(var r=new hu(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var a=new E6(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)a[s]=s-r[n]<<5|n;return{b:r,r:a}},Bte=Pte(S6,2),fSe=Bte.b,vk=Bte.r;fSe[28]=258,vk[258]=28;var hSe=Pte(I6,0),pQ=hSe.r,yk=new hu(32768);for(var As=0;As<32768;++As){var e0=(As&43690)>>1|(As&21845)<<1;e0=(e0&52428)>>2|(e0&13107)<<2,e0=(e0&61680)>>4|(e0&3855)<<4,yk[As]=((e0&65280)>>8|(e0&255)<<8)>>1}var pb=function(t,e,r){for(var n=t.length,a=0,s=new hu(e);a<n;++a)t[a]&&++s[t[a]-1];var o=new hu(e);for(a=1;a<e;++a)o[a]=o[a-1]+s[a-1]<<1;var l;if(r){l=new hu(1<<e);var c=15-e;for(a=0;a<n;++a)if(t[a])for(var u=a<<4|t[a],d=e-t[a],f=o[t[a]-1]++<<d,A=f|(1<<d)-1;f<=A;++f)l[yk[f]>>c]=u}else for(l=new hu(n),a=0;a<n;++a)t[a]&&(l[a]=yk[o[t[a]-1]++]>>15-t[a]);return l},eg=new of(288);for(var As=0;As<144;++As)eg[As]=8;for(var As=144;As<256;++As)eg[As]=9;for(var As=256;As<280;++As)eg[As]=7;for(var As=280;As<288;++As)eg[As]=8;var yS=new of(32);for(var As=0;As<32;++As)yS[As]=5;var ASe=pb(eg,9,0),mSe=pb(yS,5,0),Tte=function(t){return(t+7)/8|0},pSe=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new of(t.subarray(e,r))},hh=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},oy=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},M3=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var a=r.length,s=r.slice();if(!a)return{t:Fte,l:0};if(a==1){var o=new of(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(j,I){return j.f-I.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,d=1,f=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};d!=a-1;)l=r[r[u].f<r[f].f?u++:f++],c=r[u!=d&&r[u].f<r[f].f?u++:f++],r[d++]={s:-1,f:l.f+c.f,l,r:c};for(var A=s[0].s,n=1;n<a;++n)s[n].s>A&&(A=s[n].s);var h=new hu(A+1),m=bk(r[d-1],h,0);if(m>e){var n=0,p=0,g=m-e,v=1<<g;for(s.sort(function(I,_){return h[_.s]-h[I.s]||I.f-_.f});n<a;++n){var y=s[n].s;if(h[y]>e)p+=v-(1<<m-h[y]),h[y]=e;else break}for(p>>=g;p>0;){var b=s[n].s;h[b]<e?p-=1<<e-h[b]++-1:++n}for(;n>=0&&p;--n){var w=s[n].s;h[w]==e&&(--h[w],++p)}m=e}return{t:new of(h),l:m}},bk=function(t,e,r){return t.s==-1?Math.max(bk(t.l,e,r+1),bk(t.r,e,r+1)):e[t.s]=r},gQ=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new hu(++e),n=0,a=t[0],s=1,o=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==a&&l!=e)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=t[l]}return{c:r.subarray(0,n),n:e}},ly=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},kte=function(t,e,r){var n=r.length,a=Tte(e+2);t[a]=n&255,t[a+1]=n>>8,t[a+2]=t[a]^255,t[a+3]=t[a+1]^255;for(var s=0;s<n;++s)t[a+s+4]=r[s];return(a+4+n)*8},xQ=function(t,e,r,n,a,s,o,l,c,u,d){hh(e,d++,r),++a[256];for(var f=M3(a,15),A=f.t,h=f.l,m=M3(s,15),p=m.t,g=m.l,v=gQ(A),y=v.c,b=v.n,w=gQ(p),j=w.c,I=w.n,_=new hu(19),S=0;S<y.length;++S)++_[y[S]&31];for(var S=0;S<j.length;++S)++_[j[S]&31];for(var E=M3(_,7),F=E.t,k=E.l,P=19;P>4&&!F[mQ[P-1]];--P);var D=u+5<<3,X=ly(a,eg)+ly(s,yS)+o,pe=ly(a,A)+ly(s,p)+o+14+3*P+ly(_,F)+2*_[16]+3*_[17]+7*_[18];if(c>=0&&D<=X&&D<=pe)return kte(e,d,t.subarray(c,c+u));var ge,fe,xe,ae;if(hh(e,d,1+(pe<X)),d+=2,pe<X){ge=pb(A,h,0),fe=A,xe=pb(p,g,0),ae=p;var Se=pb(F,k,0);hh(e,d,b-257),hh(e,d+5,I-1),hh(e,d+10,P-4),d+=14;for(var S=0;S<P;++S)hh(e,d+3*S,F[mQ[S]]);d+=3*P;for(var Te=[y,j],O=0;O<2;++O)for(var G=Te[O],S=0;S<G.length;++S){var z=G[S]&31;hh(e,d,Se[z]),d+=F[z],z>15&&(hh(e,d,G[S]>>5&127),d+=G[S]>>12)}}else ge=ASe,fe=eg,xe=mSe,ae=yS;for(var S=0;S<l;++S){var L=n[S];if(L>255){var z=L>>18&31;oy(e,d,ge[z+257]),d+=fe[z+257],z>7&&(hh(e,d,L>>23&31),d+=S6[z]);var Z=L&31;oy(e,d,xe[Z]),d+=ae[Z],Z>3&&(oy(e,d,L>>5&8191),d+=I6[Z])}else oy(e,d,ge[L]),d+=fe[L]}return oy(e,d,ge[256]),d+fe[256]},gSe=new E6([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Fte=new of(0),xSe=function(t,e,r,n,a,s){var o=s.z||t.length,l=new of(n+o+5*(1+Math.ceil(o/7e3))+a),c=l.subarray(n,l.length-a),u=s.l,d=(s.r||0)&7;if(e){d&&(c[0]=s.r>>3);for(var f=gSe[e-1],A=f>>13,h=f&8191,m=(1<<r)-1,p=s.p||new hu(32768),g=s.h||new hu(m+1),v=Math.ceil(r/3),y=2*v,b=function(se){return(t[se]^t[se+1]<<v^t[se+2]<<y)&m},w=new E6(25e3),j=new hu(288),I=new hu(32),_=0,S=0,E=s.i||0,F=0,k=s.w||0,P=0;E+2<o;++E){var D=b(E),X=E&32767,pe=g[D];if(p[X]=pe,g[D]=X,k<=E){var ge=o-E;if((_>7e3||F>24576)&&(ge>423||!u)){d=xQ(t,c,0,w,j,I,S,F,P,E-P,d),F=_=S=0,P=E;for(var fe=0;fe<286;++fe)j[fe]=0;for(var fe=0;fe<30;++fe)I[fe]=0}var xe=2,ae=0,Se=h,Te=X-pe&32767;if(ge>2&&D==b(E-Te))for(var O=Math.min(A,ge)-1,G=Math.min(32767,E),z=Math.min(258,ge);Te<=G&&--Se&&X!=pe;){if(t[E+xe]==t[E+xe-Te]){for(var L=0;L<z&&t[E+L]==t[E+L-Te];++L);if(L>xe){if(xe=L,ae=Te,L>O)break;for(var Z=Math.min(Te,L-2),ee=0,fe=0;fe<Z;++fe){var R=E-Te+fe&32767,H=p[R],ne=R-H&32767;ne>ee&&(ee=ne,pe=R)}}}X=pe,pe=p[X],Te+=X-pe&32767}if(ae){w[F++]=268435456|vk[xe]<<18|pQ[ae];var ve=vk[xe]&31,U=pQ[ae]&31;S+=S6[ve]+I6[U],++j[257+ve],++I[U],k=E+xe,++_}else w[F++]=t[E],++j[t[E]]}}for(E=Math.max(E,k);E<o;++E)w[F++]=t[E],++j[t[E]];d=xQ(t,c,u,w,j,I,S,F,P,E-P,d),u||(s.r=d&7|c[d/8|0]<<3,d-=7,s.h=g,s.p=p,s.i=E,s.w=k)}else{for(var E=s.w||0;E<o+u;E+=65535){var He=E+65535;He>=o&&(c[d/8|0]=u,He=o),d=kte(c,d+1,t.subarray(E,He))}s.i=o}return pSe(l,0,n+Tte(d)+a)},Ote=function(){var t=1,e=0;return{p:function(r){for(var n=t,a=e,s=r.length|0,o=0;o!=s;){for(var l=Math.min(o+2655,s);o<l;++o)a+=n+=r[o];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}t=n,e=a},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},vSe=function(t,e,r,n,a){if(!a&&(a={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),o=new of(s.length+t.length);o.set(s),o.set(t,s.length),t=o,a.w=s.length}return xSe(t,e.level==null?6:e.level,e.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,a)},Dte=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},ySe=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var a=Ote();a.p(e.dictionary),Dte(t,2,a.d())}};function wk(t,e){e||(e={});var r=Ote();r.p(t);var n=vSe(t,e,e.dictionary?6:2,4);return ySe(n,e),Dte(n,n.length-4,r.d()),n}var bSe=typeof TextDecoder<"u"&&new TextDecoder,wSe=0;try{bSe.decode(Fte,{stream:!0}),wSe=1}catch{}function NSe(t){if(Array.isArray(t))return t}function CSe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,a,s,o,l=[],c=!0,u=!1;try{if(s=(r=r.call(t)).next,e!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function vQ(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function _Se(t,e){if(t){if(typeof t=="string")return vQ(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?vQ(t,e):void 0}}function ESe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yQ(t,e){return NSe(t)||CSe(t,e)||_Se(t,e)||ESe()}function bQ(t,e="utf8"){return new TextDecoder(e).decode(t)}const SSe=new TextEncoder;function ISe(t){return SSe.encode(t)}const jSe=1024*8,PSe=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),L3={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class j6{constructor(e=jSe,r={}){pr(this,"buffer");pr(this,"byteLength");pr(this,"byteOffset");pr(this,"length");pr(this,"offset");pr(this,"lastWrittenByte");pr(this,"littleEndian");pr(this,"_data");pr(this,"_mark");pr(this,"_marks");let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const a=r.offset?r.offset>>>0:0,s=e.byteLength-a;let o=a;(ArrayBuffer.isView(e)||e instanceof j6)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+a),e=e.buffer),n?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,a=new Uint8Array(n);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const n=L3[r].BYTES_PER_ELEMENT*e,a=this.byteOffset+this.offset,s=this.buffer.slice(a,a+n);if(this.littleEndian===PSe&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(a,a+n));l.reverse();const c=new L3[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new L3[r](s);return this.offset+=n,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let n=0;n<e;n++)r+=this.readChar();return r}readUtf8(e=1){return bQ(this.readBytes(e))}decodeText(e=1,r="utf8"){return bQ(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(ISe(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function c1(t){let e=t.length;for(;--e>=0;)t[e]=0}const BSe=3,TSe=258,Rte=29,kSe=256,FSe=kSe+1+Rte,Mte=30,OSe=512,DSe=new Array((FSe+2)*2);c1(DSe);const RSe=new Array(Mte*2);c1(RSe);const MSe=new Array(OSe);c1(MSe);const LSe=new Array(TSe-BSe+1);c1(LSe);const USe=new Array(Rte);c1(USe);const QSe=new Array(Mte);c1(QSe);const VSe=(t,e,r,n)=>{let a=t&65535|0,s=t>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do a=a+e[n++]|0,s=s+a|0;while(--o);a%=65521,s%=65521}return a|s<<16|0};var Nk=VSe;const HSe=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},$Se=new Uint32Array(HSe()),GSe=(t,e,r,n)=>{const a=$Se,s=n+r;t^=-1;for(let o=n;o<s;o++)t=t>>>8^a[(t^e[o])&255];return t^-1};var wf=GSe,Ck={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Lte={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const KSe=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var qSe=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)KSe(r,n)&&(t[n]=r[n])}}return t},zSe=t=>{let e=0;for(let n=0,a=t.length;n<a;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,a=0,s=t.length;n<s;n++){let o=t[n];r.set(o,a),a+=o.length}return r},Ute={assign:qSe,flattenChunks:zSe};let Qte=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Qte=!1}const x2=new Uint8Array(256);for(let t=0;t<256;t++)x2[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;x2[254]=x2[254]=1;var WSe=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,a,s,o=t.length,l=0;for(a=0;a<o;a++)r=t.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=t.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(l),s=0,a=0;s<l;a++)r=t.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=t.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|r&63):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|r&63):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|r&63);return e};const XSe=(t,e)=>{if(e<65534&&t.subarray&&Qte)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r};var YSe=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,a;const s=new Array(r*2);for(a=0,n=0;n<r;){let o=t[n++];if(o<128){s[a++]=o;continue}let l=x2[o];if(l>4){s[a++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|t[n++]&63,l--;if(l>1){s[a++]=65533;continue}o<65536?s[a++]=o:(o-=65536,s[a++]=55296|o>>10&1023,s[a++]=56320|o&1023)}return XSe(s,a)},JSe=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+x2[t[r]]>e?r:e},_k={string2buf:WSe,buf2string:YSe,utf8border:JSe};function ZSe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var eIe=ZSe;const yC=16209,tIe=16191;var rIe=function(e,r){let n,a,s,o,l,c,u,d,f,A,h,m,p,g,v,y,b,w,j,I,_,S,E,F;const k=e.state;n=e.next_in,E=e.input,a=n+(e.avail_in-5),s=e.next_out,F=e.output,o=s-(r-e.avail_out),l=s+(e.avail_out-257),c=k.dmax,u=k.wsize,d=k.whave,f=k.wnext,A=k.window,h=k.hold,m=k.bits,p=k.lencode,g=k.distcode,v=(1<<k.lenbits)-1,y=(1<<k.distbits)-1;e:do{m<15&&(h+=E[n++]<<m,m+=8,h+=E[n++]<<m,m+=8),b=p[h&v];t:for(;;){if(w=b>>>24,h>>>=w,m-=w,w=b>>>16&255,w===0)F[s++]=b&65535;else if(w&16){j=b&65535,w&=15,w&&(m<w&&(h+=E[n++]<<m,m+=8),j+=h&(1<<w)-1,h>>>=w,m-=w),m<15&&(h+=E[n++]<<m,m+=8,h+=E[n++]<<m,m+=8),b=g[h&y];r:for(;;){if(w=b>>>24,h>>>=w,m-=w,w=b>>>16&255,w&16){if(I=b&65535,w&=15,m<w&&(h+=E[n++]<<m,m+=8,m<w&&(h+=E[n++]<<m,m+=8)),I+=h&(1<<w)-1,I>c){e.msg="invalid distance too far back",k.mode=yC;break e}if(h>>>=w,m-=w,w=s-o,I>w){if(w=I-w,w>d&&k.sane){e.msg="invalid distance too far back",k.mode=yC;break e}if(_=0,S=A,f===0){if(_+=u-w,w<j){j-=w;do F[s++]=A[_++];while(--w);_=s-I,S=F}}else if(f<w){if(_+=u+f-w,w-=f,w<j){j-=w;do F[s++]=A[_++];while(--w);if(_=0,f<j){w=f,j-=w;do F[s++]=A[_++];while(--w);_=s-I,S=F}}}else if(_+=f-w,w<j){j-=w;do F[s++]=A[_++];while(--w);_=s-I,S=F}for(;j>2;)F[s++]=S[_++],F[s++]=S[_++],F[s++]=S[_++],j-=3;j&&(F[s++]=S[_++],j>1&&(F[s++]=S[_++]))}else{_=s-I;do F[s++]=F[_++],F[s++]=F[_++],F[s++]=F[_++],j-=3;while(j>2);j&&(F[s++]=F[_++],j>1&&(F[s++]=F[_++]))}}else if(w&64){e.msg="invalid distance code",k.mode=yC;break e}else{b=g[(b&65535)+(h&(1<<w)-1)];continue r}break}}else if(w&64)if(w&32){k.mode=tIe;break e}else{e.msg="invalid literal/length code",k.mode=yC;break e}else{b=p[(b&65535)+(h&(1<<w)-1)];continue t}break}}while(n<a&&s<l);j=m>>3,n-=j,m-=j<<3,h&=(1<<m)-1,e.next_in=n,e.next_out=s,e.avail_in=n<a?5+(a-n):5-(n-a),e.avail_out=s<l?257+(l-s):257-(s-l),k.hold=h,k.bits=m};const tx=15,wQ=852,NQ=592,CQ=0,U3=1,_Q=2,nIe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),aIe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),sIe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),iIe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),oIe=(t,e,r,n,a,s,o,l)=>{const c=l.bits;let u=0,d=0,f=0,A=0,h=0,m=0,p=0,g=0,v=0,y=0,b,w,j,I,_,S=null,E;const F=new Uint16Array(tx+1),k=new Uint16Array(tx+1);let P=null,D,X,pe;for(u=0;u<=tx;u++)F[u]=0;for(d=0;d<n;d++)F[e[r+d]]++;for(h=c,A=tx;A>=1&&F[A]===0;A--);if(h>A&&(h=A),A===0)return a[s++]=1<<24|64<<16|0,a[s++]=1<<24|64<<16|0,l.bits=1,0;for(f=1;f<A&&F[f]===0;f++);for(h<f&&(h=f),g=1,u=1;u<=tx;u++)if(g<<=1,g-=F[u],g<0)return-1;if(g>0&&(t===CQ||A!==1))return-1;for(k[1]=0,u=1;u<tx;u++)k[u+1]=k[u]+F[u];for(d=0;d<n;d++)e[r+d]!==0&&(o[k[e[r+d]]++]=d);if(t===CQ?(S=P=o,E=20):t===U3?(S=nIe,P=aIe,E=257):(S=sIe,P=iIe,E=0),y=0,d=0,u=f,_=s,m=h,p=0,j=-1,v=1<<h,I=v-1,t===U3&&v>wQ||t===_Q&&v>NQ)return 1;for(;;){D=u-p,o[d]+1<E?(X=0,pe=o[d]):o[d]>=E?(X=P[o[d]-E],pe=S[o[d]-E]):(X=96,pe=0),b=1<<u-p,w=1<<m,f=w;do w-=b,a[_+(y>>p)+w]=D<<24|X<<16|pe|0;while(w!==0);for(b=1<<u-1;y&b;)b>>=1;if(b!==0?(y&=b-1,y+=b):y=0,d++,--F[u]===0){if(u===A)break;u=e[r+o[d]]}if(u>h&&(y&I)!==j){for(p===0&&(p=h),_+=f,m=u-p,g=1<<m;m+p<A&&(g-=F[m+p],!(g<=0));)m++,g<<=1;if(v+=1<<m,t===U3&&v>wQ||t===_Q&&v>NQ)return 1;j=y&I,a[j]=h<<24|m<<16|_-s|0}}return y!==0&&(a[_+y]=u-p<<24|64<<16|0),l.bits=h,0};var gb=oIe;const lIe=0,Vte=1,Hte=2,{Z_FINISH:EQ,Z_BLOCK:cIe,Z_TREES:bC,Z_OK:tg,Z_STREAM_END:uIe,Z_NEED_DICT:dIe,Z_STREAM_ERROR:Ad,Z_DATA_ERROR:$te,Z_MEM_ERROR:Gte,Z_BUF_ERROR:fIe,Z_DEFLATED:SQ}=Lte,Gj=16180,IQ=16181,jQ=16182,PQ=16183,BQ=16184,TQ=16185,kQ=16186,FQ=16187,OQ=16188,DQ=16189,bS=16190,Ah=16191,Q3=16192,RQ=16193,V3=16194,MQ=16195,LQ=16196,UQ=16197,QQ=16198,wC=16199,NC=16200,VQ=16201,HQ=16202,$Q=16203,GQ=16204,KQ=16205,H3=16206,qQ=16207,zQ=16208,ys=16209,Kte=16210,qte=16211,hIe=852,AIe=592,mIe=15,pIe=mIe,WQ=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function gIe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const _g=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<Gj||e.mode>qte?1:0},zte=t=>{if(_g(t))return Ad;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=Gj,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(hIe),e.distcode=e.distdyn=new Int32Array(AIe),e.sane=1,e.back=-1,tg},Wte=t=>{if(_g(t))return Ad;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,zte(t)},Xte=(t,e)=>{let r;if(_g(t))return Ad;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Ad:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,Wte(t))},Yte=(t,e)=>{if(!t)return Ad;const r=new gIe;t.state=r,r.strm=t,r.window=null,r.mode=Gj;const n=Xte(t,e);return n!==tg&&(t.state=null),n},xIe=t=>Yte(t,pIe);let XQ=!0,$3,G3;const vIe=t=>{if(XQ){$3=new Int32Array(512),G3=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(gb(Vte,t.lens,0,288,$3,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;gb(Hte,t.lens,0,32,G3,0,t.work,{bits:5}),XQ=!1}t.lencode=$3,t.lenbits=9,t.distcode=G3,t.distbits=5},Jte=(t,e,r,n)=>{let a;const s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(e.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(a=s.wsize-s.wnext,a>n&&(a=n),s.window.set(e.subarray(r-n,r-n+a),s.wnext),n-=a,n?(s.window.set(e.subarray(r-n,r),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0},yIe=(t,e)=>{let r,n,a,s,o,l,c,u,d,f,A,h,m,p,g=0,v,y,b,w,j,I,_,S;const E=new Uint8Array(4);let F,k;const P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(_g(t)||!t.output||!t.input&&t.avail_in!==0)return Ad;r=t.state,r.mode===Ah&&(r.mode=Q3),o=t.next_out,a=t.output,c=t.avail_out,s=t.next_in,n=t.input,l=t.avail_in,u=r.hold,d=r.bits,f=l,A=c,S=tg;e:for(;;)switch(r.mode){case Gj:if(r.wrap===0){r.mode=Q3;break}for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&2&&u===35615){r.wbits===0&&(r.wbits=15),r.check=0,E[0]=u&255,E[1]=u>>>8&255,r.check=wf(r.check,E,2,0),u=0,d=0,r.mode=IQ;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){t.msg="incorrect header check",r.mode=ys;break}if((u&15)!==SQ){t.msg="unknown compression method",r.mode=ys;break}if(u>>>=4,d-=4,_=(u&15)+8,r.wbits===0&&(r.wbits=_),_>15||_>r.wbits){t.msg="invalid window size",r.mode=ys;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=u&512?DQ:Ah,u=0,d=0;break;case IQ:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.flags=u,(r.flags&255)!==SQ){t.msg="unknown compression method",r.mode=ys;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=ys;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,r.check=wf(r.check,E,2,0)),u=0,d=0,r.mode=jQ;case jQ:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.head&&(r.head.time=u),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,E[2]=u>>>16&255,E[3]=u>>>24&255,r.check=wf(r.check,E,4,0)),u=0,d=0,r.mode=PQ;case PQ:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,r.check=wf(r.check,E,2,0)),u=0,d=0,r.mode=BQ;case BQ:if(r.flags&1024){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,r.check=wf(r.check,E,2,0)),u=0,d=0}else r.head&&(r.head.extra=null);r.mode=TQ;case TQ:if(r.flags&1024&&(h=r.length,h>l&&(h=l),h&&(r.head&&(_=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(s,s+h),_)),r.flags&512&&r.wrap&4&&(r.check=wf(r.check,n,h,s)),l-=h,s+=h,r.length-=h),r.length))break e;r.length=0,r.mode=kQ;case kQ:if(r.flags&2048){if(l===0)break e;h=0;do _=n[s+h++],r.head&&_&&r.length<65536&&(r.head.name+=String.fromCharCode(_));while(_&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=wf(r.check,n,h,s)),l-=h,s+=h,_)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=FQ;case FQ:if(r.flags&4096){if(l===0)break e;h=0;do _=n[s+h++],r.head&&_&&r.length<65536&&(r.head.comment+=String.fromCharCode(_));while(_&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=wf(r.check,n,h,s)),l-=h,s+=h,_)break e}else r.head&&(r.head.comment=null);r.mode=OQ;case OQ:if(r.flags&512){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&4&&u!==(r.check&65535)){t.msg="header crc mismatch",r.mode=ys;break}u=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Ah;break;case DQ:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}t.adler=r.check=WQ(u),u=0,d=0,r.mode=bS;case bS:if(r.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,r.hold=u,r.bits=d,dIe;t.adler=r.check=1,r.mode=Ah;case Ah:if(e===cIe||e===bC)break e;case Q3:if(r.last){u>>>=d&7,d-=d&7,r.mode=H3;break}for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}switch(r.last=u&1,u>>>=1,d-=1,u&3){case 0:r.mode=RQ;break;case 1:if(vIe(r),r.mode=wC,e===bC){u>>>=2,d-=2;break e}break;case 2:r.mode=LQ;break;case 3:t.msg="invalid block type",r.mode=ys}u>>>=2,d-=2;break;case RQ:for(u>>>=d&7,d-=d&7;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if((u&65535)!==(u>>>16^65535)){t.msg="invalid stored block lengths",r.mode=ys;break}if(r.length=u&65535,u=0,d=0,r.mode=V3,e===bC)break e;case V3:r.mode=MQ;case MQ:if(h=r.length,h){if(h>l&&(h=l),h>c&&(h=c),h===0)break e;a.set(n.subarray(s,s+h),o),l-=h,s+=h,c-=h,o+=h,r.length-=h;break}r.mode=Ah;break;case LQ:for(;d<14;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.nlen=(u&31)+257,u>>>=5,d-=5,r.ndist=(u&31)+1,u>>>=5,d-=5,r.ncode=(u&15)+4,u>>>=4,d-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=ys;break}r.have=0,r.mode=UQ;case UQ:for(;r.have<r.ncode;){for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.lens[P[r.have++]]=u&7,u>>>=3,d-=3}for(;r.have<19;)r.lens[P[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,F={bits:r.lenbits},S=gb(lIe,r.lens,0,19,r.lencode,0,r.work,F),r.lenbits=F.bits,S){t.msg="invalid code lengths set",r.mode=ys;break}r.have=0,r.mode=QQ;case QQ:for(;r.have<r.nlen+r.ndist;){for(;g=r.lencode[u&(1<<r.lenbits)-1],v=g>>>24,y=g>>>16&255,b=g&65535,!(v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(b<16)u>>>=v,d-=v,r.lens[r.have++]=b;else{if(b===16){for(k=v+2;d<k;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(u>>>=v,d-=v,r.have===0){t.msg="invalid bit length repeat",r.mode=ys;break}_=r.lens[r.have-1],h=3+(u&3),u>>>=2,d-=2}else if(b===17){for(k=v+3;d<k;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=v,d-=v,_=0,h=3+(u&7),u>>>=3,d-=3}else{for(k=v+7;d<k;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=v,d-=v,_=0,h=11+(u&127),u>>>=7,d-=7}if(r.have+h>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=ys;break}for(;h--;)r.lens[r.have++]=_}}if(r.mode===ys)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=ys;break}if(r.lenbits=9,F={bits:r.lenbits},S=gb(Vte,r.lens,0,r.nlen,r.lencode,0,r.work,F),r.lenbits=F.bits,S){t.msg="invalid literal/lengths set",r.mode=ys;break}if(r.distbits=6,r.distcode=r.distdyn,F={bits:r.distbits},S=gb(Hte,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,F),r.distbits=F.bits,S){t.msg="invalid distances set",r.mode=ys;break}if(r.mode=wC,e===bC)break e;case wC:r.mode=NC;case NC:if(l>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,r.hold=u,r.bits=d,rIe(t,A),o=t.next_out,a=t.output,c=t.avail_out,s=t.next_in,n=t.input,l=t.avail_in,u=r.hold,d=r.bits,r.mode===Ah&&(r.back=-1);break}for(r.back=0;g=r.lencode[u&(1<<r.lenbits)-1],v=g>>>24,y=g>>>16&255,b=g&65535,!(v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(y&&!(y&240)){for(w=v,j=y,I=b;g=r.lencode[I+((u&(1<<w+j)-1)>>w)],v=g>>>24,y=g>>>16&255,b=g&65535,!(w+v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=w,d-=w,r.back+=w}if(u>>>=v,d-=v,r.back+=v,r.length=b,y===0){r.mode=KQ;break}if(y&32){r.back=-1,r.mode=Ah;break}if(y&64){t.msg="invalid literal/length code",r.mode=ys;break}r.extra=y&15,r.mode=VQ;case VQ:if(r.extra){for(k=r.extra;d<k;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=HQ;case HQ:for(;g=r.distcode[u&(1<<r.distbits)-1],v=g>>>24,y=g>>>16&255,b=g&65535,!(v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(!(y&240)){for(w=v,j=y,I=b;g=r.distcode[I+((u&(1<<w+j)-1)>>w)],v=g>>>24,y=g>>>16&255,b=g&65535,!(w+v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=w,d-=w,r.back+=w}if(u>>>=v,d-=v,r.back+=v,y&64){t.msg="invalid distance code",r.mode=ys;break}r.offset=b,r.extra=y&15,r.mode=$Q;case $Q:if(r.extra){for(k=r.extra;d<k;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=ys;break}r.mode=GQ;case GQ:if(c===0)break e;if(h=A-c,r.offset>h){if(h=r.offset-h,h>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=ys;break}h>r.wnext?(h-=r.wnext,m=r.wsize-h):m=r.wnext-h,h>r.length&&(h=r.length),p=r.window}else p=a,m=o-r.offset,h=r.length;h>c&&(h=c),c-=h,r.length-=h;do a[o++]=p[m++];while(--h);r.length===0&&(r.mode=NC);break;case KQ:if(c===0)break e;a[o++]=r.length,c--,r.mode=NC;break;case H3:if(r.wrap){for(;d<32;){if(l===0)break e;l--,u|=n[s++]<<d,d+=8}if(A-=c,t.total_out+=A,r.total+=A,r.wrap&4&&A&&(t.adler=r.check=r.flags?wf(r.check,a,A,o-A):Nk(r.check,a,A,o-A)),A=c,r.wrap&4&&(r.flags?u:WQ(u))!==r.check){t.msg="incorrect data check",r.mode=ys;break}u=0,d=0}r.mode=qQ;case qQ:if(r.wrap&&r.flags){for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&4&&u!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=ys;break}u=0,d=0}r.mode=zQ;case zQ:S=uIe;break e;case ys:S=$te;break e;case Kte:return Gte;case qte:default:return Ad}return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,r.hold=u,r.bits=d,(r.wsize||A!==t.avail_out&&r.mode<ys&&(r.mode<H3||e!==EQ))&&Jte(t,t.output,t.next_out,A-t.avail_out),f-=t.avail_in,A-=t.avail_out,t.total_in+=f,t.total_out+=A,r.total+=A,r.wrap&4&&A&&(t.adler=r.check=r.flags?wf(r.check,a,A,t.next_out-A):Nk(r.check,a,A,t.next_out-A)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Ah?128:0)+(r.mode===wC||r.mode===V3?256:0),(f===0&&A===0||e===EQ)&&S===tg&&(S=fIe),S},bIe=t=>{if(_g(t))return Ad;let e=t.state;return e.window&&(e.window=null),t.state=null,tg},wIe=(t,e)=>{if(_g(t))return Ad;const r=t.state;return r.wrap&2?(r.head=e,e.done=!1,tg):Ad},NIe=(t,e)=>{const r=e.length;let n,a,s;return _g(t)||(n=t.state,n.wrap!==0&&n.mode!==bS)?Ad:n.mode===bS&&(a=1,a=Nk(a,e,r,0),a!==n.check)?$te:(s=Jte(t,e,r,r),s?(n.mode=Kte,Gte):(n.havedict=1,tg))};var CIe=Wte,_Ie=Xte,EIe=zte,SIe=xIe,IIe=Yte,jIe=yIe,PIe=bIe,BIe=wIe,TIe=NIe,kIe="pako inflate (from Nodeca project)",Eh={inflateReset:CIe,inflateReset2:_Ie,inflateResetKeep:EIe,inflateInit:SIe,inflateInit2:IIe,inflate:jIe,inflateEnd:PIe,inflateGetHeader:BIe,inflateSetDictionary:TIe,inflateInfo:kIe};function FIe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var OIe=FIe;const Zte=Object.prototype.toString,{Z_NO_FLUSH:DIe,Z_FINISH:RIe,Z_OK:v2,Z_STREAM_END:K3,Z_NEED_DICT:q3,Z_STREAM_ERROR:MIe,Z_DATA_ERROR:YQ,Z_MEM_ERROR:LIe}=Lte;function Sw(t){this.options=Ute.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new eIe,this.strm.avail_out=0;let r=Eh.inflateInit2(this.strm,e.windowBits);if(r!==v2)throw new Error(Ck[r]);if(this.header=new OIe,Eh.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=_k.string2buf(e.dictionary):Zte.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Eh.inflateSetDictionary(this.strm,e.dictionary),r!==v2)))throw new Error(Ck[r])}Sw.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,a=this.options.dictionary;let s,o,l;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?RIe:DIe,Zte.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),s=Eh.inflate(r,o),s===q3&&a&&(s=Eh.inflateSetDictionary(r,a),s===v2?s=Eh.inflate(r,o):s===YQ&&(s=q3));r.avail_in>0&&s===K3&&r.state.wrap>0&&t[r.next_in]!==0;)Eh.inflateReset(r),s=Eh.inflate(r,o);switch(s){case MIe:case YQ:case q3:case LIe:return this.onEnd(s),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||s===K3))if(this.options.to==="string"){let c=_k.utf8border(r.output,r.next_out),u=r.next_out-c,d=_k.buf2string(r.output,c);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(c,c+u),0),this.onData(d)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===v2&&l===0)){if(s===K3)return s=Eh.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Sw.prototype.onData=function(t){this.chunks.push(t)};Sw.prototype.onEnd=function(t){t===v2&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Ute.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function UIe(t,e){const r=new Sw(e);if(r.push(t),r.err)throw r.msg||Ck[r.err];return r.result}var QIe=Sw,VIe=UIe,HIe={Inflate:QIe,inflate:VIe};const{Inflate:$Ie,inflate:GIe}=HIe;var JQ=$Ie,KIe=GIe;const ere=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;ere[t]=e}const ZQ=4294967295;function qIe(t,e,r){let n=t;for(let a=0;a<r;a++)n=ere[(n^e[a])&255]^n>>>8;return n}function zIe(t,e){return(qIe(ZQ,t,e)^ZQ)>>>0}function eV(t,e,r){const n=t.readUint32(),a=zIe(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(a!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${a}`)}function tre(t,e,r){for(let n=0;n<r;n++)e[n]=t[n]}function rre(t,e,r,n){let a=0;for(;a<n;a++)e[a]=t[a];for(;a<r;a++)e[a]=t[a]+e[a-n]&255}function nre(t,e,r,n){let a=0;if(r.length===0)for(;a<n;a++)e[a]=t[a];else for(;a<n;a++)e[a]=t[a]+r[a]&255}function are(t,e,r,n,a){let s=0;if(r.length===0){for(;s<a;s++)e[s]=t[s];for(;s<n;s++)e[s]=t[s]+(e[s-a]>>1)&255}else{for(;s<a;s++)e[s]=t[s]+(r[s]>>1)&255;for(;s<n;s++)e[s]=t[s]+(e[s-a]+r[s]>>1)&255}}function sre(t,e,r,n,a){let s=0;if(r.length===0){for(;s<a;s++)e[s]=t[s];for(;s<n;s++)e[s]=t[s]+e[s-a]&255}else{for(;s<a;s++)e[s]=t[s]+r[s]&255;for(;s<n;s++)e[s]=t[s]+WIe(e[s-a],r[s],r[s-a])&255}}function WIe(t,e,r){const n=t+e-r,a=Math.abs(n-t),s=Math.abs(n-e),o=Math.abs(n-r);return a<=s&&a<=o?t:s<=o?e:r}function XIe(t,e,r,n,a,s){switch(t){case 0:tre(e,r,a);break;case 1:rre(e,r,a,s);break;case 2:nre(e,r,n,a);break;case 3:are(e,r,n,a,s);break;case 4:sre(e,r,n,a,s);break;default:throw new Error(`Unsupported filter: ${t}`)}}const YIe=new Uint16Array([255]),JIe=new Uint8Array(YIe.buffer),ZIe=JIe[0]===255;function eje(t){const{data:e,width:r,height:n,channels:a,depth:s}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(s/8)*a,c=new Uint8Array(n*r*l);let u=0;for(let d=0;d<7;d++){const f=o[d],A=Math.ceil((r-f.x)/f.xStep),h=Math.ceil((n-f.y)/f.yStep);if(A<=0||h<=0)continue;const m=A*l,p=new Uint8Array(m);for(let g=0;g<h;g++){const v=e[u++],y=e.subarray(u,u+m);u+=m;const b=new Uint8Array(m);XIe(v,y,b,p,m,l),p.set(b);for(let w=0;w<A;w++){const j=f.x+w*f.xStep,I=f.y+g*f.yStep;if(!(j>=r||I>=n))for(let _=0;_<l;_++)c[(I*r+j)*l+_]=b[w*l+_]}}}if(s===16){const d=new Uint16Array(c.buffer);if(ZIe)for(let f=0;f<d.length;f++)d[f]=tje(d[f]);return d}else return c}function tje(t){return(t&255)<<8|t>>8&255}const rje=new Uint16Array([255]),nje=new Uint8Array(rje.buffer),aje=nje[0]===255,sje=new Uint8Array(0);function tV(t){const{data:e,width:r,height:n,channels:a,depth:s}=t,o=Math.ceil(s/8)*a,l=Math.ceil(s/8*a*r),c=new Uint8Array(n*l);let u=sje,d=0,f,A;for(let h=0;h<n;h++){switch(f=e.subarray(d+1,d+1+l),A=c.subarray(h*l,(h+1)*l),e[d]){case 0:tre(f,A,l);break;case 1:rre(f,A,l,o);break;case 2:nre(f,A,u,l);break;case 3:are(f,A,u,l,o);break;case 4:sre(f,A,u,l,o);break;default:throw new Error(`Unsupported filter: ${e[d]}`)}u=A,d+=l+1}if(s===16){const h=new Uint16Array(c.buffer);if(aje)for(let m=0;m<h.length;m++)h[m]=ije(h[m]);return h}else return c}function ije(t){return(t&255)<<8|t>>8&255}const aE=Uint8Array.of(137,80,78,71,13,10,26,10);function rV(t){if(!oje(t.readBytes(aE.length)))throw new Error("wrong PNG signature")}function oje(t){if(t.length<aE.length)return!1;for(let e=0;e<aE.length;e++)if(t[e]!==aE[e])return!1;return!0}const lje="tEXt",cje=0,ire=new TextDecoder("latin1");function uje(t){if(fje(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const dje=/^[\u0000-\u00FF]*$/;function fje(t){if(!dje.test(t))throw new Error("invalid latin1 text")}function hje(t,e,r){const n=ore(e);t[n]=Aje(e,r-n.length-1)}function ore(t){for(t.mark();t.readByte()!==cje;);const e=t.offset;t.reset();const r=ire.decode(t.readBytes(e-t.offset-1));return t.skip(1),uje(r),r}function Aje(t,e){return ire.decode(t.readBytes(e))}const Zc={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},z3={UNKNOWN:-1,DEFLATE:0},nV={UNKNOWN:-1,ADAPTIVE:0},W3={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},CC={NONE:0,BACKGROUND:1,PREVIOUS:2},X3={SOURCE:0,OVER:1};class mje extends j6{constructor(r,n={}){super(r);pr(this,"_checkCrc");pr(this,"_inflator");pr(this,"_png");pr(this,"_apng");pr(this,"_end");pr(this,"_hasPalette");pr(this,"_palette");pr(this,"_hasTransparency");pr(this,"_transparency");pr(this,"_compressionMethod");pr(this,"_filterMethod");pr(this,"_interlaceMethod");pr(this,"_colorType");pr(this,"_isAnimated");pr(this,"_numberOfFrames");pr(this,"_numberOfPlays");pr(this,"_frames");pr(this,"_writingDataChunks");const{checkCrc:a=!1}=n;this._checkCrc=a,this._inflator=new JQ,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=z3.UNKNOWN,this._filterMethod=nV.UNKNOWN,this._interlaceMethod=W3.UNKNOWN,this._colorType=Zc.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(rV(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(rV(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const a=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case lje:hje(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?eV(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const a=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=a+r;break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?eV(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=pje(this.readUint8());const n=this.readUint8();this._colorType=n;let a;switch(n){case Zc.GREYSCALE:a=1;break;case Zc.TRUECOLOUR:a=3;break;case Zc.INDEXED_COLOUR:a=1;break;case Zc.GREYSCALE_ALPHA:a=2;break;case Zc.TRUECOLOUR_ALPHA:a=4;break;case Zc.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==z3.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const a=[];this._palette=a;for(let s=0;s<n;s++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,a=this.offset+this.byteOffset;if(a+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Zc.GREYSCALE:case Zc.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case Zc.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const a=this.readByte();this._palette[n].push(a)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Zc.UNKNOWN:case Zc.GREYSCALE_ALPHA:case Zc.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=ore(this),a=this.readUint8();if(a!==z3.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const s=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:KIe(s)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),a=this.readByte();this._png.resolution={x:r,y:n,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(r);if(a){if(a.data=tV({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)n.data=a.data;else{const s=this._apng.frames.at(r-1);this.disposeFrame(a,s,n),this.addFrameDataToCanvas(n,a)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,a){switch(r.disposeOp){case CC.NONE:break;case CC.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const l=(s*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)a.data[l+c]=0}break;case CC.PREVIOUS:a.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const a=1<<this._png.depth,s=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,u=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:u}};switch(n.blendOp){case X3.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++)r.data[c+d]=n.data[u+d]}break;case X3.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++){const f=n.data[u+this._png.channels-1]/a,A=d%(this._png.channels-1)===0?1:n.data[u+d],h=Math.floor(f*A+(1-f)*r.data[c+d]);r.data[c+d]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==nV.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===W3.NO_INTERLACE)this._png.data=tV({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===W3.ADAM7)this._png.data=eje({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:CC.NONE,blendOp:X3.SOURCE,data:r}),this._inflator=new JQ,this._writingDataChunks=!1}}function pje(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var aV;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(aV||(aV={}));function gje(t,e){return new mje(t,e).decode()}var gn=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Y3(){gn.console&&typeof gn.console.log=="function"&&gn.console.log.apply(gn.console,arguments)}var Xa={log:Y3,warn:function(t){gn.console&&(typeof gn.console.warn=="function"?gn.console.warn.apply(gn.console,arguments):Y3.call(null,arguments))},error:function(t){gn.console&&(typeof gn.console.error=="function"?gn.console.error.apply(gn.console,arguments):Y3(t))}};function J3(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){Jm(n.response,e,r)},n.onerror=function(){Xa.error("could not download file")},n.send()}function sV(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function _C(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var Jm=gn.saveAs||((typeof window>"u"?"undefined":Oa(window))!=="object"||window!==gn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=gn.URL||gn.webkitURL,a=document.createElement("a");e=e||t.name||"download",a.download=e,a.rel="noopener",typeof t=="string"?(a.href=t,a.origin!==location.origin?sV(a.href)?J3(t,e,r):_C(a,a.target="_blank"):_C(a)):(a.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){_C(a)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(sV(t))J3(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){_C(n)})}else navigator.msSaveOrOpenBlob(function(a,s){return s===void 0?s={autoBom:!1}:Oa(s)!=="object"&&(Xa.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return J3(t,e,r);var a=t.type==="application/octet-stream",s=/constructor/i.test(gn.HTMLElement)||gn.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||a&&s)&&(typeof FileReader>"u"?"undefined":Oa(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var d=l.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},l.readAsDataURL(t)}else{var c=gn.URL||gn.webkitURL,u=c.createObjectURL(t);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function lre(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,s=r[n].process,o=a.exec(t);o&&(e=s(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var sE=gn.atob.bind(gn),iV=gn.btoa.bind(gn);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Z3(t,e){var r=t[0],n=t[1],a=t[2],s=t[3];r=yl(r,n,a,s,e[0],7,-680876936),s=yl(s,r,n,a,e[1],12,-389564586),a=yl(a,s,r,n,e[2],17,606105819),n=yl(n,a,s,r,e[3],22,-1044525330),r=yl(r,n,a,s,e[4],7,-176418897),s=yl(s,r,n,a,e[5],12,1200080426),a=yl(a,s,r,n,e[6],17,-1473231341),n=yl(n,a,s,r,e[7],22,-45705983),r=yl(r,n,a,s,e[8],7,1770035416),s=yl(s,r,n,a,e[9],12,-1958414417),a=yl(a,s,r,n,e[10],17,-42063),n=yl(n,a,s,r,e[11],22,-1990404162),r=yl(r,n,a,s,e[12],7,1804603682),s=yl(s,r,n,a,e[13],12,-40341101),a=yl(a,s,r,n,e[14],17,-1502002290),r=bl(r,n=yl(n,a,s,r,e[15],22,1236535329),a,s,e[1],5,-165796510),s=bl(s,r,n,a,e[6],9,-1069501632),a=bl(a,s,r,n,e[11],14,643717713),n=bl(n,a,s,r,e[0],20,-373897302),r=bl(r,n,a,s,e[5],5,-701558691),s=bl(s,r,n,a,e[10],9,38016083),a=bl(a,s,r,n,e[15],14,-660478335),n=bl(n,a,s,r,e[4],20,-405537848),r=bl(r,n,a,s,e[9],5,568446438),s=bl(s,r,n,a,e[14],9,-1019803690),a=bl(a,s,r,n,e[3],14,-187363961),n=bl(n,a,s,r,e[8],20,1163531501),r=bl(r,n,a,s,e[13],5,-1444681467),s=bl(s,r,n,a,e[2],9,-51403784),a=bl(a,s,r,n,e[7],14,1735328473),r=wl(r,n=bl(n,a,s,r,e[12],20,-1926607734),a,s,e[5],4,-378558),s=wl(s,r,n,a,e[8],11,-2022574463),a=wl(a,s,r,n,e[11],16,1839030562),n=wl(n,a,s,r,e[14],23,-35309556),r=wl(r,n,a,s,e[1],4,-1530992060),s=wl(s,r,n,a,e[4],11,1272893353),a=wl(a,s,r,n,e[7],16,-155497632),n=wl(n,a,s,r,e[10],23,-1094730640),r=wl(r,n,a,s,e[13],4,681279174),s=wl(s,r,n,a,e[0],11,-358537222),a=wl(a,s,r,n,e[3],16,-722521979),n=wl(n,a,s,r,e[6],23,76029189),r=wl(r,n,a,s,e[9],4,-640364487),s=wl(s,r,n,a,e[12],11,-421815835),a=wl(a,s,r,n,e[15],16,530742520),r=Nl(r,n=wl(n,a,s,r,e[2],23,-995338651),a,s,e[0],6,-198630844),s=Nl(s,r,n,a,e[7],10,1126891415),a=Nl(a,s,r,n,e[14],15,-1416354905),n=Nl(n,a,s,r,e[5],21,-57434055),r=Nl(r,n,a,s,e[12],6,1700485571),s=Nl(s,r,n,a,e[3],10,-1894986606),a=Nl(a,s,r,n,e[10],15,-1051523),n=Nl(n,a,s,r,e[1],21,-2054922799),r=Nl(r,n,a,s,e[8],6,1873313359),s=Nl(s,r,n,a,e[15],10,-30611744),a=Nl(a,s,r,n,e[6],15,-1560198380),n=Nl(n,a,s,r,e[13],21,1309151649),r=Nl(r,n,a,s,e[4],6,-145523070),s=Nl(s,r,n,a,e[11],10,-1120210379),a=Nl(a,s,r,n,e[2],15,718787259),n=Nl(n,a,s,r,e[9],21,-343485551),t[0]=F0(r,t[0]),t[1]=F0(n,t[1]),t[2]=F0(a,t[2]),t[3]=F0(s,t[3])}function Kj(t,e,r,n,a,s){return e=F0(F0(e,t),F0(n,s)),F0(e<<a|e>>>32-a,r)}function yl(t,e,r,n,a,s,o){return Kj(e&r|~e&n,t,e,a,s,o)}function bl(t,e,r,n,a,s,o){return Kj(e&n|r&~n,t,e,a,s,o)}function wl(t,e,r,n,a,s,o){return Kj(e^r^n,t,e,a,s,o)}function Nl(t,e,r,n,a,s,o){return Kj(r^(e|~n),t,e,a,s,o)}function cre(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)Z3(n,xje(t.substring(e-64,e)));t=t.substring(e-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)a[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(a[e>>2]|=128<<(e%4<<3),e>55)for(Z3(n,a),e=0;e<16;e++)a[e]=0;return a[14]=8*r,Z3(n,a),n}function xje(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var oV="0123456789abcdef".split("");function vje(t){for(var e="",r=0;r<4;r++)e+=oV[t>>8*r+4&15]+oV[t>>8*r&15];return e}function yje(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Ek(t){return cre(t).map(yje).join("")}var bje=function(t){for(var e=0;e<t.length;e++)t[e]=vje(t[e]);return t.join("")}(cre("hello"))!="5d41402abc4b2a76b9719d911017c592";function F0(t,e){if(bje){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Sk(t,e){var r,n,a,s;if(t!==r){for(var o=(a=t,s=1+(256/t.length|0),new Array(s+1).join(a)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var d=l[c];u=(u+d+o.charCodeAt(c))%256,l[c]=l[u],l[u]=d}r=t,n=l}else l=n;var f=e.length,A=0,h=0,m="";for(c=0;c<f;c++)h=(h+(d=l[A=(A+1)%256]))%256,l[A]=l[h],l[h]=d,o=l[(l[A]+l[h])%256],m+=String.fromCharCode(e.charCodeAt(c)^o);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var lV={print:4,modify:8,copy:16,"annot-forms":32};function Cx(t,e,r,n){this.v=1,this.r=2;var a=192;t.forEach(function(l){if(lV.perm!==void 0)throw new Error("Invalid permission: "+l);a+=lV[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(e+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^a)),this.encryptionKey=Ek(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Sk(this.encryptionKey,this.padding)}function _x(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var a=t.charCodeAt(n);e+=a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?"#"+("0"+a.toString(16)).slice(-2):t[n]}return e}function cV(t){if(Oa(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var s=Math.random().toString(35);return e[r][s]=[n,!!a],s},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var s in e[r]){var o=e[r][s];try{o[0].apply(t,n)}catch(l){gn.console&&Xa.error("jsPDF PubSub Error",l.message,l)}o[1]&&a.push(s)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function y2(t){if(!(this instanceof y2))return new y2(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function ure(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function E0(t,e,r,n,a){if(!(this instanceof E0))return new E0(t,e,r,n,a);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,ure.call(this,n,a)}function mp(t,e,r,n,a){if(!(this instanceof mp))return new mp(t,e,r,n,a);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,ure.call(this,n,a)}function Rr(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],s=arguments[3],o=[],l=1,c=16,u="S",d=null;Oa(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,a=t.format||a,s=t.compress||t.compressPdf||s,(d=t.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),u=t.defaultPathOperation||"S"),o=t.filters||(s===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=t.putOnlyUsedFonts||!1,A={},h={internal:{},__private__:{}};h.__private__.PubSub=cV;var m="1.3",p=h.__private__.getPdfVersion=function(){return m};h.__private__.setPdfVersion=function(Q){m=Q};var g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return g};var v=h.__private__.getPageFormat=function(Q){return g[Q]};a=a||"a4";var y="compat",b="advanced",w=y;function j(){this.saveGraphicsState(),re(new be(he,0,0,-he,0,ju()*he).toString()+" cm"),this.setFontSize(this.getFontSize()/he),u="n",w=b}function I(){this.restoreGraphicsState(),u="S",w=y}var _=h.__private__.combineFontStyleAndFontWeight=function(Q,_e){if(Q=="bold"&&_e=="normal"||Q=="bold"&&_e==400||Q=="normal"&&_e=="italic"||Q=="bold"&&_e=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return _e&&(Q=_e==400||_e==="normal"?Q==="italic"?"italic":"normal":_e!=700&&_e!=="bold"||Q!=="normal"?(_e==700?"bold":_e)+""+Q:"bold"),Q};h.advancedAPI=function(Q){var _e=w===y;return _e&&j.call(this),typeof Q!="function"||(Q(this),_e&&I.call(this)),this},h.compatAPI=function(Q){var _e=w===b;return _e&&I.call(this),typeof Q!="function"||(Q(this),_e&&j.call(this)),this},h.isAdvancedAPI=function(){return w===b};var S,E=function(Q){if(w!==b)throw new Error(Q+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},F=h.roundToPrecision=h.__private__.roundToPrecision=function(Q,_e){var ot=e||_e;if(isNaN(Q)||isNaN(ot))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return Q.toFixed(ot).replace(/0+$/,"")};S=h.hpf=h.__private__.hpf=typeof c=="number"?function(Q){if(isNaN(Q))throw new Error("Invalid argument passed to jsPDF.hpf");return F(Q,c)}:c==="smart"?function(Q){if(isNaN(Q))throw new Error("Invalid argument passed to jsPDF.hpf");return F(Q,Q>-1&&Q<1?16:5)}:function(Q){if(isNaN(Q))throw new Error("Invalid argument passed to jsPDF.hpf");return F(Q,16)};var k=h.f2=h.__private__.f2=function(Q){if(isNaN(Q))throw new Error("Invalid argument passed to jsPDF.f2");return F(Q,2)},P=h.__private__.f3=function(Q){if(isNaN(Q))throw new Error("Invalid argument passed to jsPDF.f3");return F(Q,3)},D=h.scale=h.__private__.scale=function(Q){if(isNaN(Q))throw new Error("Invalid argument passed to jsPDF.scale");return w===y?Q*he:w===b?Q:void 0},X=function(Q){return D(function(_e){return w===y?ju()-_e:w===b?_e:void 0}(Q))};h.__private__.setPrecision=h.setPrecision=function(Q){typeof parseInt(Q,10)=="number"&&(e=parseInt(Q,10))};var pe,ge="00000000000000000000000000000000",fe=h.__private__.getFileId=function(){return ge},xe=h.__private__.setFileId=function(Q){return ge=Q!==void 0&&/^[a-fA-F0-9]{32}$/.test(Q)?Q.toUpperCase():ge.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Nt=new Cx(d.userPermissions,d.userPassword,d.ownerPassword,ge)),ge};h.setFileId=function(Q){return xe(Q),this},h.getFileId=function(){return fe()};var ae=h.__private__.convertDateToPDFDate=function(Q){var _e=Q.getTimezoneOffset(),ot=_e<0?"+":"-",St=Math.floor(Math.abs(_e/60)),kt=Math.abs(_e%60),sr=[ot,z(St),"'",z(kt),"'"].join("");return["D:",Q.getFullYear(),z(Q.getMonth()+1),z(Q.getDate()),z(Q.getHours()),z(Q.getMinutes()),z(Q.getSeconds()),sr].join("")},Se=h.__private__.convertPDFDateToDate=function(Q){var _e=parseInt(Q.substr(2,4),10),ot=parseInt(Q.substr(6,2),10)-1,St=parseInt(Q.substr(8,2),10),kt=parseInt(Q.substr(10,2),10),sr=parseInt(Q.substr(12,2),10),ur=parseInt(Q.substr(14,2),10);return new Date(_e,ot,St,kt,sr,ur,0)},Te=h.__private__.setCreationDate=function(Q){var _e;if(Q===void 0&&(Q=new Date),Q instanceof Date)_e=ae(Q);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(Q))throw new Error("Invalid argument passed to jsPDF.setCreationDate");_e=Q}return pe=_e},O=h.__private__.getCreationDate=function(Q){var _e=pe;return Q==="jsDate"&&(_e=Se(pe)),_e};h.setCreationDate=function(Q){return Te(Q),this},h.getCreationDate=function(Q){return O(Q)};var G,z=h.__private__.padd2=function(Q){return("0"+parseInt(Q)).slice(-2)},L=h.__private__.padd2Hex=function(Q){return("00"+(Q=Q.toString())).substr(Q.length)},Z=0,ee=[],R=[],H=0,ne=[],ve=[],U=!1,He=R;h.__private__.setCustomOutputDestination=function(Q){U=!0,He=Q};var se=function(Q){U||(He=Q)};h.__private__.resetCustomOutputDestination=function(){U=!1,He=R};var re=h.__private__.out=function(Q){return Q=Q.toString(),H+=Q.length+1,He.push(Q),He},Pe=h.__private__.write=function(Q){return re(arguments.length===1?Q.toString():Array.prototype.join.call(arguments," "))},ue=h.__private__.getArrayBuffer=function(Q){for(var _e=Q.length,ot=new ArrayBuffer(_e),St=new Uint8Array(ot);_e--;)St[_e]=Q.charCodeAt(_e);return ot},we=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return we};var Me=t.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(Q){return Me=w===b?Q/he:Q,this};var ze,yt=h.__private__.getFontSize=h.getFontSize=function(){return w===y?Me:Me*he},It=t.R2L||!1;h.__private__.setR2L=h.setR2L=function(Q){return It=Q,this},h.__private__.getR2L=h.getR2L=function(){return It};var Ke,wt=h.__private__.setZoomMode=function(Q){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(Q))ze=Q;else if(isNaN(Q)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(Q)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+Q+'" is not recognized.');ze=Q}else ze=parseInt(Q,10)};h.__private__.getZoomMode=function(){return ze};var At,bt=h.__private__.setPageMode=function(Q){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(Q)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+Q+'" is not recognized.');Ke=Q};h.__private__.getPageMode=function(){return Ke};var ke=h.__private__.setLayoutMode=function(Q){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(Q)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+Q+'" is not recognized.');At=Q};h.__private__.getLayoutMode=function(){return At},h.__private__.setDisplayMode=h.setDisplayMode=function(Q,_e,ot){return wt(Q),ke(_e),bt(ot),this};var Ne={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(Q){if(Object.keys(Ne).indexOf(Q)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ne[Q]},h.__private__.getDocumentProperties=function(){return Ne},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(Q){for(var _e in Ne)Ne.hasOwnProperty(_e)&&Q[_e]&&(Ne[_e]=Q[_e]);return this},h.__private__.setDocumentProperty=function(Q,_e){if(Object.keys(Ne).indexOf(Q)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ne[Q]=_e};var Ve,he,le,Be,je,Ae={},Qe={},Ct=[],pt={},me={},te={},ie={},$e=null,de=0,Ce=[],nt=new cV(h),vt=t.hotfixes||[],ht={},xt={},Xe=[],be=function Q(_e,ot,St,kt,sr,ur){if(!(this instanceof Q))return new Q(_e,ot,St,kt,sr,ur);isNaN(_e)&&(_e=1),isNaN(ot)&&(ot=0),isNaN(St)&&(St=0),isNaN(kt)&&(kt=1),isNaN(sr)&&(sr=0),isNaN(ur)&&(ur=0),this._matrix=[_e,ot,St,kt,sr,ur]};Object.defineProperty(be.prototype,"sx",{get:function(){return this._matrix[0]},set:function(Q){this._matrix[0]=Q}}),Object.defineProperty(be.prototype,"shy",{get:function(){return this._matrix[1]},set:function(Q){this._matrix[1]=Q}}),Object.defineProperty(be.prototype,"shx",{get:function(){return this._matrix[2]},set:function(Q){this._matrix[2]=Q}}),Object.defineProperty(be.prototype,"sy",{get:function(){return this._matrix[3]},set:function(Q){this._matrix[3]=Q}}),Object.defineProperty(be.prototype,"tx",{get:function(){return this._matrix[4]},set:function(Q){this._matrix[4]=Q}}),Object.defineProperty(be.prototype,"ty",{get:function(){return this._matrix[5]},set:function(Q){this._matrix[5]=Q}}),Object.defineProperty(be.prototype,"a",{get:function(){return this._matrix[0]},set:function(Q){this._matrix[0]=Q}}),Object.defineProperty(be.prototype,"b",{get:function(){return this._matrix[1]},set:function(Q){this._matrix[1]=Q}}),Object.defineProperty(be.prototype,"c",{get:function(){return this._matrix[2]},set:function(Q){this._matrix[2]=Q}}),Object.defineProperty(be.prototype,"d",{get:function(){return this._matrix[3]},set:function(Q){this._matrix[3]=Q}}),Object.defineProperty(be.prototype,"e",{get:function(){return this._matrix[4]},set:function(Q){this._matrix[4]=Q}}),Object.defineProperty(be.prototype,"f",{get:function(){return this._matrix[5]},set:function(Q){this._matrix[5]=Q}}),Object.defineProperty(be.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(be.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(be.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(be.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),be.prototype.join=function(Q){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(S).join(Q)},be.prototype.multiply=function(Q){var _e=Q.sx*this.sx+Q.shy*this.shx,ot=Q.sx*this.shy+Q.shy*this.sy,St=Q.shx*this.sx+Q.sy*this.shx,kt=Q.shx*this.shy+Q.sy*this.sy,sr=Q.tx*this.sx+Q.ty*this.shx+this.tx,ur=Q.tx*this.shy+Q.ty*this.sy+this.ty;return new be(_e,ot,St,kt,sr,ur)},be.prototype.decompose=function(){var Q=this.sx,_e=this.shy,ot=this.shx,St=this.sy,kt=this.tx,sr=this.ty,ur=Math.sqrt(Q*Q+_e*_e),Dr=(Q/=ur)*ot+(_e/=ur)*St;ot-=Q*Dr,St-=_e*Dr;var Gr=Math.sqrt(ot*ot+St*St);return Dr/=Gr,Q*(St/=Gr)<_e*(ot/=Gr)&&(Q=-Q,_e=-_e,Dr=-Dr,ur=-ur),{scale:new be(ur,0,0,Gr,0,0),translate:new be(1,0,0,1,kt,sr),rotate:new be(Q,_e,-_e,Q,0,0),skew:new be(1,0,Dr,1,0,0)}},be.prototype.toString=function(Q){return this.join(" ")},be.prototype.inversed=function(){var Q=this.sx,_e=this.shy,ot=this.shx,St=this.sy,kt=this.tx,sr=this.ty,ur=1/(Q*St-_e*ot),Dr=St*ur,Gr=-_e*ur,un=-ot*ur,bn=Q*ur;return new be(Dr,Gr,un,bn,-Dr*kt-un*sr,-Gr*kt-bn*sr)},be.prototype.applyToPoint=function(Q){var _e=Q.x*this.sx+Q.y*this.shx+this.tx,ot=Q.x*this.shy+Q.y*this.sy+this.ty;return new Su(_e,ot)},be.prototype.applyToRectangle=function(Q){var _e=this.applyToPoint(Q),ot=this.applyToPoint(new Su(Q.x+Q.w,Q.y+Q.h));return new FA(_e.x,_e.y,ot.x-_e.x,ot.y-_e.y)},be.prototype.clone=function(){var Q=this.sx,_e=this.shy,ot=this.shx,St=this.sy,kt=this.tx,sr=this.ty;return new be(Q,_e,ot,St,kt,sr)},h.Matrix=be;var st=h.matrixMult=function(Q,_e){return _e.multiply(Q)},K=new be(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=K;var Ie=function(Q,_e){if(!me[Q]){var ot=(_e instanceof E0?"Sh":"P")+(Object.keys(pt).length+1).toString(10);_e.id=ot,me[Q]=ot,pt[ot]=_e,nt.publish("addPattern",_e)}};h.ShadingPattern=E0,h.TilingPattern=mp,h.addShadingPattern=function(Q,_e){return E("addShadingPattern()"),Ie(Q,_e),this},h.beginTilingPattern=function(Q){E("beginTilingPattern()"),mf(Q.boundingBox[0],Q.boundingBox[1],Q.boundingBox[2]-Q.boundingBox[0],Q.boundingBox[3]-Q.boundingBox[1],Q.matrix)},h.endTilingPattern=function(Q,_e){E("endTilingPattern()"),_e.stream=ve[G].join(`
`),Ie(Q,_e),nt.publish("endTilingPattern",_e),Xe.pop().restore()};var Ze,at=h.__private__.newObject=function(){var Q=it();return T(Q,!0),Q},it=h.__private__.newObjectDeferred=function(){return Z++,ee[Z]=function(){return H},Z},T=function(Q,_e){return _e=typeof _e=="boolean"&&_e,ee[Q]=H,_e&&re(Q+" 0 obj"),Q},M=h.__private__.newAdditionalObject=function(){var Q={objId:it(),content:""};return ne.push(Q),Q},V=it(),q=it(),Y=h.__private__.decodeColorString=function(Q){var _e=Q.split(" ");if(_e.length!==2||_e[1]!=="g"&&_e[1]!=="G")_e.length!==5||_e[4]!=="k"&&_e[4]!=="K"||(_e=[(1-_e[0])*(1-_e[3]),(1-_e[1])*(1-_e[3]),(1-_e[2])*(1-_e[3]),"r"]);else{var ot=parseFloat(_e[0]);_e=[ot,ot,ot,"r"]}for(var St="#",kt=0;kt<3;kt++)St+=("0"+Math.floor(255*parseFloat(_e[kt])).toString(16)).slice(-2);return St},oe=h.__private__.encodeColorString=function(Q){var _e;typeof Q=="string"&&(Q={ch1:Q});var ot=Q.ch1,St=Q.ch2,kt=Q.ch3,sr=Q.ch4,ur=Q.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ot=="string"&&ot.charAt(0)!=="#"){var Dr=new lre(ot);if(Dr.ok)ot=Dr.toHex();else if(!/^\d*\.?\d*$/.test(ot))throw new Error('Invalid color "'+ot+'" passed to jsPDF.encodeColorString.')}if(typeof ot=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ot)&&(ot="#"+ot[1]+ot[1]+ot[2]+ot[2]+ot[3]+ot[3]),typeof ot=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ot)){var Gr=parseInt(ot.substr(1),16);ot=Gr>>16&255,St=Gr>>8&255,kt=255&Gr}if(St===void 0||sr===void 0&&ot===St&&St===kt)_e=typeof ot=="string"?ot+" "+ur[0]:Q.precision===2?k(ot/255)+" "+ur[0]:P(ot/255)+" "+ur[0];else if(sr===void 0||Oa(sr)==="object"){if(sr&&!isNaN(sr.a)&&sr.a===0)return["1.","1.","1.",ur[1]].join(" ");_e=typeof ot=="string"?[ot,St,kt,ur[1]].join(" "):Q.precision===2?[k(ot/255),k(St/255),k(kt/255),ur[1]].join(" "):[P(ot/255),P(St/255),P(kt/255),ur[1]].join(" ")}else _e=typeof ot=="string"?[ot,St,kt,sr,ur[2]].join(" "):Q.precision===2?[k(ot),k(St),k(kt),k(sr),ur[2]].join(" "):[P(ot),P(St),P(kt),P(sr),ur[2]].join(" ");return _e},De=h.__private__.getFilters=function(){return o},We=h.__private__.putStream=function(Q){var _e=(Q=Q||{}).data||"",ot=Q.filters||De(),St=Q.alreadyAppliedFilters||[],kt=Q.addLength1||!1,sr=_e.length,ur=Q.objectId,Dr=function(ri){return ri};if(d!==null&&ur===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(Dr=Nt.encryptor(ur,0));var Gr={};ot===!0&&(ot=["FlateEncode"]);var un=Q.additionalKeyValues||[],bn=(Gr=Rr.API.processDataByFilters!==void 0?Rr.API.processDataByFilters(_e,ot):{data:_e,reverseChain:[]}).reverseChain+(Array.isArray(St)?St.join(" "):St.toString());if(Gr.data.length!==0&&(un.push({key:"Length",value:Gr.data.length}),kt===!0&&un.push({key:"Length1",value:sr})),bn.length!=0)if(bn.split("/").length-1==1)un.push({key:"Filter",value:bn});else{un.push({key:"Filter",value:"["+bn+"]"});for(var qn=0;qn<un.length;qn+=1)if(un[qn].key==="DecodeParms"){for(var ma=[],Ds=0;Ds<Gr.reverseChain.split("/").length-1;Ds+=1)ma.push("null");ma.push(un[qn].value),un[qn].value="["+ma.join(" ")+"]"}}re("<<");for(var _a=0;_a<un.length;_a++)re("/"+un[_a].key+" "+un[_a].value);re(">>"),Gr.data.length!==0&&(re("stream"),re(Dr(Gr.data)),re("endstream"))},dt=h.__private__.putPage=function(Q){var _e=Q.number,ot=Q.data,St=Q.objId,kt=Q.contentsObjId;T(St,!0),re("<</Type /Page"),re("/Parent "+Q.rootDictionaryObjId+" 0 R"),re("/Resources "+Q.resourceDictionaryObjId+" 0 R"),re("/MediaBox ["+parseFloat(S(Q.mediaBox.bottomLeftX))+" "+parseFloat(S(Q.mediaBox.bottomLeftY))+" "+S(Q.mediaBox.topRightX)+" "+S(Q.mediaBox.topRightY)+"]"),Q.cropBox!==null&&re("/CropBox ["+S(Q.cropBox.bottomLeftX)+" "+S(Q.cropBox.bottomLeftY)+" "+S(Q.cropBox.topRightX)+" "+S(Q.cropBox.topRightY)+"]"),Q.bleedBox!==null&&re("/BleedBox ["+S(Q.bleedBox.bottomLeftX)+" "+S(Q.bleedBox.bottomLeftY)+" "+S(Q.bleedBox.topRightX)+" "+S(Q.bleedBox.topRightY)+"]"),Q.trimBox!==null&&re("/TrimBox ["+S(Q.trimBox.bottomLeftX)+" "+S(Q.trimBox.bottomLeftY)+" "+S(Q.trimBox.topRightX)+" "+S(Q.trimBox.topRightY)+"]"),Q.artBox!==null&&re("/ArtBox ["+S(Q.artBox.bottomLeftX)+" "+S(Q.artBox.bottomLeftY)+" "+S(Q.artBox.topRightX)+" "+S(Q.artBox.topRightY)+"]"),typeof Q.userUnit=="number"&&Q.userUnit!==1&&re("/UserUnit "+Q.userUnit),nt.publish("putPage",{objId:St,pageContext:Ce[_e],pageNumber:_e,page:ot}),re("/Contents "+kt+" 0 R"),re(">>"),re("endobj");var sr=ot.join(`
`);return w===b&&(sr+=`
Q`),T(kt,!0),We({data:sr,filters:De(),objectId:kt}),re("endobj"),St},Oe=h.__private__.putPages=function(){var Q,_e,ot=[];for(Q=1;Q<=de;Q++)Ce[Q].objId=it(),Ce[Q].contentsObjId=it();for(Q=1;Q<=de;Q++)ot.push(dt({number:Q,data:ve[Q],objId:Ce[Q].objId,contentsObjId:Ce[Q].contentsObjId,mediaBox:Ce[Q].mediaBox,cropBox:Ce[Q].cropBox,bleedBox:Ce[Q].bleedBox,trimBox:Ce[Q].trimBox,artBox:Ce[Q].artBox,userUnit:Ce[Q].userUnit,rootDictionaryObjId:V,resourceDictionaryObjId:q}));T(V,!0),re("<</Type /Pages");var St="/Kids [";for(_e=0;_e<de;_e++)St+=ot[_e]+" 0 R ";re(St+"]"),re("/Count "+de),re(">>"),re("endobj"),nt.publish("postPutPages")},et=function(Q){nt.publish("putFont",{font:Q,out:re,newObject:at,putStream:We}),Q.isAlreadyPutted!==!0&&(Q.objectNumber=at(),re("<<"),re("/Type /Font"),re("/BaseFont /"+_x(Q.postScriptName)),re("/Subtype /Type1"),typeof Q.encoding=="string"&&re("/Encoding /"+Q.encoding),re("/FirstChar 32"),re("/LastChar 255"),re(">>"),re("endobj"))},mt=function(Q){Q.objectNumber=at();var _e=[];_e.push({key:"Type",value:"/XObject"}),_e.push({key:"Subtype",value:"/Form"}),_e.push({key:"BBox",value:"["+[S(Q.x),S(Q.y),S(Q.x+Q.width),S(Q.y+Q.height)].join(" ")+"]"}),_e.push({key:"Matrix",value:"["+Q.matrix.toString()+"]"});var ot=Q.pages[1].join(`
`);We({data:ot,additionalKeyValues:_e,objectId:Q.objectNumber}),re("endobj")},Tt=function(Q,_e){_e||(_e=21);var ot=at(),St=function(ur,Dr){var Gr,un=[],bn=1/(Dr-1);for(Gr=0;Gr<1;Gr+=bn)un.push(Gr);if(un.push(1),ur[0].offset!=0){var qn={offset:0,color:ur[0].color};ur.unshift(qn)}if(ur[ur.length-1].offset!=1){var ma={offset:1,color:ur[ur.length-1].color};ur.push(ma)}for(var Ds="",_a=0,ri=0;ri<un.length;ri++){for(Gr=un[ri];Gr>ur[_a+1].offset;)_a++;var Rs=ur[_a].offset,ni=(Gr-Rs)/(ur[_a+1].offset-Rs),Ms=ur[_a].color,vc=ur[_a+1].color;Ds+=L(Math.round((1-ni)*Ms[0]+ni*vc[0]).toString(16))+L(Math.round((1-ni)*Ms[1]+ni*vc[1]).toString(16))+L(Math.round((1-ni)*Ms[2]+ni*vc[2]).toString(16))}return Ds.trim()}(Q.colors,_e),kt=[];kt.push({key:"FunctionType",value:"0"}),kt.push({key:"Domain",value:"[0.0 1.0]"}),kt.push({key:"Size",value:"["+_e+"]"}),kt.push({key:"BitsPerSample",value:"8"}),kt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),kt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),We({data:St,additionalKeyValues:kt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ot}),re("endobj"),Q.objectNumber=at(),re("<< /ShadingType "+Q.type),re("/ColorSpace /DeviceRGB");var sr="/Coords ["+S(parseFloat(Q.coords[0]))+" "+S(parseFloat(Q.coords[1]))+" ";Q.type===2?sr+=S(parseFloat(Q.coords[2]))+" "+S(parseFloat(Q.coords[3])):sr+=S(parseFloat(Q.coords[2]))+" "+S(parseFloat(Q.coords[3]))+" "+S(parseFloat(Q.coords[4]))+" "+S(parseFloat(Q.coords[5])),re(sr+="]"),Q.matrix&&re("/Matrix ["+Q.matrix.toString()+"]"),re("/Function "+ot+" 0 R"),re("/Extend [true true]"),re(">>"),re("endobj")},Pt=function(Q,_e){var ot=it(),St=at();_e.push({resourcesOid:ot,objectOid:St}),Q.objectNumber=St;var kt=[];kt.push({key:"Type",value:"/Pattern"}),kt.push({key:"PatternType",value:"1"}),kt.push({key:"PaintType",value:"1"}),kt.push({key:"TilingType",value:"1"}),kt.push({key:"BBox",value:"["+Q.boundingBox.map(S).join(" ")+"]"}),kt.push({key:"XStep",value:S(Q.xStep)}),kt.push({key:"YStep",value:S(Q.yStep)}),kt.push({key:"Resources",value:ot+" 0 R"}),Q.matrix&&kt.push({key:"Matrix",value:"["+Q.matrix.toString()+"]"}),We({data:Q.stream,additionalKeyValues:kt,objectId:Q.objectNumber}),re("endobj")},Ft=function(Q){for(var _e in Q.objectNumber=at(),re("<<"),Q)switch(_e){case"opacity":re("/ca "+k(Q[_e]));break;case"stroke-opacity":re("/CA "+k(Q[_e]))}re(">>"),re("endobj")},Xt=function(Q){T(Q.resourcesOid,!0),re("<<"),re("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var _e in re("/Font <<"),Ae)Ae.hasOwnProperty(_e)&&(f===!1||f===!0&&A.hasOwnProperty(_e))&&re("/"+_e+" "+Ae[_e].objectNumber+" 0 R");re(">>")}(),function(){if(Object.keys(pt).length>0){for(var _e in re("/Shading <<"),pt)pt.hasOwnProperty(_e)&&pt[_e]instanceof E0&&pt[_e].objectNumber>=0&&re("/"+_e+" "+pt[_e].objectNumber+" 0 R");nt.publish("putShadingPatternDict"),re(">>")}}(),function(_e){if(Object.keys(pt).length>0){for(var ot in re("/Pattern <<"),pt)pt.hasOwnProperty(ot)&&pt[ot]instanceof h.TilingPattern&&pt[ot].objectNumber>=0&&pt[ot].objectNumber<_e&&re("/"+ot+" "+pt[ot].objectNumber+" 0 R");nt.publish("putTilingPatternDict"),re(">>")}}(Q.objectOid),function(){if(Object.keys(te).length>0){var _e;for(_e in re("/ExtGState <<"),te)te.hasOwnProperty(_e)&&te[_e].objectNumber>=0&&re("/"+_e+" "+te[_e].objectNumber+" 0 R");nt.publish("putGStateDict"),re(">>")}}(),function(){for(var _e in re("/XObject <<"),ht)ht.hasOwnProperty(_e)&&ht[_e].objectNumber>=0&&re("/"+_e+" "+ht[_e].objectNumber+" 0 R");nt.publish("putXobjectDict"),re(">>")}(),re(">>"),re("endobj")},mr=function(Q){Qe[Q.fontName]=Qe[Q.fontName]||{},Qe[Q.fontName][Q.fontStyle]=Q.id},Yr=function(Q,_e,ot,St,kt){var sr={id:"F"+(Object.keys(Ae).length+1).toString(10),postScriptName:Q,fontName:_e,fontStyle:ot,encoding:St,isStandardFont:kt||!1,metadata:{}};return nt.publish("addFont",{font:sr,instance:this}),Ae[sr.id]=sr,mr(sr),sr.id},Br=h.__private__.pdfEscape=h.pdfEscape=function(Q,_e){return function(ot,St){var kt,sr,ur,Dr,Gr,un,bn,qn,ma;if(ur=(St=St||{}).sourceEncoding||"Unicode",Gr=St.outputEncoding,(St.autoencode||Gr)&&Ae[Ve].metadata&&Ae[Ve].metadata[ur]&&Ae[Ve].metadata[ur].encoding&&(Dr=Ae[Ve].metadata[ur].encoding,!Gr&&Ae[Ve].encoding&&(Gr=Ae[Ve].encoding),!Gr&&Dr.codePages&&(Gr=Dr.codePages[0]),typeof Gr=="string"&&(Gr=Dr[Gr]),Gr)){for(bn=!1,un=[],kt=0,sr=ot.length;kt<sr;kt++)(qn=Gr[ot.charCodeAt(kt)])?un.push(String.fromCharCode(qn)):un.push(ot[kt]),un[kt].charCodeAt(0)>>8&&(bn=!0);ot=un.join("")}for(kt=ot.length;bn===void 0&&kt!==0;)ot.charCodeAt(kt-1)>>8&&(bn=!0),kt--;if(!bn)return ot;for(un=St.noBOM?[]:[254,255],kt=0,sr=ot.length;kt<sr;kt++){if((ma=(qn=ot.charCodeAt(kt))>>8)>>8)throw new Error("Character at position "+kt+" of string '"+ot+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");un.push(ma),un.push(qn-(ma<<8))}return String.fromCharCode.apply(void 0,un)}(Q,_e).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Fr=h.__private__.beginPage=function(Q){ve[++de]=[],Ce[de]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(Q[0]),topRightY:Number(Q[1])}},yn(de),se(ve[G])},vn=function(Q,_e){var ot,St,kt;switch(r=_e||r,typeof Q=="string"&&(ot=v(Q.toLowerCase()),Array.isArray(ot)&&(St=ot[0],kt=ot[1])),Array.isArray(Q)&&(St=Q[0]*he,kt=Q[1]*he),isNaN(St)&&(St=a[0],kt=a[1]),(St>14400||kt>14400)&&(Xa.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),St=Math.min(14400,St),kt=Math.min(14400,kt)),a=[St,kt],r.substr(0,1)){case"l":kt>St&&(a=[kt,St]);break;case"p":St>kt&&(a=[kt,St])}Fr(a),$r(Fs),re(_d),Qa!==0&&re(Qa+" J"),Tm!==0&&re(Tm+" j"),nt.publish("addPage",{pageNumber:de})},Ln=function(Q){Q>0&&Q<=de&&(ve.splice(Q,1),Ce.splice(Q,1),de--,G>de&&(G=de),this.setPage(G))},yn=function(Q){Q>0&&Q<=de&&(G=Q)},In=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return ve.length-1},Ua=function(Q,_e,ot){var St,kt=void 0;return ot=ot||{},Q=Q!==void 0?Q:Ae[Ve].fontName,_e=_e!==void 0?_e:Ae[Ve].fontStyle,St=Q.toLowerCase(),Qe[St]!==void 0&&Qe[St][_e]!==void 0?kt=Qe[St][_e]:Qe[Q]!==void 0&&Qe[Q][_e]!==void 0?kt=Qe[Q][_e]:ot.disableWarning===!1&&Xa.warn("Unable to look up font label for font '"+Q+"', '"+_e+"'. Refer to getFontList() for available fonts."),kt||ot.noFallback||(kt=Qe.times[_e])==null&&(kt=Qe.times.normal),kt},Je=h.__private__.putInfo=function(){var Q=at(),_e=function(St){return St};for(var ot in d!==null&&(_e=Nt.encryptor(Q,0)),re("<<"),re("/Producer ("+Br(_e("jsPDF "+Rr.version))+")"),Ne)Ne.hasOwnProperty(ot)&&Ne[ot]&&re("/"+ot.substr(0,1).toUpperCase()+ot.substr(1)+" ("+Br(_e(Ne[ot]))+")");re("/CreationDate ("+Br(_e(pe))+")"),re(">>"),re("endobj")},Ot=h.__private__.putCatalog=function(Q){var _e=(Q=Q||{}).rootDictionaryObjId||V;switch(at(),re("<<"),re("/Type /Catalog"),re("/Pages "+_e+" 0 R"),ze||(ze="fullwidth"),ze){case"fullwidth":re("/OpenAction [3 0 R /FitH null]");break;case"fullheight":re("/OpenAction [3 0 R /FitV null]");break;case"fullpage":re("/OpenAction [3 0 R /Fit]");break;case"original":re("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ot=""+ze;ot.substr(ot.length-1)==="%"&&(ze=parseInt(ze)/100),typeof ze=="number"&&re("/OpenAction [3 0 R /XYZ null null "+k(ze)+"]")}switch(At||(At="continuous"),At){case"continuous":re("/PageLayout /OneColumn");break;case"single":re("/PageLayout /SinglePage");break;case"two":case"twoleft":re("/PageLayout /TwoColumnLeft");break;case"tworight":re("/PageLayout /TwoColumnRight")}Ke&&re("/PageMode /"+Ke),nt.publish("putCatalog"),re(">>"),re("endobj")},Kt=h.__private__.putTrailer=function(){re("trailer"),re("<<"),re("/Size "+(Z+1)),re("/Root "+Z+" 0 R"),re("/Info "+(Z-1)+" 0 R"),d!==null&&re("/Encrypt "+Nt.oid+" 0 R"),re("/ID [ <"+ge+"> <"+ge+"> ]"),re(">>")},ar=h.__private__.putHeader=function(){re("%PDF-"+m),re("%")},Ar=h.__private__.putXRef=function(){var Q="0000000000";re("xref"),re("0 "+(Z+1)),re("0000000000 65535 f ");for(var _e=1;_e<=Z;_e++)typeof ee[_e]=="function"?re((Q+ee[_e]()).slice(-10)+" 00000 n "):ee[_e]!==void 0?re((Q+ee[_e]).slice(-10)+" 00000 n "):re("0000000000 00000 n ")},ft=h.__private__.buildDocument=function(){var Q;Z=0,H=0,R=[],ee=[],ne=[],V=it(),q=it(),se(R),nt.publish("buildDocument"),ar(),Oe(),function(){nt.publish("putAdditionalObjects");for(var ot=0;ot<ne.length;ot++){var St=ne[ot];T(St.objId,!0),re(St.content),re("endobj")}nt.publish("postPutAdditionalObjects")}(),Q=[],function(){for(var ot in Ae)Ae.hasOwnProperty(ot)&&(f===!1||f===!0&&A.hasOwnProperty(ot))&&et(Ae[ot])}(),function(){var ot;for(ot in te)te.hasOwnProperty(ot)&&Ft(te[ot])}(),function(){for(var ot in ht)ht.hasOwnProperty(ot)&&mt(ht[ot])}(),function(ot){var St;for(St in pt)pt.hasOwnProperty(St)&&(pt[St]instanceof E0?Tt(pt[St]):pt[St]instanceof mp&&Pt(pt[St],ot))}(Q),nt.publish("putResources"),Q.forEach(Xt),Xt({resourcesOid:q,objectOid:Number.MAX_SAFE_INTEGER}),nt.publish("postPutResources"),d!==null&&(Nt.oid=at(),re("<<"),re("/Filter /Standard"),re("/V "+Nt.v),re("/R "+Nt.r),re("/U <"+Nt.toHexString(Nt.U)+">"),re("/O <"+Nt.toHexString(Nt.O)+">"),re("/P "+Nt.P),re(">>"),re("endobj")),Je(),Ot();var _e=H;return Ar(),Kt(),re("startxref"),re(""+_e),re("%%EOF"),se(ve[G]),R.join(`
`)},lr=h.__private__.getBlob=function(Q){return new Blob([ue(Q)],{type:"application/pdf"})},Le=h.output=h.__private__.output=(Ze=function(Q,_e){switch(typeof(_e=_e||{})=="string"?_e={filename:_e}:_e.filename=_e.filename||"generated.pdf",Q){case void 0:return ft();case"save":h.save(_e.filename);break;case"arraybuffer":return ue(ft());case"blob":return lr(ft());case"bloburi":case"bloburl":if(gn.URL!==void 0&&typeof gn.URL.createObjectURL=="function")return gn.URL&&gn.URL.createObjectURL(lr(ft()))||void 0;Xa.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ot="",St=ft();try{ot=iV(St)}catch{ot=iV(unescape(encodeURIComponent(St)))}return"data:application/pdf;filename="+_e.filename+";base64,"+ot;case"pdfobjectnewwindow":if(Object.prototype.toString.call(gn)==="[object Window]"){var kt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",sr=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';_e.pdfObjectUrl&&(kt=_e.pdfObjectUrl,sr="");var ur='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+kt+'"'+sr+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(_e)+");<\/script></body></html>",Dr=gn.open();return Dr!==null&&Dr.document.write(ur),Dr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(gn)==="[object Window]"){var Gr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(_e.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+_e.filename+'" width="500px" height="400px" /></body></html>',un=gn.open();if(un!==null){un.document.write(Gr);var bn=this;un.document.documentElement.querySelector("#pdfViewer").onload=function(){un.document.title=_e.filename,un.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(bn.output("bloburl"))}}return un}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(gn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var qn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",_e)+'"></iframe></body></html>',ma=gn.open();if(ma!==null&&(ma.document.write(qn),ma.document.title=_e.filename),ma||typeof safari>"u")return ma;break;case"datauri":case"dataurl":return gn.document.location.href=this.output("datauristring",_e);default:return null}},Ze.foo=function(){try{return Ze.apply(this,arguments)}catch(ot){var Q=ot.stack||"";~Q.indexOf(" at ")&&(Q=Q.split(" at ")[1]);var _e="Error in function "+Q.split(`
`)[0].split("<")[0]+": "+ot.message;if(!gn.console)throw new Error(_e);gn.console.error(_e,ot),gn.alert&&alert(_e)}},Ze.foo.bar=Ze,Ze.foo),tt=function(Q){return Array.isArray(vt)===!0&&vt.indexOf(Q)>-1};switch(n){case"pt":he=1;break;case"mm":he=72/25.4;break;case"cm":he=72/2.54;break;case"in":he=72;break;case"px":he=tt("px_scaling")==1?.75:96/72;break;case"pc":case"em":he=12;break;case"ex":he=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);he=n}var Nt=null;Te(),xe();var Et=h.__private__.getPageInfo=h.getPageInfo=function(Q){if(isNaN(Q)||Q%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ce[Q].objId,pageNumber:Q,pageContext:Ce[Q]}},gt=h.__private__.getPageInfoByObjId=function(Q){if(isNaN(Q)||Q%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var _e in Ce)if(Ce[_e].objId===Q)break;return Et(_e)},ut=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:Ce[G].objId,pageNumber:G,pageContext:Ce[G]}};h.addPage=function(){return vn.apply(this,arguments),this},h.setPage=function(){return yn.apply(this,arguments),se.call(this,ve[G]),this},h.insertPage=function(Q){return this.addPage(),this.movePage(G,Q),this},h.movePage=function(Q,_e){var ot,St;if(Q>_e){ot=ve[Q],St=Ce[Q];for(var kt=Q;kt>_e;kt--)ve[kt]=ve[kt-1],Ce[kt]=Ce[kt-1];ve[_e]=ot,Ce[_e]=St,this.setPage(_e)}else if(Q<_e){ot=ve[Q],St=Ce[Q];for(var sr=Q;sr<_e;sr++)ve[sr]=ve[sr+1],Ce[sr]=Ce[sr+1];ve[_e]=ot,Ce[_e]=St,this.setPage(_e)}return this},h.deletePage=function(){return Ln.apply(this,arguments),this},h.__private__.text=h.text=function(Q,_e,ot,St,kt){var sr,ur,Dr,Gr,un,bn,qn,ma,Ds,_a=(St=St||{}).scope||this;if(typeof Q=="number"&&typeof _e=="number"&&(typeof ot=="string"||Array.isArray(ot))){var ri=ot;ot=_e,_e=Q,Q=ri}if(arguments[3]instanceof be==0?(Dr=arguments[4],Gr=arguments[5],Oa(qn=arguments[3])==="object"&&qn!==null||(typeof Dr=="string"&&(Gr=Dr,Dr=null),typeof qn=="string"&&(Gr=qn,qn=null),typeof qn=="number"&&(Dr=qn,qn=null),St={flags:qn,angle:Dr,align:Gr})):(E("The transform parameter of text() with a Matrix value"),Ds=kt),isNaN(_e)||isNaN(ot)||Q==null)throw new Error("Invalid arguments passed to jsPDF.text");if(Q.length===0)return _a;var Rs,ni="",Ms=typeof St.lineHeightFactor=="number"?St.lineHeightFactor:ti,vc=_a.internal.scaleFactor;function Pu(ba){return ba=ba.split("	").join(Array(St.TabLen||9).join(" ")),Br(ba,qn)}function Bu(ba){for(var qa,mi=ba.concat(),qi=[],oh=mi.length;oh--;)typeof(qa=mi.shift())=="string"?qi.push(qa):Array.isArray(ba)&&(qa.length===1||qa[1]===void 0&&qa[2]===void 0)?qi.push(qa[0]):qi.push([qa[0],qa[1],qa[2]]);return qi}function C(ba,qa){var mi;if(typeof ba=="string")mi=qa(ba)[0];else if(Array.isArray(ba)){for(var qi,oh,k1=ba.concat(),Qg=[],cN=k1.length;cN--;)typeof(qi=k1.shift())=="string"?Qg.push(qa(qi)[0]):Array.isArray(qi)&&typeof qi[0]=="string"&&(oh=qa(qi[0],qi[1],qi[2]),Qg.push([oh[0],oh[1],oh[2]]));mi=Qg}return mi}var J=!1,ye=!0;if(typeof Q=="string")J=!0;else if(Array.isArray(Q)){var qe=Q.concat();ur=[];for(var Dt,zt=qe.length;zt--;)(typeof(Dt=qe.shift())!="string"||Array.isArray(Dt)&&typeof Dt[0]!="string")&&(ye=!1);J=ye}if(J===!1)throw new Error('Type of text must be string or Array. "'+Q+'" is not recognized.');typeof Q=="string"&&(Q=Q.match(/[\r?\n]/)?Q.split(/\r\n|\r|\n/g):[Q]);var br=Me/_a.internal.scaleFactor,Jn=br*(Ms-1);switch(St.baseline){case"bottom":ot-=Jn;break;case"top":ot+=br-Jn;break;case"hanging":ot+=br-2*Jn;break;case"middle":ot+=br/2-Jn}if((bn=St.maxWidth||0)>0&&(typeof Q=="string"?Q=_a.splitTextToSize(Q,bn):Object.prototype.toString.call(Q)==="[object Array]"&&(Q=Q.reduce(function(ba,qa){return ba.concat(_a.splitTextToSize(qa,bn))},[]))),sr={text:Q,x:_e,y:ot,options:St,mutex:{pdfEscape:Br,activeFontKey:Ve,fonts:Ae,activeFontSize:Me}},nt.publish("preProcessText",sr),Q=sr.text,Dr=(St=sr.options).angle,Ds instanceof be==0&&Dr&&typeof Dr=="number"){Dr*=Math.PI/180,St.rotationDirection===0&&(Dr=-Dr),w===b&&(Dr=-Dr);var Ls=Math.cos(Dr),Qn=Math.sin(Dr);Ds=new be(Ls,Qn,-Qn,Ls,0,0)}else Dr&&Dr instanceof be&&(Ds=Dr);w!==b||Ds||(Ds=K),(un=St.charSpace||Eu)!==void 0&&(ni+=S(D(un))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ma=St.horizontalScale)!==void 0&&(ni+=S(100*ma)+` Tz
`),St.lang;var ca=-1,es=St.renderingMode!==void 0?St.renderingMode:St.stroke,$c=_a.internal.getCurrentPageInfo().pageContext;switch(es){case 0:case!1:case"fill":ca=0;break;case 1:case!0:case"stroke":ca=1;break;case 2:case"fillThenStroke":ca=2;break;case 3:case"invisible":ca=3;break;case 4:case"fillAndAddForClipping":ca=4;break;case 5:case"strokeAndAddPathForClipping":ca=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ca=6;break;case 7:case"addToPathForClipping":ca=7}var ml=$c.usedRenderingMode!==void 0?$c.usedRenderingMode:-1;ca!==-1?ni+=ca+` Tr
`:ml!==-1&&(ni+=`0 Tr
`),ca!==-1&&($c.usedRenderingMode=ca),Gr=St.align||"left";var Ho,Ed=Me*Ms,E1=_a.internal.pageSize.getWidth(),S1=Ae[Ve];un=St.charSpace||Eu,bn=St.maxWidth||0,qn=Object.assign({autoencode:!0,noBOM:!0},St.flags);var DA=[],Om=function(ba){return _a.getStringUnitWidth(ba,{font:S1,charSpace:un,fontSize:Me,doKerning:!1})*Me/vc};if(Object.prototype.toString.call(Q)==="[object Array]"){var Gc;ur=Bu(Q),Gr!=="left"&&(Ho=ur.map(Om));var Kc,RA=0;if(Gr==="right"){_e-=Ho[0],Q=[],zt=ur.length;for(var ih=0;ih<zt;ih++)ih===0?(Kc=Os(_e),Gc=Ki(ot)):(Kc=D(RA-Ho[ih]),Gc=-Ed),Q.push([ur[ih],Kc,Gc]),RA=Ho[ih]}else if(Gr==="center"){_e-=Ho[0]/2,Q=[],zt=ur.length;for(var MA=0;MA<zt;MA++)MA===0?(Kc=Os(_e),Gc=Ki(ot)):(Kc=D((RA-Ho[MA])/2),Gc=-Ed),Q.push([ur[MA],Kc,Gc]),RA=Ho[MA]}else if(Gr==="left"){Q=[],zt=ur.length;for(var I1=0;I1<zt;I1++)Q.push(ur[I1])}else if(Gr==="justify"&&S1.encoding==="Identity-H"){Q=[],zt=ur.length,bn=bn!==0?bn:E1;for(var Ug=0,Ai=0;Ai<zt;Ai++)if(Gc=Ai===0?Ki(ot):-Ed,Kc=Ai===0?Os(_e):Ug,Ai<zt-1){var lN=D((bn-Ho[Ai])/(ur[Ai].split(" ").length-1)),gf=ur[Ai].split(" ");Q.push([gf[0]+" ",Kc,Gc]),Ug=0;for(var xf=1;xf<gf.length;xf++){var j1=(Om(gf[xf-1]+" "+gf[xf])-Om(gf[xf]))*vc+lN;xf==gf.length-1?Q.push([gf[xf],j1,0]):Q.push([gf[xf]+" ",j1,0]),Ug-=j1}}else Q.push([ur[Ai],Kc,Gc]);Q.push(["",Ug,0])}else{if(Gr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(Q=[],zt=ur.length,bn=bn!==0?bn:E1,Ai=0;Ai<zt;Ai++){Gc=Ai===0?Ki(ot):-Ed,Kc=Ai===0?Os(_e):0;var P1=ur[Ai].split(" ").length-1,B1=P1>0?(bn-Ho[Ai])/P1:0;Ai<zt-1?DA.push(S(D(B1))):DA.push(0),Q.push([ur[Ai],Kc,Gc])}}}(typeof St.R2L=="boolean"?St.R2L:It)===!0&&(Q=C(Q,function(ba,qa,mi){return[ba.split("").reverse().join(""),qa,mi]})),sr={text:Q,x:_e,y:ot,options:St,mutex:{pdfEscape:Br,activeFontKey:Ve,fonts:Ae,activeFontSize:Me}},nt.publish("postProcessText",sr),Q=sr.text,Rs=sr.mutex.isHex||!1;var T1=Ae[Ve].encoding;T1!=="WinAnsiEncoding"&&T1!=="StandardEncoding"||(Q=C(Q,function(ba,qa,mi){return[Pu(ba),qa,mi]})),ur=Bu(Q),Q=[];for(var LA,UA,QA,Dm=Array.isArray(ur[0])?1:0,VA="",Rm=function(ba,qa,mi){var qi="";return mi instanceof be?(mi=typeof St.angle=="number"?st(mi,new be(1,0,0,1,ba,qa)):st(new be(1,0,0,1,ba,qa),mi),w===b&&(mi=st(new be(1,0,0,-1,0,0),mi)),qi=mi.join(" ")+` Tm
`):qi=S(ba)+" "+S(qa)+` Td
`,qi},Tu=0;Tu<ur.length;Tu++){switch(VA="",Dm){case 1:QA=(Rs?"<":"(")+ur[Tu][0]+(Rs?">":")"),LA=parseFloat(ur[Tu][1]),UA=parseFloat(ur[Tu][2]);break;case 0:QA=(Rs?"<":"(")+ur[Tu]+(Rs?">":")"),LA=Os(_e),UA=Ki(ot)}DA!==void 0&&DA[Tu]!==void 0&&(VA=DA[Tu]+` Tw
`),Tu===0?Q.push(VA+Rm(LA,UA,Ds)+QA):Dm===0?Q.push(VA+QA):Dm===1&&Q.push(VA+Rm(LA,UA,Ds)+QA)}Q=Dm===0?Q.join(` Tj
T* `):Q.join(` Tj
`),Q+=` Tj
`;var vf=`BT
/`;return vf+=Ve+" "+Me+` Tf
`,vf+=S(Me*Ms)+` TL
`,vf+=Hc+`
`,vf+=ni,vf+=Q,re(vf+="ET"),A[Ve]=!0,_a};var Mt=h.__private__.clip=h.clip=function(Q){return re(Q==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return Mt("evenodd")},h.__private__.discardPath=h.discardPath=function(){return re("n"),this};var Rt=h.__private__.isValidStyle=function(Q){var _e=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(Q)!==-1&&(_e=!0),_e};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(Q){return Rt(Q)&&(u=Q),this};var Jt=h.__private__.getStyle=h.getStyle=function(Q){var _e=u;switch(Q){case"D":case"S":_e="S";break;case"F":_e="f";break;case"FD":case"DF":_e="B";break;case"f":case"f*":case"B":case"B*":_e=Q}return _e},Lt=h.close=function(){return re("h"),this};h.stroke=function(){return re("S"),this},h.fill=function(Q){return Wt("f",Q),this},h.fillEvenOdd=function(Q){return Wt("f*",Q),this},h.fillStroke=function(Q){return Wt("B",Q),this},h.fillStrokeEvenOdd=function(Q){return Wt("B*",Q),this};var Wt=function(Q,_e){Oa(_e)==="object"?on(_e,Q):re(Q)},Tr=function(Q){Q===null||w===b&&Q===void 0||(Q=Jt(Q),re(Q))};function Ur(Q,_e,ot,St,kt){var sr=new mp(_e||this.boundingBox,ot||this.xStep,St||this.yStep,this.gState,kt||this.matrix);sr.stream=this.stream;var ur=Q+"$$"+this.cloneIndex+++"$$";return Ie(ur,sr),sr}var on=function(Q,_e){var ot=me[Q.key],St=pt[ot];if(St instanceof E0)re("q"),re(Nn(_e)),St.gState&&h.setGState(St.gState),re(Q.matrix.toString()+" cm"),re("/"+ot+" sh"),re("Q");else if(St instanceof mp){var kt=new be(1,0,0,-1,0,ju());Q.matrix&&(kt=kt.multiply(Q.matrix||K),ot=Ur.call(St,Q.key,Q.boundingBox,Q.xStep,Q.yStep,kt).id),re("q"),re("/Pattern cs"),re("/"+ot+" scn"),St.gState&&h.setGState(St.gState),re(_e),re("Q")}},Nn=function(Q){switch(Q){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},la=h.moveTo=function(Q,_e){return re(S(D(Q))+" "+S(X(_e))+" m"),this},Kn=h.lineTo=function(Q,_e){return re(S(D(Q))+" "+S(X(_e))+" l"),this},jn=h.curveTo=function(Q,_e,ot,St,kt,sr){return re([S(D(Q)),S(X(_e)),S(D(ot)),S(X(St)),S(D(kt)),S(X(sr)),"c"].join(" ")),this};h.__private__.line=h.line=function(Q,_e,ot,St,kt){if(isNaN(Q)||isNaN(_e)||isNaN(ot)||isNaN(St)||!Rt(kt))throw new Error("Invalid arguments passed to jsPDF.line");return w===y?this.lines([[ot-Q,St-_e]],Q,_e,[1,1],kt||"S"):this.lines([[ot-Q,St-_e]],Q,_e,[1,1]).stroke()},h.__private__.lines=h.lines=function(Q,_e,ot,St,kt,sr){var ur,Dr,Gr,un,bn,qn,ma,Ds,_a,ri,Rs,ni;if(typeof Q=="number"&&(ni=ot,ot=_e,_e=Q,Q=ni),St=St||[1,1],sr=sr||!1,isNaN(_e)||isNaN(ot)||!Array.isArray(Q)||!Array.isArray(St)||!Rt(kt)||typeof sr!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(la(_e,ot),ur=St[0],Dr=St[1],un=Q.length,ri=_e,Rs=ot,Gr=0;Gr<un;Gr++)(bn=Q[Gr]).length===2?(ri=bn[0]*ur+ri,Rs=bn[1]*Dr+Rs,Kn(ri,Rs)):(qn=bn[0]*ur+ri,ma=bn[1]*Dr+Rs,Ds=bn[2]*ur+ri,_a=bn[3]*Dr+Rs,ri=bn[4]*ur+ri,Rs=bn[5]*Dr+Rs,jn(qn,ma,Ds,_a,ri,Rs));return sr&&Lt(),Tr(kt),this},h.path=function(Q){for(var _e=0;_e<Q.length;_e++){var ot=Q[_e],St=ot.c;switch(ot.op){case"m":la(St[0],St[1]);break;case"l":Kn(St[0],St[1]);break;case"c":jn.apply(this,St);break;case"h":Lt()}}return this},h.__private__.rect=h.rect=function(Q,_e,ot,St,kt){if(isNaN(Q)||isNaN(_e)||isNaN(ot)||isNaN(St)||!Rt(kt))throw new Error("Invalid arguments passed to jsPDF.rect");return w===y&&(St=-St),re([S(D(Q)),S(X(_e)),S(D(ot)),S(D(St)),"re"].join(" ")),Tr(kt),this},h.__private__.triangle=h.triangle=function(Q,_e,ot,St,kt,sr,ur){if(isNaN(Q)||isNaN(_e)||isNaN(ot)||isNaN(St)||isNaN(kt)||isNaN(sr)||!Rt(ur))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ot-Q,St-_e],[kt-ot,sr-St],[Q-kt,_e-sr]],Q,_e,[1,1],ur,!0),this},h.__private__.roundedRect=h.roundedRect=function(Q,_e,ot,St,kt,sr,ur){if(isNaN(Q)||isNaN(_e)||isNaN(ot)||isNaN(St)||isNaN(kt)||isNaN(sr)||!Rt(ur))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Dr=4/3*(Math.SQRT2-1);return kt=Math.min(kt,.5*ot),sr=Math.min(sr,.5*St),this.lines([[ot-2*kt,0],[kt*Dr,0,kt,sr-sr*Dr,kt,sr],[0,St-2*sr],[0,sr*Dr,-kt*Dr,sr,-kt,sr],[2*kt-ot,0],[-kt*Dr,0,-kt,-sr*Dr,-kt,-sr],[0,2*sr-St],[0,-sr*Dr,kt*Dr,-sr,kt,-sr]],Q+kt,_e,[1,1],ur,!0),this},h.__private__.ellipse=h.ellipse=function(Q,_e,ot,St,kt){if(isNaN(Q)||isNaN(_e)||isNaN(ot)||isNaN(St)||!Rt(kt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var sr=4/3*(Math.SQRT2-1)*ot,ur=4/3*(Math.SQRT2-1)*St;return la(Q+ot,_e),jn(Q+ot,_e-ur,Q+sr,_e-St,Q,_e-St),jn(Q-sr,_e-St,Q-ot,_e-ur,Q-ot,_e),jn(Q-ot,_e+ur,Q-sr,_e+St,Q,_e+St),jn(Q+sr,_e+St,Q+ot,_e+ur,Q+ot,_e),Tr(kt),this},h.__private__.circle=h.circle=function(Q,_e,ot,St){if(isNaN(Q)||isNaN(_e)||isNaN(ot)||!Rt(St))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(Q,_e,ot,ot,St)},h.setFont=function(Q,_e,ot){return ot&&(_e=_(_e,ot)),Ve=Ua(Q,_e,{disableWarning:!1}),this};var Un=h.__private__.getFont=h.getFont=function(){return Ae[Ua.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var Q,_e,ot={};for(Q in Qe)if(Qe.hasOwnProperty(Q))for(_e in ot[Q]=[],Qe[Q])Qe[Q].hasOwnProperty(_e)&&ot[Q].push(_e);return ot},h.addFont=function(Q,_e,ot,St,kt){var sr=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&sr.indexOf(arguments[3])!==-1?kt=arguments[3]:arguments[3]&&sr.indexOf(arguments[3])==-1&&(ot=_(ot,St)),Yr.call(this,Q,_e,ot,kt=kt||"Identity-H")};var ti,Fs=t.lineWidth||.200025,$l=h.__private__.getLineWidth=h.getLineWidth=function(){return Fs},$r=h.__private__.setLineWidth=h.setLineWidth=function(Q){return Fs=Q,re(S(D(Q))+" w"),this};h.__private__.setLineDash=Rr.API.setLineDash=Rr.API.setLineDashPattern=function(Q,_e){if(Q=Q||[],_e=_e||0,isNaN(_e)||!Array.isArray(Q))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return Q=Q.map(function(ot){return S(D(ot))}).join(" "),_e=S(D(_e)),re("["+Q+"] "+_e+" d"),this};var Cd=h.__private__.getLineHeight=h.getLineHeight=function(){return Me*ti};h.__private__.getLineHeight=h.getLineHeight=function(){return Me*ti};var xc=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(Q){return typeof(Q=Q||1.15)=="number"&&(ti=Q),this},Gl=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return ti};xc(t.lineHeight);var Os=h.__private__.getHorizontalCoordinate=function(Q){return D(Q)},Ki=h.__private__.getVerticalCoordinate=function(Q){return w===b?Q:Ce[G].mediaBox.topRightY-Ce[G].mediaBox.bottomLeftY-D(Q)},_1=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(Q){return S(Os(Q))},TA=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(Q){return S(Ki(Q))},_d=t.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return Y(_d)},h.__private__.setStrokeColor=h.setDrawColor=function(Q,_e,ot,St){return _d=oe({ch1:Q,ch2:_e,ch3:ot,ch4:St,pdfColorType:"draw",precision:2}),re(_d),this};var kA=t.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return Y(kA)},h.__private__.setFillColor=h.setFillColor=function(Q,_e,ot,St){return kA=oe({ch1:Q,ch2:_e,ch3:ot,ch4:St,pdfColorType:"fill",precision:2}),re(kA),this};var Hc=t.textColor||"0 g",ah=h.__private__.getTextColor=h.getTextColor=function(){return Y(Hc)};h.__private__.setTextColor=h.setTextColor=function(Q,_e,ot,St){return Hc=oe({ch1:Q,ch2:_e,ch3:ot,ch4:St,pdfColorType:"text",precision:3}),this};var Eu=t.charSpace,Bm=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(Eu||0)};h.__private__.setCharSpace=h.setCharSpace=function(Q){if(isNaN(Q))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Eu=Q,this};var Qa=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(Q){var _e=h.CapJoinStyles[Q];if(_e===void 0)throw new Error("Line cap style of '"+Q+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qa=_e,re(_e+" J"),this};var Tm=0;h.__private__.setLineJoin=h.setLineJoin=function(Q){var _e=h.CapJoinStyles[Q];if(_e===void 0)throw new Error("Line join style of '"+Q+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Tm=_e,re(_e+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(Q){if(Q=Q||0,isNaN(Q))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return re(S(D(Q))+" M"),this},h.GState=y2,h.setGState=function(Q){(Q=typeof Q=="string"?te[ie[Q]]:Mg(null,Q)).equals($e)||(re("/"+Q.id+" gs"),$e=Q)};var Mg=function(Q,_e){if(!Q||!ie[Q]){var ot=!1;for(var St in te)if(te.hasOwnProperty(St)&&te[St].equals(_e)){ot=!0;break}if(ot)_e=te[St];else{var kt="GS"+(Object.keys(te).length+1).toString(10);te[kt]=_e,_e.id=kt}return Q&&(ie[Q]=_e.id),nt.publish("addGState",_e),_e}};h.addGState=function(Q,_e){return Mg(Q,_e),this},h.saveGraphicsState=function(){return re("q"),Ct.push({key:Ve,size:Me,color:Hc}),this},h.restoreGraphicsState=function(){re("Q");var Q=Ct.pop();return Ve=Q.key,Me=Q.size,Hc=Q.color,$e=null,this},h.setCurrentTransformationMatrix=function(Q){return re(Q.toString()+" cm"),this},h.comment=function(Q){return re("#"+Q),this};var Su=function(Q,_e){var ot=Q||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ot},set:function(sr){isNaN(sr)||(ot=parseFloat(sr))}});var St=_e||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return St},set:function(sr){isNaN(sr)||(St=parseFloat(sr))}});var kt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return kt},set:function(sr){kt=sr.toString()}}),this},FA=function(Q,_e,ot,St){Su.call(this,Q,_e),this.type="rect";var kt=ot||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return kt},set:function(ur){isNaN(ur)||(kt=parseFloat(ur))}});var sr=St||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return sr},set:function(ur){isNaN(ur)||(sr=parseFloat(ur))}}),this},sh=function(){this.page=de,this.currentPage=G,this.pages=ve.slice(0),this.pagesContext=Ce.slice(0),this.x=le,this.y=Be,this.matrix=je,this.width=Kl(G),this.height=Lg(G),this.outputDestination=He,this.id="",this.objectNumber=-1};sh.prototype.restore=function(){de=this.page,G=this.currentPage,Ce=this.pagesContext,ve=this.pages,le=this.x,Be=this.y,je=this.matrix,km(G,this.width),ql(G,this.height),He=this.outputDestination};var mf=function(Q,_e,ot,St,kt){Xe.push(new sh),de=G=0,ve=[],le=Q,Be=_e,je=kt,Fr([ot,St])};for(var pf in h.beginFormObject=function(Q,_e,ot,St,kt){return mf(Q,_e,ot,St,kt),this},h.endFormObject=function(Q){return function(_e){if(xt[_e])Xe.pop().restore();else{var ot=new sh,St="Xo"+(Object.keys(ht).length+1).toString(10);ot.id=St,xt[_e]=St,ht[St]=ot,nt.publish("addFormObject",ot),Xe.pop().restore()}}(Q),this},h.doFormObject=function(Q,_e){var ot=ht[xt[Q]];return re("q"),re(_e.toString()+" cm"),re("/"+ot.id+" Do"),re("Q"),this},h.getFormObject=function(Q){var _e=ht[xt[Q]];return{x:_e.x,y:_e.y,width:_e.width,height:_e.height,matrix:_e.matrix}},h.save=function(Q,_e){return Q=Q||"generated.pdf",(_e=_e||{}).returnPromise=_e.returnPromise||!1,_e.returnPromise===!1?(Jm(lr(ft()),Q),typeof Jm.unload=="function"&&gn.setTimeout&&setTimeout(Jm.unload,911),this):new Promise(function(ot,St){try{var kt=Jm(lr(ft()),Q);typeof Jm.unload=="function"&&gn.setTimeout&&setTimeout(Jm.unload,911),ot(kt)}catch(sr){St(sr.message)}})},Rr.API)Rr.API.hasOwnProperty(pf)&&(pf==="events"&&Rr.API.events.length?function(Q,_e){var ot,St,kt;for(kt=_e.length-1;kt!==-1;kt--)ot=_e[kt][0],St=_e[kt][1],Q.subscribe.apply(Q,[ot].concat(typeof St=="function"?[St]:St))}(nt,Rr.API.events):h[pf]=Rr.API[pf]);function Kl(Q){return Ce[Q].mediaBox.topRightX-Ce[Q].mediaBox.bottomLeftX}function km(Q,_e){Ce[Q].mediaBox.topRightX=_e+Ce[Q].mediaBox.bottomLeftX}function Lg(Q){return Ce[Q].mediaBox.topRightY-Ce[Q].mediaBox.bottomLeftY}function ql(Q,_e){Ce[Q].mediaBox.topRightY=_e+Ce[Q].mediaBox.bottomLeftY}var Iu=h.getPageWidth=function(Q){return Kl(Q=Q||G)/he},OA=h.setPageWidth=function(Q,_e){km(Q,_e*he)},ju=h.getPageHeight=function(Q){return Lg(Q=Q||G)/he},Fm=h.setPageHeight=function(Q,_e){ql(Q,_e*he)};return h.internal={pdfEscape:Br,getStyle:Jt,getFont:Un,getFontSize:yt,getCharSpace:Bm,getTextColor:ah,getLineHeight:Cd,getLineHeightFactor:Gl,getLineWidth:$l,write:Pe,getHorizontalCoordinate:Os,getVerticalCoordinate:Ki,getCoordinateString:_1,getVerticalCoordinateString:TA,collections:{},newObject:at,newAdditionalObject:M,newObjectDeferred:it,newObjectDeferredBegin:T,getFilters:De,putStream:We,events:nt,scaleFactor:he,pageSize:{getWidth:function(){return Iu(G)},setWidth:function(Q){OA(G,Q)},getHeight:function(){return ju(G)},setHeight:function(Q){Fm(G,Q)}},encryptionOptions:d,encryption:Nt,getEncryptor:function(Q){return d!==null?Nt.encryptor(Q,0):function(_e){return _e}},output:Le,getNumberOfPages:In,get pages(){return ve},out:re,f2:k,f3:P,getPageInfo:Et,getPageInfoByObjId:gt,getCurrentPageInfo:ut,getPDFVersion:p,Point:Su,Rectangle:FA,Matrix:be,hasHotfix:tt},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return Iu(G)},set:function(Q){OA(G,Q)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return ju(G)},set:function(Q){Fm(G,Q)},enumerable:!0,configurable:!0}),(function(Q){for(var _e=0,ot=we.length;_e<ot;_e++){var St=Yr.call(this,Q[_e][0],Q[_e][1],Q[_e][2],we[_e][3],!0);f===!1&&(A[St]=!0);var kt=Q[_e][0].split("-");mr({id:St,fontName:kt[0],fontStyle:kt[1]||""})}nt.publish("addFonts",{fonts:Ae,dictionary:Qe})}).call(h,we),Ve="F1",vn(a,r),nt.publish("initialized"),h}Cx.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Cx.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Cx.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},Cx.prototype.processOwnerPassword=function(t,e){return Sk(Ek(e).substr(0,5),t)},Cx.prototype.encryptor=function(t,e){var r=Ek(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return Sk(r,n)}},y2.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||Oa(t)!==Oa(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},Rr.API={events:[]},Rr.version="3.0.4";var ii=Rr.API,P6=1,Eg=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},rx=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Cn=function(t){return t.toFixed(2)},t0=function(t){return t.toFixed(5)};ii.__acroform__={};var Uc=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},uV=function(t){return t*P6},Ef=function(t){var e=new fre,r=Vr.internal.getHeight(t)||0,n=Vr.internal.getWidth(t)||0;return e.BBox=[0,0,Number(Cn(n)),Number(Cn(r))],e},wje=ii.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},Nje=ii.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},Cje=ii.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},_i=ii.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Cje(t,e-1)},Ei=ii.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return wje(t,e-1)},Si=ii.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Nje(t,e-1)},_je=ii.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,a=t[0],s=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=r(a)||0,c.lowerLeft_Y=n(s+l)||0,c.upperRight_X=r(a+o)||0,c.upperRight_Y=n(s)||0,[Number(Cn(c.lowerLeft_X)),Number(Cn(c.lowerLeft_Y)),Number(Cn(c.upperRight_X)),Number(Cn(c.upperRight_Y))]},Eje=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=Ik(t,r),a=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+a+" "+Cn(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=Ef(t);return s.scope=t.scope,s.stream=e.join(`
`),s}},Ik=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},a=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");a=t.multiline?a.map(function(k){return k.split(`
`)}):a.map(function(k){return[k]});var s=r,o=Vr.internal.getHeight(t)||0;o=o<0?-o:o;var l=Vr.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(k,P,D){if(k+1<a.length){var X=P+" "+a[k+1][0];return EC(X,t,D).width<=l-4}return!1};s++;e:for(;s>0;){e="",s--;var u,d,f=EC("3",t,s).height,A=t.multiline?o-s:(o-f)/2,h=A+=2,m=0,p=0,g=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+EC(e,t,s=12).width+", FieldWidth:"+l+`
`;break}for(var v="",y=0,b=0;b<a.length;b++)if(a.hasOwnProperty(b)){var w=!1;if(a[b].length!==1&&g!==a[b].length-1){if((f+2)*(y+2)+2>o)continue e;v+=a[b][g],w=!0,p=b,b--}else{v=(v+=a[b][g]+" ").substr(v.length-1)==" "?v.substr(0,v.length-1):v;var j=parseInt(b),I=c(j,v,s),_=b>=a.length-1;if(I&&!_){v+=" ",g=0;continue}if(I||_){if(_)p=j;else if(t.multiline&&(f+2)*(y+2)+2>o)continue e}else{if(!t.multiline||(f+2)*(y+2)+2>o)continue e;p=j}}for(var S="",E=m;E<=p;E++){var F=a[E];if(t.multiline){if(E===p){S+=F[g]+" ",g=(g+1)%F.length;continue}if(E===m){S+=F[F.length-1]+" ";continue}}S+=F[0]+" "}switch(S=S.substr(S.length-1)==" "?S.substr(0,S.length-1):S,d=EC(S,t,s).width,t.textAlign){case"right":u=l-d-2;break;case"center":u=(l-d)/2;break;default:u=2}e+=Cn(u)+" "+Cn(h)+` Td
`,e+="("+Eg(S)+`) Tj
`,e+=-Cn(u)+` 0 Td
`,h=-(s+2),d=0,m=w?p:p+1,y++,v=""}break}return n.text=e,n.fontSize=s,n},EC=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),a=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},Sje={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Ije=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},jje=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(ff.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(Sje)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");P6=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new hre,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var s=n[a];s.objId=void 0,s.hasAnnotation&&Ije(s,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,a){var s=!n;for(var o in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=_je(l.Rect,a)),a.internal.newObjectDeferredBegin(l.objId,!0),l.DA=Vr.createDefaultAppearanceStream(l),Oa(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var d=Eje(l);c.push({key:"AP",value:"<</N "+d+">>"}),a.internal.acroformPlugin.xForms.push(d)}if(l.appearanceStreamContent){var f="";for(var A in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(A)){var h=l.appearanceStreamContent[A];if(f+="/"+A+" ",f+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var o in h)if(h.hasOwnProperty(o)){var m=h[o];typeof m=="function"&&(m=m.call(a,l)),f+="/"+o+" "+m+" ",a.internal.acroformPlugin.xForms.indexOf(m)>=0||a.internal.acroformPlugin.xForms.push(m)}}else typeof(m=h)=="function"&&(m=m.call(a,l)),f+="/"+o+" "+m,a.internal.acroformPlugin.xForms.indexOf(m)>=0||a.internal.acroformPlugin.xForms.push(m);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}a.internal.putStream({additionalKeyValues:c,objectId:l.objId}),a.internal.out("endobj")}s&&function(p,g){for(var v in p)if(p.hasOwnProperty(v)){var y=v,b=p[v];g.internal.newObjectDeferredBegin(b.objId,!0),Oa(b)==="object"&&typeof b.putStream=="function"&&b.putStream(),delete p[y]}}(a.internal.acroformPlugin.xForms,a)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},dre=ii.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(o){return o};if(Array.isArray(t)){for(var a="[",s=0;s<t.length;s++)switch(s!==0&&(a+=" "),Oa(t[s])){case"boolean":case"number":case"object":a+=t[s].toString();break;case"string":t[s].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),a+="("+Eg(n(t[s].toString()))+")"):a+=t[s].toString()}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},e5=function(t,e,r){var n=function(a){return a};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+Eg(n(t))+")"},Df=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Df.prototype.toString=function(){return this.objId+" 0 R"},Df.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Df.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],a=this[n];a&&(Array.isArray(a)?t.push({key:n,value:dre(a,this.objId,this.scope)}):a instanceof Df?(a.scope=this.scope,t.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&t.push({key:n,value:a}))}return t};var fre=function(){Df.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};Uc(fre,Df);var hre=function(){Df.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Eg(r(t))+")"}},set:function(r){t=r}})};Uc(hre,Df);var ff=function t(){Df.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute F supplied.');e=v}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!_i(e,3)},set:function(v){v?this.F=Ei(e,3):this.F=Si(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute Ff supplied.');r=v}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(v){n=v!==void 0?v:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(v){n[0]=v}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(v){n[1]=v}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(v){n[2]=v}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(v){n[3]=v}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(v){switch(v){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=v;break;default:throw new Error('Invalid value "'+v+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof wS)return;s="FieldObject"+t.FieldNum++}var v=function(y){return y};return this.scope&&(v=this.scope.internal.getEncryptor(this.objId)),"("+Eg(v(s))+")"},set:function(v){s=v.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(v){s=v}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(v){o=v}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(v){l=v}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(v){c=v}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/P6:u},set:function(v){u=v}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(v){d=v}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof wS||this instanceof J0))return e5(f,this.objId,this.scope)},set:function(v){v=v.toString(),f=v}});var A=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(A)return this instanceof no==0?e5(A,this.objId,this.scope):A},set:function(v){v=v.toString(),A=this instanceof no==0?v.substr(0,1)==="("?rx(v.substr(1,v.length-2)):rx(v):v}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof no==1?rx(A.substr(1,A.length-1)):A},set:function(v){v=v.toString(),A=this instanceof no==1?"/"+v:v}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(v){this.V=v}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof no==0?e5(h,this.objId,this.scope):h},set:function(v){v=v.toString(),h=this instanceof no==0?v.substr(0,1)==="("?rx(v.substr(1,v.length-2)):rx(v):v}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof no==1?rx(h.substr(1,h.length-1)):h},set:function(v){v=v.toString(),h=this instanceof no==1?"/"+v:v}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,p=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return p},set:function(v){v=!!v,p=v}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(v){m=v}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,1)},set:function(v){v?this.Ff=Ei(this.Ff,1):this.Ff=Si(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,2)},set:function(v){v?this.Ff=Ei(this.Ff,2):this.Ff=Si(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,3)},set:function(v){v?this.Ff=Ei(this.Ff,3):this.Ff=Si(this.Ff,3)}});var g=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(g!==null)return g},set:function(v){if([0,1,2].indexOf(v)===-1)throw new Error('Invalid value "'+v+'" for attribute Q supplied.');g=v}}),Object.defineProperty(this,"textAlign",{get:function(){var v;switch(g){case 0:default:v="left";break;case 1:v="center";break;case 2:v="right"}return v},configurable:!0,enumerable:!0,set:function(v){switch(v){case"right":case 2:g=2;break;case"center":case 1:g=1;break;default:g=0}}})};Uc(ff,Df);var Ep=function(){ff.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return dre(e,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=function(s,o,l){l||(l=1);for(var c,u=[];c=o.exec(s);)u.push(c[l]);return u}(n,/\((.*?)\)/g)),e=a}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,18)},set:function(r){r?this.Ff=Ei(this.Ff,18):this.Ff=Si(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Ei(this.Ff,19):this.Ff=Si(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,20)},set:function(r){r?(this.Ff=Ei(this.Ff,20),e.sort()):this.Ff=Si(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,22)},set:function(r){r?this.Ff=Ei(this.Ff,22):this.Ff=Si(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,23)},set:function(r){r?this.Ff=Ei(this.Ff,23):this.Ff=Si(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,27)},set:function(r){r?this.Ff=Ei(this.Ff,27):this.Ff=Si(this.Ff,27)}}),this.hasAppearanceStream=!1};Uc(Ep,ff);var Sp=function(){Ep.call(this),this.fontName="helvetica",this.combo=!1};Uc(Sp,Ep);var Ip=function(){Sp.call(this),this.combo=!0};Uc(Ip,Sp);var xb=function(){Ip.call(this),this.edit=!0};Uc(xb,Ip);var no=function(){ff.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,15)},set:function(r){r?this.Ff=Ei(this.Ff,15):this.Ff=Si(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,16)},set:function(r){r?this.Ff=Ei(this.Ff,16):this.Ff=Si(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,17)},set:function(r){r?this.Ff=Ei(this.Ff,17):this.Ff=Si(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,26)},set:function(r){r?this.Ff=Ei(this.Ff,26):this.Ff=Si(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,a=[];for(n in a.push("<<"),e)a.push("/"+n+" ("+Eg(r(e[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){Oa(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};Uc(no,ff);var vb=function(){no.call(this),this.pushButton=!0};Uc(vb,no);var jp=function(){no.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Uc(jp,no);var wS=function(){var t,e;ff.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(a){t=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(a){e=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(l){return l};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),n)o.push("/"+s+" ("+Eg(a(n[s]))+")");return o.push(">>"),o.join(`
`)},set:function(a){Oa(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Vr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Uc(wS,ff),jp.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},jp.prototype.createOption=function(t){var e=new wS;return e.Parent=this,e.optionName=t,this.Kids.push(e),Pje.call(this.scope,e),e};var yb=function(){no.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Vr.CheckBox.createAppearanceStream()};Uc(yb,no);var J0=function(){ff.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,13)},set:function(e){e?this.Ff=Ei(this.Ff,13):this.Ff=Si(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,21)},set:function(e){e?this.Ff=Ei(this.Ff,21):this.Ff=Si(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,23)},set:function(e){e?this.Ff=Ei(this.Ff,23):this.Ff=Si(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,24)},set:function(e){e?this.Ff=Ei(this.Ff,24):this.Ff=Si(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,25)},set:function(e){e?this.Ff=Ei(this.Ff,25):this.Ff=Si(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,26)},set:function(e){e?this.Ff=Ei(this.Ff,26):this.Ff=Si(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Uc(J0,ff);var bb=function(){J0.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!_i(this.Ff,14)},set:function(t){t?this.Ff=Ei(this.Ff,14):this.Ff=Si(this.Ff,14)}}),this.password=!0};Uc(bb,J0);var Vr={CheckBox:{createAppearanceStream:function(){return{N:{On:Vr.CheckBox.YesNormal},D:{On:Vr.CheckBox.YesPushDown,Off:Vr.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Ef(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,a=t.scope.__private__.encodeColorString(t.color),s=Ik(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+Cn(Vr.internal.getWidth(t))+" "+Cn(Vr.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Cn(s.fontSize)+" Tf "+a),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=Ef(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),a=[],s=Vr.internal.getHeight(t),o=Vr.internal.getWidth(t),l=Ik(t,t.caption);return a.push("1 g"),a.push("0 0 "+Cn(o)+" "+Cn(s)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+Cn(o-1)+" "+Cn(s-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+Cn(l.fontSize)+" Tf "+n),a.push(l.text),a.push("ET"),a.push("Q"),e.stream=a.join(`
`),e},OffPushDown:function(t){var e=Ef(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Cn(Vr.internal.getWidth(t))+" "+Cn(Vr.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Vr.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Vr.RadioButton.Circle.YesNormal,e.D[t]=Vr.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Ef(t);e.scope=t.scope;var r=[],n=Vr.internal.getWidth(t)<=Vr.internal.getHeight(t)?Vr.internal.getWidth(t)/4:Vr.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var a=Vr.internal.Bezier_C,s=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+t0(Vr.internal.getWidth(t)/2)+" "+t0(Vr.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Ef(t);e.scope=t.scope;var r=[],n=Vr.internal.getWidth(t)<=Vr.internal.getHeight(t)?Vr.internal.getWidth(t)/4:Vr.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*Vr.internal.Bezier_C).toFixed(5)),o=Number((n*Vr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+t0(Vr.internal.getWidth(t)/2)+" "+t0(Vr.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+t0(Vr.internal.getWidth(t)/2)+" "+t0(Vr.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Ef(t);e.scope=t.scope;var r=[],n=Vr.internal.getWidth(t)<=Vr.internal.getHeight(t)?Vr.internal.getWidth(t)/4:Vr.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*Vr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+t0(Vr.internal.getWidth(t)/2)+" "+t0(Vr.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Vr.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Vr.RadioButton.Cross.YesNormal,e.D[t]=Vr.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Ef(t);e.scope=t.scope;var r=[],n=Vr.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+Cn(Vr.internal.getWidth(t)-2)+" "+Cn(Vr.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(Cn(n.x1.x)+" "+Cn(n.x1.y)+" m"),r.push(Cn(n.x2.x)+" "+Cn(n.x2.y)+" l"),r.push(Cn(n.x4.x)+" "+Cn(n.x4.y)+" m"),r.push(Cn(n.x3.x)+" "+Cn(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Ef(t);e.scope=t.scope;var r=Vr.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+Cn(Vr.internal.getWidth(t))+" "+Cn(Vr.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Cn(Vr.internal.getWidth(t)-2)+" "+Cn(Vr.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(Cn(r.x1.x)+" "+Cn(r.x1.y)+" m"),n.push(Cn(r.x2.x)+" "+Cn(r.x2.y)+" l"),n.push(Cn(r.x4.x)+" "+Cn(r.x4.y)+" m"),n.push(Cn(r.x3.x)+" "+Cn(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Ef(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Cn(Vr.internal.getWidth(t))+" "+Cn(Vr.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};Vr.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Vr.internal.getWidth(t),r=Vr.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},Vr.internal.getWidth=function(t){var e=0;return Oa(t)==="object"&&(e=uV(t.Rect[2])),e},Vr.internal.getHeight=function(t){var e=0;return Oa(t)==="object"&&(e=uV(t.Rect[3])),e};var Pje=ii.addField=function(t){if(jje(this,t),!(t instanceof ff))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};ii.AcroFormChoiceField=Ep,ii.AcroFormListBox=Sp,ii.AcroFormComboBox=Ip,ii.AcroFormEditBox=xb,ii.AcroFormButton=no,ii.AcroFormPushButton=vb,ii.AcroFormRadioButton=jp,ii.AcroFormCheckBox=yb,ii.AcroFormTextField=J0,ii.AcroFormPasswordField=bb,ii.AcroFormAppearance=Vr,ii.AcroForm={ChoiceField:Ep,ListBox:Sp,ComboBox:Ip,EditBox:xb,Button:no,PushButton:vb,RadioButton:jp,CheckBox:yb,TextField:J0,PasswordField:bb,Appearance:Vr},Rr.AcroForm={ChoiceField:Ep,ListBox:Sp,ComboBox:Ip,EditBox:xb,Button:no,PushButton:vb,RadioButton:jp,CheckBox:yb,TextField:J0,PasswordField:bb,Appearance:Vr};var Bje=Rr.AcroForm;function Are(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=t.__addimage__.getImageFileTypeByImageData=function(k,P){var D,X,pe,ge,fe,xe=r;if((P=P||r)==="RGBA"||k.data!==void 0&&k.data instanceof Uint8ClampedArray&&"height"in k&&"width"in k)return"RGBA";if(I(k))for(fe in n)for(pe=n[fe],D=0;D<pe.length;D+=1){for(ge=!0,X=0;X<pe[D].length;X+=1)if(pe[D][X]!==void 0&&pe[D][X]!==k[X]){ge=!1;break}if(ge===!0){xe=fe;break}}else for(fe in n)for(pe=n[fe],D=0;D<pe.length;D+=1){for(ge=!0,X=0;X<pe[D].length;X+=1)if(pe[D][X]!==void 0&&pe[D][X]!==k.charCodeAt(X)){ge=!1;break}if(ge===!0){xe=fe;break}}return xe===r&&P!==r&&(xe=P),xe},s=function k(P){for(var D=this.internal.write,X=this.internal.putStream,pe=(0,this.internal.getFilters)();pe.indexOf("FlateEncode")!==-1;)pe.splice(pe.indexOf("FlateEncode"),1);P.objectId=this.internal.newObject();var ge=[];if(ge.push({key:"Type",value:"/XObject"}),ge.push({key:"Subtype",value:"/Image"}),ge.push({key:"Width",value:P.width}),ge.push({key:"Height",value:P.height}),P.colorSpace===v.INDEXED?ge.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(P.palette.length/3-1)+" "+("sMask"in P&&P.sMask!==void 0?P.objectId+2:P.objectId+1)+" 0 R]"}):(ge.push({key:"ColorSpace",value:"/"+P.colorSpace}),P.colorSpace===v.DEVICE_CMYK&&ge.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ge.push({key:"BitsPerComponent",value:P.bitsPerComponent}),"decodeParameters"in P&&P.decodeParameters!==void 0&&ge.push({key:"DecodeParms",value:"<<"+P.decodeParameters+">>"}),"transparency"in P&&Array.isArray(P.transparency)&&P.transparency.length>0){for(var fe="",xe=0,ae=P.transparency.length;xe<ae;xe++)fe+=P.transparency[xe]+" "+P.transparency[xe]+" ";ge.push({key:"Mask",value:"["+fe+"]"})}P.sMask!==void 0&&ge.push({key:"SMask",value:P.objectId+1+" 0 R"});var Se=P.filter!==void 0?["/"+P.filter]:void 0;if(X({data:P.data,additionalKeyValues:ge,alreadyAppliedFilters:Se,objectId:P.objectId}),D("endobj"),"sMask"in P&&P.sMask!==void 0){var Te,O=(Te=P.sMaskBitsPerComponent)!==null&&Te!==void 0?Te:P.bitsPerComponent,G={width:P.width,height:P.height,colorSpace:"DeviceGray",bitsPerComponent:O,data:P.sMask};"filter"in P&&(G.decodeParameters="/Predictor ".concat(P.predictor," /Colors 1 /BitsPerComponent ").concat(O," /Columns ").concat(P.width),G.filter=P.filter),k.call(this,G)}if(P.colorSpace===v.INDEXED){var z=this.internal.newObject();X({data:S(new Uint8Array(P.palette)),objectId:z}),D("endobj")}},o=function(){var k=this.internal.collections[e+"images"];for(var P in k)s.call(this,k[P])},l=function(){var k,P=this.internal.collections[e+"images"],D=this.internal.write;for(var X in P)D("/I"+(k=P[X]).index,k.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var k=this.internal.collections[e+"images"];return c.call(this),k},d=function(){return Object.keys(this.internal.collections[e+"images"]).length},f=function(k){return typeof t["process"+k.toUpperCase()]=="function"},A=function(k){return Oa(k)==="object"&&k.nodeType===1},h=function(k,P){if(k.nodeName==="IMG"&&k.hasAttribute("src")){var D=""+k.getAttribute("src");if(D.indexOf("data:image/")===0)return sE(unescape(D).split("base64,").pop());var X=t.loadFile(D,!0);if(X!==void 0)return X}if(k.nodeName==="CANVAS"){if(k.width===0||k.height===0)throw new Error("Given canvas must have data. Canvas width: "+k.width+", height: "+k.height);var pe;switch(P){case"PNG":pe="image/png";break;case"WEBP":pe="image/webp";break;default:pe="image/jpeg"}return sE(k.toDataURL(pe,1).split("base64,").pop())}},m=function(k){var P=this.internal.collections[e+"images"];if(P){for(var D in P)if(k===P[D].alias)return P[D]}},p=function(k,P,D){return k||P||(k=-96,P=-96),k<0&&(k=-1*D.width*72/k/this.internal.scaleFactor),P<0&&(P=-1*D.height*72/P/this.internal.scaleFactor),k===0&&(k=P*D.width/D.height),P===0&&(P=k*D.height/D.width),[k,P]},g=function(k,P,D,X,pe,ge){var fe=p.call(this,D,X,pe),xe=this.internal.getCoordinateString,ae=this.internal.getVerticalCoordinateString,Se=u.call(this);if(D=fe[0],X=fe[1],Se[pe.index]=pe,ge){ge*=Math.PI/180;var Te=Math.cos(ge),O=Math.sin(ge),G=function(L){return L.toFixed(4)},z=[G(Te),G(O),G(-1*O),G(Te),0,0,"cm"]}this.internal.write("q"),ge?(this.internal.write([1,"0","0",1,xe(k),ae(P+X),"cm"].join(" ")),this.internal.write(z.join(" ")),this.internal.write([xe(D),"0","0",xe(X),"0","0","cm"].join(" "))):this.internal.write([xe(D),"0","0",xe(X),xe(k),ae(P+X),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+pe.index+" Do"),this.internal.write("Q")},v=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=t.__addimage__.sHashCode=function(k){var P,D,X=0;if(typeof k=="string")for(D=k.length,P=0;P<D;P++)X=(X<<5)-X+k.charCodeAt(P),X|=0;else if(I(k))for(D=k.byteLength/2,P=0;P<D;P++)X=(X<<5)-X+k[P],X|=0;return X},w=t.__addimage__.validateStringAsBase64=function(k){(k=k||"").toString().trim();var P=!0;return k.length===0&&(P=!1),k.length%4!=0&&(P=!1),/^[A-Za-z0-9+/]+$/.test(k.substr(0,k.length-2))===!1&&(P=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(k.substr(-2))===!1&&(P=!1),P},j=t.__addimage__.extractImageFromDataUrl=function(k){if(k==null||!(k=k.trim()).startsWith("data:"))return null;var P=k.indexOf(",");return P<0?null:k.substring(0,P).trim().endsWith("base64")?k.substring(P+1):null};t.__addimage__.isArrayBuffer=function(k){return k instanceof ArrayBuffer};var I=t.__addimage__.isArrayBufferView=function(k){return k instanceof Int8Array||k instanceof Uint8Array||k instanceof Uint8ClampedArray||k instanceof Int16Array||k instanceof Uint16Array||k instanceof Int32Array||k instanceof Uint32Array||k instanceof Float32Array||k instanceof Float64Array},_=t.__addimage__.binaryStringToUint8Array=function(k){for(var P=k.length,D=new Uint8Array(P),X=0;X<P;X++)D[X]=k.charCodeAt(X);return D},S=t.__addimage__.arrayBufferToBinaryString=function(k){for(var P="",D=I(k)?k:new Uint8Array(k),X=0;X<D.length;X+=8192)P+=String.fromCharCode.apply(null,D.subarray(X,X+8192));return P};t.addImage=function(){var k,P,D,X,pe,ge,fe,xe,ae;if(typeof arguments[1]=="number"?(P=r,D=arguments[1],X=arguments[2],pe=arguments[3],ge=arguments[4],fe=arguments[5],xe=arguments[6],ae=arguments[7]):(P=arguments[1],D=arguments[2],X=arguments[3],pe=arguments[4],ge=arguments[5],fe=arguments[6],xe=arguments[7],ae=arguments[8]),Oa(k=arguments[0])==="object"&&!A(k)&&"imageData"in k){var Se=k;k=Se.imageData,P=Se.format||P||r,D=Se.x||D||0,X=Se.y||X||0,pe=Se.w||Se.width||pe,ge=Se.h||Se.height||ge,fe=Se.alias||fe,xe=Se.compression||xe,ae=Se.rotation||Se.angle||ae}var Te=this.internal.getFilters();if(xe===void 0&&Te.indexOf("FlateEncode")!==-1&&(xe="SLOW"),isNaN(D)||isNaN(X))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var O=E.call(this,k,P,fe,xe);return g.call(this,D,X,pe,ge,O,ae),this};var E=function(k,P,D,X){var pe,ge,fe;if(typeof k=="string"&&a(k)===r){k=unescape(k);var xe=F(k,!1);(xe!==""||(xe=t.loadFile(k,!0))!==void 0)&&(k=xe)}if(A(k)&&(k=h(k,P)),P=a(k,P),!f(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(((fe=D)==null||fe.length===0)&&(D=function(ae){return typeof ae=="string"||I(ae)?b(ae):I(ae.data)?b(ae.data):null}(k)),(pe=m.call(this,D))||(k instanceof Uint8Array||P==="RGBA"||(ge=k,k=_(k)),pe=this["process"+P.toUpperCase()](k,d.call(this),D,function(ae){return ae&&typeof ae=="string"&&(ae=ae.toUpperCase()),ae in t.image_compression?ae:y.NONE}(X),ge)),!pe)throw new Error("An unknown error occurred whilst processing the image.");return pe},F=t.__addimage__.convertBase64ToBinaryString=function(k,P){P=typeof P!="boolean"||P;var D,X="";if(typeof k=="string"){var pe;D=(pe=j(k))!==null&&pe!==void 0?pe:k;try{X=sE(D)}catch(ge){if(P)throw w(D)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ge.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return X};t.getImageProperties=function(k){var P,D,X="";if(A(k)&&(k=h(k)),typeof k=="string"&&a(k)===r&&((X=F(k,!1))===""&&(X=t.loadFile(k)||""),k=X),D=a(k),!f(D))throw new Error("addImage does not support files of type '"+D+"', please ensure that a plugin for '"+D+"' support is added.");if(k instanceof Uint8Array||(k=_(k)),!(P=this["process"+D.toUpperCase()](k)))throw new Error("An unknown error occurred whilst processing the image");return P.fileType=D,P}})(Rr.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};Rr.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,a,s,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,d=!1,f=0;f<u.length&&!d;f++)switch((n=u[f]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var A=0;A<u.length;A++){n=u[A];var h=this.internal.pdfEscape,m=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),g=this.internal.newAdditionalObject(),v=this.internal.getEncryptor(p.objId),y=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+h(v(n.contents))+")",s+=" /Popup "+g.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+h(v(y))+") >>",p.content=s;var b=p.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+b,n.open&&(s+=" /Open true"),s+=" >>",g.content=s,this.internal.write(p.objId,"0 R",g.objId,"0 R");break;case"freetext":a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var w=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+h(m(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+w+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var j=this.annotations._nameMap[n.options.name];n.options.pageNumber=j.page,n.options.top=j.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+h(m(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;default:var I=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+I+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,a,s,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+a),h:u(n+s)},options:o,type:"link"})},t.textWithLink=function(r,n,a,s){var o,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){l=s.maxWidth;var d=this.splitTextToSize(r,l).length;o=Math.ceil(u*d)}else l=c,o=u;return this.text(r,n,a,s),a+=.2*u,s.align==="center"&&(n-=c/2),s.align==="right"&&(n-=c),this.link(n,a-u,l,o,s),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(Rr.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];t.__arabicParser__={};var s=t.__arabicParser__.isInArabicSubstitutionA=function(p){return e[p.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(p){return typeof p=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(p)},l=t.__arabicParser__.isArabicEndLetter=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(p){return o(p)&&a.indexOf(p.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length>=3};var d=t.__arabicParser__.arabicLetterHasMedialForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length==4},f=t.__arabicParser__.resolveLigatures=function(p){var g=0,v=r,y="",b=0;for(g=0;g<p.length;g+=1)v[p.charCodeAt(g)]!==void 0?(b++,typeof(v=v[p.charCodeAt(g)])=="number"&&(y+=String.fromCharCode(v),v=r,b=0),g===p.length-1&&(v=r,y+=p.charAt(g-(b-1)),g-=b-1,b=0)):(v=r,y+=p.charAt(g-b),g-=b,b=0);return y};t.__arabicParser__.isArabicDiacritic=function(p){return p!==void 0&&n[p.charCodeAt(0)]!==void 0};var A=t.__arabicParser__.getCorrectForm=function(p,g,v){return o(p)?s(p)===!1?-1:!u(p)||!o(g)&&!o(v)||!o(v)&&l(g)||l(p)&&!o(g)||l(p)&&c(g)||l(p)&&l(g)?0:d(p)&&o(g)&&!l(g)&&o(v)&&u(v)?3:l(p)||!o(v)?1:2:-1},h=function(p){var g=0,v=0,y=0,b="",w="",j="",I=(p=p||"").split("\\s+"),_=[];for(g=0;g<I.length;g+=1){for(_.push(""),v=0;v<I[g].length;v+=1)b=I[g][v],w=I[g][v-1],j=I[g][v+1],o(b)?(y=A(b,w,j),_[g]+=y!==-1?String.fromCharCode(e[b.charCodeAt(0)][y]):b):_[g]+=b;_[g]=f(_[g])}return _.join(" ")},m=t.__arabicParser__.processArabic=t.processArabic=function(){var p,g=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,v=[];if(Array.isArray(g)){var y=0;for(v=[],y=0;y<g.length;y+=1)Array.isArray(g[y])?v.push([h(g[y][0]),g[y][1],g[y][2]]):v.push([h(g[y])]);p=v}else p=h(g);return typeof arguments[0]=="string"?p:(arguments[0].text=p,arguments[0])};t.events.push(["preProcessText",m])}(Rr.API),Rr.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(l){a=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(l){s=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(Rr.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(p){c=p}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(p){u=p}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(p){d=p}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(p){f=p}});var A=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return A},set:function(p){A=p}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(p){h=p}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(p){m=p}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,u){n.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),f=u.font||this.getFont(),A=u.scaleFactor||this.internal.scaleFactor,h=0,m=0,p=0,g=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var v=u.maxWidth;v>0?typeof c=="string"?c=this.splitTextToSize(c,v):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(b,w){return b.concat(g.splitTextToSize(w,v))},[])):c=Array.isArray(c)?c:[c];for(var y=0;y<c.length;y++)h<(p=this.getStringUnitWidth(c[y],{font:f})*d)&&(h=p);return h!==0&&(m=c.length),{w:h/=A,h:Math.max((m*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/A,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,f=this.internal.__cell__.margins||e,A=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,h&&A&&(this.printHeaderRow(c.lineNumber,!0),c.y+=A[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};t.table=function(c,u,d,f,A){if(n.call(this),!d)throw new Error("No data for PDF table.");var h,m,p,g,v=[],y=[],b=[],w={},j={},I=[],_=[],S=(A=A||{}).autoSize||!1,E=A.printHeaders!==!1,F=A.css&&A.css["font-size"]!==void 0?16*A.css["font-size"]:A.fontSize||12,k=A.margins||Object.assign({width:this.getPageWidth()},e),P=typeof A.padding=="number"?A.padding:3,D=A.headerBackgroundColor||"#c8c8c8",X=A.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=E,this.internal.__cell__.margins=k,this.internal.__cell__.table_font_size=F,this.internal.__cell__.padding=P,this.internal.__cell__.headerBackgroundColor=D,this.internal.__cell__.headerTextColor=X,this.setFontSize(F),f==null)y=v=Object.keys(d[0]),b=v.map(function(){return"left"});else if(Array.isArray(f)&&Oa(f[0])==="object")for(v=f.map(function(Se){return Se.name}),y=f.map(function(Se){return Se.prompt||Se.name||""}),b=f.map(function(Se){return Se.align||"left"}),h=0;h<f.length;h+=1)j[f[h].name]=.7499990551181103*f[h].width;else Array.isArray(f)&&typeof f[0]=="string"&&(y=v=f,b=v.map(function(){return"left"}));if(S||Array.isArray(f)&&typeof f[0]=="string")for(h=0;h<v.length;h+=1){for(w[g=v[h]]=d.map(function(Se){return Se[g]}),this.setFont(void 0,"bold"),I.push(this.getTextDimensions(y[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=w[g],this.setFont(void 0,"normal"),p=0;p<m.length;p+=1)I.push(this.getTextDimensions(m[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);j[g]=Math.max.apply(null,I)+P+P,I=[]}if(E){var pe={};for(h=0;h<v.length;h+=1)pe[v[h]]={},pe[v[h]].text=y[h],pe[v[h]].align=b[h];var ge=l.call(this,pe,j);_=v.map(function(Se){return new s(c,u,j[Se],ge,pe[Se].text,void 0,pe[Se].align)}),this.setTableHeaderRow(_),this.printHeaderRow(1,!1)}var fe=f.reduce(function(Se,Te){return Se[Te.name]=Te.align,Se},{});for(h=0;h<d.length;h+=1){"rowStart"in A&&A.rowStart instanceof Function&&A.rowStart({row:h,data:d[h]},this);var xe=l.call(this,d[h],j);for(p=0;p<v.length;p+=1){var ae=d[h][v[p]];"cellStart"in A&&A.cellStart instanceof Function&&A.cellStart({row:h,col:p,data:ae},this),o.call(this,new s(c,u,j[v[p]],xe,ae,h+2,fe[v[p]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var d=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,A=this.internal.scaleFactor;return Object.keys(c).map(function(h){var m=c[h];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,u[h]-d-d)},this).map(function(h){return this.getLineHeightFactor()*h.length*f/A+d+d},this).reduce(function(h,m){return Math.max(h,m)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var A=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){d=this.internal.__cell__.tableHeaderRow[h].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,A.push(d)),d.lineNumber=c;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(m)}A.length>0&&this.setTableHeaderRow(A),this.setFont(void 0,"normal"),r=!1}}(Rr.API);var mre={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},pre=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],jk=Are(pre),gre=[100,200,300,400,500,600,700,800,900],Tje=Are(gre);function t5(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return mre[s=s||"normal"]?s:"normal"}(t.style),n=function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400}(t.weight),a=function(s){return typeof jk[s=s||"normal"]=="number"?s:"normal"}(t.stretch);return{family:e,style:r,weight:n,stretch:a,src:t.src||[],ref:t.ref||{name:e,style:[a,r,n].join(" ")}}}function dV(t,e,r,n){var a;for(a=r;a>=0&&a<e.length;a+=n)if(t[e[a]])return t[e[a]];for(a=r;a>=0&&a<e.length;a-=n)if(t[e[a]])return t[e[a]]}var kje={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},fV={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function hV(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function AV(t){return t.trimLeft()}function Fje(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function Oje(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var SC,mV,pV,nx,IC,gV,xV,vV,r5=["times"];function yV(t,e,r,n,a){var s=4,o=wV;switch(a){case Rr.API.image_compression.FAST:s=1,o=bV;break;case Rr.API.image_compression.MEDIUM:s=6,o=NV;break;case Rr.API.image_compression.SLOW:s=9,o=CV}t=function(c,u,d,f){for(var A,h=c.length/u,m=new Uint8Array(c.length+h),p=[Dje,bV,wV,NV,CV],g=0;g<h;g+=1){var v=g*u,y=c.subarray(v,v+u);if(f)m.set(f(y,d,A),v+g);else{for(var b=p.length,w=[],j=0;j<b;j+=1)w[j]=p[j](y,d,A);var I=Mje(w.concat());m.set(w[I],v+g)}A=y}return m}(t,e,Math.ceil(r*n/8),o);var l=wk(t,{level:s});return Rr.API.__addimage__.arrayBufferToBinaryString(l)}function Dje(t){var e=Array.apply([],t);return e.unshift(0),e}function bV(t,e){var r=t.length,n=[];n[0]=1;for(var a=0;a<r;a+=1){var s=t[a-e]||0;n[a+1]=t[a]-s+256&255}return n}function wV(t,e,r){var n=t.length,a=[];a[0]=2;for(var s=0;s<n;s+=1){var o=r&&r[s]||0;a[s+1]=t[s]-o+256&255}return a}function NV(t,e,r){var n=t.length,a=[];a[0]=3;for(var s=0;s<n;s+=1){var o=t[s-e]||0,l=r&&r[s]||0;a[s+1]=t[s]+256-(o+l>>>1)&255}return a}function CV(t,e,r){var n=t.length,a=[];a[0]=4;for(var s=0;s<n;s+=1){var o=Rje(t[s-e]||0,r&&r[s]||0,r&&r[s-e]||0);a[s+1]=t[s]-o+256&255}return a}function Rje(t,e,r){if(t===e&&e===r)return t;var n=Math.abs(e-r),a=Math.abs(t-r),s=Math.abs(t+e-r-r);return n<=a&&n<=s?t:a<=s?e:r}function Mje(t){var e=t.map(function(r){return r.reduce(function(n,a){return n+Math.abs(a)},0)});return e.indexOf(Math.min.apply(null,e))}function n5(t,e,r){var n=e*r,a=Math.floor(n/8),s=16-(n-8*a+r),o=(1<<r)-1;return xre(t,a)>>s&o}function _V(t,e,r,n){var a=r*n,s=Math.floor(a/8),o=16-(a-8*s+n),l=(1<<n)-1,c=(e&l)<<o;(function(u,d,f){if(d+1<u.byteLength)u.setUint16(d,f,!1);else{var A=f>>8&255;u.setUint8(d,A)}})(t,s,xre(t,s)&~(l<<o)&65535|c)}function xre(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function Lje(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,a=t[e++],s=a>>7,o=1<<1+(7&a);t[e++],t[e++];var l=null,c=null;s&&(l=e,c=o,e+=3*o);var u=!0,d=[],f=0,A=null,h=0,m=null;for(this.width=r,this.height=n;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,m=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var p=t[e++];f=t[e++]|t[e++]<<8,A=t[e++],1&p||(A=null),h=p>>2&7,e++;break;case 254:for(;;){if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var g=t[e++]|t[e++]<<8,v=t[e++]|t[e++]<<8,y=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,w=t[e++],j=w>>6&1,I=1<<1+(7&w),_=l,S=c,E=!1;w>>7&&(E=!0,_=e,S=I,e+=3*I);var F=e;for(e++;;){var k;if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}d.push({x:g,y:v,width:y,height:b,has_local_palette:E,palette_offset:_,palette_size:S,data_offset:F,data_length:e-F,transparent_index:A,interlaced:!!j,delay:f,disposal:h});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return m},this.frameInfo=function(P){if(P<0||P>=d.length)throw new Error("Frame index out of range.");return d[P]},this.decodeAndBlitFrameBGRA=function(P,D){var X=this.frameInfo(P),pe=X.width*X.height,ge=new Uint8Array(pe);EV(t,X.data_offset,ge,pe);var fe=X.palette_offset,xe=X.transparent_index;xe===null&&(xe=256);var ae=X.width,Se=r-ae,Te=ae,O=4*(X.y*r+X.x),G=4*((X.y+X.height)*r+X.x),z=O,L=4*Se;X.interlaced===!0&&(L+=4*r*7);for(var Z=8,ee=0,R=ge.length;ee<R;++ee){var H=ge[ee];if(Te===0&&(Te=ae,(z+=L)>=G&&(L=4*Se+4*r*(Z-1),z=O+(ae+Se)*(Z<<1),Z>>=1)),H===xe)z+=4;else{var ne=t[fe+3*H],ve=t[fe+3*H+1],U=t[fe+3*H+2];D[z++]=U,D[z++]=ve,D[z++]=ne,D[z++]=255}--Te}},this.decodeAndBlitFrameRGBA=function(P,D){var X=this.frameInfo(P),pe=X.width*X.height,ge=new Uint8Array(pe);EV(t,X.data_offset,ge,pe);var fe=X.palette_offset,xe=X.transparent_index;xe===null&&(xe=256);var ae=X.width,Se=r-ae,Te=ae,O=4*(X.y*r+X.x),G=4*((X.y+X.height)*r+X.x),z=O,L=4*Se;X.interlaced===!0&&(L+=4*r*7);for(var Z=8,ee=0,R=ge.length;ee<R;++ee){var H=ge[ee];if(Te===0&&(Te=ae,(z+=L)>=G&&(L=4*Se+4*r*(Z-1),z=O+(ae+Se)*(Z<<1),Z>>=1)),H===xe)z+=4;else{var ne=t[fe+3*H],ve=t[fe+3*H+1],U=t[fe+3*H+2];D[z++]=ne,D[z++]=ve,D[z++]=U,D[z++]=255}--Te}}}function EV(t,e,r,n){for(var a=t[e++],s=1<<a,o=s+1,l=o+1,c=a+1,u=(1<<c)-1,d=0,f=0,A=0,h=t[e++],m=new Int32Array(4096),p=null;;){for(;d<16&&h!==0;)f|=t[e++]<<d,d+=8,h===1?h=t[e++]:--h;if(d<c)break;var g=f&u;if(f>>=c,d-=c,g!==s){if(g===o)break;for(var v=g<l?g:p,y=0,b=v;b>s;)b=m[b]>>8,++y;var w=b;if(A+y+(v!==g?1:0)>n)return void Xa.log("Warning, gif stream longer than expected.");r[A++]=w;var j=A+=y;for(v!==g&&(r[A++]=w),b=v;y--;)b=m[b],r[--j]=255&b,b>>=8;p!==null&&l<4096&&(m[l++]=p<<8|w,l>=u+1&&c<12&&(++c,u=u<<1|1)),p=g}else l=o+1,u=(1<<(c=a+1))-1,p=null}return A!==n&&Xa.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function a5(t){var e,r,n,a,s,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(64),f=new Array(65535),A=new Array(65535),h=new Array(64),m=new Array(64),p=[],g=0,v=7,y=new Array(64),b=new Array(64),w=new Array(64),j=new Array(256),I=new Array(2048),_=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],S=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],E=[0,1,2,3,4,5,6,7,8,9,10,11],F=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],k=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],D=[0,1,2,3,4,5,6,7,8,9,10,11],X=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],pe=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ge(O,G){for(var z=0,L=0,Z=new Array,ee=1;ee<=16;ee++){for(var R=1;R<=O[ee];R++)Z[G[L]]=[],Z[G[L]][0]=z,Z[G[L]][1]=ee,L++,z++;z*=2}return Z}function fe(O){for(var G=O[0],z=O[1]-1;z>=0;)G&1<<z&&(g|=1<<v),z--,--v<0&&(g==255?(xe(255),xe(0)):xe(g),v=7,g=0)}function xe(O){p.push(O)}function ae(O){xe(O>>8&255),xe(255&O)}function Se(O,G,z,L,Z){for(var ee,R=Z[0],H=Z[240],ne=function(Me,ze){var yt,It,Ke,wt,At,bt,ke,Ne,Ve,he,le=0;for(Ve=0;Ve<8;++Ve){yt=Me[le],It=Me[le+1],Ke=Me[le+2],wt=Me[le+3],At=Me[le+4],bt=Me[le+5],ke=Me[le+6];var Be=yt+(Ne=Me[le+7]),je=yt-Ne,Ae=It+ke,Qe=It-ke,Ct=Ke+bt,pt=Ke-bt,me=wt+At,te=wt-At,ie=Be+me,$e=Be-me,de=Ae+Ct,Ce=Ae-Ct;Me[le]=ie+de,Me[le+4]=ie-de;var nt=.707106781*(Ce+$e);Me[le+2]=$e+nt,Me[le+6]=$e-nt;var vt=.382683433*((ie=te+pt)-(Ce=Qe+je)),ht=.5411961*ie+vt,xt=1.306562965*Ce+vt,Xe=.707106781*(de=pt+Qe),be=je+Xe,st=je-Xe;Me[le+5]=st+ht,Me[le+3]=st-ht,Me[le+1]=be+xt,Me[le+7]=be-xt,le+=8}for(le=0,Ve=0;Ve<8;++Ve){yt=Me[le],It=Me[le+8],Ke=Me[le+16],wt=Me[le+24],At=Me[le+32],bt=Me[le+40],ke=Me[le+48];var K=yt+(Ne=Me[le+56]),Ie=yt-Ne,Ze=It+ke,at=It-ke,it=Ke+bt,T=Ke-bt,M=wt+At,V=wt-At,q=K+M,Y=K-M,oe=Ze+it,De=Ze-it;Me[le]=q+oe,Me[le+32]=q-oe;var We=.707106781*(De+Y);Me[le+16]=Y+We,Me[le+48]=Y-We;var dt=.382683433*((q=V+T)-(De=at+Ie)),Oe=.5411961*q+dt,et=1.306562965*De+dt,mt=.707106781*(oe=T+at),Tt=Ie+mt,Pt=Ie-mt;Me[le+40]=Pt+Oe,Me[le+24]=Pt-Oe,Me[le+8]=Tt+et,Me[le+56]=Tt-et,le++}for(Ve=0;Ve<64;++Ve)he=Me[Ve]*ze[Ve],h[Ve]=he>0?he+.5|0:he-.5|0;return h}(O,G),ve=0;ve<64;++ve)m[_[ve]]=ne[ve];var U=m[0]-z;z=m[0],U==0?fe(L[0]):(fe(L[A[ee=32767+U]]),fe(f[ee]));for(var He=63;He>0&&m[He]==0;)He--;if(He==0)return fe(R),z;for(var se,re=1;re<=He;){for(var Pe=re;m[re]==0&&re<=He;)++re;var ue=re-Pe;if(ue>=16){se=ue>>4;for(var we=1;we<=se;++we)fe(H);ue&=15}ee=32767+m[re],fe(Z[(ue<<4)+A[ee]]),fe(f[ee]),re++}return He!=63&&fe(R),z}function Te(O){O=Math.min(Math.max(O,1),100),s!=O&&(function(G){for(var z=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],L=0;L<64;L++){var Z=o((z[L]*G+50)/100);Z=Math.min(Math.max(Z,1),255),l[_[L]]=Z}for(var ee=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],R=0;R<64;R++){var H=o((ee[R]*G+50)/100);H=Math.min(Math.max(H,1),255),c[_[R]]=H}for(var ne=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ve=0,U=0;U<8;U++)for(var He=0;He<8;He++)u[ve]=1/(l[_[ve]]*ne[U]*ne[He]*8),d[ve]=1/(c[_[ve]]*ne[U]*ne[He]*8),ve++}(O<50?Math.floor(5e3/O):Math.floor(200-2*O)),s=O)}this.encode=function(O,G){G&&Te(G),p=new Array,g=0,v=7,ae(65496),ae(65504),ae(16),xe(74),xe(70),xe(73),xe(70),xe(0),xe(1),xe(1),xe(0),ae(1),ae(1),xe(0),xe(0),function(){ae(65499),ae(132),xe(0);for(var It=0;It<64;It++)xe(l[It]);xe(1);for(var Ke=0;Ke<64;Ke++)xe(c[Ke])}(),function(It,Ke){ae(65472),ae(17),xe(8),ae(Ke),ae(It),xe(3),xe(1),xe(17),xe(0),xe(2),xe(17),xe(1),xe(3),xe(17),xe(1)}(O.width,O.height),function(){ae(65476),ae(418),xe(0);for(var It=0;It<16;It++)xe(S[It+1]);for(var Ke=0;Ke<=11;Ke++)xe(E[Ke]);xe(16);for(var wt=0;wt<16;wt++)xe(F[wt+1]);for(var At=0;At<=161;At++)xe(k[At]);xe(1);for(var bt=0;bt<16;bt++)xe(P[bt+1]);for(var ke=0;ke<=11;ke++)xe(D[ke]);xe(17);for(var Ne=0;Ne<16;Ne++)xe(X[Ne+1]);for(var Ve=0;Ve<=161;Ve++)xe(pe[Ve])}(),ae(65498),ae(12),xe(3),xe(1),xe(0),xe(2),xe(17),xe(3),xe(17),xe(0),xe(63),xe(0);var z=0,L=0,Z=0;g=0,v=7,this.encode.displayName="_encode_";for(var ee,R,H,ne,ve,U,He,se,re,Pe=O.data,ue=O.width,we=O.height,Me=4*ue,ze=0;ze<we;){for(ee=0;ee<Me;){for(ve=Me*ze+ee,He=-1,se=0,re=0;re<64;re++)U=ve+(se=re>>3)*Me+(He=4*(7&re)),ze+se>=we&&(U-=Me*(ze+1+se-we)),ee+He>=Me&&(U-=ee+He-Me+4),R=Pe[U++],H=Pe[U++],ne=Pe[U++],y[re]=(I[R]+I[H+256|0]+I[ne+512|0]>>16)-128,b[re]=(I[R+768|0]+I[H+1024|0]+I[ne+1280|0]>>16)-128,w[re]=(I[R+1280|0]+I[H+1536|0]+I[ne+1792|0]>>16)-128;z=Se(y,u,z,e,n),L=Se(b,d,L,r,a),Z=Se(w,d,Z,r,a),ee+=32}ze+=8}if(v>=0){var yt=[];yt[1]=v+1,yt[0]=(1<<v+1)-1,fe(yt)}return ae(65497),new Uint8Array(p)},t=t||50,function(){for(var O=String.fromCharCode,G=0;G<256;G++)j[G]=O(G)}(),e=ge(S,E),r=ge(P,D),n=ge(F,k),a=ge(X,pe),function(){for(var O=1,G=2,z=1;z<=15;z++){for(var L=O;L<G;L++)A[32767+L]=z,f[32767+L]=[],f[32767+L][1]=z,f[32767+L][0]=L;for(var Z=-(G-1);Z<=-O;Z++)A[32767+Z]=z,f[32767+Z]=[],f[32767+Z][1]=z,f[32767+Z][0]=G-1+Z;O<<=1,G<<=1}}(),function(){for(var O=0;O<256;O++)I[O]=19595*O,I[O+256|0]=38470*O,I[O+512|0]=7471*O+32768,I[O+768|0]=-11059*O,I[O+1024|0]=-21709*O,I[O+1280|0]=32768*O+8421375,I[O+1536|0]=-27439*O,I[O+1792|0]=-5329*O}(),Te(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Bd(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function SV(t){function e(E){if(!E)throw Error("assert :P")}function r(E,F,k){for(var P=0;4>P;P++)if(E[F+P]!=k.charCodeAt(P))return!0;return!1}function n(E,F,k,P,D){for(var X=0;X<D;X++)E[F+X]=k[P+X]}function a(E,F,k,P){for(var D=0;D<P;D++)E[F+D]=k}function s(E){return new Int32Array(E)}function o(E,F){for(var k=[],P=0;P<E;P++)k.push(new F);return k}function l(E,F){var k=[];return function P(D,X,pe){for(var ge=pe[X],fe=0;fe<ge&&(D.push(pe.length>X+1?[]:new F),!(pe.length<X+1));fe++)P(D[fe],X+1,pe)}(k,0,E),k}var c=function(){var E=this;function F(N,B){for(var W=1<<B-1>>>0;N&W;)W>>>=1;return W?(N&W-1)+W:N}function k(N,B,W,ce,Ee){e(!(ce%W));do N[B+(ce-=W)]=Ee;while(0<ce)}function P(N,B,W,ce,Ee){if(e(2328>=Ee),512>=Ee)var Re=s(512);else if((Re=s(Ee))==null)return 0;return function(Ue,Ge,Ye,lt,jt,$t){var ct,Bt,Ut=Ge,rr=1<<Ye,Ht=s(16),ir=s(16);for(e(jt!=0),e(lt!=null),e(Ue!=null),e(0<Ye),Bt=0;Bt<jt;++Bt){if(15<lt[Bt])return 0;++Ht[lt[Bt]]}if(Ht[0]==jt)return 0;for(ir[1]=0,ct=1;15>ct;++ct){if(Ht[ct]>1<<ct)return 0;ir[ct+1]=ir[ct]+Ht[ct]}for(Bt=0;Bt<jt;++Bt)ct=lt[Bt],0<lt[Bt]&&($t[ir[ct]++]=Bt);if(ir[15]==1)return(lt=new D).g=0,lt.value=$t[0],k(Ue,Ut,1,rr,lt),rr;var or,gr=-1,hr=rr-1,Zr=0,Qr=1,Pn=1,qr=1<<Ye;for(Bt=0,ct=1,jt=2;ct<=Ye;++ct,jt<<=1){if(Qr+=Pn<<=1,0>(Pn-=Ht[ct]))return 0;for(;0<Ht[ct];--Ht[ct])(lt=new D).g=ct,lt.value=$t[Bt++],k(Ue,Ut+Zr,jt,qr,lt),Zr=F(Zr,ct)}for(ct=Ye+1,jt=2;15>=ct;++ct,jt<<=1){if(Qr+=Pn<<=1,0>(Pn-=Ht[ct]))return 0;for(;0<Ht[ct];--Ht[ct]){if(lt=new D,(Zr&hr)!=gr){for(Ut+=qr,or=1<<(gr=ct)-Ye;15>gr&&!(0>=(or-=Ht[gr]));)++gr,or<<=1;rr+=qr=1<<(or=gr-Ye),Ue[Ge+(gr=Zr&hr)].g=or+Ye,Ue[Ge+gr].value=Ut-Ge-gr}lt.g=ct-Ye,lt.value=$t[Bt++],k(Ue,Ut+(Zr>>Ye),jt,qr,lt),Zr=F(Zr,ct)}}return Qr!=2*ir[15]-1?0:rr}(N,B,W,ce,Ee,Re)}function D(){this.value=this.g=0}function X(){this.value=this.g=0}function pe(){this.G=o(5,D),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Om,X)}function ge(N,B,W,ce){e(N!=null),e(B!=null),e(2147483648>ce),N.Ca=254,N.I=0,N.b=-8,N.Ka=0,N.oa=B,N.pa=W,N.Jd=B,N.Yc=W+ce,N.Zc=4<=ce?W+ce-4+1:W,R(N)}function fe(N,B){for(var W=0;0<B--;)W|=ne(N,128)<<B;return W}function xe(N,B){var W=fe(N,B);return H(N)?-W:W}function ae(N,B,W,ce){var Ee,Re=0;for(e(N!=null),e(B!=null),e(4294967288>ce),N.Sb=ce,N.Ra=0,N.u=0,N.h=0,4<ce&&(ce=4),Ee=0;Ee<ce;++Ee)Re+=B[W+Ee]<<8*Ee;N.Ra=Re,N.bb=ce,N.oa=B,N.pa=W}function Se(N){for(;8<=N.u&&N.bb<N.Sb;)N.Ra>>>=8,N.Ra+=N.oa[N.pa+N.bb]<<RA-8>>>0,++N.bb,N.u-=8;L(N)&&(N.h=1,N.u=0)}function Te(N,B){if(e(0<=B),!N.h&&B<=Kc){var W=z(N)&Gc[B];return N.u+=B,Se(N),W}return N.h=1,N.u=0}function O(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function G(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function z(N){return N.Ra>>>(N.u&RA-1)>>>0}function L(N){return e(N.bb<=N.Sb),N.h||N.bb==N.Sb&&N.u>RA}function Z(N,B){N.u=B,N.h=L(N)}function ee(N){N.u>=ih&&(e(N.u>=ih),Se(N))}function R(N){e(N!=null&&N.oa!=null),N.pa<N.Zc?(N.I=(N.oa[N.pa++]|N.I<<8)>>>0,N.b+=8):(e(N!=null&&N.oa!=null),N.pa<N.Yc?(N.b+=8,N.I=N.oa[N.pa++]|N.I<<8):N.Ka?N.b=0:(N.I<<=8,N.b+=8,N.Ka=1))}function H(N){return fe(N,1)}function ne(N,B){var W=N.Ca;0>N.b&&R(N);var ce=N.b,Ee=W*B>>>8,Re=(N.I>>>ce>Ee)+0;for(Re?(W-=Ee,N.I-=Ee+1<<ce>>>0):W=Ee+1,ce=W,Ee=0;256<=ce;)Ee+=8,ce>>=8;return ce=7^Ee+MA[ce],N.b-=ce,N.Ca=(W<<ce)-1,Re}function ve(N,B,W){N[B+0]=W>>24&255,N[B+1]=W>>16&255,N[B+2]=W>>8&255,N[B+3]=255&W}function U(N,B){return N[B+0]|N[B+1]<<8}function He(N,B){return U(N,B)|N[B+2]<<16}function se(N,B){return U(N,B)|U(N,B+2)<<16}function re(N,B){var W=1<<B;return e(N!=null),e(0<B),N.X=s(W),N.X==null?0:(N.Mb=32-B,N.Xa=B,1)}function Pe(N,B){e(N!=null),e(B!=null),e(N.Xa==B.Xa),n(B.X,0,N.X,0,1<<B.Xa)}function ue(){this.X=[],this.Xa=this.Mb=0}function we(N,B,W,ce){e(W!=null),e(ce!=null);var Ee=W[0],Re=ce[0];return Ee==0&&(Ee=(N*Re+B/2)/B),Re==0&&(Re=(B*Ee+N/2)/N),0>=Ee||0>=Re?0:(W[0]=Ee,ce[0]=Re,1)}function Me(N,B){return N+(1<<B)-1>>>B}function ze(N,B){return((4278255360&N)+(4278255360&B)>>>0&4278255360)+((16711935&N)+(16711935&B)>>>0&16711935)>>>0}function yt(N,B){E[B]=function(W,ce,Ee,Re,Ue,Ge,Ye){var lt;for(lt=0;lt<Ue;++lt){var jt=E[N](Ge[Ye+lt-1],Ee,Re+lt);Ge[Ye+lt]=ze(W[ce+lt],jt)}}}function It(){this.ud=this.hd=this.jd=0}function Ke(N,B){return((4278124286&(N^B))>>>1)+(N&B)>>>0}function wt(N){return 0<=N&&256>N?N:0>N?0:255<N?255:void 0}function At(N,B){return wt(N+(N-B+.5>>1))}function bt(N,B,W){return Math.abs(B-W)-Math.abs(N-W)}function ke(N,B,W,ce,Ee,Re,Ue){for(ce=Re[Ue-1],W=0;W<Ee;++W)Re[Ue+W]=ce=ze(N[B+W],ce)}function Ne(N,B,W,ce,Ee){var Re;for(Re=0;Re<W;++Re){var Ue=N[B+Re],Ge=Ue>>8&255,Ye=16711935&(Ye=(Ye=16711935&Ue)+((Ge<<16)+Ge));ce[Ee+Re]=(4278255360&Ue)+Ye>>>0}}function Ve(N,B){B.jd=255&N,B.hd=N>>8&255,B.ud=N>>16&255}function he(N,B,W,ce,Ee,Re){var Ue;for(Ue=0;Ue<ce;++Ue){var Ge=B[W+Ue],Ye=Ge>>>8,lt=Ge,jt=255&(jt=(jt=Ge>>>16)+((N.jd<<24>>24)*(Ye<<24>>24)>>>5));lt=255&(lt=(lt+=(N.hd<<24>>24)*(Ye<<24>>24)>>>5)+((N.ud<<24>>24)*(jt<<24>>24)>>>5)),Ee[Re+Ue]=(4278255360&Ge)+(jt<<16)+lt}}function le(N,B,W,ce,Ee){E[B]=function(Re,Ue,Ge,Ye,lt,jt,$t,ct,Bt){for(Ye=$t;Ye<ct;++Ye)for($t=0;$t<Bt;++$t)lt[jt++]=Ee(Ge[ce(Re[Ue++])])},E[N]=function(Re,Ue,Ge,Ye,lt,jt,$t){var ct=8>>Re.b,Bt=Re.Ea,Ut=Re.K[0],rr=Re.w;if(8>ct)for(Re=(1<<Re.b)-1,rr=(1<<ct)-1;Ue<Ge;++Ue){var Ht,ir=0;for(Ht=0;Ht<Bt;++Ht)Ht&Re||(ir=ce(Ye[lt++])),jt[$t++]=Ee(Ut[ir&rr]),ir>>=ct}else E["VP8LMapColor"+W](Ye,lt,Ut,rr,jt,$t,Ue,Ge,Bt)}}function Be(N,B,W,ce,Ee){for(W=B+W;B<W;){var Re=N[B++];ce[Ee++]=Re>>16&255,ce[Ee++]=Re>>8&255,ce[Ee++]=255&Re}}function je(N,B,W,ce,Ee){for(W=B+W;B<W;){var Re=N[B++];ce[Ee++]=Re>>16&255,ce[Ee++]=Re>>8&255,ce[Ee++]=255&Re,ce[Ee++]=Re>>24&255}}function Ae(N,B,W,ce,Ee){for(W=B+W;B<W;){var Re=(Ue=N[B++])>>16&240|Ue>>12&15,Ue=240&Ue|Ue>>28&15;ce[Ee++]=Re,ce[Ee++]=Ue}}function Qe(N,B,W,ce,Ee){for(W=B+W;B<W;){var Re=(Ue=N[B++])>>16&248|Ue>>13&7,Ue=Ue>>5&224|Ue>>3&31;ce[Ee++]=Re,ce[Ee++]=Ue}}function Ct(N,B,W,ce,Ee){for(W=B+W;B<W;){var Re=N[B++];ce[Ee++]=255&Re,ce[Ee++]=Re>>8&255,ce[Ee++]=Re>>16&255}}function pt(N,B,W,ce,Ee,Re){if(Re==0)for(W=B+W;B<W;)ve(ce,((Re=N[B++])[0]>>24|Re[1]>>8&65280|Re[2]<<8&16711680|Re[3]<<24)>>>0),Ee+=32;else n(ce,Ee,N,B,W)}function me(N,B){E[B][0]=E[N+"0"],E[B][1]=E[N+"1"],E[B][2]=E[N+"2"],E[B][3]=E[N+"3"],E[B][4]=E[N+"4"],E[B][5]=E[N+"5"],E[B][6]=E[N+"6"],E[B][7]=E[N+"7"],E[B][8]=E[N+"8"],E[B][9]=E[N+"9"],E[B][10]=E[N+"10"],E[B][11]=E[N+"11"],E[B][12]=E[N+"12"],E[B][13]=E[N+"13"],E[B][14]=E[N+"0"],E[B][15]=E[N+"0"]}function te(N){return N==g4||N==x4||N==mN||N==v4}function ie(){this.eb=[],this.size=this.A=this.fb=0}function $e(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function de(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ie,this.f.kb=new $e,this.sd=null}function Ce(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function nt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function vt(N){return alert("todo:WebPSamplerProcessPlane"),N.T}function ht(N,B){var W=N.T,ce=B.ba.f.RGBA,Ee=ce.eb,Re=ce.fb+N.ka*ce.A,Ue=Fu[B.ba.S],Ge=N.y,Ye=N.O,lt=N.f,jt=N.N,$t=N.ea,ct=N.W,Bt=B.cc,Ut=B.dc,rr=B.Mc,Ht=B.Nc,ir=N.ka,or=N.ka+N.T,gr=N.U,hr=gr+1>>1;for(ir==0?Ue(Ge,Ye,null,null,lt,jt,$t,ct,lt,jt,$t,ct,Ee,Re,null,null,gr):(Ue(B.ec,B.fc,Ge,Ye,Bt,Ut,rr,Ht,lt,jt,$t,ct,Ee,Re-ce.A,Ee,Re,gr),++W);ir+2<or;ir+=2)Bt=lt,Ut=jt,rr=$t,Ht=ct,jt+=N.Rc,ct+=N.Rc,Re+=2*ce.A,Ue(Ge,(Ye+=2*N.fa)-N.fa,Ge,Ye,Bt,Ut,rr,Ht,lt,jt,$t,ct,Ee,Re-ce.A,Ee,Re,gr);return Ye+=N.fa,N.j+or<N.o?(n(B.ec,B.fc,Ge,Ye,gr),n(B.cc,B.dc,lt,jt,hr),n(B.Mc,B.Nc,$t,ct,hr),W--):1&or||Ue(Ge,Ye,null,null,lt,jt,$t,ct,lt,jt,$t,ct,Ee,Re+ce.A,null,null,gr),W}function xt(N,B,W){var ce=N.F,Ee=[N.J];if(ce!=null){var Re=N.U,Ue=B.ba.S,Ge=Ue==AN||Ue==mN;B=B.ba.f.RGBA;var Ye=[0],lt=N.ka;Ye[0]=N.T,N.Kb&&(lt==0?--Ye[0]:(--lt,Ee[0]-=N.width),N.j+N.ka+N.T==N.o&&(Ye[0]=N.o-N.j-lt));var jt=B.eb;lt=B.fb+lt*B.A,N=FM(ce,Ee[0],N.width,Re,Ye,jt,lt+(Ge?0:3),B.A),e(W==Ye),N&&te(Ue)&&F1(jt,lt,Ge,Re,Ye,B.A)}return 0}function Xe(N){var B=N.ma,W=B.ba.S,ce=11>W,Ee=W==fN||W==hN||W==AN||W==p4||W==12||te(W);if(B.memory=null,B.Ib=null,B.Jb=null,B.Nd=null,!E1(B.Oa,N,Ee?11:12))return 0;if(Ee&&te(W)&&Bu(),N.da)alert("todo:use_scaling");else{if(ce){if(B.Ib=vt,N.Kb){if(W=N.U+1>>1,B.memory=s(N.U+2*W),B.memory==null)return 0;B.ec=B.memory,B.fc=0,B.cc=B.ec,B.dc=B.fc+N.U,B.Mc=B.cc,B.Nc=B.dc+W,B.Ib=ht,Bu()}}else alert("todo:EmitYUV");Ee&&(B.Jb=xt,ce&&vc())}if(ce&&!XM){for(N=0;256>N;++N)cde[N]=89858*(N-128)+gN>>pN,fde[N]=-22014*(N-128)+gN,dde[N]=-45773*(N-128),ude[N]=113618*(N-128)+gN>>pN;for(N=D1;N<w4;++N)B=76283*(N-16)+gN>>pN,hde[N-D1]=Je(B,255),Ade[N-D1]=Je(B+8>>4,15);XM=1}return 1}function be(N){var B=N.ma,W=N.U,ce=N.T;return e(!(1&N.ka)),0>=W||0>=ce?0:(W=B.Ib(N,B),B.Jb!=null&&B.Jb(N,B,W),B.Dc+=W,1)}function st(N){N.ma.memory=null}function K(N,B,W,ce){return Te(N,8)!=47?0:(B[0]=Te(N,14)+1,W[0]=Te(N,14)+1,ce[0]=Te(N,1),Te(N,3)!=0?0:!N.h)}function Ie(N,B){if(4>N)return N+1;var W=N-2>>1;return(2+(1&N)<<W)+Te(B,W)+1}function Ze(N,B){return 120<B?B-120:1<=(W=((W=Wue[B-1])>>4)*N+(8-(15&W)))?W:1;var W}function at(N,B,W){var ce=z(W),Ee=N[B+=255&ce].g-8;return 0<Ee&&(Z(W,W.u+8),ce=z(W),B+=N[B].value,B+=ce&(1<<Ee)-1),Z(W,W.u+N[B].g),N[B].value}function it(N,B,W){return W.g+=N.g,W.value+=N.value<<B>>>0,e(8>=W.g),N.g}function T(N,B,W){var ce=N.xc;return e((B=ce==0?0:N.vc[N.md*(W>>ce)+(B>>ce)])<N.Wb),N.Ya[B]}function M(N,B,W,ce){var Ee=N.ab,Re=N.c*B,Ue=N.C;B=Ue+B;var Ge=W,Ye=ce;for(ce=N.Ta,W=N.Ua;0<Ee--;){var lt=N.gc[Ee],jt=Ue,$t=B,ct=Ge,Bt=Ye,Ut=(Ye=ce,Ge=W,lt.Ea);switch(e(jt<$t),e($t<=lt.nc),lt.hc){case 2:Ai(ct,Bt,($t-jt)*Ut,Ye,Ge);break;case 0:var rr=jt,Ht=$t,ir=Ye,or=Ge,gr=(qr=lt).Ea;rr==0&&(I1(ct,Bt,null,null,1,ir,or),ke(ct,Bt+1,0,0,gr-1,ir,or+1),Bt+=gr,or+=gr,++rr);for(var hr=1<<qr.b,Zr=hr-1,Qr=Me(gr,qr.b),Pn=qr.K,qr=qr.w+(rr>>qr.b)*Qr;rr<Ht;){var Zn=Pn,zi=qr,Bn=1;for(Ug(ct,Bt,ir,or-gr,1,ir,or);Bn<gr;){var zr=(Bn&~Zr)+hr;zr>gr&&(zr=gr),(0,P1[Zn[zi++]>>8&15])(ct,Bt+ +Bn,ir,or+Bn-gr,zr-Bn,ir,or+Bn),Bn=zr}Bt+=gr,or+=gr,++rr&Zr||(qr+=Qr)}$t!=lt.nc&&n(Ye,Ge-Ut,Ye,Ge+($t-jt-1)*Ut,Ut);break;case 1:for(Ut=ct,Ht=Bt,gr=(ct=lt.Ea)-(or=ct&~(ir=(Bt=1<<lt.b)-1)),rr=Me(ct,lt.b),hr=lt.K,lt=lt.w+(jt>>lt.b)*rr;jt<$t;){for(Zr=hr,Qr=lt,Pn=new It,qr=Ht+or,Zn=Ht+ct;Ht<qr;)Ve(Zr[Qr++],Pn),B1(Pn,Ut,Ht,Bt,Ye,Ge),Ht+=Bt,Ge+=Bt;Ht<Zn&&(Ve(Zr[Qr++],Pn),B1(Pn,Ut,Ht,gr,Ye,Ge),Ht+=gr,Ge+=gr),++jt&ir||(lt+=rr)}break;case 3:if(ct==Ye&&Bt==Ge&&0<lt.b){for(Ht=Ye,ct=Ut=Ge+($t-jt)*Ut-(or=($t-jt)*Me(lt.Ea,lt.b)),Bt=Ye,ir=Ge,rr=[],or=(gr=or)-1;0<=or;--or)rr[or]=Bt[ir+or];for(or=gr-1;0<=or;--or)Ht[ct+or]=rr[or];lN(lt,jt,$t,Ye,Ut,Ye,Ge)}else lN(lt,jt,$t,ct,Bt,Ye,Ge)}Ge=ce,Ye=W}Ye!=W&&n(ce,W,Ge,Ye,Re)}function V(N,B){var W=N.V,ce=N.Ba+N.c*N.C,Ee=B-N.C;if(e(B<=N.l.o),e(16>=Ee),0<Ee){var Re=N.l,Ue=N.Ta,Ge=N.Ua,Ye=Re.width;if(M(N,Ee,W,ce),Ee=Ge=[Ge],e((W=N.C)<(ce=B)),e(Re.v<Re.va),ce>Re.o&&(ce=Re.o),W<Re.j){var lt=Re.j-W;W=Re.j,Ee[0]+=lt*Ye}if(W>=ce?W=0:(Ee[0]+=4*Re.v,Re.ka=W-Re.j,Re.U=Re.va-Re.v,Re.T=ce-W,W=1),W){if(Ge=Ge[0],11>(W=N.ca).S){var jt=W.f.RGBA,$t=(ce=W.S,Ee=Re.U,Re=Re.T,lt=jt.eb,jt.A),ct=Re;for(jt=jt.fb+N.Ma*jt.A;0<ct--;){var Bt=Ue,Ut=Ge,rr=Ee,Ht=lt,ir=jt;switch(ce){case dN:T1(Bt,Ut,rr,Ht,ir);break;case fN:LA(Bt,Ut,rr,Ht,ir);break;case g4:LA(Bt,Ut,rr,Ht,ir),F1(Ht,ir,0,rr,1,0);break;case QM:Dm(Bt,Ut,rr,Ht,ir);break;case hN:pt(Bt,Ut,rr,Ht,ir,1);break;case x4:pt(Bt,Ut,rr,Ht,ir,1),F1(Ht,ir,0,rr,1,0);break;case AN:pt(Bt,Ut,rr,Ht,ir,0);break;case mN:pt(Bt,Ut,rr,Ht,ir,0),F1(Ht,ir,1,rr,1,0);break;case p4:UA(Bt,Ut,rr,Ht,ir);break;case v4:UA(Bt,Ut,rr,Ht,ir),kM(Ht,ir,rr,1,0);break;case VM:QA(Bt,Ut,rr,Ht,ir);break;default:e(0)}Ge+=Ye,jt+=$t}N.Ma+=Re}else alert("todo:EmitRescaledRowsYUVA");e(N.Ma<=W.height)}}N.C=B,e(N.C<=N.i)}function q(N){var B;if(0<N.ua)return 0;for(B=0;B<N.Wb;++B){var W=N.Ya[B].G,ce=N.Ya[B].H;if(0<W[1][ce[1]+0].g||0<W[2][ce[2]+0].g||0<W[3][ce[3]+0].g)return 0}return 1}function Y(N,B,W,ce,Ee,Re){if(N.Z!=0){var Ue=N.qd,Ge=N.rd;for(e($A[N.Z]!=null);B<W;++B)$A[N.Z](Ue,Ge,ce,Ee,ce,Ee,Re),Ue=ce,Ge=Ee,Ee+=Re;N.qd=Ue,N.rd=Ge}}function oe(N,B){var W=N.l.ma,ce=W.Z==0||W.Z==1?N.l.j:N.C;if(ce=N.C<ce?ce:N.C,e(B<=N.l.o),B>ce){var Ee=N.l.width,Re=W.ca,Ue=W.tb+Ee*ce,Ge=N.V,Ye=N.Ba+N.c*ce,lt=N.gc;e(N.ab==1),e(lt[0].hc==3),xf(lt[0],ce,B,Ge,Ye,Re,Ue),Y(W,ce,B,Re,Ue,Ee)}N.C=N.Ma=B}function De(N,B,W,ce,Ee,Re,Ue){var Ge=N.$/ce,Ye=N.$%ce,lt=N.m,jt=N.s,$t=W+N.$,ct=$t;Ee=W+ce*Ee;var Bt=W+ce*Re,Ut=280+jt.ua,rr=N.Pb?Ge:16777216,Ht=0<jt.ua?jt.Wa:null,ir=jt.wc,or=$t<Bt?T(jt,Ye,Ge):null;e(N.C<Re),e(Bt<=Ee);var gr=!1;e:for(;;){for(;gr||$t<Bt;){var hr=0;if(Ge>=rr){var Zr=$t-W;e((rr=N).Pb),rr.wd=rr.m,rr.xd=Zr,0<rr.s.ua&&Pe(rr.s.Wa,rr.s.vb),rr=Ge+Yue}if(Ye&ir||(or=T(jt,Ye,Ge)),e(or!=null),or.Qb&&(B[$t]=or.qb,gr=!0),!gr)if(ee(lt),or.jc){hr=lt,Zr=B;var Qr=$t,Pn=or.pd[z(hr)&Om-1];e(or.jc),256>Pn.g?(Z(hr,hr.u+Pn.g),Zr[Qr]=Pn.value,hr=0):(Z(hr,hr.u+Pn.g-256),e(256<=Pn.value),hr=Pn.value),hr==0&&(gr=!0)}else hr=at(or.G[0],or.H[0],lt);if(lt.h)break;if(gr||256>hr){if(!gr)if(or.nd)B[$t]=(or.qb|hr<<8)>>>0;else{if(ee(lt),gr=at(or.G[1],or.H[1],lt),ee(lt),Zr=at(or.G[2],or.H[2],lt),Qr=at(or.G[3],or.H[3],lt),lt.h)break;B[$t]=(Qr<<24|gr<<16|hr<<8|Zr)>>>0}if(gr=!1,++$t,++Ye>=ce&&(Ye=0,++Ge,Ue!=null&&Ge<=Re&&!(Ge%16)&&Ue(N,Ge),Ht!=null))for(;ct<$t;)hr=B[ct++],Ht.X[(506832829*hr&4294967295)>>>Ht.Mb]=hr}else if(280>hr){if(hr=Ie(hr-256,lt),Zr=at(or.G[4],or.H[4],lt),ee(lt),Zr=Ze(ce,Zr=Ie(Zr,lt)),lt.h)break;if($t-W<Zr||Ee-$t<hr)break e;for(Qr=0;Qr<hr;++Qr)B[$t+Qr]=B[$t+Qr-Zr];for($t+=hr,Ye+=hr;Ye>=ce;)Ye-=ce,++Ge,Ue!=null&&Ge<=Re&&!(Ge%16)&&Ue(N,Ge);if(e($t<=Ee),Ye&ir&&(or=T(jt,Ye,Ge)),Ht!=null)for(;ct<$t;)hr=B[ct++],Ht.X[(506832829*hr&4294967295)>>>Ht.Mb]=hr}else{if(!(hr<Ut))break e;for(gr=hr-280,e(Ht!=null);ct<$t;)hr=B[ct++],Ht.X[(506832829*hr&4294967295)>>>Ht.Mb]=hr;hr=$t,e(!(gr>>>(Zr=Ht).Xa)),B[hr]=Zr.X[gr],gr=!0}gr||e(lt.h==L(lt))}if(N.Pb&&lt.h&&$t<Ee)e(N.m.h),N.a=5,N.m=N.wd,N.$=N.xd,0<N.s.ua&&Pe(N.s.vb,N.s.Wa);else{if(lt.h)break e;Ue!=null&&Ue(N,Ge>Re?Re:Ge),N.a=0,N.$=$t-W}return 1}return N.a=3,0}function We(N){e(N!=null),N.vc=null,N.yc=null,N.Ya=null;var B=N.Wa;B!=null&&(B.X=null),N.vb=null,e(N!=null)}function dt(){var N=new un;return N==null?null:(N.a=0,N.xb=GM,me("Predictor","VP8LPredictors"),me("Predictor","VP8LPredictors_C"),me("PredictorAdd","VP8LPredictorsAdd"),me("PredictorAdd","VP8LPredictorsAdd_C"),Ai=Ne,B1=he,T1=Be,LA=je,UA=Ae,QA=Qe,Dm=Ct,E.VP8LMapColor32b=gf,E.VP8LMapColor8b=j1,N)}function Oe(N,B,W,ce,Ee){var Re=1,Ue=[N],Ge=[B],Ye=ce.m,lt=ce.s,jt=null,$t=0;e:for(;;){if(W)for(;Re&&Te(Ye,1);){var ct=Ue,Bt=Ge,Ut=ce,rr=1,Ht=Ut.m,ir=Ut.gc[Ut.ab],or=Te(Ht,2);if(Ut.Oc&1<<or)Re=0;else{switch(Ut.Oc|=1<<or,ir.hc=or,ir.Ea=ct[0],ir.nc=Bt[0],ir.K=[null],++Ut.ab,e(4>=Ut.ab),or){case 0:case 1:ir.b=Te(Ht,3)+2,rr=Oe(Me(ir.Ea,ir.b),Me(ir.nc,ir.b),0,Ut,ir.K),ir.K=ir.K[0];break;case 3:var gr,hr=Te(Ht,8)+1,Zr=16<hr?0:4<hr?1:2<hr?2:3;if(ct[0]=Me(ir.Ea,Zr),ir.b=Zr,gr=rr=Oe(hr,1,0,Ut,ir.K)){var Qr,Pn=hr,qr=ir,Zn=1<<(8>>qr.b),zi=s(Zn);if(zi==null)gr=0;else{var Bn=qr.K[0],zr=qr.w;for(zi[0]=qr.K[0][0],Qr=1;Qr<1*Pn;++Qr)zi[Qr]=ze(Bn[zr+Qr],zi[Qr-1]);for(;Qr<4*Zn;++Qr)zi[Qr]=0;qr.K[0]=null,qr.K[0]=zi,gr=1}}rr=gr;break;case 2:break;default:e(0)}Re=rr}}if(Ue=Ue[0],Ge=Ge[0],Re&&Te(Ye,1)&&!(Re=1<=($t=Te(Ye,4))&&11>=$t)){ce.a=3;break e}var jr;if(jr=Re)t:{var pi,_n,ea,ls=ce,$o=Ue,zl=Ge,ai=$t,pl=W,Wl=ls.m,Wi=ls.s,na=[null],Ea=1,si=0,Sa=Xue[ai];r:for(;;){if(pl&&Te(Wl,1)){var Go=Te(Wl,3)+2,Id=Me($o,Go),gi=Me(zl,Go),yc=Id*gi;if(!Oe(Id,gi,0,ls,na))break r;for(na=na[0],Wi.xc=Go,pi=0;pi<yc;++pi){var za=na[pi]>>8&65535;na[pi]=za,za>=Ea&&(Ea=za+1)}}if(Wl.h)break r;for(_n=0;5>_n;++_n){var Xi=HM[_n];!_n&&0<ai&&(Xi+=1<<ai),si<Xi&&(si=Xi)}var zc=o(Ea*Sa,D),Xl=Ea,Wc=o(Xl,pe);if(Wc==null)var Xc=null;else e(65536>=Xl),Xc=Wc;var bc=s(si);if(Xc==null||bc==null||zc==null){ls.a=1;break r}var Yc=zc;for(pi=ea=0;pi<Ea;++pi){var ts=Xc[pi],Jc=ts.G,jd=ts.H,Mm=0,ch=1,Ko=0;for(_n=0;5>_n;++_n){Xi=HM[_n],Jc[_n]=Yc,jd[_n]=ea,!_n&&0<ai&&(Xi+=1<<ai);a:{var vN,N4=Xi,yN=ls,R1=bc,gde=Yc,xde=ea,C4=0,GA=yN.m,vde=Te(GA,1);if(a(R1,0,0,N4),vde){var yde=Te(GA,1)+1,bde=Te(GA,1),ZM=Te(GA,bde==0?1:8);R1[ZM]=1,yde==2&&(R1[ZM=Te(GA,8)]=1);var bN=1}else{var eL=s(19),tL=Te(GA,4)+4;if(19<tL){yN.a=3;var wN=0;break a}for(vN=0;vN<tL;++vN)eL[zue[vN]]=Te(GA,3);var _4=void 0,M1=void 0,rL=yN,wde=eL,NN=N4,nL=R1,E4=0,KA=rL.m,aL=8,sL=o(128,D);n:for(;P(sL,0,7,wde,19);){if(Te(KA,1)){var Nde=2+2*Te(KA,3);if((_4=2+Te(KA,Nde))>NN)break n}else _4=NN;for(M1=0;M1<NN&&_4--;){ee(KA);var iL=sL[0+(127&z(KA))];Z(KA,KA.u+iL.g);var Vg=iL.value;if(16>Vg)nL[M1++]=Vg,Vg!=0&&(aL=Vg);else{var Cde=Vg==16,oL=Vg-16,_de=Kue[oL],lL=Te(KA,Gue[oL])+_de;if(M1+lL>NN)break n;for(var Ede=Cde?aL:0;0<lL--;)nL[M1++]=Ede}}E4=1;break n}E4||(rL.a=3),bN=E4}(bN=bN&&!GA.h)&&(C4=P(gde,xde,8,R1,N4)),bN&&C4!=0?wN=C4:(yN.a=3,wN=0)}if(wN==0)break r;if(ch&&que[_n]==1&&(ch=Yc[ea].g==0),Mm+=Yc[ea].g,ea+=wN,3>=_n){var L1,S4=bc[0];for(L1=1;L1<Xi;++L1)bc[L1]>S4&&(S4=bc[L1]);Ko+=S4}}if(ts.nd=ch,ts.Qb=0,ch&&(ts.qb=(Jc[3][jd[3]+0].value<<24|Jc[1][jd[1]+0].value<<16|Jc[2][jd[2]+0].value)>>>0,Mm==0&&256>Jc[0][jd[0]+0].value&&(ts.Qb=1,ts.qb+=Jc[0][jd[0]+0].value<<8)),ts.jc=!ts.Qb&&6>Ko,ts.jc){var CN,uh=ts;for(CN=0;CN<Om;++CN){var qA=CN,zA=uh.pd[qA],_N=uh.G[0][uh.H[0]+qA];256<=_N.value?(zA.g=_N.g+256,zA.value=_N.value):(zA.g=0,zA.value=0,qA>>=it(_N,8,zA),qA>>=it(uh.G[1][uh.H[1]+qA],16,zA),qA>>=it(uh.G[2][uh.H[2]+qA],0,zA),it(uh.G[3][uh.H[3]+qA],24,zA))}}}Wi.vc=na,Wi.Wb=Ea,Wi.Ya=Xc,Wi.yc=zc,jr=1;break t}jr=0}if(!(Re=jr)){ce.a=3;break e}if(0<$t){if(lt.ua=1<<$t,!re(lt.Wa,$t)){ce.a=1,Re=0;break e}}else lt.ua=0;var I4=ce,cL=Ue,Sde=Ge,j4=I4.s,P4=j4.xc;if(I4.c=cL,I4.i=Sde,j4.md=Me(cL,P4),j4.wc=P4==0?-1:(1<<P4)-1,W){ce.xb=ade;break e}if((jt=s(Ue*Ge))==null){ce.a=1,Re=0;break e}Re=(Re=De(ce,jt,0,Ue,Ge,Ge,null))&&!Ye.h;break e}return Re?(Ee!=null?Ee[0]=jt:(e(jt==null),e(W)),ce.$=0,W||We(lt)):We(lt),Re}function et(N,B){var W=N.c*N.i,ce=W+B+16*B;return e(N.c<=B),N.V=s(ce),N.V==null?(N.Ta=null,N.Ua=0,N.a=1,0):(N.Ta=N.V,N.Ua=N.Ba+W+B,1)}function mt(N,B){var W=N.C,ce=B-W,Ee=N.V,Re=N.Ba+N.c*W;for(e(B<=N.l.o);0<ce;){var Ue=16<ce?16:ce,Ge=N.l.ma,Ye=N.l.width,lt=Ye*Ue,jt=Ge.ca,$t=Ge.tb+Ye*W,ct=N.Ta,Bt=N.Ua;M(N,Ue,Ee,Re),OM(ct,Bt,jt,$t,lt),Y(Ge,W,W+Ue,jt,$t,Ye),ce-=Ue,Ee+=Ue*N.c,W+=Ue}e(W==B),N.C=N.Ma=B}function Tt(){this.ub=this.yd=this.td=this.Rb=0}function Pt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ft(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Xt(){this.Yb=function(){var N=[];return function B(W,ce,Ee){for(var Re=Ee[ce],Ue=0;Ue<Re&&(W.push(Ee.length>ce+1?[]:0),!(Ee.length<ce+1));Ue++)B(W[Ue],ce+1,Ee)}(N,0,[3,11]),N}()}function mr(){this.jb=s(3),this.Wc=l([4,8],Xt),this.Xc=l([4,17],Xt)}function Yr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Br(){this.ld=this.La=this.dd=this.tc=0}function Fr(){this.Na=this.la=0}function vn(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ln(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function yn(){this.uc=this.M=this.Nb=0,this.wa=Array(new Br),this.Y=0,this.ya=Array(new Ln),this.aa=0,this.l=new Ot}function In(){this.y=s(16),this.f=s(8),this.ea=s(8)}function Ua(){this.cb=this.a=0,this.sc="",this.m=new O,this.Od=new Tt,this.Kc=new Pt,this.ed=new Yr,this.Qa=new Ft,this.Ic=this.$c=this.Aa=0,this.D=new yn,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,O),this.ia=0,this.pb=o(4,vn),this.Pa=new mr,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new In),this.Hd=0,this.rb=Array(new Fr),this.sb=0,this.wa=Array(new Br),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ln),this.L=this.aa=0,this.gd=l([4,2],Br),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Je(N,B){return 0>N?0:N>B?B:N}function Ot(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Kt(){var N=new Ua;return N!=null&&(N.a=0,N.sc="OK",N.cb=0,N.Xb=0,O1||(O1=lr)),N}function ar(N,B,W){return N.a==0&&(N.a=B,N.sc=W,N.cb=0),0}function Ar(N,B,W){return 3<=W&&N[B+0]==157&&N[B+1]==1&&N[B+2]==42}function ft(N,B){if(N==null)return 0;if(N.a=0,N.sc="OK",B==null)return ar(N,2,"null VP8Io passed to VP8GetHeaders()");var W=B.data,ce=B.w,Ee=B.ha;if(4>Ee)return ar(N,7,"Truncated header.");var Re=W[ce+0]|W[ce+1]<<8|W[ce+2]<<16,Ue=N.Od;if(Ue.Rb=!(1&Re),Ue.td=Re>>1&7,Ue.yd=Re>>4&1,Ue.ub=Re>>5,3<Ue.td)return ar(N,3,"Incorrect keyframe parameters.");if(!Ue.yd)return ar(N,4,"Frame not displayable.");ce+=3,Ee-=3;var Ge=N.Kc;if(Ue.Rb){if(7>Ee)return ar(N,7,"cannot parse picture header");if(!Ar(W,ce,Ee))return ar(N,3,"Bad code word");Ge.c=16383&(W[ce+4]<<8|W[ce+3]),Ge.Td=W[ce+4]>>6,Ge.i=16383&(W[ce+6]<<8|W[ce+5]),Ge.Ud=W[ce+6]>>6,ce+=7,Ee-=7,N.za=Ge.c+15>>4,N.Ub=Ge.i+15>>4,B.width=Ge.c,B.height=Ge.i,B.Da=0,B.j=0,B.v=0,B.va=B.width,B.o=B.height,B.da=0,B.ib=B.width,B.hb=B.height,B.U=B.width,B.T=B.height,a((Re=N.Pa).jb,0,255,Re.jb.length),e((Re=N.Qa)!=null),Re.Cb=0,Re.Bb=0,Re.Fb=1,a(Re.Zb,0,0,Re.Zb.length),a(Re.Lb,0,0,Re.Lb)}if(Ue.ub>Ee)return ar(N,7,"bad partition length");ge(Re=N.m,W,ce,Ue.ub),ce+=Ue.ub,Ee-=Ue.ub,Ue.Rb&&(Ge.Ld=H(Re),Ge.Kd=H(Re)),Ge=N.Qa;var Ye,lt=N.Pa;if(e(Re!=null),e(Ge!=null),Ge.Cb=H(Re),Ge.Cb){if(Ge.Bb=H(Re),H(Re)){for(Ge.Fb=H(Re),Ye=0;4>Ye;++Ye)Ge.Zb[Ye]=H(Re)?xe(Re,7):0;for(Ye=0;4>Ye;++Ye)Ge.Lb[Ye]=H(Re)?xe(Re,6):0}if(Ge.Bb)for(Ye=0;3>Ye;++Ye)lt.jb[Ye]=H(Re)?fe(Re,8):255}else Ge.Bb=0;if(Re.Ka)return ar(N,3,"cannot parse segment header");if((Ge=N.ed).zd=H(Re),Ge.Tb=fe(Re,6),Ge.wb=fe(Re,3),Ge.Pc=H(Re),Ge.Pc&&H(Re)){for(lt=0;4>lt;++lt)H(Re)&&(Ge.vd[lt]=xe(Re,6));for(lt=0;4>lt;++lt)H(Re)&&(Ge.od[lt]=xe(Re,6))}if(N.L=Ge.Tb==0?0:Ge.zd?1:2,Re.Ka)return ar(N,3,"cannot parse filter header");var jt=Ee;if(Ee=Ye=ce,ce=Ye+jt,Ge=jt,N.Xb=(1<<fe(N.m,2))-1,jt<3*(lt=N.Xb))W=7;else{for(Ye+=3*lt,Ge-=3*lt,jt=0;jt<lt;++jt){var $t=W[Ee+0]|W[Ee+1]<<8|W[Ee+2]<<16;$t>Ge&&($t=Ge),ge(N.Jc[+jt],W,Ye,$t),Ye+=$t,Ge-=$t,Ee+=3}ge(N.Jc[+lt],W,Ye,Ge),W=Ye<ce?0:5}if(W!=0)return ar(N,W,"cannot parse partitions");for(W=fe(Ye=N.m,7),Ee=H(Ye)?xe(Ye,4):0,ce=H(Ye)?xe(Ye,4):0,Ge=H(Ye)?xe(Ye,4):0,lt=H(Ye)?xe(Ye,4):0,Ye=H(Ye)?xe(Ye,4):0,jt=N.Qa,$t=0;4>$t;++$t){if(jt.Cb){var ct=jt.Zb[$t];jt.Fb||(ct+=W)}else{if(0<$t){N.pb[$t]=N.pb[0];continue}ct=W}var Bt=N.pb[$t];Bt.Sc[0]=y4[Je(ct+Ee,127)],Bt.Sc[1]=b4[Je(ct+0,127)],Bt.Eb[0]=2*y4[Je(ct+ce,127)],Bt.Eb[1]=101581*b4[Je(ct+Ge,127)]>>16,8>Bt.Eb[1]&&(Bt.Eb[1]=8),Bt.Qc[0]=y4[Je(ct+lt,117)],Bt.Qc[1]=b4[Je(ct+Ye,127)],Bt.lc=ct+Ye}if(!Ue.Rb)return ar(N,4,"Not a key frame.");for(H(Re),Ue=N.Pa,W=0;4>W;++W){for(Ee=0;8>Ee;++Ee)for(ce=0;3>ce;++ce)for(Ge=0;11>Ge;++Ge)lt=ne(Re,rde[W][Ee][ce][Ge])?fe(Re,8):ede[W][Ee][ce][Ge],Ue.Wc[W][Ee].Yb[ce][Ge]=lt;for(Ee=0;17>Ee;++Ee)Ue.Xc[W][Ee]=Ue.Wc[W][nde[Ee]]}return N.kc=H(Re),N.kc&&(N.Bd=fe(Re,8)),N.cb=1}function lr(N,B,W,ce,Ee,Re,Ue){var Ge=B[Ee].Yb[W];for(W=0;16>Ee;++Ee){if(!ne(N,Ge[W+0]))return Ee;for(;!ne(N,Ge[W+1]);)if(Ge=B[++Ee].Yb[0],W=0,Ee==16)return 16;var Ye=B[Ee+1].Yb;if(ne(N,Ge[W+2])){var lt=N,jt=0;if(ne(lt,(ct=Ge)[($t=W)+3]))if(ne(lt,ct[$t+6])){for(Ge=0,$t=2*(jt=ne(lt,ct[$t+8]))+(ct=ne(lt,ct[$t+9+jt])),jt=0,ct=Jue[$t];ct[Ge];++Ge)jt+=jt+ne(lt,ct[Ge]);jt+=3+(8<<$t)}else ne(lt,ct[$t+7])?(jt=7+2*ne(lt,165),jt+=ne(lt,145)):jt=5+ne(lt,159);else jt=ne(lt,ct[$t+4])?3+ne(lt,ct[$t+5]):2;Ge=Ye[2]}else jt=1,Ge=Ye[1];Ye=Ue+Zue[Ee],0>(lt=N).b&&R(lt);var $t,ct=lt.b,Bt=($t=lt.Ca>>1)-(lt.I>>ct)>>31;--lt.b,lt.Ca+=Bt,lt.Ca|=1,lt.I-=($t+1&Bt)<<ct,Re[Ye]=((jt^Bt)-Bt)*ce[(0<Ee)+0]}return 16}function Le(N){var B=N.rb[N.sb-1];B.la=0,B.Na=0,a(N.zc,0,0,N.zc.length),N.ja=0}function tt(N,B,W,ce,Ee){Ee=N[B+W+32*ce]+(Ee>>3),N[B+W+32*ce]=-256&Ee?0>Ee?0:255:Ee}function Nt(N,B,W,ce,Ee,Re){tt(N,B,0,W,ce+Ee),tt(N,B,1,W,ce+Re),tt(N,B,2,W,ce-Re),tt(N,B,3,W,ce-Ee)}function Et(N){return(20091*N>>16)+N}function gt(N,B,W,ce){var Ee,Re=0,Ue=s(16);for(Ee=0;4>Ee;++Ee){var Ge=N[B+0]+N[B+8],Ye=N[B+0]-N[B+8],lt=(35468*N[B+4]>>16)-Et(N[B+12]),jt=Et(N[B+4])+(35468*N[B+12]>>16);Ue[Re+0]=Ge+jt,Ue[Re+1]=Ye+lt,Ue[Re+2]=Ye-lt,Ue[Re+3]=Ge-jt,Re+=4,B++}for(Ee=Re=0;4>Ee;++Ee)Ge=(N=Ue[Re+0]+4)+Ue[Re+8],Ye=N-Ue[Re+8],lt=(35468*Ue[Re+4]>>16)-Et(Ue[Re+12]),tt(W,ce,0,0,Ge+(jt=Et(Ue[Re+4])+(35468*Ue[Re+12]>>16))),tt(W,ce,1,0,Ye+lt),tt(W,ce,2,0,Ye-lt),tt(W,ce,3,0,Ge-jt),Re++,ce+=32}function ut(N,B,W,ce){var Ee=N[B+0]+4,Re=35468*N[B+4]>>16,Ue=Et(N[B+4]),Ge=35468*N[B+1]>>16;Nt(W,ce,0,Ee+Ue,N=Et(N[B+1]),Ge),Nt(W,ce,1,Ee+Re,N,Ge),Nt(W,ce,2,Ee-Re,N,Ge),Nt(W,ce,3,Ee-Ue,N,Ge)}function Mt(N,B,W,ce,Ee){gt(N,B,W,ce),Ee&&gt(N,B+16,W,ce+4)}function Rt(N,B,W,ce){Rm(N,B+0,W,ce,1),Rm(N,B+32,W,ce+128,1)}function Jt(N,B,W,ce){var Ee;for(N=N[B+0]+4,Ee=0;4>Ee;++Ee)for(B=0;4>B;++B)tt(W,ce,B,Ee,N)}function Lt(N,B,W,ce){N[B+0]&&ba(N,B+0,W,ce),N[B+16]&&ba(N,B+16,W,ce+4),N[B+32]&&ba(N,B+32,W,ce+128),N[B+48]&&ba(N,B+48,W,ce+128+4)}function Wt(N,B,W,ce){var Ee,Re=s(16);for(Ee=0;4>Ee;++Ee){var Ue=N[B+0+Ee]+N[B+12+Ee],Ge=N[B+4+Ee]+N[B+8+Ee],Ye=N[B+4+Ee]-N[B+8+Ee],lt=N[B+0+Ee]-N[B+12+Ee];Re[0+Ee]=Ue+Ge,Re[8+Ee]=Ue-Ge,Re[4+Ee]=lt+Ye,Re[12+Ee]=lt-Ye}for(Ee=0;4>Ee;++Ee)Ue=(N=Re[0+4*Ee]+3)+Re[3+4*Ee],Ge=Re[1+4*Ee]+Re[2+4*Ee],Ye=Re[1+4*Ee]-Re[2+4*Ee],lt=N-Re[3+4*Ee],W[ce+0]=Ue+Ge>>3,W[ce+16]=lt+Ye>>3,W[ce+32]=Ue-Ge>>3,W[ce+48]=lt-Ye>>3,ce+=64}function Tr(N,B,W){var ce,Ee=B-32,Re=qc,Ue=255-N[Ee-1];for(ce=0;ce<W;++ce){var Ge,Ye=Re,lt=Ue+N[B-1];for(Ge=0;Ge<W;++Ge)N[B+Ge]=Ye[lt+N[Ee+Ge]];B+=32}}function Ur(N,B){Tr(N,B,4)}function on(N,B){Tr(N,B,8)}function Nn(N,B){Tr(N,B,16)}function la(N,B){var W;for(W=0;16>W;++W)n(N,B+32*W,N,B-32,16)}function Kn(N,B){var W;for(W=16;0<W;--W)a(N,B,N[B-1],16),B+=32}function jn(N,B,W){var ce;for(ce=0;16>ce;++ce)a(B,W+32*ce,N,16)}function Un(N,B){var W,ce=16;for(W=0;16>W;++W)ce+=N[B-1+32*W]+N[B+W-32];jn(ce>>5,N,B)}function ti(N,B){var W,ce=8;for(W=0;16>W;++W)ce+=N[B-1+32*W];jn(ce>>4,N,B)}function Fs(N,B){var W,ce=8;for(W=0;16>W;++W)ce+=N[B+W-32];jn(ce>>4,N,B)}function $l(N,B){jn(128,N,B)}function $r(N,B,W){return N+2*B+W+2>>2}function Cd(N,B){var W,ce=B-32;for(ce=new Uint8Array([$r(N[ce-1],N[ce+0],N[ce+1]),$r(N[ce+0],N[ce+1],N[ce+2]),$r(N[ce+1],N[ce+2],N[ce+3]),$r(N[ce+2],N[ce+3],N[ce+4])]),W=0;4>W;++W)n(N,B+32*W,ce,0,ce.length)}function xc(N,B){var W=N[B-1],ce=N[B-1+32],Ee=N[B-1+64],Re=N[B-1+96];ve(N,B+0,16843009*$r(N[B-1-32],W,ce)),ve(N,B+32,16843009*$r(W,ce,Ee)),ve(N,B+64,16843009*$r(ce,Ee,Re)),ve(N,B+96,16843009*$r(Ee,Re,Re))}function Gl(N,B){var W,ce=4;for(W=0;4>W;++W)ce+=N[B+W-32]+N[B-1+32*W];for(ce>>=3,W=0;4>W;++W)a(N,B+32*W,ce,4)}function Os(N,B){var W=N[B-1+0],ce=N[B-1+32],Ee=N[B-1+64],Re=N[B-1-32],Ue=N[B+0-32],Ge=N[B+1-32],Ye=N[B+2-32],lt=N[B+3-32];N[B+0+96]=$r(ce,Ee,N[B-1+96]),N[B+1+96]=N[B+0+64]=$r(W,ce,Ee),N[B+2+96]=N[B+1+64]=N[B+0+32]=$r(Re,W,ce),N[B+3+96]=N[B+2+64]=N[B+1+32]=N[B+0+0]=$r(Ue,Re,W),N[B+3+64]=N[B+2+32]=N[B+1+0]=$r(Ge,Ue,Re),N[B+3+32]=N[B+2+0]=$r(Ye,Ge,Ue),N[B+3+0]=$r(lt,Ye,Ge)}function Ki(N,B){var W=N[B+1-32],ce=N[B+2-32],Ee=N[B+3-32],Re=N[B+4-32],Ue=N[B+5-32],Ge=N[B+6-32],Ye=N[B+7-32];N[B+0+0]=$r(N[B+0-32],W,ce),N[B+1+0]=N[B+0+32]=$r(W,ce,Ee),N[B+2+0]=N[B+1+32]=N[B+0+64]=$r(ce,Ee,Re),N[B+3+0]=N[B+2+32]=N[B+1+64]=N[B+0+96]=$r(Ee,Re,Ue),N[B+3+32]=N[B+2+64]=N[B+1+96]=$r(Re,Ue,Ge),N[B+3+64]=N[B+2+96]=$r(Ue,Ge,Ye),N[B+3+96]=$r(Ge,Ye,Ye)}function _1(N,B){var W=N[B-1+0],ce=N[B-1+32],Ee=N[B-1+64],Re=N[B-1-32],Ue=N[B+0-32],Ge=N[B+1-32],Ye=N[B+2-32],lt=N[B+3-32];N[B+0+0]=N[B+1+64]=Re+Ue+1>>1,N[B+1+0]=N[B+2+64]=Ue+Ge+1>>1,N[B+2+0]=N[B+3+64]=Ge+Ye+1>>1,N[B+3+0]=Ye+lt+1>>1,N[B+0+96]=$r(Ee,ce,W),N[B+0+64]=$r(ce,W,Re),N[B+0+32]=N[B+1+96]=$r(W,Re,Ue),N[B+1+32]=N[B+2+96]=$r(Re,Ue,Ge),N[B+2+32]=N[B+3+96]=$r(Ue,Ge,Ye),N[B+3+32]=$r(Ge,Ye,lt)}function TA(N,B){var W=N[B+0-32],ce=N[B+1-32],Ee=N[B+2-32],Re=N[B+3-32],Ue=N[B+4-32],Ge=N[B+5-32],Ye=N[B+6-32],lt=N[B+7-32];N[B+0+0]=W+ce+1>>1,N[B+1+0]=N[B+0+64]=ce+Ee+1>>1,N[B+2+0]=N[B+1+64]=Ee+Re+1>>1,N[B+3+0]=N[B+2+64]=Re+Ue+1>>1,N[B+0+32]=$r(W,ce,Ee),N[B+1+32]=N[B+0+96]=$r(ce,Ee,Re),N[B+2+32]=N[B+1+96]=$r(Ee,Re,Ue),N[B+3+32]=N[B+2+96]=$r(Re,Ue,Ge),N[B+3+64]=$r(Ue,Ge,Ye),N[B+3+96]=$r(Ge,Ye,lt)}function _d(N,B){var W=N[B-1+0],ce=N[B-1+32],Ee=N[B-1+64],Re=N[B-1+96];N[B+0+0]=W+ce+1>>1,N[B+2+0]=N[B+0+32]=ce+Ee+1>>1,N[B+2+32]=N[B+0+64]=Ee+Re+1>>1,N[B+1+0]=$r(W,ce,Ee),N[B+3+0]=N[B+1+32]=$r(ce,Ee,Re),N[B+3+32]=N[B+1+64]=$r(Ee,Re,Re),N[B+3+64]=N[B+2+64]=N[B+0+96]=N[B+1+96]=N[B+2+96]=N[B+3+96]=Re}function kA(N,B){var W=N[B-1+0],ce=N[B-1+32],Ee=N[B-1+64],Re=N[B-1+96],Ue=N[B-1-32],Ge=N[B+0-32],Ye=N[B+1-32],lt=N[B+2-32];N[B+0+0]=N[B+2+32]=W+Ue+1>>1,N[B+0+32]=N[B+2+64]=ce+W+1>>1,N[B+0+64]=N[B+2+96]=Ee+ce+1>>1,N[B+0+96]=Re+Ee+1>>1,N[B+3+0]=$r(Ge,Ye,lt),N[B+2+0]=$r(Ue,Ge,Ye),N[B+1+0]=N[B+3+32]=$r(W,Ue,Ge),N[B+1+32]=N[B+3+64]=$r(ce,W,Ue),N[B+1+64]=N[B+3+96]=$r(Ee,ce,W),N[B+1+96]=$r(Re,Ee,ce)}function Hc(N,B){var W;for(W=0;8>W;++W)n(N,B+32*W,N,B-32,8)}function ah(N,B){var W;for(W=0;8>W;++W)a(N,B,N[B-1],8),B+=32}function Eu(N,B,W){var ce;for(ce=0;8>ce;++ce)a(B,W+32*ce,N,8)}function Bm(N,B){var W,ce=8;for(W=0;8>W;++W)ce+=N[B+W-32]+N[B-1+32*W];Eu(ce>>4,N,B)}function Qa(N,B){var W,ce=4;for(W=0;8>W;++W)ce+=N[B+W-32];Eu(ce>>3,N,B)}function Tm(N,B){var W,ce=4;for(W=0;8>W;++W)ce+=N[B-1+32*W];Eu(ce>>3,N,B)}function Mg(N,B){Eu(128,N,B)}function Su(N,B,W){var ce=N[B-W],Ee=N[B+0],Re=3*(Ee-ce)+m4[1020+N[B-2*W]-N[B+W]],Ue=uN[112+(Re+4>>3)];N[B-W]=qc[255+ce+uN[112+(Re+3>>3)]],N[B+0]=qc[255+Ee-Ue]}function FA(N,B,W,ce){var Ee=N[B+0],Re=N[B+W];return ku[255+N[B-2*W]-N[B-W]]>ce||ku[255+Re-Ee]>ce}function sh(N,B,W,ce){return 4*ku[255+N[B-W]-N[B+0]]+ku[255+N[B-2*W]-N[B+W]]<=ce}function mf(N,B,W,ce,Ee){var Re=N[B-3*W],Ue=N[B-2*W],Ge=N[B-W],Ye=N[B+0],lt=N[B+W],jt=N[B+2*W],$t=N[B+3*W];return 4*ku[255+Ge-Ye]+ku[255+Ue-lt]>ce?0:ku[255+N[B-4*W]-Re]<=Ee&&ku[255+Re-Ue]<=Ee&&ku[255+Ue-Ge]<=Ee&&ku[255+$t-jt]<=Ee&&ku[255+jt-lt]<=Ee&&ku[255+lt-Ye]<=Ee}function pf(N,B,W,ce){var Ee=2*ce+1;for(ce=0;16>ce;++ce)sh(N,B+ce,W,Ee)&&Su(N,B+ce,W)}function Kl(N,B,W,ce){var Ee=2*ce+1;for(ce=0;16>ce;++ce)sh(N,B+ce*W,1,Ee)&&Su(N,B+ce*W,1)}function km(N,B,W,ce){var Ee;for(Ee=3;0<Ee;--Ee)pf(N,B+=4*W,W,ce)}function Lg(N,B,W,ce){var Ee;for(Ee=3;0<Ee;--Ee)Kl(N,B+=4,W,ce)}function ql(N,B,W,ce,Ee,Re,Ue,Ge){for(Re=2*Re+1;0<Ee--;){if(mf(N,B,W,Re,Ue))if(FA(N,B,W,Ge))Su(N,B,W);else{var Ye=N,lt=B,jt=W,$t=Ye[lt-2*jt],ct=Ye[lt-jt],Bt=Ye[lt+0],Ut=Ye[lt+jt],rr=Ye[lt+2*jt],Ht=27*(or=m4[1020+3*(Bt-ct)+m4[1020+$t-Ut]])+63>>7,ir=18*or+63>>7,or=9*or+63>>7;Ye[lt-3*jt]=qc[255+Ye[lt-3*jt]+or],Ye[lt-2*jt]=qc[255+$t+ir],Ye[lt-jt]=qc[255+ct+Ht],Ye[lt+0]=qc[255+Bt-Ht],Ye[lt+jt]=qc[255+Ut-ir],Ye[lt+2*jt]=qc[255+rr-or]}B+=ce}}function Iu(N,B,W,ce,Ee,Re,Ue,Ge){for(Re=2*Re+1;0<Ee--;){if(mf(N,B,W,Re,Ue))if(FA(N,B,W,Ge))Su(N,B,W);else{var Ye=N,lt=B,jt=W,$t=Ye[lt-jt],ct=Ye[lt+0],Bt=Ye[lt+jt],Ut=uN[112+(4+(rr=3*(ct-$t))>>3)],rr=uN[112+(rr+3>>3)],Ht=Ut+1>>1;Ye[lt-2*jt]=qc[255+Ye[lt-2*jt]+Ht],Ye[lt-jt]=qc[255+$t+rr],Ye[lt+0]=qc[255+ct-Ut],Ye[lt+jt]=qc[255+Bt-Ht]}B+=ce}}function OA(N,B,W,ce,Ee,Re){ql(N,B,W,1,16,ce,Ee,Re)}function ju(N,B,W,ce,Ee,Re){ql(N,B,1,W,16,ce,Ee,Re)}function Fm(N,B,W,ce,Ee,Re){var Ue;for(Ue=3;0<Ue;--Ue)Iu(N,B+=4*W,W,1,16,ce,Ee,Re)}function Q(N,B,W,ce,Ee,Re){var Ue;for(Ue=3;0<Ue;--Ue)Iu(N,B+=4,1,W,16,ce,Ee,Re)}function _e(N,B,W,ce,Ee,Re,Ue,Ge){ql(N,B,Ee,1,8,Re,Ue,Ge),ql(W,ce,Ee,1,8,Re,Ue,Ge)}function ot(N,B,W,ce,Ee,Re,Ue,Ge){ql(N,B,1,Ee,8,Re,Ue,Ge),ql(W,ce,1,Ee,8,Re,Ue,Ge)}function St(N,B,W,ce,Ee,Re,Ue,Ge){Iu(N,B+4*Ee,Ee,1,8,Re,Ue,Ge),Iu(W,ce+4*Ee,Ee,1,8,Re,Ue,Ge)}function kt(N,B,W,ce,Ee,Re,Ue,Ge){Iu(N,B+4,1,Ee,8,Re,Ue,Ge),Iu(W,ce+4,1,Ee,8,Re,Ue,Ge)}function sr(){this.ba=new de,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new nt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ur(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Dr(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Gr(){this.ua=0,this.Wa=new ue,this.vb=new ue,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new pe,this.yc=new D}function un(){this.xb=this.a=0,this.l=new Ot,this.ca=new de,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new G,this.Pb=0,this.wd=new G,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Gr,this.ab=0,this.gc=o(4,Dr),this.Oc=0}function bn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Ot,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function qn(N,B,W,ce,Ee,Re,Ue){for(N=N==null?0:N[B+0],B=0;B<Ue;++B)Ee[Re+B]=N+W[ce+B]&255,N=Ee[Re+B]}function ma(N,B,W,ce,Ee,Re,Ue){var Ge;if(N==null)qn(null,null,W,ce,Ee,Re,Ue);else for(Ge=0;Ge<Ue;++Ge)Ee[Re+Ge]=N[B+Ge]+W[ce+Ge]&255}function Ds(N,B,W,ce,Ee,Re,Ue){if(N==null)qn(null,null,W,ce,Ee,Re,Ue);else{var Ge,Ye=N[B+0],lt=Ye,jt=Ye;for(Ge=0;Ge<Ue;++Ge)lt=jt+(Ye=N[B+Ge])-lt,jt=W[ce+Ge]+(-256&lt?0>lt?0:255:lt)&255,lt=Ye,Ee[Re+Ge]=jt}}function _a(N,B,W,ce){var Ee=B.width,Re=B.o;if(e(N!=null&&B!=null),0>W||0>=ce||W+ce>Re)return null;if(!N.Cc){if(N.ga==null){var Ue;if(N.ga=new bn,(Ue=N.ga==null)||(Ue=B.width*B.o,e(N.Gb.length==0),N.Gb=s(Ue),N.Uc=0,N.Gb==null?Ue=0:(N.mb=N.Gb,N.nb=N.Uc,N.rc=null,Ue=1),Ue=!Ue),!Ue){Ue=N.ga;var Ge=N.Fa,Ye=N.P,lt=N.qc,jt=N.mb,$t=N.nb,ct=Ye+1,Bt=lt-1,Ut=Ue.l;if(e(Ge!=null&&jt!=null&&B!=null),$A[0]=null,$A[1]=qn,$A[2]=ma,$A[3]=Ds,Ue.ca=jt,Ue.tb=$t,Ue.c=B.width,Ue.i=B.height,e(0<Ue.c&&0<Ue.i),1>=lt)B=0;else if(Ue.$a=3&Ge[Ye+0],Ue.Z=Ge[Ye+0]>>2&3,Ue.Lc=Ge[Ye+0]>>4&3,Ye=Ge[Ye+0]>>6&3,0>Ue.$a||1<Ue.$a||4<=Ue.Z||1<Ue.Lc||Ye)B=0;else if(Ut.put=be,Ut.ac=Xe,Ut.bc=st,Ut.ma=Ue,Ut.width=B.width,Ut.height=B.height,Ut.Da=B.Da,Ut.v=B.v,Ut.va=B.va,Ut.j=B.j,Ut.o=B.o,Ue.$a)e:{e(Ue.$a==1),B=dt();t:for(;;){if(B==null){B=0;break e}if(e(Ue!=null),Ue.mc=B,B.c=Ue.c,B.i=Ue.i,B.l=Ue.l,B.l.ma=Ue,B.l.width=Ue.c,B.l.height=Ue.i,B.a=0,ae(B.m,Ge,ct,Bt),!Oe(Ue.c,Ue.i,1,B,null)||(B.ab==1&&B.gc[0].hc==3&&q(B.s)?(Ue.ic=1,Ge=B.c*B.i,B.Ta=null,B.Ua=0,B.V=s(Ge),B.Ba=0,B.V==null?(B.a=1,B=0):B=1):(Ue.ic=0,B=et(B,Ue.c)),!B))break t;B=1;break e}Ue.mc=null,B=0}else B=Bt>=Ue.c*Ue.i;Ue=!B}if(Ue)return null;N.ga.Lc!=1?N.Ga=0:ce=Re-W}e(N.ga!=null),e(W+ce<=Re);e:{if(B=(Ge=N.ga).c,Re=Ge.l.o,Ge.$a==0){if(ct=N.rc,Bt=N.Vc,Ut=N.Fa,Ye=N.P+1+W*B,lt=N.mb,jt=N.nb+W*B,e(Ye<=N.P+N.qc),Ge.Z!=0)for(e($A[Ge.Z]!=null),Ue=0;Ue<ce;++Ue)$A[Ge.Z](ct,Bt,Ut,Ye,lt,jt,B),ct=lt,Bt=jt,jt+=B,Ye+=B;else for(Ue=0;Ue<ce;++Ue)n(lt,jt,Ut,Ye,B),ct=lt,Bt=jt,jt+=B,Ye+=B;N.rc=ct,N.Vc=Bt}else{if(e(Ge.mc!=null),B=W+ce,e((Ue=Ge.mc)!=null),e(B<=Ue.i),Ue.C>=B)B=1;else if(Ge.ic||vc(),Ge.ic){Ge=Ue.V,ct=Ue.Ba,Bt=Ue.c;var rr=Ue.i,Ht=(Ut=1,Ye=Ue.$/Bt,lt=Ue.$%Bt,jt=Ue.m,$t=Ue.s,Ue.$),ir=Bt*rr,or=Bt*B,gr=$t.wc,hr=Ht<or?T($t,lt,Ye):null;e(Ht<=ir),e(B<=rr),e(q($t));t:for(;;){for(;!jt.h&&Ht<or;){if(lt&gr||(hr=T($t,lt,Ye)),e(hr!=null),ee(jt),256>(rr=at(hr.G[0],hr.H[0],jt)))Ge[ct+Ht]=rr,++Ht,++lt>=Bt&&(lt=0,++Ye<=B&&!(Ye%16)&&oe(Ue,Ye));else{if(!(280>rr)){Ut=0;break t}rr=Ie(rr-256,jt);var Zr,Qr=at(hr.G[4],hr.H[4],jt);if(ee(jt),!(Ht>=(Qr=Ze(Bt,Qr=Ie(Qr,jt)))&&ir-Ht>=rr)){Ut=0;break t}for(Zr=0;Zr<rr;++Zr)Ge[ct+Ht+Zr]=Ge[ct+Ht+Zr-Qr];for(Ht+=rr,lt+=rr;lt>=Bt;)lt-=Bt,++Ye<=B&&!(Ye%16)&&oe(Ue,Ye);Ht<or&&lt&gr&&(hr=T($t,lt,Ye))}e(jt.h==L(jt))}oe(Ue,Ye>B?B:Ye);break t}!Ut||jt.h&&Ht<ir?(Ut=0,Ue.a=jt.h?5:3):Ue.$=Ht,B=Ut}else B=De(Ue,Ue.V,Ue.Ba,Ue.c,Ue.i,B,mt);if(!B){ce=0;break e}}W+ce>=Re&&(N.Cc=1),ce=1}if(!ce)return null;if(N.Cc&&((ce=N.ga)!=null&&(ce.mc=null),N.ga=null,0<N.Ga))return alert("todo:WebPDequantizeLevels"),null}return N.nb+W*Ee}function ri(N,B,W,ce,Ee,Re){for(;0<Ee--;){var Ue,Ge=N,Ye=B+(W?1:0),lt=N,jt=B+(W?0:3);for(Ue=0;Ue<ce;++Ue){var $t=lt[jt+4*Ue];$t!=255&&($t*=32897,Ge[Ye+4*Ue+0]=Ge[Ye+4*Ue+0]*$t>>23,Ge[Ye+4*Ue+1]=Ge[Ye+4*Ue+1]*$t>>23,Ge[Ye+4*Ue+2]=Ge[Ye+4*Ue+2]*$t>>23)}B+=Re}}function Rs(N,B,W,ce,Ee){for(;0<ce--;){var Re;for(Re=0;Re<W;++Re){var Ue=N[B+2*Re+0],Ge=15&(lt=N[B+2*Re+1]),Ye=4369*Ge,lt=(240&lt|lt>>4)*Ye>>16;N[B+2*Re+0]=(240&Ue|Ue>>4)*Ye>>16&240|(15&Ue|Ue<<4)*Ye>>16>>4&15,N[B+2*Re+1]=240&lt|Ge}B+=Ee}}function ni(N,B,W,ce,Ee,Re,Ue,Ge){var Ye,lt,jt=255;for(lt=0;lt<Ee;++lt){for(Ye=0;Ye<ce;++Ye){var $t=N[B+Ye];Re[Ue+4*Ye]=$t,jt&=$t}B+=W,Ue+=Ge}return jt!=255}function Ms(N,B,W,ce,Ee){var Re;for(Re=0;Re<Ee;++Re)W[ce+Re]=N[B+Re]>>8}function vc(){F1=ri,kM=Rs,FM=ni,OM=Ms}function Pu(N,B,W){E[N]=function(ce,Ee,Re,Ue,Ge,Ye,lt,jt,$t,ct,Bt,Ut,rr,Ht,ir,or,gr){var hr,Zr=gr-1>>1,Qr=Ge[Ye+0]|lt[jt+0]<<16,Pn=$t[ct+0]|Bt[Ut+0]<<16;e(ce!=null);var qr=3*Qr+Pn+131074>>2;for(B(ce[Ee+0],255&qr,qr>>16,rr,Ht),Re!=null&&(qr=3*Pn+Qr+131074>>2,B(Re[Ue+0],255&qr,qr>>16,ir,or)),hr=1;hr<=Zr;++hr){var Zn=Ge[Ye+hr]|lt[jt+hr]<<16,zi=$t[ct+hr]|Bt[Ut+hr]<<16,Bn=Qr+Zn+Pn+zi+524296,zr=Bn+2*(Zn+Pn)>>3;qr=zr+Qr>>1,Qr=(Bn=Bn+2*(Qr+zi)>>3)+Zn>>1,B(ce[Ee+2*hr-1],255&qr,qr>>16,rr,Ht+(2*hr-1)*W),B(ce[Ee+2*hr-0],255&Qr,Qr>>16,rr,Ht+(2*hr-0)*W),Re!=null&&(qr=Bn+Pn>>1,Qr=zr+zi>>1,B(Re[Ue+2*hr-1],255&qr,qr>>16,ir,or+(2*hr-1)*W),B(Re[Ue+2*hr+0],255&Qr,Qr>>16,ir,or+(2*hr+0)*W)),Qr=Zn,Pn=zi}1&gr||(qr=3*Qr+Pn+131074>>2,B(ce[Ee+gr-1],255&qr,qr>>16,rr,Ht+(gr-1)*W),Re!=null&&(qr=3*Pn+Qr+131074>>2,B(Re[Ue+gr-1],255&qr,qr>>16,ir,or+(gr-1)*W)))}}function Bu(){Fu[dN]=sde,Fu[fN]=KM,Fu[QM]=ide,Fu[hN]=qM,Fu[AN]=zM,Fu[p4]=WM,Fu[VM]=ode,Fu[g4]=KM,Fu[x4]=qM,Fu[mN]=zM,Fu[v4]=WM}function C(N){return N&-16384?0>N?0:255:N>>lde}function J(N,B){return C((19077*N>>8)+(26149*B>>8)-14234)}function ye(N,B,W){return C((19077*N>>8)-(6419*B>>8)-(13320*W>>8)+8708)}function qe(N,B){return C((19077*N>>8)+(33050*B>>8)-17685)}function Dt(N,B,W,ce,Ee){ce[Ee+0]=J(N,W),ce[Ee+1]=ye(N,B,W),ce[Ee+2]=qe(N,B)}function zt(N,B,W,ce,Ee){ce[Ee+0]=qe(N,B),ce[Ee+1]=ye(N,B,W),ce[Ee+2]=J(N,W)}function br(N,B,W,ce,Ee){var Re=ye(N,B,W);B=Re<<3&224|qe(N,B)>>3,ce[Ee+0]=248&J(N,W)|Re>>5,ce[Ee+1]=B}function Jn(N,B,W,ce,Ee){var Re=240&qe(N,B)|15;ce[Ee+0]=240&J(N,W)|ye(N,B,W)>>4,ce[Ee+1]=Re}function Ls(N,B,W,ce,Ee){ce[Ee+0]=255,Dt(N,B,W,ce,Ee+1)}function Qn(N,B,W,ce,Ee){zt(N,B,W,ce,Ee),ce[Ee+3]=255}function ca(N,B,W,ce,Ee){Dt(N,B,W,ce,Ee),ce[Ee+3]=255}function es(N,B,W){E[N]=function(ce,Ee,Re,Ue,Ge,Ye,lt,jt,$t){for(var ct=jt+(-2&$t)*W;jt!=ct;)B(ce[Ee+0],Re[Ue+0],Ge[Ye+0],lt,jt),B(ce[Ee+1],Re[Ue+0],Ge[Ye+0],lt,jt+W),Ee+=2,++Ue,++Ye,jt+=2*W;1&$t&&B(ce[Ee+0],Re[Ue+0],Ge[Ye+0],lt,jt)}}function $c(N,B,W){return W==0?N==0?B==0?6:5:B==0?4:0:W}function ml(N,B,W,ce,Ee){switch(N>>>30){case 3:Rm(B,W,ce,Ee,0);break;case 2:Tu(B,W,ce,Ee);break;case 1:ba(B,W,ce,Ee)}}function Ho(N,B){var W,ce,Ee=B.M,Re=B.Nb,Ue=N.oc,Ge=N.pc+40,Ye=N.oc,lt=N.pc+584,jt=N.oc,$t=N.pc+600;for(W=0;16>W;++W)Ue[Ge+32*W-1]=129;for(W=0;8>W;++W)Ye[lt+32*W-1]=129,jt[$t+32*W-1]=129;for(0<Ee?Ue[Ge-1-32]=Ye[lt-1-32]=jt[$t-1-32]=129:(a(Ue,Ge-32-1,127,21),a(Ye,lt-32-1,127,9),a(jt,$t-32-1,127,9)),ce=0;ce<N.za;++ce){var ct=B.ya[B.aa+ce];if(0<ce){for(W=-1;16>W;++W)n(Ue,Ge+32*W-4,Ue,Ge+32*W+12,4);for(W=-1;8>W;++W)n(Ye,lt+32*W-4,Ye,lt+32*W+4,4),n(jt,$t+32*W-4,jt,$t+32*W+4,4)}var Bt=N.Gd,Ut=N.Hd+ce,rr=ct.ad,Ht=ct.Hc;if(0<Ee&&(n(Ue,Ge-32,Bt[Ut].y,0,16),n(Ye,lt-32,Bt[Ut].f,0,8),n(jt,$t-32,Bt[Ut].ea,0,8)),ct.Za){var ir=Ue,or=Ge-32+16;for(0<Ee&&(ce>=N.za-1?a(ir,or,Bt[Ut].y[15],4):n(ir,or,Bt[Ut+1].y,0,4)),W=0;4>W;W++)ir[or+128+W]=ir[or+256+W]=ir[or+384+W]=ir[or+0+W];for(W=0;16>W;++W,Ht<<=2)ir=Ue,or=Ge+YM[W],Sd[ct.Ob[W]](ir,or),ml(Ht,rr,16*+W,ir,or)}else if(ir=$c(ce,Ee,ct.Ob[0]),HA[ir](Ue,Ge),Ht!=0)for(W=0;16>W;++W,Ht<<=2)ml(Ht,rr,16*+W,Ue,Ge+YM[W]);for(W=ct.Gc,ir=$c(ce,Ee,ct.Dd),lh[ir](Ye,lt),lh[ir](jt,$t),Ht=rr,ir=Ye,or=lt,255&(ct=0|W)&&(170&ct?vf(Ht,256,ir,or):qa(Ht,256,ir,or)),ct=jt,Ht=$t,255&(W>>=8)&&(170&W?vf(rr,320,ct,Ht):qa(rr,320,ct,Ht)),Ee<N.Ub-1&&(n(Bt[Ut].y,0,Ue,Ge+480,16),n(Bt[Ut].f,0,Ye,lt+224,8),n(Bt[Ut].ea,0,jt,$t+224,8)),W=8*Re*N.B,Bt=N.sa,Ut=N.ta+16*ce+16*Re*N.R,rr=N.qa,ct=N.ra+8*ce+W,Ht=N.Ha,ir=N.Ia+8*ce+W,W=0;16>W;++W)n(Bt,Ut+W*N.R,Ue,Ge+32*W,16);for(W=0;8>W;++W)n(rr,ct+W*N.B,Ye,lt+32*W,8),n(Ht,ir+W*N.B,jt,$t+32*W,8)}}function Ed(N,B,W,ce,Ee,Re,Ue,Ge,Ye){var lt=[0],jt=[0],$t=0,ct=Ye!=null?Ye.kd:0,Bt=Ye??new ur;if(N==null||12>W)return 7;Bt.data=N,Bt.w=B,Bt.ha=W,B=[B],W=[W],Bt.gb=[Bt.gb];e:{var Ut=B,rr=W,Ht=Bt.gb;if(e(N!=null),e(rr!=null),e(Ht!=null),Ht[0]=0,12<=rr[0]&&!r(N,Ut[0],"RIFF")){if(r(N,Ut[0]+8,"WEBP")){Ht=3;break e}var ir=se(N,Ut[0]+4);if(12>ir||4294967286<ir){Ht=3;break e}if(ct&&ir>rr[0]-8){Ht=7;break e}Ht[0]=ir,Ut[0]+=12,rr[0]-=12}Ht=0}if(Ht!=0)return Ht;for(ir=0<Bt.gb[0],W=W[0];;){e:{var or=N;rr=B,Ht=W;var gr=lt,hr=jt,Zr=Ut=[0];if((qr=$t=[$t])[0]=0,8>Ht[0])Ht=7;else{if(!r(or,rr[0],"VP8X")){if(se(or,rr[0]+4)!=10){Ht=3;break e}if(18>Ht[0]){Ht=7;break e}var Qr=se(or,rr[0]+8),Pn=1+He(or,rr[0]+12);if(2147483648<=Pn*(or=1+He(or,rr[0]+15))){Ht=3;break e}Zr!=null&&(Zr[0]=Qr),gr!=null&&(gr[0]=Pn),hr!=null&&(hr[0]=or),rr[0]+=18,Ht[0]-=18,qr[0]=1}Ht=0}}if($t=$t[0],Ut=Ut[0],Ht!=0)return Ht;if(rr=!!(2&Ut),!ir&&$t)return 3;if(Re!=null&&(Re[0]=!!(16&Ut)),Ue!=null&&(Ue[0]=rr),Ge!=null&&(Ge[0]=0),Ue=lt[0],Ut=jt[0],$t&&rr&&Ye==null){Ht=0;break}if(4>W){Ht=7;break}if(ir&&$t||!ir&&!$t&&!r(N,B[0],"ALPH")){W=[W],Bt.na=[Bt.na],Bt.P=[Bt.P],Bt.Sa=[Bt.Sa];e:{Qr=N,Ht=B,ir=W;var qr=Bt.gb;gr=Bt.na,hr=Bt.P,Zr=Bt.Sa,Pn=22,e(Qr!=null),e(ir!=null),or=Ht[0];var Zn=ir[0];for(e(gr!=null),e(Zr!=null),gr[0]=null,hr[0]=null,Zr[0]=0;;){if(Ht[0]=or,ir[0]=Zn,8>Zn){Ht=7;break e}var zi=se(Qr,or+4);if(4294967286<zi){Ht=3;break e}var Bn=8+zi+1&-2;if(Pn+=Bn,0<qr&&Pn>qr){Ht=3;break e}if(!r(Qr,or,"VP8 ")||!r(Qr,or,"VP8L")){Ht=0;break e}if(Zn[0]<Bn){Ht=7;break e}r(Qr,or,"ALPH")||(gr[0]=Qr,hr[0]=or+8,Zr[0]=zi),or+=Bn,Zn-=Bn}}if(W=W[0],Bt.na=Bt.na[0],Bt.P=Bt.P[0],Bt.Sa=Bt.Sa[0],Ht!=0)break}W=[W],Bt.Ja=[Bt.Ja],Bt.xa=[Bt.xa];e:if(qr=N,Ht=B,ir=W,gr=Bt.gb[0],hr=Bt.Ja,Zr=Bt.xa,Qr=Ht[0],or=!r(qr,Qr,"VP8 "),Pn=!r(qr,Qr,"VP8L"),e(qr!=null),e(ir!=null),e(hr!=null),e(Zr!=null),8>ir[0])Ht=7;else{if(or||Pn){if(qr=se(qr,Qr+4),12<=gr&&qr>gr-12){Ht=3;break e}if(ct&&qr>ir[0]-8){Ht=7;break e}hr[0]=qr,Ht[0]+=8,ir[0]-=8,Zr[0]=Pn}else Zr[0]=5<=ir[0]&&qr[Qr+0]==47&&!(qr[Qr+4]>>5),hr[0]=ir[0];Ht=0}if(W=W[0],Bt.Ja=Bt.Ja[0],Bt.xa=Bt.xa[0],B=B[0],Ht!=0)break;if(4294967286<Bt.Ja)return 3;if(Ge==null||rr||(Ge[0]=Bt.xa?2:1),Ue=[Ue],Ut=[Ut],Bt.xa){if(5>W){Ht=7;break}Ge=Ue,ct=Ut,rr=Re,N==null||5>W?N=0:5<=W&&N[B+0]==47&&!(N[B+4]>>5)?(ir=[0],qr=[0],gr=[0],ae(hr=new G,N,B,W),K(hr,ir,qr,gr)?(Ge!=null&&(Ge[0]=ir[0]),ct!=null&&(ct[0]=qr[0]),rr!=null&&(rr[0]=gr[0]),N=1):N=0):N=0}else{if(10>W){Ht=7;break}Ge=Ut,N==null||10>W||!Ar(N,B+3,W-3)?N=0:(ct=N[B+0]|N[B+1]<<8|N[B+2]<<16,rr=16383&(N[B+7]<<8|N[B+6]),N=16383&(N[B+9]<<8|N[B+8]),1&ct||3<(ct>>1&7)||!(ct>>4&1)||ct>>5>=Bt.Ja||!rr||!N?N=0:(Ue&&(Ue[0]=rr),Ge&&(Ge[0]=N),N=1))}if(!N||(Ue=Ue[0],Ut=Ut[0],$t&&(lt[0]!=Ue||jt[0]!=Ut)))return 3;Ye!=null&&(Ye[0]=Bt,Ye.offset=B-Ye.w,e(4294967286>B-Ye.w),e(Ye.offset==Ye.ha-W));break}return Ht==0||Ht==7&&$t&&Ye==null?(Re!=null&&(Re[0]|=Bt.na!=null&&0<Bt.na.length),ce!=null&&(ce[0]=Ue),Ee!=null&&(Ee[0]=Ut),0):Ht}function E1(N,B,W){var ce=B.width,Ee=B.height,Re=0,Ue=0,Ge=ce,Ye=Ee;if(B.Da=N!=null&&0<N.Da,B.Da&&(Ge=N.cd,Ye=N.bd,Re=N.v,Ue=N.j,11>W||(Re&=-2,Ue&=-2),0>Re||0>Ue||0>=Ge||0>=Ye||Re+Ge>ce||Ue+Ye>Ee))return 0;if(B.v=Re,B.j=Ue,B.va=Re+Ge,B.o=Ue+Ye,B.U=Ge,B.T=Ye,B.da=N!=null&&0<N.da,B.da){if(!we(Ge,Ye,W=[N.ib],Re=[N.hb]))return 0;B.ib=W[0],B.hb=Re[0]}return B.ob=N!=null&&N.ob,B.Kb=N==null||!N.Sd,B.da&&(B.ob=B.ib<3*ce/4&&B.hb<3*Ee/4,B.Kb=0),1}function S1(N){if(N==null)return 2;if(11>N.S){var B=N.f.RGBA;B.fb+=(N.height-1)*B.A,B.A=-B.A}else B=N.f.kb,N=N.height,B.O+=(N-1)*B.fa,B.fa=-B.fa,B.N+=(N-1>>1)*B.Ab,B.Ab=-B.Ab,B.W+=(N-1>>1)*B.Db,B.Db=-B.Db,B.F!=null&&(B.J+=(N-1)*B.lb,B.lb=-B.lb);return 0}function DA(N,B,W,ce){if(ce==null||0>=N||0>=B)return 2;if(W!=null){if(W.Da){var Ee=W.cd,Re=W.bd,Ue=-2&W.v,Ge=-2&W.j;if(0>Ue||0>Ge||0>=Ee||0>=Re||Ue+Ee>N||Ge+Re>B)return 2;N=Ee,B=Re}if(W.da){if(!we(N,B,Ee=[W.ib],Re=[W.hb]))return 2;N=Ee[0],B=Re[0]}}ce.width=N,ce.height=B;e:{var Ye=ce.width,lt=ce.height;if(N=ce.S,0>=Ye||0>=lt||!(N>=dN&&13>N))N=2;else{if(0>=ce.Rd&&ce.sd==null){Ue=Re=Ee=B=0;var jt=(Ge=Ye*JM[N])*lt;if(11>N||(Re=(lt+1)/2*(B=(Ye+1)/2),N==12&&(Ue=(Ee=Ye)*lt)),(lt=s(jt+2*Re+Ue))==null){N=1;break e}ce.sd=lt,11>N?((Ye=ce.f.RGBA).eb=lt,Ye.fb=0,Ye.A=Ge,Ye.size=jt):((Ye=ce.f.kb).y=lt,Ye.O=0,Ye.fa=Ge,Ye.Fd=jt,Ye.f=lt,Ye.N=0+jt,Ye.Ab=B,Ye.Cd=Re,Ye.ea=lt,Ye.W=0+jt+Re,Ye.Db=B,Ye.Ed=Re,N==12&&(Ye.F=lt,Ye.J=0+jt+2*Re),Ye.Tc=Ue,Ye.lb=Ee)}if(B=1,Ee=ce.S,Re=ce.width,Ue=ce.height,Ee>=dN&&13>Ee)if(11>Ee)N=ce.f.RGBA,B&=(Ge=Math.abs(N.A))*(Ue-1)+Re<=N.size,B&=Ge>=Re*JM[Ee],B&=N.eb!=null;else{N=ce.f.kb,Ge=(Re+1)/2,jt=(Ue+1)/2,Ye=Math.abs(N.fa),lt=Math.abs(N.Ab);var $t=Math.abs(N.Db),ct=Math.abs(N.lb),Bt=ct*(Ue-1)+Re;B&=Ye*(Ue-1)+Re<=N.Fd,B&=lt*(jt-1)+Ge<=N.Cd,B=(B&=$t*(jt-1)+Ge<=N.Ed)&Ye>=Re&lt>=Ge&$t>=Ge,B&=N.y!=null,B&=N.f!=null,B&=N.ea!=null,Ee==12&&(B&=ct>=Re,B&=Bt<=N.Tc,B&=N.F!=null)}else B=0;N=B?0:2}}return N!=0||W!=null&&W.fd&&(N=S1(ce)),N}var Om=64,Gc=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Kc=24,RA=32,ih=8,MA=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];yt("Predictor0","PredictorAdd0"),E.Predictor0=function(){return 4278190080},E.Predictor1=function(N){return N},E.Predictor2=function(N,B,W){return B[W+0]},E.Predictor3=function(N,B,W){return B[W+1]},E.Predictor4=function(N,B,W){return B[W-1]},E.Predictor5=function(N,B,W){return Ke(Ke(N,B[W+1]),B[W+0])},E.Predictor6=function(N,B,W){return Ke(N,B[W-1])},E.Predictor7=function(N,B,W){return Ke(N,B[W+0])},E.Predictor8=function(N,B,W){return Ke(B[W-1],B[W+0])},E.Predictor9=function(N,B,W){return Ke(B[W+0],B[W+1])},E.Predictor10=function(N,B,W){return Ke(Ke(N,B[W-1]),Ke(B[W+0],B[W+1]))},E.Predictor11=function(N,B,W){var ce=B[W+0];return 0>=bt(ce>>24&255,N>>24&255,(B=B[W-1])>>24&255)+bt(ce>>16&255,N>>16&255,B>>16&255)+bt(ce>>8&255,N>>8&255,B>>8&255)+bt(255&ce,255&N,255&B)?ce:N},E.Predictor12=function(N,B,W){var ce=B[W+0];return(wt((N>>24&255)+(ce>>24&255)-((B=B[W-1])>>24&255))<<24|wt((N>>16&255)+(ce>>16&255)-(B>>16&255))<<16|wt((N>>8&255)+(ce>>8&255)-(B>>8&255))<<8|wt((255&N)+(255&ce)-(255&B)))>>>0},E.Predictor13=function(N,B,W){var ce=B[W-1];return(At((N=Ke(N,B[W+0]))>>24&255,ce>>24&255)<<24|At(N>>16&255,ce>>16&255)<<16|At(N>>8&255,ce>>8&255)<<8|At(255&N,255&ce))>>>0};var I1=E.PredictorAdd0;E.PredictorAdd1=ke,yt("Predictor2","PredictorAdd2"),yt("Predictor3","PredictorAdd3"),yt("Predictor4","PredictorAdd4"),yt("Predictor5","PredictorAdd5"),yt("Predictor6","PredictorAdd6"),yt("Predictor7","PredictorAdd7"),yt("Predictor8","PredictorAdd8"),yt("Predictor9","PredictorAdd9"),yt("Predictor10","PredictorAdd10"),yt("Predictor11","PredictorAdd11"),yt("Predictor12","PredictorAdd12"),yt("Predictor13","PredictorAdd13");var Ug=E.PredictorAdd2;le("ColorIndexInverseTransform","MapARGB","32b",function(N){return N>>8&255},function(N){return N}),le("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(N){return N},function(N){return N>>8&255});var Ai,lN=E.ColorIndexInverseTransform,gf=E.MapARGB,xf=E.VP8LColorIndexInverseTransformAlpha,j1=E.MapAlpha,P1=E.VP8LPredictorsAdd=[];P1.length=16,(E.VP8LPredictors=[]).length=16,(E.VP8LPredictorsAdd_C=[]).length=16,(E.VP8LPredictors_C=[]).length=16;var B1,T1,LA,UA,QA,Dm,VA,Rm,Tu,vf,ba,qa,mi,qi,oh,k1,Qg,cN,SM,IM,jM,PM,BM,TM,F1,kM,FM,OM,DM=s(511),RM=s(2041),MM=s(225),LM=s(767),UM=0,m4=RM,uN=MM,qc=LM,ku=DM,dN=0,fN=1,QM=2,hN=3,AN=4,p4=5,VM=6,g4=7,x4=8,mN=9,v4=10,Gue=[2,3,7],Kue=[3,3,11],HM=[280,256,256,256,40],que=[0,1,1,1,0],zue=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Wue=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Xue=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Yue=8,y4=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],b4=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],O1=null,Jue=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Zue=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],$M=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],ede=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],tde=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],rde=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],nde=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],HA=[],Sd=[],lh=[],ade=1,GM=2,$A=[],Fu=[];Pu("UpsampleRgbLinePair",Dt,3),Pu("UpsampleBgrLinePair",zt,3),Pu("UpsampleRgbaLinePair",ca,4),Pu("UpsampleBgraLinePair",Qn,4),Pu("UpsampleArgbLinePair",Ls,4),Pu("UpsampleRgba4444LinePair",Jn,2),Pu("UpsampleRgb565LinePair",br,2);var sde=E.UpsampleRgbLinePair,ide=E.UpsampleBgrLinePair,KM=E.UpsampleRgbaLinePair,qM=E.UpsampleBgraLinePair,zM=E.UpsampleArgbLinePair,WM=E.UpsampleRgba4444LinePair,ode=E.UpsampleRgb565LinePair,pN=16,gN=1<<pN-1,D1=-227,w4=482,lde=6,XM=0,cde=s(256),ude=s(256),dde=s(256),fde=s(256),hde=s(w4-D1),Ade=s(w4-D1);es("YuvToRgbRow",Dt,3),es("YuvToBgrRow",zt,3),es("YuvToRgbaRow",ca,4),es("YuvToBgraRow",Qn,4),es("YuvToArgbRow",Ls,4),es("YuvToRgba4444Row",Jn,2),es("YuvToRgb565Row",br,2);var YM=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],xN=[0,2,8],mde=[8,7,6,4,4,2,2,2,1,1,1,1],pde=1;this.WebPDecodeRGBA=function(N,B,W,ce,Ee){var Re=fN,Ue=new sr,Ge=new de;Ue.ba=Ge,Ge.S=Re,Ge.width=[Ge.width],Ge.height=[Ge.height];var Ye=Ge.width,lt=Ge.height,jt=new Ce;if(jt==null||N==null)var $t=2;else e(jt!=null),$t=Ed(N,B,W,jt.width,jt.height,jt.Pd,jt.Qd,jt.format,null);if($t!=0?Ye=0:(Ye!=null&&(Ye[0]=jt.width[0]),lt!=null&&(lt[0]=jt.height[0]),Ye=1),Ye){Ge.width=Ge.width[0],Ge.height=Ge.height[0],ce!=null&&(ce[0]=Ge.width),Ee!=null&&(Ee[0]=Ge.height);e:{if(ce=new Ot,(Ee=new ur).data=N,Ee.w=B,Ee.ha=W,Ee.kd=1,B=[0],e(Ee!=null),((N=Ed(Ee.data,Ee.w,Ee.ha,null,null,null,B,null,Ee))==0||N==7)&&B[0]&&(N=4),(B=N)==0){if(e(Ue!=null),ce.data=Ee.data,ce.w=Ee.w+Ee.offset,ce.ha=Ee.ha-Ee.offset,ce.put=be,ce.ac=Xe,ce.bc=st,ce.ma=Ue,Ee.xa){if((N=dt())==null){Ue=1;break e}if(function(ct,Bt){var Ut=[0],rr=[0],Ht=[0];t:for(;;){if(ct==null)return 0;if(Bt==null)return ct.a=2,0;if(ct.l=Bt,ct.a=0,ae(ct.m,Bt.data,Bt.w,Bt.ha),!K(ct.m,Ut,rr,Ht)){ct.a=3;break t}if(ct.xb=GM,Bt.width=Ut[0],Bt.height=rr[0],!Oe(Ut[0],rr[0],1,ct,null))break t;return 1}return e(ct.a!=0),0}(N,ce)){if(ce=(B=DA(ce.width,ce.height,Ue.Oa,Ue.ba))==0){t:{ce=N;r:for(;;){if(ce==null){ce=0;break t}if(e(ce.s.yc!=null),e(ce.s.Ya!=null),e(0<ce.s.Wb),e((W=ce.l)!=null),e((Ee=W.ma)!=null),ce.xb!=0){if(ce.ca=Ee.ba,ce.tb=Ee.tb,e(ce.ca!=null),!E1(Ee.Oa,W,hN)){ce.a=2;break r}if(!et(ce,W.width)||W.da)break r;if((W.da||te(ce.ca.S))&&vc(),11>ce.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ce.ca.f.kb.F!=null&&vc()),ce.Pb&&0<ce.s.ua&&ce.s.vb.X==null&&!re(ce.s.vb,ce.s.Wa.Xa)){ce.a=1;break r}ce.xb=0}if(!De(ce,ce.V,ce.Ba,ce.c,ce.i,W.o,V))break r;Ee.Dc=ce.Ma,ce=1;break t}e(ce.a!=0),ce=0}ce=!ce}ce&&(B=N.a)}else B=N.a}else{if((N=new Kt)==null){Ue=1;break e}if(N.Fa=Ee.na,N.P=Ee.P,N.qc=Ee.Sa,ft(N,ce)){if((B=DA(ce.width,ce.height,Ue.Oa,Ue.ba))==0){if(N.Aa=0,W=Ue.Oa,e((Ee=N)!=null),W!=null){if(0<(Ye=0>(Ye=W.Md)?0:100<Ye?255:255*Ye/100)){for(lt=jt=0;4>lt;++lt)12>($t=Ee.pb[lt]).lc&&($t.ia=Ye*mde[0>$t.lc?0:$t.lc]>>3),jt|=$t.ia;jt&&(alert("todo:VP8InitRandom"),Ee.ia=1)}Ee.Ga=W.Id,100<Ee.Ga?Ee.Ga=100:0>Ee.Ga&&(Ee.Ga=0)}(function(ct,Bt){if(ct==null)return 0;if(Bt==null)return ar(ct,2,"NULL VP8Io parameter in VP8Decode().");if(!ct.cb&&!ft(ct,Bt))return 0;if(e(ct.cb),Bt.ac==null||Bt.ac(Bt)){Bt.ob&&(ct.L=0);var Ut=xN[ct.L];if(ct.L==2?(ct.yb=0,ct.zb=0):(ct.yb=Bt.v-Ut>>4,ct.zb=Bt.j-Ut>>4,0>ct.yb&&(ct.yb=0),0>ct.zb&&(ct.zb=0)),ct.Va=Bt.o+15+Ut>>4,ct.Hb=Bt.va+15+Ut>>4,ct.Hb>ct.za&&(ct.Hb=ct.za),ct.Va>ct.Ub&&(ct.Va=ct.Ub),0<ct.L){var rr=ct.ed;for(Ut=0;4>Ut;++Ut){var Ht;if(ct.Qa.Cb){var ir=ct.Qa.Lb[Ut];ct.Qa.Fb||(ir+=rr.Tb)}else ir=rr.Tb;for(Ht=0;1>=Ht;++Ht){var or=ct.gd[Ut][Ht],gr=ir;if(rr.Pc&&(gr+=rr.vd[0],Ht&&(gr+=rr.od[0])),0<(gr=0>gr?0:63<gr?63:gr)){var hr=gr;0<rr.wb&&(hr=4<rr.wb?hr>>2:hr>>1)>9-rr.wb&&(hr=9-rr.wb),1>hr&&(hr=1),or.dd=hr,or.tc=2*gr+hr,or.ld=40<=gr?2:15<=gr?1:0}else or.tc=0;or.La=Ht}}}Ut=0}else ar(ct,6,"Frame setup failed"),Ut=ct.a;if(Ut=Ut==0){if(Ut){ct.$c=0,0<ct.Aa||(ct.Ic=pde);t:{Ut=ct.Ic,rr=4*(hr=ct.za);var Zr=32*hr,Qr=hr+1,Pn=0<ct.L?hr*(0<ct.Aa?2:1):0,qr=(ct.Aa==2?2:1)*hr;if((or=rr+832+(Ht=3*(16*Ut+xN[ct.L])/2*Zr)+(ir=ct.Fa!=null&&0<ct.Fa.length?ct.Kc.c*ct.Kc.i:0))!=or)Ut=0;else{if(or>ct.Vb){if(ct.Vb=0,ct.Ec=s(or),ct.Fc=0,ct.Ec==null){Ut=ar(ct,1,"no memory during frame initialization.");break t}ct.Vb=or}or=ct.Ec,gr=ct.Fc,ct.Ac=or,ct.Bc=gr,gr+=rr,ct.Gd=o(Zr,In),ct.Hd=0,ct.rb=o(Qr+1,Fr),ct.sb=1,ct.wa=Pn?o(Pn,Br):null,ct.Y=0,ct.D.Nb=0,ct.D.wa=ct.wa,ct.D.Y=ct.Y,0<ct.Aa&&(ct.D.Y+=hr),e(!0),ct.oc=or,ct.pc=gr,gr+=832,ct.ya=o(qr,Ln),ct.aa=0,ct.D.ya=ct.ya,ct.D.aa=ct.aa,ct.Aa==2&&(ct.D.aa+=hr),ct.R=16*hr,ct.B=8*hr,hr=(Zr=xN[ct.L])*ct.R,Zr=Zr/2*ct.B,ct.sa=or,ct.ta=gr+hr,ct.qa=ct.sa,ct.ra=ct.ta+16*Ut*ct.R+Zr,ct.Ha=ct.qa,ct.Ia=ct.ra+8*Ut*ct.B+Zr,ct.$c=0,gr+=Ht,ct.mb=ir?or:null,ct.nb=ir?gr:null,e(gr+ir<=ct.Fc+ct.Vb),Le(ct),a(ct.Ac,ct.Bc,0,rr),Ut=1}}if(Ut){if(Bt.ka=0,Bt.y=ct.sa,Bt.O=ct.ta,Bt.f=ct.qa,Bt.N=ct.ra,Bt.ea=ct.Ha,Bt.Vd=ct.Ia,Bt.fa=ct.R,Bt.Rc=ct.B,Bt.F=null,Bt.J=0,!UM){for(Ut=-255;255>=Ut;++Ut)DM[255+Ut]=0>Ut?-Ut:Ut;for(Ut=-1020;1020>=Ut;++Ut)RM[1020+Ut]=-128>Ut?-128:127<Ut?127:Ut;for(Ut=-112;112>=Ut;++Ut)MM[112+Ut]=-16>Ut?-16:15<Ut?15:Ut;for(Ut=-255;510>=Ut;++Ut)LM[255+Ut]=0>Ut?0:255<Ut?255:Ut;UM=1}VA=Wt,Rm=Mt,vf=Rt,ba=Jt,qa=Lt,Tu=ut,mi=OA,qi=ju,oh=_e,k1=ot,Qg=Fm,cN=Q,SM=St,IM=kt,jM=pf,PM=Kl,BM=km,TM=Lg,Sd[0]=Gl,Sd[1]=Ur,Sd[2]=Cd,Sd[3]=xc,Sd[4]=Os,Sd[5]=_1,Sd[6]=Ki,Sd[7]=TA,Sd[8]=kA,Sd[9]=_d,HA[0]=Un,HA[1]=Nn,HA[2]=la,HA[3]=Kn,HA[4]=ti,HA[5]=Fs,HA[6]=$l,lh[0]=Bm,lh[1]=on,lh[2]=Hc,lh[3]=ah,lh[4]=Tm,lh[5]=Qa,lh[6]=Mg,Ut=1}else Ut=0}Ut&&(Ut=function(Zn,zi){for(Zn.M=0;Zn.M<Zn.Va;++Zn.M){var Bn,zr=Zn.Jc[Zn.M&Zn.Xb],jr=Zn.m,pi=Zn;for(Bn=0;Bn<pi.za;++Bn){var _n=jr,ea=pi,ls=ea.Ac,$o=ea.Bc+4*Bn,zl=ea.zc,ai=ea.ya[ea.aa+Bn];if(ea.Qa.Bb?ai.$b=ne(_n,ea.Pa.jb[0])?2+ne(_n,ea.Pa.jb[2]):ne(_n,ea.Pa.jb[1]):ai.$b=0,ea.kc&&(ai.Ad=ne(_n,ea.Bd)),ai.Za=!ne(_n,145)+0,ai.Za){var pl=ai.Ob,Wl=0;for(ea=0;4>ea;++ea){var Wi,na=zl[0+ea];for(Wi=0;4>Wi;++Wi){na=tde[ls[$o+Wi]][na];for(var Ea=$M[ne(_n,na[0])];0<Ea;)Ea=$M[2*Ea+ne(_n,na[Ea])];na=-Ea,ls[$o+Wi]=na}n(pl,Wl,ls,$o,4),Wl+=4,zl[0+ea]=na}}else na=ne(_n,156)?ne(_n,128)?1:3:ne(_n,163)?2:0,ai.Ob[0]=na,a(ls,$o,na,4),a(zl,0,na,4);ai.Dd=ne(_n,142)?ne(_n,114)?ne(_n,183)?1:3:2:0}if(pi.m.Ka)return ar(Zn,7,"Premature end-of-partition0 encountered.");for(;Zn.ja<Zn.za;++Zn.ja){if(pi=zr,_n=(jr=Zn).rb[jr.sb-1],ls=jr.rb[jr.sb+jr.ja],Bn=jr.ya[jr.aa+jr.ja],$o=jr.kc?Bn.Ad:0)_n.la=ls.la=0,Bn.Za||(_n.Na=ls.Na=0),Bn.Hc=0,Bn.Gc=0,Bn.ia=0;else{var si,Sa;if(_n=ls,ls=pi,$o=jr.Pa.Xc,zl=jr.ya[jr.aa+jr.ja],ai=jr.pb[zl.$b],ea=zl.ad,pl=0,Wl=jr.rb[jr.sb-1],na=Wi=0,a(ea,pl,0,384),zl.Za)var Go=0,Id=$o[3];else{Ea=s(16);var gi=_n.Na+Wl.Na;if(gi=O1(ls,$o[1],gi,ai.Eb,0,Ea,0),_n.Na=Wl.Na=(0<gi)+0,1<gi)VA(Ea,0,ea,pl);else{var yc=Ea[0]+3>>3;for(Ea=0;256>Ea;Ea+=16)ea[pl+Ea]=yc}Go=1,Id=$o[0]}var za=15&_n.la,Xi=15&Wl.la;for(Ea=0;4>Ea;++Ea){var zc=1&Xi;for(yc=Sa=0;4>yc;++yc)za=za>>1|(zc=(gi=O1(ls,Id,gi=zc+(1&za),ai.Sc,Go,ea,pl))>Go)<<7,Sa=Sa<<2|(3<gi?3:1<gi?2:ea[pl+0]!=0),pl+=16;za>>=4,Xi=Xi>>1|zc<<7,Wi=(Wi<<8|Sa)>>>0}for(Id=za,Go=Xi>>4,si=0;4>si;si+=2){for(Sa=0,za=_n.la>>4+si,Xi=Wl.la>>4+si,Ea=0;2>Ea;++Ea){for(zc=1&Xi,yc=0;2>yc;++yc)gi=zc+(1&za),za=za>>1|(zc=0<(gi=O1(ls,$o[2],gi,ai.Qc,0,ea,pl)))<<3,Sa=Sa<<2|(3<gi?3:1<gi?2:ea[pl+0]!=0),pl+=16;za>>=2,Xi=Xi>>1|zc<<5}na|=Sa<<4*si,Id|=za<<4<<si,Go|=(240&Xi)<<si}_n.la=Id,Wl.la=Go,zl.Hc=Wi,zl.Gc=na,zl.ia=43690&na?0:ai.ia,$o=!(Wi|na)}if(0<jr.L&&(jr.wa[jr.Y+jr.ja]=jr.gd[Bn.$b][Bn.Za],jr.wa[jr.Y+jr.ja].La|=!$o),pi.Ka)return ar(Zn,7,"Premature end-of-file encountered.")}if(Le(Zn),jr=zi,pi=1,Bn=(zr=Zn).D,_n=0<zr.L&&zr.M>=zr.zb&&zr.M<=zr.Va,zr.Aa==0)t:{if(Bn.M=zr.M,Bn.uc=_n,Ho(zr,Bn),pi=1,Bn=(Sa=zr.D).Nb,_n=(na=xN[zr.L])*zr.R,ls=na/2*zr.B,Ea=16*Bn*zr.R,yc=8*Bn*zr.B,$o=zr.sa,zl=zr.ta-_n+Ea,ai=zr.qa,ea=zr.ra-ls+yc,pl=zr.Ha,Wl=zr.Ia-ls+yc,Xi=(za=Sa.M)==0,Wi=za>=zr.Va-1,zr.Aa==2&&Ho(zr,Sa),Sa.uc)for(zc=(gi=zr).D.M,e(gi.D.uc),Sa=gi.yb;Sa<gi.Hb;++Sa){Go=Sa,Id=zc;var Xl=(Wc=(Ko=gi).D).Nb;si=Ko.R;var Wc=Wc.wa[Wc.Y+Go],Xc=Ko.sa,bc=Ko.ta+16*Xl*si+16*Go,Yc=Wc.dd,ts=Wc.tc;if(ts!=0)if(e(3<=ts),Ko.L==1)0<Go&&PM(Xc,bc,si,ts+4),Wc.La&&TM(Xc,bc,si,ts),0<Id&&jM(Xc,bc,si,ts+4),Wc.La&&BM(Xc,bc,si,ts);else{var Jc=Ko.B,jd=Ko.qa,Mm=Ko.ra+8*Xl*Jc+8*Go,ch=Ko.Ha,Ko=Ko.Ia+8*Xl*Jc+8*Go;Xl=Wc.ld,0<Go&&(qi(Xc,bc,si,ts+4,Yc,Xl),k1(jd,Mm,ch,Ko,Jc,ts+4,Yc,Xl)),Wc.La&&(cN(Xc,bc,si,ts,Yc,Xl),IM(jd,Mm,ch,Ko,Jc,ts,Yc,Xl)),0<Id&&(mi(Xc,bc,si,ts+4,Yc,Xl),oh(jd,Mm,ch,Ko,Jc,ts+4,Yc,Xl)),Wc.La&&(Qg(Xc,bc,si,ts,Yc,Xl),SM(jd,Mm,ch,Ko,Jc,ts,Yc,Xl))}}if(zr.ia&&alert("todo:DitherRow"),jr.put!=null){if(Sa=16*za,za=16*(za+1),Xi?(jr.y=zr.sa,jr.O=zr.ta+Ea,jr.f=zr.qa,jr.N=zr.ra+yc,jr.ea=zr.Ha,jr.W=zr.Ia+yc):(Sa-=na,jr.y=$o,jr.O=zl,jr.f=ai,jr.N=ea,jr.ea=pl,jr.W=Wl),Wi||(za-=na),za>jr.o&&(za=jr.o),jr.F=null,jr.J=null,zr.Fa!=null&&0<zr.Fa.length&&Sa<za&&(jr.J=_a(zr,jr,Sa,za-Sa),jr.F=zr.mb,jr.F==null&&jr.F.length==0)){pi=ar(zr,3,"Could not decode alpha data.");break t}Sa<jr.j&&(na=jr.j-Sa,Sa=jr.j,e(!(1&na)),jr.O+=zr.R*na,jr.N+=zr.B*(na>>1),jr.W+=zr.B*(na>>1),jr.F!=null&&(jr.J+=jr.width*na)),Sa<za&&(jr.O+=jr.v,jr.N+=jr.v>>1,jr.W+=jr.v>>1,jr.F!=null&&(jr.J+=jr.v),jr.ka=Sa-jr.j,jr.U=jr.va-jr.v,jr.T=za-Sa,pi=jr.put(jr))}Bn+1!=zr.Ic||Wi||(n(zr.sa,zr.ta-_n,$o,zl+16*zr.R,_n),n(zr.qa,zr.ra-ls,ai,ea+8*zr.B,ls),n(zr.Ha,zr.Ia-ls,pl,Wl+8*zr.B,ls))}if(!pi)return ar(Zn,6,"Output aborted.")}return 1}(ct,Bt)),Bt.bc!=null&&Bt.bc(Bt),Ut&=1}return Ut?(ct.cb=0,Ut):0})(N,ce)||(B=N.a)}}else B=N.a}B==0&&Ue.Oa!=null&&Ue.Oa.fd&&(B=S1(Ue.ba))}Ue=B}Re=Ue!=0?null:11>Re?Ge.f.RGBA.eb:Ge.f.kb.y}else Re=null;return Re};var JM=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(E,F){for(var k="",P=0;P<4;P++)k+=String.fromCharCode(E[F++]);return k}function d(E,F){return E[F+0]|E[F+1]<<8}function f(E,F){return(E[F+0]|E[F+1]<<8|E[F+2]<<16)>>>0}function A(E,F){return(E[F+0]|E[F+1]<<8|E[F+2]<<16|E[F+3]<<24)>>>0}new c;var h=[0],m=[0],p=[],g=new c,v=t,y=function(E,F){var k={},P=0,D=!1,X=0,pe=0;if(k.frames=[],!function(O,G){for(var z=0;z<4;z++)if(O[G+z]!="RIFF".charCodeAt(z))return!0;return!1}(E,F)){for(A(E,F+=4),F+=8;F<E.length;){var ge=u(E,F),fe=A(E,F+=4);F+=4;var xe=fe+(1&fe);switch(ge){case"VP8 ":case"VP8L":k.frames[P]===void 0&&(k.frames[P]={}),(Te=k.frames[P]).src_off=D?pe:F-8,Te.src_size=X+fe+8,P++,D&&(D=!1,X=0,pe=0);break;case"VP8X":(Te=k.header={}).feature_flags=E[F];var ae=F+4;Te.canvas_width=1+f(E,ae),ae+=3,Te.canvas_height=1+f(E,ae),ae+=3;break;case"ALPH":D=!0,X=xe+8,pe=F-8;break;case"ANIM":(Te=k.header).bgcolor=A(E,F),ae=F+4,Te.loop_count=d(E,ae),ae+=2;break;case"ANMF":var Se,Te;(Te=k.frames[P]={}).offset_x=2*f(E,F),F+=3,Te.offset_y=2*f(E,F),F+=3,Te.width=1+f(E,F),F+=3,Te.height=1+f(E,F),F+=3,Te.duration=f(E,F),F+=3,Se=E[F++],Te.dispose=1&Se,Te.blend=Se>>1&1}ge!="ANMF"&&(F+=xe)}return k}}(v,0);y.response=v,y.rgbaoutput=!0,y.dataurl=!1;var b=y.header?y.header:null,w=y.frames?y.frames:null;if(b){b.loop_counter=b.loop_count,h=[b.canvas_height],m=[b.canvas_width];for(var j=0;j<w.length&&w[j].blend!=0;j++);}var I=w[0],_=g.WebPDecodeRGBA(v,I.src_off,I.src_size,m,h);I.rgba=_,I.imgwidth=m[0],I.imgheight=h[0];for(var S=0;S<m[0]*h[0]*4;S++)p[S]=_[S];return this.width=m,this.height=h,this.data=p,this}(function(t){var e,r,n,a,s,o,l,c,u,d=function(O){return O=O||{},this.isStrokeTransparent=O.isStrokeTransparent||!1,this.strokeOpacity=O.strokeOpacity||1,this.strokeStyle=O.strokeStyle||"#000000",this.fillStyle=O.fillStyle||"#000000",this.isFillTransparent=O.isFillTransparent||!1,this.fillOpacity=O.fillOpacity||1,this.font=O.font||"10px sans-serif",this.textBaseline=O.textBaseline||"alphabetic",this.textAlign=O.textAlign||"left",this.lineWidth=O.lineWidth||1,this.lineJoin=O.lineJoin||"miter",this.lineCap=O.lineCap||"butt",this.path=O.path||[],this.transform=O.transform!==void 0?O.transform.clone():new c,this.globalCompositeOperation=O.globalCompositeOperation||"normal",this.globalAlpha=O.globalAlpha||1,this.clip_path=O.clip_path||[],this.currentPoint=O.currentPoint||new o,this.miterLimit=O.miterLimit||10,this.lastPoint=O.lastPoint||new o,this.lineDashOffset=O.lineDashOffset||0,this.lineDash=O.lineDash||[],this.margin=O.margin||[0,0,0,0],this.prevPageLastElemOffset=O.prevPageLastElemOffset||0,this.ignoreClearRect=typeof O.ignoreClearRect!="boolean"||O.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new f(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new d}]);var f=function(O){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var G=O;Object.defineProperty(this,"pdf",{get:function(){return G}});var z=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return z},set:function(re){z=!!re}});var L=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return L},set:function(re){L=!!re}});var Z=0;Object.defineProperty(this,"posX",{get:function(){return Z},set:function(re){isNaN(re)||(Z=re)}});var ee=0;Object.defineProperty(this,"posY",{get:function(){return ee},set:function(re){isNaN(re)||(ee=re)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(re){var Pe;typeof re=="number"?Pe=[re,re,re,re]:((Pe=new Array(4))[0]=re[0],Pe[1]=re.length>=2?re[1]:Pe[0],Pe[2]=re.length>=3?re[2]:Pe[0],Pe[3]=re.length>=4?re[3]:Pe[1]),u.margin=Pe}});var R=!1;Object.defineProperty(this,"autoPaging",{get:function(){return R},set:function(re){R=re}});var H=0;Object.defineProperty(this,"lastBreak",{get:function(){return H},set:function(re){H=re}});var ne=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ne},set:function(re){ne=re}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(re){re instanceof d&&(u=re)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(re){u.path=re}});var ve=[];Object.defineProperty(this,"ctxStack",{get:function(){return ve},set:function(re){ve=re}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(re){var Pe;Pe=A(re),this.ctx.fillStyle=Pe.style,this.ctx.isFillTransparent=Pe.a===0,this.ctx.fillOpacity=Pe.a,this.pdf.setFillColor(Pe.r,Pe.g,Pe.b,{a:Pe.a}),this.pdf.setTextColor(Pe.r,Pe.g,Pe.b,{a:Pe.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(re){var Pe=A(re);this.ctx.strokeStyle=Pe.style,this.ctx.isStrokeTransparent=Pe.a===0,this.ctx.strokeOpacity=Pe.a,Pe.a===0?this.pdf.setDrawColor(255,255,255):(Pe.a,this.pdf.setDrawColor(Pe.r,Pe.g,Pe.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(re){["butt","round","square"].indexOf(re)!==-1&&(this.ctx.lineCap=re,this.pdf.setLineCap(re))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(re){isNaN(re)||(this.ctx.lineWidth=re,this.pdf.setLineWidth(re))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(re){["bevel","round","miter"].indexOf(re)!==-1&&(this.ctx.lineJoin=re,this.pdf.setLineJoin(re))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(re){isNaN(re)||(this.ctx.miterLimit=re,this.pdf.setMiterLimit(re))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(re){this.ctx.textBaseline=re}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(re){["right","end","center","left","start"].indexOf(re)!==-1&&(this.ctx.textAlign=re)}});var U=null,He=null,se=null;Object.defineProperty(this,"fontFaces",{get:function(){return se},set:function(re){U=null,He=null,se=re}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(re){var Pe;if(this.ctx.font=re,(Pe=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(re))!==null){var ue=Pe[1];Pe[2];var we=Pe[3],Me=Pe[4];Pe[5];var ze=Pe[6],yt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Me)[2];Me=Math.floor(yt==="px"?parseFloat(Me)*this.pdf.internal.scaleFactor:yt==="em"?parseFloat(Me)*this.pdf.getFontSize():parseFloat(Me)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Me);var It=function(le){var Be,je,Ae=[],Qe=le.trim();if(Qe==="")return r5;if(Qe in fV)return[fV[Qe]];for(;Qe!=="";){switch(je=null,Be=(Qe=AV(Qe)).charAt(0)){case'"':case"'":je=Fje(Qe.substring(1),Be);break;default:je=Oje(Qe)}if(je===null||(Ae.push(je[0]),(Qe=AV(je[1]))!==""&&Qe.charAt(0)!==","))return r5;Qe=Qe.replace(/^,/,"")}return Ae}(ze);if(this.fontFaces){var Ke=function(le,Be){var je=le.getFontList(),Ae=JSON.stringify(je);if(U===null||He!==Ae){var Qe=function(Ct){var pt=[];return Object.keys(Ct).forEach(function(me){Ct[me].forEach(function(te){var ie=null;switch(te){case"bold":ie={family:me,weight:"bold"};break;case"italic":ie={family:me,style:"italic"};break;case"bolditalic":ie={family:me,weight:"bold",style:"italic"};break;case"":case"normal":ie={family:me}}ie!==null&&(ie.ref={name:me,style:te},pt.push(ie))})}),pt}(je);U=function(Ct){for(var pt={},me=0;me<Ct.length;++me){var te=t5(Ct[me]),ie=te.family,$e=te.stretch,de=te.style,Ce=te.weight;pt[ie]=pt[ie]||{},pt[ie][$e]=pt[ie][$e]||{},pt[ie][$e][de]=pt[ie][$e][de]||{},pt[ie][$e][de][Ce]=te}return pt}(Qe.concat(Be)),He=Ae}return U}(this.pdf,this.fontFaces),wt=It.map(function(le){return{family:le,stretch:"normal",weight:we,style:ue}}),At=function(le,Be,je){for(var Ae=(je=je||{}).defaultFontFamily||"times",Qe=Object.assign({},kje,je.genericFontFamilies||{}),Ct=null,pt=null,me=0;me<Be.length;++me)if(Qe[(Ct=t5(Be[me])).family]&&(Ct.family=Qe[Ct.family]),le.hasOwnProperty(Ct.family)){pt=le[Ct.family];break}if(!(pt=pt||le[Ae]))throw new Error("Could not find a font-family for the rule '"+hV(Ct)+"' and default family '"+Ae+"'.");if(pt=function(te,ie){if(ie[te])return ie[te];var $e=jk[te],de=$e<=jk.normal?-1:1,Ce=dV(ie,pre,$e,de);if(!Ce)throw new Error("Could not find a matching font-stretch value for "+te);return Ce}(Ct.stretch,pt),pt=function(te,ie){if(ie[te])return ie[te];for(var $e=mre[te],de=0;de<$e.length;++de)if(ie[$e[de]])return ie[$e[de]];throw new Error("Could not find a matching font-style for "+te)}(Ct.style,pt),!(pt=function(te,ie){if(ie[te])return ie[te];if(te===400&&ie[500])return ie[500];if(te===500&&ie[400])return ie[400];var $e=Tje[te],de=dV(ie,gre,$e,te<400?-1:1);if(!de)throw new Error("Could not find a matching font-weight for value "+te);return de}(Ct.weight,pt)))throw new Error("Failed to resolve a font for the rule '"+hV(Ct)+"'.");return pt}(Ke,wt);this.pdf.setFont(At.ref.name,At.ref.style)}else{var bt="";(we==="bold"||parseInt(we,10)>=700||ue==="bold")&&(bt="bold"),ue==="italic"&&(bt+="italic"),bt.length===0&&(bt="normal");for(var ke="",Ne={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ve=0;Ve<It.length;Ve++){if(this.pdf.internal.getFont(It[Ve],bt,{noFallback:!0,disableWarning:!0})!==void 0){ke=It[Ve];break}if(bt==="bolditalic"&&this.pdf.internal.getFont(It[Ve],"bold",{noFallback:!0,disableWarning:!0})!==void 0)ke=It[Ve],bt="bold";else if(this.pdf.internal.getFont(It[Ve],"normal",{noFallback:!0,disableWarning:!0})!==void 0){ke=It[Ve],bt="normal";break}}if(ke===""){for(var he=0;he<It.length;he++)if(Ne[It[he]]){ke=Ne[It[he]];break}}ke=ke===""?"Times":ke,this.pdf.setFont(ke,bt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(re){this.ctx.globalCompositeOperation=re}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(re){this.ctx.globalAlpha=re}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(re){this.ctx.lineDashOffset=re,Te.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(re){this.ctx.lineDash=re,Te.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(re){this.ctx.ignoreClearRect=!!re}})};f.prototype.setLineDash=function(O){this.lineDash=O},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){w.call(this,"fill",!1)},f.prototype.stroke=function(){w.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(O,G){if(isNaN(O)||isNaN(G))throw Xa.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var z=this.ctx.transform.applyToPoint(new o(O,G));this.path.push({type:"mt",x:z.x,y:z.y}),this.ctx.lastPoint=new o(O,G)},f.prototype.closePath=function(){var O=new o(0,0),G=0;for(G=this.path.length-1;G!==-1;G--)if(this.path[G].type==="begin"&&Oa(this.path[G+1])==="object"&&typeof this.path[G+1].x=="number"){O=new o(this.path[G+1].x,this.path[G+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(O.x,O.y)},f.prototype.lineTo=function(O,G){if(isNaN(O)||isNaN(G))throw Xa.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var z=this.ctx.transform.applyToPoint(new o(O,G));this.path.push({type:"lt",x:z.x,y:z.y}),this.ctx.lastPoint=new o(z.x,z.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),w.call(this,null,!0)},f.prototype.quadraticCurveTo=function(O,G,z,L){if(isNaN(z)||isNaN(L)||isNaN(O)||isNaN(G))throw Xa.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Z=this.ctx.transform.applyToPoint(new o(z,L)),ee=this.ctx.transform.applyToPoint(new o(O,G));this.path.push({type:"qct",x1:ee.x,y1:ee.y,x:Z.x,y:Z.y}),this.ctx.lastPoint=new o(Z.x,Z.y)},f.prototype.bezierCurveTo=function(O,G,z,L,Z,ee){if(isNaN(Z)||isNaN(ee)||isNaN(O)||isNaN(G)||isNaN(z)||isNaN(L))throw Xa.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var R=this.ctx.transform.applyToPoint(new o(Z,ee)),H=this.ctx.transform.applyToPoint(new o(O,G)),ne=this.ctx.transform.applyToPoint(new o(z,L));this.path.push({type:"bct",x1:H.x,y1:H.y,x2:ne.x,y2:ne.y,x:R.x,y:R.y}),this.ctx.lastPoint=new o(R.x,R.y)},f.prototype.arc=function(O,G,z,L,Z,ee){if(isNaN(O)||isNaN(G)||isNaN(z)||isNaN(L)||isNaN(Z))throw Xa.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ee=!!ee,!this.ctx.transform.isIdentity){var R=this.ctx.transform.applyToPoint(new o(O,G));O=R.x,G=R.y;var H=this.ctx.transform.applyToPoint(new o(0,z)),ne=this.ctx.transform.applyToPoint(new o(0,0));z=Math.sqrt(Math.pow(H.x-ne.x,2)+Math.pow(H.y-ne.y,2))}Math.abs(Z-L)>=2*Math.PI&&(L=0,Z=2*Math.PI),this.path.push({type:"arc",x:O,y:G,radius:z,startAngle:L,endAngle:Z,counterclockwise:ee})},f.prototype.arcTo=function(O,G,z,L,Z){throw new Error("arcTo not implemented.")},f.prototype.rect=function(O,G,z,L){if(isNaN(O)||isNaN(G)||isNaN(z)||isNaN(L))throw Xa.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(O,G),this.lineTo(O+z,G),this.lineTo(O+z,G+L),this.lineTo(O,G+L),this.lineTo(O,G),this.lineTo(O+z,G),this.lineTo(O,G)},f.prototype.fillRect=function(O,G,z,L){if(isNaN(O)||isNaN(G)||isNaN(z)||isNaN(L))throw Xa.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var Z={};this.lineCap!=="butt"&&(Z.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Z.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(O,G,z,L),this.fill(),Z.hasOwnProperty("lineCap")&&(this.lineCap=Z.lineCap),Z.hasOwnProperty("lineJoin")&&(this.lineJoin=Z.lineJoin)}},f.prototype.strokeRect=function(O,G,z,L){if(isNaN(O)||isNaN(G)||isNaN(z)||isNaN(L))throw Xa.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(O,G,z,L),this.stroke())},f.prototype.clearRect=function(O,G,z,L){if(isNaN(O)||isNaN(G)||isNaN(z)||isNaN(L))throw Xa.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(O,G,z,L))},f.prototype.save=function(O){O=typeof O!="boolean"||O;for(var G=this.pdf.internal.getCurrentPageInfo().pageNumber,z=0;z<this.pdf.internal.getNumberOfPages();z++)this.pdf.setPage(z+1),this.pdf.internal.out("q");if(this.pdf.setPage(G),O){this.ctx.fontSize=this.pdf.internal.getFontSize();var L=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=L}},f.prototype.restore=function(O){O=typeof O!="boolean"||O;for(var G=this.pdf.internal.getCurrentPageInfo().pageNumber,z=0;z<this.pdf.internal.getNumberOfPages();z++)this.pdf.setPage(z+1),this.pdf.internal.out("Q");this.pdf.setPage(G),O&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var A=function(O){var G,z,L,Z;if(O.isCanvasGradient===!0&&(O=O.getColor()),!O)return{r:0,g:0,b:0,a:0,style:O};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(O))G=0,z=0,L=0,Z=0;else{var ee=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(O);if(ee!==null)G=parseInt(ee[1]),z=parseInt(ee[2]),L=parseInt(ee[3]),Z=1;else if((ee=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(O))!==null)G=parseInt(ee[1]),z=parseInt(ee[2]),L=parseInt(ee[3]),Z=parseFloat(ee[4]);else{if(Z=1,typeof O=="string"&&O.charAt(0)!=="#"){var R=new lre(O);O=R.ok?R.toHex():"#000000"}O.length===4?(G=O.substring(1,2),G+=G,z=O.substring(2,3),z+=z,L=O.substring(3,4),L+=L):(G=O.substring(1,3),z=O.substring(3,5),L=O.substring(5,7)),G=parseInt(G,16),z=parseInt(z,16),L=parseInt(L,16)}}return{r:G,g:z,b:L,a:Z,style:O}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(O,G,z,L){if(isNaN(G)||isNaN(z)||typeof O!="string")throw Xa.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(L=isNaN(L)?void 0:L,!h.call(this)){var Z=xe(this.ctx.transform.rotation),ee=this.ctx.transform.scaleX;P.call(this,{text:O,x:G,y:z,scale:ee,angle:Z,align:this.textAlign,maxWidth:L})}},f.prototype.strokeText=function(O,G,z,L){if(isNaN(G)||isNaN(z)||typeof O!="string")throw Xa.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){L=isNaN(L)?void 0:L;var Z=xe(this.ctx.transform.rotation),ee=this.ctx.transform.scaleX;P.call(this,{text:O,x:G,y:z,scale:ee,renderingMode:"stroke",angle:Z,align:this.textAlign,maxWidth:L})}},f.prototype.measureText=function(O){if(typeof O!="string")throw Xa.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var G=this.pdf,z=this.pdf.internal.scaleFactor,L=G.internal.getFontSize(),Z=G.getStringUnitWidth(O)*L/G.internal.scaleFactor;return new function(ee){var R=(ee=ee||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return R}}),this}({width:Z*=Math.round(96*z/72*1e4)/1e4})},f.prototype.scale=function(O,G){if(isNaN(O)||isNaN(G))throw Xa.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var z=new c(O,0,0,G,0,0);this.ctx.transform=this.ctx.transform.multiply(z)},f.prototype.rotate=function(O){if(isNaN(O))throw Xa.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var G=new c(Math.cos(O),Math.sin(O),-Math.sin(O),Math.cos(O),0,0);this.ctx.transform=this.ctx.transform.multiply(G)},f.prototype.translate=function(O,G){if(isNaN(O)||isNaN(G))throw Xa.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var z=new c(1,0,0,1,O,G);this.ctx.transform=this.ctx.transform.multiply(z)},f.prototype.transform=function(O,G,z,L,Z,ee){if(isNaN(O)||isNaN(G)||isNaN(z)||isNaN(L)||isNaN(Z)||isNaN(ee))throw Xa.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var R=new c(O,G,z,L,Z,ee);this.ctx.transform=this.ctx.transform.multiply(R)},f.prototype.setTransform=function(O,G,z,L,Z,ee){O=isNaN(O)?1:O,G=isNaN(G)?0:G,z=isNaN(z)?0:z,L=isNaN(L)?1:L,Z=isNaN(Z)?0:Z,ee=isNaN(ee)?0:ee,this.ctx.transform=new c(O,G,z,L,Z,ee)};var p=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(O,G,z,L,Z,ee,R,H,ne){var ve=this.pdf.getImageProperties(O),U=1,He=1,se=1,re=1;L!==void 0&&H!==void 0&&(se=H/L,re=ne/Z,U=ve.width/L*H/L,He=ve.height/Z*ne/Z),ee===void 0&&(ee=G,R=z,G=0,z=0),L!==void 0&&H===void 0&&(H=L,ne=Z),L===void 0&&H===void 0&&(H=ve.width,ne=ve.height);var Pe=this.ctx.transform.decompose(),ue=xe(Pe.rotate.shx),we=new c,Me=(we=(we=(we=we.multiply(Pe.translate)).multiply(Pe.skew)).multiply(Pe.scale)).applyToRectangle(new l(ee-G*se,R-z*re,L*U,Z*He));if(this.autoPaging){for(var ze,yt=g.call(this,Me),It=[],Ke=0;Ke<yt.length;Ke+=1)It.indexOf(yt[Ke])===-1&&It.push(yt[Ke]);b(It);for(var wt=It[0],At=It[It.length-1],bt=wt;bt<At+1;bt++){this.pdf.setPage(bt);var ke=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ne=bt===1?this.posY+this.margin[0]:this.margin[0],Ve=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],he=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],le=bt===1?0:Ve+(bt-2)*he;if(this.ctx.clip_path.length!==0){var Be=this.path;ze=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(ze,this.posX+this.margin[3],-le+Ne+this.ctx.prevPageLastElemOffset),j.call(this,"fill",!0),this.path=Be}var je=JSON.parse(JSON.stringify(Me));je=y([je],this.posX+this.margin[3],-le+Ne+this.ctx.prevPageLastElemOffset)[0];var Ae=(bt>wt||bt<At)&&p.call(this);Ae&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ke,he,null).clip().discardPath()),this.pdf.addImage(O,"JPEG",je.x,je.y,je.w,je.h,null,null,ue),Ae&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(O,"JPEG",Me.x,Me.y,Me.w,Me.h,null,null,ue)};var g=function(O,G,z){var L=[];G=G||this.pdf.internal.pageSize.width,z=z||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Z=this.posY+this.ctx.prevPageLastElemOffset;switch(O.type){default:case"mt":case"lt":L.push(Math.floor((O.y+Z)/z)+1);break;case"arc":L.push(Math.floor((O.y+Z-O.radius)/z)+1),L.push(Math.floor((O.y+Z+O.radius)/z)+1);break;case"qct":var ee=ae(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x,O.y);L.push(Math.floor((ee.y+Z)/z)+1),L.push(Math.floor((ee.y+ee.h+Z)/z)+1);break;case"bct":var R=Se(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x2,O.y2,O.x,O.y);L.push(Math.floor((R.y+Z)/z)+1),L.push(Math.floor((R.y+R.h+Z)/z)+1);break;case"rect":L.push(Math.floor((O.y+Z)/z)+1),L.push(Math.floor((O.y+O.h+Z)/z)+1)}for(var H=0;H<L.length;H+=1)for(;this.pdf.internal.getNumberOfPages()<L[H];)v.call(this);return L},v=function(){var O=this.fillStyle,G=this.strokeStyle,z=this.font,L=this.lineCap,Z=this.lineWidth,ee=this.lineJoin;this.pdf.addPage(),this.fillStyle=O,this.strokeStyle=G,this.font=z,this.lineCap=L,this.lineWidth=Z,this.lineJoin=ee},y=function(O,G,z){for(var L=0;L<O.length;L++)switch(O[L].type){case"bct":O[L].x2+=G,O[L].y2+=z;case"qct":O[L].x1+=G,O[L].y1+=z;default:O[L].x+=G,O[L].y+=z}return O},b=function(O){return O.sort(function(G,z){return G-z})},w=function(O,G){var z=this.fillStyle,L=this.strokeStyle,Z=this.lineCap,ee=this.lineWidth,R=Math.abs(ee*this.ctx.transform.scaleX),H=this.lineJoin;if(this.autoPaging){for(var ne,ve,U=JSON.parse(JSON.stringify(this.path)),He=JSON.parse(JSON.stringify(this.path)),se=[],re=0;re<He.length;re++)if(He[re].x!==void 0)for(var Pe=g.call(this,He[re]),ue=0;ue<Pe.length;ue+=1)se.indexOf(Pe[ue])===-1&&se.push(Pe[ue]);for(var we=0;we<se.length;we++)for(;this.pdf.internal.getNumberOfPages()<se[we];)v.call(this);b(se);for(var Me=se[0],ze=se[se.length-1],yt=Me;yt<ze+1;yt++){this.pdf.setPage(yt),this.fillStyle=z,this.strokeStyle=L,this.lineCap=Z,this.lineWidth=R,this.lineJoin=H;var It=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ke=yt===1?this.posY+this.margin[0]:this.margin[0],wt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],At=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],bt=yt===1?0:wt+(yt-2)*At;if(this.ctx.clip_path.length!==0){var ke=this.path;ne=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(ne,this.posX+this.margin[3],-bt+Ke+this.ctx.prevPageLastElemOffset),j.call(this,O,!0),this.path=ke}if(ve=JSON.parse(JSON.stringify(U)),this.path=y(ve,this.posX+this.margin[3],-bt+Ke+this.ctx.prevPageLastElemOffset),G===!1||yt===0){var Ne=(yt>Me||yt<ze)&&p.call(this);Ne&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],It,At,null).clip().discardPath()),j.call(this,O,G),Ne&&this.pdf.restoreGraphicsState()}this.lineWidth=ee}this.path=U}else this.lineWidth=R,j.call(this,O,G),this.lineWidth=ee},j=function(O,G){if((O!=="stroke"||G||!m.call(this))&&(O==="stroke"||G||!h.call(this))){for(var z,L,Z=[],ee=this.path,R=0;R<ee.length;R++){var H=ee[R];switch(H.type){case"begin":Z.push({begin:!0});break;case"close":Z.push({close:!0});break;case"mt":Z.push({start:H,deltas:[],abs:[]});break;case"lt":var ne=Z.length;if(ee[R-1]&&!isNaN(ee[R-1].x)&&(z=[H.x-ee[R-1].x,H.y-ee[R-1].y],ne>0)){for(;ne>=0;ne--)if(Z[ne-1].close!==!0&&Z[ne-1].begin!==!0){Z[ne-1].deltas.push(z),Z[ne-1].abs.push(H);break}}break;case"bct":z=[H.x1-ee[R-1].x,H.y1-ee[R-1].y,H.x2-ee[R-1].x,H.y2-ee[R-1].y,H.x-ee[R-1].x,H.y-ee[R-1].y],Z[Z.length-1].deltas.push(z);break;case"qct":var ve=ee[R-1].x+2/3*(H.x1-ee[R-1].x),U=ee[R-1].y+2/3*(H.y1-ee[R-1].y),He=H.x+2/3*(H.x1-H.x),se=H.y+2/3*(H.y1-H.y),re=H.x,Pe=H.y;z=[ve-ee[R-1].x,U-ee[R-1].y,He-ee[R-1].x,se-ee[R-1].y,re-ee[R-1].x,Pe-ee[R-1].y],Z[Z.length-1].deltas.push(z);break;case"arc":Z.push({deltas:[],abs:[],arc:!0}),Array.isArray(Z[Z.length-1].abs)&&Z[Z.length-1].abs.push(H)}}L=G?null:O==="stroke"?"stroke":"fill";for(var ue=!1,we=0;we<Z.length;we++)if(Z[we].arc)for(var Me=Z[we].abs,ze=0;ze<Me.length;ze++){var yt=Me[ze];yt.type==="arc"?S.call(this,yt.x,yt.y,yt.radius,yt.startAngle,yt.endAngle,yt.counterclockwise,void 0,G,!ue):D.call(this,yt.x,yt.y),ue=!0}else if(Z[we].close===!0)this.pdf.internal.out("h"),ue=!1;else if(Z[we].begin!==!0){var It=Z[we].start.x,Ke=Z[we].start.y;X.call(this,Z[we].deltas,It,Ke),ue=!0}L&&E.call(this,L),G&&F.call(this)}},I=function(O){var G=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,z=G*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return O-z;case"top":return O+G-z;case"hanging":return O+G-2*z;case"middle":return O+G/2-z;default:return O}},_=function(O){return O+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var O=function(){};return O.colorStops=[],O.addColorStop=function(G,z){this.colorStops.push([G,z])},O.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},O.isCanvasGradient=!0,O},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var S=function(O,G,z,L,Z,ee,R,H,ne){for(var ve=ge.call(this,z,L,Z,ee),U=0;U<ve.length;U++){var He=ve[U];U===0&&(ne?k.call(this,He.x1+O,He.y1+G):D.call(this,He.x1+O,He.y1+G)),pe.call(this,O,G,He.x2,He.y2,He.x3,He.y3,He.x4,He.y4)}H?F.call(this):E.call(this,R)},E=function(O){switch(O){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},F=function(){this.pdf.clip(),this.pdf.discardPath()},k=function(O,G){this.pdf.internal.out(r(O)+" "+n(G)+" m")},P=function(O){var G;switch(O.align){case"right":case"end":G="right";break;case"center":G="center";break;default:G="left"}var z,L,Z,ee=this.pdf.getTextDimensions(O.text),R=I.call(this,O.y),H=_.call(this,R)-ee.h,ne=this.ctx.transform.applyToPoint(new o(O.x,R));if(this.autoPaging){var ve=this.ctx.transform.decompose(),U=new c;U=(U=(U=U.multiply(ve.translate)).multiply(ve.skew)).multiply(ve.scale);for(var He=this.ctx.transform.applyToRectangle(new l(O.x,R,ee.w,ee.h)),se=U.applyToRectangle(new l(O.x,H,ee.w,ee.h)),re=g.call(this,se),Pe=[],ue=0;ue<re.length;ue+=1)Pe.indexOf(re[ue])===-1&&Pe.push(re[ue]);b(Pe);for(var we=Pe[0],Me=Pe[Pe.length-1],ze=we;ze<Me+1;ze++){this.pdf.setPage(ze);var yt=ze===1?this.posY+this.margin[0]:this.margin[0],It=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ke=this.pdf.internal.pageSize.height-this.margin[2],wt=Ke-this.margin[0],At=this.pdf.internal.pageSize.width-this.margin[1],bt=At-this.margin[3],ke=ze===1?0:It+(ze-2)*wt;if(this.ctx.clip_path.length!==0){var Ne=this.path;z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(z,this.posX+this.margin[3],-1*ke+yt),j.call(this,"fill",!0),this.path=Ne}var Ve=y([JSON.parse(JSON.stringify(se))],this.posX+this.margin[3],-ke+yt+this.ctx.prevPageLastElemOffset)[0];O.scale>=.01&&(L=this.pdf.internal.getFontSize(),this.pdf.setFontSize(L*O.scale),Z=this.lineWidth,this.lineWidth=Z*O.scale);var he=this.autoPaging!=="text";if(he||Ve.y+Ve.h<=Ke){if(he||Ve.y>=yt&&Ve.x<=At){var le=he?O.text:this.pdf.splitTextToSize(O.text,O.maxWidth||At-Ve.x)[0],Be=y([JSON.parse(JSON.stringify(He))],this.posX+this.margin[3],-ke+yt+this.ctx.prevPageLastElemOffset)[0],je=he&&(ze>we||ze<Me)&&p.call(this);je&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],bt,wt,null).clip().discardPath()),this.pdf.text(le,Be.x,Be.y,{angle:O.angle,align:G,renderingMode:O.renderingMode}),je&&this.pdf.restoreGraphicsState()}}else Ve.y<Ke&&(this.ctx.prevPageLastElemOffset+=Ke-Ve.y);O.scale>=.01&&(this.pdf.setFontSize(L),this.lineWidth=Z)}}else O.scale>=.01&&(L=this.pdf.internal.getFontSize(),this.pdf.setFontSize(L*O.scale),Z=this.lineWidth,this.lineWidth=Z*O.scale),this.pdf.text(O.text,ne.x+this.posX,ne.y+this.posY,{angle:O.angle,align:G,renderingMode:O.renderingMode,maxWidth:O.maxWidth}),O.scale>=.01&&(this.pdf.setFontSize(L),this.lineWidth=Z)},D=function(O,G,z,L){z=z||0,L=L||0,this.pdf.internal.out(r(O+z)+" "+n(G+L)+" l")},X=function(O,G,z){return this.pdf.lines(O,G,z,null,null)},pe=function(O,G,z,L,Z,ee,R,H){this.pdf.internal.out([e(a(z+O)),e(s(L+G)),e(a(Z+O)),e(s(ee+G)),e(a(R+O)),e(s(H+G)),"c"].join(" "))},ge=function(O,G,z,L){for(var Z=2*Math.PI,ee=Math.PI/2;G>z;)G-=Z;var R=Math.abs(z-G);R<Z&&L&&(R=Z-R);for(var H=[],ne=L?-1:1,ve=G;R>1e-5;){var U=ve+ne*Math.min(R,ee);H.push(fe.call(this,O,ve,U)),R-=Math.abs(U-ve),ve=U}return H},fe=function(O,G,z){var L=(z-G)/2,Z=O*Math.cos(L),ee=O*Math.sin(L),R=Z,H=-ee,ne=R*R+H*H,ve=ne+R*Z+H*ee,U=4/3*(Math.sqrt(2*ne*ve)-ve)/(R*ee-H*Z),He=R-U*H,se=H+U*R,re=He,Pe=-se,ue=L+G,we=Math.cos(ue),Me=Math.sin(ue);return{x1:O*Math.cos(G),y1:O*Math.sin(G),x2:He*we-se*Me,y2:He*Me+se*we,x3:re*we-Pe*Me,y3:re*Me+Pe*we,x4:O*Math.cos(z),y4:O*Math.sin(z)}},xe=function(O){return 180*O/Math.PI},ae=function(O,G,z,L,Z,ee){var R=O+.5*(z-O),H=G+.5*(L-G),ne=Z+.5*(z-Z),ve=ee+.5*(L-ee),U=Math.min(O,Z,R,ne),He=Math.max(O,Z,R,ne),se=Math.min(G,ee,H,ve),re=Math.max(G,ee,H,ve);return new l(U,se,He-U,re-se)},Se=function(O,G,z,L,Z,ee,R,H){var ne,ve,U,He,se,re,Pe,ue,we,Me,ze,yt,It,Ke,wt=z-O,At=L-G,bt=Z-z,ke=ee-L,Ne=R-Z,Ve=H-ee;for(ve=0;ve<41;ve++)we=(Pe=(U=O+(ne=ve/40)*wt)+ne*((se=z+ne*bt)-U))+ne*(se+ne*(Z+ne*Ne-se)-Pe),Me=(ue=(He=G+ne*At)+ne*((re=L+ne*ke)-He))+ne*(re+ne*(ee+ne*Ve-re)-ue),ve==0?(ze=we,yt=Me,It=we,Ke=Me):(ze=Math.min(ze,we),yt=Math.min(yt,Me),It=Math.max(It,we),Ke=Math.max(Ke,Me));return new l(Math.round(ze),Math.round(yt),Math.round(It-ze),Math.round(Ke-yt))},Te=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var O,G,z=(O=this.ctx.lineDash,G=this.ctx.lineDashOffset,JSON.stringify({lineDash:O,lineDashOffset:G}));this.prevLineDash!==z&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=z)}}})(Rr.API),function(t){var e=function(o){var l,c,u,d,f,A,h,m,p,g;for(c=[],u=0,d=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;d>u;u+=4)(f=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(A=(f=((f=((f=((f=(f-(g=f%85))/85)-(p=f%85))/85)-(m=f%85))/85)-(h=f%85))/85)%85,c.push(A+33,h+33,m+33,p+33,g+33)):c.push(122);return function(v,y){for(var b=y;b>0;b--)v.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,u,d,f,A=String,h="length",m=255,p="charCodeAt",g="slice",v="replace";for(o[g](-2),o=o[g](0,-2)[v](/\s/g,"")[v]("z","!!!!!"),u=[],d=0,f=(o+=l="uuuuu"[g](o[h]%5||5))[h];f>d;d+=5)c=52200625*(o[p](d)-33)+614125*(o[p](d+1)-33)+7225*(o[p](d+2)-33)+85*(o[p](d+3)-33)+(o[p](d+4)-33),u.push(m&c>>24,m&c>>16,m&c>>8,m&c);return function(y,b){for(var w=b;w>0;w--)y.pop()}(u,l[h]),A.fromCharCode.apply(A,u)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},s=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=wk(l)).reduce(function(u,d){return u+String.fromCharCode(d)},"")};t.processDataByFilters=function(o,l){var c=0,u=o||"",d=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=e(u),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=a(u),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=n(u),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=s(u),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:d.reverse().join(" ")}}}(Rr.API),function(t){t.loadFile=function(e,r,n){return function(a,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,u,d){var f=new XMLHttpRequest,A=0,h=function(m){var p=m.length,g=[],v=String.fromCharCode;for(A=0;A<p;A+=1)g.push(v(255&m.charCodeAt(A)));return g.join("")};if(f.open("GET",c,!u),f.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(f.onload=function(){f.status===200?d(h(this.responseText)):d(void 0)}),f.send(null),u&&f.status===200)return h(f.responseText)}(a,s,o)}catch{}return l}(e,r,n)},t.loadImageFile=t.loadFile}(Rr.API),function(t){function e(){return(gn.html2canvas?Promise.resolve(gn.html2canvas):Kh(()=>Promise.resolve().then(()=>_6),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(gn.DOMPurify?Promise.resolve(gn.DOMPurify):Kh(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=Oa(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},a=function(l,c){var u=document.createElement(l);for(var d in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[d]=c.style[d];return u},s=function l(c,u){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),f=c.firstChild;f;f=f.nextSibling)u!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||d.appendChild(l(f,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft},!0)),d},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),d=l.convert(Promise.resolve(),u);return(d=d.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(u){return this.set({src:a("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=this.opt.jsPDF,d=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,A=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete A.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=d,d)for(var h=0;h<d.length;++h){var m=d[h],p=m.src.find(function(g){return g.format==="truetype"});p&&u.addFont(p.url,m.ref.name,m.ref.style)}return A.windowHeight=A.windowHeight||0,A.windowHeight=A.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):A.windowHeight,u.context2d.save(!0),c(this.prop.container,A)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,d){return Math.floor(u*d/72*96)}return this.then(function(){(l=l||Rr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,d){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,d){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,d?this.progress.stack.concat(d):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(d,f){return u.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(A){return u.updateProgress(null,d),A}).then(d,f).then(function(A){return u.updateProgress(1),A})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var d=this;l&&(l=l.bind(d)),c&&(c=c.bind(d));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?d:o.convert(Object.assign({},d),Promise.prototype),A=u.call(f,l,c);return o.convert(A,d.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Rr.getPageSize=function(l,c,u){if(Oa(l)==="object"){var d=l;l=d.orientation,c=d.unit||c,u=d.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var f,A=(""+u).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+c}var m,p=0,g=0;if(h.hasOwnProperty(A))p=h[A][1]/f,g=h[A][0]/f;else try{p=u[1],g=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",g>p&&(m=g,g=p,p=m);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",p>g&&(m=g,g=p,p=m)}return{width:g,height:p,unit:c,k:f,orientation:l}},t.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(t5):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}}(Rr.API),Rr.API.addJS=function(t){return pV=t,this.internal.events.subscribe("postPutResources",function(){SC=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(SC+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),mV=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+pV+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){SC!==void 0&&mV!==void 0&&this.internal.out("/Names <</JavaScript "+SC+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),s=0;s<a.length;s++){var o=a[s],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(s=0;s<u;s++){var f=r.internal.newObject();d.push(f);var A=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+A.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<d.length;s++)r.internal.write("(page_"+(s+1)+")"+d[s]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,s){var o={title:a,options:s,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var o=n.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var s=0;s<a.children.length;s++)n.count++,this.count_r(n,a.children[s]);return n.count}}])}(Rr.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,a,s,o,l){var c,u=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(f){for(var A,h=256*f.charCodeAt(4)+f.charCodeAt(5),m=f.length,p={width:0,height:0,numcomponents:1},g=4;g<m;g+=2){if(g+=h,e.indexOf(f.charCodeAt(g+1))!==-1){A=256*f.charCodeAt(g+5)+f.charCodeAt(g+6),p={width:256*f.charCodeAt(g+7)+f.charCodeAt(g+8),height:A,numcomponents:f.charCodeAt(g+9)};break}h=256*f.charCodeAt(g+2)+f.charCodeAt(g+3)}return p}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:a}}return d}}(Rr.API),Rr.API.processPNG=function(t,e,r,n){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var a,s=gje(t,{checkCrc:!0}),o=s.width,l=s.height,c=s.channels,u=s.palette,d=s.depth;a=u&&c===1?function(S){for(var E=S.width,F=S.height,k=S.data,P=S.palette,D=S.depth,X=!1,pe=[],ge=[],fe=void 0,xe=!1,ae=0,Se=0;Se<P.length;Se++){var Te=yQ(P[Se],4),O=Te[0],G=Te[1],z=Te[2],L=Te[3];pe.push(O,G,z),L!=null&&(L===0?(ae++,ge.length<1&&ge.push(Se)):L<255&&(xe=!0))}if(xe||ae>1){X=!0,ge=void 0;var Z=E*F;fe=new Uint8Array(Z);for(var ee=new DataView(k.buffer),R=0;R<Z;R++){var H=n5(ee,R,D),ne=yQ(P[H],4)[3];fe[R]=ne}}else ae===0&&(ge=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:X?8:void 0,colorBytes:k,alphaBytes:fe,needSMask:X,palette:pe,mask:ge}}(s):c===2||c===4?function(S){for(var E=S.data,F=S.width,k=S.height,P=S.channels,D=S.depth,X=P===2?"DeviceGray":"DeviceRGB",pe=P-1,ge=F*k,fe=pe,xe=ge*fe,ae=1*ge,Se=Math.ceil(xe*D/8),Te=Math.ceil(ae*D/8),O=new Uint8Array(Se),G=new Uint8Array(Te),z=new DataView(E.buffer),L=new DataView(O.buffer),Z=new DataView(G.buffer),ee=!1,R=0;R<ge;R++){for(var H=R*P,ne=0;ne<fe;ne++)_V(L,n5(z,H+ne,D),R*fe+ne,D);var ve=n5(z,H+fe,D);ve<(1<<D)-1&&(ee=!0),_V(Z,ve,1*R,D)}return{colorSpace:X,colorsPerPixel:pe,sMaskBitsPerComponent:ee?D:void 0,colorBytes:O,alphaBytes:G,needSMask:ee}}(s):function(S){var E=S.data,F=S.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:F,colorsPerPixel:F==="DeviceGray"?1:3,colorBytes:E instanceof Uint16Array?function(k){for(var P=k.length,D=new Uint8Array(2*P),X=new DataView(D.buffer,D.byteOffset,D.byteLength),pe=0;pe<P;pe++)X.setUint16(2*pe,k[pe],!1);return D}(E):E,needSMask:!1}}(s);var f,A,h,m=a,p=m.colorSpace,g=m.colorsPerPixel,v=m.sMaskBitsPerComponent,y=m.colorBytes,b=m.alphaBytes,w=m.needSMask,j=m.palette,I=m.mask,_=null;return n!==Rr.API.image_compression.NONE&&typeof wk=="function"?(_=function(S){var E;switch(S){case Rr.API.image_compression.FAST:E=11;break;case Rr.API.image_compression.MEDIUM:E=13;break;case Rr.API.image_compression.SLOW:E=14;break;default:E=12}return E}(n),f=this.decode.FLATE_DECODE,A="/Predictor ".concat(_," /Colors ").concat(g," /BitsPerComponent ").concat(d," /Columns ").concat(o),t=yV(y,Math.ceil(o*g*d/8),g,d,n),w&&(h=yV(b,Math.ceil(o*v/8),1,v,n))):(f=void 0,A=void 0,t=y,w&&(h=b)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:r,data:t,index:e,filter:f,decodeParameters:A,transparency:I,palette:j,sMask:h,predictor:_,width:o,height:l,bitsPerComponent:d,sMaskBitsPerComponent:v,colorSpace:p}}},function(t){t.processGIF89A=function(e,r,n,a){var s=new Lje(e),o=s.width,l=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},d=new a5(100).encode(u,100);return t.processJPEG.call(this,d,r,n,a)},t.processGIF87A=t.processGIF89A}(Rr.API),Bd.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:a,green:n,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Bd.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){Xa.log("bit decode error:"+r)}},Bd.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<e;a++)for(var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*a*4,l=0;l<8&&8*a+l<this.width;l++){var c=this.palette[s>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Bd.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<t;a++){var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*a*4,l=s>>4,c=15&s,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*a+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},Bd.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*n;if(a<this.palette.length){var o=this.palette[a];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}t!==0&&(this.pos+=4-t)}},Bd.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,l=(s>>5&e)/e*255|0,c=(s>>10&e)/e*255|0,u=s>>15?255:0,d=n*this.width*4+4*a;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=u}this.pos+=t}},Bd.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&r)/r*255|0,u=(o>>11)/e*255|0,d=a*this.width*4+4*s;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=l,this.data[d+3]=255}this.pos+=t}},Bd.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=s,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},Bd.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=s,this.data[l+1]=a,this.data[l+2]=n,this.data[l+3]=o}},Bd.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,n,a){var s=new Bd(e,!1),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new a5(100).encode(c,100);return t.processJPEG.call(this,u,r,n,a)}}(Rr.API),SV.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,n,a){var s=new SV(e),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new a5(100).encode(c,100);return t.processJPEG.call(this,u,r,n,a)}}(Rr.API),Rr.API.processRGBA=function(t,e,r){for(var n=t.data,a=n.length,s=new Uint8Array(a/4*3),o=new Uint8Array(a/4),l=0,c=0,u=0;u<a;u+=4){var d=n[u],f=n[u+1],A=n[u+2],h=n[u+3];s[l++]=d,s[l++]=f,s[l++]=A,o[c++]=h}var m=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:m,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},Rr.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},nx=Rr.API,IC=nx.getCharWidthsArray=function(t,e){var r,n,a=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:a.metadata.Unicode.widths,c=l.fof?l.fof:1,u=e.kerning?e.kerning:a.metadata.Unicode.kerning,d=u.fof?u.fof:1,f=e.doKerning!==!1,A=0,h=t.length,m=0,p=l[0]||c,g=[];for(r=0;r<h;r++)n=t.charCodeAt(r),typeof a.metadata.widthOfString=="function"?g.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+o*(1e3/s)||0)/1e3):(A=f&&Oa(u[n])==="object"&&!isNaN(parseInt(u[n][m],10))?u[n][m]/d:0,g.push((l[n]||p)/c+A)),m=n;return g},gV=nx.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),a=e.charSpace||this.internal.getCharSpace();return nx.processArabic&&(t=nx.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,a)/r:IC.apply(this,arguments).reduce(function(s,o){return s+o},0)},xV=function(t,e,r,n){for(var a=[],s=0,o=t.length,l=0;s!==o&&l+e[s]<r;)l+=e[s],s++;a.push(t.slice(0,s));var c=s;for(l=0;s!==o;)l+e[s]>n&&(a.push(t.slice(c,s)),l=0,c=s),l+=e[s],s++;return c!==s&&a.push(t.slice(c,s)),a},vV=function(t,e,r){r||(r={});var n,a,s,o,l,c,u,d=[],f=[d],A=r.textIndent||0,h=0,m=0,p=t.split(" "),g=IC.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?p[0].length+2:r.lineIndent||0){var v=Array(c).join(" "),y=[];p.map(function(w){(w=w.split(/\s*\n/)).length>1?y=y.concat(w.map(function(j,I){return(I&&j.length?`
`:"")+j})):y.push(w[0])}),p=y,c=gV.apply(this,[v,r])}for(s=0,o=p.length;s<o;s++){var b=0;if(n=p[s],c&&n[0]==`
`&&(n=n.substr(1),b=1),A+h+(m=(a=IC.apply(this,[n,r])).reduce(function(w,j){return w+j},0))>e||b){if(m>e){for(l=xV.apply(this,[n,a,e-(A+h),e]),d.push(l.shift()),d=[l.pop()];l.length;)f.push([l.shift()]);m=a.slice(n.length-(d[0]?d[0].length:0)).reduce(function(w,j){return w+j},0)}else d=[n];f.push(d),A=m+c,h=g}else d.push(n),A+=h+m,h=g}return u=c?function(w,j){return(j?v:"")+w.join(" ")}:function(w){return w.join(" ")},f.map(u)},nx.splitTextToSize=function(t,e,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var f=this.internal.getFont(d.fontName,d.fontStyle),A="Unicode";return f.metadata[A]?{widths:f.metadata[A].widths||{0:1},kerning:f.metadata[A].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/a;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,s.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(vV.apply(this,[n[l],o,s]));return u},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",n={},a={},s=0;s<16;s++)n[r[s]]=e[s],a[e[s]]=r[s];var o=function(A){return"0x"+parseInt(A,10).toString(16)},l=t.__fontmetrics__.compress=function(A){var h,m,p,g,v=["{"];for(var y in A){if(h=A[y],isNaN(parseInt(y,10))?m="'"+y+"'":(y=parseInt(y,10),m=(m=o(y).slice(2)).slice(0,-1)+a[m.slice(-1)]),typeof h=="number")h<0?(p=o(h).slice(3),g="-"):(p=o(h).slice(2),g=""),p=g+p.slice(0,-1)+a[p.slice(-1)];else{if(Oa(h)!=="object")throw new Error("Don't know what to do with value type "+Oa(h)+".");p=l(h)}v.push(m+p)}return v.push("}"),v.join("")},c=t.__fontmetrics__.uncompress=function(A){if(typeof A!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,m,p,g,v={},y=1,b=v,w=[],j="",I="",_=A.length-1,S=1;S<_;S+=1)(g=A[S])=="'"?h?(p=h.join(""),h=void 0):h=[]:h?h.push(g):g=="{"?(w.push([b,p]),b={},p=void 0):g=="}"?((m=w.pop())[0][m[1]]=b,p=void 0,b=m[0]):g=="-"?y=-1:p===void 0?n.hasOwnProperty(g)?(j+=n[g],p=parseInt(j,16)*y,y=1,j=""):j+=g:n.hasOwnProperty(g)?(I+=n[g],b[p]=parseInt(I,16)*y,y=1,p=void 0,I=""):I+=g;return v},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},f={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(A){var h=A.font,m=f.Unicode[h.postScriptName];m&&(h.metadata.Unicode={},h.metadata.Unicode.widths=m.widths,h.metadata.Unicode.kerning=m.kerning);var p=d.Unicode[h.postScriptName];p&&(h.metadata.Unicode.encoding=p,h.encoding=p.codePages[0])}])}(Rr.API),function(t){var e=function(r){for(var n=r.length,a=new Uint8Array(n),s=0;s<n;s++)a[s]=r.charCodeAt(s);return a};t.API.events.push(["addFont",function(r){var n=void 0,a=r.font,s=r.instance;if(!a.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=s.existsFileInVFS(a.postScriptName)===!1?s.loadFile(a.postScriptName):s.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(sE(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(a,n)}}])}(Rr),Rr.API.addSvgAsImage=function(t,e,r,n,a,s,o,l){if(isNaN(e)||isNaN(r))throw Xa.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(a))throw Xa.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=a;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(gn.canvg?Promise.resolve(gn.canvg):Kh(()=>import("./index.es-DK-67Q_H.js"),[])).catch(function(A){return Promise.reject(new Error("Could not load canvg: "+A))}).then(function(A){return A.default?A.default:A}).then(function(A){return A.fromString(u,t,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(A){return A.render(d)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),e,r,n,a,o,l)})},Rr.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(e,r);return this},Rr.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,a,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,d=0,f=0;function A(m,p){var g,v=!1;for(g=0;g<m.length;g+=1)m[g]===p&&(v=!0);return v}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var h=l.length;for(f=0;f<h;f+=1)r[l[f]].value=r[l[f]].defaultValue,r[l[f]].explicitSet=!1}if(Oa(t)==="object"){for(a in t)if(s=t[a],A(l,a)&&s!==void 0){if(r[a].type==="boolean"&&typeof s=="boolean")r[a].value=s;else if(r[a].type==="name"&&A(r[a].valueSet,s))r[a].value=s;else if(r[a].type==="integer"&&Number.isInteger(s))r[a].value=s;else if(r[a].type==="array"){for(u=0;u<s.length;u+=1)if(n=!0,s[u].length===1&&typeof s[u][0]=="number")c.push(String(s[u]-1));else if(s[u].length>1){for(d=0;d<s[u].length;d+=1)typeof s[u][d]!="number"&&(n=!1);n===!0&&c.push([s[u][0]-1,s[u][1]-1].join(" "))}r[a].value="["+c.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,p=[];for(m in r)r[m].explicitSet===!0&&(r[m].type==="name"?p.push("/"+m+" /"+r[m].value):p.push("/"+m+" "+r[m].value));p.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+p.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=s.length+o.length+l.length+a.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(a+s+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(Rr.API),function(t){var e=t.API,r=e.pdfEscape16=function(s,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],f=0,A=s.length;f<A;++f){if(l=o.metadata.characterToGlyph(s.charCodeAt(f)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=s.charCodeAt(f),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return d.join("");l=l.toString(16),d.push(u[4-l.length],l)}return d.join("")},n=function(s){var o,l,c,u,d,f,A;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,A=(l=Object.keys(s).sort(function(h,m){return h-m})).length;f<A;f++)o=l[f],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(u=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var f=l.metadata.Unicode.widths,A=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),h="",m=0;m<A.length;m++)h+=String.fromCharCode(A[m]);var p=u();d({data:h,addLength1:!0,objectId:p}),c("endobj");var g=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var v=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+_x(l.fontName)),c("/FontFile2 "+p+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var y=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+_x(l.fontName)),c("/FontDescriptor "+v+" 0 R"),c("/W "+t.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+g+" 0 R"),c("/BaseFont /"+_x(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+y+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var f=l.metadata.rawData,A="",h=0;h<f.length;h++)A+=String.fromCharCode(f[h]);var m=u();d({data:A,addLength1:!0,objectId:m}),c("endobj");var p=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:p}),c("endobj");var g=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+m+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+_x(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var v=0;v<l.metadata.hmtx.widths.length;v++)l.metadata.hmtx.widths[v]=parseInt(l.metadata.hmtx.widths[v]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+p+" 0 R/BaseFont/"+_x(l.fontName)+"/FontDescriptor "+g+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]);var a=function(s){var o,l=s.text||"",c=s.x,u=s.y,d=s.options||{},f=s.mutex||{},A=f.pdfEscape,h=f.activeFontKey,m=f.fonts,p=h,g="",v=0,y="",b=m[p].encoding;if(m[p].encoding!=="Identity-H")return{text:l,x:c,y:u,options:d,mutex:f};for(y=l,p=h,Array.isArray(l)&&(y=l[0]),v=0;v<y.length;v+=1)m[p].metadata.hasOwnProperty("cmap")&&(o=m[p].metadata.cmap.unicode.codeMap[y[v].charCodeAt(0)]),o||y[v].charCodeAt(0)<256&&m[p].metadata.hasOwnProperty("Unicode")?g+=y[v]:g+="";var w="";return parseInt(p.slice(1))<14||b==="WinAnsiEncoding"?w=A(g,p).split("").map(function(j){return j.charCodeAt(0).toString(16)}).join(""):b==="Identity-H"&&(w=r(g,m[p])),f.isHex=!0,{text:w,x:c,y:u,options:d,mutex:f}};e.events.push(["postProcessText",function(s){var o=s.text||"",l=[],c={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([a(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(a(Object.assign({},c,{text:o[u]})).text);s.text=l}else s.text=a(Object.assign({},c,{text:o})).text}])}(Rr),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Rr.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var a,s,o,l,c,u,d,f=e,A=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},p={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},g=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],v=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),y=!1,b=0;this.__bidiEngine__={};var w=function(k){var P=k.charCodeAt(),D=P>>8,X=p[D];return X!==void 0?f[256*X+(255&P)]:D===252||D===253?"AL":v.test(D)?"L":D===8?"R":"N"},j=function(k){for(var P,D=0;D<k.length;D++){if((P=w(k.charAt(D)))==="L")return!1;if(P==="R")return!0}return!1},I=function(k,P,D,X){var pe,ge,fe,xe,ae=P[X];switch(ae){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":y=!1;break;case"N":case"AN":break;case"EN":y&&(ae="AN");break;case"AL":y=!0,ae="R";break;case"WS":case"BN":ae="N";break;case"CS":X<1||X+1>=P.length||(pe=D[X-1])!=="EN"&&pe!=="AN"||(ge=P[X+1])!=="EN"&&ge!=="AN"?ae="N":y&&(ge="AN"),ae=ge===pe?ge:"N";break;case"ES":ae=(pe=X>0?D[X-1]:"B")==="EN"&&X+1<P.length&&P[X+1]==="EN"?"EN":"N";break;case"ET":if(X>0&&D[X-1]==="EN"){ae="EN";break}if(y){ae="N";break}for(fe=X+1,xe=P.length;fe<xe&&P[fe]==="ET";)fe++;ae=fe<xe&&P[fe]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(xe=P.length,fe=X+1;fe<xe&&P[fe]==="NSM";)fe++;if(fe<xe){var Se=k[X],Te=Se>=1425&&Se<=2303||Se===64286;if(pe=P[fe],Te&&(pe==="R"||pe==="AL")){ae="R";break}}}ae=X<1||(pe=P[X-1])==="B"?"N":D[X-1];break;case"B":y=!1,a=!0,ae=b;break;case"S":s=!0,ae="N"}return ae},_=function(k,P,D){var X=k.split("");return D&&S(X,D,{hiLevel:b}),X.reverse(),P&&P.reverse(),X.join("")},S=function(k,P,D){var X,pe,ge,fe,xe,ae=-1,Se=k.length,Te=0,O=[],G=b?h:A,z=[];for(y=!1,a=!1,s=!1,pe=0;pe<Se;pe++)z[pe]=w(k[pe]);for(ge=0;ge<Se;ge++){if(xe=Te,O[ge]=I(k,z,O,ge),X=240&(Te=G[xe][m[O[ge]]]),Te&=15,P[ge]=fe=G[Te][5],X>0)if(X===16){for(pe=ae;pe<ge;pe++)P[pe]=1;ae=-1}else ae=-1;if(G[Te][6])ae===-1&&(ae=ge);else if(ae>-1){for(pe=ae;pe<ge;pe++)P[pe]=fe;ae=-1}z[ge]==="B"&&(P[ge]=0),D.hiLevel|=fe}s&&function(L,Z,ee){for(var R=0;R<ee;R++)if(L[R]==="S"){Z[R]=b;for(var H=R-1;H>=0&&L[H]==="WS";H--)Z[H]=b}}(z,P,Se)},E=function(k,P,D,X,pe){if(!(pe.hiLevel<k)){if(k===1&&b===1&&!a)return P.reverse(),void(D&&D.reverse());for(var ge,fe,xe,ae,Se=P.length,Te=0;Te<Se;){if(X[Te]>=k){for(xe=Te+1;xe<Se&&X[xe]>=k;)xe++;for(ae=Te,fe=xe-1;ae<fe;ae++,fe--)ge=P[ae],P[ae]=P[fe],P[fe]=ge,D&&(ge=D[ae],D[ae]=D[fe],D[fe]=ge);Te=xe}Te++}}},F=function(k,P,D){var X=k.split(""),pe={hiLevel:b};return D||(D=[]),S(X,D,pe),function(ge,fe,xe){if(xe.hiLevel!==0&&d)for(var ae,Se=0;Se<ge.length;Se++)fe[Se]===1&&(ae=g.indexOf(ge[Se]))>=0&&(ge[Se]=g[ae+1])}(X,D,pe),E(2,X,P,D,pe),E(1,X,P,D,pe),X.join("")};return this.__bidiEngine__.doBidiReorder=function(k,P,D){if(function(pe,ge){if(ge)for(var fe=0;fe<pe.length;fe++)ge[fe]=fe;l===void 0&&(l=j(pe)),u===void 0&&(u=j(pe))}(k,P),o||!c||u)if(o&&c&&l^u)b=l?1:0,k=_(k,P,D);else if(!o&&c&&u)b=l?1:0,k=F(k,P,D),k=_(k,P);else if(!o||l||c||u){if(o&&!c&&l^u)k=_(k,P),l?(b=0,k=F(k,P,D)):(b=1,k=F(k,P,D),k=_(k,P));else if(o&&l&&!c&&u)b=1,k=F(k,P,D),k=_(k,P);else if(!o&&!c&&l^u){var X=d;l?(b=1,k=F(k,P,D),b=0,d=!1,k=F(k,P,D),d=X):(b=0,k=F(k,P,D),k=_(k,P),b=1,d=!1,k=F(k,P,D),d=X,k=_(k,P))}}else b=0,k=F(k,P,D);else b=l?1:0,k=F(k,P,D);return k},this.__bidiEngine__.setOptions=function(k){k&&(o=k.isInputVisual,c=k.isOutputVisual,l=k.isInputRtl,u=k.isOutputRtl,d=k.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var s=n.options||{};n.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(a)==="[object Array]"){var l=0;for(o=[],l=0;l<a.length;l+=1)Object.prototype.toString.call(a[l])==="[object Array]"?o.push([r.doBidiReorder(a[l][0]),a[l][1],a[l][2]]):o.push([r.doBidiReorder(a[l])]);n.text=o}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])}(Rr),Rr.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new fm(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new ePe(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new Uje(this.contents),this.head=new Vje(this),this.name=new qje(this),this.cmap=new vre(this),this.toUnicode={},this.hhea=new Hje(this),this.maxp=new zje(this),this.hmtx=new Wje(this),this.post=new Gje(this),this.os2=new $je(this),this.loca=new Zje(this),this.glyf=new Xje(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,a,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],u.push(Math.round(e*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(r=a>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var a,s,o,l;for(o=0,s=0,l=(e=""+e).length;0<=l?s<l:s>l;s=0<=l?++s:--s)a=e.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return o*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t}();var hf,fm=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,a;for(a=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(e.charCodeAt(r)));return a},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,a,s,o,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^s)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*a+16777216*s+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,a,s;for(s=[],n=0,a=e.length;n<a;n++)r=e[n],s.push(this.writeByte(r));return s},t}(),Uje=function(){var t;function e(r){var n,a,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,s=this.tableCount;0<=s?a<s:a>s;a=0<=s?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,a,s,o,l,c,u,d,f,A,h,m,p;for(p in h=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(h)/c),o=Math.floor(f/c),d=16*h-f,(a=new fm).writeInt(this.scalarType),a.writeShort(h),a.writeShort(f),a.writeShort(o),a.writeShort(d),s=16*h,u=a.pos+s,l=null,m=[],r)for(A=r[p],a.writeString(p),a.writeInt(t(A)),a.writeInt(u),a.writeInt(A.length),m=m.concat(A),p==="head"&&(l=u),u+=A.length;u%4;)m.push(0),u++;return a.write(m),n=2981146554-t(a.data),a.pos=l+8,a.writeUInt32(n),a.data},t=function(r){var n,a,s,o;for(r=yre.call(r);r.length%4;)r.push(0);for(s=new fm(r),a=0,n=0,o=r.length;n<o;n=n+=4)a+=s.readUInt32();return 4294967295&a},e}(),Qje={}.hasOwnProperty,eh=function(t,e){for(var r in e)Qje.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};hf=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var Vje=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return eh(t,hf),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new fm).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t}(),IV=function(){function t(e,r){var n,a,s,o,l,c,u,d,f,A,h,m,p,g,v,y,b;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),f=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(h=e.readUInt16(),A=h/2,e.pos+=6,s=function(){var w,j;for(j=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)j.push(e.readUInt16());return j}(),e.pos+=2,p=function(){var w,j;for(j=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)j.push(e.readUInt16());return j}(),u=function(){var w,j;for(j=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)j.push(e.readUInt16());return j}(),d=function(){var w,j;for(j=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)j.push(e.readUInt16());return j}(),a=(this.length-e.pos+this.offset)/2,l=function(){var w,j;for(j=[],c=w=0;0<=a?w<a:w>a;c=0<=a?++w:--w)j.push(e.readUInt16());return j}(),c=v=0,b=s.length;v<b;c=++v)for(g=s[c],n=y=m=p[c];m<=g?y<=g:y>=g;n=m<=g?++y:--y)d[c]===0?o=n+u[c]:(o=l[d[c]/2+(n-m)-(A-c)]||0)!==0&&(o+=u[c]),this.codeMap[n]=65535&o}e.pos=f}return t.encode=function(e,r){var n,a,s,o,l,c,u,d,f,A,h,m,p,g,v,y,b,w,j,I,_,S,E,F,k,P,D,X,pe,ge,fe,xe,ae,Se,Te,O,G,z,L,Z,ee,R,H,ne,ve,U;switch(X=new fm,o=Object.keys(e).sort(function(He,se){return He-se}),r){case"macroman":for(p=0,g=function(){var He=[];for(m=0;m<256;++m)He.push(0);return He}(),y={0:0},s={},pe=0,ae=o.length;pe<ae;pe++)y[H=e[a=o[pe]]]==null&&(y[H]=++p),s[a]={old:e[a],new:y[e[a]]},g[a]=y[e[a]];return X.writeUInt16(1),X.writeUInt16(0),X.writeUInt32(12),X.writeUInt16(0),X.writeUInt16(262),X.writeUInt16(0),X.write(g),{charMap:s,subtable:X.data,maxGlyphID:p+1};case"unicode":for(P=[],f=[],b=0,y={},n={},v=u=null,ge=0,Se=o.length;ge<Se;ge++)y[j=e[a=o[ge]]]==null&&(y[j]=++b),n[a]={old:j,new:y[j]},l=y[j]-a,v!=null&&l===u||(v&&f.push(v),P.push(a),u=l),v=a;for(v&&f.push(v),f.push(65535),P.push(65535),F=2*(E=P.length),S=2*Math.pow(Math.log(E)/Math.LN2,2),A=Math.log(S/2)/Math.LN2,_=2*E-S,c=[],I=[],h=[],m=fe=0,Te=P.length;fe<Te;m=++fe){if(k=P[m],d=f[m],k===65535){c.push(0),I.push(0);break}if(k-(D=n[k].new)>=32768)for(c.push(0),I.push(2*(h.length+E-m)),a=xe=k;k<=d?xe<=d:xe>=d;a=k<=d?++xe:--xe)h.push(n[a].new);else c.push(D-k),I.push(0)}for(X.writeUInt16(3),X.writeUInt16(1),X.writeUInt32(12),X.writeUInt16(4),X.writeUInt16(16+8*E+2*h.length),X.writeUInt16(0),X.writeUInt16(F),X.writeUInt16(S),X.writeUInt16(A),X.writeUInt16(_),ee=0,O=f.length;ee<O;ee++)a=f[ee],X.writeUInt16(a);for(X.writeUInt16(0),R=0,G=P.length;R<G;R++)a=P[R],X.writeUInt16(a);for(ne=0,z=c.length;ne<z;ne++)l=c[ne],X.writeUInt16(l);for(ve=0,L=I.length;ve<L;ve++)w=I[ve],X.writeUInt16(w);for(U=0,Z=h.length;U<Z;U++)p=h[U],X.writeUInt16(p);return{charMap:n,subtable:X.data,maxGlyphID:b+1}}},t}(),vre=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return eh(t,hf),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,n,a;for(e.pos=this.offset,this.version=e.readUInt16(),a=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=a?n<a:n>a;n=0<=a?++n:--n)r=new IV(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var n,a;return r==null&&(r="macroman"),n=IV.encode(e,r),(a=new fm).writeUInt16(0),a.writeUInt16(1),n.table=a.data.concat(n.subtable),n},t}(),Hje=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return eh(t,hf),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),$je=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return eh(t,hf),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(e.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(e.readInt());return n}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(e.readInt());return n}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),Gje=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return eh(t,hf),t.prototype.tag="post",t.prototype.parse=function(e){var r,n,a;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(n=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],a=[];e.pos<this.offset+this.length;)r=e.readByte(),a.push(this.names.push(e.readString(r)));return a;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)c.push(e.readUInt32());return c}).call(this)}},t}(),Kje=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},qje=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return eh(t,hf),t.prototype.tag="name",t.prototype.parse=function(e){var r,n,a,s,o,l,c,u,d,f,A;for(e.pos=this.offset,e.readShort(),r=e.readShort(),l=e.readShort(),n=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},s=d=0,f=n.length;d<f;s=++d)a=n[s],e.pos=a.offset,u=e.readString(a.length),o=new Kje(u,a),c[A=a.nameID]==null&&(c[A]=[]),c[a.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t}(),zje=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return eh(t,hf),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),Wje=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return eh(t,hf),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,n,a,s,o,l,c;for(e.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,d;for(d=[],r=u=0;0<=a?u<a:u>a;r=0<=a?++u:--u)d.push(e.readInt16());return d}(),this.widths=(function(){var u,d,f,A;for(A=[],u=0,d=(f=this.metrics).length;u<d;u++)s=f[u],A.push(s.advance);return A}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=a?o<a:o>a;r=0<=a?++o:--o)c.push(this.widths.push(n));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),yre=[].slice,Xje=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return eh(t,hf),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,n,a,s,o,l,c,u,d,f;return e in this.cache?this.cache[e]:(s=this.file.loca,r=this.file.contents,n=s.indexOf(e),(a=s.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+n,o=(l=new fm(r.read(a))).readShort(),u=l.readShort(),f=l.readShort(),c=l.readShort(),d=l.readShort(),this.cache[e]=o===-1?new Jje(l,u,f,c,d):new Yje(l,o,u,f,c,d),this.cache[e]))},t.prototype.encode=function(e,r,n){var a,s,o,l,c;for(o=[],s=[],l=0,c=r.length;l<c;l++)a=e[r[l]],s.push(o.length),a&&(o=o.concat(a.encode(n)));return s.push(o.length),{table:o,offsets:s}},t}(),Yje=function(){function t(e,r,n,a,s,o){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=s,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),Jje=function(){function t(e,r,n,a,s){var o,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new fm(yre.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),Zje=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return eh(t,hf),t.prototype.tag="loca",t.prototype.parse=function(e){var r,n;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var a,s;for(s=[],n=0,a=this.length;n<a;n+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var a,s;for(s=[],n=0,a=this.length;n<a;n+=4)s.push(e.readUInt32());return s}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var n=new Uint32Array(this.offsets.length),a=0,s=0,o=0;o<n.length;++o)if(n[o]=a,s<r.length&&r[s]==o){++s,n[o]=a;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(a+=c)}for(var u=new Array(4*n.length),d=0;d<n.length;++d)u[4*d+3]=255&n[d],u[4*d+2]=(65280&n[d])>>8,u[4*d+1]=(16711680&n[d])>>16,u[4*d]=(4278190080&n[d])>>24;return u},t}(),ePe=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,a,s;for(r in a=this.font.cmap.tables[0].codeMap,e={},s=this.subset)n=s[r],e[r]=a[n];return e},t.prototype.glyphsFor=function(e){var r,n,a,s,o,l,c;for(a={},o=0,l=e.length;o<l;o++)a[s=e[o]]=this.font.glyf.glyphFor(s);for(s in r=[],a)(n=a[s])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(s in c=this.glyphsFor(r))n=c[s],a[s]=n;return a},t.prototype.encode=function(e,r){var n,a,s,o,l,c,u,d,f,A,h,m,p,g,v;for(a in n=vre.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),h={0:0},v=n.charMap)h[(c=v[a]).old]=c.new;for(m in A=n.maxGlyphID,o)m in h||(h[m]=A++);return d=function(y){var b,w;for(b in w={},y)w[y[b]]=b;return w}(h),f=Object.keys(d).sort(function(y,b){return y-b}),p=function(){var y,b,w;for(w=[],y=0,b=f.length;y<b;y++)l=f[y],w.push(d[l]);return w}(),s=this.font.glyf.encode(o,p,h),u=this.font.loca.encode(s.offsets,p),g={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(g["OS/2"]=this.font.os2.raw()),this.font.directory.encode(g)},t}();Rr.API.PDFObject=function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,a,s,o;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(e.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in s=["<<"],r)o=r[a],s.push("/"+a+" "+e.convert(o));return s.push(">>"),s.join(`
`)}return""+r},e}();const Pk=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:Bje,AcroFormAppearance:Vr,AcroFormButton:no,AcroFormCheckBox:yb,AcroFormChoiceField:Ep,AcroFormComboBox:Ip,AcroFormEditBox:xb,AcroFormListBox:Sp,AcroFormPasswordField:bb,AcroFormPushButton:vb,AcroFormRadioButton:jp,AcroFormTextField:J0,GState:y2,ShadingPattern:E0,TilingPattern:mp,default:Rr,jsPDF:Rr},Symbol.toStringTag,{value:"Module"}));async function jV(t){const e={...t,remaining:t.quantity,status:"PENDIENTE",createdAt:dr.now()};return On(_t(Fe,"inventory_batches"),e)}async function bre(t,e){await pn(Yt(Fe,"inventory_batches",t),{status:"PAGADO",paidAmount:null,paidAt:dr.now()})}async function tPe(t,e){const r=er(_t(Fe,"batch_allocations"),cr("saleDate",">=",t),cr("saleDate","<=",e)),n=await Qt(r),a={};return n.forEach(s=>{const o=s.data(),l=o.batchId;a[l]||(a[l]={batchId:o.batchId,batchDate:o.batchDate,productName:o.productName,quantity:0,amountCharged:0}),a[l].quantity+=Number(o.quantity||0),a[l].amountCharged+=Number(o.amountCharged||0)}),Object.values(a)}async function wre(t){const e=Yt(Fe,"salesV2",t),r=await Bs(e);if(!r.exists())throw new Error("La venta no existe.");const n=r.data(),a=[];if(Array.isArray(n.items)){for(const l of n.items)if(Array.isArray(l==null?void 0:l.allocations))for(const c of l.allocations){const u=String((c==null?void 0:c.batchId)||"").trim(),d=Number((c==null?void 0:c.qty)||0);u&&d&&a.push({batchId:u,qty:d})}}if(Array.isArray(n.allocations))for(const l of n.allocations){const c=String((l==null?void 0:l.batchId)||"").trim(),u=Number((l==null?void 0:l.qty)||0);c&&u&&a.push({batchId:c,qty:u})}if(a.length===0)return await Ii(Fe,async l=>{l.delete(e)}),{restored:0};const s=new Map;for(const l of a)s.set(l.batchId,Number((s.get(l.batchId)||0)+l.qty));let o=0;return await Ii(Fe,async l=>{const c=Array.from(s.entries()),u=c.map(([f])=>Yt(Fe,"inventory_batches",f)),d=await Promise.all(u.map(f=>l.get(f)));c.forEach(([f,A],h)=>{const m=d[h];if(!m.exists())return;const p=m.data(),g=Number((p==null?void 0:p.remaining)??0),v=Number((g+Number(A||0)).toFixed(3));l.update(u[h],{remaining:v}),o+=Number(A||0)}),l.delete(e)}),{restored:o}}var Nre={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},PV=ko.createContext&&ko.createContext(Nre),rPe=["attr","size","title"];function nPe(t,e){if(t==null)return{};var r=aPe(t,e),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)n=s[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function aPe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function NS(){return NS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},NS.apply(this,arguments)}function BV(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function CS(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?BV(Object(r),!0).forEach(function(n){sPe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):BV(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function sPe(t,e,r){return e=iPe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iPe(t){var e=oPe(t,"string");return typeof e=="symbol"?e:e+""}function oPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cre(t){return t&&t.map((e,r)=>ko.createElement(e.tag,CS({key:r},e.attr),Cre(e.child)))}function lPe(t){return e=>ko.createElement(cPe,NS({attr:CS({},t.attr)},e),Cre(t.child))}function cPe(t){var e=r=>{var{attr:n,size:a,title:s}=t,o=nPe(t,rPe),l=a||r.size||"1em",c;return r.className&&(c=r.className),t.className&&(c=(c?c+" ":"")+t.className),ko.createElement("svg",NS({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,o,{className:c,style:CS(CS({color:t.color||r.color},r.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),s&&ko.createElement("title",null,s),t.children)};return PV!==void 0?ko.createElement(PV.Consumer,null,r=>e(r)):e(Nre)}function uPe(t){return lPe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"},child:[]},{tag:"polyline",attr:{points:"1 20 1 14 7 14"},child:[]},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"},child:[]}]})(t)}function pc({onClick:t,loading:e,className:r=""}){return i.jsxs("button",{onClick:t,disabled:e,className:`flex items-center gap-2 px-3 py-1.5 rounded-2xl  border 
        bg-white hover:bg-gray-100 text-sm font-medium shadow-2xl
        disabled:opacity-50 disabled:cursor-not-allowed ${r}`,title:"Refrescar datos",children:[i.jsx(uPe,{className:`w-4 h-4 ${e?"animate-spin text-blue-500":""}`}),e?"Actualizando...":"Refrescar"]})}function gc(){const[t,e]=x.useState(0),r=x.useCallback(()=>e(n=>n+1),[]);return{refreshKey:t,refresh:r}}const Wo=t=>Math.round((Number(t)||0)*100)/100,mh=t=>Math.round((Number(t)||0)*1e3)/1e3,Ou=t=>Number(t??0).toFixed(2),ph=t=>Number(t??0).toFixed(3),TV=(t,e)=>{var o;const r=t.date?String(t.date):"",n=(o=t.timestamp)!=null&&o.toDate?Nr(t.timestamp.toDate(),"yyyy-MM-dd"):"";let a=r||n;if(r&&n){const l=new Date(r+"T00:00:00").getTime(),c=new Date(n+"T00:00:00").getTime(),u=Math.abs(l-c)/(1e3*60*60*24);isFinite(u)&&u>30&&(a=n)}if(!a)return[];const s=t.type??"CONTADO";return Array.isArray(t.items)&&t.items.length>0?t.items.map((l,c)=>{const u=Number((l==null?void 0:l.qty)??0),d=Number((l==null?void 0:l.lineFinal)??0)||Math.max(0,Number((l==null?void 0:l.unitPrice)||0)*u-Number((l==null?void 0:l.discount)||0));return{id:`${e}#${c}`,productName:String((l==null?void 0:l.productName)??"(sin nombre)"),quantity:u,amount:Wo(d),amountSuggested:Number(t.amountSuggested??0),date:a,userEmail:t.userEmail??t.vendor??"(sin usuario)",clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",type:s,measurement:String((l==null?void 0:l.measurement)??t.measurement??""),allocations:Array.isArray(l==null?void 0:l.allocations)?l.allocations:t.allocations,avgUnitCost:Number((l==null?void 0:l.avgUnitCost)??t.avgUnitCost??0),cogsAmount:Number((l==null?void 0:l.cogsAmount)??0)}}):[{id:e,productName:t.productName??"(sin nombre)",quantity:Number(t.quantity??0),amount:Number(t.amount??t.amountCharged??0),amountSuggested:Number(t.amountSuggested??0),date:a,userEmail:t.userEmail??t.vendor??"(sin usuario)",clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",type:s,measurement:String(t.measurement??""),allocations:t.allocations,avgUnitCost:t.avgUnitCost,cogsAmount:t.cogsAmount}]};function dPe({role:t,roles:e}){const[r,n]=x.useState([]),[a,s]=x.useState([]),[o,l]=x.useState(null),[c,u]=x.useState(!0),[d,f]=x.useState(""),[A,h]=x.useState("ALL"),[m,p]=x.useState("ALL"),[g,v]=x.useState({}),[y,b]=x.useState(null),[w,j]=x.useState(0),[I,_]=x.useState(0),[S,E]=x.useState(""),[F,k]=x.useState(0),[P,D]=x.useState("0"),X=Nr(new Date,"yyyy-MM-dd"),[pe,ge]=x.useState(X),[fe,xe]=x.useState(X),[ae,Se]=x.useState(!1),[Te,O]=x.useState(!1),[G,z]=x.useState(!1),[L,Z]=x.useState(""),ee=x.useRef(null),{refreshKey:R,refresh:H}=gc(),ne=e&&e.length?e:t,ve=Rye(ne,"bills","cerrarVentas"),U=sn(ne,"admin"),He=({title:de,open:Ce,onToggle:nt,right:vt})=>i.jsxs("button",{type:"button",onClick:nt,className:"w-full flex items-center justify-between gap-3 px-4 py-3 rounded-xl border bg-gray-50 hover:bg-gray-100 active:bg-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[i.jsx("span",{className:"font-semibold truncate",children:de}),vt?i.jsx("span",{className:"text-xs text-gray-600",children:vt}):null]}),i.jsx("div",{className:"shrink-0 text-lg font-bold leading-none",children:Ce?"":"+"})]});x.useEffect(()=>{if(!pe||!fe)return;u(!0);const de=er(_t(Fe,"salesV2"),cr("date",">=",pe),cr("date","<=",fe)),Ce=cd(de,nt=>{const vt=[];nt.forEach(ht=>{const xt=TV(ht.data(),ht.id);vt.push(...xt)}),n(vt),u(!1)},nt=>{console.error("Error cargando ventas por periodo:",nt),n([]),u(!1)});return()=>Ce()},[pe,fe,R]),x.useEffect(()=>{if(!pe||!fe)return;const de=er(_t(Fe,"salesV2"),cr("status","==","FLOTANTE"),cr("date",">=",pe),cr("date","<=",fe)),Ce=cd(de,nt=>{const vt=[];nt.forEach(ht=>{const xt=TV(ht.data(),ht.id);vt.push(...xt)}),s(vt)});return()=>Ce()},[pe,fe,R]),x.useEffect(()=>{(async()=>{try{const de=await Qt(_t(Fe,"users")),Ce={};de.forEach(nt=>{const vt=nt.data(),ht=String(vt.email||"").trim().toLowerCase(),xt=String(vt.name||"").trim();ht&&(Ce[ht]=xt||vt.email||"")}),v(Ce)}catch(de){console.error("Error cargando usuarios:",de),v({})}})()},[]);const se=de=>{const Ce=String(de||"").trim().toLowerCase();return g[Ce]||de||""};x.useEffect(()=>{(async()=>{const Ce=er(_t(Fe,"daily_closures"),cr("date","==",X)),nt=await Qt(Ce);if(nt.empty)l(null);else{const vt=nt.docs[0];l({id:vt.id,...vt.data()})}})()},[X,R]);const re=ko.useMemo(()=>{let de=[];if(A==="FLOTANTE"){const nt=[...r,...a],vt=new Map;for(const ht of nt)ht.status==="FLOTANTE"&&vt.set(ht.id,ht);de=Array.from(vt.values())}else if(A==="ALL"){const nt=[...r,...a],vt=new Map;for(const ht of nt)vt.set(ht.id,ht);de=Array.from(vt.values())}else de=r.filter(nt=>nt.status==="PROCESADA");m!=="ALL"&&(de=de.filter(nt=>nt.type===m));const Ce=L.trim().toLowerCase();if(Ce){const nt=ht=>String(ht||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),vt=nt(Ce);de=de.filter(ht=>nt(ht.productName).includes(vt))}return de},[A,r,a,L,m]),Pe=Wo(re.reduce((de,Ce)=>de+(Ce.amount||0),0)),ue=Wo(re.reduce((de,Ce)=>de+Number(Ce.cogsAmount??0),0)),we=de=>String(de||"").trim().toLowerCase()!=="lb",Me=re.filter(de=>de.type==="CONTADO"),ze=re.filter(de=>de.type==="CREDITO"),yt=mh(Me.filter(de=>we(de.measurement)).reduce((de,Ce)=>de+(Ce.quantity||0),0)),It=mh(Me.filter(de=>!we(de.measurement)).reduce((de,Ce)=>de+(Ce.quantity||0),0)),Ke=mh(ze.filter(de=>we(de.measurement)).reduce((de,Ce)=>de+(Ce.quantity||0),0)),wt=mh(ze.filter(de=>!we(de.measurement)).reduce((de,Ce)=>de+(Ce.quantity||0),0)),At=Wo(Me.reduce((de,Ce)=>de+(Ce.amount||0),0)),bt=Wo(ze.reduce((de,Ce)=>de+(Ce.amount||0),0)),ke=Wo(Me.reduce((de,Ce)=>de+Number(Ce.cogsAmount??0),0)),Ne=Wo(ze.reduce((de,Ce)=>de+Number(Ce.cogsAmount??0),0)),Ve=Wo(At-ke),he=Wo(bt-Ne),le=mh(yt+Ke),Be=mh(It+wt),je=Wo(At+bt),Ae={};re.forEach(de=>{const Ce=de.productName||"(sin nombre)";Ae[Ce]||(Ae[Ce]={totalQuantity:0,totalAmount:0}),Ae[Ce].totalQuantity=mh(Ae[Ce].totalQuantity+(de.quantity||0)),Ae[Ce].totalAmount=Wo(Ae[Ce].totalAmount+(de.amount||0))});const Qe=Object.entries(Ae).map(([de,Ce])=>({productName:de,totalQuantity:Ce.totalQuantity,totalAmount:Ce.totalAmount})),Ct=async()=>{try{const de=re.filter(be=>be.status==="FLOTANTE"),Ce=de.length>0?de:r.filter(be=>be.status!=="PROCESADA");if(Ce.length===0){f("No hay ventas para procesar.");return}const nt={totalCharged:Wo(Ce.reduce((be,st)=>be+(st.amount||0),0)),totalSuggested:Wo(Ce.reduce((be,st)=>be+(st.amountSuggested||0),0)),totalUnits:mh(Ce.reduce((be,st)=>be+(st.quantity||0),0)),totalCOGS:Wo(Ce.reduce((be,st)=>be+Number(st.cogsAmount??0),0))},vt=Wo(nt.totalCharged-nt.totalSuggested),ht=Wo(nt.totalCharged-nt.totalCOGS),xt=await On(_t(Fe,"daily_closures"),{date:X,createdAt:dr.now(),periodStart:pe,periodEnd:fe,totalCharged:nt.totalCharged,totalSuggested:nt.totalSuggested,totalDifference:vt,totalUnits:nt.totalUnits,totalCOGS:nt.totalCOGS,grossProfit:ht,products:Ce.map(be=>({productName:be.productName,quantity:be.quantity,amount:be.amount})),salesV2:Ce.map(be=>({id:be.id,productName:be.productName,quantity:be.quantity,amount:be.amount,amountSuggested:be.amountSuggested,userEmail:be.userEmail,clientName:be.clientName,amountReceived:be.amountReceived,change:be.change,status:be.status,cogsAmount:be.cogsAmount??0,avgUnitCost:be.avgUnitCost??null,allocations:be.allocations??[],date:be.date})),productSummary:Object.entries(Ce.reduce((be,st)=>{const K=st.productName||"(sin nombre)";return be[K]||(be[K]={totalQuantity:0,totalAmount:0}),be[K].totalQuantity=mh(be[K].totalQuantity+(st.quantity||0)),be[K].totalAmount=Wo(be[K].totalAmount+(st.amount||0)),be},{})).map(([be,st])=>({productName:be,totalQuantity:st.totalQuantity,totalAmount:st.totalAmount}))}),Xe=Jd(Fe);Ce.forEach(be=>{Xe.update(Yt(Fe,"salesV2",be.id.split("#")[0]),{status:"PROCESADA",closureId:xt.id,closureDate:X,date:be.date})}),await Xe.commit(),f(` Cierre guardado. Ventas procesadas: ${Ce.length}.`)}catch(de){console.error(de),f(" Error al guardar el cierre.")}},pt=async de=>{if(!U){f(" No tienes permisos para revertir esta venta.");return}if(window.confirm("Revertir esta venta? Esta accin no se puede deshacer."))try{await pn(Yt(Fe,"salesV2",de.split("#")[0]),{status:"FLOTANTE",closureId:null,closureDate:null}),f(" Venta revertida a FLOTANTE.")}catch(Ce){console.error(Ce),f(" No se pudo revertir la venta.")}},me=de=>{if(!U){f(" No tienes permisos para editar esta venta.");return}b(de),j(de.quantity),_(de.amount),E(de.clientName),k(de.amountReceived),D(de.change)},te=async()=>{if(!U){f(" No tienes permisos para guardar cambios.");return}if(y)try{await pn(Yt(Fe,"salesV2",y.id.split("#")[0]),{quantity:w,amount:I,amountCharged:I,clientName:S,amountReceived:F,change:P}),b(null),f(" Venta actualizada.")}catch(de){console.error(de),f(" No se pudo actualizar la venta.")}},ie=async de=>{if(!U){f(" No tienes permisos para eliminar esta venta.");return}if(window.confirm("Eliminar esta venta? Se restaurar el stock en los lotes asignados."))try{const{restored:Ce}=await wre(de.split("#")[0]);f(` Venta eliminada. Stock restaurado: ${Number(Ce).toFixed(2)}.`)}catch(Ce){console.error(Ce),f(" No se pudo eliminar la venta.")}},$e=async()=>{if(ee.current){ee.current.classList.add("force-pdf-colors"),ee.current.classList.add("pdf-print-mode");try{const Ce=(await Cg(ee.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),nt=new Rr;nt.addImage(Ce,"PNG",10,10,190,0),nt.save(`cierre_${X}.pdf`)}finally{ee.current.classList.remove("pdf-print-mode"),ee.current.classList.remove("force-pdf-colors")}}};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("style",{children:`
        .pdf-print-mode .pdf-desktop { display: block !important; }
        .pdf-print-mode .pdf-mobile  { display: none !important; }
      `}),i.jsxs("div",{className:"flex items-start justify-between gap-3 mb-4",children:[i.jsxs("h2",{className:"text-2xl font-bold",children:["Cierre de Ventas - ",pe,"  ",fe]}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsx(pc,{onClick:H})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx(He,{title:"Filtros",open:ae,onToggle:()=>Se(de=>!de),right:i.jsxs("span",{className:"ml-1",children:[pe,"  ",fe,A!=="ALL"?`  ${A}`:"",m!=="ALL"?`  ${m==="CREDITO"?"Crdito":"Cash"}`:"",L.trim()?`  "${L.trim()}"`:""]})}),ae&&i.jsx("div",{className:"mt-3 border rounded-xl p-3 bg-white",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3",children:[i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Periodo desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-2 w-full",value:pe,onChange:de=>ge(de.target.value)})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-2 w-full",value:fe,onChange:de=>xe(de.target.value)})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Estado"}),i.jsxs("select",{className:"border rounded px-2 py-2 w-full",value:A,onChange:de=>h(de.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Venta Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Venta Procesada"})]})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Tipo Operacin"}),i.jsxs("select",{className:"border rounded px-2 py-2 w-full",value:m,onChange:de=>p(de.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),i.jsx("option",{value:"CREDITO",children:"Crdito"}),i.jsx("option",{value:"CONTADO",children:"Cash"})]})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Producto"}),i.jsx("input",{type:"text",className:"border rounded px-2 py-2 w-full",placeholder:"Buscar por producto...",value:L,onChange:de=>Z(de.target.value)})]})]})})]}),c?i.jsx("p",{children:"Cargando ventas..."}):i.jsxs("div",{ref:ee,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Libras - Unidad"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[re.map(de=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${de.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:de.status})}),i.jsx("td",{className:"border p-1",children:de.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:de.productName}),i.jsx("td",{className:"border p-1",children:ph(de.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",Ou(de.amount)]}),i.jsx("td",{className:"border p-1",children:de.date}),i.jsx("td",{className:"border p-1",children:se(de.userEmail)}),i.jsx("td",{className:"border p-1",children:de.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2 justify-center",children:U?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>me(de),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>ie(de.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):de.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:U?i.jsx("button",{onClick:()=>pt(de.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},de.id)),re.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-3 text-center text-gray-500",children:"Sin ventas para mostrar."})})]})]})}),i.jsxs("div",{className:"pdf-mobile md:hidden mb-4",children:[i.jsx(He,{title:"Ventas",open:Te,onToggle:()=>O(de=>!de),right:i.jsxs("span",{className:"ml-1",children:[re.length,"  C$",Ou(Pe)]})}),Te&&i.jsxs("div",{className:"mt-3 space-y-3",children:[re.map(de=>i.jsxs("details",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("summary",{className:"px-4 py-3 flex justify-between items-center cursor-pointer",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:de.productName}),i.jsx("div",{className:"text-xs text-gray-500",children:de.date})]}),i.jsxs("div",{className:"text-right shrink-0 ml-3",children:[i.jsxs("div",{className:"font-bold",children:["C$",Ou(de.amount)]}),i.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${de.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:de.status})]})]}),i.jsxs("div",{className:"px-4 pb-4 pt-2 text-sm space-y-2",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Cantidad"}),i.jsx("strong",{children:ph(de.quantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("strong",{children:de.type==="CREDITO"?"Crdito":"Cash"})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("strong",{className:"text-right break-all",children:se(de.userEmail)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("strong",{className:"text-right break-all",children:de.clientName||""})]}),i.jsx("div",{className:"pt-2",children:de.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2",children:U?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>me(de),className:"flex-1 text-xs bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>ie(de.id),className:"flex-1 text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):de.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2",children:U?i.jsx("button",{onClick:()=>pt(de.id),className:"w-full text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:"No options"})})]})]},de.id)),re.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin ventas para mostrar."})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-6",children:[i.jsxs("div",{children:["Total libras Cash: ",i.jsx("strong",{children:ph(It)})]}),i.jsxs("div",{children:["Total Unidades cash: ",i.jsx("strong",{children:ph(yt)})]}),i.jsxs("div",{children:["Total libras credito: ",i.jsx("strong",{children:ph(wt)})]}),i.jsxs("div",{children:["Total Unidades credito: ",i.jsx("strong",{children:ph(Ke)})]}),i.jsxs("div",{children:["Total facturado Cash: ",i.jsxs("strong",{children:["C$",Ou(ke)]})]}),i.jsxs("div",{children:["Total facturado credito:"," ",i.jsxs("strong",{children:["C$",Ou(Ne)]})]}),i.jsxs("div",{children:["Total venta Cash: ",i.jsxs("strong",{children:["C$",Ou(At)]})]}),i.jsxs("div",{children:["Total venta Credito: ",i.jsxs("strong",{children:["C$",Ou(bt)]})]}),i.jsxs("div",{children:["Utilidad bruta Cash: ",i.jsxs("strong",{children:["C$",Ou(Ve)]})]}),i.jsxs("div",{children:["Utilidad bruta credito:"," ",i.jsxs("strong",{children:["C$",Ou(he)]})]}),i.jsxs("div",{children:["Total libras cash y credito: ",i.jsx("strong",{children:ph(Be)})]}),i.jsxs("div",{children:["Total unidades cash y credito:"," ",i.jsx("strong",{children:ph(le)})]}),i.jsxs("div",{children:["Total ventas Cash y credito:"," ",i.jsxs("strong",{children:["C$",Ou(je)]})]}),i.jsxs("div",{children:["Total facturado a precio compra:"," ",i.jsxs("strong",{children:["C$",Ou(ue)]})]})]}),i.jsxs("div",{className:"mt-4",children:[i.jsx(He,{title:"Consolidado por producto",open:G,onToggle:()=>z(de=>!de),right:i.jsx("span",{className:"ml-1",children:Qe.length})}),G&&i.jsx("div",{className:"mt-3",children:i.jsxs("table",{className:"min-w-full border text-sm mb-2 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Total dinero"})]})}),i.jsxs("tbody",{children:[Qe.map(de=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:de.productName}),i.jsx("td",{className:"border p-1",children:ph(de.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",Ou(de.totalAmount)]})]},de.productName)),Qe.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500",children:"Sin datos para consolidar."})})]})]})})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[i.jsx("button",{disabled:!ve,onClick:Ct,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Cerrar ventas del da"}),i.jsx("button",{onClick:$e,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Descargar PDF"})]}),d&&i.jsx("p",{className:"mt-2 text-sm",children:d}),y&&i.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-4 space-y-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:"Editar venta"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[y.productName,"  ",se(y.userEmail)]}),i.jsx("label",{className:"text-sm",children:"Cantidad"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:w,onChange:de=>j(parseFloat(de.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Monto cobrado"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:I,onChange:de=>_(parseFloat(de.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Cliente"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:S,onChange:de=>E(de.target.value)}),i.jsx("label",{className:"text-sm",children:"Paga con"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:F,onChange:de=>k(parseFloat(de.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Vuelto"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:P,onChange:de=>D(de.target.value)}),i.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[i.jsx("button",{onClick:()=>b(null),className:"px-3 py-1 border rounded",children:"Cancelar"}),i.jsx("button",{onClick:te,className:"px-3 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",children:"Guardar cambios"})]})]})})]})}const Du=t=>Number(t??0).toFixed(2),ax=t=>Number(t??0).toFixed(3);function fPe(){var y,b,w,j;const t=async I=>{if(!window.confirm(`Eliminar el cierre del ${I.date}?`))return;const _=window.confirm("Tambin quieres reabrir (revertir a FLOTANTE) las ventas vinculadas a este cierre?");try{if(_){const S=await Qt(er(_t(Fe,"salesV2"),cr("closureId","==",I.id)));if(!S.empty){const E=Jd(Fe);S.forEach(F=>{E.update(Yt(Fe,"salesV2",F.id),{status:"FLOTANTE",closureId:null,closureDate:null})}),await E.commit()}}await Fn(Yt(Fe,"daily_closures",I.id)),(u==null?void 0:u.id)===I.id&&d(null),await m(),A(` Cierre eliminado${_?" y ventas reabiertas.":"."}`)}catch(S){console.error(S),A(" No se pudo eliminar el cierre.")}},[e,r]=x.useState(Nr(Eee(new Date),"yyyy-MM-dd")),[n,a]=x.useState(Nr(new Date,"yyyy-MM-dd")),[s,o]=x.useState(!0),[l,c]=x.useState([]),[u,d]=x.useState(null),[f,A]=x.useState(""),h=x.useRef(null),m=async()=>{try{o(!0);const I=er(_t(Fe,"daily_closures"),cr("date",">=",e),cr("date","<=",n)),_=await Qt(I),S=[];_.forEach(E=>S.push({id:E.id,...E.data()})),S.sort((E,F)=>E.date<F.date?1:E.date>F.date?-1:0),c(S)}catch(I){console.error(I),A(" Error cargando el historial.")}finally{o(!1)}};x.useEffect(()=>{m()},[]);const p=async I=>{I.preventDefault(),m()},g=x.useMemo(()=>{if(!u)return{units:0,sug:0,chg:0,diff:0,cogs:0,profit:0};const I=Number(u.totalUnits??0),_=Number(u.totalSuggested??0),S=Number(u.totalCharged??0),E=Number(u.totalDifference??(isFinite(S-_)?S-_:0)),F=Number(u.totalCOGS??0),k=Number(u.grossProfit??(isFinite(S-F)?S-F:0));return{units:I,sug:_,chg:S,diff:E,cogs:F,profit:k}},[u]),v=async()=>{if(!h.current||!u)return;const I=h.current;I.classList.add("force-pdf-colors");try{const[{default:_},{jsPDF:S}]=await Promise.all([Kh(()=>Promise.resolve().then(()=>_6),void 0),Kh(()=>Promise.resolve().then(()=>Pk),void 0)]),F=(await _(I,{backgroundColor:"#ffffff",onclone:D=>{const X=D.defaultView;D.body.querySelectorAll("*").forEach(ge=>{const fe=X.getComputedStyle(ge);fe.color&&(ge.style.color=fe.color),fe.backgroundColor&&fe.backgroundColor!=="rgba(0, 0, 0, 0)"&&(ge.style.backgroundColor=fe.backgroundColor),fe.borderColor&&(ge.style.borderColor=fe.borderColor)})}})).toDataURL("image/png"),{jsPDF:k}=await Kh(async()=>{const{jsPDF:D}=await Promise.resolve().then(()=>Pk);return{jsPDF:D}},void 0),P=new k;P.addImage(F,"PNG",10,10,190,0),P.save(`cierre_${u.date}.pdf`)}finally{I.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Histrico de cierres"}),i.jsxs("form",{onSubmit:p,className:"flex flex-wrap items-end gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:e,onChange:I=>r(I.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:n,onChange:I=>a(I.target.value)})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Aplicar"})]}),s?i.jsx("p",{children:"Cargando..."}):l.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cierres en el rango seleccionado."}):i.jsxs("table",{className:"min-w-full text-sm mb-6  shadow-lg p-4 bg-white border-gray-100",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Monto de venta"}),i.jsx("th",{className:"border p-2",children:"Monto al costo"}),i.jsx("th",{className:"border p-2",children:"Ganancia sin gastos"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsx("tbody",{children:l.map(I=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.date}),i.jsx("td",{className:"border p-1",children:ax(I.totalUnits)}),i.jsxs("td",{className:"border p-1",children:["C$",Du(I.totalCharged)]}),i.jsxs("td",{className:"border p-1",children:["C$",Du(I.totalCOGS)]}),i.jsxs("td",{className:"border p-1",children:["C$",Du(I.grossProfit??Number(I.totalCharged??0)-Number(I.totalCOGS??0))]}),i.jsx("td",{className:"border p-1",children:i.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>d(I),children:"Ver detalle"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>t(I),children:"Eliminar"})]})})]},I.id))})]}),u&&i.jsxs("div",{className:"mt-6 rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2 ",children:[i.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle ",u.date]}),i.jsx("button",{onClick:()=>d(null),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"}),i.jsx("button",{onClick:v,className:"ml-auto bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Descargar PDF"})]}),i.jsxs("div",{ref:h,className:"space-y-4",children:[i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:i.jsxs("div",{children:["Total Libras/Unidades: ",i.jsx("strong",{children:ax(g.units)})]})}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm",children:[i.jsxs("div",{children:["Monto al costo:"," ",i.jsxs("strong",{children:["C$",Du(g.cogs)]})]}),i.jsxs("div",{children:["Ganancia sin gastos:"," ",i.jsxs("strong",{children:["C$",Du(g.profit)]})]})]}),(y=u.salesV2)!=null&&y.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto de ventas"}),i.jsx("th",{className:"border p-2",children:"Monto al costo"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Vendedor"})]})}),i.jsx("tbody",{children:u.salesV2.map((I,_)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.productName??"(sin nombre)"}),i.jsx("td",{className:"border p-1",children:ax(I.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",Du(I.amount)]}),i.jsxs("td",{className:"border p-1",children:["C$",Du(I.cogsAmount)]}),i.jsx("td",{className:"border p-1",children:I.date??""}),i.jsx("td",{className:"border p-1",children:I.userEmail??""})]},_))})]})]}):(b=u.sales)!=null&&b.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Paga con"}),i.jsx("th",{className:"border p-2",children:"Vuelto"})]})}),i.jsx("tbody",{children:u.sales.map((I,_)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.productName??"(sin nombre)"}),i.jsx("td",{className:"border p-1",children:ax(I.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",Du(I.amount)]}),i.jsx("td",{className:"border p-1",children:I.userEmail??""}),i.jsx("td",{className:"border p-1",children:I.clientName??""}),i.jsxs("td",{className:"border p-1",children:["C$",Du(I.amountReceived)]}),i.jsx("td",{className:"border p-1",children:typeof I.change=="number"?Du(I.change):I.change??"0"})]},_))})]})]}):(w=u.products)!=null&&w.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Productos en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto"})]})}),i.jsx("tbody",{children:u.products.map((I,_)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.productName}),i.jsx("td",{className:"border p-1",children:ax(I.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",Du(I.amount)]})]},_))})]})]}):i.jsx("p",{className:"text-sm text-gray-500",children:"Sin detalle de ventas en este cierre."}),(j=u.productSummary)!=null&&j.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Consolidado por producto"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Total dinero"})]})}),i.jsx("tbody",{children:u.productSummary.map((I,_)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.productName}),i.jsx("td",{className:"border p-1",children:ax(I.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",Du(I.totalAmount)]})]},_))})]})]}):null]})]}),f&&i.jsx("p",{className:"mt-3 text-sm",children:f})]})}function hPe(){const[t,e]=x.useState(""),[r,n]=x.useState(""),[a,s]=x.useState(""),[o,l]=x.useState(!1),[c,u]=x.useState(["vendedor_pollo"]),[d,f]=x.useState(""),[A,h]=x.useState(""),[m,p]=x.useState([]),[g,v]=x.useState(!0),[y,b]=x.useState(null),[w,j]=x.useState(["vendedor_pollo"]),[I,_]=x.useState(""),[S,E]=x.useState(""),[F,k]=x.useState(!1),[P,D]=x.useState([]),X=L=>!L||L==="vendedor"?"vendedor_pollo":L==="admin"||L==="supervisor_pollo"||L==="contador"||L==="vendedor_pollo"||L==="vendedor_ropa"||L==="vendedor_dulces"?L:"vendedor_pollo",pe=L=>L?Array.isArray(L)?L.map(Z=>X(String(Z))):[X(String(L))]:["vendedor_pollo"],ge=async()=>{v(!0);const L=await Qt(_t(Fe,"users")),Z=[];L.forEach(ee=>{const R=ee.data();Z.push({id:ee.id,email:R.email??"",name:R.name??"",roles:pe(R.roles??R.role),sellerCandyId:R.sellerCandyId??""})}),p(Z),v(!1)},fe=async()=>{try{const L=await Qt(_t(Fe,"sellers_candies")),Z=[];L.forEach(ee=>{const R=ee.data();Z.push({id:ee.id,name:R.name??"(sin nombre)",branchLabel:R.branch??"",commissionPercent:Number(R.commissionPercent??0)})}),D(Z)}catch(L){console.error("Error cargando sellers_candies:",L)}};x.useEffect(()=>{ge(),fe()},[]);const xe=()=>{e(""),n(""),s(""),u(["vendedor_pollo"]),h("")},ae=async L=>{if(L.preventDefault(),f(""),y){if(a&&a.length>0&&a.length<6){f(" La contrasea debe tener al menos 6 caracteres.");return}}else if(a.length<6){f(" La contrasea debe tener al menos 6 caracteres.");return}if(!t.trim()){f(" El nombre es obligatorio.");return}try{if(y){const U=Yt(Fe,"users",y),He=w.length?w:["vendedor_pollo"],se=He.includes("vendedor_dulces")&&(I||A)||"";if(await pn(U,{email:r,name:t.trim(),roles:He,role:He[0]||"vendedor_pollo",sellerCandyId:se}),p(re=>re.map(Pe=>Pe.id===y?{...Pe,email:r,name:t.trim(),roles:He,sellerCandyId:se}:Pe)),a&&a.length>=6)try{const re=ST(),Pe=S||r;await ege(re,Pe),f(` Usuario actualizado. Se envi correo de restablecimiento a ${Pe}`)}catch(re){console.error("Error sending password reset:",re),f(" Usuario actualizado. No se pudo enviar correo de restablecimiento.")}else f(" Usuario actualizado correctamente.");Te();return}const Z=fD(),ee=dD(Z.options,"Secondary"),R=ST(ee),H=await tge(R,r,a),ne=c.length?c:["vendedor_pollo"],ve=ne.includes("vendedor_dulces")&&A||"";await oee(Yt(_t(Fe,"users"),H.user.uid),{email:r,name:t.trim(),roles:ne,role:ne[0]||"vendedor_pollo",sellerCandyId:ve}),await yD(R),await qme(ee),p(U=>[{id:H.user.uid,email:r,name:t.trim(),roles:ne,sellerCandyId:ve},...U]),f(" Usuario creado correctamente."),xe(),k(!1)}catch(Z){console.error(Z),f(" Error al crear el usuario: "+Z.message)}},Se=L=>{b(L.id),e(L.name||""),n(L.email||""),E(L.email||""),j(L.roles&&L.roles.length?L.roles:["vendedor_pollo"]),h(L.sellerCandyId||""),_(L.sellerCandyId||""),s(""),k(!0)},Te=()=>{b(null),j(["vendedor_pollo"]),_(""),E(""),xe(),k(!1)},O=async L=>{confirm("Eliminar este usuario del listado?")&&(await Fn(Yt(Fe,"users",L)),p(ee=>ee.filter(R=>R.id!==L)))},G=L=>{const Z=L==="admin"?"admin":L==="supervisor_pollo"?"supervisor_pollo":L==="vendedor_ropa"?"vendedor_ropa":L==="vendedor_dulces"?"vendedor_dulces":"vendedor_pollo",ee=Z==="admin"?"bg-blue-100 text-blue-700":Z==="supervisor_pollo"?"bg-amber-100 text-amber-700":Z==="vendedor_ropa"?"bg-indigo-100 text-indigo-700":Z==="vendedor_dulces"?"bg-pink-100 text-pink-700":"bg-green-100 text-green-700";return i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ee}`,children:Z})},z=L=>`${L.name}  ${L.branchLabel||"Sin sucursal"}  ${L.commissionPercent.toFixed(2)}%`;return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Usuarios"}),i.jsx("button",{className:"px-3 py-2 rounded bg-purple-600 text-white hover:bg-purple-700",onClick:()=>k(!0),type:"button",children:"Crear usuario"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Email"}),i.jsx("th",{className:"p-2 border",children:"Rol"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:g?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Cargando"})}):m.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Sin usuarios"})}):m.map(L=>{const Z=y===L.id,ee=(Z?w:L.roles).includes("vendedor_dulces");return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:L.name||""}),i.jsx("td",{className:"p-2 border",children:L.email}),i.jsx("td",{className:"p-2 border",children:Z?i.jsxs("div",{className:"space-y-2 text-left",children:[["supervisor_pollo","admin","vendedor_pollo","vendedor_ropa","vendedor_dulces"].map(R=>i.jsxs("label",{className:"inline-flex items-center mr-3",children:[i.jsx("input",{type:"checkbox",className:"mr-2",checked:w.includes(R),onChange:()=>j(H=>H.includes(R)?H.filter(ne=>ne!==R):[...H,R])}),i.jsx("span",{className:"text-sm",children:R})]},R)),w.includes("vendedor_dulces")&&i.jsxs("select",{className:"w-full border p-1 rounded text-xs mt-1",value:I,onChange:R=>_(R.target.value),children:[i.jsx("option",{value:"",children:"Selecciona vendedor de dulces"}),P.map(R=>i.jsx("option",{value:R.id,children:z(R)},R.id))]})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"flex gap-2 justify-center",children:L.roles.map(R=>i.jsx("span",{children:G(R)},R))}),ee&&L.sellerCandyId&&i.jsx("div",{className:"mt-1 text-[11px] text-gray-500",children:"Vendedor asignado"})]})}),i.jsx("td",{className:"p-2 border space-x-2",children:i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Se(L),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>O(L.id),children:"Eliminar"})]})})]},L.id)})})]})}),d&&i.jsx("p",{className:"text-sm mt-2",children:d}),F&&i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>k(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-lg max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:y?"Editar usuario":"Registrar nuevo usuario"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Te,type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:ae,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nombre completo"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400",value:t,onChange:L=>e(L.target.value),required:!0})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Correo electrnico"}),i.jsx("input",{type:"email",className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400",value:r,onChange:L=>n(L.target.value),required:!0})]}),i.jsxs("div",{className:"space-y-1 relative",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Contrasea (mnimo 6 caracteres)"}),i.jsx("input",{type:o?"text":"password",minLength:6,className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400 pr-10",value:a,onChange:L=>s(L.target.value),required:!y}),i.jsx("button",{type:"button",className:"absolute right-2 top-8 text-sm text-gray-600 hover:text-gray-800",onClick:()=>l(L=>!L),children:o?"":""})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Roles"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:["supervisor_pollo","contador","admin","vendedor_pollo","vendedor_ropa","vendedor_dulces"].map(L=>i.jsxs("label",{className:"inline-flex items-center mr-3",children:[i.jsx("input",{type:"checkbox",className:"mr-2",checked:y?w.includes(L):c.includes(L),onChange:()=>{y?j(Z=>Z.includes(L)?Z.filter(ee=>ee!==L):[...Z,L]):u(Z=>Z.includes(L)?Z.filter(ee=>ee!==L):[...Z,L])}}),i.jsx("span",{className:"text-sm",children:L})]},L))})]}),(y?w.includes("vendedor_dulces"):c.includes("vendedor_dulces"))&&i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Vendedor (dulces)"}),i.jsxs("select",{className:"w-full border p-2 rounded text-sm",value:A,onChange:L=>h(L.target.value),children:[i.jsx("option",{value:"",children:"Selecciona vendedor de dulces asignado"}),P.map(L=>i.jsx("option",{value:L.id,children:z(L)},L.id))]})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:Te,children:"Cancelar"}),i.jsx("button",{className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:y?"Guardar cambios":"Crear usuario"})]})]}),d&&i.jsx("p",{className:"text-sm mt-2",children:d})]})]})]})}const kV=t=>`C$${(Number(t)||0).toFixed(2)}`;function APe(){const[t,e]=x.useState(""),[r,n]=x.useState(0),[a,s]=x.useState(0),[o,l]=x.useState(""),[c,u]=x.useState(""),[d,f]=x.useState(""),[A,h]=x.useState([]),[m,p]=x.useState(!0),[g,v]=x.useState(!1),[y,b]=x.useState(null),[w,j]=x.useState(""),[I,_]=x.useState(""),[S,E]=x.useState(""),[F,k]=x.useState(0),[P,D]=x.useState(0),[X,pe]=x.useState(!1),ge=async()=>{p(!0);const z=await Qt(_t(Fe,"products")),L=[];z.forEach(Z=>{const ee=Z.data();L.push({id:Z.id,name:ee.name??"",price:Number(ee.price??0),providerPrice:Number(ee.providerPrice??0),category:ee.category??"",measurement:ee.measurement??"",active:ee.active!==!1})}),h(L),p(!1)};x.useEffect(()=>{ge()},[]);const fe=async z=>{if(z.preventDefault(),l(""),!t||r<=0||!d){l(" Completa nombre, precio vlido y unidad de medida");return}try{const L={name:t,price:parseFloat(r.toFixed(2)),providerPrice:parseFloat((a||0).toFixed(2)),category:c,measurement:d,active:!0},Z=await On(_t(Fe,"products"),L);h(ee=>[{id:Z.id,...L},...ee]),l(" Producto registrado con exito."),e(""),n(0),s(0),f(""),u(""),pe(!1)}catch(L){l(" Error: "+L.message)}},xe=z=>{b(z.id),j(z.name),_(z.category),E(z.measurement),k(z.price),D(z.providerPrice||0)},ae=()=>{b(null),j(""),_(""),E(""),k(0)},Se=async()=>{if(!y)return;const z=Yt(Fe,"products",y);await pn(z,{name:w,category:I,measurement:S,price:parseFloat((F||0).toFixed(2)),providerPrice:parseFloat((P||0).toFixed(2))}),h(L=>L.map(Z=>Z.id===y?{...Z,name:w,category:I,measurement:S,price:parseFloat((F||0).toFixed(2)),providerPrice:parseFloat((P||0).toFixed(2))}:Z)),ae()},Te=async z=>{const L=Yt(Fe,"products",z.id),Z=z.active===!1;await pn(L,{active:Z}),h(ee=>ee.map(R=>R.id===z.id?{...R,active:Z}:R))},O=async z=>{const L=er(_t(Fe,"inventory_batches"),cr("productId","==",z),iS(1));if(!(await Qt(L)).empty){alert(`No se puede eliminar: hay lotes asociados a este producto.
Sugerencia: desactvalo para ocultarlo.`);return}confirm("Eliminar este producto definitivamente?")&&(await Fn(Yt(Fe,"products",z)),h(R=>R.filter(H=>H.id!==z)))},G=g?A:A.filter(z=>z.active!==!1);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Productos"}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{l(""),pe(!0)},children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo producto"]})]}),X&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>pe(!1)}),i.jsxs("div",{className:"relative z-10 w-[95%] max-w-lg bg-white rounded-lg shadow-2xl border p-5",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("h3",{className:"text-lg font-bold text-green-700 flex items-center gap-2",children:[i.jsx("span",{className:"inline-block bg-green-100 text-green-700 rounded-full p-2",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Registrar producto"]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>pe(!1),children:"Cerrar"})]}),i.jsxs("form",{onSubmit:fe,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Categora"}),i.jsxs("select",{value:c,onChange:z=>u(z.target.value),className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-400",children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"pollo",children:"Pollo"}),i.jsx("option",{value:"cerdo",children:"Cerdo"}),i.jsx("option",{value:"huevo",children:"Huevos"}),i.jsx("option",{value:"ropa",children:"Ropa"}),i.jsx("option",{value:"otros",children:"Otros"})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nombre del producto"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded",value:t,onChange:z=>e(z.target.value)})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tipo de unidad de medida"}),i.jsxs("select",{value:d,onChange:z=>f(z.target.value),className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-400",children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"lb",children:"Libra"}),i.jsx("option",{value:"kg",children:"Kilogramo"}),i.jsx("option",{value:"unidad",children:"Unidad"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Precio proveedor (ej: 40.00)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-2 rounded",value:Number.isNaN(a)?"":a,onChange:z=>s(parseFloat(z.target.value))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Precio por unidad (ej: 55.50)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-2 rounded",value:Number.isNaN(r)?"":r,onChange:z=>n(parseFloat(z.target.value)),onFocus:z=>z.target.value==="0"?n(NaN):null})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",children:"Agregar producto"}),o&&i.jsx("p",{className:"text-sm mt-2",children:o})]})]})]}),i.jsxs("div",{className:"flex items-center justify-between mt-6 mb-2",children:[i.jsx("h3",{className:"text-lg font-semibold p-2",children:"Productos"}),i.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[i.jsx("input",{type:"checkbox",checked:g,onChange:z=>v(z.target.checked)}),"Mostrar inactivos"]})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:m?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):G.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin productos"})}):G.map(z=>{const L=y===z.id,Z=z.active!==!1;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:L?i.jsx("input",{className:"w-full border p-1 rounded",value:w,onChange:ee=>j(ee.target.value)}):z.name}),i.jsx("td",{className:"p-2 border",children:L?i.jsxs("select",{className:"w-full border p-1 rounded",value:I,onChange:ee=>_(ee.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"pollo",children:"Pollo"}),i.jsx("option",{value:"cerdo",children:"Cerdo"}),i.jsx("option",{value:"huevo",children:"Huevos"}),i.jsx("option",{value:"ropa",children:"Ropa"}),i.jsx("option",{value:"otros",children:"Otros"})]}):z.category}),i.jsx("td",{className:"p-2 border",children:L?i.jsxs("select",{className:"w-full border p-1 rounded",value:S,onChange:ee=>E(ee.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"lb",children:"Libra"}),i.jsx("option",{value:"kg",children:"Kilogramo"}),i.jsx("option",{value:"unidad",children:"Unidad"})]}):z.measurement}),i.jsx("td",{className:"p-2 border",children:L?i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-1 rounded text-right",value:Number.isNaN(P)?"":P,onChange:ee=>D(parseFloat(ee.target.value))}):kV(z.providerPrice||0)}),i.jsx("td",{className:"p-2 border",children:L?i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-1 rounded text-right",value:Number.isNaN(F)?"":F,onChange:ee=>k(parseFloat(ee.target.value))}):kV(z.price)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Z?"bg-green-100 text-green-700":"bg-gray-200 text-gray-700"}`,children:Z?"Activo":"Inactivo"})}),i.jsx("td",{className:"p-2 border space-x-2",children:L?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Se,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:ae,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>xe(z),children:"Editar"}),i.jsx("button",{className:`px-2 py-1 rounded ${Z?"bg-gray-600 hover:bg-gray-700 text-white":"bg-green-600 hover:bg-green-700 text-white"}`,onClick:()=>Te(z),children:Z?"Desactivar":"Activar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>O(z.id),children:"Eliminar"})]})})]},z.id)})})]})})]})}const Xo=[];for(let t=0;t<256;++t)Xo.push((t+256).toString(16).slice(1));function mPe(t,e=0){return(Xo[t[e+0]]+Xo[t[e+1]]+Xo[t[e+2]]+Xo[t[e+3]]+"-"+Xo[t[e+4]]+Xo[t[e+5]]+"-"+Xo[t[e+6]]+Xo[t[e+7]]+"-"+Xo[t[e+8]]+Xo[t[e+9]]+"-"+Xo[t[e+10]]+Xo[t[e+11]]+Xo[t[e+12]]+Xo[t[e+13]]+Xo[t[e+14]]+Xo[t[e+15]]).toLowerCase()}let s5;const pPe=new Uint8Array(16);function gPe(){if(!s5){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");s5=crypto.getRandomValues.bind(crypto)}return s5(pPe)}const xPe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),FV={randomUUID:xPe};function vPe(t,e,r){var a;if(FV.randomUUID&&!t)return FV.randomUUID();t=t||{};const n=t.random??((a=t.rng)==null?void 0:a.call(t))??gPe();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,mPe(n)}async function yPe(t,e,r,n=!1){if(r<=0)return{allocations:[],avgUnitCost:0,cogsAmount:0};const a=_t(t,"inventory_batches"),s=er(a,cr("productName","==",e)),c=(await Qt(s)).docs.map(u=>({id:u.id,data:u.data()})).sort((u,d)=>{var p,g;const f=u.data.date??"",A=d.data.date??"";if(f!==A)return f<A?-1:1;const h=((p=u.data.createdAt)==null?void 0:p.seconds)??0,m=((g=d.data.createdAt)==null?void 0:g.seconds)??0;return h-m}).map(u=>Yt(t,"inventory_batches",u.id));return Ii(t,async u=>{let d=Number(r);const f=[],A=await Promise.all(c.map(g=>u.get(g)));for(let g=0;g<c.length&&d>0;g++){const v=c[g],y=A[g];if(!y.exists())continue;const b=y.data(),w=Number(b.quantity??0),j=Number(b.remaining??w??0),I=Number(b.purchasePrice??0);if(j<=0)continue;const _=Math.min(j,d),S=Number((j-_).toFixed(3));u.update(v,{remaining:S}),f.push({batchId:v.id,qty:_,unitCost:I,lineCost:Number((_*I).toFixed(2))}),d=Number((d-_).toFixed(3))}if(d>0&&!n)throw new Error(`Stock insuficiente para "${e}". Faltan ${d} unidades.`);const h=Number(f.reduce((g,v)=>g+v.lineCost,0).toFixed(2)),m=f.reduce((g,v)=>g+v.qty,0),p=m>0?Number((h/m).toFixed(4)):0;return{allocations:f,avgUnitCost:p,cogsAmount:h}})}const _re=3,bPe=.5*10**-_re;function Ya(t){const e=Number(t??0);return Number(e.toFixed(_re))}function i5(t,e){return Ya((t??0)+(e??0))}function jC(t,e){return Ya(t)+bPe>=Ya(e)}async function wPe(t,e){const r=await Qt(_t(Fe,"inventory_batches")),n=t.trim().toLowerCase();let a=0;for(const s of r.docs){const o=s.data();(o.productName||"").trim().toLowerCase()===n&&o.productId!==e&&(await pn(Yt(Fe,"inventory_batches",s.id),{productId:e}),a++)}return a}const r0=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function OV({user:t,role:e,roles:r}){r&&r.length;const[n,a]=x.useState([]),[s,o]=x.useState([]),[l,c]=x.useState(""),[u,d]=x.useState(Nr(new Date,"yyyy-MM-dd")),[f,A]=x.useState(""),[h,m]=x.useState(""),[p,g]=x.useState([]),[v,y]=x.useState(0),[b,w]=x.useState(0),[j,I]=x.useState("0"),[_,S]=x.useState(""),[E,F]=x.useState(!1),[k,P]=x.useState({}),D=ke=>Math.round(ke*100)/100,X=ke=>Ya(ke).toFixed(3),[pe,ge]=x.useState("CONTADO"),[fe,xe]=x.useState([]),[ae,Se]=x.useState(""),[Te,O]=x.useState(0),G=ke=>{ge(ke),ke==="CREDITO"?(A(""),w(0),I("0.00")):(Se(""),O(0))},z=ke=>{const Ne=Number(ke.specialPrice||0);return Ne>0?Ne:Number(ke.price||0)},L=async ke=>{if(!ke)return 0;const Ne=er(_t(Fe,"inventory_batches"),cr("productId","==",ke)),Ve=await Qt(Ne);let he=0;return Ve.forEach(le=>{const Be=le.data();he=i5(he,Number(Be.remaining||0))}),Ya(he)},Z=async ke=>{if(!ke)return 0;const Ne=await Qt(_t(Fe,"inventory_batches"));let Ve=0;return Ne.forEach(he=>{const le=he.data();(le.productName||"").trim().toLowerCase()===ke.trim().toLowerCase()&&(Ve=i5(Ve,Number(le.remaining||0)))}),Ya(Ve)};x.useEffect(()=>{(async()=>{const ke=await Qt(_t(Fe,"products")),Ne=[];ke.forEach(Ve=>{const he=Ve.data();(he==null?void 0:he.active)!==!1&&Ne.push({id:Ve.id,productName:he.name??he.productName??"(sin nombre)",price:Number(he.price??0),measurement:he.measurement??"(sin unidad)",category:he.category??"(sin categora)"})}),a(Ne)})()},[]),x.useEffect(()=>{(async()=>{const ke=await Qt(_t(Fe,"inventory_batches")),Ne={};ke.forEach(Ve=>{const he=Ve.data(),le=he.productId,Be=Number(he.remaining||0);le&&(Ne[le]=i5(Ne[le]||0,Be))}),Object.keys(Ne).forEach(Ve=>Ne[Ve]=Ya(Ne[Ve])),P(Ne)})()},[]),x.useEffect(()=>{(async()=>{const ke=await Qt(_t(Fe,"users")),Ne=[];ke.forEach(Ve=>{const he=Ve.data();Ne.push({id:Ve.id,email:he.email??"(sin email)",role:he.role??"USER"})}),o(Ne)})()},[]);const ee=async()=>{if(!l)return;const ke=n.find(Ve=>Ve.id===l);if(!ke)return;if(p.some(Ve=>Ve.productId===ke.id)){c("");return}const Ne=await L(ke.id);g(Ve=>[...Ve,{productId:ke.id,productName:ke.productName,measurement:ke.measurement,price:Number(ke.price||0),specialPrice:0,stock:Ne,qty:0,qtyInput:"",specialPriceInput:"",discount:0,discountInput:""}]),c("")},R=async ke=>{if(!ke)return;const Ne=n.find(he=>he.id===ke);if(!Ne||p.some(he=>he.productId===Ne.id))return;const Ve=await L(Ne.id);g(he=>[...he,{productId:Ne.id,productName:Ne.productName,measurement:Ne.measurement,price:Number(Ne.price||0),specialPrice:0,stock:Ve,qty:0,qtyInput:"",specialPriceInput:"",discount:0,discountInput:""}]),c("")},H=ke=>{g(Ne=>Ne.filter(Ve=>Ve.productId!==ke))},ne=ke=>{const Ne=String(ke||"").replace(",",".");if(Ne==="")return"";const Ve=Ne.split(".");return Ve.length===1?Ne:`${Ve[0]}.${Ve.slice(1).join("")}`},ve=async(ke,Ne)=>{g(Ve=>Ve.map(he=>{if(he.productId!==ke)return he;const le=(he.measurement||"").toLowerCase()!=="lb",Be=ne(Ne);if(Be.trim()==="")return{...he,qty:0,qtyInput:""};if(!le&&Be===".")return{...he,qty:0,qtyInput:"0."};const je=Number(Be),Ae=Number.isFinite(je)?je:0;let Qe=le?Math.max(0,Math.round(Ae)):Ya(Ae);const Ct=le?Math.max(0,Math.floor(Number(he.stock||0))):Ya(Number(he.stock||0));if(Qe>Ct){Qe=Ct,S(` Cantidad limitada a existencias (${Ct})`);const me=le?String(Qe):Qe===0?"":String(Qe);return{...he,qty:Qe,qtyInput:me}}const pt=le?String(Qe):Be.endsWith(".")?Be:String(Qe);return{...he,qty:Qe,qtyInput:pt}}))},U=(ke,Ne)=>{g(Ve=>Ve.map(he=>{if(he.productId!==ke)return he;const le=ne(Ne);if(le.trim()==="")return{...he,specialPrice:0,specialPriceInput:""};if(le===".")return{...he,specialPrice:0,specialPriceInput:"0."};const Be=Number(le),je=Number.isFinite(Be)?Math.max(0,D(Be)):0,Ae=le.endsWith(".")?le:String(je);return{...he,specialPrice:je,specialPriceInput:Ae}}))},He=(ke,Ne)=>{g(Ve=>Ve.map(he=>{if(he.productId!==ke)return he;const le=ne(Ne);if(le.trim()==="")return{...he,discount:0,discountInput:""};if(le===".")return{...he,discount:0,discountInput:"0."};const Be=Number(le),je=Number.isFinite(Be)?Math.max(0,Math.floor(Be)):0,Ae=le.endsWith(".")?le:String(je);return{...he,discount:je,discountInput:Ae}}))},se=x.useMemo(()=>{let ke=0;for(const Ne of p){const Ve=z(Ne),he=Number(Ve||0)*Number(Ne.qty||0),le=Math.max(0,he-Math.max(0,Number(Ne.discount||0)));ke+=le}return D(ke)},[p]);x.useEffect(()=>{y(se)},[se]),x.useEffect(()=>{const ke=Number(b)||0,Ne=Number(v)||0;I((ke-Ne).toFixed(2))},[b,v]);const re=ke=>{ke.key===","&&(ke.preventDefault(),ke.target.value+=".")},[Pe,ue]=x.useState(!1);x.useEffect(()=>{var Ve;const ke=window.matchMedia("(max-width: 900px)"),Ne=()=>ue(ke.matches);return Ne(),(Ve=ke.addEventListener)==null||Ve.call(ke,"change",Ne),()=>{var he;return(he=ke.removeEventListener)==null?void 0:he.call(ke,"change",Ne)}},[]),x.useEffect(()=>{(async()=>{try{const ke=await Qt(_t(Fe,"customers_pollo")),Ne=[];ke.forEach(Ve=>{const he=Ve.data();Ne.push({id:Ve.id,name:he.name??"",phone:he.phone??"",status:he.status??"ACTIVO",creditLimit:Number(he.creditLimit??0),vendorId:he.vendorId??"",vendorName:he.vendorName??"",balance:0})});for(const Ve of Ne)try{const he=er(_t(Fe,"ar_movements_pollo"),cr("customerId","==",Ve.id)),le=await Qt(he);let Be=0;le.forEach(Ae=>{Be+=Number(Ae.data().amount||0)});const je=Number(Ve.initialDebt||0);Ve.balance=Be+je}catch{Ve.balance=0}Ne.sort((Ve,he)=>(Ve.name||"").localeCompare(he.name||"")),xe(Ne)}catch(ke){console.error("Error cargando customers_pollo:",ke),xe([])}})()},[]);const we=x.useMemo(()=>fe.find(ke=>ke.id===ae)||null,[fe,ae]),Me=Number((we==null?void 0:we.balance)||0),ze=pe==="CREDITO"?Math.max(0,Number(Me||0)+Math.max(0,Number(v||0))):0;x.useEffect(()=>{pe==="CREDITO"&&O(ke=>Math.min(Math.max(0,Number(ke||0)),ze))},[pe,ze]),x.useEffect(()=>{pe==="CREDITO"&&(w(Number(Te||0)),I("0.00"))},[pe,Te]);const yt=pe==="CREDITO"?Me+Math.max(0,Number(v||0))-Math.max(0,Number(Te||0)):0,It=async()=>{if(p.length===0)return"Agrega al menos un producto.";for(const ke of p){if(!ke.qty||ke.qty<=0)return`Cantidad invlida para "${ke.productName}".`;const Ne=await L(ke.productId);if(!jC(Ne,ke.qty)){const Ve=await Z(ke.productName);if(jC(Ve,0)&&!jC(Ne,0)){const he=await wPe(ke.productName,ke.productId),le=await L(ke.productId);if(!jC(le,ke.qty))return`Stock insuficiente tras corregir ${he} lote(s) para "${ke.productName}".`}else return`Stock insuficiente para "${ke.productName}". Disponible: ${Ne}`}}return null},Ke=async ke=>{var Ve,he;ke.preventDefault(),S("");const Ne=await It();if(Ne){S(" "+Ne);return}try{F(!0);const le=[];if(pe==="CONTADO"){if(!f.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!ae)return"Selecciona un cliente (crdito).";if(Te<0)return"El pago inicial no puede ser negativo.";if(Te>v)return"El pago inicial no puede superar el total.";if((we==null?void 0:we.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede fiar."}for(const me of p){const te=me.qty,{allocations:ie,avgUnitCost:$e,cogsAmount:de}=await yPe(Fe,me.productName,te,!1),Ce=z(me),nt=Number(Ce||0)*Number(te||0),vt=Math.max(0,Number(me.discount||0)),ht=Math.max(0,nt-vt);le.push({productId:me.productId,productName:me.productName,measurement:me.measurement,unitPrice:Number(Ce||0),regularPrice:Number(me.price||0),specialPrice:Number(me.specialPrice||0)>0?Number(me.specialPrice):null,qty:te,discount:vt,lineTotal:D(nt),lineFinal:D(ht),allocations:ie,avgUnitCost:$e,cogsAmount:de})}const Be=le.reduce((me,te)=>me+te.lineFinal,0),je=le.reduce((me,te)=>me+Number(te.qty||0),0),Ae=Number(pe==="CREDITO"?Te||0:b||0),Qe=pe==="CREDITO"?"0.00":j,Ct={id:vPe(),quantity:je,amount:Be,amountCharged:Be,timestamp:dr.now(),date:u,userEmail:(t==null?void 0:t.email)??((Ve=s[0])==null?void 0:Ve.email)??"sin usuario",vendor:e??((he=s[0])==null?void 0:he.role)??"sin usuario",status:"FLOTANTE",items:le,itemsTotal:Be,type:pe,amountReceived:Ae,change:Qe,customerId:pe==="CREDITO"?ae:"",customerName:pe==="CREDITO"?(we==null?void 0:we.name)||"":f.trim(),clientName:pe==="CONTADO"?f.trim():""};if(pe==="CONTADO"){if(!f.trim()){S(" Ingresa el nombre del cliente (contado).");return}}else{if(!ae){S(" Selecciona un cliente (crdito).");return}if(Te<0){S(" El pago inicial no puede ser negativo.");return}if(Te>v){S(" El pago inicial no puede superar el total.");return}if((we==null?void 0:we.status)==="BLOQUEADO"){S(" El cliente est BLOQUEADO. No se puede fiar.");return}const me=Number((we==null?void 0:we.creditLimit)||0);if(me>0&&yt>me){S(` Supera el lmite de crdito (C$ ${me.toFixed(2)}).`);return}}const pt=await On(_t(Fe,"salesV2"),Ct);if(pe==="CREDITO"&&ae){const me={customerId:ae,date:u,createdAt:dr.now(),ref:{saleId:pt.id}};await On(_t(Fe,"ar_movements_pollo"),{...me,type:"CARGO",amount:Number(Be)||0}),Number(Te)>0&&await On(_t(Fe,"ar_movements_pollo"),{...me,type:"ABONO",amount:-Number(Te)}),xe(te=>te.map(ie=>ie.id===ae?{...ie,balance:Number(ie.balance||0)+Number(Be||0)-Number(Te||0)}:ie))}S(" Venta registrada y asignada a inventario (FIFO)."),g([]),c(""),y(0),w(0),I("0"),A(""),d(Nr(new Date,"yyyy-MM-dd")),Se(""),O(0),ge("CONTADO")}catch(le){console.error(le),S(` ${(le==null?void 0:le.message)||"Error al registrar la venta."}`)}finally{F(!1)}},wt=x.useMemo(()=>new Set(p.map(ke=>ke.productId)),[p]),At=x.useMemo(()=>n.filter(ke=>(k[ke.id]||0)>0),[n,k]),bt=x.useMemo(()=>{const ke=String(h||"").trim().toLowerCase();return ke?At.filter(Ne=>`${Ne.productName||""}`.toLowerCase().includes(ke)):At},[At,h]);return Pe?i.jsx("div",{className:"w-full max-w-lg mx-auto p-3",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow p-3 space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{className:"font-bold text-lg text-blue-700",children:"Registrar venta (Pollo)"}),i.jsx("input",{type:"date",className:"text-sm text-gray-700 border rounded px-2 py-1",value:u,onChange:ke=>d(ke.target.value),"aria-label":"Fecha de la venta"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:pe,onChange:ke=>G(ke.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),pe==="CONTADO"?i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Cliente (Contado)"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:f,onChange:ke=>A(ke.target.value),placeholder:"Ej: Cliente Mostrador"})]}):i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Cliente (Crdito)"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:ae,onChange:ke=>Se(ke.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),fe.map(ke=>i.jsxs("option",{value:ke.status==="ACTIVO"?ke.id:"",disabled:ke.status==="BLOQUEADO",children:[ke.name,"  Saldo: ",r0(ke.balance||0)]},ke.id))]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-base font-semibold",children:r0(Me)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-base font-semibold",children:r0(yt)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-semibold",children:"Pago inicial"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",type:"number",step:"0.01",inputMode:"decimal",max:ze,value:Te===0?"":Te,onChange:ke=>{const Ne=Math.max(0,Number(ke.target.value||0)),Ve=Math.min(Ne,ze);O(Ve)},placeholder:"0.00"}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Mximo: ",r0(ze)]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2 mb-2",placeholder:"Buscar producto por nombre...",value:h,onChange:ke=>m(ke.target.value)}),i.jsx("div",{className:"flex gap-2",children:i.jsxs("select",{className:"flex-1 border rounded px-1 py-2 text-sm",value:l,onChange:async ke=>{const Ne=ke.target.value;c(Ne),await R(Ne)},children:[i.jsx("option",{value:"",disabled:!0,children:"Selecciona un producto"}),bt.map(ke=>i.jsxs("option",{value:ke.id,disabled:wt.has(ke.id),children:[ke.productName," | C$ ",ke.price," | Disp:"," ",X(k[ke.id]||0)]},ke.id))]})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"text-sm font-semibold",children:"Items"}),p.length===0?i.jsx("div",{className:"text-gray-500",children:"Agrega productos al carrito."}):i.jsx("div",{className:"space-y-2",children:p.map(ke=>{const Ne=z(ke),Ve=Number(Ne||0)*Number(ke.qty||0),he=Math.max(0,Ve-Math.max(0,Number(ke.discount||0))),le=(ke.measurement||"").toLowerCase()!=="lb";return i.jsxs("div",{className:"border rounded p-2",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("div",{className:"font-semibold",children:ke.productName}),i.jsxs("div",{className:"text-sm",children:["C$ ",D(Ne).toFixed(2)]})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 items-center",children:[i.jsx("input",{className:"border rounded px-2 py-1 text-right",inputMode:le?"numeric":"decimal",step:le?1:.01,value:ke.qtyInput??(ke.qty===0?"":ke.qty),onKeyDown:re,onChange:Be=>ve(ke.productId,Be.target.value),placeholder:le?"Unid":"Libras",title:le?"Unidades":"Libras"}),i.jsx("input",{className:"border rounded px-1 py-1 text-right",inputMode:"numeric",value:ke.discountInput??(ke.discount===0?"":ke.discount),onChange:Be=>He(ke.productId,Be.target.value),placeholder:"Descuento",title:"Descuento (C$)"}),i.jsx("input",{className:"border rounded px-2 py-1 text-right",inputMode:"decimal",value:ke.specialPriceInput??(ke.specialPrice===0?"":ke.specialPrice),onChange:Be=>U(ke.productId,Be.target.value),placeholder:"Sugerido",title:"Precio sugerido (opcional)"})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Exist:"," ",Ya(Number(ke.stock)-Number(ke.qty||0)).toFixed(3)]}),i.jsxs("div",{className:"font-semibold",children:["C$ ",D(he).toFixed(2)]})]}),i.jsx("div",{className:"mt-2 text-right",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 text-red-600",onClick:()=>H(ke.productId),children:"Quitar"})})]},ke.productId)})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"text-sm font-semibold",children:"Monto total"}),i.jsxs("div",{className:"text-xl font-bold",children:["C$ ",v.toFixed(2)]})]}),pe==="CONTADO"&&i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("input",{className:"border rounded px-2 py-2",inputMode:"decimal",value:b===0?"":b,onChange:ke=>w(Number(ke.target.value||0)),placeholder:"Monto recibido"}),i.jsxs("div",{className:"border rounded px-2 py-2 bg-gray-100",children:["Cambio: C$ ",j]})]}),i.jsx("button",{onClick:Ke,disabled:p.length===0||E,className:"w-full bg-blue-600 text-white px-4 py-2 rounded",children:E?"Guardando...":"Guardar venta"}),_&&i.jsx("div",{className:`text-sm ${_.startsWith("")?"text-green-600":_.startsWith("")?"text-yellow-600":"text-red-600"}`,children:_})]})}):i.jsxs("div",{className:"relative",children:[i.jsxs("form",{onSubmit:Ke,className:`w-full mx-auto bg-white rounded-2xl shadow-2xl\r
                 p-4 sm:p-6 md:p-8\r
                 max-w-5xl space-y-4`,children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-blue-700 whitespace-nowrap",children:"Registrar venta (Pollo)"})}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Producto | Precio por Libra/Unidad"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("select",{className:"flex-1 border border-gray-300 p-2 rounded-2xl shadow-2xl focus:ring-2 focus:ring-blue-400",value:l,onChange:ke=>c(ke.target.value),children:[i.jsx("option",{value:"",disabled:!0,children:"Selecciona un producto"}),At.map(ke=>i.jsxs("option",{value:ke.id,disabled:wt.has(ke.id),title:wt.has(ke.id)?"Ya est en la lista":`Disponible: ${X(k[ke.id]||0)}`,children:[ke.productName,"  ",ke.measurement,"  C$ ",ke.price," (disp:"," ",X(k[ke.id]||0),")"]},ke.id))]}),i.jsx("button",{type:"button",onClick:ee,disabled:!l||wt.has(l),className:"px-3 py-2 rounded-2xl shadow-2xl bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:"Agregar"})]})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Fecha de la venta"}),i.jsx("input",{type:"date",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl focus:ring-2 focus:ring-blue-400",value:u,onChange:ke=>d(ke.target.value)})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:pe,onChange:ke=>G(ke.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),pe==="CONTADO"?i.jsxs("div",{className:"md:col-span-2 space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cliente (Contado)"}),i.jsx("input",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:f,onChange:ke=>A(ke.target.value),placeholder:"Ej: Cliente Mostrador"})]}):i.jsxs("div",{className:"md:col-span-2 space-y-2",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cliente (Crdito)"}),i.jsxs("select",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:ae,onChange:ke=>Se(ke.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),fe.map(ke=>i.jsxs("option",{value:ke.status==="ACTIVO"?ke.id:"",disabled:ke.status==="BLOQUEADO",children:[ke.name,"  Saldo: ",r0(ke.balance||0)]},ke.id))]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:r0(Me)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Pago inicial"}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Mximo: ",r0(ze)]}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",max:ze,className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:Te===0?"":Te,onChange:ke=>{const Ne=Math.max(0,Number(ke.target.value||0)),Ve=Math.min(Ne,ze);O(Ve)},placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:r0(yt)})]})]})]})]}),i.jsx("div",{className:"rounded border overflow-x-auto shadow-2xl",children:i.jsxs("table",{className:"min-w-full text-sm r",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"text-center",children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio especial"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Existencias"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cantidad"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descuento"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:""})]})}),i.jsx("tbody",{children:p.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Agrega productos al carrito."})}):p.map(ke=>{const Ne=z(ke),Ve=Number(Ne||0)*Number(ke.qty||0),he=Math.max(0,Ve-Math.max(0,Number(ke.discount||0))),le=(ke.measurement||"").toLowerCase()!=="lb",Be=Ya(Number(ke.stock)-Number(ke.qty||0));return i.jsxs("tr",{className:"text-center",children:[i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:[ke.productName,"  ",ke.measurement]}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:["C$ ",D(ke.price).toFixed(2)]}),i.jsxs("td",{className:"p-2 border",children:[i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:ke.specialPrice===0?"":ke.specialPrice,onKeyDown:re,onChange:je=>U(ke.productId,je.target.value),placeholder:"",title:"Precio especial (si se deja vaco, se usa el precio normal)"}),i.jsxs("div",{className:"text-[11px] text-gray-500 mt-1",children:["Aplicado: C$ ",D(Ne).toFixed(2)]})]}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Be.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:le?1:.01,inputMode:le?"numeric":"decimal",className:"w-28 border p-1 rounded text-right",value:ke.qtyInput??(ke.qty===0?"":ke.qty),onKeyDown:re,onChange:je=>ve(ke.productId,je.target.value),placeholder:"0",title:"Cantidad"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:1,min:0,className:"w-24 border p-1 rounded text-right",value:ke.discount===0?"":ke.discount,onChange:je=>He(ke.productId,je.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento (entero C$)"})}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:["C$ ",D(he).toFixed(2)]}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 text-red-600 hover:bg-red-200",onClick:()=>H(ke.productId),title:"Quitar",children:""})})]},ke.productId)})})]})}),i.jsxs("div",{className:"space-y-1 ",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 ",children:" Monto total"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl bg-gray-100",value:`C$ ${v.toFixed(2)}`,readOnly:!0,title:"Suma de (precio aplicado  cantidad  descuento) de cada producto."})]}),pe==="CONTADO"&&i.jsx(i.Fragment,{children:i.jsxs("div",{className:"grid grid-cols-2 gap-x-3",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Monto recibido"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:b===0?"":b,onChange:ke=>w(Number(ke.target.value||0))})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cambio"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl bg-gray-100",value:`C$ ${j}`,readOnly:!0})]})]})}),i.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white px-4 py-3 sm:py-2 rounded-2xl shadow-2xl font-semibold shadow hover:bg-blue-700 transition disabled:opacity-50",disabled:p.length===0||E,children:E?"Guardando...":"Guardar venta"}),_&&i.jsx("p",{className:`text-sm mt-2 ${_.startsWith("")?"text-green-600":_.startsWith("")?"text-yellow-600":"text-red-600"}`,children:_})]}),E&&i.jsx("div",{className:"fixed inset-0 bg-black/40 z-[60] flex items-center justify-center",children:i.jsx("div",{className:"bg-white rounded-lg shadow-xl border px-6 py-5",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-semibold",children:"Guardando venta"})]})})})]})}const bo=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function o5(t="LOT"){return`${t}-${Date.now()}-${Math.random().toString(16).slice(2)}`}function NPe({role:t="",roles:e,sellerCandyId:r="",currentUserEmail:n}){const[a,s]=x.useState([]),[o,l]=x.useState([]),[c,u]=x.useState(!0),[d,f]=x.useState(""),{refreshKey:A,refresh:h}=gc(),m=e&&e.length?e:t,p=sn(m,"admin"),g=p||sn(m,"contador"),[v,y]=x.useState(Nr(yd(new Date),"yyyy-MM-dd")),[b,w]=x.useState(Nr(vd(new Date),"yyyy-MM-dd")),[j,I]=x.useState(""),[_,S]=x.useState(!1),[E,F]=x.useState(""),[k,P]=x.useState(Nr(new Date,"yyyy-MM-dd")),[D,X]=x.useState("lb"),[pe,ge]=x.useState(""),[fe,xe]=x.useState(0),[ae,Se]=x.useState(NaN),[Te,O]=x.useState(0),[G,z]=x.useState([]),[L,Z]=x.useState(null),[ee,R]=x.useState([]),[H,ne]=x.useState(!1),[ve,U]=x.useState(null),[He,se]=x.useState(!1),[re,Pe]=x.useState(null),[ue,we]=x.useState(null),Me=ie=>we($e=>$e===ie?null:ie),[ze,yt]=x.useState(!1),It=()=>yt(ie=>!ie),Ke=ie=>{const $e=(ie||"").toLowerCase();return/(^|\s)(lb|lbs|libra|libras)(\s|$)/.test($e)||$e==="lb"};x.useEffect(()=>{(async()=>{u(!0),f("");const ie=await Qt(_t(Fe,"products")),$e=[];ie.forEach(vt=>{const ht=vt.data();ht.active===!0&&$e.push({id:vt.id,name:ht.name??ht.productName??"(sin nombre)",category:ht.category??"(sin categora)",measurement:ht.measurement??"lb",price:Number(ht.price??0),providerPrice:Object.prototype.hasOwnProperty.call(ht,"providerPrice")?Number(ht.providerPrice):void 0})}),s($e);const de=er(_t(Fe,"inventory_batches"),dn("date","desc")),Ce=await Qt(de),nt=[];Ce.forEach(vt=>{const ht=vt.data(),xt=Ya(Number(ht.quantity||0)),Xe=Number(ht.purchasePrice||0),be=Number(ht.salePrice||0),st=Number((xt*Xe).toFixed(2)),K=Number((xt*be).toFixed(2));nt.push({id:vt.id,productId:ht.productId,productName:ht.productName,category:ht.category,unit:ht.unit,quantity:xt,remaining:Ya(Number(ht.remaining||0)),purchasePrice:Xe,salePrice:be,invoiceTotal:ht.invoiceTotal!=null?Number(ht.invoiceTotal):st,expectedTotal:ht.expectedTotal!=null?Number(ht.expectedTotal):K,date:ht.date,createdAt:ht.createdAt,status:ht.status,notes:ht.notes,paidAmount:Number(ht.paidAmount||0),paidAt:ht.paidAt,batchGroupId:ht.batchGroupId,orderName:ht.orderName})}),l(nt),u(!1)})()},[A]);const wt=x.useMemo(()=>o.filter(ie=>!(v&&ie.date<v||b&&ie.date>b||j&&ie.productId!==j)),[o,v,b,j]),At=x.useMemo(()=>{const ie=wt.reduce((Xe,be)=>Xe+Number(be.invoiceTotal||0),0),$e=wt.reduce((Xe,be)=>Xe+Number(be.expectedTotal||0),0);let de=0,Ce=0,nt=0,vt=0;for(const Xe of wt)Ke(Xe.unit)?(de+=Xe.quantity,Ce+=Xe.remaining):(nt+=Xe.quantity,vt+=Xe.remaining);const ht=wt.reduce((Xe,be)=>Xe+be.quantity,0),xt=wt.reduce((Xe,be)=>Xe+be.remaining,0);return{lbsIng:de,lbsRem:Ce,udsIng:nt,udsRem:vt,qty:ht,rem:xt,totalFacturado:ie,totalEsperado:$e}},[wt]),bt=x.useMemo(()=>{var de,Ce;const ie=new Map;for(const nt of wt){const vt=nt.batchGroupId&&String(nt.batchGroupId).trim()||nt.id;ie.has(vt)||ie.set(vt,[]),ie.get(vt).push(nt)}const $e=[];for(const[nt,vt]of ie.entries()){const ht=[...vt].sort((q,Y)=>{var We,dt;const oe=((We=q.createdAt)==null?void 0:We.seconds)??0;return(((dt=Y.createdAt)==null?void 0:dt.seconds)??0)-oe}),xt=((de=ht[0])==null?void 0:de.date)||"",Xe=String(((Ce=ht[0])==null?void 0:Ce.orderName)||"").trim()||`Pedido ${xt||""}`.trim()||"Pedido",be=new Set(ht.map(q=>String(q.category||"").trim()).filter(Boolean)),st=be.size===1?Array.from(be)[0].toUpperCase():"MIXTO",K=ht.some(q=>q.status==="PENDIENTE")?"PENDIENTE":"PAGADO",Ie=Ya(ht.reduce((q,Y)=>q+(Ke(Y.unit)?Number(Y.quantity||0):0),0)),Ze=Ya(ht.reduce((q,Y)=>q+(Ke(Y.unit)?Number(Y.remaining||0):0),0)),at=Ya(ht.reduce((q,Y)=>q+(Ke(Y.unit)?0:Number(Y.quantity||0)),0)),it=Ya(ht.reduce((q,Y)=>q+(Ke(Y.unit)?0:Number(Y.remaining||0)),0)),T=Number(ht.reduce((q,Y)=>q+Number(Y.invoiceTotal||0),0).toFixed(2)),M=Number(ht.reduce((q,Y)=>q+Number(Y.expectedTotal||0),0).toFixed(2)),V=Number((M-T).toFixed(2));$e.push({groupId:nt,orderName:Xe,date:xt,typeLabel:st,status:K,lbsIn:Ie,lbsRem:Ze,udsIn:at,udsRem:it,totalFacturado:T,totalEsperado:M,utilidadBruta:V,items:ht})}return $e.sort((nt,vt)=>nt.date===vt.date?nt.groupId<vt.groupId?1:-1:nt.date<vt.date?1:-1),$e},[wt]),ke=x.useMemo(()=>{const ie=String(D||"").toLowerCase().trim();return a.filter(de=>String(de.measurement||"").toLowerCase().trim()===ie).sort((de,Ce)=>de.name.localeCompare(Ce.name,"es"))},[a,D]);x.useEffect(()=>{const ie=G.find(de=>de.productId===pe);if(ie){xe(Number(ie.quantity||0)),Se(Number(ie.purchasePrice||0)),O(Number(ie.salePrice||0));return}const $e=a.find(de=>de.id===pe);$e?(xe(0),O(Number($e.price||0)),$e.providerPrice!=null&&Number.isFinite(Number($e.providerPrice))?Se(Number($e.providerPrice)):Se(NaN)):(xe(0),O(0),Se(NaN))},[pe,a,A,G]);const Ne=()=>{f("");const ie=a.find(xt=>xt.id===pe);if(!ie)return f("Selecciona un producto.");if(fe<=0||!Number.isFinite(ae)||ae<=0)return f("Completa libras a ingresar y precio proveedor.");const $e=Ya(fe),de=ie.measurement,Ce=Number(($e*Number(ae||0)).toFixed(2)),nt=Number(($e*Number(Te||0)).toFixed(2)),vt=Number((nt-Ce).toFixed(2)),ht=G.findIndex(xt=>xt.productId===ie.id);ht>=0?z(xt=>xt.map((Xe,be)=>be!==ht?Xe:{...Xe,quantity:$e,remaining:$e,purchasePrice:Number(ae||0),salePrice:Number(Te||0),invoiceTotal:Ce,expectedTotal:nt,utilidadBruta:vt})):z(xt=>[...xt,{tempId:o5("IT"),productId:ie.id,productName:ie.name,category:ie.category,unit:de,quantity:$e,remaining:$e,purchasePrice:Number(ae||0),salePrice:Number(Te||0),invoiceTotal:Ce,expectedTotal:nt,utilidadBruta:vt}]),ge(""),xe(0),Se(NaN),O(0)},Ve=ie=>{z($e=>$e.filter(de=>de.tempId!==ie))},he=(ie,$e,de)=>{z(Ce=>Ce.map(nt=>{if(nt.tempId!==ie)return nt;const vt={...nt};return $e==="quantity"&&(vt.quantity=Ya(Math.max(0,de)),L||(vt.remaining=vt.quantity)),$e==="purchasePrice"&&(vt.purchasePrice=Math.max(0,Number(de||0))),$e==="salePrice"&&(vt.salePrice=Math.max(0,Number(de||0))),vt.invoiceTotal=Number((vt.quantity*vt.purchasePrice).toFixed(2)),vt.expectedTotal=Number((vt.quantity*vt.salePrice).toFixed(2)),vt.utilidadBruta=Number((vt.expectedTotal-vt.invoiceTotal).toFixed(2)),vt}))},le=x.useMemo(()=>{const ie=Ya(G.reduce((vt,ht)=>vt+(Ke(ht.unit)?Number(ht.quantity||0):0),0)),$e=Ya(G.reduce((vt,ht)=>vt+(Ke(ht.unit)?Number(ht.remaining||0):0),0)),de=Number(G.reduce((vt,ht)=>vt+Number(ht.invoiceTotal||0),0).toFixed(2)),Ce=Number(G.reduce((vt,ht)=>vt+Number(ht.expectedTotal||0),0).toFixed(2)),nt=Number((Ce-de).toFixed(2));return{lbsIn:ie,lbsRem:$e,totalFacturado:de,totalEsperado:Ce,utilidadBruta:nt}},[G]),Be=()=>{Z(null),R([]),F(""),P(Nr(new Date,"yyyy-MM-dd")),X("lb"),ge(""),xe(0),Se(NaN),O(0),z([])},je=async()=>{if(f(""),!G.length)return f("Agrega al menos un producto al pedido.");const ie=k||Nr(new Date,"yyyy-MM-dd"),$e=String(E||"").trim()||`Pedido ${ie}`,de=L||o5("BATCH");try{if(!L){for(const ht of G)await jV({productId:ht.productId,productName:ht.productName,category:ht.category,unit:ht.unit,quantity:Ya(ht.quantity),purchasePrice:Number(ht.purchasePrice||0),salePrice:Number(ht.salePrice||0),invoiceTotal:Number(ht.invoiceTotal||0),expectedTotal:Number(ht.expectedTotal||0),date:ie,notes:"",batchGroupId:de,orderName:$e});f(" Pedido creado"),S(!1),Be(),h();return}const Ce=ee,nt=new Map;for(const ht of Ce)nt.set(ht.productId,ht);const vt=new Set(G.map(ht=>ht.productId));for(const ht of G){const xt=nt.get(ht.productId),Xe=Ya(ht.quantity);if(xt){const be=Ya(xt.quantity-xt.remaining),st=Math.max(0,Ya(Xe-be));await pn(Yt(Fe,"inventory_batches",xt.id),{date:ie,orderName:$e,batchGroupId:de,quantity:Xe,purchasePrice:Number(ht.purchasePrice||0),salePrice:Number(ht.salePrice||0),invoiceTotal:Number(ht.invoiceTotal||0),expectedTotal:Number(ht.expectedTotal||0),remaining:st})}else await jV({productId:ht.productId,productName:ht.productName,category:ht.category,unit:ht.unit,quantity:Xe,purchasePrice:Number(ht.purchasePrice||0),salePrice:Number(ht.salePrice||0),invoiceTotal:Number(ht.invoiceTotal||0),expectedTotal:Number(ht.expectedTotal||0),date:ie,notes:"",batchGroupId:de,orderName:$e})}for(const ht of Ce)vt.has(ht.productId)||await Fn(Yt(Fe,"inventory_batches",ht.id));f(" Pedido actualizado"),S(!1),Be(),h()}catch(Ce){console.error(Ce),f(" Error al guardar pedido")}},Ae=ie=>{U(ie),ne(!0)},Qe=ie=>{Z(ie.groupId),R(ie.items),F(ie.orderName),P(ie.date||Nr(new Date,"yyyy-MM-dd"));const $e=ie.items.map(de=>{const Ce=Number(de.invoiceTotal||0),nt=Number(de.expectedTotal||0);return{tempId:o5("IT"),productId:de.productId,productName:de.productName,category:de.category,unit:de.unit,quantity:Ya(de.quantity),remaining:Ya(de.remaining),purchasePrice:Number(de.purchasePrice||0),salePrice:Number(de.salePrice||0),invoiceTotal:Ce,expectedTotal:nt,utilidadBruta:Number((nt-Ce).toFixed(2))}});z($e),S(!0)},Ct=async ie=>{if(confirm(`Eliminar el pedido "${ie.orderName}" del ${ie.date}?`))try{for(const de of ie.items)await Fn(Yt(Fe,"inventory_batches",de.id));f(" Pedido eliminado"),h()}catch(de){console.error(de),f(" Error al eliminar pedido")}},pt=ie=>{Pe(ie),se(!0)},me=async()=>{if(re)try{for(const ie of re.items){if(ie.status!=="PENDIENTE")continue;await bre(ie.id),await pn(Yt(Fe,"inventory_batches",ie.id),{remaining:0});const $e={date:ie.date,productName:ie.productName,quantity:ie.quantity,amount:Number((ie.expectedTotal??ie.salePrice*ie.quantity).toFixed(2)),allocations:[{batchId:ie.id,qty:ie.quantity,unitCost:ie.purchasePrice,lineCost:Number((ie.purchasePrice*ie.quantity).toFixed(2))}],avgUnitCost:ie.purchasePrice,measurement:ie.unit,createdAt:dr.now(),autoGeneratedFromInventory:!0};await On(_t(Fe,"salesV2"),$e)}f(" Pedido pagado y reflejado como venta"),h()}catch(ie){console.error(ie),f(" Error al pagar pedido")}finally{se(!1),Pe(null)}},te=()=>{se(!1),Pe(null)};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario"}),g&&i.jsx("button",{className:"px-3 py-2 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",type:"button",onClick:()=>{Be(),S(!0)},children:"Crear Lote"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow-2xl border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:v,onChange:ie=>y(ie.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:b,onChange:ie=>w(ie.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:j,onChange:ie=>I(ie.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),a.map(ie=>i.jsxs("option",{value:ie.id,children:[ie.name,"  ",ie.category]},ie.id))]})]}),i.jsx("button",{className:"px-3 rounded-2xl shadow-2xl py-1 bg-gray-200 hover:bg-gray-300",onClick:()=>{y(""),w(""),I("")},children:"Quitar filtro"}),i.jsx("div",{className:"ml-auto",children:i.jsx(pc,{onClick:()=>h(),loading:c})})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded-2xl shadow-2xl border mb-3 text-base",children:[i.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:It,role:"button","aria-expanded":ze,children:[i.jsxs("div",{className:"flex gap-6 items-center",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",At.lbsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",At.lbsRem.toFixed(3)]})]}),i.jsx("div",{className:"text-sm text-gray-500",children:ze?"Cerrar":"Ver ms"})]}),ze&&i.jsx("div",{className:"mt-3",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",At.lbsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",At.lbsRem.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",At.udsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",At.udsRem.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ","C$ ",At.totalEsperado.toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," C$"," ",At.totalFacturado.toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," C$"," ",(At.totalEsperado-At.totalFacturado).toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes (por filtro):"})," ",wt.length.toLocaleString()]})]})})]}),i.jsx("div",{className:"md:hidden space-y-3",children:c?i.jsx("div",{className:"bg-white border rounded-2xl p-4 shadow",children:"Cargando"}):bt.length===0?i.jsx("div",{className:"bg-white border rounded-2xl p-4 shadow text-center",children:"Sin lotes"}):bt.map(ie=>{const $e=ue===ie.groupId;return i.jsxs("div",{className:"bg-white border rounded-2xl",children:[i.jsxs("div",{className:"p-4 flex items-start justify-between gap-3 cursor-pointer",onClick:()=>Me(ie.groupId),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsxs("div",{className:"font-semibold text-lg",children:[ie.date,i.jsxs("div",{className:"text-sm text-gray-500",children:["Producto: ",ie.typeLabel]})]}),i.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["Nombre: ",ie.orderName]})]}),i.jsx("div",{className:"flex items-center gap-3",children:i.jsx("span",{className:`px-2 py-1 rounded text-xs shrink-0 ${ie.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:ie.status})})]}),i.jsxs("div",{className:"pb-4 p-4 flex items-start justify-between gap-1 cursor-pointer",children:[i.jsxs("div",{className:" px-2 py-1 rounded text-xs shrink-0 bg-green-100 font-semibold text-gray-700",children:["Ingresado: ",ie.lbsIn.toFixed(3)," Lbs"]}),i.jsxs("span",{className:`px-2 py-1 rounded text-xs shrink-0 ${ie.lbsRem>0?"bg-green-100 font-semibold text-gray-700":"bg-red-100 font-semibold text-red-700"}`,children:["Disponible: ",ie.lbsRem.toFixed(3)," Lbs"]})]}),$e&&i.jsxs("div",{className:"p-4 pt-0",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Tipo"}),i.jsx("div",{className:"font-semibold",children:ie.typeLabel})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Utilidad bruta"}),i.jsx("div",{className:"font-semibold",children:bo(ie.utilidadBruta)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lbs ingresadas"}),i.jsx("div",{className:"font-semibold",children:ie.lbsIn.toFixed(3)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lbs restantes"}),i.jsx("div",{className:"font-semibold",children:ie.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 col-span-2",children:[i.jsxs("div",{className:"flex justify-between text-[11px] text-gray-500",children:[i.jsx("span",{children:"Total facturado"}),i.jsx("span",{children:"Total esperado"})]}),i.jsxs("div",{className:"flex justify-between font-semibold",children:[i.jsx("span",{children:bo(ie.totalFacturado)}),i.jsx("span",{children:bo(ie.totalEsperado)})]})]})]}),i.jsxs("div",{className:"mt-3 flex gap-2",children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-sm",onClick:()=>Ae(ie),children:"Ver detalle"}),p?i.jsxs(i.Fragment,{children:[ie.status==="PENDIENTE"&&i.jsx("button",{className:"px-3 py-2 rounded-xl bg-green-600 hover:bg-green-700 text-white text-sm",onClick:()=>pt(ie),children:"Pagar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-yellow-600 hover:bg-yellow-700 text-white text-sm",onClick:()=>Qe(ie),children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-red-600 hover:bg-red-700 text-white text-sm",onClick:()=>Ct(ie),children:"Borrar"})]}):null]})]})]},ie.groupId)})}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] w-full text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Libras ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Libras restantes"}),i.jsx("th",{className:"p-2 border",children:"Unidades ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Unidades restantes"}),i.jsx("th",{className:"p-2 border",children:"Total Facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:c?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):bt.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin lotes"})}):bt.map(ie=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsxs("td",{className:"p-2 border",children:[i.jsx("button",{className:"underline text-blue-700 hover:text-blue-900",onClick:()=>Ae(ie),title:ie.orderName,children:ie.date}),i.jsx("div",{className:"text-[11px] text-gray-500",children:ie.orderName})]}),i.jsx("td",{className:"p-2 border",children:ie.typeLabel}),i.jsx("td",{className:"p-2 border",children:ie.lbsIn.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:ie.lbsRem.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:ie.udsIn.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:ie.udsRem.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:bo(ie.totalFacturado)}),i.jsx("td",{className:"p-2 border",children:bo(ie.totalEsperado)}),i.jsx("td",{className:"p-2 border",children:bo(ie.utilidadBruta)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ie.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:ie.status})}),i.jsx("td",{className:"p-2 border",children:p?i.jsxs("div",{className:"flex gap-2 justify-center",children:[ie.status==="PENDIENTE"&&i.jsx("button",{onClick:()=>pt(ie),className:"px-2 py-1 rounded text-white bg-green-600 hover:bg-green-700",children:"Pagar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Qe(ie),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Ct(ie),children:"Borrar"})]}):i.jsx("span",{className:"text-xs text-gray-500",children:"Solo vista"})})]},ie.groupId))})]})}),d&&i.jsx("p",{className:"mt-2 text-sm",children:d}),_&&pu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>S(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-6xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:L?"Editar pedido":"Crear pedido"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>S(!1),type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre de pedido"}),i.jsx("input",{className:"w-full border p-2 rounded",value:E,onChange:ie=>F(ie.target.value),placeholder:"Ej: Pedido Pollo - Semana 1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de lote"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:k,onChange:ie=>P(ie.target.value)})]})]}),i.jsxs("div",{className:"border rounded p-3 bg-gray-50 mb-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3 items-end",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Unidad"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:D,onChange:ie=>{X(ie.target.value),ge(""),xe(0),Se(NaN),O(0)},children:[i.jsx("option",{value:"lb",children:"lb"}),i.jsx("option",{value:"unidad",children:"unidad"}),i.jsx("option",{value:"kg",children:"kg"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (solo activos)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:pe,onChange:ie=>ge(ie.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un producto"}),ke.map(ie=>i.jsxs("option",{value:ie.id,children:[ie.name,"  ",ie.category,"  ",ie.measurement]},ie.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Libras a ingresar"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:fe===0?"":fe,onChange:ie=>{const $e=ie.target.value.replace(",","."),de=parseFloat($e),Ce=Number.isFinite(de)?parseFloat(de.toFixed(3)):0;xe(Math.max(0,Ce));const nt=G.find(vt=>vt.productId===pe);nt&&he(nt.tempId,"quantity",Ce)},disabled:!pe})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio proveedor"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Number.isNaN(ae)?"":ae,onChange:ie=>{const $e=ie.target.value.replace(",",".");if($e==="")return Se(NaN);const de=parseFloat($e),Ce=Number.isFinite(de)?parseFloat(de.toFixed(2)):NaN;Se(Number.isFinite(Ce)?Math.max(0,Ce):NaN);const nt=G.find(vt=>vt.productId===pe);nt&&Number.isFinite(Ce)&&he(nt.tempId,"purchasePrice",Ce)},disabled:!pe})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio venta (editable)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Te===0?"":Te,onChange:ie=>{const $e=ie.target.value.replace(",","."),de=parseFloat($e),Ce=Number.isFinite(de)?parseFloat(de.toFixed(2)):0;O(Math.max(0,Ce));const nt=G.find(vt=>vt.productId===pe);nt&&he(nt.tempId,"salePrice",Ce)},disabled:!pe})]})]}),i.jsx("div",{className:"flex justify-end mt-3",children:i.jsx("button",{type:"button",onClick:Ne,className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Agregar producto al pedido"})})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Libras ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Libras restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:G.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center text-gray-500",children:"No hay productos agregados."})}):G.map(ie=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsxs("td",{className:"p-2 border text-left",children:[ie.productName,i.jsxs("div",{className:"text-[11px] text-gray-500",children:[ie.category,"  ",ie.unit]})]}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:ie.quantity,onChange:$e=>{const de=$e.target.value.replace(",","."),Ce=parseFloat(de),nt=Number.isFinite(Ce)?parseFloat(Ce.toFixed(3)):0;he(ie.tempId,"quantity",nt)}})}),i.jsx("td",{className:"p-2 border",children:Number(ie.remaining||0).toFixed(3)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:ie.purchasePrice,onChange:$e=>{const de=$e.target.value.replace(",","."),Ce=parseFloat(de),nt=Number.isFinite(Ce)?parseFloat(Ce.toFixed(2)):0;he(ie.tempId,"purchasePrice",nt)}})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:ie.salePrice,onChange:$e=>{const de=$e.target.value.replace(",","."),Ce=parseFloat(de),nt=Number.isFinite(Ce)?parseFloat(Ce.toFixed(2)):0;he(ie.tempId,"salePrice",nt)}})}),i.jsx("td",{className:"p-2 border",children:bo(ie.invoiceTotal)}),i.jsx("td",{className:"p-2 border",children:bo(ie.expectedTotal)}),i.jsx("td",{className:"p-2 border",children:bo(ie.utilidadBruta)}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>Ve(ie.tempId),children:"Quitar"})})]},ie.tempId))})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras ingresadas"}),i.jsx("div",{className:"text-lg font-semibold",children:le.lbsIn.toFixed(3)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Libras restantes"}),i.jsx("div",{className:"text-lg font-semibold",children:le.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado"}),i.jsx("div",{className:"text-lg font-semibold",children:bo(le.totalFacturado)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Total esperado"}),i.jsx("div",{className:"text-lg font-semibold",children:bo(le.totalEsperado)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Utilidad bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:bo(le.utilidadBruta)})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>S(!1),children:"Cancelar"}),i.jsx("button",{type:"button",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",onClick:je,disabled:G.length===0,children:L?"Editar pedido":"Crear pedido"})]})]})]}),document.body),H&&ve&&pu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[75] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>{ne(!1),U(null)}}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-6xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold",children:"Detalle del pedido"}),i.jsxs("div",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:ve.orderName})," "," ",ve.date]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{ne(!1),U(null)},type:"button",children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Ingresado"}),i.jsx("th",{className:"p-2 border",children:"Restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Compra"}),i.jsx("th",{className:"p-2 border",children:"Precio Venta"}),i.jsx("th",{className:"p-2 border",children:"Total factura"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:ve.items.map(ie=>{const $e=Number(ie.invoiceTotal||0),de=Number(ie.expectedTotal||0);return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border text-left",children:ie.productName}),i.jsx("td",{className:"p-2 border",children:(ie.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:ie.quantity.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:ie.remaining.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:bo(ie.purchasePrice)}),i.jsx("td",{className:"p-2 border",children:bo(ie.salePrice)}),i.jsx("td",{className:"p-2 border",children:bo($e)}),i.jsx("td",{className:"p-2 border",children:bo(de)}),i.jsx("td",{className:"p-2 border",children:bo(de-$e)}),i.jsx("td",{className:"p-2 border",children:ie.status})]},ie.id)})})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mt-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras ingresadas"}),i.jsx("div",{className:"text-lg font-semibold",children:ve.lbsIn.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras restantes"}),i.jsx("div",{className:"text-lg font-semibold",children:ve.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:bo(ve.utilidadBruta)})]})]})]})]}),document.body),He&&re&&pu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[80] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:te}),i.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl border w-[90%] max-w-md p-6",children:[i.jsx("h3",{className:"text-lg font-bold mb-3 text-center",children:"Confirmar pago de inventario"}),i.jsxs("p",{className:"text-sm text-gray-700 mb-5 text-center",children:["Seguro que quieres pagar este pedido?",i.jsx("br",{}),i.jsx("strong",{children:re.orderName})," "," ",re.date,i.jsx("br",{}),"Ya no habrn libras disponibles al pagar este inventario."]}),i.jsxs("div",{className:"flex justify-center gap-4",children:[i.jsx("button",{onClick:me,className:"px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700",children:"Confirmar"}),i.jsx("button",{onClick:te,className:"px-4 py-2 rounded-lg bg-gray-300 hover:bg-gray-400",children:"Cancelar"})]})]})]}),document.body)]})}const gh=t=>`C$${(Number(t)||0).toFixed(2)}`;function CPe(){const t=L2e(new Date),[e,r]=x.useState(Nr(t,"yyyy-MM")),[n,a]=x.useState([]),[s,o]=x.useState(!1),[l,c]=x.useState(""),u=x.useRef(null),d=x.useMemo(()=>{const[g,v]=e.split("-").map(w=>parseInt(w,10)),y=Nr(yd(new Date(g,v-1,1)),"yyyy-MM-dd"),b=Nr(vd(new Date(g,v-1,1)),"yyyy-MM-dd");return{from:y,to:b}},[e]),f=async()=>{o(!0);try{const g=await tPe(d.from,d.to),v=[];for(const y of g){const b=Yt(Fe,"inventory_batches",y.batchId),w=await Bs(b);if(!w.exists())continue;const j=w.data();v.push({batchId:y.batchId,batchDate:y.batchDate,productName:y.productName,soldQty:Number(y.quantity||0),soldAmount:Number(y.amountCharged||0),status:j.status??"PENDIENTE",purchasePrice:Number(j.purchasePrice||0),salePrice:Number(j.salePrice||0),supplier:j.supplier})}a(v)}catch(g){console.error(g),c(" Error al cargar liquidaciones")}finally{o(!1)}};x.useEffect(()=>{f()},[e]);const A=async g=>{confirm("Marcar este lote como PAGADO?")&&(await bre(g),a(y=>y.map(b=>b.batchId===g?{...b,status:"PAGADO"}:b)))},h=x.useMemo(()=>{const g=n.reduce((w,j)=>w+j.soldQty,0),v=n.reduce((w,j)=>w+j.soldAmount,0),y=n.reduce((w,j)=>w+j.soldQty*j.purchasePrice,0),b=v-y;return{q:g,amt:v,cogs:y,profit:b}},[n]),m=x.useMemo(()=>{const g=new Map;for(const v of n){const y=v.productName||"(sin nombre)";g.has(y)||g.set(y,{productName:y,qty:0,revenue:0,cogs:0,profit:0});const b=g.get(y);b.qty+=v.soldQty,b.revenue+=v.soldAmount;const w=v.soldQty*v.purchasePrice;b.cogs+=w,b.profit=b.revenue-b.cogs}return Array.from(g.values()).sort((v,y)=>v.productName.localeCompare(y.productName))},[n]),p=async()=>{if(!u.current)return;const g=u.current;g.classList.add("force-pdf-colors");try{const[{default:v},{jsPDF:y}]=await Promise.all([Kh(()=>Promise.resolve().then(()=>_6),void 0),Kh(()=>Promise.resolve().then(()=>Pk),void 0)]),w=(await v(g,{backgroundColor:"#ffffff",scale:2})).toDataURL("image/png"),j=new y("p","mm","a4"),I=190,_=j.getImageProperties(w),S=I,E=_.height*S/_.width;j.addImage(w,"PNG",10,10,S,E),j.save(`liquidaciones_${e}.pdf`)}catch(v){console.error(v),alert("No se pudo generar el PDF")}finally{g.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between gap-3 mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Liquidaciones por lote"}),i.jsx("button",{onClick:p,className:"bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700",children:"Descargar PDF"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-center gap-3",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Mes:"}),i.jsx("input",{type:"month",className:"border rounded px-2 py-1",value:e,onChange:g=>r(g.target.value)}),i.jsx("button",{onClick:f,className:"bg-gray-800 text-white px-3 py-1 rounded",children:"Aplicar"})]}),i.jsxs("div",{ref:u,children:[i.jsx("div",{className:"bg-white p-3 rounded shadow border mb-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total vendido (cantidad):"})," ",h.q]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Monto vendido:"})," ",gh(h.amt)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Costo (COGS):"})," ",gh(h.cogs)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Utilidad:"})," ",gh(h.profit)]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto mb-6",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Lote (fecha)"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Proveedor"}),i.jsx("th",{className:"p-2 border",children:"Vendido"}),i.jsx("th",{className:"p-2 border",children:"Monto vendido"}),i.jsx("th",{className:"p-2 border",children:"COGS"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Cargando"})}):n.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Sin datos"})}):n.map(g=>{const v=g.soldQty*g.purchasePrice,y=g.soldAmount-v;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:g.batchDate}),i.jsx("td",{className:"p-2 border",children:g.productName}),i.jsx("td",{className:"p-2 border",children:g.supplier||"-"}),i.jsx("td",{className:"p-2 border",children:g.soldQty}),i.jsx("td",{className:"p-2 border",children:gh(g.soldAmount)}),i.jsx("td",{className:"p-2 border",children:gh(v)}),i.jsx("td",{className:`p-2 border ${y>=0?"text-green-700":"text-red-700"}`,children:gh(y)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${g.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:g.status})}),i.jsx("td",{className:"p-2 border",children:g.status==="PENDIENTE"&&i.jsx("button",{onClick:()=>A(g.batchId),className:"px-2 py-1 rounded text-white bg-green-600 hover:bg-green-700",children:"Marcar pagado"})})]},g.batchId)})})]})}),i.jsx("h3",{className:"font-semibold mb-2",children:"Utilidad por producto"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Cantidad vendida"}),i.jsx("th",{className:"p-2 border",children:"Ingreso"}),i.jsx("th",{className:"p-2 border",children:"COGS"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"})]})}),i.jsx("tbody",{children:m.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin datos"})}):m.map(g=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:g.productName}),i.jsx("td",{className:"p-2 border",children:g.qty}),i.jsx("td",{className:"p-2 border",children:gh(g.revenue)}),i.jsx("td",{className:"p-2 border",children:gh(g.cogs)}),i.jsx("td",{className:`p-2 border ${g.profit>=0?"text-green-700":"text-red-700"}`,children:gh(g.profit)})]},g.productName))})]})})]}),l&&i.jsx("p",{className:"mt-2 text-sm",children:l})]})}function Ere(t,e,r,n,a){n=n||{};var s=1.15,o=a.internal.scaleFactor,l=a.internal.getFontSize()/o,c=a.getLineHeightFactor?a.getLineHeightFactor():s,u=l*c,d=/\r\n|\r|\n/g,f="",A=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(f=typeof t=="string"?t.split(d):t,A=f.length||1),r+=l*(2-s),n.valign==="middle"?r-=A/2*u:n.valign==="bottom"&&(r-=A*u),n.halign==="center"||n.halign==="right"){var h=l;if(n.halign==="center"&&(h*=.5),f&&A>=1){for(var m=0;m<f.length;m++)a.text(f[m],e-a.getStringUnitWidth(f[m])*h,r),r+=u;return a}e-=a.getStringUnitWidth(t)*h}return n.halign==="justify"?a.text(t,e,r,{maxWidth:n.maxWidth||100,align:"justify"}):a.text(t,e,r),a}var DV={},ov=function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:DV=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var n,a,s;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var o=this.jsPDFDocument.internal.getFont(),l=o.fontStyle,c=o.fontName;if(e.font&&(c=e.font),e.fontStyle){l=e.fontStyle;var u=this.getFontList()[c];u&&u.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(u[0]),l=u[0])}if(this.jsPDFDocument.setFont(c,l),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var d=t.unifyColor(e.fillColor);d&&(n=this.jsPDFDocument).setFillColor.apply(n,d),d=t.unifyColor(e.textColor),d&&(a=this.jsPDFDocument).setTextColor.apply(a,d),d=t.unifyColor(e.lineColor),d&&(s=this.jsPDFDocument).setDrawColor.apply(s,d),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,n){return this.jsPDFDocument.splitTextToSize(e,r,n)},t.prototype.rect=function(e,r,n,a,s){return this.jsPDFDocument.rect(e,r,n,a,s)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return DV||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t}(),Bk=function(t,e){return Bk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},Bk(t,e)};function Sre(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Bk(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Ire=function(t){Sre(e,t);function e(r){var n=t.call(this)||this;return n._element=r,n}return e}(Array);function _Pe(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function EPe(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function _S(t,e,r){r.applyStyles(e,!0);var n=Array.isArray(t)?t:[t],a=n.map(function(s){return r.getTextWidth(s)}).reduce(function(s,o){return Math.max(s,o)},0);return a}function jre(t,e,r,n){var a=e.settings.tableLineWidth,s=e.settings.tableLineColor;t.applyStyles({lineWidth:a,lineColor:s});var o=Pre(a,!1);o&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),n.y-r.y,o)}function Pre(t,e){var r=t>0,n=e||e===0;return r&&n?"DF":r?"S":n?"F":null}function qj(t,e){var r,n,a,s;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(n=t.top)!==null&&n!==void 0?n:e,right:(a=t.right)!==null&&a!==void 0?a:e,bottom:(s=t.bottom)!==null&&s!==void 0?s:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function Bre(t,e){var r=qj(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function SPe(t,e,r,n,a){var s={},o=1.3333333333333333,l=l5(e,function(b){return a.getComputedStyle(b).backgroundColor});l!=null&&(s.fillColor=l);var c=l5(e,function(b){return a.getComputedStyle(b).color});c!=null&&(s.textColor=c);var u=jPe(n,r);u&&(s.cellPadding=u);var d="borderTopColor",f=o*r,A=n.borderTopWidth;if(n.borderBottomWidth===A&&n.borderRightWidth===A&&n.borderLeftWidth===A){var h=(parseFloat(A)||0)/f;h&&(s.lineWidth=h)}else s.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/f,right:(parseFloat(n.borderRightWidth)||0)/f,bottom:(parseFloat(n.borderBottomWidth)||0)/f,left:(parseFloat(n.borderLeftWidth)||0)/f},s.lineWidth.top||(s.lineWidth.right?d="borderRightColor":s.lineWidth.bottom?d="borderBottomColor":s.lineWidth.left&&(d="borderLeftColor"));var m=l5(e,function(b){return a.getComputedStyle(b)[d]});m!=null&&(s.lineColor=m);var p=["left","right","center","justify"];p.indexOf(n.textAlign)!==-1&&(s.halign=n.textAlign),p=["middle","bottom","top"],p.indexOf(n.verticalAlign)!==-1&&(s.valign=n.verticalAlign);var g=parseInt(n.fontSize||"");isNaN(g)||(s.fontSize=g/o);var v=IPe(n);v&&(s.fontStyle=v);var y=(n.fontFamily||"").toLowerCase();return t.indexOf(y)!==-1&&(s.font=y),s}function IPe(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function l5(t,e){var r=Tre(t,e);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var a=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],s=parseInt(n[4]);return s===0||isNaN(a[0])||isNaN(a[1])||isNaN(a[2])?null:a}function Tre(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:Tre(t.parentElement,e):r}function jPe(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],n=96/(72/e),a=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,s=r.map(function(l){return parseInt(l||"0")/n}),o=qj(s,0);return a>o.top&&(o.top=a),a>o.bottom&&(o.bottom=a),o}function kre(t,e,r,n,a){var s,o;n===void 0&&(n=!1),a===void 0&&(a=!1);var l;typeof e=="string"?l=r.document.querySelector(e):l=e;var c=Object.keys(t.getFontList()),u=t.scaleFactor(),d=[],f=[],A=[];if(!l)return console.error("Html table could not be found with input: ",e),{head:d,body:f,foot:A};for(var h=0;h<l.rows.length;h++){var m=l.rows[h],p=(o=(s=m==null?void 0:m.parentElement)===null||s===void 0?void 0:s.tagName)===null||o===void 0?void 0:o.toLowerCase(),g=PPe(c,u,r,m,n,a);g&&(p==="thead"?d.push(g):p==="tfoot"?A.push(g):f.push(g))}return{head:d,body:f,foot:A}}function PPe(t,e,r,n,a,s){for(var o=new Ire(n),l=0;l<n.cells.length;l++){var c=n.cells[l],u=r.getComputedStyle(c);if(a||u.display!=="none"){var d=void 0;s&&(d=SPe(t,c,e,u,r)),o.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:d,_element:c,content:BPe(c)})}}var f=r.getComputedStyle(n);if(o.length>0&&(a||f.display!=="none"))return o}function BPe(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function TPe(t,e,r){for(var n=0,a=[t,e,r];n<a.length;n++){var s=a[n];s&&typeof s!="object"&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&typeof s.startY!="number"&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}function Dh(t,e,r,n,a){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(t),o=1;o<arguments.length;o++){var l=arguments[o];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(s[c]=l[c])}return s}function Fre(t,e){var r=new ov(t),n=r.getDocumentOptions(),a=r.getGlobalOptions();TPe(a,n,e);var s=Dh({},a,n,e),o;typeof window<"u"&&(o=window);var l=kPe(a,n,e),c=FPe(a,n,e),u=OPe(r,s),d=RPe(r,s,o);return{id:e.tableId,content:d,hooks:c,styles:l,settings:u}}function kPe(t,e,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},a=function(c){if(c==="columnStyles"){var u=t[c],d=e[c],f=r[c];n.columnStyles=Dh({},u,d,f)}else{var A=[t,e,r],h=A.map(function(m){return m[c]||{}});n[c]=Dh({},h[0],h[1],h[2])}},s=0,o=Object.keys(n);s<o.length;s++){var l=o[s];a(l)}return n}function FPe(t,e,r){for(var n=[t,e,r],a={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},s=0,o=n;s<o.length;s++){var l=o[s];l.didParseCell&&a.didParseCell.push(l.didParseCell),l.willDrawCell&&a.willDrawCell.push(l.willDrawCell),l.didDrawCell&&a.didDrawCell.push(l.didDrawCell),l.willDrawPage&&a.willDrawPage.push(l.willDrawPage),l.didDrawPage&&a.didDrawPage.push(l.didDrawPage)}return a}function OPe(t,e){var r,n,a,s,o,l,c,u,d,f,A,h,m=qj(e.margin,40/t.scaleFactor()),p=(r=DPe(t,e.startY))!==null&&r!==void 0?r:m.top,g;e.showFoot===!0?g="everyPage":e.showFoot===!1?g="never":g=(n=e.showFoot)!==null&&n!==void 0?n:"everyPage";var v;e.showHead===!0?v="everyPage":e.showHead===!1?v="never":v=(a=e.showHead)!==null&&a!==void 0?a:"everyPage";var y=(s=e.useCss)!==null&&s!==void 0?s:!1,b=e.theme||(y?"plain":"striped"),w=!!e.horizontalPageBreak,j=(o=e.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(l=e.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:y,theme:b,startY:p,margin:m,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(u=e.rowPageBreak)!==null&&u!==void 0?u:"auto",tableWidth:(d=e.tableWidth)!==null&&d!==void 0?d:"auto",showHead:v,showFoot:g,tableLineWidth:(f=e.tableLineWidth)!==null&&f!==void 0?f:0,tableLineColor:(A=e.tableLineColor)!==null&&A!==void 0?A:200,horizontalPageBreak:w,horizontalPageBreakRepeat:j,horizontalPageBreakBehaviour:(h=e.horizontalPageBreakBehaviour)!==null&&h!==void 0?h:"afterAllRows"}}function DPe(t,e){var r=t.getLastAutoTable(),n=t.scaleFactor(),a=t.pageNumber(),s=!1;if(r&&r.startPageNumber){var o=r.startPageNumber+r.pageNumber-1;s=o===a}return typeof e=="number"?e:(e==null||e===!1)&&s&&(r==null?void 0:r.finalY)!=null?r.finalY+20/n:null}function RPe(t,e,r){var n=e.head||[],a=e.body||[],s=e.foot||[];if(e.html){var o=e.includeHiddenHtml;if(r){var l=kre(t,e.html,r,o,e.useCss)||{};n=l.head||n,a=l.body||n,s=l.foot||n}else console.error("Cannot parse html in non browser environment")}var c=e.columns||MPe(n,a,s);return{columns:c,head:n,body:a,foot:s}}function MPe(t,e,r){var n=t[0]||e[0]||r[0]||[],a=[];return Object.keys(n).filter(function(s){return s!=="_element"}).forEach(function(s){var o=1,l;Array.isArray(n)?l=n[parseInt(s)]:l=n[s],typeof l=="object"&&!Array.isArray(l)&&(o=(l==null?void 0:l.colSpan)||1);for(var c=0;c<o;c++){var u=void 0;Array.isArray(n)?u=a.length:u=s+(c>0?"_".concat(c):"");var d={dataKey:u};a.push(d)}}),a}var Tk=function(){function t(e,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=e.getDocument()}return t}(),LPe=function(t){Sre(e,t);function e(r,n,a,s,o,l){var c=t.call(this,r,n,l)||this;return c.cell=a,c.row=s,c.column=o,c.section=s.section,c}return e}(Tk),UPe=function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,n,a,s,o){for(var l=0,c=r;l<c.length;l++){var u=c[l],d=new LPe(e,this,n,a,s,o),f=u(d)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],f)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var n=0,a=this.hooks.didDrawPage;n<a.length;n++){var s=a[n];s(new Tk(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var n=0,a=this.hooks.willDrawPage;n<a.length;n++){var s=a[n];s(new Tk(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(a,s){return a+s.wrappedWidth},0);return r}else{var n=this.settings.margin;return e-n.left-n.right}},t}(),Ore=function(){function t(e,r,n,a,s){s===void 0&&(s=!1),this.height=0,this.raw=e,e instanceof Ire&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=n,this.cells=a,this.spansMultiplePages=s}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(n,a){var s;return Math.max(n,((s=r.cells[a.index])===null||s===void 0?void 0:s.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(n){var a=r.cells[n.index];return a?a.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var n=this;return e.reduce(function(a,s){var o=n.cells[s.index];if(!o)return 0;var l=r.getLineHeight(o.styles.fontSize),c=o.padding("vertical"),u=c+l;return u>a?u:a},0)},t}(),Dre=function(){function t(e,r,n){var a;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=e;var s=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,s=(a=e.content)!==null&&a!==void 0?a:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var o=s!=null?""+s:"",l=/\r\n|\r|\n/g;this.text=o.split(l)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var a=this.width-this.padding("horizontal");n=this.x+a/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,a=this.styles.fontSize/e*r,s=n*a+this.padding("vertical");return Math.max(s,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=qj(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t}(),QPe=function(){function t(e,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=n}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,n=0,a=e.allRows();n<a.length;n++){var s=a[n],o=s.cells[this.index];o&&typeof o.styles.cellWidth=="number"&&(r=Math.max(r,o.styles.cellWidth))}return r},t}();function VPe(t,e){HPe(t,e);var r=[],n=0;e.columns.forEach(function(s){var o=s.getMaxCustomCellWidth(e);o?s.width=o:(s.width=s.wrappedWidth,r.push(s)),n+=s.width});var a=e.getWidth(t.pageSize().width)-n;a&&(a=kk(r,a,function(s){return Math.max(s.minReadableWidth,s.minWidth)})),a&&(a=kk(r,a,function(s){return s.minWidth})),a=Math.abs(a),!e.settings.horizontalPageBreak&&a>.1/t.scaleFactor()&&(a=a<1?a:Math.round(a),console.warn("Of the table content, ".concat(a," units width could not fit page"))),GPe(e),KPe(e,t),$Pe(e)}function HPe(t,e){var r=t.scaleFactor(),n=e.settings.horizontalPageBreak,a=Bre(t,e);e.allRows().forEach(function(s){for(var o=0,l=e.columns;o<l.length;o++){var c=l[o],u=s.cells[c.index];if(u){var d=e.hooks.didParseCell;e.callCellHooks(t,d,u,s,c,null);var f=u.padding("horizontal");u.contentWidth=_S(u.text,u.styles,t)+f;var A=_S(u.text.join(" ").split(/[^\S\u00A0]+/),u.styles,t);if(u.minReadableWidth=A+u.padding("horizontal"),typeof u.styles.cellWidth=="number")u.minWidth=u.styles.cellWidth,u.wrappedWidth=u.styles.cellWidth;else if(u.styles.cellWidth==="wrap"||n===!0)u.contentWidth>a?(u.minWidth=a,u.wrappedWidth=a):(u.minWidth=u.contentWidth,u.wrappedWidth=u.contentWidth);else{var h=10/r;u.minWidth=u.styles.minCellWidth||h,u.wrappedWidth=u.contentWidth,u.minWidth>u.wrappedWidth&&(u.wrappedWidth=u.minWidth)}}}}),e.allRows().forEach(function(s){for(var o=0,l=e.columns;o<l.length;o++){var c=l[o],u=s.cells[c.index];if(u&&u.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,u.wrappedWidth),c.minWidth=Math.max(c.minWidth,u.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,u.minReadableWidth);else{var d=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},f=d.cellWidth||d.minCellWidth;f&&typeof f=="number"&&(c.minWidth=f,c.wrappedWidth=f)}u&&(u.colSpan>1&&!c.minWidth&&(c.minWidth=u.minWidth),u.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=u.minWidth))}})}function kk(t,e,r){for(var n=e,a=t.reduce(function(h,m){return h+m.wrappedWidth},0),s=0;s<t.length;s++){var o=t[s],l=o.wrappedWidth/a,c=n*l,u=o.width+c,d=r(o),f=u<d?d:u;e-=f-o.width,o.width=f}if(e=Math.round(e*1e10)/1e10,e){var A=t.filter(function(h){return e<0?h.width>r(h):!0});A.length&&(e=kk(A,e,r))}return e}function $Pe(t){for(var e={},r=1,n=t.allRows(),a=0;a<n.length;a++)for(var s=n[a],o=0,l=t.columns;o<l.length;o++){var c=l[o],u=e[c.index];if(r>1)r--,delete s.cells[c.index];else if(u)u.cell.height+=s.height,r=u.cell.colSpan,delete s.cells[c.index],u.left--,u.left<=1&&delete e[c.index];else{var d=s.cells[c.index];if(!d)continue;if(d.height=s.height,d.rowSpan>1){var f=n.length-a,A=d.rowSpan>f?f:d.rowSpan;e[c.index]={cell:d,left:A,row:s}}}}}function GPe(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var n=e[r],a=null,s=0,o=0,l=0;l<t.columns.length;l++){var c=t.columns[l];if(o-=1,o>1&&t.columns[l+1])s+=c.width,delete n.cells[c.index];else if(a){var u=a;delete n.cells[c.index],a=null,u.width=c.width+s}else{var u=n.cells[c.index];if(!u)continue;if(o=u.colSpan,s=0,u.colSpan>1){a=u,s+=c.width;continue}u.width=c.width+s}}}function KPe(t,e){for(var r={count:0,height:0},n=0,a=t.allRows();n<a.length;n++){for(var s=a[n],o=0,l=t.columns;o<l.length;o++){var c=l[o],u=s.cells[c.index];if(u){e.applyStyles(u.styles,!0);var d=u.width-u.padding("horizontal");if(u.styles.overflow==="linebreak")u.text=e.splitTextToSize(u.text,d+1/e.scaleFactor(),{fontSize:u.styles.fontSize});else if(u.styles.overflow==="ellipsize")u.text=RV(u.text,d,u.styles,e,"...");else if(u.styles.overflow==="hidden")u.text=RV(u.text,d,u.styles,e,"");else if(typeof u.styles.overflow=="function"){var f=u.styles.overflow(u.text,d);typeof f=="string"?u.text=[f]:u.text=f}u.contentHeight=u.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var A=u.contentHeight/u.rowSpan;u.rowSpan>1&&r.count*r.height<A*u.rowSpan?r={height:A,count:u.rowSpan}:r&&r.count>0&&r.height>A&&(A=r.height),A>s.height&&(s.height=A)}}r.count--}}function RV(t,e,r,n,a){return t.map(function(s){return qPe(s,e,r,n,a)})}function qPe(t,e,r,n,a){var s=1e4*n.scaleFactor();if(e=Math.ceil(e*s)/s,e>=_S(t,r,n))return t;for(;e<_S(t+a,r,n)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+a}function Rre(t,e){var r=new ov(t),n=zPe(e,r.scaleFactor()),a=new UPe(e,n);return VPe(r,a),r.applyStyles(r.userStyles),a}function zPe(t,e){var r=t.content,n=XPe(r.columns);if(r.head.length===0){var a=MV(n,"head");a&&r.head.push(a)}if(r.foot.length===0){var a=MV(n,"foot");a&&r.foot.push(a)}var s=t.settings.theme,o=t.styles;return{columns:n,head:c5("head",r.head,n,o,s,e),body:c5("body",r.body,n,o,s,e),foot:c5("foot",r.foot,n,o,s,e)}}function c5(t,e,r,n,a,s){var o={},l=e.map(function(c,u){for(var d=0,f={},A=0,h=0,m=0,p=r;m<p.length;m++){var g=p[m];if(o[g.index]==null||o[g.index].left===0)if(h===0){var v=void 0;Array.isArray(c)?v=c[g.index-A-d]:v=c[g.dataKey];var y={};typeof v=="object"&&!Array.isArray(v)&&(y=(v==null?void 0:v.styles)||{});var b=YPe(t,g,u,a,n,s,y),w=new Dre(v,b,t);f[g.dataKey]=w,f[g.index]=w,h=w.colSpan-1,o[g.index]={left:w.rowSpan-1,times:h}}else h--,A++;else o[g.index].left--,h=o[g.index].times,d++}return new Ore(c,u,t,f)});return l}function MV(t,e){var r={};return t.forEach(function(n){if(n.raw!=null){var a=WPe(e,n.raw);a!=null&&(r[n.dataKey]=a)}}),Object.keys(r).length>0?r:null}function WPe(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function XPe(t){return t.map(function(e,r){var n,a;return typeof e=="object"?a=(n=e.dataKey)!==null&&n!==void 0?n:r:a=r,new QPe(a,e,r)})}function YPe(t,e,r,n,a,s,o){var l=EPe(n),c;t==="head"?c=a.headStyles:t==="body"?c=a.bodyStyles:t==="foot"&&(c=a.footStyles);var u=Dh({},l.table,l[t],a.styles,c),d=a.columnStyles[e.dataKey]||a.columnStyles[e.index]||{},f=t==="body"?d:{},A=t==="body"&&r%2===0?Dh({},l.alternateRow,a.alternateRowStyles):{},h=_Pe(s),m=Dh({},h,u,A,f);return Dh(m,o)}function JPe(t,e,r){var n;r===void 0&&(r={});var a=Bre(t,e),s=new Map,o=[],l=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(A){var h=e.columns.find(function(m){return m.dataKey===A||m.index===A});h&&!s.has(h.index)&&(s.set(h.index,!0),o.push(h.index),l.push(e.columns[h.index]),a-=h.wrappedWidth)});for(var u=!0,d=(n=r==null?void 0:r.start)!==null&&n!==void 0?n:0;d<e.columns.length;){if(s.has(d)){d++;continue}var f=e.columns[d].wrappedWidth;if(u||a>=f)u=!1,o.push(d),l.push(e.columns[d]),a-=f;else break;d++}return{colIndexes:o,columns:l,lastIndex:d-1}}function ZPe(t,e){for(var r=[],n=0;n<e.columns.length;n++){var a=JPe(t,e,{start:n});a.columns.length&&(r.push(a),n=a.lastIndex)}return r}function Mre(t,e){var r=e.settings,n=r.startY,a=r.margin,s={x:a.left,y:n},o=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),l=n+a.bottom+o;if(r.pageBreak==="avoid"){var c=e.body,u=c.reduce(function(A,h){return A+h.height},0);l+=u}var d=new ov(t);(r.pageBreak==="always"||r.startY!=null&&l>d.pageSize().height)&&(Ure(d),s.y=a.top),e.callWillDrawPageHooks(d,s);var f=Dh({},s);e.startPageNumber=d.pageNumber(),r.horizontalPageBreak?e4e(d,e,f,s):(d.applyStyles(d.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(A){return iA(d,e,A,s,e.columns)}),d.applyStyles(d.userStyles),e.body.forEach(function(A,h){var m=h===e.body.length-1;ES(d,e,A,m,f,s,e.columns)}),d.applyStyles(d.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(A){return iA(d,e,A,s,e.columns)})),jre(d,e,f,s),e.callEndPageHooks(d,s),e.finalY=s.y,t.lastAutoTable=e,d.applyStyles(d.userStyles)}function e4e(t,e,r,n){var a=ZPe(t,e),s=e.settings;if(s.horizontalPageBreakBehaviour==="afterAllRows")a.forEach(function(u,d){t.applyStyles(t.userStyles),d>0?wb(t,e,r,n,u.columns,!0):LV(t,e,n,u.columns),t4e(t,e,r,n,u.columns),u5(t,e,n,u.columns)});else for(var o=-1,l=a[0],c=function(){var u=o;if(l){t.applyStyles(t.userStyles);var d=l.columns;o>=0?wb(t,e,r,n,d,!0):LV(t,e,n,d),u=UV(t,e,o+1,n,d),u5(t,e,n,d)}var f=u-o;a.slice(1).forEach(function(A){t.applyStyles(t.userStyles),wb(t,e,r,n,A.columns,!0),UV(t,e,o+1,n,A.columns,f),u5(t,e,n,A.columns)}),o=u};o<e.body.length-1;)c()}function LV(t,e,r,n){var a=e.settings;t.applyStyles(t.userStyles),(a.showHead==="firstPage"||a.showHead==="everyPage")&&e.head.forEach(function(s){return iA(t,e,s,r,n)})}function t4e(t,e,r,n,a){t.applyStyles(t.userStyles),e.body.forEach(function(s,o){var l=o===e.body.length-1;ES(t,e,s,l,r,n,a)})}function UV(t,e,r,n,a,s){t.applyStyles(t.userStyles),s=s??e.body.length;var o=Math.min(r+s,e.body.length),l=-1;return e.body.slice(r,o).forEach(function(c,u){var d=r+u===e.body.length-1,f=Lre(t,e,d,n);c.canEntireRowFit(f,a)&&(iA(t,e,c,n,a),l=r+u)}),l}function u5(t,e,r,n){var a=e.settings;t.applyStyles(t.userStyles),(a.showFoot==="lastPage"||a.showFoot==="everyPage")&&e.foot.forEach(function(s){return iA(t,e,s,r,n)})}function r4e(t,e,r){var n=r.getLineHeight(t.styles.fontSize),a=t.padding("vertical"),s=Math.floor((e-a)/n);return Math.max(0,s)}function n4e(t,e,r,n){var a={};t.spansMultiplePages=!0,t.height=0;for(var s=0,o=0,l=r.columns;o<l.length;o++){var c=l[o],u=t.cells[c.index];if(u){Array.isArray(u.text)||(u.text=[u.text]);var d=new Dre(u.raw,u.styles,u.section);d=Dh(d,u),d.text=[];var f=r4e(u,e,n);u.text.length>f&&(d.text=u.text.splice(f,u.text.length));var A=n.scaleFactor(),h=n.getLineHeightFactor();u.contentHeight=u.getContentHeight(A,h),u.contentHeight>=e&&(u.contentHeight=e,d.styles.minCellHeight-=e),u.contentHeight>t.height&&(t.height=u.contentHeight),d.contentHeight=d.getContentHeight(A,h),d.contentHeight>s&&(s=d.contentHeight),a[c.index]=d}}var m=new Ore(t.raw,-1,t.section,a,!0);m.height=s;for(var p=0,g=r.columns;p<g.length;p++){var c=g[p],d=m.cells[c.index];d&&(d.height=m.height);var u=t.cells[c.index];u&&(u.height=t.height)}return m}function a4e(t,e,r,n){var a=t.pageSize().height,s=n.settings.margin,o=s.top+s.bottom,l=a-o;e.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=e.getMinimumRowHeight(n.columns,t),u=c<r;if(c>l)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!u)return!1;var d=e.hasRowSpan(n.columns),f=e.getMaxCellHeight(n.columns)>l;return f?(d&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(d||n.settings.rowPageBreak==="avoid")}function ES(t,e,r,n,a,s,o){var l=Lre(t,e,n,s);if(r.canEntireRowFit(l,o))iA(t,e,r,s,o);else if(a4e(t,r,l,e)){var c=n4e(r,l,e,t);iA(t,e,r,s,o),wb(t,e,a,s,o),ES(t,e,c,n,a,s,o)}else wb(t,e,a,s,o),ES(t,e,r,n,a,s,o)}function iA(t,e,r,n,a){n.x=e.settings.margin.left;for(var s=0,o=a;s<o.length;s++){var l=o[s],c=r.cells[l.index];if(!c){n.x+=l.width;continue}t.applyStyles(c.styles),c.x=n.x,c.y=n.y;var u=e.callCellHooks(t,e.hooks.willDrawCell,c,r,l,n);if(u===!1){n.x+=l.width;continue}s4e(t,c,n);var d=c.getTextPos();Ere(c.text,d.x,d.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,c,r,l,n),n.x+=l.width}n.y+=r.height}function s4e(t,e,r){var n=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof n.lineWidth=="number"){var a=Pre(n.lineWidth,n.fillColor);a&&t.rect(e.x,r.y,e.width,e.height,a)}else typeof n.lineWidth=="object"&&(n.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),i4e(t,e,r,n.lineWidth))}function i4e(t,e,r,n){var a,s,o,l;n.top&&(a=r.x,s=r.y,o=r.x+e.width,l=r.y,n.right&&(o+=.5*n.right),n.left&&(a-=.5*n.left),c(n.top,a,s,o,l)),n.bottom&&(a=r.x,s=r.y+e.height,o=r.x+e.width,l=r.y+e.height,n.right&&(o+=.5*n.right),n.left&&(a-=.5*n.left),c(n.bottom,a,s,o,l)),n.left&&(a=r.x,s=r.y,o=r.x,l=r.y+e.height,n.top&&(s-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.left,a,s,o,l)),n.right&&(a=r.x+e.width,s=r.y,o=r.x+e.width,l=r.y+e.height,n.top&&(s-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.right,a,s,o,l));function c(u,d,f,A,h){t.getDocument().setLineWidth(u),t.getDocument().line(d,f,A,h,"S")}}function Lre(t,e,r,n){var a=e.settings.margin.bottom,s=e.settings.showFoot;return(s==="everyPage"||s==="lastPage"&&r)&&(a+=e.getFootHeight(e.columns)),t.pageSize().height-n.y-a}function wb(t,e,r,n,a,s){a===void 0&&(a=[]),s===void 0&&(s=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!s&&e.foot.forEach(function(l){return iA(t,e,l,n,a)}),e.callEndPageHooks(t,n);var o=e.settings.margin;jre(t,e,r,n),Ure(t),e.pageNumber++,n.x=o.left,n.y=o.top,r.y=o.top,e.callWillDrawPageHooks(t,n),e.settings.showHead==="everyPage"&&(e.head.forEach(function(l){return iA(t,e,l,n,a)}),t.applyStyles(t.userStyles))}function Ure(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function o4e(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e[0],a=Fre(this,n),s=Rre(this,a);return Mre(this,s),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,n,a){Ere(e,r,n,a,this)},t.API.autoTableSetDefaults=function(e){return ov.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){ov.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var a=new ov(this),s=kre(a,e,window,r,!1),o=s.head,l=s.body,c=((n=o[0])===null||n===void 0?void 0:n.map(function(u){return u.content}))||[];return{columns:c,rows:l,data:l}}}var d5;function PC(t,e){var r=Fre(t,e),n=Rre(t,r);Mre(t,n)}try{if(typeof window<"u"&&window){var QV=window,VV=QV.jsPDF||((d5=QV.jspdf)===null||d5===void 0?void 0:d5.jsPDF);VV&&o4e(VV)}}catch(t){console.error("Could not apply autoTable plugin",t)}const Xr=t=>`C$${Number(t??0).toFixed(2)}`,l4e=()=>Nr(new Date,"yyyy-MM-dd"),wa=t=>Number(t||0).toFixed(3);function c4e(){const[t,e]=x.useState(()=>{const te=new Date,ie=new Date(te.getFullYear(),te.getMonth(),1);return Nr(ie,"yyyy-MM-dd")}),[r,n]=x.useState(l4e()),[a,s]=x.useState(!0),[o,l]=x.useState([]),[c,u]=x.useState([]),[d,f]=x.useState([]),[A,h]=x.useState(!1),[m,p]=x.useState(null),[g,v]=x.useState(0),[y,b]=x.useState(0),[w,j]=x.useState({}),[I,_]=x.useState({}),{refreshKey:S,refresh:E}=gc(),[F,k]=x.useState({}),[P,D]=x.useState({}),[X,pe]=x.useState(!1),ge=()=>pe(te=>!te),[fe,xe]=x.useState(!1),ae=()=>xe(te=>!te),[Se,Te]=x.useState(!1),[O,G]=x.useState(!1),[z,L]=x.useState(!1),Z=()=>Te(te=>!te),ee=()=>G(te=>!te),R=()=>L(te=>!te),[H,ne]=x.useState("");x.useEffect(()=>{(async()=>{s(!0);const ie=er(_t(Fe,"salesV2"),cr("date",">=",t),cr("date","<=",r)),$e=await Qt(ie),de=[];$e.forEach(ht=>{const xt=ht.data(),Xe=xt.date??"";if(Array.isArray(xt.items)&&xt.items.length>0){xt.items.forEach((be,st)=>{const K=String(be.productName??"(sin nombre)"),Ie=Number(be.qty??0),Ze=Number(be.lineFinal??0)||Math.max(0,Number(be.unitPrice||0)*Ie-Number(be.discount||0));de.push({id:`${ht.id}#${st}`,date:Xe,productName:K,quantity:Ie,amount:Ze,allocations:Array.isArray(be.allocations)?be.allocations:xt.allocations,avgUnitCost:Number(be.avgUnitCost??xt.avgUnitCost??0),measurement:be.measurement??xt.measurement??"",type:xt.type??"CONTADO"})});return}de.push({id:ht.id,date:Xe,productName:xt.productName??"(sin nombre)",quantity:Number(xt.quantity??0),amount:Number(xt.amount??xt.amountCharged??0),allocations:Array.isArray(xt.allocations)?xt.allocations:[],avgUnitCost:Number(xt.avgUnitCost??0),measurement:xt.measurement??"",type:xt.type??"CONTADO"})}),l(de);const Ce=er(_t(Fe,"expenses"),cr("date",">=",t),cr("date","<=",r)),nt=await Qt(Ce),vt=[];nt.forEach(ht=>{const xt=ht.data();vt.push({id:ht.id,date:xt.date??"",category:xt.category??"(sin categora)",description:xt.description??"",amount:Number(xt.amount??0),status:xt.status??"PAGADO",createdAt:xt.createdAt})}),u(vt),s(!1)})()},[t,r,S]),x.useMemo(()=>{const te=o.reduce((nt,vt)=>nt+(vt.amount||0),0);let ie=0;o.forEach(nt=>{var vt;(vt=nt.allocations)!=null&&vt.length?ie+=nt.allocations.reduce((ht,xt)=>ht+Number(xt.lineCost||0),0):nt.avgUnitCost&&nt.quantity&&(ie+=Number(nt.avgUnitCost)*Number(nt.quantity))});const $e=te-ie,de=c.reduce((nt,vt)=>nt+(vt.amount||0),0),Ce=$e-de;return{revenue:te,cogsReal:ie,grossProfit:$e,expensesSum:de,netProfit:Ce}},[o,c]);const ve=x.useMemo(()=>H?o.filter(te=>(te.productName||"")===H):o,[o,H]),U=x.useMemo(()=>{const te=ve.reduce((nt,vt)=>nt+(vt.amount||0),0);let ie=0;ve.forEach(nt=>{var vt;(vt=nt.allocations)!=null&&vt.length?ie+=nt.allocations.reduce((ht,xt)=>ht+Number(xt.lineCost||0),0):nt.avgUnitCost&&nt.quantity&&(ie+=Number(nt.avgUnitCost)*Number(nt.quantity))});const $e=te-ie,de=c.reduce((nt,vt)=>nt+(vt.amount||0),0),Ce=$e-de;return{revenue:te,cogsReal:ie,grossProfit:$e,expensesSum:de,netProfit:Ce}},[ve,c]),He=x.useMemo(()=>{const te=ve.filter(vt=>vt.type==="CONTADO"),ie=te.reduce((vt,ht)=>vt+(ht.amount||0),0);let $e=0;te.forEach(vt=>{var ht;(ht=vt.allocations)!=null&&ht.length?$e+=vt.allocations.reduce((xt,Xe)=>xt+Number(Xe.lineCost||0),0):vt.avgUnitCost&&vt.quantity&&($e+=Number(vt.avgUnitCost)*Number(vt.quantity))});const de=ie-$e,Ce=c.reduce((vt,ht)=>vt+(ht.amount||0),0),nt=de-Ce;return{revenue:ie,cogsReal:$e,grossProfit:de,expensesSum:Ce,netProfit:nt}},[ve,c]),se=x.useMemo(()=>{const te=ve.filter(Ce=>Ce.type==="CREDITO"),ie=te.reduce((Ce,nt)=>Ce+(nt.amount||0),0);let $e=0;te.forEach(Ce=>{var nt;(nt=Ce.allocations)!=null&&nt.length?$e+=Ce.allocations.reduce((vt,ht)=>vt+Number(ht.lineCost||0),0):Ce.avgUnitCost&&Ce.quantity&&($e+=Number(Ce.avgUnitCost)*Number(Ce.quantity))});const de=ie-$e;return{revenue:ie,cogsReal:$e,grossProfit:de}},[ve]),re=te=>String(te??"").toLowerCase().trim(),Pe=te=>Number(te.qty??te.quantity??0),ue=te=>["lb","lbs","libra","libras"].includes(re(te)),we=te=>["unidad","unidades","ud","uds","pieza","piezas"].includes(re(te)),Me=te=>te?typeof te=="string"?te:te!=null&&te.toDate?Nr(te.toDate(),"yyyy-MM-dd"):"":"";x.useEffect(()=>{(async()=>{h(!0);try{const ie=await Qt(_t(Fe,"customers_pollo")),$e={};ie.forEach(Y=>{const oe=Y.data();$e[Y.id]=String(oe.name??"(sin nombre)")});const de=await Qt(_t(Fe,"ar_movements_pollo")),Ce={},nt={},vt={},ht={},xt=new Set,Xe={},be={};let st=0;de.forEach(Y=>{var et,mt,Tt;const oe=Y.data(),De=String(oe.customerId??"").trim();if(!De)return;const We=Number(oe.amount??0);Ce[De]=(Ce[De]||0)+We;const dt=String(oe.type??"").toUpperCase(),Oe=oe.createdAt??null;if(dt==="ABONO"){st+=Math.abs(We);const Pt=(et=oe==null?void 0:oe.ref)!=null&&et.saleId?String(oe.ref.saleId):"";Pt?(Xe[Pt]=(Xe[Pt]||0)+Math.abs(We),xt.add(Pt)):be[De]=(be[De]||0)+Math.abs(We);const Ft=vt[De],Xt=!(Ft!=null&&Ft.ts)||(Oe!=null&&Oe.toDate&&((mt=Ft.ts)!=null&&mt.toDate)?Oe.toDate()>Ft.ts.toDate():!1);(!Ft||Xt)&&(vt[De]={amount:Math.abs(We),date:oe.date??"",ts:Oe})}if(dt==="CARGO"){nt[De]=(nt[De]||0)+Math.abs(We);const Pt=(Tt=oe==null?void 0:oe.ref)!=null&&Tt.saleId?String(oe.ref.saleId):"";Pt&&(ht[De]||(ht[De]=new Set),ht[De].add(Pt),xt.add(Pt))}});const K=new Map;await Promise.all(Array.from(xt).map(async Y=>{const oe=await Bs(Yt(Fe,"salesV2",Y));oe.exists()&&K.set(Y,oe.data())}));let Ie=0;const Ze=Y=>{const oe=Number(Y.qty??Y.quantity??0);return Number(Y.lineFinal??0)||Math.max(0,Number(Y.unitPrice||0)*oe-Number(Y.discount||0))},at=Y=>{if(Array.isArray(Y.items)&&Y.items.length>0){let dt=0,Oe=0;return Y.items.forEach(et=>{const mt=Number(et.qty??et.quantity??0);if(dt+=Ze(et),Array.isArray(et.allocations)&&et.allocations.length>0)Oe+=et.allocations.reduce((Tt,Pt)=>Tt+Number(Pt.lineCost||0),0);else{const Tt=Number(et.avgUnitCost??Y.avgUnitCost??0);Oe+=Tt*mt}}),{total:dt,cogs:Oe}}const oe=Number(Y.quantity??0),De=Number(Y.amount??Y.amountCharged??0)||0;let We=0;return Array.isArray(Y.allocations)&&Y.allocations.length>0?We=Y.allocations.reduce((dt,Oe)=>dt+Number(Oe.lineCost||0),0):Y.avgUnitCost&&(We=Number(Y.avgUnitCost)*oe),{total:De,cogs:We}},it=new Map;K.forEach((Y,oe)=>{const{total:De,cogs:We}=at(Y);it.set(oe,{total:De,cogs:We,grossProfit:De-We})});const T={},M={};Object.keys(Xe).forEach(Y=>{const oe=it.get(Y);if(!(oe!=null&&oe.total))return;const De=Number(Xe[Y]||0);M[Y]=De;const We=Math.min(1,De/oe.total),dt=oe.grossProfit*We;T[Y]=dt,Ie+=dt}),Object.keys(be).forEach(Y=>{const oe=ht[Y];if(!oe||oe.size===0)return;let De=0,We=0,dt=0,Oe=0;oe.forEach(Ft=>{const Xt=it.get(Ft);Xt&&(De+=Xt.total,We+=Xt.grossProfit,M[Ft]&&(dt+=Math.min(Xt.total,M[Ft])),Oe+=T[Ft]||0)});const et=Math.max(0,De-dt),mt=Math.max(0,We-Oe);if(!et||!mt)return;const Tt=Number(be[Y]||0),Pt=Math.min(1,Tt/et);Ie+=mt*Pt});const V=[];Object.keys(Ce).forEach(Y=>{const oe=Number(Ce[Y]||0);if(oe<=0)return;const De=new Map;let We=0,dt=0,Oe="";(ht[Y]||new Set).forEach(Tt=>{const Pt=K.get(Tt);if(!Pt)return;const Ft=String(Pt.date??"");Ft&&(!Oe||Ft>Oe)&&(Oe=Ft),(Array.isArray(Pt.items)&&Pt.items.length>0?Pt.items:[{productName:Pt.productName,qty:Pt.quantity,unitPrice:Pt.unitPrice,discount:Pt.discount,lineFinal:Pt.amount??Pt.amountCharged,measurement:Pt.measurement}]).forEach(mr=>{const Yr=String(mr.productName??"(sin nombre)"),Br=Number(mr.qty??mr.quantity??0),Fr=String(mr.measurement??""),vn=Number(mr.lineFinal??0)||Math.max(0,Number(mr.unitPrice||0)*Br-Number(mr.discount||0));ue(Fr)?We+=Br:dt+=Br;const Ln=`${Yr}||${Fr}`,yn=De.get(Ln)||{productName:Yr,qty:0,amount:0,measurement:Fr};yn.qty+=Br,yn.amount+=vn,De.set(Ln,yn)})});const mt=vt[Y];V.push({customerId:Y,name:$e[Y]||"(sin nombre)",balance:oe,globalBalance:Number(nt[Y]||0),lbs:We,units:dt,lastPaymentAmount:Number((mt==null?void 0:mt.amount)||0),lastSaleDate:Oe||"",lastPaymentDate:Me((mt==null?void 0:mt.ts)||(mt==null?void 0:mt.date)),products:Array.from(De.values()).sort((Tt,Pt)=>Tt.productName.localeCompare(Pt.productName))})});const q=V.filter(Y=>Y.products.length);q.sort((Y,oe)=>oe.balance-Y.balance),f(q),v(st),b(Ie)}catch(ie){console.error("Error cargando saldos pendientes:",ie),f([]),v(0)}finally{h(!1)}})()},[S]),x.useEffect(()=>{(async()=>{try{const ie=await Qt(er(_t(Fe,"inventory_batches"))),$e=cS(t,"yyyy-MM-dd",new Date),de=cS(r,"yyyy-MM-dd",new Date),Ce=Nr(yd($e),"yyyy-MM-dd"),nt=Nr(vd(de),"yyyy-MM-dd"),vt={};ie.forEach(ht=>{var Ze;const xt=ht.data(),Xe=String(xt.productName??"(sin nombre)"),be=Number(xt.quantity??0),st=Number(xt.remaining??0),K=(Ze=xt==null?void 0:xt.date)!=null&&Ze.toDate?Nr(xt.date.toDate(),"yyyy-MM-dd"):String((xt==null?void 0:xt.date)??(xt==null?void 0:xt.createdAt)??""),Ie=K&&K>=Ce&&K<=nt;vt[Xe]||(vt[Xe]={incomingQty:0,remainingQty:0}),Ie&&(vt[Xe].incomingQty+=be),vt[Xe].remainingQty+=st}),j(vt)}catch(ie){console.error("Error cargando inventario:",ie),j({})}})()},[S,t,r]),x.useMemo(()=>o.reduce((te,ie)=>ue(ie.measurement)?te+Pe(ie):te,0),[o]),x.useMemo(()=>ve.reduce((te,ie)=>ue(ie.measurement)?te+Pe(ie):te,0),[ve]);const ze=x.useMemo(()=>ve.filter(te=>te.type==="CONTADO"),[ve]),yt=x.useMemo(()=>ve.filter(te=>te.type==="CREDITO"),[ve]),It=x.useMemo(()=>ze.reduce((te,ie)=>te+(ie.amount||0),0),[ze]),Ke=x.useMemo(()=>yt.reduce((te,ie)=>te+(ie.amount||0),0),[yt]),wt=x.useMemo(()=>d.reduce((te,ie)=>te+Number(ie.balance||0),0),[d]),At=x.useMemo(()=>He.revenue+g,[He.revenue,g]),bt=x.useMemo(()=>It+g,[It,g]),ke=x.useMemo(()=>He.grossProfit+y,[He.grossProfit,y]),Ne=x.useMemo(()=>He.netProfit+y,[He.netProfit,y]),Ve=x.useMemo(()=>ze.reduce((te,ie)=>ue(ie.measurement)?te+Pe(ie):te,0),[ze]),he=x.useMemo(()=>yt.reduce((te,ie)=>ue(ie.measurement)?te+Pe(ie):te,0),[yt]);x.useMemo(()=>o.reduce((te,ie)=>we(ie.measurement)?te+Pe(ie):te,0),[o]),x.useMemo(()=>ve.reduce((te,ie)=>we(ie.measurement)?te+Pe(ie):te,0),[ve]);const le=x.useMemo(()=>ze.reduce((te,ie)=>we(ie.measurement)?te+Pe(ie):te,0),[ze]),Be=x.useMemo(()=>yt.reduce((te,ie)=>we(ie.measurement)?te+Pe(ie):te,0),[yt]),je=x.useMemo(()=>Array.from(new Set(o.map(te=>te.productName||"(sin nombre)"))).sort(),[o]),Ae=x.useMemo(()=>{var ie;const te=new Map;for(const $e of ve){const de=$e.productName||"(sin nombre)";te.has(de)||te.set(de,{productName:de,units:0,revenue:0,cogs:0,profit:0,firstDate:$e.date||"",lastDate:$e.date||""});const Ce=te.get(de);Ce.units+=Number($e.quantity||0),Ce.revenue+=Number($e.amount||0),(!Ce.firstDate||$e.date<(Ce.firstDate||$e.date))&&(Ce.firstDate=$e.date),(!Ce.lastDate||$e.date>(Ce.lastDate||$e.date))&&(Ce.lastDate=$e.date);let nt=0;(ie=$e.allocations)!=null&&ie.length?nt=$e.allocations.reduce((vt,ht)=>vt+Number(ht.lineCost||0),0):$e.avgUnitCost&&(nt=Number($e.avgUnitCost)*Number($e.quantity||0)),Ce.cogs+=nt,Ce.profit=Ce.revenue-Ce.cogs}return Array.from(te.values()).sort(($e,de)=>$e.productName.localeCompare(de.productName))},[ve]),Qe=x.useMemo(()=>[...Ae].sort((te,ie)=>ie.units-te.units).slice(0,3).map((te,ie)=>({idx:ie+1,name:te.productName,units:te.units})),[Ae]),Ct=te=>k(ie=>({...ie,[te]:!ie[te]})),pt=te=>D(ie=>({...ie,[te]:!ie[te]})),me=()=>{var nt,vt,ht;const te=new Rr({unit:"pt",format:"a4"}),ie="Dashboard Financiero",$e=`Rango: ${t} a ${r}`,de=H?`Producto: ${H}`:"Producto: Todos";te.setFontSize(16),te.text(ie,40,40),te.setFontSize(10),te.text($e,40,58),te.text(de,40,72);let Ce=90;PC(te,{startY:Ce,head:[["KPI","Valor"]],body:[["Ventas (rango)",Xr(U.revenue)],["Costo",Xr(U.cogsReal)],["Utilidad Bruta",Xr(U.grossProfit)],["Gastos",Xr(U.expensesSum)],["Utilidad Neta",Xr(U.netProfit)],["CxC",Xr(wt)],["Recaudacin (Abonos)",Xr(g)],["Utilidad Neta Crdito (Caja)",Xr(y)],["Utilidad Bruta Cash + Crdito",Xr(ke)],["Utilidad Neta Cash + Crdito",Xr(Ne)]],styles:{fontSize:9},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),Ce=(nt=te.lastAutoTable)!=null&&nt.finalY?te.lastAutoTable.finalY+18:110,PC(te,{startY:Ce,head:[["Cliente","Libras","Unidades","Saldo Global","Saldo pendiente","ltimo abono","Fecha ult. abono"]],body:d.map(xt=>[xt.name,wa(xt.lbs),wa(xt.units),Xr(xt.globalBalance),Xr(xt.balance),Xr(xt.lastPaymentAmount),xt.lastPaymentDate||""]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]},didDrawPage:xt=>{xt.pageNumber>1&&(te.setFontSize(10),te.text(ie,40,30))}}),Ce=(vt=te.lastAutoTable)!=null&&vt.finalY?te.lastAutoTable.finalY+18:110,PC(te,{startY:Ce,head:[["Producto","Ingresado","Disponibilidad","Fechas","Cantidad","Venta","Costo","Utilidad"]],body:Ae.map(xt=>{var Xe,be;return[xt.productName,wa(((Xe=w[xt.productName])==null?void 0:Xe.incomingQty)||0),wa(((be=w[xt.productName])==null?void 0:be.remainingQty)||0),xt.firstDate&&xt.lastDate?xt.firstDate===xt.lastDate?xt.firstDate:`${xt.firstDate}  ${xt.lastDate}`:"",wa(xt.units),Xr(xt.revenue),Xr(xt.cogs),Xr(xt.profit)]}),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),Ce=(ht=te.lastAutoTable)!=null&&ht.finalY?te.lastAutoTable.finalY+18:110,PC(te,{startY:Ce,head:[["Fecha","Categora","Descripcin","Monto","Estado"]],body:c.map(xt=>[xt.date,xt.category,xt.description||"",Xr(xt.amount),xt.status||""]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),te.save(`dashboard_${t}_a_${r}.pdf`)};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-4 sm:p-6 rounded-2xl shadow-2xl",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[i.jsx("h2",{className:"text-xl sm:text-2xl font-bold",children:"Dashboard Financiero"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",onClick:me,className:"px-3 py-2 rounded-lg text-sm bg-gray-900 text-white hover:bg-black",children:"Exportar PDF"}),i.jsx(pc,{onClick:E,loading:a})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-3 py-2 w-full",value:t,onChange:te=>e(te.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-3 py-2 w-full",value:r,onChange:te=>n(te.target.value)})]})]}),a?i.jsx("p",{children:"Cargando"}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{type:"button",onClick:Z,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Kpi Financiero"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Ventas: ",i.jsx("b",{children:Xr(U.revenue)}),"  Utilidad Neta:"," ",i.jsx("b",{children:Xr(U.netProfit)})]})]}),i.jsx("div",{className:"text-gray-500",children:Se?"Cerrar":"Ver"})]}),Se&&i.jsxs("div",{className:"mt-3",children:[i.jsx("div",{className:"flex gap-2 mb-2 items-center",children:i.jsxs("select",{className:"w-full border rounded px-2 py-2 text-sm",value:H,onChange:te=>ne(te.target.value),children:[i.jsx("option",{value:"",children:"Todos los productos"}),je.map(te=>i.jsx("option",{value:te,children:te},te))]})}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(bs,{title:"Ventas",subtitle:"Ventas cash",value:Xr(At),valueClass:"text-[#1E4D2B]"}),i.jsx(bs,{title:"Costo",value:Xr(He.cogsReal)}),i.jsx(bs,{title:"Utilidad Bruta Cash",value:Xr(He.grossProfit),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(bs,{title:"Ventas Crdito",value:Xr(se.revenue)}),i.jsx(bs,{title:"Costo",value:Xr(se.cogsReal),negative:!0}),i.jsx(bs,{title:"Utilidad Bruta Crdito",value:Xr(se.grossProfit),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(bs,{title:"CxC",value:Xr(wt)}),i.jsx(bs,{title:"Recaudacin (Abonos)",value:Xr(g)})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(bs,{title:"Utilidad Neta Crdito (Caja)",value:Xr(y),valueClass:"text-[#BF5700]"}),i.jsx(bs,{title:"Utilidad Bruta Cash + Crdito",value:Xr(ke),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(bs,{title:"Gastos",value:Xr(He.expensesSum),negative:!0}),i.jsx(bs,{title:"Utilidad Neta Cash + Crdito",value:Xr(Ne),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(Cl,{title:"Ventas Cash",value:Xr(bt)}),i.jsx(Cl,{title:"Ventas Crdito",value:Xr(Ke)}),i.jsx(Cl,{title:"Libras Cash",value:wa(Ve)}),i.jsx(Cl,{title:"Libras Crdito",value:wa(he)}),i.jsx(Cl,{title:"Unidades Cash",value:wa(le)}),i.jsx(Cl,{title:"Unidades Crdito",value:wa(Be)})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 rounded-lg shadow-2xl p-3 sm:p-4 bg-gray-50",children:[i.jsx(Cl,{title:"Libras Cash + Credito",value:wa(Ve+he)}),i.jsx(Cl,{title:"Unidades Cash + Credito",value:wa(le+Be)}),i.jsx(HV,{title:"Productos ms vendidos",items:Qe.map(te=>({key:`${te.idx}`,label:`${te.idx}. ${te.name}`,value:`(${wa(te.units)})`}))})]})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(bs,{title:"Ventas Cash",value:Xr(At),positive:!0}),i.jsx(bs,{title:"Costo",value:Xr(He.cogsReal),negative:!0}),i.jsx(bs,{title:"Utilidad Bruta Cash",value:Xr(He.grossProfit),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(bs,{title:"Ventas Crdito",value:Xr(se.revenue),positive:!0}),i.jsx(bs,{title:"Costo",value:Xr(se.cogsReal),negative:!0}),i.jsx(bs,{title:"Utilidad Bruta Crdito",value:Xr(se.grossProfit),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(bs,{title:"CxC",value:Xr(wt),negative:!0}),i.jsx(bs,{title:"Recaudacin (Abonos)",value:Xr(g),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-4 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(bs,{title:"Utilidad Neta Crdito (Caja)",value:Xr(y),valueClass:"text-[#BF5700]"}),i.jsx(bs,{title:"Utilidad Bruta Cash + Crdito",value:Xr(ke),positive:!0}),i.jsx(bs,{title:"Gastos",value:Xr(He.expensesSum),negative:!0}),i.jsx(bs,{title:"Utilidad Neta Cash + Crdito",value:Xr(Ne),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(Cl,{title:"Ventas Cash",value:Xr(bt)}),i.jsx(Cl,{title:"Ventas Crdito",value:Xr(Ke)}),i.jsx(Cl,{title:"Libras Cash",value:wa(Ve)}),i.jsx(Cl,{title:"Libras Crdito",value:wa(he)}),i.jsx(Cl,{title:"Unidades Cash",value:wa(le)}),i.jsx(Cl,{title:"Unidades Crdito",value:wa(Be)})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-3 gap-3 mb-6 rounded-lg shadow-2xl p-3 sm:p-4 bg-gray-50",children:[i.jsx(Cl,{title:"Libras Cash + Credito",value:wa(Ve+he)}),i.jsx(Cl,{title:"Unidades Cash + Credito",value:wa(le+Be)}),i.jsx(HV,{title:"Productos ms vendidos",items:Qe.map(te=>({key:`${te.idx}`,label:`${te.idx}. ${te.name}`,value:`(${wa(te.units)})`}))})]})]})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{type:"button",onClick:ee,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsx("div",{className:"font-semibold",children:"Saldos pendientes"}),i.jsx("div",{className:"text-gray-500",children:O?"Cerrar":"Ver"})]}),O&&i.jsx("div",{className:"border rounded-2xl p-3 sm:p-4 bg-gray-50 mt-3",children:A?i.jsx("div",{className:"text-sm text-gray-600",children:"Cargando saldos"}):d.length===0?i.jsx("div",{className:"text-sm text-gray-600",children:"Sin saldos pendientes."}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-white",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Libras"}),i.jsx("th",{className:"border p-2",children:"Unidades"}),i.jsx("th",{className:"border p-2",children:"Saldo Global"}),i.jsx("th",{className:"border p-2",children:"Saldo pendiente"}),i.jsx("th",{className:"border p-2",children:"ltimo abono"}),i.jsx("th",{className:"border p-2",children:"Fecha ult. abono"}),i.jsx("th",{className:"border p-2",children:"Ver"})]})}),i.jsx("tbody",{children:d.map(te=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1 text-left",children:te.name}),i.jsx("td",{className:"border p-1",children:wa(te.lbs)}),i.jsx("td",{className:"border p-1",children:wa(te.units)}),i.jsx("td",{className:"border p-1",children:Xr(te.globalBalance)}),i.jsx("td",{className:"border p-1",children:Xr(te.balance)}),i.jsx("td",{className:"border p-1",children:Xr(te.lastPaymentAmount)}),i.jsx("td",{className:"border p-1",children:te.lastPaymentDate||""}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",onClick:()=>p(te),className:"px-3 py-1 rounded bg-indigo-600 text-white text-xs hover:bg-indigo-700",children:"Ver"})})]},te.customerId))})]})})})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{type:"button",onClick:R,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsx("div",{className:"font-semibold",children:"Ventas y Gastos"}),i.jsx("div",{className:"text-gray-500",children:z?"Cerrar":"Ver"})]}),z&&i.jsxs("div",{className:"mt-3",children:[i.jsx("h3",{className:"font-semibold mb-2",children:"Ventas"}),i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-6",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Ingresado Lb/Un"}),i.jsx("th",{className:"border p-2",children:"Disponibilidad"}),i.jsx("th",{className:"border p-2",children:"Fecha Venta"}),i.jsx("th",{className:"border p-2",children:"Cantidad Lb/Un"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Costo"}),i.jsx("th",{className:"border p-2",children:"Utilidad"})]})}),i.jsxs("tbody",{children:[Ae.map(te=>{var ie,$e;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:te.productName}),i.jsx("td",{className:"border p-1",children:wa(((ie=w[te.productName])==null?void 0:ie.incomingQty)||0)}),i.jsx("td",{className:"border p-1",children:wa((($e=w[te.productName])==null?void 0:$e.remainingQty)||0)}),i.jsx("td",{className:"border p-1",children:te.firstDate&&te.lastDate?te.firstDate===te.lastDate?te.firstDate:`${te.firstDate}  ${te.lastDate}`:""}),i.jsx("td",{className:"border p-1",children:wa(te.units)}),i.jsx("td",{className:"border p-1",children:Xr(te.revenue)}),i.jsx("td",{className:"border p-1",children:Xr(te.cogs)}),i.jsx("td",{className:`border p-1 ${te.profit>=0?"text-green-700":"text-red-700"}`,children:Xr(te.profit)})]},te.productName)}),Ae.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-3 text-center text-gray-500",children:"Sin datos en el rango seleccionado."})})]})]})}),i.jsxs("div",{className:"md:hidden mb-6",children:[i.jsxs("button",{type:"button",onClick:ge,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Ventas por producto"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[Ae.length," productos"]})]}),i.jsx("div",{className:"text-gray-500",children:X?"Cerrar":"Ver"})]}),X&&i.jsx("div",{className:"space-y-2 mt-3",children:Ae.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-sm text-gray-500 bg-gray-50",children:"Sin datos en el rango seleccionado."}):Ae.map(te=>{var de,Ce,nt,vt;const ie=!!F[te.productName],$e=te.firstDate&&te.lastDate?te.firstDate===te.lastDate?te.firstDate:`${te.firstDate}  ${te.lastDate}`:"";return i.jsxs("div",{className:"border rounded-2xl bg-white shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",onClick:()=>Ct(te.productName),className:"w-full text-left px-3 py-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:te.productName}),i.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Libras/Unidades"}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Vendidas: ",i.jsx("b",{children:wa(te.units)}),"  Disponible:"," ",i.jsx("b",{className:((de=w[te.productName])==null?void 0:de.remainingQty)>0?"text-green-700":"text-red-700",children:wa(((Ce=w[te.productName])==null?void 0:Ce.remainingQty)||0)})]})]}),i.jsx("div",{className:"text-gray-500 text-xs pt-0.10",children:ie?"Cerrar":"Ver"})]}),ie&&i.jsx("div",{className:"px-3 pb-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx(Ru,{label:"Lb/Un Ingresadas",value:wa(((nt=w[te.productName])==null?void 0:nt.incomingQty)||0)}),i.jsx(Ru,{label:"Lb/Un Disponibles",value:wa(((vt=w[te.productName])==null?void 0:vt.remainingQty)||0)}),i.jsx(Ru,{label:"Fechas Venta",value:$e}),i.jsx(Ru,{label:"Lb/Un Vendidas",value:wa(te.units)}),i.jsx(Ru,{label:"Facturado al costo",value:Xr(te.cogs)}),i.jsx(Ru,{label:"Monto Venta",value:Xr(te.revenue)}),i.jsx(Ru,{label:"Utilidad bruta",value:Xr(te.profit),valueClass:te.profit>=0?"text-green-700 font-semibold":"text-red-700 font-semibold"})]})})]},te.productName)})})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Categora"}),i.jsx("th",{className:"border p-2",children:"Descripcin"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Estado"})]})}),i.jsxs("tbody",{children:[c.map(te=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:te.date}),i.jsx("td",{className:"border p-1",children:te.category}),i.jsx("td",{className:"border p-1",children:te.description}),i.jsx("td",{className:"border p-1",children:Xr(te.amount)}),i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${te.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:te.status})})]},te.id)),c.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-3 text-center text-gray-500",children:"Sin gastos en el rango seleccionado."})})]})]})}),i.jsxs("div",{className:"md:hidden mb-6",children:[i.jsxs("button",{type:"button",onClick:ae,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Gastos del periodo"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[c.length," registros"]})]}),i.jsx("div",{className:"text-gray-500",children:fe?"Cerrar":"Abrir"})]}),fe&&i.jsx("div",{className:"space-y-2 mt-3",children:c.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-sm text-gray-500 bg-gray-50",children:"Sin gastos en el rango seleccionado."}):c.map(te=>{const ie=!!P[te.id],$e=te.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700";return i.jsxs("div",{className:"border rounded-2xl bg-white shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",onClick:()=>pt(te.id),className:"w-full text-left px-3 py-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:te.category}),i.jsx("span",{className:`px-2 py-0.5 rounded text-[11px] ${$e}`,children:te.status})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[te.date,"  ",i.jsx("b",{children:Xr(te.amount)})]})]}),i.jsx("div",{className:"text-gray-500 text-sm pt-0.5",children:ie?"Cerrar":"Ver"})]}),ie&&i.jsx("div",{className:"px-3 pb-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[i.jsx(Ru,{label:"Fecha",value:te.date}),i.jsx(Ru,{label:"Categora",value:te.category}),i.jsx(Ru,{label:"Descripcin",value:te.description||""}),i.jsx(Ru,{label:"Monto",value:Xr(te.amount)}),i.jsx(Ru,{label:"Estado",value:te.status||""})]})})]},te.id)})})]})]})]})]}),m&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:m.name}),i.jsx("button",{type:"button",onClick:()=>p(null),className:"text-sm text-gray-500 hover:text-gray-700",children:""})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Libras/Unidades"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Fecha Venta"})]})}),i.jsx("tbody",{children:m.products.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"border p-2 text-center text-gray-500",children:"Sin productos asociados."})}):m.products.map(te=>i.jsxs("tr",{children:[i.jsx("td",{className:"border p-1",children:te.productName}),i.jsx("td",{className:"border p-1 text-center",children:wa(te.qty)}),i.jsx("td",{className:"border p-1 text-center",children:Xr(te.amount)}),i.jsx("td",{className:"border p-1 text-center",children:m.lastSaleDate||""})]},`${te.productName}-${te.measurement}`))})]})})]})})]})}function bs({title:t,value:e,positive:r,negative:n,valueClass:a,subtitle:s}){const o=a||(r?"text-[#568203]":n?"text-[#AB274F]":"");return i.jsxs("div",{className:"border rounded-2xl p-3 bg-white",children:[i.jsx("div",{className:"text-[13px] sm:text-[17px] text-gray-500",children:t}),s?i.jsx("div",{className:"text-[11px] sm:text-[12px] text-gray-400",children:s}):null,i.jsx("div",{className:`text-[26px] sm:text-[30px] font-bold ${o}`,children:e})]})}function Cl({title:t,value:e}){return i.jsxs("div",{className:"border rounded-lg p-3 bg-white",children:[i.jsx("div",{className:"text-[13px] sm:text-[17px] text-gray-500",children:t}),i.jsx("div",{className:"text-[18px] sm:text-[20px] font-semibold",children:e})]})}function HV({title:t,items:e}){return i.jsxs("div",{className:"border rounded-lg p-3 bg-white",children:[i.jsx("div",{className:"text-[11px] text-gray-500 mb-1",children:t}),i.jsx("ul",{className:"text-sm leading-snug list-none pl-0 m-0 space-y-0.5",children:e.length===0?i.jsx("li",{className:"text-gray-500",children:""}):e.map(r=>i.jsxs("li",{children:[r.label," ",r.value??""]},r.key))})]})}function Ru({label:t,value:e,valueClass:r}){return i.jsxs("div",{className:"border rounded-xl p-2 bg-gray-50",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:t}),i.jsx("div",{className:`text-sm mt-0.5 ${r||""}`,children:e})]})}const BC=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal","Varios"],sx=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function u4e(){const{refreshKey:t,refresh:e}=gc(),[r,n]=x.useState(Nr(yd(new Date),"yyyy-MM-dd")),[a,s]=x.useState(Nr(vd(new Date),"yyyy-MM-dd")),[o,l]=x.useState(Nr(new Date,"yyyy-MM-dd")),[c,u]=x.useState(""),[d,f]=x.useState(""),[A,h]=x.useState(0),[m,p]=x.useState("PENDIENTE"),[g,v]=x.useState(""),[y,b]=x.useState([]),[w,j]=x.useState(!0),[I,_]=x.useState(""),[S,E]=x.useState(null),[F,k]=x.useState(""),[P,D]=x.useState(""),[X,pe]=x.useState(""),[ge,fe]=x.useState(0),[xe,ae]=x.useState("PENDIENTE"),[Se,Te]=x.useState(""),[O,G]=x.useState(!1),z=()=>G(ue=>!ue),[L,Z]=x.useState(null),ee=ue=>Z(we=>we===ue?null:ue);x.useEffect(()=>{(async()=>{j(!0),_("");try{const ue=er(_t(Fe,"expenses"),dn("date","desc")),we=await Qt(ue),Me=[];we.forEach(ze=>{const yt=ze.data();Me.push({id:ze.id,date:yt.date||Nr(new Date,"yyyy-MM-dd"),category:yt.category||"",description:yt.description||"",amount:Number(yt.amount||0),status:yt.status||"PENDIENTE",notes:yt.notes||"",createdAt:yt.createdAt??dr.now()})}),b(Me)}catch(ue){console.error(ue),_(" Error al cargar gastos")}finally{j(!1)}})()},[t]);const R=x.useMemo(()=>y.filter(ue=>!(r&&ue.date<r||a&&ue.date>a)),[y,r,a]),H=x.useMemo(()=>{const ue=R.reduce((ze,yt)=>ze+(yt.amount||0),0),we=R.filter(ze=>ze.status==="PAGADO").reduce((ze,yt)=>ze+(yt.amount||0),0),Me=ue-we;return{total:ue,pagado:we,pendiente:Me}},[R]),ne=()=>{l(Nr(new Date,"yyyy-MM-dd")),u(""),f(""),h(0),p("PENDIENTE"),v("")},ve=async ue=>{if(ue.preventDefault(),_(""),!c)return _("Selecciona una categora.");if(!d.trim())return _("Ingresa una descripcin.");if(!A||A<=0)return _("Ingresa un monto vlido.");try{const we={date:o,category:c,description:d.trim(),amount:Number(Number(A||0).toFixed(2)),status:m,notes:g||"",createdAt:dr.now()},Me=await On(_t(Fe,"expenses"),we);b(ze=>[{id:Me.id,...we},...ze]),ne(),_(" Gasto registrado")}catch(we){console.error(we),_(" Error al guardar gasto")}},U=ue=>{_(""),E(ue.id),k(ue.date),D(ue.category||""),pe(ue.description||""),fe(Number(ue.amount||0)),ae(ue.status||"PENDIENTE"),Te(ue.notes||"")},He=()=>{E(null),k(""),D(""),pe(""),fe(0),ae("PENDIENTE"),Te("")},se=async()=>{if(S){if(!P)return _("Selecciona una categora.");if(!X.trim())return _("Ingresa una descripcin.");if(!ge||ge<=0)return _("Ingresa un monto vlido.");try{const ue={date:F,category:P,description:X.trim(),amount:Number(Number(ge||0).toFixed(2)),status:xe,notes:Se||""};await pn(Yt(Fe,"expenses",S),ue),b(we=>we.map(Me=>Me.id===S?{...Me,...ue}:Me)),He(),_(" Gasto actualizado")}catch(ue){console.error(ue),_(" Error al actualizar gasto")}}},re=async ue=>{if(confirm(`Eliminar el gasto "${ue.description}"?`))try{await Fn(Yt(Fe,"expenses",ue.id)),b(Me=>Me.filter(ze=>ze.id!==ue.id)),_(" Gasto borrado")}catch(Me){console.error(Me),_(" Error al borrar gasto")}},Pe=ue=>ue==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700";return i.jsxs("div",{className:"max-w-6xl mx-auto px-3 sm:px-0",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Gastos (Pollo)"}),i.jsx(pc,{onClick:e,loading:w})]}),i.jsxs("div",{className:"bg-white p-3 rounded-2xl shadow-2xl border mb-4 flex flex-col sm:flex-row sm:items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:ue=>n(ue.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:ue=>s(ue.target.value)})]})]}),i.jsxs("div",{className:"sm:ml-auto text-sm bg-gray-50 border rounded-xl p-3",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",sx(H.total)]}),i.jsxs("div",{children:["Pagado: ",sx(H.pagado)]}),i.jsxs("div",{children:["Pendiente: ",sx(H.pendiente)]})]})]}),i.jsxs("div",{className:"md:hidden mb-4",children:[i.jsxs("button",{type:"button",onClick:z,className:"w-full text-left px-3 py-3 flex items-center justify-between bg-white border rounded-2xl",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Crear gasto"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Fecha: ",o,"  Monto: ",A===0?"":sx(A)]})]}),i.jsx("div",{className:"text-gray-500",children:O?"":""})]}),O&&i.jsxs("form",{onSubmit:ve,className:"mt-3 bg-white p-4 rounded-2xl shadow-2xl border grid grid-cols-1 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:o,onChange:ue=>l(ue.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:c,onChange:ue=>u(ue.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),BC.map(ue=>i.jsx("option",{value:ue,children:ue},ue))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:d,onChange:ue=>f(ue.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:A===0?"":A,onChange:ue=>{const we=String(ue.target.value||"").replace(",","."),Me=parseFloat(we);h(Number.isFinite(Me)?Math.max(0,Me):0)},placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:ue=>p(ue.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:g,onChange:ue=>v(ue.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[g.length,"/500"]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"}),i.jsx("button",{type:"button",className:"bg-gray-200 px-4 py-2 rounded hover:bg-gray-300",onClick:ne,children:"Limpiar"})]})]})]}),i.jsx("div",{className:"hidden md:block",children:i.jsxs("form",{onSubmit:ve,className:"bg-white p-4 rounded-2xl shadow-2xl border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:o,onChange:ue=>l(ue.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:c,onChange:ue=>u(ue.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),BC.map(ue=>i.jsx("option",{value:ue,children:ue},ue))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:d,onChange:ue=>f(ue.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:A===0?"":A,onChange:ue=>{const we=String(ue.target.value||"").replace(",","."),Me=parseFloat(we);h(Number.isFinite(Me)?Math.max(0,Me):0)},placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:ue=>p(ue.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:g,onChange:ue=>v(ue.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[g.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex gap-2",children:[i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"}),i.jsx("button",{type:"button",className:"bg-gray-200 px-4 py-2 rounded hover:bg-gray-300",onClick:ne,children:"Limpiar"})]})]})}),i.jsx("div",{className:"block md:hidden space-y-3",children:w?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Cargando"}):R.length===0?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Sin gastos en el rango seleccionado."}):R.map(ue=>{const we=L===ue.id,Me=S===ue.id;return i.jsxs("div",{className:"bg-white border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full text-left px-3 py-3 flex items-start justify-between bg-white",onClick:()=>ee(ue.id),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:ue.description}),i.jsxs("div",{className:"text-xs text-gray-500",children:[ue.category||"","  ",ue.date]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"font-bold",children:sx(ue.amount)}),i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Pe(ue.status)}`,children:ue.status})]})]}),we&&i.jsxs("div",{className:"p-3",children:[i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:ue.notes?ue.notes:""}),Me?i.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2 text-sm",children:[i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:F,onChange:ze=>k(ze.target.value)}),i.jsxs("select",{className:"w-full border p-2 rounded",value:P,onChange:ze=>D(ze.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),BC.map(ze=>i.jsx("option",{value:ze,children:ze},ze))]}),i.jsx("input",{className:"w-full border p-2 rounded",value:X,onChange:ze=>pe(ze.target.value)}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:Number.isNaN(ge)?"":ge,onChange:ze=>{const yt=String(ze.target.value||"").replace(",","."),It=parseFloat(yt);fe(Number.isFinite(It)?Math.max(0,It):0)}}),i.jsxs("select",{className:"w-full border p-2 rounded",value:xe,onChange:ze=>ae(ze.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Se,onChange:ze=>Te(ze.target.value),maxLength:500}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:se,children:"Guardar"}),i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:He,children:"Cancelar"})]})]}):i.jsxs("div",{className:"mt-3 flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>U(ue),children:"Editar"}),i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>re(ue),children:"Borrar"})]})]})]},ue.id)})}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded-2xl shadow-2xl border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:w?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):R.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):R.map(ue=>{const we=S===ue.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:we?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:F,onChange:Me=>k(Me.target.value)}):ue.date}),i.jsx("td",{className:"p-2 border",children:we?i.jsxs("select",{className:"w-full border p-1 rounded",value:P,onChange:Me=>D(Me.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),BC.map(Me=>i.jsx("option",{value:Me,children:Me},Me))]}):ue.category||""}),i.jsx("td",{className:"p-2 border",children:we?i.jsx("input",{className:"w-full border p-1 rounded",value:X,onChange:Me=>pe(Me.target.value)}):i.jsx("span",{title:ue.description,children:ue.description.length>45?ue.description.slice(0,45)+"":ue.description})}),i.jsx("td",{className:"p-2 border",children:we?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(ge)?"":ge,onChange:Me=>{const ze=String(Me.target.value||"").replace(",","."),yt=parseFloat(ze);fe(Number.isFinite(yt)?Math.max(0,yt):0)}}):sx(ue.amount)}),i.jsx("td",{className:"p-2 border",children:we?i.jsxs("select",{className:"w-full border p-1 rounded",value:xe,onChange:Me=>ae(Me.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Pe(ue.status)}`,children:ue.status})}),i.jsx("td",{className:"p-2 border",children:we?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:Se,onChange:Me=>Te(Me.target.value),maxLength:500}):i.jsx("span",{title:ue.notes||"",children:(ue.notes||"").length>45?(ue.notes||"").slice(0,45)+"":ue.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:we?i.jsxs(i.Fragment,{children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:se,children:"Guardar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:He,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>U(ue),children:"Editar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>re(ue),children:"Borrar"})]})})})]},ue.id)})})]})}),I&&i.jsx("p",{className:"mt-2 text-sm",children:I})]})}function SS(t){return(t||"").trim().toLowerCase()}async function Qre(){const t=await Qt(_t(Fe,"products")),e=new Map;return t.forEach(r=>{const n=r.data(),a=SS(n.name??n.productName);a&&e.set(a,r.id)}),e}async function d4e(t=!1){const e=await Qre(),r=await Qt(_t(Fe,"inventory_batches")),n={checked:0,fixed:0,alreadyOk:0,missingName:0,withoutMatch:0,details:[]};for(const a of r.docs){n.checked++;const s=a.data(),o=SS(s.productName);if(!o){n.missingName++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,status:"missingName"});continue}const l=e.get(o);if(!l){n.withoutMatch++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,status:"withoutMatch"});continue}if(s.productId===l){n.alreadyOk++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,newProductId:l,status:"alreadyOk"});continue}t||await pn(Yt(Fe,"inventory_batches",a.id),{productId:l}),n.fixed++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,newProductId:l,status:"fixed"})}return console.group("[fixAllBatchProductIds] Resultado"),console.log("checked:",n.checked),console.log("fixed:",n.fixed),console.log("alreadyOk:",n.alreadyOk),console.log("missingName:",n.missingName),console.log("withoutMatch:",n.withoutMatch),console.groupEnd(),n}async function f4e(t,e=!1){const r=SS(t),a=(await Qre()).get(r);if(!a)throw new Error(`No existe un producto activo con nombre "${t}".`);const s=await Qt(_t(Fe,"inventory_batches"));let o=0;for(const l of s.docs){const c=l.data();SS(c.productName)===r&&c.productId!==a&&(e||await pn(Yt(Fe,"inventory_batches",l.id),{productId:a}),o++)}return console.log(`[fixBatchesByProductName] "${t}" fixed: ${o} lote(s)`),o}function h4e(){const[t,e]=x.useState(!1),[r,n]=x.useState(""),a=async()=>{try{e(!0),n("");const c=await d4e(!1);n(` Hecho. Revisados: ${c.checked}, Corregidos: ${c.fixed}, Ok: ${c.alreadyOk}, Sin nombre: ${c.missingName}, Sin match: ${c.withoutMatch}. (Mira consola para detalles)`)}catch(c){n(" Error: "+((c==null?void 0:c.message)||c))}finally{e(!1)}},[s,o]=x.useState(""),l=async()=>{if(!s.trim()){n(" Escribe el nombre del producto.");return}try{e(!0),n("");const c=await f4e(s.trim(),!1);n(` Hecho. Corregidos ${c} lote(s) para "${s}".`)}catch(c){n(" Error: "+((c==null?void 0:c.message)||c))}finally{e(!1)}};return i.jsxs("div",{className:"max-w-xl mx-auto bg-white p-6 rounded shadow border space-y-4",children:[i.jsx("h1",{className:"text-xl font-bold",children:"Herramienta de Migracin de Lotes"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Corrige los ",i.jsx("code",{children:"inventory_batches.productId"})," basndose en el nombre del producto. salo una sola vez para limpiar datos viejos. Revisa la consola para un log detallado."]}),i.jsx("div",{className:"space-y-2",children:i.jsx("button",{onClick:a,disabled:t,className:"bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-60",children:t?"Corriendo":"Corregir TODOS los lotes"})}),i.jsx("hr",{}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Corregir por nombre:"}),i.jsx("input",{className:"border p-2 rounded w-full",placeholder:'Ej: "Pierna Entera"',value:s,onChange:c=>o(c.target.value)}),i.jsx("button",{onClick:l,disabled:t,className:"bg-indigo-600 text-white px-4 py-2 rounded disabled:opacity-60",children:t?"Corriendo":"Corregir lotes de ese producto"})]}),r&&i.jsx("p",{className:"text-sm",children:r})]})}const eu=t=>`C$${Number(t||0).toFixed(2)}`,ix=t=>Number(t||0).toFixed(3),A4e=t=>(t||"").toLowerCase()==="lb"||/libra/.test((t||"").toLowerCase()),f5=()=>{const t=new Date;return Nr(new Date(t.getFullYear(),t.getMonth(),1),"yyyy-MM-dd")},TC=()=>Nr(new Date,"yyyy-MM-dd");function m4e({paidBatches:t=[],onClose:e,onCreated:r}){const n=Array.isArray(t)?t:[],[a,s]=x.useState(f5()),[o,l]=x.useState(TC()),[c,u]=x.useState(""),d=x.useMemo(()=>{const he=new Map;return n.forEach(le=>he.set(le.productId,{id:le.productId,name:le.productName})),Array.from(he.values()).sort((le,Be)=>le.name.localeCompare(Be.name))},[n]),f=x.useMemo(()=>n.filter(he=>!(a&&he.date<a||o&&he.date>o||c&&he.productId!==c)),[n,a,o,c]),[A,h]=x.useState(TC()),[m,p]=x.useState(()=>`FAC-${Date.now().toString().slice(-6)}`),[g,v]=x.useState(""),[y,b]=x.useState([]);x.useEffect(()=>{b(he=>{const le=he.filter(Be=>f.some(je=>je.id===Be));return le.length===0&&f.length>0?f.map(Be=>Be.id):le})},[f]);const[w,j]=x.useState([]),[I,_]=x.useState([]),[S,E]=x.useState(!1),[F,k]=x.useState(f5()),[P,D]=x.useState(TC());x.useEffect(()=>{(async()=>{try{E(!0);const he=er(_t(Fe,"expenses"),dn("date","desc")),le=await Qt(he),Be=[];le.forEach(je=>{const Ae=je.data();Be.push({id:je.id,date:Ae.date,description:Ae.description,amount:Number(Ae.amount||0)})}),j(Be)}catch(he){console.error(he)}finally{E(!1)}})()},[]);const X=x.useMemo(()=>w.filter(he=>!(!he.date||F&&he.date<F||P&&he.date>P)),[w,F,P]),[pe,ge]=x.useState([]),[fe,xe]=x.useState(!1),[ae,Se]=x.useState(""),[Te,O]=x.useState("DEBITO"),[G,z]=x.useState(""),L=()=>{const he=Number(G);!ae.trim()||!isFinite(he)||he<=0||(ge(le=>[...le,{id:`${Date.now()}_${le.length+1}`,description:ae.trim(),type:Te,amount:Number(he.toFixed(2))}]),Se(""),z(""))},[Z,ee]=x.useState(null),[R,H]=x.useState(""),[ne,ve]=x.useState("DEBITO"),[U,He]=x.useState(""),se=he=>{ee(he.id),H(he.description),ve(he.type),He(he.amount.toFixed(2))},re=()=>{ee(null),H(""),ve("DEBITO"),He("")},Pe=()=>{if(!Z)return;const he=Number(U);!isFinite(he)||he<=0||(ge(le=>le.map(Be=>Be.id===Z?{...Be,description:R.trim(),type:ne,amount:Number(he.toFixed(2))}:Be)),re())},ue=he=>{ge(le=>le.filter(Be=>Be.id!==he)),Z===he&&re()},we=(he,le)=>{b(Be=>le?[...new Set([...Be,he])]:Be.filter(je=>je!==he))},Me=he=>{b(he?f.map(le=>le.id):[])},ze=(he,le)=>{_(Be=>le?[...new Set([...Be,he])]:Be.filter(je=>je!==he))},yt=x.useMemo(()=>f.filter(he=>y.includes(he.id)),[f,y]),It=x.useMemo(()=>pe.filter(he=>he.type==="DEBITO").reduce((he,le)=>he+le.amount,0),[pe]),Ke=x.useMemo(()=>pe.filter(he=>he.type==="CREDITO").reduce((he,le)=>he+le.amount,0),[pe]),wt=x.useMemo(()=>{let he=0,le=0,Be=0,je=0;for(const Ct of yt){A4e(Ct.unit)?he+=Number(Ct.quantity||0):le+=Number(Ct.quantity||0);const pt=Ct.expectedTotal??Number((Number(Ct.quantity||0)*Number(Ct.salePrice||0)).toFixed(2)),me=Ct.invoiceTotal!==void 0&&Ct.invoiceTotal!==null?Number(Ct.invoiceTotal):Number((Number(Ct.quantity||0)*Number(Ct.purchasePrice||0)).toFixed(2));Be+=Number(pt||0),je+=Number(me||0)}const Ae=X.filter(Ct=>I.includes(Ct.id)).reduce((Ct,pt)=>Ct+Number(pt.amount||0),0),Qe=Be-Ae-It+Ke;return{totalLbs:he,totalUnits:le,totalExpected:Number(Be.toFixed(2)),totalInvoiced:Number(je.toFixed(2)),totalGastos:Number(Ae.toFixed(2)),debits:Number(It.toFixed(2)),credits:Number(Ke.toFixed(2)),finalAmount:Number(Qe.toFixed(2)),grossProfit:Number((Be-je).toFixed(2))}},[yt,X,I,It,Ke]),[At,bt]=x.useState(!1),[ke,Ne]=x.useState(""),Ve=async()=>{if(Ne(""),yt.length===0){Ne("Selecciona al menos 1 lote pagado.");return}try{bt(!0);const he={number:m.trim(),date:A,description:g.trim(),status:"PENDIENTE",createdAt:dr.now(),totalLbs:Number(ix(wt.totalLbs)),totalUnits:Number(ix(wt.totalUnits)),totalAmount:wt.totalExpected,invoiceTotal:wt.totalInvoiced,totalExpenses:wt.totalGastos,totalDebits:wt.debits,totalCredits:wt.credits,finalAmount:wt.finalAmount,batches:yt.map(le=>{var Be;return{id:le.id,productId:le.productId,productName:le.productName,unit:le.unit,quantity:Number(ix(le.quantity)),salePrice:Number(Number(le.salePrice||0).toFixed(2)),purchasePrice:Number(Number(le.purchasePrice||0).toFixed(2)),expectedTotal:Number((Number(le.quantity||0)*Number(le.salePrice||0)).toFixed(2)),invoiceTotal:le.invoiceTotal!==void 0&&le.invoiceTotal!==null?Number(le.invoiceTotal):Number((Number(le.quantity||0)*Number(le.purchasePrice||0)).toFixed(2)),batchDate:le.date,paidAt:(Be=le.paidAt)!=null&&Be.toDate?Nr(le.paidAt.toDate(),"yyyy-MM-dd"):null}}),expenses:X.filter(le=>I.includes(le.id)).map(le=>({id:le.id,date:le.date||null,description:le.description||"",amount:Number(Number(le.amount||0).toFixed(2))})),adjustments:pe.map(le=>({id:le.id,description:le.description,type:le.type,amount:Number(le.amount.toFixed(2))}))};await On(_t(Fe,"invoices"),he),Ne(" Factura creada."),r()}catch(he){console.error(he),Ne(` Error al crear factura: ${(he==null?void 0:he.message)||"desconocido"}`)}finally{bt(!1)}};return i.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:[i.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-xl shadow-xl p-4 md:p-6 max-h-[90vh] overflow-auto relative",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Crear factura"}),i.jsx("button",{type:"button",onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:A,onChange:he=>h(he.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Nmero"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:m,onChange:he=>p(he.target.value),placeholder:"FAC-001"})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Descripcin"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:g,onChange:he=>v(he.target.value),placeholder:"Comentarios de la factura"})]})]}),i.jsx("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:i.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Desde (lote)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:he=>s(he.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Hasta (lote)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:o,onChange:he=>l(he.target.value)})]}),i.jsxs("div",{className:"min-w-[220px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:c,onChange:he=>u(he.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),d.map(he=>i.jsx("option",{value:he.id,children:he.name},he.id))]})]}),i.jsx("button",{type:"button",className:"ml-auto px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{s(f5()),l(TC()),u("")},children:"Quitar filtro"})]})}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Lotes pagados"}),i.jsxs("label",{className:"text-sm flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:f.length>0&&y.length===f.length,onChange:he=>Me(he.target.checked)}),"Seleccionar todos (sobre el filtro)"]})]}),f.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay lotes pagados disponibles en el filtro actual."}):i.jsx("div",{className:"border rounded max-h-80 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha lote"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Cantidad"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Ganancia bruta"}),i.jsx("th",{className:"p-2 border",children:"Fecha pago"})]})}),i.jsx("tbody",{children:f.map(he=>{var Qe;const le=y.includes(he.id),Be=he.expectedTotal??Number((Number(he.quantity||0)*Number(he.salePrice||0)).toFixed(2)),je=he.invoiceTotal!==void 0&&he.invoiceTotal!==null?Number(he.invoiceTotal):Number((Number(he.quantity||0)*Number(he.purchasePrice||0)).toFixed(2)),Ae=Be-je;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:le,onChange:Ct=>we(he.id,Ct.target.checked)})}),i.jsx("td",{className:"p-2 border",children:he.date}),i.jsx("td",{className:"p-2 border",children:he.productName}),i.jsx("td",{className:"p-2 border",children:(he.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:ix(he.quantity)}),i.jsx("td",{className:"p-2 border",children:eu(he.salePrice)}),i.jsx("td",{className:"p-2 border",children:eu(je)}),i.jsx("td",{className:"p-2 border",children:eu(Be)}),i.jsx("td",{className:"p-2 border",children:eu(Ae)}),i.jsx("td",{className:"p-2 border",children:(Qe=he.paidAt)!=null&&Qe.toDate?Nr(he.paidAt.toDate(),"yyyy-MM-dd"):""})]},he.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Gastos a incluir (opcional)"}),S&&i.jsx("span",{className:"text-xs text-gray-500",children:"Cargando"}),i.jsxs("div",{className:"ml-auto flex items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:F,onChange:he=>k(he.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:P,onChange:he=>D(he.target.value)})]})]})]}),X.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay gastos en el rango seleccionado."}):i.jsx("div",{className:"border rounded max-h-48 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:X.map(he=>{const le=I.includes(he.id);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:le,onChange:Be=>ze(he.id,Be.target.checked)})}),i.jsx("td",{className:"p-2 border",children:he.date||""}),i.jsx("td",{className:"p-2 border",children:he.description||""}),i.jsx("td",{className:"p-2 border",children:eu(Number(he.amount||0))})]},he.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Notas Crdito/Dbito (Cargos extras)"}),i.jsx("button",{type:"button",className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>xe(!0),children:"Crear Cargo"})]}),pe.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cargos agregados."}):i.jsx("div",{className:"border rounded max-h-40 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:pe.map(he=>{const le=Z===he.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:le?i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[70px]",value:R,onChange:Be=>H(Be.target.value)}):i.jsx("span",{title:he.description,children:he.description.length>60?`${he.description.slice(0,60)}`:he.description})}),i.jsx("td",{className:"p-2 border",children:le?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:ne,onChange:Be=>ve(Be.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${he.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:he.type})}),i.jsx("td",{className:"p-2 border",children:le?i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1 text-right",value:U,onChange:Be=>He(Be.target.value)}):eu(he.amount)}),i.jsx("td",{className:"p-2 border",children:le?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:Pe,children:"Guardar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:re,children:"Cancelar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ue(he.id),children:"Eliminar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 text-xs",onClick:()=>se(he),children:"Editar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ue(he.id),children:"Eliminar"})]})})]},he.id)})})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-4 justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:["Total libras: ",i.jsx("strong",{children:ix(wt.totalLbs)})]}),i.jsxs("div",{children:["Total unidades: ",i.jsx("strong",{children:ix(wt.totalUnits)})]})]}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Total facturado (costo):"," ",i.jsx("strong",{children:eu(wt.totalInvoiced)})]}),i.jsxs("div",{children:["Total esperado (ventas):"," ",i.jsx("strong",{children:eu(wt.totalExpected)})]}),i.jsxs("div",{children:["Ganancia bruta (esperado  facturado):"," ",i.jsx("strong",{children:eu(wt.grossProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:eu(wt.totalGastos)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:eu(wt.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:eu(wt.credits)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded text-center font-semibold text-lg",children:["Monto final (esperado  gastos  dbitos + crditos):"," ",i.jsx("span",{className:"text-blue-700",children:eu(wt.finalAmount)})]})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",disabled:At,onClick:Ve,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",children:At?"Creando":"Crear factura"}),i.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border rounded",children:"Cancelar"}),ke&&i.jsx("span",{className:"text-sm ml-2",children:ke})]}),At&&i.jsxs("div",{className:"absolute inset-0 z-[11000] bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Creando factura"})]})]}),fe&&i.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-lg rounded-xl shadow-xl p-4",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx("h4",{className:"font-semibold",children:"Nuevo cargo"}),i.jsx("button",{type:"button",className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",onClick:()=>xe(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[90px]",value:ae,onChange:he=>Se(he.target.value),placeholder:"Detalle del cargo"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Tipo de cargo"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Te,onChange:he=>O(he.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:G,onChange:he=>z(he.target.value),placeholder:"0.00"})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:L,children:"Agregar"})})]})]})})]})}const Mu=t=>`C$ ${Number(t||0).toFixed(2)}`,wc=t=>Number(t||0).toFixed(3),p4e=t=>(t||"").toLowerCase()==="lb"||/libra/.test((t||"").toLowerCase());function g4e(){const[t,e]=x.useState([]),[r,n]=x.useState(!0),[a,s]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState(Nr(new Date(new Date().getFullYear(),new Date().getMonth(),1),"yyyy-MM-dd")),[d,f]=x.useState(Nr(new Date,"yyyy-MM-dd")),[A,h]=x.useState(""),[m,p]=x.useState(!1),{refreshKey:g,refresh:v}=gc(),[y,b]=x.useState(!1),w=()=>b(D=>!D),[j,I]=x.useState(null),_=D=>I(X=>X===D?null:D);x.useEffect(()=>{(async()=>{n(!0);const D=er(_t(Fe,"inventory_batches"),cr("status","==","PAGADO"),dn("date","desc")),X=await Qt(D),pe=[];X.forEach(ge=>{const fe=ge.data(),xe=Number(fe.quantity||0),ae=Number(fe.remaining||0),Se=Number(fe.purchasePrice||0),Te=Number(fe.salePrice||0),O=Number((xe*Se).toFixed(2)),G=Number((xe*Te).toFixed(2));pe.push({id:ge.id,productId:fe.productId,productName:fe.productName,category:fe.category,unit:fe.unit,quantity:xe,remaining:ae,purchasePrice:Se,salePrice:Te,invoiceTotal:fe.invoiceTotal!=null?Number(fe.invoiceTotal):O,expectedTotal:fe.expectedTotal!=null?Number(fe.expectedTotal):G,date:fe.date,status:fe.status,paidAt:fe.paidAt})}),e(pe),n(!1)})()},[g]);const S=x.useMemo(()=>t.filter(D=>!(c&&D.date<c||d&&D.date>d||A&&D.productId!==A)),[t,c,d,A]),E=x.useMemo(()=>{let D=0,X=0,pe=0,ge=0,fe=0,xe=0;for(const ae of S)p4e(ae.unit)?(D+=ae.quantity,X+=ae.remaining):(pe+=ae.quantity,ge+=ae.remaining),fe+=Number(ae.expectedTotal||0),xe+=Number(ae.invoiceTotal||0);return{lbsIng:D,lbsRem:X,udsIng:pe,udsRem:ge,totalEsperado:fe,totalFact:xe,gross:fe-xe}},[S]),F=D=>{l(D),s(!0)},k=async()=>{if(o)try{const D=Yt(Fe,"inventory_batches",o.id);await pn(D,{status:"PENDIENTE",remaining:o.quantity});const X=_t(Fe,"salesV2"),pe=await Qt(er(X,cr("batchId","==",o.id))),ge=await Qt(er(X,cr("productName","==",o.productName),cr("date","==",o.date))),fe=[...pe.docs,...ge.docs];for(const xe of fe)await Fn(Yt(Fe,"salesV2",xe.id));s(!1),l(null),v()}catch(D){console.error("Error al marcar pendiente:",D)}},P=x.useMemo(()=>{const D=new Map;return t.forEach(X=>D.set(X.productId,{id:X.productId,name:X.productName})),Array.from(D.values()).sort((X,pe)=>X.name.localeCompare(pe.name))},[t]);return i.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-0",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Pagados"}),i.jsx(pc,{onClick:v,loading:r})]}),i.jsxs("div",{className:"bg-white p-3 rounded-2xl shadow-2xl border mb-4 flex flex-col sm:flex-row sm:items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-wrap gap-3",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:D=>u(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:D=>f(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:D=>h(D.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),P.map(D=>i.jsx("option",{value:D.id,children:D.name},D.id))]})]}),i.jsx("button",{type:"button",className:"px-3 py-1 rounded-2xl bg-gray-200 hover:bg-gray-300",onClick:()=>{u(""),f(""),h("")},children:"Quitar filtro"})]}),i.jsx("button",{type:"button",className:"sm:ml-auto px-3 py-2 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",onClick:()=>p(!0),children:"Crear factura"})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("div",{className:"md:hidden",children:[i.jsxs("button",{type:"button",onClick:w,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Totales"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Libras: ",i.jsx("b",{children:wc(E.lbsIng)}),"  Restantes:"," ",i.jsx("b",{children:wc(E.lbsRem)})]})]}),i.jsx("div",{className:"text-gray-500",children:y?"":""})]}),y&&i.jsx("div",{className:"mt-3 bg-gray-50 p-3 rounded-2xl shadow-2xl border text-base",children:i.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",wc(E.lbsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",wc(E.udsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",Mu(E.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",wc(E.lbsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",wc(E.udsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",Mu(E.totalFact)]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",Mu(E.gross)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes:"})," ",S.length.toLocaleString()]})]})})]}),i.jsx("div",{className:"hidden md:block bg-gray-50 p-3 rounded-2xl shadow-2xl border mb-3 text-base",children:i.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",wc(E.lbsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",wc(E.udsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",Mu(E.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",wc(E.lbsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",wc(E.udsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",Mu(E.totalFact)]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",Mu(E.gross)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes:"})," ",S.length.toLocaleString()]})]})})]}),i.jsx("div",{className:"block md:hidden space-y-3",children:r?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Cargando"}):S.length===0?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Sin lotes pagados"}):S.map(D=>{var pe;const X=j===D.id;return i.jsxs("div",{className:"bg-white border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",onClick:()=>_(D.id),className:"w-full text-left px-3 py-3 flex items-center justify-between bg-white",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:D.productName}),i.jsxs("div",{className:"text-xs text-gray-500 truncate",children:[(D.category||"").toUpperCase(),"  ",D.date," "," ",(D.unit||"").toUpperCase()]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-sm font-bold",children:Mu(D.expectedTotal||0)}),i.jsx("div",{className:"text-[11px] text-gray-500",children:X?"Detalles":"Esperado"})]})]}),X&&i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ingresado"}),i.jsx("div",{className:"font-semibold",children:wc(D.quantity)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Restantes"}),i.jsx("div",{className:"font-semibold",children:wc(D.remaining)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Costo"}),i.jsx("div",{className:"font-semibold",children:Mu(D.invoiceTotal||0)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Fecha pago"}),i.jsx("div",{className:"font-semibold",children:(pe=D.paidAt)!=null&&pe.toDate?Nr(D.paidAt.toDate(),"yyyy-MM-dd"):""})]})]}),i.jsx("div",{className:"mt-3",children:i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded-xl text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>F(D),children:"Marcar PENDIENTE"})})]})]},D.id)})}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow-2xl border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Ingresado"}),i.jsx("th",{className:"p-2 border",children:"Restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Compra"}),i.jsx("th",{className:"p-2 border",children:"Precio Venta"}),i.jsx("th",{className:"p-2 border",children:"Total factura"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Fecha pago"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):S.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin lotes pagados"})}):S.map(D=>{var X;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:D.date}),i.jsx("td",{className:"p-2 border",children:(D.category||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:D.productName}),i.jsx("td",{className:"p-2 border",children:(D.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:wc(D.quantity)}),i.jsx("td",{className:"p-2 border",children:wc(D.remaining)}),i.jsx("td",{className:"p-2 border",children:Mu(D.purchasePrice)}),i.jsx("td",{className:"p-2 border",children:Mu(D.salePrice)}),i.jsx("td",{className:"p-2 border",children:Mu(D.invoiceTotal||0)}),i.jsx("td",{className:"p-2 border",children:Mu(D.expectedTotal||0)}),i.jsx("td",{className:"p-2 border",children:(X=D.paidAt)!=null&&X.toDate?Nr(D.paidAt.toDate(),"yyyy-MM-dd"):""}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>F(D),children:"Marcar PENDIENTE"})})]},D.id)})})]})}),m&&i.jsx(m4e,{paidBatches:t,onClose:()=>p(!1),onCreated:()=>p(!1)}),a&&o&&i.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50 p-3",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 w-full max-w-md",children:[i.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Confirmar accin"}),i.jsxs("p",{className:"text-gray-700 mb-4",children:["Seguro que quieres marcar pendiente este inventario?",i.jsx("br",{}),"Al hacerlo, las libras se restaurarn y se eliminarn las ventas generadas."]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{type:"button",onClick:()=>s(!1),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-xl",children:"Cancelar"}),i.jsx("button",{type:"button",onClick:k,className:"px-4 py-2 bg-yellow-600 text-white hover:bg-yellow-700 rounded-xl",children:"Confirmar"})]})]})})]})}const wo=t=>`C$ ${(Number(t)||0).toFixed(2)}`,x4e=["","HOMBRE","MUJER","NINO","NINA","UNISEX"];function kC(t){return(t||"").trim().toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"")}function v4e(t){switch((t||"").toUpperCase()){case"HOMBRE":return"HOM";case"MUJER":return"MUJ";case"NINO":return"NIN";case"NINA":return"NIA";case"UNISEX":return"UNI";default:return"GEN"}}function y4e(t){const e="ROP",r=kC(t.subcat).slice(0,3)||"GEN",n=v4e(t.gender),a=kC(t.color).slice(0,3)||"COL",s=kC(t.size)||"TLL",o=kC(t.brand).slice(0,4)||"BRD",l=Date.now().toString(36).toUpperCase().slice(-4);return`${e}-${r}-${n}-${a}-${s}-${o}-${l}`}const cy=/^[A-Za-z0-9._-]{0,32}$/;function b4e(){const[t,e]=x.useState([]),[r,n]=x.useState([]),[a,s]=x.useState(!0),[o,l]=x.useState(""),[c,u]=x.useState(Nr(yd(new Date),"yyyy-MM-dd")),[d,f]=x.useState(Nr(vd(new Date),"yyyy-MM-dd")),[A,h]=x.useState(""),[m,p]=x.useState(""),[g,v]=x.useState(Nr(new Date,"yyyy-MM-dd")),[y,b]=x.useState(0),[w,j]=x.useState(0),[I,_]=x.useState(0),[S,E]=x.useState(0),[F,k]=x.useState(0),[P,D]=x.useState(""),[X,pe]=x.useState(""),[ge,fe]=x.useState(""),[xe,ae]=x.useState(""),[Se,Te]=x.useState(""),[O,G]=x.useState(""),[z,L]=x.useState(""),[Z,ee]=x.useState(!1),[R,H]=x.useState(""),[ne,ve]=x.useState("Camisa"),[U,He]=x.useState(null),[se,re]=x.useState(""),[Pe,ue]=x.useState(0),[we,Me]=x.useState(0),[ze,yt]=x.useState(0),[It,Ke]=x.useState(0),[wt,At]=x.useState(0),[bt,ke]=x.useState(""),[Ne,Ve]=x.useState(""),[he,le]=x.useState(""),[Be,je]=x.useState(""),[Ae,Qe]=x.useState(""),[Ct,pt]=x.useState(""),[me,te]=x.useState(""),[ie,$e]=x.useState(null),[de,Ce]=x.useState({x:0,y:0}),[nt,vt]=x.useState(!1);x.useEffect(()=>{const M=()=>$e(null),V=q=>q.key==="Escape"&&$e(null);return document.addEventListener("click",M),document.addEventListener("keydown",V),()=>{document.removeEventListener("click",M),document.removeEventListener("keydown",V)}},[]);const ht=(M,V,q=192,Y=160)=>{let De=M;M+q+8>window.innerWidth&&(De=M-q),De=Math.max(8,Math.min(De,window.innerWidth-q-8));let We=V;return V+Y+8>window.innerHeight&&(We=window.innerHeight-Y-8),We=Math.max(8,Math.min(We,window.innerHeight-Y-8)),{x:De,y:We}},xt=(M,V)=>{M.stopPropagation();const q=M.currentTarget.getBoundingClientRect(),Y=q.right,oe=q.bottom,De=ht(Y,oe);Ce(De),$e(We=>We===V?null:V)};x.useEffect(()=>{const M=()=>$e(null),V=q=>{q.key==="Escape"&&$e(null)};return document.addEventListener("click",M),document.addEventListener("keydown",V),()=>{document.removeEventListener("click",M),document.removeEventListener("keydown",V)}},[]),x.useEffect(()=>{if(!ie)return;const M=()=>$e(null);return window.addEventListener("scroll",M,!0),window.addEventListener("resize",M),()=>{window.removeEventListener("scroll",M,!0),window.removeEventListener("resize",M)}},[ie]),x.useEffect(()=>{(async()=>{const M=await Qt(_t(Fe,"products_clothes")),V=[];M.forEach(De=>{const We=De.data();V.push({id:De.id,name:We.name??"(sin nombre)",category:We.category??"(sin categora)",measurement:We.measurement??"unidad",price:Number(We.price??0),sku:We.sku||"",size:We.size||"",color:We.color||"",gender:We.gender||"",brand:We.brand||""})}),e(V);const q=er(_t(Fe,"inventory_clothes_batches"),dn("date","desc")),Y=await Qt(q),oe=[];Y.forEach(De=>{const We=De.data();oe.push({id:De.id,productId:We.productId,productName:We.productName,category:We.category,unit:We.unit,quantity:Number(We.quantity||0),remaining:Number(We.remaining??We.quantity??0),purchasePrice:Number(We.purchasePrice||0),salePrice:Number(We.salePrice||0),invoiceTotal:Number(We.invoiceTotal??Number(We.quantity||0)*Number(We.purchasePrice||0)),expectedTotal:Number(We.expectedTotal??Number(We.quantity||0)*Number(We.salePrice||0)),date:We.date,createdAt:We.createdAt,status:We.status,notes:We.notes||"",sku:We.sku||"",size:We.size||"",color:We.color||"",gender:We.gender||"",brand:We.brand||"",clientCode:We.clientCode||""})}),n(oe),s(!1)})()},[]),x.useEffect(()=>{const M=t.find(V=>V.id===m);M&&(_(Number(M.price||0)),M.sku&&pe(M.sku),M.size&&fe(V=>V||M.size),M.color&&ae(V=>V||M.color),M.gender&&Te(V=>V||M.gender),M.brand&&G(V=>V||M.brand))},[m,t]),x.useEffect(()=>{E(Math.floor(y*w*100)/100)},[y,w]),x.useEffect(()=>{k(Math.floor(y*I*100)/100)},[y,I]),x.useEffect(()=>{const M=t.find(Y=>Y.id===m);if(M!=null&&M.sku){pe(M.sku);return}const V=Z&&ne?ne:(M==null?void 0:M.category)||"";if(!V&&!Se&&!xe&&!ge&&!O){pe("");return}const q=y4e({subcat:V,gender:Se||"",color:xe||"",size:ge||"",brand:O||""});pe(q)},[Z,ne,m,Se,xe,ge,O,t]);const Xe=x.useMemo(()=>r.filter(M=>!(c&&M.date<c||d&&M.date>d||A&&M.productId!==A)),[r,c,d,A]),be=x.useMemo(()=>{const M=Xe.reduce((oe,De)=>oe+(De.invoiceTotal||0),0),V=Xe.reduce((oe,De)=>oe+(De.expectedTotal||0),0),q=Xe.reduce((oe,De)=>oe+De.quantity,0),Y=Xe.reduce((oe,De)=>oe+De.remaining,0);return{udsIng:q,udsRem:Y,totalFacturado:M,totalEsperado:V}},[Xe]),st=async M=>{M.preventDefault(),l("");const V=!!m&&!Z,q=t.find(We=>We.id===m),Y=V?(q==null?void 0:q.name)||"":R||"",oe=V?(q==null?void 0:q.category)||"":ne||"General",De=V&&(q==null?void 0:q.measurement)||"unidad";if(!Y||y<=0||w<=0){l("Completa nombre/cantidad/costo.");return}if(z&&!cy.test(z)){l("Cdigo del cliente invlido (solo A-Z, 0-9, . _ - , mx 32).");return}try{const We=await On(_t(Fe,"inventory_clothes_batches"),{productId:V?q.id:"",productName:Y,category:oe,unit:De,quantity:y,remaining:y,purchasePrice:w,salePrice:I,invoiceTotal:S,expectedTotal:F,date:g,createdAt:dr.now(),status:"PENDIENTE",notes:P||"",sku:X||"",size:ge||"",color:xe||"",gender:Se||"",brand:O||"",clientCode:z||""});n(dt=>[{id:We.id,productId:V?q.id:"",productName:Y,category:oe,unit:De,quantity:y,remaining:y,purchasePrice:w,salePrice:I,invoiceTotal:S,expectedTotal:F,date:g,createdAt:dr.now(),status:"PENDIENTE",notes:P||"",sku:X||"",size:ge||"",color:xe||"",gender:Se||"",brand:O||"",clientCode:z||""},...dt]),l(" Lote de ropa creado"),p(""),v(Nr(new Date,"yyyy-MM-dd")),b(0),j(0),_(0),E(0),k(0),D(""),pe(""),fe(""),ae(""),Te(""),G(""),L(""),ee(!1),H(""),ve("Camisa")}catch(We){console.error(We),l(" Error al crear lote")}},K=async M=>{confirm(`Marcar PAGADO el lote del ${M.date} (${M.productName})?`)&&(await pn(Yt(Fe,"inventory_clothes_batches",M.id),{status:"PAGADO"}),n(q=>q.map(Y=>Y.id===M.id?{...Y,status:"PAGADO"}:Y)))},Ie=M=>{He(M.id),re(M.date),ue(M.quantity),Me(M.purchasePrice),yt(M.salePrice),Ke(Number((M.quantity*M.purchasePrice).toFixed(2))),At(Number((M.quantity*M.salePrice).toFixed(2))),ke(M.notes||""),Ve(M.sku||""),le(M.size||""),je(M.color||""),Qe(M.gender||""),pt(M.brand||""),te(M.clientCode||"")},Ze=()=>{He(null),re(""),ue(0),Me(0),yt(0),Ke(0),At(0),ke(""),Ve(""),le(""),je(""),Qe(""),pt(""),te("")};x.useEffect(()=>{U&&Ke(Math.floor(Pe*we*100)/100)},[U,Pe,we]),x.useEffect(()=>{U&&At(Math.floor(Pe*ze*100)/100)},[U,Pe,ze]);const at=async()=>{if(!U)return;const M=r.find(oe=>oe.id===U);if(!M)return;const V=Math.max(0,M.quantity-M.remaining),q=Math.max(0,Pe-V);if(me&&!cy.test(me)){l("Cdigo del cliente invlido (solo A-Z, 0-9, . _ - , mx 32).");return}const Y=Yt(Fe,"inventory_clothes_batches",U);await pn(Y,{date:se,quantity:Pe,purchasePrice:we,salePrice:ze,invoiceTotal:It,expectedTotal:wt,notes:bt,remaining:q,sku:Ne,size:he,color:Be,gender:Ae||"",brand:Ct||"",clientCode:me||""}),n(oe=>oe.map(De=>De.id===U?{...De,date:se,quantity:Pe,purchasePrice:we,salePrice:ze,invoiceTotal:It,expectedTotal:wt,notes:bt,remaining:q,sku:Ne,size:he,color:Be,gender:Ae||"",brand:Ct||"",clientCode:me||""}:De)),Ze(),l(" Lote actualizado")},it=async M=>{confirm(`Eliminar el lote del ${M.date} (${M.productName})?`)&&(await Fn(Yt(Fe,"inventory_clothes_batches",M.id)),n(q=>q.filter(Y=>Y.id!==M.id)),l(" Lote eliminado"))},T=()=>{const M=(c?`Desde ${c}`:"Desde inicio")+"  "+(d?`Hasta ${d}`:"Hasta hoy"),V=De=>(De||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),q=Xe.map(De=>`
      <tr>
        <td>${De.date}</td>
        <td>${(De.category||"").toUpperCase()}</td>
        <td>${V(De.productName)}</td>
        <td>${V(De.sku||"")}</td>
        <td>${V(De.size||"")}</td>
        <td>${V(De.color||"")}</td>
        <td>${V(De.clientCode||"")}</td>
        <td>${V(De.gender||"")}</td>
        <td>${(De.unit||"").toUpperCase()}</td>
        <td style="text-align:right">${De.quantity.toFixed(0)}</td>
        <td style="text-align:right">${De.remaining.toFixed(0)}</td>
        <td style="text-align:right">${wo(De.purchasePrice)}</td>
        <td style="text-align:right">${wo(De.salePrice)}</td>
        <td style="text-align:right">${wo(De.invoiceTotal||0)}</td>
        <td style="text-align:right">${wo(De.expectedTotal||0)}</td>
        <td>${V((De.notes||"").slice(0,120))}</td>
        <td>${De.status}</td>
      </tr>`).join(""),Y=`
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Inventario de Ropa por Lotes</title>
  <style>
    * { font-family: Arial, sans-serif; }
    h1 { margin: 0 0 4px; }
    .muted { color: #555; font-size: 12px; margin-bottom: 12px; }
    table { width: 100%; border-collapse: collapse; font-size: 11px; }
    th, td { border: 1px solid #ddd; padding: 6px; }
    th { background: #f5f5f5; text-align: left; }
    .totals { margin: 10px 0 16px; font-size: 12px; display: grid; grid-template-columns: repeat(2, max-content); column-gap: 32px; row-gap: 6px; align-items: center; }
    @media print { @page { size: A4 landscape; margin: 12mm; } button { display: none; } }
  </style>
</head>
<body>
  <button onclick="window.print()">Imprimir</button>
  <h1>Inventario de Ropa por Lotes</h1>
  <div class="muted">${M}</div>
  <div class="totals">
    <span><strong>Unidades ingresadas:</strong> ${be.udsIng.toFixed(0)}</span>
    <span><strong>Unidades restantes:</strong> ${be.udsRem.toFixed(0)}</span>
    <span><strong>Total esperado a ganar:</strong> ${wo(be.totalEsperado)}</span>
    <span><strong>Total facturado:</strong> ${wo(be.totalFacturado)}</span>
    <span><strong>Ganancia sin gastos:</strong> ${wo(Number((be.totalEsperado-be.totalFacturado).toFixed(2)))}</span>
  </div>
  <table>
    <thead>
      <tr>
        <th>Fecha</th>
        <th>Subcat.</th>
        <th>Producto</th>
        <th>SKU</th>
        <th>Talla</th>
        <th>Color</th>
        <th>Cdigo Cliente</th>
        <th>Gnero</th>
        <th>Unidad</th>
        <th>Ingresado</th>
        <th>Restantes</th>
        <th>Precio Compra</th>
        <th>Precio Venta</th>
        <th>Total factura</th>
        <th>Total esperado</th>
        <th>Comentario</th>
        <th>Estado</th>
      </tr>
    </thead>
    <tbody>${q||'<tr><td colspan="17" style="text-align:center">Sin lotes</td></tr>'}</tbody>
  </table>
</body>
</html>`,oe=window.open("","_blank");oe&&(oe.document.open(),oe.document.write(Y),oe.document.close())};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario de Ropa"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>vt(!0),type:"button",children:"Crear Inventario"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:M=>u(M.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:M=>f(M.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:M=>h(M.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),t.map(M=>i.jsxs("option",{value:M.id,children:[M.name,"  ",M.category]},M.id))]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{u(""),f(""),h("")},children:"Quitar filtro"}),i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:T,children:"Imprimir PDF"})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-base",children:i.jsxs("div",{className:"grid grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",be.udsIng.toFixed(0)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",be.udsRem.toFixed(0)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",wo(be.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",wo(be.totalFacturado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",wo(Number((be.totalEsperado-be.totalFacturado).toFixed(2)))]})]})}),i.jsx("div",{className:"bg-white rounded shadow border",children:i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Fecha"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden sm:table-cell",children:"Subcat."}),i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"SKU"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden md:table-cell",children:"Talla"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden md:table-cell",children:"Color"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden xl:table-cell",children:"Cdigo Cliente"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"Gnero"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"Unidad"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums",children:"Ingresado"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums",children:"Restantes"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden md:table-cell",children:"Precio Compra"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden md:table-cell",children:"Precio Venta"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden lg:table-cell",children:"Total factura"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden lg:table-cell",children:"Total esperado"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden xl:table-cell",children:"Comentario"}),i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Estado"}),i.jsx("th",{className:"p-2 md:p-3 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center",children:"Cargando"})}):Xe.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center",children:"Sin lotes"})}):Xe.map(M=>{const V=U===M.id;return i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 md:p-3 border align-top",children:V?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:se,onChange:q=>re(q.target.value)}):M.date}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden sm:table-cell",children:(M.category||"").toUpperCase()}),i.jsx("td",{className:"p-2 md:p-3 border align-top max-w-[220px] md:max-w-[320px]",children:i.jsx("span",{className:"block truncate",title:M.productName,children:M.productName})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell max-w-[220px]",children:V?i.jsx("input",{className:"w-full border p-1 rounded",value:Ne,onChange:q=>Ve(q.target.value)}):i.jsx("span",{className:"block truncate",title:M.sku||"",children:M.sku||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden md:table-cell",children:V?i.jsx("input",{className:"w-full border p-1 rounded",value:he,onChange:q=>le(q.target.value)}):M.size||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden md:table-cell",children:V?i.jsx("input",{className:"w-full border p-1 rounded",value:Be,onChange:q=>je(q.target.value)}):M.color||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden xl:table-cell max-w-[200px]",children:V?i.jsx("input",{className:"w-full border p-1 rounded",value:me,onChange:q=>{const Y=q.target.value;cy.test(Y)&&te(Y)},placeholder:"Ej: LOTE-SHEIN-SEP-01",title:"AZ 09 . _ - (mx 32)"}):i.jsx("span",{className:"block truncate",title:M.clientCode||"",children:M.clientCode||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell",children:V?i.jsx("select",{className:"w-full border p-1 rounded",value:Ae,onChange:q=>Qe(q.target.value),children:x4e.map(q=>i.jsx("option",{value:q,children:q||""},q))}):M.gender||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell",children:(M.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums",children:V?i.jsx("input",{type:"number",step:"1",inputMode:"numeric",className:"w-20 border p-1 rounded text-right",value:Number.isNaN(Pe)?"":Pe,onChange:q=>ue(Math.max(0,parseInt(q.target.value||"0",10)))}):M.quantity.toFixed(0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums",children:V?M.remaining:M.remaining.toFixed(0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden md:table-cell",children:V?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(we)?"":we,onChange:q=>Me(Math.max(0,parseFloat(q.target.value||"0")))}):wo(M.purchasePrice)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden md:table-cell",children:V?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(ze)?"":ze,onChange:q=>yt(Math.max(0,parseFloat(q.target.value||"0")))}):wo(M.salePrice)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden lg:table-cell",children:wo(V?It:M.invoiceTotal||0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden lg:table-cell",children:wo(V?wt:M.expectedTotal||0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden xl:table-cell max-w-[280px]",children:V?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:bt,onChange:q=>ke(q.target.value),maxLength:500}):i.jsx("span",{className:"block truncate",title:M.notes||"",children:M.notes||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] md:text-xs ${M.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:M.status})}),i.jsx("td",{className:"p-2 md:p-3 border align-top",children:V?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:at,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Ze,children:"Cancelar"})]}):i.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-8 h-8 rounded border border-gray-200 hover:bg-gray-100",title:"Acciones",onClick:q=>xt(q,M.id),children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:[i.jsx("circle",{cx:"12",cy:"5",r:"1.6"}),i.jsx("circle",{cx:"12",cy:"12",r:"1.6"}),i.jsx("circle",{cx:"12",cy:"19",r:"1.6"})]})})})]},M.id)})})]})})}),ie&&pu.createPortal(i.jsxs(i.Fragment,{children:[i.jsx("div",{onClick:()=>$e(null),className:"fixed inset-0 z-[60]"}),i.jsx("div",{className:"fixed z-[61] w-44 rounded-md border border-gray-200 bg-white shadow-xl",style:{left:de.x,top:de.y},onClick:M=>M.stopPropagation(),role:"menu","aria-orientation":"vertical",children:i.jsxs("div",{className:"py-1 text-sm",children:[(()=>{const M=Xe.find(V=>V.id===ie);return(M==null?void 0:M.status)==="PENDIENTE"?i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-green-50",onClick:()=>{$e(null),K(M)},children:" Pagar"}):null})(),i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-yellow-50",onClick:()=>{const M=Xe.find(V=>V.id===ie);M&&($e(null),Ie(M))},children:" Editar"}),i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-red-50 text-red-600",onClick:()=>{const M=Xe.find(V=>V.id===ie);M&&($e(null),it(M))},children:" Borrar"})]})})]}),document.body),nt&&pu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>vt(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-4xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Inventario (Lote)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>vt(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:st,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto de ropa"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:M=>p(M.target.value),children:[i.jsx("option",{value:"",children:"(Opcional) Selecciona un producto"}),t.map(M=>i.jsxs("option",{value:M.id,children:[M.name,"  ",M.category,"  ",M.sku?`SKU: ${M.sku}`:""]},M.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del lote"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:g,onChange:M=>v(M.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad (pzas)"}),i.jsx("input",{type:"number",step:"1",inputMode:"numeric",className:"w-full border p-2 rounded",value:y===0?"":y,onChange:M=>b(Math.max(0,parseInt(M.target.value||"0",10))),placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de compra (pza)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:w===0?"":w,onChange:M=>j(Math.max(0,parseFloat(M.target.value||"0")))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de venta (pza)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:I===0?"":I,onChange:M=>_(Math.max(0,parseFloat(M.target.value||"0")))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"SKU (auto)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:X,readOnly:!0,placeholder:"Se genera automticamente o se carga del producto",title:"Si el producto tiene SKU, se usa tal cual; si no, se genera por subcat/gnero/talla/color/marca."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Talla"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:ge,readOnly:!0,onChange:M=>fe(M.target.value),placeholder:"XS/S/M/L/XL/10/12"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:xe,readOnly:!0,onChange:M=>ae(M.target.value),placeholder:"Negro, Azul, Rojo"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:Se,readOnly:!0,onChange:M=>Te(M.target.value),placeholder:"Masculino, Femenino, Otro"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Marca / Origen (opcional)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:O,onChange:M=>G(M.target.value),placeholder:"Shein, Usado, Otro"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cdigo del cliente (opcional)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: LOTE-SHEIN-SEP-01",value:z,onChange:M=>{const V=M.target.value;cy.test(V)&&L(V)},title:"Solo letras, nmeros, punto, guion y guion_bajo (mx 32)"}),!cy.test(z)&&z.length>0&&i.jsx("div",{className:"text-xs text-red-600 mt-1",children:"Formato invlido"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:P,onChange:M=>D(M.target.value),maxLength:500,placeholder:"Ej: Camisita veranera, tela delgada, tirantes"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[P.length,"/500"]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Total factura (auto)"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:wo(S),readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Total esperado (auto)"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:wo(F),readOnly:!0})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>vt(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar lote"})]})]})]})]}),document.body),o&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const w4e=["Camisa","Blusa","Vestido","Jean","Pantaln","Short","Falda","Conjunto","Abrigo","Suter","Accesorio"],N4e=["Negro","Blanco","Azul","Rojo","Verde","Gris","Beige","Rosa","Amarillo","Marrn","Morado","Naranja"],C4e=["XS","S","M","L","XL","2XL"],_4e=["2","4","6","8","10","12","14"],E4e=["26","28","30","32","34","36","38"],S4e=["Shein","Usado","Otro"],I4e=["","HOMBRE","MUJER","NINO","NINA","UNISEX"];function FC(t){return(t||"").trim().toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"")}function j4e(t){switch((t||"").toUpperCase()){case"HOMBRE":return"HOM";case"MUJER":return"MUJ";case"NINO":return"NIN";case"NINA":return"NIA";case"UNISEX":return"UNI";default:return"GEN"}}function P4e(t){const e="ROP",r=FC(t.subcat).slice(0,3)||"GEN",n=j4e(t.gender),a=FC(t.color).slice(0,3)||"COL",s=FC(t.size)||"TLL",o=FC(t.brand).slice(0,4)||"BRD";return`${e}-${r}-${n}-${a}-${s}-${o}`}const B4e=/^[A-Za-z0-9._-]{0,32}$/;function T4e(){const[t,e]=x.useState(""),[r,n]=x.useState("Camisa"),[a,s]=x.useState(""),[o,l]=x.useState(""),[c,u]=x.useState("Shein"),[d,f]=x.useState(""),[A,h]=x.useState(""),[m,p]=x.useState(""),[g,v]=x.useState(""),[y,b]=x.useState(""),[w,j]=x.useState("0"),[I,_]=x.useState(""),[S,E]=x.useState(""),F=x.useMemo(()=>{const L=Number(w||0),Z=Number(y||0);return Math.floor(L*Z*100)/100},[w,y]),[k,P]=x.useState([]),[D,X]=x.useState(!0),[pe,ge]=x.useState(""),{refreshKey:fe,refresh:xe}=gc(),[ae,Se]=x.useState(!1),Te=x.useMemo(()=>r.toLowerCase()==="jean"?E4e:d==="NINO"||d==="NINA"?_4e:C4e,[r,d]);x.useEffect(()=>{p(P4e({subcat:r,gender:d,color:o,size:a,brand:c}))},[r,d,o,a,c]),x.useEffect(()=>{(async()=>{X(!0);const L=er(_t(Fe,"products_clothes"),dn("createdAt","desc")),Z=await Qt(L),ee=[];Z.forEach(R=>{const H=R.data();ee.push({id:R.id,name:H.name??"(sin nombre)",category:H.category??"",measurement:H.measurement??"unidad",sku:H.sku??"",size:H.size||"",color:H.color||"",brand:H.brand||"",gender:H.gender||"",clientCode:H.clientCode||"",notes:H.notes||"",createdAt:H.createdAt??dr.now()})}),P(ee),X(!1)})()},[fe]);const O=()=>{e(""),n("Camisa"),s(""),l(""),u("Shein"),f(""),h(""),v(""),b(""),j("0"),_(""),E("")},G=async L=>{if(L.preventDefault(),ge(""),!t.trim()){ge("Ingresa el nombre del producto.");return}if(A&&!B4e.test(A)){ge("Cdigo del cliente invlido");return}const Z=Number(w||0),ee=Number(y||0);if(Z<0){ge("La cantidad de piezas debe ser 0 o mayor.");return}if(ee<0){ge("El precio de venta no puede ser negativo.");return}try{const R=await On(_t(Fe,"products_clothes"),{name:t.trim(),category:r,measurement:"unidad",sku:m,size:a||"",color:o||"",brand:c||"",gender:d||"",clientCode:A||"",notes:g||"",createdAt:dr.now(),price:ee||0});if(P(H=>[{id:R.id,name:t.trim(),category:r,measurement:"unidad",sku:m,size:a||"",color:o||"",brand:c||"",gender:d||"",clientCode:A||"",notes:g||"",createdAt:dr.now()},...H]),Z>0){const H=new Date().toISOString().slice(0,10),ne=I||H;await On(_t(Fe,"inventory_clothes_batches"),{productId:R.id,productName:t.trim(),category:r,unit:"unidad",quantity:Z,remaining:Z,purchasePrice:0,salePrice:ee||0,invoiceTotal:0,expectedTotal:F||0,date:ne,createdAt:dr.now(),status:"PENDIENTE",notes:S||"",sku:m||"",size:a||"",color:o||"",gender:d||"",brand:c||"",clientCode:A||""})}ge(Z>0?" Producto creado y lote de inventario registrado":" Producto de ropa creado"),O()}catch(R){console.error(R),ge(" Error al crear producto")}},z=async L=>{confirm(`Eliminar el producto "${L.name}"?`)&&(await Fn(Yt(Fe,"products_clothes",L.id)),P(ee=>ee.filter(R=>R.id!==L.id)))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Productos de Ropa"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(pc,{onClick:xe,loading:D}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{Se(!0)},children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo producto"]})]})]}),ae&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Nuevo producto de ropa"}),i.jsxs("form",{onSubmit:G,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:t,onChange:L=>e(L.target.value),placeholder:"Ej: Blusa floral"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Subcategora"}),i.jsx("select",{className:"w-full border p-2 rounded",value:r,onChange:L=>n(L.target.value),children:w4e.map(L=>i.jsx("option",{value:L,children:L},L))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Gnero"}),i.jsx("select",{className:"w-full border p-2 rounded",value:d,onChange:L=>f(L.target.value),children:I4e.map(L=>i.jsx("option",{value:L,children:L||""},L))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Talla"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:a,onChange:L=>s(L.target.value),children:[i.jsx("option",{value:"",children:""}),Te.map(L=>i.jsx("option",{value:L,children:L},L))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:L=>l(L.target.value),children:[i.jsx("option",{value:"",children:""}),N4e.map(L=>i.jsx("option",{value:L,children:L},L))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Marca"}),i.jsx("select",{className:"w-full border p-2 rounded",value:c,onChange:L=>u(L.target.value),children:S4e.map(L=>i.jsx("option",{value:L,children:L},L))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"SKU (auto)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:m,readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cdigo cliente"}),i.jsx("input",{className:"w-full border p-2 rounded",value:A,onChange:L=>h(L.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de venta (pza)"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"number",step:"0.01",min:0,value:y,onChange:L=>b(L.target.value),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad de piezas (crea lote si > 0)"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"number",min:0,value:w,onChange:L=>j(L.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de lote"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"date",value:I,onChange:L=>_(L.target.value)})]}),i.jsxs("div",{className:"md:col-span-2 flex items-center justify-between border-t pt-3 mt-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Medicin:"})," unidad"]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado (auto): "}),isNaN(F)?"":F.toFixed(2)]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2 mt-2",children:[i.jsx("button",{type:"button",onClick:O,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Limpiar"}),i.jsx("button",{type:"button",onClick:()=>Se(!1),className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Guardar"})]})]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Subcat."}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Talla"}),i.jsx("th",{className:"p-2 border",children:"Color"}),i.jsx("th",{className:"p-2 border",children:"Marca"}),i.jsx("th",{className:"p-2 border",children:"Gnero"}),i.jsx("th",{className:"p-2 border",children:"Cdigo Cliente"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:D?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):k.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin productos"})}):k.map(L=>{var Z;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(Z=L.createdAt)!=null&&Z.toDate?L.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border",children:L.category}),i.jsx("td",{className:"p-2 border",children:L.name}),i.jsx("td",{className:"p-2 border",children:L.sku}),i.jsx("td",{className:"p-2 border",children:L.size||""}),i.jsx("td",{className:"p-2 border",children:L.color||""}),i.jsx("td",{className:"p-2 border",children:L.brand||""}),i.jsx("td",{className:"p-2 border",children:L.gender||""}),i.jsx("td",{className:"p-2 border",children:L.clientCode||""}),i.jsx("td",{className:"p-2 border",children:L.notes||""}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>z(L),children:"Borrar"})})]},L.id)})})]})}),pe&&i.jsx("p",{className:"mt-2 text-sm",children:pe})]})}async function k4e(t){const{productId:e,quantity:r,saleDate:n,saleId:a}=t,s=Math.max(0,Math.floor(Number(r||0)));if(!e||s<=0)throw new Error("Parmetros invlidos para allocateSaleFIFOClothes");const o=er(_t(Fe,"inventory_clothes_batches"),cr("productId","==",e)),u=(await Qt(o)).docs.map(f=>({id:f.id,data:f.data()})).sort((f,A)=>{var v,y;const h=String(f.data.date||""),m=String(A.data.date||"");if(h!==m)return h<m?-1:1;const p=((v=f.data.createdAt)==null?void 0:v.seconds)??0,g=((y=A.data.createdAt)==null?void 0:y.seconds)??0;return p-g}).map(f=>Yt(Fe,"inventory_clothes_batches",f.id)),d=[];return await Ii(Fe,async f=>{const A=await Promise.all(u.map(m=>f.get(m)));let h=s;for(let m=0;m<u.length&&h>0;m++){const p=u[m],g=A[m];if(!g.exists())continue;const v=g.data(),y=Math.max(0,Math.floor(Number(v.quantity||0))),b=Number.isFinite(Number(v.remaining))?Math.max(0,Math.floor(Number(v.remaining||0))):y;if(b<=0)continue;const w=Math.min(b,h),j=Math.max(0,b-w);f.update(p,{remaining:j}),d.push({batchId:p.id,qty:w,batchDate:String(v.date||""),productName:String(v.productName||"")}),h-=w}if(h>0)throw new Error(`Inventario insuficiente. Faltan ${h} unidades.`);if(a)for(const m of d)await On(_t(Fe,"batch_clothes_allocations"),{saleId:a,saleDate:n,productId:e,productName:m.productName??"",batchId:m.batchId,batchDate:m.batchDate??"",quantity:m.qty,createdAt:dr.now()})}),{allocations:d}}async function Fk(t){const e=Yt(Fe,"sales_clothes",t),r=await Bs(e);if(!r.exists())throw new Error("La venta no existe.");const n=r.data(),a=[];if(Array.isArray(n.items)&&n.items.length>0){const l={};if(n.allocationsByItem&&typeof n.allocationsByItem=="object")for(const c of Object.keys(n.allocationsByItem)){const u=n.allocationsByItem[c],d=String((u==null?void 0:u.productId)||c||"");if(!d)continue;const f=Array.isArray(u==null?void 0:u.allocations)?u.allocations:[];l[d]=f.map(A=>({batchId:String(A.batchId),qty:Math.max(0,Math.floor(Number(A.qty||A.quantity||0)))}))}if(Array.isArray(n.allocationsByItem))for(const c of n.allocationsByItem){const u=String((c==null?void 0:c.productId)||"");if(!u)continue;const d=Array.isArray(c==null?void 0:c.allocations)?c.allocations:[];l[u]=d.map(f=>({batchId:String(f.batchId),qty:Math.max(0,Math.floor(Number(f.qty||f.quantity||0)))}))}for(const c of n.items){const u=String((c==null?void 0:c.productId)||"");if(!u)continue;const d=Math.max(0,Math.floor(Number((c==null?void 0:c.qty)||(c==null?void 0:c.quantity)||0))),f=Array.isArray(c==null?void 0:c.allocations)?c.allocations.map(A=>({batchId:String(A.batchId),qty:Math.max(0,Math.floor(Number(A.qty||A.quantity||0)))})):l[u]||[];a.push({productId:u,productName:String((c==null?void 0:c.productName)||""),qty:d,allocations:f.length?f:void 0})}}else{const l=n.item||{},c=String(l.productId||n.productId||""),u=Math.max(0,Math.floor(Number(l.qty??n.quantity??0))),d=Array.isArray(n.allocations)?n.allocations.map(f=>({batchId:String(f.batchId),qty:Math.max(0,Math.floor(Number(f.qty||f.quantity||0)))})):[];c&&u>0&&a.push({productId:c,productName:String(l.productName||n.productName||""),qty:u,allocations:d.length?d:void 0})}return a.length===0?(await Ii(Fe,async l=>{l.delete(e)}),{restored:0}):a.every(l=>Array.isArray(l.allocations)&&l.allocations.length>0)?(await Ii(Fe,async c=>{const u=[];for(const f of a)for(const A of f.allocations||[])u.push({ref:Yt(Fe,"inventory_clothes_batches",A.batchId),addBack:Math.max(0,Math.floor(Number(A.qty||0)))});const d=await Promise.all(u.map(f=>c.get(f.ref)));for(let f=0;f<u.length;f++){const A=d[f];if(!A.exists())continue;const h=A.data(),m=Math.max(0,Math.floor(Number(h.remaining||0)));c.update(u[f].ref,{remaining:m+u[f].addBack})}c.delete(e)}),{restored:a.reduce((c,u)=>c+(u.allocations||[]).reduce((d,f)=>d+f.qty,0),0)}):(await Ii(Fe,async l=>{const c={};for(const h of a){if(!h.productId||h.qty<=0)continue;const m=er(_t(Fe,"inventory_clothes_batches"),cr("productId","==",h.productId)),g=(await Qt(m)).docs.map(v=>{const y=v.data(),b=Math.max(0,Math.floor(Number(y.quantity||0))),w=Number.isFinite(Number(y.remaining))?Math.max(0,Math.floor(Number(y.remaining||0))):b;return{id:v.id,date:String(y.date||""),quantity:b,remaining:w}}).sort((v,y)=>v.date.localeCompare(y.date));c[h.productId]=g}const u=[];for(const h of a){if(!h.productId||h.qty<=0)continue;if(Array.isArray(h.allocations)&&h.allocations.length>0){for(const g of h.allocations)u.push({id:g.batchId,addBack:Math.max(0,Math.floor(Number(g.qty||0)))});continue}const m=c[h.productId]||[];let p=h.qty;for(const g of m){if(p<=0)break;const v=Math.max(0,g.quantity-g.remaining);if(v<=0)continue;const y=Math.min(v,p);u.push({id:g.id,addBack:y}),p-=y}for(const g of m){if(p<=0)break;const v=Math.min(p,h.qty);u.push({id:g.id,addBack:v}),p-=v}}const d={};for(const h of u)d[h.id]=(d[h.id]||0)+Math.max(0,Math.floor(Number(h.addBack||0)));const f=Object.keys(d).map(h=>Yt(Fe,"inventory_clothes_batches",h)),A=await Promise.all(f.map(h=>l.get(h)));for(let h=0;h<f.length;h++){const m=A[h];if(!m.exists())continue;const p=m.data(),g=Math.max(0,Math.floor(Number(p.remaining||0))),v=Math.max(0,Math.floor(Number(d[f[h].id]||0)));l.update(f[h],{remaining:g+v})}l.delete(e)}),{restored:a.reduce((l,c)=>l+c.qty,0)})}const $V=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],xh=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function OC(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function GV(t){const e=er(_t(Fe,"ar_movements"),cr("ref.saleId","==",t)),r=await Qt(e);await Promise.all(r.docs.map(n=>Fn(Yt(Fe,"ar_movements",n.id))))}function F4e(){const[t,e]=x.useState(!1),[r,n]=x.useState(!1),[a,s]=x.useState(null),[o,l]=x.useState([]),c=async be=>{e(!0),n(!0),s(be),l([]);try{const K=(await Qt(er(_t(Fe,"sales_clothes"),cr("__name__","==",be)))).docs[0],Ie=K==null?void 0:K.data(),at=(Array.isArray(Ie==null?void 0:Ie.items)?Ie.items:Ie!=null&&Ie.item?[Ie.item]:[]).map(it=>({productName:String(it.productName||""),qty:Number(it.qty||0),unitPrice:Number(it.unitPrice||0),discount:Number(it.discount||0),total:Number(it.total||0)}));l(at)}catch(st){console.error(st)}finally{n(!1)}},[u,d]=x.useState(""),[f,A]=x.useState("+505 "),[h,m]=x.useState(""),[p,g]=x.useState(""),[v,y]=x.useState("ACTIVO"),[b,w]=x.useState(0),[j,I]=x.useState([]),[_,S]=x.useState(!0),[E,F]=x.useState(""),[k,P]=x.useState(null),[D,X]=x.useState(""),[pe,ge]=x.useState("+505 "),[fe,xe]=x.useState(""),[ae,Se]=x.useState(""),[Te,O]=x.useState("ACTIVO"),[G,z]=x.useState(0),[L,Z]=x.useState(!1),[ee,R]=x.useState(null),[H,ne]=x.useState(!1),[ve,U]=x.useState([]),[He,se]=x.useState({saldoActual:0,totalAbonado:0,totalCargos:0}),[re,Pe]=x.useState(!1),[ue,we]=x.useState(0),[Me,ze]=x.useState(new Date().toISOString().slice(0,10)),[yt,It]=x.useState(""),[Ke,wt]=x.useState(!1),[At,bt]=x.useState(null),[ke,Ne]=x.useState(""),[Ve,he]=x.useState(0),[le,Be]=x.useState(""),[je,Ae]=x.useState(!1);x.useEffect(()=>{(async()=>{const be=er(_t(Fe,"customers_clothes"),dn("createdAt","desc")),st=await Qt(be),K=[];st.forEach(Ie=>{const Ze=Ie.data();K.push({id:Ie.id,name:Ze.name??"",phone:Ze.phone??"+505 ",place:Ze.place??"",notes:Ze.notes??"",status:Ze.status??"ACTIVO",creditLimit:Number(Ze.creditLimit??0),createdAt:Ze.createdAt??dr.now(),balance:0})});for(const Ie of K)try{const Ze=er(_t(Fe,"ar_movements"),cr("customerId","==",Ie.id)),at=await Qt(Ze);let it=0;at.forEach(T=>it+=Number(T.data().amount||0)),Ie.balance=it}catch{Ie.balance=0}I(K),S(!1)})()},[]);const Qe=()=>{d(""),A("+505 "),m(""),g(""),y("ACTIVO"),w(0)},Ct=async be=>{if(be.preventDefault(),F(""),!u.trim()){F("Ingresa el nombre.");return}const st=OC(f);if(st.length<6){F("Telfono incompleto.");return}try{const K=await On(_t(Fe,"customers_clothes"),{name:u.trim(),phone:st,place:h||"",notes:p||"",status:v,creditLimit:Number(b||0),createdAt:dr.now()});I(Ie=>[{id:K.id,name:u.trim(),phone:st,place:h||"",notes:p||"",status:v,creditLimit:Number(b||0),createdAt:dr.now(),balance:0},...Ie]),Qe(),Ae(!1),F(" Cliente creado")}catch(K){console.error(K),F(" Error al crear cliente")}},pt=be=>{P(be.id),X(be.name),ge(be.phone||"+505 "),xe(be.place||""),Se(be.notes||""),O(be.status||"ACTIVO"),z(Number(be.creditLimit||0))},me=()=>{P(null),X(""),ge("+505 "),xe(""),Se(""),O("ACTIVO"),z(0)},te=async()=>{if(!k)return;const be=OC(pe);if(!D.trim()){F("Ingresa el nombre.");return}try{await pn(Yt(Fe,"customers_clothes",k),{name:D.trim(),phone:be,place:fe||"",notes:ae||"",status:Te,creditLimit:Number(G||0)}),I(st=>st.map(K=>K.id===k?{...K,name:D.trim(),phone:be,place:fe||"",notes:ae||"",status:Te,creditLimit:Number(G||0)}:K)),me(),F(" Cliente actualizado")}catch(st){console.error(st),F(" Error al actualizar")}},ie=async be=>{if(confirm(`Eliminar al cliente "${be.name}"?
Se devolvern al inventario todas las prendas de sus compras y se borrarn sus movimientos.`))try{S(!0);const K=er(_t(Fe,"sales_clothes"),cr("customerId","==",be.id)),Ie=await Qt(K);for(const it of Ie.docs){const T=it.id;try{await Fk(T)}catch(M){console.warn("restoreSaleAndDeleteClothes error",M);try{await Fn(Yt(Fe,"sales_clothes",T))}catch{}}await GV(T)}const Ze=er(_t(Fe,"ar_movements"),cr("customerId","==",be.id)),at=await Qt(Ze);await Promise.all(at.docs.map(it=>Fn(Yt(Fe,"ar_movements",it.id)))),await Fn(Yt(Fe,"customers_clothes",be.id)),I(it=>it.filter(T=>T.id!==be.id)),F(" Cliente eliminado y prendas devueltas al inventario")}catch(K){console.error(K),F(" No se pudo eliminar el cliente.")}finally{S(!1)}},$e=async be=>{R(be),U([]),se({saldoActual:0,totalAbonado:0,totalCargos:0}),Z(!0),Pe(!1),we(0),ze(new Date().toISOString().slice(0,10)),It(""),bt(null),ne(!0);try{const st=er(_t(Fe,"ar_movements"),cr("customerId","==",be.id)),K=await Qt(st),Ie=[];K.forEach(Ze=>{var it,T;const at=Ze.data();Ie.push({id:Ze.id,date:at.date??((T=(it=at.createdAt)==null?void 0:it.toDate)!=null&&T.call(it)?at.createdAt.toDate().toISOString().slice(0,10):""),type:at.type??"CARGO",amount:Number(at.amount||0),ref:at.ref||{},comment:at.comment||"",createdAt:at.createdAt})}),Ie.sort((Ze,at)=>{var M,V;if(Ze.date!==at.date)return Ze.date.localeCompare(at.date);const it=((M=Ze.createdAt)==null?void 0:M.seconds)||0,T=((V=at.createdAt)==null?void 0:V.seconds)||0;return it-T}),U(Ie),de(Ie)}catch(st){console.error(st),F(" No se pudo cargar el estado de cuenta")}finally{ne(!1)}},de=be=>{const st=be.reduce((Ze,at)=>Ze+(Number(at.amount)||0),0),K=be.filter(Ze=>Number(Ze.amount)<0).reduce((Ze,at)=>Ze+Math.abs(Number(at.amount)||0),0),Ie=be.filter(Ze=>Number(Ze.amount)>0).reduce((Ze,at)=>Ze+Number(at.amount)||0,0);se({saldoActual:st,totalAbonado:K,totalCargos:Ie})},Ce=async()=>{if(!ee)return;F("");const be=Number(ue||0);if(!(be>0)){F("Ingresa un monto de abono mayor a 0.");return}const st=parseFloat(be.toFixed(2));if(!Me){F("Selecciona la fecha del abono.");return}try{wt(!0);const K={customerId:ee.id,type:"ABONO",amount:-st,date:Me,comment:yt||"",createdAt:dr.now()},Ze={id:(await On(_t(Fe,"ar_movements"),K)).id,date:Me,type:"ABONO",amount:-st,comment:yt||"",createdAt:dr.now()},at=[...ve,Ze].sort((it,T)=>{var q,Y;if(it.date!==T.date)return it.date.localeCompare(T.date);const M=((q=it.createdAt)==null?void 0:q.seconds)||0,V=((Y=T.createdAt)==null?void 0:Y.seconds)||0;return M-V});U(at),de(at),I(it=>it.map(T=>T.id===ee.id?{...T,balance:(T.balance||0)-st}:T)),R(it=>it&&{...it,balance:(it.balance||0)-st}),we(0),It(""),ze(new Date().toISOString().slice(0,10)),Pe(!1),F(" Abono registrado")}catch(K){console.error(K),F(" Error al registrar el abono")}finally{wt(!1)}},nt=be=>{bt(be.id),Ne(be.date||new Date().toISOString().slice(0,10)),he(Math.abs(Number(be.amount||0))),Be(be.comment||"")},vt=()=>{bt(null),Ne(""),he(0),Be("")},ht=async()=>{if(!At)return;const be=ve.findIndex(Ze=>Ze.id===At);if(be===-1)return;const st=ve[be],K=Number(Ve||0);if(!(K>0)){F("El monto debe ser mayor a 0.");return}const Ie=st.type==="ABONO"?-parseFloat(K.toFixed(2)):+parseFloat(K.toFixed(2));try{await pn(Yt(Fe,"ar_movements",At),{date:ke,amount:Ie,comment:le||""});const Ze=[...ve];Ze[be]={...st,date:ke,amount:Ie,comment:le||""},Ze.sort((it,T)=>{var q,Y;if(it.date!==T.date)return it.date.localeCompare(T.date);const M=((q=it.createdAt)==null?void 0:q.seconds)||0,V=((Y=T.createdAt)==null?void 0:Y.seconds)||0;return M-V}),U(Ze),de(Ze);const at=Ze.reduce((it,T)=>it+(Number(T.amount)||0),0);I(it=>it.map(T=>T.id===(ee==null?void 0:ee.id)?{...T,balance:at}:T)),R(it=>it&&{...it,balance:at}),vt(),F(" Movimiento actualizado")}catch(Ze){console.error(Ze),F(" Error al actualizar movimiento")}},xt=async be=>{var K,Ie;if(confirm(`Eliminar este movimiento (${be.type==="ABONO"?"Abono":"Compra"}) del ${be.date}?${be.type==="CARGO"&&((K=be.ref)!=null&&K.saleId)?`
Se devolvern al inventario las prendas de esa venta.`:""}`))try{if(S(!0),be.type==="CARGO"&&((Ie=be.ref)!=null&&Ie.saleId)){try{await Fk(be.ref.saleId)}catch(it){console.warn("restoreSaleAndDeleteClothes error",it),S(!1),F(" No se pudo devolver inventario de la venta.");return}await GV(be.ref.saleId)}else await Fn(Yt(Fe,"ar_movements",be.id));const Ze=ve.filter(it=>{var T,M;return be.type==="CARGO"&&((T=be.ref)!=null&&T.saleId)?((M=it.ref)==null?void 0:M.saleId)!==be.ref.saleId:it.id!==be.id});U(Ze),de(Ze);const at=Ze.reduce((it,T)=>it+(Number(T.amount)||0),0);I(it=>it.map(T=>T.id===(ee==null?void 0:ee.id)?{...T,balance:at}:T)),R(it=>it&&{...it,balance:at}),F(" Movimiento eliminado")}catch(Ze){console.error(Ze),F(" Error al eliminar movimiento")}finally{S(!1)}},Xe=x.useMemo(()=>[...j].sort((be,st)=>{var K,Ie;return be.status!==st.status?be.status==="BLOQUEADO"?1:-1:(((K=st.createdAt)==null?void 0:K.seconds)||0)-(((Ie=be.createdAt)==null?void 0:Ie.seconds)||0)}),[j]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Ropa)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>Ae(!0),type:"button",children:"Crear Cliente"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:_?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):Xe.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin clientes"})}):Xe.map(be=>{var K;const st=k===be.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(K=be.createdAt)!=null&&K.toDate?be.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border",children:st?i.jsx("input",{className:"w-full border p-1 rounded",value:D,onChange:Ie=>X(Ie.target.value)}):be.name}),i.jsx("td",{className:"p-2 border",children:st?i.jsx("input",{className:"w-full border p-1 rounded",value:pe,onChange:Ie=>ge(OC(Ie.target.value))}):be.phone}),i.jsx("td",{className:"p-2 border",children:st?i.jsxs("select",{className:"w-full border p-1 rounded",value:fe,onChange:Ie=>xe(Ie.target.value),children:[i.jsx("option",{value:"",children:""}),$V.map(Ie=>i.jsx("option",{value:Ie,children:Ie},Ie))]}):be.place||""}),i.jsx("td",{className:"p-2 border",children:st?i.jsxs("select",{className:"w-full border p-1 rounded",value:Te,onChange:Ie=>O(Ie.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${be.status==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:be.status})}),i.jsx("td",{className:"p-2 border",children:st?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(G)?"":G,onChange:Ie=>z(Math.max(0,Number(Ie.target.value||0)))}):xh(be.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:xh(be.balance||0)}),i.jsx("td",{className:"p-2 border",children:st?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:ae,onChange:Ie=>Se(Ie.target.value),maxLength:500}):i.jsx("span",{title:be.notes||"",children:(be.notes||"").length>40?(be.notes||"").slice(0,40)+"":be.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:st?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:te,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:me,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>pt(be),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>ie(be),children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>$e(be),title:"Ver compras y abonos",children:"Estado de cuenta"})]})})})]},be.id)})})]})}),E&&i.jsx("p",{className:"mt-2 text-sm",children:E}),je&&pu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Ae(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Ae(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:Ct,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:u,onChange:be=>d(be.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:f,onChange:be=>A(OC(be.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:be=>m(be.target.value),children:[i.jsx("option",{value:"",children:""}),$V.map(be=>i.jsx("option",{value:be,children:be},be))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:v,onChange:be=>y(be.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:b===0?"":b,onChange:be=>w(Math.max(0,Number(be.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:p,onChange:be=>g(be.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[p.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Ae(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),L&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(ee==null?void 0:ee.name)||""]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{we(0),ze(new Date().toISOString().slice(0,10)),It(""),Pe(!0)},children:"Abonar"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Z(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:xh(He.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:xh(He.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:xh(He.saldoActual)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Referencia"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:H?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):ve.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):ve.map(be=>{var K,Ie;const st=At===be.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:st?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:ke,onChange:Ze=>Ne(Ze.target.value)}):be.date||""}),i.jsx("td",{className:"p-2 border",children:be.amount>=0?(K=be.ref)!=null&&K.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",title:"Ver piezas de esta compra",onClick:()=>c(be.ref.saleId),children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:(Ie=be.ref)!=null&&Ie.saleId?`Venta #${be.ref.saleId}`:""}),i.jsx("td",{className:"p-2 border",children:st?i.jsx("input",{className:"w-full border p-1 rounded",value:le,onChange:Ze=>Be(Ze.target.value),placeholder:"Comentario"}):i.jsx("span",{title:be.comment||"",children:(be.comment||"").length>40?(be.comment||"").slice(0,40)+"":be.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:st?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Ve)?"":Ve,onChange:Ze=>{const at=Number(Ze.target.value||0),it=Number.isFinite(at)?Math.max(0,parseFloat(at.toFixed(2))):0;he(it)},placeholder:"0.00",title:be.type==="ABONO"?"Se guardar como negativo":"Se guardar como positivo"}):xh(be.amount)}),i.jsx("td",{className:"p-2 border",children:st?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:ht,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:vt,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>nt(be),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>xt(be),children:"Borrar"})]})})]},be.id)})})]})})]})}),re&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(ee==null?void 0:ee.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:Me,onChange:be=>ze(be.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto del abono"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ue===0?"":ue,onChange:be=>{const st=Number(be.target.value||0),K=Number.isFinite(st)?Math.max(0,parseFloat(st.toFixed(2))):0;we(K)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se guarda con 2 decimales (se registrar como ABONO negativo)."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:yt,onChange:be=>It(be.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[yt.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Pe(!1),disabled:Ke,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:Ce,disabled:Ke,children:Ke?"Guardando...":"Guardar abono"})]})]})}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[65]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Piezas vendidas"," ",a?` #${a}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>e(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):o.map((be,st)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:be.productName}),i.jsx("td",{className:"p-2 border text-right",children:be.qty}),i.jsx("td",{className:"p-2 border text-right",children:xh(be.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:xh(be.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:xh(be.total)})]},st))})]})})]})})]})}const ox=t=>`C$ ${(Number(t)||0).toFixed(2)}`,O4e=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"];async function D4e(t){if(!t)return 0;const e=er(_t(Fe,"inventory_clothes_batches"),cr("productId","==",t)),r=await Qt(e);let n="0000-00-00",a=-1,s=0;return r.forEach(o=>{const l=o.data(),c=String(l.date||"0000-00-00"),u=Number(l.salePrice||0),d=l.createdAt,f=((d==null?void 0:d.seconds)??0)*1e3+((d==null?void 0:d.nanoseconds)??0)/1e6;c>n?(n=c,a=f,s=u):c===n&&f>a&&(a=f,s=u)}),Number(s||0)}async function KV(t){if(!t)return 0;const e=er(_t(Fe,"inventory_clothes_batches"),cr("productId","==",t)),r=await Qt(e);let n=0;return r.forEach(a=>n+=Number(a.data().remaining||0)),n}function qV(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}function R4e({role:t="",roles:e}={role:""}){const r=e&&e.length?e:t;sn(r,"admin"),sn(r,"vendedor_ropa");const[n,a]=x.useState([]),[s,o]=x.useState([]),[l,c]=x.useState({}),[u,d]=x.useState("CONTADO"),[f,A]=x.useState(""),[h,m]=x.useState(""),[p,g]=x.useState(new Date().toISOString().slice(0,10)),[v,y]=x.useState(""),[b,w]=x.useState([]),j=x.useMemo(()=>b.reduce((ue,we)=>ue+(we.qty||0),0),[b]),I=x.useMemo(()=>{const ue=b.reduce((we,Me)=>{const ze=Math.max(0,(Number(Me.unitPrice)||0)*(Me.qty||0)-(Number(Me.discount)||0));return we+ze},0);return Math.floor(ue*100)/100},[b]),[_,S]=x.useState(0),[E,F]=x.useState(""),[k,P]=x.useState(!1),[D,X]=x.useState(!1),[pe,ge]=x.useState(""),[fe,xe]=x.useState("+505 "),[ae,Se]=x.useState(""),[Te,O]=x.useState(""),[G,z]=x.useState("ACTIVO"),[L,Z]=x.useState(0),ee=()=>{ge(""),xe("+505 "),Se(""),O(""),z("ACTIVO"),Z(0)};x.useEffect(()=>{(async()=>{const ue=er(_t(Fe,"customers_clothes"),dn("createdAt","desc")),we=await Qt(ue),Me=[];we.forEach(bt=>{const ke=bt.data();Me.push({id:bt.id,name:ke.name??"",phone:ke.phone??"+505 ",place:ke.place??"",status:ke.status??"ACTIVO",creditLimit:Number(ke.creditLimit??0),balance:0})});for(const bt of Me)try{const ke=er(_t(Fe,"ar_movements"),cr("customerId","==",bt.id)),Ne=await Qt(ke);let Ve=0;Ne.forEach(he=>Ve+=Number(he.data().amount||0)),bt.balance=Ve}catch{bt.balance=0}a(Me);const ze=er(_t(Fe,"products_clothes"),dn("createdAt","desc")),yt=await Qt(ze),It=[];yt.forEach(bt=>{const ke=bt.data();It.push({id:bt.id,name:ke.name??"(sin nombre)",sku:ke.sku??""})}),o(It);const Ke=er(_t(Fe,"inventory_clothes_batches"),cr("remaining",">",0)),wt=await Qt(Ke),At={};wt.forEach(bt=>{const ke=bt.data(),Ne=ke.productId||"",Ve=Number(ke.remaining||0);Ne&&(At[Ne]=(At[Ne]||0)+Ve)}),c(At)})()},[]);const R=x.useMemo(()=>n.find(ue=>ue.id===f),[n,f]),H=(R==null?void 0:R.balance)||0,ne=u==="CREDITO"?H+Math.max(0,Number(I||0))-Math.max(0,Number(_||0)):0,ve=async ue=>{if(!ue)return;if(b.some(It=>It.productId===ue)){y("");return}const we=s.find(It=>It.id===ue);if(!we){y("");return}let Me=await D4e(ue);Me||(Me=Number((we==null?void 0:we.price)||0));const ze=await KV(ue),yt={productId:ue,productName:we.name||"",sku:we.sku||"",unitPrice:Number(Me)||0,available:Number(ze)||0,qty:0,discount:0};w(It=>[...It,yt]),y("")},U=(ue,we)=>{w(Me=>Me.map(ze=>{if(ze.productId!==ue)return ze;if(we==="")return{...ze,qty:0};const yt=Math.max(0,Math.floor(Number(we)));return{...ze,qty:yt}}))},He=(ue,we)=>{w(Me=>Me.map(ze=>{if(ze.productId!==ue)return ze;if(we==="")return{...ze,discount:0};const yt=Math.max(0,Math.floor(Number(we)));return{...ze,discount:yt}}))},se=ue=>w(we=>we.filter(Me=>Me.productId!==ue)),re=async()=>{if(!p)return"Selecciona la fecha.";if(b.length===0)return"Agrega al menos un producto.";const ue=b.filter(we=>(we.qty||0)>0);if(ue.length===0)return"Debes ingresar cantidades (> 0) en al menos un producto.";if(!(I>0))return"El total debe ser mayor a cero.";if(u==="CONTADO"){if(!h.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!f)return"Selecciona un cliente (crdito).";if(_<0)return"El pago inicial no puede ser negativo.";if(_>I)return"El pago inicial no puede superar el total.";if((R==null?void 0:R.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede facturar a crdito."}for(const we of ue){const Me=await KV(we.productId);if(we.qty>Me)return`Inventario insuficiente para "${we.productName}". Disponible: ${Me} unidades.`;const ze=(Number(we.unitPrice)||0)*(we.qty||0),yt=Number(we.discount)||0;if(!Number.isInteger(yt)||yt<0)return`El descuento en "${we.productName}" debe ser entero y  0.`;if(yt>ze)return`El descuento en "${we.productName}" no puede exceder C$ ${ze.toFixed(2)}.`}return null},Pe=async ue=>{ue.preventDefault(),F("");const we=await re();if(we){F(" "+we);return}try{P(!0);const Me=b.filter(Ke=>(Ke.qty||0)>0).map(Ke=>{const wt=(Number(Ke.unitPrice)||0)*(Ke.qty||0),At=Math.max(0,Math.floor(Number(Ke.discount)||0)),bt=Math.max(0,wt-At);return{productId:Ke.productId,productName:Ke.productName,sku:Ke.sku||"",qty:Ke.qty,unitPrice:Number(Ke.unitPrice)||0,discount:At,total:Math.floor(bt*100)/100}}),ze={type:u,date:p,createdAt:dr.now(),itemsTotal:Number(I)||0,total:Number(I)||0,quantity:Number(j)||0,items:Me};u==="CONTADO"?ze.customerName=h.trim():(ze.customerId=f,ze.downPayment=Number(_)||0);const yt=await On(_t(Fe,"sales_clothes"),ze);if(u==="CREDITO"&&f){const Ke={customerId:f,date:p,createdAt:dr.now(),ref:{saleId:yt.id}};await On(_t(Fe,"ar_movements"),{...Ke,type:"CARGO",amount:Number(I)||0}),Number(_)>0&&await On(_t(Fe,"ar_movements"),{...Ke,type:"ABONO",amount:-Number(_)})}const It={};for(const Ke of Me)if(Ke.qty>0){const{allocations:wt}=await k4e({productId:Ke.productId,quantity:Ke.qty,saleDate:p,saleId:yt.id});It[Ke.productId]={productId:Ke.productId,allocations:wt}}await pn(Yt(Fe,"sales_clothes",yt.id),{allocationsByItem:It}),d("CONTADO"),A(""),m(""),g(new Date().toISOString().slice(0,10)),w([]),S(0),u==="CREDITO"&&f&&a(Ke=>Ke.map(wt=>wt.id===f?{...wt,balance:(wt.balance||0)+(Number(I)||0)-(Number(_)||0)}:wt)),F(" Venta registrada"),(async()=>{const Ke=er(_t(Fe,"inventory_clothes_batches"),cr("remaining",">",0)),wt=await Qt(Ke),At={};wt.forEach(bt=>{const ke=bt.data(),Ne=ke.productId||"",Ve=Number(ke.remaining||0);Ne&&(At[Ne]=(At[Ne]||0)+Ve)}),c(At)})()}catch(Me){console.error(Me),F(" Error al guardar la venta")}finally{P(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas (Ropa)"}),i.jsxs("form",{onSubmit:Pe,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:u,onChange:ue=>d(ue.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),u==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre del cliente (contado)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Cliente Mostrador",value:h,onChange:ue=>m(ue.target.value)})]}):i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("select",{className:"flex-1 border p-2 rounded",value:f,onChange:ue=>A(ue.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),n.map(ue=>i.jsxs("option",{value:ue.status==="ACTIVO"?ue.id:"",disabled:ue.status==="BLOQUEADO",children:[ue.name," | ",ue.phone," | Saldo: ",ox(ue.balance||0)]},ue.id))]}),i.jsx("button",{type:"button",className:"px-20 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>X(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:ox(H)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:_===0?"":_,onChange:ue=>S(Math.max(0,Number(ue.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:ox(ne)})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:p,onChange:ue=>g(ue.target.value)})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:v,onChange:async ue=>{const we=ue.target.value;y(we),await ve(we)},children:[i.jsx("option",{value:"",children:"Selecciona un producto"}),s.map(ue=>{const we=b.some(yt=>yt.productId===ue.id),Me=l[ue.id]||0,ze=we||Me<=0;return i.jsxs("option",{value:ze?"":ue.id,disabled:ze,children:[ue.name," ",ue.sku?` ${ue.sku}`:""," ",Me>0?`(disp: ${Me})`:"(sin stock)",we?" (seleccionado)":""]},ue.id)})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Productos sin existencias se muestran en gris y no se pueden seleccionar."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsxs("div",{className:"border rounded overflow-hidden",children:[i.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 px-3 py-2 text-xs font-semibold border-b",children:[i.jsx("div",{className:"col-span-4",children:"Producto"}),i.jsx("div",{className:"col-span-2 text-right",children:"Precio"}),i.jsx("div",{className:"col-span-2 text-right",children:"Existencias"}),i.jsx("div",{className:"col-span-1 text-right",children:"Cantidad"}),i.jsx("div",{className:"col-span-1 text-right",children:"Descuento"}),i.jsx("div",{className:"col-span-1 text-right",children:"Monto"}),i.jsx("div",{className:"col-span-1 text-center",children:"Quitar"})]}),b.length===0?i.jsx("div",{className:"px-3 py-4 text-sm text-gray-500",children:"No hay productos agregados."}):b.map(ue=>{const we=Math.max(0,(ue.available||0)-(ue.qty||0)),Me=(Number(ue.unitPrice)||0)*(ue.qty||0),ze=Math.max(0,Me-(Number(ue.discount)||0));return i.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 border-b text-sm gap-x-2",children:[i.jsx("div",{className:"col-span-4",children:i.jsxs("div",{className:"font-medium",children:[ue.productName,ue.sku?`  ${ue.sku}`:""]})}),i.jsx("div",{className:"col-span-2 text-right",children:ox(ue.unitPrice)}),i.jsx("div",{className:"col-span-2 text-right",children:we}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(ue.qty)||ue.qty===0?"":ue.qty,onChange:yt=>U(ue.productId,yt.target.value),inputMode:"numeric",placeholder:"0",title:"Cantidad de piezas"})}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(ue.discount)||ue.discount===0?"":ue.discount,onChange:yt=>He(ue.productId,yt.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento entero (C$)"})}),i.jsx("div",{className:"col-span-1 text-right",children:ox(ze)}),i.jsx("div",{className:"col-span-1 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 hover:bg-red-200",onClick:()=>se(ue.productId),title:"Quitar producto",children:""})})]},ue.productId)})]}),b.length>0&&i.jsxs("div",{className:"flex justify-end gap-6 mt-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Piezas totales: "}),i.jsx("span",{className:"font-semibold",children:j})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Total: "}),i.jsx("span",{className:"font-semibold",children:ox(I)})]})]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",disabled:k,children:k?"Guardando...":"Registrar venta"})})]}),E&&i.jsx("p",{className:"mt-2 text-sm",children:E}),D&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-xl p-4",children:[i.jsx("h3",{className:"text-lg font-bold mb-3",children:"Nuevo cliente"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:pe,onChange:ue=>ge(ue.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:fe,onChange:ue=>xe(qV(ue.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ae,onChange:ue=>Se(ue.target.value),children:[i.jsx("option",{value:"",children:""}),O4e.map(ue=>i.jsx("option",{value:ue,children:ue},ue))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:G,onChange:ue=>z(ue.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:L===0?"":L,onChange:ue=>Z(Math.max(0,Number(ue.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Te,onChange:ue=>O(ue.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{ee(),X(!1)},children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:async()=>{if(F(""),!pe.trim()){F("Ingresa el nombre del nuevo cliente.");return}const ue=qV(fe);try{const we=await On(_t(Fe,"customers_clothes"),{name:pe.trim(),phone:ue,place:ae||"",notes:Te||"",status:G,creditLimit:Number(L||0),createdAt:dr.now()}),Me={id:we.id,name:pe.trim(),phone:ue,place:ae||"",status:G,creditLimit:Number(L||0),balance:0};a(ze=>[Me,...ze]),A(we.id),ee(),X(!1),F(" Cliente creado")}catch(we){console.error(we),F(" Error al crear cliente")}},children:"Guardar cliente"})]})]})}),k&&i.jsx("div",{className:"fixed inset-0 z-[70] bg-black/40 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border px-4 py-3 flex items-center gap-3",children:[i.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-medium",children:"Guardando venta"})]})})]})}const Yi=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function iE(t){var r;const e=t==null?void 0:t.date;return e||((r=t==null?void 0:t.createdAt)!=null&&r.toDate?Nr(t.createdAt.toDate(),"yyyy-MM-dd"):"")}function M4e(t,e){const r=iE(t);if(!r)return null;if(Array.isArray(t.items))return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total??t.itemsTotal??0),items:t.items.map(o=>({productId:String(o.productId||""),productName:String(o.productName||""),sku:o.sku||"",qty:Number(o.qty||0),unitPrice:Number(o.unitPrice??(Number(o.total||0)/Math.max(1,Number(o.qty||0))||0)),discount:Number(o.discount||0)})),customerId:t.customerId||void 0,customerName:t.customerName||void 0};const n=t.item||{},a=Number(t.quantity??n.qty??0),s=Number(t.total??t.itemsTotal??n.total??0);return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total??t.itemsTotal??s??0),items:[{productId:String(n.productId||t.productId||""),productName:String(n.productName||t.productName||""),sku:n.sku||t.sku||"",qty:a,unitPrice:Number(n.unitPrice??(s&&a?s/a:0)),discount:Number(n.discount||0)}],customerId:t.customerId||void 0,customerName:t.customerName||void 0}}function L4e(t,e,r,n){const a={};for(const l of t)a[l.productId]||(a[l.productId]={productName:l.productName,lots:[]}),a[l.productId].lots.push({date:l.date,qtyLeft:Number(l.quantity||0),cost:Number(l.purchasePrice||0)});for(const l of Object.keys(a))a[l].lots.sort((c,u)=>c.date.localeCompare(u.date));const s=[...e].sort((l,c)=>l.date.localeCompare(c.date));let o=0;for(const l of s)for(const c of l.items||[]){const u=a[c.productId];if(!u)continue;let d=Number(c.qty||0);if(!(d<=0))for(const f of u.lots){if(d<=0)break;if(f.qtyLeft<=0)continue;const A=Math.min(f.qtyLeft,d);l.date>=r&&l.date<=n&&(o+=A*f.cost),f.qtyLeft-=A,d-=A}}return o}function U4e(){const{refreshKey:t,refresh:e}=gc(),[r,n]=x.useState(Nr(yd(new Date),"yyyy-MM-dd")),[a,s]=x.useState(Nr(vd(new Date),"yyyy-MM-dd")),[o,l]=x.useState([]),[c,u]=x.useState([]),[d,f]=x.useState([]),[A,h]=x.useState([]),[m,p]=x.useState([]),[g,v]=x.useState([]),[y,b]=x.useState(!0),[w,j]=x.useState(""),[I,_]=x.useState(!1),[S,E]=x.useState(null),[F,k]=x.useState([]),[P,D]=x.useState(!1),[X,pe]=x.useState({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});x.useEffect(()=>{(async()=>{b(!0),j("");try{const O=await Qt(_t(Fe,"sales_clothes")),G=[],z=[];O.forEach(se=>{const re=se.data(),Pe=M4e(re,se.id);Pe&&(Pe.date<=a&&G.push(Pe),Pe.date>=r&&Pe.date<=a&&z.push(Pe))}),u(G),l(z);const L=await Qt(_t(Fe,"inventory_clothes_batches")),Z=[];L.forEach(se=>{const re=se.data(),Pe=iE(re);!Pe||Pe>a||Z.push({id:se.id,productId:re.productId,productName:re.productName||"",date:Pe,quantity:Number(re.quantity||0),remaining:Number(re.remaining||0),purchasePrice:Number(re.purchasePrice||0)})}),f(Z);const ee=await Qt(_t(Fe,"expenses_clothes")),R=[];ee.forEach(se=>{const re=se.data(),Pe=iE(re);Pe&&Pe>=r&&Pe<=a&&R.push({id:se.id,date:Pe,category:re.category||"",description:re.description||"",amount:Number(re.amount||0),status:re.status||""})}),h(R);const H=await Qt(_t(Fe,"ar_movements")),ne=[],ve={};H.forEach(se=>{const re=se.data(),Pe=iE(re);if(!Pe)return;const ue=re.customerId,we=Number(re.amount||0);ue&&(ve[ue]=(ve[ue]||0)+we),re.type==="ABONO"&&Pe>=r&&Pe<=a&&ne.push({id:se.id,customerId:ue,type:"ABONO",amount:we,date:Pe})}),p(ne);const U=await Qt(_t(Fe,"customers_clothes")),He=[];U.forEach(se=>{const re=se.data();He.push({id:se.id,name:re.name||"",balance:ve[se.id]||0})}),v(He)}catch(O){console.error(O),j(" Error cargando datos del dashboard.")}finally{b(!1)}})()},[r,a,t]);const ge=x.useMemo(()=>{try{return L4e(d,c,r,a)}catch(O){return console.error(O),0}},[d,c,r,a]),fe=x.useMemo(()=>{const O=o.reduce((ve,U)=>ve+(U.total||0),0),G=A.reduce((ve,U)=>ve+(U.amount||0),0),z=O-ge,L=z-G,Z=m.reduce((ve,U)=>ve+Math.abs(U.amount||0),0),ee=g.filter(ve=>(ve.balance||0)>0),R=ee.reduce((ve,U)=>ve+(U.balance||0),0);let H=0,ne=0;for(const ve of o){const U=(ve.items||[]).reduce((He,se)=>He+(Number(se.qty)||0),0);ve.type==="CONTADO"?H+=U:ne+=U}return{ventasTotales:O,costoMercaderia:ge,gastosPeriodo:G,gananciaAntes:z,gananciaDespues:L,abonosRecibidos:Z,saldosPendientes:R,clientesConSaldo:ee.length,prendasCash:H,prendasCredito:ne}},[o,A,m,g,ge]),xe=x.useMemo(()=>{const O={};for(const G of o){if(G.type!=="CREDITO"||!G.customerId)continue;const z=(G.items||[]).reduce((L,Z)=>L+(Number(Z.qty)||0),0);O[G.customerId]=(O[G.customerId]||0)+z}return g.filter(G=>(G.balance||0)>0).map(G=>({customerId:G.id,name:G.name,prendasCredito:O[G.id]||0,saldo:G.balance||0})).sort((G,z)=>z.saldo-G.saldo)},[g,o]),ae=x.useMemo(()=>{const O={};return g.forEach(G=>O[G.id]=G.name),O},[g]),Se=x.useMemo(()=>[...o].sort((O,G)=>G.date.localeCompare(O.date)).map(O=>{var L;const G=(O.items||[]).reduce((Z,ee)=>Z+(Number(ee.qty)||0),0);let z="Cash";return O.type==="CREDITO"&&O.customerId?z=ae[O.customerId]||"":O.type==="CONTADO"&&(z=((L=O.customerName)==null?void 0:L.trim())||"Cash"),{id:O.id,date:O.date,type:O.type==="CREDITO"?"Crdito":"Cash",customer:z,piezas:G,total:Number(O.total||0)}}),[o,ae]),Te=async O=>{_(!0),E({id:O.customerId,name:O.name}),k([]),D(!0),pe({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});try{const G=[];let z=0,L=0,Z=0;for(const ne of o)if(!(ne.type!=="CREDITO"||ne.customerId!==O.customerId))for(const ve of ne.items||[]){const U=Number(ve.qty||0),He=Number(ve.unitPrice||0),se=U*He,re=Math.max(0,Number(ve.discount||0)),Pe=Math.max(0,se-re);G.push({saleId:ne.id,date:ne.date,productName:ve.productName,sku:ve.sku||"",qty:U,unitPrice:He,lineTotal:se,discount:re,lineFinal:Pe}),z+=se,L+=re,Z+=Pe}let ee=0;for(const ne of m)ne.customerId===O.customerId&&(ee+=Math.abs(ne.amount||0));const R=g.find(ne=>ne.id===O.customerId),H=(R==null?void 0:R.balance)||0;k(G),pe({totalBruto:z,totalDescuento:L,totalFiado:Z,saldoActual:H,abonadoPeriodo:ee})}catch(G){console.error(G),j(" No se pudo cargar el detalle del cliente.")}finally{D(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas (Ropa)"}),i.jsx(pc,{onClick:e,loading:y})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:O=>n(O.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:O=>s(O.target.value)})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:Yi(fe.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Cash + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:Yi(fe.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia antes de Gastos"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:Yi(fe.gananciaAntes)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos del Negocio"}),i.jsx("div",{className:"text-xl font-semibold",children:Yi(fe.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia despus de Gastos"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:Yi(fe.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:Yi(fe.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:Yi(fe.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:fe.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prendas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:fe.prendasCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prendas Crdito (vendidas)"}),i.jsx("div",{className:"text-xl font-semibold",children:fe.prendasCredito})]})]}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Consolidado por cliente"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Prendas Crdito (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo actual"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:3,children:"Cargando"})}):xe.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:3,children:"Sin clientes con saldo"})}):xe.map(O=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:O.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Te({customerId:O.customerId,name:O.name}),title:"Ver piezas fiadas del periodo",children:O.prendasCredito})}),i.jsx("td",{className:"p-2 border font-semibold",children:Yi(O.saldo)})]},O.customerId))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Piezas"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):Se.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin transacciones en el rango seleccionado."})}):Se.map(O=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:O.date}),i.jsx("td",{className:"p-2 border",children:O.customer}),i.jsx("td",{className:"p-2 border",children:O.type}),i.jsx("td",{className:"p-2 border",children:O.piezas}),i.jsx("td",{className:"p-2 border",children:Yi(O.total)})]},O.id))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):A.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):A.sort((O,G)=>O.date.localeCompare(G.date)).map(O=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:O.date}),i.jsx("td",{className:"p-2 border",children:O.category||""}),i.jsx("td",{className:"p-2 border",children:O.description?i.jsx("span",{title:O.description,children:O.description.length>40?O.description.slice(0,40)+"":O.description}):""}),i.jsx("td",{className:"p-2 border",children:Yi(O.amount)}),i.jsx("td",{className:"p-2 border",children:O.status||""})]},O.id))})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w}),I&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle del cliente  ",(S==null?void 0:S.name)||""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>_(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total Bruto (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:Yi(X.totalBruto)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Descuento (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:Yi(X.totalDescuento)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Total Fiado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:Yi(X.totalFiado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:Yi(X.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:Yi(X.abonadoPeriodo)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha compra"}),i.jsx("th",{className:"p-2 border",children:"Pieza"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Cant."}),i.jsx("th",{className:"p-2 border",children:"P. Unit"}),i.jsx("th",{className:"p-2 border",children:"Monto"})," ",i.jsx("th",{className:"p-2 border",children:"Descuento"})," ",i.jsx("th",{className:"p-2 border",children:"Monto final"})," "]})}),i.jsx("tbody",{children:P?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Cargando"})}):F.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Sin piezas fiadas en el periodo."})}):F.sort((O,G)=>O.date.localeCompare(G.date)).map((O,G)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:O.date}),i.jsx("td",{className:"p-2 border",children:O.productName}),i.jsx("td",{className:"p-2 border",children:O.sku||""}),i.jsx("td",{className:"p-2 border",children:O.qty}),i.jsx("td",{className:"p-2 border",children:Yi(O.unitPrice)}),i.jsx("td",{className:"p-2 border",children:Yi(O.lineTotal)}),i.jsx("td",{className:"p-2 border",children:Yi(O.discount)}),i.jsx("td",{className:"p-2 border",children:Yi(O.lineFinal)})]},`${O.saleId}-${G}`))})]})})]})})]})}const zV=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal"],DC=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Q4e(){const[t,e]=x.useState(Nr(yd(new Date),"yyyy-MM-dd")),[r,n]=x.useState(Nr(vd(new Date),"yyyy-MM-dd")),[a,s]=x.useState(Nr(new Date,"yyyy-MM-dd")),[o,l]=x.useState(""),[c,u]=x.useState(""),[d,f]=x.useState(0),[A,h]=x.useState("PENDIENTE"),[m,p]=x.useState(""),[g,v]=x.useState([]),[y,b]=x.useState(!0),[w,j]=x.useState(""),[I,_]=x.useState(null),[S,E]=x.useState(""),[F,k]=x.useState(""),[P,D]=x.useState(""),[X,pe]=x.useState(0),[ge,fe]=x.useState("PENDIENTE"),[xe,ae]=x.useState("");x.useEffect(()=>{(async()=>{b(!0);try{const R=er(_t(Fe,"expenses_clothes"),dn("date","desc")),H=await Qt(R),ne=[];H.forEach(ve=>{const U=ve.data();ne.push({id:ve.id,date:U.date||Nr(new Date,"yyyy-MM-dd"),category:U.category||"",description:U.description||"",amount:Number(U.amount||0),status:U.status||"PENDIENTE",notes:U.notes||"",createdAt:U.createdAt??dr.now()})}),v(ne)}catch(R){console.error(R),j(" Error al cargar gastos")}finally{b(!1)}})()},[]);const Se=x.useMemo(()=>g.filter(R=>!(t&&R.date<t||r&&R.date>r)),[g,t,r]),Te=x.useMemo(()=>{const R=Se.reduce((ve,U)=>ve+(U.amount||0),0),H=Se.filter(ve=>ve.status==="PAGADO").reduce((ve,U)=>ve+(U.amount||0),0),ne=R-H;return{total:R,pagado:H,pendiente:ne}},[Se]),O=()=>{s(Nr(new Date,"yyyy-MM-dd")),l(""),u(""),f(0),h("PENDIENTE"),p("")},G=async R=>{if(R.preventDefault(),j(""),!o){j("Selecciona una categora.");return}if(!c.trim()){j("Ingresa una descripcin.");return}if(!d||d<=0){j("Ingresa un monto vlido.");return}try{const H=await On(_t(Fe,"expenses_clothes"),{date:a,category:o,description:c.trim(),amount:Number(d.toFixed(2)),status:A,notes:m||"",createdAt:dr.now()});v(ne=>[{id:H.id,date:a,category:o,description:c.trim(),amount:Number(d.toFixed(2)),status:A,notes:m||"",createdAt:dr.now()},...ne]),O(),j(" Gasto registrado")}catch(H){console.error(H),j(" Error al guardar gasto")}},z=R=>{_(R.id),E(R.date),k(R.category||""),D(R.description||""),pe(Number(R.amount||0)),fe(R.status||"PENDIENTE"),ae(R.notes||"")},L=()=>{_(null),E(""),k(""),D(""),pe(0),fe("PENDIENTE"),ae("")},Z=async()=>{if(I){if(!F){j("Selecciona una categora.");return}if(!P.trim()){j("Ingresa una descripcin.");return}if(!X||X<=0){j("Ingresa un monto vlido.");return}try{await pn(Yt(Fe,"expenses_clothes",I),{date:S,category:F,description:P.trim(),amount:Number(X.toFixed(2)),status:ge,notes:xe||""}),v(R=>R.map(H=>H.id===I?{...H,date:S,category:F,description:P.trim(),amount:Number(X.toFixed(2)),status:ge,notes:xe||""}:H)),L(),j(" Gasto actualizado")}catch(R){console.error(R),j(" Error al actualizar gasto")}}},ee=async R=>{confirm(`Eliminar el gasto "${R.description}"?`)&&(await Fn(Yt(Fe,"expenses_clothes",R.id)),v(ne=>ne.filter(ve=>ve.id!==R.id)),j(" Gasto borrado"))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Ropa)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:R=>e(R.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:R=>n(R.target.value)})]}),i.jsxs("div",{className:"ml-auto text-sm",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",DC(Te.total)]}),i.jsxs("div",{children:["Pagado: ",DC(Te.pagado)]}),i.jsxs("div",{children:["Pendiente: ",DC(Te.pendiente)]})]})]}),i.jsxs("form",{onSubmit:G,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:a,onChange:R=>s(R.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:R=>l(R.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),zV.map(R=>i.jsx("option",{value:R,children:R},R))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:R=>u(R.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:d===0?"":d,onChange:R=>f(Math.max(0,Number(R.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:A,onChange:R=>h(R.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:R=>p(R.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):Se.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):Se.slice().sort((R,H)=>R.date.localeCompare(H.date)).map(R=>{const H=I===R.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:H?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:S,onChange:ne=>E(ne.target.value)}):R.date}),i.jsx("td",{className:"p-2 border",children:H?i.jsxs("select",{className:"w-full border p-1 rounded",value:F,onChange:ne=>k(ne.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),zV.map(ne=>i.jsx("option",{value:ne,children:ne},ne))]}):R.category||""}),i.jsx("td",{className:"p-2 border",children:H?i.jsx("input",{className:"w-full border p-1 rounded",value:P,onChange:ne=>D(ne.target.value)}):i.jsx("span",{title:R.description,children:R.description.length>40?R.description.slice(0,40)+"":R.description})}),i.jsx("td",{className:"p-2 border",children:H?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(X)?"":X,onChange:ne=>pe(Math.max(0,Number(ne.target.value||0)))}):DC(R.amount)}),i.jsx("td",{className:"p-2 border",children:H?i.jsxs("select",{className:"w-full border p-1 rounded",value:ge,onChange:ne=>fe(ne.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${R.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:R.status})}),i.jsx("td",{className:"p-2 border",children:H?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:xe,onChange:ne=>ae(ne.target.value),maxLength:500}):i.jsx("span",{title:R.notes||"",children:(R.notes||"").length>40?(R.notes||"").slice(0,40)+"":R.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:H?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Z,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:L,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>z(R),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>ee(R),children:"Borrar"})]})})})]},R.id)})})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w})]})}const Td=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function V4e(t){var e;return t!=null&&t.date?t.date:(e=t==null?void 0:t.createdAt)!=null&&e.toDate?Nr(t.createdAt.toDate(),"yyyy-MM-dd"):""}function H4e(t,e){const r=V4e(t);if(!r)return null;const n=t.item||{},a=Number((n==null?void 0:n.qty)??t.quantity??0)||0,s=Number((n==null?void 0:n.total)??t.total??0)||0,o=Number((n==null?void 0:n.unitPrice)??(a>0?s/a:0))||0;return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total||0),quantity:Number(t.quantity||a||0),customerId:t.customerId||void 0,customerName:t.customerName||void 0,downPayment:Number(t.downPayment||0),item:{productId:String((n==null?void 0:n.productId)||t.productId||""),productName:String((n==null?void 0:n.productName)||t.productName||""),sku:(n==null?void 0:n.sku)||t.sku||"",qty:a,unitPrice:o,total:a*o}}}async function $4e(t,e){if(e<=0)return;const r=er(_t(Fe,"inventory_clothes_batches"),cr("productId","==",t)),n=await Qt(r),a=[];n.forEach(o=>{const l=o.data();a.push({id:o.id,productId:l.productId,date:l.date||"",quantity:Number(l.quantity||0),remaining:Number(l.remaining||0)})}),a.sort((o,l)=>o.date.localeCompare(l.date));let s=e;for(const o of a){if(s<=0)break;if(o.remaining<=0)continue;const l=Math.min(o.remaining,s);s-=l,await pn(Yt(Fe,"inventory_clothes_batches",o.id),{remaining:Math.max(0,Number((o.remaining-l).toFixed(0)))})}s>0&&console.warn("consumeFIFO: falt inventario",s)}async function G4e(t,e){if(e<=0)return;const r=er(_t(Fe,"inventory_clothes_batches"),cr("productId","==",t)),n=await Qt(r),a=[];n.forEach(o=>{const l=o.data();a.push({id:o.id,productId:l.productId,date:l.date||"",quantity:Number(l.quantity||0),remaining:Number(l.remaining||0)})}),a.sort((o,l)=>o.date.localeCompare(l.date));let s=e;for(const o of a){if(s<=0)break;const l=Math.max(0,o.quantity-o.remaining);if(l<=0)continue;const c=Math.min(l,s);s-=c,await pn(Yt(Fe,"inventory_clothes_batches",o.id),{remaining:Number((o.remaining+c).toFixed(0))})}s>0&&console.warn("restoreFIFO: no se devolvi todo",s)}async function Vre(t){const e=er(_t(Fe,"ar_movements"),cr("ref.saleId","==",t)),r=await Qt(e);await Promise.all(r.docs.map(n=>Fn(Yt(Fe,"ar_movements",n.id))))}async function K4e(t,e,r){if(await Vre(t.id),t.type!=="CREDITO"||!t.customerId)return;const n={customerId:t.customerId,date:t.date,createdAt:dr.now(),ref:{saleId:t.id}},{addDoc:a}=await Kh(async()=>{const{addDoc:o}=await Promise.resolve().then(()=>Bye);return{addDoc:o}},void 0);await a(_t(Fe,"ar_movements"),{...n,type:"CARGO",amount:Number(e)||0});const s=Math.max(0,Number(r??t.downPayment??0));s>0&&await a(_t(Fe,"ar_movements"),{...n,type:"ABONO",amount:-s})}function q4e(){const[t,e]=x.useState(!1),[r,n]=x.useState(!1),[a,s]=x.useState(null),[o,l]=x.useState([]),c=async se=>{e(!0),n(!0),s(se),l([]);try{const Pe=(await Qt(er(_t(Fe,"sales_clothes"),cr("__name__","==",se)))).docs[0],ue=Pe==null?void 0:Pe.data(),Me=(Array.isArray(ue==null?void 0:ue.items)?ue.items:ue!=null&&ue.item?[ue.item]:[]).map(ze=>({productName:String(ze.productName||""),qty:Number(ze.qty||0),unitPrice:Number(ze.unitPrice||0),discount:Number(ze.discount||0),total:Number(ze.total||0)}));l(Me)}catch(re){console.error(re)}finally{n(!1)}},[u,d]=x.useState(Nr(new Date,"yyyy-MM-01")),[f,A]=x.useState(Nr(new Date,"yyyy-MM-dd")),[h,m]=x.useState([]),[p,g]=x.useState([]),[v,y]=x.useState(!0),[b,w]=x.useState(""),[j,I]=x.useState(""),[_,S]=x.useState(""),[E,F]=x.useState(null),[k,P]=x.useState(!1),[D,X]=x.useState(null),[pe,ge]=x.useState(0),fe=15,[xe,ae]=x.useState(1),Se=x.useMemo(()=>{const se={};return h.forEach(re=>se[re.id]=re.name),se},[h]);x.useEffect(()=>{(async()=>{y(!0),w("");try{const se=await Qt(_t(Fe,"customers_clothes")),re=[];se.forEach(we=>re.push({id:we.id,name:we.data().name||""})),m(re);const Pe=await Qt(er(_t(Fe,"sales_clothes"),dn("createdAt","desc"))),ue=[];Pe.forEach(we=>{const Me=H4e(we.data(),we.id);Me&&Me.date>=u&&Me.date<=f&&ue.push(Me)}),g(ue.sort((we,Me)=>Me.date.localeCompare(we.date))),ae(1)}catch(se){console.error(se),w(" Error cargando transacciones.")}finally{y(!1)}})()},[u,f]);const Te=x.useMemo(()=>p.filter(se=>!(j&&se.customerId!==j||_&&se.type!==_)),[p,j,_]),O=x.useMemo(()=>{let se=0,re=0,Pe=0,ue=0;for(const we of Te)we.type==="CONTADO"?(se+=we.item.qty,Pe+=we.total):(re+=we.item.qty,ue+=we.total);return{piezasCash:se,piezasCredito:re,montoCash:Pe,montoCredito:ue}},[Te]),G=Math.max(1,Math.ceil(Te.length/fe)),z=x.useMemo(()=>{const se=(xe-1)*fe;return Te.slice(se,se+fe)},[Te,xe]),L=se=>{F(null),X(se),ge(se.item.qty||0),P(!0)},Z=async se=>{if(F(null),!!window.confirm("Eliminar esta venta? Esta accin no se puede deshacer."))try{y(!0),await Fk(se.id),await Vre(se.id),g(re=>re.filter(Pe=>Pe.id!==se.id)),w(" Venta eliminada")}catch(re){console.error(re),w(" No se pudo eliminar la venta.")}finally{y(!1)}},ee=async()=>{if(!D)return;const se=Number(D.item.qty||0),re=Math.max(1,Math.floor(Number(pe)||0));if(re===se){P(!1);return}const Pe=Number(D.item.unitPrice||0),ue=Number((Pe*re).toFixed(2));try{y(!0);const we=re-se;we>0?await $4e(D.item.productId,we):we<0&&await G4e(D.item.productId,-we);const Me=Yt(Fe,"sales_clothes",D.id);await pn(Me,{quantity:re,total:ue,itemsTotal:ue,"item.qty":re,"item.total":ue,updatedAt:dr.now()});const ze=Math.min(Number(D.downPayment||0),ue);await K4e(D,ue,ze),g(yt=>yt.map(It=>It.id===D.id?{...It,quantity:re,total:ue,item:{...It.item,qty:re,total:ue},downPayment:ze}:It)),w(" Venta actualizada"),P(!1)}catch(we){console.error(we),w(" No se pudo actualizar la venta.")}finally{y(!1)}},R=()=>{const se=`Reporte de transacciones (Ropa)  ${u} a ${f}`,re=Me=>(Me||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Pe=Te.map(Me=>{const ze=Me.customerName||(Me.customerId?Se[Me.customerId]:"")||"Nombre cliente";return`<tr>
          <td>${Me.date}</td>
          <td>${re(ze)}</td>
          <td>${Me.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${Me.item.qty}</td>
          <td style="text-align:right">${Td(Me.total)}</td>
        </tr>`}).join(""),ue=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${re(se)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${re(se)}</h1>
      <div class="kpis">
        <div><b>Piezas Cash:</b> ${O.piezasCash}</div>
        <div><b>Piezas Crdito:</b> ${O.piezasCredito}</div>
        <div><b>Monto Cash:</b> ${Td(O.montoCash)}</div>
        <div><b>Monto Crdito:</b> ${Td(O.montoCredito)}</div>
      </div>
      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Piezas</th><th>Monto</th>
      </tr></thead><tbody>
      ${Pe||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,we=window.open("","_blank");we&&(we.document.open(),we.document.write(ue),we.document.close())},H=()=>ae(1),ne=()=>ae(se=>Math.max(1,se-1)),ve=()=>ae(se=>Math.min(G,se+1)),U=()=>ae(G),He=()=>{const se=[];if(G<=7)for(let Pe=1;Pe<=G;Pe++)se.push(Pe);else{const Pe=Math.max(1,xe-2),ue=Math.min(G,xe+2);se.push(1),Pe>2&&se.push(-1);for(let we=Pe;we<=ue;we++)we!==1&&we!==G&&se.push(we);ue<G-1&&se.push(-2),se.push(G)}return i.jsxs("div",{className:"flex items-center gap-1 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:H,disabled:xe===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:ne,disabled:xe===1,children:" Anterior"}),se.map((Pe,ue)=>typeof Pe=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${Pe===xe?"bg-blue-600 text-white":""}`,onClick:()=>ae(Pe),children:Pe},ue):i.jsx("span",{className:"px-2",children:""},ue)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:ve,disabled:xe===G,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:U,disabled:xe===G,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",xe," de ",G,"  ",Te.length," transaccin(es)"]})]})};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Reporte de transacciones (Ropa)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:se=>{d(se.target.value),ae(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:f,onChange:se=>{A(se.target.value),ae(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 min-w-[220px]",value:j,onChange:se=>{I(se.target.value),ae(1)},children:[i.jsx("option",{value:"",children:"Todos"}),h.map(se=>i.jsx("option",{value:se.id,children:se.name},se.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:_,onChange:se=>{S(se.target.value),ae(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsx("button",{className:"ml-auto px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:R,children:"Exportar PDF"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Piezas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:O.piezasCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Piezas Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:O.piezasCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Td(O.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:Td(O.montoCredito)})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Piezas"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:v?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Cargando"})}):z.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Sin transacciones en el rango."})}):z.map(se=>{const re=se.customerName||(se.customerId?Se[se.customerId]:"")||"Nombre cliente";return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:se.date}),i.jsx("td",{className:"p-2 border",children:re}),i.jsx("td",{className:"p-2 border",children:se.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver piezas de esta transaccin",onClick:()=>c(se.id),children:se.item.qty})}),i.jsx("td",{className:"p-2 border",children:Td(se.total)}),i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>F(Pe=>Pe===se.id?null:se.id),title:"Acciones",children:""}),E===se.id&&i.jsxs("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:[i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>L(se),children:"Editar"}),i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>Z(se),children:"Eliminar"})]})]})]},se.id)})})]}),He()]}),b&&i.jsx("p",{className:"mt-2 text-sm",children:b}),k&&D&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-md p-4",children:[i.jsx("h3",{className:"text-lg font-bold mb-2",children:"Editar venta"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Producto"}),i.jsxs("div",{className:"font-semibold",children:[D.item.productName," ",D.item.sku?` ${D.item.sku}`:""]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad (piezas)"}),i.jsx("input",{type:"number",step:"1",min:1,className:"w-full border p-2 rounded",value:pe,onChange:se=>ge(Math.max(1,Math.floor(Number(se.target.value||0))))})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"P. Unit"}),i.jsx("div",{className:"text-lg font-semibold",children:Td(D.item.unitPrice)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Nuevo total"}),i.jsx("div",{className:"text-lg font-semibold",children:Td(Number(D.item.unitPrice)*Number(pe||0))})]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{P(!1),X(null)},children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:ee,children:"Guardar cambios"})]})]})}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Piezas vendidas"," ",a?` #${a}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>e(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):o.map((se,re)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:se.productName}),i.jsx("td",{className:"p-2 border text-right",children:se.qty}),i.jsx("td",{className:"p-2 border text-right",children:Td(se.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Td(se.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Td(se.total)})]},re))})]})})]})})]})}const WV=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],tu=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function RC(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function XV(t){const e=er(_t(Fe,"ar_movements_pollo"),cr("ref.saleId","==",t)),r=await Qt(e);await Promise.all(r.docs.map(n=>Fn(Yt(Fe,"ar_movements_pollo",n.id))))}function z4e({role:t="",roles:e,sellerPolloId:r="",currentUserEmail:n}){const a=e&&e.length?e:t,s=String(r||"").trim(),o=sn(a,"vendedor_pollo"),l=sn(a,"admin"),[c,u]=x.useState([]),[d,f]=x.useState(!1),[A,h]=x.useState(""),[m,p]=x.useState(""),[g,v]=x.useState(""),[y,b]=x.useState(""),[w,j]=x.useState(!1),[I,_]=x.useState(!1),[S,E]=x.useState(null),[F,k]=x.useState([]),P=async ft=>{var lr;j(!0),_(!0),E(ft),k([]);try{const Le=await Bs(Yt(Fe,"salesV2",ft));let tt=null;if(Le.exists()?tt=Le.data():tt=(lr=(await Qt(er(_t(Fe,"salesV2"),cr("name","==",ft)))).docs[0])==null?void 0:lr.data(),!tt){k([]);return}let Nt=[];if(Array.isArray(tt.items)&&tt.items.length>0)Nt=tt.items;else if(tt.items&&typeof tt.items=="object")try{Nt=Object.values(tt.items)}catch{Nt=[]}else tt.item?Nt=[tt.item]:Array.isArray(tt.products)&&tt.products.length>0?Nt=tt.products:Array.isArray(tt.lines)&&tt.lines.length>0?Nt=tt.lines:Array.isArray(tt.detalles)&&tt.detalles.length>0?Nt=tt.detalles:(tt.productName||tt.product)&&(Nt=[{productName:tt.productName||tt.product||"",qty:tt.qty??tt.quantity??tt.lbs??0,unitPrice:tt.unitPrice??tt.price??0,discount:tt.discount??0,total:tt.total??tt.amount??0}]);const Et=Lt=>{if(Lt==null)return NaN;if(typeof Lt=="number")return Lt;let Wt=String(Lt).trim();if(!Wt)return NaN;if(Wt=Wt.replace(/[^0-9.,-]/g,""),!Wt)return NaN;Wt.indexOf(".")>-1&&Wt.indexOf(",")>-1?Wt=Wt.replace(/,/g,""):Wt.indexOf(",")>-1&&Wt.indexOf(".")===-1&&(Wt=Wt.replace(/,/g,"."));const Tr=Number(Wt);return Number.isNaN(Tr)?NaN:Tr},gt=new Set;for(const Lt of Nt)if(Array.isArray(Lt==null?void 0:Lt.allocations))for(const Wt of Lt.allocations){const Tr=String((Wt==null?void 0:Wt.batchId)||"").trim();Tr&&gt.add(Tr)}else if(Lt!=null&&Lt.allocations&&typeof Lt.allocations=="object")try{for(const Wt of Object.values(Lt.allocations)){const Tr=String((Wt==null?void 0:Wt.batchId)||"").trim();Tr&&gt.add(Tr)}}catch{}if(Array.isArray(tt==null?void 0:tt.allocations))for(const Lt of tt.allocations){const Wt=String((Lt==null?void 0:Lt.batchId)||"").trim();Wt&&gt.add(Wt)}const ut={};gt.size>0&&await Promise.all(Array.from(gt).map(async Lt=>{try{const Wt=await Bs(Yt(Fe,"inventory_batches",Lt));if(Wt.exists()){const Tr=Wt.data();ut[Lt]=Number(Tr.salePrice??Tr.sale_price??Tr.price??0)}}catch{}}));const Mt=new Set;for(const Lt of Nt){const Wt=String(Lt.productId||"").trim();Wt&&Mt.add(Wt)}const Rt={};Mt.size>0&&await Promise.all(Array.from(Mt).map(async Lt=>{try{const Wt=await Bs(Yt(Fe,"products",Lt));if(Wt.exists()){const Tr=Wt.data();Rt[Lt]=Number(Tr.salePrice??Tr.price??0)}}catch{}}));const Jt=Nt.map(Lt=>{const Wt=String(Lt.productName||Lt.product||Lt.name||"(sin nombre)"),Tr=Number(Lt.qty??Lt.quantity??Lt.lbs??Lt.weight??0)||0,Ur=Et(Lt.total??Lt.lineFinal??Lt.amount??Lt.monto??Lt.line_total)||0;let on=0;const Nn=[Lt.unitPrice,Lt.unitPricePackage,Lt.salePrice,Lt.sale_price,Lt.price,Lt.unit_price,Lt.pricePerUnit,Lt.price_per_unit];for(const jn of Nn){const Un=Et(jn);if(!Number.isNaN(Un)&&Un!==0){on=Un;break}}if(!on){const jn=(tt==null?void 0:tt.salePrice)??(tt==null?void 0:tt.sale_price)??(tt==null?void 0:tt.unitPrice)??(tt==null?void 0:tt.unit_price)??(tt==null?void 0:tt.price)??(tt==null?void 0:tt.pricePerUnit),Un=Et(jn);!Number.isNaN(Un)&&Un!==0&&(on=Un)}if(!on){const jn=Array.isArray(Lt.allocations)?Lt.allocations[0]:Lt.allocations&&typeof Lt.allocations=="object"?Object.values(Lt.allocations)[0]:null,Un=jn?String(jn.batchId||"").trim():"";Un&&ut[Un]&&(on=ut[Un]||0)}!on&&Lt.productId&&(on=Rt[String(Lt.productId)]||0),(!on||on===0)&&Ur>0&&Tr>0&&(on=Ur/Tr);const la=Et(Lt.discount??Lt.desc??0)||0;let Kn=Ur;return(!Kn||Kn===0)&&(Kn=Number(on*Tr||0)),Kn=Number(Kn)||0,{productName:Wt,qty:Tr,unitPrice:on,discount:la,total:Kn}});k(Jt)}catch(Le){console.error(Le)}finally{_(!1)}},[D,X]=x.useState(""),[pe,ge]=x.useState("+505 "),[fe,xe]=x.useState(""),[ae,Se]=x.useState(""),[Te,O]=x.useState("ACTIVO"),[G,z]=x.useState(0),[L,Z]=x.useState(""),[ee,R]=x.useState(0),[H,ne]=x.useState([]),[ve,U]=x.useState(!0),[He,se]=x.useState(""),[re,Pe]=x.useState(null),[ue,we]=x.useState(""),[Me,ze]=x.useState("+505 "),[yt,It]=x.useState(""),[Ke,wt]=x.useState(""),[At,bt]=x.useState("ACTIVO"),[ke,Ne]=x.useState(0),[Ve,he]=x.useState(""),[le,Be]=x.useState(!1),[je,Ae]=x.useState(null),[Qe,Ct]=x.useState(!1),[pt,me]=x.useState([]),[te,ie]=x.useState({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),[$e,de]=x.useState(!1),[Ce,nt]=x.useState(0),[vt,ht]=x.useState(new Date().toISOString().slice(0,10)),[xt,Xe]=x.useState(""),[be,st]=x.useState(!1),[K,Ie]=x.useState(null),[Ze,at]=x.useState(""),[it,T]=x.useState(0),[M,V]=x.useState(""),[q,Y]=x.useState(!1),[oe,De]=x.useState(null),[We,dt]=x.useState(!1),[Oe,et]=x.useState(!1),[mt,Tt]=x.useState(null);x.useEffect(()=>{(async()=>{try{if(U(!0),o&&!s){ne([]),se(" Este usuario no tiene vendedor asociado (sellerPolloId vaco).");return}const ft=await Qt(_t(Fe,"sellers_candies")),lr=[];ft.forEach(Et=>{const gt=Et.data();lr.push({id:Et.id,name:String(gt.name||"")})}),u(lr);const Le=o?er(_t(Fe,"customers_pollo"),cr("vendorId","==",s),dn("createdAt","desc")):er(_t(Fe,"customers_pollo"),dn("createdAt","desc")),tt=await Qt(Le),Nt=[];tt.forEach(Et=>{const gt=Et.data();Nt.push({id:Et.id,name:gt.name??"",phone:gt.phone??"+505 ",place:gt.place??"",notes:gt.notes??"",status:gt.status??"ACTIVO",creditLimit:Number(gt.creditLimit??0),createdAt:gt.createdAt??dr.now(),balance:0,vendorId:gt.vendorId||"",vendorName:gt.vendorName||"",initialDebt:Number(gt.initialDebt||0),lastAbonoDate:"",lastAbonoAmount:0})});for(const Et of Nt)try{const gt=er(_t(Fe,"ar_movements_pollo"),cr("customerId","==",Et.id)),ut=await Qt(gt);let Mt=0,Rt=null;ut.forEach(Lt=>{var Ur,on,Nn;const Wt=Lt.data(),Tr=Number(Wt.amount||0);if(Mt+=Tr,Tr<0){const la=Wt.date??((on=(Ur=Wt.createdAt)==null?void 0:Ur.toDate)!=null&&on.call(Ur)?Wt.createdAt.toDate().toISOString().slice(0,10):""),Kn=(Nn=Wt.createdAt)!=null&&Nn.seconds?Number(Wt.createdAt.seconds):0;(!Rt||Kn>=Rt.ts)&&(Rt={date:la,amount:Math.abs(Tr),ts:Kn})}});const Jt=Number(Et.initialDebt||0);Et.balance=Jt+Mt,Rt?(Et.lastAbonoDate=Rt==null?void 0:Rt.date,Et.lastAbonoAmount=Rt==null?void 0:Rt.amount):(Et.lastAbonoDate="",Et.lastAbonoAmount=0)}catch{Et.balance=Number(Et.initialDebt||0),Et.lastAbonoDate="",Et.lastAbonoAmount=0}ne(Nt)}catch(ft){console.error(ft),se(" Error cargando clientes.")}finally{U(!1)}})()},[o,s]);const Pt=()=>{X(""),ge("+505 "),xe(""),Se(""),O("ACTIVO"),z(0),Z(""),R(0)},Ft=async ft=>{var Nt;if(ft.preventDefault(),se(""),!D.trim()){se("Ingresa el nombre.");return}const lr=RC(pe);if(lr.length<6){se("Telfono incompleto.");return}const Le=o?s:String(L||""),tt=Le&&((Nt=c.find(Et=>Et.id===Le))==null?void 0:Nt.name)||"";try{const Et=Number(ee||0),gt=await On(_t(Fe,"customers_pollo"),{name:D.trim(),phone:lr,place:fe||"",notes:ae||"",status:Te,creditLimit:Number(G||0),vendorId:Le,vendorName:tt,initialDebt:Et,createdAt:dr.now()});ne(ut=>[{id:gt.id,name:D.trim(),phone:lr,place:fe||"",notes:ae||"",status:Te,creditLimit:Number(G||0),vendorId:Le,vendorName:tt,initialDebt:Et,createdAt:dr.now(),balance:Et,lastAbonoDate:"",lastAbonoAmount:0},...ut]),Pt(),Y(!1),se(" Cliente creado")}catch(Et){console.error(Et),se(" Error al crear cliente")}},Xt=ft=>{if(o){se(" No permitido: vendedores no editan clientes desde el listado.");return}Pe(ft.id),we(ft.name),ze(ft.phone||"+505 "),It(ft.place||""),wt(ft.notes||""),bt(ft.status||"ACTIVO"),Ne(Number(ft.creditLimit||0)),he(String(ft.vendorId||""))},mr=()=>{Pe(null),we(""),ze("+505 "),It(""),wt(""),bt("ACTIVO"),Ne(0),he("")},Yr=async()=>{var gt;if(o){se(" No permitido.");return}if(!re)return;const ft=RC(Me);if(!ue.trim()){se("Ingresa el nombre.");return}const lr=H.find(ut=>ut.id===re),Le=String((lr==null?void 0:lr.vendorId)||""),tt=o?s:String(Ve||"");if(o&&Le&&Le!==s){se(" Este cliente pertenece a otro vendedor.");return}if(l&&Le&&tt&&Le!==tt){se(" Este cliente ya est asociado a otro vendedor. Primero desasocia (deja vendedor en ) y guarda; luego lo puedes asignar.");return}const Nt=o?s:String(Ve||""),Et=Nt&&((gt=c.find(ut=>ut.id===Nt))==null?void 0:gt.name)||"";try{await pn(Yt(Fe,"customers_pollo",re),{name:ue.trim(),phone:ft,place:yt||"",notes:Ke||"",status:At,creditLimit:Number(ke||0),vendorId:Nt,vendorName:Et}),ne(ut=>ut.map(Mt=>Mt.id===re?{...Mt,name:ue.trim(),phone:ft,place:yt||"",notes:Ke||"",status:At,creditLimit:Number(ke||0),vendorId:Nt,vendorName:Et}:Mt)),mr(),se(" Cliente actualizado")}catch(ut){console.error(ut),se(" Error al actualizar")}},Br=async ft=>{if(confirm(`Eliminar al cliente "${ft.name}"?
Se borrarn todas sus ventas y movimientos.`))try{U(!0);const Le=er(_t(Fe,"salesV2"),cr("customerId","==",ft.id)),tt=await Qt(Le);for(const gt of tt.docs){const ut=gt.id;try{await Fn(Yt(Fe,"salesV2",ut))}catch(Mt){console.warn("delete sale error",Mt)}await XV(ut)}const Nt=er(_t(Fe,"ar_movements_pollo"),cr("customerId","==",ft.id)),Et=await Qt(Nt);await Promise.all(Et.docs.map(gt=>Fn(Yt(Fe,"ar_movements_pollo",gt.id)))),await Fn(Yt(Fe,"customers_pollo",ft.id)),ne(gt=>gt.filter(ut=>ut.id!==ft.id)),se(" Cliente eliminado y registros borrados")}catch(Le){console.error(Le),se(" No se pudo eliminar el cliente.")}finally{U(!1)}},Fr=(ft,lr)=>{const Le=ft.reduce((gt,ut)=>gt+(Number(ut.amount)||0),0),tt=ft.filter(gt=>Number(gt.amount)<0).reduce((gt,ut)=>gt+Math.abs(Number(ut.amount)||0),0),Nt=ft.filter(gt=>Number(gt.amount)>0).reduce((gt,ut)=>gt+(Number(ut.amount)||0),0),Et=Number(lr||0)+Le;ie({saldoActual:Et,totalAbonado:tt,totalCargos:Number(lr||0)+Nt,saldoRestante:Et})},vn=async ft=>{Ae(ft),me([]),ie({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),Be(!0),dt(!1),et(!1),Tt(null),de(!1),nt(0),ht(new Date().toISOString().slice(0,10)),Xe(""),Ie(null),Ct(!0);try{const lr=er(_t(Fe,"ar_movements_pollo"),cr("customerId","==",ft.id)),Le=await Qt(lr),tt=[];Le.forEach(Nt=>{var Mt,Rt;const Et=Nt.data(),gt=Et.date??((Rt=(Mt=Et.createdAt)==null?void 0:Mt.toDate)!=null&&Rt.call(Mt)?Et.createdAt.toDate().toISOString().slice(0,10):""),ut=Number(Et.amount||0);tt.push({id:Nt.id,date:gt,type:Et.type??(ut<0?"ABONO":"CARGO"),amount:ut,ref:Et.ref||{},comment:Et.comment||"",createdAt:Et.createdAt})}),tt.sort((Nt,Et)=>{var Mt,Rt;if(Nt.date!==Et.date)return Nt.date.localeCompare(Et.date);const gt=((Mt=Nt.createdAt)==null?void 0:Mt.seconds)||0,ut=((Rt=Et.createdAt)==null?void 0:Rt.seconds)||0;return gt-ut}),me(tt),Fr(tt,Number(ft.initialDebt||0))}catch(lr){console.error(lr),se(" No se pudo cargar el estado de cuenta")}finally{Ct(!1)}},Ln=ft=>{const lr=ft.filter(Le=>Number(Le.amount)<0).map(Le=>{var tt;return{date:Le.date,amount:Math.abs(Number(Le.amount||0)),ts:((tt=Le.createdAt)==null?void 0:tt.seconds)||0}}).sort((Le,tt)=>(Le.ts||0)-(tt.ts||0));return lr.length?lr[lr.length-1]:null},yn=async()=>{if(!je)return;se("");const ft=Number(Ce||0);if(!(ft>0)){se("Ingresa un monto de abono mayor a 0.");return}const lr=parseFloat(ft.toFixed(2));if(!vt){se("Selecciona la fecha del abono.");return}try{st(!0);const Le={customerId:je.id,type:"ABONO",amount:-lr,date:vt,comment:xt||"",createdAt:dr.now()},Nt={id:(await On(_t(Fe,"ar_movements_pollo"),Le)).id,date:vt,type:"ABONO",amount:-lr,comment:xt||"",createdAt:dr.now()},Et=[...pt,Nt].sort((gt,ut)=>{var Jt,Lt;if(gt.date!==ut.date)return gt.date.localeCompare(ut.date);const Mt=((Jt=gt.createdAt)==null?void 0:Jt.seconds)||0,Rt=((Lt=ut.createdAt)==null?void 0:Lt.seconds)||0;return Mt-Rt});me(Et),Fr(Et,Number(je.initialDebt||0)),ne(gt=>gt.map(ut=>{if(ut.id!==je.id)return ut;const Mt=(ut.balance||0)-lr;return{...ut,balance:Mt,lastAbonoDate:vt,lastAbonoAmount:lr}})),Ae(gt=>gt&&{...gt,balance:(gt.balance||0)-lr,lastAbonoDate:vt,lastAbonoAmount:lr}),nt(0),Xe(""),ht(new Date().toISOString().slice(0,10)),de(!1),se(" Abono registrado")}catch(Le){console.error(Le),se(" Error al registrar el abono")}finally{st(!1)}},In=ft=>{Ie(ft.id),at(ft.date||new Date().toISOString().slice(0,10)),T(Math.abs(Number(ft.amount||0))),V(ft.comment||"")},Ua=()=>{Ie(null),at(""),T(0),V("")},Je=async()=>{if(!K||!je)return;const ft=pt.findIndex(Nt=>Nt.id===K);if(ft===-1)return;const lr=pt[ft],Le=Number(it||0);if(!(Le>0)){se("El monto debe ser mayor a 0.");return}const tt=lr.type==="ABONO"?-parseFloat(Le.toFixed(2)):+parseFloat(Le.toFixed(2));try{await pn(Yt(Fe,"ar_movements_pollo",K),{date:Ze,amount:tt,comment:M||""});const Nt=[...pt];Nt[ft]={...lr,date:Ze,amount:tt,comment:M||""},Nt.sort((Mt,Rt)=>{var Wt,Tr;if(Mt.date!==Rt.date)return Mt.date.localeCompare(Rt.date);const Jt=((Wt=Mt.createdAt)==null?void 0:Wt.seconds)||0,Lt=((Tr=Rt.createdAt)==null?void 0:Tr.seconds)||0;return Jt-Lt}),me(Nt),Fr(Nt,Number(je.initialDebt||0));const Et=Nt.reduce((Mt,Rt)=>Mt+(Number(Rt.amount)||0),0),gt=Number(je.initialDebt||0)+Et,ut=Ln(Nt);ne(Mt=>Mt.map(Rt=>Rt.id===je.id?{...Rt,balance:gt,lastAbonoDate:(ut==null?void 0:ut.date)||"",lastAbonoAmount:(ut==null?void 0:ut.amount)||0}:Rt)),Ae(Mt=>Mt&&{...Mt,balance:gt,lastAbonoDate:(ut==null?void 0:ut.date)||"",lastAbonoAmount:(ut==null?void 0:ut.amount)||0}),Ua(),se(" Movimiento actualizado")}catch(Nt){console.error(Nt),se(" Error al actualizar movimiento")}},Ot=async ft=>{var Le,tt;if(confirm(`Eliminar este movimiento (${ft.type==="ABONO"?"Abono":"Compra"}) del ${ft.date}?${ft.type==="CARGO"&&((Le=ft.ref)!=null&&Le.saleId)?`
Se borrarn los registros de esa venta.`:""}`)&&je)try{if(U(!0),ft.type==="CARGO"&&((tt=ft.ref)!=null&&tt.saleId)){try{await Fn(Yt(Fe,"salesV2",ft.ref.saleId))}catch(Mt){console.warn("delete sale error",Mt),U(!1),se(" No se pudo borrar la venta asociada.");return}await XV(ft.ref.saleId)}else await Fn(Yt(Fe,"ar_movements_pollo",ft.id));const Nt=pt.filter(Mt=>{var Rt,Jt;return ft.type==="CARGO"&&((Rt=ft.ref)!=null&&Rt.saleId)?((Jt=Mt.ref)==null?void 0:Jt.saleId)!==ft.ref.saleId:Mt.id!==ft.id});me(Nt),Fr(Nt,Number(je.initialDebt||0));const Et=Nt.reduce((Mt,Rt)=>Mt+(Number(Rt.amount)||0),0),gt=Number(je.initialDebt||0)+Et,ut=Ln(Nt);ne(Mt=>Mt.map(Rt=>Rt.id===je.id?{...Rt,balance:gt,lastAbonoDate:(ut==null?void 0:ut.date)||"",lastAbonoAmount:(ut==null?void 0:ut.amount)||0}:Rt)),Ae(Mt=>Mt&&{...Mt,balance:gt,lastAbonoDate:(ut==null?void 0:ut.date)||"",lastAbonoAmount:(ut==null?void 0:ut.amount)||0}),Tt(null),se(" Movimiento eliminado")}catch(Nt){console.error(Nt),se(" Error al eliminar movimiento")}finally{U(!1)}},Kt=x.useMemo(()=>[...H].sort((ft,lr)=>{var Le,tt;return ft.status!==lr.status?ft.status==="BLOQUEADO"?1:-1:(((Le=lr.createdAt)==null?void 0:Le.seconds)||0)-(((tt=ft.createdAt)==null?void 0:tt.seconds)||0)}),[H]),ar=ft=>ft==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700",Ar=x.useMemo(()=>{const ft=A.trim().toLowerCase(),lr=g.trim()===""?null:Number(g),Le=y.trim()===""?null:Number(y);return Kt.filter(tt=>{const Nt=!ft||String(tt.name||"").toLowerCase().includes(ft),Et=!m||tt.status===m,gt=Number(tt.balance||0),ut=lr===null||!Number.isNaN(lr)&&gt>=lr,Mt=Le===null||!Number.isNaN(Le)&&gt<=Le;return Nt&&Et&&ut&&Mt})},[Kt,A,m,g,y]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Pollo)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>{Y(!0),o&&Z(s)},type:"button",children:"Crear Cliente"})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:ve?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Cargando"})}):Ar.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Sin clientes"})}):Ar.map(ft=>{var Le;const lr=re===ft.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(Le=ft.createdAt)!=null&&Le.toDate?ft.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border text-left",children:lr?i.jsx("input",{className:"w-full border p-1 rounded",value:ue,onChange:tt=>we(tt.target.value)}):i.jsx("div",{className:"font-medium",children:ft.name})}),i.jsx("td",{className:"p-2 border",children:lr?i.jsx("input",{className:"w-full border p-1 rounded",value:Me,onChange:tt=>ze(RC(tt.target.value))}):ft.phone}),i.jsx("td",{className:"p-2 border",children:lr?i.jsxs("select",{className:"w-full border p-1 rounded text-xs",value:o?s:Ve,onChange:tt=>he(tt.target.value),disabled:o,title:"Vendedor asociado",children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(tt=>i.jsx("option",{value:tt.id,children:tt.name},tt.id))]}):ft.vendorName||""}),i.jsx("td",{className:"p-2 border",children:lr?i.jsxs("select",{className:"w-full border p-1 rounded",value:yt,onChange:tt=>It(tt.target.value),children:[i.jsx("option",{value:"",children:""}),WV.map(tt=>i.jsx("option",{value:tt,children:tt},tt))]}):ft.place||""}),i.jsx("td",{className:"p-2 border",children:lr?i.jsxs("select",{className:"w-full border p-1 rounded",value:At,onChange:tt=>bt(tt.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ar(ft.status)}`,children:ft.status})}),i.jsx("td",{className:"p-2 border",children:lr?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(ke)?"":ke,onChange:tt=>Ne(Math.max(0,Number(tt.target.value||0)))}):tu(ft.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:tu(ft.balance||0)}),i.jsx("td",{className:"p-2 border",children:lr?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:Ke,onChange:tt=>wt(tt.target.value),maxLength:500}):i.jsx("span",{title:ft.notes||"",children:(ft.notes||"").length>40?(ft.notes||"").slice(0,40)+"":ft.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:lr?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Yr,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:mr,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Xt(ft),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>Br(ft),disabled:!l,title:l?"Borrar":"Solo admin",children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>vn(ft),children:"Estado de cuenta"})]})})})]},ft.id)})})]})}),i.jsx("div",{className:"md:hidden space-y-2",children:ve?i.jsx("div",{className:"p-4 text-center text-sm text-gray-600",children:"Cargando"}):Ar.length===0?i.jsx("div",{className:"p-4 text-center text-sm text-gray-600",children:"Sin clientes"}):Ar.map(ft=>i.jsxs("div",{className:"border rounded-lg bg-white p-3 shadow-sm",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-base",children:ft.name}),i.jsx("div",{className:"text-xs text-gray-600",children:ft.phone||""}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Vendedor:"," ",i.jsx("span",{className:"font-medium",children:ft.vendorName||""})]})]}),i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ar(ft.status)}`,children:ft.status})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"border rounded p-2 bg-gray-50",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Saldo"}),i.jsx("div",{className:"font-semibold",children:tu(ft.balance||0)})]}),i.jsxs("div",{className:"border rounded p-2 bg-gray-50",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Lmite"}),i.jsx("div",{className:"font-semibold",children:tu(ft.creditLimit||0)})]})]}),i.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["ltimo abono:"," ",i.jsx("span",{className:"font-medium",children:ft.lastAbonoDate?`${ft.lastAbonoDate} (${tu(ft.lastAbonoAmount||0)})`:""})]}),ft.notes?i.jsxs("div",{className:"mt-2 text-xs text-gray-700",children:[i.jsx("span",{className:"font-semibold",children:"Nota:"})," ",(ft.notes||"").length>80?(ft.notes||"").slice(0,80)+"":ft.notes]}):null,i.jsxs("div",{className:"mt-3 flex gap-2 flex-wrap",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-indigo-600 text-white text-sm",onClick:()=>vn(ft),children:"Estado de cuenta"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-yellow-600 text-white text-sm",onClick:()=>Xt(ft),disabled:o,title:o?"Vendedor no edita":"Editar",children:"Editar"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-red-600 text-white text-sm disabled:opacity-50",onClick:()=>Br(ft),disabled:!l,title:l?"Borrar":"Solo admin",children:"Borrar"})]})]},ft.id))})]}),He&&i.jsx("p",{className:"mt-2 text-sm",children:He}),q&&pu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Y(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Y(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:Ft,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:D,onChange:ft=>X(ft.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:pe,onChange:ft=>ge(RC(ft.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:fe,onChange:ft=>xe(ft.target.value),children:[i.jsx("option",{value:"",children:""}),WV.map(ft=>i.jsx("option",{value:ft,children:ft},ft))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:Te,onChange:ft=>O(ft.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor asociado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o?s:L,onChange:ft=>Z(ft.target.value),disabled:o,children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(ft=>i.jsx("option",{value:ft.id,children:ft.name},ft.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Deuda inicial"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ee===0?"":ee,onChange:ft=>R(Math.max(0,Number(ft.target.value||0))),placeholder:"Ej: 1500"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este valor cuenta como saldo desde el inicio."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:G===0?"":G,onChange:ft=>z(Math.max(0,Number(ft.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:ae,onChange:ft=>Se(ft.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[ae.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Y(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),le&&pu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[50]",style:{zIndex:50},children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Be(!1)}),i.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-full max-w-5xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 gap-3",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(je==null?void 0:je.name)||""]}),i.jsxs("div",{className:"flex gap-2 shrink-0",children:[i.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{nt(0),ht(new Date().toISOString().slice(0,10)),Xe(""),de(!0)},children:"Abonar"}),i.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Be(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Deuda inicial"}),i.jsx("div",{className:"text-xl font-semibold",children:tu(Number((je==null?void 0:je.initialDebt)||0))})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:tu(te.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:tu(te.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:tu(te.saldoRestante)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:Qe?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):pt.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):pt.map(ft=>{var Le;const lr=K===ft.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:lr?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:Ze,onChange:tt=>at(tt.target.value)}):ft.date||""}),i.jsx("td",{className:"p-2 border",children:ft.amount>=0?(Le=ft.ref)!=null&&Le.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",onClick:()=>P(ft.ref.saleId),children:"COMPRA (Ver detalle)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (Ver detalle)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:lr?i.jsx("input",{className:"w-full border p-1 rounded",value:M,onChange:tt=>V(tt.target.value)}):i.jsx("span",{title:ft.comment||"",children:(ft.comment||"").length>40?(ft.comment||"").slice(0,40)+"":ft.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:lr?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(it)?"":it,onChange:tt=>T(Number(tt.target.value||0))}):tu(ft.amount)}),i.jsx("td",{className:"p-2 border",children:lr?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Je,children:"Guardar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Ua,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>In(ft),children:"Editar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Ot(ft),children:"Borrar"})]})})]},ft.id)})})]})})]})}),w&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",style:{zIndex:60},children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Productos vendidos"," "]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>j(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:I?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):F.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):F.map((ft,lr)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:ft.productName}),i.jsx("td",{className:"p-2 border text-right",children:ft.qty}),i.jsx("td",{className:"p-2 border text-right",children:tu(ft.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:tu(ft.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:tu(ft.total)})]},lr))})]})})]})})]}),document.body),$e&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[90]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(je==null?void 0:je.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:vt,onChange:ft=>ht(ft.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Ce===0?"":Ce,onChange:ft=>{const lr=Number(ft.target.value||0),Le=Number.isFinite(lr)?Math.max(0,parseFloat(lr.toFixed(2))):0;nt(Le)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se registrar como ABONO (negativo) con 2 decimales."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:xt,onChange:ft=>Xe(ft.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[xt.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>de(!1),disabled:be,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:yn,disabled:be,children:be?"Guardando...":"Guardar abono"})]})]})})]})}function W4e(t,e){var r=Object.setPrototypeOf;r?r(t,e):t.__proto__=e}function X4e(t,e){e===void 0&&(e=t.constructor);var r=Error.captureStackTrace;r&&r(t,e)}var Y4e=function(){var t=function(r,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,s){a.__proto__=s}||function(a,s){for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(a[o]=s[o])},t(r,n)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),J4e=function(t){Y4e(e,t);function e(r,n){var a=this.constructor,s=t.call(this,r,n)||this;return Object.defineProperty(s,"name",{value:a.name,enumerable:!1,configurable:!0}),W4e(s,a.prototype),X4e(s),s}return e}(Error),Z4e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Qc=function(t){Z4e(e,t);function e(r){r===void 0&&(r=void 0);var n=t.call(this,r)||this;return n.message=r,n}return e.prototype.getKind=function(){var r=this.constructor;return r.kind},e.kind="Exception",e}(J4e),e3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ni=function(t){e3e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ArgumentException",e}(Qc),t3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),cn=function(t){t3e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="IllegalArgumentException",e}(Qc),Hre=function(){function t(e){if(this.binarizer=e,e===null)throw new cn("Binarizer must be non-null.")}return t.prototype.getWidth=function(){return this.binarizer.getWidth()},t.prototype.getHeight=function(){return this.binarizer.getHeight()},t.prototype.getBlackRow=function(e,r){return this.binarizer.getBlackRow(e,r)},t.prototype.getBlackMatrix=function(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix},t.prototype.isCropSupported=function(){return this.binarizer.getLuminanceSource().isCropSupported()},t.prototype.crop=function(e,r,n,a){var s=this.binarizer.getLuminanceSource().crop(e,r,n,a);return new t(this.binarizer.createBinarizer(s))},t.prototype.isRotateSupported=function(){return this.binarizer.getLuminanceSource().isRotateSupported()},t.prototype.rotateCounterClockwise=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new t(this.binarizer.createBinarizer(e))},t.prototype.rotateCounterClockwise45=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new t(this.binarizer.createBinarizer(e))},t.prototype.toString=function(){try{return this.getBlackMatrix().toString()}catch{return""}},t}(),r3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Vi=function(t){r3e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getChecksumInstance=function(){return new e},e.kind="ChecksumException",e}(Qc),n3e=function(){function t(e){this.source=e}return t.prototype.getLuminanceSource=function(){return this.source},t.prototype.getWidth=function(){return this.source.getWidth()},t.prototype.getHeight=function(){return this.source.getHeight()},t}(),ss=function(){function t(){}return t.arraycopy=function(e,r,n,a,s){for(;s--;)n[a++]=e[r++]},t.currentTimeMillis=function(){return Date.now()},t}(),a3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),B6=function(t){a3e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="IndexOutOfBoundsException",e}(Qc),s3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),YV=function(t){s3e(e,t);function e(r,n){r===void 0&&(r=void 0),n===void 0&&(n=void 0);var a=t.call(this,n)||this;return a.index=r,a.message=n,a}return e.kind="ArrayIndexOutOfBoundsException",e}(B6),i3e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},co=function(){function t(){}return t.fill=function(e,r){for(var n=0,a=e.length;n<a;n++)e[n]=r},t.fillWithin=function(e,r,n,a){t.rangeCheck(e.length,r,n);for(var s=r;s<n;s++)e[s]=a},t.rangeCheck=function(e,r,n){if(r>n)throw new cn("fromIndex("+r+") > toIndex("+n+")");if(r<0)throw new YV(r);if(n>e)throw new YV(n)},t.asList=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e},t.create=function(e,r,n){var a=Array.from({length:e});return a.map(function(s){return Array.from({length:r}).fill(n)})},t.createInt32Array=function(e,r,n){var a=Array.from({length:e});return a.map(function(s){return Int32Array.from({length:r}).fill(n)})},t.equals=function(e,r){if(!e||!r||!e.length||!r.length||e.length!==r.length)return!1;for(var n=0,a=e.length;n<a;n++)if(e[n]!==r[n])return!1;return!0},t.hashCode=function(e){var r,n;if(e===null)return 0;var a=1;try{for(var s=i3e(e),o=s.next();!o.done;o=s.next()){var l=o.value;a=31*a+l}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a},t.fillUint8Array=function(e,r){for(var n=0;n!==e.length;n++)e[n]=r},t.copyOf=function(e,r){return e.slice(0,r)},t.copyOfUint8Array=function(e,r){if(e.length<=r){var n=new Uint8Array(r);return n.set(e),n}return e.slice(0,r)},t.copyOfRange=function(e,r,n){var a=n-r,s=new Int32Array(a);return ss.arraycopy(e,r,s,0,a),s},t.binarySearch=function(e,r,n){n===void 0&&(n=t.numberComparator);for(var a=0,s=e.length-1;a<=s;){var o=s+a>>1,l=n(r,e[o]);if(l>0)a=o+1;else if(l<0)s=o-1;else return o}return-a-1},t.numberComparator=function(e,r){return e-r},t}(),Hn=function(){function t(){}return t.numberOfTrailingZeros=function(e){var r;if(e===0)return 32;var n=31;return r=e<<16,r!==0&&(n-=16,e=r),r=e<<8,r!==0&&(n-=8,e=r),r=e<<4,r!==0&&(n-=4,e=r),r=e<<2,r!==0&&(n-=2,e=r),n-(e<<1>>>31)},t.numberOfLeadingZeros=function(e){if(e===0)return 32;var r=1;return e>>>16||(r+=16,e<<=16),e>>>24||(r+=8,e<<=8),e>>>28||(r+=4,e<<=4),e>>>30||(r+=2,e<<=2),r-=e>>>31,r},t.toHexString=function(e){return e.toString(16)},t.toBinaryString=function(e){return String(parseInt(String(e),2))},t.bitCount=function(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63},t.truncDivision=function(e,r){return Math.trunc(e/r)},t.parseInt=function(e,r){return r===void 0&&(r=void 0),parseInt(e,r)},t.MIN_VALUE_32_BITS=-2147483648,t.MAX_VALUE=Number.MAX_SAFE_INTEGER,t}(),Oo=function(){function t(e,r){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,r==null?this.bits=t.makeArray(e):this.bits=r)}return t.prototype.getSize=function(){return this.size},t.prototype.getSizeInBytes=function(){return Math.floor((this.size+7)/8)},t.prototype.ensureCapacity=function(e){if(e>this.bits.length*32){var r=t.makeArray(e);ss.arraycopy(this.bits,0,r,0,this.bits.length),this.bits=r}},t.prototype.get=function(e){return(this.bits[Math.floor(e/32)]&1<<(e&31))!==0},t.prototype.set=function(e){this.bits[Math.floor(e/32)]|=1<<(e&31)},t.prototype.flip=function(e){this.bits[Math.floor(e/32)]^=1<<(e&31)},t.prototype.getNextSet=function(e){var r=this.size;if(e>=r)return r;var n=this.bits,a=Math.floor(e/32),s=n[a];s&=~((1<<(e&31))-1);for(var o=n.length;s===0;){if(++a===o)return r;s=n[a]}var l=a*32+Hn.numberOfTrailingZeros(s);return l>r?r:l},t.prototype.getNextUnset=function(e){var r=this.size;if(e>=r)return r;var n=this.bits,a=Math.floor(e/32),s=~n[a];s&=~((1<<(e&31))-1);for(var o=n.length;s===0;){if(++a===o)return r;s=~n[a]}var l=a*32+Hn.numberOfTrailingZeros(s);return l>r?r:l},t.prototype.setBulk=function(e,r){this.bits[Math.floor(e/32)]=r},t.prototype.setRange=function(e,r){if(r<e||e<0||r>this.size)throw new cn;if(r!==e){r--;for(var n=Math.floor(e/32),a=Math.floor(r/32),s=this.bits,o=n;o<=a;o++){var l=o>n?0:e&31,c=o<a?31:r&31,u=(2<<c)-(1<<l);s[o]|=u}}},t.prototype.clear=function(){for(var e=this.bits.length,r=this.bits,n=0;n<e;n++)r[n]=0},t.prototype.isRange=function(e,r,n){if(r<e||e<0||r>this.size)throw new cn;if(r===e)return!0;r--;for(var a=Math.floor(e/32),s=Math.floor(r/32),o=this.bits,l=a;l<=s;l++){var c=l>a?0:e&31,u=l<s?31:r&31,d=(2<<u)-(1<<c)&4294967295;if((o[l]&d)!==(n?d:0))return!1}return!0},t.prototype.appendBit=function(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++},t.prototype.appendBits=function(e,r){if(r<0||r>32)throw new cn("Num bits must be between 0 and 32");this.ensureCapacity(this.size+r);for(var n=r;n>0;n--)this.appendBit((e>>n-1&1)===1)},t.prototype.appendBitArray=function(e){var r=e.size;this.ensureCapacity(this.size+r);for(var n=0;n<r;n++)this.appendBit(e.get(n))},t.prototype.xor=function(e){if(this.size!==e.size)throw new cn("Sizes don't match");for(var r=this.bits,n=0,a=r.length;n<a;n++)r[n]^=e.bits[n]},t.prototype.toBytes=function(e,r,n,a){for(var s=0;s<a;s++){for(var o=0,l=0;l<8;l++)this.get(e)&&(o|=1<<7-l),e++;r[n+s]=o}},t.prototype.getBitArray=function(){return this.bits},t.prototype.reverse=function(){for(var e=new Int32Array(this.bits.length),r=Math.floor((this.size-1)/32),n=r+1,a=this.bits,s=0;s<n;s++){var o=a[s];o=o>>1&1431655765|(o&1431655765)<<1,o=o>>2&858993459|(o&858993459)<<2,o=o>>4&252645135|(o&252645135)<<4,o=o>>8&16711935|(o&16711935)<<8,o=o>>16&65535|(o&65535)<<16,e[r-s]=o}if(this.size!==n*32){for(var l=n*32-this.size,c=e[0]>>>l,s=1;s<n;s++){var u=e[s];c|=u<<32-l,e[s-1]=c,c=u>>>l}e[n-1]=c}this.bits=e},t.makeArray=function(e){return new Int32Array(Math.floor((e+31)/32))},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.size===r.size&&co.equals(this.bits,r.bits)},t.prototype.hashCode=function(){return 31*this.size+co.hashCode(this.bits)},t.prototype.toString=function(){for(var e="",r=0,n=this.size;r<n;r++)r&7||(e+=" "),e+=this.get(r)?"X":".";return e},t.prototype.clone=function(){return new t(this.size,this.bits.slice())},t.prototype.toArray=function(){for(var e=[],r=0,n=this.size;r<n;r++)e.push(this.get(r));return e},t}(),Ok;(function(t){t[t.OTHER=0]="OTHER",t[t.PURE_BARCODE=1]="PURE_BARCODE",t[t.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",t[t.TRY_HARDER=3]="TRY_HARDER",t[t.CHARACTER_SET=4]="CHARACTER_SET",t[t.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",t[t.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",t[t.ENABLE_CODE_39_EXTENDED_MODE=7]="ENABLE_CODE_39_EXTENDED_MODE",t[t.ASSUME_GS1=8]="ASSUME_GS1",t[t.RETURN_CODABAR_START_END=9]="RETURN_CODABAR_START_END",t[t.NEED_RESULT_POINT_CALLBACK=10]="NEED_RESULT_POINT_CALLBACK",t[t.ALLOWED_EAN_EXTENSIONS=11]="ALLOWED_EAN_EXTENSIONS"})(Ok||(Ok={}));const is=Ok;var o3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Sr=function(t){o3e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getFormatInstance=function(){return new e},e.kind="FormatException",e}(Qc),l3e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ja;(function(t){t[t.Cp437=0]="Cp437",t[t.ISO8859_1=1]="ISO8859_1",t[t.ISO8859_2=2]="ISO8859_2",t[t.ISO8859_3=3]="ISO8859_3",t[t.ISO8859_4=4]="ISO8859_4",t[t.ISO8859_5=5]="ISO8859_5",t[t.ISO8859_6=6]="ISO8859_6",t[t.ISO8859_7=7]="ISO8859_7",t[t.ISO8859_8=8]="ISO8859_8",t[t.ISO8859_9=9]="ISO8859_9",t[t.ISO8859_10=10]="ISO8859_10",t[t.ISO8859_11=11]="ISO8859_11",t[t.ISO8859_13=12]="ISO8859_13",t[t.ISO8859_14=13]="ISO8859_14",t[t.ISO8859_15=14]="ISO8859_15",t[t.ISO8859_16=15]="ISO8859_16",t[t.SJIS=16]="SJIS",t[t.Cp1250=17]="Cp1250",t[t.Cp1251=18]="Cp1251",t[t.Cp1252=19]="Cp1252",t[t.Cp1256=20]="Cp1256",t[t.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",t[t.UTF8=22]="UTF8",t[t.ASCII=23]="ASCII",t[t.Big5=24]="Big5",t[t.GB18030=25]="GB18030",t[t.EUC_KR=26]="EUC_KR"})(ja||(ja={}));var lo=function(){function t(e,r,n){for(var a,s,o=[],l=3;l<arguments.length;l++)o[l-3]=arguments[l];this.valueIdentifier=e,this.name=n,typeof r=="number"?this.values=Int32Array.from([r]):this.values=r,this.otherEncodingNames=o,t.VALUE_IDENTIFIER_TO_ECI.set(e,this),t.NAME_TO_ECI.set(n,this);for(var c=this.values,u=0,d=c.length;u!==d;u++){var f=c[u];t.VALUES_TO_ECI.set(f,this)}try{for(var A=l3e(o),h=A.next();!h.done;h=A.next()){var m=h.value;t.NAME_TO_ECI.set(m,this)}}catch(p){a={error:p}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}}return t.prototype.getValueIdentifier=function(){return this.valueIdentifier},t.prototype.getName=function(){return this.name},t.prototype.getValue=function(){return this.values[0]},t.getCharacterSetECIByValue=function(e){if(e<0||e>=900)throw new Sr("incorect value");var r=t.VALUES_TO_ECI.get(e);if(r===void 0)throw new Sr("incorect value");return r},t.getCharacterSetECIByName=function(e){var r=t.NAME_TO_ECI.get(e);if(r===void 0)throw new Sr("incorect value");return r},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.getName()===r.getName()},t.VALUE_IDENTIFIER_TO_ECI=new Map,t.VALUES_TO_ECI=new Map,t.NAME_TO_ECI=new Map,t.Cp437=new t(ja.Cp437,Int32Array.from([0,2]),"Cp437"),t.ISO8859_1=new t(ja.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),t.ISO8859_2=new t(ja.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),t.ISO8859_3=new t(ja.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),t.ISO8859_4=new t(ja.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),t.ISO8859_5=new t(ja.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),t.ISO8859_6=new t(ja.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),t.ISO8859_7=new t(ja.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),t.ISO8859_8=new t(ja.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),t.ISO8859_9=new t(ja.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),t.ISO8859_10=new t(ja.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),t.ISO8859_11=new t(ja.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),t.ISO8859_13=new t(ja.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),t.ISO8859_14=new t(ja.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),t.ISO8859_15=new t(ja.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),t.ISO8859_16=new t(ja.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),t.SJIS=new t(ja.SJIS,20,"SJIS","Shift_JIS"),t.Cp1250=new t(ja.Cp1250,21,"Cp1250","windows-1250"),t.Cp1251=new t(ja.Cp1251,22,"Cp1251","windows-1251"),t.Cp1252=new t(ja.Cp1252,23,"Cp1252","windows-1252"),t.Cp1256=new t(ja.Cp1256,24,"Cp1256","windows-1256"),t.UnicodeBigUnmarked=new t(ja.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),t.UTF8=new t(ja.UTF8,26,"UTF8","UTF-8"),t.ASCII=new t(ja.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),t.Big5=new t(ja.Big5,28,"Big5"),t.GB18030=new t(ja.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),t.EUC_KR=new t(ja.EUC_KR,30,"EUC_KR","EUC-KR"),t}(),c3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),oE=function(t){c3e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="UnsupportedOperationException",e}(Qc),ud=function(){function t(){}return t.decode=function(e,r){var n=this.encodingName(r);return this.customDecoder?this.customDecoder(e,n):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(n)?this.decodeFallback(e,n):new TextDecoder(n).decode(e)},t.shouldDecodeOnFallback=function(e){return!t.isBrowser()&&e==="ISO-8859-1"},t.encode=function(e,r){var n=this.encodingName(r);return this.customEncoder?this.customEncoder(e,n):typeof TextEncoder>"u"?this.encodeFallback(e):new TextEncoder().encode(e)},t.isBrowser=function(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"},t.encodingName=function(e){return typeof e=="string"?e:e.getName()},t.encodingCharacterSet=function(e){return e instanceof lo?e:lo.getCharacterSetECIByName(e)},t.decodeFallback=function(e,r){var n=this.encodingCharacterSet(r);if(t.isDecodeFallbackSupported(n)){for(var a="",s=0,o=e.length;s<o;s++){var l=e[s].toString(16);l.length<2&&(l="0"+l),a+="%"+l}return decodeURIComponent(a)}if(n.equals(lo.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new oE("Encoding "+this.encodingName(r)+" not supported by fallback.")},t.isDecodeFallbackSupported=function(e){return e.equals(lo.UTF8)||e.equals(lo.ISO8859_1)||e.equals(lo.ASCII)},t.encodeFallback=function(e){for(var r=btoa(unescape(encodeURIComponent(e))),n=r.split(""),a=[],s=0;s<n.length;s++)a.push(n[s].charCodeAt(0));return new Uint8Array(a)},t}(),ra=function(){function t(){}return t.castAsNonUtf8Char=function(e,r){r===void 0&&(r=null);var n=r?r.getName():this.ISO88591;return ud.decode(new Uint8Array([e]),n)},t.guessEncoding=function(e,r){if(r!=null&&r.get(is.CHARACTER_SET)!==void 0)return r.get(is.CHARACTER_SET).toString();for(var n=e.length,a=!0,s=!0,o=!0,l=0,c=0,u=0,d=0,f=0,A=0,h=0,m=0,p=0,g=0,v=0,y=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191,b=0;b<n&&(a||s||o);b++){var w=e[b]&255;o&&(l>0?w&128?l--:o=!1:w&128&&(w&64?(l++,w&32?(l++,w&16?(l++,w&8?o=!1:d++):u++):c++):o=!1)),a&&(w>127&&w<160?a=!1:w>159&&(w<192||w===215||w===247)&&v++),s&&(f>0?w<64||w===127||w>252?s=!1:f--:w===128||w===160||w>239?s=!1:w>160&&w<224?(A++,m=0,h++,h>p&&(p=h)):w>127?(f++,h=0,m++,m>g&&(g=m)):(h=0,m=0))}return o&&l>0&&(o=!1),s&&f>0&&(s=!1),o&&(y||c+u+d>0)?t.UTF8:s&&(t.ASSUME_SHIFT_JIS||p>=3||g>=3)?t.SHIFT_JIS:a&&s?p===2&&A===2||v*10>=n?t.SHIFT_JIS:t.ISO88591:a?t.ISO88591:s?t.SHIFT_JIS:o?t.UTF8:t.PLATFORM_DEFAULT_ENCODING},t.format=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var a=-1;function s(l,c,u,d,f,A){if(l==="%%")return"%";if(r[++a]!==void 0){l=d?parseInt(d.substr(1)):void 0;var h=f?parseInt(f.substr(1)):void 0,m;switch(A){case"s":m=r[a];break;case"c":m=r[a][0];break;case"f":m=parseFloat(r[a]).toFixed(l);break;case"p":m=parseFloat(r[a]).toPrecision(l);break;case"e":m=parseFloat(r[a]).toExponential(l);break;case"x":m=parseInt(r[a]).toString(h||16);break;case"d":m=parseFloat(parseInt(r[a],h||10).toPrecision(l)).toFixed(0);break}m=typeof m=="object"?JSON.stringify(m):(+m).toString(h);for(var p=parseInt(u),g=u&&u[0]+""=="0"?"0":" ";m.length<p;)m=c!==void 0?m+g:g+m;return m}}var o=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(o,s)},t.getBytes=function(e,r){return ud.encode(e,r)},t.getCharCode=function(e,r){return r===void 0&&(r=0),e.charCodeAt(r)},t.getCharAt=function(e){return String.fromCharCode(e)},t.SHIFT_JIS=lo.SJIS.getName(),t.GB2312="GB2312",t.ISO88591=lo.ISO8859_1.getName(),t.EUC_JP="EUC_JP",t.UTF8=lo.UTF8.getName(),t.PLATFORM_DEFAULT_ENCODING=t.UTF8,t.ASSUME_SHIFT_JIS=!1,t}(),Dn=function(){function t(e){e===void 0&&(e=""),this.value=e}return t.prototype.enableDecoding=function(e){return this.encoding=e,this},t.prototype.append=function(e){return typeof e=="string"?this.value+=e.toString():this.encoding?this.value+=ra.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this},t.prototype.appendChars=function(e,r,n){for(var a=r;r<r+n;a++)this.append(e[a]);return this},t.prototype.length=function(){return this.value.length},t.prototype.charAt=function(e){return this.value.charAt(e)},t.prototype.deleteCharAt=function(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)},t.prototype.setCharAt=function(e,r){this.value=this.value.substr(0,e)+r+this.value.substr(e+1)},t.prototype.substring=function(e,r){return this.value.substring(e,r)},t.prototype.setLengthToZero=function(){this.value=""},t.prototype.toString=function(){return this.value},t.prototype.insert=function(e,r){this.value=this.value.substring(0,e)+r+this.value.substring(e)},t}(),Kf=function(){function t(e,r,n,a){if(this.width=e,this.height=r,this.rowSize=n,this.bits=a,r==null&&(r=e),this.height=r,e<1||r<1)throw new cn("Both dimensions must be greater than 0");n==null&&(n=Math.floor((e+31)/32)),this.rowSize=n,a==null&&(this.bits=new Int32Array(this.rowSize*this.height))}return t.parseFromBooleanArray=function(e){for(var r=e.length,n=e[0].length,a=new t(n,r),s=0;s<r;s++)for(var o=e[s],l=0;l<n;l++)o[l]&&a.set(l,s);return a},t.parseFromString=function(e,r,n){if(e===null)throw new cn("stringRepresentation cannot be null");for(var a=new Array(e.length),s=0,o=0,l=-1,c=0,u=0;u<e.length;)if(e.charAt(u)===`
`||e.charAt(u)==="\r"){if(s>o){if(l===-1)l=s-o;else if(s-o!==l)throw new cn("row lengths do not match");o=s,c++}u++}else if(e.substring(u,u+r.length)===r)u+=r.length,a[s]=!0,s++;else if(e.substring(u,u+n.length)===n)u+=n.length,a[s]=!1,s++;else throw new cn("illegal character encountered: "+e.substring(u));if(s>o){if(l===-1)l=s-o;else if(s-o!==l)throw new cn("row lengths do not match");c++}for(var d=new t(l,c),f=0;f<s;f++)a[f]&&d.set(Math.floor(f%l),Math.floor(f/l));return d},t.prototype.get=function(e,r){var n=r*this.rowSize+Math.floor(e/32);return(this.bits[n]>>>(e&31)&1)!==0},t.prototype.set=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]|=1<<(e&31)&4294967295},t.prototype.unset=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]&=~(1<<(e&31)&4294967295)},t.prototype.flip=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]^=1<<(e&31)&4294967295},t.prototype.xor=function(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new cn("input matrix dimensions do not match");for(var r=new Oo(Math.floor(this.width/32)+1),n=this.rowSize,a=this.bits,s=0,o=this.height;s<o;s++)for(var l=s*n,c=e.getRow(s,r).getBitArray(),u=0;u<n;u++)a[l+u]^=c[u]},t.prototype.clear=function(){for(var e=this.bits,r=e.length,n=0;n<r;n++)e[n]=0},t.prototype.setRegion=function(e,r,n,a){if(r<0||e<0)throw new cn("Left and top must be nonnegative");if(a<1||n<1)throw new cn("Height and width must be at least 1");var s=e+n,o=r+a;if(o>this.height||s>this.width)throw new cn("The region must fit inside the matrix");for(var l=this.rowSize,c=this.bits,u=r;u<o;u++)for(var d=u*l,f=e;f<s;f++)c[d+Math.floor(f/32)]|=1<<(f&31)&4294967295},t.prototype.getRow=function(e,r){r==null||r.getSize()<this.width?r=new Oo(this.width):r.clear();for(var n=this.rowSize,a=this.bits,s=e*n,o=0;o<n;o++)r.setBulk(o*32,a[s+o]);return r},t.prototype.setRow=function(e,r){ss.arraycopy(r.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)},t.prototype.rotate180=function(){for(var e=this.getWidth(),r=this.getHeight(),n=new Oo(e),a=new Oo(e),s=0,o=Math.floor((r+1)/2);s<o;s++)n=this.getRow(s,n),a=this.getRow(r-1-s,a),n.reverse(),a.reverse(),this.setRow(s,a),this.setRow(r-1-s,n)},t.prototype.getEnclosingRectangle=function(){for(var e=this.width,r=this.height,n=this.rowSize,a=this.bits,s=e,o=r,l=-1,c=-1,u=0;u<r;u++)for(var d=0;d<n;d++){var f=a[u*n+d];if(f!==0){if(u<o&&(o=u),u>c&&(c=u),d*32<s){for(var A=0;!(f<<31-A&4294967295);)A++;d*32+A<s&&(s=d*32+A)}if(d*32+31>l){for(var A=31;!(f>>>A);)A--;d*32+A>l&&(l=d*32+A)}}}return l<s||c<o?null:Int32Array.from([s,o,l-s+1,c-o+1])},t.prototype.getTopLeftOnBit=function(){for(var e=this.rowSize,r=this.bits,n=0;n<r.length&&r[n]===0;)n++;if(n===r.length)return null;for(var a=n/e,s=n%e*32,o=r[n],l=0;!(o<<31-l&4294967295);)l++;return s+=l,Int32Array.from([s,a])},t.prototype.getBottomRightOnBit=function(){for(var e=this.rowSize,r=this.bits,n=r.length-1;n>=0&&r[n]===0;)n--;if(n<0)return null;for(var a=Math.floor(n/e),s=Math.floor(n%e)*32,o=r[n],l=31;!(o>>>l);)l--;return s+=l,Int32Array.from([s,a])},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.getRowSize=function(){return this.rowSize},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.width===r.width&&this.height===r.height&&this.rowSize===r.rowSize&&co.equals(this.bits,r.bits)},t.prototype.hashCode=function(){var e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+co.hashCode(this.bits),e},t.prototype.toString=function(e,r,n){return e===void 0&&(e="X "),r===void 0&&(r="  "),n===void 0&&(n=`
`),this.buildToString(e,r,n)},t.prototype.buildToString=function(e,r,n){for(var a=new Dn,s=0,o=this.height;s<o;s++){for(var l=0,c=this.width;l<c;l++)a.append(this.get(l,s)?e:r);a.append(n)}return a.toString()},t.prototype.clone=function(){return new t(this.width,this.height,this.rowSize,this.bits.slice())},t}(),u3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Zt=function(t){u3e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getNotFoundInstance=function(){return new e},e.kind="NotFoundException",e}(Qc),d3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),f3e=function(t){d3e(e,t);function e(r){var n=t.call(this,r)||this;return n.luminances=e.EMPTY,n.buckets=new Int32Array(e.LUMINANCE_BUCKETS),n}return e.prototype.getBlackRow=function(r,n){var a=this.getLuminanceSource(),s=a.getWidth();n==null||n.getSize()<s?n=new Oo(s):n.clear(),this.initArrays(s);for(var o=a.getRow(r,this.luminances),l=this.buckets,c=0;c<s;c++)l[(o[c]&255)>>e.LUMINANCE_SHIFT]++;var u=e.estimateBlackPoint(l);if(s<3)for(var c=0;c<s;c++)(o[c]&255)<u&&n.set(c);else for(var d=o[0]&255,f=o[1]&255,c=1;c<s-1;c++){var A=o[c+1]&255;(f*4-d-A)/2<u&&n.set(c),d=f,f=A}return n},e.prototype.getBlackMatrix=function(){var r=this.getLuminanceSource(),n=r.getWidth(),a=r.getHeight(),s=new Kf(n,a);this.initArrays(n);for(var o=this.buckets,l=1;l<5;l++)for(var c=Math.floor(a*l/5),u=r.getRow(c,this.luminances),d=Math.floor(n*4/5),f=Math.floor(n/5);f<d;f++){var A=u[f]&255;o[A>>e.LUMINANCE_SHIFT]++}for(var h=e.estimateBlackPoint(o),m=r.getMatrix(),l=0;l<a;l++)for(var p=l*n,f=0;f<n;f++){var A=m[p+f]&255;A<h&&s.set(f,l)}return s},e.prototype.createBinarizer=function(r){return new e(r)},e.prototype.initArrays=function(r){this.luminances.length<r&&(this.luminances=new Uint8ClampedArray(r));for(var n=this.buckets,a=0;a<e.LUMINANCE_BUCKETS;a++)n[a]=0},e.estimateBlackPoint=function(r){for(var n=r.length,a=0,s=0,o=0,l=0;l<n;l++)r[l]>o&&(s=l,o=r[l]),r[l]>a&&(a=r[l]);for(var c=0,u=0,l=0;l<n;l++){var d=l-s,f=r[l]*d*d;f>u&&(c=l,u=f)}if(s>c){var A=s;s=c,c=A}if(c-s<=n/16)throw new Zt;for(var h=c-1,m=-1,l=c-1;l>s;l--){var p=l-s,f=p*p*(c-l)*(a-r[l]);f>m&&(h=l,m=f)}return h<<e.LUMINANCE_SHIFT},e.LUMINANCE_BITS=5,e.LUMINANCE_SHIFT=8-e.LUMINANCE_BITS,e.LUMINANCE_BUCKETS=1<<e.LUMINANCE_BITS,e.EMPTY=Uint8ClampedArray.from([0]),e}(n3e),h3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),$re=function(t){h3e(e,t);function e(r){var n=t.call(this,r)||this;return n.matrix=null,n}return e.prototype.getBlackMatrix=function(){if(this.matrix!==null)return this.matrix;var r=this.getLuminanceSource(),n=r.getWidth(),a=r.getHeight();if(n>=e.MINIMUM_DIMENSION&&a>=e.MINIMUM_DIMENSION){var s=r.getMatrix(),o=n>>e.BLOCK_SIZE_POWER;n&e.BLOCK_SIZE_MASK&&o++;var l=a>>e.BLOCK_SIZE_POWER;a&e.BLOCK_SIZE_MASK&&l++;var c=e.calculateBlackPoints(s,o,l,n,a),u=new Kf(n,a);e.calculateThresholdForBlock(s,o,l,n,a,c,u),this.matrix=u}else this.matrix=t.prototype.getBlackMatrix.call(this);return this.matrix},e.prototype.createBinarizer=function(r){return new e(r)},e.calculateThresholdForBlock=function(r,n,a,s,o,l,c){for(var u=o-e.BLOCK_SIZE,d=s-e.BLOCK_SIZE,f=0;f<a;f++){var A=f<<e.BLOCK_SIZE_POWER;A>u&&(A=u);for(var h=e.cap(f,2,a-3),m=0;m<n;m++){var p=m<<e.BLOCK_SIZE_POWER;p>d&&(p=d);for(var g=e.cap(m,2,n-3),v=0,y=-2;y<=2;y++){var b=l[h+y];v+=b[g-2]+b[g-1]+b[g]+b[g+1]+b[g+2]}var w=v/25;e.thresholdBlock(r,p,A,w,s,c)}}},e.cap=function(r,n,a){return r<n?n:r>a?a:r},e.thresholdBlock=function(r,n,a,s,o,l){for(var c=0,u=a*o+n;c<e.BLOCK_SIZE;c++,u+=o)for(var d=0;d<e.BLOCK_SIZE;d++)(r[u+d]&255)<=s&&l.set(n+d,a+c)},e.calculateBlackPoints=function(r,n,a,s,o){for(var l=o-e.BLOCK_SIZE,c=s-e.BLOCK_SIZE,u=new Array(a),d=0;d<a;d++){u[d]=new Int32Array(n);var f=d<<e.BLOCK_SIZE_POWER;f>l&&(f=l);for(var A=0;A<n;A++){var h=A<<e.BLOCK_SIZE_POWER;h>c&&(h=c);for(var m=0,p=255,g=0,v=0,y=f*s+h;v<e.BLOCK_SIZE;v++,y+=s){for(var b=0;b<e.BLOCK_SIZE;b++){var w=r[y+b]&255;m+=w,w<p&&(p=w),w>g&&(g=w)}if(g-p>e.MIN_DYNAMIC_RANGE)for(v++,y+=s;v<e.BLOCK_SIZE;v++,y+=s)for(var b=0;b<e.BLOCK_SIZE;b++)m+=r[y+b]&255}var j=m>>e.BLOCK_SIZE_POWER*2;if(g-p<=e.MIN_DYNAMIC_RANGE&&(j=p/2,d>0&&A>0)){var I=(u[d-1][A]+2*u[d][A-1]+u[d-1][A-1])/4;p<I&&(j=I)}u[d][A]=j}}return u},e.BLOCK_SIZE_POWER=3,e.BLOCK_SIZE=1<<e.BLOCK_SIZE_POWER,e.BLOCK_SIZE_MASK=e.BLOCK_SIZE-1,e.MINIMUM_DIMENSION=e.BLOCK_SIZE*5,e.MIN_DYNAMIC_RANGE=24,e}(f3e),Iw=function(){function t(e,r){this.width=e,this.height=r}return t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.isCropSupported=function(){return!1},t.prototype.crop=function(e,r,n,a){throw new oE("This luminance source does not support cropping.")},t.prototype.isRotateSupported=function(){return!1},t.prototype.rotateCounterClockwise=function(){throw new oE("This luminance source does not support rotation by 90 degrees.")},t.prototype.rotateCounterClockwise45=function(){throw new oE("This luminance source does not support rotation by 45 degrees.")},t.prototype.toString=function(){for(var e=new Uint8ClampedArray(this.width),r=new Dn,n=0;n<this.height;n++){for(var a=this.getRow(n,e),s=0;s<this.width;s++){var o=a[s]&255,l=void 0;o<64?l="#":o<128?l="+":o<192?l=".":l=" ",r.append(l)}r.append(`
`)}return r.toString()},t}(),A3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),zj=function(t){A3e(e,t);function e(r){var n=t.call(this,r.getWidth(),r.getHeight())||this;return n.delegate=r,n}return e.prototype.getRow=function(r,n){for(var a=this.delegate.getRow(r,n),s=this.getWidth(),o=0;o<s;o++)a[o]=255-(a[o]&255);return a},e.prototype.getMatrix=function(){for(var r=this.delegate.getMatrix(),n=this.getWidth()*this.getHeight(),a=new Uint8ClampedArray(n),s=0;s<n;s++)a[s]=255-(r[s]&255);return a},e.prototype.isCropSupported=function(){return this.delegate.isCropSupported()},e.prototype.crop=function(r,n,a,s){return new e(this.delegate.crop(r,n,a,s))},e.prototype.isRotateSupported=function(){return this.delegate.isRotateSupported()},e.prototype.invert=function(){return this.delegate},e.prototype.rotateCounterClockwise=function(){return new e(this.delegate.rotateCounterClockwise())},e.prototype.rotateCounterClockwise45=function(){return new e(this.delegate.rotateCounterClockwise45())},e}(Iw),m3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),p3e=function(t){m3e(e,t);function e(r,n){n===void 0&&(n=!1);var a=t.call(this,r.width,r.height)||this;return a.canvas=r,a.tempCanvasElement=null,a.buffer=e.makeBufferFromCanvasImageData(r,n),a}return e.makeBufferFromCanvasImageData=function(r,n){n===void 0&&(n=!1);var a=r.getContext("2d").getImageData(0,0,r.width,r.height);return e.toGrayscaleBuffer(a.data,r.width,r.height,n)},e.toGrayscaleBuffer=function(r,n,a,s){s===void 0&&(s=!1);var o=new Uint8ClampedArray(n*a);if(e.FRAME_INDEX=!e.FRAME_INDEX,e.FRAME_INDEX||!s)for(var l=0,c=0,u=r.length;l<u;l+=4,c++){var d=void 0,f=r[l+3];if(f===0)d=255;else{var A=r[l],h=r[l+1],m=r[l+2];d=306*A+601*h+117*m+512>>10}o[c]=d}else for(var l=0,c=0,p=r.length;l<p;l+=4,c++){var d=void 0,f=r[l+3];if(f===0)d=255;else{var A=r[l],h=r[l+1],m=r[l+2];d=306*A+601*h+117*m+512>>10}o[c]=255-d}return o},e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new cn("Requested row is outside the image: "+r);var a=this.getWidth(),s=r*a;return n===null?n=this.buffer.slice(s,s+a):(n.length<a&&(n=new Uint8ClampedArray(a)),n.set(this.buffer.slice(s,s+a))),n},e.prototype.getMatrix=function(){return this.buffer},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return t.prototype.crop.call(this,r,n,a,s),this},e.prototype.isRotateSupported=function(){return!0},e.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},e.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},e.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement},e.prototype.rotate=function(r){var n=this.getTempCanvasElement(),a=n.getContext("2d"),s=r*e.DEGREE_TO_RADIANS,o=this.canvas.width,l=this.canvas.height,c=Math.ceil(Math.abs(Math.cos(s))*o+Math.abs(Math.sin(s))*l),u=Math.ceil(Math.abs(Math.sin(s))*o+Math.abs(Math.cos(s))*l);return n.width=c,n.height=u,a.translate(c/2,u/2),a.rotate(s),a.drawImage(this.canvas,o/-2,l/-2),this.buffer=e.makeBufferFromCanvasImageData(n),this},e.prototype.invert=function(){return new zj(this)},e.DEGREE_TO_RADIANS=Math.PI/180,e.FRAME_INDEX=!0,e}(Iw),g3e=function(){function t(e,r,n){this.deviceId=e,this.label=r,this.kind="videoinput",this.groupId=n||void 0}return t.prototype.toJSON=function(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}},t}(),Yl=function(t,e,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?s(d.value):a(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})},Jl=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=u[0]&2?a.return:u[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,u[1])).done)return s;switch(a=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],a=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},x3e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},u1=function(){function t(e,r,n){r===void 0&&(r=500),this.reader=e,this.timeBetweenScansMillis=r,this._hints=n,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}return Object.defineProperty(t.prototype,"hasNavigator",{get:function(){return typeof navigator<"u"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMediaDevicesSuported",{get:function(){return this.hasNavigator&&!!navigator.mediaDevices},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canEnumerateDevices",{get:function(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"timeBetweenDecodingAttempts",{get:function(){return this._timeBetweenDecodingAttempts},set:function(e){this._timeBetweenDecodingAttempts=e<0?0:e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hints",{get:function(){return this._hints},set:function(e){this._hints=e||null},enumerable:!1,configurable:!0}),t.prototype.listVideoInputDevices=function(){return Yl(this,void 0,void 0,function(){var e,r,n,a,s,o,l,c,u,d,f,A;return Jl(this,function(h){switch(h.label){case 0:if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=h.sent(),r=[];try{for(n=x3e(e),a=n.next();!a.done;a=n.next())s=a.value,o=s.kind==="video"?"videoinput":s.kind,o==="videoinput"&&(l=s.deviceId||s.id,c=s.label||"Video device "+(r.length+1),u=s.groupId,d={deviceId:l,label:c,kind:o,groupId:u},r.push(d))}catch(m){f={error:m}}finally{try{a&&!a.done&&(A=n.return)&&A.call(n)}finally{if(f)throw f.error}}return[2,r]}})})},t.prototype.getVideoInputDevices=function(){return Yl(this,void 0,void 0,function(){var e;return Jl(this,function(r){switch(r.label){case 0:return[4,this.listVideoInputDevices()];case 1:return e=r.sent(),[2,e.map(function(n){return new g3e(n.deviceId,n.label)})]}})})},t.prototype.findDeviceById=function(e){return Yl(this,void 0,void 0,function(){var r;return Jl(this,function(n){switch(n.label){case 0:return[4,this.listVideoInputDevices()];case 1:return r=n.sent(),r?[2,r.find(function(a){return a.deviceId===e})]:[2,null]}})})},t.prototype.decodeFromInputVideoDevice=function(e,r){return Yl(this,void 0,void 0,function(){return Jl(this,function(n){switch(n.label){case 0:return[4,this.decodeOnceFromVideoDevice(e,r)];case 1:return[2,n.sent()]}})})},t.prototype.decodeOnceFromVideoDevice=function(e,r){return Yl(this,void 0,void 0,function(){var n,a;return Jl(this,function(s){switch(s.label){case 0:return this.reset(),e?n={deviceId:{exact:e}}:n={facingMode:"environment"},a={video:n},[4,this.decodeOnceFromConstraints(a,r)];case 1:return[2,s.sent()]}})})},t.prototype.decodeOnceFromConstraints=function(e,r){return Yl(this,void 0,void 0,function(){var n;return Jl(this,function(a){switch(a.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return n=a.sent(),[4,this.decodeOnceFromStream(n,r)];case 2:return[2,a.sent()]}})})},t.prototype.decodeOnceFromStream=function(e,r){return Yl(this,void 0,void 0,function(){var n,a;return Jl(this,function(s){switch(s.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,r)];case 1:return n=s.sent(),[4,this.decodeOnce(n)];case 2:return a=s.sent(),[2,a]}})})},t.prototype.decodeFromInputVideoDeviceContinuously=function(e,r,n){return Yl(this,void 0,void 0,function(){return Jl(this,function(a){switch(a.label){case 0:return[4,this.decodeFromVideoDevice(e,r,n)];case 1:return[2,a.sent()]}})})},t.prototype.decodeFromVideoDevice=function(e,r,n){return Yl(this,void 0,void 0,function(){var a,s;return Jl(this,function(o){switch(o.label){case 0:return e?a={deviceId:{exact:e}}:a={facingMode:"environment"},s={video:a},[4,this.decodeFromConstraints(s,r,n)];case 1:return[2,o.sent()]}})})},t.prototype.decodeFromConstraints=function(e,r,n){return Yl(this,void 0,void 0,function(){var a;return Jl(this,function(s){switch(s.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return a=s.sent(),[4,this.decodeFromStream(a,r,n)];case 2:return[2,s.sent()]}})})},t.prototype.decodeFromStream=function(e,r,n){return Yl(this,void 0,void 0,function(){var a;return Jl(this,function(s){switch(s.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,r)];case 1:return a=s.sent(),[4,this.decodeContinuously(a,n)];case 2:return[2,s.sent()]}})})},t.prototype.stopAsyncDecode=function(){this._stopAsyncDecode=!0},t.prototype.stopContinuousDecode=function(){this._stopContinuousDecode=!0},t.prototype.attachStreamToVideo=function(e,r){return Yl(this,void 0,void 0,function(){var n;return Jl(this,function(a){switch(a.label){case 0:return n=this.prepareVideoElement(r),this.addVideoSource(n,e),this.videoElement=n,this.stream=e,[4,this.playVideoOnLoadAsync(n)];case 1:return a.sent(),[2,n]}})})},t.prototype.playVideoOnLoadAsync=function(e){var r=this;return new Promise(function(n,a){return r.playVideoOnLoad(e,function(){return n()})})},t.prototype.playVideoOnLoad=function(e,r){var n=this;this.videoEndedListener=function(){return n.stopStreams()},this.videoCanPlayListener=function(){return n.tryPlayVideo(e)},e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",r),this.tryPlayVideo(e)},t.prototype.isVideoPlaying=function(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2},t.prototype.tryPlayVideo=function(e){return Yl(this,void 0,void 0,function(){return Jl(this,function(r){switch(r.label){case 0:if(this.isVideoPlaying(e))return console.warn("Trying to play video that is already playing."),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.play()];case 2:return r.sent(),[3,4];case 3:return r.sent(),console.warn("It was not possible to play the video."),[3,4];case 4:return[2]}})})},t.prototype.getMediaElement=function(e,r){var n=document.getElementById(e);if(!n)throw new Ni("element with id '"+e+"' not found");if(n.nodeName.toLowerCase()!==r.toLowerCase())throw new Ni("element with id '"+e+"' must be an "+r+" element");return n},t.prototype.decodeFromImage=function(e,r){if(!e&&!r)throw new Ni("either imageElement with a src set or an url must be provided");return r&&!e?this.decodeFromImageUrl(r):this.decodeFromImageElement(e)},t.prototype.decodeFromVideo=function(e,r){if(!e&&!r)throw new Ni("Either an element with a src set or an URL must be provided");return r&&!e?this.decodeFromVideoUrl(r):this.decodeFromVideoElement(e)},t.prototype.decodeFromVideoContinuously=function(e,r,n){if(e===void 0&&r===void 0)throw new Ni("Either an element with a src set or an URL must be provided");return r&&!e?this.decodeFromVideoUrlContinuously(r,n):this.decodeFromVideoElementContinuously(e,n)},t.prototype.decodeFromImageElement=function(e){if(!e)throw new Ni("An image element must be provided.");this.reset();var r=this.prepareImageElement(e);this.imageElement=r;var n;return this.isImageLoaded(r)?n=this.decodeOnce(r,!1,!0):n=this._decodeOnLoadImage(r),n},t.prototype.decodeFromVideoElement=function(e){var r=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(r)},t.prototype.decodeFromVideoElementContinuously=function(e,r){var n=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(n,r)},t.prototype._decodeFromVideoElementSetup=function(e){if(!e)throw new Ni("A video element must be provided.");this.reset();var r=this.prepareVideoElement(e);return this.videoElement=r,r},t.prototype.decodeFromImageUrl=function(e){if(!e)throw new Ni("An URL must be provided.");this.reset();var r=this.prepareImageElement();this.imageElement=r;var n=this._decodeOnLoadImage(r);return r.src=e,n},t.prototype.decodeFromVideoUrl=function(e){if(!e)throw new Ni("An URL must be provided.");this.reset();var r=this.prepareVideoElement(),n=this.decodeFromVideoElement(r);return r.src=e,n},t.prototype.decodeFromVideoUrlContinuously=function(e,r){if(!e)throw new Ni("An URL must be provided.");this.reset();var n=this.prepareVideoElement(),a=this.decodeFromVideoElementContinuously(n,r);return n.src=e,a},t.prototype._decodeOnLoadImage=function(e){var r=this;return new Promise(function(n,a){r.imageLoadedListener=function(){return r.decodeOnce(e,!1,!0).then(n,a)},e.addEventListener("load",r.imageLoadedListener)})},t.prototype._decodeOnLoadVideo=function(e){return Yl(this,void 0,void 0,function(){return Jl(this,function(r){switch(r.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return r.sent(),[4,this.decodeOnce(e)];case 2:return[2,r.sent()]}})})},t.prototype._decodeOnLoadVideoContinuously=function(e,r){return Yl(this,void 0,void 0,function(){return Jl(this,function(n){switch(n.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return n.sent(),this.decodeContinuously(e,r),[2]}})})},t.prototype.isImageLoaded=function(e){return!(!e.complete||e.naturalWidth===0)},t.prototype.prepareImageElement=function(e){var r;return typeof e>"u"&&(r=document.createElement("img"),r.width=200,r.height=200),typeof e=="string"&&(r=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(r=e),r},t.prototype.prepareVideoElement=function(e){var r;return!e&&typeof document<"u"&&(r=document.createElement("video"),r.width=200,r.height=200),typeof e=="string"&&(r=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(r=e),r.setAttribute("autoplay","true"),r.setAttribute("muted","true"),r.setAttribute("playsinline","true"),r},t.prototype.decodeOnce=function(e,r,n){var a=this;r===void 0&&(r=!0),n===void 0&&(n=!0),this._stopAsyncDecode=!1;var s=function(o,l){if(a._stopAsyncDecode){l(new Zt("Video stream has ended before any code could be detected.")),a._stopAsyncDecode=void 0;return}try{var c=a.decode(e);o(c)}catch(A){var u=r&&A instanceof Zt,d=A instanceof Vi||A instanceof Sr,f=d&&n;if(u||f)return setTimeout(s,a._timeBetweenDecodingAttempts,o,l);l(A)}};return new Promise(function(o,l){return s(o,l)})},t.prototype.decodeContinuously=function(e,r){var n=this;this._stopContinuousDecode=!1;var a=function(){if(n._stopContinuousDecode){n._stopContinuousDecode=void 0;return}try{var s=n.decode(e);r(s,null),setTimeout(a,n.timeBetweenScansMillis)}catch(c){r(null,c);var o=c instanceof Vi||c instanceof Sr,l=c instanceof Zt;(o||l)&&setTimeout(a,n._timeBetweenDecodingAttempts)}};a()},t.prototype.decode=function(e){var r=this.createBinaryBitmap(e);return this.decodeBitmap(r)},t.prototype.createBinaryBitmap=function(e){this.getCaptureCanvasContext(e);var r=!1;e instanceof HTMLVideoElement?(this.drawFrameOnCanvas(e),r=!0):this.drawImageOnCanvas(e);var n=this.getCaptureCanvas(e),a=new p3e(n,r),s=new $re(a);return new Hre(s)},t.prototype.getCaptureCanvasContext=function(e){if(!this.captureCanvasContext){var r=this.getCaptureCanvas(e),n=void 0;try{n=r.getContext("2d",{willReadFrequently:!0})}catch{n=r.getContext("2d")}this.captureCanvasContext=n}return this.captureCanvasContext},t.prototype.getCaptureCanvas=function(e){if(!this.captureCanvas){var r=this.createCaptureCanvas(e);this.captureCanvas=r}return this.captureCanvas},t.prototype.drawFrameOnCanvas=function(e,r,n){r===void 0&&(r={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),n===void 0&&(n=this.captureCanvasContext),n.drawImage(e,r.sx,r.sy,r.sWidth,r.sHeight,r.dx,r.dy,r.dWidth,r.dHeight)},t.prototype.drawImageOnCanvas=function(e,r,n){r===void 0&&(r={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),n===void 0&&(n=this.captureCanvasContext),n.drawImage(e,r.sx,r.sy,r.sWidth,r.sHeight,r.dx,r.dy,r.dWidth,r.dHeight)},t.prototype.decodeBitmap=function(e){return this.reader.decode(e,this._hints)},t.prototype.createCaptureCanvas=function(e){if(typeof document>"u")return this._destroyCaptureCanvas(),null;var r=document.createElement("canvas"),n,a;return typeof e<"u"&&(e instanceof HTMLVideoElement?(n=e.videoWidth,a=e.videoHeight):e instanceof HTMLImageElement&&(n=e.naturalWidth||e.width,a=e.naturalHeight||e.height)),r.style.width=n+"px",r.style.height=a+"px",r.width=n,r.height=a,r},t.prototype.stopStreams=function(){this.stream&&(this.stream.getVideoTracks().forEach(function(e){return e.stop()}),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()},t.prototype.reset=function(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()},t.prototype._destroyVideoElement=function(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)},t.prototype._destroyImageElement=function(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)},t.prototype._destroyCaptureCanvas=function(){this.captureCanvasContext=void 0,this.captureCanvas=void 0},t.prototype.addVideoSource=function(e,r){try{e.srcObject=r}catch{e.src=URL.createObjectURL(r)}},t.prototype.cleanVideoSource=function(e){try{e.srcObject=null}catch{e.src=""}this.videoElement.removeAttribute("src")},t}(),Vl=function(){function t(e,r,n,a,s,o){n===void 0&&(n=r==null?0:8*r.length),o===void 0&&(o=ss.currentTimeMillis()),this.text=e,this.rawBytes=r,this.numBits=n,this.resultPoints=a,this.format=s,this.timestamp=o,this.text=e,this.rawBytes=r,n==null?this.numBits=r==null?0:8*r.length:this.numBits=n,this.resultPoints=a,this.format=s,this.resultMetadata=null,o==null?this.timestamp=ss.currentTimeMillis():this.timestamp=o}return t.prototype.getText=function(){return this.text},t.prototype.getRawBytes=function(){return this.rawBytes},t.prototype.getNumBits=function(){return this.numBits},t.prototype.getResultPoints=function(){return this.resultPoints},t.prototype.getBarcodeFormat=function(){return this.format},t.prototype.getResultMetadata=function(){return this.resultMetadata},t.prototype.putMetadata=function(e,r){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(e,r)},t.prototype.putAllMetadata=function(e){e!==null&&(this.resultMetadata===null?this.resultMetadata=e:this.resultMetadata=new Map(e))},t.prototype.addResultPoints=function(e){var r=this.resultPoints;if(r===null)this.resultPoints=e;else if(e!==null&&e.length>0){var n=new Array(r.length+e.length);ss.arraycopy(r,0,n,0,r.length),ss.arraycopy(e,0,n,r.length,e.length),this.resultPoints=n}},t.prototype.getTimestamp=function(){return this.timestamp},t.prototype.toString=function(){return this.text},t}(),Dk;(function(t){t[t.AZTEC=0]="AZTEC",t[t.CODABAR=1]="CODABAR",t[t.CODE_39=2]="CODE_39",t[t.CODE_93=3]="CODE_93",t[t.CODE_128=4]="CODE_128",t[t.DATA_MATRIX=5]="DATA_MATRIX",t[t.EAN_8=6]="EAN_8",t[t.EAN_13=7]="EAN_13",t[t.ITF=8]="ITF",t[t.MAXICODE=9]="MAXICODE",t[t.PDF_417=10]="PDF_417",t[t.QR_CODE=11]="QR_CODE",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Dk||(Dk={}));const ln=Dk;var Rk;(function(t){t[t.OTHER=0]="OTHER",t[t.ORIENTATION=1]="ORIENTATION",t[t.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",t[t.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",t[t.ISSUE_NUMBER=4]="ISSUE_NUMBER",t[t.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",t[t.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",t[t.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",t[t.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",t[t.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",t[t.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Rk||(Rk={}));const ul=Rk;var Wj=function(){function t(e,r,n,a,s,o){s===void 0&&(s=-1),o===void 0&&(o=-1),this.rawBytes=e,this.text=r,this.byteSegments=n,this.ecLevel=a,this.structuredAppendSequenceNumber=s,this.structuredAppendParity=o,this.numBits=e==null?0:8*e.length}return t.prototype.getRawBytes=function(){return this.rawBytes},t.prototype.getNumBits=function(){return this.numBits},t.prototype.setNumBits=function(e){this.numBits=e},t.prototype.getText=function(){return this.text},t.prototype.getByteSegments=function(){return this.byteSegments},t.prototype.getECLevel=function(){return this.ecLevel},t.prototype.getErrorsCorrected=function(){return this.errorsCorrected},t.prototype.setErrorsCorrected=function(e){this.errorsCorrected=e},t.prototype.getErasures=function(){return this.erasures},t.prototype.setErasures=function(e){this.erasures=e},t.prototype.getOther=function(){return this.other},t.prototype.setOther=function(e){this.other=e},t.prototype.hasStructuredAppend=function(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0},t.prototype.getStructuredAppendParity=function(){return this.structuredAppendParity},t.prototype.getStructuredAppendSequenceNumber=function(){return this.structuredAppendSequenceNumber},t}(),Uy=function(){function t(){}return t.prototype.exp=function(e){return this.expTable[e]},t.prototype.log=function(e){if(e===0)throw new cn;return this.logTable[e]},t.addOrSubtract=function(e,r){return e^r},t}(),Z0=function(){function t(e,r){if(r.length===0)throw new cn;this.field=e;var n=r.length;if(n>1&&r[0]===0){for(var a=1;a<n&&r[a]===0;)a++;a===n?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(n-a),ss.arraycopy(r,a,this.coefficients,0,this.coefficients.length))}else this.coefficients=r}return t.prototype.getCoefficients=function(){return this.coefficients},t.prototype.getDegree=function(){return this.coefficients.length-1},t.prototype.isZero=function(){return this.coefficients[0]===0},t.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},t.prototype.evaluateAt=function(e){if(e===0)return this.getCoefficient(0);var r=this.coefficients,n;if(e===1){n=0;for(var a=0,s=r.length;a!==s;a++){var o=r[a];n=Uy.addOrSubtract(n,o)}return n}n=r[0];for(var l=r.length,c=this.field,a=1;a<l;a++)n=Uy.addOrSubtract(c.multiply(e,n),r[a]);return n},t.prototype.addOrSubtract=function(e){if(!this.field.equals(e.field))throw new cn("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;var r=this.coefficients,n=e.coefficients;if(r.length>n.length){var a=r;r=n,n=a}var s=new Int32Array(n.length),o=n.length-r.length;ss.arraycopy(n,0,s,0,o);for(var l=o;l<n.length;l++)s[l]=Uy.addOrSubtract(r[l-o],n[l]);return new t(this.field,s)},t.prototype.multiply=function(e){if(!this.field.equals(e.field))throw new cn("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();for(var r=this.coefficients,n=r.length,a=e.coefficients,s=a.length,o=new Int32Array(n+s-1),l=this.field,c=0;c<n;c++)for(var u=r[c],d=0;d<s;d++)o[c+d]=Uy.addOrSubtract(o[c+d],l.multiply(u,a[d]));return new t(l,o)},t.prototype.multiplyScalar=function(e){if(e===0)return this.field.getZero();if(e===1)return this;for(var r=this.coefficients.length,n=this.field,a=new Int32Array(r),s=this.coefficients,o=0;o<r;o++)a[o]=n.multiply(s[o],e);return new t(n,a)},t.prototype.multiplyByMonomial=function(e,r){if(e<0)throw new cn;if(r===0)return this.field.getZero();for(var n=this.coefficients,a=n.length,s=new Int32Array(a+e),o=this.field,l=0;l<a;l++)s[l]=o.multiply(n[l],r);return new t(o,s)},t.prototype.divide=function(e){if(!this.field.equals(e.field))throw new cn("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new cn("Divide by 0");for(var r=this.field,n=r.getZero(),a=this,s=e.getCoefficient(e.getDegree()),o=r.inverse(s);a.getDegree()>=e.getDegree()&&!a.isZero();){var l=a.getDegree()-e.getDegree(),c=r.multiply(a.getCoefficient(a.getDegree()),o),u=e.multiplyByMonomial(l,c),d=r.buildMonomial(l,c);n=n.addOrSubtract(d),a=a.addOrSubtract(u)}return[n,a]},t.prototype.toString=function(){for(var e="",r=this.getDegree();r>=0;r--){var n=this.getCoefficient(r);if(n!==0){if(n<0?(e+=" - ",n=-n):e.length>0&&(e+=" + "),r===0||n!==1){var a=this.field.log(n);a===0?e+="1":a===1?e+="a":(e+="a^",e+=a)}r!==0&&(r===1?e+="x":(e+="x^",e+=r))}}return e},t}(),v3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Gre=function(t){v3e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ArithmeticException",e}(Qc),y3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Bc=function(t){y3e(e,t);function e(r,n,a){var s=t.call(this)||this;s.primitive=r,s.size=n,s.generatorBase=a;for(var o=new Int32Array(n),l=1,c=0;c<n;c++)o[c]=l,l*=2,l>=n&&(l^=r,l&=n-1);s.expTable=o;for(var u=new Int32Array(n),c=0;c<n-1;c++)u[o[c]]=c;return s.logTable=u,s.zero=new Z0(s,Int32Array.from([0])),s.one=new Z0(s,Int32Array.from([1])),s}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(r,n){if(r<0)throw new cn;if(n===0)return this.zero;var a=new Int32Array(r+1);return a[0]=n,new Z0(this,a)},e.prototype.inverse=function(r){if(r===0)throw new Gre;return this.expTable[this.size-this.logTable[r]-1]},e.prototype.multiply=function(r,n){return r===0||n===0?0:this.expTable[(this.logTable[r]+this.logTable[n])%(this.size-1)]},e.prototype.getSize=function(){return this.size},e.prototype.getGeneratorBase=function(){return this.generatorBase},e.prototype.toString=function(){return"GF(0x"+Hn.toHexString(this.primitive)+","+this.size+")"},e.prototype.equals=function(r){return r===this},e.AZTEC_DATA_12=new e(4201,4096,1),e.AZTEC_DATA_10=new e(1033,1024,1),e.AZTEC_DATA_6=new e(67,64,1),e.AZTEC_PARAM=new e(19,16,1),e.QR_CODE_FIELD_256=new e(285,256,0),e.DATA_MATRIX_FIELD_256=new e(301,256,1),e.AZTEC_DATA_8=e.DATA_MATRIX_FIELD_256,e.MAXICODE_FIELD_64=e.AZTEC_DATA_6,e}(Uy),b3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),MC=function(t){b3e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ReedSolomonException",e}(Qc),w3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),jw=function(t){w3e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="IllegalStateException",e}(Qc),Xj=function(){function t(e){this.field=e}return t.prototype.decode=function(e,r){for(var n=this.field,a=new Z0(n,e),s=new Int32Array(r),o=!0,l=0;l<r;l++){var c=a.evaluateAt(n.exp(l+n.getGeneratorBase()));s[s.length-1-l]=c,c!==0&&(o=!1)}if(!o)for(var u=new Z0(n,s),d=this.runEuclideanAlgorithm(n.buildMonomial(r,1),u,r),f=d[0],A=d[1],h=this.findErrorLocations(f),m=this.findErrorMagnitudes(A,h),l=0;l<h.length;l++){var p=e.length-1-n.log(h[l]);if(p<0)throw new MC("Bad error location");e[p]=Bc.addOrSubtract(e[p],m[l])}},t.prototype.runEuclideanAlgorithm=function(e,r,n){if(e.getDegree()<r.getDegree()){var a=e;e=r,r=a}for(var s=this.field,o=e,l=r,c=s.getZero(),u=s.getOne();l.getDegree()>=(n/2|0);){var d=o,f=c;if(o=l,c=u,o.isZero())throw new MC("r_{i-1} was zero");l=d;for(var A=s.getZero(),h=o.getCoefficient(o.getDegree()),m=s.inverse(h);l.getDegree()>=o.getDegree()&&!l.isZero();){var p=l.getDegree()-o.getDegree(),g=s.multiply(l.getCoefficient(l.getDegree()),m);A=A.addOrSubtract(s.buildMonomial(p,g)),l=l.addOrSubtract(o.multiplyByMonomial(p,g))}if(u=A.multiply(c).addOrSubtract(f),l.getDegree()>=o.getDegree())throw new jw("Division algorithm failed to reduce polynomial?")}var v=u.getCoefficient(0);if(v===0)throw new MC("sigmaTilde(0) was zero");var y=s.inverse(v),b=u.multiplyScalar(y),w=l.multiplyScalar(y);return[b,w]},t.prototype.findErrorLocations=function(e){var r=e.getDegree();if(r===1)return Int32Array.from([e.getCoefficient(1)]);for(var n=new Int32Array(r),a=0,s=this.field,o=1;o<s.getSize()&&a<r;o++)e.evaluateAt(o)===0&&(n[a]=s.inverse(o),a++);if(a!==r)throw new MC("Error locator degree does not match number of roots");return n},t.prototype.findErrorMagnitudes=function(e,r){for(var n=r.length,a=new Int32Array(n),s=this.field,o=0;o<n;o++){for(var l=s.inverse(r[o]),c=1,u=0;u<n;u++)if(o!==u){var d=s.multiply(r[u],l),f=d&1?d&-2:d|1;c=s.multiply(c,f)}a[o]=s.multiply(e.evaluateAt(l),s.inverse(c)),s.getGeneratorBase()!==0&&(a[o]=s.multiply(a[o],l))}return a},t}(),Yo;(function(t){t[t.UPPER=0]="UPPER",t[t.LOWER=1]="LOWER",t[t.MIXED=2]="MIXED",t[t.DIGIT=3]="DIGIT",t[t.PUNCT=4]="PUNCT",t[t.BINARY=5]="BINARY"})(Yo||(Yo={}));var JV=function(){function t(){}return t.prototype.decode=function(e){this.ddata=e;var r=e.getBits(),n=this.extractBits(r),a=this.correctBits(n),s=t.convertBoolArrayToByteArray(a),o=t.getEncodedData(a),l=new Wj(s,o,null,null);return l.setNumBits(a.length),l},t.highLevelDecode=function(e){return this.getEncodedData(e)},t.getEncodedData=function(e){for(var r=e.length,n=Yo.UPPER,a=Yo.UPPER,s="",o=0;o<r;)if(a===Yo.BINARY){if(r-o<5)break;var l=t.readCode(e,o,5);if(o+=5,l===0){if(r-o<11)break;l=t.readCode(e,o,11)+31,o+=11}for(var c=0;c<l;c++){if(r-o<8){o=r;break}var u=t.readCode(e,o,8);s+=ra.castAsNonUtf8Char(u),o+=8}a=n}else{var d=a===Yo.DIGIT?4:5;if(r-o<d)break;var u=t.readCode(e,o,d);o+=d;var f=t.getCharacter(a,u);f.startsWith("CTRL_")?(n=a,a=t.getTable(f.charAt(5)),f.charAt(6)==="L"&&(n=a)):(s+=f,a=n)}return s},t.getTable=function(e){switch(e){case"L":return Yo.LOWER;case"P":return Yo.PUNCT;case"M":return Yo.MIXED;case"D":return Yo.DIGIT;case"B":return Yo.BINARY;case"U":default:return Yo.UPPER}},t.getCharacter=function(e,r){switch(e){case Yo.UPPER:return t.UPPER_TABLE[r];case Yo.LOWER:return t.LOWER_TABLE[r];case Yo.MIXED:return t.MIXED_TABLE[r];case Yo.PUNCT:return t.PUNCT_TABLE[r];case Yo.DIGIT:return t.DIGIT_TABLE[r];default:throw new jw("Bad table")}},t.prototype.correctBits=function(e){var r,n;this.ddata.getNbLayers()<=2?(n=6,r=Bc.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(n=8,r=Bc.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(n=10,r=Bc.AZTEC_DATA_10):(n=12,r=Bc.AZTEC_DATA_12);var a=this.ddata.getNbDatablocks(),s=e.length/n;if(s<a)throw new Sr;for(var o=e.length%n,l=new Int32Array(s),c=0;c<s;c++,o+=n)l[c]=t.readCode(e,o,n);try{var u=new Xj(r);u.decode(l,s-a)}catch(g){throw new Sr(g)}for(var d=(1<<n)-1,f=0,c=0;c<a;c++){var A=l[c];if(A===0||A===d)throw new Sr;(A===1||A===d-1)&&f++}for(var h=new Array(a*n-f),m=0,c=0;c<a;c++){var A=l[c];if(A===1||A===d-1)h.fill(A>1,m,m+n-1),m+=n-1;else for(var p=n-1;p>=0;--p)h[m++]=(A&1<<p)!==0}return h},t.prototype.extractBits=function(e){var r=this.ddata.isCompact(),n=this.ddata.getNbLayers(),a=(r?11:14)+n*4,s=new Int32Array(a),o=new Array(this.totalBitsInLayer(n,r));if(r)for(var l=0;l<s.length;l++)s[l]=l;else for(var c=a+1+2*Hn.truncDivision(Hn.truncDivision(a,2)-1,15),u=a/2,d=Hn.truncDivision(c,2),l=0;l<u;l++){var f=l+Hn.truncDivision(l,15);s[u-l-1]=d-f-1,s[u+l]=d+f+1}for(var l=0,A=0;l<n;l++){for(var h=(n-l)*4+(r?9:12),m=l*2,p=a-1-m,g=0;g<h;g++)for(var v=g*2,y=0;y<2;y++)o[A+v+y]=e.get(s[m+y],s[m+g]),o[A+2*h+v+y]=e.get(s[m+g],s[p-y]),o[A+4*h+v+y]=e.get(s[p-y],s[p-g]),o[A+6*h+v+y]=e.get(s[p-g],s[m+y]);A+=h*8}return o},t.readCode=function(e,r,n){for(var a=0,s=r;s<r+n;s++)a<<=1,e[s]&&(a|=1);return a},t.readByte=function(e,r){var n=e.length-r;return n>=8?t.readCode(e,r,8):t.readCode(e,r,n)<<8-n},t.convertBoolArrayToByteArray=function(e){for(var r=new Uint8Array((e.length+7)/8),n=0;n<r.length;n++)r[n]=t.readByte(e,8*n);return r},t.prototype.totalBitsInLayer=function(e,r){return((r?88:112)+16*e)*e},t.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],t.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],t.MIXED_TABLE=["CTRL_PS"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~","","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],t.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],t.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"],t}(),da=function(){function t(){}return t.round=function(e){return isNaN(e)?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0},t.distance=function(e,r,n,a){var s=e-n,o=r-a;return Math.sqrt(s*s+o*o)},t.sum=function(e){for(var r=0,n=0,a=e.length;n!==a;n++){var s=e[n];r+=s}return r},t}(),Mk=function(){function t(){}return t.floatToIntBits=function(e){return e},t.MAX_VALUE=Number.MAX_SAFE_INTEGER,t}(),Kr=function(){function t(e,r){this.x=e,this.y=r}return t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.equals=function(e){if(e instanceof t){var r=e;return this.x===r.x&&this.y===r.y}return!1},t.prototype.hashCode=function(){return 31*Mk.floatToIntBits(this.x)+Mk.floatToIntBits(this.y)},t.prototype.toString=function(){return"("+this.x+","+this.y+")"},t.orderBestPatterns=function(e){var r=this.distance(e[0],e[1]),n=this.distance(e[1],e[2]),a=this.distance(e[0],e[2]),s,o,l;if(n>=r&&n>=a?(o=e[0],s=e[1],l=e[2]):a>=n&&a>=r?(o=e[1],s=e[0],l=e[2]):(o=e[2],s=e[0],l=e[1]),this.crossProductZ(s,o,l)<0){var c=s;s=l,l=c}e[0]=s,e[1]=o,e[2]=l},t.distance=function(e,r){return da.distance(e.x,e.y,r.x,r.y)},t.crossProductZ=function(e,r,n){var a=r.x,s=r.y;return(n.x-a)*(e.y-s)-(n.y-s)*(e.x-a)},t}(),T6=function(){function t(e,r){this.bits=e,this.points=r}return t.prototype.getBits=function(){return this.bits},t.prototype.getPoints=function(){return this.points},t}(),N3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),C3e=function(t){N3e(e,t);function e(r,n,a,s,o){var l=t.call(this,r,n)||this;return l.compact=a,l.nbDatablocks=s,l.nbLayers=o,l}return e.prototype.getNbLayers=function(){return this.nbLayers},e.prototype.getNbDatablocks=function(){return this.nbDatablocks},e.prototype.isCompact=function(){return this.compact},e}(T6),Lk=function(){function t(e,r,n,a){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),r==null&&(r=t.INIT_SIZE),n==null&&(n=e.getWidth()/2|0),a==null&&(a=e.getHeight()/2|0);var s=r/2|0;if(this.leftInit=n-s,this.rightInit=n+s,this.upInit=a-s,this.downInit=a+s,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new Zt}return t.prototype.detect=function(){for(var e=this.leftInit,r=this.rightInit,n=this.upInit,a=this.downInit,s=!1,o=!0,l=!1,c=!1,u=!1,d=!1,f=!1,A=this.width,h=this.height;o;){o=!1;for(var m=!0;(m||!c)&&r<A;)m=this.containsBlackPoint(n,a,r,!1),m?(r++,o=!0,c=!0):c||r++;if(r>=A){s=!0;break}for(var p=!0;(p||!u)&&a<h;)p=this.containsBlackPoint(e,r,a,!0),p?(a++,o=!0,u=!0):u||a++;if(a>=h){s=!0;break}for(var g=!0;(g||!d)&&e>=0;)g=this.containsBlackPoint(n,a,e,!1),g?(e--,o=!0,d=!0):d||e--;if(e<0){s=!0;break}for(var v=!0;(v||!f)&&n>=0;)v=this.containsBlackPoint(e,r,n,!0),v?(n--,o=!0,f=!0):f||n--;if(n<0){s=!0;break}o&&(l=!0)}if(!s&&l){for(var y=r-e,b=null,w=1;b===null&&w<y;w++)b=this.getBlackPointOnSegment(e,a-w,e+w,a);if(b==null)throw new Zt;for(var j=null,w=1;j===null&&w<y;w++)j=this.getBlackPointOnSegment(e,n+w,e+w,n);if(j==null)throw new Zt;for(var I=null,w=1;I===null&&w<y;w++)I=this.getBlackPointOnSegment(r,n+w,r-w,n);if(I==null)throw new Zt;for(var _=null,w=1;_===null&&w<y;w++)_=this.getBlackPointOnSegment(r,a-w,r-w,a);if(_==null)throw new Zt;return this.centerEdges(_,b,I,j)}else throw new Zt},t.prototype.getBlackPointOnSegment=function(e,r,n,a){for(var s=da.round(da.distance(e,r,n,a)),o=(n-e)/s,l=(a-r)/s,c=this.image,u=0;u<s;u++){var d=da.round(e+u*o),f=da.round(r+u*l);if(c.get(d,f))return new Kr(d,f)}return null},t.prototype.centerEdges=function(e,r,n,a){var s=e.getX(),o=e.getY(),l=r.getX(),c=r.getY(),u=n.getX(),d=n.getY(),f=a.getX(),A=a.getY(),h=t.CORR;return s<this.width/2?[new Kr(f-h,A+h),new Kr(l+h,c+h),new Kr(u-h,d-h),new Kr(s+h,o-h)]:[new Kr(f+h,A+h),new Kr(l+h,c-h),new Kr(u-h,d+h),new Kr(s-h,o-h)]},t.prototype.containsBlackPoint=function(e,r,n,a){var s=this.image;if(a){for(var o=e;o<=r;o++)if(s.get(o,n))return!0}else for(var l=e;l<=r;l++)if(s.get(n,l))return!0;return!1},t.INIT_SIZE=10,t.CORR=1,t}(),ZV=function(){function t(){}return t.checkAndNudgePoints=function(e,r){for(var n=e.getWidth(),a=e.getHeight(),s=!0,o=0;o<r.length&&s;o+=2){var l=Math.floor(r[o]),c=Math.floor(r[o+1]);if(l<-1||l>n||c<-1||c>a)throw new Zt;s=!1,l===-1?(r[o]=0,s=!0):l===n&&(r[o]=n-1,s=!0),c===-1?(r[o+1]=0,s=!0):c===a&&(r[o+1]=a-1,s=!0)}s=!0;for(var o=r.length-2;o>=0&&s;o-=2){var l=Math.floor(r[o]),c=Math.floor(r[o+1]);if(l<-1||l>n||c<-1||c>a)throw new Zt;s=!1,l===-1?(r[o]=0,s=!0):l===n&&(r[o]=n-1,s=!0),c===-1?(r[o+1]=0,s=!0):c===a&&(r[o+1]=a-1,s=!0)}},t}(),Kre=function(){function t(e,r,n,a,s,o,l,c,u){this.a11=e,this.a21=r,this.a31=n,this.a12=a,this.a22=s,this.a32=o,this.a13=l,this.a23=c,this.a33=u}return t.quadrilateralToQuadrilateral=function(e,r,n,a,s,o,l,c,u,d,f,A,h,m,p,g){var v=t.quadrilateralToSquare(e,r,n,a,s,o,l,c),y=t.squareToQuadrilateral(u,d,f,A,h,m,p,g);return y.times(v)},t.prototype.transformPoints=function(e){for(var r=e.length,n=this.a11,a=this.a12,s=this.a13,o=this.a21,l=this.a22,c=this.a23,u=this.a31,d=this.a32,f=this.a33,A=0;A<r;A+=2){var h=e[A],m=e[A+1],p=s*h+c*m+f;e[A]=(n*h+o*m+u)/p,e[A+1]=(a*h+l*m+d)/p}},t.prototype.transformPointsWithValues=function(e,r){for(var n=this.a11,a=this.a12,s=this.a13,o=this.a21,l=this.a22,c=this.a23,u=this.a31,d=this.a32,f=this.a33,A=e.length,h=0;h<A;h++){var m=e[h],p=r[h],g=s*m+c*p+f;e[h]=(n*m+o*p+u)/g,r[h]=(a*m+l*p+d)/g}},t.squareToQuadrilateral=function(e,r,n,a,s,o,l,c){var u=e-n+s-l,d=r-a+o-c;if(u===0&&d===0)return new t(n-e,s-n,e,a-r,o-a,r,0,0,1);var f=n-s,A=l-s,h=a-o,m=c-o,p=f*m-A*h,g=(u*m-A*d)/p,v=(f*d-u*h)/p;return new t(n-e+g*n,l-e+v*l,e,a-r+g*a,c-r+v*c,r,g,v,1)},t.quadrilateralToSquare=function(e,r,n,a,s,o,l,c){return t.squareToQuadrilateral(e,r,n,a,s,o,l,c).buildAdjoint()},t.prototype.buildAdjoint=function(){return new t(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},t.prototype.times=function(e){return new t(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)},t}(),_3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),E3e=function(t){_3e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.sampleGrid=function(r,n,a,s,o,l,c,u,d,f,A,h,m,p,g,v,y,b,w){var j=Kre.quadrilateralToQuadrilateral(s,o,l,c,u,d,f,A,h,m,p,g,v,y,b,w);return this.sampleGridWithTransform(r,n,a,j)},e.prototype.sampleGridWithTransform=function(r,n,a,s){if(n<=0||a<=0)throw new Zt;for(var o=new Kf(n,a),l=new Float32Array(2*n),c=0;c<a;c++){for(var u=l.length,d=c+.5,f=0;f<u;f+=2)l[f]=f/2+.5,l[f+1]=d;s.transformPoints(l),ZV.checkAndNudgePoints(r,l);try{for(var f=0;f<u;f+=2)r.get(Math.floor(l[f]),Math.floor(l[f+1]))&&o.set(f/2,c)}catch{throw new Zt}}return o},e}(ZV),k6=function(){function t(){}return t.setGridSampler=function(e){t.gridSampler=e},t.getInstance=function(){return t.gridSampler},t.gridSampler=new E3e,t}(),Nc=function(){function t(e,r){this.x=e,this.y=r}return t.prototype.toResultPoint=function(){return new Kr(this.getX(),this.getY())},t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t}(),S3e=function(){function t(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}return t.prototype.detect=function(){return this.detectMirror(!1)},t.prototype.detectMirror=function(e){var r=this.getMatrixCenter(),n=this.getBullsEyeCorners(r);if(e){var a=n[0];n[0]=n[2],n[2]=a}this.extractParameters(n);var s=this.sampleGrid(this.image,n[this.shift%4],n[(this.shift+1)%4],n[(this.shift+2)%4],n[(this.shift+3)%4]),o=this.getMatrixCornerPoints(n);return new C3e(s,o,this.compact,this.nbDataBlocks,this.nbLayers)},t.prototype.extractParameters=function(e){if(!this.isValidPoint(e[0])||!this.isValidPoint(e[1])||!this.isValidPoint(e[2])||!this.isValidPoint(e[3]))throw new Zt;var r=2*this.nbCenterLayers,n=new Int32Array([this.sampleLine(e[0],e[1],r),this.sampleLine(e[1],e[2],r),this.sampleLine(e[2],e[3],r),this.sampleLine(e[3],e[0],r)]);this.shift=this.getRotation(n,r);for(var a=0,s=0;s<4;s++){var o=n[(this.shift+s)%4];this.compact?(a<<=7,a+=o>>1&127):(a<<=10,a+=(o>>2&992)+(o>>1&31))}var l=this.getCorrectedParameterData(a,this.compact);this.compact?(this.nbLayers=(l>>6)+1,this.nbDataBlocks=(l&63)+1):(this.nbLayers=(l>>11)+1,this.nbDataBlocks=(l&2047)+1)},t.prototype.getRotation=function(e,r){var n=0;e.forEach(function(s,o,l){var c=(s>>r-2<<1)+(s&1);n=(n<<3)+c}),n=((n&1)<<11)+(n>>1);for(var a=0;a<4;a++)if(Hn.bitCount(n^this.EXPECTED_CORNER_BITS[a])<=2)return a;throw new Zt},t.prototype.getCorrectedParameterData=function(e,r){var n,a;r?(n=7,a=2):(n=10,a=4);for(var s=n-a,o=new Int32Array(n),l=n-1;l>=0;--l)o[l]=e&15,e>>=4;try{var c=new Xj(Bc.AZTEC_PARAM);c.decode(o,s)}catch{throw new Zt}for(var u=0,l=0;l<a;l++)u=(u<<4)+o[l];return u},t.prototype.getBullsEyeCorners=function(e){var r=e,n=e,a=e,s=e,o=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){var l=this.getFirstDifferent(r,o,1,-1),c=this.getFirstDifferent(n,o,1,1),u=this.getFirstDifferent(a,o,-1,1),d=this.getFirstDifferent(s,o,-1,-1);if(this.nbCenterLayers>2){var f=this.distancePoint(d,l)*this.nbCenterLayers/(this.distancePoint(s,r)*(this.nbCenterLayers+2));if(f<.75||f>1.25||!this.isWhiteOrBlackRectangle(l,c,u,d))break}r=l,n=c,a=u,s=d,o=!o}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new Zt;this.compact=this.nbCenterLayers===5;var A=new Kr(r.getX()+.5,r.getY()-.5),h=new Kr(n.getX()+.5,n.getY()+.5),m=new Kr(a.getX()-.5,a.getY()+.5),p=new Kr(s.getX()-.5,s.getY()-.5);return this.expandSquare([A,h,m,p],2*this.nbCenterLayers-3,2*this.nbCenterLayers)},t.prototype.getMatrixCenter=function(){var e,r,n,a;try{var s=new Lk(this.image).detect();e=s[0],r=s[1],n=s[2],a=s[3]}catch{var o=this.image.getWidth()/2,l=this.image.getHeight()/2;e=this.getFirstDifferent(new Nc(o+7,l-7),!1,1,-1).toResultPoint(),r=this.getFirstDifferent(new Nc(o+7,l+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new Nc(o-7,l+7),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new Nc(o-7,l-7),!1,-1,-1).toResultPoint()}var c=da.round((e.getX()+a.getX()+r.getX()+n.getX())/4),u=da.round((e.getY()+a.getY()+r.getY()+n.getY())/4);try{var s=new Lk(this.image,15,c,u).detect();e=s[0],r=s[1],n=s[2],a=s[3]}catch{e=this.getFirstDifferent(new Nc(c+7,u-7),!1,1,-1).toResultPoint(),r=this.getFirstDifferent(new Nc(c+7,u+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new Nc(c-7,u+7),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new Nc(c-7,u-7),!1,-1,-1).toResultPoint()}return c=da.round((e.getX()+a.getX()+r.getX()+n.getX())/4),u=da.round((e.getY()+a.getY()+r.getY()+n.getY())/4),new Nc(c,u)},t.prototype.getMatrixCornerPoints=function(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())},t.prototype.sampleGrid=function(e,r,n,a,s){var o=k6.getInstance(),l=this.getDimension(),c=l/2-this.nbCenterLayers,u=l/2+this.nbCenterLayers;return o.sampleGrid(e,l,l,c,c,u,c,u,u,c,u,r.getX(),r.getY(),n.getX(),n.getY(),a.getX(),a.getY(),s.getX(),s.getY())},t.prototype.sampleLine=function(e,r,n){for(var a=0,s=this.distanceResultPoint(e,r),o=s/n,l=e.getX(),c=e.getY(),u=o*(r.getX()-e.getX())/s,d=o*(r.getY()-e.getY())/s,f=0;f<n;f++)this.image.get(da.round(l+f*u),da.round(c+f*d))&&(a|=1<<n-f-1);return a},t.prototype.isWhiteOrBlackRectangle=function(e,r,n,a){var s=3;e=new Nc(e.getX()-s,e.getY()+s),r=new Nc(r.getX()-s,r.getY()-s),n=new Nc(n.getX()+s,n.getY()-s),a=new Nc(a.getX()+s,a.getY()+s);var o=this.getColor(a,e);if(o===0)return!1;var l=this.getColor(e,r);return l!==o||(l=this.getColor(r,n),l!==o)?!1:(l=this.getColor(n,a),l===o)},t.prototype.getColor=function(e,r){for(var n=this.distancePoint(e,r),a=(r.getX()-e.getX())/n,s=(r.getY()-e.getY())/n,o=0,l=e.getX(),c=e.getY(),u=this.image.get(e.getX(),e.getY()),d=Math.ceil(n),f=0;f<d;f++)l+=a,c+=s,this.image.get(da.round(l),da.round(c))!==u&&o++;var A=o/n;return A>.1&&A<.9?0:A<=.1===u?1:-1},t.prototype.getFirstDifferent=function(e,r,n,a){for(var s=e.getX()+n,o=e.getY()+a;this.isValid(s,o)&&this.image.get(s,o)===r;)s+=n,o+=a;for(s-=n,o-=a;this.isValid(s,o)&&this.image.get(s,o)===r;)s+=n;for(s-=n;this.isValid(s,o)&&this.image.get(s,o)===r;)o+=a;return o-=a,new Nc(s,o)},t.prototype.expandSquare=function(e,r,n){var a=n/(2*r),s=e[0].getX()-e[2].getX(),o=e[0].getY()-e[2].getY(),l=(e[0].getX()+e[2].getX())/2,c=(e[0].getY()+e[2].getY())/2,u=new Kr(l+a*s,c+a*o),d=new Kr(l-a*s,c-a*o);s=e[1].getX()-e[3].getX(),o=e[1].getY()-e[3].getY(),l=(e[1].getX()+e[3].getX())/2,c=(e[1].getY()+e[3].getY())/2;var f=new Kr(l+a*s,c+a*o),A=new Kr(l-a*s,c-a*o),h=[u,f,d,A];return h},t.prototype.isValid=function(e,r){return e>=0&&e<this.image.getWidth()&&r>0&&r<this.image.getHeight()},t.prototype.isValidPoint=function(e){var r=da.round(e.getX()),n=da.round(e.getY());return this.isValid(r,n)},t.prototype.distancePoint=function(e,r){return da.distance(e.getX(),e.getY(),r.getX(),r.getY())},t.prototype.distanceResultPoint=function(e,r){return da.distance(e.getX(),e.getY(),r.getX(),r.getY())},t.prototype.getDimension=function(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(Hn.truncDivision(this.nbLayers-4,8)+1)+15},t}(),IS=function(){function t(){}return t.prototype.decode=function(e,r){r===void 0&&(r=null);var n=null,a=new S3e(e.getBlackMatrix()),s=null,o=null;try{var l=a.detectMirror(!1);s=l.getPoints(),this.reportFoundResultPoints(r,s),o=new JV().decode(l)}catch(f){n=f}if(o==null)try{var l=a.detectMirror(!0);s=l.getPoints(),this.reportFoundResultPoints(r,s),o=new JV().decode(l)}catch(f){throw n??f}var c=new Vl(o.getText(),o.getRawBytes(),o.getNumBits(),s,ln.AZTEC,ss.currentTimeMillis()),u=o.getByteSegments();u!=null&&c.putMetadata(ul.BYTE_SEGMENTS,u);var d=o.getECLevel();return d!=null&&c.putMetadata(ul.ERROR_CORRECTION_LEVEL,d),c},t.prototype.reportFoundResultPoints=function(e,r){if(e!=null){var n=e.get(is.NEED_RESULT_POINT_CALLBACK);n!=null&&r.forEach(function(a,s,o){n.foundPossibleResultPoint(a)})}},t.prototype.reset=function(){},t}(),I3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){I3e(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new IS,r)||this}return e})(u1);var ho=function(){function t(){}return t.prototype.decode=function(e,r){try{return this.doDecode(e,r)}catch{var n=r&&r.get(is.TRY_HARDER)===!0;if(n&&e.isRotateSupported()){var a=e.rotateCounterClockwise(),s=this.doDecode(a,r),o=s.getResultMetadata(),l=270;o!==null&&o.get(ul.ORIENTATION)===!0&&(l=l+o.get(ul.ORIENTATION)%360),s.putMetadata(ul.ORIENTATION,l);var c=s.getResultPoints();if(c!==null)for(var u=a.getHeight(),d=0;d<c.length;d++)c[d]=new Kr(u-c[d].getY()-1,c[d].getX());return s}else throw new Zt}},t.prototype.reset=function(){},t.prototype.doDecode=function(e,r){var n=e.getWidth(),a=e.getHeight(),s=new Oo(n),o=r&&r.get(is.TRY_HARDER)===!0,l=Math.max(1,a>>(o?8:5)),c;o?c=a:c=15;for(var u=Math.trunc(a/2),d=0;d<c;d++){var f=Math.trunc((d+1)/2),A=(d&1)===0,h=u+l*(A?f:-f);if(h<0||h>=a)break;try{s=e.getBlackRow(h,s)}catch{continue}for(var m=function(y){if(y===1&&(s.reverse(),r&&r.get(is.NEED_RESULT_POINT_CALLBACK)===!0)){var b=new Map;r.forEach(function(I,_){return b.set(_,I)}),b.delete(is.NEED_RESULT_POINT_CALLBACK),r=b}try{var w=p.decodeRow(h,s,r);if(y===1){w.putMetadata(ul.ORIENTATION,180);var j=w.getResultPoints();j!==null&&(j[0]=new Kr(n-j[0].getX()-1,j[0].getY()),j[1]=new Kr(n-j[1].getX()-1,j[1].getY()))}return{value:w}}catch{}},p=this,g=0;g<2;g++){var v=m(g);if(typeof v=="object")return v.value}}throw new Zt},t.recordPattern=function(e,r,n){for(var a=n.length,s=0;s<a;s++)n[s]=0;var o=e.getSize();if(r>=o)throw new Zt;for(var l=!e.get(r),c=0,u=r;u<o;){if(e.get(u)!==l)n[c]++;else{if(++c===a)break;n[c]=1,l=!l}u++}if(!(c===a||c===a-1&&u===o))throw new Zt},t.recordPatternInReverse=function(e,r,n){for(var a=n.length,s=e.get(r);r>0&&a>=0;)e.get(--r)!==s&&(a--,s=!s);if(a>=0)throw new Zt;t.recordPattern(e,r+1,n)},t.patternMatchVariance=function(e,r,n){for(var a=e.length,s=0,o=0,l=0;l<a;l++)s+=e[l],o+=r[l];if(s<o)return Number.POSITIVE_INFINITY;var c=s/o;n*=c;for(var u=0,d=0;d<a;d++){var f=e[d],A=r[d]*c,h=f>A?f-A:A-f;if(h>n)return Number.POSITIVE_INFINITY;u+=h}return u/s},t}(),j3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),eH=function(t){j3e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.findStartPattern=function(r){for(var n=r.getSize(),a=r.getNextSet(0),s=0,o=Int32Array.from([0,0,0,0,0,0]),l=a,c=!1,u=6,d=a;d<n;d++)if(r.get(d)!==c)o[s]++;else{if(s===u-1){for(var f=e.MAX_AVG_VARIANCE,A=-1,h=e.CODE_START_A;h<=e.CODE_START_C;h++){var m=ho.patternMatchVariance(o,e.CODE_PATTERNS[h],e.MAX_INDIVIDUAL_VARIANCE);m<f&&(f=m,A=h)}if(A>=0&&r.isRange(Math.max(0,l-(d-l)/2),l,!1))return Int32Array.from([l,d,A]);l+=o[0]+o[1],o=o.slice(2,o.length),o[s-1]=0,o[s]=0,s--}else s++;o[s]=1,c=!c}throw new Zt},e.decodeCode=function(r,n,a){ho.recordPattern(r,a,n);for(var s=e.MAX_AVG_VARIANCE,o=-1,l=0;l<e.CODE_PATTERNS.length;l++){var c=e.CODE_PATTERNS[l],u=this.patternMatchVariance(n,c,e.MAX_INDIVIDUAL_VARIANCE);u<s&&(s=u,o=l)}if(o>=0)return o;throw new Zt},e.prototype.decodeRow=function(r,n,a){var s=a&&a.get(is.ASSUME_GS1)===!0,o=e.findStartPattern(n),l=o[2],c=0,u=new Uint8Array(20);u[c++]=l;var d;switch(l){case e.CODE_START_A:d=e.CODE_CODE_A;break;case e.CODE_START_B:d=e.CODE_CODE_B;break;case e.CODE_START_C:d=e.CODE_CODE_C;break;default:throw new Sr}for(var f=!1,A=!1,h="",m=o[0],p=o[1],g=Int32Array.from([0,0,0,0,0,0]),v=0,y=0,b=l,w=0,j=!0,I=!1,_=!1;!f;){var S=A;switch(A=!1,v=y,y=e.decodeCode(n,g,p),u[c++]=y,y!==e.CODE_STOP&&(j=!0),y!==e.CODE_STOP&&(w++,b+=w*y),m=p,p+=g.reduce(function(fe,xe){return fe+xe},0),y){case e.CODE_START_A:case e.CODE_START_B:case e.CODE_START_C:throw new Sr}switch(d){case e.CODE_CODE_A:if(y<64)_===I?h+=String.fromCharCode(32+y):h+=String.fromCharCode(32+y+128),_=!1;else if(y<96)_===I?h+=String.fromCharCode(y-64):h+=String.fromCharCode(y+64),_=!1;else switch(y!==e.CODE_STOP&&(j=!1),y){case e.CODE_FNC_1:s&&(h.length===0?h+="]C1":h+="");break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_A:!I&&_?(I=!0,_=!1):I&&_?(I=!1,_=!1):_=!0;break;case e.CODE_SHIFT:A=!0,d=e.CODE_CODE_B;break;case e.CODE_CODE_B:d=e.CODE_CODE_B;break;case e.CODE_CODE_C:d=e.CODE_CODE_C;break;case e.CODE_STOP:f=!0;break}break;case e.CODE_CODE_B:if(y<96)_===I?h+=String.fromCharCode(32+y):h+=String.fromCharCode(32+y+128),_=!1;else switch(y!==e.CODE_STOP&&(j=!1),y){case e.CODE_FNC_1:s&&(h.length===0?h+="]C1":h+="");break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_B:!I&&_?(I=!0,_=!1):I&&_?(I=!1,_=!1):_=!0;break;case e.CODE_SHIFT:A=!0,d=e.CODE_CODE_A;break;case e.CODE_CODE_A:d=e.CODE_CODE_A;break;case e.CODE_CODE_C:d=e.CODE_CODE_C;break;case e.CODE_STOP:f=!0;break}break;case e.CODE_CODE_C:if(y<100)y<10&&(h+="0"),h+=y;else switch(y!==e.CODE_STOP&&(j=!1),y){case e.CODE_FNC_1:s&&(h.length===0?h+="]C1":h+="");break;case e.CODE_CODE_A:d=e.CODE_CODE_A;break;case e.CODE_CODE_B:d=e.CODE_CODE_B;break;case e.CODE_STOP:f=!0;break}break}S&&(d=d===e.CODE_CODE_A?e.CODE_CODE_B:e.CODE_CODE_A)}var E=p-m;if(p=n.getNextUnset(p),!n.isRange(p,Math.min(n.getSize(),p+(p-m)/2),!1))throw new Zt;if(b-=w*v,b%103!==v)throw new Vi;var F=h.length;if(F===0)throw new Zt;F>0&&j&&(d===e.CODE_CODE_C?h=h.substring(0,F-2):h=h.substring(0,F-1));for(var k=(o[1]+o[0])/2,P=m+E/2,D=u.length,X=new Uint8Array(D),pe=0;pe<D;pe++)X[pe]=u[pe];var ge=[new Kr(k,r),new Kr(P,r)];return new Vl(h,X,0,ge,ln.CODE_128,new Date().getTime())},e.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],e.MAX_AVG_VARIANCE=.25,e.MAX_INDIVIDUAL_VARIANCE=.7,e.CODE_SHIFT=98,e.CODE_CODE_C=99,e.CODE_CODE_B=100,e.CODE_CODE_A=101,e.CODE_FNC_1=102,e.CODE_FNC_2=97,e.CODE_FNC_3=96,e.CODE_FNC_4_A=101,e.CODE_FNC_4_B=100,e.CODE_START_A=103,e.CODE_START_B=104,e.CODE_START_C=105,e.CODE_STOP=106,e}(ho),P3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),h5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},tH=function(t){P3e(e,t);function e(r,n){r===void 0&&(r=!1),n===void 0&&(n=!1);var a=t.call(this)||this;return a.usingCheckDigit=r,a.extendedMode=n,a.decodeRowResult="",a.counters=new Int32Array(9),a}return e.prototype.decodeRow=function(r,n,a){var s,o,l,c,u=this.counters;u.fill(0),this.decodeRowResult="";var d=e.findAsteriskPattern(n,u),f=n.getNextSet(d[1]),A=n.getSize(),h,m;do{e.recordPattern(n,f,u);var p=e.toNarrowWidePattern(u);if(p<0)throw new Zt;h=e.patternToChar(p),this.decodeRowResult+=h,m=f;try{for(var g=(s=void 0,h5(u)),v=g.next();!v.done;v=g.next()){var y=v.value;f+=y}}catch(D){s={error:D}}finally{try{v&&!v.done&&(o=g.return)&&o.call(g)}finally{if(s)throw s.error}}f=n.getNextSet(f)}while(h!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var b=0;try{for(var w=h5(u),j=w.next();!j.done;j=w.next()){var y=j.value;b+=y}}catch(D){l={error:D}}finally{try{j&&!j.done&&(c=w.return)&&c.call(w)}finally{if(l)throw l.error}}var I=f-m-b;if(f!==A&&I*2<b)throw new Zt;if(this.usingCheckDigit){for(var _=this.decodeRowResult.length-1,S=0,E=0;E<_;E++)S+=e.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(E));if(this.decodeRowResult.charAt(_)!==e.ALPHABET_STRING.charAt(S%43))throw new Vi;this.decodeRowResult=this.decodeRowResult.substring(0,_)}if(this.decodeRowResult.length===0)throw new Zt;var F;this.extendedMode?F=e.decodeExtended(this.decodeRowResult):F=this.decodeRowResult;var k=(d[1]+d[0])/2,P=m+b/2;return new Vl(F,null,0,[new Kr(k,r),new Kr(P,r)],ln.CODE_39,new Date().getTime())},e.findAsteriskPattern=function(r,n){for(var a=r.getSize(),s=r.getNextSet(0),o=0,l=s,c=!1,u=n.length,d=s;d<a;d++)if(r.get(d)!==c)n[o]++;else{if(o===u-1){if(this.toNarrowWidePattern(n)===e.ASTERISK_ENCODING&&r.isRange(Math.max(0,l-Math.floor((d-l)/2)),l,!1))return[l,d];l+=n[0]+n[1],n.copyWithin(0,2,2+o-1),n[o-1]=0,n[o]=0,o--}else o++;n[o]=1,c=!c}throw new Zt},e.toNarrowWidePattern=function(r){var n,a,s=r.length,o=0,l;do{var c=2147483647;try{for(var u=(n=void 0,h5(r)),d=u.next();!d.done;d=u.next()){var f=d.value;f<c&&f>o&&(c=f)}}catch(p){n={error:p}}finally{try{d&&!d.done&&(a=u.return)&&a.call(u)}finally{if(n)throw n.error}}o=c,l=0;for(var A=0,h=0,m=0;m<s;m++){var f=r[m];f>o&&(h|=1<<s-1-m,l++,A+=f)}if(l===3){for(var m=0;m<s&&l>0;m++){var f=r[m];if(f>o&&(l--,f*2>=A))return-1}return h}}while(l>3);return-1},e.patternToChar=function(r){for(var n=0;n<e.CHARACTER_ENCODINGS.length;n++)if(e.CHARACTER_ENCODINGS[n]===r)return e.ALPHABET_STRING.charAt(n);if(r===e.ASTERISK_ENCODING)return"*";throw new Zt},e.decodeExtended=function(r){for(var n=r.length,a="",s=0;s<n;s++){var o=r.charAt(s);if(o==="+"||o==="$"||o==="%"||o==="/"){var l=r.charAt(s+1),c="\0";switch(o){case"+":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)+32);else throw new Sr;break;case"$":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)-64);else throw new Sr;break;case"%":if(l>="A"&&l<="E")c=String.fromCharCode(l.charCodeAt(0)-38);else if(l>="F"&&l<="J")c=String.fromCharCode(l.charCodeAt(0)-11);else if(l>="K"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)+16);else if(l>="P"&&l<="T")c=String.fromCharCode(l.charCodeAt(0)+43);else if(l==="U")c="\0";else if(l==="V")c="@";else if(l==="W")c="`";else if(l==="X"||l==="Y"||l==="Z")c="";else throw new Sr;break;case"/":if(l>="A"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)-32);else if(l==="Z")c=":";else throw new Sr;break}a+=c,s++}else a+=o}return a},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",e.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],e.ASTERISK_ENCODING=148,e}(ho),B3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),A5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},rH=function(t){B3e(e,t);function e(){var r=t.call(this)||this;return r.decodeRowResult="",r.counters=new Int32Array(6),r}return e.prototype.decodeRow=function(r,n,a){var s,o,l,c,u=this.findAsteriskPattern(n),d=n.getNextSet(u[1]),f=n.getSize(),A=this.counters;A.fill(0),this.decodeRowResult="";var h,m;do{e.recordPattern(n,d,A);var p=this.toPattern(A);if(p<0)throw new Zt;h=this.patternToChar(p),this.decodeRowResult+=h,m=d;try{for(var g=(s=void 0,A5(A)),v=g.next();!v.done;v=g.next()){var y=v.value;d+=y}}catch(E){s={error:E}}finally{try{v&&!v.done&&(o=g.return)&&o.call(g)}finally{if(s)throw s.error}}d=n.getNextSet(d)}while(h!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var b=0;try{for(var w=A5(A),j=w.next();!j.done;j=w.next()){var y=j.value;b+=y}}catch(E){l={error:E}}finally{try{j&&!j.done&&(c=w.return)&&c.call(w)}finally{if(l)throw l.error}}if(d===f||!n.get(d))throw new Zt;if(this.decodeRowResult.length<2)throw new Zt;this.checkChecksums(this.decodeRowResult),this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-2);var I=this.decodeExtended(this.decodeRowResult),_=(u[1]+u[0])/2,S=m+b/2;return new Vl(I,null,0,[new Kr(_,r),new Kr(S,r)],ln.CODE_93,new Date().getTime())},e.prototype.findAsteriskPattern=function(r){var n=r.getSize(),a=r.getNextSet(0);this.counters.fill(0);for(var s=this.counters,o=a,l=!1,c=s.length,u=0,d=a;d<n;d++)if(r.get(d)!==l)s[u]++;else{if(u===c-1){if(this.toPattern(s)===e.ASTERISK_ENCODING)return new Int32Array([o,d]);o+=s[0]+s[1],s.copyWithin(0,2,2+u-1),s[u-1]=0,s[u]=0,u--}else u++;s[u]=1,l=!l}throw new Zt},e.prototype.toPattern=function(r){var n,a,s=0;try{for(var o=A5(r),l=o.next();!l.done;l=o.next()){var c=l.value;s+=c}}catch(m){n={error:m}}finally{try{l&&!l.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}for(var u=0,d=r.length,f=0;f<d;f++){var A=Math.round(r[f]*9/s);if(A<1||A>4)return-1;if(f&1)u<<=A;else for(var h=0;h<A;h++)u=u<<1|1}return u},e.prototype.patternToChar=function(r){for(var n=0;n<e.CHARACTER_ENCODINGS.length;n++)if(e.CHARACTER_ENCODINGS[n]===r)return e.ALPHABET_STRING.charAt(n);throw new Zt},e.prototype.decodeExtended=function(r){for(var n=r.length,a="",s=0;s<n;s++){var o=r.charAt(s);if(o>="a"&&o<="d"){if(s>=n-1)throw new Sr;var l=r.charAt(s+1),c="\0";switch(o){case"d":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)+32);else throw new Sr;break;case"a":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)-64);else throw new Sr;break;case"b":if(l>="A"&&l<="E")c=String.fromCharCode(l.charCodeAt(0)-38);else if(l>="F"&&l<="J")c=String.fromCharCode(l.charCodeAt(0)-11);else if(l>="K"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)+16);else if(l>="P"&&l<="T")c=String.fromCharCode(l.charCodeAt(0)+43);else if(l==="U")c="\0";else if(l==="V")c="@";else if(l==="W")c="`";else if(l>="X"&&l<="Z")c="";else throw new Sr;break;case"c":if(l>="A"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)-32);else if(l==="Z")c=":";else throw new Sr;break}a+=c,s++}else a+=o}return a},e.prototype.checkChecksums=function(r){var n=r.length;this.checkOneChecksum(r,n-2,20),this.checkOneChecksum(r,n-1,15)},e.prototype.checkOneChecksum=function(r,n,a){for(var s=1,o=0,l=n-1;l>=0;l--)o+=s*e.ALPHABET_STRING.indexOf(r.charAt(l)),++s>a&&(s=1);if(r.charAt(n)!==e.ALPHABET_STRING[o%47])throw new Vi},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%abcd*",e.CHARACTER_ENCODINGS=[276,328,324,322,296,292,290,336,274,266,424,420,418,404,402,394,360,356,354,308,282,344,332,326,300,278,436,434,428,422,406,410,364,358,310,314,302,468,466,458,366,374,430,294,474,470,306,350],e.ASTERISK_ENCODING=e.CHARACTER_ENCODINGS[47],e}(ho),T3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),k3e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},nH=function(t){T3e(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.narrowLineWidth=-1,r}return e.prototype.decodeRow=function(r,n,a){var s,o,l=this.decodeStart(n),c=this.decodeEnd(n),u=new Dn;e.decodeMiddle(n,l[1],c[0],u);var d=u.toString(),f=null;a!=null&&(f=a.get(is.ALLOWED_LENGTHS)),f==null&&(f=e.DEFAULT_ALLOWED_LENGTHS);var A=d.length,h=!1,m=0;try{for(var p=k3e(f),g=p.next();!g.done;g=p.next()){var v=g.value;if(A===v){h=!0;break}v>m&&(m=v)}}catch(w){s={error:w}}finally{try{g&&!g.done&&(o=p.return)&&o.call(p)}finally{if(s)throw s.error}}if(!h&&A>m&&(h=!0),!h)throw new Sr;var y=[new Kr(l[1],r),new Kr(c[0],r)],b=new Vl(d,null,0,y,ln.ITF,new Date().getTime());return b},e.decodeMiddle=function(r,n,a,s){var o=new Int32Array(10),l=new Int32Array(5),c=new Int32Array(5);for(o.fill(0),l.fill(0),c.fill(0);n<a;){ho.recordPattern(r,n,o);for(var u=0;u<5;u++){var d=2*u;l[u]=o[d],c[u]=o[d+1]}var f=e.decodeDigit(l);s.append(f.toString()),f=this.decodeDigit(c),s.append(f.toString()),o.forEach(function(A){n+=A})}},e.prototype.decodeStart=function(r){var n=e.skipWhiteSpace(r),a=e.findGuardPattern(r,n,e.START_PATTERN);return this.narrowLineWidth=(a[1]-a[0])/4,this.validateQuietZone(r,a[0]),a},e.prototype.validateQuietZone=function(r,n){var a=this.narrowLineWidth*10;a=a<n?a:n;for(var s=n-1;a>0&&s>=0&&!r.get(s);s--)a--;if(a!==0)throw new Zt},e.skipWhiteSpace=function(r){var n=r.getSize(),a=r.getNextSet(0);if(a===n)throw new Zt;return a},e.prototype.decodeEnd=function(r){r.reverse();try{var n=e.skipWhiteSpace(r),a=void 0;try{a=e.findGuardPattern(r,n,e.END_PATTERN_REVERSED[0])}catch(o){o instanceof Zt&&(a=e.findGuardPattern(r,n,e.END_PATTERN_REVERSED[1]))}this.validateQuietZone(r,a[0]);var s=a[0];return a[0]=r.getSize()-a[1],a[1]=r.getSize()-s,a}finally{r.reverse()}},e.findGuardPattern=function(r,n,a){var s=a.length,o=new Int32Array(s),l=r.getSize(),c=!1,u=0,d=n;o.fill(0);for(var f=n;f<l;f++)if(r.get(f)!==c)o[u]++;else{if(u===s-1){if(ho.patternMatchVariance(o,a,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return[d,f];d+=o[0]+o[1],ss.arraycopy(o,2,o,0,u-1),o[u-1]=0,o[u]=0,u--}else u++;o[u]=1,c=!c}throw new Zt},e.decodeDigit=function(r){for(var n=e.MAX_AVG_VARIANCE,a=-1,s=e.PATTERNS.length,o=0;o<s;o++){var l=e.PATTERNS[o],c=ho.patternMatchVariance(r,l,e.MAX_INDIVIDUAL_VARIANCE);c<n?(n=c,a=o):c===n&&(a=-1)}if(a>=0)return a%10;throw new Zt},e.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],e.MAX_AVG_VARIANCE=.38,e.MAX_INDIVIDUAL_VARIANCE=.5,e.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],e.START_PATTERN=Int32Array.from([1,1,1,1]),e.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])],e}(ho),F3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Tv=function(t){F3e(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.decodeRowStringBuffer="",r}return e.findStartGuardPattern=function(r){for(var n=!1,a,s=0,o=Int32Array.from([0,0,0]);!n;){o=Int32Array.from([0,0,0]),a=e.findGuardPattern(r,s,!1,this.START_END_PATTERN,o);var l=a[0];s=a[1];var c=l-(s-l);c>=0&&(n=r.isRange(c,l,!1))}return a},e.checkChecksum=function(r){return e.checkStandardUPCEANChecksum(r)},e.checkStandardUPCEANChecksum=function(r){var n=r.length;if(n===0)return!1;var a=parseInt(r.charAt(n-1),10);return e.getStandardUPCEANChecksum(r.substring(0,n-1))===a},e.getStandardUPCEANChecksum=function(r){for(var n=r.length,a=0,s=n-1;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new Sr;a+=o}a*=3;for(var s=n-2;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new Sr;a+=o}return(1e3-a)%10},e.decodeEnd=function(r,n){return e.findGuardPattern(r,n,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e.findGuardPatternWithoutCounters=function(r,n,a,s){return this.findGuardPattern(r,n,a,s,new Int32Array(s.length))},e.findGuardPattern=function(r,n,a,s,o){var l=r.getSize();n=a?r.getNextUnset(n):r.getNextSet(n);for(var c=0,u=n,d=s.length,f=a,A=n;A<l;A++)if(r.get(A)!==f)o[c]++;else{if(c===d-1){if(ho.patternMatchVariance(o,s,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return Int32Array.from([u,A]);u+=o[0]+o[1];for(var h=o.slice(2,o.length),m=0;m<c-1;m++)o[m]=h[m];o[c-1]=0,o[c]=0,c--}else c++;o[c]=1,f=!f}throw new Zt},e.decodeDigit=function(r,n,a,s){this.recordPattern(r,a,n);for(var o=this.MAX_AVG_VARIANCE,l=-1,c=s.length,u=0;u<c;u++){var d=s[u],f=ho.patternMatchVariance(n,d,e.MAX_INDIVIDUAL_VARIANCE);f<o&&(o=f,l=u)}if(l>=0)return l;throw new Zt},e.MAX_AVG_VARIANCE=.48,e.MAX_INDIVIDUAL_VARIANCE=.7,e.START_END_PATTERN=Int32Array.from([1,1,1]),e.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),e.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])],e}(ho),O3e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},D3e=function(){function t(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return t.prototype.decodeRow=function(e,r,n){var a=this.decodeRowStringBuffer,s=this.decodeMiddle(r,n,a),o=a.toString(),l=t.parseExtensionString(o),c=[new Kr((n[0]+n[1])/2,e),new Kr(s,e)],u=new Vl(o,null,0,c,ln.UPC_EAN_EXTENSION,new Date().getTime());return l!=null&&u.putAllMetadata(l),u},t.prototype.decodeMiddle=function(e,r,n){var a,s,o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var l=e.getSize(),c=r[1],u=0,d=0;d<5&&c<l;d++){var f=Tv.decodeDigit(e,o,c,Tv.L_AND_G_PATTERNS);n+=String.fromCharCode(48+f%10);try{for(var A=(a=void 0,O3e(o)),h=A.next();!h.done;h=A.next()){var m=h.value;c+=m}}catch(g){a={error:g}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}f>=10&&(u|=1<<4-d),d!==4&&(c=e.getNextSet(c),c=e.getNextUnset(c))}if(n.length!==5)throw new Zt;var p=this.determineCheckDigit(u);if(t.extensionChecksum(n.toString())!==p)throw new Zt;return c},t.extensionChecksum=function(e){for(var r=e.length,n=0,a=r-2;a>=0;a-=2)n+=e.charAt(a).charCodeAt(0)-48;n*=3;for(var a=r-1;a>=0;a-=2)n+=e.charAt(a).charCodeAt(0)-48;return n*=3,n%10},t.prototype.determineCheckDigit=function(e){for(var r=0;r<10;r++)if(e===this.CHECK_DIGIT_ENCODINGS[r])return r;throw new Zt},t.parseExtensionString=function(e){if(e.length!==5)return null;var r=t.parseExtension5String(e);return r==null?null:new Map([[ul.SUGGESTED_PRICE,r]])},t.parseExtension5String=function(e){var r;switch(e.charAt(0)){case"0":r="";break;case"5":r="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}r="";break;default:r="";break}var n=parseInt(e.substring(1)),a=(n/100).toString(),s=n%100,o=s<10?"0"+s:s.toString();return r+a+"."+o},t}(),R3e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},M3e=function(){function t(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return t.prototype.decodeRow=function(e,r,n){var a=this.decodeRowStringBuffer,s=this.decodeMiddle(r,n,a),o=a.toString(),l=t.parseExtensionString(o),c=[new Kr((n[0]+n[1])/2,e),new Kr(s,e)],u=new Vl(o,null,0,c,ln.UPC_EAN_EXTENSION,new Date().getTime());return l!=null&&u.putAllMetadata(l),u},t.prototype.decodeMiddle=function(e,r,n){var a,s,o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var l=e.getSize(),c=r[1],u=0,d=0;d<2&&c<l;d++){var f=Tv.decodeDigit(e,o,c,Tv.L_AND_G_PATTERNS);n+=String.fromCharCode(48+f%10);try{for(var A=(a=void 0,R3e(o)),h=A.next();!h.done;h=A.next()){var m=h.value;c+=m}}catch(p){a={error:p}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}f>=10&&(u|=1<<1-d),d!==1&&(c=e.getNextSet(c),c=e.getNextUnset(c))}if(n.length!==2)throw new Zt;if(parseInt(n.toString())%4!==u)throw new Zt;return c},t.parseExtensionString=function(e){return e.length!==2?null:new Map([[ul.ISSUE_NUMBER,parseInt(e)]])},t}(),L3e=function(){function t(){}return t.decodeRow=function(e,r,n){var a=Tv.findGuardPattern(r,n,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{var s=new D3e;return s.decodeRow(e,r,a)}catch{var o=new M3e;return o.decodeRow(e,r,a)}},t.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]),t}(),U3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ao=function(t){U3e(e,t);function e(){var r=t.call(this)||this;r.decodeRowStringBuffer="",e.L_AND_G_PATTERNS=e.L_PATTERNS.map(function(l){return Int32Array.from(l)});for(var n=10;n<20;n++){for(var a=e.L_PATTERNS[n-10],s=new Int32Array(a.length),o=0;o<a.length;o++)s[o]=a[a.length-o-1];e.L_AND_G_PATTERNS[n]=s}return r}return e.prototype.decodeRow=function(r,n,a){var s=e.findStartGuardPattern(n),o=a==null?null:a.get(is.NEED_RESULT_POINT_CALLBACK);if(o!=null){var l=new Kr((s[0]+s[1])/2,r);o.foundPossibleResultPoint(l)}var c=this.decodeMiddle(n,s,this.decodeRowStringBuffer),u=c.rowOffset,d=c.resultString;if(o!=null){var f=new Kr(u,r);o.foundPossibleResultPoint(f)}var A=e.decodeEnd(n,u);if(o!=null){var h=new Kr((A[0]+A[1])/2,r);o.foundPossibleResultPoint(h)}var m=A[1],p=m+(m-A[0]);if(p>=n.getSize()||!n.isRange(m,p,!1))throw new Zt;var g=d.toString();if(g.length<8)throw new Sr;if(!e.checkChecksum(g))throw new Vi;var v=(s[1]+s[0])/2,y=(A[1]+A[0])/2,b=this.getBarcodeFormat(),w=[new Kr(v,r),new Kr(y,r)],j=new Vl(g,null,0,w,b,new Date().getTime()),I=0;try{var _=L3e.decodeRow(r,n,A[1]);j.putMetadata(ul.UPC_EAN_EXTENSION,_.getText()),j.putAllMetadata(_.getResultMetadata()),j.addResultPoints(_.getResultPoints()),I=_.getText().length}catch{}var S=a==null?null:a.get(is.ALLOWED_EAN_EXTENSIONS);if(S!=null){var E=!1;for(var F in S)if(I.toString()===F){E=!0;break}if(!E)throw new Zt}return b===ln.EAN_13||ln.UPC_A,j},e.checkChecksum=function(r){return e.checkStandardUPCEANChecksum(r)},e.checkStandardUPCEANChecksum=function(r){var n=r.length;if(n===0)return!1;var a=parseInt(r.charAt(n-1),10);return e.getStandardUPCEANChecksum(r.substring(0,n-1))===a},e.getStandardUPCEANChecksum=function(r){for(var n=r.length,a=0,s=n-1;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new Sr;a+=o}a*=3;for(var s=n-2;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new Sr;a+=o}return(1e3-a)%10},e.decodeEnd=function(r,n){return e.findGuardPattern(r,n,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e}(Tv),Q3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),aH=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Uk=function(t){Q3e(e,t);function e(){var r=t.call(this)||this;return r.decodeMiddleCounters=Int32Array.from([0,0,0,0]),r}return e.prototype.decodeMiddle=function(r,n,a){var s,o,l,c,u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;for(var d=r.getSize(),f=n[1],A=0,h=0;h<6&&f<d;h++){var m=ao.decodeDigit(r,u,f,ao.L_AND_G_PATTERNS);a+=String.fromCharCode(48+m%10);try{for(var p=(s=void 0,aH(u)),g=p.next();!g.done;g=p.next()){var v=g.value;f+=v}}catch(j){s={error:j}}finally{try{g&&!g.done&&(o=p.return)&&o.call(p)}finally{if(s)throw s.error}}m>=10&&(A|=1<<5-h)}a=e.determineFirstDigit(a,A);var y=ao.findGuardPattern(r,f,!0,ao.MIDDLE_PATTERN,new Int32Array(ao.MIDDLE_PATTERN.length).fill(0));f=y[1];for(var h=0;h<6&&f<d;h++){var m=ao.decodeDigit(r,u,f,ao.L_PATTERNS);a+=String.fromCharCode(48+m);try{for(var b=(l=void 0,aH(u)),w=b.next();!w.done;w=b.next()){var v=w.value;f+=v}}catch(_){l={error:_}}finally{try{w&&!w.done&&(c=b.return)&&c.call(b)}finally{if(l)throw l.error}}}return{rowOffset:f,resultString:a}},e.prototype.getBarcodeFormat=function(){return ln.EAN_13},e.determineFirstDigit=function(r,n){for(var a=0;a<10;a++)if(n===this.FIRST_DIGIT_ENCODINGS[a])return r=String.fromCharCode(48+a)+r,r;throw new Zt},e.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26],e}(ao),V3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),sH=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},iH=function(t){V3e(e,t);function e(){var r=t.call(this)||this;return r.decodeMiddleCounters=Int32Array.from([0,0,0,0]),r}return e.prototype.decodeMiddle=function(r,n,a){var s,o,l,c,u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;for(var d=r.getSize(),f=n[1],A=0;A<4&&f<d;A++){var h=ao.decodeDigit(r,u,f,ao.L_PATTERNS);a+=String.fromCharCode(48+h);try{for(var m=(s=void 0,sH(u)),p=m.next();!p.done;p=m.next()){var g=p.value;f+=g}}catch(w){s={error:w}}finally{try{p&&!p.done&&(o=m.return)&&o.call(m)}finally{if(s)throw s.error}}}var v=ao.findGuardPattern(r,f,!0,ao.MIDDLE_PATTERN,new Int32Array(ao.MIDDLE_PATTERN.length).fill(0));f=v[1];for(var A=0;A<4&&f<d;A++){var h=ao.decodeDigit(r,u,f,ao.L_PATTERNS);a+=String.fromCharCode(48+h);try{for(var y=(l=void 0,sH(u)),b=y.next();!b.done;b=y.next()){var g=b.value;f+=g}}catch(I){l={error:I}}finally{try{b&&!b.done&&(c=y.return)&&c.call(y)}finally{if(l)throw l.error}}}return{rowOffset:f,resultString:a}},e.prototype.getBarcodeFormat=function(){return ln.EAN_8},e}(ao),H3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),oH=function(t){H3e(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.ean13Reader=new Uk,r}return e.prototype.getBarcodeFormat=function(){return ln.UPC_A},e.prototype.decode=function(r,n){return this.maybeReturnResult(this.ean13Reader.decode(r))},e.prototype.decodeRow=function(r,n,a){return this.maybeReturnResult(this.ean13Reader.decodeRow(r,n,a))},e.prototype.decodeMiddle=function(r,n,a){return this.ean13Reader.decodeMiddle(r,n,a)},e.prototype.maybeReturnResult=function(r){var n=r.getText();if(n.charAt(0)==="0"){var a=new Vl(n.substring(1),null,null,r.getResultPoints(),ln.UPC_A);return r.getResultMetadata()!=null&&a.putAllMetadata(r.getResultMetadata()),a}else throw new Zt},e.prototype.reset=function(){this.ean13Reader.reset()},e}(ao),$3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),G3e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},lH=function(t){$3e(e,t);function e(){var r=t.call(this)||this;return r.decodeMiddleCounters=new Int32Array(4),r}return e.prototype.decodeMiddle=function(r,n,a){var s,o,l=this.decodeMiddleCounters.map(function(g){return g});l[0]=0,l[1]=0,l[2]=0,l[3]=0;for(var c=r.getSize(),u=n[1],d=0,f=0;f<6&&u<c;f++){var A=e.decodeDigit(r,l,u,e.L_AND_G_PATTERNS);a+=String.fromCharCode(48+A%10);try{for(var h=(s=void 0,G3e(l)),m=h.next();!m.done;m=h.next()){var p=m.value;u+=p}}catch(g){s={error:g}}finally{try{m&&!m.done&&(o=h.return)&&o.call(h)}finally{if(s)throw s.error}}A>=10&&(d|=1<<5-f)}return e.determineNumSysAndCheckDigit(new Dn(a),d),u},e.prototype.decodeEnd=function(r,n){return e.findGuardPatternWithoutCounters(r,n,!0,e.MIDDLE_END_PATTERN)},e.prototype.checkChecksum=function(r){return ao.checkChecksum(e.convertUPCEtoUPCA(r))},e.determineNumSysAndCheckDigit=function(r,n){for(var a=0;a<=1;a++)for(var s=0;s<10;s++)if(n===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[a][s]){r.insert(0,"0"+a),r.append("0"+s);return}throw Zt.getNotFoundInstance()},e.prototype.getBarcodeFormat=function(){return ln.UPC_E},e.convertUPCEtoUPCA=function(r){var n=r.slice(1,7).split("").map(function(o){return o.charCodeAt(0)}),a=new Dn;a.append(r.charAt(0));var s=n[5];switch(s){case 0:case 1:case 2:a.appendChars(n,0,2),a.append(s),a.append("0000"),a.appendChars(n,2,3);break;case 3:a.appendChars(n,0,3),a.append("00000"),a.appendChars(n,3,2);break;case 4:a.appendChars(n,0,4),a.append("00000"),a.append(n[4]);break;default:a.appendChars(n,0,5),a.append("0000"),a.append(s);break}return r.length>=8&&a.append(r.charAt(7)),a.toString()},e.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,1])],e}(ao),K3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),cH=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},m5=function(t){K3e(e,t);function e(r){var n=t.call(this)||this,a=r==null?null:r.get(is.POSSIBLE_FORMATS),s=[];return a!=null&&(a.indexOf(ln.EAN_13)>-1&&s.push(new Uk),a.indexOf(ln.UPC_A)>-1&&s.push(new oH),a.indexOf(ln.EAN_8)>-1&&s.push(new iH),a.indexOf(ln.UPC_E)>-1&&s.push(new lH)),s.length===0&&(s.push(new Uk),s.push(new oH),s.push(new iH),s.push(new lH)),n.readers=s,n}return e.prototype.decodeRow=function(r,n,a){var s,o;try{for(var l=cH(this.readers),c=l.next();!c.done;c=l.next()){var u=c.value;try{var d=u.decodeRow(r,n,a),f=d.getBarcodeFormat()===ln.EAN_13&&d.getText().charAt(0)==="0",A=a==null?null:a.get(is.POSSIBLE_FORMATS),h=A==null||A.includes(ln.UPC_A);if(f&&h){var m=d.getRawBytes(),p=new Vl(d.getText().substring(1),m,m?m.length:null,d.getResultPoints(),ln.UPC_A);return p.putAllMetadata(d.getResultMetadata()),p}return d}catch{}}}catch(g){s={error:g}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(s)throw s.error}}throw new Zt},e.prototype.reset=function(){var r,n;try{for(var a=cH(this.readers),s=a.next();!s.done;s=a.next()){var o=s.value;o.reset()}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},e}(ho),q3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),z3e=function(t){q3e(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.CODA_BAR_CHAR_SET={nnnnnww:"0",nnnnwwn:"1",nnnwnnw:"2",wwnnnnn:"3",nnwnnwn:"4",wnnnnwn:"5",nwnnnnw:"6",nwnnwnn:"7",nwwnnnn:"8",wnnwnnn:"9",nnnwwnn:"-",nnwwnnn:"$",wnnnwnw:":",wnwnnnw:"/",wnwnwnn:".",nnwwwww:"+",nnwwnwn:"A",nwnwnnw:"B",nnnwnww:"C",nnnwwwn:"D"},r}return e.prototype.decodeRow=function(r,n,a){var s=this.getValidRowData(n);if(!s)throw new Zt;var o=this.codaBarDecodeRow(s.row);if(!o)throw new Zt;return new Vl(o,null,0,[new Kr(s.left,r),new Kr(s.right,r)],ln.CODABAR,new Date().getTime())},e.prototype.getValidRowData=function(r){var n=r.toArray(),a=n.indexOf(!0);if(a===-1)return null;var s=n.lastIndexOf(!0);if(s<=a)return null;n=n.slice(a,s+1);for(var o=[],l=n[0],c=1,u=1;u<n.length;u++)n[u]===l?c++:(l=n[u],o.push(c),c=1);return o.push(c),o.length<23&&(o.length+1)%8!==0?null:{row:o,left:a,right:s}},e.prototype.codaBarDecodeRow=function(r){for(var n=[],a=Math.ceil(r.reduce(function(c,u){return(c+u)/2},0));r.length>0;){var s=r.splice(0,8).splice(0,7),o=s.map(function(c){return c<a?"n":"w"}).join("");if(this.CODA_BAR_CHAR_SET[o]===void 0)return null;n.push(this.CODA_BAR_CHAR_SET[o])}var l=n.join("");return this.validCodaBarString(l)?l:null},e.prototype.validCodaBarString=function(r){var n=/^[A-D].{1,}[A-D]$/;return n.test(r)},e}(ho),W3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),X3e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Zm=function(t){W3e(e,t);function e(){var r=t.call(this)||this;return r.decodeFinderCounters=new Int32Array(4),r.dataCharacterCounters=new Int32Array(8),r.oddRoundingErrors=new Array(4),r.evenRoundingErrors=new Array(4),r.oddCounts=new Array(r.dataCharacterCounters.length/2),r.evenCounts=new Array(r.dataCharacterCounters.length/2),r}return e.prototype.getDecodeFinderCounters=function(){return this.decodeFinderCounters},e.prototype.getDataCharacterCounters=function(){return this.dataCharacterCounters},e.prototype.getOddRoundingErrors=function(){return this.oddRoundingErrors},e.prototype.getEvenRoundingErrors=function(){return this.evenRoundingErrors},e.prototype.getOddCounts=function(){return this.oddCounts},e.prototype.getEvenCounts=function(){return this.evenCounts},e.prototype.parseFinderValue=function(r,n){for(var a=0;a<n.length;a++)if(ho.patternMatchVariance(r,n[a],e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return a;throw new Zt},e.count=function(r){return da.sum(new Int32Array(r))},e.increment=function(r,n){for(var a=0,s=n[0],o=1;o<r.length;o++)n[o]>s&&(s=n[o],a=o);r[a]++},e.decrement=function(r,n){for(var a=0,s=n[0],o=1;o<r.length;o++)n[o]<s&&(s=n[o],a=o);r[a]--},e.isFinderPattern=function(r){var n,a,s=r[0]+r[1],o=s+r[2]+r[3],l=s/o;if(l>=e.MIN_FINDER_PATTERN_RATIO&&l<=e.MAX_FINDER_PATTERN_RATIO){var c=Number.MAX_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER;try{for(var d=X3e(r),f=d.next();!f.done;f=d.next()){var A=f.value;A>u&&(u=A),A<c&&(c=A)}}catch(h){n={error:h}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}return u<10*c}return!1},e.MAX_AVG_VARIANCE=.2,e.MAX_INDIVIDUAL_VARIANCE=.45,e.MIN_FINDER_PATTERN_RATIO=9.5/12,e.MAX_FINDER_PATTERN_RATIO=12.5/14,e}(ho),jS=function(){function t(e,r){this.value=e,this.checksumPortion=r}return t.prototype.getValue=function(){return this.value},t.prototype.getChecksumPortion=function(){return this.checksumPortion},t.prototype.toString=function(){return this.value+"("+this.checksumPortion+")"},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value&&this.checksumPortion===r.checksumPortion},t.prototype.hashCode=function(){return this.value^this.checksumPortion},t}(),qre=function(){function t(e,r,n,a,s){this.value=e,this.startEnd=r,this.value=e,this.startEnd=r,this.resultPoints=new Array,this.resultPoints.push(new Kr(n,s)),this.resultPoints.push(new Kr(a,s))}return t.prototype.getValue=function(){return this.value},t.prototype.getStartEnd=function(){return this.startEnd},t.prototype.getResultPoints=function(){return this.resultPoints},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value},t.prototype.hashCode=function(){return this.value},t}(),Y3e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Vx=function(){function t(){}return t.getRSSvalue=function(e,r,n){var a,s,o=0;try{for(var l=Y3e(e),c=l.next();!c.done;c=l.next()){var u=c.value;o+=u}}catch(y){a={error:y}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}for(var d=0,f=0,A=e.length,h=0;h<A-1;h++){var m=void 0;for(m=1,f|=1<<h;m<e[h];m++,f&=~(1<<h)){var p=t.combins(o-m-1,A-h-2);if(n&&f===0&&o-m-(A-h-1)>=A-h-1&&(p-=t.combins(o-m-(A-h),A-h-2)),A-h-1>1){for(var g=0,v=o-m-(A-h-2);v>r;v--)g+=t.combins(o-m-v-1,A-h-3);p-=g*(A-1-h)}else o-m>r&&p--;d+=p}o-=m}return d},t.combins=function(e,r){var n,a;e-r>r?(a=r,n=e-r):(a=e-r,n=r);for(var s=1,o=1,l=e;l>n;l--)s*=l,o<=a&&(s/=o,o++);for(;o<=a;)s/=o,o++;return s},t}(),J3e=function(){function t(){}return t.buildBitArray=function(e){var r=e.length*2-1;e[e.length-1].getRightChar()==null&&(r-=1);for(var n=12*r,a=new Oo(n),s=0,o=e[0],l=o.getRightChar().getValue(),c=11;c>=0;--c)l&1<<c&&a.set(s),s++;for(var c=1;c<e.length;++c){for(var u=e[c],d=u.getLeftChar().getValue(),f=11;f>=0;--f)d&1<<f&&a.set(s),s++;if(u.getRightChar()!==null)for(var A=u.getRightChar().getValue(),f=11;f>=0;--f)A&1<<f&&a.set(s),s++}return a},t}(),Qm=function(){function t(e,r){r?this.decodedInformation=null:(this.finished=e,this.decodedInformation=r)}return t.prototype.getDecodedInformation=function(){return this.decodedInformation},t.prototype.isFinished=function(){return this.finished},t}(),F6=function(){function t(e){this.newPosition=e}return t.prototype.getNewPosition=function(){return this.newPosition},t}(),Z3e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),kd=function(t){Z3e(e,t);function e(r,n){var a=t.call(this,r)||this;return a.value=n,a}return e.prototype.getValue=function(){return this.value},e.prototype.isFNC1=function(){return this.value===e.FNC1},e.FNC1="$",e}(F6),e5e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Vm=function(t){e5e(e,t);function e(r,n,a){var s=t.call(this,r)||this;return a?(s.remaining=!0,s.remainingValue=s.remainingValue):(s.remaining=!1,s.remainingValue=0),s.newString=n,s}return e.prototype.getNewString=function(){return this.newString},e.prototype.isRemaining=function(){return this.remaining},e.prototype.getRemainingValue=function(){return this.remainingValue},e}(F6),t5e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),lx=function(t){t5e(e,t);function e(r,n,a){var s=t.call(this,r)||this;if(n<0||n>10||a<0||a>10)throw new Sr;return s.firstDigit=n,s.secondDigit=a,s}return e.prototype.getFirstDigit=function(){return this.firstDigit},e.prototype.getSecondDigit=function(){return this.secondDigit},e.prototype.getValue=function(){return this.firstDigit*10+this.secondDigit},e.prototype.isFirstDigitFNC1=function(){return this.firstDigit===e.FNC1},e.prototype.isSecondDigitFNC1=function(){return this.secondDigit===e.FNC1},e.prototype.isAnyFNC1=function(){return this.firstDigit===e.FNC1||this.secondDigit===e.FNC1},e.FNC1=10,e}(F6),LC=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},r5e=function(){function t(){}return t.parseFieldsInGeneralPurpose=function(e){var r,n,a,s,o,l,c,u;if(!e)return null;if(e.length<2)throw new Zt;var d=e.substring(0,2);try{for(var f=LC(t.TWO_DIGIT_DATA_LENGTH),A=f.next();!A.done;A=f.next()){var h=A.value;if(h[0]===d)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(2,h[2],e):t.processFixedAI(2,h[1],e)}}catch(I){r={error:I}}finally{try{A&&!A.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}if(e.length<3)throw new Zt;var m=e.substring(0,3);try{for(var p=LC(t.THREE_DIGIT_DATA_LENGTH),g=p.next();!g.done;g=p.next()){var h=g.value;if(h[0]===m)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(3,h[2],e):t.processFixedAI(3,h[1],e)}}catch(I){a={error:I}}finally{try{g&&!g.done&&(s=p.return)&&s.call(p)}finally{if(a)throw a.error}}try{for(var v=LC(t.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH),y=v.next();!y.done;y=v.next()){var h=y.value;if(h[0]===m)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(4,h[2],e):t.processFixedAI(4,h[1],e)}}catch(I){o={error:I}}finally{try{y&&!y.done&&(l=v.return)&&l.call(v)}finally{if(o)throw o.error}}if(e.length<4)throw new Zt;var b=e.substring(0,4);try{for(var w=LC(t.FOUR_DIGIT_DATA_LENGTH),j=w.next();!j.done;j=w.next()){var h=j.value;if(h[0]===b)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(4,h[2],e):t.processFixedAI(4,h[1],e)}}catch(I){c={error:I}}finally{try{j&&!j.done&&(u=w.return)&&u.call(w)}finally{if(c)throw c.error}}throw new Zt},t.processFixedAI=function(e,r,n){if(n.length<e)throw new Zt;var a=n.substring(0,e);if(n.length<e+r)throw new Zt;var s=n.substring(e,e+r),o=n.substring(e+r),l="("+a+")"+s,c=t.parseFieldsInGeneralPurpose(o);return c==null?l:l+c},t.processVariableAI=function(e,r,n){var a=n.substring(0,e),s;n.length<e+r?s=n.length:s=e+r;var o=n.substring(e,s),l=n.substring(s),c="("+a+")"+o,u=t.parseFieldsInGeneralPurpose(l);return u==null?c:c+u},t.VARIABLE_LENGTH=[],t.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",t.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",t.VARIABLE_LENGTH,20],["22",t.VARIABLE_LENGTH,29],["30",t.VARIABLE_LENGTH,8],["37",t.VARIABLE_LENGTH,8],["90",t.VARIABLE_LENGTH,30],["91",t.VARIABLE_LENGTH,30],["92",t.VARIABLE_LENGTH,30],["93",t.VARIABLE_LENGTH,30],["94",t.VARIABLE_LENGTH,30],["95",t.VARIABLE_LENGTH,30],["96",t.VARIABLE_LENGTH,30],["97",t.VARIABLE_LENGTH,3],["98",t.VARIABLE_LENGTH,30],["99",t.VARIABLE_LENGTH,30]],t.THREE_DIGIT_DATA_LENGTH=[["240",t.VARIABLE_LENGTH,30],["241",t.VARIABLE_LENGTH,30],["242",t.VARIABLE_LENGTH,6],["250",t.VARIABLE_LENGTH,30],["251",t.VARIABLE_LENGTH,30],["253",t.VARIABLE_LENGTH,17],["254",t.VARIABLE_LENGTH,20],["400",t.VARIABLE_LENGTH,30],["401",t.VARIABLE_LENGTH,30],["402",17],["403",t.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",t.VARIABLE_LENGTH,20],["421",t.VARIABLE_LENGTH,15],["422",3],["423",t.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],t.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",t.VARIABLE_LENGTH,15],["391",t.VARIABLE_LENGTH,18],["392",t.VARIABLE_LENGTH,15],["393",t.VARIABLE_LENGTH,18],["703",t.VARIABLE_LENGTH,30]],t.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",t.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",t.VARIABLE_LENGTH,20],["8003",t.VARIABLE_LENGTH,30],["8004",t.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",t.VARIABLE_LENGTH,30],["8008",t.VARIABLE_LENGTH,12],["8018",18],["8020",t.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",t.VARIABLE_LENGTH,70],["8200",t.VARIABLE_LENGTH,70]],t}(),lE=function(){function t(e){this.buffer=new Dn,this.information=e}return t.prototype.decodeAllCodes=function(e,r){var n=r,a=null;do{var s=this.decodeGeneralPurposeField(n,a),o=r5e.parseFieldsInGeneralPurpose(s.getNewString());if(o!=null&&e.append(o),s.isRemaining()?a=""+s.getRemainingValue():a=null,n===s.getNewPosition())break;n=s.getNewPosition()}while(!0);return e.toString()},t.prototype.isStillNumeric=function(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(var r=e;r<e+3;++r)if(this.information.get(r))return!0;return this.information.get(e+3)},t.prototype.decodeNumeric=function(e){if(e+7>this.information.getSize()){var r=this.extractNumericValueFromBitArray(e,4);return r===0?new lx(this.information.getSize(),lx.FNC1,lx.FNC1):new lx(this.information.getSize(),r-1,lx.FNC1)}var n=this.extractNumericValueFromBitArray(e,7),a=(n-8)/11,s=(n-8)%11;return new lx(e+7,a,s)},t.prototype.extractNumericValueFromBitArray=function(e,r){return t.extractNumericValueFromBitArray(this.information,e,r)},t.extractNumericValueFromBitArray=function(e,r,n){for(var a=0,s=0;s<n;++s)e.get(r+s)&&(a|=1<<n-s-1);return a},t.prototype.decodeGeneralPurposeField=function(e,r){this.buffer.setLengthToZero(),r!=null&&this.buffer.append(r),this.current.setPosition(e);var n=this.parseBlocks();return n!=null&&n.isRemaining()?new Vm(this.current.getPosition(),this.buffer.toString(),n.getRemainingValue()):new Vm(this.current.getPosition(),this.buffer.toString())},t.prototype.parseBlocks=function(){var e,r;do{var n=this.current.getPosition();this.current.isAlpha()?(r=this.parseAlphaBlock(),e=r.isFinished()):this.current.isIsoIec646()?(r=this.parseIsoIec646Block(),e=r.isFinished()):(r=this.parseNumericBlock(),e=r.isFinished());var a=n!==this.current.getPosition();if(!a&&!e)break}while(!e);return r.getDecodedInformation()},t.prototype.parseNumericBlock=function(){for(;this.isStillNumeric(this.current.getPosition());){var e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){var r=void 0;return e.isSecondDigitFNC1()?r=new Vm(this.current.getPosition(),this.buffer.toString()):r=new Vm(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new Qm(!0,r)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){var r=new Vm(this.current.getPosition(),this.buffer.toString());return new Qm(!0,r)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Qm(!1)},t.prototype.parseIsoIec646Block=function(){for(;this.isStillIsoIec646(this.current.getPosition());){var e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var r=new Vm(this.current.getPosition(),this.buffer.toString());return new Qm(!0,r)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Qm(!1)},t.prototype.parseAlphaBlock=function(){for(;this.isStillAlpha(this.current.getPosition());){var e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var r=new Vm(this.current.getPosition(),this.buffer.toString());return new Qm(!0,r)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Qm(!1)},t.prototype.isStillIsoIec646=function(e){if(e+5>this.information.getSize())return!1;var r=this.extractNumericValueFromBitArray(e,5);if(r>=5&&r<16)return!0;if(e+7>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<116)return!0;if(e+8>this.information.getSize())return!1;var a=this.extractNumericValueFromBitArray(e,8);return a>=232&&a<253},t.prototype.decodeIsoIec646=function(e){var r=this.extractNumericValueFromBitArray(e,5);if(r===15)return new kd(e+5,kd.FNC1);if(r>=5&&r<15)return new kd(e+5,"0"+(r-5));var n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<90)return new kd(e+7,""+(n+1));if(n>=90&&n<116)return new kd(e+7,""+(n+7));var a=this.extractNumericValueFromBitArray(e,8),s;switch(a){case 232:s="!";break;case 233:s='"';break;case 234:s="%";break;case 235:s="&";break;case 236:s="'";break;case 237:s="(";break;case 238:s=")";break;case 239:s="*";break;case 240:s="+";break;case 241:s=",";break;case 242:s="-";break;case 243:s=".";break;case 244:s="/";break;case 245:s=":";break;case 246:s=";";break;case 247:s="<";break;case 248:s="=";break;case 249:s=">";break;case 250:s="?";break;case 251:s="_";break;case 252:s=" ";break;default:throw new Sr}return new kd(e+8,s)},t.prototype.isStillAlpha=function(e){if(e+5>this.information.getSize())return!1;var r=this.extractNumericValueFromBitArray(e,5);if(r>=5&&r<16)return!0;if(e+6>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,6);return n>=16&&n<63},t.prototype.decodeAlphanumeric=function(e){var r=this.extractNumericValueFromBitArray(e,5);if(r===15)return new kd(e+5,kd.FNC1);if(r>=5&&r<15)return new kd(e+5,"0"+(r-5));var n=this.extractNumericValueFromBitArray(e,6);if(n>=32&&n<58)return new kd(e+6,""+(n+33));var a;switch(n){case 58:a="*";break;case 59:a=",";break;case 60:a="-";break;case 61:a=".";break;case 62:a="/";break;default:throw new jw("Decoding invalid alphanumeric value: "+n)}return new kd(e+6,a)},t.prototype.isAlphaTo646ToAlphaLatch=function(e){if(e+1>this.information.getSize())return!1;for(var r=0;r<5&&r+e<this.information.getSize();++r)if(r===2){if(!this.information.get(e+2))return!1}else if(this.information.get(e+r))return!1;return!0},t.prototype.isAlphaOr646ToNumericLatch=function(e){if(e+3>this.information.getSize())return!1;for(var r=e;r<e+3;++r)if(this.information.get(r))return!1;return!0},t.prototype.isNumericToAlphaNumericLatch=function(e){if(e+1>this.information.getSize())return!1;for(var r=0;r<4&&r+e<this.information.getSize();++r)if(this.information.get(e+r))return!1;return!0},t}(),zre=function(){function t(e){this.information=e,this.generalDecoder=new lE(e)}return t.prototype.getInformation=function(){return this.information},t.prototype.getGeneralDecoder=function(){return this.generalDecoder},t}(),n5e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Vd=function(t){n5e(e,t);function e(r){return t.call(this,r)||this}return e.prototype.encodeCompressedGtin=function(r,n){r.append("(01)");var a=r.length();r.append("9"),this.encodeCompressedGtinWithoutAI(r,n,a)},e.prototype.encodeCompressedGtinWithoutAI=function(r,n,a){for(var s=0;s<4;++s){var o=this.getGeneralDecoder().extractNumericValueFromBitArray(n+10*s,10);o/100===0&&r.append("0"),o/10===0&&r.append("0"),r.append(o)}e.appendCheckDigit(r,a)},e.appendCheckDigit=function(r,n){for(var a=0,s=0;s<13;s++){var o=r.charAt(s+n).charCodeAt(0)-48;a+=s&1?o:3*o}a=10-a%10,a===10&&(a=0),r.append(a)},e.GTIN_SIZE=40,e}(zre),a5e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),s5e=function(t){a5e(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){var r=new Dn;r.append("(01)");var n=r.length(),a=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE,4);return r.append(a),this.encodeCompressedGtinWithoutAI(r,e.HEADER_SIZE+4,n),this.getGeneralDecoder().decodeAllCodes(r,e.HEADER_SIZE+44)},e.HEADER_SIZE=4,e}(Vd),i5e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),o5e=function(t){i5e(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){var r=new Dn;return this.getGeneralDecoder().decodeAllCodes(r,e.HEADER_SIZE)},e.HEADER_SIZE=5,e}(zre),l5e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),cE=function(t){l5e(e,t);function e(r){return t.call(this,r)||this}return e.prototype.encodeCompressedWeight=function(r,n,a){var s=this.getGeneralDecoder().extractNumericValueFromBitArray(n,a);this.addWeightCode(r,s);for(var o=this.checkWeight(s),l=1e5,c=0;c<5;++c)o/l===0&&r.append("0"),l/=10;r.append(o)},e}(Vd),c5e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Wre=function(t){c5e(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+cE.GTIN_SIZE+e.WEIGHT_SIZE)throw new Zt;var r=new Dn;return this.encodeCompressedGtin(r,e.HEADER_SIZE),this.encodeCompressedWeight(r,e.HEADER_SIZE+cE.GTIN_SIZE,e.WEIGHT_SIZE),r.toString()},e.HEADER_SIZE=5,e.WEIGHT_SIZE=15,e}(cE),u5e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),d5e=function(t){u5e(e,t);function e(r){return t.call(this,r)||this}return e.prototype.addWeightCode=function(r,n){r.append("(3103)")},e.prototype.checkWeight=function(r){return r},e}(Wre),f5e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),h5e=function(t){f5e(e,t);function e(r){return t.call(this,r)||this}return e.prototype.addWeightCode=function(r,n){n<1e4?r.append("(3202)"):r.append("(3203)")},e.prototype.checkWeight=function(r){return r<1e4?r:r-1e4},e}(Wre),A5e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),m5e=function(t){A5e(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+Vd.GTIN_SIZE)throw new Zt;var r=new Dn;this.encodeCompressedGtin(r,e.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+Vd.GTIN_SIZE,e.LAST_DIGIT_SIZE);r.append("(392"),r.append(n),r.append(")");var a=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+Vd.GTIN_SIZE+e.LAST_DIGIT_SIZE,null);return r.append(a.getNewString()),r.toString()},e.HEADER_SIZE=8,e.LAST_DIGIT_SIZE=2,e}(Vd),p5e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),g5e=function(t){p5e(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+Vd.GTIN_SIZE)throw new Zt;var r=new Dn;this.encodeCompressedGtin(r,e.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+Vd.GTIN_SIZE,e.LAST_DIGIT_SIZE);r.append("(393"),r.append(n),r.append(")");var a=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+Vd.GTIN_SIZE+e.LAST_DIGIT_SIZE,e.FIRST_THREE_DIGITS_SIZE);a/100===0&&r.append("0"),a/10===0&&r.append("0"),r.append(a);var s=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+Vd.GTIN_SIZE+e.LAST_DIGIT_SIZE+e.FIRST_THREE_DIGITS_SIZE,null);return r.append(s.getNewString()),r.toString()},e.HEADER_SIZE=8,e.LAST_DIGIT_SIZE=2,e.FIRST_THREE_DIGITS_SIZE=10,e}(Vd),x5e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),n0=function(t){x5e(e,t);function e(r,n,a){var s=t.call(this,r)||this;return s.dateCode=a,s.firstAIdigits=n,s}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE+e.DATE_SIZE)throw new Zt;var r=new Dn;return this.encodeCompressedGtin(r,e.HEADER_SIZE),this.encodeCompressedWeight(r,e.HEADER_SIZE+e.GTIN_SIZE,e.WEIGHT_SIZE),this.encodeCompressedDate(r,e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE),r.toString()},e.prototype.encodeCompressedDate=function(r,n){var a=this.getGeneralDecoder().extractNumericValueFromBitArray(n,e.DATE_SIZE);if(a!==38400){r.append("("),r.append(this.dateCode),r.append(")");var s=a%32;a/=32;var o=a%12+1;a/=12;var l=a;l/10===0&&r.append("0"),r.append(l),o/10===0&&r.append("0"),r.append(o),s/10===0&&r.append("0"),r.append(s)}},e.prototype.addWeightCode=function(r,n){r.append("("),r.append(this.firstAIdigits),r.append(n/1e5),r.append(")")},e.prototype.checkWeight=function(r){return r%1e5},e.HEADER_SIZE=8,e.WEIGHT_SIZE=20,e.DATE_SIZE=16,e}(cE);function v5e(t){try{if(t.get(1))return new s5e(t);if(!t.get(2))return new o5e(t);var e=lE.extractNumericValueFromBitArray(t,1,4);switch(e){case 4:return new d5e(t);case 5:return new h5e(t)}var r=lE.extractNumericValueFromBitArray(t,1,5);switch(r){case 12:return new m5e(t);case 13:return new g5e(t)}var n=lE.extractNumericValueFromBitArray(t,1,7);switch(n){case 56:return new n0(t,"310","11");case 57:return new n0(t,"320","11");case 58:return new n0(t,"310","13");case 59:return new n0(t,"320","13");case 60:return new n0(t,"310","15");case 61:return new n0(t,"320","15");case 62:return new n0(t,"310","17");case 63:return new n0(t,"320","17")}}catch(a){throw console.log(a),new jw("unknown decoder: "+t)}}var uH=function(){function t(e,r,n,a){this.leftchar=e,this.rightchar=r,this.finderpattern=n,this.maybeLast=a}return t.prototype.mayBeLast=function(){return this.maybeLast},t.prototype.getLeftChar=function(){return this.leftchar},t.prototype.getRightChar=function(){return this.rightchar},t.prototype.getFinderPattern=function(){return this.finderpattern},t.prototype.mustBeLast=function(){return this.rightchar==null},t.prototype.toString=function(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"},t.equals=function(e,r){return e instanceof t?t.equalsOrNull(e.leftchar,r.leftchar)&&t.equalsOrNull(e.rightchar,r.rightchar)&&t.equalsOrNull(e.finderpattern,r.finderpattern):!1},t.equalsOrNull=function(e,r){return e===null?r===null:t.equals(e,r)},t.prototype.hashCode=function(){var e=this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue();return e},t}(),y5e=function(){function t(e,r,n){this.pairs=e,this.rowNumber=r,this.wasReversed=n}return t.prototype.getPairs=function(){return this.pairs},t.prototype.getRowNumber=function(){return this.rowNumber},t.prototype.isReversed=function(){return this.wasReversed},t.prototype.isEquivalent=function(e){return this.checkEqualitity(this,e)},t.prototype.toString=function(){return"{ "+this.pairs+" }"},t.prototype.equals=function(e,r){return e instanceof t?this.checkEqualitity(e,r)&&e.wasReversed===r.wasReversed:!1},t.prototype.checkEqualitity=function(e,r){if(!(!e||!r)){var n;return e.forEach(function(a,s){r.forEach(function(o){a.getLeftChar().getValue()===o.getLeftChar().getValue()&&a.getRightChar().getValue()===o.getRightChar().getValue()&&a.getFinderPatter().getValue()===o.getFinderPatter().getValue()&&(n=!0)})}),n}},t}(),b5e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),a0=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},w5e=function(t){b5e(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.pairs=new Array(e.MAX_PAIRS),r.rows=new Array,r.startEnd=[2],r}return e.prototype.decodeRow=function(r,n,a){this.pairs.length=0,this.startFromEven=!1;try{return e.constructResult(this.decodeRow2pairs(r,n))}catch{}return this.pairs.length=0,this.startFromEven=!0,e.constructResult(this.decodeRow2pairs(r,n))},e.prototype.reset=function(){this.pairs.length=0,this.rows.length=0},e.prototype.decodeRow2pairs=function(r,n){for(var a=!1;!a;)try{this.pairs.push(this.retrieveNextPair(n,this.pairs,r))}catch(l){if(l instanceof Zt){if(!this.pairs.length)throw new Zt;a=!0}}if(this.checkChecksum())return this.pairs;var s;if(this.rows.length?s=!0:s=!1,this.storeRow(r,!1),s){var o=this.checkRowsBoolean(!1);if(o!=null||(o=this.checkRowsBoolean(!0),o!=null))return o}throw new Zt},e.prototype.checkRowsBoolean=function(r){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,r&&(this.rows=this.rows.reverse());var n=null;try{n=this.checkRows(new Array,0)}catch(a){console.log(a)}return r&&(this.rows=this.rows.reverse()),n},e.prototype.checkRows=function(r,n){for(var a,s,o=n;o<this.rows.length;o++){var l=this.rows[o];this.pairs.length=0;try{for(var c=(a=void 0,a0(r)),u=c.next();!u.done;u=c.next()){var d=u.value;this.pairs.push(d.getPairs())}}catch(A){a={error:A}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(a)throw a.error}}if(this.pairs.push(l.getPairs()),!!e.isValidSequence(this.pairs)){if(this.checkChecksum())return this.pairs;var f=new Array(r);f.push(l);try{return this.checkRows(f,o+1)}catch(A){console.log(A)}}}throw new Zt},e.isValidSequence=function(r){var n,a;try{for(var s=a0(e.FINDER_PATTERN_SEQUENCES),o=s.next();!o.done;o=s.next()){var l=o.value;if(!(r.length>l.length)){for(var c=!0,u=0;u<r.length;u++)if(r[u].getFinderPattern().getValue()!==l[u]){c=!1;break}if(c)return!0}}}catch(d){n={error:d}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}return!1},e.prototype.storeRow=function(r,n){for(var a=0,s=!1,o=!1;a<this.rows.length;){var l=this.rows[a];if(l.getRowNumber()>r){o=l.isEquivalent(this.pairs);break}s=l.isEquivalent(this.pairs),a++}o||s||e.isPartialRow(this.pairs,this.rows)||(this.rows.push(a,new y5e(this.pairs,r,n)),this.removePartialRows(this.pairs,this.rows))},e.prototype.removePartialRows=function(r,n){var a,s,o,l,c,u;try{for(var d=a0(n),f=d.next();!f.done;f=d.next()){var A=f.value;if(A.getPairs().length!==r.length){var h=!0;try{for(var m=(o=void 0,a0(A.getPairs())),p=m.next();!p.done;p=m.next()){var g=p.value,v=!1;try{for(var y=(c=void 0,a0(r)),b=y.next();!b.done;b=y.next()){var w=b.value;if(uH.equals(g,w)){v=!0;break}}}catch(j){c={error:j}}finally{try{b&&!b.done&&(u=y.return)&&u.call(y)}finally{if(c)throw c.error}}v||(h=!1)}}catch(j){o={error:j}}finally{try{p&&!p.done&&(l=m.return)&&l.call(m)}finally{if(o)throw o.error}}}}}catch(j){a={error:j}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}},e.isPartialRow=function(r,n){var a,s,o,l,c,u;try{for(var d=a0(n),f=d.next();!f.done;f=d.next()){var A=f.value,h=!0;try{for(var m=(o=void 0,a0(r)),p=m.next();!p.done;p=m.next()){var g=p.value,v=!1;try{for(var y=(c=void 0,a0(A.getPairs())),b=y.next();!b.done;b=y.next()){var w=b.value;if(g.equals(w)){v=!0;break}}}catch(j){c={error:j}}finally{try{b&&!b.done&&(u=y.return)&&u.call(y)}finally{if(c)throw c.error}}if(!v){h=!1;break}}}catch(j){o={error:j}}finally{try{p&&!p.done&&(l=m.return)&&l.call(m)}finally{if(o)throw o.error}}if(h)return!0}}catch(j){a={error:j}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}return!1},e.prototype.getRows=function(){return this.rows},e.constructResult=function(r){var n=J3e.buildBitArray(r),a=v5e(n),s=a.parseInformation(),o=r[0].getFinderPattern().getResultPoints(),l=r[r.length-1].getFinderPattern().getResultPoints(),c=[o[0],o[1],l[0],l[1]];return new Vl(s,null,null,c,ln.RSS_EXPANDED,null)},e.prototype.checkChecksum=function(){var r=this.pairs.get(0),n=r.getLeftChar(),a=r.getRightChar();if(a===null)return!1;for(var s=a.getChecksumPortion(),o=2,l=1;l<this.pairs.size();++l){var c=this.pairs.get(l);s+=c.getLeftChar().getChecksumPortion(),o++;var u=c.getRightChar();u!=null&&(s+=u.getChecksumPortion(),o++)}s%=211;var d=211*(o-4)+s;return d===n.getValue()},e.getNextSecondBar=function(r,n){var a;return r.get(n)?(a=r.getNextUnset(n),a=r.getNextSet(a)):(a=r.getNextSet(n),a=r.getNextUnset(a)),a},e.prototype.retrieveNextPair=function(r,n,a){var s=n.length%2===0;this.startFromEven&&(s=!s);var o,l=!0,c=-1;do this.findNextPair(r,n,c),o=this.parseFoundFinderPattern(r,a,s),o===null?c=e.getNextSecondBar(r,this.startEnd[0]):l=!1;while(l);var u=this.decodeDataCharacter(r,o,s,!0);if(!this.isEmptyPair(n)&&n[n.length-1].mustBeLast())throw new Zt;var d;try{d=this.decodeDataCharacter(r,o,s,!1)}catch(f){d=null,console.log(f)}return new uH(u,d,o,!0)},e.prototype.isEmptyPair=function(r){return r.length===0},e.prototype.findNextPair=function(r,n,a){var s=this.getDecodeFinderCounters();s[0]=0,s[1]=0,s[2]=0,s[3]=0;var o=r.getSize(),l;if(a>=0)l=a;else if(this.isEmptyPair(n))l=0;else{var c=n[n.length-1];l=c.getFinderPattern().getStartEnd()[1]}var u=n.length%2!==0;this.startFromEven&&(u=!u);for(var d=!1;l<o&&(d=!r.get(l),!!d);)l++;for(var f=0,A=l,h=l;h<o;h++)if(r.get(h)!==d)s[f]++;else{if(f===3){if(u&&e.reverseCounters(s),e.isFinderPattern(s)){this.startEnd[0]=A,this.startEnd[1]=h;return}u&&e.reverseCounters(s),A+=s[0]+s[1],s[0]=s[2],s[1]=s[3],s[2]=0,s[3]=0,f--}else f++;s[f]=1,d=!d}throw new Zt},e.reverseCounters=function(r){for(var n=r.length,a=0;a<n/2;++a){var s=r[a];r[a]=r[n-a-1],r[n-a-1]=s}},e.prototype.parseFoundFinderPattern=function(r,n,a){var s,o,l;if(a){for(var c=this.startEnd[0]-1;c>=0&&!r.get(c);)c--;c++,s=this.startEnd[0]-c,o=c,l=this.startEnd[1]}else o=this.startEnd[0],l=r.getNextUnset(this.startEnd[1]+1),s=l-this.startEnd[1];var u=this.getDecodeFinderCounters();ss.arraycopy(u,0,u,1,u.length-1),u[0]=s;var d;try{d=this.parseFinderValue(u,e.FINDER_PATTERNS)}catch{return null}return new qre(d,[o,l],o,l,n)},e.prototype.decodeDataCharacter=function(r,n,a,s){for(var o=this.getDataCharacterCounters(),l=0;l<o.length;l++)o[l]=0;if(s)e.recordPatternInReverse(r,n.getStartEnd()[0],o);else{e.recordPattern(r,n.getStartEnd()[1],o);for(var c=0,u=o.length-1;c<u;c++,u--){var d=o[c];o[c]=o[u],o[u]=d}}var f=17,A=da.sum(new Int32Array(o))/f,h=(n.getStartEnd()[1]-n.getStartEnd()[0])/15;if(Math.abs(A-h)/h>.3)throw new Zt;for(var m=this.getOddCounts(),p=this.getEvenCounts(),g=this.getOddRoundingErrors(),v=this.getEvenRoundingErrors(),c=0;c<o.length;c++){var y=1*o[c]/A,b=y+.5;if(b<1){if(y<.3)throw new Zt;b=1}else if(b>8){if(y>8.7)throw new Zt;b=8}var w=c/2;c&1?(p[w]=b,v[w]=y-b):(m[w]=b,g[w]=y-b)}this.adjustOddEvenCounts(f);for(var j=4*n.getValue()+(a?0:2)+(s?0:1)-1,I=0,_=0,c=m.length-1;c>=0;c--){if(e.isNotA1left(n,a,s)){var S=e.WEIGHTS[j][2*c];_+=m[c]*S}I+=m[c]}for(var E=0,c=p.length-1;c>=0;c--)if(e.isNotA1left(n,a,s)){var S=e.WEIGHTS[j][2*c+1];E+=p[c]*S}var F=_+E;if(I&1||I>13||I<4)throw new Zt;var k=(13-I)/2,P=e.SYMBOL_WIDEST[k],D=9-P,X=Vx.getRSSvalue(m,P,!0),pe=Vx.getRSSvalue(p,D,!1),ge=e.EVEN_TOTAL_SUBSET[k],fe=e.GSUM[k],xe=X*ge+pe+fe;return new jS(xe,F)},e.isNotA1left=function(r,n,a){return!(r.getValue()===0&&n&&a)},e.prototype.adjustOddEvenCounts=function(r){var n=da.sum(new Int32Array(this.getOddCounts())),a=da.sum(new Int32Array(this.getEvenCounts())),s=!1,o=!1;n>13?o=!0:n<4&&(s=!0);var l=!1,c=!1;a>13?c=!0:a<4&&(l=!0);var u=n+a-r,d=(n&1)===1,f=(a&1)===0;if(u===1)if(d){if(f)throw new Zt;o=!0}else{if(!f)throw new Zt;c=!0}else if(u===-1)if(d){if(f)throw new Zt;s=!0}else{if(!f)throw new Zt;l=!0}else if(u===0){if(d){if(!f)throw new Zt;n<a?(s=!0,c=!0):(o=!0,l=!0)}else if(f)throw new Zt}else throw new Zt;if(s){if(o)throw new Zt;e.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&e.decrement(this.getOddCounts(),this.getOddRoundingErrors()),l){if(c)throw new Zt;e.increment(this.getEvenCounts(),this.getOddRoundingErrors())}c&&e.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.SYMBOL_WIDEST=[7,5,4,3,1],e.EVEN_TOTAL_SUBSET=[4,20,52,104,204],e.GSUM=[0,348,1388,2948,3988],e.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],e.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],e.FINDER_PAT_A=0,e.FINDER_PAT_B=1,e.FINDER_PAT_C=2,e.FINDER_PAT_D=3,e.FINDER_PAT_E=4,e.FINDER_PAT_F=5,e.FINDER_PATTERN_SEQUENCES=[[e.FINDER_PAT_A,e.FINDER_PAT_A],[e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B],[e.FINDER_PAT_A,e.FINDER_PAT_C,e.FINDER_PAT_B,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_C],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F]],e.MAX_PAIRS=11,e}(Zm),N5e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),C5e=function(t){N5e(e,t);function e(r,n,a){var s=t.call(this,r,n)||this;return s.count=0,s.finderPattern=a,s}return e.prototype.getFinderPattern=function(){return this.finderPattern},e.prototype.getCount=function(){return this.count},e.prototype.incrementCount=function(){this.count++},e}(jS),_5e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),p5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},dH=function(t){_5e(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.possibleLeftPairs=[],r.possibleRightPairs=[],r}return e.prototype.decodeRow=function(r,n,a){var s,o,l,c,u=this.decodePair(n,!1,r,a);e.addOrTally(this.possibleLeftPairs,u),n.reverse();var d=this.decodePair(n,!0,r,a);e.addOrTally(this.possibleRightPairs,d),n.reverse();try{for(var f=p5(this.possibleLeftPairs),A=f.next();!A.done;A=f.next()){var h=A.value;if(h.getCount()>1)try{for(var m=(l=void 0,p5(this.possibleRightPairs)),p=m.next();!p.done;p=m.next()){var g=p.value;if(g.getCount()>1&&e.checkChecksum(h,g))return e.constructResult(h,g)}}catch(v){l={error:v}}finally{try{p&&!p.done&&(c=m.return)&&c.call(m)}finally{if(l)throw l.error}}}}catch(v){s={error:v}}finally{try{A&&!A.done&&(o=f.return)&&o.call(f)}finally{if(s)throw s.error}}throw new Zt},e.addOrTally=function(r,n){var a,s;if(n!=null){var o=!1;try{for(var l=p5(r),c=l.next();!c.done;c=l.next()){var u=c.value;if(u.getValue()===n.getValue()){u.incrementCount(),o=!0;break}}}catch(d){a={error:d}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}o||r.push(n)}},e.prototype.reset=function(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0},e.constructResult=function(r,n){for(var a=4537077*r.getValue()+n.getValue(),s=new String(a).toString(),o=new Dn,l=13-s.length;l>0;l--)o.append("0");o.append(s);for(var c=0,l=0;l<13;l++){var u=o.charAt(l).charCodeAt(0)-48;c+=l&1?u:3*u}c=10-c%10,c===10&&(c=0),o.append(c.toString());var d=r.getFinderPattern().getResultPoints(),f=n.getFinderPattern().getResultPoints();return new Vl(o.toString(),null,0,[d[0],d[1],f[0],f[1]],ln.RSS_14,new Date().getTime())},e.checkChecksum=function(r,n){var a=(r.getChecksumPortion()+16*n.getChecksumPortion())%79,s=9*r.getFinderPattern().getValue()+n.getFinderPattern().getValue();return s>72&&s--,s>8&&s--,a===s},e.prototype.decodePair=function(r,n,a,s){try{var o=this.findFinderPattern(r,n),l=this.parseFoundFinderPattern(r,a,n,o),c=s==null?null:s.get(is.NEED_RESULT_POINT_CALLBACK);if(c!=null){var u=(o[0]+o[1])/2;n&&(u=r.getSize()-1-u),c.foundPossibleResultPoint(new Kr(u,a))}var d=this.decodeDataCharacter(r,l,!0),f=this.decodeDataCharacter(r,l,!1);return new C5e(1597*d.getValue()+f.getValue(),d.getChecksumPortion()+4*f.getChecksumPortion(),l)}catch{return null}},e.prototype.decodeDataCharacter=function(r,n,a){for(var s=this.getDataCharacterCounters(),o=0;o<s.length;o++)s[o]=0;if(a)ho.recordPatternInReverse(r,n.getStartEnd()[0],s);else{ho.recordPattern(r,n.getStartEnd()[1]+1,s);for(var l=0,c=s.length-1;l<c;l++,c--){var u=s[l];s[l]=s[c],s[c]=u}}for(var d=a?16:15,f=da.sum(new Int32Array(s))/d,A=this.getOddCounts(),h=this.getEvenCounts(),m=this.getOddRoundingErrors(),p=this.getEvenRoundingErrors(),l=0;l<s.length;l++){var g=s[l]/f,v=Math.floor(g+.5);v<1?v=1:v>8&&(v=8);var y=Math.floor(l/2);l&1?(h[y]=v,p[y]=g-v):(A[y]=v,m[y]=g-v)}this.adjustOddEvenCounts(a,d);for(var b=0,w=0,l=A.length-1;l>=0;l--)w*=9,w+=A[l],b+=A[l];for(var j=0,I=0,l=h.length-1;l>=0;l--)j*=9,j+=h[l],I+=h[l];var _=w+3*j;if(a){if(b&1||b>12||b<4)throw new Zt;var S=(12-b)/2,E=e.OUTSIDE_ODD_WIDEST[S],F=9-E,k=Vx.getRSSvalue(A,E,!1),P=Vx.getRSSvalue(h,F,!0),D=e.OUTSIDE_EVEN_TOTAL_SUBSET[S],X=e.OUTSIDE_GSUM[S];return new jS(k*D+P+X,_)}else{if(I&1||I>10||I<4)throw new Zt;var S=(10-I)/2,E=e.INSIDE_ODD_WIDEST[S],F=9-E,k=Vx.getRSSvalue(A,E,!0),P=Vx.getRSSvalue(h,F,!1),pe=e.INSIDE_ODD_TOTAL_SUBSET[S],X=e.INSIDE_GSUM[S];return new jS(P*pe+k+X,_)}},e.prototype.findFinderPattern=function(r,n){var a=this.getDecodeFinderCounters();a[0]=0,a[1]=0,a[2]=0,a[3]=0;for(var s=r.getSize(),o=!1,l=0;l<s&&(o=!r.get(l),n!==o);)l++;for(var c=0,u=l,d=l;d<s;d++)if(r.get(d)!==o)a[c]++;else{if(c===3){if(Zm.isFinderPattern(a))return[u,d];u+=a[0]+a[1],a[0]=a[2],a[1]=a[3],a[2]=0,a[3]=0,c--}else c++;a[c]=1,o=!o}throw new Zt},e.prototype.parseFoundFinderPattern=function(r,n,a,s){for(var o=r.get(s[0]),l=s[0]-1;l>=0&&o!==r.get(l);)l--;l++;var c=s[0]-l,u=this.getDecodeFinderCounters(),d=new Int32Array(u.length);ss.arraycopy(u,0,d,1,u.length-1),d[0]=c;var f=this.parseFinderValue(d,e.FINDER_PATTERNS),A=l,h=s[1];return a&&(A=r.getSize()-1-A,h=r.getSize()-1-h),new qre(f,[l,s[1]],A,h,n)},e.prototype.adjustOddEvenCounts=function(r,n){var a=da.sum(new Int32Array(this.getOddCounts())),s=da.sum(new Int32Array(this.getEvenCounts())),o=!1,l=!1,c=!1,u=!1;r?(a>12?l=!0:a<4&&(o=!0),s>12?u=!0:s<4&&(c=!0)):(a>11?l=!0:a<5&&(o=!0),s>10?u=!0:s<4&&(c=!0));var d=a+s-n,f=(a&1)===(r?1:0),A=(s&1)===1;if(d===1)if(f){if(A)throw new Zt;l=!0}else{if(!A)throw new Zt;u=!0}else if(d===-1)if(f){if(A)throw new Zt;o=!0}else{if(!A)throw new Zt;c=!0}else if(d===0){if(f){if(!A)throw new Zt;a<s?(o=!0,u=!0):(l=!0,c=!0)}else if(A)throw new Zt}else throw new Zt;if(o){if(l)throw new Zt;Zm.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(l&&Zm.decrement(this.getOddCounts(),this.getOddRoundingErrors()),c){if(u)throw new Zt;Zm.increment(this.getEvenCounts(),this.getOddRoundingErrors())}u&&Zm.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],e.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],e.OUTSIDE_GSUM=[0,161,961,2015,2715],e.INSIDE_GSUM=[0,336,1036,1516],e.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],e.INSIDE_ODD_WIDEST=[2,4,6,8],e.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])],e}(Zm),E5e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Hx=function(t){E5e(e,t);function e(r){var n=t.call(this)||this;n.readers=[];var a=r?r.get(is.POSSIBLE_FORMATS):null,s=r&&r.get(is.ASSUME_CODE_39_CHECK_DIGIT)!==void 0,o=r&&r.get(is.ENABLE_CODE_39_EXTENDED_MODE)!==void 0;return a&&((a.includes(ln.EAN_13)||a.includes(ln.UPC_A)||a.includes(ln.EAN_8)||a.includes(ln.UPC_E))&&n.readers.push(new m5(r)),a.includes(ln.CODE_39)&&n.readers.push(new tH(s,o)),a.includes(ln.CODE_93)&&n.readers.push(new rH),a.includes(ln.CODE_128)&&n.readers.push(new eH),a.includes(ln.ITF)&&n.readers.push(new nH),a.includes(ln.CODABAR)&&n.readers.push(new z3e),a.includes(ln.RSS_14)&&n.readers.push(new dH),a.includes(ln.RSS_EXPANDED)&&(console.warn("RSS Expanded reader IS NOT ready for production yet! use at your own risk."),n.readers.push(new w5e))),n.readers.length===0&&(n.readers.push(new m5(r)),n.readers.push(new tH),n.readers.push(new rH),n.readers.push(new m5(r)),n.readers.push(new eH),n.readers.push(new nH),n.readers.push(new dH)),n}return e.prototype.decodeRow=function(r,n,a){for(var s=0;s<this.readers.length;s++)try{return this.readers[s].decodeRow(r,n,a)}catch{}throw new Zt},e.prototype.reset=function(){this.readers.forEach(function(r){return r.reset()})},e}(ho),S5e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){S5e(e,t);function e(r,n){return r===void 0&&(r=500),t.call(this,new Hx(n),r,n)||this}return e})(u1);var fH=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Na=function(){function t(e,r,n){this.ecCodewords=e,this.ecBlocks=[r],n&&this.ecBlocks.push(n)}return t.prototype.getECCodewords=function(){return this.ecCodewords},t.prototype.getECBlocks=function(){return this.ecBlocks},t}(),pa=function(){function t(e,r){this.count=e,this.dataCodewords=r}return t.prototype.getCount=function(){return this.count},t.prototype.getDataCodewords=function(){return this.dataCodewords},t}(),I5e=function(){function t(e,r,n,a,s,o){var l,c;this.versionNumber=e,this.symbolSizeRows=r,this.symbolSizeColumns=n,this.dataRegionSizeRows=a,this.dataRegionSizeColumns=s,this.ecBlocks=o;var u=0,d=o.getECCodewords(),f=o.getECBlocks();try{for(var A=fH(f),h=A.next();!h.done;h=A.next()){var m=h.value;u+=m.getCount()*(m.getDataCodewords()+d)}}catch(p){l={error:p}}finally{try{h&&!h.done&&(c=A.return)&&c.call(A)}finally{if(l)throw l.error}}this.totalCodewords=u}return t.prototype.getVersionNumber=function(){return this.versionNumber},t.prototype.getSymbolSizeRows=function(){return this.symbolSizeRows},t.prototype.getSymbolSizeColumns=function(){return this.symbolSizeColumns},t.prototype.getDataRegionSizeRows=function(){return this.dataRegionSizeRows},t.prototype.getDataRegionSizeColumns=function(){return this.dataRegionSizeColumns},t.prototype.getTotalCodewords=function(){return this.totalCodewords},t.prototype.getECBlocks=function(){return this.ecBlocks},t.getVersionForDimensions=function(e,r){var n,a;if(e&1||r&1)throw new Sr;try{for(var s=fH(t.VERSIONS),o=s.next();!o.done;o=s.next()){var l=o.value;if(l.symbolSizeRows===e&&l.symbolSizeColumns===r)return l}}catch(c){n={error:c}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}throw new Sr},t.prototype.toString=function(){return""+this.versionNumber},t.buildVersions=function(){return[new t(1,10,10,8,8,new Na(5,new pa(1,3))),new t(2,12,12,10,10,new Na(7,new pa(1,5))),new t(3,14,14,12,12,new Na(10,new pa(1,8))),new t(4,16,16,14,14,new Na(12,new pa(1,12))),new t(5,18,18,16,16,new Na(14,new pa(1,18))),new t(6,20,20,18,18,new Na(18,new pa(1,22))),new t(7,22,22,20,20,new Na(20,new pa(1,30))),new t(8,24,24,22,22,new Na(24,new pa(1,36))),new t(9,26,26,24,24,new Na(28,new pa(1,44))),new t(10,32,32,14,14,new Na(36,new pa(1,62))),new t(11,36,36,16,16,new Na(42,new pa(1,86))),new t(12,40,40,18,18,new Na(48,new pa(1,114))),new t(13,44,44,20,20,new Na(56,new pa(1,144))),new t(14,48,48,22,22,new Na(68,new pa(1,174))),new t(15,52,52,24,24,new Na(42,new pa(2,102))),new t(16,64,64,14,14,new Na(56,new pa(2,140))),new t(17,72,72,16,16,new Na(36,new pa(4,92))),new t(18,80,80,18,18,new Na(48,new pa(4,114))),new t(19,88,88,20,20,new Na(56,new pa(4,144))),new t(20,96,96,22,22,new Na(68,new pa(4,174))),new t(21,104,104,24,24,new Na(56,new pa(6,136))),new t(22,120,120,18,18,new Na(68,new pa(6,175))),new t(23,132,132,20,20,new Na(62,new pa(8,163))),new t(24,144,144,22,22,new Na(62,new pa(8,156),new pa(2,155))),new t(25,8,18,6,16,new Na(7,new pa(1,5))),new t(26,8,32,6,14,new Na(11,new pa(1,10))),new t(27,12,26,10,24,new Na(14,new pa(1,16))),new t(28,12,36,10,16,new Na(18,new pa(1,22))),new t(29,16,36,14,16,new Na(24,new pa(1,32))),new t(30,16,48,14,22,new Na(28,new pa(1,49)))]},t.VERSIONS=t.buildVersions(),t}(),j5e=function(){function t(e){var r=e.getHeight();if(r<8||r>144||r&1)throw new Sr;this.version=t.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new Kf(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}return t.prototype.getVersion=function(){return this.version},t.readVersion=function(e){var r=e.getHeight(),n=e.getWidth();return I5e.getVersionForDimensions(r,n)},t.prototype.readCodewords=function(){var e=new Int8Array(this.version.getTotalCodewords()),r=0,n=4,a=0,s=this.mappingBitMatrix.getHeight(),o=this.mappingBitMatrix.getWidth(),l=!1,c=!1,u=!1,d=!1;do if(n===s&&a===0&&!l)e[r++]=this.readCorner1(s,o)&255,n-=2,a+=2,l=!0;else if(n===s-2&&a===0&&o&3&&!c)e[r++]=this.readCorner2(s,o)&255,n-=2,a+=2,c=!0;else if(n===s+4&&a===2&&!(o&7)&&!u)e[r++]=this.readCorner3(s,o)&255,n-=2,a+=2,u=!0;else if(n===s-2&&a===0&&(o&7)===4&&!d)e[r++]=this.readCorner4(s,o)&255,n-=2,a+=2,d=!0;else{do n<s&&a>=0&&!this.readMappingMatrix.get(a,n)&&(e[r++]=this.readUtah(n,a,s,o)&255),n-=2,a+=2;while(n>=0&&a<o);n+=1,a+=3;do n>=0&&a<o&&!this.readMappingMatrix.get(a,n)&&(e[r++]=this.readUtah(n,a,s,o)&255),n+=2,a-=2;while(n<s&&a>=0);n+=3,a+=1}while(n<s||a<o);if(r!==this.version.getTotalCodewords())throw new Sr;return e},t.prototype.readModule=function(e,r,n,a){return e<0&&(e+=n,r+=4-(n+4&7)),r<0&&(r+=a,e+=4-(a+4&7)),this.readMappingMatrix.set(r,e),this.mappingBitMatrix.get(r,e)},t.prototype.readUtah=function(e,r,n,a){var s=0;return this.readModule(e-2,r-2,n,a)&&(s|=1),s<<=1,this.readModule(e-2,r-1,n,a)&&(s|=1),s<<=1,this.readModule(e-1,r-2,n,a)&&(s|=1),s<<=1,this.readModule(e-1,r-1,n,a)&&(s|=1),s<<=1,this.readModule(e-1,r,n,a)&&(s|=1),s<<=1,this.readModule(e,r-2,n,a)&&(s|=1),s<<=1,this.readModule(e,r-1,n,a)&&(s|=1),s<<=1,this.readModule(e,r,n,a)&&(s|=1),s},t.prototype.readCorner1=function(e,r){var n=0;return this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,1,e,r)&&(n|=1),n<<=1,this.readModule(e-1,2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n<<=1,this.readModule(2,r-1,e,r)&&(n|=1),n<<=1,this.readModule(3,r-1,e,r)&&(n|=1),n},t.prototype.readCorner2=function(e,r){var n=0;return this.readModule(e-3,0,e,r)&&(n|=1),n<<=1,this.readModule(e-2,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(0,r-4,e,r)&&(n|=1),n<<=1,this.readModule(0,r-3,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n},t.prototype.readCorner3=function(e,r){var n=0;return this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,r-1,e,r)&&(n|=1),n<<=1,this.readModule(0,r-3,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-3,e,r)&&(n|=1),n<<=1,this.readModule(1,r-2,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n},t.prototype.readCorner4=function(e,r){var n=0;return this.readModule(e-3,0,e,r)&&(n|=1),n<<=1,this.readModule(e-2,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n<<=1,this.readModule(2,r-1,e,r)&&(n|=1),n<<=1,this.readModule(3,r-1,e,r)&&(n|=1),n},t.prototype.extractDataRegion=function(e){var r=this.version.getSymbolSizeRows(),n=this.version.getSymbolSizeColumns();if(e.getHeight()!==r)throw new cn("Dimension of bitMatrix must match the version size");for(var a=this.version.getDataRegionSizeRows(),s=this.version.getDataRegionSizeColumns(),o=r/a|0,l=n/s|0,c=o*a,u=l*s,d=new Kf(u,c),f=0;f<o;++f)for(var A=f*a,h=0;h<l;++h)for(var m=h*s,p=0;p<a;++p)for(var g=f*(a+2)+1+p,v=A+p,y=0;y<s;++y){var b=h*(s+2)+1+y;if(e.get(b,g)){var w=m+y;d.set(w,v)}}return d},t}(),hH=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},P5e=function(){function t(e,r){this.numDataCodewords=e,this.codewords=r}return t.getDataBlocks=function(e,r){var n,a,s,o,l=r.getECBlocks(),c=0,u=l.getECBlocks();try{for(var d=hH(u),f=d.next();!f.done;f=d.next()){var A=f.value;c+=A.getCount()}}catch(X){n={error:X}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}var h=new Array(c),m=0;try{for(var p=hH(u),g=p.next();!g.done;g=p.next())for(var A=g.value,v=0;v<A.getCount();v++){var y=A.getDataCodewords(),b=l.getECCodewords()+y;h[m++]=new t(y,new Uint8Array(b))}}catch(X){s={error:X}}finally{try{g&&!g.done&&(o=p.return)&&o.call(p)}finally{if(s)throw s.error}}for(var w=h[0].codewords.length,j=w-l.getECCodewords(),I=j-1,_=0,v=0;v<I;v++)for(var S=0;S<m;S++)h[S].codewords[v]=e[_++];for(var E=r.getVersionNumber()===24,F=E?8:m,S=0;S<F;S++)h[S].codewords[j-1]=e[_++];for(var k=h[0].codewords.length,v=j;v<k;v++)for(var S=0;S<m;S++){var P=E?(S+8)%m:S,D=E&&P>7?v-1:v;h[P].codewords[D]=e[_++]}if(_!==e.length)throw new cn;return h},t.prototype.getNumDataCodewords=function(){return this.numDataCodewords},t.prototype.getCodewords=function(){return this.codewords},t}(),Xre=function(){function t(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}return t.prototype.getBitOffset=function(){return this.bitOffset},t.prototype.getByteOffset=function(){return this.byteOffset},t.prototype.readBits=function(e){if(e<1||e>32||e>this.available())throw new cn(""+e);var r=0,n=this.bitOffset,a=this.byteOffset,s=this.bytes;if(n>0){var o=8-n,l=e<o?e:o,c=o-l,u=255>>8-l<<c;r=(s[a]&u)>>c,e-=l,n+=l,n===8&&(n=0,a++)}if(e>0){for(;e>=8;)r=r<<8|s[a]&255,a++,e-=8;if(e>0){var c=8-e,u=255>>c<<c;r=r<<e|(s[a]&u)>>c,n+=e}}return this.bitOffset=n,this.byteOffset=a,r},t.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset},t}(),Zi;(function(t){t[t.PAD_ENCODE=0]="PAD_ENCODE",t[t.ASCII_ENCODE=1]="ASCII_ENCODE",t[t.C40_ENCODE=2]="C40_ENCODE",t[t.TEXT_ENCODE=3]="TEXT_ENCODE",t[t.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",t[t.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",t[t.BASE256_ENCODE=6]="BASE256_ENCODE"})(Zi||(Zi={}));var B5e=function(){function t(){}return t.decode=function(e){var r=new Xre(e),n=new Dn,a=new Dn,s=new Array,o=Zi.ASCII_ENCODE;do if(o===Zi.ASCII_ENCODE)o=this.decodeAsciiSegment(r,n,a);else{switch(o){case Zi.C40_ENCODE:this.decodeC40Segment(r,n);break;case Zi.TEXT_ENCODE:this.decodeTextSegment(r,n);break;case Zi.ANSIX12_ENCODE:this.decodeAnsiX12Segment(r,n);break;case Zi.EDIFACT_ENCODE:this.decodeEdifactSegment(r,n);break;case Zi.BASE256_ENCODE:this.decodeBase256Segment(r,n,s);break;default:throw new Sr}o=Zi.ASCII_ENCODE}while(o!==Zi.PAD_ENCODE&&r.available()>0);return a.length()>0&&n.append(a.toString()),new Wj(e,n.toString(),s.length===0?null:s,null)},t.decodeAsciiSegment=function(e,r,n){var a=!1;do{var s=e.readBits(8);if(s===0)throw new Sr;if(s<=128)return a&&(s+=128),r.append(String.fromCharCode(s-1)),Zi.ASCII_ENCODE;if(s===129)return Zi.PAD_ENCODE;if(s<=229){var o=s-130;o<10&&r.append("0"),r.append(""+o)}else switch(s){case 230:return Zi.C40_ENCODE;case 231:return Zi.BASE256_ENCODE;case 232:r.append("");break;case 233:case 234:break;case 235:a=!0;break;case 236:r.append("[)>05"),n.insert(0,"");break;case 237:r.append("[)>06"),n.insert(0,"");break;case 238:return Zi.ANSIX12_ENCODE;case 239:return Zi.TEXT_ENCODE;case 240:return Zi.EDIFACT_ENCODE;case 241:break;default:if(s!==254||e.available()!==0)throw new Sr;break}}while(e.available()>0);return Zi.ASCII_ENCODE},t.decodeC40Segment=function(e,r){var n=!1,a=[],s=0;do{if(e.available()===8)return;var o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),a);for(var l=0;l<3;l++){var c=a[l];switch(s){case 0:if(c<3)s=c+1;else if(c<this.C40_BASIC_SET_CHARS.length){var u=this.C40_BASIC_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u)}else throw new Sr;break;case 1:n?(r.append(String.fromCharCode(c+128)),n=!1):r.append(String.fromCharCode(c)),s=0;break;case 2:if(c<this.C40_SHIFT2_SET_CHARS.length){var u=this.C40_SHIFT2_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u)}else switch(c){case 27:r.append("");break;case 30:n=!0;break;default:throw new Sr}s=0;break;case 3:n?(r.append(String.fromCharCode(c+224)),n=!1):r.append(String.fromCharCode(c+96)),s=0;break;default:throw new Sr}}}while(e.available()>0)},t.decodeTextSegment=function(e,r){var n=!1,a=[],s=0;do{if(e.available()===8)return;var o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),a);for(var l=0;l<3;l++){var c=a[l];switch(s){case 0:if(c<3)s=c+1;else if(c<this.TEXT_BASIC_SET_CHARS.length){var u=this.TEXT_BASIC_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u)}else throw new Sr;break;case 1:n?(r.append(String.fromCharCode(c+128)),n=!1):r.append(String.fromCharCode(c)),s=0;break;case 2:if(c<this.TEXT_SHIFT2_SET_CHARS.length){var u=this.TEXT_SHIFT2_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u)}else switch(c){case 27:r.append("");break;case 30:n=!0;break;default:throw new Sr}s=0;break;case 3:if(c<this.TEXT_SHIFT3_SET_CHARS.length){var u=this.TEXT_SHIFT3_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u),s=0}else throw new Sr;break;default:throw new Sr}}}while(e.available()>0)},t.decodeAnsiX12Segment=function(e,r){var n=[];do{if(e.available()===8)return;var a=e.readBits(8);if(a===254)return;this.parseTwoBytes(a,e.readBits(8),n);for(var s=0;s<3;s++){var o=n[s];switch(o){case 0:r.append("\r");break;case 1:r.append("*");break;case 2:r.append(">");break;case 3:r.append(" ");break;default:if(o<14)r.append(String.fromCharCode(o+44));else if(o<40)r.append(String.fromCharCode(o+51));else throw new Sr;break}}}while(e.available()>0)},t.parseTwoBytes=function(e,r,n){var a=(e<<8)+r-1,s=Math.floor(a/1600);n[0]=s,a-=s*1600,s=Math.floor(a/40),n[1]=s,n[2]=a-s*40},t.decodeEdifactSegment=function(e,r){do{if(e.available()<=16)return;for(var n=0;n<4;n++){var a=e.readBits(6);if(a===31){var s=8-e.getBitOffset();s!==8&&e.readBits(s);return}a&32||(a|=64),r.append(String.fromCharCode(a))}}while(e.available()>0)},t.decodeBase256Segment=function(e,r,n){var a=1+e.getByteOffset(),s=this.unrandomize255State(e.readBits(8),a++),o;if(s===0?o=e.available()/8|0:s<250?o=s:o=250*(s-249)+this.unrandomize255State(e.readBits(8),a++),o<0)throw new Sr;for(var l=new Uint8Array(o),c=0;c<o;c++){if(e.available()<8)throw new Sr;l[c]=this.unrandomize255State(e.readBits(8),a++)}n.push(l);try{r.append(ud.decode(l,ra.ISO88591))}catch(u){throw new jw("Platform does not support required encoding: "+u.message)}},t.unrandomize255State=function(e,r){var n=149*r%255+1,a=e-n;return a>=0?a:a+256},t.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],t.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],t.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],t.TEXT_SHIFT2_SET_CHARS=t.C40_SHIFT2_SET_CHARS,t.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""],t}(),T5e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},k5e=function(){function t(){this.rsDecoder=new Xj(Bc.DATA_MATRIX_FIELD_256)}return t.prototype.decode=function(e){var r,n,a=new j5e(e),s=a.getVersion(),o=a.readCodewords(),l=P5e.getDataBlocks(o,s),c=0;try{for(var u=T5e(l),d=u.next();!d.done;d=u.next()){var f=d.value;c+=f.getNumDataCodewords()}}catch(b){r={error:b}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}for(var A=new Uint8Array(c),h=l.length,m=0;m<h;m++){var p=l[m],g=p.getCodewords(),v=p.getNumDataCodewords();this.correctErrors(g,v);for(var y=0;y<v;y++)A[y*h+m]=g[y]}return B5e.decode(A)},t.prototype.correctErrors=function(e,r){var n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-r)}catch{throw new Vi}for(var a=0;a<r;a++)e[a]=n[a]},t}(),F5e=function(){function t(e){this.image=e,this.rectangleDetector=new Lk(this.image)}return t.prototype.detect=function(){var e=this.rectangleDetector.detect(),r=this.detectSolid1(e);if(r=this.detectSolid2(r),r[3]=this.correctTopRight(r),!r[3])throw new Zt;r=this.shiftToModuleCenter(r);var n=r[0],a=r[1],s=r[2],o=r[3],l=this.transitionsBetween(n,o)+1,c=this.transitionsBetween(s,o)+1;(l&1)===1&&(l+=1),(c&1)===1&&(c+=1),4*l<7*c&&4*c<7*l&&(l=c=Math.max(l,c));var u=t.sampleGrid(this.image,n,a,s,o,l,c);return new T6(u,[n,a,s,o])},t.shiftPoint=function(e,r,n){var a=(r.getX()-e.getX())/(n+1),s=(r.getY()-e.getY())/(n+1);return new Kr(e.getX()+a,e.getY()+s)},t.moveAway=function(e,r,n){var a=e.getX(),s=e.getY();return a<r?a-=1:a+=1,s<n?s-=1:s+=1,new Kr(a,s)},t.prototype.detectSolid1=function(e){var r=e[0],n=e[1],a=e[3],s=e[2],o=this.transitionsBetween(r,n),l=this.transitionsBetween(n,a),c=this.transitionsBetween(a,s),u=this.transitionsBetween(s,r),d=o,f=[s,r,n,a];return d>l&&(d=l,f[0]=r,f[1]=n,f[2]=a,f[3]=s),d>c&&(d=c,f[0]=n,f[1]=a,f[2]=s,f[3]=r),d>u&&(f[0]=a,f[1]=s,f[2]=r,f[3]=n),f},t.prototype.detectSolid2=function(e){var r=e[0],n=e[1],a=e[2],s=e[3],o=this.transitionsBetween(r,s),l=t.shiftPoint(n,a,(o+1)*4),c=t.shiftPoint(a,n,(o+1)*4),u=this.transitionsBetween(l,r),d=this.transitionsBetween(c,s);return u<d?(e[0]=r,e[1]=n,e[2]=a,e[3]=s):(e[0]=n,e[1]=a,e[2]=s,e[3]=r),e},t.prototype.correctTopRight=function(e){var r=e[0],n=e[1],a=e[2],s=e[3],o=this.transitionsBetween(r,s),l=this.transitionsBetween(n,s),c=t.shiftPoint(r,n,(l+1)*4),u=t.shiftPoint(a,n,(o+1)*4);o=this.transitionsBetween(c,s),l=this.transitionsBetween(u,s);var d=new Kr(s.getX()+(a.getX()-n.getX())/(o+1),s.getY()+(a.getY()-n.getY())/(o+1)),f=new Kr(s.getX()+(r.getX()-n.getX())/(l+1),s.getY()+(r.getY()-n.getY())/(l+1));if(!this.isValid(d))return this.isValid(f)?f:null;if(!this.isValid(f))return d;var A=this.transitionsBetween(c,d)+this.transitionsBetween(u,d),h=this.transitionsBetween(c,f)+this.transitionsBetween(u,f);return A>h?d:f},t.prototype.shiftToModuleCenter=function(e){var r=e[0],n=e[1],a=e[2],s=e[3],o=this.transitionsBetween(r,s)+1,l=this.transitionsBetween(a,s)+1,c=t.shiftPoint(r,n,l*4),u=t.shiftPoint(a,n,o*4);o=this.transitionsBetween(c,s)+1,l=this.transitionsBetween(u,s)+1,(o&1)===1&&(o+=1),(l&1)===1&&(l+=1);var d=(r.getX()+n.getX()+a.getX()+s.getX())/4,f=(r.getY()+n.getY()+a.getY()+s.getY())/4;r=t.moveAway(r,d,f),n=t.moveAway(n,d,f),a=t.moveAway(a,d,f),s=t.moveAway(s,d,f);var A,h;return c=t.shiftPoint(r,n,l*4),c=t.shiftPoint(c,s,o*4),A=t.shiftPoint(n,r,l*4),A=t.shiftPoint(A,a,o*4),u=t.shiftPoint(a,s,l*4),u=t.shiftPoint(u,n,o*4),h=t.shiftPoint(s,a,l*4),h=t.shiftPoint(h,r,o*4),[c,A,u,h]},t.prototype.isValid=function(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()},t.sampleGrid=function(e,r,n,a,s,o,l){var c=k6.getInstance();return c.sampleGrid(e,o,l,.5,.5,o-.5,.5,o-.5,l-.5,.5,l-.5,r.getX(),r.getY(),s.getX(),s.getY(),a.getX(),a.getY(),n.getX(),n.getY())},t.prototype.transitionsBetween=function(e,r){var n=Math.trunc(e.getX()),a=Math.trunc(e.getY()),s=Math.trunc(r.getX()),o=Math.trunc(r.getY()),l=Math.abs(o-a)>Math.abs(s-n);if(l){var c=n;n=a,a=c,c=s,s=o,o=c}for(var u=Math.abs(s-n),d=Math.abs(o-a),f=-u/2,A=a<o?1:-1,h=n<s?1:-1,m=0,p=this.image.get(l?a:n,l?n:a),g=n,v=a;g!==s;g+=h){var y=this.image.get(l?v:g,l?g:v);if(y!==p&&(m++,p=y),f+=d,f>0){if(v===o)break;v+=A,f-=u}}return m},t}(),PS=function(){function t(){this.decoder=new k5e}return t.prototype.decode=function(e,r){r===void 0&&(r=null);var n,a;if(r!=null&&r.has(is.PURE_BARCODE)){var s=t.extractPureBits(e.getBlackMatrix());n=this.decoder.decode(s),a=t.NO_POINTS}else{var o=new F5e(e.getBlackMatrix()).detect();n=this.decoder.decode(o.getBits()),a=o.getPoints()}var l=n.getRawBytes(),c=new Vl(n.getText(),l,8*l.length,a,ln.DATA_MATRIX,ss.currentTimeMillis()),u=n.getByteSegments();u!=null&&c.putMetadata(ul.BYTE_SEGMENTS,u);var d=n.getECLevel();return d!=null&&c.putMetadata(ul.ERROR_CORRECTION_LEVEL,d),c},t.prototype.reset=function(){},t.extractPureBits=function(e){var r=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(r==null||n==null)throw new Zt;var a=this.moduleSize(r,e),s=r[1],o=n[1],l=r[0],c=n[0],u=(c-l+1)/a,d=(o-s+1)/a;if(u<=0||d<=0)throw new Zt;var f=a/2;s+=f,l+=f;for(var A=new Kf(u,d),h=0;h<d;h++)for(var m=s+h*a,p=0;p<u;p++)e.get(l+p*a,m)&&A.set(p,h);return A},t.moduleSize=function(e,r){for(var n=r.getWidth(),a=e[0],s=e[1];a<n&&r.get(a,s);)a++;if(a===n)throw new Zt;var o=a-e[0];if(o===0)throw new Zt;return o},t.NO_POINTS=[],t}(),O5e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){O5e(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new PS,r)||this}return e})(u1);var $x;(function(t){t[t.L=0]="L",t[t.M=1]="M",t[t.Q=2]="Q",t[t.H=3]="H"})($x||($x={}));var D5e=function(){function t(e,r,n){this.value=e,this.stringValue=r,this.bits=n,t.FOR_BITS.set(n,this),t.FOR_VALUE.set(e,this)}return t.prototype.getValue=function(){return this.value},t.prototype.getBits=function(){return this.bits},t.fromString=function(e){switch(e){case"L":return t.L;case"M":return t.M;case"Q":return t.Q;case"H":return t.H;default:throw new Ni(e+"not available")}},t.prototype.toString=function(){return this.stringValue},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value},t.forBits=function(e){if(e<0||e>=t.FOR_BITS.size)throw new cn;return t.FOR_BITS.get(e)},t.FOR_BITS=new Map,t.FOR_VALUE=new Map,t.L=new t($x.L,"L",1),t.M=new t($x.M,"M",0),t.Q=new t($x.Q,"Q",3),t.H=new t($x.H,"H",2),t}(),R5e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Yre=function(){function t(e){this.errorCorrectionLevel=D5e.forBits(e>>3&3),this.dataMask=e&7}return t.numBitsDiffering=function(e,r){return Hn.bitCount(e^r)},t.decodeFormatInformation=function(e,r){var n=t.doDecodeFormatInformation(e,r);return n!==null?n:t.doDecodeFormatInformation(e^t.FORMAT_INFO_MASK_QR,r^t.FORMAT_INFO_MASK_QR)},t.doDecodeFormatInformation=function(e,r){var n,a,s=Number.MAX_SAFE_INTEGER,o=0;try{for(var l=R5e(t.FORMAT_INFO_DECODE_LOOKUP),c=l.next();!c.done;c=l.next()){var u=c.value,d=u[0];if(d===e||d===r)return new t(u[1]);var f=t.numBitsDiffering(e,d);f<s&&(o=u[1],s=f),e!==r&&(f=t.numBitsDiffering(r,d),f<s&&(o=u[1],s=f))}}catch(A){n={error:A}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}return s<=3?new t(o):null},t.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},t.prototype.getDataMask=function(){return this.dataMask},t.prototype.hashCode=function(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.errorCorrectionLevel===r.errorCorrectionLevel&&this.dataMask===r.dataMask},t.FORMAT_INFO_MASK_QR=21522,t.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])],t}(),M5e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Vt=function(){function t(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.ecCodewordsPerBlock=e,this.ecBlocks=r}return t.prototype.getECCodewordsPerBlock=function(){return this.ecCodewordsPerBlock},t.prototype.getNumBlocks=function(){var e,r,n=0,a=this.ecBlocks;try{for(var s=M5e(a),o=s.next();!o.done;o=s.next()){var l=o.value;n+=l.getCount()}}catch(c){e={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return n},t.prototype.getTotalECCodewords=function(){return this.ecCodewordsPerBlock*this.getNumBlocks()},t.prototype.getECBlocks=function(){return this.ecBlocks},t}(),rt=function(){function t(e,r){this.count=e,this.dataCodewords=r}return t.prototype.getCount=function(){return this.count},t.prototype.getDataCodewords=function(){return this.dataCodewords},t}(),L5e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Pp=function(){function t(e,r){for(var n,a,s=[],o=2;o<arguments.length;o++)s[o-2]=arguments[o];this.versionNumber=e,this.alignmentPatternCenters=r,this.ecBlocks=s;var l=0,c=s[0].getECCodewordsPerBlock(),u=s[0].getECBlocks();try{for(var d=L5e(u),f=d.next();!f.done;f=d.next()){var A=f.value;l+=A.getCount()*(A.getDataCodewords()+c)}}catch(h){n={error:h}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}this.totalCodewords=l}return t.prototype.getVersionNumber=function(){return this.versionNumber},t.prototype.getAlignmentPatternCenters=function(){return this.alignmentPatternCenters},t.prototype.getTotalCodewords=function(){return this.totalCodewords},t.prototype.getDimensionForVersion=function(){return 17+4*this.versionNumber},t.prototype.getECBlocksForLevel=function(e){return this.ecBlocks[e.getValue()]},t.getProvisionalVersionForDimension=function(e){if(e%4!==1)throw new Sr;try{return this.getVersionForNumber((e-17)/4)}catch{throw new Sr}},t.getVersionForNumber=function(e){if(e<1||e>40)throw new cn;return t.VERSIONS[e-1]},t.decodeVersionInformation=function(e){for(var r=Number.MAX_SAFE_INTEGER,n=0,a=0;a<t.VERSION_DECODE_INFO.length;a++){var s=t.VERSION_DECODE_INFO[a];if(s===e)return t.getVersionForNumber(a+7);var o=Yre.numBitsDiffering(e,s);o<r&&(n=a+7,r=o)}return r<=3?t.getVersionForNumber(n):null},t.prototype.buildFunctionPattern=function(){var e=this.getDimensionForVersion(),r=new Kf(e);r.setRegion(0,0,9,9),r.setRegion(e-8,0,8,9),r.setRegion(0,e-8,9,8);for(var n=this.alignmentPatternCenters.length,a=0;a<n;a++)for(var s=this.alignmentPatternCenters[a]-2,o=0;o<n;o++)a===0&&(o===0||o===n-1)||a===n-1&&o===0||r.setRegion(this.alignmentPatternCenters[o]-2,s,5,5);return r.setRegion(6,9,1,e-17),r.setRegion(9,6,e-17,1),this.versionNumber>6&&(r.setRegion(e-11,0,3,6),r.setRegion(0,e-11,6,3)),r},t.prototype.toString=function(){return""+this.versionNumber},t.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),t.VERSIONS=[new t(1,new Int32Array(0),new Vt(7,new rt(1,19)),new Vt(10,new rt(1,16)),new Vt(13,new rt(1,13)),new Vt(17,new rt(1,9))),new t(2,Int32Array.from([6,18]),new Vt(10,new rt(1,34)),new Vt(16,new rt(1,28)),new Vt(22,new rt(1,22)),new Vt(28,new rt(1,16))),new t(3,Int32Array.from([6,22]),new Vt(15,new rt(1,55)),new Vt(26,new rt(1,44)),new Vt(18,new rt(2,17)),new Vt(22,new rt(2,13))),new t(4,Int32Array.from([6,26]),new Vt(20,new rt(1,80)),new Vt(18,new rt(2,32)),new Vt(26,new rt(2,24)),new Vt(16,new rt(4,9))),new t(5,Int32Array.from([6,30]),new Vt(26,new rt(1,108)),new Vt(24,new rt(2,43)),new Vt(18,new rt(2,15),new rt(2,16)),new Vt(22,new rt(2,11),new rt(2,12))),new t(6,Int32Array.from([6,34]),new Vt(18,new rt(2,68)),new Vt(16,new rt(4,27)),new Vt(24,new rt(4,19)),new Vt(28,new rt(4,15))),new t(7,Int32Array.from([6,22,38]),new Vt(20,new rt(2,78)),new Vt(18,new rt(4,31)),new Vt(18,new rt(2,14),new rt(4,15)),new Vt(26,new rt(4,13),new rt(1,14))),new t(8,Int32Array.from([6,24,42]),new Vt(24,new rt(2,97)),new Vt(22,new rt(2,38),new rt(2,39)),new Vt(22,new rt(4,18),new rt(2,19)),new Vt(26,new rt(4,14),new rt(2,15))),new t(9,Int32Array.from([6,26,46]),new Vt(30,new rt(2,116)),new Vt(22,new rt(3,36),new rt(2,37)),new Vt(20,new rt(4,16),new rt(4,17)),new Vt(24,new rt(4,12),new rt(4,13))),new t(10,Int32Array.from([6,28,50]),new Vt(18,new rt(2,68),new rt(2,69)),new Vt(26,new rt(4,43),new rt(1,44)),new Vt(24,new rt(6,19),new rt(2,20)),new Vt(28,new rt(6,15),new rt(2,16))),new t(11,Int32Array.from([6,30,54]),new Vt(20,new rt(4,81)),new Vt(30,new rt(1,50),new rt(4,51)),new Vt(28,new rt(4,22),new rt(4,23)),new Vt(24,new rt(3,12),new rt(8,13))),new t(12,Int32Array.from([6,32,58]),new Vt(24,new rt(2,92),new rt(2,93)),new Vt(22,new rt(6,36),new rt(2,37)),new Vt(26,new rt(4,20),new rt(6,21)),new Vt(28,new rt(7,14),new rt(4,15))),new t(13,Int32Array.from([6,34,62]),new Vt(26,new rt(4,107)),new Vt(22,new rt(8,37),new rt(1,38)),new Vt(24,new rt(8,20),new rt(4,21)),new Vt(22,new rt(12,11),new rt(4,12))),new t(14,Int32Array.from([6,26,46,66]),new Vt(30,new rt(3,115),new rt(1,116)),new Vt(24,new rt(4,40),new rt(5,41)),new Vt(20,new rt(11,16),new rt(5,17)),new Vt(24,new rt(11,12),new rt(5,13))),new t(15,Int32Array.from([6,26,48,70]),new Vt(22,new rt(5,87),new rt(1,88)),new Vt(24,new rt(5,41),new rt(5,42)),new Vt(30,new rt(5,24),new rt(7,25)),new Vt(24,new rt(11,12),new rt(7,13))),new t(16,Int32Array.from([6,26,50,74]),new Vt(24,new rt(5,98),new rt(1,99)),new Vt(28,new rt(7,45),new rt(3,46)),new Vt(24,new rt(15,19),new rt(2,20)),new Vt(30,new rt(3,15),new rt(13,16))),new t(17,Int32Array.from([6,30,54,78]),new Vt(28,new rt(1,107),new rt(5,108)),new Vt(28,new rt(10,46),new rt(1,47)),new Vt(28,new rt(1,22),new rt(15,23)),new Vt(28,new rt(2,14),new rt(17,15))),new t(18,Int32Array.from([6,30,56,82]),new Vt(30,new rt(5,120),new rt(1,121)),new Vt(26,new rt(9,43),new rt(4,44)),new Vt(28,new rt(17,22),new rt(1,23)),new Vt(28,new rt(2,14),new rt(19,15))),new t(19,Int32Array.from([6,30,58,86]),new Vt(28,new rt(3,113),new rt(4,114)),new Vt(26,new rt(3,44),new rt(11,45)),new Vt(26,new rt(17,21),new rt(4,22)),new Vt(26,new rt(9,13),new rt(16,14))),new t(20,Int32Array.from([6,34,62,90]),new Vt(28,new rt(3,107),new rt(5,108)),new Vt(26,new rt(3,41),new rt(13,42)),new Vt(30,new rt(15,24),new rt(5,25)),new Vt(28,new rt(15,15),new rt(10,16))),new t(21,Int32Array.from([6,28,50,72,94]),new Vt(28,new rt(4,116),new rt(4,117)),new Vt(26,new rt(17,42)),new Vt(28,new rt(17,22),new rt(6,23)),new Vt(30,new rt(19,16),new rt(6,17))),new t(22,Int32Array.from([6,26,50,74,98]),new Vt(28,new rt(2,111),new rt(7,112)),new Vt(28,new rt(17,46)),new Vt(30,new rt(7,24),new rt(16,25)),new Vt(24,new rt(34,13))),new t(23,Int32Array.from([6,30,54,78,102]),new Vt(30,new rt(4,121),new rt(5,122)),new Vt(28,new rt(4,47),new rt(14,48)),new Vt(30,new rt(11,24),new rt(14,25)),new Vt(30,new rt(16,15),new rt(14,16))),new t(24,Int32Array.from([6,28,54,80,106]),new Vt(30,new rt(6,117),new rt(4,118)),new Vt(28,new rt(6,45),new rt(14,46)),new Vt(30,new rt(11,24),new rt(16,25)),new Vt(30,new rt(30,16),new rt(2,17))),new t(25,Int32Array.from([6,32,58,84,110]),new Vt(26,new rt(8,106),new rt(4,107)),new Vt(28,new rt(8,47),new rt(13,48)),new Vt(30,new rt(7,24),new rt(22,25)),new Vt(30,new rt(22,15),new rt(13,16))),new t(26,Int32Array.from([6,30,58,86,114]),new Vt(28,new rt(10,114),new rt(2,115)),new Vt(28,new rt(19,46),new rt(4,47)),new Vt(28,new rt(28,22),new rt(6,23)),new Vt(30,new rt(33,16),new rt(4,17))),new t(27,Int32Array.from([6,34,62,90,118]),new Vt(30,new rt(8,122),new rt(4,123)),new Vt(28,new rt(22,45),new rt(3,46)),new Vt(30,new rt(8,23),new rt(26,24)),new Vt(30,new rt(12,15),new rt(28,16))),new t(28,Int32Array.from([6,26,50,74,98,122]),new Vt(30,new rt(3,117),new rt(10,118)),new Vt(28,new rt(3,45),new rt(23,46)),new Vt(30,new rt(4,24),new rt(31,25)),new Vt(30,new rt(11,15),new rt(31,16))),new t(29,Int32Array.from([6,30,54,78,102,126]),new Vt(30,new rt(7,116),new rt(7,117)),new Vt(28,new rt(21,45),new rt(7,46)),new Vt(30,new rt(1,23),new rt(37,24)),new Vt(30,new rt(19,15),new rt(26,16))),new t(30,Int32Array.from([6,26,52,78,104,130]),new Vt(30,new rt(5,115),new rt(10,116)),new Vt(28,new rt(19,47),new rt(10,48)),new Vt(30,new rt(15,24),new rt(25,25)),new Vt(30,new rt(23,15),new rt(25,16))),new t(31,Int32Array.from([6,30,56,82,108,134]),new Vt(30,new rt(13,115),new rt(3,116)),new Vt(28,new rt(2,46),new rt(29,47)),new Vt(30,new rt(42,24),new rt(1,25)),new Vt(30,new rt(23,15),new rt(28,16))),new t(32,Int32Array.from([6,34,60,86,112,138]),new Vt(30,new rt(17,115)),new Vt(28,new rt(10,46),new rt(23,47)),new Vt(30,new rt(10,24),new rt(35,25)),new Vt(30,new rt(19,15),new rt(35,16))),new t(33,Int32Array.from([6,30,58,86,114,142]),new Vt(30,new rt(17,115),new rt(1,116)),new Vt(28,new rt(14,46),new rt(21,47)),new Vt(30,new rt(29,24),new rt(19,25)),new Vt(30,new rt(11,15),new rt(46,16))),new t(34,Int32Array.from([6,34,62,90,118,146]),new Vt(30,new rt(13,115),new rt(6,116)),new Vt(28,new rt(14,46),new rt(23,47)),new Vt(30,new rt(44,24),new rt(7,25)),new Vt(30,new rt(59,16),new rt(1,17))),new t(35,Int32Array.from([6,30,54,78,102,126,150]),new Vt(30,new rt(12,121),new rt(7,122)),new Vt(28,new rt(12,47),new rt(26,48)),new Vt(30,new rt(39,24),new rt(14,25)),new Vt(30,new rt(22,15),new rt(41,16))),new t(36,Int32Array.from([6,24,50,76,102,128,154]),new Vt(30,new rt(6,121),new rt(14,122)),new Vt(28,new rt(6,47),new rt(34,48)),new Vt(30,new rt(46,24),new rt(10,25)),new Vt(30,new rt(2,15),new rt(64,16))),new t(37,Int32Array.from([6,28,54,80,106,132,158]),new Vt(30,new rt(17,122),new rt(4,123)),new Vt(28,new rt(29,46),new rt(14,47)),new Vt(30,new rt(49,24),new rt(10,25)),new Vt(30,new rt(24,15),new rt(46,16))),new t(38,Int32Array.from([6,32,58,84,110,136,162]),new Vt(30,new rt(4,122),new rt(18,123)),new Vt(28,new rt(13,46),new rt(32,47)),new Vt(30,new rt(48,24),new rt(14,25)),new Vt(30,new rt(42,15),new rt(32,16))),new t(39,Int32Array.from([6,26,54,82,110,138,166]),new Vt(30,new rt(20,117),new rt(4,118)),new Vt(28,new rt(40,47),new rt(7,48)),new Vt(30,new rt(43,24),new rt(22,25)),new Vt(30,new rt(10,15),new rt(67,16))),new t(40,Int32Array.from([6,30,58,86,114,142,170]),new Vt(30,new rt(19,118),new rt(6,119)),new Vt(28,new rt(18,47),new rt(31,48)),new Vt(30,new rt(34,24),new rt(34,25)),new Vt(30,new rt(20,15),new rt(61,16)))],t}(),_o;(function(t){t[t.DATA_MASK_000=0]="DATA_MASK_000",t[t.DATA_MASK_001=1]="DATA_MASK_001",t[t.DATA_MASK_010=2]="DATA_MASK_010",t[t.DATA_MASK_011=3]="DATA_MASK_011",t[t.DATA_MASK_100=4]="DATA_MASK_100",t[t.DATA_MASK_101=5]="DATA_MASK_101",t[t.DATA_MASK_110=6]="DATA_MASK_110",t[t.DATA_MASK_111=7]="DATA_MASK_111"})(_o||(_o={}));var AH=function(){function t(e,r){this.value=e,this.isMasked=r}return t.prototype.unmaskBitMatrix=function(e,r){for(var n=0;n<r;n++)for(var a=0;a<r;a++)this.isMasked(n,a)&&e.flip(a,n)},t.values=new Map([[_o.DATA_MASK_000,new t(_o.DATA_MASK_000,function(e,r){return(e+r&1)===0})],[_o.DATA_MASK_001,new t(_o.DATA_MASK_001,function(e,r){return(e&1)===0})],[_o.DATA_MASK_010,new t(_o.DATA_MASK_010,function(e,r){return r%3===0})],[_o.DATA_MASK_011,new t(_o.DATA_MASK_011,function(e,r){return(e+r)%3===0})],[_o.DATA_MASK_100,new t(_o.DATA_MASK_100,function(e,r){return(Math.floor(e/2)+Math.floor(r/3)&1)===0})],[_o.DATA_MASK_101,new t(_o.DATA_MASK_101,function(e,r){return e*r%6===0})],[_o.DATA_MASK_110,new t(_o.DATA_MASK_110,function(e,r){return e*r%6<3})],[_o.DATA_MASK_111,new t(_o.DATA_MASK_111,function(e,r){return(e+r+e*r%3&1)===0})]]),t}(),U5e=function(){function t(e){var r=e.getHeight();if(r<21||(r&3)!==1)throw new Sr;this.bitMatrix=e}return t.prototype.readFormatInformation=function(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;for(var e=0,r=0;r<6;r++)e=this.copyBit(r,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(var n=5;n>=0;n--)e=this.copyBit(8,n,e);for(var a=this.bitMatrix.getHeight(),s=0,o=a-7,n=a-1;n>=o;n--)s=this.copyBit(8,n,s);for(var r=a-8;r<a;r++)s=this.copyBit(r,8,s);if(this.parsedFormatInfo=Yre.decodeFormatInformation(e,s),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new Sr},t.prototype.readVersion=function(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;var e=this.bitMatrix.getHeight(),r=Math.floor((e-17)/4);if(r<=6)return Pp.getVersionForNumber(r);for(var n=0,a=e-11,s=5;s>=0;s--)for(var o=e-9;o>=a;o--)n=this.copyBit(o,s,n);var l=Pp.decodeVersionInformation(n);if(l!==null&&l.getDimensionForVersion()===e)return this.parsedVersion=l,l;n=0;for(var o=5;o>=0;o--)for(var s=e-9;s>=a;s--)n=this.copyBit(o,s,n);if(l=Pp.decodeVersionInformation(n),l!==null&&l.getDimensionForVersion()===e)return this.parsedVersion=l,l;throw new Sr},t.prototype.copyBit=function(e,r,n){var a=this.isMirror?this.bitMatrix.get(r,e):this.bitMatrix.get(e,r);return a?n<<1|1:n<<1},t.prototype.readCodewords=function(){var e=this.readFormatInformation(),r=this.readVersion(),n=AH.values.get(e.getDataMask()),a=this.bitMatrix.getHeight();n.unmaskBitMatrix(this.bitMatrix,a);for(var s=r.buildFunctionPattern(),o=!0,l=new Uint8Array(r.getTotalCodewords()),c=0,u=0,d=0,f=a-1;f>0;f-=2){f===6&&f--;for(var A=0;A<a;A++)for(var h=o?a-1-A:A,m=0;m<2;m++)s.get(f-m,h)||(d++,u<<=1,this.bitMatrix.get(f-m,h)&&(u|=1),d===8&&(l[c++]=u,d=0,u=0));o=!o}if(c!==r.getTotalCodewords())throw new Sr;return l},t.prototype.remask=function(){if(this.parsedFormatInfo!==null){var e=AH.values.get(this.parsedFormatInfo.getDataMask()),r=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,r)}},t.prototype.setMirror=function(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e},t.prototype.mirror=function(){for(var e=this.bitMatrix,r=0,n=e.getWidth();r<n;r++)for(var a=r+1,s=e.getHeight();a<s;a++)e.get(r,a)!==e.get(a,r)&&(e.flip(a,r),e.flip(r,a))},t}(),mH=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Q5e=function(){function t(e,r){this.numDataCodewords=e,this.codewords=r}return t.getDataBlocks=function(e,r,n){var a,s,o,l;if(e.length!==r.getTotalCodewords())throw new cn;var c=r.getECBlocksForLevel(n),u=0,d=c.getECBlocks();try{for(var f=mH(d),A=f.next();!A.done;A=f.next()){var h=A.value;u+=h.getCount()}}catch(D){a={error:D}}finally{try{A&&!A.done&&(s=f.return)&&s.call(f)}finally{if(a)throw a.error}}var m=new Array(u),p=0;try{for(var g=mH(d),v=g.next();!v.done;v=g.next())for(var h=v.value,y=0;y<h.getCount();y++){var b=h.getDataCodewords(),w=c.getECCodewordsPerBlock()+b;m[p++]=new t(b,new Uint8Array(w))}}catch(D){o={error:D}}finally{try{v&&!v.done&&(l=g.return)&&l.call(g)}finally{if(o)throw o.error}}for(var j=m[0].codewords.length,I=m.length-1;I>=0;){var _=m[I].codewords.length;if(_===j)break;I--}I++;for(var S=j-c.getECCodewordsPerBlock(),E=0,y=0;y<S;y++)for(var F=0;F<p;F++)m[F].codewords[y]=e[E++];for(var F=I;F<p;F++)m[F].codewords[S]=e[E++];for(var k=m[0].codewords.length,y=S;y<k;y++)for(var F=0;F<p;F++){var P=F<I?y:y+1;m[F].codewords[P]=e[E++]}return m},t.prototype.getNumDataCodewords=function(){return this.numDataCodewords},t.prototype.getCodewords=function(){return this.codewords},t}(),qu;(function(t){t[t.TERMINATOR=0]="TERMINATOR",t[t.NUMERIC=1]="NUMERIC",t[t.ALPHANUMERIC=2]="ALPHANUMERIC",t[t.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",t[t.BYTE=4]="BYTE",t[t.ECI=5]="ECI",t[t.KANJI=6]="KANJI",t[t.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",t[t.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",t[t.HANZI=9]="HANZI"})(qu||(qu={}));var ds=function(){function t(e,r,n,a){this.value=e,this.stringValue=r,this.characterCountBitsForVersions=n,this.bits=a,t.FOR_BITS.set(a,this),t.FOR_VALUE.set(e,this)}return t.forBits=function(e){var r=t.FOR_BITS.get(e);if(r===void 0)throw new cn;return r},t.prototype.getCharacterCountBits=function(e){var r=e.getVersionNumber(),n;return r<=9?n=0:r<=26?n=1:n=2,this.characterCountBitsForVersions[n]},t.prototype.getValue=function(){return this.value},t.prototype.getBits=function(){return this.bits},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value},t.prototype.toString=function(){return this.stringValue},t.FOR_BITS=new Map,t.FOR_VALUE=new Map,t.TERMINATOR=new t(qu.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),t.NUMERIC=new t(qu.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),t.ALPHANUMERIC=new t(qu.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),t.STRUCTURED_APPEND=new t(qu.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),t.BYTE=new t(qu.BYTE,"BYTE",Int32Array.from([8,16,16]),4),t.ECI=new t(qu.ECI,"ECI",Int32Array.from([0,0,0]),7),t.KANJI=new t(qu.KANJI,"KANJI",Int32Array.from([8,10,12]),8),t.FNC1_FIRST_POSITION=new t(qu.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),t.FNC1_SECOND_POSITION=new t(qu.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),t.HANZI=new t(qu.HANZI,"HANZI",Int32Array.from([8,10,12]),13),t}(),V5e=function(){function t(){}return t.decode=function(e,r,n,a){var s=new Xre(e),o=new Dn,l=new Array,c=-1,u=-1;try{var d=null,f=!1,A=void 0;do{if(s.available()<4)A=ds.TERMINATOR;else{var h=s.readBits(4);A=ds.forBits(h)}switch(A){case ds.TERMINATOR:break;case ds.FNC1_FIRST_POSITION:case ds.FNC1_SECOND_POSITION:f=!0;break;case ds.STRUCTURED_APPEND:if(s.available()<16)throw new Sr;c=s.readBits(8),u=s.readBits(8);break;case ds.ECI:var m=t.parseECIValue(s);if(d=lo.getCharacterSetECIByValue(m),d===null)throw new Sr;break;case ds.HANZI:var p=s.readBits(4),g=s.readBits(A.getCharacterCountBits(r));p===t.GB2312_SUBSET&&t.decodeHanziSegment(s,o,g);break;default:var v=s.readBits(A.getCharacterCountBits(r));switch(A){case ds.NUMERIC:t.decodeNumericSegment(s,o,v);break;case ds.ALPHANUMERIC:t.decodeAlphanumericSegment(s,o,v,f);break;case ds.BYTE:t.decodeByteSegment(s,o,v,d,l,a);break;case ds.KANJI:t.decodeKanjiSegment(s,o,v);break;default:throw new Sr}break}}while(A!==ds.TERMINATOR)}catch{throw new Sr}return new Wj(e,o.toString(),l.length===0?null:l,n===null?null:n.toString(),c,u)},t.decodeHanziSegment=function(e,r,n){if(n*13>e.available())throw new Sr;for(var a=new Uint8Array(2*n),s=0;n>0;){var o=e.readBits(13),l=o/96<<8&4294967295|o%96;l<959?l+=41377:l+=42657,a[s]=l>>8&255,a[s+1]=l&255,s+=2,n--}try{r.append(ud.decode(a,ra.GB2312))}catch(c){throw new Sr(c)}},t.decodeKanjiSegment=function(e,r,n){if(n*13>e.available())throw new Sr;for(var a=new Uint8Array(2*n),s=0;n>0;){var o=e.readBits(13),l=o/192<<8&4294967295|o%192;l<7936?l+=33088:l+=49472,a[s]=l>>8,a[s+1]=l,s+=2,n--}try{r.append(ud.decode(a,ra.SHIFT_JIS))}catch(c){throw new Sr(c)}},t.decodeByteSegment=function(e,r,n,a,s,o){if(8*n>e.available())throw new Sr;for(var l=new Uint8Array(n),c=0;c<n;c++)l[c]=e.readBits(8);var u;a===null?u=ra.guessEncoding(l,o):u=a.getName();try{r.append(ud.decode(l,u))}catch(d){throw new Sr(d)}s.push(l)},t.toAlphaNumericChar=function(e){if(e>=t.ALPHANUMERIC_CHARS.length)throw new Sr;return t.ALPHANUMERIC_CHARS[e]},t.decodeAlphanumericSegment=function(e,r,n,a){for(var s=r.length();n>1;){if(e.available()<11)throw new Sr;var o=e.readBits(11);r.append(t.toAlphaNumericChar(Math.floor(o/45))),r.append(t.toAlphaNumericChar(o%45)),n-=2}if(n===1){if(e.available()<6)throw new Sr;r.append(t.toAlphaNumericChar(e.readBits(6)))}if(a)for(var l=s;l<r.length();l++)r.charAt(l)==="%"&&(l<r.length()-1&&r.charAt(l+1)==="%"?r.deleteCharAt(l+1):r.setCharAt(l,""))},t.decodeNumericSegment=function(e,r,n){for(;n>=3;){if(e.available()<10)throw new Sr;var a=e.readBits(10);if(a>=1e3)throw new Sr;r.append(t.toAlphaNumericChar(Math.floor(a/100))),r.append(t.toAlphaNumericChar(Math.floor(a/10)%10)),r.append(t.toAlphaNumericChar(a%10)),n-=3}if(n===2){if(e.available()<7)throw new Sr;var s=e.readBits(7);if(s>=100)throw new Sr;r.append(t.toAlphaNumericChar(Math.floor(s/10))),r.append(t.toAlphaNumericChar(s%10))}else if(n===1){if(e.available()<4)throw new Sr;var o=e.readBits(4);if(o>=10)throw new Sr;r.append(t.toAlphaNumericChar(o))}},t.parseECIValue=function(e){var r=e.readBits(8);if(!(r&128))return r&127;if((r&192)===128){var n=e.readBits(8);return(r&63)<<8&4294967295|n}if((r&224)===192){var a=e.readBits(16);return(r&31)<<16&4294967295|a}throw new Sr},t.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",t.GB2312_SUBSET=1,t}(),Jre=function(){function t(e){this.mirrored=e}return t.prototype.isMirrored=function(){return this.mirrored},t.prototype.applyMirroredCorrection=function(e){if(!(!this.mirrored||e===null||e.length<3)){var r=e[0];e[0]=e[2],e[2]=r}},t}(),pH=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},H5e=function(){function t(){this.rsDecoder=new Xj(Bc.QR_CODE_FIELD_256)}return t.prototype.decodeBooleanArray=function(e,r){return this.decodeBitMatrix(Kf.parseFromBooleanArray(e),r)},t.prototype.decodeBitMatrix=function(e,r){var n=new U5e(e),a=null;try{return this.decodeBitMatrixParser(n,r)}catch(o){a=o}try{n.remask(),n.setMirror(!0),n.readVersion(),n.readFormatInformation(),n.mirror();var s=this.decodeBitMatrixParser(n,r);return s.setOther(new Jre(!0)),s}catch(o){throw a!==null?a:o}},t.prototype.decodeBitMatrixParser=function(e,r){var n,a,s,o,l=e.readVersion(),c=e.readFormatInformation().getErrorCorrectionLevel(),u=e.readCodewords(),d=Q5e.getDataBlocks(u,l,c),f=0;try{for(var A=pH(d),h=A.next();!h.done;h=A.next()){var m=h.value;f+=m.getNumDataCodewords()}}catch(I){n={error:I}}finally{try{h&&!h.done&&(a=A.return)&&a.call(A)}finally{if(n)throw n.error}}var p=new Uint8Array(f),g=0;try{for(var v=pH(d),y=v.next();!y.done;y=v.next()){var m=y.value,b=m.getCodewords(),w=m.getNumDataCodewords();this.correctErrors(b,w);for(var j=0;j<w;j++)p[g++]=b[j]}}catch(I){s={error:I}}finally{try{y&&!y.done&&(o=v.return)&&o.call(v)}finally{if(s)throw s.error}}return V5e.decode(p,l,c,r)},t.prototype.correctErrors=function(e,r){var n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-r)}catch{throw new Vi}for(var a=0;a<r;a++)e[a]=n[a]},t}(),$5e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),G5e=function(t){$5e(e,t);function e(r,n,a){var s=t.call(this,r,n)||this;return s.estimatedModuleSize=a,s}return e.prototype.aboutEquals=function(r,n,a){if(Math.abs(n-this.getY())<=r&&Math.abs(a-this.getX())<=r){var s=Math.abs(r-this.estimatedModuleSize);return s<=1||s<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(r,n,a){var s=(this.getX()+n)/2,o=(this.getY()+r)/2,l=(this.estimatedModuleSize+a)/2;return new e(s,o,l)},e}(Kr),K5e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},q5e=function(){function t(e,r,n,a,s,o,l){this.image=e,this.startX=r,this.startY=n,this.width=a,this.height=s,this.moduleSize=o,this.resultPointCallback=l,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}return t.prototype.find=function(){for(var e=this.startX,r=this.height,n=this.width,a=e+n,s=this.startY+r/2,o=new Int32Array(3),l=this.image,c=0;c<r;c++){var u=s+(c&1?-Math.floor((c+1)/2):Math.floor((c+1)/2));o[0]=0,o[1]=0,o[2]=0;for(var d=e;d<a&&!l.get(d,u);)d++;for(var f=0;d<a;){if(l.get(d,u))if(f===1)o[1]++;else if(f===2){if(this.foundPatternCross(o)){var A=this.handlePossibleCenter(o,u,d);if(A!==null)return A}o[0]=o[2],o[1]=1,o[2]=0,f=1}else o[++f]++;else f===1&&f++,o[f]++;d++}if(this.foundPatternCross(o)){var A=this.handlePossibleCenter(o,u,a);if(A!==null)return A}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new Zt},t.centerFromEnd=function(e,r){return r-e[2]-e[1]/2},t.prototype.foundPatternCross=function(e){for(var r=this.moduleSize,n=r/2,a=0;a<3;a++)if(Math.abs(r-e[a])>=n)return!1;return!0},t.prototype.crossCheckVertical=function(e,r,n,a){var s=this.image,o=s.getHeight(),l=this.crossCheckStateCount;l[0]=0,l[1]=0,l[2]=0;for(var c=e;c>=0&&s.get(r,c)&&l[1]<=n;)l[1]++,c--;if(c<0||l[1]>n)return NaN;for(;c>=0&&!s.get(r,c)&&l[0]<=n;)l[0]++,c--;if(l[0]>n)return NaN;for(c=e+1;c<o&&s.get(r,c)&&l[1]<=n;)l[1]++,c++;if(c===o||l[1]>n)return NaN;for(;c<o&&!s.get(r,c)&&l[2]<=n;)l[2]++,c++;if(l[2]>n)return NaN;var u=l[0]+l[1]+l[2];return 5*Math.abs(u-a)>=2*a?NaN:this.foundPatternCross(l)?t.centerFromEnd(l,c):NaN},t.prototype.handlePossibleCenter=function(e,r,n){var a,s,o=e[0]+e[1]+e[2],l=t.centerFromEnd(e,n),c=this.crossCheckVertical(r,l,2*e[1],o);if(!isNaN(c)){var u=(e[0]+e[1]+e[2])/3;try{for(var d=K5e(this.possibleCenters),f=d.next();!f.done;f=d.next()){var A=f.value;if(A.aboutEquals(u,c,l))return A.combineEstimate(c,l,u)}}catch(m){a={error:m}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}var h=new G5e(l,c,u);this.possibleCenters.push(h),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(h)}return null},t}(),z5e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),W5e=function(t){z5e(e,t);function e(r,n,a,s){var o=t.call(this,r,n)||this;return o.estimatedModuleSize=a,o.count=s,s===void 0&&(o.count=1),o}return e.prototype.getEstimatedModuleSize=function(){return this.estimatedModuleSize},e.prototype.getCount=function(){return this.count},e.prototype.aboutEquals=function(r,n,a){if(Math.abs(n-this.getY())<=r&&Math.abs(a-this.getX())<=r){var s=Math.abs(r-this.estimatedModuleSize);return s<=1||s<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(r,n,a){var s=this.count+1,o=(this.count*this.getX()+n)/s,l=(this.count*this.getY()+r)/s,c=(this.count*this.estimatedModuleSize+a)/s;return new e(o,l,c,s)},e}(Kr),X5e=function(){function t(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}return t.prototype.getBottomLeft=function(){return this.bottomLeft},t.prototype.getTopLeft=function(){return this.topLeft},t.prototype.getTopRight=function(){return this.topRight},t}(),uy=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Y5e=function(){function t(e,r){this.image=e,this.resultPointCallback=r,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=r}return t.prototype.getImage=function(){return this.image},t.prototype.getPossibleCenters=function(){return this.possibleCenters},t.prototype.find=function(e){var r=e!=null&&e.get(is.TRY_HARDER)!==void 0,n=e!=null&&e.get(is.PURE_BARCODE)!==void 0,a=this.image,s=a.getHeight(),o=a.getWidth(),l=Math.floor(3*s/(4*t.MAX_MODULES));(l<t.MIN_SKIP||r)&&(l=t.MIN_SKIP);for(var c=!1,u=new Int32Array(5),d=l-1;d<s&&!c;d+=l){u[0]=0,u[1]=0,u[2]=0,u[3]=0,u[4]=0;for(var f=0,A=0;A<o;A++)if(a.get(A,d))(f&1)===1&&f++,u[f]++;else if(f&1)u[f]++;else if(f===4)if(t.foundPatternCross(u)){var h=this.handlePossibleCenter(u,d,A,n);if(h===!0)if(l=2,this.hasSkipped===!0)c=this.haveMultiplyConfirmedCenters();else{var m=this.findRowSkip();m>u[2]&&(d+=m-u[2]-l,A=o-1)}else{u[0]=u[2],u[1]=u[3],u[2]=u[4],u[3]=1,u[4]=0,f=3;continue}f=0,u[0]=0,u[1]=0,u[2]=0,u[3]=0,u[4]=0}else u[0]=u[2],u[1]=u[3],u[2]=u[4],u[3]=1,u[4]=0,f=3;else u[++f]++;if(t.foundPatternCross(u)){var h=this.handlePossibleCenter(u,d,o,n);h===!0&&(l=u[0],this.hasSkipped&&(c=this.haveMultiplyConfirmedCenters()))}}var p=this.selectBestPatterns();return Kr.orderBestPatterns(p),new X5e(p)},t.centerFromEnd=function(e,r){return r-e[4]-e[3]-e[2]/2},t.foundPatternCross=function(e){for(var r=0,n=0;n<5;n++){var a=e[n];if(a===0)return!1;r+=a}if(r<7)return!1;var s=r/7,o=s/2;return Math.abs(s-e[0])<o&&Math.abs(s-e[1])<o&&Math.abs(3*s-e[2])<3*o&&Math.abs(s-e[3])<o&&Math.abs(s-e[4])<o},t.prototype.getCrossCheckStateCount=function(){var e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e},t.prototype.crossCheckDiagonal=function(e,r,n,a){for(var s=this.getCrossCheckStateCount(),o=0,l=this.image;e>=o&&r>=o&&l.get(r-o,e-o);)s[2]++,o++;if(e<o||r<o)return!1;for(;e>=o&&r>=o&&!l.get(r-o,e-o)&&s[1]<=n;)s[1]++,o++;if(e<o||r<o||s[1]>n)return!1;for(;e>=o&&r>=o&&l.get(r-o,e-o)&&s[0]<=n;)s[0]++,o++;if(s[0]>n)return!1;var c=l.getHeight(),u=l.getWidth();for(o=1;e+o<c&&r+o<u&&l.get(r+o,e+o);)s[2]++,o++;if(e+o>=c||r+o>=u)return!1;for(;e+o<c&&r+o<u&&!l.get(r+o,e+o)&&s[3]<n;)s[3]++,o++;if(e+o>=c||r+o>=u||s[3]>=n)return!1;for(;e+o<c&&r+o<u&&l.get(r+o,e+o)&&s[4]<n;)s[4]++,o++;if(s[4]>=n)return!1;var d=s[0]+s[1]+s[2]+s[3]+s[4];return Math.abs(d-a)<2*a&&t.foundPatternCross(s)},t.prototype.crossCheckVertical=function(e,r,n,a){for(var s=this.image,o=s.getHeight(),l=this.getCrossCheckStateCount(),c=e;c>=0&&s.get(r,c);)l[2]++,c--;if(c<0)return NaN;for(;c>=0&&!s.get(r,c)&&l[1]<=n;)l[1]++,c--;if(c<0||l[1]>n)return NaN;for(;c>=0&&s.get(r,c)&&l[0]<=n;)l[0]++,c--;if(l[0]>n)return NaN;for(c=e+1;c<o&&s.get(r,c);)l[2]++,c++;if(c===o)return NaN;for(;c<o&&!s.get(r,c)&&l[3]<n;)l[3]++,c++;if(c===o||l[3]>=n)return NaN;for(;c<o&&s.get(r,c)&&l[4]<n;)l[4]++,c++;if(l[4]>=n)return NaN;var u=l[0]+l[1]+l[2]+l[3]+l[4];return 5*Math.abs(u-a)>=2*a?NaN:t.foundPatternCross(l)?t.centerFromEnd(l,c):NaN},t.prototype.crossCheckHorizontal=function(e,r,n,a){for(var s=this.image,o=s.getWidth(),l=this.getCrossCheckStateCount(),c=e;c>=0&&s.get(c,r);)l[2]++,c--;if(c<0)return NaN;for(;c>=0&&!s.get(c,r)&&l[1]<=n;)l[1]++,c--;if(c<0||l[1]>n)return NaN;for(;c>=0&&s.get(c,r)&&l[0]<=n;)l[0]++,c--;if(l[0]>n)return NaN;for(c=e+1;c<o&&s.get(c,r);)l[2]++,c++;if(c===o)return NaN;for(;c<o&&!s.get(c,r)&&l[3]<n;)l[3]++,c++;if(c===o||l[3]>=n)return NaN;for(;c<o&&s.get(c,r)&&l[4]<n;)l[4]++,c++;if(l[4]>=n)return NaN;var u=l[0]+l[1]+l[2]+l[3]+l[4];return 5*Math.abs(u-a)>=a?NaN:t.foundPatternCross(l)?t.centerFromEnd(l,c):NaN},t.prototype.handlePossibleCenter=function(e,r,n,a){var s=e[0]+e[1]+e[2]+e[3]+e[4],o=t.centerFromEnd(e,n),l=this.crossCheckVertical(r,Math.floor(o),e[2],s);if(!isNaN(l)&&(o=this.crossCheckHorizontal(Math.floor(o),Math.floor(l),e[2],s),!isNaN(o)&&(!a||this.crossCheckDiagonal(Math.floor(l),Math.floor(o),e[2],s)))){for(var c=s/7,u=!1,d=this.possibleCenters,f=0,A=d.length;f<A;f++){var h=d[f];if(h.aboutEquals(c,l,o)){d[f]=h.combineEstimate(l,o,c),u=!0;break}}if(!u){var m=new W5e(o,l,c);d.push(m),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(m)}return!0}return!1},t.prototype.findRowSkip=function(){var e,r,n=this.possibleCenters.length;if(n<=1)return 0;var a=null;try{for(var s=uy(this.possibleCenters),o=s.next();!o.done;o=s.next()){var l=o.value;if(l.getCount()>=t.CENTER_QUORUM)if(a==null)a=l;else return this.hasSkipped=!0,Math.floor((Math.abs(a.getX()-l.getX())-Math.abs(a.getY()-l.getY()))/2)}}catch(c){e={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return 0},t.prototype.haveMultiplyConfirmedCenters=function(){var e,r,n,a,s=0,o=0,l=this.possibleCenters.length;try{for(var c=uy(this.possibleCenters),u=c.next();!u.done;u=c.next()){var d=u.value;d.getCount()>=t.CENTER_QUORUM&&(s++,o+=d.getEstimatedModuleSize())}}catch(p){e={error:p}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}if(s<3)return!1;var f=o/l,A=0;try{for(var h=uy(this.possibleCenters),m=h.next();!m.done;m=h.next()){var d=m.value;A+=Math.abs(d.getEstimatedModuleSize()-f)}}catch(p){n={error:p}}finally{try{m&&!m.done&&(a=h.return)&&a.call(h)}finally{if(n)throw n.error}}return A<=.05*o},t.prototype.selectBestPatterns=function(){var e,r,n,a,s=this.possibleCenters.length;if(s<3)throw new Zt;var o=this.possibleCenters,l;if(s>3){var c=0,u=0;try{for(var d=uy(this.possibleCenters),f=d.next();!f.done;f=d.next()){var A=f.value,h=A.getEstimatedModuleSize();c+=h,u+=h*h}}catch(j){e={error:j}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(e)throw e.error}}l=c/s;var m=Math.sqrt(u/s-l*l);o.sort(function(j,I){var _=Math.abs(I.getEstimatedModuleSize()-l),S=Math.abs(j.getEstimatedModuleSize()-l);return _<S?-1:_>S?1:0});for(var p=Math.max(.2*l,m),g=0;g<o.length&&o.length>3;g++){var v=o[g];Math.abs(v.getEstimatedModuleSize()-l)>p&&(o.splice(g,1),g--)}}if(o.length>3){var c=0;try{for(var y=uy(o),b=y.next();!b.done;b=y.next()){var w=b.value;c+=w.getEstimatedModuleSize()}}catch(I){n={error:I}}finally{try{b&&!b.done&&(a=y.return)&&a.call(y)}finally{if(n)throw n.error}}l=c/o.length,o.sort(function(I,_){if(_.getCount()===I.getCount()){var S=Math.abs(_.getEstimatedModuleSize()-l),E=Math.abs(I.getEstimatedModuleSize()-l);return S<E?1:S>E?-1:0}else return _.getCount()-I.getCount()}),o.splice(3)}return[o[0],o[1],o[2]]},t.CENTER_QUORUM=2,t.MIN_SKIP=3,t.MAX_MODULES=57,t}(),J5e=function(){function t(e){this.image=e}return t.prototype.getImage=function(){return this.image},t.prototype.getResultPointCallback=function(){return this.resultPointCallback},t.prototype.detect=function(e){this.resultPointCallback=e==null?null:e.get(is.NEED_RESULT_POINT_CALLBACK);var r=new Y5e(this.image,this.resultPointCallback),n=r.find(e);return this.processFinderPatternInfo(n)},t.prototype.processFinderPatternInfo=function(e){var r=e.getTopLeft(),n=e.getTopRight(),a=e.getBottomLeft(),s=this.calculateModuleSize(r,n,a);if(s<1)throw new Zt("No pattern found in proccess finder.");var o=t.computeDimension(r,n,a,s),l=Pp.getProvisionalVersionForDimension(o),c=l.getDimensionForVersion()-7,u=null;if(l.getAlignmentPatternCenters().length>0)for(var d=n.getX()-r.getX()+a.getX(),f=n.getY()-r.getY()+a.getY(),A=1-3/c,h=Math.floor(r.getX()+A*(d-r.getX())),m=Math.floor(r.getY()+A*(f-r.getY())),p=4;p<=16;p<<=1)try{u=this.findAlignmentInRegion(s,h,m,p);break}catch(b){if(!(b instanceof Zt))throw b}var g=t.createTransform(r,n,a,u,o),v=t.sampleGrid(this.image,g,o),y;return u===null?y=[a,r,n]:y=[a,r,n,u],new T6(v,y)},t.createTransform=function(e,r,n,a,s){var o=s-3.5,l,c,u,d;return a!==null?(l=a.getX(),c=a.getY(),u=o-3,d=u):(l=r.getX()-e.getX()+n.getX(),c=r.getY()-e.getY()+n.getY(),u=o,d=o),Kre.quadrilateralToQuadrilateral(3.5,3.5,o,3.5,u,d,3.5,o,e.getX(),e.getY(),r.getX(),r.getY(),l,c,n.getX(),n.getY())},t.sampleGrid=function(e,r,n){var a=k6.getInstance();return a.sampleGridWithTransform(e,n,n,r)},t.computeDimension=function(e,r,n,a){var s=da.round(Kr.distance(e,r)/a),o=da.round(Kr.distance(e,n)/a),l=Math.floor((s+o)/2)+7;switch(l&3){case 0:l++;break;case 2:l--;break;case 3:throw new Zt("Dimensions could be not found.")}return l},t.prototype.calculateModuleSize=function(e,r,n){return(this.calculateModuleSizeOneWay(e,r)+this.calculateModuleSizeOneWay(e,n))/2},t.prototype.calculateModuleSizeOneWay=function(e,r){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(r.getX()),Math.floor(r.getY())),a=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(r.getX()),Math.floor(r.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(n)?a/7:isNaN(a)?n/7:(n+a)/14},t.prototype.sizeOfBlackWhiteBlackRunBothWays=function(e,r,n,a){var s=this.sizeOfBlackWhiteBlackRun(e,r,n,a),o=1,l=e-(n-e);l<0?(o=e/(e-l),l=0):l>=this.image.getWidth()&&(o=(this.image.getWidth()-1-e)/(l-e),l=this.image.getWidth()-1);var c=Math.floor(r-(a-r)*o);return o=1,c<0?(o=r/(r-c),c=0):c>=this.image.getHeight()&&(o=(this.image.getHeight()-1-r)/(c-r),c=this.image.getHeight()-1),l=Math.floor(e+(l-e)*o),s+=this.sizeOfBlackWhiteBlackRun(e,r,l,c),s-1},t.prototype.sizeOfBlackWhiteBlackRun=function(e,r,n,a){var s=Math.abs(a-r)>Math.abs(n-e);if(s){var o=e;e=r,r=o,o=n,n=a,a=o}for(var l=Math.abs(n-e),c=Math.abs(a-r),u=-l/2,d=e<n?1:-1,f=r<a?1:-1,A=0,h=n+d,m=e,p=r;m!==h;m+=d){var g=s?p:m,v=s?m:p;if(A===1===this.image.get(g,v)){if(A===2)return da.distance(m,p,e,r);A++}if(u+=c,u>0){if(p===a)break;p+=f,u-=l}}return A===2?da.distance(n+d,a,e,r):NaN},t.prototype.findAlignmentInRegion=function(e,r,n,a){var s=Math.floor(a*e),o=Math.max(0,r-s),l=Math.min(this.image.getWidth()-1,r+s);if(l-o<e*3)throw new Zt("Alignment top exceeds estimated module size.");var c=Math.max(0,n-s),u=Math.min(this.image.getHeight()-1,n+s);if(u-c<e*3)throw new Zt("Alignment bottom exceeds estimated module size.");var d=new q5e(this.image,o,c,l-o,u-c,e,this.resultPointCallback);return d.find()},t}(),BS=function(){function t(){this.decoder=new H5e}return t.prototype.getDecoder=function(){return this.decoder},t.prototype.decode=function(e,r){var n,a;if(r!=null&&r.get(is.PURE_BARCODE)!==void 0){var s=t.extractPureBits(e.getBlackMatrix());n=this.decoder.decodeBitMatrix(s,r),a=t.NO_POINTS}else{var o=new J5e(e.getBlackMatrix()).detect(r);n=this.decoder.decodeBitMatrix(o.getBits(),r),a=o.getPoints()}n.getOther()instanceof Jre&&n.getOther().applyMirroredCorrection(a);var l=new Vl(n.getText(),n.getRawBytes(),void 0,a,ln.QR_CODE,void 0),c=n.getByteSegments();c!==null&&l.putMetadata(ul.BYTE_SEGMENTS,c);var u=n.getECLevel();return u!==null&&l.putMetadata(ul.ERROR_CORRECTION_LEVEL,u),n.hasStructuredAppend()&&(l.putMetadata(ul.STRUCTURED_APPEND_SEQUENCE,n.getStructuredAppendSequenceNumber()),l.putMetadata(ul.STRUCTURED_APPEND_PARITY,n.getStructuredAppendParity())),l},t.prototype.reset=function(){},t.extractPureBits=function(e){var r=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(r===null||n===null)throw new Zt;var a=this.moduleSize(r,e),s=r[1],o=n[1],l=r[0],c=n[0];if(l>=c||s>=o)throw new Zt;if(o-s!==c-l&&(c=l+(o-s),c>=e.getWidth()))throw new Zt;var u=Math.round((c-l+1)/a),d=Math.round((o-s+1)/a);if(u<=0||d<=0)throw new Zt;if(d!==u)throw new Zt;var f=Math.floor(a/2);s+=f,l+=f;var A=l+Math.floor((u-1)*a)-c;if(A>0){if(A>f)throw new Zt;l-=A}var h=s+Math.floor((d-1)*a)-o;if(h>0){if(h>f)throw new Zt;s-=h}for(var m=new Kf(u,d),p=0;p<d;p++)for(var g=s+Math.floor(p*a),v=0;v<u;v++)e.get(l+Math.floor(v*a),g)&&m.set(v,p);return m},t.moduleSize=function(e,r){for(var n=r.getHeight(),a=r.getWidth(),s=e[0],o=e[1],l=!0,c=0;s<a&&o<n;){if(l!==r.get(s,o)){if(++c===5)break;l=!l}s++,o++}if(s===a||o===n)throw new Zt;return(s-e[0])/7},t.NO_POINTS=new Array,t}(),Z5e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},aa=function(){function t(){}return t.prototype.PDF417Common=function(){},t.getBitCountSum=function(e){return da.sum(e)},t.toIntArray=function(e){var r,n;if(e==null||!e.length)return t.EMPTY_INT_ARRAY;var a=new Int32Array(e.length),s=0;try{for(var o=Z5e(e),l=o.next();!l.done;l=o.next()){var c=l.value;a[s++]=c}}catch(u){r={error:u}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a},t.getCodeword=function(e){var r=co.binarySearch(t.SYMBOL_TABLE,e&262143);return r<0?-1:(t.CODEWORD_TABLE[r]-1)%t.NUMBER_OF_CODEWORDS},t.NUMBER_OF_CODEWORDS=929,t.MAX_CODEWORDS_IN_BARCODE=t.NUMBER_OF_CODEWORDS-1,t.MIN_ROWS_IN_BARCODE=3,t.MAX_ROWS_IN_BARCODE=90,t.MODULES_IN_CODEWORD=17,t.MODULES_IN_STOP_PATTERN=18,t.BARS_IN_MODULE=8,t.EMPTY_INT_ARRAY=new Int32Array([]),t.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),t.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]),t}(),eBe=function(){function t(e,r){this.bits=e,this.points=r}return t.prototype.getBits=function(){return this.bits},t.prototype.getPoints=function(){return this.points},t}(),tBe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},rBe=function(){function t(){}return t.detectMultiple=function(e,r,n){var a=e.getBlackMatrix(),s=t.detect(n,a);return s.length||(a=a.clone(),a.rotate180(),s=t.detect(n,a)),new eBe(a,s)},t.detect=function(e,r){for(var n,a,s=new Array,o=0,l=0,c=!1;o<r.getHeight();){var u=t.findVertices(r,o,l);if(u[0]==null&&u[3]==null){if(!c)break;c=!1,l=0;try{for(var d=(n=void 0,tBe(s)),f=d.next();!f.done;f=d.next()){var A=f.value;A[1]!=null&&(o=Math.trunc(Math.max(o,A[1].getY()))),A[3]!=null&&(o=Math.max(o,Math.trunc(A[3].getY())))}}catch(h){n={error:h}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}o+=t.ROW_STEP;continue}if(c=!0,s.push(u),!e)break;u[2]!=null?(l=Math.trunc(u[2].getX()),o=Math.trunc(u[2].getY())):(l=Math.trunc(u[4].getX()),o=Math.trunc(u[4].getY()))}return s},t.findVertices=function(e,r,n){var a=e.getHeight(),s=e.getWidth(),o=new Array(8);return t.copyToResult(o,t.findRowsWithPattern(e,a,s,r,n,t.START_PATTERN),t.INDEXES_START_PATTERN),o[4]!=null&&(n=Math.trunc(o[4].getX()),r=Math.trunc(o[4].getY())),t.copyToResult(o,t.findRowsWithPattern(e,a,s,r,n,t.STOP_PATTERN),t.INDEXES_STOP_PATTERN),o},t.copyToResult=function(e,r,n){for(var a=0;a<n.length;a++)e[n[a]]=r[a]},t.findRowsWithPattern=function(e,r,n,a,s,o){for(var l=new Array(4),c=!1,u=new Int32Array(o.length);a<r;a+=t.ROW_STEP){var d=t.findGuardPattern(e,s,a,n,!1,o,u);if(d!=null){for(;a>0;){var f=t.findGuardPattern(e,s,--a,n,!1,o,u);if(f!=null)d=f;else{a++;break}}l[0]=new Kr(d[0],a),l[1]=new Kr(d[1],a),c=!0;break}}var A=a+1;if(c){for(var h=0,f=Int32Array.from([Math.trunc(l[0].getX()),Math.trunc(l[1].getX())]);A<r;A++){var d=t.findGuardPattern(e,f[0],A,n,!1,o,u);if(d!=null&&Math.abs(f[0]-d[0])<t.MAX_PATTERN_DRIFT&&Math.abs(f[1]-d[1])<t.MAX_PATTERN_DRIFT)f=d,h=0;else{if(h>t.SKIPPED_ROW_COUNT_MAX)break;h++}}A-=h+1,l[2]=new Kr(f[0],A),l[3]=new Kr(f[1],A)}return A-a<t.BARCODE_MIN_HEIGHT&&co.fill(l,null),l},t.findGuardPattern=function(e,r,n,a,s,o,l){co.fillWithin(l,0,l.length,0);for(var c=r,u=0;e.get(c,n)&&c>0&&u++<t.MAX_PIXEL_DRIFT;)c--;for(var d=c,f=0,A=o.length,h=s;d<a;d++){var m=e.get(d,n);if(m!==h)l[f]++;else{if(f===A-1){if(t.patternMatchVariance(l,o,t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE)return new Int32Array([c,d]);c+=l[0]+l[1],ss.arraycopy(l,2,l,0,f-1),l[f-1]=0,l[f]=0,f--}else f++;l[f]=1,h=!h}}return f===A-1&&t.patternMatchVariance(l,o,t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE?new Int32Array([c,d-1]):null},t.patternMatchVariance=function(e,r,n){for(var a=e.length,s=0,o=0,l=0;l<a;l++)s+=e[l],o+=r[l];if(s<o)return 1/0;var c=s/o;n*=c;for(var u=0,d=0;d<a;d++){var f=e[d],A=r[d]*c,h=f>A?f-A:A-f;if(h>n)return 1/0;u+=h}return u/s},t.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),t.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),t.MAX_AVG_VARIANCE=.42,t.MAX_INDIVIDUAL_VARIANCE=.8,t.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),t.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),t.MAX_PIXEL_DRIFT=3,t.MAX_PATTERN_DRIFT=5,t.SKIPPED_ROW_COUNT_MAX=25,t.ROW_STEP=5,t.BARCODE_MIN_HEIGHT=10,t}(),nBe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},pp=function(){function t(e,r){if(r.length===0)throw new cn;this.field=e;var n=r.length;if(n>1&&r[0]===0){for(var a=1;a<n&&r[a]===0;)a++;a===n?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(n-a),ss.arraycopy(r,a,this.coefficients,0,this.coefficients.length))}else this.coefficients=r}return t.prototype.getCoefficients=function(){return this.coefficients},t.prototype.getDegree=function(){return this.coefficients.length-1},t.prototype.isZero=function(){return this.coefficients[0]===0},t.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},t.prototype.evaluateAt=function(e){var r,n;if(e===0)return this.getCoefficient(0);if(e===1){var a=0;try{for(var s=nBe(this.coefficients),o=s.next();!o.done;o=s.next()){var l=o.value;a=this.field.add(a,l)}}catch(f){r={error:f}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a}for(var c=this.coefficients[0],u=this.coefficients.length,d=1;d<u;d++)c=this.field.add(this.field.multiply(e,c),this.coefficients[d]);return c},t.prototype.add=function(e){if(!this.field.equals(e.field))throw new cn("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;var r=this.coefficients,n=e.coefficients;if(r.length>n.length){var a=r;r=n,n=a}var s=new Int32Array(n.length),o=n.length-r.length;ss.arraycopy(n,0,s,0,o);for(var l=o;l<n.length;l++)s[l]=this.field.add(r[l-o],n[l]);return new t(this.field,s)},t.prototype.subtract=function(e){if(!this.field.equals(e.field))throw new cn("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())},t.prototype.multiply=function(e){return e instanceof t?this.multiplyOther(e):this.multiplyScalar(e)},t.prototype.multiplyOther=function(e){if(!this.field.equals(e.field))throw new cn("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new t(this.field,new Int32Array([0]));for(var r=this.coefficients,n=r.length,a=e.coefficients,s=a.length,o=new Int32Array(n+s-1),l=0;l<n;l++)for(var c=r[l],u=0;u<s;u++)o[l+u]=this.field.add(o[l+u],this.field.multiply(c,a[u]));return new t(this.field,o)},t.prototype.negative=function(){for(var e=this.coefficients.length,r=new Int32Array(e),n=0;n<e;n++)r[n]=this.field.subtract(0,this.coefficients[n]);return new t(this.field,r)},t.prototype.multiplyScalar=function(e){if(e===0)return new t(this.field,new Int32Array([0]));if(e===1)return this;for(var r=this.coefficients.length,n=new Int32Array(r),a=0;a<r;a++)n[a]=this.field.multiply(this.coefficients[a],e);return new t(this.field,n)},t.prototype.multiplyByMonomial=function(e,r){if(e<0)throw new cn;if(r===0)return new t(this.field,new Int32Array([0]));for(var n=this.coefficients.length,a=new Int32Array(n+e),s=0;s<n;s++)a[s]=this.field.multiply(this.coefficients[s],r);return new t(this.field,a)},t.prototype.toString=function(){for(var e=new Dn,r=this.getDegree();r>=0;r--){var n=this.getCoefficient(r);n!==0&&(n<0?(e.append(" - "),n=-n):e.length()>0&&e.append(" + "),(r===0||n!==1)&&e.append(n),r!==0&&(r===1?e.append("x"):(e.append("x^"),e.append(r))))}return e.toString()},t}(),aBe=function(){function t(){}return t.prototype.add=function(e,r){return(e+r)%this.modulus},t.prototype.subtract=function(e,r){return(this.modulus+e-r)%this.modulus},t.prototype.exp=function(e){return this.expTable[e]},t.prototype.log=function(e){if(e===0)throw new cn;return this.logTable[e]},t.prototype.inverse=function(e){if(e===0)throw new Gre;return this.expTable[this.modulus-this.logTable[e]-1]},t.prototype.multiply=function(e,r){return e===0||r===0?0:this.expTable[(this.logTable[e]+this.logTable[r])%(this.modulus-1)]},t.prototype.getSize=function(){return this.modulus},t.prototype.equals=function(e){return e===this},t}(),sBe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),iBe=function(t){sBe(e,t);function e(r,n){var a=t.call(this)||this;a.modulus=r,a.expTable=new Int32Array(r),a.logTable=new Int32Array(r);for(var s=1,o=0;o<r;o++)a.expTable[o]=s,s=s*n%r;for(var o=0;o<r-1;o++)a.logTable[a.expTable[o]]=o;return a.zero=new pp(a,new Int32Array([0])),a.one=new pp(a,new Int32Array([1])),a}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(r,n){if(r<0)throw new cn;if(n===0)return this.zero;var a=new Int32Array(r+1);return a[0]=n,new pp(this,a)},e.PDF417_GF=new e(aa.NUMBER_OF_CODEWORDS,3),e}(aBe),oBe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},lBe=function(){function t(){this.field=iBe.PDF417_GF}return t.prototype.decode=function(e,r,n){for(var a,s,o=new pp(this.field,e),l=new Int32Array(r),c=!1,u=r;u>0;u--){var d=o.evaluateAt(this.field.exp(u));l[r-u]=d,d!==0&&(c=!0)}if(!c)return 0;var f=this.field.getOne();if(n!=null)try{for(var A=oBe(n),h=A.next();!h.done;h=A.next()){var m=h.value,p=this.field.exp(e.length-1-m),g=new pp(this.field,new Int32Array([this.field.subtract(0,p),1]));f=f.multiply(g)}}catch(S){a={error:S}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}for(var v=new pp(this.field,l),y=this.runEuclideanAlgorithm(this.field.buildMonomial(r,1),v,r),b=y[0],w=y[1],j=this.findErrorLocations(b),I=this.findErrorMagnitudes(w,b,j),u=0;u<j.length;u++){var _=e.length-1-this.field.log(j[u]);if(_<0)throw Vi.getChecksumInstance();e[_]=this.field.subtract(e[_],I[u])}return j.length},t.prototype.runEuclideanAlgorithm=function(e,r,n){if(e.getDegree()<r.getDegree()){var a=e;e=r,r=a}for(var s=e,o=r,l=this.field.getZero(),c=this.field.getOne();o.getDegree()>=Math.round(n/2);){var u=s,d=l;if(s=o,l=c,s.isZero())throw Vi.getChecksumInstance();o=u;for(var f=this.field.getZero(),A=s.getCoefficient(s.getDegree()),h=this.field.inverse(A);o.getDegree()>=s.getDegree()&&!o.isZero();){var m=o.getDegree()-s.getDegree(),p=this.field.multiply(o.getCoefficient(o.getDegree()),h);f=f.add(this.field.buildMonomial(m,p)),o=o.subtract(s.multiplyByMonomial(m,p))}c=f.multiply(l).subtract(d).negative()}var g=c.getCoefficient(0);if(g===0)throw Vi.getChecksumInstance();var v=this.field.inverse(g),y=c.multiply(v),b=o.multiply(v);return[y,b]},t.prototype.findErrorLocations=function(e){for(var r=e.getDegree(),n=new Int32Array(r),a=0,s=1;s<this.field.getSize()&&a<r;s++)e.evaluateAt(s)===0&&(n[a]=this.field.inverse(s),a++);if(a!==r)throw Vi.getChecksumInstance();return n},t.prototype.findErrorMagnitudes=function(e,r,n){for(var a=r.getDegree(),s=new Int32Array(a),o=1;o<=a;o++)s[a-o]=this.field.multiply(o,r.getCoefficient(o));for(var l=new pp(this.field,s),c=n.length,u=new Int32Array(c),o=0;o<c;o++){var d=this.field.inverse(n[o]),f=this.field.subtract(0,e.evaluateAt(d)),A=this.field.inverse(l.evaluateAt(d));u[o]=this.field.multiply(f,A)}return u},t}(),Qk=function(){function t(e,r,n,a,s){e instanceof t?this.constructor_2(e):this.constructor_1(e,r,n,a,s)}return t.prototype.constructor_1=function(e,r,n,a,s){var o=r==null||n==null,l=a==null||s==null;if(o&&l)throw new Zt;o?(r=new Kr(0,a.getY()),n=new Kr(0,s.getY())):l&&(a=new Kr(e.getWidth()-1,r.getY()),s=new Kr(e.getWidth()-1,n.getY())),this.image=e,this.topLeft=r,this.bottomLeft=n,this.topRight=a,this.bottomRight=s,this.minX=Math.trunc(Math.min(r.getX(),n.getX())),this.maxX=Math.trunc(Math.max(a.getX(),s.getX())),this.minY=Math.trunc(Math.min(r.getY(),a.getY())),this.maxY=Math.trunc(Math.max(n.getY(),s.getY()))},t.prototype.constructor_2=function(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()},t.merge=function(e,r){return e==null?r:r==null?e:new t(e.image,e.topLeft,e.bottomLeft,r.topRight,r.bottomRight)},t.prototype.addMissingRows=function(e,r,n){var a=this.topLeft,s=this.bottomLeft,o=this.topRight,l=this.bottomRight;if(e>0){var c=n?this.topLeft:this.topRight,u=Math.trunc(c.getY()-e);u<0&&(u=0);var d=new Kr(c.getX(),u);n?a=d:o=d}if(r>0){var f=n?this.bottomLeft:this.bottomRight,A=Math.trunc(f.getY()+r);A>=this.image.getHeight()&&(A=this.image.getHeight()-1);var h=new Kr(f.getX(),A);n?s=h:l=h}return new t(this.image,a,s,o,l)},t.prototype.getMinX=function(){return this.minX},t.prototype.getMaxX=function(){return this.maxX},t.prototype.getMinY=function(){return this.minY},t.prototype.getMaxY=function(){return this.maxY},t.prototype.getTopLeft=function(){return this.topLeft},t.prototype.getTopRight=function(){return this.topRight},t.prototype.getBottomLeft=function(){return this.bottomLeft},t.prototype.getBottomRight=function(){return this.bottomRight},t}(),cBe=function(){function t(e,r,n,a){this.columnCount=e,this.errorCorrectionLevel=a,this.rowCountUpperPart=r,this.rowCountLowerPart=n,this.rowCount=r+n}return t.prototype.getColumnCount=function(){return this.columnCount},t.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},t.prototype.getRowCount=function(){return this.rowCount},t.prototype.getRowCountUpperPart=function(){return this.rowCountUpperPart},t.prototype.getRowCountLowerPart=function(){return this.rowCountLowerPart},t}(),O6=function(){function t(){this.buffer=""}return t.form=function(e,r){var n=-1;function a(o,l,c,u,d,f){if(o==="%%")return"%";if(r[++n]!==void 0){o=u?parseInt(u.substr(1)):void 0;var A=d?parseInt(d.substr(1)):void 0,h;switch(f){case"s":h=r[n];break;case"c":h=r[n][0];break;case"f":h=parseFloat(r[n]).toFixed(o);break;case"p":h=parseFloat(r[n]).toPrecision(o);break;case"e":h=parseFloat(r[n]).toExponential(o);break;case"x":h=parseInt(r[n]).toString(A||16);break;case"d":h=parseFloat(parseInt(r[n],A||10).toPrecision(o)).toFixed(0);break}h=typeof h=="object"?JSON.stringify(h):(+h).toString(A);for(var m=parseInt(c),p=c&&c[0]+""=="0"?"0":" ";h.length<m;)h=l!==void 0?h+p:p+h;return h}}var s=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(s,a)},t.prototype.format=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.buffer+=t.form(e,r)},t.prototype.toString=function(){return this.buffer},t}(),uBe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Zre=function(){function t(e){this.boundingBox=new Qk(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}return t.prototype.getCodewordNearby=function(e){var r=this.getCodeword(e);if(r!=null)return r;for(var n=1;n<t.MAX_NEARBY_DISTANCE;n++){var a=this.imageRowToCodewordIndex(e)-n;if(a>=0&&(r=this.codewords[a],r!=null)||(a=this.imageRowToCodewordIndex(e)+n,a<this.codewords.length&&(r=this.codewords[a],r!=null)))return r}return null},t.prototype.imageRowToCodewordIndex=function(e){return e-this.boundingBox.getMinY()},t.prototype.setCodeword=function(e,r){this.codewords[this.imageRowToCodewordIndex(e)]=r},t.prototype.getCodeword=function(e){return this.codewords[this.imageRowToCodewordIndex(e)]},t.prototype.getBoundingBox=function(){return this.boundingBox},t.prototype.getCodewords=function(){return this.codewords},t.prototype.toString=function(){var e,r,n=new O6,a=0;try{for(var s=uBe(this.codewords),o=s.next();!o.done;o=s.next()){var l=o.value;if(l==null){n.format("%3d:    |   %n",a++);continue}n.format("%3d: %3d|%3d%n",a++,l.getRowNumber(),l.getValue())}}catch(c){e={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return n.toString()},t.MAX_NEARBY_DISTANCE=5,t}(),dBe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},fBe=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),a,s=[],o;try{for(;(e===void 0||e-- >0)&&!(a=n.next()).done;)s.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s},Qy=function(){function t(){this.values=new Map}return t.prototype.setValue=function(e){e=Math.trunc(e);var r=this.values.get(e);r==null&&(r=0),r++,this.values.set(e,r)},t.prototype.getValue=function(){var e,r,n=-1,a=new Array,s=function(f,A){var h={getKey:function(){return f},getValue:function(){return A}};h.getValue()>n?(n=h.getValue(),a=[],a.push(h.getKey())):h.getValue()===n&&a.push(h.getKey())};try{for(var o=dBe(this.values.entries()),l=o.next();!l.done;l=o.next()){var c=fBe(l.value,2),u=c[0],d=c[1];s(u,d)}}catch(f){e={error:f}}finally{try{l&&!l.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return aa.toIntArray(a)},t.prototype.getConfidence=function(e){return this.values.get(e)},t}(),hBe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),g5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},gH=function(t){hBe(e,t);function e(r,n){var a=t.call(this,r)||this;return a._isLeft=n,a}return e.prototype.setRowNumbers=function(){var r,n;try{for(var a=g5(this.getCodewords()),s=a.next();!s.done;s=a.next()){var o=s.value;o!=null&&o.setRowNumberAsRowIndicatorColumn()}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},e.prototype.adjustCompleteIndicatorColumnRowNumbers=function(r){var n=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(n,r);for(var a=this.getBoundingBox(),s=this._isLeft?a.getTopLeft():a.getTopRight(),o=this._isLeft?a.getBottomLeft():a.getBottomRight(),l=this.imageRowToCodewordIndex(Math.trunc(s.getY())),c=this.imageRowToCodewordIndex(Math.trunc(o.getY())),u=-1,d=1,f=0,A=l;A<c;A++)if(n[A]!=null){var h=n[A],m=h.getRowNumber()-u;if(m===0)f++;else if(m===1)d=Math.max(d,f),f=1,u=h.getRowNumber();else if(m<0||h.getRowNumber()>=r.getRowCount()||m>A)n[A]=null;else{var p=void 0;d>2?p=(d-2)*m:p=m;for(var g=p>=A,v=1;v<=p&&!g;v++)g=n[A-v]!=null;g?n[A]=null:(u=h.getRowNumber(),f=1)}}},e.prototype.getRowHeights=function(){var r,n,a=this.getBarcodeMetadata();if(a==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(a);var s=new Int32Array(a.getRowCount());try{for(var o=g5(this.getCodewords()),l=o.next();!l.done;l=o.next()){var c=l.value;if(c!=null){var u=c.getRowNumber();if(u>=s.length)continue;s[u]++}}}catch(d){r={error:d}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s},e.prototype.adjustIncompleteIndicatorColumnRowNumbers=function(r){for(var n=this.getBoundingBox(),a=this._isLeft?n.getTopLeft():n.getTopRight(),s=this._isLeft?n.getBottomLeft():n.getBottomRight(),o=this.imageRowToCodewordIndex(Math.trunc(a.getY())),l=this.imageRowToCodewordIndex(Math.trunc(s.getY())),c=this.getCodewords(),u=-1,d=o;d<l;d++)if(c[d]!=null){var f=c[d];f.setRowNumberAsRowIndicatorColumn();var A=f.getRowNumber()-u;A===0||(A===1?u=f.getRowNumber():f.getRowNumber()>=r.getRowCount()?c[d]=null:u=f.getRowNumber())}},e.prototype.getBarcodeMetadata=function(){var r,n,a=this.getCodewords(),s=new Qy,o=new Qy,l=new Qy,c=new Qy;try{for(var u=g5(a),d=u.next();!d.done;d=u.next()){var f=d.value;if(f!=null){f.setRowNumberAsRowIndicatorColumn();var A=f.getValue()%30,h=f.getRowNumber();switch(this._isLeft||(h+=2),h%3){case 0:o.setValue(A*3+1);break;case 1:c.setValue(A/3),l.setValue(A%3);break;case 2:s.setValue(A+1);break}}}}catch(p){r={error:p}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}if(s.getValue().length===0||o.getValue().length===0||l.getValue().length===0||c.getValue().length===0||s.getValue()[0]<1||o.getValue()[0]+l.getValue()[0]<aa.MIN_ROWS_IN_BARCODE||o.getValue()[0]+l.getValue()[0]>aa.MAX_ROWS_IN_BARCODE)return null;var m=new cBe(s.getValue()[0],o.getValue()[0],l.getValue()[0],c.getValue()[0]);return this.removeIncorrectCodewords(a,m),m},e.prototype.removeIncorrectCodewords=function(r,n){for(var a=0;a<r.length;a++){var s=r[a];if(r[a]!=null){var o=s.getValue()%30,l=s.getRowNumber();if(l>n.getRowCount()){r[a]=null;continue}switch(this._isLeft||(l+=2),l%3){case 0:o*3+1!==n.getRowCountUpperPart()&&(r[a]=null);break;case 1:(Math.trunc(o/3)!==n.getErrorCorrectionLevel()||o%3!==n.getRowCountLowerPart())&&(r[a]=null);break;case 2:o+1!==n.getColumnCount()&&(r[a]=null);break}}}},e.prototype.isLeft=function(){return this._isLeft},e.prototype.toString=function(){return"IsLeft: "+this._isLeft+`
`+t.prototype.toString.call(this)},e}(Zre),ABe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},mBe=function(){function t(e,r){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=r,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}return t.prototype.getDetectionResultColumns=function(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);var e=aa.MAX_CODEWORDS_IN_BARCODE,r;do r=e,e=this.adjustRowNumbersAndGetCount();while(e>0&&e<r);return this.detectionResultColumns},t.prototype.adjustIndicatorColumnRowNumbers=function(e){e!=null&&e.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)},t.prototype.adjustRowNumbersAndGetCount=function(){var e=this.adjustRowNumbersByRow();if(e===0)return 0;for(var r=1;r<this.barcodeColumnCount+1;r++)for(var n=this.detectionResultColumns[r].getCodewords(),a=0;a<n.length;a++)n[a]!=null&&(n[a].hasValidRowNumber()||this.adjustRowNumbers(r,a,n));return e},t.prototype.adjustRowNumbersByRow=function(){this.adjustRowNumbersFromBothRI();var e=this.adjustRowNumbersFromLRI();return e+this.adjustRowNumbersFromRRI()},t.prototype.adjustRowNumbersFromBothRI=function(){if(!(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)){for(var e=this.detectionResultColumns[0].getCodewords(),r=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<e.length;n++)if(e[n]!=null&&r[n]!=null&&e[n].getRowNumber()===r[n].getRowNumber())for(var a=1;a<=this.barcodeColumnCount;a++){var s=this.detectionResultColumns[a].getCodewords()[n];s!=null&&(s.setRowNumber(e[n].getRowNumber()),s.hasValidRowNumber()||(this.detectionResultColumns[a].getCodewords()[n]=null))}}},t.prototype.adjustRowNumbersFromRRI=function(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;for(var e=0,r=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<r.length;n++)if(r[n]!=null)for(var a=r[n].getRowNumber(),s=0,o=this.barcodeColumnCount+1;o>0&&s<this.ADJUST_ROW_NUMBER_SKIP;o--){var l=this.detectionResultColumns[o].getCodewords()[n];l!=null&&(s=t.adjustRowNumberIfValid(a,s,l),l.hasValidRowNumber()||e++)}return e},t.prototype.adjustRowNumbersFromLRI=function(){if(this.detectionResultColumns[0]==null)return 0;for(var e=0,r=this.detectionResultColumns[0].getCodewords(),n=0;n<r.length;n++)if(r[n]!=null)for(var a=r[n].getRowNumber(),s=0,o=1;o<this.barcodeColumnCount+1&&s<this.ADJUST_ROW_NUMBER_SKIP;o++){var l=this.detectionResultColumns[o].getCodewords()[n];l!=null&&(s=t.adjustRowNumberIfValid(a,s,l),l.hasValidRowNumber()||e++)}return e},t.adjustRowNumberIfValid=function(e,r,n){return n==null||n.hasValidRowNumber()||(n.isValidRowNumber(e)?(n.setRowNumber(e),r=0):++r),r},t.prototype.adjustRowNumbers=function(e,r,n){var a,s;if(this.detectionResultColumns[e-1]!=null){var o=n[r],l=this.detectionResultColumns[e-1].getCodewords(),c=l;this.detectionResultColumns[e+1]!=null&&(c=this.detectionResultColumns[e+1].getCodewords());var u=new Array(14);u[2]=l[r],u[3]=c[r],r>0&&(u[0]=n[r-1],u[4]=l[r-1],u[5]=c[r-1]),r>1&&(u[8]=n[r-2],u[10]=l[r-2],u[11]=c[r-2]),r<n.length-1&&(u[1]=n[r+1],u[6]=l[r+1],u[7]=c[r+1]),r<n.length-2&&(u[9]=n[r+2],u[12]=l[r+2],u[13]=c[r+2]);try{for(var d=ABe(u),f=d.next();!f.done;f=d.next()){var A=f.value;if(t.adjustRowNumber(o,A))return}}catch(h){a={error:h}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}}},t.adjustRowNumber=function(e,r){return r==null?!1:r.hasValidRowNumber()&&r.getBucket()===e.getBucket()?(e.setRowNumber(r.getRowNumber()),!0):!1},t.prototype.getBarcodeColumnCount=function(){return this.barcodeColumnCount},t.prototype.getBarcodeRowCount=function(){return this.barcodeMetadata.getRowCount()},t.prototype.getBarcodeECLevel=function(){return this.barcodeMetadata.getErrorCorrectionLevel()},t.prototype.setBoundingBox=function(e){this.boundingBox=e},t.prototype.getBoundingBox=function(){return this.boundingBox},t.prototype.setDetectionResultColumn=function(e,r){this.detectionResultColumns[e]=r},t.prototype.getDetectionResultColumn=function(e){return this.detectionResultColumns[e]},t.prototype.toString=function(){var e=this.detectionResultColumns[0];e==null&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);for(var r=new O6,n=0;n<e.getCodewords().length;n++){r.format("CW %3d:",n);for(var a=0;a<this.barcodeColumnCount+2;a++){if(this.detectionResultColumns[a]==null){r.format("    |   ");continue}var s=this.detectionResultColumns[a].getCodewords()[n];if(s==null){r.format("    |   ");continue}r.format(" %3d|%3d",s.getRowNumber(),s.getValue())}r.format("%n")}return r.toString()},t}(),pBe=function(){function t(e,r,n,a){this.rowNumber=t.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(r),this.bucket=Math.trunc(n),this.value=Math.trunc(a)}return t.prototype.hasValidRowNumber=function(){return this.isValidRowNumber(this.rowNumber)},t.prototype.isValidRowNumber=function(e){return e!==t.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3},t.prototype.setRowNumberAsRowIndicatorColumn=function(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))},t.prototype.getWidth=function(){return this.endX-this.startX},t.prototype.getStartX=function(){return this.startX},t.prototype.getEndX=function(){return this.endX},t.prototype.getBucket=function(){return this.bucket},t.prototype.getValue=function(){return this.value},t.prototype.getRowNumber=function(){return this.rowNumber},t.prototype.setRowNumber=function(e){this.rowNumber=e},t.prototype.toString=function(){return this.rowNumber+"|"+this.value},t.BARCODE_ROW_UNKNOWN=-1,t}(),gBe=function(){function t(){}return t.initialize=function(){for(var e=0;e<aa.SYMBOL_TABLE.length;e++)for(var r=aa.SYMBOL_TABLE[e],n=r&1,a=0;a<aa.BARS_IN_MODULE;a++){for(var s=0;(r&1)===n;)s+=1,r>>=1;n=r&1,t.RATIOS_TABLE[e]||(t.RATIOS_TABLE[e]=new Array(aa.BARS_IN_MODULE)),t.RATIOS_TABLE[e][aa.BARS_IN_MODULE-a-1]=Math.fround(s/aa.MODULES_IN_CODEWORD)}this.bSymbolTableReady=!0},t.getDecodedValue=function(e){var r=t.getDecodedCodewordValue(t.sampleBitCounts(e));return r!==-1?r:t.getClosestDecodedValue(e)},t.sampleBitCounts=function(e){for(var r=da.sum(e),n=new Int32Array(aa.BARS_IN_MODULE),a=0,s=0,o=0;o<aa.MODULES_IN_CODEWORD;o++){var l=r/(2*aa.MODULES_IN_CODEWORD)+o*r/aa.MODULES_IN_CODEWORD;s+e[a]<=l&&(s+=e[a],a++),n[a]++}return n},t.getDecodedCodewordValue=function(e){var r=t.getBitValue(e);return aa.getCodeword(r)===-1?-1:r},t.getBitValue=function(e){for(var r=0,n=0;n<e.length;n++)for(var a=0;a<e[n];a++)r=r<<1|(n%2===0?1:0);return Math.trunc(r)},t.getClosestDecodedValue=function(e){var r=da.sum(e),n=new Array(aa.BARS_IN_MODULE);if(r>1)for(var a=0;a<n.length;a++)n[a]=Math.fround(e[a]/r);var s=Mk.MAX_VALUE,o=-1;this.bSymbolTableReady||t.initialize();for(var l=0;l<t.RATIOS_TABLE.length;l++){for(var c=0,u=t.RATIOS_TABLE[l],d=0;d<aa.BARS_IN_MODULE;d++){var f=Math.fround(u[d]-n[d]);if(c+=Math.fround(f*f),c>=s)break}c<s&&(s=c,o=aa.SYMBOL_TABLE[l])}return o},t.bSymbolTableReady=!1,t.RATIOS_TABLE=new Array(aa.SYMBOL_TABLE.length).map(function(e){return new Array(aa.BARS_IN_MODULE)}),t}(),xBe=function(){function t(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}return t.prototype.getSegmentIndex=function(){return this.segmentIndex},t.prototype.setSegmentIndex=function(e){this.segmentIndex=e},t.prototype.getFileId=function(){return this.fileId},t.prototype.setFileId=function(e){this.fileId=e},t.prototype.getOptionalData=function(){return this.optionalData},t.prototype.setOptionalData=function(e){this.optionalData=e},t.prototype.isLastSegment=function(){return this.lastSegment},t.prototype.setLastSegment=function(e){this.lastSegment=e},t.prototype.getSegmentCount=function(){return this.segmentCount},t.prototype.setSegmentCount=function(e){this.segmentCount=e},t.prototype.getSender=function(){return this.sender||null},t.prototype.setSender=function(e){this.sender=e},t.prototype.getAddressee=function(){return this.addressee||null},t.prototype.setAddressee=function(e){this.addressee=e},t.prototype.getFileName=function(){return this.fileName},t.prototype.setFileName=function(e){this.fileName=e},t.prototype.getFileSize=function(){return this.fileSize},t.prototype.setFileSize=function(e){this.fileSize=e},t.prototype.getChecksum=function(){return this.checksum},t.prototype.setChecksum=function(e){this.checksum=e},t.prototype.getTimestamp=function(){return this.timestamp},t.prototype.setTimestamp=function(e){this.timestamp=e},t}(),xH=function(){function t(){}return t.parseLong=function(e,r){return r===void 0&&(r=void 0),parseInt(e,r)},t}(),vBe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),yBe=function(t){vBe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="NullPointerException",e}(Qc),bBe=function(){function t(){}return t.prototype.writeBytes=function(e){this.writeBytesOffset(e,0,e.length)},t.prototype.writeBytesOffset=function(e,r,n){if(e==null)throw new yBe;if(r<0||r>e.length||n<0||r+n>e.length||r+n<0)throw new B6;if(n===0)return;for(var a=0;a<n;a++)this.write(e[r+a])},t.prototype.flush=function(){},t.prototype.close=function(){},t}(),wBe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),NBe=function(t){wBe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Qc),CBe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),_Be=function(t){CBe(e,t);function e(r){r===void 0&&(r=32);var n=t.call(this)||this;if(n.count=0,r<0)throw new cn("Negative initial size: "+r);return n.buf=new Uint8Array(r),n}return e.prototype.ensureCapacity=function(r){r-this.buf.length>0&&this.grow(r)},e.prototype.grow=function(r){var n=this.buf.length,a=n<<1;if(a-r<0&&(a=r),a<0){if(r<0)throw new NBe;a=Hn.MAX_VALUE}this.buf=co.copyOfUint8Array(this.buf,a)},e.prototype.write=function(r){this.ensureCapacity(this.count+1),this.buf[this.count]=r,this.count+=1},e.prototype.writeBytesOffset=function(r,n,a){if(n<0||n>r.length||a<0||n+a-r.length>0)throw new B6;this.ensureCapacity(this.count+a),ss.arraycopy(r,n,this.buf,this.count,a),this.count+=a},e.prototype.writeTo=function(r){r.writeBytesOffset(this.buf,0,this.count)},e.prototype.reset=function(){this.count=0},e.prototype.toByteArray=function(){return co.copyOfUint8Array(this.buf,this.count)},e.prototype.size=function(){return this.count},e.prototype.toString=function(r){return r?typeof r=="string"?this.toString_string(r):this.toString_number(r):this.toString_void()},e.prototype.toString_void=function(){return new String(this.buf).toString()},e.prototype.toString_string=function(r){return new String(this.buf).toString()},e.prototype.toString_number=function(r){return new String(this.buf).toString()},e.prototype.close=function(){},e}(bBe),Va;(function(t){t[t.ALPHA=0]="ALPHA",t[t.LOWER=1]="LOWER",t[t.MIXED=2]="MIXED",t[t.PUNCT=3]="PUNCT",t[t.ALPHA_SHIFT=4]="ALPHA_SHIFT",t[t.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Va||(Va={}));function ene(){if(typeof window<"u")return window.BigInt||null;if(typeof global<"u")return global.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}var UC;function m0(t){if(typeof UC>"u"&&(UC=ene()),UC===null)throw new Error("BigInt is not supported!");return UC(t)}function EBe(){var t=[];t[0]=m0(1);var e=m0(900);t[1]=e;for(var r=2;r<16;r++)t[r]=t[r-1]*e;return t}var SBe=function(){function t(){}return t.decode=function(e,r){var n=new Dn(""),a=lo.ISO8859_1;n.enableDecoding(a);for(var s=1,o=e[s++],l=new xBe;s<e[0];){switch(o){case t.TEXT_COMPACTION_MODE_LATCH:s=t.textCompaction(e,s,n);break;case t.BYTE_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:s=t.byteCompaction(o,e,a,s,n);break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[s++]);break;case t.NUMERIC_COMPACTION_MODE_LATCH:s=t.numericCompaction(e,s,n);break;case t.ECI_CHARSET:lo.getCharacterSetECIByValue(e[s++]);break;case t.ECI_GENERAL_PURPOSE:s+=2;break;case t.ECI_USER_DEFINED:s++;break;case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:s=t.decodeMacroBlock(e,s,l);break;case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:throw new Sr;default:s--,s=t.textCompaction(e,s,n);break}if(s<e.length)o=e[s++];else throw Sr.getFormatInstance()}if(n.length()===0)throw Sr.getFormatInstance();var c=new Wj(null,n.toString(),null,r);return c.setOther(l),c},t.decodeMacroBlock=function(e,r,n){if(r+t.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw Sr.getFormatInstance();for(var a=new Int32Array(t.NUMBER_OF_SEQUENCE_CODEWORDS),s=0;s<t.NUMBER_OF_SEQUENCE_CODEWORDS;s++,r++)a[s]=e[r];n.setSegmentIndex(Hn.parseInt(t.decodeBase900toBase10(a,t.NUMBER_OF_SEQUENCE_CODEWORDS)));var o=new Dn;r=t.textCompaction(e,r,o),n.setFileId(o.toString());var l=-1;for(e[r]===t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(l=r+1);r<e[0];)switch(e[r]){case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(r++,e[r]){case t.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:var c=new Dn;r=t.textCompaction(e,r+1,c),n.setFileName(c.toString());break;case t.MACRO_PDF417_OPTIONAL_FIELD_SENDER:var u=new Dn;r=t.textCompaction(e,r+1,u),n.setSender(u.toString());break;case t.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:var d=new Dn;r=t.textCompaction(e,r+1,d),n.setAddressee(d.toString());break;case t.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:var f=new Dn;r=t.numericCompaction(e,r+1,f),n.setSegmentCount(Hn.parseInt(f.toString()));break;case t.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:var A=new Dn;r=t.numericCompaction(e,r+1,A),n.setTimestamp(xH.parseLong(A.toString()));break;case t.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:var h=new Dn;r=t.numericCompaction(e,r+1,h),n.setChecksum(Hn.parseInt(h.toString()));break;case t.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:var m=new Dn;r=t.numericCompaction(e,r+1,m),n.setFileSize(xH.parseLong(m.toString()));break;default:throw Sr.getFormatInstance()}break;case t.MACRO_PDF417_TERMINATOR:r++,n.setLastSegment(!0);break;default:throw Sr.getFormatInstance()}if(l!==-1){var p=r-l;n.isLastSegment()&&p--,n.setOptionalData(co.copyOfRange(e,l,l+p))}return r},t.textCompaction=function(e,r,n){for(var a=new Int32Array((e[0]-r)*2),s=new Int32Array((e[0]-r)*2),o=0,l=!1;r<e[0]&&!l;){var c=e[r++];if(c<t.TEXT_COMPACTION_MODE_LATCH)a[o]=c/30,a[o+1]=c%30,o+=2;else switch(c){case t.TEXT_COMPACTION_MODE_LATCH:a[o++]=t.TEXT_COMPACTION_MODE_LATCH;break;case t.BYTE_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.NUMERIC_COMPACTION_MODE_LATCH:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:r--,l=!0;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a[o]=t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,c=e[r++],s[o]=c,o++;break}}return t.decodeTextCompaction(a,s,o,n),r},t.decodeTextCompaction=function(e,r,n,a){for(var s=Va.ALPHA,o=Va.ALPHA,l=0;l<n;){var c=e[l],u="";switch(s){case Va.ALPHA:if(c<26)u=String.fromCharCode(65+c);else switch(c){case 26:u=" ";break;case t.LL:s=Va.LOWER;break;case t.ML:s=Va.MIXED;break;case t.PS:o=s,s=Va.PUNCT_SHIFT;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=Va.ALPHA;break}break;case Va.LOWER:if(c<26)u=String.fromCharCode(97+c);else switch(c){case 26:u=" ";break;case t.AS:o=s,s=Va.ALPHA_SHIFT;break;case t.ML:s=Va.MIXED;break;case t.PS:o=s,s=Va.PUNCT_SHIFT;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=Va.ALPHA;break}break;case Va.MIXED:if(c<t.PL)u=t.MIXED_CHARS[c];else switch(c){case t.PL:s=Va.PUNCT;break;case 26:u=" ";break;case t.LL:s=Va.LOWER;break;case t.AL:s=Va.ALPHA;break;case t.PS:o=s,s=Va.PUNCT_SHIFT;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=Va.ALPHA;break}break;case Va.PUNCT:if(c<t.PAL)u=t.PUNCT_CHARS[c];else switch(c){case t.PAL:s=Va.ALPHA;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=Va.ALPHA;break}break;case Va.ALPHA_SHIFT:if(s=o,c<26)u=String.fromCharCode(65+c);else switch(c){case 26:u=" ";break;case t.TEXT_COMPACTION_MODE_LATCH:s=Va.ALPHA;break}break;case Va.PUNCT_SHIFT:if(s=o,c<t.PAL)u=t.PUNCT_CHARS[c];else switch(c){case t.PAL:s=Va.ALPHA;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=Va.ALPHA;break}break}u!==""&&a.append(u),l++}},t.byteCompaction=function(e,r,n,a,s){var o=new _Be,l=0,c=0,u=!1;switch(e){case t.BYTE_COMPACTION_MODE_LATCH:for(var d=new Int32Array(6),f=r[a++];a<r[0]&&!u;)switch(d[l++]=f,c=900*c+f,f=r[a++],f){case t.TEXT_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH:case t.NUMERIC_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:a--,u=!0;break;default:if(l%5===0&&l>0){for(var A=0;A<6;++A)o.write(Number(m0(c)>>m0(8*(5-A))));c=0,l=0}break}a===r[0]&&f<t.TEXT_COMPACTION_MODE_LATCH&&(d[l++]=f);for(var h=0;h<l;h++)o.write(d[h]);break;case t.BYTE_COMPACTION_MODE_LATCH_6:for(;a<r[0]&&!u;){var m=r[a++];if(m<t.TEXT_COMPACTION_MODE_LATCH)l++,c=900*c+m;else switch(m){case t.TEXT_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH:case t.NUMERIC_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:a--,u=!0;break}if(l%5===0&&l>0){for(var A=0;A<6;++A)o.write(Number(m0(c)>>m0(8*(5-A))));c=0,l=0}}break}return s.append(ud.decode(o.toByteArray(),n)),a},t.numericCompaction=function(e,r,n){for(var a=0,s=!1,o=new Int32Array(t.MAX_NUMERIC_CODEWORDS);r<e[0]&&!s;){var l=e[r++];if(r===e[0]&&(s=!0),l<t.TEXT_COMPACTION_MODE_LATCH)o[a]=l,a++;else switch(l){case t.TEXT_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:r--,s=!0;break}(a%t.MAX_NUMERIC_CODEWORDS===0||l===t.NUMERIC_COMPACTION_MODE_LATCH||s)&&a>0&&(n.append(t.decodeBase900toBase10(o,a)),a=0)}return r},t.decodeBase900toBase10=function(e,r){for(var n=m0(0),a=0;a<r;a++)n+=t.EXP900[r-a-1]*m0(e[a]);var s=n.toString();if(s.charAt(0)!=="1")throw new Sr;return s.substring(1)},t.TEXT_COMPACTION_MODE_LATCH=900,t.BYTE_COMPACTION_MODE_LATCH=901,t.NUMERIC_COMPACTION_MODE_LATCH=902,t.BYTE_COMPACTION_MODE_LATCH_6=924,t.ECI_USER_DEFINED=925,t.ECI_GENERAL_PURPOSE=926,t.ECI_CHARSET=927,t.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,t.MACRO_PDF417_TERMINATOR=922,t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,t.MAX_NUMERIC_CODEWORDS=15,t.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,t.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,t.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,t.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,t.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,t.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,t.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,t.PL=25,t.LL=27,t.AS=27,t.ML=28,t.AL=28,t.PS=29,t.PAL=29,t.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,t.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",t.EXP900=ene()?EBe():[],t.NUMBER_OF_SEQUENCE_CODEWORDS=2,t}(),dy=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},IBe=function(){function t(){}return t.decode=function(e,r,n,a,s,o,l){for(var c=new Qk(e,r,n,a,s),u=null,d=null,f,A=!0;;A=!1){if(r!=null&&(u=t.getRowIndicatorColumn(e,c,r,!0,o,l)),a!=null&&(d=t.getRowIndicatorColumn(e,c,a,!1,o,l)),f=t.merge(u,d),f==null)throw Zt.getNotFoundInstance();var h=f.getBoundingBox();if(A&&h!=null&&(h.getMinY()<c.getMinY()||h.getMaxY()>c.getMaxY()))c=h;else break}f.setBoundingBox(c);var m=f.getBarcodeColumnCount()+1;f.setDetectionResultColumn(0,u),f.setDetectionResultColumn(m,d);for(var p=u!=null,g=1;g<=m;g++){var v=p?g:m-g;if(f.getDetectionResultColumn(v)===void 0){var y=void 0;v===0||v===m?y=new gH(c,v===0):y=new Zre(c),f.setDetectionResultColumn(v,y);for(var b=-1,w=b,j=c.getMinY();j<=c.getMaxY();j++){if(b=t.getStartColumn(f,v,j,p),b<0||b>c.getMaxX()){if(w===-1)continue;b=w}var I=t.detectCodeword(e,c.getMinX(),c.getMaxX(),p,b,j,o,l);I!=null&&(y.setCodeword(j,I),w=b,o=Math.min(o,I.getWidth()),l=Math.max(l,I.getWidth()))}}}return t.createDecoderResult(f)},t.merge=function(e,r){if(e==null&&r==null)return null;var n=t.getBarcodeMetadata(e,r);if(n==null)return null;var a=Qk.merge(t.adjustBoundingBox(e),t.adjustBoundingBox(r));return new mBe(n,a)},t.adjustBoundingBox=function(e){var r,n;if(e==null)return null;var a=e.getRowHeights();if(a==null)return null;var s=t.getMax(a),o=0;try{for(var l=dy(a),c=l.next();!c.done;c=l.next()){var u=c.value;if(o+=s-u,u>0)break}}catch(h){r={error:h}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}for(var d=e.getCodewords(),f=0;o>0&&d[f]==null;f++)o--;for(var A=0,f=a.length-1;f>=0&&(A+=s-a[f],!(a[f]>0));f--);for(var f=d.length-1;A>0&&d[f]==null;f--)A--;return e.getBoundingBox().addMissingRows(o,A,e.isLeft())},t.getMax=function(e){var r,n,a=-1;try{for(var s=dy(e),o=s.next();!o.done;o=s.next()){var l=o.value;a=Math.max(a,l)}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a},t.getBarcodeMetadata=function(e,r){var n;if(e==null||(n=e.getBarcodeMetadata())==null)return r==null?null:r.getBarcodeMetadata();var a;return r==null||(a=r.getBarcodeMetadata())==null?n:n.getColumnCount()!==a.getColumnCount()&&n.getErrorCorrectionLevel()!==a.getErrorCorrectionLevel()&&n.getRowCount()!==a.getRowCount()?null:n},t.getRowIndicatorColumn=function(e,r,n,a,s,o){for(var l=new gH(r,a),c=0;c<2;c++)for(var u=c===0?1:-1,d=Math.trunc(Math.trunc(n.getX())),f=Math.trunc(Math.trunc(n.getY()));f<=r.getMaxY()&&f>=r.getMinY();f+=u){var A=t.detectCodeword(e,0,e.getWidth(),a,d,f,s,o);A!=null&&(l.setCodeword(f,A),a?d=A.getStartX():d=A.getEndX())}return l},t.adjustCodewordCount=function(e,r){var n=r[0][1],a=n.getValue(),s=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-t.getNumberOfECCodeWords(e.getBarcodeECLevel());if(a.length===0){if(s<1||s>aa.MAX_CODEWORDS_IN_BARCODE)throw Zt.getNotFoundInstance();n.setValue(s)}else a[0]!==s&&n.setValue(s)},t.createDecoderResult=function(e){var r=t.createBarcodeMatrix(e);t.adjustCodewordCount(e,r);for(var n=new Array,a=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),s=[],o=new Array,l=0;l<e.getBarcodeRowCount();l++)for(var c=0;c<e.getBarcodeColumnCount();c++){var u=r[l][c+1].getValue(),d=l*e.getBarcodeColumnCount()+c;u.length===0?n.push(d):u.length===1?a[d]=u[0]:(o.push(d),s.push(u))}for(var f=new Array(s.length),A=0;A<f.length;A++)f[A]=s[A];return t.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),a,aa.toIntArray(n),aa.toIntArray(o),f)},t.createDecoderResultFromAmbiguousValues=function(e,r,n,a,s){for(var o=new Int32Array(a.length),l=100;l-- >0;){for(var c=0;c<o.length;c++)r[a[c]]=s[c][o[c]];try{return t.decodeCodewords(r,e,n)}catch(d){var u=d instanceof Vi;if(!u)throw d}if(o.length===0)throw Vi.getChecksumInstance();for(var c=0;c<o.length;c++)if(o[c]<s[c].length-1){o[c]++;break}else if(o[c]=0,c===o.length-1)throw Vi.getChecksumInstance()}throw Vi.getChecksumInstance()},t.createBarcodeMatrix=function(e){for(var r,n,a,s,o=Array.from({length:e.getBarcodeRowCount()},function(){return new Array(e.getBarcodeColumnCount()+2)}),l=0;l<o.length;l++)for(var c=0;c<o[l].length;c++)o[l][c]=new Qy;var u=0;try{for(var d=dy(e.getDetectionResultColumns()),f=d.next();!f.done;f=d.next()){var A=f.value;if(A!=null)try{for(var h=(a=void 0,dy(A.getCodewords())),m=h.next();!m.done;m=h.next()){var p=m.value;if(p!=null){var g=p.getRowNumber();if(g>=0){if(g>=o.length)continue;o[g][u].setValue(p.getValue())}}}}catch(v){a={error:v}}finally{try{m&&!m.done&&(s=h.return)&&s.call(h)}finally{if(a)throw a.error}}u++}}catch(v){r={error:v}}finally{try{f&&!f.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}return o},t.isValidBarcodeColumn=function(e,r){return r>=0&&r<=e.getBarcodeColumnCount()+1},t.getStartColumn=function(e,r,n,a){var s,o,l=a?1:-1,c=null;if(t.isValidBarcodeColumn(e,r-l)&&(c=e.getDetectionResultColumn(r-l).getCodeword(n)),c!=null)return a?c.getEndX():c.getStartX();if(c=e.getDetectionResultColumn(r).getCodewordNearby(n),c!=null)return a?c.getStartX():c.getEndX();if(t.isValidBarcodeColumn(e,r-l)&&(c=e.getDetectionResultColumn(r-l).getCodewordNearby(n)),c!=null)return a?c.getEndX():c.getStartX();for(var u=0;t.isValidBarcodeColumn(e,r-l);){r-=l;try{for(var d=(s=void 0,dy(e.getDetectionResultColumn(r).getCodewords())),f=d.next();!f.done;f=d.next()){var A=f.value;if(A!=null)return(a?A.getEndX():A.getStartX())+l*u*(A.getEndX()-A.getStartX())}}catch(h){s={error:h}}finally{try{f&&!f.done&&(o=d.return)&&o.call(d)}finally{if(s)throw s.error}}u++}return a?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()},t.detectCodeword=function(e,r,n,a,s,o,l,c){s=t.adjustCodewordStartColumn(e,r,n,a,s,o);var u=t.getModuleBitCount(e,r,n,a,s,o);if(u==null)return null;var d,f=da.sum(u);if(a)d=s+f;else{for(var A=0;A<u.length/2;A++){var h=u[A];u[A]=u[u.length-1-A],u[u.length-1-A]=h}d=s,s=d-f}if(!t.checkCodewordSkew(f,l,c))return null;var m=gBe.getDecodedValue(u),p=aa.getCodeword(m);return p===-1?null:new pBe(s,d,t.getCodewordBucketNumber(m),p)},t.getModuleBitCount=function(e,r,n,a,s,o){for(var l=s,c=new Int32Array(8),u=0,d=a?1:-1,f=a;(a?l<n:l>=r)&&u<c.length;)e.get(l,o)===f?(c[u]++,l+=d):(u++,f=!f);return u===c.length||l===(a?n:r)&&u===c.length-1?c:null},t.getNumberOfECCodeWords=function(e){return 2<<e},t.adjustCodewordStartColumn=function(e,r,n,a,s,o){for(var l=s,c=a?-1:1,u=0;u<2;u++){for(;(a?l>=r:l<n)&&a===e.get(l,o);){if(Math.abs(s-l)>t.CODEWORD_SKEW_SIZE)return s;l+=c}c=-c,a=!a}return l},t.checkCodewordSkew=function(e,r,n){return r-t.CODEWORD_SKEW_SIZE<=e&&e<=n+t.CODEWORD_SKEW_SIZE},t.decodeCodewords=function(e,r,n){if(e.length===0)throw Sr.getFormatInstance();var a=1<<r+1,s=t.correctErrors(e,n,a);t.verifyCodewordCount(e,a);var o=SBe.decode(e,""+r);return o.setErrorsCorrected(s),o.setErasures(n.length),o},t.correctErrors=function(e,r,n){if(r!=null&&r.length>n/2+t.MAX_ERRORS||n<0||n>t.MAX_EC_CODEWORDS)throw Vi.getChecksumInstance();return t.errorCorrection.decode(e,n,r)},t.verifyCodewordCount=function(e,r){if(e.length<4)throw Sr.getFormatInstance();var n=e[0];if(n>e.length)throw Sr.getFormatInstance();if(n===0)if(r<e.length)e[0]=e.length-r;else throw Sr.getFormatInstance()},t.getBitCountForCodeword=function(e){for(var r=new Int32Array(8),n=0,a=r.length-1;!((e&1)!==n&&(n=e&1,a--,a<0));)r[a]++,e>>=1;return r},t.getCodewordBucketNumber=function(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)},t.getCodewordBucketNumber_number=function(e){return t.getCodewordBucketNumber(t.getBitCountForCodeword(e))},t.getCodewordBucketNumber_Int32Array=function(e){return(e[0]-e[2]+e[4]-e[6]+9)%9},t.toString=function(e){for(var r=new O6,n=0;n<e.length;n++){r.format("Row %2d: ",n);for(var a=0;a<e[n].length;a++){var s=e[n][a];s.getValue().length===0?r.format("        ",null):r.format("%4d(%2d)",s.getValue()[0],s.getConfidence(s.getValue()[0]))}r.format("%n")}return r.toString()},t.CODEWORD_SKEW_SIZE=2,t.MAX_ERRORS=3,t.MAX_EC_CODEWORDS=512,t.errorCorrection=new lBe,t}(),jBe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},TS=function(){function t(){}return t.prototype.decode=function(e,r){r===void 0&&(r=null);var n=t.decode(e,r,!1);if(n==null||n.length===0||n[0]==null)throw Zt.getNotFoundInstance();return n[0]},t.prototype.decodeMultiple=function(e,r){r===void 0&&(r=null);try{return t.decode(e,r,!0)}catch(n){throw n instanceof Sr||n instanceof Vi?Zt.getNotFoundInstance():n}},t.decode=function(e,r,n){var a,s,o=new Array,l=rBe.detectMultiple(e,r,n);try{for(var c=jBe(l.getPoints()),u=c.next();!u.done;u=c.next()){var d=u.value,f=IBe.decode(l.getBits(),d[4],d[5],d[6],d[7],t.getMinCodewordWidth(d),t.getMaxCodewordWidth(d)),A=new Vl(f.getText(),f.getRawBytes(),void 0,d,ln.PDF_417);A.putMetadata(ul.ERROR_CORRECTION_LEVEL,f.getECLevel());var h=f.getOther();h!=null&&A.putMetadata(ul.PDF417_EXTRA_METADATA,h),o.push(A)}}catch(m){a={error:m}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(a)throw a.error}}return o.map(function(m){return m})},t.getMaxWidth=function(e,r){return e==null||r==null?0:Math.trunc(Math.abs(e.getX()-r.getX()))},t.getMinWidth=function(e,r){return e==null||r==null?Hn.MAX_VALUE:Math.trunc(Math.abs(e.getX()-r.getX()))},t.getMaxCodewordWidth=function(e){return Math.floor(Math.max(Math.max(t.getMaxWidth(e[0],e[4]),t.getMaxWidth(e[6],e[2])*aa.MODULES_IN_CODEWORD/aa.MODULES_IN_STOP_PATTERN),Math.max(t.getMaxWidth(e[1],e[5]),t.getMaxWidth(e[7],e[3])*aa.MODULES_IN_CODEWORD/aa.MODULES_IN_STOP_PATTERN)))},t.getMinCodewordWidth=function(e){return Math.floor(Math.min(Math.min(t.getMinWidth(e[0],e[4]),t.getMinWidth(e[6],e[2])*aa.MODULES_IN_CODEWORD/aa.MODULES_IN_STOP_PATTERN),Math.min(t.getMinWidth(e[1],e[5]),t.getMinWidth(e[7],e[3])*aa.MODULES_IN_CODEWORD/aa.MODULES_IN_STOP_PATTERN)))},t.prototype.reset=function(){},t}(),PBe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),vH=function(t){PBe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ReaderException",e}(Qc),yH=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},tne=function(){function t(){}return t.prototype.decode=function(e,r){return this.setHints(r),this.decodeInternal(e)},t.prototype.decodeWithState=function(e){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(e)},t.prototype.setHints=function(e){this.hints=e;var r=e!=null&&e.get(is.TRY_HARDER)!==void 0,n=e==null?null:e.get(is.POSSIBLE_FORMATS),a=new Array;if(n!=null){var s=n.some(function(o){return o===ln.UPC_A||o===ln.UPC_E||o===ln.EAN_13||o===ln.EAN_8||o===ln.CODABAR||o===ln.CODE_39||o===ln.CODE_93||o===ln.CODE_128||o===ln.ITF||o===ln.RSS_14||o===ln.RSS_EXPANDED});s&&!r&&a.push(new Hx(e)),n.includes(ln.QR_CODE)&&a.push(new BS),n.includes(ln.DATA_MATRIX)&&a.push(new PS),n.includes(ln.AZTEC)&&a.push(new IS),n.includes(ln.PDF_417)&&a.push(new TS),s&&r&&a.push(new Hx(e))}a.length===0&&(r||a.push(new Hx(e)),a.push(new BS),a.push(new PS),a.push(new IS),a.push(new TS),r&&a.push(new Hx(e))),this.readers=a},t.prototype.reset=function(){var e,r;if(this.readers!==null)try{for(var n=yH(this.readers),a=n.next();!a.done;a=n.next()){var s=a.value;s.reset()}}catch(o){e={error:o}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.decodeInternal=function(e){var r,n;if(this.readers===null)throw new vH("No readers where selected, nothing can be read.");try{for(var a=yH(this.readers),s=a.next();!s.done;s=a.next()){var o=s.value;try{return o.decode(e,this.hints)}catch(l){if(l instanceof vH)continue}}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}throw new Zt("No MultiFormat Readers were able to detect the code.")},t}(),BBe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){BBe(e,t);function e(r,n){r===void 0&&(r=null),n===void 0&&(n=500);var a=this,s=new tne;return s.setHints(r),a=t.call(this,s,n)||this,a}return e.prototype.decodeBitmap=function(r){return this.reader.decodeWithState(r)},e})(u1);var TBe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){TBe(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new TS,r)||this}return e})(u1);var kBe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){kBe(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new BS,r)||this}return e})(u1);var Vk;(function(t){t[t.ERROR_CORRECTION=0]="ERROR_CORRECTION",t[t.CHARACTER_SET=1]="CHARACTER_SET",t[t.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",t[t.DATA_MATRIX_COMPACT=3]="DATA_MATRIX_COMPACT",t[t.MIN_SIZE=4]="MIN_SIZE",t[t.MAX_SIZE=5]="MAX_SIZE",t[t.MARGIN=6]="MARGIN",t[t.PDF417_COMPACT=7]="PDF417_COMPACT",t[t.PDF417_COMPACTION=8]="PDF417_COMPACTION",t[t.PDF417_DIMENSIONS=9]="PDF417_DIMENSIONS",t[t.AZTEC_LAYERS=10]="AZTEC_LAYERS",t[t.QR_VERSION=11]="QR_VERSION",t[t.GS1_FORMAT=12]="GS1_FORMAT",t[t.FORCE_C40=13]="FORCE_C40"})(Vk||(Vk={}));const QC=Vk;var rne=function(){function t(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new Z0(e,Int32Array.from([1])))}return t.prototype.buildGenerator=function(e){var r=this.cachedGenerators;if(e>=r.length)for(var n=r[r.length-1],a=this.field,s=r.length;s<=e;s++){var o=n.multiply(new Z0(a,Int32Array.from([1,a.exp(s-1+a.getGeneratorBase())])));r.push(o),n=o}return r[e]},t.prototype.encode=function(e,r){if(r===0)throw new cn("No error correction bytes");var n=e.length-r;if(n<=0)throw new cn("No data bytes provided");var a=this.buildGenerator(r),s=new Int32Array(n);ss.arraycopy(e,0,s,0,n);var o=new Z0(this.field,s);o=o.multiplyByMonomial(r,1);for(var l=o.divide(a)[1],c=l.getCoefficients(),u=r-c.length,d=0;d<u;d++)e[n+d]=0;ss.arraycopy(c,0,e,n+u,c.length)},t}(),Vy=function(){function t(){}return t.applyMaskPenaltyRule1=function(e){return t.applyMaskPenaltyRule1Internal(e,!0)+t.applyMaskPenaltyRule1Internal(e,!1)},t.applyMaskPenaltyRule2=function(e){for(var r=0,n=e.getArray(),a=e.getWidth(),s=e.getHeight(),o=0;o<s-1;o++)for(var l=n[o],c=0;c<a-1;c++){var u=l[c];u===l[c+1]&&u===n[o+1][c]&&u===n[o+1][c+1]&&r++}return t.N2*r},t.applyMaskPenaltyRule3=function(e){for(var r=0,n=e.getArray(),a=e.getWidth(),s=e.getHeight(),o=0;o<s;o++)for(var l=0;l<a;l++){var c=n[o];l+6<a&&c[l]===1&&c[l+1]===0&&c[l+2]===1&&c[l+3]===1&&c[l+4]===1&&c[l+5]===0&&c[l+6]===1&&(t.isWhiteHorizontal(c,l-4,l)||t.isWhiteHorizontal(c,l+7,l+11))&&r++,o+6<s&&n[o][l]===1&&n[o+1][l]===0&&n[o+2][l]===1&&n[o+3][l]===1&&n[o+4][l]===1&&n[o+5][l]===0&&n[o+6][l]===1&&(t.isWhiteVertical(n,l,o-4,o)||t.isWhiteVertical(n,l,o+7,o+11))&&r++}return r*t.N3},t.isWhiteHorizontal=function(e,r,n){r=Math.max(r,0),n=Math.min(n,e.length);for(var a=r;a<n;a++)if(e[a]===1)return!1;return!0},t.isWhiteVertical=function(e,r,n,a){n=Math.max(n,0),a=Math.min(a,e.length);for(var s=n;s<a;s++)if(e[s][r]===1)return!1;return!0},t.applyMaskPenaltyRule4=function(e){for(var r=0,n=e.getArray(),a=e.getWidth(),s=e.getHeight(),o=0;o<s;o++)for(var l=n[o],c=0;c<a;c++)l[c]===1&&r++;var u=e.getHeight()*e.getWidth(),d=Math.floor(Math.abs(r*2-u)*10/u);return d*t.N4},t.getDataMaskBit=function(e,r,n){var a,s;switch(e){case 0:a=n+r&1;break;case 1:a=n&1;break;case 2:a=r%3;break;case 3:a=(n+r)%3;break;case 4:a=Math.floor(n/2)+Math.floor(r/3)&1;break;case 5:s=n*r,a=(s&1)+s%3;break;case 6:s=n*r,a=(s&1)+s%3&1;break;case 7:s=n*r,a=s%3+(n+r&1)&1;break;default:throw new cn("Invalid mask pattern: "+e)}return a===0},t.applyMaskPenaltyRule1Internal=function(e,r){for(var n=0,a=r?e.getHeight():e.getWidth(),s=r?e.getWidth():e.getHeight(),o=e.getArray(),l=0;l<a;l++){for(var c=0,u=-1,d=0;d<s;d++){var f=r?o[l][d]:o[d][l];f===u?c++:(c>=5&&(n+=t.N1+(c-5)),c=1,u=f)}c>=5&&(n+=t.N1+(c-5))}return n},t.N1=3,t.N2=3,t.N3=40,t.N4=10,t}(),FBe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},OBe=function(){function t(e,r){this.width=e,this.height=r;for(var n=new Array(r),a=0;a!==r;a++)n[a]=new Uint8Array(e);this.bytes=n}return t.prototype.getHeight=function(){return this.height},t.prototype.getWidth=function(){return this.width},t.prototype.get=function(e,r){return this.bytes[r][e]},t.prototype.getArray=function(){return this.bytes},t.prototype.setNumber=function(e,r,n){this.bytes[r][e]=n},t.prototype.setBoolean=function(e,r,n){this.bytes[r][e]=n?1:0},t.prototype.clear=function(e){var r,n;try{for(var a=FBe(this.bytes),s=a.next();!s.done;s=a.next()){var o=s.value;co.fill(o,e)}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;if(this.width!==r.width||this.height!==r.height)return!1;for(var n=0,a=this.height;n<a;++n)for(var s=this.bytes[n],o=r.bytes[n],l=0,c=this.width;l<c;++l)if(s[l]!==o[l])return!1;return!0},t.prototype.toString=function(){for(var e=new Dn,r=0,n=this.height;r<n;++r){for(var a=this.bytes[r],s=0,o=this.width;s<o;++s)switch(a[s]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ");break}e.append(`
`)}return e.toString()},t}(),Hk=function(){function t(){this.maskPattern=-1}return t.prototype.getMode=function(){return this.mode},t.prototype.getECLevel=function(){return this.ecLevel},t.prototype.getVersion=function(){return this.version},t.prototype.getMaskPattern=function(){return this.maskPattern},t.prototype.getMatrix=function(){return this.matrix},t.prototype.toString=function(){var e=new Dn;return e.append(`<<
`),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append(`
 ecLevel: `),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append(`
 version: `),e.append(this.version?this.version.toString():"null"),e.append(`
 maskPattern: `),e.append(this.maskPattern.toString()),this.matrix?(e.append(`
 matrix:
`),e.append(this.matrix.toString())):e.append(`
 matrix: null
`),e.append(`>>
`),e.toString()},t.prototype.setMode=function(e){this.mode=e},t.prototype.setECLevel=function(e){this.ecLevel=e},t.prototype.setVersion=function(e){this.version=e},t.prototype.setMaskPattern=function(e){this.maskPattern=e},t.prototype.setMatrix=function(e){this.matrix=e},t.isValidMaskPattern=function(e){return e>=0&&e<t.NUM_MASK_PATTERNS},t.NUM_MASK_PATTERNS=8,t}(),DBe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),us=function(t){DBe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="WriterException",e}(Qc),bH=function(){function t(){}return t.clearMatrix=function(e){e.clear(255)},t.buildMatrix=function(e,r,n,a,s){t.clearMatrix(s),t.embedBasicPatterns(n,s),t.embedTypeInfo(r,a,s),t.maybeEmbedVersionInfo(n,s),t.embedDataBits(e,a,s)},t.embedBasicPatterns=function(e,r){t.embedPositionDetectionPatternsAndSeparators(r),t.embedDarkDotAtLeftBottomCorner(r),t.maybeEmbedPositionAdjustmentPatterns(e,r),t.embedTimingPatterns(r)},t.embedTypeInfo=function(e,r,n){var a=new Oo;t.makeTypeInfoBits(e,r,a);for(var s=0,o=a.getSize();s<o;++s){var l=a.get(a.getSize()-1-s),c=t.TYPE_INFO_COORDINATES[s],u=c[0],d=c[1];if(n.setBoolean(u,d,l),s<8){var f=n.getWidth()-s-1,A=8;n.setBoolean(f,A,l)}else{var f=8,A=n.getHeight()-7+(s-8);n.setBoolean(f,A,l)}}},t.maybeEmbedVersionInfo=function(e,r){if(!(e.getVersionNumber()<7)){var n=new Oo;t.makeVersionInfoBits(e,n);for(var a=6*3-1,s=0;s<6;++s)for(var o=0;o<3;++o){var l=n.get(a);a--,r.setBoolean(s,r.getHeight()-11+o,l),r.setBoolean(r.getHeight()-11+o,s,l)}}},t.embedDataBits=function(e,r,n){for(var a=0,s=-1,o=n.getWidth()-1,l=n.getHeight()-1;o>0;){for(o===6&&(o-=1);l>=0&&l<n.getHeight();){for(var c=0;c<2;++c){var u=o-c;if(t.isEmpty(n.get(u,l))){var d=void 0;a<e.getSize()?(d=e.get(a),++a):d=!1,r!==255&&Vy.getDataMaskBit(r,u,l)&&(d=!d),n.setBoolean(u,l,d)}}l+=s}s=-s,l+=s,o-=2}if(a!==e.getSize())throw new us("Not all bits consumed: "+a+"/"+e.getSize())},t.findMSBSet=function(e){return 32-Hn.numberOfLeadingZeros(e)},t.calculateBCHCode=function(e,r){if(r===0)throw new cn("0 polynomial");var n=t.findMSBSet(r);for(e<<=n-1;t.findMSBSet(e)>=n;)e^=r<<t.findMSBSet(e)-n;return e},t.makeTypeInfoBits=function(e,r,n){if(!Hk.isValidMaskPattern(r))throw new us("Invalid mask pattern");var a=e.getBits()<<3|r;n.appendBits(a,5);var s=t.calculateBCHCode(a,t.TYPE_INFO_POLY);n.appendBits(s,10);var o=new Oo;if(o.appendBits(t.TYPE_INFO_MASK_PATTERN,15),n.xor(o),n.getSize()!==15)throw new us("should not happen but we got: "+n.getSize())},t.makeVersionInfoBits=function(e,r){r.appendBits(e.getVersionNumber(),6);var n=t.calculateBCHCode(e.getVersionNumber(),t.VERSION_INFO_POLY);if(r.appendBits(n,12),r.getSize()!==18)throw new us("should not happen but we got: "+r.getSize())},t.isEmpty=function(e){return e===255},t.embedTimingPatterns=function(e){for(var r=8;r<e.getWidth()-8;++r){var n=(r+1)%2;t.isEmpty(e.get(r,6))&&e.setNumber(r,6,n),t.isEmpty(e.get(6,r))&&e.setNumber(6,r,n)}},t.embedDarkDotAtLeftBottomCorner=function(e){if(e.get(8,e.getHeight()-8)===0)throw new us;e.setNumber(8,e.getHeight()-8,1)},t.embedHorizontalSeparationPattern=function(e,r,n){for(var a=0;a<8;++a){if(!t.isEmpty(n.get(e+a,r)))throw new us;n.setNumber(e+a,r,0)}},t.embedVerticalSeparationPattern=function(e,r,n){for(var a=0;a<7;++a){if(!t.isEmpty(n.get(e,r+a)))throw new us;n.setNumber(e,r+a,0)}},t.embedPositionAdjustmentPattern=function(e,r,n){for(var a=0;a<5;++a)for(var s=t.POSITION_ADJUSTMENT_PATTERN[a],o=0;o<5;++o)n.setNumber(e+o,r+a,s[o])},t.embedPositionDetectionPattern=function(e,r,n){for(var a=0;a<7;++a)for(var s=t.POSITION_DETECTION_PATTERN[a],o=0;o<7;++o)n.setNumber(e+o,r+a,s[o])},t.embedPositionDetectionPatternsAndSeparators=function(e){var r=t.POSITION_DETECTION_PATTERN[0].length;t.embedPositionDetectionPattern(0,0,e),t.embedPositionDetectionPattern(e.getWidth()-r,0,e),t.embedPositionDetectionPattern(0,e.getWidth()-r,e);var n=8;t.embedHorizontalSeparationPattern(0,n-1,e),t.embedHorizontalSeparationPattern(e.getWidth()-n,n-1,e),t.embedHorizontalSeparationPattern(0,e.getWidth()-n,e);var a=7;t.embedVerticalSeparationPattern(a,0,e),t.embedVerticalSeparationPattern(e.getHeight()-a-1,0,e),t.embedVerticalSeparationPattern(a,e.getHeight()-a,e)},t.maybeEmbedPositionAdjustmentPatterns=function(e,r){if(!(e.getVersionNumber()<2))for(var n=e.getVersionNumber()-1,a=t.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[n],s=0,o=a.length;s!==o;s++){var l=a[s];if(l>=0)for(var c=0;c!==o;c++){var u=a[c];u>=0&&t.isEmpty(r.get(u,l))&&t.embedPositionAdjustmentPattern(u-2,l-2,r)}}},t.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),t.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),t.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),t.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),t.VERSION_INFO_POLY=7973,t.TYPE_INFO_POLY=1335,t.TYPE_INFO_MASK_PATTERN=21522,t}(),RBe=function(){function t(e,r){this.dataBytes=e,this.errorCorrectionBytes=r}return t.prototype.getDataBytes=function(){return this.dataBytes},t.prototype.getErrorCorrectionBytes=function(){return this.errorCorrectionBytes},t}(),wH=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function t(){}return t.calculateMaskPenalty=function(e){return Vy.applyMaskPenaltyRule1(e)+Vy.applyMaskPenaltyRule2(e)+Vy.applyMaskPenaltyRule3(e)+Vy.applyMaskPenaltyRule4(e)},t.encode=function(e,r,n){n===void 0&&(n=null);var a=t.DEFAULT_BYTE_MODE_ENCODING,s=n!==null&&n.get(QC.CHARACTER_SET)!==void 0;s&&(a=n.get(QC.CHARACTER_SET).toString());var o=this.chooseMode(e,a),l=new Oo;if(o===ds.BYTE&&(s||t.DEFAULT_BYTE_MODE_ENCODING!==a)){var c=lo.getCharacterSetECIByName(a);c!==void 0&&this.appendECI(c,l)}this.appendModeInfo(o,l);var u=new Oo;this.appendBytes(e,o,u,a);var d;if(n!==null&&n.get(QC.QR_VERSION)!==void 0){var f=Number.parseInt(n.get(QC.QR_VERSION).toString(),10);d=Pp.getVersionForNumber(f);var A=this.calculateBitsNeeded(o,l,u,d);if(!this.willFit(A,d,r))throw new us("Data too big for requested version")}else d=this.recommendVersion(r,o,l,u);var h=new Oo;h.appendBitArray(l);var m=o===ds.BYTE?u.getSizeInBytes():e.length;this.appendLengthInfo(m,d,o,h),h.appendBitArray(u);var p=d.getECBlocksForLevel(r),g=d.getTotalCodewords()-p.getTotalECCodewords();this.terminateBits(g,h);var v=this.interleaveWithECBytes(h,d.getTotalCodewords(),g,p.getNumBlocks()),y=new Hk;y.setECLevel(r),y.setMode(o),y.setVersion(d);var b=d.getDimensionForVersion(),w=new OBe(b,b),j=this.chooseMaskPattern(v,r,d,w);return y.setMaskPattern(j),bH.buildMatrix(v,r,d,j,w),y.setMatrix(w),y},t.recommendVersion=function(e,r,n,a){var s=this.calculateBitsNeeded(r,n,a,Pp.getVersionForNumber(1)),o=this.chooseVersion(s,e),l=this.calculateBitsNeeded(r,n,a,o);return this.chooseVersion(l,e)},t.calculateBitsNeeded=function(e,r,n,a){return r.getSize()+e.getCharacterCountBits(a)+n.getSize()},t.getAlphanumericCode=function(e){return e<t.ALPHANUMERIC_TABLE.length?t.ALPHANUMERIC_TABLE[e]:-1},t.chooseMode=function(e,r){if(r===void 0&&(r=null),lo.SJIS.getName()===r&&this.isOnlyDoubleByteKanji(e))return ds.KANJI;for(var n=!1,a=!1,s=0,o=e.length;s<o;++s){var l=e.charAt(s);if(t.isDigit(l))n=!0;else if(this.getAlphanumericCode(l.charCodeAt(0))!==-1)a=!0;else return ds.BYTE}return a?ds.ALPHANUMERIC:n?ds.NUMERIC:ds.BYTE},t.isOnlyDoubleByteKanji=function(e){var r;try{r=ud.encode(e,lo.SJIS)}catch{return!1}var n=r.length;if(n%2!==0)return!1;for(var a=0;a<n;a+=2){var s=r[a]&255;if((s<129||s>159)&&(s<224||s>235))return!1}return!0},t.chooseMaskPattern=function(e,r,n,a){for(var s=Number.MAX_SAFE_INTEGER,o=-1,l=0;l<Hk.NUM_MASK_PATTERNS;l++){bH.buildMatrix(e,r,n,l,a);var c=this.calculateMaskPenalty(a);c<s&&(s=c,o=l)}return o},t.chooseVersion=function(e,r){for(var n=1;n<=40;n++){var a=Pp.getVersionForNumber(n);if(t.willFit(e,a,r))return a}throw new us("Data too big")},t.willFit=function(e,r,n){var a=r.getTotalCodewords(),s=r.getECBlocksForLevel(n),o=s.getTotalECCodewords(),l=a-o,c=(e+7)/8;return l>=c},t.terminateBits=function(e,r){var n=e*8;if(r.getSize()>n)throw new us("data bits cannot fit in the QR Code"+r.getSize()+" > "+n);for(var a=0;a<4&&r.getSize()<n;++a)r.appendBit(!1);var s=r.getSize()&7;if(s>0)for(var a=s;a<8;a++)r.appendBit(!1);for(var o=e-r.getSizeInBytes(),a=0;a<o;++a)r.appendBits(a&1?17:236,8);if(r.getSize()!==n)throw new us("Bits size does not equal capacity")},t.getNumDataBytesAndNumECBytesForBlockID=function(e,r,n,a,s,o){if(a>=n)throw new us("Block ID too large");var l=e%n,c=n-l,u=Math.floor(e/n),d=u+1,f=Math.floor(r/n),A=f+1,h=u-f,m=d-A;if(h!==m)throw new us("EC bytes mismatch");if(n!==c+l)throw new us("RS blocks mismatch");if(e!==(f+h)*c+(A+m)*l)throw new us("Total bytes mismatch");a<c?(s[0]=f,o[0]=h):(s[0]=A,o[0]=m)},t.interleaveWithECBytes=function(e,r,n,a){var s,o,l,c;if(e.getSizeInBytes()!==n)throw new us("Number of bits and data bytes does not match");for(var u=0,d=0,f=0,A=new Array,h=0;h<a;++h){var m=new Int32Array(1),p=new Int32Array(1);t.getNumDataBytesAndNumECBytesForBlockID(r,n,a,h,m,p);var g=m[0],v=new Uint8Array(g);e.toBytes(8*u,v,0,g);var y=t.generateECBytes(v,p[0]);A.push(new RBe(v,y)),d=Math.max(d,g),f=Math.max(f,y.length),u+=m[0]}if(n!==u)throw new us("Data bytes does not match offset");for(var b=new Oo,h=0;h<d;++h)try{for(var w=(s=void 0,wH(A)),j=w.next();!j.done;j=w.next()){var I=j.value,v=I.getDataBytes();h<v.length&&b.appendBits(v[h],8)}}catch(F){s={error:F}}finally{try{j&&!j.done&&(o=w.return)&&o.call(w)}finally{if(s)throw s.error}}for(var h=0;h<f;++h)try{for(var _=(l=void 0,wH(A)),S=_.next();!S.done;S=_.next()){var I=S.value,y=I.getErrorCorrectionBytes();h<y.length&&b.appendBits(y[h],8)}}catch(F){l={error:F}}finally{try{S&&!S.done&&(c=_.return)&&c.call(_)}finally{if(l)throw l.error}}if(r!==b.getSizeInBytes())throw new us("Interleaving error: "+r+" and "+b.getSizeInBytes()+" differ.");return b},t.generateECBytes=function(e,r){for(var n=e.length,a=new Int32Array(n+r),s=0;s<n;s++)a[s]=e[s]&255;new rne(Bc.QR_CODE_FIELD_256).encode(a,r);for(var o=new Uint8Array(r),s=0;s<r;s++)o[s]=a[n+s];return o},t.appendModeInfo=function(e,r){r.appendBits(e.getBits(),4)},t.appendLengthInfo=function(e,r,n,a){var s=n.getCharacterCountBits(r);if(e>=1<<s)throw new us(e+" is bigger than "+((1<<s)-1));a.appendBits(e,s)},t.appendBytes=function(e,r,n,a){switch(r){case ds.NUMERIC:t.appendNumericBytes(e,n);break;case ds.ALPHANUMERIC:t.appendAlphanumericBytes(e,n);break;case ds.BYTE:t.append8BitBytes(e,n,a);break;case ds.KANJI:t.appendKanjiBytes(e,n);break;default:throw new us("Invalid mode: "+r)}},t.getDigit=function(e){return e.charCodeAt(0)-48},t.isDigit=function(e){var r=t.getDigit(e);return r>=0&&r<=9},t.appendNumericBytes=function(e,r){for(var n=e.length,a=0;a<n;){var s=t.getDigit(e.charAt(a));if(a+2<n){var o=t.getDigit(e.charAt(a+1)),l=t.getDigit(e.charAt(a+2));r.appendBits(s*100+o*10+l,10),a+=3}else if(a+1<n){var o=t.getDigit(e.charAt(a+1));r.appendBits(s*10+o,7),a+=2}else r.appendBits(s,4),a++}},t.appendAlphanumericBytes=function(e,r){for(var n=e.length,a=0;a<n;){var s=t.getAlphanumericCode(e.charCodeAt(a));if(s===-1)throw new us;if(a+1<n){var o=t.getAlphanumericCode(e.charCodeAt(a+1));if(o===-1)throw new us;r.appendBits(s*45+o,11),a+=2}else r.appendBits(s,6),a++}},t.append8BitBytes=function(e,r,n){var a;try{a=ud.encode(e,n)}catch(c){throw new us(c)}for(var s=0,o=a.length;s!==o;s++){var l=a[s];r.appendBits(l,8)}},t.appendKanjiBytes=function(e,r){var n;try{n=ud.encode(e,lo.SJIS)}catch(f){throw new us(f)}for(var a=n.length,s=0;s<a;s+=2){var o=n[s]&255,l=n[s+1]&255,c=o<<8&4294967295|l,u=-1;if(c>=33088&&c<=40956?u=c-33088:c>=57408&&c<=60351&&(u=c-49472),u===-1)throw new us("Invalid byte sequence");var d=(u>>8)*192+(u&255);r.appendBits(d,13)}},t.appendECI=function(e,r){r.appendBits(ds.ECI.getBits(),4),r.appendBits(e.getValue(),8)},t.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),t.DEFAULT_BYTE_MODE_ENCODING=lo.UTF8.getName(),t})();var MBe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){MBe(e,t);function e(r,n,a,s,o,l,c,u){var d=t.call(this,l,c)||this;if(d.yuvData=r,d.dataWidth=n,d.dataHeight=a,d.left=s,d.top=o,s+l>n||o+c>a)throw new cn("Crop rectangle does not fit within image data.");return u&&d.reverseHorizontal(l,c),d}return e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new cn("Requested row is outside the image: "+r);var a=this.getWidth();(n==null||n.length<a)&&(n=new Uint8ClampedArray(a));var s=(r+this.top)*this.dataWidth+this.left;return ss.arraycopy(this.yuvData,s,n,0,a),n},e.prototype.getMatrix=function(){var r=this.getWidth(),n=this.getHeight();if(r===this.dataWidth&&n===this.dataHeight)return this.yuvData;var a=r*n,s=new Uint8ClampedArray(a),o=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return ss.arraycopy(this.yuvData,o,s,0,a),s;for(var l=0;l<n;l++){var c=l*r;ss.arraycopy(this.yuvData,o,s,c,r),o+=this.dataWidth}return s},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return new e(this.yuvData,this.dataWidth,this.dataHeight,this.left+r,this.top+n,a,s,!1)},e.prototype.renderThumbnail=function(){for(var r=this.getWidth()/e.THUMBNAIL_SCALE_FACTOR,n=this.getHeight()/e.THUMBNAIL_SCALE_FACTOR,a=new Int32Array(r*n),s=this.yuvData,o=this.top*this.dataWidth+this.left,l=0;l<n;l++){for(var c=l*r,u=0;u<r;u++){var d=s[o+u*e.THUMBNAIL_SCALE_FACTOR]&255;a[c+u]=4278190080|d*65793}o+=this.dataWidth*e.THUMBNAIL_SCALE_FACTOR}return a},e.prototype.getThumbnailWidth=function(){return this.getWidth()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.getThumbnailHeight=function(){return this.getHeight()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.reverseHorizontal=function(r,n){for(var a=this.yuvData,s=0,o=this.top*this.dataWidth+this.left;s<n;s++,o+=this.dataWidth)for(var l=o+r/2,c=o,u=o+r-1;c<l;c++,u--){var d=a[c];a[c]=a[u],a[u]=d}},e.prototype.invert=function(){return new zj(this)},e.THUMBNAIL_SCALE_FACTOR=2,e})(Iw);var LBe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){LBe(e,t);function e(r,n,a,s,o,l,c){var u=t.call(this,n,a)||this;if(u.dataWidth=s,u.dataHeight=o,u.left=l,u.top=c,r.BYTES_PER_ELEMENT===4){for(var d=n*a,f=new Uint8ClampedArray(d),A=0;A<d;A++){var h=r[A],m=h>>16&255,p=h>>7&510,g=h&255;f[A]=(m+p+g)/4&255}u.luminances=f}else u.luminances=r;if(s===void 0&&(u.dataWidth=n),o===void 0&&(u.dataHeight=a),l===void 0&&(u.left=0),c===void 0&&(u.top=0),u.left+n>u.dataWidth||u.top+a>u.dataHeight)throw new cn("Crop rectangle does not fit within image data.");return u}return e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new cn("Requested row is outside the image: "+r);var a=this.getWidth();(n==null||n.length<a)&&(n=new Uint8ClampedArray(a));var s=(r+this.top)*this.dataWidth+this.left;return ss.arraycopy(this.luminances,s,n,0,a),n},e.prototype.getMatrix=function(){var r=this.getWidth(),n=this.getHeight();if(r===this.dataWidth&&n===this.dataHeight)return this.luminances;var a=r*n,s=new Uint8ClampedArray(a),o=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return ss.arraycopy(this.luminances,o,s,0,a),s;for(var l=0;l<n;l++){var c=l*r;ss.arraycopy(this.luminances,o,s,c,r),o+=this.dataWidth}return s},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return new e(this.luminances,a,s,this.dataWidth,this.dataHeight,this.left+r,this.top+n)},e.prototype.invert=function(){return new zj(this)},e})(Iw);var UBe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),QBe=function(t){UBe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.forName=function(r){return this.getCharacterSetECIByName(r)},e}(lo),VBe=function(){function t(){}return t.ISO_8859_1=lo.ISO8859_1,t}(),$k,HBe=301,$Be=function(t,e){for(var r=1,n=0;n<255;n++)e[n]=r,t[r]=n,r*=2,r>=256&&(r^=HBe);return{LOG:t,ALOG:e}};$k=$Be([],[]),$k.LOG;$k.ALOG;var NH;(function(t){t[t.FORCE_NONE=0]="FORCE_NONE",t[t.FORCE_SQUARE=1]="FORCE_SQUARE",t[t.FORCE_RECTANGLE=2]="FORCE_RECTANGLE"})(NH||(NH={}));var CH=129,nne=230,GBe=231,KBe=235,qBe=236,zBe=237,WBe=238,XBe=239,YBe=240,x5=254,JBe=254,_H="[)>05",EH="[)>06",SH="",Pa=0,Zo=1,ec=2,eo=3,Io=4,Il=5,ZBe=function(){function t(){}return t.prototype.getEncodingMode=function(){return Pa},t.prototype.encode=function(e){var r=Hd.determineConsecutiveDigitCount(e.getMessage(),e.pos);if(r>=2)e.writeCodeword(this.encodeASCIIDigits(e.getMessage().charCodeAt(e.pos),e.getMessage().charCodeAt(e.pos+1))),e.pos+=2;else{var n=e.getCurrentChar(),a=Hd.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(a!==this.getEncodingMode())switch(a){case Il:e.writeCodeword(GBe),e.signalEncoderChange(Il);return;case Zo:e.writeCodeword(nne),e.signalEncoderChange(Zo);return;case eo:e.writeCodeword(WBe),e.signalEncoderChange(eo);break;case ec:e.writeCodeword(XBe),e.signalEncoderChange(ec);break;case Io:e.writeCodeword(YBe),e.signalEncoderChange(Io);break;default:throw new Error("Illegal mode: "+a)}else Hd.isExtendedASCII(n)?(e.writeCodeword(KBe),e.writeCodeword(n-128+1),e.pos++):(e.writeCodeword(n+1),e.pos++)}},t.prototype.encodeASCIIDigits=function(e,r){if(Hd.isDigit(e)&&Hd.isDigit(r)){var n=(e-48)*10+(r-48);return n+130}throw new Error("not digits: "+e+r)},t}(),eTe=function(){function t(){}return t.prototype.getEncodingMode=function(){return Il},t.prototype.encode=function(e){var r=new Dn;for(r.append(0);e.hasMoreCharacters();){var n=e.getCurrentChar();r.append(n),e.pos++;var a=Hd.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(a!==this.getEncodingMode()){e.signalEncoderChange(Pa);break}}var s=r.length()-1,o=1,l=e.getCodewordCount()+s+o;e.updateSymbolInfo(l);var c=e.getSymbolInfo().getDataCapacity()-l>0;if(e.hasMoreCharacters()||c)if(s<=249)r.setCharAt(0,ra.getCharAt(s));else if(s<=1555)r.setCharAt(0,ra.getCharAt(Math.floor(s/250)+249)),r.insert(1,ra.getCharAt(s%250));else throw new Error("Message length not in valid ranges: "+s);for(var u=0,n=r.length();u<n;u++)e.writeCodeword(this.randomize255State(r.charAt(u).charCodeAt(0),e.getCodewordCount()+1))},t.prototype.randomize255State=function(e,r){var n=149*r%255+1,a=e+n;return a<=255?a:a-256},t}(),D6=function(){function t(){}return t.prototype.getEncodingMode=function(){return Zo},t.prototype.encodeMaximal=function(e){for(var r=new Dn,n=0,a=e.pos,s=0;e.hasMoreCharacters();){var o=e.getCurrentChar();e.pos++,n=this.encodeChar(o,r),r.length()%3===0&&(a=e.pos,s=r.length())}if(s!==r.length()){var l=Math.floor(r.length()/3*2),c=Math.floor(e.getCodewordCount()+l+1);e.updateSymbolInfo(c);var u=e.getSymbolInfo().getDataCapacity()-c,d=Math.floor(r.length()%3);(d===2&&u!==2||d===1&&(n>3||u!==1))&&(e.pos=a)}r.length()>0&&e.writeCodeword(nne),this.handleEOD(e,r)},t.prototype.encode=function(e){for(var r=new Dn;e.hasMoreCharacters();){var n=e.getCurrentChar();e.pos++;var a=this.encodeChar(n,r),s=Math.floor(r.length()/3)*2,o=e.getCodewordCount()+s;e.updateSymbolInfo(o);var l=e.getSymbolInfo().getDataCapacity()-o;if(!e.hasMoreCharacters()){var c=new Dn;for(r.length()%3===2&&l!==2&&(a=this.backtrackOneCharacter(e,r,c,a));r.length()%3===1&&(a>3||l!==1);)a=this.backtrackOneCharacter(e,r,c,a);break}var u=r.length();if(u%3===0){var d=Hd.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(d!==this.getEncodingMode()){e.signalEncoderChange(Pa);break}}}this.handleEOD(e,r)},t.prototype.backtrackOneCharacter=function(e,r,n,a){var s=r.length(),o=r.toString().substring(0,s-a);r.setLengthToZero(),r.append(o),e.pos--;var l=e.getCurrentChar();return a=this.encodeChar(l,n),e.resetSymbolInfo(),a},t.prototype.writeNextTriplet=function(e,r){e.writeCodewords(this.encodeToCodewords(r.toString()));var n=r.toString().substring(3);r.setLengthToZero(),r.append(n)},t.prototype.handleEOD=function(e,r){var n=Math.floor(r.length()/3*2),a=r.length()%3,s=e.getCodewordCount()+n;e.updateSymbolInfo(s);var o=e.getSymbolInfo().getDataCapacity()-s;if(a===2){for(r.append("\0");r.length()>=3;)this.writeNextTriplet(e,r);e.hasMoreCharacters()&&e.writeCodeword(x5)}else if(o===1&&a===1){for(;r.length()>=3;)this.writeNextTriplet(e,r);e.hasMoreCharacters()&&e.writeCodeword(x5),e.pos--}else if(a===0){for(;r.length()>=3;)this.writeNextTriplet(e,r);(o>0||e.hasMoreCharacters())&&e.writeCodeword(x5)}else throw new Error("Unexpected case. Please report!");e.signalEncoderChange(Pa)},t.prototype.encodeChar=function(e,r){if(e===32)return r.append(3),1;if(e>=48&&e<=57)return r.append(e-48+4),1;if(e>=65&&e<=90)return r.append(e-65+14),1;if(e<32)return r.append(0),r.append(e),2;if(e<=47)return r.append(1),r.append(e-33),2;if(e<=64)return r.append(1),r.append(e-58+15),2;if(e<=95)return r.append(1),r.append(e-91+22),2;if(e<=127)return r.append(2),r.append(e-96),2;r.append("1");var n=2;return n+=this.encodeChar(e-128,r),n},t.prototype.encodeToCodewords=function(e){var r=1600*e.charCodeAt(0)+40*e.charCodeAt(1)+e.charCodeAt(2)+1,n=r/256,a=r%256,s=new Dn;return s.append(n),s.append(a),s.toString()},t}(),tTe=function(){function t(){}return t.prototype.getEncodingMode=function(){return Io},t.prototype.encode=function(e){for(var r=new Dn;e.hasMoreCharacters();){var n=e.getCurrentChar();this.encodeChar(n,r),e.pos++;var a=r.length();if(a>=4){e.writeCodewords(this.encodeToCodewords(r.toString()));var s=r.toString().substring(4);r.setLengthToZero(),r.append(s);var o=Hd.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(o!==this.getEncodingMode()){e.signalEncoderChange(Pa);break}}}r.append(ra.getCharAt(31)),this.handleEOD(e,r)},t.prototype.handleEOD=function(e,r){try{var n=r.length();if(n===0)return;if(n===1){e.updateSymbolInfo();var a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount(),s=e.getRemainingCharacters();if(s>a&&(e.updateSymbolInfo(e.getCodewordCount()+1),a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount()),s<=a&&a<=2)return}if(n>4)throw new Error("Count must not exceed 4");var o=n-1,l=this.encodeToCodewords(r.toString()),c=!e.hasMoreCharacters(),u=c&&o<=2;if(o<=2){e.updateSymbolInfo(e.getCodewordCount()+o);var a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount();a>=3&&(u=!1,e.updateSymbolInfo(e.getCodewordCount()+l.length))}u?(e.resetSymbolInfo(),e.pos-=o):e.writeCodewords(l)}finally{e.signalEncoderChange(Pa)}},t.prototype.encodeChar=function(e,r){e>=32&&e<=63?r.append(e):e>=64&&e<=94?r.append(ra.getCharAt(e-64)):Hd.illegalCharacter(ra.getCharAt(e))},t.prototype.encodeToCodewords=function(e){var r=e.length;if(r===0)throw new Error("StringBuilder must not be empty");var n=e.charAt(0).charCodeAt(0),a=r>=2?e.charAt(1).charCodeAt(0):0,s=r>=3?e.charAt(2).charCodeAt(0):0,o=r>=4?e.charAt(3).charCodeAt(0):0,l=(n<<18)+(a<<12)+(s<<6)+o,c=l>>16&255,u=l>>8&255,d=l&255,f=new Dn;return f.append(c),r>=2&&f.append(u),r>=3&&f.append(d),f.toString()},t}(),rTe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),nTe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},xa=function(){function t(e,r,n,a,s,o,l,c){l===void 0&&(l=0),c===void 0&&(c=0),this.rectangular=e,this.dataCapacity=r,this.errorCodewords=n,this.matrixWidth=a,this.matrixHeight=s,this.dataRegions=o,this.rsBlockData=l,this.rsBlockError=c}return t.lookup=function(e,r,n,a,s){var o,l;r===void 0&&(r=0),n===void 0&&(n=null),a===void 0&&(a=null),s===void 0&&(s=!0);try{for(var c=nTe(sTe),u=c.next();!u.done;u=c.next()){var d=u.value;if(!(r===1&&d.rectangular)&&!(r===2&&!d.rectangular)&&!(n!=null&&(d.getSymbolWidth()<n.getWidth()||d.getSymbolHeight()<n.getHeight()))&&!(a!=null&&(d.getSymbolWidth()>a.getWidth()||d.getSymbolHeight()>a.getHeight()))&&e<=d.dataCapacity)return d}}catch(f){o={error:f}}finally{try{u&&!u.done&&(l=c.return)&&l.call(c)}finally{if(o)throw o.error}}if(s)throw new Error("Can't find a symbol arrangement that matches the message. Data codewords: "+e);return null},t.prototype.getHorizontalDataRegions=function(){switch(this.dataRegions){case 1:return 1;case 2:case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},t.prototype.getVerticalDataRegions=function(){switch(this.dataRegions){case 1:case 2:return 1;case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},t.prototype.getSymbolDataWidth=function(){return this.getHorizontalDataRegions()*this.matrixWidth},t.prototype.getSymbolDataHeight=function(){return this.getVerticalDataRegions()*this.matrixHeight},t.prototype.getSymbolWidth=function(){return this.getSymbolDataWidth()+this.getHorizontalDataRegions()*2},t.prototype.getSymbolHeight=function(){return this.getSymbolDataHeight()+this.getVerticalDataRegions()*2},t.prototype.getCodewordCount=function(){return this.dataCapacity+this.errorCodewords},t.prototype.getInterleavedBlockCount=function(){return this.rsBlockData?this.dataCapacity/this.rsBlockData:1},t.prototype.getDataCapacity=function(){return this.dataCapacity},t.prototype.getErrorCodewords=function(){return this.errorCodewords},t.prototype.getDataLengthForInterleavedBlock=function(e){return this.rsBlockData},t.prototype.getErrorLengthForInterleavedBlock=function(e){return this.rsBlockError},t}(),aTe=function(t){rTe(e,t);function e(){return t.call(this,!1,1558,620,22,22,36,-1,62)||this}return e.prototype.getInterleavedBlockCount=function(){return 10},e.prototype.getDataLengthForInterleavedBlock=function(r){return r<=8?156:155},e}(xa),sTe=[new xa(!1,3,5,8,8,1),new xa(!1,5,7,10,10,1),new xa(!0,5,7,16,6,1),new xa(!1,8,10,12,12,1),new xa(!0,10,11,14,6,2),new xa(!1,12,12,14,14,1),new xa(!0,16,14,24,10,1),new xa(!1,18,14,16,16,1),new xa(!1,22,18,18,18,1),new xa(!0,22,18,16,10,2),new xa(!1,30,20,20,20,1),new xa(!0,32,24,16,14,2),new xa(!1,36,24,22,22,1),new xa(!1,44,28,24,24,1),new xa(!0,49,28,22,14,2),new xa(!1,62,36,14,14,4),new xa(!1,86,42,16,16,4),new xa(!1,114,48,18,18,4),new xa(!1,144,56,20,20,4),new xa(!1,174,68,22,22,4),new xa(!1,204,84,24,24,4,102,42),new xa(!1,280,112,14,14,16,140,56),new xa(!1,368,144,16,16,16,92,36),new xa(!1,456,192,18,18,16,114,48),new xa(!1,576,224,20,20,16,144,56),new xa(!1,696,272,22,22,16,174,68),new xa(!1,816,336,24,24,16,136,56),new xa(!1,1050,408,18,18,36,175,68),new xa(!1,1304,496,20,20,36,163,62),new aTe],iTe=function(){function t(e){this.msg=e,this.pos=0,this.skipAtEnd=0;for(var r=e.split("").map(function(l){return l.charCodeAt(0)}),n=new Dn,a=0,s=r.length;a<s;a++){var o=String.fromCharCode(r[a]&255);if(o==="?"&&e.charAt(a)!=="?")throw new Error("Message contains characters outside ISO-8859-1 encoding.");n.append(o)}this.msg=n.toString(),this.shape=0,this.codewords=new Dn,this.newEncoding=-1}return t.prototype.setSymbolShape=function(e){this.shape=e},t.prototype.setSizeConstraints=function(e,r){this.minSize=e,this.maxSize=r},t.prototype.getMessage=function(){return this.msg},t.prototype.setSkipAtEnd=function(e){this.skipAtEnd=e},t.prototype.getCurrentChar=function(){return this.msg.charCodeAt(this.pos)},t.prototype.getCurrent=function(){return this.msg.charCodeAt(this.pos)},t.prototype.getCodewords=function(){return this.codewords},t.prototype.writeCodewords=function(e){this.codewords.append(e)},t.prototype.writeCodeword=function(e){this.codewords.append(e)},t.prototype.getCodewordCount=function(){return this.codewords.length()},t.prototype.getNewEncoding=function(){return this.newEncoding},t.prototype.signalEncoderChange=function(e){this.newEncoding=e},t.prototype.resetEncoderSignal=function(){this.newEncoding=-1},t.prototype.hasMoreCharacters=function(){return this.pos<this.getTotalMessageCharCount()},t.prototype.getTotalMessageCharCount=function(){return this.msg.length-this.skipAtEnd},t.prototype.getRemainingCharacters=function(){return this.getTotalMessageCharCount()-this.pos},t.prototype.getSymbolInfo=function(){return this.symbolInfo},t.prototype.updateSymbolInfo=function(e){e===void 0&&(e=this.getCodewordCount()),(this.symbolInfo==null||e>this.symbolInfo.getDataCapacity())&&(this.symbolInfo=xa.lookup(e,this.shape,this.minSize,this.maxSize,!0))},t.prototype.resetSymbolInfo=function(){this.symbolInfo=null},t}(),oTe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),lTe=function(t){oTe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return eo},e.prototype.encode=function(r){for(var n=new Dn;r.hasMoreCharacters();){var a=r.getCurrentChar();r.pos++,this.encodeChar(a,n);var s=n.length();if(s%3===0){this.writeNextTriplet(r,n);var o=Hd.lookAheadTest(r.getMessage(),r.pos,this.getEncodingMode());if(o!==this.getEncodingMode()){r.signalEncoderChange(Pa);break}}}this.handleEOD(r,n)},e.prototype.encodeChar=function(r,n){switch(r){case 13:n.append(0);break;case 42:n.append(1);break;case 62:n.append(2);break;case 32:n.append(3);break;default:r>=48&&r<=57?n.append(r-48+4):r>=65&&r<=90?n.append(r-65+14):Hd.illegalCharacter(ra.getCharAt(r));break}return 1},e.prototype.handleEOD=function(r,n){r.updateSymbolInfo();var a=r.getSymbolInfo().getDataCapacity()-r.getCodewordCount(),s=n.length();r.pos-=s,(r.getRemainingCharacters()>1||a>1||r.getRemainingCharacters()!==a)&&r.writeCodeword(JBe),r.getNewEncoding()<0&&r.signalEncoderChange(Pa)},e}(D6),cTe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),uTe=function(t){cTe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return ec},e.prototype.encodeChar=function(r,n){if(r===32)return n.append(3),1;if(r>=48&&r<=57)return n.append(r-48+4),1;if(r>=97&&r<=122)return n.append(r-97+14),1;if(r<32)return n.append(0),n.append(r),2;if(r<=47)return n.append(1),n.append(r-33),2;if(r<=64)return n.append(1),n.append(r-58+15),2;if(r>=91&&r<=95)return n.append(1),n.append(r-91+22),2;if(r===96)return n.append(2),n.append(0),2;if(r<=90)return n.append(2),n.append(r-65+1),2;if(r<=127)return n.append(2),n.append(r-123+27),2;n.append("1");var a=2;return a+=this.encodeChar(r-128,n),a},e}(D6),Hd=function(){function t(){}return t.randomize253State=function(e){var r=149*e%253+1,n=CH+r;return n<=254?n:n-254},t.encodeHighLevel=function(e,r,n,a,s){r===void 0&&(r=0),n===void 0&&(n=null),a===void 0&&(a=null),s===void 0&&(s=!1);var o=new D6,l=[new ZBe,o,new uTe,new lTe,new tTe,new eTe],c=new iTe(e);c.setSymbolShape(r),c.setSizeConstraints(n,a),e.startsWith(_H)&&e.endsWith(SH)?(c.writeCodeword(qBe),c.setSkipAtEnd(2),c.pos+=_H.length):e.startsWith(EH)&&e.endsWith(SH)&&(c.writeCodeword(zBe),c.setSkipAtEnd(2),c.pos+=EH.length);var u=Pa;for(s&&(o.encodeMaximal(c),u=c.getNewEncoding(),c.resetEncoderSignal());c.hasMoreCharacters();)l[u].encode(c),c.getNewEncoding()>=0&&(u=c.getNewEncoding(),c.resetEncoderSignal());var d=c.getCodewordCount();c.updateSymbolInfo();var f=c.getSymbolInfo().getDataCapacity();d<f&&u!==Pa&&u!==Il&&u!==Io&&c.writeCodeword("");var A=c.getCodewords();for(A.length()<f&&A.append(CH);A.length()<f;)A.append(this.randomize253State(A.length()+1));return c.getCodewords().toString()},t.lookAheadTest=function(e,r,n){var a=this.lookAheadTestIntern(e,r,n);if(n===eo&&a===eo){for(var s=Math.min(r+3,e.length),o=r;o<s;o++)if(!this.isNativeX12(e.charCodeAt(o)))return Pa}else if(n===Io&&a===Io){for(var s=Math.min(r+4,e.length),o=r;o<s;o++)if(!this.isNativeEDIFACT(e.charCodeAt(o)))return Pa}return a},t.lookAheadTestIntern=function(e,r,n){if(r>=e.length)return n;var a;n===Pa?a=[0,1,1,1,1,1.25]:(a=[1,2,2,2,2,2.25],a[n]=0);for(var s=0,o=new Uint8Array(6),l=[];;){if(r+s===e.length){co.fill(o,0),co.fill(l,0);var c=this.findMinimums(a,l,Hn.MAX_VALUE,o),u=this.getMinimumCount(o);if(l[Pa]===c)return Pa;if(u===1){if(o[Il]>0)return Il;if(o[Io]>0)return Io;if(o[ec]>0)return ec;if(o[eo]>0)return eo}return Zo}var d=e.charCodeAt(r+s);if(s++,this.isDigit(d)?a[Pa]+=.5:this.isExtendedASCII(d)?(a[Pa]=Math.ceil(a[Pa]),a[Pa]+=2):(a[Pa]=Math.ceil(a[Pa]),a[Pa]++),this.isNativeC40(d)?a[Zo]+=2/3:this.isExtendedASCII(d)?a[Zo]+=8/3:a[Zo]+=4/3,this.isNativeText(d)?a[ec]+=2/3:this.isExtendedASCII(d)?a[ec]+=8/3:a[ec]+=4/3,this.isNativeX12(d)?a[eo]+=2/3:this.isExtendedASCII(d)?a[eo]+=13/3:a[eo]+=10/3,this.isNativeEDIFACT(d)?a[Io]+=3/4:this.isExtendedASCII(d)?a[Io]+=17/4:a[Io]+=13/4,this.isSpecialB256(d)?a[Il]+=4:a[Il]++,s>=4){if(co.fill(o,0),co.fill(l,0),this.findMinimums(a,l,Hn.MAX_VALUE,o),l[Pa]<this.min(l[Il],l[Zo],l[ec],l[eo],l[Io]))return Pa;if(l[Il]<l[Pa]||l[Il]+1<this.min(l[Zo],l[ec],l[eo],l[Io]))return Il;if(l[Io]+1<this.min(l[Il],l[Zo],l[ec],l[eo],l[Pa]))return Io;if(l[ec]+1<this.min(l[Il],l[Zo],l[Io],l[eo],l[Pa]))return ec;if(l[eo]+1<this.min(l[Il],l[Zo],l[Io],l[ec],l[Pa]))return eo;if(l[Zo]+1<this.min(l[Pa],l[Il],l[Io],l[ec])){if(l[Zo]<l[eo])return Zo;if(l[Zo]===l[eo]){for(var f=r+s+1;f<e.length;){var A=e.charCodeAt(f);if(this.isX12TermSep(A))return eo;if(!this.isNativeX12(A))break;f++}return Zo}}}}},t.min=function(e,r,n,a,s){var o=Math.min(e,Math.min(r,Math.min(n,a)));return s===void 0?o:Math.min(o,s)},t.findMinimums=function(e,r,n,a){for(var s=0;s<6;s++){var o=r[s]=Math.ceil(e[s]);n>o&&(n=o,co.fill(a,0)),n===o&&(a[s]=a[s]+1)}return n},t.getMinimumCount=function(e){for(var r=0,n=0;n<6;n++)r+=e[n];return r||0},t.isDigit=function(e){return e>=48&&e<=57},t.isExtendedASCII=function(e){return e>=128&&e<=255},t.isNativeC40=function(e){return e===32||e>=48&&e<=57||e>=65&&e<=90},t.isNativeText=function(e){return e===32||e>=48&&e<=57||e>=97&&e<=122},t.isNativeX12=function(e){return this.isX12TermSep(e)||e===32||e>=48&&e<=57||e>=65&&e<=90},t.isX12TermSep=function(e){return e===13||e===42||e===62},t.isNativeEDIFACT=function(e){return e>=32&&e<=94},t.isSpecialB256=function(e){return!1},t.determineConsecutiveDigitCount=function(e,r){r===void 0&&(r=0);for(var n=e.length,a=r;a<n&&this.isDigit(e.charCodeAt(a));)a++;return a-r},t.illegalCharacter=function(e){var r=Hn.toHexString(e.charCodeAt(0));throw r="0000".substring(0,4-r.length)+r,new Error("Illegal character: "+e+" (0x"+r+")")},t}(),v5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},IH=function(){function t(e){this.charset=e,this.name=e.name}return t.prototype.canEncode=function(e){try{return ud.encode(e,this.charset)!=null}catch{return!1}},t}(),dTe=function(){function t(e,r,n){var a,s,o,l,c,u;this.ENCODERS=["IBM437","ISO-8859-2","ISO-8859-3","ISO-8859-4","ISO-8859-5","ISO-8859-6","ISO-8859-7","ISO-8859-8","ISO-8859-9","ISO-8859-10","ISO-8859-11","ISO-8859-13","ISO-8859-14","ISO-8859-15","ISO-8859-16","windows-1250","windows-1251","windows-1252","windows-1256","Shift_JIS"].map(function(E){return new IH(QBe.forName(E))}),this.encoders=[];var d=[];d.push(new IH(VBe.ISO_8859_1));for(var f=r!=null&&r.name.startsWith("UTF"),A=0;A<e.length;A++){var h=!1;try{for(var m=(a=void 0,v5(d)),p=m.next();!p.done;p=m.next()){var g=p.value,v=e.charAt(A),y=v.charCodeAt(0);if(y===n||g.canEncode(v)){h=!0;break}}}catch(E){a={error:E}}finally{try{p&&!p.done&&(s=m.return)&&s.call(m)}finally{if(a)throw a.error}}if(!h)try{for(var b=(o=void 0,v5(this.ENCODERS)),w=b.next();!w.done;w=b.next()){var g=w.value;if(g.canEncode(e.charAt(A))){d.push(g),h=!0;break}}}catch(E){o={error:E}}finally{try{w&&!w.done&&(l=b.return)&&l.call(b)}finally{if(o)throw o.error}}h||(f=!0)}if(d.length===1&&!f)this.encoders=[d[0]];else{this.encoders=[];var j=0;try{for(var I=v5(d),_=I.next();!_.done;_=I.next()){var g=_.value;this.encoders[j++]=g}}catch(E){c={error:E}}finally{try{_&&!_.done&&(u=I.return)&&u.call(I)}finally{if(c)throw c.error}}}var S=-1;if(r!=null){for(var A=0;A<this.encoders.length;A++)if(this.encoders[A]!=null&&r.name===this.encoders[A].name){S=A;break}}this.priorityEncoderIndex=S}return t.prototype.length=function(){return this.encoders.length},t.prototype.getCharsetName=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].name},t.prototype.getCharset=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].charset},t.prototype.getECIValue=function(e){return this.encoders[e].charset.getValueIdentifier()},t.prototype.getPriorityEncoderIndex=function(){return this.priorityEncoderIndex},t.prototype.canEncode=function(e,r){if(!(r<this.length()))throw new Error("index must be less than length");return!0},t.prototype.encode=function(e,r){if(!(r<this.length()))throw new Error("index must be less than length");return ud.encode(ra.getCharAt(e),this.encoders[r].name)},t}(),fTe=3,hTe=function(){function t(e,r,n){this.fnc1=n;var a=new dTe(e,r,n);if(a.length()===1)for(var s=0;s<this.bytes.length;s++){var o=e.charAt(s).charCodeAt(0);this.bytes[s]=o===n?1e3:o}else this.bytes=this.encodeMinimally(e,a,n)}return t.prototype.getFNC1Character=function(){return this.fnc1},t.prototype.length=function(){return this.bytes.length},t.prototype.haveNCharacters=function(e,r){if(e+r-1>=this.bytes.length)return!1;for(var n=0;n<r;n++)if(this.isECI(e+n))return!1;return!0},t.prototype.charAt=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(this.isECI(e))throw new Error("value at "+e+" is not a character but an ECI");return this.isFNC1(e)?this.fnc1:this.bytes[e]},t.prototype.subSequence=function(e,r){if(e<0||e>r||r>this.length())throw new Error(""+e);for(var n=new Dn,a=e;a<r;a++){if(this.isECI(a))throw new Error("value at "+a+" is not a character but an ECI");n.append(this.charAt(a))}return n.toString()},t.prototype.isECI=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]>255&&this.bytes[e]<=999},t.prototype.isFNC1=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]===1e3},t.prototype.getECIValue=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(!this.isECI(e))throw new Error("value at "+e+" is not an ECI but a character");return this.bytes[e]-256},t.prototype.addEdge=function(e,r,n){(e[r][n.encoderIndex]==null||e[r][n.encoderIndex].cachedTotalSize>n.cachedTotalSize)&&(e[r][n.encoderIndex]=n)},t.prototype.addEdges=function(e,r,n,a,s,o){var l=e.charAt(a).charCodeAt(0),c=0,u=r.length();r.getPriorityEncoderIndex()>=0&&(l===o||r.canEncode(l,r.getPriorityEncoderIndex()))&&(c=r.getPriorityEncoderIndex(),u=c+1);for(var d=c;d<u;d++)(l===o||r.canEncode(l,d))&&this.addEdge(n,a+1,new jH(l,r,d,s,o))},t.prototype.encodeMinimally=function(e,r,n){var a=e.length,s=new jH[a+1][r.length()];this.addEdges(e,r,s,0,null,n);for(var o=1;o<=a;o++){for(var l=0;l<r.length();l++)s[o][l]!=null&&o<a&&this.addEdges(e,r,s,o,s[o][l],n);for(var l=0;l<r.length();l++)s[o-1][l]=null}for(var c=-1,u=Hn.MAX_VALUE,l=0;l<r.length();l++)if(s[a][l]!=null){var d=s[a][l];d.cachedTotalSize<u&&(u=d.cachedTotalSize,c=l)}if(c<0)throw new Error('Failed to encode "'+e+'"');for(var f=[],A=s[a][c];A!=null;){if(A.isFNC1())f.unshift(1e3);else for(var h=r.encode(A.c,A.encoderIndex),o=h.length-1;o>=0;o--)f.unshift(h[o]&255);var m=A.previous===null?0:A.previous.encoderIndex;m!==A.encoderIndex&&f.unshift(256+r.getECIValue(A.encoderIndex)),A=A.previous}for(var p=[],o=0;o<p.length;o++)p[o]=f[o];return p},t}(),jH=function(){function t(e,r,n,a,s){this.c=e,this.encoderSet=r,this.encoderIndex=n,this.previous=a,this.fnc1=s,this.c=e===s?1e3:e;var o=this.isFNC1()?1:r.encode(e,n).length,l=a===null?0:a.encoderIndex;l!==n&&(o+=fTe),a!=null&&(o+=a.cachedTotalSize),this.cachedTotalSize=o}return t.prototype.isFNC1=function(){return this.c===1e3},t}(),ATe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var PH;(function(t){t[t.ASCII=0]="ASCII",t[t.C40=1]="C40",t[t.TEXT=2]="TEXT",t[t.X12=3]="X12",t[t.EDF=4]="EDF",t[t.B256=5]="B256"})(PH||(PH={}));(function(t){ATe(e,t);function e(r,n,a,s,o){var l=t.call(this,r,n,a)||this;return l.shape=s,l.macroId=o,l}return e.prototype.getMacroId=function(){return this.macroId},e.prototype.getShapeHint=function(){return this.shape},e})(hTe);var mTe=function(){function t(){}return t.prototype.isCompact=function(){return this.compact},t.prototype.setCompact=function(e){this.compact=e},t.prototype.getSize=function(){return this.size},t.prototype.setSize=function(e){this.size=e},t.prototype.getLayers=function(){return this.layers},t.prototype.setLayers=function(e){this.layers=e},t.prototype.getCodeWords=function(){return this.codeWords},t.prototype.setCodeWords=function(e){this.codeWords=e},t.prototype.getMatrix=function(){return this.matrix},t.prototype.setMatrix=function(e){this.matrix=e},t}(),BH=function(){function t(){}return t.singletonList=function(e){return[e]},t.min=function(e,r){return e.sort(r)[0]},t}(),pTe=function(){function t(e){this.previous=e}return t.prototype.getPrevious=function(){return this.previous},t}(),gTe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),R6=function(t){gTe(e,t);function e(r,n,a){var s=t.call(this,r)||this;return s.value=n,s.bitCount=a,s}return e.prototype.appendTo=function(r,n){r.appendBits(this.value,this.bitCount)},e.prototype.add=function(r,n){return new e(this,r,n)},e.prototype.addBinaryShift=function(r,n){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new e(this,r,n)},e.prototype.toString=function(){var r=this.value&(1<<this.bitCount)-1;return r|=1<<this.bitCount,"<"+Hn.toBinaryString(r|1<<this.bitCount).substring(1)+">"},e}(pTe),xTe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),vTe=function(t){xTe(e,t);function e(r,n,a){var s=t.call(this,r,0,0)||this;return s.binaryShiftStart=n,s.binaryShiftByteCount=a,s}return e.prototype.appendTo=function(r,n){for(var a=0;a<this.binaryShiftByteCount;a++)(a===0||a===31&&this.binaryShiftByteCount<=62)&&(r.appendBits(31,5),this.binaryShiftByteCount>62?r.appendBits(this.binaryShiftByteCount-31,16):a===0?r.appendBits(Math.min(this.binaryShiftByteCount,31),5):r.appendBits(this.binaryShiftByteCount-31,5)),r.appendBits(n[this.binaryShiftStart+a],8)},e.prototype.addBinaryShift=function(r,n){return new e(this,r,n)},e.prototype.toString=function(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"},e}(R6);function yTe(t,e,r){return new vTe(t,e,r)}function fy(t,e,r){return new R6(t,e,r)}var bTe=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],em=0,kS=1,sd=2,ane=3,Rf=4,wTe=new R6(null,0,0),y5=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])],NTe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function CTe(t){var e,r;try{for(var n=NTe(t),a=n.next();!a.done;a=n.next()){var s=a.value;co.fill(s,-1)}}catch(o){e={error:o}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return t[em][Rf]=0,t[kS][Rf]=0,t[kS][em]=28,t[ane][Rf]=0,t[sd][Rf]=0,t[sd][em]=15,t}var sne=CTe(co.createInt32Array(6,6)),_Te=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ETe=function(){function t(e,r,n,a){this.token=e,this.mode=r,this.binaryShiftByteCount=n,this.bitCount=a}return t.prototype.getMode=function(){return this.mode},t.prototype.getToken=function(){return this.token},t.prototype.getBinaryShiftByteCount=function(){return this.binaryShiftByteCount},t.prototype.getBitCount=function(){return this.bitCount},t.prototype.latchAndAppend=function(e,r){var n=this.bitCount,a=this.token;if(e!==this.mode){var s=y5[this.mode][e];a=fy(a,s&65535,s>>16),n+=s>>16}var o=e===sd?4:5;return a=fy(a,r,o),new t(a,e,0,n+o)},t.prototype.shiftAndAppend=function(e,r){var n=this.token,a=this.mode===sd?4:5;return n=fy(n,sne[this.mode][e],a),n=fy(n,r,5),new t(n,this.mode,0,this.bitCount+a+5)},t.prototype.addBinaryShiftChar=function(e){var r=this.token,n=this.mode,a=this.bitCount;if(this.mode===Rf||this.mode===sd){var s=y5[n][em];r=fy(r,s&65535,s>>16),a+=s>>16,n=em}var o=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,l=new t(r,n,this.binaryShiftByteCount+1,a+o);return l.binaryShiftByteCount===2078&&(l=l.endBinaryShift(e+1)),l},t.prototype.endBinaryShift=function(e){if(this.binaryShiftByteCount===0)return this;var r=this.token;return r=yTe(r,e-this.binaryShiftByteCount,this.binaryShiftByteCount),new t(r,this.mode,0,this.bitCount)},t.prototype.isBetterThanOrEqualTo=function(e){var r=this.bitCount+(y5[this.mode][e.mode]>>16);return this.binaryShiftByteCount<e.binaryShiftByteCount?r+=t.calculateBinaryShiftCost(e)-t.calculateBinaryShiftCost(this):this.binaryShiftByteCount>e.binaryShiftByteCount&&e.binaryShiftByteCount>0&&(r+=10),r<=e.bitCount},t.prototype.toBitArray=function(e){for(var r,n,a=[],s=this.endBinaryShift(e.length).token;s!==null;s=s.getPrevious())a.unshift(s);var o=new Oo;try{for(var l=_Te(a),c=l.next();!c.done;c=l.next()){var u=c.value;u.appendTo(o,e)}}catch(d){r={error:d}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return o},t.prototype.toString=function(){return ra.format("%s bits=%d bytes=%d",bTe[this.mode],this.bitCount,this.binaryShiftByteCount)},t.calculateBinaryShiftCost=function(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0},t.INITIAL_STATE=new t(wTe,em,0,0),t}();function STe(t){var e=ra.getCharCode(" "),r=ra.getCharCode("."),n=ra.getCharCode(",");t[em][e]=1;for(var a=ra.getCharCode("Z"),s=ra.getCharCode("A"),o=s;o<=a;o++)t[em][o]=o-s+2;t[kS][e]=1;for(var l=ra.getCharCode("z"),c=ra.getCharCode("a"),o=c;o<=l;o++)t[kS][o]=o-c+2;t[sd][e]=1;for(var u=ra.getCharCode("9"),d=ra.getCharCode("0"),o=d;o<=u;o++)t[sd][o]=o-d+2;t[sd][n]=12,t[sd][r]=13;for(var f=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""],A=0;A<f.length;A++)t[ane][ra.getCharCode(f[A])]=A;for(var h=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"],A=0;A<h.length;A++)ra.getCharCode(h[A])>0&&(t[Rf][ra.getCharCode(h[A])]=A);return t}var b5=STe(co.createInt32Array(5,256)),VC=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ITe=function(){function t(e){this.text=e}return t.prototype.encode=function(){for(var e=ra.getCharCode(" "),r=ra.getCharCode(`
`),n=BH.singletonList(ETe.INITIAL_STATE),a=0;a<this.text.length;a++){var s=void 0,o=a+1<this.text.length?this.text[a+1]:0;switch(this.text[a]){case ra.getCharCode("\r"):s=o===r?2:0;break;case ra.getCharCode("."):s=o===e?3:0;break;case ra.getCharCode(","):s=o===e?4:0;break;case ra.getCharCode(":"):s=o===e?5:0;break;default:s=0}s>0?(n=t.updateStateListForPair(n,a,s),a++):n=this.updateStateListForChar(n,a)}var l=BH.min(n,function(c,u){return c.getBitCount()-u.getBitCount()});return l.toBitArray(this.text)},t.prototype.updateStateListForChar=function(e,r){var n,a,s=[];try{for(var o=VC(e),l=o.next();!l.done;l=o.next()){var c=l.value;this.updateStateForChar(c,r,s)}}catch(u){n={error:u}}finally{try{l&&!l.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}return t.simplifyStates(s)},t.prototype.updateStateForChar=function(e,r,n){for(var a=this.text[r]&255,s=b5[e.getMode()][a]>0,o=null,l=0;l<=Rf;l++){var c=b5[l][a];if(c>0){if(o==null&&(o=e.endBinaryShift(r)),!s||l===e.getMode()||l===sd){var u=o.latchAndAppend(l,c);n.push(u)}if(!s&&sne[e.getMode()][l]>=0){var d=o.shiftAndAppend(l,c);n.push(d)}}}if(e.getBinaryShiftByteCount()>0||b5[e.getMode()][a]===0){var f=e.addBinaryShiftChar(r);n.push(f)}},t.updateStateListForPair=function(e,r,n){var a,s,o=[];try{for(var l=VC(e),c=l.next();!c.done;c=l.next()){var u=c.value;this.updateStateForPair(u,r,n,o)}}catch(d){a={error:d}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}return this.simplifyStates(o)},t.updateStateForPair=function(e,r,n,a){var s=e.endBinaryShift(r);if(a.push(s.latchAndAppend(Rf,n)),e.getMode()!==Rf&&a.push(s.shiftAndAppend(Rf,n)),n===3||n===4){var o=s.latchAndAppend(sd,16-n).latchAndAppend(sd,1);a.push(o)}if(e.getBinaryShiftByteCount()>0){var l=e.addBinaryShiftChar(r).addBinaryShiftChar(r+1);a.push(l)}},t.simplifyStates=function(e){var r,n,a,s,o=[];try{for(var l=VC(e),c=l.next();!c.done;c=l.next()){var u=c.value,d=!0,f=function(g){if(g.isBetterThanOrEqualTo(u))return d=!1,"break";u.isBetterThanOrEqualTo(g)&&(o=o.filter(function(v){return v!==g}))};try{for(var A=(a=void 0,VC(o)),h=A.next();!h.done;h=A.next()){var m=h.value,p=f(m);if(p==="break")break}}catch(g){a={error:g}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}d&&o.push(u)}}catch(g){r={error:g}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return o},t}(),jTe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function t(){}return t.encodeBytes=function(e){return t.encode(e,t.DEFAULT_EC_PERCENT,t.DEFAULT_AZTEC_LAYERS)},t.encode=function(e,r,n){var a=new ITe(e).encode(),s=Hn.truncDivision(a.getSize()*r,100)+11,o=a.getSize()+s,l,c,u,d,f;if(n!==t.DEFAULT_AZTEC_LAYERS){if(l=n<0,c=Math.abs(n),c>(l?t.MAX_NB_BITS_COMPACT:t.MAX_NB_BITS))throw new cn(ra.format("Illegal value %s for layers",n));u=t.totalBitsInLayer(c,l),d=t.WORD_SIZE[c];var A=u-u%d;if(f=t.stuffBits(a,d),f.getSize()+s>A)throw new cn("Data to large for user specified layer");if(l&&f.getSize()>d*64)throw new cn("Data to large for user specified layer")}else{d=0,f=null;for(var h=0;;h++){if(h>t.MAX_NB_BITS)throw new cn("Data too large for an Aztec code");if(l=h<=3,c=l?h+1:h,u=t.totalBitsInLayer(c,l),!(o>u)){(f==null||d!==t.WORD_SIZE[c])&&(d=t.WORD_SIZE[c],f=t.stuffBits(a,d));var A=u-u%d;if(!(l&&f.getSize()>d*64)&&f.getSize()+s<=A)break}}}var m=t.generateCheckWords(f,u,d),p=f.getSize()/d,g=t.generateModeMessage(l,c,p),v=(l?11:14)+c*4,y=new Int32Array(v),b;if(l){b=v;for(var h=0;h<y.length;h++)y[h]=h}else{b=v+1+2*Hn.truncDivision(Hn.truncDivision(v,2)-1,15);for(var w=Hn.truncDivision(v,2),j=Hn.truncDivision(b,2),h=0;h<w;h++){var I=h+Hn.truncDivision(h,15);y[w-h-1]=j-I-1,y[w+h]=j+I+1}}for(var _=new Kf(b),h=0,S=0;h<c;h++){for(var E=(c-h)*4+(l?9:12),F=0;F<E;F++)for(var k=F*2,P=0;P<2;P++)m.get(S+k+P)&&_.set(y[h*2+P],y[h*2+F]),m.get(S+E*2+k+P)&&_.set(y[h*2+F],y[v-1-h*2-P]),m.get(S+E*4+k+P)&&_.set(y[v-1-h*2-P],y[v-1-h*2-F]),m.get(S+E*6+k+P)&&_.set(y[v-1-h*2-F],y[h*2+P]);S+=E*8}if(t.drawModeMessage(_,l,b,g),l)t.drawBullsEye(_,Hn.truncDivision(b,2),5);else{t.drawBullsEye(_,Hn.truncDivision(b,2),7);for(var h=0,F=0;h<Hn.truncDivision(v,2)-1;h+=15,F+=16)for(var P=Hn.truncDivision(b,2)&1;P<b;P+=2)_.set(Hn.truncDivision(b,2)-F,P),_.set(Hn.truncDivision(b,2)+F,P),_.set(P,Hn.truncDivision(b,2)-F),_.set(P,Hn.truncDivision(b,2)+F)}var D=new mTe;return D.setCompact(l),D.setSize(b),D.setLayers(c),D.setCodeWords(p),D.setMatrix(_),D},t.drawBullsEye=function(e,r,n){for(var a=0;a<n;a+=2)for(var s=r-a;s<=r+a;s++)e.set(s,r-a),e.set(s,r+a),e.set(r-a,s),e.set(r+a,s);e.set(r-n,r-n),e.set(r-n+1,r-n),e.set(r-n,r-n+1),e.set(r+n,r-n),e.set(r+n,r-n+1),e.set(r+n,r+n-1)},t.generateModeMessage=function(e,r,n){var a=new Oo;return e?(a.appendBits(r-1,2),a.appendBits(n-1,6),a=t.generateCheckWords(a,28,4)):(a.appendBits(r-1,5),a.appendBits(n-1,11),a=t.generateCheckWords(a,40,4)),a},t.drawModeMessage=function(e,r,n,a){var s=Hn.truncDivision(n,2);if(r)for(var o=0;o<7;o++){var l=s-3+o;a.get(o)&&e.set(l,s-5),a.get(o+7)&&e.set(s+5,l),a.get(20-o)&&e.set(l,s+5),a.get(27-o)&&e.set(s-5,l)}else for(var o=0;o<10;o++){var l=s-5+o+Hn.truncDivision(o,5);a.get(o)&&e.set(l,s-7),a.get(o+10)&&e.set(s+7,l),a.get(29-o)&&e.set(l,s+7),a.get(39-o)&&e.set(s-7,l)}},t.generateCheckWords=function(e,r,n){var a,s,o=e.getSize()/n,l=new rne(t.getGF(n)),c=Hn.truncDivision(r,n),u=t.bitsToWords(e,n,c);l.encode(u,c-o);var d=r%n,f=new Oo;f.appendBits(0,d);try{for(var A=jTe(Array.from(u)),h=A.next();!h.done;h=A.next()){var m=h.value;f.appendBits(m,n)}}catch(p){a={error:p}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}return f},t.bitsToWords=function(e,r,n){var a=new Int32Array(n),s,o;for(s=0,o=e.getSize()/r;s<o;s++){for(var l=0,c=0;c<r;c++)l|=e.get(s*r+c)?1<<r-c-1:0;a[s]=l}return a},t.getGF=function(e){switch(e){case 4:return Bc.AZTEC_PARAM;case 6:return Bc.AZTEC_DATA_6;case 8:return Bc.AZTEC_DATA_8;case 10:return Bc.AZTEC_DATA_10;case 12:return Bc.AZTEC_DATA_12;default:throw new cn("Unsupported word size "+e)}},t.stuffBits=function(e,r){for(var n=new Oo,a=e.getSize(),s=(1<<r)-2,o=0;o<a;o+=r){for(var l=0,c=0;c<r;c++)(o+c>=a||e.get(o+c))&&(l|=1<<r-1-c);(l&s)===s?(n.appendBits(l&s,r),o--):l&s?n.appendBits(l,r):(n.appendBits(l|1,r),o--)}return n},t.totalBitsInLayer=function(e,r){return((r?88:112)+16*e)*e},t.DEFAULT_EC_PERCENT=33,t.DEFAULT_AZTEC_LAYERS=0,t.MAX_NB_BITS=32,t.MAX_NB_BITS_COMPACT=4,t.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]),t})();var PTe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),BTe=function(t){PTe(e,t);function e(r){var n=t.call(this,r.width,r.height)||this;return n.canvas=r,n.tempCanvasElement=null,n.buffer=e.makeBufferFromCanvasImageData(r),n}return e.makeBufferFromCanvasImageData=function(r){var n;try{n=r.getContext("2d",{willReadFrequently:!0})}catch{n=r.getContext("2d")}if(!n)throw new Error("Couldn't get canvas context.");var a=n.getImageData(0,0,r.width,r.height);return e.toGrayscaleBuffer(a.data,r.width,r.height)},e.toGrayscaleBuffer=function(r,n,a){for(var s=new Uint8ClampedArray(n*a),o=0,l=0,c=r.length;o<c;o+=4,l++){var u=void 0,d=r[o+3];if(d===0)u=255;else{var f=r[o],A=r[o+1],h=r[o+2];u=306*f+601*A+117*h+512>>10}s[l]=u}return s},e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new cn("Requested row is outside the image: "+r);var a=this.getWidth(),s=r*a;return n===null?n=this.buffer.slice(s,s+a):(n.length<a&&(n=new Uint8ClampedArray(a)),n.set(this.buffer.slice(s,s+a))),n},e.prototype.getMatrix=function(){return this.buffer},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return t.prototype.crop.call(this,r,n,a,s),this},e.prototype.isRotateSupported=function(){return!0},e.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},e.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},e.prototype.invert=function(){return new zj(this)},e.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement},e.prototype.rotate=function(r){var n=this.getTempCanvasElement();if(!n)throw new Error("Could not create a Canvas element.");var a=r*e.DEGREE_TO_RADIANS,s=this.canvas.width,o=this.canvas.height,l=Math.ceil(Math.abs(Math.cos(a))*s+Math.abs(Math.sin(a))*o),c=Math.ceil(Math.abs(Math.sin(a))*s+Math.abs(Math.cos(a))*o);n.width=l,n.height=c;var u=n.getContext("2d");if(!u)throw new Error("Could not create a Canvas Context element.");return u.translate(l/2,c/2),u.rotate(a),u.drawImage(this.canvas,s/-2,o/-2),this.buffer=e.makeBufferFromCanvasImageData(n),this},e.DEGREE_TO_RADIANS=Math.PI/180,e}(Iw);function ine(){return typeof navigator<"u"}function TTe(){return ine()&&!!navigator.mediaDevices}function kTe(){return!!(TTe()&&navigator.mediaDevices.enumerateDevices)}var Gx=function(){return Gx=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},Gx.apply(this,arguments)},Us=function(t,e,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?s(d.value):a(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})},Qs=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=u[0]&2?a.return:u[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,u[1])).done)return s;switch(a=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],a=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},w5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},FTe={delayBetweenScanAttempts:500,delayBetweenScanSuccess:500,tryPlayVideoTimeout:5e3},d1=function(){function t(e,r,n){r===void 0&&(r=new Map),n===void 0&&(n={}),this.reader=e,this.hints=r,this.options=Gx(Gx({},FTe),n)}return Object.defineProperty(t.prototype,"possibleFormats",{set:function(e){this.hints.set(is.POSSIBLE_FORMATS,e)},enumerable:!1,configurable:!0}),t.addVideoSource=function(e,r){try{e.srcObject=r}catch{console.error("got interrupted by new loading request")}},t.mediaStreamSetTorch=function(e,r){return Us(this,void 0,void 0,function(){return Qs(this,function(n){switch(n.label){case 0:return[4,e.applyConstraints({advanced:[{fillLightMode:r?"flash":"off",torch:!!r}]})];case 1:return n.sent(),[2]}})})},t.mediaStreamIsTorchCompatible=function(e){var r,n,a=e.getVideoTracks();try{for(var s=w5(a),o=s.next();!o.done;o=s.next()){var l=o.value;if(t.mediaStreamIsTorchCompatibleTrack(l))return!0}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return!1},t.mediaStreamIsTorchCompatibleTrack=function(e){try{var r=e.getCapabilities();return"torch"in r}catch(n){return console.error(n),console.warn("Your browser may be not fully compatible with WebRTC and/or ImageCapture specs. Torch will not be available."),!1}},t.isVideoPlaying=function(e){return e.currentTime>0&&!e.paused&&e.readyState>2},t.getMediaElement=function(e,r){var n=document.getElementById(e);if(!n)throw new Ni("element with id '".concat(e,"' not found"));if(n.nodeName.toLowerCase()!==r.toLowerCase())throw new Ni("element with id '".concat(e,"' must be an ").concat(r," element"));return n},t.createVideoElement=function(e){if(e instanceof HTMLVideoElement)return e;if(typeof e=="string")return t.getMediaElement(e,"video");if(!e&&typeof document<"u"){var r=document.createElement("video");return r.width=200,r.height=200,r}throw new Error("Couldn't get videoElement from videoSource!")},t.prepareImageElement=function(e){if(e instanceof HTMLImageElement)return e;if(typeof e=="string")return t.getMediaElement(e,"img");if(typeof e>"u"){var r=document.createElement("img");return r.width=200,r.height=200,r}throw new Error("Couldn't get imageElement from imageSource!")},t.prepareVideoElement=function(e){var r=t.createVideoElement(e);return r.setAttribute("autoplay","true"),r.setAttribute("muted","true"),r.setAttribute("playsinline","true"),r},t.isImageLoaded=function(e){return!(!e.complete||e.naturalWidth===0)},t.createBinaryBitmapFromCanvas=function(e){var r=new BTe(e),n=new $re(r);return new Hre(n)},t.drawImageOnCanvas=function(e,r){e.drawImage(r,0,0)},t.getMediaElementDimensions=function(e){if(e instanceof HTMLVideoElement)return{height:e.videoHeight,width:e.videoWidth};if(e instanceof HTMLImageElement)return{height:e.naturalHeight||e.height,width:e.naturalWidth||e.width};throw new Error("Couldn't find the Source's dimensions!")},t.createCaptureCanvas=function(e){if(!e)throw new Ni("Cannot create a capture canvas without a media element.");if(typeof document>"u")throw new Error(`The page "Document" is undefined, make sure you're running in a browser.`);var r=document.createElement("canvas"),n=t.getMediaElementDimensions(e),a=n.width,s=n.height;return r.style.width=a+"px",r.style.height=s+"px",r.width=a,r.height=s,r},t.tryPlayVideo=function(e){return Us(this,void 0,void 0,function(){var r;return Qs(this,function(n){switch(n.label){case 0:if(e!=null&&e.ended)return console.error("Trying to play video that has ended."),[2,!1];if(t.isVideoPlaying(e))return console.warn("Trying to play video that is already playing."),[2,!0];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e.play()];case 2:return n.sent(),[2,!0];case 3:return r=n.sent(),console.warn("It was not possible to play the video.",r),[2,!1];case 4:return[2]}})})},t.createCanvasFromMediaElement=function(e){var r=t.createCaptureCanvas(e),n=r.getContext("2d");if(!n)throw new Error("Couldn't find Canvas 2D Context.");return t.drawImageOnCanvas(n,e),r},t.createBinaryBitmapFromMediaElem=function(e){var r=t.createCanvasFromMediaElement(e);return t.createBinaryBitmapFromCanvas(r)},t.destroyImageElement=function(e){e.src="",e.removeAttribute("src"),e=void 0},t.listVideoInputDevices=function(){return Us(this,void 0,void 0,function(){var e,r,n,a,s,o,l,c,u,d,f,A;return Qs(this,function(h){switch(h.label){case 0:if(!ine())throw new Error("Can't enumerate devices, navigator is not present.");if(!kTe())throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=h.sent(),r=[];try{for(n=w5(e),a=n.next();!a.done;a=n.next())s=a.value,o=s.kind==="video"?"videoinput":s.kind,o==="videoinput"&&(l=s.deviceId||s.id,c=s.label||"Video device ".concat(r.length+1),u=s.groupId,d={deviceId:l,label:c,kind:o,groupId:u},r.push(d))}catch(m){f={error:m}}finally{try{a&&!a.done&&(A=n.return)&&A.call(n)}finally{if(f)throw f.error}}return[2,r]}})})},t.findDeviceById=function(e){return Us(this,void 0,void 0,function(){var r;return Qs(this,function(n){switch(n.label){case 0:return[4,t.listVideoInputDevices()];case 1:return r=n.sent(),r?[2,r.find(function(a){return a.deviceId===e})]:[2]}})})},t.cleanVideoSource=function(e){if(e){try{e.srcObject=null}catch{e.src=""}e&&e.removeAttribute("src")}},t.releaseAllStreams=function(){t.streamTracker.length!==0&&t.streamTracker.forEach(function(e){e.getTracks().forEach(function(r){return r.stop()})}),t.streamTracker=[]},t.playVideoOnLoadAsync=function(e,r){return Us(this,void 0,void 0,function(){var n;return Qs(this,function(a){switch(a.label){case 0:return[4,t.tryPlayVideo(e)];case 1:return n=a.sent(),n?[2,!0]:[2,new Promise(function(s,o){var l=setTimeout(function(){t.isVideoPlaying(e)||(o(!1),e.removeEventListener("canplay",c))},r),c=function(){t.tryPlayVideo(e).then(function(u){clearTimeout(l),e.removeEventListener("canplay",c),s(u)})};e.addEventListener("canplay",c)})]}})})},t.attachStreamToVideo=function(e,r,n){return n===void 0&&(n=5e3),Us(this,void 0,void 0,function(){var a;return Qs(this,function(s){switch(s.label){case 0:return a=t.prepareVideoElement(r),t.addVideoSource(a,e),[4,t.playVideoOnLoadAsync(a,n)];case 1:return s.sent(),[2,a]}})})},t._waitImageLoad=function(e){return new Promise(function(r,n){var a=1e4,s=setTimeout(function(){t.isImageLoaded(e)||(e.removeEventListener("load",o),n())},a),o=function(){clearTimeout(s),e.removeEventListener("load",o),r()};e.addEventListener("load",o)})},t.checkCallbackFnOrThrow=function(e){if(!e)throw new Ni("`callbackFn` is a required parameter, you cannot capture results without it.")},t.disposeMediaStream=function(e){e.getVideoTracks().forEach(function(r){return r.stop()}),e=void 0},t.prototype.decode=function(e){var r=t.createCanvasFromMediaElement(e);return this.decodeFromCanvas(r)},t.prototype.decodeBitmap=function(e){return this.reader.decode(e,this.hints)},t.prototype.decodeFromCanvas=function(e){var r=t.createBinaryBitmapFromCanvas(e);return this.decodeBitmap(r)},t.prototype.decodeFromImageElement=function(e){return Us(this,void 0,void 0,function(){var r;return Qs(this,function(n){switch(n.label){case 0:if(!e)throw new Ni("An image element must be provided.");return r=t.prepareImageElement(e),[4,this._decodeOnLoadImage(r)];case 1:return[2,n.sent()]}})})},t.prototype.decodeFromImageUrl=function(e){return Us(this,void 0,void 0,function(){var r;return Qs(this,function(n){switch(n.label){case 0:if(!e)throw new Ni("An URL must be provided.");r=t.prepareImageElement(),r.src=e,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this.decodeFromImageElement(r)];case 2:return[2,n.sent()];case 3:return t.destroyImageElement(r),[7];case 4:return[2]}})})},t.prototype.decodeFromConstraints=function(e,r,n){return Us(this,void 0,void 0,function(){var a,s;return Qs(this,function(o){switch(o.label){case 0:return t.checkCallbackFnOrThrow(n),[4,this.getUserMedia(e)];case 1:a=o.sent(),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,this.decodeFromStream(a,r,n)];case 3:return[2,o.sent()];case 4:throw s=o.sent(),t.disposeMediaStream(a),s;case 5:return[2]}})})},t.prototype.decodeFromStream=function(e,r,n){return Us(this,void 0,void 0,function(){var a,s,o,l,c,u,d,f,A,h=this;return Qs(this,function(m){switch(m.label){case 0:return t.checkCallbackFnOrThrow(n),a=this.options.tryPlayVideoTimeout,[4,t.attachStreamToVideo(e,r,a)];case 1:return s=m.sent(),o=function(){t.disposeMediaStream(e),t.cleanVideoSource(s)},l=this.scan(s,n,o),c=e.getVideoTracks(),u=Gx(Gx({},l),{stop:function(){l.stop()},streamVideoConstraintsApply:function(p,g){return Us(this,void 0,void 0,function(){var v,y,b,w,j,I,_;return Qs(this,function(S){switch(S.label){case 0:v=g?c.filter(g):c,S.label=1;case 1:S.trys.push([1,6,7,8]),y=w5(v),b=y.next(),S.label=2;case 2:return b.done?[3,5]:(w=b.value,[4,w.applyConstraints(p)]);case 3:S.sent(),S.label=4;case 4:return b=y.next(),[3,2];case 5:return[3,8];case 6:return j=S.sent(),I={error:j},[3,8];case 7:try{b&&!b.done&&(_=y.return)&&_.call(y)}finally{if(I)throw I.error}return[7];case 8:return[2]}})})},streamVideoConstraintsGet:function(p){return c.find(p).getConstraints()},streamVideoSettingsGet:function(p){return c.find(p).getSettings()},streamVideoCapabilitiesGet:function(p){return c.find(p).getCapabilities()}}),d=t.mediaStreamIsTorchCompatible(e),d&&(f=c==null?void 0:c.find(function(p){return t.mediaStreamIsTorchCompatibleTrack(p)}),A=function(p){return Us(h,void 0,void 0,function(){return Qs(this,function(g){switch(g.label){case 0:return[4,t.mediaStreamSetTorch(f,p)];case 1:return g.sent(),[2]}})})},u.switchTorch=A,u.stop=function(){return Us(h,void 0,void 0,function(){return Qs(this,function(p){switch(p.label){case 0:return l.stop(),[4,A(!1)];case 1:return p.sent(),[2]}})})}),[2,u]}})})},t.prototype.decodeFromVideoDevice=function(e,r,n){return Us(this,void 0,void 0,function(){var a,s;return Qs(this,function(o){switch(o.label){case 0:return t.checkCallbackFnOrThrow(n),e?a={deviceId:{exact:e}}:a={facingMode:"environment"},s={video:a},[4,this.decodeFromConstraints(s,r,n)];case 1:return[2,o.sent()]}})})},t.prototype.decodeFromVideoElement=function(e,r){return Us(this,void 0,void 0,function(){var n,a;return Qs(this,function(s){switch(s.label){case 0:if(t.checkCallbackFnOrThrow(r),!e)throw new Ni("A video element must be provided.");return n=t.prepareVideoElement(e),a=this.options.tryPlayVideoTimeout,[4,t.playVideoOnLoadAsync(n,a)];case 1:return s.sent(),[2,this.scan(n,r)]}})})},t.prototype.decodeFromVideoUrl=function(e,r){return Us(this,void 0,void 0,function(){var n,a,s,o;return Qs(this,function(l){switch(l.label){case 0:if(t.checkCallbackFnOrThrow(r),!e)throw new Ni("An URL must be provided.");return n=t.prepareVideoElement(),n.src=e,a=function(){t.cleanVideoSource(n)},s=this.options.tryPlayVideoTimeout,[4,t.playVideoOnLoadAsync(n,s)];case 1:return l.sent(),o=this.scan(n,r,a),[2,o]}})})},t.prototype.decodeOnceFromConstraints=function(e,r){return Us(this,void 0,void 0,function(){var n;return Qs(this,function(a){switch(a.label){case 0:return[4,this.getUserMedia(e)];case 1:return n=a.sent(),[4,this.decodeOnceFromStream(n,r)];case 2:return[2,a.sent()]}})})},t.prototype.decodeOnceFromStream=function(e,r){return Us(this,void 0,void 0,function(){var n,a,s;return Qs(this,function(o){switch(o.label){case 0:return n=!!r,[4,t.attachStreamToVideo(e,r)];case 1:a=o.sent(),o.label=2;case 2:return o.trys.push([2,,4,5]),[4,this.scanOneResult(a)];case 3:return s=o.sent(),[2,s];case 4:return n||t.cleanVideoSource(a),[7];case 5:return[2]}})})},t.prototype.decodeOnceFromVideoDevice=function(e,r){return Us(this,void 0,void 0,function(){var n,a;return Qs(this,function(s){switch(s.label){case 0:return e?n={deviceId:{exact:e}}:n={facingMode:"environment"},a={video:n},[4,this.decodeOnceFromConstraints(a,r)];case 1:return[2,s.sent()]}})})},t.prototype.decodeOnceFromVideoElement=function(e){return Us(this,void 0,void 0,function(){var r,n;return Qs(this,function(a){switch(a.label){case 0:if(!e)throw new Ni("A video element must be provided.");return r=t.prepareVideoElement(e),n=this.options.tryPlayVideoTimeout,[4,t.playVideoOnLoadAsync(r,n)];case 1:return a.sent(),[4,this.scanOneResult(r)];case 2:return[2,a.sent()]}})})},t.prototype.decodeOnceFromVideoUrl=function(e){return Us(this,void 0,void 0,function(){var r,n;return Qs(this,function(a){switch(a.label){case 0:if(!e)throw new Ni("An URL must be provided.");r=t.prepareVideoElement(),r.src=e,n=this.decodeOnceFromVideoElement(r),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,n];case 2:return[2,a.sent()];case 3:return t.cleanVideoSource(r),[7];case 4:return[2]}})})},t.prototype.scanOneResult=function(e,r,n,a){var s=this;return r===void 0&&(r=!0),n===void 0&&(n=!0),a===void 0&&(a=!0),new Promise(function(o,l){s.scan(e,function(c,u,d){if(c){o(c),d.stop();return}if(u){if(u instanceof Zt&&r||u instanceof Vi&&n||u instanceof Sr&&a)return;d.stop(),l(u)}})})},t.prototype.scan=function(e,r,n){var a=this;t.checkCallbackFnOrThrow(r);var s=t.createCaptureCanvas(e),o;try{o=s.getContext("2d",{willReadFrequently:!0})}catch{o=s.getContext("2d")}if(!o)throw new Error("Couldn't create canvas for visual element scan.");var l=function(){o=void 0,s=void 0},c=!1,u,d=function(){c=!0,clearTimeout(u),l(),n&&n()},f={stop:d},A=function(){if(!c)try{t.drawImageOnCanvas(o,e);var h=a.decodeFromCanvas(s);r(h,void 0,f),u=setTimeout(A,a.options.delayBetweenScanSuccess)}catch(v){r(void 0,v,f);var m=v instanceof Vi,p=v instanceof Sr,g=v instanceof Zt;if(m||p||g){u=setTimeout(A,a.options.delayBetweenScanAttempts);return}l(),n&&n(v)}};return A(),f},t.prototype._decodeOnLoadImage=function(e){return Us(this,void 0,void 0,function(){var r;return Qs(this,function(n){switch(n.label){case 0:return r=t.isImageLoaded(e),r?[3,2]:[4,t._waitImageLoad(e)];case 1:n.sent(),n.label=2;case 2:return[2,this.decode(e)]}})})},t.prototype.getUserMedia=function(e){return Us(this,void 0,void 0,function(){var r;return Qs(this,function(n){switch(n.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return r=n.sent(),t.streamTracker.push(r),[2,r]}})})},t.streamTracker=[],t}(),OTe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){OTe(e,t);function e(r,n){return t.call(this,new IS,r,n)||this}return e})(d1);var DTe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){DTe(e,t);function e(r,n){return t.call(this,new Hx(r),r,n)||this}return e})(d1);var RTe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){RTe(e,t);function e(r,n){return t.call(this,new PS,r,n)||this}return e})(d1);var MTe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),b2=function(t){MTe(e,t);function e(r,n){var a=this,s=new tne;return s.setHints(r),a=t.call(this,s,r,n)||this,a.reader=s,a}return Object.defineProperty(e.prototype,"possibleFormats",{set:function(r){this.hints.set(is.POSSIBLE_FORMATS,r),this.reader.setHints(this.hints)},enumerable:!1,configurable:!0}),e.prototype.decodeBitmap=function(r){return this.reader.decodeWithState(r)},e.prototype.setHints=function(r){this.hints=r,this.reader.setHints(this.hints)},e}(d1),LTe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){LTe(e,t);function e(r,n){return t.call(this,new TS,r,n)||this}return e})(d1);var UTe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){UTe(e,t);function e(r,n){return t.call(this,new BS,r,n)||this}return e})(d1);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var FS={};FS.version="0.18.5";var one=1252,QTe=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],M6={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},L6=function(t){QTe.indexOf(t)!=-1&&(one=M6[0]=t)};function VTe(){L6(1252)}var qd=function(t){L6(t)};function U6(){qd(1200),VTe()}function TH(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function HTe(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function lne(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Hy=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?HTe(t.slice(2)):e==254&&r==255?lne(t.slice(2)):e==65279?t.slice(1):t},HC=function(e){return String.fromCharCode(e)},kH=function(e){return String.fromCharCode(e)},w2,O0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function N2(t){for(var e="",r=0,n=0,a=0,s=0,o=0,l=0,c=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),o=(r&3)<<4|n>>4,a=t.charCodeAt(u++),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),e+=O0.charAt(s)+O0.charAt(o)+O0.charAt(l)+O0.charAt(c);return e}function bu(t){var e="",r=0,n=0,a=0,s=0,o=0,l=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=O0.indexOf(t.charAt(u++)),o=O0.indexOf(t.charAt(u++)),r=s<<2|o>>4,e+=String.fromCharCode(r),l=O0.indexOf(t.charAt(u++)),n=(o&15)<<4|l>>2,l!==64&&(e+=String.fromCharCode(n)),c=O0.indexOf(t.charAt(u++)),a=(l&3)<<6|c,c!==64&&(e+=String.fromCharCode(a));return e}var Rn=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),wA=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function hm(t){return Rn?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function FH(t){return Rn?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var lu=function(e){return Rn?wA(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Yj(t){if(typeof ArrayBuffer>"u")return lu(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Em(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function $Te(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function Q6(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Q6(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Fo=Rn?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:wA(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),a=0;for(e=0,r=0;e<t.length;r+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function GTe(t){for(var e=[],r=0,n=t.length+250,a=hm(t.length+255),s=0;s<t.length;++s){var o=t.charCodeAt(s);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=t.charCodeAt(++s)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|l>>6&15|(o&3)<<4,a[r++]=128|l&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(e.push(a.slice(0,r)),r=0,a=hm(65535),n=65530)}return e.push(a.slice(0,r)),Fo(e)}var dc=/\u0000/g,$y=/[\u0001-\u0006]/g;function lv(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function zd(t,e){var r=""+t;return r.length>=e?r:ci("0",e-r.length)+r}function V6(t,e){var r=""+t;return r.length>=e?r:ci(" ",e-r.length)+r}function OS(t,e){var r=""+t;return r.length>=e?r:r+ci(" ",e-r.length)}function KTe(t,e){var r=""+Math.round(t);return r.length>=e?r:ci("0",e-r.length)+r}function qTe(t,e){var r=""+t;return r.length>=e?r:ci("0",e-r.length)+r}var OH=Math.pow(2,32);function cx(t,e){if(t>OH||t<-OH)return KTe(t,e);var r=Math.round(t);return qTe(r,e)}function DS(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var DH=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],N5=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function zTe(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var fn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},RH={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},WTe={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function RS(t,e,r){for(var n=t<0?-1:1,a=t*n,s=0,o=1,l=0,c=1,u=0,d=0,f=Math.floor(a);u<e&&(f=Math.floor(a),l=f*o+s,d=f*u+c,!(a-f<5e-8));)a=1/(a-f),s=o,o=l,c=u,u=d;if(d>e&&(u>e?(d=c,l=s):(d=u,l=o)),!r)return[0,n*l,d];var A=Math.floor(n*l/d);return[A,n*l-A*d,d]}function gp(t,e,r){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),s=0,o=[],l={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),e&&e.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=tke(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=s,l}var cne=new Date(1899,11,31,0,0,0),XTe=cne.getTime(),YTe=new Date(1900,2,1,0,0,0);function une(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=YTe&&(r+=24*60*60*1e3),(r-(XTe+(t.getTimezoneOffset()-cne.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function H6(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function JTe(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function ZTe(t){var e=t<0?12:11,r=H6(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function eke(t){var e=H6(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function C2(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=ZTe(t):e===10?r=t.toFixed(10).substr(0,12):r=eke(t),H6(JTe(r.toUpperCase()))}function rg(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):C2(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return md(14,une(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function tke(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function rke(t,e,r,n){var a="",s=0,o=0,l=r.y,c,u=0;switch(t){case 98:l=r.y+543;case 121:switch(e.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,u=e.length;break;case 3:return N5[r.m-1][1];case 5:return N5[r.m-1][0];default:return N5[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,u=e.length;break;case 3:return DH[r.q][0];default:return DH[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?zd(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),e==="s"?s===0?"0":""+s/o:(a=zd(s,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?zd(c,u):"";return d}function D0(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var dne=/%/g;function nke(t,e,r){var n=e.replace(dne,""),a=e.length-n.length;return qh(t,n,r*Math.pow(10,2*a))+ci("%",a)}function ake(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return qh(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function fne(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+fne(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(e/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var hne=/# (\?+)( ?)\/( ?)(\d+)/;function ske(t,e,r){var n=parseInt(t[4],10),a=Math.round(e*n),s=Math.floor(a/n),o=a-s*n,l=n;return r+(s===0?"":""+s)+" "+(o===0?ci(" ",t[1].length+1+t[4].length):V6(o,t[1].length)+t[2]+"/"+t[3]+zd(l,t[4].length))}function ike(t,e,r){return r+(e===0?"":""+e)+ci(" ",t[1].length+2+t[4].length)}var Ane=/^#*0*\.([0#]+)/,mne=/\).*[0#]/,pne=/\(###\) ###\\?-####/;function ac(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function MH(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function LH(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function oke(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function lke(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Hu(t,e,r){if(t.charCodeAt(0)===40&&!e.match(mne)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Hu("n",n,r):"("+Hu("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return ake(t,e,r);if(e.indexOf("%")!==-1)return nke(t,e,r);if(e.indexOf("E")!==-1)return fne(e,r);if(e.charCodeAt(0)===36)return"$"+Hu(t,e.substr(e.charAt(1)==" "?2:1),r);var a,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+cx(c,e.length);if(e.match(/^[#?]+$/))return a=cx(r,0),a==="0"&&(a=""),a.length>e.length?a:ac(e.substr(0,e.length-a.length))+a;if(s=e.match(hne))return ske(s,c,u);if(e.match(/^#+0+$/))return u+cx(c,e.length-e.indexOf("0"));if(s=e.match(Ane))return a=MH(r,s[1].length).replace(/^([^\.]+)$/,"$1."+ac(s[1])).replace(/\.$/,"."+ac(s[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+ci("0",ac(s[1]).length-p.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+MH(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+D0(cx(c,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Hu(t,e,-r):D0(""+(Math.floor(r)+oke(r,s[1].length)))+"."+zd(LH(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Hu(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=lv(Hu(t,e.replace(/[\\-]/g,""),r)),o=0,lv(lv(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<a.length?a.charAt(o++):m==="0"?"0":""}));if(e.match(pne))return a=Hu(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=RS(c,Math.pow(10,o)-1,!1),a=""+u,d=qh("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=OS(l[2],o),d.length<s[4].length&&(d=ac(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=RS(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?V6(l[1],o)+s[2]+"/"+s[3]+OS(l[2],o):ci(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=cx(r,0),e.length<=a.length?a:ac(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=e.indexOf(".")-o,A=e.length-a.length-f;return ac(e.substr(0,f)+a+e.substr(e.length-A))}if(s=e.match(/^00,000\.([#0]*0)$/))return o=LH(r,s[1].length),r<0?"-"+Hu(t,e,-r):D0(lke(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?zd(0,3-m.length):"")+m})+"."+zd(o,s[1].length);switch(e){case"###,##0.00":return Hu(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=D0(cx(c,0));return h!=="0"?u+h:"";case"###,###.00":return Hu(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Hu(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function cke(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return qh(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function uke(t,e,r){var n=e.replace(dne,""),a=e.length-n.length;return qh(t,n,r*Math.pow(10,2*a))+ci("%",a)}function gne(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+gne(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(e/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Sf(t,e,r){if(t.charCodeAt(0)===40&&!e.match(mne)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Sf("n",n,r):"("+Sf("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return cke(t,e,r);if(e.indexOf("%")!==-1)return uke(t,e,r);if(e.indexOf("E")!==-1)return gne(e,r);if(e.charCodeAt(0)===36)return"$"+Sf(t,e.substr(e.charAt(1)==" "?2:1),r);var a,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+zd(c,e.length);if(e.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>e.length?a:ac(e.substr(0,e.length-a.length))+a;if(s=e.match(hne))return ike(s,c,u);if(e.match(/^#+0+$/))return u+zd(c,e.length-e.indexOf("0"));if(s=e.match(Ane))return a=(""+r).replace(/^([^\.]+)$/,"$1."+ac(s[1])).replace(/\.$/,"."+ac(s[1])),a=a.replace(/\.(\d*)$/,function(m,p){return"."+p+ci("0",ac(s[1]).length-p.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+D0(""+c);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Sf(t,e,-r):D0(""+r)+"."+ci("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Sf(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=lv(Sf(t,e.replace(/[\\-]/g,""),r)),o=0,lv(lv(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<a.length?a.charAt(o++):m==="0"?"0":""}));if(e.match(pne))return a=Sf(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=RS(c,Math.pow(10,o)-1,!1),a=""+u,d=qh("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=OS(l[2],o),d.length<s[4].length&&(d=ac(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=RS(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?V6(l[1],o)+s[2]+"/"+s[3]+OS(l[2],o):ci(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=""+r,e.length<=a.length?a:ac(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=e.indexOf(".")-o,A=e.length-a.length-f;return ac(e.substr(0,f)+a+e.substr(e.length-A))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Sf(t,e,-r):D0(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?zd(0,3-m.length):"")+m})+"."+zd(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var h=D0(""+c);return h!=="0"?u+h:"";default:if(e.match(/\.[0#?]*$/))return Sf(t,e.slice(0,e.lastIndexOf(".")),r)+ac(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function qh(t,e,r){return(r|0)===r?Sf(t,e,r):Hu(t,e,r)}function dke(t){for(var e=[],r=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(a,n-a),a=n+1}if(e[e.length]=t.substr(a),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var xne=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function f1(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":DS(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(xne))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function fke(t,e,r,n){for(var a=[],s="",o=0,l="",c="t",u,d,f,A="H";o<t.length;)switch(l=t.charAt(o)){case"G":if(!DS(t,o))throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(f=t.charCodeAt(++o))!==34&&o<t.length;)s+=String.fromCharCode(f);a[a.length]={t:"t",v:s},++o;break;case"\\":var h=t.charAt(++o),m=h==="("||h===")"?h:"t";a[a.length]={t:m,v:h},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(u==null&&(u=gp(e,r,t.charAt(o+1)==="2"),u==null))return"";a[a.length]={t:"X",v:t.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=gp(e,r),u==null))return"";for(s=l;++o<t.length&&t.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=A),a[a.length]={t:l,v:s},c=l;break;case"A":case"a":case"":var p={t:l,v:l};if(u==null&&(u=gp(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",A="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",o+=5,A="h"):t.substr(o,5).toUpperCase()==="/"?(u!=null&&(p.v=u.H>=12?"":""),p.t="T",o+=5,A="h"):(p.t="t",++o),u==null&&p.t==="T")return"";a[a.length]=p,c=l;break;case"[":for(s=l;t.charAt(o++)!=="]"&&o<t.length;)s+=t.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(xne)){if(u==null&&(u=gp(e,r),u==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",f1(t)||(a[a.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=l;++o<t.length&&(l=t.charAt(o))==="0";)s+=l;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(o))>-1;)s+=l;a[a.length]={t:"n",v:s};break;case"?":for(s=l;t.charAt(++o)===l;)s+=l;a[a.length]={t:l,v:s},c=l;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)s+=t.charAt(o);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:l,v:l},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"t",v:l},++o;break}var g=0,v=0,y;for(o=a.length-1,c="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=A,c="h",g<1&&(g=1);break;case"s":(y=a[o].v.match(/\.0+$/))&&(v=Math.max(v,y[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=a[o].t;break;case"m":c==="s"&&(a[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&a[o].v.match(/[Hh]/)&&(g=1),g<2&&a[o].v.match(/[Mm]/)&&(g=2),g<3&&a[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var b="",w;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=rke(a[o].t.charCodeAt(0),a[o].v,u,v),a[o].t="t";break;case"n":case"?":for(w=o+1;a[w]!=null&&((l=a[w].t)==="?"||l==="D"||(l===" "||l==="t")&&a[w+1]!=null&&(a[w+1].t==="?"||a[w+1].t==="t"&&a[w+1].v==="/")||a[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[w].v==="/"||a[w].v===" "&&a[w+1]!=null&&a[w+1].t=="?"));)a[o].v+=a[w].v,a[w]={v:"",t:";"},++w;b+=a[o].v,o=w-1;break;case"G":a[o].t="t",a[o].v=rg(e,r);break}var j="",I,_;if(b.length>0){b.charCodeAt(0)==40?(I=e<0&&b.charCodeAt(0)===45?-e:e,_=qh("n",b,I)):(I=e<0&&n>1?-e:e,_=qh("n",b,I),I<0&&a[0]&&a[0].t=="t"&&(_=_.substr(1),a[0].v="-"+a[0].v)),w=_.length-1;var S=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){S=o;break}var E=a.length;if(S===a.length&&_.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(w>=a[o].v.length-1?(w-=a[o].v.length,a[o].v=_.substr(w+1,a[o].v.length)):w<0?a[o].v="":(a[o].v=_.substr(0,w+1),w=-1),a[o].t="t",E=o);w>=0&&E<a.length&&(a[E].v=_.substr(0,w+1)+a[E].v)}else if(S!==a.length&&_.indexOf("E")===-1){for(w=_.indexOf(".")-1,o=S;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(d=a[o].v.indexOf(".")>-1&&o===S?a[o].v.indexOf(".")-1:a[o].v.length-1,j=a[o].v.substr(d+1);d>=0;--d)w>=0&&(a[o].v.charAt(d)==="0"||a[o].v.charAt(d)==="#")&&(j=_.charAt(w--)+j);a[o].v=j,a[o].t="t",E=o}for(w>=0&&E<a.length&&(a[E].v=_.substr(0,w+1)+a[E].v),w=_.indexOf(".")+1,o=S;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==S)){for(d=a[o].v.indexOf(".")>-1&&o===S?a[o].v.indexOf(".")+1:0,j=a[o].v.substr(0,d);d<a[o].v.length;++d)w<_.length&&(j+=_.charAt(w++));a[o].v=j,a[o].t="t",E=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(I=n>1&&e<0&&o>0&&a[o-1].v==="-"?-e:e,a[o].v=qh(a[o].t,a[o].v,I),a[o].t="t");var F="";for(o=0;o!==a.length;++o)a[o]!=null&&(F+=a[o].v);return F}var UH=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function QH(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function hke(t,e){var r=dke(t),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(UH),l=r[1].match(UH);return QH(e,o)?[n,r[0]]:QH(e,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,s]}function md(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:fn)[t],n==null&&(n=r.table&&r.table[RH[t]]||fn[RH[t]]),n==null&&(n=WTe[t]||"General");break}if(DS(n,0))return rg(e,r);e instanceof Date&&(e=une(e,r.date1904));var a=hke(n,e);if(DS(a[1]))return rg(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return fke(a[1],e,r,a[0])}function zh(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(fn[r]==null){e<0&&(e=r);continue}if(fn[r]==t){e=r;break}}e<0&&(e=391)}return fn[e]=t,e}function Jj(t){for(var e=0;e!=392;++e)t[e]!==void 0&&zh(t[e],e)}function h1(){fn=zTe()}var Ake={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},vne=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function mke(t){var e=typeof t=="number"?fn[t]:t;return e=e.replace(vne,"(\\d+)"),new RegExp("^"+e+"$")}function pke(t,e,r){var n=-1,a=-1,s=-1,o=-1,l=-1,c=-1;(e.match(vne)||[]).forEach(function(f,A){var h=parseInt(r[A+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=h;break;case"d":s=h;break;case"h":o=h;break;case"s":c=h;break;case"m":o>=0?l=h:a=h;break}}),c>=0&&l==-1&&a>=0&&(l=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:n==-1&&a==-1&&s==-1?d:u+"T"+d}var gke=function(){var t={};t.version="1.2.0";function e(){for(var _=0,S=new Array(256),E=0;E!=256;++E)_=E,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,S[E]=_;return typeof Int32Array<"u"?new Int32Array(S):S}var r=e();function n(_){var S=0,E=0,F=0,k=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(F=0;F!=256;++F)k[F]=_[F];for(F=0;F!=256;++F)for(E=_[F],S=256+F;S<4096;S+=256)E=k[S]=E>>>8^_[E&255];var P=[];for(F=1;F!=16;++F)P[F-1]=typeof Int32Array<"u"?k.subarray(F*256,F*256+256):k.slice(F*256,F*256+256);return P}var a=n(r),s=a[0],o=a[1],l=a[2],c=a[3],u=a[4],d=a[5],f=a[6],A=a[7],h=a[8],m=a[9],p=a[10],g=a[11],v=a[12],y=a[13],b=a[14];function w(_,S){for(var E=S^-1,F=0,k=_.length;F<k;)E=E>>>8^r[(E^_.charCodeAt(F++))&255];return~E}function j(_,S){for(var E=S^-1,F=_.length-15,k=0;k<F;)E=b[_[k++]^E&255]^y[_[k++]^E>>8&255]^v[_[k++]^E>>16&255]^g[_[k++]^E>>>24]^p[_[k++]]^m[_[k++]]^h[_[k++]]^A[_[k++]]^f[_[k++]]^d[_[k++]]^u[_[k++]]^c[_[k++]]^l[_[k++]]^o[_[k++]]^s[_[k++]]^r[_[k++]];for(F+=15;k<F;)E=E>>>8^r[(E^_[k++])&255];return~E}function I(_,S){for(var E=S^-1,F=0,k=_.length,P=0,D=0;F<k;)P=_.charCodeAt(F++),P<128?E=E>>>8^r[(E^P)&255]:P<2048?(E=E>>>8^r[(E^(192|P>>6&31))&255],E=E>>>8^r[(E^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,D=_.charCodeAt(F++)&1023,E=E>>>8^r[(E^(240|P>>8&7))&255],E=E>>>8^r[(E^(128|P>>2&63))&255],E=E>>>8^r[(E^(128|D>>6&15|(P&3)<<4))&255],E=E>>>8^r[(E^(128|D&63))&255]):(E=E>>>8^r[(E^(224|P>>12&15))&255],E=E>>>8^r[(E^(128|P>>6&63))&255],E=E>>>8^r[(E^(128|P&63))&255]);return~E}return t.table=r,t.bstr=w,t.buf=j,t.str=I,t}(),nn=function(){var e={};e.version="1.2.1";function r(T,M){for(var V=T.split("/"),q=M.split("/"),Y=0,oe=0,De=Math.min(V.length,q.length);Y<De;++Y){if(oe=V[Y].length-q[Y].length)return oe;if(V[Y]!=q[Y])return V[Y]<q[Y]?-1:1}return V.length-q.length}function n(T){if(T.charAt(T.length-1)=="/")return T.slice(0,-1).indexOf("/")===-1?T:n(T.slice(0,-1));var M=T.lastIndexOf("/");return M===-1?T:T.slice(0,M+1)}function a(T){if(T.charAt(T.length-1)=="/")return a(T.slice(0,-1));var M=T.lastIndexOf("/");return M===-1?T:T.slice(M+1)}function s(T,M){typeof M=="string"&&(M=new Date(M));var V=M.getHours();V=V<<6|M.getMinutes(),V=V<<5|M.getSeconds()>>>1,T.write_shift(2,V);var q=M.getFullYear()-1980;q=q<<4|M.getMonth()+1,q=q<<5|M.getDate(),T.write_shift(2,q)}function o(T){var M=T.read_shift(2)&65535,V=T.read_shift(2)&65535,q=new Date,Y=V&31;V>>>=5;var oe=V&15;V>>>=4,q.setMilliseconds(0),q.setFullYear(V+1980),q.setMonth(oe-1),q.setDate(Y);var De=M&31;M>>>=5;var We=M&63;return M>>>=6,q.setHours(M),q.setMinutes(We),q.setSeconds(De<<1),q}function l(T){il(T,0);for(var M={},V=0;T.l<=T.length-4;){var q=T.read_shift(2),Y=T.read_shift(2),oe=T.l+Y,De={};switch(q){case 21589:V=T.read_shift(1),V&1&&(De.mtime=T.read_shift(4)),Y>5&&(V&2&&(De.atime=T.read_shift(4)),V&4&&(De.ctime=T.read_shift(4))),De.mtime&&(De.mt=new Date(De.mtime*1e3));break}T.l=oe,M[q]=De}return M}var c;function u(){return c||(c={})}function d(T,M){if(T[0]==80&&T[1]==75)return ie(T,M);if((T[0]|32)==109&&(T[1]|32)==105)return be(T,M);if(T.length<512)throw new Error("CFB file size "+T.length+" < 512");var V=3,q=512,Y=0,oe=0,De=0,We=0,dt=0,Oe=[],et=T.slice(0,512);il(et,0);var mt=f(et);switch(V=mt[0],V){case 3:q=512;break;case 4:q=4096;break;case 0:if(mt[1]==0)return ie(T,M);default:throw new Error("Major Version: Expected 3 or 4 saw "+V)}q!==512&&(et=T.slice(0,q),il(et,28));var Tt=T.slice(0,q);A(et,V);var Pt=et.read_shift(4,"i");if(V===3&&Pt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Pt);et.l+=4,De=et.read_shift(4,"i"),et.l+=4,et.chk("00100000","Mini Stream Cutoff Size: "),We=et.read_shift(4,"i"),Y=et.read_shift(4,"i"),dt=et.read_shift(4,"i"),oe=et.read_shift(4,"i");for(var Ft=-1,Xt=0;Xt<109&&(Ft=et.read_shift(4,"i"),!(Ft<0));++Xt)Oe[Xt]=Ft;var mr=h(T,q);g(dt,oe,mr,q,Oe);var Yr=y(mr,De,Oe,q);Yr[De].name="!Directory",Y>0&&We!==D&&(Yr[We].name="!MiniFAT"),Yr[Oe[0]].name="!FAT",Yr.fat_addrs=Oe,Yr.ssz=q;var Br={},Fr=[],vn=[],Ln=[];b(De,Yr,mr,Fr,Y,Br,vn,We),m(vn,Ln,Fr),Fr.shift();var yn={FileIndex:vn,FullPaths:Ln};return M&&M.raw&&(yn.raw={header:Tt,sectors:mr}),yn}function f(T){if(T[T.l]==80&&T[T.l+1]==75)return[0,0];T.chk(X,"Header Signature: "),T.l+=16;var M=T.read_shift(2,"u");return[T.read_shift(2,"u"),M]}function A(T,M){var V=9;switch(T.l+=2,V=T.read_shift(2)){case 9:if(M!=3)throw new Error("Sector Shift: Expected 9 saw "+V);break;case 12:if(M!=4)throw new Error("Sector Shift: Expected 12 saw "+V);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+V)}T.chk("0600","Mini Sector Shift: "),T.chk("000000000000","Reserved: ")}function h(T,M){for(var V=Math.ceil(T.length/M)-1,q=[],Y=1;Y<V;++Y)q[Y-1]=T.slice(Y*M,(Y+1)*M);return q[V-1]=T.slice(V*M),q}function m(T,M,V){for(var q=0,Y=0,oe=0,De=0,We=0,dt=V.length,Oe=[],et=[];q<dt;++q)Oe[q]=et[q]=q,M[q]=V[q];for(;We<et.length;++We)q=et[We],Y=T[q].L,oe=T[q].R,De=T[q].C,Oe[q]===q&&(Y!==-1&&Oe[Y]!==Y&&(Oe[q]=Oe[Y]),oe!==-1&&Oe[oe]!==oe&&(Oe[q]=Oe[oe])),De!==-1&&(Oe[De]=q),Y!==-1&&q!=Oe[q]&&(Oe[Y]=Oe[q],et.lastIndexOf(Y)<We&&et.push(Y)),oe!==-1&&q!=Oe[q]&&(Oe[oe]=Oe[q],et.lastIndexOf(oe)<We&&et.push(oe));for(q=1;q<dt;++q)Oe[q]===q&&(oe!==-1&&Oe[oe]!==oe?Oe[q]=Oe[oe]:Y!==-1&&Oe[Y]!==Y&&(Oe[q]=Oe[Y]));for(q=1;q<dt;++q)if(T[q].type!==0){if(We=q,We!=Oe[We])do We=Oe[We],M[q]=M[We]+"/"+M[q];while(We!==0&&Oe[We]!==-1&&We!=Oe[We]);Oe[q]=-1}for(M[0]+="/",q=1;q<dt;++q)T[q].type!==2&&(M[q]+="/")}function p(T,M,V){for(var q=T.start,Y=T.size,oe=[],De=q;V&&Y>0&&De>=0;)oe.push(M.slice(De*P,De*P+P)),Y-=P,De=cp(V,De*4);return oe.length===0?tr(0):Fo(oe).slice(0,T.size)}function g(T,M,V,q,Y){var oe=D;if(T===D){if(M!==0)throw new Error("DIFAT chain shorter than expected")}else if(T!==-1){var De=V[T],We=(q>>>2)-1;if(!De)return;for(var dt=0;dt<We&&(oe=cp(De,dt*4))!==D;++dt)Y.push(oe);g(cp(De,q-4),M-1,V,q,Y)}}function v(T,M,V,q,Y){var oe=[],De=[];Y||(Y=[]);var We=q-1,dt=0,Oe=0;for(dt=M;dt>=0;){Y[dt]=!0,oe[oe.length]=dt,De.push(T[dt]);var et=V[Math.floor(dt*4/q)];if(Oe=dt*4&We,q<4+Oe)throw new Error("FAT boundary crossed: "+dt+" 4 "+q);if(!T[et])break;dt=cp(T[et],Oe)}return{nodes:oe,data:ZH([De])}}function y(T,M,V,q){var Y=T.length,oe=[],De=[],We=[],dt=[],Oe=q-1,et=0,mt=0,Tt=0,Pt=0;for(et=0;et<Y;++et)if(We=[],Tt=et+M,Tt>=Y&&(Tt-=Y),!De[Tt]){dt=[];var Ft=[];for(mt=Tt;mt>=0;){Ft[mt]=!0,De[mt]=!0,We[We.length]=mt,dt.push(T[mt]);var Xt=V[Math.floor(mt*4/q)];if(Pt=mt*4&Oe,q<4+Pt)throw new Error("FAT boundary crossed: "+mt+" 4 "+q);if(!T[Xt]||(mt=cp(T[Xt],Pt),Ft[mt]))break}oe[Tt]={nodes:We,data:ZH([dt])}}return oe}function b(T,M,V,q,Y,oe,De,We){for(var dt=0,Oe=q.length?2:0,et=M[T].data,mt=0,Tt=0,Pt;mt<et.length;mt+=128){var Ft=et.slice(mt,mt+128);il(Ft,64),Tt=Ft.read_shift(2),Pt=X6(Ft,0,Tt-Oe),q.push(Pt);var Xt={name:Pt,type:Ft.read_shift(1),color:Ft.read_shift(1),L:Ft.read_shift(4,"i"),R:Ft.read_shift(4,"i"),C:Ft.read_shift(4,"i"),clsid:Ft.read_shift(16),state:Ft.read_shift(4,"i"),start:0,size:0},mr=Ft.read_shift(2)+Ft.read_shift(2)+Ft.read_shift(2)+Ft.read_shift(2);mr!==0&&(Xt.ct=w(Ft,Ft.l-8));var Yr=Ft.read_shift(2)+Ft.read_shift(2)+Ft.read_shift(2)+Ft.read_shift(2);Yr!==0&&(Xt.mt=w(Ft,Ft.l-8)),Xt.start=Ft.read_shift(4,"i"),Xt.size=Ft.read_shift(4,"i"),Xt.size<0&&Xt.start<0&&(Xt.size=Xt.type=0,Xt.start=D,Xt.name=""),Xt.type===5?(dt=Xt.start,Y>0&&dt!==D&&(M[dt].name="!StreamData")):Xt.size>=4096?(Xt.storage="fat",M[Xt.start]===void 0&&(M[Xt.start]=v(V,Xt.start,M.fat_addrs,M.ssz)),M[Xt.start].name=Xt.name,Xt.content=M[Xt.start].data.slice(0,Xt.size)):(Xt.storage="minifat",Xt.size<0?Xt.size=0:dt!==D&&Xt.start!==D&&M[dt]&&(Xt.content=p(Xt,M[dt].data,(M[We]||{}).data))),Xt.content&&il(Xt.content,0),oe[Pt]=Xt,De.push(Xt)}}function w(T,M){return new Date((ou(T,M+4)/1e7*Math.pow(2,32)+ou(T,M)/1e7-11644473600)*1e3)}function j(T,M){return u(),d(c.readFileSync(T),M)}function I(T,M){var V=M&&M.type;switch(V||Rn&&Buffer.isBuffer(T)&&(V="buffer"),V||"base64"){case"file":return j(T,M);case"base64":return d(lu(bu(T)),M);case"binary":return d(lu(T),M)}return d(T,M)}function _(T,M){var V=M||{},q=V.root||"Root Entry";if(T.FullPaths||(T.FullPaths=[]),T.FileIndex||(T.FileIndex=[]),T.FullPaths.length!==T.FileIndex.length)throw new Error("inconsistent CFB structure");T.FullPaths.length===0&&(T.FullPaths[0]=q+"/",T.FileIndex[0]={name:q,type:5}),V.CLSID&&(T.FileIndex[0].clsid=V.CLSID),S(T)}function S(T){var M="Sh33tJ5";if(!nn.find(T,"/"+M)){var V=tr(4);V[0]=55,V[1]=V[3]=50,V[2]=54,T.FileIndex.push({name:M,type:2,content:V,size:4,L:69,R:69,C:69}),T.FullPaths.push(T.FullPaths[0]+M),E(T)}}function E(T,M){_(T);for(var V=!1,q=!1,Y=T.FullPaths.length-1;Y>=0;--Y){var oe=T.FileIndex[Y];switch(oe.type){case 0:q?V=!0:(T.FileIndex.pop(),T.FullPaths.pop());break;case 1:case 2:case 5:q=!0,isNaN(oe.R*oe.L*oe.C)&&(V=!0),oe.R>-1&&oe.L>-1&&oe.R==oe.L&&(V=!0);break;default:V=!0;break}}if(!(!V&&!M)){var De=new Date(1987,1,19),We=0,dt=Object.create?Object.create(null):{},Oe=[];for(Y=0;Y<T.FullPaths.length;++Y)dt[T.FullPaths[Y]]=!0,T.FileIndex[Y].type!==0&&Oe.push([T.FullPaths[Y],T.FileIndex[Y]]);for(Y=0;Y<Oe.length;++Y){var et=n(Oe[Y][0]);q=dt[et],q||(Oe.push([et,{name:a(et).replace("/",""),type:1,clsid:ge,ct:De,mt:De,content:null}]),dt[et]=!0)}for(Oe.sort(function(Pt,Ft){return r(Pt[0],Ft[0])}),T.FullPaths=[],T.FileIndex=[],Y=0;Y<Oe.length;++Y)T.FullPaths[Y]=Oe[Y][0],T.FileIndex[Y]=Oe[Y][1];for(Y=0;Y<Oe.length;++Y){var mt=T.FileIndex[Y],Tt=T.FullPaths[Y];if(mt.name=a(Tt).replace("/",""),mt.L=mt.R=mt.C=-(mt.color=1),mt.size=mt.content?mt.content.length:0,mt.start=0,mt.clsid=mt.clsid||ge,Y===0)mt.C=Oe.length>1?1:-1,mt.size=0,mt.type=5;else if(Tt.slice(-1)=="/"){for(We=Y+1;We<Oe.length&&n(T.FullPaths[We])!=Tt;++We);for(mt.C=We>=Oe.length?-1:We,We=Y+1;We<Oe.length&&n(T.FullPaths[We])!=n(Tt);++We);mt.R=We>=Oe.length?-1:We,mt.type=1}else n(T.FullPaths[Y+1]||"")==n(Tt)&&(mt.R=Y+1),mt.type=2}}}function F(T,M){var V=M||{};if(V.fileType=="mad")return st(T,V);switch(E(T),V.fileType){case"zip":return de(T,V)}var q=function(Pt){for(var Ft=0,Xt=0,mr=0;mr<Pt.FileIndex.length;++mr){var Yr=Pt.FileIndex[mr];if(Yr.content){var Br=Yr.content.length;Br>0&&(Br<4096?Ft+=Br+63>>6:Xt+=Br+511>>9)}}for(var Fr=Pt.FullPaths.length+3>>2,vn=Ft+7>>3,Ln=Ft+127>>7,yn=vn+Xt+Fr+Ln,In=yn+127>>7,Ua=In<=109?0:Math.ceil((In-109)/127);yn+In+Ua+127>>7>In;)Ua=++In<=109?0:Math.ceil((In-109)/127);var Je=[1,Ua,In,Ln,Fr,Xt,Ft,0];return Pt.FileIndex[0].size=Ft<<6,Je[7]=(Pt.FileIndex[0].start=Je[0]+Je[1]+Je[2]+Je[3]+Je[4]+Je[5])+(Je[6]+7>>3),Je}(T),Y=tr(q[7]<<9),oe=0,De=0;{for(oe=0;oe<8;++oe)Y.write_shift(1,pe[oe]);for(oe=0;oe<8;++oe)Y.write_shift(2,0);for(Y.write_shift(2,62),Y.write_shift(2,3),Y.write_shift(2,65534),Y.write_shift(2,9),Y.write_shift(2,6),oe=0;oe<3;++oe)Y.write_shift(2,0);for(Y.write_shift(4,0),Y.write_shift(4,q[2]),Y.write_shift(4,q[0]+q[1]+q[2]+q[3]-1),Y.write_shift(4,0),Y.write_shift(4,4096),Y.write_shift(4,q[3]?q[0]+q[1]+q[2]-1:D),Y.write_shift(4,q[3]),Y.write_shift(-4,q[1]?q[0]-1:D),Y.write_shift(4,q[1]),oe=0;oe<109;++oe)Y.write_shift(-4,oe<q[2]?q[1]+oe:-1)}if(q[1])for(De=0;De<q[1];++De){for(;oe<236+De*127;++oe)Y.write_shift(-4,oe<q[2]?q[1]+oe:-1);Y.write_shift(-4,De===q[1]-1?D:De+1)}var We=function(Pt){for(De+=Pt;oe<De-1;++oe)Y.write_shift(-4,oe+1);Pt&&(++oe,Y.write_shift(-4,D))};for(De=oe=0,De+=q[1];oe<De;++oe)Y.write_shift(-4,fe.DIFSECT);for(De+=q[2];oe<De;++oe)Y.write_shift(-4,fe.FATSECT);We(q[3]),We(q[4]);for(var dt=0,Oe=0,et=T.FileIndex[0];dt<T.FileIndex.length;++dt)et=T.FileIndex[dt],et.content&&(Oe=et.content.length,!(Oe<4096)&&(et.start=De,We(Oe+511>>9)));for(We(q[6]+7>>3);Y.l&511;)Y.write_shift(-4,fe.ENDOFCHAIN);for(De=oe=0,dt=0;dt<T.FileIndex.length;++dt)et=T.FileIndex[dt],et.content&&(Oe=et.content.length,!(!Oe||Oe>=4096)&&(et.start=De,We(Oe+63>>6)));for(;Y.l&511;)Y.write_shift(-4,fe.ENDOFCHAIN);for(oe=0;oe<q[4]<<2;++oe){var mt=T.FullPaths[oe];if(!mt||mt.length===0){for(dt=0;dt<17;++dt)Y.write_shift(4,0);for(dt=0;dt<3;++dt)Y.write_shift(4,-1);for(dt=0;dt<12;++dt)Y.write_shift(4,0);continue}et=T.FileIndex[oe],oe===0&&(et.start=et.size?et.start-1:D);var Tt=oe===0&&V.root||et.name;if(Oe=2*(Tt.length+1),Y.write_shift(64,Tt,"utf16le"),Y.write_shift(2,Oe),Y.write_shift(1,et.type),Y.write_shift(1,et.color),Y.write_shift(-4,et.L),Y.write_shift(-4,et.R),Y.write_shift(-4,et.C),et.clsid)Y.write_shift(16,et.clsid,"hex");else for(dt=0;dt<4;++dt)Y.write_shift(4,0);Y.write_shift(4,et.state||0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,et.start),Y.write_shift(4,et.size),Y.write_shift(4,0)}for(oe=1;oe<T.FileIndex.length;++oe)if(et=T.FileIndex[oe],et.size>=4096)if(Y.l=et.start+1<<9,Rn&&Buffer.isBuffer(et.content))et.content.copy(Y,Y.l,0,et.size),Y.l+=et.size+511&-512;else{for(dt=0;dt<et.size;++dt)Y.write_shift(1,et.content[dt]);for(;dt&511;++dt)Y.write_shift(1,0)}for(oe=1;oe<T.FileIndex.length;++oe)if(et=T.FileIndex[oe],et.size>0&&et.size<4096)if(Rn&&Buffer.isBuffer(et.content))et.content.copy(Y,Y.l,0,et.size),Y.l+=et.size+63&-64;else{for(dt=0;dt<et.size;++dt)Y.write_shift(1,et.content[dt]);for(;dt&63;++dt)Y.write_shift(1,0)}if(Rn)Y.l=Y.length;else for(;Y.l<Y.length;)Y.write_shift(1,0);return Y}function k(T,M){var V=T.FullPaths.map(function(dt){return dt.toUpperCase()}),q=V.map(function(dt){var Oe=dt.split("/");return Oe[Oe.length-(dt.slice(-1)=="/"?2:1)]}),Y=!1;M.charCodeAt(0)===47?(Y=!0,M=V[0].slice(0,-1)+M):Y=M.indexOf("/")!==-1;var oe=M.toUpperCase(),De=Y===!0?V.indexOf(oe):q.indexOf(oe);if(De!==-1)return T.FileIndex[De];var We=!oe.match($y);for(oe=oe.replace(dc,""),We&&(oe=oe.replace($y,"!")),De=0;De<V.length;++De)if((We?V[De].replace($y,"!"):V[De]).replace(dc,"")==oe||(We?q[De].replace($y,"!"):q[De]).replace(dc,"")==oe)return T.FileIndex[De];return null}var P=64,D=-2,X="d0cf11e0a1b11ae1",pe=[208,207,17,224,161,177,26,225],ge="00000000000000000000000000000000",fe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:D,FREESECT:-1,HEADER_SIGNATURE:X,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ge,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function xe(T,M,V){u();var q=F(T,V);c.writeFileSync(M,q)}function ae(T){for(var M=new Array(T.length),V=0;V<T.length;++V)M[V]=String.fromCharCode(T[V]);return M.join("")}function Se(T,M){var V=F(T,M);switch(M&&M.type||"buffer"){case"file":return u(),c.writeFileSync(M.filename,V),V;case"binary":return typeof V=="string"?V:ae(V);case"base64":return N2(typeof V=="string"?V:ae(V));case"buffer":if(Rn)return Buffer.isBuffer(V)?V:wA(V);case"array":return typeof V=="string"?lu(V):V}return V}var Te;function O(T){try{var M=T.InflateRaw,V=new M;if(V._processChunk(new Uint8Array([3,0]),V._finishFlushFlag),V.bytesRead)Te=T;else throw new Error("zlib does not expose bytesRead")}catch(q){console.error("cannot use native zlib: "+(q.message||q))}}function G(T,M){if(!Te)return me(T,M);var V=Te.InflateRaw,q=new V,Y=q._processChunk(T.slice(T.l),q._finishFlushFlag);return T.l+=q.bytesRead,Y}function z(T){return Te?Te.deflateRawSync(T):he(T)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ee=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function R(T){var M=(T<<1|T<<11)&139536|(T<<5|T<<15)&558144;return(M>>16|M>>8|M)&255}for(var H=typeof Uint8Array<"u",ne=H?new Uint8Array(256):[],ve=0;ve<256;++ve)ne[ve]=R(ve);function U(T,M){var V=ne[T&255];return M<=8?V>>>8-M:(V=V<<8|ne[T>>8&255],M<=16?V>>>16-M:(V=V<<8|ne[T>>16&255],V>>>24-M))}function He(T,M){var V=M&7,q=M>>>3;return(T[q]|(V<=6?0:T[q+1]<<8))>>>V&3}function se(T,M){var V=M&7,q=M>>>3;return(T[q]|(V<=5?0:T[q+1]<<8))>>>V&7}function re(T,M){var V=M&7,q=M>>>3;return(T[q]|(V<=4?0:T[q+1]<<8))>>>V&15}function Pe(T,M){var V=M&7,q=M>>>3;return(T[q]|(V<=3?0:T[q+1]<<8))>>>V&31}function ue(T,M){var V=M&7,q=M>>>3;return(T[q]|(V<=1?0:T[q+1]<<8))>>>V&127}function we(T,M,V){var q=M&7,Y=M>>>3,oe=(1<<V)-1,De=T[Y]>>>q;return V<8-q||(De|=T[Y+1]<<8-q,V<16-q)||(De|=T[Y+2]<<16-q,V<24-q)||(De|=T[Y+3]<<24-q),De&oe}function Me(T,M,V){var q=M&7,Y=M>>>3;return q<=5?T[Y]|=(V&7)<<q:(T[Y]|=V<<q&255,T[Y+1]=(V&7)>>8-q),M+3}function ze(T,M,V){var q=M&7,Y=M>>>3;return V=(V&1)<<q,T[Y]|=V,M+1}function yt(T,M,V){var q=M&7,Y=M>>>3;return V<<=q,T[Y]|=V&255,V>>>=8,T[Y+1]=V,M+8}function It(T,M,V){var q=M&7,Y=M>>>3;return V<<=q,T[Y]|=V&255,V>>>=8,T[Y+1]=V&255,T[Y+2]=V>>>8,M+16}function Ke(T,M){var V=T.length,q=2*V>M?2*V:M+5,Y=0;if(V>=M)return T;if(Rn){var oe=FH(q);if(T.copy)T.copy(oe);else for(;Y<T.length;++Y)oe[Y]=T[Y];return oe}else if(H){var De=new Uint8Array(q);if(De.set)De.set(T);else for(;Y<V;++Y)De[Y]=T[Y];return De}return T.length=q,T}function wt(T){for(var M=new Array(T),V=0;V<T;++V)M[V]=0;return M}function At(T,M,V){var q=1,Y=0,oe=0,De=0,We=0,dt=T.length,Oe=H?new Uint16Array(32):wt(32);for(oe=0;oe<32;++oe)Oe[oe]=0;for(oe=dt;oe<V;++oe)T[oe]=0;dt=T.length;var et=H?new Uint16Array(dt):wt(dt);for(oe=0;oe<dt;++oe)Oe[Y=T[oe]]++,q<Y&&(q=Y),et[oe]=0;for(Oe[0]=0,oe=1;oe<=q;++oe)Oe[oe+16]=We=We+Oe[oe-1]<<1;for(oe=0;oe<dt;++oe)We=T[oe],We!=0&&(et[oe]=Oe[We+16]++);var mt=0;for(oe=0;oe<dt;++oe)if(mt=T[oe],mt!=0)for(We=U(et[oe],q)>>q-mt,De=(1<<q+4-mt)-1;De>=0;--De)M[We|De<<mt]=mt&15|oe<<4;return q}var bt=H?new Uint16Array(512):wt(512),ke=H?new Uint16Array(32):wt(32);if(!H){for(var Ne=0;Ne<512;++Ne)bt[Ne]=0;for(Ne=0;Ne<32;++Ne)ke[Ne]=0}(function(){for(var T=[],M=0;M<32;M++)T.push(5);At(T,ke,32);var V=[];for(M=0;M<=143;M++)V.push(8);for(;M<=255;M++)V.push(9);for(;M<=279;M++)V.push(7);for(;M<=287;M++)V.push(8);At(V,bt,288)})();var Ve=function(){for(var M=H?new Uint8Array(32768):[],V=0,q=0;V<ee.length-1;++V)for(;q<ee[V+1];++q)M[q]=V;for(;q<32768;++q)M[q]=29;var Y=H?new Uint8Array(259):[];for(V=0,q=0;V<Z.length-1;++V)for(;q<Z[V+1];++q)Y[q]=V;function oe(We,dt){for(var Oe=0;Oe<We.length;){var et=Math.min(65535,We.length-Oe),mt=Oe+et==We.length;for(dt.write_shift(1,+mt),dt.write_shift(2,et),dt.write_shift(2,~et&65535);et-- >0;)dt[dt.l++]=We[Oe++]}return dt.l}function De(We,dt){for(var Oe=0,et=0,mt=H?new Uint16Array(32768):[];et<We.length;){var Tt=Math.min(65535,We.length-et);if(Tt<10){for(Oe=Me(dt,Oe,+(et+Tt==We.length)),Oe&7&&(Oe+=8-(Oe&7)),dt.l=Oe/8|0,dt.write_shift(2,Tt),dt.write_shift(2,~Tt&65535);Tt-- >0;)dt[dt.l++]=We[et++];Oe=dt.l*8;continue}Oe=Me(dt,Oe,+(et+Tt==We.length)+2);for(var Pt=0;Tt-- >0;){var Ft=We[et];Pt=(Pt<<5^Ft)&32767;var Xt=-1,mr=0;if((Xt=mt[Pt])&&(Xt|=et&-32768,Xt>et&&(Xt-=32768),Xt<et))for(;We[Xt+mr]==We[et+mr]&&mr<250;)++mr;if(mr>2){Ft=Y[mr],Ft<=22?Oe=yt(dt,Oe,ne[Ft+1]>>1)-1:(yt(dt,Oe,3),Oe+=5,yt(dt,Oe,ne[Ft-23]>>5),Oe+=3);var Yr=Ft<8?0:Ft-4>>2;Yr>0&&(It(dt,Oe,mr-Z[Ft]),Oe+=Yr),Ft=M[et-Xt],Oe=yt(dt,Oe,ne[Ft]>>3),Oe-=3;var Br=Ft<4?0:Ft-2>>1;Br>0&&(It(dt,Oe,et-Xt-ee[Ft]),Oe+=Br);for(var Fr=0;Fr<mr;++Fr)mt[Pt]=et&32767,Pt=(Pt<<5^We[et])&32767,++et;Tt-=mr-1}else Ft<=143?Ft=Ft+48:Oe=ze(dt,Oe,1),Oe=yt(dt,Oe,ne[Ft]),mt[Pt]=et&32767,++et}Oe=yt(dt,Oe,0)-1}return dt.l=(Oe+7)/8|0,dt.l}return function(dt,Oe){return dt.length<8?oe(dt,Oe):De(dt,Oe)}}();function he(T){var M=tr(50+Math.floor(T.length*1.1)),V=Ve(T,M);return M.slice(0,V)}var le=H?new Uint16Array(32768):wt(32768),Be=H?new Uint16Array(32768):wt(32768),je=H?new Uint16Array(128):wt(128),Ae=1,Qe=1;function Ct(T,M){var V=Pe(T,M)+257;M+=5;var q=Pe(T,M)+1;M+=5;var Y=re(T,M)+4;M+=4;for(var oe=0,De=H?new Uint8Array(19):wt(19),We=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],dt=1,Oe=H?new Uint8Array(8):wt(8),et=H?new Uint8Array(8):wt(8),mt=De.length,Tt=0;Tt<Y;++Tt)De[L[Tt]]=oe=se(T,M),dt<oe&&(dt=oe),Oe[oe]++,M+=3;var Pt=0;for(Oe[0]=0,Tt=1;Tt<=dt;++Tt)et[Tt]=Pt=Pt+Oe[Tt-1]<<1;for(Tt=0;Tt<mt;++Tt)(Pt=De[Tt])!=0&&(We[Tt]=et[Pt]++);var Ft=0;for(Tt=0;Tt<mt;++Tt)if(Ft=De[Tt],Ft!=0){Pt=ne[We[Tt]]>>8-Ft;for(var Xt=(1<<7-Ft)-1;Xt>=0;--Xt)je[Pt|Xt<<Ft]=Ft&7|Tt<<3}var mr=[];for(dt=1;mr.length<V+q;)switch(Pt=je[ue(T,M)],M+=Pt&7,Pt>>>=3){case 16:for(oe=3+He(T,M),M+=2,Pt=mr[mr.length-1];oe-- >0;)mr.push(Pt);break;case 17:for(oe=3+se(T,M),M+=3;oe-- >0;)mr.push(0);break;case 18:for(oe=11+ue(T,M),M+=7;oe-- >0;)mr.push(0);break;default:mr.push(Pt),dt<Pt&&(dt=Pt);break}var Yr=mr.slice(0,V),Br=mr.slice(V);for(Tt=V;Tt<286;++Tt)Yr[Tt]=0;for(Tt=q;Tt<30;++Tt)Br[Tt]=0;return Ae=At(Yr,le,286),Qe=At(Br,Be,30),M}function pt(T,M){if(T[0]==3&&!(T[1]&3))return[hm(M),2];for(var V=0,q=0,Y=FH(M||1<<18),oe=0,De=Y.length>>>0,We=0,dt=0;!(q&1);){if(q=se(T,V),V+=3,q>>>1)q>>1==1?(We=9,dt=5):(V=Ct(T,V),We=Ae,dt=Qe);else{V&7&&(V+=8-(V&7));var Oe=T[V>>>3]|T[(V>>>3)+1]<<8;if(V+=32,Oe>0)for(!M&&De<oe+Oe&&(Y=Ke(Y,oe+Oe),De=Y.length);Oe-- >0;)Y[oe++]=T[V>>>3],V+=8;continue}for(;;){!M&&De<oe+32767&&(Y=Ke(Y,oe+32767),De=Y.length);var et=we(T,V,We),mt=q>>>1==1?bt[et]:le[et];if(V+=mt&15,mt>>>=4,!(mt>>>8&255))Y[oe++]=mt;else{if(mt==256)break;mt-=257;var Tt=mt<8?0:mt-4>>2;Tt>5&&(Tt=0);var Pt=oe+Z[mt];Tt>0&&(Pt+=we(T,V,Tt),V+=Tt),et=we(T,V,dt),mt=q>>>1==1?ke[et]:Be[et],V+=mt&15,mt>>>=4;var Ft=mt<4?0:mt-2>>1,Xt=ee[mt];for(Ft>0&&(Xt+=we(T,V,Ft),V+=Ft),!M&&De<Pt&&(Y=Ke(Y,Pt+100),De=Y.length);oe<Pt;)Y[oe]=Y[oe-Xt],++oe}}}return M?[Y,V+7>>>3]:[Y.slice(0,oe),V+7>>>3]}function me(T,M){var V=T.slice(T.l||0),q=pt(V,M);return T.l+=q[1],q[0]}function te(T,M){if(T)typeof console<"u"&&console.error(M);else throw new Error(M)}function ie(T,M){var V=T;il(V,0);var q=[],Y=[],oe={FileIndex:q,FullPaths:Y};_(oe,{root:M.root});for(var De=V.length-4;(V[De]!=80||V[De+1]!=75||V[De+2]!=5||V[De+3]!=6)&&De>=0;)--De;V.l=De+4,V.l+=4;var We=V.read_shift(2);V.l+=6;var dt=V.read_shift(4);for(V.l=dt,De=0;De<We;++De){V.l+=20;var Oe=V.read_shift(4),et=V.read_shift(4),mt=V.read_shift(2),Tt=V.read_shift(2),Pt=V.read_shift(2);V.l+=8;var Ft=V.read_shift(4),Xt=l(V.slice(V.l+mt,V.l+mt+Tt));V.l+=mt+Tt+Pt;var mr=V.l;V.l=Ft+4,$e(V,Oe,et,oe,Xt),V.l=mr}return oe}function $e(T,M,V,q,Y){T.l+=2;var oe=T.read_shift(2),De=T.read_shift(2),We=o(T);if(oe&8257)throw new Error("Unsupported ZIP encryption");for(var dt=T.read_shift(4),Oe=T.read_shift(4),et=T.read_shift(4),mt=T.read_shift(2),Tt=T.read_shift(2),Pt="",Ft=0;Ft<mt;++Ft)Pt+=String.fromCharCode(T[T.l++]);if(Tt){var Xt=l(T.slice(T.l,T.l+Tt));(Xt[21589]||{}).mt&&(We=Xt[21589].mt),((Y||{})[21589]||{}).mt&&(We=Y[21589].mt)}T.l+=Tt;var mr=T.slice(T.l,T.l+Oe);switch(De){case 8:mr=G(T,et);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+De)}var Yr=!1;oe&8&&(dt=T.read_shift(4),dt==134695760&&(dt=T.read_shift(4),Yr=!0),Oe=T.read_shift(4),et=T.read_shift(4)),Oe!=M&&te(Yr,"Bad compressed size: "+M+" != "+Oe),et!=V&&te(Yr,"Bad uncompressed size: "+V+" != "+et),Ie(q,Pt,mr,{unsafe:!0,mt:We})}function de(T,M){var V=M||{},q=[],Y=[],oe=tr(1),De=V.compression?8:0,We=0,dt=0,Oe=0,et=0,mt=0,Tt=T.FullPaths[0],Pt=Tt,Ft=T.FileIndex[0],Xt=[],mr=0;for(dt=1;dt<T.FullPaths.length;++dt)if(Pt=T.FullPaths[dt].slice(Tt.length),Ft=T.FileIndex[dt],!(!Ft.size||!Ft.content||Pt=="Sh33tJ5")){var Yr=et,Br=tr(Pt.length);for(Oe=0;Oe<Pt.length;++Oe)Br.write_shift(1,Pt.charCodeAt(Oe)&127);Br=Br.slice(0,Br.l),Xt[mt]=gke.buf(Ft.content,0);var Fr=Ft.content;De==8&&(Fr=z(Fr)),oe=tr(30),oe.write_shift(4,67324752),oe.write_shift(2,20),oe.write_shift(2,We),oe.write_shift(2,De),Ft.mt?s(oe,Ft.mt):oe.write_shift(4,0),oe.write_shift(-4,Xt[mt]),oe.write_shift(4,Fr.length),oe.write_shift(4,Ft.content.length),oe.write_shift(2,Br.length),oe.write_shift(2,0),et+=oe.length,q.push(oe),et+=Br.length,q.push(Br),et+=Fr.length,q.push(Fr),oe=tr(46),oe.write_shift(4,33639248),oe.write_shift(2,0),oe.write_shift(2,20),oe.write_shift(2,We),oe.write_shift(2,De),oe.write_shift(4,0),oe.write_shift(-4,Xt[mt]),oe.write_shift(4,Fr.length),oe.write_shift(4,Ft.content.length),oe.write_shift(2,Br.length),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(4,0),oe.write_shift(4,Yr),mr+=oe.l,Y.push(oe),mr+=Br.length,Y.push(Br),++mt}return oe=tr(22),oe.write_shift(4,101010256),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,mt),oe.write_shift(2,mt),oe.write_shift(4,mr),oe.write_shift(4,et),oe.write_shift(2,0),Fo([Fo(q),Fo(Y),oe])}var Ce={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function nt(T,M){if(T.ctype)return T.ctype;var V=T.name||"",q=V.match(/\.([^\.]+)$/);return q&&Ce[q[1]]||M&&(q=(V=M).match(/[\.\\]([^\.\\])+$/),q&&Ce[q[1]])?Ce[q[1]]:"application/octet-stream"}function vt(T){for(var M=N2(T),V=[],q=0;q<M.length;q+=76)V.push(M.slice(q,q+76));return V.join(`\r
`)+`\r
`}function ht(T){var M=T.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Oe){var et=Oe.charCodeAt(0).toString(16).toUpperCase();return"="+(et.length==1?"0"+et:et)});M=M.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),M.charAt(0)==`
`&&(M="=0D"+M.slice(1)),M=M.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var V=[],q=M.split(`\r
`),Y=0;Y<q.length;++Y){var oe=q[Y];if(oe.length==0){V.push("");continue}for(var De=0;De<oe.length;){var We=76,dt=oe.slice(De,De+We);dt.charAt(We-1)=="="?We--:dt.charAt(We-2)=="="?We-=2:dt.charAt(We-3)=="="&&(We-=3),dt=oe.slice(De,De+We),De+=We,De<oe.length&&(dt+="="),V.push(dt)}}return V.join(`\r
`)}function xt(T){for(var M=[],V=0;V<T.length;++V){for(var q=T[V];V<=T.length&&q.charAt(q.length-1)=="=";)q=q.slice(0,q.length-1)+T[++V];M.push(q)}for(var Y=0;Y<M.length;++Y)M[Y]=M[Y].replace(/[=][0-9A-Fa-f]{2}/g,function(oe){return String.fromCharCode(parseInt(oe.slice(1),16))});return lu(M.join(`\r
`))}function Xe(T,M,V){for(var q="",Y="",oe="",De,We=0;We<10;++We){var dt=M[We];if(!dt||dt.match(/^\s*$/))break;var Oe=dt.match(/^(.*?):\s*([^\s].*)$/);if(Oe)switch(Oe[1].toLowerCase()){case"content-location":q=Oe[2].trim();break;case"content-type":oe=Oe[2].trim();break;case"content-transfer-encoding":Y=Oe[2].trim();break}}switch(++We,Y.toLowerCase()){case"base64":De=lu(bu(M.slice(We).join("")));break;case"quoted-printable":De=xt(M.slice(We));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Y)}var et=Ie(T,q.slice(V.length),De,{unsafe:!0});oe&&(et.ctype=oe)}function be(T,M){if(ae(T.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var V=M&&M.root||"",q=(Rn&&Buffer.isBuffer(T)?T.toString("binary"):ae(T)).split(`\r
`),Y=0,oe="";for(Y=0;Y<q.length;++Y)if(oe=q[Y],!!/^Content-Location:/i.test(oe)&&(oe=oe.slice(oe.indexOf("file")),V||(V=oe.slice(0,oe.lastIndexOf("/")+1)),oe.slice(0,V.length)!=V))for(;V.length>0&&(V=V.slice(0,V.length-1),V=V.slice(0,V.lastIndexOf("/")+1),oe.slice(0,V.length)!=V););var De=(q[1]||"").match(/boundary="(.*?)"/);if(!De)throw new Error("MAD cannot find boundary");var We="--"+(De[1]||""),dt=[],Oe=[],et={FileIndex:dt,FullPaths:Oe};_(et);var mt,Tt=0;for(Y=0;Y<q.length;++Y){var Pt=q[Y];Pt!==We&&Pt!==We+"--"||(Tt++&&Xe(et,q.slice(mt,Y),V),mt=Y)}return et}function st(T,M){var V=M||{},q=V.boundary||"SheetJS";q="------="+q;for(var Y=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+q.slice(2)+'"',"","",""],oe=T.FullPaths[0],De=oe,We=T.FileIndex[0],dt=1;dt<T.FullPaths.length;++dt)if(De=T.FullPaths[dt].slice(oe.length),We=T.FileIndex[dt],!(!We.size||!We.content||De=="Sh33tJ5")){De=De.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(mr){return"_x"+mr.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(mr){return"_u"+mr.charCodeAt(0).toString(16)+"_"});for(var Oe=We.content,et=Rn&&Buffer.isBuffer(Oe)?Oe.toString("binary"):ae(Oe),mt=0,Tt=Math.min(1024,et.length),Pt=0,Ft=0;Ft<=Tt;++Ft)(Pt=et.charCodeAt(Ft))>=32&&Pt<128&&++mt;var Xt=mt>=Tt*4/5;Y.push(q),Y.push("Content-Location: "+(V.root||"file:///C:/SheetJS/")+De),Y.push("Content-Transfer-Encoding: "+(Xt?"quoted-printable":"base64")),Y.push("Content-Type: "+nt(We,De)),Y.push(""),Y.push(Xt?ht(et):vt(et))}return Y.push(q+`--\r
`),Y.join(`\r
`)}function K(T){var M={};return _(M,T),M}function Ie(T,M,V,q){var Y=q&&q.unsafe;Y||_(T);var oe=!Y&&nn.find(T,M);if(!oe){var De=T.FullPaths[0];M.slice(0,De.length)==De?De=M:(De.slice(-1)!="/"&&(De+="/"),De=(De+M).replace("//","/")),oe={name:a(M),type:2},T.FileIndex.push(oe),T.FullPaths.push(De),Y||nn.utils.cfb_gc(T)}return oe.content=V,oe.size=V?V.length:0,q&&(q.CLSID&&(oe.clsid=q.CLSID),q.mt&&(oe.mt=q.mt),q.ct&&(oe.ct=q.ct)),oe}function Ze(T,M){_(T);var V=nn.find(T,M);if(V){for(var q=0;q<T.FileIndex.length;++q)if(T.FileIndex[q]==V)return T.FileIndex.splice(q,1),T.FullPaths.splice(q,1),!0}return!1}function at(T,M,V){_(T);var q=nn.find(T,M);if(q){for(var Y=0;Y<T.FileIndex.length;++Y)if(T.FileIndex[Y]==q)return T.FileIndex[Y].name=a(V),T.FullPaths[Y]=V,!0}return!1}function it(T){E(T,!0)}return e.find=k,e.read=I,e.parse=d,e.write=Se,e.writeFile=xe,e.utils={cfb_new:K,cfb_add:Ie,cfb_del:Ze,cfb_mov:at,cfb_gc:it,ReadShift:Nb,CheckField:Qne,prep_blob:il,bconcat:Fo,use_zlib:O,_deflateRaw:he,_inflateRaw:me,consts:fe},e}();function xke(t){return typeof t=="string"?Yj(t):Array.isArray(t)?$Te(t):t}function Pw(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Yj(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Mf(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var a=new Blob([xke(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(t);return l.open("w"),l.encoding="binary",Array.isArray(e)&&(e=Em(e)),l.write(e),l.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function vke(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function hi(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function VH(t,e){for(var r=[],n=hi(t),a=0;a!==n.length;++a)r[t[n[a]][e]]==null&&(r[t[n[a]][e]]=n[a]);return r}function Zj(t){for(var e=[],r=hi(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function eP(t){for(var e=[],r=hi(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function yke(t){for(var e=[],r=hi(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var MS=new Date(1899,11,30,0,0,0);function mo(t,e){var r=t.getTime(),n=MS.getTime()+(t.getTimezoneOffset()-MS.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var yne=new Date,bke=MS.getTime()+(yne.getTimezoneOffset()-MS.getTimezoneOffset())*6e4,HH=yne.getTimezoneOffset();function tP(t){var e=new Date;return e.setTime(t*24*60*60*1e3+bke),e.getTimezoneOffset()!==HH&&e.setTime(e.getTime()+(e.getTimezoneOffset()-HH)*6e4),e}function wke(t){var e=0,r=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(a[s],10)}return e}var $H=new Date("2017-02-19T19:06:09.000Z"),bne=isNaN($H.getFullYear())?new Date("2/19/17"):$H,Nke=bne.getFullYear()==2017;function gs(t,e){var r=new Date(t);if(Nke)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(bne.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ng(t,e){if(Rn&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Mf(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Mf(lne(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Mf(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Mf(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function xs(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=xs(t[r]));return e}function ci(t,e){for(var r="";r.length<e;)r+=t;return r}function ef(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var Cke=["january","february","march","april","may","june","july","august","september","october","november","december"];function kv(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),a=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&Cke.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var _ke=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],l=1;l<s.length;++l)o.push(a),o.push(s[l]);return o}}();function wne(t){return t?t.content&&t.type?ng(t.content,!0):t.data?Hy(t.data):t.asNodeBuffer&&Rn?Hy(t.asNodeBuffer().toString("binary")):t.asBinary?Hy(t.asBinary()):t._data&&t._data.getContent?Hy(ng(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function Nne(t){if(!t)return null;if(t.data)return TH(t.data);if(t.asNodeBuffer&&Rn)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?TH(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function Eke(t){return t&&t.name.slice(-4)===".bin"?Nne(t):wne(t)}function Xu(t,e){for(var r=t.FullPaths||hi(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function $6(t,e){var r=Xu(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Ri(t,e,r){if(!r)return Eke($6(t,e));if(!e)return null;try{return Ri(t,e)}catch{return null}}function cu(t,e,r){if(!r)return wne($6(t,e));if(!e)return null;try{return cu(t,e)}catch{return null}}function Ske(t,e,r){return Nne($6(t,e))}function GH(t){for(var e=t.FullPaths||hi(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function kn(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Rn?n=wA(r):n=GTe(r),nn.utils.cfb_add(t,e,n)}nn.utils.cfb_add(t,e,r)}else t.file(e,r)}function G6(){return nn.utils.cfb_new()}function Cne(t,e){switch(e.type){case"base64":return nn.read(t,{type:"base64"});case"binary":return nn.read(t,{type:"binary"});case"buffer":case"array":return nn.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Gy(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var ki=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Ike=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,KH=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,jke=/<[^>]*>/g,Hl=ki.match(KH)?KH:jke,Pke=/<\w*:/,Bke=/<(\/?)\w+:/;function An(t,e,r){for(var n={},a=0,s=0;a!==t.length&&!((s=t.charCodeAt(a))===32||s===10||s===13);++a);if(e||(n[0]=t.slice(0,a)),a===t.length)return n;var o=t.match(Ike),l=0,c="",u=0,d="",f="",A=1;if(o)for(u=0;u!=o.length;++u){for(f=o[u],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(d=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(A=(a=f.charCodeAt(s+1))==34||a==39?1:0,c=f.slice(s+1+A,f.length-A),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var h=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(n[h]&&d.slice(l-3,l)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function th(t){return t.replace(Bke,"<$1")}var _ne={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},K6=Zj(_ne),ia=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(t,function(l,c){return _ne[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(e,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,o)+r(a.slice(o+3))}}(),q6=/[&<>'"]/g,Tke=/[\u0000-\u0008\u000b-\u001f]/g;function Ra(t){var e=t+"";return e.replace(q6,function(r){return K6[r]}).replace(Tke,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function qH(t){return Ra(t).replace(/ /g,"_x0020_")}var Ene=/[\u0000-\u001f]/g;function z6(t){var e=t+"";return e.replace(q6,function(r){return K6[r]}).replace(/\n/g,"<br/>").replace(Ene,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function kke(t){var e=t+"";return e.replace(q6,function(r){return K6[r]}).replace(Ene,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var zH=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Fke(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function hs(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function C5(t){for(var e="",r=0,n=0,a=0,s=0,o=0,l=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(a=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,e+=String.fromCharCode(o);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}o=t.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(s&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(l>>>10&1023)),e+=String.fromCharCode(56320+(l&1023))}return e}function WH(t){var e=hm(2*t.length),r,n,a=1,s=0,o=0,l;for(n=0;n<t.length;n+=a)a=1,(l=t.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(t.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[s++]=o&255,e[s++]=o>>>8,o=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function XH(t){return wA(t,"binary").toString("utf8")}var $C="foo bar baz",Ga=Rn&&(XH($C)==C5($C)&&XH||WH($C)==C5($C)&&WH)||C5,Mf=Rn?function(t){return wA(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,a=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},_2=function(){var t={};return function(r,n){var a=r+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),Sne=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}}(),Oke=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Dke=/<\/?(?:vt:)?variant>/g,Rke=/<(?:vt:)([^>]*)>([\s\S]*)</;function YH(t,e){var r=An(t),n=t.match(Oke(r.baseType))||[],a=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var o=s.replace(Dke,"").match(Rke);o&&a.push({v:Ga(o[2]),t:o[1]})}),a}var Ine=/(^\s|\s$|\n)/;function ll(t,e){return"<"+t+(e.match(Ine)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function E2(t){return hi(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function _r(t,e,r){return"<"+t+(r!=null?E2(r):"")+(e!=null?(e.match(Ine)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Gk(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function Mke(t,e){switch(typeof t){case"string":var r=_r("vt:lpwstr",Ra(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return _r((t|0)==t?"vt:i4":"vt:r8",Ra(String(t)));case"boolean":return _r("vt:bool",t?"true":"false")}if(t instanceof Date)return _r("vt:filetime",Gk(t));throw new Error("Unable to serialize "+t)}function W6(t){if(Rn&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Ga(Em(Q6(t)));throw new Error("Bad input format: expected Buffer or string")}var S2=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,uo={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Sg=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],iu={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Lke(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,s=5;s>=0;--s)a=a*256+t[e+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function Uke(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,s=0,o=n?-e:e;isFinite(o)?o==0?a=s=0:(a=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(e)?26985:0);for(var l=0;l<=5;++l,s/=256)t[r+l]=s&255;t[r+6]=(a&15)<<4|s&15,t[r+7]=a>>4|n}var JH=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,s=t[0][n].length;a<s;a+=r)e.push.apply(e,t[0][n].slice(a,a+r));return e},ZH=Rn?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:wA(e)})):JH(t)}:JH,e$=function(t,e,r){for(var n=[],a=e;a<r;a+=2)n.push(String.fromCharCode(Rh(t,a)));return n.join("").replace(dc,"")},X6=Rn?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(dc,""):e$(t,e,r)}:e$,t$=function(t,e,r){for(var n=[],a=e;a<e+r;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},jne=Rn?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):t$(t,e,r)}:t$,r$=function(t,e,r){for(var n=[],a=e;a<r;a++)n.push(String.fromCharCode(Ex(t,a)));return n.join("")},Bw=Rn?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):r$(e,r,n)}:r$,Pne=function(t,e){var r=ou(t,e);return r>0?Bw(t,e+4,e+4+r-1):""},Bne=Pne,Tne=function(t,e){var r=ou(t,e);return r>0?Bw(t,e+4,e+4+r-1):""},kne=Tne,Fne=function(t,e){var r=2*ou(t,e);return r>0?Bw(t,e+4,e+4+r-1):""},One=Fne,Dne=function(e,r){var n=ou(e,r);return n>0?X6(e,r+4,r+4+n):""},Rne=Dne,Mne=function(t,e){var r=ou(t,e);return r>0?Bw(t,e+4,e+4+r):""},Lne=Mne,Une=function(t,e){return Lke(t,e)},LS=Une,Y6=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Rn&&(Bne=function(e,r){if(!Buffer.isBuffer(e))return Pne(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},kne=function(e,r){if(!Buffer.isBuffer(e))return Tne(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},One=function(e,r){if(!Buffer.isBuffer(e))return Fne(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},Rne=function(e,r){if(!Buffer.isBuffer(e))return Dne(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},Lne=function(e,r){if(!Buffer.isBuffer(e))return Mne(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},LS=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):Une(e,r)},Y6=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Ex=function(t,e){return t[e]},Rh=function(t,e){return t[e+1]*256+t[e]},Qke=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},ou=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},cp=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},Vke=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Nb(t,e){var r="",n,a,s=[],o,l,c,u;switch(e){case"dbcs":if(u=this.l,Rn&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(Rh(this,u)),u+=2;t*=2;break;case"utf8":r=Bw(this,this.l,this.l+t);break;case"utf16le":t*=2,r=X6(this,this.l,this.l+t);break;case"wstr":return Nb.call(this,t,"dbcs");case"lpstr-ansi":r=Bne(this,this.l),t=4+ou(this,this.l);break;case"lpstr-cp":r=kne(this,this.l),t=4+ou(this,this.l);break;case"lpwstr":r=One(this,this.l),t=4+2*ou(this,this.l);break;case"lpp4":t=4+ou(this,this.l),r=Rne(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+ou(this,this.l),r=Lne(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=Ex(this,this.l+t++))!==0;)s.push(HC(o));r=s.join("");break;case"_wstr":for(t=0,r="";(o=Rh(this,this.l+t))!==0;)s.push(HC(o)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Ex(this,u),this.l=u+1,l=Nb.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(HC(Rh(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Ex(this,u),this.l=u+1,l=Nb.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(HC(Ex(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=Ex(this,this.l),this.l++,n;case 2:return n=(e==="i"?Qke:Rh)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?cp:Vke)(this,this.l),this.l+=4,n):(a=ou(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=LS(this,this.l):a=LS([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:r=jne(this,this.l,t);break}}return this.l+=t,r}var Hke=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},$ke=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},Gke=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function Kke(t,e,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=e.length;++a)Gke(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(r==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var o=e.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,Hke(this,e,this.l);break;case 8:if(n=8,r==="f"){Uke(this,e,this.l);break}case 16:break;case-4:n=4,$ke(this,e,this.l);break}return this.l+=n,this}function Qne(t,e){var r=jne(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function il(t,e){t.l=e,t.read_shift=Nb,t.chk=Qne,t.write_shift=Kke}function Ql(t,e){t.l+=e}function tr(t){var e=hm(t);return il(e,0),e}function NA(t,e,r){if(t){var n,a,s;il(t,t.l||0);for(var o=t.length,l=0,c=0;t.l<o;){l=t.read_shift(1),l&128&&(l=(l&127)+((t.read_shift(1)&127)<<7));var u=k2[l]||k2[65535];for(n=t.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=t.read_shift(1))&127)<<7*a;c=t.l+s;var d=u.f&&u.f(t,s,r);if(t.l=c,e(d,u,l))return}}}function Mc(){var t=[],e=Rn?256:2048,r=function(u){var d=tr(u);return il(d,0),d},n=r(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,e)))},o=function(){return a(),Fo(t)},l=function(u){a(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:l,end:o,_bufs:t}}function fr(t,e,r,n){var a=+e,s;if(!isNaN(a)){n||(n=k2[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=t.next(s);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&Y6(r)&&t.push(r)}}function Cb(t,e,r){var n=xs(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function n$(t,e,r){var n=xs(t);return n.s=Cb(n.s,e.s,r),n.e=Cb(n.e,e.s,r),n}function _b(t,e){if(t.cRel&&t.c<0)for(t=xs(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=xs(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=hn(t);return!t.cRel&&t.cRel!=null&&(r=Wke(r)),!t.rRel&&t.rRel!=null&&(r=qke(r)),r}function _5(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+qs(t.s.c)+":"+(t.e.cRel?"":"$")+qs(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Bi(t.s.r)+":"+(t.e.rRel?"":"$")+Bi(t.e.r):_b(t.s,e.biff)+":"+_b(t.e,e.biff)}function J6(t){return parseInt(zke(t),10)-1}function Bi(t){return""+(t+1)}function qke(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function zke(t){return t.replace(/\$(\d+)$/,"$1")}function Z6(t){for(var e=Xke(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function qs(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function Wke(t){return t.replace(/^([A-Z])/,"$$$1")}function Xke(t){return t.replace(/^\$([A-Z])/,"$1")}function Yke(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function zs(t){for(var e=0,r=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:e-1}}function hn(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Lc(t){var e=t.indexOf(":");return e==-1?{s:zs(t),e:zs(t)}:{s:zs(t.slice(0,e)),e:zs(t.slice(e+1))}}function Sn(t,e){return typeof e>"u"||typeof e=="number"?Sn(t.s,t.e):(typeof t!="string"&&(t=hn(t)),typeof e!="string"&&(e=hn(e)),t==e?t:t+":"+e)}function oa(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=t.length;for(r=0;n<s&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.s.c=--r,r=0;n<s&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(e.s.r=--r,n===s||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.e.c=--r,r=0;n!=s&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return e.e.r=--r,e}function a$(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=md(t.z,r?mo(e):e)}catch{}try{return t.w=md((t.XF||{}).numFmtId||(r?14:0),r?mo(e):e)}catch{return""+e}}function oA(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?CA[t.v]||t.v:e==null?a$(t,t.v):a$(t,e))}function Sm(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function Vne(t,e,r){var n=r||{},a=t?Array.isArray(t):n.dense,s=t||(a?[]:{}),o=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?zs(n.origin):n.origin;o=c.r,l=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=oa(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var A=0;A!=e[f].length;++A)if(!(typeof e[f][A]>"u")){var h={v:e[f][A]},m=o+f,p=l+A;if(u.s.r>m&&(u.s.r=m),u.s.c>p&&(u.s.c=p),u.e.r<m&&(u.e.r=m),u.e.c<p&&(u.e.c=p),e[f][A]&&typeof e[f][A]=="object"&&!Array.isArray(e[f][A])&&!(e[f][A]instanceof Date))h=e[f][A];else if(Array.isArray(h.v)&&(h.f=e[f][A][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||fn[14],n.cellDates?(h.t="d",h.w=md(h.z,mo(h.v))):(h.t="n",h.v=mo(h.v),h.w=md(h.z,h.v))):h.t="s";if(a)s[m]||(s[m]=[]),s[m][p]&&s[m][p].z&&(h.z=s[m][p].z),s[m][p]=h;else{var g=hn({c:p,r:m});s[g]&&s[g].z&&(h.z=s[g].z),s[g]=h}}}return u.s.c<1e7&&(s["!ref"]=Sn(u)),s}function A1(t,e){return Vne(null,t,e)}function Jke(t){return t.read_shift(4,"i")}function tf(t,e){return e||(e=tr(4)),e.write_shift(4,t),e}function Ml(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Do(t,e){var r=!1;return e==null&&(r=!0,e=tr(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function Zke(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function eFe(t,e){return e||(e=tr(4)),e.write_shift(2,0),e.write_shift(2,0),e}function eR(t,e){var r=t.l,n=t.read_shift(1),a=Ml(t),s=[],o={t:a,h:a};if(n&1){for(var l=t.read_shift(4),c=0;c!=l;++c)s.push(Zke(t));o.r=s}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function tFe(t,e){var r=!1;return e==null&&(r=!0,e=tr(15+4*t.t.length)),e.write_shift(1,0),Do(t.t,e),r?e.slice(0,e.l):e}var rFe=eR;function nFe(t,e){var r=!1;return e==null&&(r=!0,e=tr(23+4*t.t.length)),e.write_shift(1,1),Do(t.t,e),e.write_shift(4,1),eFe({},e),r?e.slice(0,e.l):e}function bd(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Ig(t,e){return e==null&&(e=tr(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function jg(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Pg(t,e){return e==null&&(e=tr(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var aFe=Ml,Hne=Do;function tR(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function US(t,e){var r=!1;return e==null&&(r=!0,e=tr(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var sFe=Ml,Kk=tR,rR=US;function nR(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var a=n===0?LS([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):cp(e,0)>>2;return r?a/100:a}function $ne(t,e){e==null&&(e=tr(4));var r=0,n=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?a:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function Gne(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function iFe(t,e){return e||(e=tr(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Bg=Gne,m1=iFe;function Dl(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function ag(t,e){return(e||tr(8)).write_shift(8,t,"f")}function oFe(t){var e={},r=t.read_shift(1),n=r>>>1,a=t.read_shift(1),s=t.read_shift(2,"i"),o=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var u=Bp[a];u&&(e.rgb=j2(u));break;case 2:e.rgb=j2([o,l,c]);break;case 3:e.theme=a;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function QS(t,e){if(e||(e=tr(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function lFe(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function cFe(t,e){e||(e=tr(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function Kne(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function uFe(t){return Kne(t,1)}function dFe(t){return Kne(t,2)}var aR=2,Sc=3,GC=11,s$=12,VS=19,KC=64,fFe=65,hFe=71,AFe=4108,mFe=4126,Po=80,qne=81,pFe=[Po,qne],qk={1:{n:"CodePage",t:aR},2:{n:"Category",t:Po},3:{n:"PresentationFormat",t:Po},4:{n:"ByteCount",t:Sc},5:{n:"LineCount",t:Sc},6:{n:"ParagraphCount",t:Sc},7:{n:"SlideCount",t:Sc},8:{n:"NoteCount",t:Sc},9:{n:"HiddenCount",t:Sc},10:{n:"MultimediaClipCount",t:Sc},11:{n:"ScaleCrop",t:GC},12:{n:"HeadingPairs",t:AFe},13:{n:"TitlesOfParts",t:mFe},14:{n:"Manager",t:Po},15:{n:"Company",t:Po},16:{n:"LinksUpToDate",t:GC},17:{n:"CharacterCount",t:Sc},19:{n:"SharedDoc",t:GC},22:{n:"HyperlinksChanged",t:GC},23:{n:"AppVersion",t:Sc,p:"version"},24:{n:"DigSig",t:fFe},26:{n:"ContentType",t:Po},27:{n:"ContentStatus",t:Po},28:{n:"Language",t:Po},29:{n:"Version",t:Po},255:{},2147483648:{n:"Locale",t:VS},2147483651:{n:"Behavior",t:VS},1919054434:{}},zk={1:{n:"CodePage",t:aR},2:{n:"Title",t:Po},3:{n:"Subject",t:Po},4:{n:"Author",t:Po},5:{n:"Keywords",t:Po},6:{n:"Comments",t:Po},7:{n:"Template",t:Po},8:{n:"LastAuthor",t:Po},9:{n:"RevNumber",t:Po},10:{n:"EditTime",t:KC},11:{n:"LastPrinted",t:KC},12:{n:"CreatedDate",t:KC},13:{n:"ModifiedDate",t:KC},14:{n:"PageCount",t:Sc},15:{n:"WordCount",t:Sc},16:{n:"CharCount",t:Sc},17:{n:"Thumbnail",t:hFe},18:{n:"Application",t:Po},19:{n:"DocSecurity",t:Sc},255:{},2147483648:{n:"Locale",t:VS},2147483651:{n:"Behavior",t:VS},1919054434:{}},i$={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},gFe=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function xFe(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var vFe=xFe([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Bp=xs(vFe),CA={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},zne={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Wk={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},qC={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function sR(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function yFe(t){var e=sR();if(!t||!t.match)return e;var r={};if((t.match(Hl)||[]).forEach(function(n){var a=An(n);switch(a[0].replace(Pke,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":e[Wk[a.ContentType]]!==void 0&&e[Wk[a.ContentType]].push(a.PartName);break}}),e.xmlns!==uo.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function Wne(t,e){var r=yke(Wk),n=[],a;n[n.length]=ki,n[n.length]=_r("Types",null,{xmlns:uo.CT,"xmlns:xsd":uo.xsd,"xmlns:xsi":uo.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return _r("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){t[c]&&t[c].length>0&&(a=t[c][0],n[n.length]=_r("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:qC[c][e.bookType]||qC[c].xlsx}))},o=function(c){(t[c]||[]).forEach(function(u){n[n.length]=_r("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:qC[c][e.bookType]||qC[c].xlsx})})},l=function(c){(t[c]||[]).forEach(function(u){n[n.length]=_r("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var $n={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function I2(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Eb(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Hl)||[]).forEach(function(a){var s=An(a);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:Gy(s.Target,e);r[l]=o,n[s.Id]=o}}),r["!id"]=n,r}function cv(t){var e=[ki,_r("Relationships",null,{xmlns:uo.RELS})];return hi(t["!id"]).forEach(function(r){e[e.length]=_r("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function ka(t,e,r,n,a,s){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,a.Id="rId"+e,a.Type=n,a.Target=r,[$n.HLINK,$n.XPATH,$n.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,e}var bFe="application/vnd.oasis.opendocument.spreadsheet";function wFe(t,e){for(var r=W6(t),n,a;n=S2.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=An(n[0],!1),a.path=="/"&&a.type!==bFe)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function NFe(t){var e=[ki];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function o$(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function CFe(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function _Fe(t){var e=[ki];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(o$(t[r][0],t[r][1])),e.push(CFe("",t[r][0]));return e.push(o$("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function Xne(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+FS.version+"</meta:generator></office:meta></office:document-meta>"}var dd=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],EFe=function(){for(var t=new Array(dd.length),e=0;e<dd.length;++e){var r=dd[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function Yne(t){var e={};t=Ga(t);for(var r=0;r<dd.length;++r){var n=dd[r],a=t.match(EFe[r]);a!=null&&a.length>0&&(e[n[1]]=ia(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=gs(e[n[1]]))}return e}function E5(t,e,r,n,a){a[t]!=null||e==null||e===""||(a[t]=e,e=Ra(e),n[n.length]=r?_r(t,e,r):ll(t,e))}function Jne(t,e){var r=e||{},n=[ki,_r("cp:coreProperties",null,{"xmlns:cp":uo.CORE_PROPS,"xmlns:dc":uo.dc,"xmlns:dcterms":uo.dcterms,"xmlns:dcmitype":uo.dcmitype,"xmlns:xsi":uo.xsi})],a={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&E5("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Gk(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),t.ModifiedDate!=null&&E5("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Gk(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=dd.length;++s){var o=dd[s],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&E5(o[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Tp=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Zne=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function eae(t,e,r,n){var a=[];if(typeof t=="string")a=YH(t,n);else for(var s=0;s<t.length;++s)a=a.concat(t[s].map(function(d){return{v:d}}));var o=typeof e=="string"?YH(e,n).map(function(d){return d.v}):e,l=0,c=0;if(o.length>0)for(var u=0;u!==a.length;u+=2){switch(c=+a[u+1].v,a[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function SFe(t,e,r){var n={};return e||(e={}),t=Ga(t),Tp.forEach(function(a){var s=(t.match(_2(a[0]))||[])[1];switch(a[2]){case"string":s&&(e[a[1]]=ia(s));break;case"bool":e[a[1]]=s==="true";break;case"raw":var o=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&eae(n.HeadingPairs,n.TitlesOfParts,e,r),e}function tae(t){var e=[],r=_r;return t||(t={}),t.Application="SheetJS",e[e.length]=ki,e[e.length]=_r("Properties",null,{xmlns:uo.EXT_PROPS,"xmlns:vt":uo.vt}),Tp.forEach(function(n){if(t[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Ra(String(t[n[1]]));break;case"bool":a=t[n[1]]?"true":"false";break}a!==void 0&&(e[e.length]=r(n[0],a))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Ra(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var IFe=/<[^>]+>[^<]*/g;function jFe(t,e){var r={},n="",a=t.match(IFe);if(a)for(var s=0;s!=a.length;++s){var o=a[s],l=An(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ia(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=ia(d);break;case"bool":r[n]=hs(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=gs(d);break;case"cy":case"error":r[n]=ia(d);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,c)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function rae(t){var e=[ki,_r("Properties",null,{xmlns:uo.CUST_PROPS,"xmlns:vt":uo.vt})];if(!t)return e.join("");var r=1;return hi(t).forEach(function(a){++r,e[e.length]=_r("property",Mke(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ra(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Xk={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},S5;function PFe(t,e,r){S5||(S5=Zj(Xk)),e=S5[e]||e,t[e]=r}function BFe(t,e){var r=[];return hi(Xk).map(function(n){for(var a=0;a<dd.length;++a)if(dd[a][1]==n)return dd[a];for(a=0;a<Tp.length;++a)if(Tp[a][1]==n)return Tp[a];throw n}).forEach(function(n){if(t[n[1]]!=null){var a=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(ll(Xk[n[1]]||n[1],a))}}),_r("DocumentProperties",r.join(""),{xmlns:iu.o})}function TFe(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return t&&hi(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var o=0;o<dd.length;++o)if(s==dd[o][1])return;for(o=0;o<Tp.length;++o)if(s==Tp[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var l=t[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),a.push(_r(qH(s),l,{"dt:dt":c}))}}),e&&hi(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),a.push(_r(qH(s),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+iu.o+'">'+a.join("")+"</"+n+">"}function iR(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function kFe(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var o=tr(8);return o.write_shift(4,n),o.write_shift(4,a),o}function nae(t,e,r){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return a}function aae(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function sae(t,e,r){return e===31?aae(t):nae(t,e,r)}function Yk(t,e,r){return sae(t,e,r===!1?0:4)}function FFe(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return sae(t,e,0)}function OFe(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var a=t.l;r[n]=t.read_shift(0,"lpwstr").replace(dc,""),t.l-a&2&&(t.l+=2)}return r}function DFe(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(dc,"");return r}function RFe(t){var e=t.l,r=HS(t,qne);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=HS(t,Sc);return[r,n]}function MFe(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(RFe(t));return r}function l$(t,e){for(var r=t.read_shift(4),n={},a=0;a!=r;++a){var s=t.read_shift(4),o=t.read_shift(4);n[s]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(dc,"").replace($y,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function iae(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function LFe(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function HS(t,e,r){var n=t.read_shift(2),a,s=r||{};if(t.l+=2,e!==s$&&n!==e&&pFe.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===s$?n:e){case 2:return a=t.read_shift(2,"i"),s.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return nae(t,n,4).replace(dc,"");case 31:return aae(t);case 64:return iR(t);case 65:return iae(t);case 71:return LFe(t);case 80:return Yk(t,n,!s.raw).replace(dc,"");case 81:return FFe(t,n).replace(dc,"");case 4108:return MFe(t);case 4126:case 4127:return n==4127?OFe(t):DFe(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function c$(t,e){var r=tr(4),n=tr(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=tr(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=kFe(e);break;case 31:case 80:for(n=tr(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Fo([r,n])}function u$(t,e){var r=t.l,n=t.read_shift(4),a=t.read_shift(4),s=[],o=0,l=0,c=-1,u={};for(o=0;o!=a;++o){var d=t.read_shift(4),f=t.read_shift(4);s[o]=[d,f+r]}s.sort(function(y,b){return y[1]-b[1]});var A={};for(o=0;o!=a;++o){if(t.l!==s[o][1]){var h=!0;if(o>0&&e)switch(e[s[o-1][0]].t){case 2:t.l+2===s[o][1]&&(t.l+=2,h=!1);break;case 80:t.l<=s[o][1]&&(t.l=s[o][1],h=!1);break;case 4108:t.l<=s[o][1]&&(t.l=s[o][1],h=!1);break}if((!e||o==0)&&t.l<=s[o][1]&&(h=!1,t.l=s[o][1]),h)throw new Error("Read Error: Expected address "+s[o][1]+" at "+t.l+" :"+o)}if(e){var m=e[s[o][0]];if(A[m.n]=HS(t,m.t,{raw:!0}),m.p==="version"&&(A[m.n]=String(A[m.n]>>16)+"."+("0000"+String(A[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(A[m.n]){case 0:A[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:qd(l=A[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+A[m.n])}}else if(s[o][0]===1){if(l=A.CodePage=HS(t,aR),qd(l),c!==-1){var p=t.l;t.l=s[c][1],u=l$(t,l),t.l=p}}else if(s[o][0]===0){if(l===0){c=o,t.l=s[o+1][1];continue}u=l$(t,l)}else{var g=u[s[o][0]],v;switch(t[t.l]){case 65:t.l+=4,v=iae(t);break;case 30:t.l+=4,v=Yk(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,v=Yk(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,v=t.read_shift(4,"i");break;case 19:t.l+=4,v=t.read_shift(4);break;case 5:t.l+=4,v=t.read_shift(8,"f");break;case 11:t.l+=4,v=yi(t,4);break;case 64:t.l+=4,v=gs(iR(t));break;default:throw new Error("unparsed value: "+t[t.l])}A[g]=v}}return t.l=r+n,A}var oae=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function UFe(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function d$(t,e,r){var n=tr(8),a=[],s=[],o=8,l=0,c=tr(8),u=tr(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),a.push(u),o+=8+c.length,!e){u=tr(8),u.write_shift(4,0),a.unshift(u);var d=[tr(4)];for(d[0].write_shift(4,t.length),l=0;l<t.length;++l){var f=t[l][0];for(c=tr(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Fo(d),s.unshift(c),o+=8+c.length}for(l=0;l<t.length;++l)if(!(e&&!e[t[l][0]])&&!(oae.indexOf(t[l][0])>-1||Zne.indexOf(t[l][0])>-1)&&t[l][1]!=null){var A=t[l][1],h=0;if(e){h=+e[t[l][0]];var m=r[h];if(m.p=="version"&&typeof A=="string"){var p=A.split(".");A=(+p[0]<<16)+(+p[1]||0)}c=c$(m.t,A)}else{var g=UFe(A);g==-1&&(g=31,A=String(A)),c=c$(g,A)}s.push(c),u=tr(8),u.write_shift(4,e?h:2+l),a.push(u),o+=8+c.length}var v=8*(s.length+1);for(l=0;l<s.length;++l)a[l].write_shift(4,v),v+=s[l].length;return n.write_shift(4,o),n.write_shift(4,s.length),Fo([n].concat(a).concat(s))}function f$(t,e,r){var n=t.content;if(!n)return{};il(n,0);var a,s,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==nn.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(o=n.read_shift(16),c=n.read_shift(4));var f=u$(n,e),A={SystemIdentifier:u};for(var h in f)A[h]=f[h];if(A.FMTID=s,a===1)return A;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var m;try{m=u$(n,null)}catch{}for(h in m)A[h]=m[h];return A.FMTID=[s,o],A}function h$(t,e,r,n,a,s){var o=tr(a?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,nn.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,a?68:48);var c=d$(t,r,n);if(l.push(c),a){var u=d$(a,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+c.length),l.push(u)}return Fo(l)}function s0(t,e){return t.read_shift(e),null}function QFe(t,e){e||(e=tr(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function VFe(t,e,r){for(var n=[],a=t.l+e;t.l<a;)n.push(r(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function yi(t,e){return t.read_shift(e)===1}function sc(t,e){return e||(e=tr(2)),e.write_shift(2,+!!t),e}function Mi(t){return t.read_shift(2,"u")}function Yu(t,e){return e||(e=tr(2)),e.write_shift(2,t),e}function lae(t,e){return VFe(t,e,Mi)}function HFe(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function cae(t,e,r){return r||(r=tr(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Tw(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?t.read_shift(n,a):"";return o}function $Fe(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,a=r&8,s=1+(r&1),o=0,l,c={};a&&(o=t.read_shift(2)),n&&(l=t.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,u);return a&&(t.l+=4*o),n&&(t.l+=l),c.t=d,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function GFe(t){var e=t.t||"",r=tr(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=tr(2*e.length);n.write_shift(2*e.length,e,"utf16le");var a=[r,n];return Fo(a)}function sg(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function kw(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):sg(t,n,r)}function Tg(t,e,r){if(r.biff>5)return kw(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function uae(t,e,r){return r||(r=tr(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function KFe(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function qFe(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var a=t.read_shift((n?e-24:e)>>1,"utf16le").replace(dc,"");return n&&(t.l+=24),a}function zFe(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(s>>1,"utf16le").replace(dc,"");return r+o}function WFe(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return qFe(t);case"0303000000000000c000000000000046":return zFe(t);default:throw new Error("Unsupported Moniker "+r)}}function zC(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(dc,""):"";return r}function A$(t,e){e||(e=tr(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function XFe(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var s,o,l,c,u="",d,f;a&16&&(s=zC(t,r-t.l)),a&128&&(o=zC(t,r-t.l)),(a&257)===257&&(l=zC(t,r-t.l)),(a&257)===1&&(c=WFe(t,r-t.l)),a&8&&(u=zC(t,r-t.l)),a&32&&(d=t.read_shift(16)),a&64&&(f=iR(t)),t.l=r;var A=o||l||c||"";A&&u&&(A+="#"+u),A||(A="#"+u),a&2&&A.charAt(0)=="/"&&A.charAt(1)!="/"&&(A="file://"+A);var h={Target:A};return d&&(h.guid=d),f&&(h.time=f),s&&(h.Tooltip=s),h}function YFe(t){var e=tr(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(s==28)n=n.slice(1),A$(n,e);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var l=a>-1?n.slice(0,a):n;for(e.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)e.write_shift(2,l.charCodeAt(r));e.write_shift(2,0),s&8&&A$(a>-1?n.slice(a+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)e.write_shift(1,n.charCodeAt(r+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function dae(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[e,r,n,a]}function fae(t,e){var r=dae(t);return r[3]=0,r}function rh(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function ig(t,e,r,n){return n||(n=tr(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function JFe(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function ZFe(t,e,r){return e===0?"":Tg(t,e,r)}function eOe(t,e,r){var n=r.biff>8?4:2,a=t.read_shift(n),s=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[a,s,o]}function hae(t){var e=t.read_shift(2),r=nR(t);return[e,r]}function tOe(t,e,r){t.l+=4,e-=4;var n=t.l+e,a=Tw(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,a}function rP(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r:e},e:{c:a,r}}}function Aae(t,e){return e||(e=tr(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function mae(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r:e},e:{c:a,r}}}var rOe=mae;function pae(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function nOe(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function aOe(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function _l(t){t.l+=2,t.l+=t.read_shift(2)}var sOe={0:_l,4:_l,5:_l,6:_l,7:aOe,8:_l,9:_l,10:_l,11:_l,12:_l,13:nOe,14:_l,15:_l,16:_l,17:_l,18:_l,19:_l,20:_l,21:pae};function iOe(t,e){for(var r=t.l+e,n=[];t.l<r;){var a=t.read_shift(2);t.l-=2;try{n.push(sOe[a](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function WC(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function oR(t,e,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=tr(a);return s.write_shift(2,n),s.write_shift(2,e),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function oOe(t,e){return e===0||t.read_shift(2),1200}function lOe(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,a=Tg(t,0,r);return t.read_shift(e+n-t.l),a}function cOe(t,e){var r=!e||e.biff==8,n=tr(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function uOe(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function dOe(t,e,r){var n=t.read_shift(4),a=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=Tw(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:s,name:o}}function fOe(t,e){var r=!e||e.biff>=8?2:1,n=tr(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function hOe(t,e){for(var r=t.l+e,n=t.read_shift(4),a=t.read_shift(4),s=[],o=0;o!=a&&t.l<r;++o)s.push($Fe(t));return s.Count=n,s.Unique=a,s}function AOe(t,e){var r=tr(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],a=0;a<t.length;++a)n[a]=GFe(t[a]);var s=Fo([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function mOe(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function pOe(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function gOe(t){var e=JFe(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function xOe(t){return t.read_shift(2),t.read_shift(4)}function m$(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function vOe(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),u=t.read_shift(2);return{Pos:[e,r],Dim:[n,a],Flags:s,CurTab:o,FirstTab:l,Selected:c,TabRatio:u}}function yOe(){var t=tr(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function bOe(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function wOe(t){var e=tr(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function NOe(){}function COe(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Tw(t,0,r),n}function _Oe(t,e){var r=t.name||"Arial",n=e&&e.biff==5,a=n?15+r.length:16+2*r.length,s=tr(a);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function EOe(t){var e=rh(t);return e.isst=t.read_shift(4),e}function SOe(t,e,r,n){var a=tr(10);return ig(t,e,n,a),a.write_shift(4,r),a}function IOe(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,a=rh(t);r.biff==2&&t.l++;var s=kw(t,n-t.l,r);return a.val=s,a}function jOe(t,e,r,n,a){var s=!a||a.biff==8,o=tr(8+ +s+(1+s)*r.length);return ig(t,e,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function POe(t,e,r){var n=t.read_shift(2),a=Tg(t,0,r);return[n,a]}function BOe(t,e,r,n){var a=r&&r.biff==5;n||(n=tr(a?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(a?1:2,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var TOe=Tg;function p$(t,e,r){var n=t.l+e,a=r.biff==8||!r.biff?4:2,s=t.read_shift(a),o=t.read_shift(a),l=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:s,c:l},e:{r:o,c}}}function kOe(t,e){var r=e.biff==8||!e.biff?4:2,n=tr(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function FOe(t){var e=t.read_shift(2),r=t.read_shift(2),n=hae(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function OOe(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),s=[];t.l<r;)s.push(hae(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(s.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:s}}function DOe(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(s.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:s}}function ROe(t,e,r,n){var a={},s=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(2);return a.patternType=gFe[l>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function MOe(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=ROe(t,e,n.fStyle,r),n}function g$(t,e,r,n){var a=r&&r.biff==5;n||(n=tr(a?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function LOe(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function UOe(t){var e=tr(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function x$(t,e,r){var n=rh(t);(r.biff==2||e==9)&&++t.l;var a=HFe(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function QOe(t,e,r,n,a,s){var o=tr(8);return ig(t,e,n,o),cae(r,s,o),o}function VOe(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=rh(t),a=Dl(t);return n.val=a,n}function HOe(t,e,r,n){var a=tr(14);return ig(t,e,n,a),ag(r,a),a}var v$=ZFe;function $Oe(t,e,r){var n=t.l+e,a=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=sg(t,s),l=[];n>t.l;)l.push(kw(t));return[s,a,o,l]}function y$(t,e,r){var n=t.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=tOe(t,e-2,r)),s.body=a||t.read_shift(e-2),typeof a=="string"&&(s.Name=a),s}var GOe=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function b$(t,e,r){var n=t.l+e,a=t.read_shift(2),s=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var u=sg(t,o,r);a&32&&(u=GOe[u.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var f=n==t.l||l===0||!(d>0)?[]:iMe(t,d,r,l);return{chKey:s,Name:u,itab:c,rgce:f}}function gae(t,e,r){if(r.biff<8)return KOe(t,e,r);for(var n=[],a=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(eOe(t,r.biff>8?12:6,r));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function KOe(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Tw(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function qOe(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),a=t.read_shift(2),s=sg(t,n,r),o=sg(t,a,r);return[s,o]}function zOe(t,e,r){var n=mae(t);t.l++;var a=t.read_shift(1);return e-=8,[oMe(t,e,r),a,n]}function w$(t,e,r){var n=rOe(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,aMe(t,e,r)]}function WOe(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function XOe(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),l=Tg(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:a},l,o,s]}}function YOe(t,e,r){return XOe(t,e,r)}function JOe(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(rP(t));return r}function ZOe(t){var e=tr(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)Aae(t[r],e);return e}function eDe(t,e,r){if(r&&r.biff<8)return rDe(t,e,r);var n=pae(t),a=iOe(t,e-22,n[1]);return{cmo:n,ft:a}}var tDe={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=r,{fmt:n}}};function rDe(t,e,r){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((tDe[n]||Ql)(t,e,r)),{cmo:[a,n,s],ft:o}}function nDe(t,e,r){var n=t.l,a="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:o=KFe(t,6,r);var l=t.read_shift(2);t.read_shift(2),Mi(t,2);var c=t.read_shift(2);t.l+=c;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var d=t[t.l],f=sg(t,t.lens[u+1]-t.lens[u]-1);if(a+=f,a.length>=(d?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return t.l=n+e,{t:a}}catch{return t.l=n+e,{t:a}}}function aDe(t,e){var r=rP(t);t.l+=16;var n=XFe(t,e-24);return[r,n]}function sDe(t){var e=tr(24),r=zs(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(n[a],16));return Fo([e,YFe(t[1])])}function iDe(t,e){t.read_shift(2);var r=rP(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(dc,""),[r,n]}function oDe(t){var e=t[1].Tooltip,r=tr(10+2*(e.length+1));r.write_shift(2,2048);var n=zs(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<e.length;++a)r.write_shift(2,e.charCodeAt(a));return r.write_shift(2,0),r}function lDe(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=i$[r]||r,r=t.read_shift(2),e[1]=i$[r]||r,e}function cDe(t){return t||(t=tr(4)),t.write_shift(2,1),t.write_shift(2,1),t}function uDe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(fae(t));return r}function dDe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(fae(t));return r}function fDe(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function xae(t,e,r){if(!r.cellStyles)return Ql(t,e);var n=r&&r.biff>=12?4:2,a=t.read_shift(n),s=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var u={s:a,e:s,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function hDe(t,e){var r=tr(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function ADe(t,e){var r={};return e<32||(t.l+=16,r.header=Dl(t),r.footer=Dl(t),t.l+=2),r}function mDe(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}function pDe(t){for(var e=tr(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var gDe=rh,xDe=lae,vDe=kw;function yDe(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function bDe(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=rh(t);++t.l;var a=Tg(t,e-7,r);return n.t="str",n.val=a,n}function wDe(t){var e=rh(t);++t.l;var r=Dl(t);return e.t="n",e.val=r,e}function NDe(t,e,r){var n=tr(15);return Rw(n,t,e),n.write_shift(8,r,"f"),n}function CDe(t){var e=rh(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function _De(t,e,r){var n=tr(9);return Rw(n,t,e),n.write_shift(2,r),n}function EDe(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function SDe(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function IDe(t,e,r){var n=t.l+e,a=rh(t),s=t.read_shift(2),o=sg(t,s,r);return t.l=n,a.t="str",a.val=o,a}var jDe=[2,3,48,49,131,139,140,245],Jk=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Zj({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=hm(1);switch(c.type){case"base64":d=lu(bu(l));break;case"binary":d=lu(l);break;case"buffer":case"array":d=l;break}il(d,0);var f=d.read_shift(1),A=!!(f&136),h=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,A=!0;break;case 49:h=!0,A=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,g=521;f==2&&(p=d.read_shift(2)),d.l+=3,f!=2&&(p=d.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(g=d.read_shift(2));var v=d.read_shift(2),y=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(y=t[d[d.l]]),d.l+=1,d.l+=2),m&&(d.l+=36);for(var b=[],w={},j=Math.min(d.length,f==2?521:g-10-(h?264:0)),I=m?32:11;d.l<j&&d[d.l]!=13;)switch(w={},w.name=w2.utils.decode(y,d.slice(d.l,d.l+I)).replace(/[\u0000\r\n].*$/g,""),d.l+=I,w.type=String.fromCharCode(d.read_shift(1)),f!=2&&!m&&(w.offset=d.read_shift(4)),w.len=d.read_shift(1),f==2&&(w.offset=d.read_shift(2)),w.dec=d.read_shift(1),w.name.length&&b.push(w),f!=2&&(d.l+=m?13:14),w.type){case"B":(!h||w.len!=8)&&c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(d[d.l]!==13&&(d.l=g-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=g;var _=0,S=0;for(u[0]=[],S=0;S!=b.length;++S)u[0][S]=b[S].name;for(;p-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,u[++_]=[],S=0,S=0;S!=b.length;++S){var E=d.slice(d.l,d.l+b[S].len);d.l+=b[S].len,il(E,0);var F=w2.utils.decode(y,E);switch(b[S].type){case"C":F.trim().length&&(u[_][S]=F.replace(/\s+$/,""));break;case"D":F.length===8?u[_][S]=new Date(+F.slice(0,4),+F.slice(4,6)-1,+F.slice(6,8)):u[_][S]=F;break;case"F":u[_][S]=parseFloat(F.trim());break;case"+":case"I":u[_][S]=m?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(F.trim().toUpperCase()){case"Y":case"T":u[_][S]=!0;break;case"N":case"F":u[_][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+F+"|")}break;case"M":if(!A)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[_][S]="##MEMO##"+(m?parseInt(F.trim(),10):E.read_shift(4));break;case"N":F=F.replace(/\u0000/g,"").trim(),F&&F!="."&&(u[_][S]=+F||0);break;case"@":u[_][S]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":u[_][S]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":u[_][S]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[_][S]=-E.read_shift(-8,"f");break;case"B":if(h&&b[S].len==8){u[_][S]=E.read_shift(8,"f");break}case"G":case"P":E.l+=b[S].len;break;case"0":if(b[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[S].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=b,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=A1(r(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function a(l,c){try{return Sm(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&qd(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Mc(),f=KS(l,{header:1,raw:!0,cellDates:!0}),A=f[0],h=f.slice(1),m=l["!cols"]||[],p=0,g=0,v=0,y=1;for(p=0;p<A.length;++p){if(((m[p]||{}).DBF||{}).name){A[p]=m[p].DBF.name,++v;continue}if(A[p]!=null){if(++v,typeof A[p]=="number"&&(A[p]=A[p].toString(10)),typeof A[p]!="string")throw new Error("DBF Invalid column name "+A[p]+" |"+typeof A[p]+"|");if(A.indexOf(A[p])!==p){for(g=0;g<1024;++g)if(A.indexOf(A[p]+"_"+g)==-1){A[p]+="_"+g;break}}}}var b=oa(l["!ref"]),w=[],j=[],I=[];for(p=0;p<=b.e.c-b.s.c;++p){var _="",S="",E=0,F=[];for(g=0;g<h.length;++g)h[g][p]!=null&&F.push(h[g][p]);if(F.length==0||A[p]==null){w[p]="?";continue}for(g=0;g<F.length;++g){switch(typeof F[g]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=F[g]instanceof Date?"D":"C";break;default:S="C"}E=Math.max(E,String(F[g]).length),_=_&&_!=S?"C":S}E>250&&(E=250),S=((m[p]||{}).DBF||{}).type,S=="C"&&m[p].DBF.len>E&&(E=m[p].DBF.len),_=="B"&&S=="N"&&(_="N",I[p]=m[p].DBF.dec,E=m[p].DBF.len),j[p]=_=="C"||S=="N"?E:s[_]||0,y+=j[p],w[p]=_}var k=d.next(32);for(k.write_shift(4,318902576),k.write_shift(4,h.length),k.write_shift(2,296+32*v),k.write_shift(2,y),p=0;p<4;++p)k.write_shift(4,0);for(k.write_shift(4,0|(+e[one]||3)<<8),p=0,g=0;p<A.length;++p)if(A[p]!=null){var P=d.next(32),D=(A[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,D,"sbcs"),P.write_shift(1,w[p]=="?"?"C":w[p],"sbcs"),P.write_shift(4,g),P.write_shift(1,j[p]||s[w[p]]||0),P.write_shift(1,I[p]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),g+=j[p]||s[w[p]]||0}var X=d.next(264);for(X.write_shift(4,13),p=0;p<65;++p)X.write_shift(4,0);for(p=0;p<h.length;++p){var pe=d.next(y);for(pe.write_shift(1,0),g=0;g<A.length;++g)if(A[g]!=null)switch(w[g]){case"L":pe.write_shift(1,h[p][g]==null?63:h[p][g]?84:70);break;case"B":pe.write_shift(8,h[p][g]||0,"f");break;case"N":var ge="0";for(typeof h[p][g]=="number"&&(ge=h[p][g].toFixed(I[g]||0)),v=0;v<j[g]-ge.length;++v)pe.write_shift(1,32);pe.write_shift(1,ge,"sbcs");break;case"D":h[p][g]?(pe.write_shift(4,("0000"+h[p][g].getFullYear()).slice(-4),"sbcs"),pe.write_shift(2,("00"+(h[p][g].getMonth()+1)).slice(-2),"sbcs"),pe.write_shift(2,("00"+h[p][g].getDate()).slice(-2),"sbcs")):pe.write_shift(8,"00000000","sbcs");break;case"C":var fe=String(h[p][g]!=null?h[p][g]:"").slice(0,j[g]);for(pe.write_shift(1,fe,"sbcs"),v=0;v<j[g]-fe.length;++v)pe.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),vae=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+hi(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(A,h){var m=t[h];return typeof m=="number"?kH(m):m},n=function(A,h,m){var p=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?A:kH(p)};t["|"]=254;function a(A,h){switch(h.type){case"base64":return s(bu(A),h);case"binary":return s(A,h);case"buffer":return s(Rn&&Buffer.isBuffer(A)?A.toString("binary"):Em(A),h);case"array":return s(ng(A),h)}throw new Error("Unrecognized type "+h.type)}function s(A,h){var m=A.split(/[\n\r]+/),p=-1,g=-1,v=0,y=0,b=[],w=[],j=null,I={},_=[],S=[],E=[],F=0,k;for(+h.codepage>=0&&qd(+h.codepage);v!==m.length;++v){F=0;var P=m[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),D=P.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),X=D[0],pe;if(P.length>0)switch(X){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":D[1].charAt(0)=="P"&&w.push(P.slice(3).replace(/;;/g,";"));break;case"C":var ge=!1,fe=!1,xe=!1,ae=!1,Se=-1,Te=-1;for(y=1;y<D.length;++y)switch(D[y].charAt(0)){case"A":break;case"X":g=parseInt(D[y].slice(1))-1,fe=!0;break;case"Y":for(p=parseInt(D[y].slice(1))-1,fe||(g=0),k=b.length;k<=p;++k)b[k]=[];break;case"K":pe=D[y].slice(1),pe.charAt(0)==='"'?pe=pe.slice(1,pe.length-1):pe==="TRUE"?pe=!0:pe==="FALSE"?pe=!1:isNaN(ef(pe))?isNaN(kv(pe).getDate())||(pe=gs(pe)):(pe=ef(pe),j!==null&&f1(j)&&(pe=tP(pe))),ge=!0;break;case"E":ae=!0;var O=uv(D[y].slice(1),{r:p,c:g});b[p][g]=[b[p][g],O];break;case"S":xe=!0,b[p][g]=[b[p][g],"S5S"];break;case"G":break;case"R":Se=parseInt(D[y].slice(1))-1;break;case"C":Te=parseInt(D[y].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}if(ge&&(b[p][g]&&b[p][g].length==2?b[p][g][0]=pe:b[p][g]=pe,j=null),xe){if(ae)throw new Error("SYLK shared formula cannot have own formula");var G=Se>-1&&b[Se][Te];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");b[p][g][1]=Rae(G[1],{r:p-Se,c:g-Te})}break;case"F":var z=0;for(y=1;y<D.length;++y)switch(D[y].charAt(0)){case"X":g=parseInt(D[y].slice(1))-1,++z;break;case"Y":for(p=parseInt(D[y].slice(1))-1,k=b.length;k<=p;++k)b[k]=[];break;case"M":F=parseInt(D[y].slice(1))/20;break;case"F":break;case"G":break;case"P":j=w[parseInt(D[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=D[y].slice(1).split(" "),k=parseInt(E[0],10);k<=parseInt(E[1],10);++k)F=parseInt(E[2],10),S[k-1]=F===0?{hidden:!0}:{wch:F},Am(S[k-1]);break;case"C":g=parseInt(D[y].slice(1))-1,S[g]||(S[g]={});break;case"R":p=parseInt(D[y].slice(1))-1,_[p]||(_[p]={}),F>0?(_[p].hpt=F,_[p].hpx=Ov(F)):F===0&&(_[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}z<1&&(j=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}}return _.length>0&&(I["!rows"]=_),S.length>0&&(I["!cols"]=S),h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),[b,I]}function o(A,h){var m=a(A,h),p=m[0],g=m[1],v=A1(p,h);return hi(g).forEach(function(y){v[y]=g[y]}),v}function l(A,h){return Sm(o(A,h),h)}function c(A,h,m,p){var g="C;Y"+(m+1)+";X"+(p+1)+";K";switch(A.t){case"n":g+=A.v||0,A.f&&!A.F&&(g+=";E"+hR(A.f,{r:m,c:p}));break;case"b":g+=A.v?"TRUE":"FALSE";break;case"e":g+=A.w||A.v;break;case"d":g+='"'+(A.w||A.v)+'"';break;case"s":g+='"'+A.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function u(A,h){h.forEach(function(m,p){var g="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=P2(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=B2(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&A.push(g)})}function d(A,h){h.forEach(function(m,p){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*T2(m.hpx)+";"),g.length>2&&A.push(g+"R"+(p+1))})}function f(A,h){var m=["ID;PWXL;N;E"],p=[],g=oa(A["!ref"]),v,y=Array.isArray(A),b=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),A["!cols"]&&u(m,A["!cols"]),A["!rows"]&&d(m,A["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var w=g.s.r;w<=g.e.r;++w)for(var j=g.s.c;j<=g.e.c;++j){var I=hn({r:w,c:j});v=y?(A[w]||[])[j]:A[I],!(!v||v.v==null&&(!v.f||v.F))&&p.push(c(v,A,w,j))}return m.join(b)+b+p.join(b)+b+"E"+b}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),yae=function(){function t(s,o){switch(o.type){case"base64":return e(bu(s),o);case"binary":return e(s,o);case"buffer":return e(Rn&&Buffer.isBuffer(s)?s.toString("binary"):Em(s),o);case"array":return e(ng(s),o)}throw new Error("Unrecognized type "+o.type)}function e(s,o){for(var l=s.split(`
`),c=-1,u=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var A=l[d].trim().split(","),h=A[0],m=A[1];++d;for(var p=l[d]||"";(p.match(/["]/g)||[]).length&1&&d<l.length-1;)p+=`
`+l[++d];switch(p=p.trim(),+h){case-1:if(p==="BOT"){f[++c]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][u]=!0:p==="FALSE"?f[c][u]=!1:isNaN(ef(m))?isNaN(kv(m).getDate())?f[c][u]=m:f[c][u]=gs(m):f[c][u]=ef(m),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][u++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(s,o){return A1(t(s,o),o)}function n(s,o){return Sm(r(s,o),o)}var a=function(){var s=function(c,u,d,f,A){c.push(u),c.push(d+","+f),c.push('"'+A.replace(/"/g,'""')+'"')},o=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=oa(c["!ref"]),f,A=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var h=d.s.r;h<=d.e.r;++h){o(u,-1,0,"BOT");for(var m=d.s.c;m<=d.e.c;++m){var p=hn({r:h,c:m});if(f=A?(c[h]||[])[m]:c[p],!f){o(u,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?o(u,1,0,"="+f.f):o(u,1,0,""):o(u,0,g,"V");break;case"b":o(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=md(f.z||fn[14],mo(gs(f.v)))),o(u,0,f.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var v=`\r
`,y=u.join(v);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),bae=function(){function t(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,A){for(var h=f.split(`
`),m=-1,p=-1,g=0,v=[];g!==h.length;++g){var y=h[g].trim().split(":");if(y[0]==="cell"){var b=zs(y[1]);if(v.length<=b.r)for(m=v.length;m<=b.r;++m)v[m]||(v[m]=[]);switch(m=b.r,p=b.c,y[2]){case"t":v[m][p]=t(y[3]);break;case"v":v[m][p]=+y[3];break;case"vtf":var w=y[y.length-1];case"vtc":switch(y[3]){case"nl":v[m][p]=!!+y[4];break;default:v[m][p]=+y[4];break}y[2]=="vtf"&&(v[m][p]=[v[m][p],w])}}}return A&&A.sheetRows&&(v=v.slice(0,A.sheetRows)),v}function n(f,A){return A1(r(f,A),A)}function a(f,A){return Sm(n(f,A),A)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var A=[],h=[],m,p="",g=Lc(f["!ref"]),v=Array.isArray(f),y=g.s.r;y<=g.e.r;++y)for(var b=g.s.c;b<=g.e.c;++b)if(p=hn({r:y,c:b}),m=v?(f[y]||[])[b]:f[p],!(!m||m.v==null||m.t==="z")){switch(h=["cell",p,"t"],m.t){case"s":case"str":h.push(e(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=e(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=e(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var w=mo(gs(m.v));h[2]="vtc",h[3]="nd",h[4]=""+w,h[5]=m.w||md(m.z||fn[14],w);break;case"e":continue}A.push(h.join(":"))}return A.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),A.push("valueformat:1:text-wiki"),A.join(`
`)}function d(f){return[s,o,l,o,u(f),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}}(),Fv=function(){function t(d,f,A,h,m){m.raw?f[A][h]=d:d===""||(d==="TRUE"?f[A][h]=!0:d==="FALSE"?f[A][h]=!1:isNaN(ef(d))?isNaN(kv(d).getDate())?f[A][h]=d:f[A][h]=gs(d):f[A][h]=ef(d))}function e(d,f){var A=f||{},h=[];if(!d||d.length===0)return h;for(var m=d.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var g=10,v=0,y=0;y<=p;++y)v=m[y].indexOf(" "),v==-1?v=m[y].length:v++,g=Math.max(g,v);for(y=0;y<=p;++y){h[y]=[];var b=0;for(t(m[y].slice(0,g).trim(),h,y,b,A),b=1;b<=(m[y].length-g)/10+1;++b)t(m[y].slice(g+(b-1)*10,g+b*10).trim(),h,y,b,A)}return A.sheetRows&&(h=h.slice(0,A.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var f={},A=!1,h=0,m=0;h<d.length;++h)(m=d.charCodeAt(h))==34?A=!A:!A&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h]);if(!m.length){f=n;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h])}return m.sort(function(p,g){return p[0]-g[0]||n[p[1]]-n[g[1]]}),r[m.pop()[1]]||44}function s(d,f){var A=f||{},h="",m=A.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(h=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(h=d.charAt(4),d=d.slice(6)):h=a(d.slice(0,1024)):A&&A.FS?h=A.FS:h=a(d.slice(0,1024));var g=0,v=0,y=0,b=0,w=0,j=h.charCodeAt(0),I=!1,_=0,S=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var E=A.dateNF!=null?mke(A.dateNF):null;function F(){var k=d.slice(b,w),P={};if(k.charAt(0)=='"'&&k.charAt(k.length-1)=='"'&&(k=k.slice(1,-1).replace(/""/g,'"')),k.length===0)P.t="z";else if(A.raw)P.t="s",P.v=k;else if(k.trim().length===0)P.t="s",P.v=k;else if(k.charCodeAt(0)==61)k.charCodeAt(1)==34&&k.charCodeAt(k.length-1)==34?(P.t="s",P.v=k.slice(2,-1).replace(/""/g,'"')):$Re(k)?(P.t="n",P.f=k.slice(1)):(P.t="s",P.v=k);else if(k=="TRUE")P.t="b",P.v=!0;else if(k=="FALSE")P.t="b",P.v=!1;else if(!isNaN(y=ef(k)))P.t="n",A.cellText!==!1&&(P.w=k),P.v=y;else if(!isNaN(kv(k).getDate())||E&&k.match(E)){P.z=A.dateNF||fn[14];var D=0;E&&k.match(E)&&(k=pke(k,A.dateNF,k.match(E)||[]),D=1),A.cellDates?(P.t="d",P.v=gs(k,D)):(P.t="n",P.v=mo(gs(k,D))),A.cellText!==!1&&(P.w=md(P.z,P.v instanceof Date?mo(P.v):P.v)),A.cellNF||delete P.z}else P.t="s",P.v=k;if(P.t=="z"||(A.dense?(m[g]||(m[g]=[]),m[g][v]=P):m[hn({c:v,r:g})]=P),b=w+1,S=d.charCodeAt(b),p.e.c<v&&(p.e.c=v),p.e.r<g&&(p.e.r=g),_==j)++v;else if(v=0,++g,A.sheetRows&&A.sheetRows<=g)return!0}e:for(;w<d.length;++w)switch(_=d.charCodeAt(w)){case 34:S===34&&(I=!I);break;case j:case 10:case 13:if(!I&&F())break e;break}return w-b>0&&F(),m["!ref"]=Sn(p),m}function o(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,f):A1(e(d,f),f)}function l(d,f){var A="",h=f.type=="string"?[0,0,0,0]:bR(d,f);switch(f.type){case"base64":A=bu(d);break;case"binary":A=d;break;case"buffer":f.codepage==65001?A=d.toString("utf8"):f.codepage&&typeof w2<"u"||(A=Rn&&Buffer.isBuffer(d)?d.toString("binary"):Em(d));break;case"array":A=ng(d);break;case"string":A=d;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?A=Ga(A.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?A=Ga(A):f.type=="binary"&&typeof w2<"u",A.slice(0,19)=="socialcalc:version:"?bae.to_sheet(f.type=="string"?A:Ga(A),f):o(A,f)}function c(d,f){return Sm(l(d,f),f)}function u(d){for(var f=[],A=oa(d["!ref"]),h,m=Array.isArray(d),p=A.s.r;p<=A.e.r;++p){for(var g=[],v=A.s.c;v<=A.e.c;++v){var y=hn({r:p,c:v});if(h=m?(d[p]||[])[v]:d[y],!h||h.v==null){g.push("          ");continue}for(var b=(h.w||(oA(h),h.w)||"").slice(0,10);b.length<10;)b+=" ";g.push(b+(v===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function PDe(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var a=vae.to_workbook(t,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Fv.to_workbook(t,e)}}var kp=function(){function t(O,G,z){if(O){il(O,O.l||0);for(var L=z.Enum||Se;O.l<O.length;){var Z=O.read_shift(2),ee=L[Z]||L[65535],R=O.read_shift(2),H=O.l+R,ne=ee.f&&ee.f(O,R,z);if(O.l=H,G(ne,ee,Z))return}}}function e(O,G){switch(G.type){case"base64":return r(lu(bu(O)),G);case"binary":return r(lu(O),G);case"buffer":case"array":return r(O,G)}throw"Unsupported type "+G.type}function r(O,G){if(!O)return O;var z=G||{},L=z.dense?[]:{},Z="Sheet1",ee="",R=0,H={},ne=[],ve=[],U={s:{r:0,c:0},e:{r:0,c:0}},He=z.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)z.Enum=Se,t(O,function(ue,we,Me){switch(Me){case 0:z.vers=ue,ue>=4096&&(z.qpro=!0);break;case 6:U=ue;break;case 204:ue&&(ee=ue);break;case 222:ee=ue;break;case 15:case 51:z.qpro||(ue[1].v=ue[1].v.slice(1));case 13:case 14:case 16:Me==14&&(ue[2]&112)==112&&(ue[2]&15)>1&&(ue[2]&15)<15&&(ue[1].z=z.dateNF||fn[14],z.cellDates&&(ue[1].t="d",ue[1].v=tP(ue[1].v))),z.qpro&&ue[3]>R&&(L["!ref"]=Sn(U),H[Z]=L,ne.push(Z),L=z.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},R=ue[3],Z=ee||"Sheet"+(R+1),ee="");var ze=z.dense?(L[ue[0].r]||[])[ue[0].c]:L[hn(ue[0])];if(ze){ze.t=ue[1].t,ze.v=ue[1].v,ue[1].z!=null&&(ze.z=ue[1].z),ue[1].f!=null&&(ze.f=ue[1].f);break}z.dense?(L[ue[0].r]||(L[ue[0].r]=[]),L[ue[0].r][ue[0].c]=ue[1]):L[hn(ue[0])]=ue[1];break}},z);else if(O[2]==26||O[2]==14)z.Enum=Te,O[2]==14&&(z.qpro=!0,O.l=0),t(O,function(ue,we,Me){switch(Me){case 204:Z=ue;break;case 22:ue[1].v=ue[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ue[3]>R&&(L["!ref"]=Sn(U),H[Z]=L,ne.push(Z),L=z.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},R=ue[3],Z="Sheet"+(R+1)),He>0&&ue[0].r>=He)break;z.dense?(L[ue[0].r]||(L[ue[0].r]=[]),L[ue[0].r][ue[0].c]=ue[1]):L[hn(ue[0])]=ue[1],U.e.c<ue[0].c&&(U.e.c=ue[0].c),U.e.r<ue[0].r&&(U.e.r=ue[0].r);break;case 27:ue[14e3]&&(ve[ue[14e3][0]]=ue[14e3][1]);break;case 1537:ve[ue[0]]=ue[1],ue[0]==R&&(Z=ue[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(L["!ref"]=Sn(U),H[ee||Z]=L,ne.push(ee||Z),!ve.length)return{SheetNames:ne,Sheets:H};for(var se={},re=[],Pe=0;Pe<ve.length;++Pe)H[ne[Pe]]?(re.push(ve[Pe]||ne[Pe]),se[ve[Pe]]=H[ve[Pe]]||H[ne[Pe]]):(re.push(ve[Pe]),se[ve[Pe]]={"!ref":"A1"});return{SheetNames:re,Sheets:se}}function n(O,G){var z=G||{};if(+z.codepage>=0&&qd(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var L=Mc(),Z=oa(O["!ref"]),ee=Array.isArray(O),R=[];Er(L,0,s(1030)),Er(L,6,c(Z));for(var H=Math.min(Z.e.r,8191),ne=Z.s.r;ne<=H;++ne)for(var ve=Bi(ne),U=Z.s.c;U<=Z.e.c;++U){ne===Z.s.r&&(R[U]=qs(U));var He=R[U]+ve,se=ee?(O[ne]||[])[U]:O[He];if(!(!se||se.t=="z"))if(se.t=="n")(se.v|0)==se.v&&se.v>=-32768&&se.v<=32767?Er(L,13,h(ne,U,se.v)):Er(L,14,p(ne,U,se.v));else{var re=oA(se);Er(L,15,f(ne,U,re.slice(0,239)))}}return Er(L,1),L.end()}function a(O,G){var z=G||{};if(+z.codepage>=0&&qd(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var L=Mc();Er(L,0,o(O));for(var Z=0,ee=0;Z<O.SheetNames.length;++Z)(O.Sheets[O.SheetNames[Z]]||{})["!ref"]&&Er(L,27,ae(O.SheetNames[Z],ee++));var R=0;for(Z=0;Z<O.SheetNames.length;++Z){var H=O.Sheets[O.SheetNames[Z]];if(!(!H||!H["!ref"])){for(var ne=oa(H["!ref"]),ve=Array.isArray(H),U=[],He=Math.min(ne.e.r,8191),se=ne.s.r;se<=He;++se)for(var re=Bi(se),Pe=ne.s.c;Pe<=ne.e.c;++Pe){se===ne.s.r&&(U[Pe]=qs(Pe));var ue=U[Pe]+re,we=ve?(H[se]||[])[Pe]:H[ue];if(!(!we||we.t=="z"))if(we.t=="n")Er(L,23,F(se,Pe,R,we.v));else{var Me=oA(we);Er(L,22,_(se,Pe,R,Me.slice(0,239)))}}++R}}return Er(L,1),L.end()}function s(O){var G=tr(2);return G.write_shift(2,O),G}function o(O){var G=tr(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var z=0,L=0,Z=0,ee=0;ee<O.SheetNames.length;++ee){var R=O.SheetNames[ee],H=O.Sheets[R];if(!(!H||!H["!ref"])){++Z;var ne=Lc(H["!ref"]);z<ne.e.r&&(z=ne.e.r),L<ne.e.c&&(L=ne.e.c)}}return z>8191&&(z=8191),G.write_shift(2,z),G.write_shift(1,Z),G.write_shift(1,L),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function l(O,G,z){var L={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&z.qpro?(L.s.c=O.read_shift(1),O.l++,L.s.r=O.read_shift(2),L.e.c=O.read_shift(1),O.l++,L.e.r=O.read_shift(2),L):(L.s.c=O.read_shift(2),L.s.r=O.read_shift(2),G==12&&z.qpro&&(O.l+=2),L.e.c=O.read_shift(2),L.e.r=O.read_shift(2),G==12&&z.qpro&&(O.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function c(O){var G=tr(8);return G.write_shift(2,O.s.c),G.write_shift(2,O.s.r),G.write_shift(2,O.e.c),G.write_shift(2,O.e.r),G}function u(O,G,z){var L=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(L[0].c=O.read_shift(1),L[3]=O.read_shift(1),L[0].r=O.read_shift(2),O.l+=2):(L[2]=O.read_shift(1),L[0].c=O.read_shift(2),L[0].r=O.read_shift(2)),L}function d(O,G,z){var L=O.l+G,Z=u(O,G,z);if(Z[1].t="s",z.vers==20768){O.l++;var ee=O.read_shift(1);return Z[1].v=O.read_shift(ee,"utf8"),Z}return z.qpro&&O.l++,Z[1].v=O.read_shift(L-O.l,"cstr"),Z}function f(O,G,z){var L=tr(7+z.length);L.write_shift(1,255),L.write_shift(2,G),L.write_shift(2,O),L.write_shift(1,39);for(var Z=0;Z<L.length;++Z){var ee=z.charCodeAt(Z);L.write_shift(1,ee>=128?95:ee)}return L.write_shift(1,0),L}function A(O,G,z){var L=u(O,G,z);return L[1].v=O.read_shift(2,"i"),L}function h(O,G,z){var L=tr(7);return L.write_shift(1,255),L.write_shift(2,G),L.write_shift(2,O),L.write_shift(2,z,"i"),L}function m(O,G,z){var L=u(O,G,z);return L[1].v=O.read_shift(8,"f"),L}function p(O,G,z){var L=tr(13);return L.write_shift(1,255),L.write_shift(2,G),L.write_shift(2,O),L.write_shift(8,z,"f"),L}function g(O,G,z){var L=O.l+G,Z=u(O,G,z);if(Z[1].v=O.read_shift(8,"f"),z.qpro)O.l=L;else{var ee=O.read_shift(2);w(O.slice(O.l,O.l+ee),Z),O.l+=ee}return Z}function v(O,G,z){var L=G&32768;return G&=-32769,G=(L?O:0)+(G>=8192?G-16384:G),(L?"":"$")+(z?qs(G):Bi(G))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(O,G){il(O,0);for(var z=[],L=0,Z="",ee="",R="",H="";O.l<O.length;){var ne=O[O.l++];switch(ne){case 0:z.push(O.read_shift(8,"f"));break;case 1:ee=v(G[0].c,O.read_shift(2),!0),Z=v(G[0].r,O.read_shift(2),!1),z.push(ee+Z);break;case 2:{var ve=v(G[0].c,O.read_shift(2),!0),U=v(G[0].r,O.read_shift(2),!1);ee=v(G[0].c,O.read_shift(2),!0),Z=v(G[0].r,O.read_shift(2),!1),z.push(ve+U+":"+ee+Z)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(O.read_shift(2));break;case 6:{for(var He="";ne=O[O.l++];)He+=String.fromCharCode(ne);z.push('"'+He.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:H=z.pop(),R=z.pop(),z.push(["AND","OR"][ne-20]+"("+R+","+H+")");break;default:if(ne<32&&b[ne])H=z.pop(),R=z.pop(),z.push(R+b[ne]+H);else if(y[ne]){if(L=y[ne][1],L==69&&(L=O[O.l++]),L>z.length){console.error("WK1 bad formula parse 0x"+ne.toString(16)+":|"+z.join("|")+"|");return}var se=z.slice(-L);z.length-=L,z.push(y[ne][0]+"("+se.join(",")+")")}else return ne<=7?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=24?console.error("WK1 unsupported op "+ne.toString(16)):ne<=30?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=115?console.error("WK1 unsupported function opcode "+ne.toString(16)):console.error("WK1 unrecognized opcode "+ne.toString(16))}}z.length==1?G[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function j(O){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=O.read_shift(2),G[3]=O[O.l++],G[0].c=O[O.l++],G}function I(O,G){var z=j(O);return z[1].t="s",z[1].v=O.read_shift(G-4,"cstr"),z}function _(O,G,z,L){var Z=tr(6+L.length);Z.write_shift(2,O),Z.write_shift(1,z),Z.write_shift(1,G),Z.write_shift(1,39);for(var ee=0;ee<L.length;++ee){var R=L.charCodeAt(ee);Z.write_shift(1,R>=128?95:R)}return Z.write_shift(1,0),Z}function S(O,G){var z=j(O);z[1].v=O.read_shift(2);var L=z[1].v>>1;if(z[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return z[1].v=L,z}function E(O,G){var z=j(O),L=O.read_shift(4),Z=O.read_shift(4),ee=O.read_shift(2);if(ee==65535)return L===0&&Z===3221225472?(z[1].t="e",z[1].v=15):L===0&&Z===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var R=ee&32768;return ee=(ee&32767)-16446,z[1].v=(1-R*2)*(Z*Math.pow(2,ee+32)+L*Math.pow(2,ee)),z}function F(O,G,z,L){var Z=tr(14);if(Z.write_shift(2,O),Z.write_shift(1,z),Z.write_shift(1,G),L==0)return Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,65535),Z;var ee=0,R=0,H=0,ne=0;return L<0&&(ee=1,L=-L),R=Math.log2(L)|0,L/=Math.pow(2,R-31),ne=L>>>0,ne&2147483648||(L/=2,++R,ne=L>>>0),L-=ne,ne|=2147483648,ne>>>=0,L*=Math.pow(2,32),H=L>>>0,Z.write_shift(4,H),Z.write_shift(4,ne),R+=16383+(ee?32768:0),Z.write_shift(2,R),Z}function k(O,G){var z=E(O);return O.l+=G-14,z}function P(O,G){var z=j(O),L=O.read_shift(4);return z[1].v=L>>6,z}function D(O,G){var z=j(O),L=O.read_shift(8,"f");return z[1].v=L,z}function X(O,G){var z=D(O);return O.l+=G-10,z}function pe(O,G){return O[O.l+G-1]==0?O.read_shift(G,"cstr"):""}function ge(O,G){var z=O[O.l++];z>G-1&&(z=G-1);for(var L="";L.length<z;)L+=String.fromCharCode(O[O.l++]);return L}function fe(O,G,z){if(!(!z.qpro||G<21)){var L=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var Z=O.read_shift(G-21,"cstr");return[L,Z]}}function xe(O,G){for(var z={},L=O.l+G;O.l<L;){var Z=O.read_shift(2);if(Z==14e3){for(z[Z]=[0,""],z[Z][0]=O.read_shift(2);O[O.l];)z[Z][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return z}function ae(O,G){var z=tr(5+O.length);z.write_shift(2,14e3),z.write_shift(2,G);for(var L=0;L<O.length;++L){var Z=O.charCodeAt(L);z[z.l++]=Z>127?95:Z}return z[z.l++]=0,z}var Se={0:{n:"BOF",f:Mi},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:A},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:pe},222:{n:"SHEETNAMELP",f:ge},65535:{n:""}},Te={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:k},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:xe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:D},40:{n:"FORMULA28",f:X},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:pe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:fe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}}();function BDe(t){var e={},r=t.match(Hl),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=An(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=M6[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return e}var TDe=function(){var t=_2("t"),e=_2("rPr");function r(s){var o=s.match(t);if(!o)return{t:"s",v:""};var l={t:"s",v:ia(o[1])},c=s.match(e);return c&&(l.s=BDe(c[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(l){return l.v})}}(),kDe=function(){var e=/(\r\n|\n)/g;function r(a,s,o){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),a.b&&(s.push("<b>"),o.push("</b>")),a.i&&(s.push("<i>"),o.push("</i>")),a.strike&&(s.push("<s>"),o.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),FDe=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,ODe=/<(?:\w+:)?r>/,DDe=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function lR(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ia(Ga(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ga(t),r&&(n.h=z6(n.t))):t.match(ODe)&&(n.r=Ga(t),n.t=ia(Ga((t.replace(DDe,"").match(FDe)||[]).join("").replace(Hl,""))),r&&(n.h=kDe(TDe(n.r)))),n):{t:""}}var RDe=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,MDe=/<(?:\w+:)?(?:si|sstItem)>/g,LDe=/<\/(?:\w+:)?(?:si|sstItem)>/;function UDe(t,e){var r=[],n="";if(!t)return r;var a=t.match(RDe);if(a){n=a[2].replace(MDe,"").split(LDe);for(var s=0;s!=n.length;++s){var o=lR(n[s].trim(),e);o!=null&&(r[r.length]=o)}a=An(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var QDe=/^\s|\s$|[\t\n\r]/;function wae(t,e){if(!e.bookSST)return"";var r=[ki];r[r.length]=_r("sst",null,{xmlns:Sg[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var a=t[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(QDe)&&(s+=' xml:space="preserve"'),s+=">"+Ra(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function VDe(t){return[t.read_shift(4),t.read_shift(4)]}function HDe(t,e){var r=[],n=!1;return NA(t,function(s,o,l){switch(l){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function $De(t,e){return e||(e=tr(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var GDe=tFe;function KDe(t){var e=Mc();fr(e,159,$De(t));for(var r=0;r<t.length;++r)fr(e,19,GDe(t[r]));return fr(e,160),e.end()}function Nae(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Wh(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function qDe(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Wh(t,4),e.U=Wh(t,4),e.W=Wh(t,4),e}function zDe(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},a=t.read_shift(4),s=[];a-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function WDe(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(zDe(t));return e}function XDe(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function YDe(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Wh(t,4),e.U=Wh(t,4),e.W=Wh(t,4),e}function JDe(t){var e=YDe(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function Cae(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function _ae(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function ZDe(t){var e=Wh(t);switch(e.Minor){case 2:return[e.Minor,e6e(t)];case 3:return[e.Minor,t6e()];case 4:return[e.Minor,r6e(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function e6e(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=Cae(t,r),a=_ae(t,t.length-t.l);return{t:"Std",h:n,v:a}}function t6e(){throw new Error("File is password-protected: ECMA-376 Extensible")}function r6e(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Hl,function(s){var o=An(s);switch(th(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function n6e(t,e){var r={},n=r.EncryptionVersionInfo=Wh(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,r.EncryptionHeader=Cae(t,a),e-=a,r.EncryptionVerifier=_ae(t,e),r}function a6e(t){var e={},r=e.EncryptionVersionInfo=Wh(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function cR(t){var e=0,r,n=Nae(t),a=n.length+1,s,o,l,c,u;for(r=hm(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)o=r[s],l=e&16384?1:0,c=e<<1&32767,u=l|c,e=u^o;return e^52811}var Eae=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,l){return n(o^l)},s=function(o){for(var l=e[o.length-1],c=104,u=o.length-1;u>=0;--u)for(var d=o[u],f=0;f!=7;++f)d&64&&(l^=r[c]),d*=2,--c;return l};return function(o){for(var l=Nae(o),c=s(l),u=l.length,d=hm(16),f=0;f!=16;++f)d[f]=0;var A,h,m;for((u&1)===1&&(A=c>>8,d[u]=a(t[0],A),--u,A=c&255,h=l[l.length-1],d[u]=a(h,A));u>0;)--u,A=c>>8,d[u]=a(l[u],A),--u,A=c&255,d[u]=a(l[u],A);for(u=15,m=15-l.length;m>0;)A=c>>8,d[u]=a(t[m],A),--u,--m,A=c&255,d[u]=a(l[u],A),--u,--m;return d}}(),s6e=function(t,e,r,n,a){a||(a=e),n||(n=Eae(t));var s,o;for(s=0;s!=e.length;++s)o=e[s],o^=n[r],o=(o>>5|o<<3)&255,a[s]=o,++r;return[a,r,n]},i6e=function(t){var e=0,r=Eae(t);return function(n){var a=s6e("",n,e,r);return e=a[1],a[0]}};function o6e(t,e,r,n){var a={key:Mi(t),verificationBytes:Mi(t)};return r.password&&(a.verifier=cR(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=i6e(r.password)),a}function l6e(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=a6e(t):n.Data=n6e(t,e),n}function c6e(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?l6e(t,e-2,n):o6e(t,r.biff>=8?e:e-2,r,n),n}var Sae=function(){function t(a,s){switch(s.type){case"base64":return e(bu(a),s);case"binary":return e(a,s);case"buffer":return e(Rn&&Buffer.isBuffer(a)?a.toString("binary"):Em(a),s);case"array":return e(ng(a),s)}throw new Error("Unrecognized type "+s.type)}function e(a,s){var o=s||{},l=o.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var A=/\\\w+\b/g,h=0,m,p=-1;m=A.exec(d);){switch(m[0]){case"\\cell":var g=d.slice(h,A.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var v={v:g,t:"s"};Array.isArray(l)?l[f][p]=v:l[hn({r:f,c:p})]=v}break}h=A.lastIndex}p>u.e.c&&(u.e.c=p)}),l["!ref"]=Sn(u),l}function r(a,s){return Sm(t(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],o=oa(a["!ref"]),l,c=Array.isArray(a),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var f=hn({r:u,c:d});l=c?(a[u]||[])[d]:a[f],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(oA(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function u6e(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function j2(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function d6e(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,a=Math.max(e,r,n),s=Math.min(e,r,n),o=a-s;if(o===0)return[0,0,e];var l=0,c=0,u=a+s;switch(c=o/(u>1?2-u:u),a){case e:l=((r-n)/o+6)%6;break;case r:l=(n-e)/o+2;break;case n:l=(e-r)/o+4;break}return[l/6,c,u/2]}function f6e(t){var e=t[0],r=t[1],n=t[2],a=r*2*(n<.5?n:1-n),s=n-a/2,o=[s,s,s],l=6*e,c;if(r!==0)switch(l|0){case 0:case 6:c=a*l,o[0]+=a,o[1]+=c;break;case 1:c=a*(2-l),o[0]+=c,o[1]+=a;break;case 2:c=a*(l-2),o[1]+=a,o[2]+=c;break;case 3:c=a*(4-l),o[1]+=c,o[2]+=a;break;case 4:c=a*(l-4),o[2]+=a,o[0]+=c;break;case 5:c=a*(6-l),o[2]+=c,o[0]+=a;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function $S(t,e){if(e===0)return t;var r=d6e(u6e(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),j2(f6e(r))}var Iae=6,h6e=15,A6e=1,Ol=Iae;function P2(t){return Math.floor((t+Math.round(128/Ol)/256)*Ol)}function B2(t){return Math.floor((t-5)/Ol*100+.5)/100}function GS(t){return Math.round((t*Ol+5)/Ol*256)/256}function I5(t){return GS(B2(P2(t)))}function uR(t){var e=Math.abs(t-I5(t)),r=Ol;if(e>.005)for(Ol=A6e;Ol<h6e;++Ol)Math.abs(t-I5(t))<=e&&(e=Math.abs(t-I5(t)),r=Ol);Ol=r}function Am(t){t.width?(t.wpx=P2(t.width),t.wch=B2(t.wpx),t.MDW=Ol):t.wpx?(t.wch=B2(t.wpx),t.width=GS(t.wch),t.MDW=Ol):typeof t.wch=="number"&&(t.width=GS(t.wch),t.wpx=P2(t.width),t.MDW=Ol),t.customWidth&&delete t.customWidth}var m6e=96,jae=m6e;function T2(t){return t*96/jae}function Ov(t){return t*jae/96}var p6e={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function g6e(t,e,r,n){e.Borders=[];var a={},s=!1;(t[0].match(Hl)||[]).forEach(function(o){var l=An(o);switch(th(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=hs(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=hs(l.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function x6e(t,e,r,n){e.Fills=[];var a={},s=!1;(t[0].match(Hl)||[]).forEach(function(o){var l=An(o);switch(th(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function v6e(t,e,r,n){e.Fonts=[];var a={},s=!1;(t[0].match(Hl)||[]).forEach(function(o){var l=An(o);switch(th(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=Ga(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?hs(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?hs(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?hs(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?hs(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?hs(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?hs(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?hs(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=M6[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=hs(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var c=Bp[a.color.index];a.color.index==81&&(c=Bp[1]),c||(c=Bp[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=$S(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function y6e(t,e,r){e.NumberFmt=[];for(var n=hi(fn),a=0;a<n.length;++a)e.NumberFmt[n[a]]=fn[n[a]];var s=t[0].match(Hl);if(s)for(a=0;a<s.length;++a){var o=An(s[a]);switch(th(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=ia(Ga(o.formatCode)),c=parseInt(o.numFmtId,10);if(e.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=l}zh(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function b6e(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=_r("numFmt",null,{numFmtId:n,formatCode:Ra(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=_r("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var XC=["numFmtId","fillId","fontId","borderId","xfId"],YC=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function w6e(t,e,r){e.CellXf=[];var n,a=!1;(t[0].match(Hl)||[]).forEach(function(s){var o=An(s),l=0;switch(th(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<XC.length;++l)n[XC[l]]&&(n[XC[l]]=parseInt(n[XC[l]],10));for(l=0;l<YC.length;++l)n[YC[l]]&&(n[YC[l]]=hs(n[YC[l]]));if(e.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[l]){n.numFmtId=l;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=hs(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function N6e(t){var e=[];return e[e.length]=_r("cellXfs",null),t.forEach(function(r){e[e.length]=_r("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=_r("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var C6e=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(e))&&y6e(f,d,u),(f=l.match(a))&&v6e(f,d,c,u),(f=l.match(n))&&x6e(f,d,c,u),(f=l.match(s))&&g6e(f,d,c,u),(f=l.match(r))&&w6e(f,d,u),d}}();function Pae(t,e){var r=[ki,_r("styleSheet",null,{xmlns:Sg[0],"xmlns:vt":uo.vt})],n;return t.SSF&&(n=b6e(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=N6e(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function _6e(t,e){var r=t.read_shift(2),n=Ml(t);return[r,n]}function E6e(t,e,r){r||(r=tr(6+4*e.length)),r.write_shift(2,t),Do(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function S6e(t,e,r){var n={};n.sz=t.read_shift(2)/20;var a=lFe(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var l=t.read_shift(1);l>0&&(n.family=l);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=oFe(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ml(t),n}function I6e(t,e){e||(e=tr(25+4*32)),e.write_shift(2,t.sz*20),cFe(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),QS(t.color,e);var n=0;return n=2,e.write_shift(1,n),Do(t.name,e),e.length>e.l?e.slice(0,e.l):e}var j6e=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],j5,P6e=Ql;function N$(t,e){e||(e=tr(4*3+8*7+16*1)),j5||(j5=Zj(j6e));var r=j5[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(QS({auto:1},e),QS({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function B6e(t,e){var r=t.l+e,n=t.read_shift(2),a=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:a}}function Bae(t,e,r){r||(r=tr(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function hy(t,e){return e||(e=tr(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var T6e=Ql;function k6e(t,e){return e||(e=tr(51)),e.write_shift(1,0),hy(null,e),hy(null,e),hy(null,e),hy(null,e),hy(null,e),e.length>e.l?e.slice(0,e.l):e}function F6e(t,e){return e||(e=tr(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),US(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function O6e(t,e,r){var n=tr(2052);return n.write_shift(4,t),US(e,n),US(r,n),n.length>n.l?n.slice(0,n.l):n}function D6e(t,e,r){var n={};n.NumberFmt=[];for(var a in fn)n.NumberFmt[a]=fn[a];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return NA(t,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],zh(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=$S(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(d),o=!0;break;case 38:s.pop(),o=!1;break;default:if(u.T>0)s.push(d);else if(u.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function R6e(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&++r}),r!=0&&(fr(t,615,tf(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&fr(t,44,E6e(a,e[a]))}),fr(t,616))}}function M6e(t){var e=1;fr(t,611,tf(e)),fr(t,43,I6e({sz:12,color:{theme:1},name:"Calibri",family:2})),fr(t,612)}function L6e(t){var e=2;fr(t,603,tf(e)),fr(t,45,N$({patternType:"none"})),fr(t,45,N$({patternType:"gray125"})),fr(t,604)}function U6e(t){var e=1;fr(t,613,tf(e)),fr(t,46,k6e()),fr(t,614)}function Q6e(t){var e=1;fr(t,626,tf(e)),fr(t,47,Bae({numFmtId:0},65535)),fr(t,627)}function V6e(t,e){fr(t,617,tf(e.length)),e.forEach(function(r){fr(t,47,Bae(r,0))}),fr(t,618)}function H6e(t){var e=1;fr(t,619,tf(e)),fr(t,48,F6e({xfId:0,name:"Normal"})),fr(t,620)}function $6e(t){var e=0;fr(t,505,tf(e)),fr(t,506)}function G6e(t){var e=0;fr(t,508,O6e(e,"TableStyleMedium9","PivotStyleMedium4")),fr(t,509)}function K6e(t,e){var r=Mc();return fr(r,278),R6e(r,t.SSF),M6e(r),L6e(r),U6e(r),Q6e(r),V6e(r,e.cellXfs),H6e(r),$6e(r),G6e(r),fr(r,279),r.end()}var q6e=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function z6e(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Hl)||[]).forEach(function(a){var s=An(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[q6e.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function W6e(){}function X6e(){}var Y6e=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,J6e=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Z6e=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function eRe(t,e,r){e.themeElements={};var n;[["clrScheme",Y6e,z6e],["fontScheme",J6e,W6e],["fmtScheme",Z6e,X6e]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,r)})}var tRe=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Tae(t,e){(!t||t.length===0)&&(t=dR());var r,n={};if(!(r=t.match(tRe)))throw new Error("themeElements not found in theme");return eRe(r[0],n,e),n.raw=t,n}function dR(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[ki];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function rRe(t,e,r){var n=t.l+e,a=t.read_shift(4);if(a!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var o;try{o=Cne(s,{type:"array"})}catch{return}var l=cu(o,"theme/theme/theme1.xml",!0);if(l)return Tae(l,r)}}function nRe(t){return t.read_shift(4)}function aRe(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=sRe(t,4);break;case 2:e.xclrValue=dae(t);break;case 3:e.xclrValue=nRe(t);break;case 4:t.l+=4;break}return t.l+=8,e}function sRe(t,e){return Ql(t,e)}function iRe(t,e){return Ql(t,e)}function oRe(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=aRe(t);break;case 6:n[1]=iRe(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function lRe(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),s=[];a-- >0;)s.push(oRe(t,r-t.l));return{ixfe:n,ext:s}}function cRe(t,e){e.forEach(function(r){switch(r[0]){}})}function uRe(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Ml(t)}}function dRe(t){var e=tr(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Do(t.name,e),e.slice(0,e.l)}function fRe(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function hRe(t){var e=tr(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function ARe(t,e){var r=tr(8+2*e.length);return r.write_shift(4,t),Do(e,r),r.slice(0,r.l)}function mRe(t){return t.l+=4,t.read_shift(4)!=0}function pRe(t,e){var r=tr(8);return r.write_shift(4,t),r.write_shift(4,1),r}function gRe(t,e,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],o=!1,l=2;return NA(t,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):l==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:s.push(d),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!u.T){if(!o||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function xRe(){var t=Mc();return fr(t,332),fr(t,334,tf(1)),fr(t,335,dRe({name:"XLDAPR",version:12e4,flags:3496657072})),fr(t,336),fr(t,339,ARe(1,"XLDAPR")),fr(t,52),fr(t,35,tf(514)),fr(t,4096,tf(0)),fr(t,4097,Yu(1)),fr(t,36),fr(t,53),fr(t,340),fr(t,337,pRe(1)),fr(t,51,hRe([[1,0]])),fr(t,338),fr(t,333),t.end()}function vRe(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,s=2,o;return t.replace(Hl,function(l){var c=An(l);switch(th(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function kae(){var t=[ki];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function yRe(t){var e=[];if(!t)return e;var r=1;return(t.match(Hl)||[]).forEach(function(n){var a=An(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,e.push(a);break}}),e}function bRe(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=hn(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function wRe(t,e,r){var n=[];return NA(t,function(s,o,l){switch(l){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function NRe(t,e,r,n){if(!t)return t;var a=n||{},s=!1;NA(t,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function CRe(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Kx=1024;function Fae(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[_r("xml",null,{"xmlns:v":iu.v,"xmlns:o":iu.o,"xmlns:x":iu.x,"xmlns:mv":iu.mv}).replace(/\/>/,">"),_r("o:shapelayout",_r("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),_r("v:shapetype",[_r("v:stroke",null,{joinstyle:"miter"}),_r("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Kx<t*1e3;)Kx+=1e3;return e.forEach(function(s){var o=zs(s[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?_r("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=_r("v:fill",c,l),d={on:"t",obscured:"t"};++Kx,a=a.concat(["<v:shape"+E2({id:"_x0000_s"+Kx,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,_r("v:shadow",null,d),_r("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ll("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),ll("x:AutoFill","False"),ll("x:Row",String(o.r)),ll("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function C$(t,e,r,n){var a=Array.isArray(t),s;e.forEach(function(o){var l=zs(o.ref);if(a?(t[l.r]||(t[l.r]=[]),s=t[l.r][l.c]):s=t[o.ref],!s){s={t:"z"},a?t[l.r][l.c]=s:t[o.ref]=s;var c=oa(t["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=Sn(c);u!==t["!ref"]&&(t["!ref"]=u)}s.c||(s.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}s.c.push(d)})}function _Re(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=An(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=zs(c.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),A=!!f&&!!f[1]&&lR(f[1])||{r:"",t:"",h:""};u.r=A.r,A.r=="<t></t>"&&(A.t=A.h=""),u.t=(A.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=A.h),n.push(u)}}}}),n}function Oae(t){var e=[ki,_r("comments",null,{xmlns:Sg[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(a){var s=Ra(a.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(Ra(c.a))),s.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)e.push(ll("t",Ra(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)o+=`Reply:
    `+s[l]+`
`;e.push(ll("t",Ra(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function ERe(t,e){var r=[],n=!1,a={},s=0;return t.replace(Hl,function(l,c){var u=An(l);switch(th(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=c+l.length;break;case"</text>":a.t=t.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function SRe(t,e,r){var n=[ki,_r("ThreadedComments",null,{xmlns:uo.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var s="";(a[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?s=c.id:c.parentId=s,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(_r("threadedComment",ll("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function IRe(t,e){var r=[],n=!1;return t.replace(Hl,function(s){var o=An(s);switch(th(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function jRe(t){var e=[ki,_r("personList",null,{xmlns:uo.TCMNT,"xmlns:x":Sg[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(_r("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function PRe(t){var e={};e.iauthor=t.read_shift(4);var r=Bg(t);return e.rfx=r.s,e.ref=hn(r.s),t.l+=16,e}function BRe(t,e){return e==null&&(e=tr(36)),e.write_shift(4,t[1].iauthor),m1(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var TRe=Ml;function kRe(t){return Do(t.slice(0,54))}function FRe(t,e){var r=[],n=[],a={},s=!1;return NA(t,function(l,c,u){switch(u){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function ORe(t){var e=Mc(),r=[];return fr(e,628),fr(e,630),t.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),fr(e,632,kRe(a.a)))})}),fr(e,631),fr(e,633),t.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:zs(n[0]),e:zs(n[0])};fr(e,635,BRe([s,a])),a.t&&a.t.length>0&&fr(e,637,nFe(a)),fr(e,636),delete a.iauthor})}),fr(e,634),fr(e,629),e.end()}var DRe="application/vnd.ms-office.vbaProject";function RRe(t){var e=nn.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");nn.utils.cfb_add(e,a,t.FileIndex[n].content)}}),nn.write(e)}function MRe(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&nn.utils.cfb_add(t,a,e.FileIndex[n].content)}})}var Dae=["xlsb","xlsm","xlam","biff8","xla"];function LRe(){return{"!type":"dialog"}}function URe(){return{"!type":"dialog"}}function QRe(){return{"!type":"macro"}}function VRe(){return{"!type":"macro"}}var uv=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,a,s,o){var l=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=e.c:--d,c?u+=e.r:--u,a+(l?"":"$")+qs(d)+(c?"":"$")+Bi(u)}return function(a,s){return e=s,a.replace(t,r)}}(),fR=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,hR=function(){return function(e,r){return e.replace(fR,function(n,a,s,o,l,c){var u=Z6(o)-(s?0:r.c),d=J6(c)-(l?0:r.r),f=d==0?"":l?d+1:"["+d+"]",A=u==0?"":s?u+1:"["+u+"]";return a+"R"+f+"C"+A})}}();function Rae(t,e){return t.replace(fR,function(r,n,a,s,o,l){return n+(a=="$"?a+s:qs(Z6(s)+e.c))+(o=="$"?o+l:Bi(J6(l)+e.r))})}function HRe(t,e,r){var n=Lc(e),a=n.s,s=zs(r),o={r:s.r-a.r,c:s.c-a.c};return Rae(t,o)}function $Re(t){return t.length!=1}function _$(t){return t.replace(/_xlfn\./g,"")}function Fi(t){t.l+=1}function mm(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Mae(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Lae(t);r.biff==12&&(n=4)}var a=t.read_shift(n),s=t.read_shift(n),o=mm(t),l=mm(t);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function Lae(t){var e=mm(t),r=mm(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function GRe(t,e,r){if(r.biff<8)return Lae(t);var n=t.read_shift(r.biff==12?4:2),a=t.read_shift(r.biff==12?4:2),s=mm(t),o=mm(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function Uae(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return KRe(t);var n=t.read_shift(r&&r.biff==12?4:2),a=mm(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function KRe(t){var e=mm(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function qRe(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function zRe(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return WRe(t);var a=t.read_shift(n>=12?4:2),s=t.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;a>524287;)a-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:o,rRel:l}}function WRe(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:a,rRel:n}}function XRe(t,e,r){var n=(t[t.l++]&96)>>5,a=Mae(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function YRe(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var o=Mae(t,s,r);return[n,a,o]}function JRe(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function ZRe(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,a]}function e8e(t,e,r){var n=(t[t.l++]&96)>>5,a=GRe(t,e-1,r);return[n,a]}function t8e(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function E$(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function r8e(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(t.read_shift(r&&r.biff==2?1:2));return a}function n8e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function a8e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function s8e(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function i8e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function Qae(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function o8e(t){return t.read_shift(2),Qae(t)}function l8e(t){return t.read_shift(2),Qae(t)}function c8e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=Uae(t,0,r);return[n,a]}function u8e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=zRe(t,0,r);return[n,a]}function d8e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=Uae(t,0,r);return[n,a,s]}function f8e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(r&&r.biff<=3?1:2);return[mMe[a],$ae[a],n]}function h8e(t,e,r){var n=t[t.l++],a=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:A8e(t);return[a,(s[0]===0?$ae:AMe)[s[1]]]}function A8e(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function m8e(t,e,r){t.l+=r&&r.biff==2?3:4}function p8e(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function g8e(t){return t.l++,CA[t.read_shift(1)]}function x8e(t){return t.l++,t.read_shift(2)}function v8e(t){return t.l++,t.read_shift(1)!==0}function y8e(t){return t.l++,Dl(t)}function b8e(t,e,r){return t.l++,Tw(t,e-1,r)}function w8e(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=yi(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=CA[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Dl(t);break;case 2:r[1]=Tg(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function N8e(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?Bg:rP)(t));return a}function C8e(t,e,r){var n=0,a=0;r.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var l=0;l!=a;++l)o[s][l]=w8e(t,r.biff);return o}function _8e(t,e,r){var n=t.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=t.read_shift(a);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function E8e(t,e,r){if(r.biff==5)return S8e(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),s=t.read_shift(4);return[n,a,s]}function S8e(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function I8e(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function j8e(t,e,r){var n=t.read_shift(1)>>>5&3,a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function P8e(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function B8e(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,a]}var T8e=Ql,k8e=Ql,F8e=Ql;function Fw(t,e,r){return t.l+=2,[qRe(t)]}function AR(t){return t.l+=6,[]}var O8e=Fw,D8e=AR,R8e=AR,M8e=Fw;function Vae(t){return t.l+=2,[Mi(t),t.read_shift(2)&1]}var L8e=Fw,U8e=Vae,Q8e=AR,V8e=Fw,H8e=Fw,$8e=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function G8e(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),s=t.read_shift(2),o=$8e[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:a,C:s}}function K8e(t){return t.l+=2,[t.read_shift(4)]}function q8e(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function z8e(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function W8e(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function X8e(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Y8e(t){return t.l+=4,[0,0]}var S$={1:{n:"PtgExp",f:p8e},2:{n:"PtgTbl",f:F8e},3:{n:"PtgAdd",f:Fi},4:{n:"PtgSub",f:Fi},5:{n:"PtgMul",f:Fi},6:{n:"PtgDiv",f:Fi},7:{n:"PtgPower",f:Fi},8:{n:"PtgConcat",f:Fi},9:{n:"PtgLt",f:Fi},10:{n:"PtgLe",f:Fi},11:{n:"PtgEq",f:Fi},12:{n:"PtgGe",f:Fi},13:{n:"PtgGt",f:Fi},14:{n:"PtgNe",f:Fi},15:{n:"PtgIsect",f:Fi},16:{n:"PtgUnion",f:Fi},17:{n:"PtgRange",f:Fi},18:{n:"PtgUplus",f:Fi},19:{n:"PtgUminus",f:Fi},20:{n:"PtgPercent",f:Fi},21:{n:"PtgParen",f:Fi},22:{n:"PtgMissArg",f:Fi},23:{n:"PtgStr",f:b8e},26:{n:"PtgSheet",f:q8e},27:{n:"PtgEndSheet",f:z8e},28:{n:"PtgErr",f:g8e},29:{n:"PtgBool",f:v8e},30:{n:"PtgInt",f:x8e},31:{n:"PtgNum",f:y8e},32:{n:"PtgArray",f:t8e},33:{n:"PtgFunc",f:f8e},34:{n:"PtgFuncVar",f:h8e},35:{n:"PtgName",f:_8e},36:{n:"PtgRef",f:c8e},37:{n:"PtgArea",f:XRe},38:{n:"PtgMemArea",f:I8e},39:{n:"PtgMemErr",f:T8e},40:{n:"PtgMemNoMem",f:k8e},41:{n:"PtgMemFunc",f:j8e},42:{n:"PtgRefErr",f:P8e},43:{n:"PtgAreaErr",f:JRe},44:{n:"PtgRefN",f:u8e},45:{n:"PtgAreaN",f:e8e},46:{n:"PtgMemAreaN",f:W8e},47:{n:"PtgMemNoMemN",f:X8e},57:{n:"PtgNameX",f:E8e},58:{n:"PtgRef3d",f:d8e},59:{n:"PtgArea3d",f:YRe},60:{n:"PtgRefErr3d",f:B8e},61:{n:"PtgAreaErr3d",f:ZRe},255:{}},J8e={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Z8e={1:{n:"PtgElfLel",f:Vae},2:{n:"PtgElfRw",f:V8e},3:{n:"PtgElfCol",f:O8e},6:{n:"PtgElfRwV",f:H8e},7:{n:"PtgElfColV",f:M8e},10:{n:"PtgElfRadical",f:L8e},11:{n:"PtgElfRadicalS",f:Q8e},13:{n:"PtgElfColS",f:D8e},15:{n:"PtgElfColSV",f:R8e},16:{n:"PtgElfRadicalLel",f:U8e},25:{n:"PtgList",f:G8e},29:{n:"PtgSxName",f:K8e},255:{}},eMe={0:{n:"PtgAttrNoop",f:Y8e},1:{n:"PtgAttrSemi",f:i8e},2:{n:"PtgAttrIf",f:a8e},4:{n:"PtgAttrChoose",f:r8e},8:{n:"PtgAttrGoto",f:n8e},16:{n:"PtgAttrSum",f:m8e},32:{n:"PtgAttrBaxcel",f:E$},33:{n:"PtgAttrBaxcel",f:E$},64:{n:"PtgAttrSpace",f:o8e},65:{n:"PtgAttrSpaceSemi",f:l8e},128:{n:"PtgAttrIfError",f:s8e},255:{}};function Ow(t,e,r,n){if(n.biff<8)return Ql(t,e);for(var a=t.l+e,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=C8e(t,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=N8e(t,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=a-t.l,e!==0&&s.push(Ql(t,e)),s}function Dw(t,e,r){for(var n=t.l+e,a,s,o=[];n!=t.l;)e=n-t.l,s=t[t.l],a=S$[s]||S$[J8e[s]],(s===24||s===25)&&(a=(s===24?Z8e:eMe)[t[t.l+1]]),!a||!a.f?Ql(t,e):o.push([a.n,a.f(t,e,r)]);return o}function tMe(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],a=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var rMe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function nMe(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Hae(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function I$(t,e,r){var n=Hae(t,e,r);return n=="#REF"?n:nMe(n,r)}function kl(t,e,r,n,a){var s=a&&a.biff||8,o={s:{c:0,r:0}},l=[],c,u,d,f=0,A=0,h,m="";if(!t[0]||!t[0][0])return"";for(var p=-1,g="",v=0,y=t[0].length;v<y;++v){var b=t[0][v];switch(b[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),p>=0){switch(t[0][p][1][0]){case 0:g=ci(" ",t[0][p][1][1]);break;case 1:g=ci("\r",t[0][p][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}u=u+g,p=-1}l.push(u+rMe[b[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Cb(b[1][1],o,a),l.push(_b(d,s));break;case"PtgRefN":d=r?Cb(b[1][1],r,a):b[1][1],l.push(_b(d,s));break;case"PtgRef3d":f=b[1][1],d=Cb(b[1][2],o,a),m=I$(n,f,a),l.push(m+"!"+_b(d,s));break;case"PtgFunc":case"PtgFuncVar":var w=b[1][0],j=b[1][1];w||(w=0),w&=127;var I=w==0?[]:l.slice(-w);l.length-=w,j==="User"&&(j=I.shift()),l.push(j+"("+I.join(",")+")");break;case"PtgBool":l.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(b[1]);break;case"PtgNum":l.push(String(b[1]));break;case"PtgStr":l.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(b[1]);break;case"PtgAreaN":h=n$(b[1][1],r?{s:r}:o,a),l.push(_5(h,a));break;case"PtgArea":h=n$(b[1][1],o,a),l.push(_5(h,a));break;case"PtgArea3d":f=b[1][1],h=b[1][2],m=I$(n,f,a),l.push(m+"!"+_5(h,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":A=b[1][2];var _=(n.names||[])[A-1]||(n[0]||[])[A],S=_?_.Name:"SH33TJSNAME"+String(A);S&&S.slice(0,6)=="_xlfn."&&!a.xlfn&&(S=S.slice(6)),l.push(S);break;case"PtgNameX":var E=b[1][1];A=b[1][2];var F;if(a.biff<=5)E<0&&(E=-E),n[E]&&(F=n[E][A]);else{var k="";if(((n[E]||[])[0]||[])[0]==14849||(((n[E]||[])[0]||[])[0]==1025?n[E][A]&&n[E][A].itab>0&&(k=n.SheetNames[n[E][A].itab-1]+"!"):k=n.SheetNames[A-1]+"!"),n[E]&&n[E][A])k+=n[E][A].Name;else if(n[0]&&n[0][A])k+=n[0][A].Name;else{var P=(Hae(n,E,a)||"").split(";;");P[A-1]?k=P[A-1]:k+="SH33TJSERRX"}l.push(k);break}F||(F={Name:"SH33TJSERRY"}),l.push(F.Name);break;case"PtgParen":var D="(",X=")";if(p>=0){switch(g="",t[0][p][1][0]){case 2:D=ci(" ",t[0][p][1][1])+D;break;case 3:D=ci("\r",t[0][p][1][1])+D;break;case 4:X=ci(" ",t[0][p][1][1])+X;break;case 5:X=ci("\r",t[0][p][1][1])+X;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}p=-1}l.push(D+l.pop()+X);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:b[1][1],r:b[1][0]};var pe={c:r.c,r:r.r};if(n.sharedf[hn(d)]){var ge=n.sharedf[hn(d)];l.push(kl(ge,o,pe,n,a))}else{var fe=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(kl(u[1],o,pe,n,a)),fe=!0;break}fe||l.push(b[1])}break;case"PtgArray":l.push("{"+tMe(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var xe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&xe.indexOf(t[0][v][0])==-1){b=t[0][p];var ae=!0;switch(b[1][0]){case 4:ae=!1;case 0:g=ci(" ",b[1][1]);break;case 5:ae=!1;case 1:g=ci("\r",b[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}l.push((ae?g:"")+l.pop()+(ae?"":g)),p=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function aMe(t,e,r){var n=t.l+e,a=r.biff==2?1:2,s,o=t.read_shift(a);if(o==65535)return[[],Ql(t,e-2)];var l=Dw(t,o,r);return e!==o+a&&(s=Ow(t,e-o-a,l,r)),t.l=n,[l,s]}function sMe(t,e,r){var n=t.l+e,a=r.biff==2?1:2,s,o=t.read_shift(a);if(o==65535)return[[],Ql(t,e-2)];var l=Dw(t,o,r);return e!==o+a&&(s=Ow(t,e-o-a,l,r)),t.l=n,[l,s]}function iMe(t,e,r,n){var a=t.l+e,s=Dw(t,n,r),o;return a!==t.l&&(o=Ow(t,a-t.l,s,r)),[s,o]}function oMe(t,e,r){var n=t.l+e,a,s=t.read_shift(2),o=Dw(t,s,r);return s==65535?[[],Ql(t,e-2)]:(e!==s+2&&(a=Ow(t,n-s-2,o,r)),[o,a])}function lMe(t){var e;if(Rh(t,t.l+6)!==65535)return[Dl(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function cMe(t){if(t==null){var e=tr(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return ag(t);return ag(0)}function P5(t,e,r){var n=t.l+e,a=rh(t);r.biff==2&&++t.l;var s=lMe(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var l=sMe(t,n-t.l,r);return{cell:a,val:s[0],formula:l,shared:o>>3&1,tt:s[1]}}function uMe(t,e,r,n,a){var s=ig(e,r,a),o=cMe(t.v),l=tr(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=tr(t.bf.length),d=0;d<t.bf.length;++d)u[d]=t.bf[d];var f=Fo([s,o,l,u]);return f}function nP(t,e,r){var n=t.read_shift(4),a=Dw(t,n,r),s=t.read_shift(4),o=s>0?Ow(t,s,a,r):null;return[a,o]}var dMe=nP,aP=nP,fMe=nP,hMe=nP,AMe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},$ae={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},mMe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function j$(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function pMe(t){var e="of:="+t.replace(fR,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function B5(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function gMe(t){return t.replace(/\./,"!")}var Sb={},dv={},Ib=typeof Map<"u";function mR(t,e,r){var n=0,a=t.length;if(r){if(Ib?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Ib?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<a;++n)if(t[n].t===e)return t.Count++,n;return t[a]={t:e},t.Count++,t.Unique++,r&&(Ib?(r.has(e)||r.set(e,[]),r.get(e).push(a)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(a))),a}function sP(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Ol=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=B2(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=GS(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Fp(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Im(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],a=60,s=t.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){zh(e.z,a),r.ssf[a]=e.z,r.revssf[e.z]=n=a;break}}for(a=0;a!=s;++a)if(t[a].numFmtId===n)return a;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Gae(t,e,r,n,a,s){try{n.cellNF&&(t.z=fn[e])}catch(l){if(n.WTF)throw l}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=gs(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(fn[e]==null&&zh(Ake[e]||"General",e),t.t==="e")t.w=t.w||CA[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=C2(t.v);else if(t.t==="d"){var o=mo(t.v);(o|0)===o?t.w=o.toString(10):t.w=C2(o)}else{if(t.v===void 0)return"";t.w=rg(t.v,dv)}else t.t==="d"?t.w=md(e,mo(t.v),dv):t.w=md(e,t.v,dv)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=$S(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=$S(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&s.Fills)throw l}}}function xMe(t,e,r){if(t&&t["!ref"]){var n=oa(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function vMe(t,e){var r=oa(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Sn(r))}var yMe=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,bMe=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,wMe=/<(?:\w:)?hyperlink [^>]*>/mg,NMe=/"(\w*:\w*)"/,CMe=/<(?:\w:)?col\b[^>]*[\/]?>/g,_Me=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,EMe=/<(?:\w:)?pageMargins[^>]*\/>/g,Kae=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,SMe=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,IMe=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function jMe(t,e,r,n,a,s,o){if(!t)return t;n||(n={"!id":{}});var l=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=t.match(bMe);f?(u=t.slice(0,f.index),d=t.slice(f.index+f[0].length)):u=d=t;var A=u.match(Kae);A?pR(A[0],l,a,r):(A=u.match(SMe))&&BMe(A[0],A[1]||"",l,a,r);var h=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=u.slice(h,h+50).match(NMe);m&&vMe(l,m[1])}var p=u.match(IMe);p&&p[1]&&$Me(p[1],a);var g=[];if(e.cellStyles){var v=u.match(CMe);v&&LMe(g,v)}f&&qMe(f[1],l,e,c,s,o);var y=d.match(_Me);y&&(l["!autofilter"]=QMe(y[0]));var b=[],w=d.match(yMe);if(w)for(h=0;h!=w.length;++h)b[h]=oa(w[h].slice(w[h].indexOf('"')+1));var j=d.match(wMe);j&&DMe(l,j,n);var I=d.match(EMe);if(I&&(l["!margins"]=RMe(An(I[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Sn(c)),e.sheetRows>0&&l["!ref"]){var _=oa(l["!ref"]);e.sheetRows<=+_.e.r&&(_.e.r=e.sheetRows-1,_.e.r>c.e.r&&(_.e.r=c.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>c.e.c&&(_.e.c=c.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Sn(_))}return g.length>0&&(l["!cols"]=g),b.length>0&&(l["!merges"]=b),l}function PMe(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Sn(t[r])+'"/>';return e+"</mergeCells>"}function pR(t,e,r,n){var a=An(t);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=ia(Ga(a.codeName)))}function BMe(t,e,r,n,a){pR(t.slice(0,t.indexOf(">")),r,n,a)}function TMe(t,e,r,n,a){var s=!1,o={},l=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[r];try{e.Workbook&&(c=e.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,o.codeName=Mf(Ra(c))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),l=(l||"")+_r("outlinePr",null,u)}!s&&!l||(a[a.length]=_r("sheetPr",l,o))}var kMe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],FMe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function OMe(t){var e={sheet:1};return kMe.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),FMe.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=cR(t.password).toString(16).toUpperCase()),_r("sheetProtection",null,e)}function DMe(t,e,r){for(var n=Array.isArray(t),a=0;a!=e.length;++a){var s=An(Ga(e[a]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+ia(s.location))):(s.Target="#"+ia(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=oa(s.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=hn({c:u,r:c});n?(t[c]||(t[c]=[]),t[c][u]||(t[c][u]={t:"z",v:void 0}),t[c][u].l=s):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=s)}}}function RMe(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function MMe(t){return Fp(t),_r("pageMargins",null,t)}function LMe(t,e){for(var r=!1,n=0;n!=e.length;++n){var a=An(e[n],!0);a.hidden&&(a.hidden=hs(a.hidden));var s=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,uR(a.width)),Am(a);s<=o;)t[s++]=xs(a)}}function UMe(t,e){for(var r=["<cols>"],n,a=0;a!=e.length;++a)(n=e[a])&&(r[r.length]=_r("col",null,sP(a,n)));return r[r.length]="</cols>",r.join("")}function QMe(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function VMe(t,e,r,n){var a=typeof t.ref=="string"?t.ref:Sn(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=Lc(a);o.s.r==o.e.r&&(o.e.r=Lc(e["!ref"]).e.r,a=Sn(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),_r("autoFilter",null,{ref:a})}var HMe=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function $Me(t,e){e.Views||(e.Views=[{}]),(t.match(HMe)||[]).forEach(function(r,n){var a=An(r);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),hs(a.rightToLeft)&&(e.Views[n].RTL=!0)})}function GMe(t,e,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),_r("sheetViews",_r("sheetView",null,a),{})}function KMe(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",s=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=CA[t.v];break;case"d":n&&n.cellDates?a=gs(t.v,-1).toISOString():(t=xs(t),t.t="n",a=""+(t.v=mo(gs(t.v)))),typeof t.z>"u"&&(t.z=fn[14]);break;default:a=t.v;break}var l=ll("v",Ra(a)),c={r:e},u=Im(n.cellXfs,t,n);switch(u!==0&&(c.s=u),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=ll("v",""+mR(n.Strings,t.v,n.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=s&&(t.t=s,t.v=o),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;l=_r("f",Ra(t.f),d)+(t.v!=null?l:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(c.cm=1),_r("c",l,c)}var qMe=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=_2("v"),o=_2("f");return function(c,u,d,f,A,h){for(var m=0,p="",g=[],v=[],y=0,b=0,w=0,j="",I,_,S=0,E=0,F,k,P=0,D=0,X=Array.isArray(h.CellXf),pe,ge=[],fe=[],xe=Array.isArray(u),ae=[],Se={},Te=!1,O=!!d.sheetStubs,G=c.split(e),z=0,L=G.length;z!=L;++z){p=G[z].trim();var Z=p.length;if(Z!==0){var ee=0;e:for(m=0;m<Z;++m)switch(p[m]){case">":if(p[m-1]!="/"){++m;break e}if(d&&d.cellStyles){if(_=An(p.slice(ee,m),!0),S=_.r!=null?parseInt(_.r,10):S+1,E=-1,d.sheetRows&&d.sheetRows<S)continue;Se={},Te=!1,_.ht&&(Te=!0,Se.hpt=parseFloat(_.ht),Se.hpx=Ov(Se.hpt)),_.hidden=="1"&&(Te=!0,Se.hidden=!0),_.outlineLevel!=null&&(Te=!0,Se.level=+_.outlineLevel),Te&&(ae[S-1]=Se)}break;case"<":ee=m;break}if(ee>=m)break;if(_=An(p.slice(ee,m),!0),S=_.r!=null?parseInt(_.r,10):S+1,E=-1,!(d.sheetRows&&d.sheetRows<S)){f.s.r>S-1&&(f.s.r=S-1),f.e.r<S-1&&(f.e.r=S-1),d&&d.cellStyles&&(Se={},Te=!1,_.ht&&(Te=!0,Se.hpt=parseFloat(_.ht),Se.hpx=Ov(Se.hpt)),_.hidden=="1"&&(Te=!0,Se.hidden=!0),_.outlineLevel!=null&&(Te=!0,Se.level=+_.outlineLevel),Te&&(ae[S-1]=Se)),g=p.slice(m).split(t);for(var R=0;R!=g.length&&g[R].trim().charAt(0)=="<";++R);for(g=g.slice(R),m=0;m!=g.length;++m)if(p=g[m].trim(),p.length!==0){if(v=p.match(r),y=m,b=0,w=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,v!=null&&v.length===2){for(y=0,j=v[1],b=0;b!=j.length&&!((w=j.charCodeAt(b)-64)<1||w>26);++b)y=26*y+w;--y,E=y}else++E;for(b=0;b!=p.length&&p.charCodeAt(b)!==62;++b);if(++b,_=An(p.slice(0,b),!0),_.r||(_.r=hn({r:S-1,c:E})),j=p.slice(b),I={t:""},(v=j.match(s))!=null&&v[1]!==""&&(I.v=ia(v[1])),d.cellFormula){if((v=j.match(o))!=null&&v[1]!==""){if(I.f=ia(Ga(v[1])).replace(/\r\n/g,`
`),d.xlfn||(I.f=_$(I.f)),v[0].indexOf('t="array"')>-1)I.F=(j.match(a)||[])[1],I.F.indexOf(":")>-1&&ge.push([oa(I.F),I.F]);else if(v[0].indexOf('t="shared"')>-1){k=An(v[0]);var H=ia(Ga(v[1]));d.xlfn||(H=_$(H)),fe[parseInt(k.si,10)]=[k,H,_.r]}}else(v=j.match(/<f[^>]*\/>/))&&(k=An(v[0]),fe[k.si]&&(I.f=HRe(fe[k.si][1],fe[k.si][2],_.r)));var ne=zs(_.r);for(b=0;b<ge.length;++b)ne.r>=ge[b][0].s.r&&ne.r<=ge[b][0].e.r&&ne.c>=ge[b][0].s.c&&ne.c<=ge[b][0].e.c&&(I.F=ge[b][1])}if(_.t==null&&I.v===void 0)if(I.f||I.F)I.v=0,I.t="n";else if(O)I.t="z";else continue;else I.t=_.t||"n";switch(f.s.c>E&&(f.s.c=E),f.e.c<E&&(f.e.c=E),I.t){case"n":if(I.v==""||I.v==null){if(!O)continue;I.t="z"}else I.v=parseFloat(I.v);break;case"s":if(typeof I.v>"u"){if(!O)continue;I.t="z"}else F=Sb[parseInt(I.v,10)],I.v=F.t,I.r=F.r,d.cellHTML&&(I.h=F.h);break;case"str":I.t="s",I.v=I.v!=null?Ga(I.v):"",d.cellHTML&&(I.h=z6(I.v));break;case"inlineStr":v=j.match(n),I.t="s",v!=null&&(F=lR(v[1]))?(I.v=F.t,d.cellHTML&&(I.h=F.h)):I.v="";break;case"b":I.v=hs(I.v);break;case"d":d.cellDates?I.v=gs(I.v,1):(I.v=mo(gs(I.v,1)),I.t="n");break;case"e":(!d||d.cellText!==!1)&&(I.w=I.v),I.v=zne[I.v];break}if(P=D=0,pe=null,X&&_.s!==void 0&&(pe=h.CellXf[_.s],pe!=null&&(pe.numFmtId!=null&&(P=pe.numFmtId),d.cellStyles&&pe.fillId!=null&&(D=pe.fillId))),Gae(I,P,D,d,A,h),d.cellDates&&X&&I.t=="n"&&f1(fn[P])&&(I.t="d",I.v=tP(I.v)),_.cm&&d.xlmeta){var ve=(d.xlmeta.Cell||[])[+_.cm-1];ve&&ve.type=="XLDAPR"&&(I.D=!0)}if(xe){var U=zs(_.r);u[U.r]||(u[U.r]=[]),u[U.r][U.c]=I}else u[_.r]=I}}}}ae.length>0&&(u["!rows"]=ae)}}();function zMe(t,e,r,n){var a=[],s=[],o=oa(t["!ref"]),l="",c,u="",d=[],f=0,A=0,h=t["!rows"],m=Array.isArray(t),p={r:u},g,v=-1;for(A=o.s.c;A<=o.e.c;++A)d[A]=qs(A);for(f=o.s.r;f<=o.e.r;++f){for(s=[],u=Bi(f),A=o.s.c;A<=o.e.c;++A){c=d[A]+u;var y=m?(t[f]||[])[A]:t[c];y!==void 0&&(l=KMe(y,c,t,e))!=null&&s.push(l)}(s.length>0||h&&h[f])&&(p={r:u},h&&h[f]&&(g=h[f],g.hidden&&(p.hidden=1),v=-1,g.hpx?v=T2(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(p.ht=v,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),a[a.length]=_r("row",s.join(""),p))}if(h)for(;f<h.length;++f)h&&h[f]&&(p={r:f+1},g=h[f],g.hidden&&(p.hidden=1),v=-1,g.hpx?v=T2(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(p.ht=v,p.customHeight=1),g.level&&(p.outlineLevel=g.level),a[a.length]=_r("row","",p));return a.join("")}function qae(t,e,r,n){var a=[ki,_r("worksheet",null,{xmlns:Sg[0],"xmlns:r":uo.r})],s=r.SheetNames[t],o=0,l="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",d=oa(u);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Sn(d)}n||(n={}),c["!comments"]=[];var f=[];TMe(c,r,t,e,a),a[a.length]=_r("dimension",null,{ref:u}),a[a.length]=GMe(c,e,t,r),e.sheetFormat&&(a[a.length]=_r("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=UMe(c,c["!cols"])),a[o=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=zMe(c,e),l.length>0&&(a[a.length]=l)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),c["!protect"]&&(a[a.length]=OMe(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=VMe(c["!autofilter"],c,r,t)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=PMe(c["!merges"]));var A=-1,h,m=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(m=ka(n,-1,Ra(p[1].Target).replace(/#.*$/,""),$n.HLINK),h["r:id"]="rId"+m),(A=p[1].Target.indexOf("#"))>-1&&(h.location=Ra(p[1].Target.slice(A+1))),p[1].Tooltip&&(h.tooltip=Ra(p[1].Tooltip)),a[a.length]=_r("hyperlink",null,h))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=MMe(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=ll("ignoredErrors",_r("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(m=ka(n,-1,"../drawings/drawing"+(t+1)+".xml",$n.DRAW),a[a.length]=_r("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=f),c["!comments"].length>0&&(m=ka(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",$n.VML),a[a.length]=_r("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function WMe(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function XMe(t,e,r){var n=tr(145),a=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;a.hpx?s=T2(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var f=-1,A=-1,h=d<<10;h<d+1<<10;++h){u.c=h;var m=Array.isArray(r)?(r[u.r]||[])[u.c]:r[hn(u)];m&&(f<0&&(f=h),A=h)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,A))}var p=n.l;return n.l=c,n.write_shift(4,l),n.l=p,n.length>n.l?n.slice(0,n.l):n}function YMe(t,e,r,n){var a=XMe(n,r,e);(a.length>17||(e["!rows"]||[])[n])&&fr(t,0,a)}var JMe=Bg,ZMe=m1;function eLe(){}function tLe(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=aFe(t),r}function rLe(t,e,r){r==null&&(r=tr(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return QS({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Hne(t,r),r.slice(0,r.l)}function nLe(t){var e=bd(t);return[e]}function aLe(t,e,r){return r==null&&(r=tr(8)),Ig(e,r)}function sLe(t){var e=jg(t);return[e]}function iLe(t,e,r){return r==null&&(r=tr(4)),Pg(e,r)}function oLe(t){var e=bd(t),r=t.read_shift(1);return[e,r,"b"]}function lLe(t,e,r){return r==null&&(r=tr(9)),Ig(e,r),r.write_shift(1,t.v?1:0),r}function cLe(t){var e=jg(t),r=t.read_shift(1);return[e,r,"b"]}function uLe(t,e,r){return r==null&&(r=tr(5)),Pg(e,r),r.write_shift(1,t.v?1:0),r}function dLe(t){var e=bd(t),r=t.read_shift(1);return[e,r,"e"]}function fLe(t,e,r){return r==null&&(r=tr(9)),Ig(e,r),r.write_shift(1,t.v),r}function hLe(t){var e=jg(t),r=t.read_shift(1);return[e,r,"e"]}function ALe(t,e,r){return r==null&&(r=tr(8)),Pg(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function mLe(t){var e=bd(t),r=t.read_shift(4);return[e,r,"s"]}function pLe(t,e,r){return r==null&&(r=tr(12)),Ig(e,r),r.write_shift(4,e.v),r}function gLe(t){var e=jg(t),r=t.read_shift(4);return[e,r,"s"]}function xLe(t,e,r){return r==null&&(r=tr(8)),Pg(e,r),r.write_shift(4,e.v),r}function vLe(t){var e=bd(t),r=Dl(t);return[e,r,"n"]}function yLe(t,e,r){return r==null&&(r=tr(16)),Ig(e,r),ag(t.v,r),r}function zae(t){var e=jg(t),r=Dl(t);return[e,r,"n"]}function bLe(t,e,r){return r==null&&(r=tr(12)),Pg(e,r),ag(t.v,r),r}function wLe(t){var e=bd(t),r=nR(t);return[e,r,"n"]}function NLe(t,e,r){return r==null&&(r=tr(12)),Ig(e,r),$ne(t.v,r),r}function CLe(t){var e=jg(t),r=nR(t);return[e,r,"n"]}function _Le(t,e,r){return r==null&&(r=tr(8)),Pg(e,r),$ne(t.v,r),r}function ELe(t){var e=bd(t),r=eR(t);return[e,r,"is"]}function SLe(t){var e=bd(t),r=Ml(t);return[e,r,"str"]}function ILe(t,e,r){return r==null&&(r=tr(12+4*t.v.length)),Ig(e,r),Do(t.v,r),r.length>r.l?r.slice(0,r.l):r}function jLe(t){var e=jg(t),r=Ml(t);return[e,r,"str"]}function PLe(t,e,r){return r==null&&(r=tr(8+4*t.v.length)),Pg(e,r),Do(t.v,r),r.length>r.l?r.slice(0,r.l):r}function BLe(t,e,r){var n=t.l+e,a=bd(t);a.r=r["!row"];var s=t.read_shift(1),o=[a,s,"b"];if(r.cellFormula){t.l+=2;var l=aP(t,n-t.l,r);o[3]=kl(l,null,a,r.supbooks,r)}else t.l=n;return o}function TLe(t,e,r){var n=t.l+e,a=bd(t);a.r=r["!row"];var s=t.read_shift(1),o=[a,s,"e"];if(r.cellFormula){t.l+=2;var l=aP(t,n-t.l,r);o[3]=kl(l,null,a,r.supbooks,r)}else t.l=n;return o}function kLe(t,e,r){var n=t.l+e,a=bd(t);a.r=r["!row"];var s=Dl(t),o=[a,s,"n"];if(r.cellFormula){t.l+=2;var l=aP(t,n-t.l,r);o[3]=kl(l,null,a,r.supbooks,r)}else t.l=n;return o}function FLe(t,e,r){var n=t.l+e,a=bd(t);a.r=r["!row"];var s=Ml(t),o=[a,s,"str"];if(r.cellFormula){t.l+=2;var l=aP(t,n-t.l,r);o[3]=kl(l,null,a,r.supbooks,r)}else t.l=n;return o}var OLe=Bg,DLe=m1;function RLe(t,e){return e==null&&(e=tr(4)),e.write_shift(4,t),e}function MLe(t,e){var r=t.l+e,n=Bg(t),a=tR(t),s=Ml(t),o=Ml(t),l=Ml(t);t.l=r;var c={rfx:n,relId:a,loc:s,display:l};return o&&(c.Tooltip=o),c}function LLe(t,e){var r=tr(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));m1({s:zs(t[0]),e:zs(t[0])},r),rR("rId"+e,r);var n=t[1].Target.indexOf("#"),a=n==-1?"":t[1].Target.slice(n+1);return Do(a||"",r),Do(t[1].Tooltip||"",r),Do("",r),r.slice(0,r.l)}function ULe(){}function QLe(t,e,r){var n=t.l+e,a=Gne(t),s=t.read_shift(1),o=[a];if(o[2]=s,r.cellFormula){var l=dMe(t,n-t.l,r);o[1]=l}else t.l=n;return o}function VLe(t,e,r){var n=t.l+e,a=Bg(t),s=[a];if(r.cellFormula){var o=hMe(t,n-t.l,r);s[1]=o,t.l=n}else t.l=n;return s}function HLe(t,e,r){r==null&&(r=tr(18));var n=sP(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),r.write_shift(2,a),r}var Wae=["left","right","top","bottom","header","footer"];function $Le(t){var e={};return Wae.forEach(function(r){e[r]=Dl(t)}),e}function GLe(t,e){return e==null&&(e=tr(6*8)),Fp(t),Wae.forEach(function(r){ag(t[r],e)}),e}function KLe(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function qLe(t,e,r){r==null&&(r=tr(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function zLe(t){var e=tr(24);return e.write_shift(4,4),e.write_shift(4,1),m1(t,e),e}function WLe(t,e){return e==null&&(e=tr(16*4+2)),e.write_shift(2,t.password?cR(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function XLe(){}function YLe(){}function JLe(t,e,r,n,a,s,o){if(!t)return t;var l=e||{};n||(n={"!id":{}});var c=l.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,A=!1,h,m,p,g,v,y,b,w,j,I=[];l.biff=12,l["!row"]=0;var _=0,S=!1,E=[],F={},k=l.supbooks||a.supbooks||[[]];if(k.sharedf=F,k.arrayf=E,k.SheetNames=a.SheetNames||a.Sheets.map(function(xe){return xe.name}),!l.supbooks&&(l.supbooks=k,a.Names))for(var P=0;P<a.Names.length;++P)k[0][P+1]=a.Names[P];var D=[],X=[],pe=!1;k2[16]={n:"BrtShortReal",f:zae};var ge;if(NA(t,function(ae,Se,Te){if(!A)switch(Te){case 148:u=ae;break;case 0:h=ae,l.sheetRows&&l.sheetRows<=h.r&&(A=!0),w=Bi(g=h.r),l["!row"]=h.r,(ae.hidden||ae.hpt||ae.level!=null)&&(ae.hpt&&(ae.hpx=Ov(ae.hpt)),X[ae.r]=ae);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:ae[2]},ae[2]){case"n":m.v=ae[1];break;case"s":b=Sb[ae[1]],m.v=b.t,m.r=b.r;break;case"b":m.v=!!ae[1];break;case"e":m.v=ae[1],l.cellText!==!1&&(m.w=CA[m.v]);break;case"str":m.t="s",m.v=ae[1];break;case"is":m.t="s",m.v=ae[1].t;break}if((p=o.CellXf[ae[0].iStyleRef])&&Gae(m,p.numFmtId,null,l,s,o),v=ae[0].c==-1?v+1:ae[0].c,l.dense?(c[g]||(c[g]=[]),c[g][v]=m):c[qs(v)+w]=m,l.cellFormula){for(S=!1,_=0;_<E.length;++_){var O=E[_];h.r>=O[0].s.r&&h.r<=O[0].e.r&&v>=O[0].s.c&&v<=O[0].e.c&&(m.F=Sn(O[0]),S=!0)}!S&&ae.length>3&&(m.f=ae[3])}if(d.s.r>h.r&&(d.s.r=h.r),d.s.c>v&&(d.s.c=v),d.e.r<h.r&&(d.e.r=h.r),d.e.c<v&&(d.e.c=v),l.cellDates&&p&&m.t=="n"&&f1(fn[p.numFmtId])){var G=gp(m.v);G&&(m.t="d",m.v=new Date(G.y,G.m-1,G.d,G.H,G.M,G.S,G.u))}ge&&(ge.type=="XLDAPR"&&(m.D=!0),ge=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;m={t:"z",v:void 0},v=ae[0].c==-1?v+1:ae[0].c,l.dense?(c[g]||(c[g]=[]),c[g][v]=m):c[qs(v)+w]=m,d.s.r>h.r&&(d.s.r=h.r),d.s.c>v&&(d.s.c=v),d.e.r<h.r&&(d.e.r=h.r),d.e.c<v&&(d.e.c=v),ge&&(ge.type=="XLDAPR"&&(m.D=!0),ge=void 0);break;case 176:I.push(ae);break;case 49:ge=((l.xlmeta||{}).Cell||[])[ae-1];break;case 494:var z=n["!id"][ae.relId];for(z?(ae.Target=z.Target,ae.loc&&(ae.Target+="#"+ae.loc),ae.Rel=z):ae.relId==""&&(ae.Target="#"+ae.loc),g=ae.rfx.s.r;g<=ae.rfx.e.r;++g)for(v=ae.rfx.s.c;v<=ae.rfx.e.c;++v)l.dense?(c[g]||(c[g]=[]),c[g][v]||(c[g][v]={t:"z",v:void 0}),c[g][v].l=ae):(y=hn({c:v,r:g}),c[y]||(c[y]={t:"z",v:void 0}),c[y].l=ae);break;case 426:if(!l.cellFormula)break;E.push(ae),j=l.dense?c[g][v]:c[qs(v)+w],j.f=kl(ae[1],d,{r:h.r,c:v},k,l),j.F=Sn(ae[0]);break;case 427:if(!l.cellFormula)break;F[hn(ae[0].s)]=ae[1],j=l.dense?c[g][v]:c[qs(v)+w],j.f=kl(ae[1],d,{r:h.r,c:v},k,l);break;case 60:if(!l.cellStyles)break;for(;ae.e>=ae.s;)D[ae.e--]={width:ae.w/256,hidden:!!(ae.flags&1),level:ae.level},pe||(pe=!0,uR(ae.w/256)),Am(D[ae.e+1]);break;case 161:c["!autofilter"]={ref:Sn(ae)};break;case 476:c["!margins"]=ae;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),ae.name&&(a.Sheets[r].CodeName=ae.name),(ae.above||ae.left)&&(c["!outline"]={above:ae.above,left:ae.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ae.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!Se.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+Te.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Sn(u||d)),l.sheetRows&&c["!ref"]){var fe=oa(c["!ref"]);l.sheetRows<=+fe.e.r&&(fe.e.r=l.sheetRows-1,fe.e.r>d.e.r&&(fe.e.r=d.e.r),fe.e.r<fe.s.r&&(fe.s.r=fe.e.r),fe.e.c>d.e.c&&(fe.e.c=d.e.c),fe.e.c<fe.s.c&&(fe.s.c=fe.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Sn(fe))}return I.length>0&&(c["!merges"]=I),D.length>0&&(c["!cols"]=D),X.length>0&&(c["!rows"]=X),c}function ZLe(t,e,r,n,a,s,o){if(e.v===void 0)return!1;var l="";switch(e.t){case"b":l=e.v?"1":"0";break;case"d":e=xs(e),e.z=e.z||fn[14],e.v=mo(gs(e.v)),e.t="n";break;case"n":case"e":l=""+e.v;break;default:l=e.v;break}var c={r,c:n};switch(c.s=Im(a.cellXfs,e,a),e.l&&s["!links"].push([hn(c),e.l]),e.c&&s["!comments"].push([hn(c),e.c]),e.t){case"s":case"str":return a.bookSST?(l=mR(a.Strings,e.v,a.revStrings),c.t="s",c.v=l,o?fr(t,18,xLe(e,c)):fr(t,7,pLe(e,c))):(c.t="str",o?fr(t,17,PLe(e,c)):fr(t,6,ILe(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?fr(t,13,_Le(e,c)):fr(t,2,NLe(e,c)):o?fr(t,16,bLe(e,c)):fr(t,5,yLe(e,c)),!0;case"b":return c.t="b",o?fr(t,15,uLe(e,c)):fr(t,4,lLe(e,c)),!0;case"e":return c.t="e",o?fr(t,14,ALe(e,c)):fr(t,3,fLe(e,c)),!0}return o?fr(t,12,iLe(e,c)):fr(t,1,aLe(e,c)),!0}function eUe(t,e,r,n){var a=oa(e["!ref"]||"A1"),s,o="",l=[];fr(t,145);var c=Array.isArray(e),u=a.e.r;e["!rows"]&&(u=Math.max(a.e.r,e["!rows"].length-1));for(var d=a.s.r;d<=u;++d){o=Bi(d),YMe(t,e,a,d);var f=!1;if(d<=a.e.r)for(var A=a.s.c;A<=a.e.c;++A){d===a.s.r&&(l[A]=qs(A)),s=l[A]+o;var h=c?(e[d]||[])[A]:e[s];if(!h){f=!1;continue}f=ZLe(t,h,d,A,n,e,f)}}fr(t,146)}function tUe(t,e){!e||!e["!merges"]||(fr(t,177,RLe(e["!merges"].length)),e["!merges"].forEach(function(r){fr(t,176,DLe(r))}),fr(t,178))}function rUe(t,e){!e||!e["!cols"]||(fr(t,390),e["!cols"].forEach(function(r,n){r&&fr(t,60,HLe(n,r))}),fr(t,391))}function nUe(t,e){!e||!e["!ref"]||(fr(t,648),fr(t,649,zLe(oa(e["!ref"]))),fr(t,650))}function aUe(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var a=ka(r,-1,n[1].Target.replace(/#.*$/,""),$n.HLINK);fr(t,494,LLe(n,a))}}),delete e["!links"]}function sUe(t,e,r,n){if(e["!comments"].length>0){var a=ka(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",$n.VML);fr(t,551,rR("rId"+a)),e["!legacy"]=a}}function iUe(t,e,r,n){if(e["!autofilter"]){var a=e["!autofilter"],s=typeof a.ref=="string"?a.ref:Sn(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Lc(s);l.s.r==l.e.r&&(l.e.r=Lc(e["!ref"]).e.r,s=Sn(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),fr(t,161,m1(oa(s))),fr(t,162)}}function oUe(t,e,r){fr(t,133),fr(t,137,qLe(e,r)),fr(t,138),fr(t,134)}function lUe(t,e){e["!protect"]&&fr(t,535,WLe(e["!protect"]))}function cUe(t,e,r,n){var a=Mc(),s=r.SheetNames[t],o=r.Sheets[s]||{},l=s;try{r&&r.Workbook&&(l=r.Workbook.Sheets[t].CodeName||l)}catch{}var c=oa(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],fr(a,129),(r.vbaraw||o["!outline"])&&fr(a,147,rLe(l,o["!outline"])),fr(a,148,ZMe(c)),oUe(a,o,r.Workbook),rUe(a,o),eUe(a,o,t,e),lUe(a,o),iUe(a,o,r,t),tUe(a,o),aUe(a,o,n),o["!margins"]&&fr(a,476,GLe(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&nUe(a,o),sUe(a,o,t,n),fr(a,130),a.end()}function uUe(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var a=ia((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,a,n]}function dUe(t,e,r,n,a,s){var o=s||{"!type":"chart"};if(!t)return s;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var A=uUe(f);d.s.r=d.s.c=0,d.e.c=l,u=qs(l),A[0].forEach(function(h,m){o[u+Bi(m)]={t:"n",v:h,z:A[1]},c=m}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(o["!ref"]=Sn(d)),o}function fUe(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,l=t.match(Kae);return l&&pR(l[0],s,a,r),(o=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function hUe(t,e){t.l+=10;var r=Ml(t);return{name:r}}function AUe(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return NA(t,function(c,u,d){switch(d){case 550:s["!rel"]=c;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),c.name&&(a.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var gR=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],mUe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],pUe=[],gUe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function P$(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],a=0;a!=e.length;++a){var s=e[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=hs(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function B$(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=hs(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function Xae(t){B$(t.WBProps,gR),B$(t.CalcPr,gUe),P$(t.WBView,mUe),P$(t.Sheets,pUe),dv.date1904=hs(t.WBProps.date1904)}function xUe(t){return!t.Workbook||!t.Workbook.WBProps?"false":hs(t.Workbook.WBProps.date1904)?"true":"false"}var vUe="][*?/\\".split("");function Yae(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return vUe.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function yUe(t,e,r){t.forEach(function(n,a){Yae(n);for(var s=0;s<a;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[a]&&e[a].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function bUe(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];yUe(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)xMe(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var wUe=/<\w+:workbook/;function NUe(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},o=0;if(t.replace(Hl,function(c,u){var d=An(c);switch(th(d[0])){case"<?xml":break;case"<workbook":c.match(wUe)&&(a="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":gR.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=hs(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=Ga(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=ia(Ga(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Ga(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),hs(d.hidden||"0")&&(s.Hidden=!0),o=u+c.length;break;case"</definedName>":s.Ref=ia(Ga(t.slice(o,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),Sg.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Xae(r),r}function Jae(t){var e=[ki];e[e.length]=_r("workbook",null,{xmlns:Sg[0],"xmlns:r":uo.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(gR.forEach(function(l){t.Workbook.WBProps[l[0]]!=null&&t.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=t.Workbook.WBProps[l[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=_r("workbookPr",null,n);var a=t.Workbook&&t.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var o={name:Ra(t.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=_r("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(e[e.length]=_r("definedName",Ra(l.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function CUe(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Kk(t),r.name=Ml(t),r}function _Ue(t,e){return e||(e=tr(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),rR(t.strRelID,e),Do(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function EUe(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var a=e>8?Ml(t):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function SUe(t,e){e||(e=tr(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),Hne(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function IUe(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function jUe(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),s=sFe(t),o=fMe(t,0,r),l=tR(t);t.l=n;var c={Name:s,Ptg:o};return a<268435455&&(c.Sheet=a),l&&(c.Comment=l),c}function PUe(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],k2[16]={n:"BrtFRTArchID$",f:IUe},NA(t,function(c,u,d){switch(d){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=kl(c.Ptg,null,null,o,e),delete e.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,c]):o[0]=[d,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(d),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),Xae(r),r.Names=s,r.supbooks=o,r}function BUe(t,e){fr(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};fr(t,156,_Ue(a))}fr(t,144)}function TUe(t,e){e||(e=tr(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Do("SheetJS",e),Do(FS.version,e),Do(FS.version,e),Do("7262",e),e.length>e.l?e.slice(0,e.l):e}function kUe(t,e){e||(e=tr(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function FUe(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(fr(t,135),fr(t,158,kUe(a)),fr(t,136))}}function OUe(t,e){var r=Mc();return fr(r,131),fr(r,128,TUe()),fr(r,153,SUe(t.Workbook&&t.Workbook.WBProps||null)),FUe(r,t),BUe(r,t),fr(r,132),r.end()}function DUe(t,e,r){return e.slice(-4)===".bin"?PUe(t,r):NUe(t,r)}function RUe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?JLe(t,n,r,a,s,o,l):jMe(t,n,r,a,s,o,l)}function MUe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?AUe(t,n,r,a,s):fUe(t,n,r,a,s)}function LUe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?QRe():VRe()}function UUe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?LRe():URe()}function QUe(t,e,r,n){return e.slice(-4)===".bin"?D6e(t,r,n):C6e(t,r,n)}function VUe(t,e,r){return Tae(t,r)}function HUe(t,e,r){return e.slice(-4)===".bin"?HDe(t,r):UDe(t,r)}function $Ue(t,e,r){return e.slice(-4)===".bin"?FRe(t,r):_Re(t,r)}function GUe(t,e,r){return e.slice(-4)===".bin"?wRe(t):yRe(t)}function KUe(t,e,r,n){return r.slice(-4)===".bin"?NRe(t,e,r,n):void 0}function qUe(t,e,r){return e.slice(-4)===".bin"?gRe(t,e,r):vRe(t,e,r)}function zUe(t,e,r){return(e.slice(-4)===".bin"?OUe:Jae)(t)}function WUe(t,e,r,n,a){return(e.slice(-4)===".bin"?cUe:qae)(t,r,n,a)}function XUe(t,e,r){return(e.slice(-4)===".bin"?K6e:Pae)(t,r)}function YUe(t,e,r){return(e.slice(-4)===".bin"?KDe:wae)(t,r)}function JUe(t,e,r){return(e.slice(-4)===".bin"?ORe:Oae)(t)}function ZUe(t){return(t.slice(-4)===".bin"?xRe:kae)()}var Zae=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,ese=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Fd(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=t.match(Zae),s,o,l,c;if(a)for(c=0;c!=a.length;++c)s=a[c].match(ese),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(o+1),n[l]=s[2].slice(1,s[2].length-1));return n}function e7e(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(Zae),a,s,o,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(ese),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),r[o]=a[2].slice(1,a[2].length-1));return r}var jb;function t7e(t,e){var r=jb[t]||ia(t);return r==="General"?rg(e):md(r,e)}function r7e(t,e,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=hs(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=gs(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[ia(e)]=a}function n7e(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||CA[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=C2(t.v):t.w=rg(t.v):t.w=t7e(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=jb[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&f1(n)){var a=gp(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function a7e(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=p6e[n.Pattern]||n.Pattern)}t[e.ID]=e}function s7e(t,e,r,n,a,s,o,l,c,u){var d="General",f=n.StyleID,A={};u=u||{};var h=[],m=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);s[f]!==void 0&&(s[f].nf&&(d=s[f].nf),s[f].Interior&&h.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=hs(t);break;case"String":n.t="s",n.r=zH(ia(t)),n.v=t.indexOf("<")>-1?ia(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(gs(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ia(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=zne[t],u.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=zH(e||t));break}if(n7e(n,d,u),u.cellFormula!==!1)if(n.Formula){var p=ia(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=uv(p,a),delete n.Formula,n.ArrayRange=="RC"?n.F=uv("RC:RC",a):n.ArrayRange&&(n.F=uv(n.ArrayRange,a),c.push([oa(n.F),n.F]))}else for(m=0;m<c.length;++m)a.r>=c[m][0].s.r&&a.r<=c[m][0].e.r&&a.c>=c[m][0].s.c&&a.c<=c[m][0].e.c&&(n.F=c[m][1]);u.cellStyles&&(h.forEach(function(g){!A.patternType&&g.patternType&&(A.patternType=g.patternType)}),n.s=A),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function i7e(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function T5(t,e){var r=e||{};h1();var n=Hy(W6(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Ga(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=xs(r);return o.type="string",Fv.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(we){a.indexOf("<"+we)>=0&&(s=!0)}),s)return G7e(n,r);jb={"General Number":"General","General Date":fn[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":fn[15],"Short Date":fn[14],"Long Time":fn[19],"Medium Time":fn[18],"Short Time":fn[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:fn[2],Standard:fn[4],Percent:fn[10],Scientific:fn[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,d={},f=[],A=r.dense?[]:{},h="",m={},p={},g=Fd('<Data ss:Type="String">'),v=0,y=0,b=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},I={},_="",S=0,E=[],F={},k={},P=0,D=[],X=[],pe={},ge=[],fe,xe=!1,ae=[],Se=[],Te={},O=0,G=0,z={Sheets:[],WBProps:{date1904:!1}},L={};S2.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Z="";l=S2.exec(n);)switch(l[3]=(Z=l[3]).toLowerCase()){case"data":if(Z=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?s7e(n.slice(v,l.index),_,g,c[c.length-1][0]=="comment"?pe:m,{c:y,r:b},j,ge[y],p,ae,r):(_="",g=Fd(l[0]),v=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(X.length>0&&(m.c=X),(!r.sheetRows||r.sheetRows>b)&&m.v!==void 0&&(r.dense?(A[b]||(A[b]=[]),A[b][y]=m):A[qs(y)+Bi(b)]=m),m.HRef&&(m.l={Target:ia(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(O=y+(parseInt(m.MergeAcross,10)|0),G=b+(parseInt(m.MergeDown,10)|0),E.push({s:{c:y,r:b},e:{c:O,r:G}})),!r.sheetStubs)m.MergeAcross?y=O+1:++y;else if(m.MergeAcross||m.MergeDown){for(var ee=y;ee<=O;++ee)for(var R=b;R<=G;++R)(ee>y||R>b)&&(r.dense?(A[R]||(A[R]=[]),A[R][ee]={t:"z"}):A[qs(ee)+Bi(R)]={t:"z"});y=O+1}else++y;else m=e7e(l[0]),m.Index&&(y=+m.Index-1),y<w.s.c&&(w.s.c=y),y>w.e.c&&(w.e.c=y),l[0].slice(-2)==="/>"&&++y,X=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(b<w.s.r&&(w.s.r=b),b>w.e.r&&(w.e.r=b),l[0].slice(-2)==="/>"&&(p=Fd(l[0]),p.Index&&(b=+p.Index-1)),y=0,++b):(p=Fd(l[0]),p.Index&&(b=+p.Index-1),Te={},(p.AutoFitHeight=="0"||p.Height)&&(Te.hpx=parseInt(p.Height,10),Te.hpt=T2(Te.hpx),Se[b]=Te),p.Hidden=="1"&&(Te.hidden=!0,Se[b]=Te));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(h),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(A["!ref"]=Sn(w),r.sheetRows&&r.sheetRows<=w.e.r&&(A["!fullref"]=A["!ref"],w.e.r=r.sheetRows-1,A["!ref"]=Sn(w))),E.length&&(A["!merges"]=E),ge.length>0&&(A["!cols"]=ge),Se.length>0&&(A["!rows"]=Se),d[h]=A}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=y=0,c.push([l[3],!1]),u=Fd(l[0]),h=ia(u.Name),A=r.dense?[]:{},E=[],ae=[],Se=[],L={name:h,Hidden:0},z.Sheets.push(L);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),ge=[],xe=!1}break;case"style":l[1]==="/"?a7e(j,I,r):I=Fd(l[0]);break;case"numberformat":I.nf=ia(Fd(l[0]).Format||"General"),jb[I.nf]&&(I.nf=jb[I.nf]);for(var H=0;H!=392&&fn[H]!=I.nf;++H);if(H==392){for(H=57;H!=392;++H)if(fn[H]==null){zh(I.nf,H);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(fe=Fd(l[0]),fe.Hidden&&(fe.hidden=!0,delete fe.Hidden),fe.Width&&(fe.wpx=parseInt(fe.Width,10)),!xe&&fe.wpx>10){xe=!0,Ol=Iae;for(var ne=0;ne<ge.length;++ne)ge[ne]&&Am(ge[ne])}xe&&Am(fe),ge[fe.Index-1||ge.length]=fe;for(var ve=0;ve<+fe.Span;++ve)ge[ge.length]=xs(fe);break;case"namedrange":if(l[1]==="/")break;z.Names||(z.Names=[]);var U=An(l[0]),He={Name:U.Name,Ref:uv(U.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(He.Sheet=z.Sheets.length-1),z.Names.push(He);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?_+=n.slice(S,l.index):S=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;I.Interior=Fd(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?PFe(F,Z,n.slice(P,l.index)):P=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));i7e(pe),X.push(pe)}else c.push([l[3],!1]),u=Fd(l[0]),pe={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var se=Fd(l[0]);A["!autofilter"]={ref:uv(se.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return D$(n,r);var re=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:re=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:re=!1}break;case"excelworkbook":switch(l[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:re=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:re=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(P,l.index)){case"SheetHidden":L.Hidden=1;break;case"SheetVeryHidden":L.Hidden=2;break}else P=l.index+l[0].length;break;case"header":A["!margins"]||Fp(A["!margins"]={},"xlml"),isNaN(+An(l[0]).Margin)||(A["!margins"].header=+An(l[0]).Margin);break;case"footer":A["!margins"]||Fp(A["!margins"]={},"xlml"),isNaN(+An(l[0]).Margin)||(A["!margins"].footer=+An(l[0]).Margin);break;case"pagemargins":var Pe=An(l[0]);A["!margins"]||Fp(A["!margins"]={},"xlml"),isNaN(+Pe.Top)||(A["!margins"].top=+Pe.Top),isNaN(+Pe.Left)||(A["!margins"].left=+Pe.Left),isNaN(+Pe.Right)||(A["!margins"].right=+Pe.Right),isNaN(+Pe.Bottom)||(A["!margins"].bottom=+Pe.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":A["!outline"]||(A["!outline"]={}),A["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":A["!outline"]||(A["!outline"]={}),A["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:re=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:re=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:re=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:re=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:re=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:re=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:re=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:re=!1}break;case"smarttags":break;default:re=!1;break}if(re||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?r7e(k,Z,D,n.slice(P,l.index)):(D=l,P=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var ue={};return!r.bookSheets&&!r.bookProps&&(ue.Sheets=d),ue.SheetNames=f,ue.Workbook=z,ue.SSF=xs(fn),ue.Props=F,ue.Custprops=k,ue}function Zk(t,e){switch(vR(e=e||{}),e.type||"base64"){case"base64":return T5(bu(t),e);case"binary":case"buffer":case"file":return T5(t,e);case"array":return T5(Em(t),e)}}function o7e(t,e){var r=[];return t.Props&&r.push(BFe(t.Props,e)),t.Custprops&&r.push(TFe(t.Props,t.Custprops)),r.join("")}function l7e(){return""}function c7e(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,a){var s=[];s.push(_r("NumberFormat",null,{"ss:Format":Ra(fn[n.numFmtId])}));var o={"ss:ID":"s"+(21+a)};r.push(_r("Style",s.join(""),o))}),_r("Styles",r.join(""))}function tse(t){return _r("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+hR(t.Ref,{r:0,c:0})})}function u7e(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var a=e[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(tse(a)))}return _r("Names",r.join(""))}function d7e(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],o=0;o<a.length;++o){var l=a[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||s.push(tse(l)))}return s.join("")}function f7e(t,e,r,n){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(_r("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(_r("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(_r("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(_r("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(ll("ProtectContents","True")),t["!protect"].objects&&a.push(ll("ProtectObjects","True")),t["!protect"].scenarios&&a.push(ll("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(ll("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(ll("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":_r("WorksheetOptions",a.join(""),{xmlns:iu.x})}function h7e(t){return t.map(function(e){var r=Fke(e.t||""),n=_r("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return _r("Comment",n,{"ss:Author":e.a})}).join("")}function A7e(t,e,r,n,a,s,o){if(!t||t.v==null&&t.f==null)return"";var l={};if(t.f&&(l["ss:Formula"]="="+Ra(hR(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var c=zs(t.F.slice(e.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(t.l&&t.l.Target&&(l["ss:HRef"]=Ra(t.l.Target),t.l.Tooltip&&(l["x:HRefScreenTip"]=Ra(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",A="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",A=String(t.v);break;case"b":f="Boolean",A=t.v?"1":"0";break;case"e":f="Error",A=CA[t.v];break;case"d":f="DateTime",A=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||fn[14]);break;case"s":f="String",A=kke(t.v||"");break}var h=Im(n.cellXfs,t,n);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=o.c+1;var m=t.v!=null?A:"",p=t.t=="z"?"":'<Data ss:Type="'+f+'">'+m+"</Data>";return(t.c||[]).length>0&&(p+=h7e(t.c)),_r("Cell",p,l)}function m7e(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Ov(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function p7e(t,e,r,n){if(!t["!ref"])return"";var a=oa(t["!ref"]),s=t["!merges"]||[],o=0,l=[];t["!cols"]&&t["!cols"].forEach(function(g,v){Am(g);var y=!!g.width,b=sP(v,g),w={"ss:Index":v+1};y&&(w["ss:Width"]=P2(b.width)),g.hidden&&(w["ss:Hidden"]="1"),l.push(_r("Column",null,w))});for(var c=Array.isArray(t),u=a.s.r;u<=a.e.r;++u){for(var d=[m7e(u,(t["!rows"]||[])[u])],f=a.s.c;f<=a.e.c;++f){var A=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>f)&&!(s[o].s.r>u)&&!(s[o].e.c<f)&&!(s[o].e.r<u)){(s[o].s.c!=f||s[o].s.r!=u)&&(A=!0);break}if(!A){var h={r:u,c:f},m=hn(h),p=c?(t[u]||[])[f]:t[m];d.push(A7e(p,m,t,e,r,n,h))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function g7e(t,e,r){var n=[],a=r.SheetNames[t],s=r.Sheets[a],o=s?d7e(s,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?p7e(s,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(f7e(s,e,t,r)),n.join("")}function x7e(t,e){e||(e={}),t.SSF||(t.SSF=xs(fn)),t.SSF&&(h1(),Jj(t.SSF),e.revssf=eP(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Im(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(o7e(t,e)),r.push(l7e()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(_r("Worksheet",g7e(n,e,t),{"ss:Name":Ra(t.SheetNames[n])}));return r[2]=c7e(t,e),r[3]=u7e(t),ki+_r("Workbook",r.join(""),{xmlns:iu.ss,"xmlns:o":iu.o,"xmlns:x":iu.x,"xmlns:ss":iu.ss,"xmlns:dt":iu.dt,"xmlns:html":iu.html})}function v7e(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=uFe(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=dFe(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var y7e=[60,1084,2066,2165,2175];function b7e(t,e,r,n,a){var s=n,o=[],l=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}o.push(l),r.l+=s;for(var c=Rh(r,r.l),u=eF[c],d=0;u!=null&&y7e.indexOf(c)>-1;)s=Rh(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+s),o.push(l),r.l+=4+s,u=eF[c=Rh(r,r.l)];var f=Fo(o);il(f,0);var A=0;f.lens=[];for(var h=0;h<o.length;++h)f.lens.push(A),A+=o[h].length;if(f.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+f.length+" < "+n;return e.f(f,f.length,a)}function Nf(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=fn[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||CA[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=C2(t.v):t.w=rg(t.v):t.w=md(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&f1(fn[n]||String(n))){var a=gp(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function JC(t,e,r){return{v:t,ixfe:e,t:r}}function w7e(t,e){var r={opts:{}},n={},a=e.dense?[]:{},s={},o={},l=null,c=[],u="",d={},f,A="",h,m,p,g,v={},y=[],b,w,j=[],I=[],_={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},E=function(he){return he<8?Bp[he]:he<64&&I[he-8]||Bp[he]},F=function(he,le,Be){var je=le.XF.data;if(!(!je||!je.patternType||!Be||!Be.cellStyles)){le.s={},le.s.patternType=je.patternType;var Ae;(Ae=j2(E(je.icvFore)))&&(le.s.fgColor={rgb:Ae}),(Ae=j2(E(je.icvBack)))&&(le.s.bgColor={rgb:Ae})}},k=function(he,le,Be){if(!(Te>1)&&!(Be.sheetRows&&he.r>=Be.sheetRows)){if(Be.cellStyles&&le.XF&&le.XF.data&&F(he,le,Be),delete le.ixfe,delete le.XF,f=he,A=hn(he),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),he.r<o.s.r&&(o.s.r=he.r),he.c<o.s.c&&(o.s.c=he.c),he.r+1>o.e.r&&(o.e.r=he.r+1),he.c+1>o.e.c&&(o.e.c=he.c+1),Be.cellFormula&&le.f){for(var je=0;je<y.length;++je)if(!(y[je][0].s.c>he.c||y[je][0].s.r>he.r)&&!(y[je][0].e.c<he.c||y[je][0].e.r<he.r)){le.F=Sn(y[je][0]),(y[je][0].s.c!=he.c||y[je][0].s.r!=he.r)&&delete le.f,le.f&&(le.f=""+kl(y[je][1],o,he,ae,P));break}}Be.dense?(a[he.r]||(a[he.r]=[]),a[he.r][he.c]=le):a[A]=le}},P={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(P.password=e.password);var D,X=[],pe=[],ge=[],fe=[],xe=!1,ae=[];ae.SheetNames=P.snames,ae.sharedf=P.sharedf,ae.arrayf=P.arrayf,ae.names=[],ae.XTI=[];var Se=0,Te=0,O=0,G=[],z=[],L;P.codepage=1200,qd(1200);for(var Z=!1;t.l<t.length-1;){var ee=t.l,R=t.read_shift(2);if(R===0&&Se===10)break;var H=t.l===t.length?0:t.read_shift(2),ne=eF[R];if(ne&&ne.f){if(e.bookSheets&&Se===133&&R!==133)break;if(Se=R,ne.r===2||ne.r==12){var ve=t.read_shift(2);if(H-=2,!P.enc&&ve!==R&&((ve&255)<<8|ve>>8)!==R)throw new Error("rt mismatch: "+ve+"!="+R);ne.r==12&&(t.l+=10,H-=10)}var U={};if(R===10?U=ne.f(t,H,P):U=b7e(R,ne,t,H,P),Te==0&&[9,521,1033,2057].indexOf(Se)===-1)continue;switch(R){case 34:r.opts.Date1904=_.WBProps.date1904=U;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(t.l=0),P.enc=U,!e.password)throw new Error("File is password-protected");if(U.valid==null)throw new Error("Encryption scheme unsupported");if(!U.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=U;break;case 66:var He=Number(U);switch(He){case 21010:He=1200;break;case 32768:He=1e4;break;case 32769:He=1252;break}qd(P.codepage=He),Z=!0;break;case 317:P.rrtabid=U;break;case 25:P.winlocked=U;break;case 439:r.opts.RefreshAll=U;break;case 12:r.opts.CalcCount=U;break;case 16:r.opts.CalcDelta=U;break;case 17:r.opts.CalcIter=U;break;case 13:r.opts.CalcMode=U;break;case 14:r.opts.CalcPrecision=U;break;case 95:r.opts.CalcSaveRecalc=U;break;case 15:P.CalcRefMode=U;break;case 2211:r.opts.FullCalc=U;break;case 129:U.fDialog&&(a["!type"]="dialog"),U.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),U.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:j.push(U);break;case 430:ae.push([U]),ae[ae.length-1].XTI=[];break;case 35:case 547:ae[ae.length-1].push(U);break;case 24:case 536:L={Name:U.Name,Ref:kl(U.rgce,o,null,ae,P)},U.itab>0&&(L.Sheet=U.itab-1),ae.names.push(L),ae[0]||(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].push(U),U.Name=="_xlnm._FilterDatabase"&&U.itab>0&&U.rgce&&U.rgce[0]&&U.rgce[0][0]&&U.rgce[0][0][0]=="PtgArea3d"&&(z[U.itab-1]={ref:Sn(U.rgce[0][0][1][2])});break;case 22:P.ExternCount=U;break;case 23:ae.length==0&&(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].XTI=ae[ae.length-1].XTI.concat(U),ae.XTI=ae.XTI.concat(U);break;case 2196:if(P.biff<8)break;L!=null&&(L.Comment=U[1]);break;case 18:a["!protect"]=U;break;case 19:U!==0&&P.WTF&&console.error("Password verifier: "+U);break;case 133:s[U.pos]=U,P.snames.push(U.name);break;case 10:{if(--Te)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=Sn(o),e.sheetRows&&e.sheetRows<=o.e.r){var se=o.e.r;o.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Sn(o),o.e.r=se}o.e.r++,o.e.c++}X.length>0&&(a["!merges"]=X),pe.length>0&&(a["!objects"]=pe),ge.length>0&&(a["!cols"]=ge),fe.length>0&&(a["!rows"]=fe),_.Sheets.push(S)}u===""?d=a:n[u]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[R]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[U.BIFFVer]||8),P.biffguess=U.BIFFVer==0,U.BIFFVer==0&&U.dt==4096&&(P.biff=5,Z=!0,qd(P.codepage=28591)),P.biff==8&&U.BIFFVer==0&&U.dt==16&&(P.biff=2),Te++)break;if(a=e.dense?[]:{},P.biff<8&&!Z&&(Z=!0,qd(P.codepage=e.codepage||1252)),P.biff<5||U.BIFFVer==0&&U.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var re={pos:t.l-H,name:u};s[re.pos]=re,P.snames.push(u)}else u=(s[ee]||{name:""}).name;U.dt==32&&(a["!type"]="chart"),U.dt==64&&(a["!type"]="macro"),X=[],pe=[],P.arrayf=y=[],ge=[],fe=[],xe=!1,S={Hidden:(s[ee]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[U.r]||[])[U.c]:a[hn({c:U.c,r:U.r})])&&++U.c,b={ixfe:U.ixfe,XF:j[U.ixfe]||{},v:U.val,t:"n"},O>0&&(b.z=G[b.ixfe>>8&63]),Nf(b,e,r.opts.Date1904),k({c:U.c,r:U.r},b,e);break;case 5:case 517:b={ixfe:U.ixfe,XF:j[U.ixfe],v:U.val,t:U.t},O>0&&(b.z=G[b.ixfe>>8&63]),Nf(b,e,r.opts.Date1904),k({c:U.c,r:U.r},b,e);break;case 638:b={ixfe:U.ixfe,XF:j[U.ixfe],v:U.rknum,t:"n"},O>0&&(b.z=G[b.ixfe>>8&63]),Nf(b,e,r.opts.Date1904),k({c:U.c,r:U.r},b,e);break;case 189:for(var Pe=U.c;Pe<=U.C;++Pe){var ue=U.rkrec[Pe-U.c][0];b={ixfe:ue,XF:j[ue],v:U.rkrec[Pe-U.c][1],t:"n"},O>0&&(b.z=G[b.ixfe>>8&63]),Nf(b,e,r.opts.Date1904),k({c:Pe,r:U.r},b,e)}break;case 6:case 518:case 1030:{if(U.val=="String"){l=U;break}if(b=JC(U.val,U.cell.ixfe,U.tt),b.XF=j[b.ixfe],e.cellFormula){var we=U.formula;if(we&&we[0]&&we[0][0]&&we[0][0][0]=="PtgExp"){var Me=we[0][0][1][0],ze=we[0][0][1][1],yt=hn({r:Me,c:ze});v[yt]?b.f=""+kl(U.formula,o,U.cell,ae,P):b.F=((e.dense?(a[Me]||[])[ze]:a[yt])||{}).F}else b.f=""+kl(U.formula,o,U.cell,ae,P)}O>0&&(b.z=G[b.ixfe>>8&63]),Nf(b,e,r.opts.Date1904),k(U.cell,b,e),l=U}break;case 7:case 519:if(l)l.val=U,b=JC(U,l.cell.ixfe,"s"),b.XF=j[b.ixfe],e.cellFormula&&(b.f=""+kl(l.formula,o,l.cell,ae,P)),O>0&&(b.z=G[b.ixfe>>8&63]),Nf(b,e,r.opts.Date1904),k(l.cell,b,e),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(U);var It=hn(U[0].s);if(h=e.dense?(a[U[0].s.r]||[])[U[0].s.c]:a[It],e.cellFormula&&h){if(!l||!It||!h)break;h.f=""+kl(U[1],o,U[0],ae,P),h.F=Sn(U[0])}}break;case 1212:{if(!e.cellFormula)break;if(A){if(!l)break;v[hn(l.cell)]=U[0],h=e.dense?(a[l.cell.r]||[])[l.cell.c]:a[hn(l.cell)],(h||{}).f=""+kl(U[0],o,f,ae,P)}}break;case 253:b=JC(c[U.isst].t,U.ixfe,"s"),c[U.isst].h&&(b.h=c[U.isst].h),b.XF=j[b.ixfe],O>0&&(b.z=G[b.ixfe>>8&63]),Nf(b,e,r.opts.Date1904),k({c:U.c,r:U.r},b,e);break;case 513:e.sheetStubs&&(b={ixfe:U.ixfe,XF:j[U.ixfe],t:"z"},O>0&&(b.z=G[b.ixfe>>8&63]),Nf(b,e,r.opts.Date1904),k({c:U.c,r:U.r},b,e));break;case 190:if(e.sheetStubs)for(var Ke=U.c;Ke<=U.C;++Ke){var wt=U.ixfe[Ke-U.c];b={ixfe:wt,XF:j[wt],t:"z"},O>0&&(b.z=G[b.ixfe>>8&63]),Nf(b,e,r.opts.Date1904),k({c:Ke,r:U.r},b,e)}break;case 214:case 516:case 4:b=JC(U.val,U.ixfe,"s"),b.XF=j[b.ixfe],O>0&&(b.z=G[b.ixfe>>8&63]),Nf(b,e,r.opts.Date1904),k({c:U.c,r:U.r},b,e);break;case 0:case 512:Te===1&&(o=U);break;case 252:c=U;break;case 1054:if(P.biff==4){G[O++]=U[1];for(var At=0;At<O+163&&fn[At]!=U[1];++At);At>=163&&zh(U[1],O+163)}else zh(U[1],U[0]);break;case 30:{G[O++]=U;for(var bt=0;bt<O+163&&fn[bt]!=U;++bt);bt>=163&&zh(U,O+163)}break;case 229:X=X.concat(U);break;case 93:pe[U.cmo[0]]=P.lastobj=U;break;case 438:P.lastobj.TxO=U;break;case 127:P.lastobj.ImData=U;break;case 440:for(g=U[0].s.r;g<=U[0].e.r;++g)for(p=U[0].s.c;p<=U[0].e.c;++p)h=e.dense?(a[g]||[])[p]:a[hn({c:p,r:g})],h&&(h.l=U[1]);break;case 2048:for(g=U[0].s.r;g<=U[0].e.r;++g)for(p=U[0].s.c;p<=U[0].e.c;++p)h=e.dense?(a[g]||[])[p]:a[hn({c:p,r:g})],h&&h.l&&(h.l.Tooltip=U[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;h=e.dense?(a[U[0].r]||[])[U[0].c]:a[hn(U[0])];var ke=pe[U[2]];h||(e.dense?(a[U[0].r]||(a[U[0].r]=[]),h=a[U[0].r][U[0].c]={t:"z"}):h=a[hn(U[0])]={t:"z"},o.e.r=Math.max(o.e.r,U[0].r),o.s.r=Math.min(o.s.r,U[0].r),o.e.c=Math.max(o.e.c,U[0].c),o.s.c=Math.min(o.s.c,U[0].c)),h.c||(h.c=[]),m={a:U[1],t:ke.TxO.t},h.c.push(m)}break;case 2173:cRe(j[U.ixfe],U.ext);break;case 125:{if(!P.cellStyles)break;for(;U.e>=U.s;)ge[U.e--]={width:U.w/256,level:U.level||0,hidden:!!(U.flags&1)},xe||(xe=!0,uR(U.w/256)),Am(ge[U.e+1])}break;case 520:{var Ne={};U.level!=null&&(fe[U.r]=Ne,Ne.level=U.level),U.hidden&&(fe[U.r]=Ne,Ne.hidden=!0),U.hpt&&(fe[U.r]=Ne,Ne.hpt=U.hpt,Ne.hpx=Ov(U.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Fp(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[R]]=U;break;case 161:a["!margins"]||Fp(a["!margins"]={}),a["!margins"].header=U.header,a["!margins"].footer=U.footer;break;case 574:U.RTL&&(_.Views[0].RTL=!0);break;case 146:I=U;break;case 2198:D=U;break;case 140:w=U;break;case 442:u?S.CodeName=U||S.name:_.WBProps.CodeName=U||"ThisWorkbook";break}}else ne||console.error("Missing Info for XLS Record 0x"+R.toString(16)),t.l+=H}return r.SheetNames=hi(s).sort(function(Ve,he){return Number(Ve)-Number(he)}).map(function(Ve){return s[Ve].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&z.forEach(function(Ve,he){r.Sheets[r.SheetNames[he]]["!autofilter"]=Ve}),r.Strings=c,r.SSF=xs(fn),P.enc&&(r.Encryption=P.enc),D&&(r.Themes=D),r.Metadata={},w!==void 0&&(r.Metadata.Country=w),ae.names.length>0&&(_.Names=ae.names),r.Workbook=_,r}var Pb={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function N7e(t,e,r){var n=nn.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=f$(n,qk,Pb.DSI);for(var s in a)e[s]=a[s]}catch(u){if(r.WTF)throw u}var o=nn.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var l=f$(o,zk,Pb.SI);for(var c in l)e[c]==null&&(e[c]=l[c])}catch(u){if(r.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(eae(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function C7e(t,e){var r=[],n=[],a=[],s=0,o,l=VH(qk,"n"),c=VH(zk,"n");if(t.Props)for(o=hi(t.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],t.Props[o[s]]]);if(t.Custprops)for(o=hi(t.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],t.Custprops[o[s]]]);var u=[];for(s=0;s<a.length;++s)oae.indexOf(a[s][0])>-1||Zne.indexOf(a[s][0])>-1||a[s][1]!=null&&u.push(a[s]);n.length&&nn.utils.cfb_add(e,"/SummaryInformation",h$(n,Pb.SI,c,zk)),(r.length||u.length)&&nn.utils.cfb_add(e,"/DocumentSummaryInformation",h$(r,Pb.DSI,l,qk,u.length?u:null,Pb.UDI))}function rse(t,e){e||(e={}),vR(e),U6(),e.codepage&&L6(e.codepage);var r,n;if(t.FullPaths){if(nn.find(t,"/encryption"))throw new Error("File is password-protected");r=nn.find(t,"!CompObj"),n=nn.find(t,"/Workbook")||nn.find(t,"/Book")}else{switch(e.type){case"base64":t=lu(bu(t));break;case"binary":t=lu(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}il(t,0),n={content:t}}var a,s;if(r&&v7e(r),e.bookProps&&!e.bookSheets)a={};else{var o=Rn?"buffer":"array";if(n&&n.content)a=w7e(n.content,e);else if((s=nn.find(t,"PerfectOffice_MAIN"))&&s.content)a=kp.to_workbook(s.content,(e.type=o,e));else if((s=nn.find(t,"NativeContent_MAIN"))&&s.content)a=kp.to_workbook(s.content,(e.type=o,e));else throw(s=nn.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&nn.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=RRe(t))}var l={};return t.FullPaths&&N7e(t,l,e),a.Props=a.Custprops=l,e.bookFiles&&(a.cfb=t),a}function _7e(t,e){var r=e||{},n=nn.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return nn.utils.cfb_add(n,a,nse(t,r)),r.biff==8&&(t.Props||t.Custprops)&&C7e(t,n),r.biff==8&&t.vbaraw&&MRe(n,nn.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var k2={0:{f:WMe},1:{f:nLe},2:{f:wLe},3:{f:dLe},4:{f:oLe},5:{f:vLe},6:{f:SLe},7:{f:mLe},8:{f:FLe},9:{f:kLe},10:{f:BLe},11:{f:TLe},12:{f:sLe},13:{f:CLe},14:{f:hLe},15:{f:cLe},16:{f:zae},17:{f:jLe},18:{f:gLe},19:{f:eR},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:jUe},40:{},42:{},43:{f:S6e},44:{f:_6e},45:{f:P6e},46:{f:T6e},47:{f:B6e},48:{},49:{f:Jke},50:{},51:{f:fRe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:xae},62:{f:ELe},63:{f:bRe},64:{f:XLe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ql,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:KLe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:tLe},148:{f:JMe,p:16},151:{f:ULe},152:{},153:{f:EUe},154:{},155:{},156:{f:CUe},157:{},158:{},159:{T:1,f:VDe},160:{T:-1},161:{T:1,f:Bg},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:OLe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:uRe},336:{T:-1},337:{f:mRe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Kk},357:{},358:{},359:{},360:{T:1},361:{},362:{f:gae},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:QLe},427:{f:VLe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:$Le},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:eLe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:MLe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Kk},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:TRe},633:{T:1},634:{T:-1},635:{T:1,f:PRe},636:{T:-1},637:{f:rFe},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:hUe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:YLe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},eF={6:{f:P5},10:{f:s0},12:{f:Mi},13:{f:Mi},14:{f:yi},15:{f:yi},16:{f:Dl},17:{f:yi},18:{f:yi},19:{f:Mi},20:{f:v$},21:{f:v$},23:{f:gae},24:{f:b$},25:{f:yi},26:{},27:{},28:{f:YOe},29:{},34:{f:yi},35:{f:y$},38:{f:Dl},39:{f:Dl},40:{f:Dl},41:{f:Dl},42:{f:yi},43:{f:yi},47:{f:c6e},49:{f:COe},51:{f:Mi},60:{},61:{f:vOe},64:{f:yi},65:{f:NOe},66:{f:Mi},77:{},80:{},81:{},82:{},85:{f:Mi},89:{},90:{},91:{},92:{f:lOe},93:{f:eDe},94:{},95:{f:yi},96:{},97:{},99:{f:yi},125:{f:xae},128:{f:LOe},129:{f:uOe},130:{f:Mi},131:{f:yi},132:{f:yi},133:{f:dOe},134:{},140:{f:lDe},141:{f:Mi},144:{},146:{f:dDe},151:{},152:{},153:{},154:{},155:{},156:{f:Mi},157:{},158:{},160:{f:xDe},161:{f:ADe},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:OOe},190:{f:DOe},193:{f:s0},197:{},198:{},199:{},200:{},201:{},202:{f:yi},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Mi},220:{},221:{f:yi},222:{},224:{f:MOe},225:{f:oOe},226:{f:s0},227:{},229:{f:JOe},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:hOe},253:{f:EOe},255:{f:mOe},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:lae},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:yi},353:{f:s0},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:$Oe},431:{f:yi},432:{},433:{},434:{},437:{},438:{f:nDe},439:{f:yi},440:{f:aDe},441:{},442:{f:kw},443:{},444:{f:Mi},445:{},446:{},448:{f:s0},449:{f:xOe,r:2},450:{f:s0},512:{f:p$},513:{f:gDe},515:{f:VOe},516:{f:IOe},517:{f:x$},519:{f:vDe},520:{f:pOe},523:{},545:{f:w$},549:{f:m$},566:{},574:{f:bOe},638:{f:FOe},659:{},1048:{},1054:{f:POe},1084:{},1212:{f:zOe},2048:{f:iDe},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:WC},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:s0},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:fDe,r:12},2173:{f:lRe,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:yi,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:qOe,r:12},2197:{},2198:{f:rRe,r:12},2199:{},2200:{},2201:{},2202:{f:WOe,r:12},2203:{f:s0},2204:{},2205:{},2206:{},2207:{},2211:{f:gOe},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Mi},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:mDe},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:uDe},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:p$},1:{},2:{f:CDe},3:{f:wDe},4:{f:bDe},5:{f:x$},7:{f:EDe},8:{},9:{f:WC},11:{},22:{f:Mi},30:{f:TOe},31:{},32:{},33:{f:w$},36:{},37:{f:m$},50:{f:SDe},62:{},52:{},67:{},68:{f:Mi},69:{},86:{},126:{},127:{f:yDe},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:IDe},223:{},234:{},354:{},421:{},518:{f:P5},521:{f:WC},536:{f:b$},547:{f:y$},561:{},579:{},1030:{f:P5},1033:{f:WC},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Er(t,e,r,n){var a=e;if(!isNaN(a)){var s=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,a),o.write_shift(2,s),s>0&&Y6(r)&&t.push(r)}}function E7e(t,e,r,n){var a=(r||[]).length||0;if(a<=8224)return Er(t,e,r,a);var s=e;if(!isNaN(s)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var d=t.next(4);for(d.write_shift(2,s),d.write_shift(2,u),t.push(r.slice(c,c+u)),c+=u;c<a;){for(d=t.next(4),d.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;d.write_shift(2,u),t.push(r.slice(c,c+u)),c+=u}}}function Rw(t,e,r){return t||(t=tr(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function S7e(t,e,r,n){var a=tr(9);return Rw(a,t,e),cae(r,n||"b",a),a}function I7e(t,e,r){var n=tr(8+2*r.length);return Rw(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function j7e(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?mo(gs(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?Er(t,2,_De(r,n,a)):Er(t,3,NDe(r,n,a));return;case"b":case"e":Er(t,5,S7e(r,n,e.v,e.t));return;case"s":case"str":Er(t,4,I7e(r,n,(e.v||"").slice(0,255)));return}Er(t,1,Rw(null,r,n))}function P7e(t,e,r,n){var a=Array.isArray(e),s=oa(e["!ref"]||"A1"),o,l="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=Sn(s)}for(var u=s.s.r;u<=s.e.r;++u){l=Bi(u);for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(c[d]=qs(d)),o=c[d]+l;var f=a?(e[u]||[])[d]:e[o];f&&j7e(t,f,u,d)}}}function B7e(t,e){for(var r=e||{},n=Mc(),a=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Er(n,r.biff==4?1033:r.biff==3?521:9,oR(t,16,r)),P7e(n,t.Sheets[t.SheetNames[a]],a,r),Er(n,10),n.end()}function T7e(t,e,r){Er(t,49,_Oe({sz:12,name:"Arial"},r))}function k7e(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Er(t,1054,BOe(a,e[a],r))})}function F7e(t,e){var r=tr(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Er(t,2151,r),r=tr(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Aae(oa(e["!ref"]||"A1"),r),r.write_shift(4,4),Er(t,2152,r)}function O7e(t,e){for(var r=0;r<16;++r)Er(t,224,g$({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Er(t,224,g$(n,0,e))})}function D7e(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Er(t,440,sDe(n)),n[1].Tooltip&&Er(t,2048,oDe(n))}delete e["!links"]}function R7e(t,e){if(e){var r=0;e.forEach(function(n,a){++r<=256&&n&&Er(t,125,hDe(sP(a,n),a))})}}function M7e(t,e,r,n,a){var s=16+Im(a.cellXfs,e,a);if(e.v==null&&!e.bf){Er(t,513,ig(r,n,s));return}if(e.bf)Er(t,6,uMe(e,r,n,a,s));else switch(e.t){case"d":case"n":var o=e.t=="d"?mo(gs(e.v)):e.v;Er(t,515,HOe(r,n,o,s));break;case"b":case"e":Er(t,517,QOe(r,n,e.v,s,a,e.t));break;case"s":case"str":if(a.bookSST){var l=mR(a.Strings,e.v,a.revStrings);Er(t,253,SOe(r,n,l,s))}else Er(t,516,jOe(r,n,(e.v||"").slice(0,255),s,a));break;default:Er(t,513,ig(r,n,s))}}function L7e(t,e,r){var n=Mc(),a=r.SheetNames[t],s=r.Sheets[a]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[t]||{},c=Array.isArray(s),u=e.biff==8,d,f="",A=[],h=oa(s["!ref"]||"A1"),m=u?65536:16384;if(h.e.c>255||h.e.r>=m){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,m-1)}Er(n,2057,oR(r,16,e)),Er(n,13,Yu(1)),Er(n,12,Yu(100)),Er(n,15,sc(!0)),Er(n,17,sc(!1)),Er(n,16,ag(.001)),Er(n,95,sc(!0)),Er(n,42,sc(!1)),Er(n,43,sc(!1)),Er(n,130,Yu(1)),Er(n,128,UOe()),Er(n,131,sc(!1)),Er(n,132,sc(!1)),u&&R7e(n,s["!cols"]),Er(n,512,kOe(h,e)),u&&(s["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){f=Bi(p);for(var g=h.s.c;g<=h.e.c;++g){p===h.s.r&&(A[g]=qs(g)),d=A[g]+f;var v=c?(s[p]||[])[g]:s[d];v&&(M7e(n,v,p,g,e),u&&v.l&&s["!links"].push([d,v.l]))}}var y=l.CodeName||l.name||a;return u&&Er(n,574,wOe((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&Er(n,229,ZOe(s["!merges"])),u&&D7e(n,s),Er(n,442,uae(y)),u&&F7e(n,s),Er(n,10),n.end()}function U7e(t,e,r){var n=Mc(),a=(t||{}).Workbook||{},s=a.Sheets||[],o=a.WBProps||{},l=r.biff==8,c=r.biff==5;if(Er(n,2057,oR(t,5,r)),r.bookType=="xla"&&Er(n,135),Er(n,225,l?Yu(1200):null),Er(n,193,QFe(2)),c&&Er(n,191),c&&Er(n,192),Er(n,226),Er(n,92,cOe("SheetJS",r)),Er(n,66,Yu(l?1200:1252)),l&&Er(n,353,Yu(0)),l&&Er(n,448),Er(n,317,pDe(t.SheetNames.length)),l&&t.vbaraw&&Er(n,211),l&&t.vbaraw){var u=o.CodeName||"ThisWorkbook";Er(n,442,uae(u))}Er(n,156,Yu(17)),Er(n,25,sc(!1)),Er(n,18,sc(!1)),Er(n,19,Yu(0)),l&&Er(n,431,sc(!1)),l&&Er(n,444,Yu(0)),Er(n,61,yOe()),Er(n,64,sc(!1)),Er(n,141,Yu(0)),Er(n,34,sc(xUe(t)=="true")),Er(n,14,sc(!0)),l&&Er(n,439,sc(!1)),Er(n,218,Yu(0)),T7e(n,t,r),k7e(n,t.SSF,r),O7e(n,r),l&&Er(n,352,sc(!1));var d=n.end(),f=Mc();l&&Er(f,140,cDe()),l&&r.Strings&&E7e(f,252,AOe(r.Strings)),Er(f,10);var A=f.end(),h=Mc(),m=0,p=0;for(p=0;p<t.SheetNames.length;++p)m+=(l?12:11)+(l?2:1)*t.SheetNames[p].length;var g=d.length+m+A.length;for(p=0;p<t.SheetNames.length;++p){var v=s[p]||{};Er(h,133,fOe({pos:g,hs:v.Hidden||0,dt:0,name:t.SheetNames[p]},r)),g+=e[p].length}var y=h.end();if(m!=y.length)throw new Error("BS8 "+m+" != "+y.length);var b=[];return d.length&&b.push(d),y.length&&b.push(y),A.length&&b.push(A),Fo(b)}function Q7e(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=xs(fn)),t&&t.SSF&&(h1(),Jj(t.SSF),r.revssf=eP(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,yR(r),r.cellXfs=[],Im(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)n[n.length]=L7e(a,r,t);return n.unshift(U7e(t,n,r)),Fo(n)}function nse(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Lc(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return Q7e(t,e);case 4:case 3:case 2:return B7e(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function T$(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),o=a.index,l=s&&s.index||t.length,c=_ke(t.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,A=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<c.length;++o){var p=c[o].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(g!="<td"&&g!="<th")){var v=p.split(/<\/t[dh]>/i);for(l=0;l<v.length;++l){var y=v[l].trim();if(y.match(/<t[dh]/i)){for(var b=y,w=0;b.charAt(0)=="<"&&(w=b.indexOf(">"))>-1;)b=b.slice(w+1);for(var j=0;j<m.length;++j){var I=m[j];I.s.c==d&&I.s.r<u&&u<=I.e.r&&(d=I.e.c+1,j=-1)}var _=An(y.slice(0,y.indexOf(">")));A=_.colspan?+_.colspan:1,((f=+_.rowspan)>1||A>1)&&m.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+A-1}});var S=_.t||_["data-t"]||"";if(!b.length){d+=A;continue}if(b=Sne(b),h.s.r>u&&(h.s.r=u),h.e.r<u&&(h.e.r=u),h.s.c>d&&(h.s.c=d),h.e.c<d&&(h.e.c=d),!b.length){d+=A;continue}var E={t:"s",v:b};r.raw||!b.trim().length||S=="s"||(b==="TRUE"?E={t:"b",v:!0}:b==="FALSE"?E={t:"b",v:!1}:isNaN(ef(b))?isNaN(kv(b).getDate())||(E={t:"d",v:gs(b)},r.cellDates||(E={t:"n",v:mo(E.v)}),E.z=r.dateNF||fn[14]):E={t:"n",v:ef(b)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=E):n[hn({r:u,c:d})]=E,d+=A}}}}return n["!ref"]=Sn(h),m.length&&(n["!merges"]=m),n}function V7e(t,e,r,n){for(var a=t["!merges"]||[],s=[],o=e.s.c;o<=e.e.c;++o){for(var l=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>o)&&!(a[u].e.r<r||a[u].e.c<o)){if(a[u].s.r<r||a[u].s.c<o){l=-1;break}l=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(l<0)){var d=hn({r,c:o}),f=n.dense?(t[r]||[])[o]:t[d],A=f&&f.v!=null&&(f.h||z6(f.w||(oA(f),f.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),n.editable?A='<span contenteditable="true">'+A+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(A='<a href="'+f.l.Target+'">'+A+"</a>")),h.id=(n.id||"sjs")+"-"+d,s.push(_r("td",A,h))}}var m="<tr>";return m+s.join("")+"</tr>"}var H7e='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',$7e="</body></html>";function G7e(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Sm(T$(r[0],e),e);var n=NR();return r.forEach(function(a,s){CR(n,T$(a,e),"Sheet"+(s+1))}),n}function K7e(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function ase(t,e){var r=e||{},n=r.header!=null?r.header:H7e,a=r.footer!=null?r.footer:$7e,s=[n],o=Lc(t["!ref"]);r.dense=Array.isArray(t),s.push(K7e(t,o,r));for(var l=o.s.r;l<=o.e.r;++l)s.push(V7e(t,o,l,r));return s.push("</table>"+a),s.join("")}function sse(t,e,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?zs(n.origin):n.origin;a=o.r,s=o.c}var l=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:a,c:s}};if(t["!ref"]){var d=Lc(t["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),a==-1&&(u.e.r=a=d.e.r+1)}var f=[],A=0,h=t["!rows"]||(t["!rows"]=[]),m=0,p=0,g=0,v=0,y=0,b=0;for(t["!cols"]||(t["!cols"]=[]);m<l.length&&p<c;++m){var w=l[m];if(k$(w)){if(n.display)continue;h[p]={hidden:!0}}var j=w.children;for(g=v=0;g<j.length;++g){var I=j[g];if(!(n.display&&k$(I))){var _=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):Sne(I.innerHTML),S=I.getAttribute("data-z")||I.getAttribute("z");for(A=0;A<f.length;++A){var E=f[A];E.s.c==v+s&&E.s.r<p+a&&p+a<=E.e.r&&(v=E.e.c+1-s,A=-1)}b=+I.getAttribute("colspan")||1,((y=+I.getAttribute("rowspan")||1)>1||b>1)&&f.push({s:{r:p+a,c:v+s},e:{r:p+a+(y||1)-1,c:v+s+(b||1)-1}});var F={t:"s",v:_},k=I.getAttribute("data-t")||I.getAttribute("t")||"";_!=null&&(_.length==0?F.t=k||"z":n.raw||_.trim().length==0||k=="s"||(_==="TRUE"?F={t:"b",v:!0}:_==="FALSE"?F={t:"b",v:!1}:isNaN(ef(_))?isNaN(kv(_).getDate())||(F={t:"d",v:gs(_)},n.cellDates||(F={t:"n",v:mo(F.v)}),F.z=n.dateNF||fn[14]):F={t:"n",v:ef(_)})),F.z===void 0&&S!=null&&(F.z=S);var P="",D=I.getElementsByTagName("A");if(D&&D.length)for(var X=0;X<D.length&&!(D[X].hasAttribute("href")&&(P=D[X].getAttribute("href"),P.charAt(0)!="#"));++X);P&&P.charAt(0)!="#"&&(F.l={Target:P}),n.dense?(t[p+a]||(t[p+a]=[]),t[p+a][v+s]=F):t[hn({c:v+s,r:p+a})]=F,u.e.c<v+s&&(u.e.c=v+s),v+=b}}++p}return f.length&&(t["!merges"]=(t["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,p-1+a),t["!ref"]=Sn(u),p>=c&&(t["!fullref"]=Sn((u.e.r=l.length-m+p-1+a,u))),t}function ise(t,e){var r=e||{},n=r.dense?[]:{};return sse(n,t,e)}function q7e(t,e){return Sm(ise(t,e),e)}function k$(t){var e="",r=z7e(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function z7e(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function W7e(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ia(e.replace(/<[^>]*>/g,""));return[r]}var F$={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function ose(t,e){var r=e||{},n=W6(t),a=[],s,o,l={name:""},c="",u=0,d,f,A={},h=[],m=r.dense?[]:{},p,g,v={value:""},y="",b=0,w=[],j=-1,I=-1,_={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,E={},F=[],k={},P=0,D=0,X=[],pe=1,ge=1,fe=[],xe={Names:[]},ae={},Se=["",""],Te=[],O={},G="",z=0,L=!1,Z=!1,ee=0;for(S2.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=S2.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(_.e.c>=_.s.c&&_.e.r>=_.s.r?m["!ref"]=Sn(_):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=_.e.r&&(m["!fullref"]=m["!ref"],_.e.r=r.sheetRows-1,m["!ref"]=Sn(_)),F.length&&(m["!merges"]=F),X.length&&(m["!rows"]=X),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),h.push(d.name),A[d.name]=m,Z=!1):p[0].charAt(p[0].length-2)!=="/"&&(d=An(p[0],!1),j=I=-1,_.s.r=_.s.c=1e7,_.e.r=_.e.c=0,m=r.dense?[]:{},F=[],X=[],Z=!0);break;case"table-row-group":p[1]==="/"?--S:++S;break;case"table-row":case"":if(p[1]==="/"){j+=pe,pe=1;break}if(f=An(p[0],!1),f.?j=f.-1:j==-1&&(j=0),pe=+f["number-rows-repeated"]||1,pe<10)for(ee=0;ee<pe;++ee)S>0&&(X[j+ee]={level:S});I=-1;break;case"covered-table-cell":p[1]!=="/"&&++I,r.sheetStubs&&(r.dense?(m[j]||(m[j]=[]),m[j][I]={t:"z"}):m[hn({r:j,c:I})]={t:"z"}),y="",w=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++I,v=An(p[0],!1),ge=parseInt(v["number-columns-repeated"]||"1",10),g={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(g.f=j$(ia(v.formula))),(v.||v["value-type"])=="string"&&(g.t="s",g.v=ia(v["string-value"]||""),r.dense?(m[j]||(m[j]=[]),m[j][I]=g):m[hn({r:j,c:I})]=g),I+=ge-1;else if(p[1]!=="/"){++I,y="",b=0,w=[],ge=1;var R=pe?j+pe-1:j;if(I>_.e.c&&(_.e.c=I),I<_.s.c&&(_.s.c=I),j<_.s.r&&(_.s.r=j),R>_.e.r&&(_.e.r=R),v=An(p[0],!1),Te=[],O={},g={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=ia(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(P=parseInt(v["number-matrix-rows-spanned"],10)||0,D=parseInt(v["number-matrix-columns-spanned"],10)||0,k={s:{r:j,c:I},e:{r:j+P-1,c:I+D-1}},g.F=Sn(k),fe.push([k,g.F])),v.formula)g.f=j$(v.formula);else for(ee=0;ee<fe.length;++ee)j>=fe[ee][0].s.r&&j<=fe[ee][0].e.r&&I>=fe[ee][0].s.c&&I<=fe[ee][0].e.c&&(g.F=fe[ee][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(P=parseInt(v["number-rows-spanned"],10)||0,D=parseInt(v["number-columns-spanned"],10)||0,k={s:{r:j,c:I},e:{r:j+P-1,c:I+D-1}},F.push(k)),v["number-columns-repeated"]&&(ge=parseInt(v["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=hs(v["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(v.value);break;case"percentage":g.t="n",g.v=parseFloat(v.value);break;case"currency":g.t="n",g.v=parseFloat(v.value);break;case"date":g.t="d",g.v=gs(v["date-value"]),r.cellDates||(g.t="n",g.v=mo(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=wke(v["time-value"])/86400,r.cellDates&&(g.t="d",g.v=tP(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(v.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",v["string-value"]!=null&&(y=ia(v["string-value"]),w=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(L=!1,g.t==="s"&&(g.v=y||"",w.length&&(g.R=w),L=b==0),ae.Target&&(g.l=ae),Te.length>0&&(g.c=Te,Te=[]),y&&r.cellText!==!1&&(g.w=y),L&&(g.t="z",delete g.v),(!L||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=j))for(var H=0;H<pe;++H){if(ge=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(m[j+H]||(m[j+H]=[]),m[j+H][I]=H==0?g:xs(g);--ge>0;)m[j+H][I+ge]=xs(g);else for(m[hn({r:j+H,c:I})]=g;--ge>0;)m[hn({r:j+H,c:I+ge})]=xs(g);_.e.c<=I&&(_.e.c=I)}ge=parseInt(v["number-columns-repeated"]||"1",10),I+=ge-1,ge=0,g={},y="",w=[]}ae={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s;O.t=y,w.length&&(O.R=w),O.a=G,Te.push(O)}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);G="",z=0,y="",b=0,w=[];break;case"creator":p[1]==="/"?G=n.slice(z,p.index):z=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);y="",b=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(E[l.name]=c,(s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(c="",l=An(p[0],!1),a.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=An(p[0],!1),c+=F$[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=An(p[0],!1),c+=F$[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":o=An(p[0],!1),Se=B5(o["cell-range-address"]);var ne={Name:o.name,Ref:Se[0]+"!"+Se[1]};Z&&(ne.Sheet=h.length),xe.Names.push(ne);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(p[1]==="/"&&(!v||!v["string-value"])){var ve=W7e(n.slice(b,p.index));y=(y.length>0?y+`
`:"")+ve[0]}else An(p[0],!1),b=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{Se=B5(An(p[0])["target-range-address"]),A[Se[0]]["!autofilter"]={ref:Se[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(ae=An(p[0],!1),!ae.href)break;ae.Target=ia(ae.href),delete ae.href,ae.Target.charAt(0)=="#"&&ae.Target.indexOf(".")>-1?(Se=B5(ae.Target.slice(1)),ae.Target="#"+Se[0]+"!"+Se[1]):ae.Target.match(/^\.\.[\\\/]/)&&(ae.Target=ae.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var U={Sheets:A,SheetNames:h,Workbook:xe};return r.bookSheets&&delete U.Sheets,U}function O$(t,e){e=e||{},Xu(t,"META-INF/manifest.xml")&&wFe(Ri(t,"META-INF/manifest.xml"),e);var r=cu(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=ose(Ga(r),e);return Xu(t,"meta.xml")&&(n.Props=Yne(Ri(t,"meta.xml"))),n}function D$(t,e){return ose(t,e)}var X7e=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+E2({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return ki+e}}(),R$=function(){var t=function(s){return Ra(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,l){var c=[];c.push('      <table:table table:name="'+Ra(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,f=Lc(s["!ref"]||"A1"),A=s["!merges"]||[],h=0,m=Array.isArray(s);if(s["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var p="",g=s["!rows"]||[];for(u=0;u<f.s.r;++u)p=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=f.e.r;++u){for(p=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+p+`>
`),d=0;d<f.s.c;++d)c.push(e);for(;d<=f.e.c;++d){var v=!1,y={},b="";for(h=0;h!=A.length;++h)if(!(A[h].s.c>d)&&!(A[h].s.r>u)&&!(A[h].e.c<d)&&!(A[h].e.r<u)){(A[h].s.c!=d||A[h].s.r!=u)&&(v=!0),y["table:number-columns-spanned"]=A[h].e.c-A[h].s.c+1,y["table:number-rows-spanned"]=A[h].e.r-A[h].s.r+1;break}if(v){c.push(r);continue}var w=hn({r:u,c:d}),j=m?(s[u]||[])[d]:s[w];if(j&&j.f&&(y["table:formula"]=Ra(pMe(j.f)),j.F&&j.F.slice(0,w.length)==w)){var I=Lc(j.F);y["table:number-matrix-columns-spanned"]=I.e.c-I.s.c+1,y["table:number-matrix-rows-spanned"]=I.e.r-I.s.r+1}if(!j){c.push(e);continue}switch(j.t){case"b":b=j.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=j.v?"true":"false";break;case"n":b=j.w||String(j.v||0),y["office:value-type"]="float",y["office:value"]=j.v||0;break;case"s":case"str":b=j.v==null?"":j.v,y["office:value-type"]="string";break;case"d":b=j.w||gs(j.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=gs(j.v).toISOString(),y["table:style-name"]="ce1";break;default:c.push(e);continue}var _=t(b);if(j.l&&j.l.Target){var S=j.l.Target;S=S.charAt(0)=="#"?"#"+gMe(S.slice(1)):S,S.charAt(0)!="#"&&!S.match(/^\w+:/)&&(S="../"+S),_=_r("text:a",_,{"xlink:href":S.replace(/&/g,"&amp;")})}c.push("          "+_r("table:table-cell",_r("text:p",_,{}),y)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Am(f),f.ods=l;var A=u["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+A+`"/>
`),s.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,l){var c=[ki],u=E2({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=E2({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(Xne().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),a(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(n(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function lse(t,e){if(e.bookType=="fods")return R$(t,e);var r=G6(),n="",a=[],s=[];return n="mimetype",kn(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",kn(r,n,R$(t,e)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",kn(r,n,X7e(t,e)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",kn(r,n,ki+Xne()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",kn(r,n,_Fe(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",kn(r,n,NFe(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function og(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function tF(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Ga(Em(t))}function Y7e(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):lu(Mf(t))}function J7e(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function pm(t){var e=t.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(a){r.set(a,n),n+=a.length}),r}function M$(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function Z7e(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,a=e+13;a>=e;--a)n=n*256+t[a];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function e9e(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)t[e+s]=a&255;t[e+15]|=r>=0?0:128}function F2(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Ba(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function di(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function ua(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],a=F2(t,r),s=a&7;a=Math.floor(a/8);var o=0,l;if(a==0)break;switch(s){case 0:{for(var c=r[0];t[r[0]++]>=128;);l=t.slice(c,r[0])}break;case 5:o=4,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=F2(t,r),l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var u={data:l,type:s};e[a]==null?e[a]=[u]:e[a].push(u)}return e}function Jo(t){var e=[];return t.forEach(function(r,n){r.forEach(function(a){a.data&&(e.push(Ba(n*8+a.type)),a.type==2&&e.push(Ba(a.data.length)),e.push(a.data))})}),pm(e)}function xR(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function $u(t){for(var e,r=[],n=[0];n[0]<t.length;){var a=F2(t,n),s=ua(t.slice(n[0],n[0]+a));n[0]+=a;var o={id:di(s[1][0].data),messages:[]};s[2].forEach(function(l){var c=ua(l.data),u=di(c[3][0].data);o.messages.push({meta:c,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(o.merge=di(s[3][0].data)>>>0>0),r.push(o)}return r}function ux(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Ba(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ba(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:Ba(o.data.length)}],n[2].push({data:Jo(o.meta),type:2})});var s=Jo(n);e.push(Ba(s.length)),e.push(s),a.forEach(function(o){return e.push(o)})}),pm(e)}function t9e(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=F2(e,r),a=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=e[r[0]],l>1&&(o|=e[r[0]+1]<<8),l>2&&(o|=e[r[0]+2]<<16),l>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}a.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),a=[pm(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}}var d=pm(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Gu(t){for(var e=[],r=0;r<t.length;){var n=t[r++],a=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(t9e(n,t.slice(r,r+a))),r+=a}if(r!==t.length)throw new Error("data is not a valid framed stream!");return pm(e)}function dx(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),a=new Uint8Array(4);e.push(a);var s=Ba(n),o=s.length;e.push(s),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,r+=n}return pm(e)}function r9e(t,e,r,n){var a=og(t),s=a.getUint32(4,!0),o=(n>1?12:8)+M$(s&(n>1?3470:398))*4,l=-1,c=-1,u=NaN,d=new Date(2001,0,1);s&512&&(l=a.getUint32(o,!0),o+=4),o+=M$(s&(n>1?12288:4096))*4,s&16&&(c=a.getUint32(o,!0),o+=4),s&32&&(u=a.getFloat64(o,!0),o+=8),s&64&&(d.setTime(d.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var f;switch(t[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:e[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:e[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return f}function n9e(t,e,r){var n=og(t),a=n.getUint32(8,!0),s=12,o=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);a&1&&(c=Z7e(t,s),s+=16),a&2&&(u=n.getFloat64(s,!0),s+=8),a&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(l=n.getUint32(s,!0),s+=4),a&16&&(o=n.getUint32(s,!0),s+=4);var f;switch(t[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:e[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return f}function k5(t,e){var r=new Uint8Array(32),n=og(r),a=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,e9e(r,a,t.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,t.v?1:0,!0),s|=2,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(a,e.indexOf(t.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,a)}function F5(t,e){var r=new Uint8Array(32),n=og(r),a=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(a,t.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,t.v?1:0,!0),s|=32,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(a,e.indexOf(t.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,a)}function a9e(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return r9e(t,e,r,t[0]);case 5:return n9e(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Bl(t){var e=ua(t);return F2(e[1][0].data)}function L$(t,e){var r=ua(e.data),n=di(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(o){var l=ua(o.data),c=di(l[1][0].data)>>>0;switch(n){case 1:s[c]=tF(l[3][0].data);break;case 8:{var u=t[Bl(l[9][0].data)][0],d=ua(u.data),f=t[Bl(d[1][0].data)][0],A=di(f.meta[1][0].data);if(A!=2001)throw new Error("2000 unexpected reference to ".concat(A));var h=ua(f.data);s[c]=h[3].map(function(m){return tF(m.data)}).join("")}break}}),s}function s9e(t,e){var r,n,a,s,o,l,c,u,d,f,A,h,m,p,g=ua(t),v=di(g[1][0].data)>>>0,y=di(g[2][0].data)>>>0,b=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&di(g[8][0].data)>0||!1,w,j;if((s=(a=g[7])==null?void 0:a[0])!=null&&s.data&&e!=0)w=(l=(o=g[7])==null?void 0:o[0])==null?void 0:l.data,j=(u=(c=g[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=g[4])==null?void 0:d[0])!=null&&f.data&&e!=1)w=(h=(A=g[4])==null?void 0:A[0])==null?void 0:h.data,j=(p=(m=g[3])==null?void 0:m[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var I=b?4:1,_=og(w),S=[],E=0;E<w.length/2;++E){var F=_.getUint16(E*2,!0);F<65535&&S.push([E,F])}if(S.length!=y)throw"Expected ".concat(y," cells, found ").concat(S.length);var k=[];for(E=0;E<S.length-1;++E)k[S[E][0]]=j.subarray(S[E][1]*I,S[E+1][1]*I);return S.length>=1&&(k[S[S.length-1][0]]=j.subarray(S[S.length-1][1]*I)),{R:v,cells:k}}function i9e(t,e){var r,n=ua(e.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?di(n[7][0].data)>>>0>0?1:0:-1,s=xR(n[5],function(o){return s9e(o,a)});return{nrows:di(n[4][0].data)>>>0,data:s.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=c}),o},[])}}function o9e(t,e,r){var n,a=ua(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(di(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(di(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Sn(s);var o=ua(a[4][0].data),l=L$(t,t[Bl(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?L$(t,t[Bl(o[17][0].data)][0]):[],u=ua(o[3][0].data),d=0;u[1].forEach(function(f){var A=ua(f.data),h=t[Bl(A[2][0].data)][0],m=di(h.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var p=i9e(t,h);p.data.forEach(function(g,v){g.forEach(function(y,b){var w=hn({r:d+v,c:b}),j=a9e(y,l,c);j&&(r[w]=j)})}),d+=p.nrows})}function l9e(t,e){var r=ua(e.data),n={"!ref":"A1"},a=t[Bl(r[2][0].data)],s=di(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return o9e(t,a[0],n),n}function c9e(t,e){var r,n=ua(e.data),a={name:(r=n[1])!=null&&r[0]?tF(n[1][0].data):"",sheets:[]},s=xR(n[2],Bl);return s.forEach(function(o){t[o].forEach(function(l){var c=di(l.meta[1][0].data);c==6e3&&a.sheets.push(l9e(t,l))})}),a}function u9e(t,e){var r=NR(),n=ua(e.data),a=xR(n[1],Bl);if(a.forEach(function(s){t[s].forEach(function(o){var l=di(o.meta[1][0].data);if(l==2){var c=c9e(t,o);c.sheets.forEach(function(u,d){CR(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function O5(t){var e,r,n,a,s={},o=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=Gu(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=$u(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){s[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((a=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&di(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||o.forEach(function(c){s[c].forEach(function(u){var d=di(u.meta[1][0].data)>>>0;if(d==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return u9e(s,l)}function d9e(t,e,r){var n,a,s,o;if(!((n=t[6])!=null&&n[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(s=t[8])==null?void 0:s[0])==null?void 0:o.data)&&di(t[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=og(t[7][0].data),d=0,f=[],A=og(t[4][0].data),h=0,m=[],p=0;p<e.length;++p){if(e[p]==null){u.setUint16(p*2,65535,!0),A.setUint16(p*2,65535);continue}u.setUint16(p*2,d,!0),A.setUint16(p*2,h,!0);var g,v;switch(typeof e[p]){case"string":g=k5({t:"s",v:e[p]},r),v=F5({t:"s",v:e[p]},r);break;case"number":g=k5({t:"n",v:e[p]},r),v=F5({t:"n",v:e[p]},r);break;case"boolean":g=k5({t:"b",v:e[p]},r),v=F5({t:"b",v:e[p]},r);break;default:throw new Error("Unsupported value "+e[p])}f.push(g),d+=g.length,m.push(v),h+=v.length,++c}for(t[2][0].data=Ba(c);p<t[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),A.setUint16(p*2,65535,!0);return t[6][0].data=pm(f),t[3][0].data=pm(m),c}function f9e(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Lc(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Sn(n)));var s=KS(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(G){return G.forEach(function(z){typeof z=="string"&&o.push(z)})});var l={},c=[],u=nn.read(e.numbers,{type:"base64"});u.FileIndex.map(function(G,z){return[G,u.FullPaths[z]]}).forEach(function(G){var z=G[0],L=G[1];if(z.type==2&&z.name.match(/\.iwa/)){var Z=z.content,ee=Gu(Z),R=$u(ee);R.forEach(function(H){c.push(H.id),l[H.id]={deps:[],location:L,type:di(H.messages[0].meta[1][0].data)}})}}),c.sort(function(G,z){return G-z});var d=c.filter(function(G){return G>1}).map(function(G){return[G,Ba(G)]});u.FileIndex.map(function(G,z){return[G,u.FullPaths[z]]}).forEach(function(G){var z=G[0];if(G[1],!!z.name.match(/\.iwa/)){var L=$u(Gu(z.content));L.forEach(function(Z){Z.messages.forEach(function(ee){d.forEach(function(R){Z.messages.some(function(H){return di(H.meta[1][0].data)!=11006&&J7e(H.data,R[1])})&&l[R[0]].deps.push(Z.id)})})})}});for(var f=nn.find(u,l[1].location),A=$u(Gu(f.content)),h,m=0;m<A.length;++m){var p=A[m];p.id==1&&(h=p)}var g=Bl(ua(h.messages[0].data)[1][0].data);for(f=nn.find(u,l[g].location),A=$u(Gu(f.content)),m=0;m<A.length;++m)p=A[m],p.id==g&&(h=p);for(g=Bl(ua(h.messages[0].data)[2][0].data),f=nn.find(u,l[g].location),A=$u(Gu(f.content)),m=0;m<A.length;++m)p=A[m],p.id==g&&(h=p);for(g=Bl(ua(h.messages[0].data)[2][0].data),f=nn.find(u,l[g].location),A=$u(Gu(f.content)),m=0;m<A.length;++m)p=A[m],p.id==g&&(h=p);var v=ua(h.messages[0].data);{v[6][0].data=Ba(n.e.r+1),v[7][0].data=Ba(n.e.c+1);var y=Bl(v[46][0].data),b=nn.find(u,l[y].location),w=$u(Gu(b.content));{for(var j=0;j<w.length&&w[j].id!=y;++j);if(w[j].id!=y)throw"Bad ColumnRowUIDMapArchive";var I=ua(w[j].messages[0].data);I[1]=[],I[2]=[],I[3]=[];for(var _=0;_<=n.e.c;++_){var S=[];S[1]=S[2]=[{type:0,data:Ba(_+420690)}],I[1].push({type:2,data:Jo(S)}),I[2].push({type:0,data:Ba(_)}),I[3].push({type:0,data:Ba(_)})}I[4]=[],I[5]=[],I[6]=[];for(var E=0;E<=n.e.r;++E)S=[],S[1]=S[2]=[{type:0,data:Ba(E+726270)}],I[4].push({type:2,data:Jo(S)}),I[5].push({type:0,data:Ba(E)}),I[6].push({type:0,data:Ba(E)});w[j].messages[0].data=Jo(I)}b.content=dx(ux(w)),b.size=b.content.length,delete v[46];var F=ua(v[4][0].data);{F[7][0].data=Ba(n.e.r+1);var k=ua(F[1][0].data),P=Bl(k[2][0].data);b=nn.find(u,l[P].location),w=$u(Gu(b.content));{if(w[0].id!=P)throw"Bad HeaderStorageBucket";var D=ua(w[0].messages[0].data);for(E=0;E<s.length;++E){var X=ua(D[2][0].data);X[1][0].data=Ba(E),X[4][0].data=Ba(s[E].length),D[2][E]={type:D[2][0].type,data:Jo(X)}}w[0].messages[0].data=Jo(D)}b.content=dx(ux(w)),b.size=b.content.length;var pe=Bl(F[2][0].data);b=nn.find(u,l[pe].location),w=$u(Gu(b.content));{if(w[0].id!=pe)throw"Bad HeaderStorageBucket";for(D=ua(w[0].messages[0].data),_=0;_<=n.e.c;++_)X=ua(D[2][0].data),X[1][0].data=Ba(_),X[4][0].data=Ba(n.e.r+1),D[2][_]={type:D[2][0].type,data:Jo(X)};w[0].messages[0].data=Jo(D)}b.content=dx(ux(w)),b.size=b.content.length;var ge=Bl(F[4][0].data);(function(){for(var G=nn.find(u,l[ge].location),z=$u(Gu(G.content)),L,Z=0;Z<z.length;++Z){var ee=z[Z];ee.id==ge&&(L=ee)}var R=ua(L.messages[0].data);{R[3]=[];var H=[];o.forEach(function(U,He){H[1]=[{type:0,data:Ba(He)}],H[2]=[{type:0,data:Ba(1)}],H[3]=[{type:2,data:Y7e(U)}],R[3].push({type:2,data:Jo(H)})})}L.messages[0].data=Jo(R);var ne=ux(z),ve=dx(ne);G.content=ve,G.size=G.content.length})();var fe=ua(F[3][0].data);{var xe=fe[1][0];delete fe[2];var ae=ua(xe.data);{var Se=Bl(ae[2][0].data);(function(){for(var G=nn.find(u,l[Se].location),z=$u(Gu(G.content)),L,Z=0;Z<z.length;++Z){var ee=z[Z];ee.id==Se&&(L=ee)}var R=ua(L.messages[0].data);{delete R[6],delete fe[7];var H=new Uint8Array(R[5][0].data);R[5]=[];for(var ne=0,ve=0;ve<=n.e.r;++ve){var U=ua(H);ne+=d9e(U,s[ve],o),U[1][0].data=Ba(ve),R[5].push({data:Jo(U),type:2})}R[1]=[{type:0,data:Ba(n.e.c+1)}],R[2]=[{type:0,data:Ba(n.e.r+1)}],R[3]=[{type:0,data:Ba(ne)}],R[4]=[{type:0,data:Ba(n.e.r+1)}]}L.messages[0].data=Jo(R);var He=ux(z),se=dx(He);G.content=se,G.size=G.content.length})()}xe.data=Jo(ae)}F[3][0].data=Jo(fe)}v[4][0].data=Jo(F)}h.messages[0].data=Jo(v);var Te=ux(A),O=dx(Te);return f.content=O,f.size=f.content.length,u}function cse(t){return function(r){for(var n=0;n!=t.length;++n){var a=t[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function vR(t){cse([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function yR(t){cse([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function h9e(t){return $n.WS.indexOf(t)>-1?"sheet":t==$n.CS?"chart":t==$n.DS?"dialog":t==$n.MS?"macro":t&&t.length?t:"sheet"}function A9e(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,h9e(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function m9e(t,e,r,n,a,s,o,l,c,u,d,f){try{s[n]=Eb(cu(t,r,!0),e);var A=Ri(t,e),h;switch(l){case"sheet":h=RUe(A,e,a,c,s[n],u,d,f);break;case"chart":if(h=MUe(A,e,a,c,s[n],u,d,f),!h||!h["!drawel"])break;var m=Gy(h["!drawel"].Target,e),p=I2(m),g=CRe(cu(t,m,!0),Eb(cu(t,p,!0),m)),v=Gy(g,m),y=I2(v);h=dUe(cu(t,v,!0),v,c,Eb(cu(t,y,!0),v),u,h);break;case"macro":h=LUe(A,e,a,c,s[n],u,d,f);break;case"dialog":h=UUe(A,e,a,c,s[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=h;var b=[];s&&s[n]&&hi(s[n]).forEach(function(w){var j="";if(s[n][w].Type==$n.CMNT){j=Gy(s[n][w].Target,e);var I=$Ue(Ri(t,j,!0),j,c);if(!I||!I.length)return;C$(h,I,!1)}s[n][w].Type==$n.TCMNT&&(j=Gy(s[n][w].Target,e),b=b.concat(ERe(Ri(t,j,!0),c)))}),b&&b.length&&C$(h,b,!0,c.people||[])}catch(w){if(c.WTF)throw w}}function Lu(t){return t.charAt(0)=="/"?t.slice(1):t}function p9e(t,e){if(h1(),e=e||{},vR(e),Xu(t,"META-INF/manifest.xml")||Xu(t,"objectdata.xml"))return O$(t,e);if(Xu(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof O5<"u"){if(t.FileIndex)return O5(t);var r=nn.utils.cfb_new();return GH(t).forEach(function(X){kn(r,X,Ske(t,X))}),O5(r)}throw new Error("Unsupported NUMBERS file")}if(!Xu(t,"[Content_Types].xml"))throw Xu(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Xu(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=GH(t),a=yFe(cu(t,"[Content_Types].xml")),s=!1,o,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",Ri(t,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!Ri(t,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},u={};if(!e.bookSheets&&!e.bookProps){if(Sb=[],a.sst)try{Sb=HUe(Ri(t,Lu(a.sst)),a.sst,e)}catch(X){if(e.WTF)throw X}e.cellStyles&&a.themes.length&&(c=VUe(cu(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(u=QUe(Ri(t,Lu(a.style)),a.style,c,e))}a.links.map(function(X){try{var pe=Eb(cu(t,I2(Lu(X))),X);return KUe(Ri(t,Lu(X)),pe,X,e)}catch{}});var d=DUe(Ri(t,Lu(a.workbooks[0])),a.workbooks[0],e),f={},A="";a.coreprops.length&&(A=Ri(t,Lu(a.coreprops[0]),!0),A&&(f=Yne(A)),a.extprops.length!==0&&(A=Ri(t,Lu(a.extprops[0]),!0),A&&SFe(A,f,e)));var h={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(A=cu(t,Lu(a.custprops[0]),!0),A&&(h=jFe(A,e)));var m={};if((e.bookSheets||e.bookProps)&&(d.Sheets?o=d.Sheets.map(function(pe){return pe.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),e.bookProps&&(m.Props=f,m.Custprops=h),e.bookSheets&&typeof o<"u"&&(m.SheetNames=o),e.bookSheets?m.SheetNames:e.bookProps))return m;o={};var p={};e.bookDeps&&a.calcchain&&(p=GUe(Ri(t,Lu(a.calcchain)),a.calcchain));var g=0,v={},y,b;{var w=d.Sheets;f.Worksheets=w.length,f.SheetNames=[];for(var j=0;j!=w.length;++j)f.SheetNames[j]=w[j].name}var I=s?"bin":"xml",_=a.workbooks[0].lastIndexOf("/"),S=(a.workbooks[0].slice(0,_+1)+"_rels/"+a.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");Xu(t,S)||(S="xl/_rels/workbook."+I+".rels");var E=Eb(cu(t,S,!0),S.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=qUe(Ri(t,Lu(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=IRe(Ri(t,Lu(a.people[0])),e)),E&&(E=A9e(E,d.Sheets));var F=Ri(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var k="sheet";if(E&&E[g]?(y="xl/"+E[g][1].replace(/[\/]?xl\//,""),Xu(t,y)||(y=E[g][1]),Xu(t,y)||(y=S.replace(/_rels\/.*$/,"")+E[g][1]),k=E[g][2]):(y="xl/worksheets/sheet"+(g+1-F)+"."+I,y=y.replace(/sheet0\./,"sheet.")),b=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(g!=e.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var P=!1,D=0;D!=e.sheets.length;++D)typeof e.sheets[D]=="number"&&e.sheets[D]==g&&(P=1),typeof e.sheets[D]=="string"&&e.sheets[D].toLowerCase()==f.SheetNames[g].toLowerCase()&&(P=1);if(!P)continue e}}m9e(t,y,b,f.SheetNames[g],g,v,o,k,e,d,c,u)}return m={Directory:a,Workbook:d,Props:f,Custprops:h,Deps:p,Sheets:o,SheetNames:f.SheetNames,Strings:Sb,Styles:u,Themes:c,SSF:xs(fn)},e&&e.bookFiles&&(t.files?(m.keys=n,m.files=t.files):(m.keys=[],m.files={},t.FullPaths.forEach(function(X,pe){X=X.replace(/^Root Entry[\/]/,""),m.keys.push(X),m.files[X]=t.FileIndex[pe]}))),e&&e.bookVBA&&(a.vba.length>0?m.vbaraw=Ri(t,Lu(a.vba[0]),!0):a.defaults&&a.defaults.bin===DRe&&(m.vbaraw=Ri(t,"xl/vbaProject.bin",!0))),m}function g9e(t,e){var r=e||{},n="Workbook",a=nn.find(t,n);try{if(n="/!DataSpaces/Version",a=nn.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(qDe(a.content),n="/!DataSpaces/DataSpaceMap",a=nn.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=WDe(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=nn.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=XDe(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=nn.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);JDe(a.content)}catch{}if(n="/EncryptionInfo",a=nn.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=ZDe(a.content);if(n="/EncryptedPackage",a=nn.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function x9e(t,e){return e.bookType=="ods"?lse(t,e):e.bookType=="numbers"?f9e(t,e):e.bookType=="xlsb"?v9e(t,e):y9e(t,e)}function v9e(t,e){Kx=1024,t&&!t.SSF&&(t.SSF=xs(fn)),t&&t.SSF&&(h1(),Jj(t.SSF),e.revssf=eP(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Ib?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=Dae.indexOf(e.bookType)>-1,a=sR();yR(e=e||{});var s=G6(),o="",l=0;if(e.cellXfs=[],Im(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",kn(s,o,Jne(t.Props,e)),a.coreprops.push(o),ka(e.rels,2,o,$n.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(t.SheetNames[u]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,kn(s,o,tae(t.Props)),a.extprops.push(o),ka(e.rels,3,o,$n.EXT_PROPS),t.Custprops!==t.Props&&hi(t.Custprops||{}).length>0&&(o="docProps/custom.xml",kn(s,o,rae(t.Custprops)),a.custprops.push(o),ka(e.rels,4,o,$n.CUST_PROPS)),l=1;l<=t.SheetNames.length;++l){var d={"!id":{}},f=t.Sheets[t.SheetNames[l-1]],A=(f||{})["!type"]||"sheet";switch(A){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,kn(s,o,WUe(l-1,o,e,t,d)),a.sheets.push(o),ka(e.wbrels,-1,"worksheets/sheet"+l+"."+r,$n.WS[0])}if(f){var h=f["!comments"],m=!1,p="";h&&h.length>0&&(p="xl/comments"+l+"."+r,kn(s,p,JUe(h,p)),a.comments.push(p),ka(d,-1,"../comments"+l+"."+r,$n.CMNT),m=!0),f["!legacy"]&&m&&kn(s,"xl/drawings/vmlDrawing"+l+".vml",Fae(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&kn(s,I2(o),cv(d))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,kn(s,o,YUe(e.Strings,o,e)),a.strs.push(o),ka(e.wbrels,-1,"sharedStrings."+r,$n.SST)),o="xl/workbook."+r,kn(s,o,zUe(t,o)),a.workbooks.push(o),ka(e.rels,1,o,$n.WB),o="xl/theme/theme1.xml",kn(s,o,dR(t.Themes,e)),a.themes.push(o),ka(e.wbrels,-1,"theme/theme1.xml",$n.THEME),o="xl/styles."+r,kn(s,o,XUe(t,o,e)),a.styles.push(o),ka(e.wbrels,-1,"styles."+r,$n.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",kn(s,o,t.vbaraw),a.vba.push(o),ka(e.wbrels,-1,"vbaProject.bin",$n.VBA)),o="xl/metadata."+r,kn(s,o,ZUe(o)),a.metadata.push(o),ka(e.wbrels,-1,"metadata."+r,$n.XLMETA),kn(s,"[Content_Types].xml",Wne(a,e)),kn(s,"_rels/.rels",cv(e.rels)),kn(s,"xl/_rels/workbook."+r+".rels",cv(e.wbrels)),delete e.revssf,delete e.ssf,s}function y9e(t,e){Kx=1024,t&&!t.SSF&&(t.SSF=xs(fn)),t&&t.SSF&&(h1(),Jj(t.SSF),e.revssf=eP(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Ib?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=Dae.indexOf(e.bookType)>-1,a=sR();yR(e=e||{});var s=G6(),o="",l=0;if(e.cellXfs=[],Im(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",kn(s,o,Jne(t.Props,e)),a.coreprops.push(o),ka(e.rels,2,o,$n.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(t.SheetNames[u]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,kn(s,o,tae(t.Props)),a.extprops.push(o),ka(e.rels,3,o,$n.EXT_PROPS),t.Custprops!==t.Props&&hi(t.Custprops||{}).length>0&&(o="docProps/custom.xml",kn(s,o,rae(t.Custprops)),a.custprops.push(o),ka(e.rels,4,o,$n.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,l=1;l<=t.SheetNames.length;++l){var f={"!id":{}},A=t.Sheets[t.SheetNames[l-1]],h=(A||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,kn(s,o,qae(l-1,e,t,f)),a.sheets.push(o),ka(e.wbrels,-1,"worksheets/sheet"+l+"."+r,$n.WS[0])}if(A){var m=A["!comments"],p=!1,g="";if(m&&m.length>0){var v=!1;m.forEach(function(y){y[1].forEach(function(b){b.T==!0&&(v=!0)})}),v&&(g="xl/threadedComments/threadedComment"+l+"."+r,kn(s,g,SRe(m,d,e)),a.threadedcomments.push(g),ka(f,-1,"../threadedComments/threadedComment"+l+"."+r,$n.TCMNT)),g="xl/comments"+l+"."+r,kn(s,g,Oae(m)),a.comments.push(g),ka(f,-1,"../comments"+l+"."+r,$n.CMNT),p=!0}A["!legacy"]&&p&&kn(s,"xl/drawings/vmlDrawing"+l+".vml",Fae(l,A["!comments"])),delete A["!comments"],delete A["!legacy"]}f["!id"].rId1&&kn(s,I2(o),cv(f))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,kn(s,o,wae(e.Strings,e)),a.strs.push(o),ka(e.wbrels,-1,"sharedStrings."+r,$n.SST)),o="xl/workbook."+r,kn(s,o,Jae(t)),a.workbooks.push(o),ka(e.rels,1,o,$n.WB),o="xl/theme/theme1.xml",kn(s,o,dR(t.Themes,e)),a.themes.push(o),ka(e.wbrels,-1,"theme/theme1.xml",$n.THEME),o="xl/styles."+r,kn(s,o,Pae(t,e)),a.styles.push(o),ka(e.wbrels,-1,"styles."+r,$n.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",kn(s,o,t.vbaraw),a.vba.push(o),ka(e.wbrels,-1,"vbaProject.bin",$n.VBA)),o="xl/metadata."+r,kn(s,o,kae()),a.metadata.push(o),ka(e.wbrels,-1,"metadata."+r,$n.XLMETA),d.length>1&&(o="xl/persons/person.xml",kn(s,o,jRe(d)),a.people.push(o),ka(e.wbrels,-1,"persons/person.xml",$n.PEOPLE)),kn(s,"[Content_Types].xml",Wne(a,e)),kn(s,"_rels/.rels",cv(e.rels)),kn(s,"xl/_rels/workbook."+r+".rels",cv(e.wbrels)),delete e.revssf,delete e.ssf,s}function bR(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=bu(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function b9e(t,e){return nn.find(t,"EncryptedPackage")?g9e(t,e):rse(t,e)}function w9e(t,e){var r,n=t,a=e||{};return a.type||(a.type=Rn&&Buffer.isBuffer(t)?"buffer":"base64"),r=Cne(n,a),p9e(r,a)}function use(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Zk(t.slice(r),e);default:break e}return Fv.to_workbook(t,e)}function N9e(t,e){var r="",n=bR(t,e);switch(e.type){case"base64":r=bu(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=ng(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Ga(r)),e.type="binary",use(r,e)}function C9e(t,e){var r=t;return e.type=="base64"&&(r=bu(r)),r=w2.utils.decode(1200,r.slice(2),"str"),e.type="binary",use(r,e)}function _9e(t){return t.match(/[^\x00-\x7F]/)?Mf(t):t}function D5(t,e,r,n){return n?(r.type="string",Fv.to_workbook(t,r)):Fv.to_workbook(e,r)}function O2(t,e){U6();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return O2(new Uint8Array(t),(r=xs(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),dv={},r.dateNF&&(dv.dateNF=r.dateNF),r.type||(r.type=Rn&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Rn?"buffer":"binary",n=vke(t),typeof Uint8Array<"u"&&!Rn&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=_9e(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=xs(r),r.type="array",O2(Q6(n),r)}switch((a=bR(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return b9e(nn.read(n,r),r);break;case 9:if(a[1]<=8)return rse(n,r);break;case 60:return Zk(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return PDe(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return yae.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?w9e(n,r):D5(t,n,r,s);case 239:return a[3]===60?Zk(n,r):D5(t,n,r,s);case 255:if(a[1]===254)return C9e(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return kp.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return kp.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Jk.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Sae.to_workbook(n,r);break;case 10:case 13:case 32:return N9e(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return jDe.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Jk.to_workbook(n,r):D5(t,n,r,s)}function dse(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Pw(e.file,nn.write(t,{type:Rn?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return nn.write(t,e)}function E9e(t,e){var r=xs(e||{}),n=x9e(t,r);return S9e(n,r)}function S9e(t,e){var r={},n=Rn?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var a=t.FullPaths?nn.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(Yj(a))}return e.password&&typeof encrypt_agile<"u"?dse(encrypt_agile(a,e.password),e):e.type==="file"?Pw(e.file,a):e.type=="string"?Ga(a):a}function I9e(t,e){var r=e||{},n=_7e(t,r);return dse(n,r)}function If(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return N2(Mf(n));case"binary":return Mf(n);case"string":return t;case"file":return Pw(e.file,n,"utf8");case"buffer":return Rn?wA(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):If(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function j9e(t,e){switch(e.type){case"base64":return N2(t);case"binary":return t;case"string":return t;case"file":return Pw(e.file,t,"binary");case"buffer":return Rn?wA(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function ZC(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?N2(r):e.type=="string"?Ga(r):r;case"file":return Pw(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function iP(t,e){U6(),bUe(t);var r=xs(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=iP(t,r);return r.type="array",Yj(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=t.SheetNames.indexOf(r.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return If(x7e(t,r),r);case"slk":case"sylk":return If(vae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"htm":case"html":return If(ase(t.Sheets[t.SheetNames[a]],r),r);case"txt":return j9e(fse(t.Sheets[t.SheetNames[a]],r),r);case"csv":return If(wR(t.Sheets[t.SheetNames[a]],r),r,"\uFEFF");case"dif":return If(yae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"dbf":return ZC(Jk.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"prn":return If(Fv.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"rtf":return If(Sae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"eth":return If(bae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"fods":return If(lse(t,r),r);case"wk1":return ZC(kp.sheet_to_wk1(t.Sheets[t.SheetNames[a]],r),r);case"wk3":return ZC(kp.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ZC(nse(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),I9e(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return E9e(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function P9e(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function rF(t,e,r){var n={};return n.type="file",n.file=e,P9e(n),iP(t,n)}function B9e(t,e,r,n,a,s,o,l){var c=Bi(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,A=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(A,"__rowNum__",{value:r,enumerable:!1})}catch{A.__rowNum__=r}else A.__rowNum__=r;if(!o||t[r])for(var h=e.s.c;h<=e.e.c;++h){var m=o?t[r][h]:t[n[h]+c];if(m===void 0||m.t===void 0){if(u===void 0)continue;s[h]!=null&&(A[s[h]]=u);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[h]!=null){if(p==null)if(m.t=="e"&&p===null)A[s[h]]=null;else if(u!==void 0)A[s[h]]=u;else if(d&&p===null)A[s[h]]=null;else continue;else A[s[h]]=d&&(m.t!=="n"||m.t==="n"&&l.rawNumbers!==!1)?p:oA(m,p,l);p!=null&&(f=!1)}}return{row:A,isempty:f}}function KS(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},d=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=oa(d);break;case"number":c=oa(t["!ref"]),c.s.r=d;break;default:c=d}n>0&&(a=0);var f=Bi(c.s.r),A=[],h=[],m=0,p=0,g=Array.isArray(t),v=c.s.r,y=0,b={};g&&!t[v]&&(t[v]=[]);var w=u.skipHidden&&t["!cols"]||[],j=u.skipHidden&&t["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(w[y]||{}).hidden)switch(A[y]=qs(y),r=g?t[v][y]:t[A[y]+f],n){case 1:s[y]=y-c.s.c;break;case 2:s[y]=A[y];break;case 3:s[y]=u.header[y-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=oA(r,null,u),p=b[o]||0,!p)b[o]=1;else{do l=o+"_"+p++;while(b[l]);b[o]=p,b[l]=1}s[y]=l}for(v=c.s.r+a;v<=c.e.r;++v)if(!(j[v]||{}).hidden){var I=B9e(t,c,v,A,n,s,g,u);(I.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(h[m++]=I.row)}return h.length=m,h}var U$=/"/g;function T9e(t,e,r,n,a,s,o,l){for(var c=!0,u=[],d="",f=Bi(r),A=e.s.c;A<=e.e.c;++A)if(n[A]){var h=l.dense?(t[r]||[])[A]:t[n[A]+f];if(h==null)d="";else if(h.v!=null){c=!1,d=""+(l.rawNumbers&&h.t=="n"?h.v:oA(h,null,l));for(var m=0,p=0;m!==d.length;++m)if((p=d.charCodeAt(m))===a||p===s||p===34||l.forceQuotes){d='"'+d.replace(U$,'""')+'"';break}d=="ID"&&(d='"ID"')}else h.f!=null&&!h.F?(c=!1,d="="+h.f,d.indexOf(",")>=0&&(d='"'+d.replace(U$,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(o)}function wR(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var a=oa(t["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];n.dense=Array.isArray(t);for(var A=n.skipHidden&&t["!cols"]||[],h=n.skipHidden&&t["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(A[m]||{}).hidden||(f[m]=qs(m));for(var p=0,g=a.s.r;g<=a.e.r;++g)(h[g]||{}).hidden||(d=T9e(t,a,g,f,o,c,s,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((p++?l:"")+d)));return delete n.dense,r.join("")}function fse(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=wR(t,e);return r}function k9e(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var a=oa(t["!ref"]),s="",o=[],l,c=[],u=Array.isArray(t);for(l=a.s.c;l<=a.e.c;++l)o[l]=qs(l);for(var d=a.s.r;d<=a.e.r;++d)for(s=Bi(d),l=a.s.c;l<=a.e.c;++l)if(e=o[l]+s,r=u?(t[d]||[])[l]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function hse(t,e,r){var n=r||{},a=+!n.skipHeader,s=t||{},o=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?zs(n.origin):n.origin;o=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:o+e.length-1+a}};if(s["!ref"]){var f=oa(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+e.length-1+a)}else o==-1&&(o=0,d.e.r=e.length-1+a);var A=n.header||[],h=0;e.forEach(function(p,g){hi(p).forEach(function(v){(h=A.indexOf(v))==-1&&(A[h=A.length]=v);var y=p[v],b="z",w="",j=hn({c:l+h,r:o+g+a});u=D2(s,j),y&&typeof y=="object"&&!(y instanceof Date)?s[j]=y:(typeof y=="number"?b="n":typeof y=="boolean"?b="b":typeof y=="string"?b="s":y instanceof Date?(b="d",n.cellDates||(b="n",y=mo(y)),w=n.dateNF||fn[14]):y===null&&n.nullError&&(b="e",y=0),u?(u.t=b,u.v=y,delete u.w,delete u.R,w&&(u.z=w)):s[j]=u={t:b,v:y},w&&(u.z=w))})}),d.e.c=Math.max(d.e.c,l+A.length-1);var m=Bi(o);if(a)for(h=0;h<A.length;++h)s[qs(h+l)+m]={t:"s",v:A[h]};return s["!ref"]=Sn(d),s}function F9e(t,e){return hse(null,t,e)}function D2(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=zs(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?D2(t,hn(e)):D2(t,hn({r:e,c:r||0}))}function O9e(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function NR(){return{SheetNames:[],Sheets:{}}}function CR(t,e,r,n){var a=1;if(!r)for(;a<=65535&&t.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var o=s&&s[1]||r;for(++a;a<=65535&&t.SheetNames.indexOf(r=o+a)!=-1;++a);}if(Yae(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function D9e(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=O9e(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function R9e(t,e){return t.z=e,t}function Ase(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function M9e(t,e,r){return Ase(t,"#"+e,r)}function L9e(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function U9e(t,e,r,n){for(var a=typeof e!="string"?e:oa(e),s=typeof e=="string"?e:Sn(e),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l){var c=D2(t,o,l);c.t="n",c.F=s,delete c.v,o==a.s.r&&l==a.s.c&&(c.f=r,n&&(c.D=!0))}return t}var $s={encode_col:qs,encode_row:Bi,encode_cell:hn,encode_range:Sn,decode_col:Z6,decode_row:J6,split_cell:Yke,decode_cell:zs,decode_range:Lc,format_cell:oA,sheet_add_aoa:Vne,sheet_add_json:hse,sheet_add_dom:sse,aoa_to_sheet:A1,json_to_sheet:F9e,table_to_sheet:ise,table_to_book:q7e,sheet_to_csv:wR,sheet_to_txt:fse,sheet_to_json:KS,sheet_to_html:ase,sheet_to_formulae:k9e,sheet_to_row_object_array:KS,sheet_get_cell:D2,book_new:NR,book_append_sheet:CR,book_set_sheet_visibility:D9e,cell_set_number_format:R9e,cell_set_hyperlink:Ase,cell_set_internal_link:M9e,cell_add_comment:L9e,sheet_set_array_formula:U9e,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const R5=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Ha(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function Nh(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function i0(t,e=1){const r=Math.floor(Nh(t,e));return r>0?r:e}function Q9e(t){return Object.values(t||{}).every(r=>Ha(r)==="")}function Hm(t,e){const r=Object.keys(t||{}),n=new Map;r.forEach(a=>n.set(Ha(a),a));for(const a of e){const s=n.get(Ha(a));if(s!=null)return t[s]}}function V9e({open:t,code:e,onClose:r}){return t?i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-sm rounded-2xl shadow-lg border p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{className:"font-bold text-lg",children:"Cdigo de barras"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:r,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-3",children:[i.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Valor"}),i.jsx("div",{className:"text-xl font-mono font-semibold break-all",children:e})]}),i.jsx("div",{className:"mt-3 flex gap-2 justify-end",children:i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",type:"button",onClick:()=>{var n;try{(n=navigator.clipboard)==null||n.writeText(e)}catch{}},children:"Copiar"})})]})}):null}function H9e({open:t,onClose:e,onDetected:r}){const n=x.useRef(null),a=x.useRef(null),[s,o]=x.useState(""),l=x.useRef("");return x.useEffect(()=>{if(!t)return;let c=!1;const u=new b2,d=()=>{var A,h,m;try{(A=a.current)==null||A.stop()}catch{}a.current=null;try{const p=(h=n.current)==null?void 0:h.srcObject;(m=p==null?void 0:p.getTracks)==null||m.call(p).forEach(g=>g.stop())}catch{}try{n.current&&(n.current.srcObject=null)}catch{}};return(async()=>{o("");try{if(!n.current)return;try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1})).getTracks().forEach(m=>m.stop())}catch{}const A=await u.decodeFromConstraints({video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1},n.current,h=>{if(!c&&h){const m=String(h.getText()||"").trim().replace(/\s+/g,"");if(!m||m===l.current)return;l.current=m,d(),r(m),e()}});a.current=A}catch(A){const h=String((A==null?void 0:A.message)||""),m=String((A==null?void 0:A.name)||"");h.toLowerCase().includes("permission")||m==="NotAllowedError"?o("Permiso de cmara denegado."):m==="NotFoundError"||h.toLowerCase().includes("notfound")?o("No se encontr cmara en este dispositivo."):h.toLowerCase().includes("secure")||h.toLowerCase().includes("https")?o("La cmara requiere HTTPS (sitio seguro)."):o(h||"No se pudo iniciar el escner.")}})(),()=>{c=!0,d()}},[t,e,r]),t?i.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 p-3 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-lg border overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[i.jsx("div",{className:"font-bold",children:"Escanear cdigo"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:e,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"relative w-full aspect-[3/4] bg-black rounded-xl overflow-hidden",children:[i.jsx("video",{ref:n,className:"w-full h-full object-cover",muted:!0,playsInline:!0,autoPlay:!0}),i.jsx("div",{className:"absolute inset-0 pointer-events-none",children:i.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[85%] h-40 border-2 border-white/70 rounded-xl"})})]}),s&&i.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded p-2",children:s}),i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Apunt al cdigo de barras y mantenelo estable."})]})]})}):null}function $9e(){const{refreshKey:t,refresh:e}=gc(),[r,n]=x.useState(!0),[a,s]=x.useState(""),[o,l]=x.useState([]),[c,u]=x.useState(""),[d,f]=x.useState(""),[A,h]=x.useState(0),[m,p]=x.useState(1),[g,v]=x.useState(""),[y,b]=x.useState(""),[w,j]=x.useState(null),[I,_]=x.useState(""),[S,E]=x.useState(""),[F,k]=x.useState(0),[P,D]=x.useState(1),[X,pe]=x.useState(""),[ge,fe]=x.useState(""),[xe,ae]=x.useState(""),[Se,Te]=x.useState(""),[O,G]=x.useState(""),[z,L]=x.useState(!1),[Z,ee]=x.useState(""),[R,H]=x.useState(!1),[ne,ve]=x.useState("create"),[U,He]=x.useState(!1),[se,re]=x.useState(""),[Pe,ue]=x.useState([]),[we,Me]=x.useState([]),[ze,yt]=x.useState(!1),[It,Ke]=x.useState(!1);x.useEffect(()=>{var st;const Xe=window.matchMedia("(max-width: 900px)"),be=()=>Ke(Xe.matches);return be(),(st=Xe.addEventListener)==null||st.call(Xe,"change",be),()=>{var K;return(K=Xe.removeEventListener)==null?void 0:K.call(Xe,"change",be)}},[]);const[wt,At]=x.useState(!0),[bt,ke]=x.useState(!0);x.useEffect(()=>{It?(At(!1),ke(!1)):(At(!0),ke(!0))},[It]);const[Ne,Ve]=x.useState(null),he=x.useRef(!1),le=x.useRef(null);x.useEffect(()=>{n(!0),s("");const Xe=_t(Fe,"products_candies"),be=er(Xe,dn("name","asc")),st=cd(be,K=>{const Ie=[],Ze={};K.forEach(T=>{const M=T.data(),V=String(M.barcode||"").trim()||void 0;V&&(Ze[T.id]=V),Ie.push({id:T.id,name:M.name||"",category:M.category||"",providerPrice:Number(M.providerPrice||0),unitsPerPackage:Number(M.unitsPerPackage||1),barcode:V,packaging:String(M.packaging||M.empaque||"").trim()||void 0,createdAt:M.createdAt})});const at=Be.current||{};let it=!1;for(const T of Object.keys(Ze))if((Ze[T]||"")!==(at[T]||"")){it=!0;break}l(Ie),Be.current=Ze,n(!1),!je.current&&it&&(s(" Catlogo actualizado."),setTimeout(()=>s(""),3e3)),je.current=!1},K=>{console.error(K),s(" Error sincronizando catlogo de dulces."),n(!1)});return()=>st()},[t]);const Be=x.useRef({}),je=x.useRef(!0),Ae=x.useMemo(()=>{const Xe=Ha(xe),be=String(Se||"").trim(),st=String(O||"").trim().toLowerCase();return st?o.filter(K=>String(K.packaging||"").trim().toLowerCase()===st):!Xe&&!be?o:o.filter(K=>{const Ie=`${K.category} ${K.name}`.toLowerCase(),Ze=Xe?Ie.includes(Xe):!0,at=String(K.barcode||""),it=be?at.includes(be):!0;return Ze&&it})},[o,xe,Se,O]),Qe=x.useMemo(()=>{const Xe=new Set;return o.forEach(be=>{const st=String(be.category||"").trim();st&&Xe.add(st)}),Array.from(Xe).sort((be,st)=>be.localeCompare(st,"es"))},[o]),Ct=()=>{u(""),f(""),h(0),p(1),v(""),b("")},pt=async Xe=>{if(Xe.preventDefault(),he.current||r)return;s("");const be=String(c||"").trim(),st=String(d||"").trim(),K=Math.max(0,Nh(A,0)),Ie=i0(m,1),Ze=String(g||"").trim();if(!be)return s(" La categora es requerida.");if(!st)return s(" El nombre del producto es requerido.");if(K<=0)return s(" El precio proveedor debe ser > 0.");if(Ie<=0)return s(" Und x paquete debe ser > 0.");const at=`${Ha(be)}::${Ha(st)}`,it=Date.now();if(le.current&&le.current.key===at&&it-le.current.ts<4e3){s(" Ya se est creando este producto.");return}if(o.some(M=>Ha(M.category)===Ha(be)&&Ha(M.name)===Ha(st)))return s(" Ya existe un producto con esa categora y nombre.");if(Ze&&o.some(V=>String(V.barcode||"")===Ze))return s(" Ya existe un producto con ese cdigo de barras.");he.current=!0,le.current={key:at,ts:it};try{if(n(!0),!(await Qt(er(_t(Fe,"products_candies"),cr("category","==",be),cr("name","==",st),iS(1)))).empty){s(" Ya existe un producto con esa categora y nombre.");return}if(Ze&&!(await Qt(er(_t(Fe,"products_candies"),cr("barcode","==",Ze),iS(1)))).empty){s(" Ya existe un producto con ese cdigo de barras.");return}const V={category:be,name:st,providerPrice:K,unitsPerPackage:Ie,createdAt:dr.now()};Ze&&(V.barcode=Ze);const q=String(y||"").trim();q&&(V.packaging=q),await On(_t(Fe,"products_candies"),V),s(" Producto creado."),Ct()}catch(M){console.error(M),s(" Error creando producto.")}finally{n(!1),he.current=!1}},me=Xe=>{j(Xe.id),_(Xe.category),E(Xe.name),k(Xe.providerPrice),D(Xe.unitsPerPackage||1),pe(String(Xe.barcode||"")),fe(String(Xe.packaging||"")),s("")},te=()=>{j(null),_(""),E(""),k(0),D(1),pe(""),fe("")},ie=async()=>{if(!w)return;s("");const Xe=String(I||"").trim(),be=String(S||"").trim(),st=Math.max(0,Nh(F,0)),K=i0(P,1),Ie=String(X||"").trim(),Ze=String(ge||"").trim();if(!Xe)return s(" La categora es requerida.");if(!be)return s(" El nombre del producto es requerido.");if(st<=0)return s(" El precio proveedor debe ser > 0.");if(K<=0)return s(" Und x paquete debe ser > 0.");if(o.some(it=>it.id!==w&&Ha(it.category)===Ha(Xe)&&Ha(it.name)===Ha(be)))return s(" Ya existe otro producto con esa categora y nombre.");if(Ie&&o.some(T=>T.id!==w&&String(T.barcode||"")===Ie))return s(" Ya existe otro producto con ese cdigo de barras.");try{n(!0);const it={category:Xe,name:be,providerPrice:st,unitsPerPackage:K,updatedAt:dr.now()};it.barcode=Ie||"",it.packaging=Ze||"",await pn(Yt(Fe,"products_candies",w),it),l(T=>T.map(M=>M.id===w?{...M,category:Xe,name:be,providerPrice:st,unitsPerPackage:K,barcode:Ie||void 0,packaging:Ze||void 0}:M).sort((M,V)=>M.name.localeCompare(V.name,"es"))),It&&s(" Producto guardado."),te()}catch(it){console.error(it),s(" Error actualizando producto.")}finally{n(!1)}},$e=async Xe=>{if(confirm(`Eliminar "${Xe.name}" (${Xe.category}) del catlogo?`))try{n(!0),await Fn(Yt(Fe,"products_candies",Xe.id)),l(st=>st.filter(K=>K.id!==Xe.id)),s(" Producto eliminado.")}catch(st){console.error(st),s(" Error eliminando producto.")}finally{n(!1)}},de=()=>{const Xe=[{Id:"",Categoria:"Gomitas",Producto:"Gomita Fresa",PrecioProveedor:120,UnidadesPorPaquete:24,Empaque:"Tarro",Codigo:"7445074183182"}],be=$s.json_to_sheet(Xe),st=$s.book_new();$s.book_append_sheet(st,be,"Productos");const K=iP(st,{type:"array",bookType:"xlsx"}),Ie=new Blob([K],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Ze=URL.createObjectURL(Ie),at=document.createElement("a");at.href=Ze,at.download="template_productos_dulces.xlsx",document.body.appendChild(at),at.click(),at.remove(),URL.revokeObjectURL(Ze)},Ce=Xe=>{const be=[],st=[];Xe.forEach((Ie,Ze)=>{if(!Ie||typeof Ie!="object"||Q9e(Ie))return;const at=String(Hm(Ie,["Id","ID","productId","docId"])??"").trim(),it=String(Hm(Ie,["Categoria","Categora","Category","cat","category"])??"").trim(),T=String(Hm(Ie,["Producto","Product","Nombre","Name","producto","name"])??"").trim(),M=Hm(Ie,["PrecioProveedor","Precio Prov","Precio Prov.","ProviderPrice","Precio","Costo","providerPrice"]),V=Hm(Ie,["UnidadesPorPaquete","Und x Paquete","UnitsPerPackage","UPP","unitsPerPackage"]),q=Hm(Ie,["Codigo","Cdigo","Barcode","barcode","EAN","UPC","Code"]),Y=String(q??"").trim(),oe=Hm(Ie,["Empaque","Packaging","PackagingType","Pack","Formato"]),De=String(oe??"").trim(),We=Math.max(0,Nh(M,0)),dt=i0(V,1),Oe=Ze+2;it||st.push(`Fila ${Oe}: falta Categoria.`),T||st.push(`Fila ${Oe}: falta Producto/Nombre.`),We<=0&&st.push(`Fila ${Oe}: PrecioProveedor debe ser > 0.`),dt<=0&&st.push(`Fila ${Oe}: UnidadesPorPaquete debe ser > 0.`),it&&T&&We>0&&dt>0&&be.push({id:at||void 0,category:it,name:T,providerPrice:We,unitsPerPackage:dt,barcode:Y||void 0,packaging:De||void 0,_raw:Ie})});const K=new Map;for(const Ie of be){const Ze=Ie.id?`id::${Ie.id}`:`${Ha(Ie.category)}::${Ha(Ie.name)}`;K.set(Ze,Ie)}return{rows:Array.from(K.values()),errors:st}},nt=async Xe=>{if(s(""),Me([]),ue([]),re((Xe==null?void 0:Xe.name)||""),!Xe)return;const be=Xe.name.toLowerCase(),st=be.endsWith(".xlsx")||be.endsWith(".xls"),K=be.endsWith(".csv");if(!st&&!K){Me(["Solo se permiten archivos .xlsx, .xls o .csv"]);return}try{yt(!0);const Ie=new FileReader,Ze=await new Promise((Y,oe)=>{Ie.onerror=()=>oe(new Error("No se pudo leer el archivo.")),Ie.onload=()=>Y(Ie.result),Ie.readAsArrayBuffer(Xe)}),at=O2(new Uint8Array(Ze),{type:"array"}),it=at.SheetNames[0],T=at.Sheets[it],M=$s.sheet_to_json(T,{defval:""}),{rows:V,errors:q}=Ce(M);ue(V),Me(q),V.length===0&&q.length===0&&Me(["No se encontraron filas vlidas para importar."])}catch(Ie){console.error(Ie),Me(["Error leyendo el archivo. Revis que no est corrupto."])}finally{yt(!1)}},vt=(Xe,be)=>{ue(st=>{const K=[...st],Ie=K[Xe];return Ie?(K[Xe]={...Ie,...be},K):st})},ht=async()=>{if(s(""),we.length>0){s(" Correg los errores antes de importar.");return}if(Pe.length===0){s(" No hay filas para importar.");return}try{yt(!0);const Xe={},be={},st={};o.forEach(at=>{Xe[at.id]=at,be[`${Ha(at.category)}::${Ha(at.name)}`]=at;const it=String(at.barcode||"").trim();it&&(st[it]=at)});const K=Jd(Fe);let Ie=0,Ze=0;for(const at of Pe){const it=String(at.category||"").trim(),T=String(at.name||"").trim(),M=Math.max(0,Nh(at.providerPrice,0)),V=i0(at.unitsPerPackage,1),q=String(at.barcode||"").trim();if(!it||!T||M<=0||V<=0)continue;let Y;if(at.id&&Xe[at.id])Y=Xe[at.id];else{const oe=`${Ha(it)}::${Ha(T)}`;Y=be[oe]}if(!Y&&q&&st[q]&&(Y=st[q]),Y){const oe={category:it,name:T,providerPrice:M,unitsPerPackage:V,updatedAt:dr.now()};at.barcode!=null&&(oe.barcode=q||""),at.packaging!=null&&(oe.packaging=String(at.packaging||"")||""),K.update(Yt(Fe,"products_candies",Y.id),oe),Ze+=1}else{const oe=Yt(_t(Fe,"products_candies")),De={category:it,name:T,providerPrice:M,unitsPerPackage:V,createdAt:dr.now()};q&&(De.barcode=q),at.packaging&&(De.packaging=at.packaging),K.set(oe,De),Ie+=1}}await K.commit(),s(` Importacin lista. Creados: ${Ie}, Actualizados: ${Ze}`),He(!1),ue([]),Me([]),re(""),e()}catch(Xe){console.error(Xe),s(" Error importando productos a Firestore.")}finally{yt(!1)}},xt=x.useMemo(()=>{const Xe=new Set(o.map(Ze=>Ze.id)),be=new Set(o.map(Ze=>`${Ha(Ze.category)}::${Ha(Ze.name)}`)),st=new Set(o.map(Ze=>String(Ze.barcode||"").trim()).filter(Boolean));let K=0,Ie=0;for(const Ze of Pe){if(Ze.id&&Xe.has(Ze.id)){K+=1;continue}const at=`${Ha(Ze.category)}::${Ha(Ze.name)}`;if(be.has(at)){K+=1;continue}const it=String(Ze.barcode||"").trim();if(it&&st.has(it)){K+=1;continue}Ie+=1}return{willCreate:Ie,willUpdate:K,total:Pe.length}},[Pe,o]);return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Catalogo"}),i.jsx("div",{className:"flex gap-2",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx(pc,{onClick:e,loading:r||ze}),!It&&i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-white border shadow-sm",onClick:()=>{He(!0),ue([]),Me([]),re("")},children:"Importar"})]})})]}),It&&i.jsxs("div",{className:"flex flex-col gap-2 mb-3",children:[i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-gray-900 text-white",onClick:()=>At(Xe=>!Xe),children:wt?"Ocultar creacin":"Crear producto"}),i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-white border shadow-sm",onClick:()=>{He(!0),ue([]),Me([]),re("")},children:"Importar"}),i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-gray-200",onClick:()=>ke(Xe=>!Xe),children:bt?"Ocultar filtros":"Mostrar filtros"}),bt&&i.jsxs("div",{className:"bg-white p-3 rounded shadow-sm border",children:[i.jsx("label",{className:"block font-semibold",children:"Empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:O,onChange:Xe=>G(Xe.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]})]}),wt&&i.jsxs("form",{onSubmit:pt,className:"bg-white p-3 rounded shadow border mb-4 grid grid-cols-1 md:grid-cols-6 gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Categora"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:c,onChange:Xe=>u(Xe.target.value),placeholder:"Ej: Gomitas"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:d,onChange:Xe=>f(Xe.target.value),placeholder:"Ej: Gomita Fresa"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:y,onChange:Xe=>b(Xe.target.value),children:[i.jsx("option",{value:"",children:"Seleccionar"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio proveedor (paq)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-1 text-right",value:Number.isNaN(A)?"":A,onChange:Xe=>h(Math.max(0,Nh(Xe.target.value,0)))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Und x paquete"}),i.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-1 text-right",value:m,onChange:Xe=>p(i0(Xe.target.value,1))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cdigo (opcional)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"w-full border rounded px-2 py-1",value:g,onChange:Xe=>v(Xe.target.value),placeholder:"EAN/UPC"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white hover:bg-black whitespace-nowrap",onClick:()=>{ve("create"),H(!0)},children:"Escanear"})]})]}),i.jsxs("div",{className:"md:col-span-6 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:Ct,children:"Limpiar"}),i.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",disabled:r,children:"Crear producto"})]})]}),bt&&i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-3 flex flex-col md:flex-row gap-3 items-center text-sm",children:[i.jsxs("div",{className:"w-full md:w-1/2",children:[i.jsx("label",{className:"block font-semibold",children:"Buscar"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:xe,onChange:Xe=>ae(Xe.target.value),placeholder:"Buscar por categora o producto"}),i.jsxs("div",{className:"mt-2",children:[i.jsx("label",{className:"block font-semibold",children:"Empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:O,onChange:Xe=>G(Xe.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]})]}),i.jsxs("div",{className:"w-full md:w-1/2",children:[i.jsx("label",{className:"block font-semibold",children:"Buscar por cdigo"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:Se,onChange:Xe=>Te(Xe.target.value),placeholder:"Ej: 7445074183182"}),i.jsx("div",{className:"mt-2 md:mt-0",children:i.jsx("button",{type:"button",className:"w-full md:w-auto px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{ve("search"),H(!0),ke(!0)},children:"Escanear producto"})}),i.jsx("div",{className:"mt-2 md:mt-0",children:i.jsx("button",{type:"button",className:"w-full md:w-auto px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{ae(""),Te("")},children:"Limpiar filtros"})})]}),i.jsxs("div",{className:"w-full md:w-auto text-right",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Productos en catlogo"}),i.jsx("div",{className:"text-lg font-semibold",children:Ae.length})]})]}),It?i.jsx("div",{className:"space-y-2",children:r?i.jsx("div",{className:"bg-white border rounded p-4 text-center",children:"Cargando"}):Ae.length===0?i.jsx("div",{className:"bg-white border rounded p-4 text-center",children:"Sin productos."}):Ae.map(Xe=>{const be=w===Xe.id,st=Ne===Xe.id,K=!!String(Xe.barcode||"").trim();return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>Ve(Ie=>Ie===Xe.id?null:Xe.id),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-bold truncate",children:Xe.name}),i.jsx("div",{className:"text-xs text-gray-600 truncate",children:Xe.category})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Precio proveedor"}),i.jsx("div",{className:"font-bold tabular-nums",children:R5(Xe.providerPrice)})]})]}),st&&i.jsx("div",{className:"px-3 pb-3 border-t",children:i.jsxs("div",{className:"pt-3 space-y-2 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Categora"}),be?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:I,onChange:Ie=>_(Ie.target.value)}):i.jsx("div",{className:"font-semibold",children:Xe.category})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Und x paquete"}),be?i.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-1 text-right",value:P,onChange:Ie=>D(i0(Ie.target.value,1))}):i.jsx("div",{className:"font-semibold text-right tabular-nums",children:Xe.unitsPerPackage})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Empaque"}),be?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:ge,onChange:Ie=>fe(Ie.target.value),children:[i.jsx("option",{value:"",children:"Seleccionar"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):i.jsx("div",{className:"font-semibold",children:Xe.packaging||""})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Precio proveedor"}),be?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-1 text-right",value:Number.isNaN(F)?"":F,onChange:Ie=>k(Math.max(0,Nh(Ie.target.value,0)))}):i.jsx("div",{className:"font-semibold tabular-nums",children:R5(Xe.providerPrice)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Cdigo"}),be?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-1",value:X,onChange:Ie=>pe(Ie.target.value),placeholder:"EAN/UPC"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{ve("edit"),H(!0)},children:"Escanear"})]}):K?i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200",onClick:()=>{ee(String(Xe.barcode||"").trim()),L(!0)},children:"Ver cdigo"}):i.jsx("div",{className:"text-gray-600",children:"No"})]})]}),i.jsx("div",{className:"pt-2 flex gap-2",children:be?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-blue-600 text-white",onClick:ie,type:"button",children:"Guardar"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{ve("edit"),H(!0)},type:"button",children:"Escanear"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-gray-200",onClick:te,type:"button",children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-yellow-400",onClick:()=>me(Xe),type:"button",children:"Editar"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-red-600 text-white",onClick:()=>$e(Xe),type:"button",children:"Borrar"})]})})]})})]},Xe.id)})}):i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1050px] w-full text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-left",children:"Empaque"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Und x paquete"}),i.jsx("th",{className:"p-2 border text-center",children:"Cdigo"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):Ae.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin productos."})}):Ae.map(Xe=>{const be=w===Xe.id,st=!!String(Xe.barcode||"").trim();return i.jsxs("tr",{className:"align-top",children:[i.jsx("td",{className:"p-2 border",children:be?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:I,onChange:K=>_(K.target.value)}):Xe.category}),i.jsx("td",{className:"p-2 border",children:be?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:S,onChange:K=>E(K.target.value)}):Xe.name}),i.jsx("td",{className:"p-2 border",children:be?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:ge,onChange:K=>fe(K.target.value),children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):Xe.packaging||""}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:be?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border rounded px-2 py-1 text-right",value:Number.isNaN(F)?"":F,onChange:K=>k(Math.max(0,Nh(K.target.value,0)))}):R5(Xe.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:be?i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:P,onChange:K=>D(i0(K.target.value,1))}):Xe.unitsPerPackage}),i.jsx("td",{className:"p-2 border text-center",children:be?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("input",{className:"w-44 border rounded px-2 py-1",value:X,onChange:K=>pe(K.target.value),placeholder:"EAN/UPC"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-800 text-white hover:bg-black",onClick:()=>{ve("edit"),H(!0)},children:"Escanear"})]}):st?i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200",onClick:()=>{ee(String(Xe.barcode||"").trim()),L(!0)},children:"S"}):i.jsx("span",{className:"px-2 py-1 rounded bg-gray-100 text-gray-600",children:"No"})}),i.jsx("td",{className:"p-2 border",children:be?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:ie,type:"button",children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:te,type:"button",children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 hover:bg-yellow-500",onClick:()=>me(Xe),type:"button",children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>$e(Xe),type:"button",children:"Borrar"})]})})]},Xe.id)})})]})}),a?It&&a===" Producto guardado."?i.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[i.jsx("div",{className:"flex-1 text-sm",children:a}),i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white",onClick:()=>{s(""),te(),H(!1)},children:"Aceptar"})]}):i.jsx("p",{className:"mt-2 text-sm",children:a}):null,i.jsx(V9e,{open:z,code:Z,onClose:()=>L(!1)}),i.jsx(H9e,{open:R,onClose:()=>H(!1),onDetected:async Xe=>{const be=String(Xe||"").trim();if(be){if(ne==="edit"&&w){if(o.some(K=>K.id!==w&&String(K.barcode||"")===be)){s(" Ya existe otro producto con ese cdigo de barras."),pe(be),H(!1);return}try{await pn(Yt(Fe,"products_candies",w),{barcode:be}),l(K=>K.map(Ie=>Ie.id===w?{...Ie,barcode:be}:Ie)),pe(be),It&&s(" Producto guardado.")}catch(K){console.error(K),s(" Error guardando cdigo de barras.")}finally{H(!1)}return}if(ne==="search"){Te(be),H(!1);return}ne==="create"?v(Xe):pe(Xe)}}}),U&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white w-full max-w-6xl max-h-[90vh] overflow-y-auto rounded shadow-lg p-5 text-sm",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Importar productos (.xlsx / .csv)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>He(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:[i.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-end md:justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"1) Sub tu archivo"}),i.jsx("div",{className:"text-xs text-gray-600",children:"Columnas esperadas (flexible): Id (opcional), Categoria, Producto/Nombre, PrecioProveedor, UnidadesPorPaquete, Empaque (opcional), Codigo (opcional)."})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:de,type:"button",children:"Descargar template .xlsx"})]}),i.jsxs("div",{className:"mt-3 flex flex-col md:flex-row gap-3 md:items-center",children:[i.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:Xe=>{var be;return nt(((be=Xe.target.files)==null?void 0:be[0])||null)}}),se&&i.jsxs("span",{className:"text-xs text-gray-600",children:["Archivo: ",i.jsx("b",{children:se})]}),ze&&i.jsx("span",{className:"text-xs",children:"Procesando"})]})]}),we.length>0&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3 mb-3",children:[i.jsx("div",{className:"font-semibold text-red-700 mb-2",children:"Errores encontrados"}),i.jsx("ul",{className:"list-disc pl-5 text-red-700 text-xs space-y-1",children:we.slice(0,50).map((Xe,be)=>i.jsx("li",{children:Xe},be))})]}),i.jsxs("div",{className:"bg-white border rounded p-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"2) Previsualizacin (editable)"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Se importarn ",xt.total," filas (Crear:"," ",xt.willCreate," / Actualizar:"," ",xt.willUpdate,")"]})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50",onClick:ht,disabled:ze||Pe.length===0||we.length>0,type:"button",children:"Importar a Firestore"})]}),i.jsxs("div",{className:"overflow-x-auto border rounded",children:[i.jsxs("table",{className:"min-w-[1250px] w-full text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Id (opcional)"}),i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Und x paquete"}),i.jsx("th",{className:"p-2 border text-left",children:"Empaque (opcional)"}),i.jsx("th",{className:"p-2 border text-left",children:"Codigo (opcional)"}),i.jsx("th",{className:"p-2 border text-center",children:"Accin"})]})}),i.jsx("tbody",{children:Pe.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Sub un archivo para ver la previsualizacin."})}):Pe.slice(0,300).map((Xe,be)=>{const st=Xe.id?o.some(at=>at.id===Xe.id):!1,K=o.some(at=>`${Ha(at.category)}::${Ha(at.name)}`==`${Ha(Xe.category)}::${Ha(Xe.name)}`),Ie=Xe.barcode?o.some(at=>String(at.barcode||"")===Xe.barcode):!1,Ze=st||K||Ie;return i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:Xe.id||"",onChange:at=>vt(be,{id:at.target.value.trim()||void 0}),placeholder:"docId (si quers update exacto)"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:Xe.category,onChange:at=>vt(be,{category:at.target.value}),list:"categories-list"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-72 border rounded px-2 py-1",value:Xe.name,onChange:at=>vt(be,{name:at.target.value})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border rounded px-2 py-1 text-right",value:Number.isNaN(Xe.providerPrice)?"":Xe.providerPrice,onChange:at=>vt(be,{providerPrice:Math.max(0,Nh(at.target.value,0))})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:Xe.unitsPerPackage,onChange:at=>vt(be,{unitsPerPackage:i0(at.target.value,1)})})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:Xe.packaging||"",onChange:at=>vt(be,{packaging:at.target.value.trim()||void 0}),placeholder:"Tarro, Bolsa..."})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:Xe.barcode||"",onChange:at=>vt(be,{barcode:at.target.value.trim()||void 0}),placeholder:"EAN/UPC (opcional)"})}),i.jsx("td",{className:"p-2 border text-center",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] ${Ze?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:Ze?"ACTUALIZA":"CREA"})})]},`${Xe.id||""}-${be}`)})})]}),i.jsx("datalist",{id:"categories-list",children:Qe.map(Xe=>i.jsx("option",{value:Xe},Xe))})]}),Pe.length>300&&i.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:["Mostrando 300 de ",Pe.length," filas (el import importa todas)."]})]})]})})]})}function mse(t){const e=Math.max(1,Math.floor(Number(t.unitsPerPackage||1))),r=Number(t.totalUnits||0),n=Number(t.quantity||0),a=Number(t.packages||0);return r>0?Math.floor(r):n>0?Math.floor(n):a>0?Math.floor(a*e):0}function M5(t){const e=Number(t.remaining);return Number.isFinite(e)&&e>0?Math.floor(e):mse(t)}const pse=t=>Math.max(0,Math.floor(Number(t??0)));function G9e(t){return pse(t.packages??t.totalPackages??t.packs??t.packagesInitial??t.initialPackages??0)}function K9e(t){return pse(t.remainingPackages??t.remainingPacks??t.packsRemaining??t.packagesRemaining??t.remaining_packages??0)}async function q9e(t){const e=Yt(Fe,"candy_main_orders",t);if((await Bs(e)).exists())return e;const n=er(_t(Fe,"candy_main_orders"),cr("orderId","==",t)),a=await Qt(n);return a.empty?null:Yt(Fe,"candy_main_orders",a.docs[0].id)}async function L5(t){if(!t)return;const e=await q9e(t);if(!e)return;const r=er(_t(Fe,"inventory_candies"),cr("orderId","==",t)),n=await Qt(r),a=new Map;n.forEach(l=>{const c=l.data(),u=String(c.productId||"");if(!u)return;const d=G9e(c),f=K9e(c),A=Math.max(1,Math.floor(Number(c.unitsPerPackage||1))),h=Number(c.providerPrice||0),m=Number(c.unitPriceRivas||0),p=Number(c.unitPriceSanJorge||0),g=Number(c.unitPriceIsla||0),v=h*d,y=m*d,b=p*d,w=g*d,j=y-v,I=b-v,_=w-v;a.has(u)||a.set(u,{productId:u,name:String(c.productName||""),category:String(c.category||""),unitsPerPackage:A,providerPrice:h,marginRivas:typeof c.marginRivas=="number"?Number(c.marginRivas):void 0,marginSanJorge:typeof c.marginSanJorge=="number"?Number(c.marginSanJorge):void 0,marginIsla:typeof c.marginIsla=="number"?Number(c.marginIsla):void 0,packages:0,remainingPackages:0,subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0,unitPriceRivas:m||0,unitPriceSanJorge:p||0,unitPriceIsla:g||0,gainRivas:0,gainSanJorge:0,gainIsla:0});const S=a.get(u);S.packages+=d,S.remainingPackages+=f,S.subtotal+=v,S.totalRivas+=y,S.totalSanJorge+=b,S.totalIsla+=w,S.gainRivas+=j,S.gainSanJorge+=I,S.gainIsla+=_,S.providerPrice=h,S.unitPriceRivas=m||S.unitPriceRivas,S.unitPriceSanJorge=p||S.unitPriceSanJorge,S.unitPriceIsla=g||S.unitPriceIsla,S.unitsPerPackage=A||S.unitsPerPackage,S.name=String(c.productName||S.name),S.category=String(c.category||S.category)});const s=Array.from(a.values()).map(l=>({id:l.productId,name:l.name,category:l.category,providerPrice:l.providerPrice,unitsPerPackage:l.unitsPerPackage,packages:l.packages,remainingPackages:l.remainingPackages,marginRivas:l.marginRivas??void 0,marginSanJorge:l.marginSanJorge??void 0,marginIsla:l.marginIsla??void 0,subtotal:l.subtotal,totalRivas:l.totalRivas,totalSanJorge:l.totalSanJorge,totalIsla:l.totalIsla,unitPriceRivas:l.unitPriceRivas,unitPriceSanJorge:l.unitPriceSanJorge,unitPriceIsla:l.unitPriceIsla,gainRivas:l.gainRivas,gainSanJorge:l.gainSanJorge,gainIsla:l.gainIsla})),o=s.reduce((l,c)=>l+Number(c.packages||0),0);await pn(e,{totalPackages:o,items:s})}function z9e(t){const e=t==null?void 0:t.allocationsByItem;if(!e)return null;const r=[];if(Array.isArray(e))for(const n of e){const a=Array.isArray(n==null?void 0:n.allocations)?n.allocations:[];for(const s of a){const o=String(s.inventorySellerId||""),l=Math.max(0,Math.floor(Number(s.units??s.qty??s.quantity??0)));!o||l<=0||r.push({inventorySellerId:o,units:l})}}else if(typeof e=="object")for(const n of Object.keys(e)){const a=e[n],s=Array.isArray(a==null?void 0:a.allocations)?a.allocations:[];for(const o of s){const l=String(o.inventorySellerId||""),c=Math.max(0,Math.floor(Number(o.units??o.qty??o.quantity??0)));!l||c<=0||r.push({inventorySellerId:l,units:c})}}return r.length?{allocations:r}:null}async function R2(t){const e=t.split("#")[0],r=Yt(Fe,"sales_candies",e),n=await Bs(r);if(!n.exists())throw new Error("La venta no existe.");const a=n.data(),s=z9e(a);if(s&&s.allocations.length>0){let u=0;return await Ii(Fe,async d=>{const f={};for(const p of s.allocations){const g=p.inventorySellerId,v=Math.max(0,Math.floor(Number(p.units||0)));!g||v<=0||(f[g]=(f[g]||0)+v,u+=v)}const h=Object.keys(f).map(p=>Yt(Fe,"inventory_candies_sellers",p)),m=await Promise.all(h.map(p=>d.get(p)));for(let p=0;p<h.length;p++){const g=m[p];if(!g.exists())continue;const v=g.data(),y=Number(v.remainingUnits??v.remaining??0),b=Math.max(0,Math.floor(Number(f[h[p].id]||0))),w=y+b,j=Math.max(1,Math.floor(Number(v.unitsPerPackage||1))),I=Math.floor(w/j);d.update(h[p],{remainingUnits:w,remainingPackages:I})}d.delete(r)}),{restored:u}}const o=[];if(Array.isArray(a.items)&&a.items.length>0){const u={};if(a.allocationsByItem&&typeof a.allocationsByItem=="object")for(const d of Object.keys(a.allocationsByItem)){const f=a.allocationsByItem[d],A=String((f==null?void 0:f.productId)||d||"");if(!A)continue;const h=Array.isArray(f==null?void 0:f.allocations)?f.allocations:[];u[A]=h.map(m=>({batchId:String(m.batchId),qty:Math.max(0,Math.floor(Number(m.qty||m.quantity||0)))}))}if(Array.isArray(a.allocationsByItem))for(const d of a.allocationsByItem){const f=String((d==null?void 0:d.productId)||"");if(!f)continue;const A=Array.isArray(d==null?void 0:d.allocations)?d.allocations:[];u[f]=A.map(h=>({batchId:String(h.batchId),qty:Math.max(0,Math.floor(Number(h.qty||h.quantity||0)))}))}for(const d of a.items){const f=String((d==null?void 0:d.productId)||"");if(!f)continue;const A=Math.max(0,Math.floor(Number((d==null?void 0:d.qty)||(d==null?void 0:d.quantity)||0))),h=Array.isArray(d==null?void 0:d.allocations)?d.allocations.map(m=>({batchId:String(m.batchId),qty:Math.max(0,Math.floor(Number(m.qty||m.quantity||0)))})):u[f]||[];o.push({productId:f,productName:String((d==null?void 0:d.productName)||""),qty:A,allocations:h.length?h:void 0})}}else{const u=a.item||{},d=String(u.productId||a.productId||""),f=Math.max(0,Math.floor(Number(u.qty??a.quantity??0))),A=Array.isArray(a.allocations)?a.allocations.map(h=>({batchId:String(h.batchId),qty:Math.max(0,Math.floor(Number(h.qty||h.quantity||0)))})):[];d&&f>0&&o.push({productId:d,productName:String(u.productName||a.productName||""),qty:f,allocations:A.length?A:void 0})}if(o.length===0)return await Ii(Fe,async u=>{u.delete(r)}),{restored:0};if(o.every(u=>Array.isArray(u.allocations)&&u.allocations.length>0)){let u=0;return await Ii(Fe,async d=>{const f=[];for(const h of o)for(const m of h.allocations||[]){const p=Math.max(0,Math.floor(Number(m.qty||0)));u+=p,f.push({ref:Yt(Fe,"inventory_candies",m.batchId),addBack:p})}const A=await Promise.all(f.map(h=>d.get(h.ref)));for(let h=0;h<f.length;h++){const m=A[h];if(!m.exists())continue;const p=m.data(),g=M5(p),v=Math.max(0,Math.floor(Number(f[h].addBack||0))),y=g+v,b=Math.max(1,Math.floor(Number(p.unitsPerPackage||1))),w=Math.floor(y/b);d.update(f[h].ref,{remaining:y,remainingPackages:w,packages:w})}d.delete(r)}),{restored:u}}let c=0;return await Ii(Fe,async u=>{const d={};for(const p of o){if(!p.productId||p.qty<=0)continue;const g=er(_t(Fe,"inventory_candies"),cr("productId","==",p.productId)),y=(await Qt(g)).docs.map(b=>{const w=b.data(),j=mse(w),I=M5(w);return{id:b.id,date:String(w.date||""),baseUnits:j,remaining:I}}).sort((b,w)=>b.date.localeCompare(w.date));d[p.productId]=y}const f=[];for(const p of o){if(!p.productId||p.qty<=0)continue;if(Array.isArray(p.allocations)&&p.allocations.length>0){for(const y of p.allocations){const b=Math.max(0,Math.floor(Number(y.qty||0)));c+=b,f.push({id:y.batchId,addBack:b})}continue}const g=d[p.productId]||[];let v=p.qty;for(const y of g){if(v<=0)break;const b=Math.max(0,y.baseUnits-y.remaining);if(b<=0)continue;const w=Math.min(b,v);f.push({id:y.id,addBack:w}),c+=w,v-=w}for(const y of g){if(v<=0)break;const b=Math.min(v,p.qty);f.push({id:y.id,addBack:b}),c+=b,v-=b}}const A={};for(const p of f)A[p.id]=(A[p.id]||0)+Math.max(0,Math.floor(Number(p.addBack||0)));const h=Object.keys(A).map(p=>Yt(Fe,"inventory_candies",p)),m=await Promise.all(h.map(p=>u.get(p)));for(let p=0;p<h.length;p++){const g=m[p];if(!g.exists())continue;const v=g.data(),y=M5(v),b=Math.max(0,Math.floor(Number(A[h[p].id]||0))),w=y+b,j=Math.max(1,Math.floor(Number(v.unitsPerPackage||1))),I=Math.floor(w/j);u.update(h[p],{remaining:w,remainingPackages:I,packages:I})}u.delete(r)}),{restored:c}}async function W9e(t){return R2(t)}const Zl=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function U5(t){return isFinite(t)?Math.round(t):0}function Od(t){return t.unitsPerPackage>0&&t.totalUnits>0?Math.floor(t.totalUnits/t.unitsPerPackage):Math.max(0,Math.floor(Number(t.packages||0)))}function Q5(t){return typeof t.remainingPackages=="number"&&isFinite(t.remainingPackages)?Math.max(0,Math.floor(t.remainingPackages)):t.unitsPerPackage>0?Math.max(0,Math.floor(Number(t.remaining||0)/t.unitsPerPackage)):0}function X9e(t,e){var o,l;const r=String(t.date||""),n=String(e.date||"");if(r!==n)return n.localeCompare(r);const a=((o=t.createdAt)==null?void 0:o.seconds)??0;return(((l=e.createdAt)==null?void 0:l.seconds)??0)-a}function Y9e(){const[t,e]=x.useState([]),[r,n]=x.useState([]),[a,s]=x.useState(!0),[o,l]=x.useState(""),[c,u]=x.useState(Nr(yd(new Date),"yyyy-MM-dd")),[d,f]=x.useState(Nr(vd(new Date),"yyyy-MM-dd")),[A,h]=x.useState(""),[m,p]=x.useState(""),[g,v]=x.useState(null),[y,b]=x.useState(""),[w,j]=x.useState(0),[I,_]=x.useState(!1),[S,E]=x.useState(""),[F,k]=x.useState(""),[P,D]=x.useState([]);x.useEffect(()=>{(async()=>{try{s(!0);const Z=await Qt(_t(Fe,"products_candies")),ee=[];Z.forEach(ve=>{const U=ve.data();ee.push({id:ve.id,name:U.name??"(sin nombre)",category:U.category??"(sin categora)"})}),e(ee);const R=er(_t(Fe,"inventory_candies"),dn("date","desc")),H=await Qt(R),ne=[];H.forEach(ve=>{const U=ve.data(),He=Number(U.unitsPerPackage||0),se=Number(U.totalUnits??U.quantity??(U.packages||0)*(U.unitsPerPackage||0)),re=Number(U.remaining??U.totalUnits??se??0);ne.push({id:ve.id,productId:U.productId,productName:U.productName,category:U.category,measurement:U.measurement??"unidad",packages:Number(U.packages||0),unitsPerPackage:He,totalUnits:se,remaining:re,remainingPackages:typeof U.remainingPackages=="number"?Number(U.remainingPackages):void 0,providerPrice:Number(U.providerPrice||0),subtotal:Number(U.subtotal||0),totalRivas:Number(U.totalRivas||0),totalSanJorge:Number(U.totalSanJorge||0),totalIsla:Number(U.totalIsla||0),gainRivas:Number(U.gainRivas||0),gainSanJorge:Number(U.gainSanJorge||0),gainIsla:Number(U.gainIsla||0),unitPriceRivas:Number(U.unitPriceRivas||0),unitPriceSanJorge:Number(U.unitPriceSanJorge||0),unitPriceIsla:Number(U.unitPriceIsla||0),date:U.date,createdAt:U.createdAt,status:U.status??"PENDIENTE",orderId:U.orderId??null})}),n(ne)}catch(Z){console.error(Z),l(" Error cargando inventario.")}finally{s(!1)}})()},[]);const X=x.useMemo(()=>r.filter(Z=>!(c&&Z.date<c||d&&Z.date>d||A&&Z.productId!==A||m&&String(Z.category||"")!==m)),[r,c,d,A,m]),pe=x.useMemo(()=>{const Z=new Set;for(const ee of t)ee.category&&Z.add(ee.category);return Array.from(Z).sort((ee,R)=>ee.localeCompare(R))},[t]),ge=x.useMemo(()=>{const Z=X.reduce((U,He)=>U+Od(He),0),ee=X.reduce((U,He)=>U+Q5(He),0),R=X.reduce((U,He)=>{const se=Od(He);return U+Number(He.providerPrice||0)*se},0),H=X.reduce((U,He)=>{const se=Od(He);return U+Number(He.unitPriceRivas||0)*se},0),ne=X.reduce((U,He)=>{const se=Od(He);return U+Number(He.unitPriceSanJorge||0)*se},0),ve=X.reduce((U,He)=>{const se=Od(He);return U+Number(He.unitPriceIsla||0)*se},0);return{totalPaquetes:Z,totalPaquetesRestantes:ee,totalSubtotal:R,totalRivas:H,totalSJ:ne,totalIsla:ve}},[X]),fe=x.useMemo(()=>{let Z=0,ee=0;for(const R of X)R.status==="PENDIENTE"&&(Z+=1),R.status==="PAGADO"&&(ee+=1);return{totalLotes:X.length,pendientes:Z,pagados:ee}},[X]),xe=x.useMemo(()=>{const Z=new Map;for(const R of X){const H=String(R.productId||"");H&&(Z.has(H)||Z.set(H,{batches:[]}),Z.get(H).batches.push(R))}const ee=[];for(const[R,H]of Z.entries()){const ne=[...H.batches].sort(X9e),ve=ne[0],U=ne.reduce((wt,At)=>wt+Od(At),0),He=ne.reduce((wt,At)=>wt+Q5(At),0),se=Number((ve==null?void 0:ve.providerPrice)||0),re=Number((ve==null?void 0:ve.unitPriceRivas)||0),Pe=Number((ve==null?void 0:ve.unitPriceIsla)||0),ue=ne.reduce((wt,At)=>{const bt=Od(At);return wt+Number(At.providerPrice||0)*bt},0),we=ne.reduce((wt,At)=>{const bt=Od(At);return wt+Number(At.unitPriceRivas||0)*bt},0),Me=ne.reduce((wt,At)=>{const bt=Od(At);return wt+Number(At.unitPriceIsla||0)*bt},0),ze=we-ue,yt=Me-ue;let It="",Ke;for(const wt of ne)(!It||String(wt.date||"")>It)&&(It=String(wt.date||""),Ke=wt.createdAt);ee.push({productId:R,productName:(ve==null?void 0:ve.productName)||"",category:(ve==null?void 0:ve.category)||"",totalPackages:U,remainingPackages:He,providerPrice:se,unitPriceRivas:re,unitPriceIsla:Pe,subtotal:ue,totalRivas:we,totalIsla:Me,gainRivas:ze,gainIsla:yt,lastDate:It,lastCreatedAt:Ke,batchCount:ne.length})}return ee.sort((R,H)=>String(H.lastDate).localeCompare(String(R.lastDate))),ee},[X]),ae=Z=>{v(Z.id),b(Z.date),j(Z.providerPrice),l("")},Se=()=>{v(null),b(""),j(0)},Te=async()=>{if(!g)return;const Z=r.find(Me=>Me.id===g);if(!Z)return;if(w<0){l("El precio proveedor no puede ser negativo.");return}const ee=Od(Z),R=w*ee,H=ee>0?R/.8:0,ne=ee>0?R/.85:0,ve=ee>0?R/.7:0,U=H-R,He=ne-R,se=ve-R,re=ee>0?U5(H/ee):0,Pe=ee>0?U5(ne/ee):0,ue=ee>0?U5(ve/ee):0,we=Yt(Fe,"inventory_candies",g);await pn(we,{date:y,providerPrice:w,subtotal:R,totalRivas:H,totalSanJorge:ne,totalIsla:ve,gainRivas:U,gainSanJorge:He,gainIsla:se,unitPriceRivas:re,unitPriceSanJorge:Pe,unitPriceIsla:ue}),n(Me=>Me.map(ze=>ze.id===g?{...ze,date:y,providerPrice:w,subtotal:R,totalRivas:H,totalSanJorge:ne,totalIsla:ve,gainRivas:U,gainSanJorge:He,gainIsla:se,unitPriceRivas:re,unitPriceSanJorge:Pe,unitPriceIsla:ue}:ze)),Z.orderId&&await L5(String(Z.orderId)),l(" Lote de dulces actualizado"),Se()},O=async Z=>{confirm(`Marcar PAGADO el lote del ${Z.date} (${Z.productName})?`)&&(await pn(Yt(Fe,"inventory_candies",Z.id),{status:"PAGADO"}),n(R=>R.map(H=>H.id===Z.id?{...H,status:"PAGADO"}:H)),l(" Lote marcado como pagado"))},G=async Z=>{confirm(`Eliminar el lote del ${Z.date} (${Z.productName})?`)&&(await Fn(Yt(Fe,"inventory_candies",Z.id)),n(R=>R.filter(H=>H.id!==Z.id)),Z.orderId&&await L5(String(Z.orderId)),l(" Lote eliminado"))},z=async(Z,ee)=>{try{s(!0),l("");const R=er(_t(Fe,"inventory_candies"),cr("productId","==",Z),dn("date","desc")),H=await Qt(R),ne=[];H.forEach(ve=>{const U=ve.data(),He=Number(U.unitsPerPackage||0),se=Number(U.totalUnits??U.quantity??(U.packages||0)*(U.unitsPerPackage||0)),re=Number(U.remaining??U.totalUnits??se??0);ne.push({id:ve.id,productId:U.productId,productName:U.productName,category:U.category,measurement:U.measurement??"unidad",packages:Number(U.packages||0),unitsPerPackage:He,totalUnits:se,remaining:re,remainingPackages:typeof U.remainingPackages=="number"?Number(U.remainingPackages):void 0,providerPrice:Number(U.providerPrice||0),subtotal:Number(U.subtotal||0),totalRivas:Number(U.totalRivas||0),totalSanJorge:Number(U.totalSanJorge||0),totalIsla:Number(U.totalIsla||0),gainRivas:Number(U.gainRivas||0),gainSanJorge:Number(U.gainSanJorge||0),gainIsla:Number(U.gainIsla||0),unitPriceRivas:Number(U.unitPriceRivas||0),unitPriceSanJorge:Number(U.unitPriceSanJorge||0),unitPriceIsla:Number(U.unitPriceIsla||0),date:U.date,createdAt:U.createdAt,status:U.status??"PENDIENTE",orderId:U.orderId??null})}),E(Z),k(ee),D(ne),_(!0)}catch(R){console.error(R),l(" Error abriendo detalle del producto.")}finally{s(!1)}},L=async(Z,ee)=>{const R=r.filter(ne=>ne.productId===Z);if(confirm(`Eliminar COMPLETAMENTE "${ee}"?
Esto eliminar ${R.length} lote(s) de este producto.`))try{s(!0),l("");const ne=Array.from(new Set(R.map(ve=>ve.orderId?String(ve.orderId):"").filter(Boolean)));for(const ve of R)await Fn(Yt(Fe,"inventory_candies",ve.id));n(ve=>ve.filter(U=>U.productId!==Z)),l(" Producto eliminado (todos sus lotes).");for(const ve of ne)await L5(ve);I&&S===Z&&(_(!1),D([]),E(""),k(""))}catch(ne){console.error(ne),l(" Error eliminando lotes del producto.")}finally{s(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario Productos"})}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:Z=>u(Z.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:Z=>f(Z.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[220px]",children:[i.jsx("label",{className:"font-semibold",children:"Categora"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:m,onChange:Z=>p(Z.target.value),children:[i.jsx("option",{value:"",children:"Todas"}),pe.map(Z=>i.jsx("option",{value:Z,children:Z},Z))]})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:Z=>h(Z.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),t.map(Z=>i.jsxs("option",{value:Z.id,children:[Z.name,"  ",Z.category]},Z.id))]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{u(""),f(""),h(""),p("")},children:"Quitar filtro"})]}),i.jsx("div",{className:"bg-gray-50 p-2 rounded shadow border mb-2 text-xs md:text-sm",children:i.jsxs("div",{className:"flex flex-wrap gap-x-6 gap-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes totales:"})," ",fe.totalLotes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes pendientes:"})," ",fe.pendientes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes pagados:"})," ",fe.pagados]})]})}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-sm md:text-base",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-y-1 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes ingresados:"})," ",ge.totalPaquetes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes restantes:"})," ",ge.totalPaquetesRestantes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Sub total:"})," ",Zl(ge.totalSubtotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Rivas:"})," ",Zl(ge.totalRivas)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total San Jorge:"})," ",Zl(ge.totalSJ)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Isla:"})," ",Zl(ge.totalIsla)]})]})}),i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] table-auto text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio venta Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio venta Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Subtotal"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Total Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Ganancia bruta Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Ganancia bruta Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"ltima fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-center",children:"Opciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:14,className:"p-4 text-center",children:"Cargando"})}):xe.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:14,className:"p-4 text-center",children:"Sin productos"})}):xe.map(Z=>i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 border",children:Z.category||""}),i.jsxs("td",{className:"p-2 border max-w-[260px]",children:[i.jsx("span",{className:"block truncate",title:Z.productName,children:Z.productName}),i.jsxs("span",{className:"text-[10px] text-gray-500",children:["Lotes: ",Z.batchCount]})]}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Z.totalPackages}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Z.remainingPackages}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Zl(Z.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Zl(Z.unitPriceRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Zl(Z.unitPriceIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Zl(Z.subtotal)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Zl(Z.totalRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Zl(Z.totalIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Zl(Z.gainRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Zl(Z.gainIsla)}),i.jsx("td",{className:"p-2 border",children:Z.lastDate||""}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-1 justify-center flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>z(Z.productId,Z.productName),children:"Detalle"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>L(Z.productId,Z.productName),children:"Borrar"})]})})]},Z.productId))})]})})}),o&&i.jsx("p",{className:"mt-2 text-sm",children:o}),I&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-4 rounded shadow-lg w-full max-w-6xl max-h-[90vh] overflow-y-auto text-sm",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold",children:"Detalle del producto"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[i.jsx("span",{className:"font-semibold",children:"Producto:"})," ",F||""," ",i.jsxs("span",{className:"ml-2",children:[i.jsx("span",{className:"font-semibold",children:"ID:"})," ",S]})]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{_(!1),D([]),E(""),k(""),Se()},children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] table-auto text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border text-left",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes ingresados"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border text-right",children:"Unidades"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio venta Rivas"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio venta Isla"}),i.jsx("th",{className:"p-2 border",children:"Nmero orden"}),i.jsx("th",{className:"p-2 border",children:"Status"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:P.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center text-gray-500",children:"Sin lotes"})}):P.map(Z=>{const ee=g===Z.id,R=Od(Z),H=Q5(Z);return i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 border align-top",children:ee?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:y,onChange:ne=>b(ne.target.value)}):Z.date}),i.jsx("td",{className:"p-2 border align-top",children:Z.category||""}),i.jsxs("td",{className:"p-2 border align-top max-w-[260px]",children:[i.jsx("span",{className:"block truncate",title:Z.productName,children:Z.productName}),i.jsxs("span",{className:"text-[10px] text-gray-500",children:["Lote ID: ",Z.id]})]}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:R}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:H}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:Z.totalUnits}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:ee?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(w)?"":w,onChange:ne=>j(Math.max(0,parseFloat(ne.target.value||"0")))}):Zl(Z.providerPrice)}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:Zl(Z.unitPriceRivas)}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:Zl(Z.unitPriceIsla)}),i.jsx("td",{className:"p-2 border align-top",children:Z.orderId?String(Z.orderId):""}),i.jsx("td",{className:"p-2 border align-top",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] md:text-xs ${Z.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:Z.status})}),i.jsx("td",{className:"p-2 border align-top",children:ee?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Te,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Se,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-1 justify-center flex-wrap",children:[Z.status==="PENDIENTE"&&i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:()=>O(Z),children:"Pagar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 text-black hover:bg-yellow-500 text-xs",onClick:()=>ae(Z),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>G(Z),children:"Borrar"})]})})]},Z.id)})})]})}),i.jsx("div",{className:"mt-3 flex justify-end",children:i.jsx("button",{className:"px-3 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>L(S,F),children:"Borrar producto (todos los lotes)"})})]})})]})}const V5=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],No=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Ay(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function Q$(t){const e=er(_t(Fe,"ar_movements"),cr("ref.saleId","==",t)),r=await Qt(e);await Promise.all(r.docs.map(n=>Fn(Yt(Fe,"ar_movements",n.id))))}function J9e({role:t="",roles:e,sellerCandyId:r="",currentUserEmail:n}){const a=e&&e.length?e:t,s=String(r||"").trim(),o=sn(a,"vendedor_dulces"),l=sn(a,"admin"),[c,u]=x.useState([]),[d,f]=x.useState(!1),[A,h]=x.useState(""),[m,p]=x.useState(""),[g,v]=x.useState(""),[y,b]=x.useState(""),[w,j]=x.useState(!1),[I,_]=x.useState(!1),[S,E]=x.useState(null),[F,k]=x.useState([]),P=async Le=>{var tt;j(!0),_(!0),E(Le),k([]);try{const Nt=await Bs(Yt(Fe,"sales_candies",Le));let Et=null;Nt.exists()?Et=Nt.data():Et=(tt=(await Qt(er(_t(Fe,"sales_candies"),cr("name","==",Le)))).docs[0])==null?void 0:tt.data();const ut=(Array.isArray(Et==null?void 0:Et.items)?Et.items:Et!=null&&Et.item?[Et.item]:[]).map(Mt=>({productName:String(Mt.productName||""),qty:Number(Mt.qty||0),unitPrice:Number(Mt.unitPrice||0),discount:Number(Mt.discount||0),total:Number(Mt.total||0)}));k(ut)}catch(Nt){console.error(Nt)}finally{_(!1)}},[D,X]=x.useState(""),[pe,ge]=x.useState("+505 "),[fe,xe]=x.useState(""),[ae,Se]=x.useState(""),[Te,O]=x.useState("ACTIVO"),[G,z]=x.useState(0),[L,Z]=x.useState(""),[ee,R]=x.useState(0),[H,ne]=x.useState([]),[ve,U]=x.useState(!0),[He,se]=x.useState(""),[re,Pe]=x.useState(null),[ue,we]=x.useState(""),[Me,ze]=x.useState("+505 "),[yt,It]=x.useState(""),[Ke,wt]=x.useState(""),[At,bt]=x.useState("ACTIVO"),[ke,Ne]=x.useState(0),[Ve,he]=x.useState(""),[le,Be]=x.useState(!1),[je,Ae]=x.useState(null),[Qe,Ct]=x.useState(!1),[pt,me]=x.useState([]),[te,ie]=x.useState({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),[$e,de]=x.useState(!1),[Ce,nt]=x.useState(0),[vt,ht]=x.useState(new Date().toISOString().slice(0,10)),[xt,Xe]=x.useState(""),[be,st]=x.useState(!1),[K,Ie]=x.useState(null),[Ze,at]=x.useState(""),[it,T]=x.useState(0),[M,V]=x.useState(""),[q,Y]=x.useState(!1),[oe,De]=x.useState(null),[We,dt]=x.useState(!1),[Oe,et]=x.useState(!1),[mt,Tt]=x.useState(null);x.useEffect(()=>{(async()=>{try{if(U(!0),o&&!s){ne([]),se(" Este usuario no tiene vendedor asociado (sellerCandyId vaco).");return}const Le=await Qt(_t(Fe,"sellers_candies")),tt=[];Le.forEach(ut=>{const Mt=ut.data(),Rt=String(Mt.status||"ACTIVO");Rt==="ACTIVO"&&tt.push({id:ut.id,name:String(Mt.name||""),status:Rt})}),u(tt);const Nt=o?er(_t(Fe,"customers_candies"),cr("vendorId","==",s),dn("createdAt","desc")):er(_t(Fe,"customers_candies"),dn("createdAt","desc")),Et=await Qt(Nt),gt=[];Et.forEach(ut=>{const Mt=ut.data();gt.push({id:ut.id,name:Mt.name??"",phone:Mt.phone??"+505 ",place:Mt.place??"",notes:Mt.notes??"",status:Mt.status??"ACTIVO",creditLimit:Number(Mt.creditLimit??0),createdAt:Mt.createdAt??dr.now(),balance:0,sellerId:Mt.sellerId||"",vendorId:Mt.vendorId||"",vendorName:Mt.vendorName||"",initialDebt:Number(Mt.initialDebt||0),initialDebtDate:String(Mt.initialDebtDate||"").trim(),lastAbonoDate:"",lastAbonoAmount:0})});for(const ut of gt)try{const Mt=er(_t(Fe,"ar_movements"),cr("customerId","==",ut.id)),Rt=await Qt(Mt);let Jt=0,Lt=null;const Wt=[];Rt.forEach(on=>{var jn,Un,ti;const Nn=on.data(),la=Number(Nn.amount||0);Jt+=la;const Kn=Nn.date??((Un=(jn=Nn.createdAt)==null?void 0:jn.toDate)!=null&&Un.call(jn)?Nn.createdAt.toDate().toISOString().slice(0,10):"");if(Wt.push({id:on.id,date:Kn,type:Nn.type??(la<0?"ABONO":"CARGO"),amount:la,ref:Nn.ref||{},comment:Nn.comment||"",createdAt:Nn.createdAt}),la<0){const Fs=(ti=Nn.createdAt)!=null&&ti.seconds?Number(Nn.createdAt.seconds):0;(!Lt||Fs>=Lt.ts)&&(Lt={date:Kn,amount:Math.abs(la),ts:Fs})}});const Tr=Number(ut.initialDebt||0),Ur=Fr(Tr,String(ut.initialDebtDate||""),Wt);ut.balance=Ur+Jt,Lt?(ut.lastAbonoDate=Lt==null?void 0:Lt.date,ut.lastAbonoAmount=Lt==null?void 0:Lt.amount):(ut.lastAbonoDate="",ut.lastAbonoAmount=0)}catch{ut.balance=Number(ut.initialDebt||0),ut.lastAbonoDate="",ut.lastAbonoAmount=0}ne(gt)}catch(Le){console.error(Le),se(" Error cargando clientes.")}finally{U(!1)}})()},[o,s]);const Pt=()=>{X(""),ge("+505 "),xe(""),Se(""),O("ACTIVO"),z(0),Z(""),R(0)},Ft=async Le=>{var gt;if(Le.preventDefault(),se(""),!D.trim()){se("Ingresa el nombre.");return}const tt=Ay(pe);if(tt.length<6){se("Telfono incompleto.");return}const Nt=o?s:String(L||"").trim(),Et=Nt&&((gt=c.find(ut=>ut.id===Nt))==null?void 0:gt.name)||"";try{const ut=Number(ee||0),Mt=await On(_t(Fe,"customers_candies"),{name:D.trim(),phone:tt,place:fe||"",notes:ae||"",status:Te,creditLimit:Number(G||0),vendorId:Nt,vendorName:Et,initialDebt:ut,createdAt:dr.now()});ne(Rt=>[{id:Mt.id,name:D.trim(),phone:tt,place:fe||"",notes:ae||"",status:Te,creditLimit:Number(G||0),vendorId:Nt,vendorName:Et,initialDebt:ut,createdAt:dr.now(),balance:ut,lastAbonoDate:"",lastAbonoAmount:0},...Rt]),Pt(),Y(!1),se(" Cliente creado")}catch(ut){console.error(ut),se(" Error al crear cliente")}},Xt=Le=>{if(o){se(" No permitido: vendedores no editan clientes desde el listado.");return}Pe(Le.id),we(Le.name),ze(Le.phone||"+505 "),It(Le.place||""),wt(Le.notes||""),bt(Le.status||"ACTIVO"),Ne(Number(Le.creditLimit||0)),he(String(Le.vendorId||""))},mr=()=>{Pe(null),we(""),ze("+505 "),It(""),wt(""),bt("ACTIVO"),Ne(0),he("")},Yr=async()=>{var Mt;if(o){se(" No permitido.");return}if(!re)return;const Le=Ay(Me);if(!ue.trim()){se("Ingresa el nombre.");return}const tt=H.find(Rt=>Rt.id===re),Nt=String((tt==null?void 0:tt.vendorId)||""),Et=o?s:String(Ve||"");if(o&&Nt&&Nt!==s){se(" Este cliente pertenece a otro vendedor.");return}if(l&&Nt&&Et&&Nt!==Et){se(" Este cliente ya est asociado a otro vendedor. Primero desasocia (deja vendedor en ) y guarda; luego lo puedes asignar.");return}const gt=o?s:String(Ve||""),ut=gt&&((Mt=c.find(Rt=>Rt.id===gt))==null?void 0:Mt.name)||"";try{await pn(Yt(Fe,"customers_candies",re),{name:ue.trim(),phone:Le,place:yt||"",notes:Ke||"",status:At,creditLimit:Number(ke||0),vendorId:gt,vendorName:ut}),ne(Rt=>Rt.map(Jt=>Jt.id===re?{...Jt,name:ue.trim(),phone:Le,place:yt||"",notes:Ke||"",status:At,creditLimit:Number(ke||0),vendorId:gt,vendorName:ut}:Jt)),mr(),se(" Cliente actualizado")}catch(Rt){console.error(Rt),se(" Error al actualizar")}},Br=async Le=>{if(confirm(`Eliminar al cliente "${Le.name}"?
Se devolvern al inventario todos los dulces de sus compras y se borrarn sus movimientos.`))try{U(!0);const Nt=er(_t(Fe,"sales_candies"),cr("customerId","==",Le.id)),Et=await Qt(Nt);for(const Mt of Et.docs){const Rt=Mt.id;try{await R2(Rt)}catch(Jt){console.warn("restoreSaleAndDeleteCandy error",Jt);try{await Fn(Yt(Fe,"sales_candies",Rt))}catch{}}await Q$(Rt)}const gt=er(_t(Fe,"ar_movements"),cr("customerId","==",Le.id)),ut=await Qt(gt);await Promise.all(ut.docs.map(Mt=>Fn(Yt(Fe,"ar_movements",Mt.id)))),await Fn(Yt(Fe,"customers_candies",Le.id)),ne(Mt=>Mt.filter(Rt=>Rt.id!==Le.id)),se(" Cliente eliminado y dulces devueltos al inventario")}catch(Nt){console.error(Nt),se(" No se pudo eliminar el cliente.")}finally{U(!1)}},Fr=(Le,tt,Nt)=>{const Et=Number(Le||0);if(!Et)return 0;const gt=String(tt||"").trim();return gt&&Nt.some(Mt=>{var Tr;const Rt=Number(Mt.amount||0);if(!(Rt>0))return!1;const Jt=Math.abs(Rt-Et)<.01,Lt=String(Mt.date||"").trim()===gt,Wt=!!((Tr=Mt.ref)!=null&&Tr.saleId);return Jt&&Lt&&Wt})?0:Et},vn=(Le,tt,Nt)=>{const Et=Le.reduce((Jt,Lt)=>Jt+(Number(Lt.amount)||0),0),gt=Le.filter(Jt=>Number(Jt.amount)<0).reduce((Jt,Lt)=>Jt+Math.abs(Number(Lt.amount)||0),0),ut=Le.filter(Jt=>Number(Jt.amount)>0).reduce((Jt,Lt)=>Jt+(Number(Lt.amount)||0),0),Mt=Fr(tt,Nt,Le),Rt=Number(Mt||0)+Et;ie({saldoActual:Rt,totalAbonado:gt,totalCargos:Number(Mt||0)+ut,saldoRestante:Rt})},Ln=async Le=>{Ae(Le),me([]),ie({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),Be(!0),dt(!1),et(!1),Tt(null),de(!1),nt(0),ht(new Date().toISOString().slice(0,10)),Xe(""),Ie(null),Ct(!0);try{const tt=er(_t(Fe,"ar_movements"),cr("customerId","==",Le.id)),Nt=await Qt(tt),Et=[];Nt.forEach(gt=>{var Jt,Lt;const ut=gt.data(),Mt=ut.date??((Lt=(Jt=ut.createdAt)==null?void 0:Jt.toDate)!=null&&Lt.call(Jt)?ut.createdAt.toDate().toISOString().slice(0,10):""),Rt=Number(ut.amount||0);Et.push({id:gt.id,date:Mt,type:ut.type??(Rt<0?"ABONO":"CARGO"),amount:Rt,ref:ut.ref||{},comment:ut.comment||"",createdAt:ut.createdAt})}),Et.sort((gt,ut)=>{var Jt,Lt;if(gt.date!==ut.date)return gt.date.localeCompare(ut.date);const Mt=((Jt=gt.createdAt)==null?void 0:Jt.seconds)||0,Rt=((Lt=ut.createdAt)==null?void 0:Lt.seconds)||0;return Mt-Rt}),me(Et),vn(Et,Number(Le.initialDebt||0),String(Le.initialDebtDate||""))}catch(tt){console.error(tt),se(" No se pudo cargar el estado de cuenta")}finally{Ct(!1)}},yn=Le=>{const tt=Le.filter(Nt=>Number(Nt.amount)<0).map(Nt=>{var Et;return{date:Nt.date,amount:Math.abs(Number(Nt.amount||0)),ts:((Et=Nt.createdAt)==null?void 0:Et.seconds)||0}}).sort((Nt,Et)=>(Nt.ts||0)-(Et.ts||0));return tt.length?tt[tt.length-1]:null},In=x.useMemo(()=>Fr(Number((je==null?void 0:je.initialDebt)||0),String((je==null?void 0:je.initialDebtDate)||""),pt),[je==null?void 0:je.initialDebt,je==null?void 0:je.initialDebtDate,pt]),Ua=async()=>{if(!je)return;se("");const Le=Number(Ce||0);if(!(Le>0)){se("Ingresa un monto de abono mayor a 0.");return}const tt=parseFloat(Le.toFixed(2));if(!vt){se("Selecciona la fecha del abono.");return}try{st(!0);const Nt={customerId:je.id,type:"ABONO",amount:-tt,date:vt,comment:xt||"",createdAt:dr.now()},gt={id:(await On(_t(Fe,"ar_movements"),Nt)).id,date:vt,type:"ABONO",amount:-tt,comment:xt||"",createdAt:dr.now()},ut=[...pt,gt].sort((Lt,Wt)=>{var on,Nn;if(Lt.date!==Wt.date)return Lt.date.localeCompare(Wt.date);const Tr=((on=Lt.createdAt)==null?void 0:on.seconds)||0,Ur=((Nn=Wt.createdAt)==null?void 0:Nn.seconds)||0;return Tr-Ur});me(ut),vn(ut,Number(je.initialDebt||0),String(je.initialDebtDate||""));const Mt=ut.reduce((Lt,Wt)=>Lt+(Number(Wt.amount)||0),0),Rt=Fr(Number(je.initialDebt||0),String(je.initialDebtDate||""),ut),Jt=Number(Rt||0)+Mt;ne(Lt=>Lt.map(Wt=>Wt.id!==je.id?Wt:{...Wt,balance:Jt,lastAbonoDate:vt,lastAbonoAmount:tt})),Ae(Lt=>Lt&&{...Lt,balance:Jt,lastAbonoDate:vt,lastAbonoAmount:tt}),nt(0),Xe(""),ht(new Date().toISOString().slice(0,10)),de(!1),se(" Abono registrado")}catch(Nt){console.error(Nt),se(" Error al registrar el abono")}finally{st(!1)}},Je=Le=>{Ie(Le.id),at(Le.date||new Date().toISOString().slice(0,10)),T(Math.abs(Number(Le.amount||0))),V(Le.comment||"")},Ot=()=>{Ie(null),at(""),T(0),V("")},Kt=async()=>{if(!K||!je)return;const Le=pt.findIndex(gt=>gt.id===K);if(Le===-1)return;const tt=pt[Le],Nt=Number(it||0);if(!(Nt>0)){se("El monto debe ser mayor a 0.");return}const Et=tt.type==="ABONO"?-parseFloat(Nt.toFixed(2)):+parseFloat(Nt.toFixed(2));try{await pn(Yt(Fe,"ar_movements",K),{date:Ze,amount:Et,comment:M||""});const gt=[...pt];gt[Le]={...tt,date:Ze,amount:Et,comment:M||""},gt.sort((Lt,Wt)=>{var on,Nn;if(Lt.date!==Wt.date)return Lt.date.localeCompare(Wt.date);const Tr=((on=Lt.createdAt)==null?void 0:on.seconds)||0,Ur=((Nn=Wt.createdAt)==null?void 0:Nn.seconds)||0;return Tr-Ur}),me(gt),vn(gt,Number(je.initialDebt||0),String(je.initialDebtDate||""));const ut=gt.reduce((Lt,Wt)=>Lt+(Number(Wt.amount)||0),0),Mt=Fr(Number(je.initialDebt||0),String(je.initialDebtDate||""),gt),Rt=Number(Mt||0)+ut,Jt=yn(gt);ne(Lt=>Lt.map(Wt=>Wt.id===je.id?{...Wt,balance:Rt,lastAbonoDate:(Jt==null?void 0:Jt.date)||"",lastAbonoAmount:(Jt==null?void 0:Jt.amount)||0}:Wt)),Ae(Lt=>Lt&&{...Lt,balance:Rt,lastAbonoDate:(Jt==null?void 0:Jt.date)||"",lastAbonoAmount:(Jt==null?void 0:Jt.amount)||0}),Ot(),se(" Movimiento actualizado")}catch(gt){console.error(gt),se(" Error al actualizar movimiento")}},ar=async Le=>{var Nt,Et;if(confirm(`Eliminar este movimiento (${Le.type==="ABONO"?"Abono":"Compra"}) del ${Le.date}?${Le.type==="CARGO"&&((Nt=Le.ref)!=null&&Nt.saleId)?`
Se devolvern al inventario los dulces de esa venta.`:""}`)&&je)try{if(U(!0),Le.type==="CARGO"&&((Et=Le.ref)!=null&&Et.saleId)){try{await R2(Le.ref.saleId)}catch(Lt){console.warn("restoreSaleAndDeleteCandy error",Lt),U(!1),se(" No se pudo devolver inventario de la venta.");return}await Q$(Le.ref.saleId)}else await Fn(Yt(Fe,"ar_movements",Le.id));const gt=pt.filter(Lt=>{var Wt,Tr;return Le.type==="CARGO"&&((Wt=Le.ref)!=null&&Wt.saleId)?((Tr=Lt.ref)==null?void 0:Tr.saleId)!==Le.ref.saleId:Lt.id!==Le.id});me(gt),vn(gt,Number(je.initialDebt||0),String(je.initialDebtDate||""));const ut=gt.reduce((Lt,Wt)=>Lt+(Number(Wt.amount)||0),0),Mt=Fr(Number(je.initialDebt||0),String(je.initialDebtDate||""),gt),Rt=Number(Mt||0)+ut,Jt=yn(gt);ne(Lt=>Lt.map(Wt=>Wt.id===je.id?{...Wt,balance:Rt,lastAbonoDate:(Jt==null?void 0:Jt.date)||"",lastAbonoAmount:(Jt==null?void 0:Jt.amount)||0}:Wt)),Ae(Lt=>Lt&&{...Lt,balance:Rt,lastAbonoDate:(Jt==null?void 0:Jt.date)||"",lastAbonoAmount:(Jt==null?void 0:Jt.amount)||0}),Tt(null),se(" Movimiento eliminado")}catch(gt){console.error(gt),se(" Error al eliminar movimiento")}finally{U(!1)}},Ar=x.useMemo(()=>[...H].sort((Le,tt)=>{var Nt,Et;return Le.status!==tt.status?Le.status==="BLOQUEADO"?1:-1:(((Nt=tt.createdAt)==null?void 0:Nt.seconds)||0)-(((Et=Le.createdAt)==null?void 0:Et.seconds)||0)}),[H]),ft=Le=>Le==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700",lr=x.useMemo(()=>{const Le=A.trim().toLowerCase(),tt=g.trim()===""?null:Number(g),Nt=y.trim()===""?null:Number(y);return Ar.filter(Et=>{const gt=!Le||String(Et.name||"").toLowerCase().includes(Le),ut=!m||Et.status===m,Mt=Number(Et.balance||0),Rt=tt===null||!Number.isNaN(tt)&&Mt>=tt,Jt=Nt===null||!Number.isNaN(Nt)&&Mt<=Nt;return gt&&ut&&Rt&&Jt})},[Ar,A,m,g,y]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Dulces)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>{Y(!0),o&&Z(s)},type:"button",children:"Crear Cliente"})]}),i.jsxs("div",{className:"mb-3",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 border w-full md:w-auto",onClick:()=>f(Le=>!Le),children:d?"Ocultar filtros":"Mostrar filtros"}),d&&i.jsxs("div",{className:"mt-2 bg-white border rounded-xl p-3 grid grid-cols-1 md:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Cliente"}),i.jsx("input",{className:"w-full border p-2 rounded",value:A,onChange:Le=>h(Le.target.value),placeholder:"Buscar por nombre"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:Le=>p(Le.target.value||""),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Monto mn."}),i.jsx("input",{className:"w-full border p-2 rounded text-right",inputMode:"decimal",value:g,onChange:Le=>v(Le.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Monto mx."}),i.jsx("input",{className:"w-full border p-2 rounded text-right",inputMode:"decimal",value:y,onChange:Le=>b(Le.target.value),placeholder:""})]})]}),i.jsx("div",{className:"md:col-span-4 flex flex-wrap gap-2 justify-end",children:i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 border",onClick:()=>{h(""),p(""),v(""),b("")},children:"Limpiar"})})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:ve?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Cargando"})}):lr.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Sin clientes"})}):lr.map(Le=>{var Nt;const tt=re===Le.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(Nt=Le.createdAt)!=null&&Nt.toDate?Le.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border text-left",children:tt?i.jsx("input",{className:"w-full border p-1 rounded",value:ue,onChange:Et=>we(Et.target.value)}):i.jsx("div",{className:"font-medium",children:Le.name})}),i.jsx("td",{className:"p-2 border",children:tt?i.jsx("input",{className:"w-full border p-1 rounded",value:Me,onChange:Et=>ze(Ay(Et.target.value))}):Le.phone}),i.jsx("td",{className:"p-2 border",children:tt?i.jsxs("select",{className:"w-full border p-1 rounded text-xs",value:o?s:Ve,onChange:Et=>he(Et.target.value),disabled:o,title:"Vendedor asociado",children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(Et=>i.jsx("option",{value:Et.id,children:Et.name},Et.id))]}):Le.vendorName||""}),i.jsx("td",{className:"p-2 border",children:tt?i.jsxs("select",{className:"w-full border p-1 rounded",value:yt,onChange:Et=>It(Et.target.value),children:[i.jsx("option",{value:"",children:""}),V5.map(Et=>i.jsx("option",{value:Et,children:Et},Et))]}):Le.place||""}),i.jsx("td",{className:"p-2 border",children:tt?i.jsxs("select",{className:"w-full border p-1 rounded",value:At,onChange:Et=>bt(Et.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ft(Le.status)}`,children:Le.status})}),i.jsx("td",{className:"p-2 border",children:tt?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(ke)?"":ke,onChange:Et=>Ne(Math.max(0,Number(Et.target.value||0)))}):No(Le.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:No(Le.balance||0)}),i.jsx("td",{className:"p-2 border",children:tt?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:Ke,onChange:Et=>wt(Et.target.value),maxLength:500}):i.jsx("span",{title:Le.notes||"",children:(Le.notes||"").length>40?(Le.notes||"").slice(0,40)+"":Le.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:tt?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Yr,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:mr,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Xt(Le),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>Br(Le),disabled:!l,title:l?"Borrar":"Solo admin",children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>Ln(Le),children:"Estado de cuenta"})]})})})]},Le.id)})})]})}),i.jsx("div",{className:"md:hidden",children:ve?i.jsx("div",{className:"p-4 text-center text-sm",children:"Cargando"}):lr.length===0?i.jsx("div",{className:"p-4 text-center text-sm",children:"Sin clientes"}):i.jsx("div",{className:"space-y-2",children:lr.map(Le=>{const tt=oe===Le.id,Nt=re===Le.id,Et=i.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] ${ft(Le.status)}`,children:Le.status});return i.jsxs("div",{className:"border rounded-2xl shadow-sm bg-white overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between gap-2 text-left",onClick:()=>{se(""),!Nt&&De(gt=>gt===Le.id?null:Le.id)},children:[i.jsx("div",{className:"min-w-0 flex-1",children:i.jsx("div",{className:"truncate font-semibold",children:Le.name})}),i.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[11px] text-gray-500 leading-3",children:"Pendiente"}),i.jsx("div",{className:"font-semibold leading-4",children:No(Le.balance||0)})]}),Et]})]}),tt&&i.jsxs("div",{className:"px-3 pb-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"ltimo abono"}),i.jsx("div",{className:"font-medium",children:Le.lastAbonoDate?Le.lastAbonoDate:""}),i.jsx("div",{className:"text-[12px] text-gray-700",children:Le.lastAbonoAmount?No(Le.lastAbonoAmount):""})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Saldo pendiente"}),i.jsx("div",{className:"text-lg font-bold",children:No(Le.balance||0)})]})]}),Nt?i.jsxs("div",{className:"mt-3 space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded-xl",value:ue,onChange:gt=>we(gt.target.value)})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded-xl",value:Me,onChange:gt=>ze(Ay(gt.target.value))})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded-xl",value:At,onChange:gt=>bt(gt.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded-xl",value:yt,onChange:gt=>It(gt.target.value),children:[i.jsx("option",{value:"",children:""}),V5.map(gt=>i.jsx("option",{value:gt,children:gt},gt))]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded-xl",value:o?s:Ve,onChange:gt=>he(gt.target.value),disabled:o,children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(gt=>i.jsx("option",{value:gt.id,children:gt.name},gt.id))]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lmite"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded-xl text-right",value:Number.isNaN(ke)?"":ke,onChange:gt=>Ne(Math.max(0,Number(gt.target.value||0)))})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded-xl min-h-24 resize-y",value:Ke,onChange:gt=>wt(gt.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-blue-600 hover:bg-blue-700",onClick:Yr,type:"button",children:"Guardar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-gray-200 hover:bg-gray-300",onClick:()=>{mr(),De(null)},type:"button",children:"Cancelar"})]})]}):i.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Xt(Le),type:"button",children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>Br(Le),disabled:!l,title:l?"Borrar":"Solo admin",type:"button",children:"Borrar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>Ln(Le),type:"button",children:"Estado"})]})]})]},Le.id)})})})]}),He&&i.jsx("p",{className:"mt-2 text-sm",children:He}),q&&pu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Y(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Y(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:Ft,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:D,onChange:Le=>X(Le.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:pe,onChange:Le=>ge(Ay(Le.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:fe,onChange:Le=>xe(Le.target.value),children:[i.jsx("option",{value:"",children:""}),V5.map(Le=>i.jsx("option",{value:Le,children:Le},Le))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:Te,onChange:Le=>O(Le.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor asociado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o?s:L,onChange:Le=>Z(Le.target.value),disabled:o,children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(Le=>i.jsx("option",{value:Le.id,children:Le.name},Le.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Deuda inicial"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ee===0?"":ee,onChange:Le=>R(Math.max(0,Number(Le.target.value||0))),placeholder:"Ej: 1500"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este valor cuenta como saldo desde el inicio."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:G===0?"":G,onChange:Le=>z(Math.max(0,Number(Le.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:ae,onChange:Le=>Se(Le.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[ae.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Y(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),le&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4 max-h-[92vh] overflow-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(je==null?void 0:je.name)||""]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{nt(0),ht(new Date().toISOString().slice(0,10)),Xe(""),de(!0)},children:"Abonar"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Be(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"hidden md:block",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Deuda inicial"}),i.jsx("div",{className:"text-xl font-semibold",children:No(Number(In||0))})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:No(te.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:No(te.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:No(te.saldoRestante)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Referencia"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:Qe?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):pt.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):pt.map(Le=>{var Nt,Et;const tt=K===Le.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:tt?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:Ze,onChange:gt=>at(gt.target.value)}):Le.date||""}),i.jsx("td",{className:"p-2 border",children:Le.amount>=0?(Nt=Le.ref)!=null&&Nt.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",title:"Ver dulces de esta compra",onClick:()=>P(Le.ref.saleId),children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:(Et=Le.ref)!=null&&Et.saleId?`Venta #${Le.ref.saleId}`:""}),i.jsx("td",{className:"p-2 border",children:tt?i.jsx("input",{className:"w-full border p-1 rounded",value:M,onChange:gt=>V(gt.target.value),placeholder:"Comentario"}):i.jsx("span",{title:Le.comment||"",children:(Le.comment||"").length>40?(Le.comment||"").slice(0,40)+"":Le.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:tt?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(it)?"":it,onChange:gt=>{const ut=Number(gt.target.value||0),Mt=Number.isFinite(ut)?Math.max(0,parseFloat(ut.toFixed(2))):0;T(Mt)},placeholder:"0.00"}):No(Le.amount)}),i.jsx("td",{className:"p-2 border",children:tt?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Kt,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Ot,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Je(Le),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>ar(Le),children:"Borrar"})]})})]},Le.id)})})]})})]}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsxs("div",{className:"border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>dt(Le=>!Le),children:[i.jsx("div",{className:"font-semibold",children:"Estado de cuenta"}),i.jsx("div",{className:"text-sm text-gray-500",children:We?"Ocultar":"Ver"})]}),We&&i.jsxs("div",{className:"px-3 pb-3 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Deuda inicial"}),i.jsx("div",{className:"font-bold",children:No(Number(In||0))})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Saldo actual"}),i.jsx("div",{className:"font-bold",children:No(te.saldoActual)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Total abonado"}),i.jsx("div",{className:"font-bold",children:No(te.totalAbonado)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Saldo restante"}),i.jsx("div",{className:"font-bold",children:No(te.saldoRestante)})]})]})]}),i.jsxs("div",{className:"border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>et(Le=>!Le),children:[i.jsx("div",{className:"font-semibold",children:"Movimientos"}),i.jsx("div",{className:"text-sm text-gray-500",children:Oe?"Ocultar":"Ver"})]}),Oe&&i.jsx("div",{className:"px-3 pb-3 space-y-2",children:Qe?i.jsx("div",{className:"text-center text-sm p-3",children:"Cargando"}):pt.length===0?i.jsx("div",{className:"text-center text-sm p-3",children:"Sin movimientos"}):pt.map(Le=>{var ut;const tt=mt===Le.id,Nt=K===Le.id,Et=Le.amount>=0?"CARGO":"ABONO",gt=Le.amount>=0?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700";return i.jsxs("div",{className:"border rounded-2xl overflow-hidden bg-white",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between gap-2 text-left",onClick:()=>{Nt||Tt(Mt=>Mt===Le.id?null:Le.id)},children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[11px] text-gray-500 leading-3",children:"Fecha"}),i.jsx("div",{className:"font-semibold",children:Le.date||""})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] ${gt}`,children:Et}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[11px] text-gray-500 leading-3",children:"Monto"}),i.jsx("div",{className:"font-semibold",children:No(Le.amount)})]})]})]}),tt&&i.jsxs("div",{className:"px-3 pb-3 space-y-2",children:[i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Referencia"}),i.jsx("div",{className:"font-medium",children:(ut=Le.ref)!=null&&ut.saleId?`Venta #${Le.ref.saleId}`:""})]}),i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Comentario"}),Nt?i.jsx("input",{className:"w-full border p-2 rounded-xl",value:M,onChange:Mt=>V(Mt.target.value),placeholder:"Comentario"}):i.jsx("div",{className:"font-medium",children:(Le.comment||"").trim()||""})]}),Nt&&i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded-xl",value:Ze,onChange:Mt=>at(Mt.target.value)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded-xl text-right",value:Number.isNaN(it)?"":it,onChange:Mt=>{const Rt=Number(Mt.target.value||0),Jt=Number.isFinite(Rt)?Math.max(0,parseFloat(Rt.toFixed(2))):0;T(Jt)}})]})]}),Nt?i.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-1",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-blue-600 hover:bg-blue-700",onClick:Kt,type:"button",children:"Guardar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-gray-200 hover:bg-gray-300",onClick:Ot,type:"button",children:"Cancelar"})]}):i.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-1",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Je(Le),type:"button",children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-red-600 hover:bg-red-700",onClick:()=>ar(Le),type:"button",children:"Borrar"})]})]})]},Le.id)})})]})]}),$e&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(je==null?void 0:je.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:vt,onChange:Le=>ht(Le.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Ce===0?"":Ce,onChange:Le=>{const tt=Number(Le.target.value||0),Nt=Number.isFinite(tt)?Math.max(0,parseFloat(tt.toFixed(2))):0;nt(Nt)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se registrar como ABONO (negativo) con 2 decimales."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:xt,onChange:Le=>Xe(Le.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[xt.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>de(!1),disabled:be,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:Ua,disabled:be,children:be?"Guardando...":"Guardar abono"})]})]})})]})}),w&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[65]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Dulces vendidos"," ",S?` #${S}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>j(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:I?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):F.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):F.map((Le,tt)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:Le.productName}),i.jsx("td",{className:"p-2 border text-right",children:Le.qty}),i.jsx("td",{className:"p-2 border text-right",children:No(Le.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:No(Le.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:No(Le.total)})]},tt))})]})})]})})]})}const Cc=t=>`C$ ${(Number(t)||0).toFixed(2)}`,Z9e=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas","Pull","Tilgue","Balge","Santa Cruz","Moyogalpa","Santo Domingo","San Jos del Sur","San Fernando","Merida","La Paloma","San Lorenzo","San Carlos","San Miguel"];function eQe(t){switch(t){case"RIVAS":return"Rivas";case"SAN_JORGE":return"San Jorge";case"ISLA":return"Isla de Ometepe";default:return""}}function tQe(t){switch(t){case"Rivas":return"RIVAS";case"San Jorge":return"SAN_JORGE";case"Isla Ometepe":return"ISLA";default:return"RIVAS"}}function rQe(t){const{saleId:e,date:r,customerName:n,branch:a,items:s,total:o,vendorName:l,vendorCommissionPercent:c,vendorCommissionAmount:u}=t,d=new Rr;let f=12;if(d.setFontSize(16),d.text("Multiservicios Ortiz",10,f),f+=6,d.setFontSize(12),d.text("Recibo de venta certificada",10,f),f+=8,d.setFontSize(12),d.text(`Fecha: ${r}`,10,f),f+=5,d.text(`Cliente: ${n||"Cliente Mostrador"}`,10,f),f+=5,d.text(`Sucursal: ${eQe(a)}`,10,f),f+=5,d.text(`Autorizado: ${e}`,10,f),f+=5,l&&(d.text(`Vendedor: ${l}`,10,f),f+=5),typeof c=="number"){const A=Number(u||0).toFixed(2),h=c.toFixed(2);d.text(`Comisin vendedor: ${h}%  C$ ${A}`,10,f),f+=8}else f+=3;d.setFontSize(12),d.text("Producto",10,f),d.text("Paquetes",110,f,{align:"right"}),d.text("Precio.",150,f,{align:"right"}),d.text("Subtotal",190,f,{align:"right"}),f+=4,d.line(10,f,190,f),f+=4,s.forEach(A=>{f>270&&(d.addPage(),f=12);const h=(A.productName||"").length>50?A.productName.slice(0,47)+"...":A.productName;d.text(h,10,f),d.text(String(A.qty),110,f,{align:"right"}),d.text(`C$ ${Number(A.unitPrice||0).toFixed(2)}`,150,f,{align:"right"}),d.text(`C$ ${Number(A.total||0).toFixed(2)}`,190,f,{align:"right"}),f+=5}),f+=4,d.line(10,f,190,f),f+=6,d.setFontSize(13),d.text(`Total: C$ ${Number(o||0).toFixed(2)}`,190,f,{align:"right"}),f+=6,d.setFontSize(9),d.text("Gracias por su compra.",10,f),d.save(`venta_dulces_${e}.pdf`)}async function V$(t,e){if(!t||!e)return 0;const r=er(_t(Fe,"inventory_candies_sellers"),cr("sellerId","==",e),cr("productId","==",t)),n=await Qt(r);let a=0;return n.forEach(s=>{const o=s.data(),l=Number(o.remainingUnits??o.remaining??o.totalUnits??0);l>0&&(a+=l)}),a}const H$=()=>{const t=new Date;return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t.toISOString().slice(0,10)};async function nQe(t){const{productId:e,vendorId:r,quantityUnits:n,saleDate:a,saleId:s}=t;let o=Math.max(0,Math.floor(Number(n||0)));const l=[];if(!e||!r||o<=0)return{allocations:[]};const c=er(_t(Fe,"inventory_candies_sellers"),cr("sellerId","==",r),cr("productId","==",e),cr("remainingUnits",">",0),dn("date","asc"),dn("createdAt","asc")),u=await Qt(c);for(const d of u.docs){if(o<=0)break;const f=d.data(),A=Number(f.remainingUnits||0);if(A<=0)continue;const h=Math.min(A,o),m=A-h,p=Math.max(1,Math.floor(Number(f.unitsPerPackage||1))),g=Math.floor(m/p);await pn(d.ref,{remainingUnits:m,remainingPackages:g}),l.push({inventorySellerId:d.id,productId:e,units:h,saleDate:a,saleId:s}),o-=h}return o>0&&console.warn("[allocateSaleFIFOCandyFromVendor] No alcanz el inventario del vendedor, faltaron unidades.",{productId:e,vendorId:r,remaining:o}),{allocations:l}}function $$(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}function aQe({role:t="",roles:e,sellerCandyId:r="",currentUserEmail:n}){const a=e&&e.length?e:t;sn(a,"admin"),sn(a,"vendedor_dulces");const[s,o]=x.useState([]),[l,c]=x.useState([]),[u,d]=x.useState([]),[f,A]=x.useState({}),[h,m]=x.useState("CONTADO"),[p,g]=x.useState("RIVAS"),[v,y]=x.useState(""),[b,w]=x.useState(""),[j,I]=x.useState(H$()),[_,S]=x.useState(""),[E,F]=x.useState(!1),[k,P]=x.useState(""),[D,X]=x.useState([]),[pe,ge]=x.useState(!0),[fe,xe]=x.useState(!1),ae=x.useMemo(()=>D.reduce((K,Ie)=>K+(Ie.qtyPackages||0),0),[D]),Se=x.useMemo(()=>D.reduce((K,Ie)=>K+(Ie.qtyPackages||0)*(Ie.unitsPerPackage||1),0),[D]),Te=x.useMemo(()=>{const K=D.reduce((Ie,Ze)=>{const at=(Number(Ze.pricePerPackage)||0)*(Ze.qtyPackages||0),it=Number(Ze.discount)||0,T=Math.max(0,at-it);return Ie+T},0);return Math.floor(K*100)/100},[D]),[O,G]=x.useState(0),[z,L]=x.useState(""),[Z,ee]=x.useState(!1),[R,H]=x.useState(!1),[ne,ve]=x.useState(""),[U,He]=x.useState("+505 "),[se,re]=x.useState(""),[Pe,ue]=x.useState(""),[we,Me]=x.useState("ACTIVO"),[ze,yt]=x.useState(0),[It,Ke]=x.useState(""),wt=()=>{ve(""),He("+505 "),re(""),ue(""),Me("ACTIVO"),yt(0)},[At,bt]=x.useState(!1),ke=async K=>{const Ie=String(K||"").trim();if(!Ie)return;const Ze=xt.find(M=>String(M.barcode||"")===Ie),at=xt.find(M=>String(M.sku||"")===Ie),it=xt.find(M=>String(M.id||"")===Ie),T=Ze||at||it||null;T?(await $e(T.id),L(" Producto agregado desde escner."),setTimeout(()=>L(""),2500)):(L(" Cdigo no corresponde a ningn producto disponible."),setTimeout(()=>L(""),2500))};function Ne({open:K,onClose:Ie,onDetected:Ze}){const at=x.useRef(null),it=x.useRef(null),[T,M]=x.useState(""),V=x.useRef("");return x.useEffect(()=>{if(!K)return;let q=!1;const Y=new b2,oe=()=>{var We,dt,Oe;try{(We=it.current)==null||We.stop()}catch{}it.current=null;try{const et=(dt=at.current)==null?void 0:dt.srcObject;try{(Oe=et==null?void 0:et.getTracks)==null||Oe.call(et).forEach(mt=>mt.stop())}catch{}}catch{}try{at.current&&(at.current.srcObject=null)}catch{}};return(async()=>{M("");try{if(!at.current)return;try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1})).getTracks().forEach(Oe=>Oe.stop())}catch{}const We=await Y.decodeFromConstraints({video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1},at.current,dt=>{if(!q&&dt){const Oe=String(dt.getText()||"").trim().replace(/\s+/g,"");if(!Oe||Oe===V.current)return;V.current=Oe,oe(),Ze(Oe),Ie()}});it.current=We}catch(We){const dt=String((We==null?void 0:We.message)||""),Oe=String((We==null?void 0:We.name)||"");dt.toLowerCase().includes("permission")||Oe==="NotAllowedError"?M("Permiso de cmara denegado."):Oe==="NotFoundError"||dt.toLowerCase().includes("notfound")?M("No se encontr cmara en este dispositivo."):dt.toLowerCase().includes("secure")||dt.toLowerCase().includes("https")?M("La cmara requiere HTTPS (sitio seguro)."):M(dt||"No se pudo iniciar el escner.")}})(),()=>{var We;q=!0;try{(We=it.current)==null||We.stop()}catch{}it.current=null}},[K,Ie,Ze]),K?i.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 p-3 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-lg border overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[i.jsx("div",{className:"font-bold",children:"Escanear cdigo"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Ie,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"relative w-full aspect-[3/4] bg-black rounded-xl overflow-hidden",children:[i.jsx("video",{ref:at,className:"w-full h-full object-cover",muted:!0,playsInline:!0,autoPlay:!0}),i.jsx("div",{className:"absolute inset-0 pointer-events-none",children:i.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[85%] h-40 border-2 border-white/70 rounded-xl"})})]}),T&&i.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded p-2",children:T}),i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Apunt al cdigo de barras y mantenelo estable."})]})]})}):null}const Ve=x.useMemo(()=>s.find(K=>K.id===v),[s,v]),he=x.useMemo(()=>E&&_?s.filter(K=>(K.vendorId??K.sellerId??"")===_):s,[s,E,_]),le=(Ve==null?void 0:Ve.balance)||0,Be=h==="CREDITO"?le+Math.max(0,Number(Te||0))-Math.max(0,Number(O||0)):0,je=x.useMemo(()=>{if(h!=="CREDITO")return 0;const K=Math.max(0,Number(le||0))+Math.max(0,Number(Te||0));return Math.floor(K*100)/100},[h,le,Te]),Ae=K=>{const Ie=Math.max(0,Number(K||0));return Math.min(Ie,je)},Qe=x.useMemo(()=>u.find(K=>K.id===_)||null,[u,_]),Ct=(Qe==null?void 0:Qe.commissionPercent)||0,pt=x.useMemo(()=>{const K=D.reduce((Ie,Ze)=>Ie+Number(Ze.margenVendedor||0),0);return Number(K.toFixed(2))},[D]);x.useEffect(()=>{(async()=>{const K=er(_t(Fe,"customers_candies"),dn("createdAt","desc")),Ie=await Qt(K),Ze=[];Ie.forEach(M=>{const V=M.data();Ze.push({id:M.id,name:V.name??"",phone:V.phone??"+505 ",place:V.place??"",status:V.status??"ACTIVO",creditLimit:Number(V.creditLimit??0),balance:0,sellerId:V.sellerId??V.vendorId??"",vendorId:V.vendorId??V.sellerId??""})});for(const M of Ze)try{const V=er(_t(Fe,"ar_movements"),cr("customerId","==",M.id)),q=await Qt(V);let Y=0;q.forEach(De=>Y+=Number(De.data().amount||0));const oe=Number(M.initialDebt||0);M.balance=Y+oe}catch{M.balance=0}o(Ze);const at=er(_t(Fe,"products_candies"),dn("createdAt","desc")),it=await Qt(at),T=[];it.forEach(M=>{const V=M.data();T.push({id:M.id,name:V.name??"(sin nombre)",sku:V.sku??"",unitsPerPackage:Number(V.unitsPerPackage??1),barcode:String(V.barcode||""),priceRivas:Number(V.unitPriceRivas??0),priceSanJorge:Number(V.unitPriceSanJorge??0),priceIsla:Number(V.unitPriceIsla??0),providerPrice:Number(V.providerPrice??0),providerPricePerUnit:Number(V.providerPricePerUnit??0)})}),c(T);try{const M=await Qt(_t(Fe,"sellers_candies")),V=[];M.forEach(q=>{const Y=q.data(),oe=Y.branch||"Rivas",De=tQe(oe);V.push({id:q.id,name:Y.name??"(sin nombre)",branch:De,branchLabel:oe,commissionPercent:Number(Y.commissionPercent??0)})}),d(V)}catch(M){console.error("Error cargando vendedores:",M)}A({})})()},[]),x.useEffect(()=>{var Ie,Ze;const K=e&&e.length?e:t;if(K&&((Ie=K.includes)!=null&&Ie.call(K,"vendedor_dulces"))&&r){S(r),F(!0);try{localStorage.setItem("pos_vendorId",r),localStorage.setItem("pos_role","VENDEDOR")}catch{}return}if(K&&((Ze=K.includes)!=null&&Ze.call(K,"admin"))){F(!1);return}try{const at=localStorage.getItem("pos_vendorId")||"",it=localStorage.getItem("pos_role")||"";at&&S(at),it.toUpperCase()==="VENDEDOR"&&F(!0)}catch{}},[t,r]);const me=async K=>{if(!K){A({});return}const Ie=er(_t(Fe,"inventory_candies_sellers"),cr("sellerId","==",K)),Ze=await Qt(Ie),at={};Ze.forEach(it=>{const T=it.data(),M=T.productId||"";if(!M)return;const V=Number(T.remainingUnits??T.remaining??T.totalUnits??0);V<=0||(at[M]=(at[M]||0)+V)}),A(at),X(it=>{const T=[];for(const M of it){const V=at[M.productId]??0;V>0&&T.push({...M,availableUnits:V})}return T})};x.useEffect(()=>{if(!_){A({});return}const K=u.find(Ie=>Ie.id===_);K&&g(K.branch),me(_)},[_,u]),x.useEffect(()=>{X(K=>K.map(Ie=>{const Ze=l.find(it=>it.id===Ie.productId);if(!Ze)return Ie;const at=p==="RIVAS"?Ze.priceRivas:p==="SAN_JORGE"?Ze.priceSanJorge:Ze.priceIsla;return{...Ie,pricePerPackage:Number(at)||0}}))},[p,l]);async function te(K){const{productId:Ie,vendorId:Ze,branch:at}=K;if(!Ie||!Ze)return 0;const it=er(_t(Fe,"inventory_candies_sellers"),cr("sellerId","==",Ze),cr("productId","==",Ie)),T=await Qt(it);if(T.empty)return 0;const M=T.docs[0].data(),V=Number(M.unitPriceVendor??0);if(V>0)return V;const q=Number(at==="RIVAS"?M.unitPriceRivas??0:at==="SAN_JORGE"?M.unitPriceSanJorge??0:M.unitPriceIsla??0);return Number(q||0)}const ie=K=>{const Ie=Number(Ct||0),Ze=Number(K||0)*Ie/100;return Math.max(0,Number(Ze.toFixed(2)))},$e=async K=>{var oe;if(!K)return;if(!_){L("Selecciona primero el vendedor para usar su inventario."),P("");return}if(D.some(De=>De.productId===K)){P("");return}const Ie=l.find(De=>De.id===K);if(!Ie){P("");return}const Ze=await V$(K,_),at=((oe=u.find(De=>De.id===_))==null?void 0:oe.branch)??p,it=await te({productId:K,vendorId:_,branch:at}),M=await(async De=>{const{productId:We,vendorId:dt}=De;if(!We||!dt)return 0;try{const Oe=er(_t(Fe,"inventory_candies_sellers"),cr("sellerId","==",dt),cr("productId","==",We)),et=await Qt(Oe);if(et.empty)return 0;const mt=et.docs[0].data();return Number(mt.providerPrice??0)}catch{return 0}})({productId:K,vendorId:_}),V=(()=>{const De=Number(Ie.providerPrice||0);if(De>0)return De;const We=Number(Ie.providerPricePerUnit||0);return We>0?We*Number(Ie.unitsPerPackage||1):0})(),q=Number(M||0)>0?Number(M||0):Number(V||0),Y={productId:K,productName:Ie.name||"",sku:Ie.sku||"",unitsPerPackage:Ie.unitsPerPackage||1,pricePerPackage:Number(it)||0,availableUnits:Number(Ze)||0,qtyPackages:0,discount:0,providerPricePerPackage:Number(q)||0,margenVendedor:0,uBruta:0};X(De=>[...De,Y]),P("")},de=(K,Ie)=>{X(Ze=>Ze.map(at=>{if(at.productId!==K)return at;if(Ie==="")return{...at,qtyPackages:0};const it=Math.max(0,Math.floor(Number(Ie))),T=f[K]??at.availableUnits??0,M=Math.max(1,Number(at.unitsPerPackage||1)),V=Math.floor(T/M);let q=it;it>V&&(q=V,L(` Solo hay ${V} paquetes disponibles.`),setTimeout(()=>L(""),2500));const Y=Number(at.pricePerPackage||0)*q,oe=Number(at.providerPricePerPackage||0)*q,De=Y-oe,We=ie(De);return{...at,qtyPackages:q,margenVendedor:We,uBruta:De}}))},Ce=(K,Ie)=>{X(Ze=>Ze.map(at=>{if(at.productId!==K)return at;if(Ie==="")return{...at,discount:0};const it=Math.max(0,Math.floor(Number(Ie))),T=at.qtyPackages||0,M=Number(at.pricePerPackage||0)*T,V=Number(at.providerPricePerPackage||0)*T,q=M-V,Y=ie(q);return{...at,discount:it,margenVendedor:Y,uBruta:q}}))},nt=K=>X(Ie=>Ie.filter(Ze=>Ze.productId!==K)),vt=async()=>{if(!j)return"Selecciona la fecha.";if(!_)return"Selecciona el vendedor para esta venta.";if(D.length===0)return"Agrega al menos un producto.";const K=D.filter(Ie=>(Ie.qtyPackages||0)>0);if(K.length===0)return"Debes ingresar cantidades (> 0) en al menos un producto.";if(!(Te>0))return"El total debe ser mayor a cero.";if(h==="CONTADO"){if(!b.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!v)return"Selecciona un cliente (crdito).";if(O<0)return"El pago inicial no puede ser negativo.";if(O>je)return"El pago inicial no puede superar el saldo a deber (saldo actual + venta).";if((Ve==null?void 0:Ve.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede facturar a crdito."}for(const Ie of K){const Ze=Ie.unitsPerPackage||1,at=(Ie.qtyPackages||0)*Ze,it=await V$(Ie.productId,_),T=Math.floor(it/Ze);if(at>it)return`Inventario insuficiente en el pedido del vendedor para "${Ie.productName}". Disponible: ${T} paquetes.`;const M=(Number(Ie.pricePerPackage)||0)*(Ie.qtyPackages||0),V=Number(Ie.discount)||0;if(!Number.isInteger(V)||V<0)return`El descuento en "${Ie.productName}" debe ser entero y  0.`;if(V>M)return`El descuento en "${Ie.productName}" no puede exceder C$ ${M.toFixed(2)}.`}return null},ht=async K=>{K.preventDefault(),L("");const Ie=await vt();if(Ie){L(" "+Ie);return}try{ee(!0);const Ze=D.filter(V=>(V.qtyPackages||0)>0).map(V=>{const q=V.unitsPerPackage||1,Y=V.qtyPackages||0,oe=Y*q,De=(Number(V.pricePerPackage)||0)*(Y||0),We=Math.max(0,Math.floor(Number(V.discount)||0)),dt=Math.max(0,De-We),Oe=Number(V.providerPricePerPackage||0),et=Oe*Y,mt=De-et,Tt=ie(mt);return{productId:V.productId,productName:V.productName,sku:V.sku||"",qty:oe,packages:Y,unitsPerPackage:q,branch:p,unitPricePackage:Number(V.pricePerPackage)||0,discount:We,total:Math.floor(dt*100)/100,providerPricePerPackage:Oe,margenVendedor:Tt,uBruta:mt}}),at={type:h,branch:p,date:j,createdAt:dr.now(),itemsTotal:Number(Te)||0,total:Number(Te)||0,quantity:Number(Se)||0,packagesTotal:Number(ae)||0,items:Ze,vendorId:_},it=u.find(V=>V.id===_);it&&(at.vendorName=it.name,at.vendorBranch=it.branch,at.vendorBranchLabel=it.branchLabel,at.vendorCommissionPercent=it.commissionPercent||0,at.vendorCommissionAmount=pt||0),h==="CONTADO"?at.customerName=b.trim():(at.customerId=v,at.downPayment=Number(O)||0);const T=await On(_t(Fe,"sales_candies"),at);if(h==="CONTADO"){const V=(b||"").trim();if(V)try{await On(_t(Fe,"cash_customers"),{name:V,date:j,branch:p,vendorId:_,createdAt:dr.now()})}catch(q){console.warn("No se pudo guardar cash_customer:",q)}}if(h==="CREDITO"&&v){const V={customerId:v,date:j,createdAt:dr.now(),ref:{saleId:T.id}};await On(_t(Fe,"ar_movements"),{...V,type:"CARGO",amount:Number(Te)||0}),Number(O)>0&&await On(_t(Fe,"ar_movements"),{...V,type:"ABONO",amount:-Number(O)})}const M={};for(const V of Ze)if(V.qty>0){const{allocations:q}=await nQe({productId:V.productId,vendorId:_,quantityUnits:V.qty,saleDate:j,saleId:T.id});M[V.productId]={productId:V.productId,vendorId:_,allocations:q}}await pn(Yt(Fe,"sales_candies",T.id),{allocationsByItem:M});try{const V=h==="CONTADO"?b.trim()||"Cliente Mostrador":(Ve==null?void 0:Ve.name)||"Cliente crdito";rQe({saleId:T.id,date:j,customerName:V,branch:p,items:Ze.map(q=>({productName:q.productName,qty:q.packages,unitPrice:q.unitPricePackage,total:q.total})),total:Number(Te)||0,vendorName:it==null?void 0:it.name,vendorCommissionPercent:(it==null?void 0:it.commissionPercent)||0,vendorCommissionAmount:pt})}catch(V){console.error("Error generando voucher PDF:",V)}m("CONTADO"),y(""),w(""),I(H$()),X([]),G(0),h==="CREDITO"&&v&&o(V=>V.map(q=>q.id===v?{...q,balance:(q.balance||0)+(Number(Te)||0)-(Number(O)||0)}:q)),L(" Venta de dulces registrada"),_?await me(_):A({})}catch(Ze){console.error(Ze),L(" Error al guardar la venta de dulces")}finally{ee(!1)}},xt=x.useMemo(()=>l.filter(K=>{const Ie=f[K.id]||0,Ze=Math.max(1,Number(K.unitsPerPackage||1));return Math.floor(Ie/Ze)>0}).sort((K,Ie)=>(K.name||"").localeCompare(Ie.name||"")),[l,f]),[Xe,be]=x.useState(""),st=x.useMemo(()=>{const K=String(Xe||"").trim().toLowerCase();return K?xt.filter(Ie=>`${Ie.name||""} ${Ie.sku||""}`.toLowerCase().includes(K)||String(Ie.id||"").includes(K)):xt},[Xe,xt]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Ventas (Dulces)"})}),i.jsxs("form",{onSubmit:ht,className:"bg-white p-3 sm:p-4 rounded shadow border mb-6",children:[i.jsxs("div",{className:"hidden md:grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:K=>m(K.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),h==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre del cliente (contado)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Cliente Mostrador",value:b,onChange:K=>w(K.target.value)})]}):i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[i.jsxs("select",{className:"w-full sm:flex-1 border p-2 rounded",value:v,onChange:K=>y(K.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),he.map(K=>i.jsxs("option",{value:K.status==="ACTIVO"?K.id:"",disabled:K.status==="BLOQUEADO",children:[K.name," | ",K.phone," | Saldo: ",Cc(K.balance||0)]},K.id))]}),i.jsx("button",{type:"button",className:"w-full sm:w-auto px-4 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>H(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:Cc(le)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",max:je,className:"w-full border p-2 rounded",value:O===0?"":O,onChange:K=>{const Ie=Ae(K.target.value);G(Ie)},placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:Cc(Be)})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:j,onChange:K=>I(K.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:_,onChange:K=>{S(K.target.value),X([])},disabled:E,children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),u.map(K=>i.jsxs("option",{value:K.id,children:[K.name,"  ",K.branchLabel,"  ",K.commissionPercent.toFixed(2),"%"," comisin"]},K.id))]}),E&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Vendedor fijado por el usuario logueado."})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Lista de precios / Sucursal"}),i.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"RIVAS",checked:p==="RIVAS",readOnly:!0,disabled:!0}),i.jsx("span",{children:"Rivas"})]}),i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"SAN_JORGE",checked:p==="SAN_JORGE",readOnly:!0,disabled:!0}),i.jsx("span",{children:"San Jorge"})]}),i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"ISLA",checked:p==="ISLA",readOnly:!0,disabled:!0}),i.jsx("span",{children:"Isla de Ometepe"})]})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"La sucursal se toma automticamente del vendedor seleccionado."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("div",{className:"mt-1 mb-2 flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",placeholder:_?"Buscar producto por nombre o SKU":"Selecciona un vendedor primero",value:Xe,onChange:K=>be(K.target.value),disabled:!_}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>bt(!0),disabled:!_,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[i.jsx("rect",{x:"3",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"3",y:"15",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"15",width:"6",height:"6",rx:"1"})]})})]}),i.jsxs("select",{className:"w-full border p-2 rounded",value:k,onChange:async K=>{const Ie=K.target.value;P(Ie),await $e(Ie)},disabled:!_,children:[i.jsx("option",{value:"",children:_?"Selecciona un producto":"Selecciona un vendedor primero"}),st.map(K=>{const Ie=D.some(T=>T.productId===K.id),Ze=f[K.id]||0,at=Math.max(1,Number(K.unitsPerPackage||1)),it=Math.floor(Ze/at);return it<=0?null:i.jsxs("option",{value:Ie?"":K.id,disabled:Ie,children:[K.name," ",K.sku?` ${K.sku}`:""," (disp: ",it," ","paq.)",Ie?" ":""]},K.id)})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"El selector solo muestra productos disponibles del pedido del vendedor seleccionado (sin ceros)."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("div",{className:"border rounded overflow-hidden min-w-[860px]",children:[i.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 px-3 py-2 text-xs font-semibold border-b",children:[i.jsx("div",{className:"col-span-4",children:"Producto"}),i.jsx("div",{className:"col-span-2 text-right",children:"Precio (paq.)"}),i.jsx("div",{className:"col-span-2 text-right",children:"Existencias (paq.)"}),i.jsx("div",{className:"col-span-1 text-right",children:"Cantidad (paq.)"}),i.jsx("div",{className:"col-span-1 text-right",children:"Descuento"}),i.jsx("div",{className:"col-span-1 text-right",children:"Monto"}),i.jsx("div",{className:"col-span-1 text-center",children:"Quitar"})]}),D.length===0?i.jsx("div",{className:"px-3 py-4 text-sm text-gray-500",children:"No hay productos agregados."}):D.map(K=>{const Ie=f[K.productId]??K.availableUnits??0,Ze=K.unitsPerPackage?Math.floor(Ie/K.unitsPerPackage):0,at=Math.max(0,Ze-(K.qtyPackages||0)),it=(Number(K.pricePerPackage)||0)*(K.qtyPackages||0),T=Math.max(0,it-(Number(K.discount)||0));return i.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 border-b text-sm gap-x-2",children:[i.jsx("div",{className:"col-span-4",children:i.jsxs("div",{className:"font-medium",children:[K.productName,K.sku?`  ${K.sku}`:""]})}),i.jsx("div",{className:"col-span-2 text-right",children:Cc(K.pricePerPackage)}),i.jsxs("div",{className:"col-span-2 text-right",children:[at," paq."]}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(K.qtyPackages)||K.qtyPackages===0?"":K.qtyPackages,onChange:M=>de(K.productId,M.target.value),inputMode:"numeric",placeholder:"0"})}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(K.discount)||K.discount===0?"":K.discount,onChange:M=>Ce(K.productId,M.target.value),inputMode:"numeric",placeholder:"0"})}),i.jsx("div",{className:"col-span-1 text-right",children:Cc(T)}),i.jsx("div",{className:"col-span-1 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 hover:bg-red-200",onClick:()=>nt(K.productId),title:"Quitar producto",children:""})})]},K.productId)})]})}),D.length>0&&i.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-2 sm:gap-6 mt-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes totales: "}),i.jsx("span",{className:"font-semibold",children:ae})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Total: "}),i.jsx("span",{className:"font-semibold",children:Cc(Te)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Comisin vendedor: "}),i.jsxs("span",{className:"font-semibold",children:[Cc(pt)," ",Ct?`(${Ct.toFixed(2)}%)`:""]})]})]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{type:"submit",className:"w-full sm:w-auto bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",disabled:Z,children:Z?"Guardando...":"Registrar venta"})})]}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsxs("div",{className:"bg-white rounded-xl border shadow",children:[i.jsxs("button",{type:"button",onClick:()=>ge(K=>!K),className:"w-full flex justify-between items-center p-3 font-semibold",children:["Datos de venta",i.jsx("span",{className:"text-lg",children:pe?"":"+"})]}),pe&&i.jsxs("div",{className:"p-3 space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:j,onChange:K=>I(K.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:K=>m(K.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),h==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (Cash)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mario Bergoglio",value:b,onChange:K=>w(K.target.value)})]}):i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("select",{className:"w-full border p-2 rounded",value:v,onChange:K=>y(K.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),he.map(K=>i.jsxs("option",{value:K.status==="ACTIVO"?K.id:"",disabled:K.status==="BLOQUEADO",children:[K.name," | Saldo: ",Cc(K.balance||0)]},K.id))]}),i.jsx("button",{type:"button",className:"w-full px-4 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>H(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-base font-semibold",children:Cc(le)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-base font-semibold",children:Cc(Be)})]})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",max:je,className:"w-full border p-2 rounded",value:O===0?"":O,onChange:K=>{const Ie=Ae(K.target.value);G(Ie)},placeholder:"0.00"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:_,onChange:K=>{S(K.target.value),X([])},disabled:E,children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),u.map(K=>i.jsxs("option",{value:K.id,children:[K.name,"  "," ",K.commissionPercent.toFixed(2),"%"]},K.id))]}),E&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Vendedor Logueado en esta app."})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl border shadow",children:[i.jsxs("button",{type:"button",onClick:()=>xe(K=>!K),className:"w-full flex justify-between items-center p-3 font-semibold",children:["Agrega Productos",i.jsx("span",{className:"text-lg",children:fe?"":"+"})]}),fe&&i.jsxs("div",{className:"p-3 space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Productos"}),i.jsxs("div",{className:"mt-1 mb-2 flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",placeholder:_?"Buscar producto por nombre o SKU":"Selecciona un vendedor primero",value:Xe,onChange:K=>be(K.target.value),disabled:!_}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>bt(!0),disabled:!_,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[i.jsx("rect",{x:"3",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"3",y:"15",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"15",width:"6",height:"6",rx:"1"})]})})]}),i.jsxs("select",{className:"w-full border p-2 rounded",value:k,onChange:async K=>{const Ie=K.target.value;P(Ie),await $e(Ie)},disabled:!_,children:[i.jsx("option",{value:"",children:_?"Selecciona un producto":"Selecciona un vendedor primero"}),st.map(K=>{const Ie=D.some(T=>T.productId===K.id),Ze=f[K.id]||0,at=Math.max(1,Number(K.unitsPerPackage||1)),it=Math.floor(Ze/at);return it<=0?null:i.jsxs("option",{value:Ie?"":K.id,disabled:Ie,children:[K.name," ",K.sku?` ${K.sku}`:""," (disp:"," ",it," paq.)",Ie?" ":""]},K.id)})]})]}),D.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"No hay productos agregados."}):i.jsx("div",{className:"space-y-2",children:D.map(K=>{const Ie=f[K.productId]??K.availableUnits??0,Ze=K.unitsPerPackage?Math.floor(Ie/K.unitsPerPackage):0,at=Math.max(0,Ze-(K.qtyPackages||0)),it=(Number(K.pricePerPackage)||0)*(K.qtyPackages||0),T=Math.max(0,it-(Number(K.discount)||0));return i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50 space-y-2",children:[i.jsxs("div",{className:"font-semibold leading-tight",children:[K.productName,K.sku?`  ${K.sku}`:""]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"p-2 rounded border bg-white",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Precio x Paquete"}),i.jsx("div",{className:"font-bold",children:Cc(K.pricePerPackage)})]}),i.jsxs("div",{className:"p-2 rounded border bg-white",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Existencias"}),i.jsxs("div",{className:"font-bold",children:[at," paq."]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Cantidad Paquetes"}),i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-2 rounded text-right",value:Number.isNaN(K.qtyPackages)||K.qtyPackages===0?"":K.qtyPackages,onChange:M=>de(K.productId,M.target.value),inputMode:"numeric",placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Descuento"}),i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-2 rounded text-right",value:Number.isNaN(K.discount)||K.discount===0?"":K.discount,onChange:M=>Ce(K.productId,M.target.value),inputMode:"numeric",placeholder:"0"})]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"font-regular text-gray-600",children:["Total ",Cc(T)]}),i.jsxs("div",{className:"font-regular text-gray-600",children:["Comision ",Cc(K.margenVendedor||0)]}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded-lg bg-red-100 hover:bg-red-200",onClick:()=>nt(K.productId),children:"Quitar"})]})]},K.productId)})}),D.length>0&&i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("div",{className:"font-semibold",children:ae})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total"}),i.jsx("div",{className:"font-semibold",children:Cc(Te)})]})]})]})]}),i.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white px-4 py-3 rounded-xl hover:bg-blue-700 disabled:opacity-60",disabled:Z,children:Z?"Guardando...":"Registrar venta"})]})]}),z&&i.jsx("p",{className:"mt-2 text-sm",children:z}),R&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-2 sm:p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[98%] sm:w-[95%] max-w-xl p-3 sm:p-4 max-h-[92vh] overflow-auto",children:[i.jsx("h3",{className:"text-lg font-bold mb-3",children:"Nuevo cliente"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:ne,onChange:K=>ve(K.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:U,onChange:K=>He($$(K.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:se,onChange:K=>re(K.target.value),children:[i.jsx("option",{value:"",children:""}),Z9e.map(K=>i.jsx("option",{value:K,children:K},K))]})]}),!E&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:It,onChange:K=>Ke(K.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),u.filter(K=>(K.status??"ACTIVO")==="ACTIVO").map(K=>i.jsxs("option",{value:K.id,children:[K.name,"  ",K.branchLabel]},K.id))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Pe,onChange:K=>ue(K.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row justify-end gap-2",children:[i.jsx("button",{className:"w-full sm:w-auto px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{wt(),H(!1)},children:"Cancelar"}),i.jsx("button",{className:"w-full sm:w-auto px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:async()=>{var Ze;const K=E?_||r:It;if(!K){L("Selecciona el vendedor para asociar este cliente.");return}if(L(""),!ne.trim()){L("Ingresa el nombre del nuevo cliente.");return}const Ie=$$(U);try{const at=await On(_t(Fe,"customers_candies"),{name:ne.trim(),phone:Ie,place:se||"",notes:Pe||"",status:we,creditLimit:Number(ze||0),createdAt:dr.now(),sellerId:K,vendorId:K,vendorName:((Ze=u.find(T=>T.id===K))==null?void 0:Ze.name)||""}),it={id:at.id,name:ne.trim(),phone:Ie,place:se||"",status:we,creditLimit:Number(ze||0),balance:0,sellerId:K};o(T=>[it,...T]),y(at.id),wt(),H(!1),L(" Cliente creado")}catch(at){console.error(at),L(" Error al crear cliente")}},children:"Guardar cliente"})]})]})}),i.jsx(Ne,{open:At,onClose:()=>bt(!1),onDetected:ke}),Z&&i.jsx("div",{className:"fixed inset-0 z-[70] bg-black/40 flex items-center justify-center p-2",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border px-4 py-3 flex items-center gap-3",children:[i.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-medium",children:"Guardando venta"})]})})]})}const G$=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal"],e_=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function sQe(){const[t,e]=x.useState(Nr(yd(new Date),"yyyy-MM-dd")),[r,n]=x.useState(Nr(vd(new Date),"yyyy-MM-dd")),[a,s]=x.useState(Nr(new Date,"yyyy-MM-dd")),[o,l]=x.useState(""),[c,u]=x.useState(""),[d,f]=x.useState(0),[A,h]=x.useState("PENDIENTE"),[m,p]=x.useState(""),[g,v]=x.useState([]),[y,b]=x.useState(!0),[w,j]=x.useState(""),[I,_]=x.useState(null),[S,E]=x.useState(""),[F,k]=x.useState(""),[P,D]=x.useState(""),[X,pe]=x.useState(0),[ge,fe]=x.useState("PENDIENTE"),[xe,ae]=x.useState("");x.useEffect(()=>{(async()=>{b(!0);try{const R=er(_t(Fe,"expenses_candies"),dn("date","desc")),H=await Qt(R),ne=[];H.forEach(ve=>{const U=ve.data();ne.push({id:ve.id,date:U.date||Nr(new Date,"yyyy-MM-dd"),category:U.category||"",description:U.description||"",amount:Number(U.amount||0),status:U.status||"PENDIENTE",notes:U.notes||"",createdAt:U.createdAt??dr.now()})}),v(ne)}catch(R){console.error(R),j(" Error al cargar gastos")}finally{b(!1)}})()},[]);const Se=x.useMemo(()=>g.filter(R=>!(t&&R.date<t||r&&R.date>r)),[g,t,r]),Te=x.useMemo(()=>{const R=Se.reduce((ve,U)=>ve+(U.amount||0),0),H=Se.filter(ve=>ve.status==="PAGADO").reduce((ve,U)=>ve+(U.amount||0),0),ne=R-H;return{total:R,pagado:H,pendiente:ne}},[Se]),O=()=>{s(Nr(new Date,"yyyy-MM-dd")),l(""),u(""),f(0),h("PENDIENTE"),p("")},G=async R=>{if(R.preventDefault(),j(""),!o){j("Selecciona una categora.");return}if(!c.trim()){j("Ingresa una descripcin.");return}if(!d||d<=0){j("Ingresa un monto vlido.");return}try{const H=await On(_t(Fe,"expenses_candies"),{date:a,category:o,description:c.trim(),amount:Number(d.toFixed(2)),status:A,notes:m||"",createdAt:dr.now()});v(ne=>[{id:H.id,date:a,category:o,description:c.trim(),amount:Number(d.toFixed(2)),status:A,notes:m||"",createdAt:dr.now()},...ne]),O(),j(" Gasto registrado")}catch(H){console.error(H),j(" Error al guardar gasto")}},z=R=>{_(R.id),E(R.date),k(R.category||""),D(R.description||""),pe(Number(R.amount||0)),fe(R.status||"PENDIENTE"),ae(R.notes||"")},L=()=>{_(null),E(""),k(""),D(""),pe(0),fe("PENDIENTE"),ae("")},Z=async()=>{if(I){if(!F){j("Selecciona una categora.");return}if(!P.trim()){j("Ingresa una descripcin.");return}if(!X||X<=0){j("Ingresa un monto vlido.");return}try{await pn(Yt(Fe,"expenses_candies",I),{date:S,category:F,description:P.trim(),amount:Number(X.toFixed(2)),status:ge,notes:xe||""}),v(R=>R.map(H=>H.id===I?{...H,date:S,category:F,description:P.trim(),amount:Number(X.toFixed(2)),status:ge,notes:xe||""}:H)),L(),j(" Gasto actualizado")}catch(R){console.error(R),j(" Error al actualizar gasto")}}},ee=async R=>{confirm(`Eliminar el gasto "${R.description}"?`)&&(await Fn(Yt(Fe,"expenses_candies",R.id)),v(ne=>ne.filter(ve=>ve.id!==R.id)),j(" Gasto borrado"))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Dulces)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:R=>e(R.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:R=>n(R.target.value)})]}),i.jsxs("div",{className:"ml-auto text-sm",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",e_(Te.total)]}),i.jsxs("div",{children:["Pagado: ",e_(Te.pagado)]}),i.jsxs("div",{children:["Pendiente: ",e_(Te.pendiente)]})]})]}),i.jsxs("form",{onSubmit:G,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:a,onChange:R=>s(R.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:R=>l(R.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),G$.map(R=>i.jsx("option",{value:R,children:R},R))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:R=>u(R.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:d===0?"":d,onChange:R=>f(Math.max(0,Number(R.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:A,onChange:R=>h(R.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:R=>p(R.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):Se.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):Se.slice().sort((R,H)=>R.date.localeCompare(H.date)).map(R=>{const H=I===R.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:H?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:S,onChange:ne=>E(ne.target.value)}):R.date}),i.jsx("td",{className:"p-2 border",children:H?i.jsxs("select",{className:"w-full border p-1 rounded",value:F,onChange:ne=>k(ne.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),G$.map(ne=>i.jsx("option",{value:ne,children:ne},ne))]}):R.category||""}),i.jsx("td",{className:"p-2 border",children:H?i.jsx("input",{className:"w-full border p-1 rounded",value:P,onChange:ne=>D(ne.target.value)}):i.jsx("span",{title:R.description,children:R.description.length>40?R.description.slice(0,40)+"":R.description})}),i.jsx("td",{className:"p-2 border",children:H?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(X)?"":X,onChange:ne=>pe(Math.max(0,Number(ne.target.value||0)))}):e_(R.amount)}),i.jsx("td",{className:"p-2 border",children:H?i.jsxs("select",{className:"w-full border p-1 rounded",value:ge,onChange:ne=>fe(ne.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${R.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:R.status})}),i.jsx("td",{className:"p-2 border",children:H?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:xe,onChange:ne=>ae(ne.target.value),maxLength:500}):i.jsx("span",{title:R.notes||"",children:(R.notes||"").length>40?(R.notes||"").slice(0,40)+"":R.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:H?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Z,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:L,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>z(R),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>ee(R),children:"Borrar"})]})})})]},R.id)})})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w})]})}const _c=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function iQe(t){var e;return t!=null&&t.date?t.date:(e=t==null?void 0:t.createdAt)!=null&&e.toDate?Nr(t.createdAt.toDate(),"yyyy-MM-dd"):""}function oQe(t,e){var s,o,l;const r=iQe(t);if(!r)return null;let n=0,a=0;return Array.isArray(t.items)&&t.items.length>0?(n=t.items.reduce((c,u)=>c+(Number(u.packages??u.qty??u.quantity??0)||0),0),a=Number(t.total??t.itemsTotal??0)||0):(n=Number(t.packagesTotal??t.quantity??((s=t.item)==null?void 0:s.packages)??((o=t.item)==null?void 0:o.qty)??0)||0,a=Number(t.total??((l=t.item)==null?void 0:l.total)??0)||0),{id:e,date:r,type:t.type||"CONTADO",total:a,quantity:n,customerId:t.customerId||void 0,customerName:t.customerName||void 0,downPayment:Number(t.downPayment||0),vendorId:t.vendorId||void 0,vendorName:t.vendorName||t.vendor||void 0,vendorCommissionPercent:Number(t.vendorCommissionPercent||0)||0,vendorCommissionAmount:Number(t.vendorCommissionAmount||0)||0}}async function lQe(t){const e=er(_t(Fe,"ar_movements"),cr("ref.saleId","==",t)),r=await Qt(e);await Promise.all(r.docs.map(n=>Fn(Yt(Fe,"ar_movements",n.id))))}function cQe({role:t="",sellerCandyId:e="",roles:r}){const n=r&&r.length?r:t,a=sn(n,"vendedor_dulces"),s=sn(n,"admin"),o=s?8:7,[l,c]=x.useState(!1),[u,d]=x.useState(!1),[f,A]=x.useState(null),[h,m]=x.useState([]),p=async we=>{c(!0),d(!0),A(we),m([]);try{const Me=await Bs(Yt(Fe,"sales_candies",we)),ze=Me.exists()?Me.data():null;if(!ze){m([]);return}const It=(Array.isArray(ze==null?void 0:ze.items)?ze.items:ze!=null&&ze.item?[ze.item]:[]).map(Ke=>({productName:String(Ke.productName||""),qty:Number(Ke.packages??Ke.qty??Ke.quantity??0),unitPrice:Number(Ke.unitPricePackage??Ke.unitPrice??0),discount:Number(Ke.discount||0),total:Number(Ke.total??Ke.lineFinal??0)}));m(It)}catch(Me){console.error(Me)}finally{d(!1)}},[g,v]=x.useState(Nr(new Date,"yyyy-MM-01")),[y,b]=x.useState(Nr(new Date,"yyyy-MM-dd")),[w,j]=x.useState([]),[I,_]=x.useState([]),[S,E]=x.useState([]),[F,k]=x.useState(!0),[P,D]=x.useState(""),[X,pe]=x.useState(""),[ge,fe]=x.useState(""),[xe,ae]=x.useState(null),Se=15,[Te,O]=x.useState(1),G=x.useMemo(()=>{const we={};return w.forEach(Me=>we[Me.id]=Me.name),we},[w]),z=x.useMemo(()=>{const we={};return S.forEach(Me=>{we[Me.id]=Me}),we},[S]),L=we=>{const Me=Number(we.vendorCommissionAmount||0);if(Me>0)return Me;if(!we.vendorId)return 0;const ze=z[we.vendorId];if(!ze||!ze.commissionPercent)return 0;const yt=(Number(we.total)||0)*(Number(ze.commissionPercent)||0)/100;return Number(yt.toFixed(2))};x.useEffect(()=>{(async()=>{k(!0),D("");try{const we=await Qt(_t(Fe,"customers_candies")),Me=[];we.forEach(wt=>Me.push({id:wt.id,name:wt.data().name||""})),j(Me);const ze=await Qt(_t(Fe,"sellers_candies")),yt=[];ze.forEach(wt=>{const At=wt.data();yt.push({id:wt.id,name:At.name||"",commissionPercent:Number(At.commissionPercent||0)})}),E(yt);const It=await Qt(er(_t(Fe,"sales_candies"),dn("createdAt","desc"))),Ke=[];It.forEach(wt=>{const At=oQe(wt.data(),wt.id);At&&At.date>=g&&At.date<=y&&Ke.push(At)}),_(Ke.sort((wt,At)=>At.date.localeCompare(wt.date))),O(1)}catch(we){console.error(we),D(" Error cargando transacciones.")}finally{k(!1)}})()},[g,y]);const Z=x.useMemo(()=>I.filter(we=>!(a&&(!e||!we.vendorId||we.vendorId!==e)||X&&we.customerId!==X||ge&&we.type!==ge)),[I,X,ge,a,e]),ee=x.useMemo(()=>{let we=0,Me=0,ze=0,yt=0;for(const It of Z)It.type==="CONTADO"?(we+=It.quantity,ze+=It.total):(Me+=It.quantity,yt+=It.total);return{packsCash:we,packsCredito:Me,montoCash:ze,montoCredito:yt}},[Z]),R=Math.max(1,Math.ceil(Z.length/Se)),H=x.useMemo(()=>{const we=(Te-1)*Se;return Z.slice(we,we+Se)},[Z,Te]),ne=x.useMemo(()=>f&&I.find(we=>we.id===f)||null,[f,I]),ve=async we=>{if(s&&(ae(null),!!window.confirm("Eliminar esta venta de dulces? Se restaurar el inventario asociado.")))try{k(!0),await R2(we.id),await lQe(we.id),_(Me=>Me.filter(ze=>ze.id!==we.id)),D(" Venta eliminada")}catch(Me){console.error(Me),D(" No se pudo eliminar la venta.")}finally{k(!1)}},U=()=>{const we=`Ventas del dia  ${g} a ${y}`,Me=Ke=>(Ke||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),ze=Z.map(Ke=>{const wt=Ke.customerName||(Ke.customerId?G[Ke.customerId]:"")||"Nombre cliente";return`<tr>
          <td>${Ke.date}</td>
          <td>${Me(wt)}</td>
          <td>${Ke.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${Ke.quantity}</td>
          <td style="text-align:right">${_c(Ke.total)}</td>
        </tr>`}).join(""),yt=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${Me(we)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${Me(we)}</h1>
      <div class="kpis">
        <div><b>Paquetes Cash:</b> ${ee.packsCash}</div>
        <div><b>Paquetes Crdito:</b> ${ee.packsCredito}</div>
        <div><b>Monto Cash:</b> ${_c(ee.montoCash)}</div>
        <div><b>Monto Crdito:</b> ${_c(ee.montoCredito)}</div>
      </div>
      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Paquetes</th><th>Monto</th>
      </tr></thead><tbody>
      ${ze||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,It=window.open("","_blank");It&&(It.document.open(),It.document.write(yt),It.document.close())},He=()=>O(1),se=()=>O(we=>Math.max(1,we-1)),re=()=>O(we=>Math.min(R,we+1)),Pe=()=>O(R),ue=()=>{const we=[];if(R<=7)for(let ze=1;ze<=R;ze++)we.push(ze);else{const ze=Math.max(1,Te-2),yt=Math.min(R,Te+2);we.push(1),ze>2&&we.push(-1);for(let It=ze;It<=yt;It++)It!==1&&It!==R&&we.push(It);yt<R-1&&we.push(-2),we.push(R)}return i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:He,disabled:Te===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:se,disabled:Te===1,children:" Anterior"}),we.map((ze,yt)=>typeof ze=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${ze===Te?"bg-blue-600 text-white":""}`,onClick:()=>O(ze),children:ze},yt):i.jsx("span",{className:"px-2",children:""},yt)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:re,disabled:Te===R,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Pe,disabled:Te===R,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",Te," de ",R,"  ",Z.length," transaccin(es)"]})]})};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas del dia"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:g,onChange:we=>{v(we.target.value),O(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:y,onChange:we=>{b(we.target.value),O(1)}})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:X,onChange:we=>{pe(we.target.value),O(1)},children:[i.jsx("option",{value:"",children:"Todos"}),w.map(we=>i.jsx("option",{value:we.id,children:we.name},we.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:ge,onChange:we=>{fe(we.target.value),O(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsx("button",{className:"sm:col-span-2 lg:col-span-1 px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 w-full",onClick:U,children:"Exportar PDF"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:ee.packsCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:ee.packsCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:_c(ee.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:_c(ee.montoCredito)})]})]}),i.jsxs("div",{className:"block md:hidden space-y-3",children:[F?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Cargando"}):H.length===0?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Sin transacciones en el rango."}):H.map(we=>{const Me=we.customerName||(we.customerId?G[we.customerId]:"")||"Nombre cliente",ze=L(we);return i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:Me}),i.jsx("div",{className:"text-xs text-gray-600 shrink-0",children:we.date})]}),i.jsxs("div",{className:"mt-1 flex items-center gap-2 flex-wrap text-xs",children:[i.jsx("span",{className:`px-2 py-1 rounded-full border ${we.type==="CREDITO"?"bg-yellow-50 border-yellow-200 text-yellow-700":"bg-green-50 border-green-200 text-green-700"}`,children:we.type==="CREDITO"?"Crdito":"Cash"}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Paquetes:"})," ",i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:yt=>{yt.preventDefault(),p(we.id)},title:"Ver detalle",children:we.quantity})]}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Monto:"})," ",_c(we.total)]})]})]}),i.jsx("div",{className:"text-gray-500 mt-1",children:i.jsx("span",{className:"inline-block transition-transform group-open:rotate-180",children:""})})]}),i.jsx("div",{className:"px-3 pb-3 pt-0 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2 border-t pt-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("span",{className:"font-medium text-right",children:Me})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha"}),i.jsx("span",{className:"font-medium",children:we.date})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("span",{className:"font-medium",children:we.type==="CREDITO"?"Crdito":"Cash"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes"}),i.jsx("span",{className:"font-medium",children:i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:()=>p(we.id),title:"Ver detalle",children:we.quantity})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Monto"}),i.jsx("span",{className:"font-semibold",children:_c(we.total)})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("span",{className:"font-medium",children:ze>0?_c(ze):""})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("span",{className:"font-medium",children:we.vendorName||""})]}),s&&i.jsxs("div",{className:"pt-2 flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border hover:bg-gray-50",onClick:()=>ae(yt=>yt===we.id?null:we.id),children:" Acciones"}),xe===we.id&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>ve(we),children:"Eliminar"})]})]})})]})},we.id)}),i.jsx("div",{className:"bg-white p-3 rounded shadow border",children:ue()})]}),i.jsxs("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Comisin"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),s&&i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:F?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Cargando"})}):H.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Sin transacciones en el rango."})}):H.map(we=>{const Me=we.customerName||(we.customerId?G[we.customerId]:"")||"Nombre cliente",ze=L(we);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:we.date}),i.jsx("td",{className:"p-2 border",children:Me}),i.jsx("td",{className:"p-2 border",children:we.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver detalle de productos de esta venta",onClick:()=>p(we.id),children:we.quantity})}),i.jsx("td",{className:"p-2 border",children:_c(we.total)}),i.jsx("td",{className:"p-2 border",children:ze>0?_c(ze):""}),i.jsx("td",{className:"p-2 border",children:we.vendorName||""}),s&&i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>ae(yt=>yt===we.id?null:we.id),title:"Acciones",children:""}),xe===we.id&&i.jsx("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>ve(we),children:"Eliminar"})})]})]},we.id)})})]}),ue()]}),P&&i.jsx("p",{className:"mt-2 text-sm",children:P}),l&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Productos/paquetes vendidos"," ",f?` #${f}`:""]}),ne&&i.jsxs("div",{className:"text-sm text-gray-700 mt-1",children:["Comisin de vendedor:"," ",i.jsx("span",{className:"font-semibold",children:L(ne)>0?_c(L(ne)):""})]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>c(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:u?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):h.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):h.map((we,Me)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:we.productName}),i.jsx("td",{className:"p-2 border text-right",children:we.qty}),i.jsx("td",{className:"p-2 border text-right",children:_c(we.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:_c(we.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:_c(we.total)})]},Me))})]})})]})})]})}const en=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Ky(t){var r;const e=t==null?void 0:t.date;return e||((r=t==null?void 0:t.createdAt)!=null&&r.toDate?Nr(t.createdAt.toDate(),"yyyy-MM-dd"):"")}function uQe(t){if(Array.isArray(t==null?void 0:t.items))return t.items.map(n=>{const a=Number((n==null?void 0:n.packages)??(n==null?void 0:n.qty)??(n==null?void 0:n.quantity)??0)||0,s=Number((n==null?void 0:n.unitPricePackage)??(n==null?void 0:n.unitPrice)??0)||(a>0?Number((n==null?void 0:n.total)??(n==null?void 0:n.lineFinal)??0)/a:0)||0;return{productId:String((n==null?void 0:n.productId)||""),productName:String((n==null?void 0:n.productName)||""),sku:(n==null?void 0:n.sku)||"",qty:a,unitPrice:Number(s||0),discount:Number((n==null?void 0:n.discount)||0),vendorCommissionAmount:Number((n==null?void 0:n.vendorCommissionAmount)??(n==null?void 0:n.commissionAmount)??0),uBruta:Number((n==null?void 0:n.uBruta)??(n==null?void 0:n.grossProfit)??0)}});if(t!=null&&t.item){const n=t.item,a=Number((n==null?void 0:n.packages)??(n==null?void 0:n.qty)??(n==null?void 0:n.quantity)??0)||Number((t==null?void 0:t.packagesTotal)??(t==null?void 0:t.quantity)??0)||0,s=Number((n==null?void 0:n.unitPricePackage)??(n==null?void 0:n.unitPrice)??0)||(a>0?Number((n==null?void 0:n.total)??(t==null?void 0:t.total)??0)/a:0)||0;return[{productId:String((n==null?void 0:n.productId)||""),productName:String((n==null?void 0:n.productName)||""),sku:(n==null?void 0:n.sku)||"",qty:a,unitPrice:Number(s||0),discount:Number((n==null?void 0:n.discount)||0),vendorCommissionAmount:Number((n==null?void 0:n.vendorCommissionAmount)??(n==null?void 0:n.commissionAmount)??0),uBruta:Number((n==null?void 0:n.uBruta)??(n==null?void 0:n.grossProfit)??0)}]}const e=Number((t==null?void 0:t.packagesTotal)??(t==null?void 0:t.quantity)??0)||0,r=e>0?Number((t==null?void 0:t.total)||0)/e:0;return e>0?[{productId:String((t==null?void 0:t.productId)||""),productName:String((t==null?void 0:t.productName)||""),sku:(t==null?void 0:t.sku)||"",qty:e,unitPrice:Number(r||0),discount:Number((t==null?void 0:t.discount)||0),vendorCommissionAmount:Number((t==null?void 0:t.vendorCommissionAmount)??(t==null?void 0:t.commissionAmount)??0),uBruta:Number((t==null?void 0:t.uBruta)??(t==null?void 0:t.grossProfit)??0)}]:[]}function dQe(t,e){const r=Ky(t);if(!r)return null;const n=t.vendorId||t.sellerId||void 0,a=t.vendorName||t.sellerName||void 0,s=uQe(t);let o=Number(t.total??t.itemsTotal??0)||s.reduce((l,c)=>{const u=(Number(c.qty||0)||0)*(Number(c.unitPrice||0)||0),d=Math.max(0,Number(c.discount||0)),f=Math.max(0,u-d);return l+f},0);return o=Number(o||0),{id:e,date:r,type:t.type||"CONTADO",total:o,items:s,customerId:t.customerId||void 0,customerName:t.customerName||void 0,vendorId:n,vendorName:a,vendorCommissionAmount:Number(t.vendorCommissionAmount||0)||0}}function fQe(t,e,r,n){const a={};for(const l of t)a[l.productId]||(a[l.productId]={productName:l.productName,lots:[]}),a[l.productId].lots.push({date:l.date,qtyLeft:Number(l.quantity||0),cost:Number(l.purchasePrice||0)});for(const l of Object.keys(a))a[l].lots.sort((c,u)=>c.date.localeCompare(u.date));const s=[...e].sort((l,c)=>l.date.localeCompare(c.date));let o=0;for(const l of s)for(const c of l.items||[]){const u=a[c.productId];if(!u)continue;let d=Number(c.qty||0);if(!(d<=0))for(const f of u.lots){if(d<=0)break;if(f.qtyLeft<=0)continue;const A=Math.min(f.qtyLeft,d);l.date>=r&&l.date<=n&&(o+=A*f.cost),f.qtyLeft-=A,d-=A}}return o}async function hQe(t){const e=er(_t(Fe,"ar_movements"),cr("ref.saleId","==",t)),r=await Qt(e);await Promise.all(r.docs.map(n=>Fn(Yt(Fe,"ar_movements",n.id))))}function AQe(){const{refreshKey:t,refresh:e}=gc(),[r,n]=x.useState(Nr(yd(new Date),"yyyy-MM-dd")),[a,s]=x.useState(Nr(vd(new Date),"yyyy-MM-dd")),[o,l]=x.useState([]),[c,u]=x.useState([]),[d,f]=x.useState([]),[A,h]=x.useState([]),[m,p]=x.useState([]),[g,v]=x.useState([]),[y,b]=x.useState(!0),[w,j]=x.useState(""),[I,_]=x.useState([]),[S,E]=x.useState({}),[F,k]=x.useState({}),[P,D]=x.useState(!1),[X,pe]=x.useState(null),[ge,fe]=x.useState([]),[xe,ae]=x.useState(!1),[Se,Te]=x.useState({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0}),[O,G]=x.useState(!1),[z,L]=x.useState(""),[Z,ee]=x.useState([]),[R,H]=x.useState(!1),[ne,ve]=x.useState("CASH"),[U,He]=x.useState(1),se=10,[re,Pe]=x.useState(!1),[ue,we]=x.useState(null);x.useEffect(()=>{(async()=>{try{const Ae=await Qt(_t(Fe,"sellers_candies")),Qe=[];Ae.forEach(Ct=>{const pt=Ct.data();Qe.push({id:Ct.id,name:pt.name||"",commissionPercent:Number(pt.commissionPercent||0)})}),_(Qe)}catch(Ae){console.error("Error cargando sellers_candies",Ae)}})()},[]);const Me=x.useMemo(()=>{const Ae={};return I.forEach(Qe=>{Ae[Qe.id]=Qe}),Ae},[I]);x.useEffect(()=>{(async()=>{b(!0),j("");try{const Ae=await Qt(_t(Fe,"sales_candies")),Qe=[],Ct=[];Ae.forEach(be=>{const st=be.data(),K=dQe(st,be.id);K&&(K.date<=a&&Qe.push(K),K.date>=r&&K.date<=a&&Ct.push(K))}),u(Qe),l(Ct);const pt=await Qt(_t(Fe,"inventory_candies")),me=[];pt.forEach(be=>{const st=be.data(),K=Ky(st);if(!K||K>a)return;const Ie=Math.max(1,Math.floor(Number(st.unitsPerPackage||1))),Ze=Number(st.totalUnits??st.quantity??0),at=Number(st.packages??0),it=Number(st.remaining??0),T=Number(st.remainingPackages??0),M=at>0?at:Ze>0?Math.floor(Ze/Ie):0,V=T>0?T:it>0?Math.floor(it/Ie):0;me.push({id:be.id,productId:st.productId,productName:st.productName||"",date:K,quantity:Number(M||0),remaining:Number(V||0),purchasePrice:Number(st.providerPrice||st.purchasePrice||0),unitsPerPackage:Ie})}),f(me);const te=await Qt(_t(Fe,"expenses_candies")),ie=[];te.forEach(be=>{const st=be.data(),K=Ky(st);K&&K>=r&&K<=a&&ie.push({id:be.id,date:K,category:st.category||"",description:st.description||"",amount:Number(st.amount||0),status:st.status||""})}),h(ie);const $e=await Qt(_t(Fe,"ar_movements")),de=[],Ce={};$e.forEach(be=>{const st=be.data(),K=Ky(st);if(!K)return;const Ie=st.customerId,Ze=Number(st.amount||0);Ie&&(Ce[Ie]=(Ce[Ie]||0)+Ze),st.type==="ABONO"&&K>=r&&K<=a&&de.push({id:be.id,customerId:Ie,type:"ABONO",amount:Ze,date:K})}),p(de);const nt=await Qt(_t(Fe,"customers_candies")),vt=[];nt.forEach(be=>{const st=be.data();vt.push({id:be.id,name:st.name||"",balance:Ce[be.id]||0})}),v(vt);const ht=await Qt(_t(Fe,"inventory_candies_sellers")),xt={},Xe={};ht.forEach(be=>{const st=be.data(),K=Ky(st);if(!K||K<r||K>a)return;const Ie=st.sellerId||st.vendorId||"NO_VENDOR",Ze=st.productName||"",at=st.sku||"",it=Math.max(1,Math.floor(Number(st.unitsPerPackage||1))),T=Number(st.totalUnits??0),M=Number(st.packages??0),V=Number(st.remainingUnits??st.remaining??0),q=Number(st.remainingPackages??0),Y=M>0?M:T>0?Math.floor(T/it):0,oe=q>0?q:V>0?Math.floor(V/it):0,De=Number(st.totalVendor??0),We=Number(st.uVendor??0),dt=Number(st.subtotal??0),Oe=Number(st.uBruta??0),et=Y,mt=et>0?De/et:0,Tt=et>0?We/et:0,Pt=et>0?dt/et:0,Ft=et>0?Oe>0?Oe/et:mt-Pt:0;if(xt[Ie]||(xt[Ie]={associated:[],remaining:[]}),Y>0){const Xt=Y,mr=Xt*mt,Yr=Xt*Pt,Br=mr,Fr=Xt*Tt,vn=Xt*Ft;xt[Ie].associated.push({saleId:be.id,date:K,productId:st.productId||st.id||"",productName:Ze,sku:at,qty:Xt,unitPrice:mt,costTotal:Yr,lineTotal:mr,discount:0,lineFinal:Br,grossProfit:vn,vendorCommissionAmount:Fr,type:"ASSOCIATED"}),Xe[Ie]=(Xe[Ie]||0)+Xt}if(oe>0){const Xt=oe,mr=Xt*mt,Yr=Xt*Pt,Br=mr,Fr=Xt*Tt,vn=Xt*Ft;xt[Ie].remaining.push({saleId:be.id,date:K,productId:st.productId||st.id||"",productName:Ze,sku:at,qty:Xt,unitPrice:mt,costTotal:Yr,lineTotal:mr,discount:0,lineFinal:Br,grossProfit:vn,vendorCommissionAmount:Fr,type:"REMAINING"})}}),E(xt),k(Xe)}catch(Ae){console.error(Ae),j(" Error cargando datos del dashboard.")}finally{b(!1)}})()},[r,a,t]);const ze=x.useCallback((Ae,Qe)=>{const Ct=Number(Qe.vendorCommissionAmount||0)||0;if(Ct>0)return Ct;const pt=Number(Ae.vendorCommissionAmount||0)||0;if(pt<=0)return 0;const me=Number(Qe.qty||0),te=Number(Qe.unitPrice||0),ie=me*te,$e=Math.max(0,Number(Qe.discount||0)),de=Math.max(0,ie-$e);return!de||!Ae.total?0:pt*de/Ae.total},[]),yt=x.useMemo(()=>{try{return fQe(d,c,r,a)}catch(Ae){return console.error(Ae),0}},[d,c,r,a]),It=x.useMemo(()=>{const Ae=o.reduce((ht,xt)=>ht+(xt.total||0),0),Qe=A.reduce((ht,xt)=>ht+(xt.amount||0),0),Ct=Ae-yt,pt=Ct-Qe;let me=0;for(const ht of o)for(const xt of ht.items||[]){const Xe=Number(xt.uBruta||0);Number.isFinite(Xe)&&(me+=Xe)}const te=m.reduce((ht,xt)=>ht+Math.abs(xt.amount||0),0),ie=g.filter(ht=>(ht.balance||0)>0),$e=ie.reduce((ht,xt)=>ht+(xt.balance||0),0);let de=0,Ce=0,nt=0,vt=0;for(const ht of o){const xt=(ht.items||[]).reduce((be,st)=>be+(Number(st.qty)||0),0),Xe=(ht.items||[]).reduce((be,st)=>be+ze(ht,st),0);ht.type==="CONTADO"?(de+=xt,nt+=Xe):(Ce+=xt,vt+=Xe)}return{ventasTotales:Ae,costoMercaderia:yt,gastosPeriodo:Qe,gananciaAntes:Ct,utilidadBrutaOrdenes:me,gananciaDespues:pt,abonosRecibidos:te,saldosPendientes:$e,clientesConSaldo:ie.length,paquetesCash:de,paquetesCredito:Ce,comisionCash:nt,comisionCredito:vt}},[o,A,m,g,yt,ze,S]),Ke=x.useMemo(()=>{const Ae={},Qe={};for(const Ct of o)if(!(Ct.type!=="CREDITO"||!Ct.customerId))for(const pt of Ct.items||[]){const me=Number(pt.qty||0),te=Number(pt.unitPrice||0),ie=me*te,$e=Math.max(0,Number(pt.discount||0)),de=Math.max(0,ie-$e);Ae[Ct.customerId]=(Ae[Ct.customerId]||0)+me,Qe[Ct.customerId]=(Qe[Ct.customerId]||0)+de}return g.filter(Ct=>(Ct.balance||0)>0).map(Ct=>({customerId:Ct.id,name:Ct.name,paquetesAsociados:Ae[Ct.id]||0,saldoTotal:Qe[Ct.id]||0,saldoPendiente:Ct.balance||0})).sort((Ct,pt)=>pt.saldoPendiente-Ct.saldoPendiente)},[g,o]),wt=x.useMemo(()=>{const Ae={};return g.forEach(Qe=>Ae[Qe.id]=Qe.name),Ae},[g]),At=x.useMemo(()=>[...o].sort((Ae,Qe)=>Qe.date.localeCompare(Ae.date)).map(Ae=>{var me;const Qe=(Ae.items||[]).reduce((te,ie)=>te+(Number(ie.qty)||0),0);let Ct="Cash";Ae.type==="CREDITO"&&Ae.customerId?Ct=wt[Ae.customerId]||"":Ae.type==="CONTADO"&&(Ct=((me=Ae.customerName)==null?void 0:me.trim())||"Cash");const pt=Qe>0?Ae.total/Qe:0;return{id:Ae.id,date:Ae.date,type:Ae.type==="CREDITO"?"Crdito":"Cash",customer:Ct,paquetes:Qe,total:Number(Ae.total||0),avgPrice:pt}}),[o,wt]),bt=x.useMemo(()=>{var Qe,Ct;const Ae=new Map;for(const pt of o){const me=pt.vendorId||"NO_VENDOR",te=pt.vendorName||((Qe=Me[me])==null?void 0:Qe.name)||"Sin vendedor";Ae.has(me)||Ae.set(me,{vendorId:me,vendorName:te,paquetesAsociados:0,paquetesVendidos:0,paquetesFiados:0,totalVendido:0,totalFiado:0,comisionCash:0,comisionCredito:0,paquetesRestantes:0});const ie=Ae.get(me);for(const $e of pt.items||[]){const de=Number($e.qty||0),Ce=Number($e.unitPrice||0),nt=de*Ce,vt=Math.max(0,Number($e.discount||0)),ht=Math.max(0,nt-vt),xt=ze(pt,$e);pt.type==="CONTADO"?(ie.paquetesVendidos+=de,ie.totalVendido+=ht,ie.comisionCash+=xt):(ie.paquetesFiados+=de,ie.totalFiado+=ht,ie.comisionCredito+=xt)}}for(const[pt,me]of Object.entries(F)){const te=Ae.get(pt),ie=(te==null?void 0:te.vendorName)||((Ct=Me[pt])==null?void 0:Ct.name)||"Sin vendedor",$e=te||{vendorId:pt,vendorName:ie,paquetesAsociados:0,paquetesVendidos:0,paquetesFiados:0,totalVendido:0,totalFiado:0,comisionCash:0,comisionCredito:0,paquetesRestantes:0};$e.paquetesAsociados=me,$e.paquetesRestantes=Math.max(me-$e.paquetesVendidos-$e.paquetesFiados,0),Ae.set(pt,$e)}return Array.from(Ae.values()).sort((pt,me)=>me.totalVendido+me.totalFiado-(pt.totalVendido+pt.totalFiado))},[o,F,Me,ze]),ke=async Ae=>{D(!0),pe({id:Ae.customerId,name:Ae.name}),fe([]),ae(!0),Te({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});try{const Qe=[];let Ct=0,pt=0,me=0;for(const de of o)if(!(de.type!=="CREDITO"||de.customerId!==Ae.customerId))for(const Ce of de.items||[]){const nt=Number(Ce.qty||0),vt=Number(Ce.unitPrice||0),ht=nt*vt,xt=Math.max(0,Number(Ce.discount||0)),Xe=Math.max(0,ht-xt);Qe.push({saleId:de.id,date:de.date,productName:Ce.productName,sku:Ce.sku||"",qty:nt,unitPrice:vt,lineTotal:ht,discount:xt,lineFinal:Xe}),Ct+=ht,pt+=xt,me+=Xe}let te=0;for(const de of m)de.customerId===Ae.customerId&&(te+=Math.abs(de.amount||0));const ie=g.find(de=>de.id===Ae.customerId),$e=(ie==null?void 0:ie.balance)||0;fe(Qe),Te({totalBruto:Ct,totalDescuento:pt,totalFiado:me,saldoActual:$e,abonadoPeriodo:te})}catch(Qe){console.error(Qe),j(" No se pudo cargar el detalle del cliente.")}finally{ae(!1)}},Ne=(Ae,Qe,Ct)=>{G(!0),ve(Ct),He(1);let pt="";Ct==="ASSOCIATED"?pt=`Paquetes asociados  ${Qe}`:Ct==="REMAINING"?pt=`Paquetes restantes  ${Qe}`:Ct==="CASH"?pt=`Paquetes vendidos (Cash)  ${Qe}`:pt=`Paquetes fiados (Crdito)  ${Qe}`,L(pt),ee([]),H(!0);try{if(Ct==="ASSOCIATED"||Ct==="REMAINING"){const te=S[Ae],ie=Ct==="ASSOCIATED"?(te==null?void 0:te.associated)||[]:(te==null?void 0:te.remaining)||[];ee([...ie].sort(($e,de)=>(de.qty||0)-($e.qty||0))),H(!1);return}const me=[];for(const te of o)if(((te.vendorId||"NO_VENDOR")===Ae||!te.vendorId&&Ae==="NO_VENDOR")&&!(Ct==="CASH"&&te.type!=="CONTADO")&&!(Ct==="CREDIT"&&te.type!=="CREDITO"))for(const $e of te.items||[]){const de=Number($e.qty||0),Ce=Number($e.unitPrice||0),nt=de*Ce,vt=Math.max(0,Number($e.discount||0)),ht=Math.max(0,nt-vt),xt=ze(te,$e);me.push({saleId:te.id,date:te.date,productName:$e.productName,sku:$e.sku||"",qty:de,unitPrice:Ce,lineTotal:nt,discount:vt,lineFinal:ht,vendorCommissionAmount:xt,type:Ct})}ee(me.sort((te,ie)=>te.date.localeCompare(ie.date)))}catch(me){console.error(me),j(" No se pudo cargar el detalle del vendedor.")}finally{H(!1)}},Ve=x.useMemo(()=>ne!=="ASSOCIATED"&&ne!=="REMAINING"?1:Math.max(1,Math.ceil(Z.length/se)),[ne,Z.length]),he=x.useMemo(()=>{if(ne!=="ASSOCIATED"&&ne!=="REMAINING")return Z;const Ae=(U-1)*se;return Z.slice(Ae,Ae+se)},[ne,U,Z]),le=ne==="ASSOCIATED"||ne==="REMAINING"?10:8;x.useEffect(()=>{ne!=="ASSOCIATED"&&ne!=="REMAINING"||U>Ve&&He(Ve)},[ne,U,Ve]);const Be=Ae=>{const Qe=o.find(Ct=>Ct.id===Ae)||null;we(Qe),Pe(!0)},je=async Ae=>{if(window.confirm("Eliminar esta venta? Esta accin no se puede deshacer."))try{await R2(Ae),await hQe(Ae),l(Qe=>Qe.filter(Ct=>Ct.id!==Ae)),u(Qe=>Qe.filter(Ct=>Ct.id!==Ae)),Pe(!1),we(null)}catch(Qe){console.error(Qe),alert("No se pudo eliminar la venta. Revisa la consola para ms detalles.")}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas (Dulces)"}),i.jsx(pc,{onClick:e,loading:y})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:Ae=>n(Ae.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:Ae=>s(Ae.target.value)})]})]}),i.jsx("div",{className:"md:hidden mb-4",children:i.jsxs("details",{className:"bg-white border rounded-lg shadow",open:!0,children:[i.jsx("summary",{className:"cursor-pointer px-3 py-2 font-semibold",children:"KPIs"}),i.jsx("div",{className:"p-3",children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:en(It.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Contado + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:en(It.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:en(It.utilidadBrutaOrdenes||0)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos"}),i.jsx("div",{className:"text-xl font-semibold",children:en(It.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Neta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:en(It.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:en(It.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:en(It.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:It.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:It.paquetesCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito (vendidos)"}),i.jsx("div",{className:"text-xl font-semibold",children:It.paquetesCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:en(It.comisionCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:en(It.comisionCredito)})]})]})})]})}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:en(It.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Contado + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:en(It.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:en(It.utilidadBrutaOrdenes||0)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos"}),i.jsx("div",{className:"text-xl font-semibold",children:en(It.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Neta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:en(It.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:en(It.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:en(It.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:It.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:It.paquetesCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito (vendidos)"}),i.jsx("div",{className:"text-xl font-semibold",children:It.paquetesCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:en(It.comisionCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:en(It.comisionCredito)})]})]}),i.jsx("div",{className:"md:hidden mb-6",children:i.jsxs("details",{className:"bg-white border rounded-lg shadow",children:[i.jsx("summary",{className:"cursor-pointer px-3 py-2 font-semibold",children:"Consolidado clientes y vendedores"}),i.jsxs("div",{className:"p-3",children:[i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Consolidado por cliente (Crdito)"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full mb-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Paquetes asociados"}),i.jsx("th",{className:"p-2 border",children:"Saldo total"}),i.jsx("th",{className:"p-2 border",children:"Saldo pendiente"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):Ke.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin clientes con saldo"})}):Ke.map(Ae=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ae.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>ke({customerId:Ae.customerId,name:Ae.name}),title:"Ver paquetes fiados del periodo",children:Ae.paquetesAsociados})}),i.jsx("td",{className:"p-2 border",children:en(Ae.saldoTotal)}),i.jsx("td",{className:"p-2 border font-semibold",children:en(Ae.saldoPendiente)})]},Ae.customerId))})]})}),i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Consolidado vendedores"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes asociados"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes vendidos (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total vendido (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Cash"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes fiados (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total fiado (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Crdito"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):bt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin datos de vendedores en el rango seleccionado."})}):bt.map(Ae=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ae.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Ne(Ae.vendorId,Ae.vendorName,"ASSOCIATED"),children:Ae.paquetesAsociados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Ne(Ae.vendorId,Ae.vendorName,"REMAINING"),children:Ae.paquetesRestantes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Ne(Ae.vendorId,Ae.vendorName,"CASH"),children:Ae.paquetesVendidos})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Ae.totalVendido)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Ae.comisionCash)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Ne(Ae.vendorId,Ae.vendorName,"CREDIT"),children:Ae.paquetesFiados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Ae.totalFiado)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Ae.comisionCredito)})]},Ae.vendorId))})]})})]})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Consolidado por cliente (Crdito)"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Paquetes asociados (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo total (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo pendiente"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):Ke.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin clientes con saldo"})}):Ke.map(Ae=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ae.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>ke({customerId:Ae.customerId,name:Ae.name}),title:"Ver paquetes fiados del periodo",children:Ae.paquetesAsociados})}),i.jsx("td",{className:"p-2 border",children:en(Ae.saldoTotal)}),i.jsx("td",{className:"p-2 border font-semibold",children:en(Ae.saldoPendiente)})]},Ae.customerId))})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Consolidado vendedores"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full mb-6 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes asociados"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes vendidos (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total vendido (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Cash"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes fiados (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total fiado (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Crdito"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):bt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin datos de vendedores en el rango seleccionado."})}):bt.map(Ae=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ae.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Ne(Ae.vendorId,Ae.vendorName,"ASSOCIATED"),children:Ae.paquetesAsociados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Ne(Ae.vendorId,Ae.vendorName,"REMAINING"),children:Ae.paquetesRestantes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Ne(Ae.vendorId,Ae.vendorName,"CASH"),children:Ae.paquetesVendidos})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Ae.totalVendido)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Ae.comisionCash)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Ne(Ae.vendorId,Ae.vendorName,"CREDIT"),children:Ae.paquetesFiados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Ae.totalFiado)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Ae.comisionCredito)})]},Ae.vendorId))})]})}),i.jsx("div",{className:"md:hidden mb-6",children:i.jsxs("details",{className:"bg-white border rounded-lg shadow",children:[i.jsx("summary",{className:"cursor-pointer px-3 py-2 font-semibold",children:"Transacciones y gastos"}),i.jsxs("div",{className:"p-3",children:[i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full mb-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cliente"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta (prom.)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):At.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin transacciones en el rango seleccionado."})}):At.map(Ae=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ae.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ae.customer}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ae.type}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Be(Ae.id),children:Ae.paquetes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Ae.avgPrice)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Ae.total)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>je(Ae.id),children:"Eliminar"})})]},Ae.id))})]})}),i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):A.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):A.sort((Ae,Qe)=>Ae.date.localeCompare(Qe.date)).map(Ae=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ae.date}),i.jsx("td",{className:"p-2 border",children:Ae.category||""}),i.jsx("td",{className:"p-2 border",children:Ae.description?i.jsx("span",{title:Ae.description,children:Ae.description.length>40?Ae.description.slice(0,40)+"":Ae.description}):""}),i.jsx("td",{className:"p-2 border",children:en(Ae.amount)}),i.jsx("td",{className:"p-2 border",children:Ae.status||""})]},Ae.id))})]})})]})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full mb-6 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cliente"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta (prom.)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):At.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin transacciones en el rango seleccionado."})}):At.map(Ae=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ae.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ae.customer}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ae.type}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Be(Ae.id),children:Ae.paquetes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Ae.avgPrice)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Ae.total)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>je(Ae.id),children:"Eliminar"})})]},Ae.id))})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):A.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):A.sort((Ae,Qe)=>Ae.date.localeCompare(Qe.date)).map(Ae=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ae.date}),i.jsx("td",{className:"p-2 border",children:Ae.category||""}),i.jsx("td",{className:"p-2 border",children:Ae.description?i.jsx("span",{title:Ae.description,children:Ae.description.length>40?Ae.description.slice(0,40)+"":Ae.description}):""}),i.jsx("td",{className:"p-2 border",children:en(Ae.amount)}),i.jsx("td",{className:"p-2 border",children:Ae.status||""})]},Ae.id))})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w}),P&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle cliente  ",(X==null?void 0:X.name)||""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>D(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total bruto (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:en(Se.totalBruto)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Descuento (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:en(Se.totalDescuento)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto total fiado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:en(Se.totalFiado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:en(Se.abonadoPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:en(Se.saldoActual)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha compra"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio Paq"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Descuento"}),i.jsx("th",{className:"p-2 border",children:"Monto final"})]})}),i.jsx("tbody",{children:xe?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Cargando"})}):ge.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Sin paquetes fiados en el periodo."})}):ge.sort((Ae,Qe)=>Ae.date.localeCompare(Qe.date)).map((Ae,Qe)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ae.date}),i.jsx("td",{className:"p-2 border",children:Ae.productName}),i.jsx("td",{className:"p-2 border",children:Ae.qty}),i.jsx("td",{className:"p-2 border",children:en(Ae.unitPrice)}),i.jsx("td",{className:"p-2 border",children:en(Ae.lineTotal)}),i.jsx("td",{className:"p-2 border",children:en(Ae.discount)}),i.jsx("td",{className:"p-2 border",children:en(Ae.lineFinal)})]},`${Ae.saleId}-${Qe}`))})]})})]})}),O&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:z}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>G(!1),children:"Cerrar"})]}),(ne==="ASSOCIATED"||ne==="REMAINING")&&!R&&i.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2 text-sm",children:[i.jsxs("div",{className:"text-gray-600",children:["Pgina ",U," de ",Ve]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded border bg-white hover:bg-gray-50 disabled:opacity-50",onClick:()=>He(Ae=>Math.max(1,Ae-1)),disabled:U<=1,children:"Anterior"}),i.jsx("button",{className:"px-3 py-1 rounded border bg-white hover:bg-gray-50 disabled:opacity-50",onClick:()=>He(Ae=>Math.min(Ve,Ae+1)),disabled:U>=Ve,children:"Siguiente"})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha Orden"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio Paq"}),ne==="ASSOCIATED"||ne==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"p-2 border",children:"Costo"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]}):i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Descuento"}),i.jsx("th",{className:"p-2 border",children:"Monto final"}),ne==="ASSOCIATED"||ne==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Utilidad vendedor"})]}):i.jsx("th",{className:"p-2 border",children:"Comisin"})]})}),i.jsx("tbody",{children:R?i.jsx("tr",{children:i.jsx("td",{colSpan:le,className:"p-4 text-center",children:"Cargando"})}):Z.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:le,className:"p-4 text-center",children:"Sin paquetes para este vendedor en el periodo."})}):he.map((Ae,Qe)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ae.date}),i.jsx("td",{className:"p-2 border",children:Ae.productName}),i.jsx("td",{className:"p-2 border",children:Ae.qty}),i.jsx("td",{className:"p-2 border",children:en(Ae.unitPrice)}),ne==="ASSOCIATED"||ne==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"p-2 border",children:en(Ae.costTotal??0)}),i.jsx("td",{className:"p-2 border",children:en(Ae.lineTotal)})]}):i.jsx("td",{className:"p-2 border",children:en(Ae.lineTotal)}),i.jsx("td",{className:"p-2 border",children:en(Ae.discount)}),i.jsx("td",{className:"p-2 border",children:en(Ae.lineFinal)}),ne==="ASSOCIATED"||ne==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"p-2 border",children:en(Ae.grossProfit||0)}),i.jsx("td",{className:"p-2 border",children:en(Ae.vendorCommissionAmount)})]}):i.jsx("td",{className:"p-2 border",children:en(Ae.vendorCommissionAmount)})]},`${Ae.saleId}-${Qe}`))})]})})]})}),re&&ue&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-4xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle de venta  ",ue.date]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Pe(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto mb-3",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio Paq"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Comisin"})]})}),i.jsx("tbody",{children:(ue.items||[]).map((Ae,Qe)=>{const Ct=Number(Ae.qty||0),pt=Number(Ae.unitPrice||0),me=Ct*pt,te=ze(ue,Ae);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ae.productName}),i.jsx("td",{className:"p-2 border",children:Ct}),i.jsx("td",{className:"p-2 border",children:en(pt)}),i.jsx("td",{className:"p-2 border",children:en(me)}),i.jsx("td",{className:"p-2 border",children:en(te)})]},Qe)})})]})}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"font-semibold",children:"Total venta:"}),en(ue.total)]}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700",onClick:()=>je(ue.id),children:"Eliminar venta"})]})]})})]})}const K$=["Rivas","Isla Ometepe","San Jorge"];function mQe(){const{refreshKey:t,refresh:e}=gc(),[r,n]=x.useState([]),[a,s]=x.useState(!0),[o,l]=x.useState(""),[c,u]=x.useState(!1),[d,f]=x.useState(""),[A,h]=x.useState("0"),[m,p]=x.useState("Rivas"),[g,v]=x.useState(null),[y,b]=x.useState(""),[w,j]=x.useState("0"),[I,_]=x.useState("Rivas");x.useEffect(()=>{(async()=>{s(!0),l("");try{const X=er(_t(Fe,"sellers_candies"),dn("name","asc")),pe=await Qt(X),ge=[];pe.forEach(fe=>{const xe=fe.data();ge.push({id:fe.id,name:xe.name||"",commissionPercent:Number(xe.commissionPercent||0),branch:xe.branch||"Rivas",createdAt:xe.createdAt||dr.now()})}),n(ge)}catch(X){console.error(X),l(" Error cargando vendedores.")}finally{s(!1)}})()},[t]);const S=()=>{f(""),h("0"),p("Rivas")},E=async X=>{X.preventDefault(),l("");const pe=d.trim();if(!pe){l("Ingresa el nombre y apellido del vendedor.");return}const ge=Number(A||0);if(ge<0){l("El margen no puede ser negativo.");return}try{const fe={name:pe,commissionPercent:ge,branch:m,createdAt:dr.now()},xe=await On(_t(Fe,"sellers_candies"),fe);n(ae=>[{id:xe.id,...fe},...ae]),l(" Vendedor creado correctamente."),S(),u(!1)}catch(fe){console.error(fe),l(" Error al crear el vendedor.")}},F=X=>{v(X.id),b(X.name),j(X.commissionPercent.toString()),_(X.branch)},k=()=>{v(null),b(""),j("0"),_("Rivas")},P=async()=>{if(!g)return;l("");const X=y.trim();if(!X){l("El nombre y apellido no pueden estar vacos.");return}const pe=Number(w||0);if(pe<0){l("El margen no puede ser negativo.");return}try{await pn(Yt(Fe,"sellers_candies",g),{name:X,commissionPercent:pe,branch:I}),n(ge=>ge.map(fe=>fe.id===g?{...fe,name:X,commissionPercent:pe,branch:I}:fe)),l(" Vendedor actualizado."),k()}catch(ge){console.error(ge),l(" Error al actualizar el vendedor.")}},D=async X=>{if(window.confirm(`Eliminar al vendedor "${X.name}"? Esta accin no se puede deshacer.`))try{await Fn(Yt(Fe,"sellers_candies",X.id)),n(ge=>ge.filter(fe=>fe.id!==X.id)),l(" Vendedor eliminado.")}catch(ge){console.error(ge),l(" Error al eliminar el vendedor.")}};return i.jsxs("div",{className:"max-w-5xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Vendedores de Dulces"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(pc,{onClick:e,loading:a}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>u(!0),children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo vendedor"]})]})]}),c&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Nuevo vendedor de dulces"}),i.jsxs("form",{onSubmit:E,className:"space-y-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre y apellido"}),i.jsx("input",{className:"w-full border p-2 rounded",value:d,onChange:X=>f(X.target.value),placeholder:"Ej: Juan Prez"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Margen del vendedor (% sobre U Aproximada)"}),i.jsx("input",{type:"number",step:"0.01",min:0,className:"w-full border p-2 rounded",value:A,onChange:X=>h(X.target.value),placeholder:"Ej: 30"}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Este porcentaje YA NO es comisin sobre venta. Se aplica as: U. Vendedor = U. Aproximada  (margen/100). U. Inversionista = U. Aproximada  U. Vendedor."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Sucursal"}),i.jsx("select",{className:"w-full border p-2 rounded",value:m,onChange:X=>p(X.target.value),children:K$.map(X=>i.jsx("option",{value:X,children:X},X))})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[i.jsx("button",{type:"button",onClick:()=>{S(),u(!1)},className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Guardar vendedor"})]})]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-3",children:i.jsxs("table",{className:"min-w-[700px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Nombre y apellido"}),i.jsx("th",{className:"p-2 border",children:"Margen (% U Aproximada)"}),i.jsx("th",{className:"p-2 border",children:"Sucursal"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:a?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):r.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin vendedores registrados."})}):r.map(X=>{const pe=g===X.id;return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:pe?i.jsx("input",{className:"border p-1 rounded text-xs w-full",value:y,onChange:ge=>b(ge.target.value)}):X.name}),i.jsx("td",{className:"p-2 border",children:pe?i.jsx("input",{type:"number",step:"0.01",min:0,className:"border p-1 rounded text-xs w-24 text-right",value:w,onChange:ge=>j(ge.target.value)}):`${X.commissionPercent.toFixed(2)} %`}),i.jsx("td",{className:"p-2 border",children:pe?i.jsx("select",{className:"border p-1 rounded text-xs",value:I,onChange:ge=>_(ge.target.value),children:K$.map(ge=>i.jsx("option",{value:ge,children:ge},ge))}):X.branch}),i.jsx("td",{className:"p-2 border",children:pe?i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:P,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:k,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600 text-xs",onClick:()=>F(X),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>D(X),children:"Borrar"})]})})]},X.id)})})]})}),o&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const va=t=>Math.max(0,Math.floor(Number(t||0)));function _R(t){return Math.max(1,va(t.unitsPerPackage||1))}function pQe(t){const e=Number(t.remaining);if(Number.isFinite(e)&&e>0)return Math.floor(e);const r=_R(t),n=Number(t.totalUnits||0),a=Number(t.quantity||0),s=Number(t.packages||0);return n>0?Math.floor(n):a>0?Math.floor(a):s>0?Math.floor(s*r):0}async function gse(t){const{orderId:e,productId:r}=t;let n=va(t.packagesToReturn);if(!e||!r||n<=0)return;const a=er(_t(Fe,"inventory_candies"),cr("orderId","==",e),cr("productId","==",r),dn("createdAt","asc")),s=await Qt(a);if(s.empty)return;const o=s.docs.map(l=>l.ref);await Ii(Fe,async l=>{const c=await Promise.all(o.map(u=>l.get(u)));for(let u=0;u<o.length&&n>0;u++){const d=c[u];if(!d.exists())continue;const f=d.data(),A=_R(f),h=n*A,p=va(f.remaining??0)+h,g=Math.floor(p/A);l.update(o[u],{remaining:p,remainingPackages:g,packages:g,updatedAt:dr.now()}),n=0}})}async function xse(t){const{orderId:e,productId:r}=t,n=va(t.packagesToReturn);if(!e||!r||n<=0)return;const a=Yt(Fe,"candy_main_orders",e);await Ii(Fe,async s=>{const o=await s.get(a);if(!o.exists())return;const l=o.data(),c=Array.isArray(l.items)?l.items:[];let u=!1;const d=c.map(f=>String((f==null?void 0:f.id)||"")!==String(r)?f:(u=!0,{...f,remainingPackages:va(f.remainingPackages)+n}));u&&s.update(a,{items:d,updatedAt:dr.now()})})}function nF(t){if(!Array.isArray(t))return[];const e=[];for(const r of t){const n=String((r==null?void 0:r.batchId)||""),a=String((r==null?void 0:r.masterOrderId)||(r==null?void 0:r.orderId)||""),s=va((r==null?void 0:r.units)??(r==null?void 0:r.qty)??(r==null?void 0:r.quantity)??0),o=Math.max(1,va((r==null?void 0:r.unitsPerPackage)||1));!n||!a||s<=0||e.push({batchId:n,masterOrderId:a,units:s,unitsPerPackage:o})}return e}function M2(t,e){const r=va(t),n=Math.max(1,va(e));return Math.floor(r/n)}async function gQe(t){const e=String(t.productId||"");let r=va(t.packagesToAllocate);if(!e||r<=0)return{allocations:[]};const n=er(_t(Fe,"inventory_candies"),cr("productId","==",e)),a=await Qt(n);if(a.empty)throw new Error("No hay inventario para este producto.");const o=a.docs.map(c=>({id:c.id,data:c.data()})).sort((c,u)=>{var m,p;const d=String(c.data.date||""),f=String(u.data.date||"");if(d!==f)return d<f?-1:1;const A=((m=c.data.createdAt)==null?void 0:m.seconds)??0,h=((p=u.data.createdAt)==null?void 0:p.seconds)??0;return A-h}).map(c=>Yt(Fe,"inventory_candies",c.id)),l=[];return await Ii(Fe,async c=>{const u=await Promise.all(o.map(g=>c.get(g))),d=[];let f=r;for(let g=0;g<o.length&&f>0;g++){const v=o[g],y=u[g];if(!y.exists())continue;const b=y.data(),w=_R(b),j=pQe(b);if(j<=0)continue;const I=Math.floor(j/w);if(I<=0)continue;const _=Math.min(I,f),S=_*w,E=Math.max(0,j-S),F=Math.floor(E/w),k=String(b.orderId||"");if(!k)throw new Error("Lote sin orderId (orden maestra).");l.push({batchId:v.id,masterOrderId:k,units:S,unitsPerPackage:w}),d.push({ref:v,newRemUnits:E,newRemPacks:F}),f-=_}if(f>0)throw new Error(`Inventario insuficiente. Faltan ${f} paquetes.`);const A={};for(const g of l){const v=M2(g.units,g.unitsPerPackage);A[g.masterOrderId]=(A[g.masterOrderId]||0)+v}const h=Object.keys(A),m=h.map(g=>Yt(Fe,"candy_main_orders",g)),p=await Promise.all(m.map(g=>c.get(g)));for(let g=0;g<d.length;g++){const v=d[g];c.update(v.ref,{remaining:v.newRemUnits,remainingPackages:v.newRemPacks,packages:v.newRemPacks,updatedAt:dr.now()})}for(let g=0;g<m.length;g++){const v=p[g];if(!v.exists())throw new Error("Orden maestra no existe.");const y=v.data(),b=Array.isArray(y.items)?y.items:[],w=va(A[h[g]]||0);if(w<=0)continue;let j=!1;const I=b.map(_=>{if(String((_==null?void 0:_.id)||"")!==e)return _;const S=va(_.remainingPackages);if(S<w)throw new Error("Orden maestra sin paquetes suficientes.");return j=!0,{..._,remainingPackages:S-w}});j&&c.update(m[g],{items:I,updatedAt:dr.now()})}}),{allocations:l}}async function xQe(t){const e=String(t.vendorInventoryId||"");let r=va(t.packagesToReturn);if(!e)throw new Error("vendorInventoryId requerido");if(r<=0)return{restoredPackages:0,mode:"noop"};const n=Yt(Fe,"inventory_candies_sellers",e),a=await Bs(n);if(!a.exists())throw new Error("No existe la orden del vendedor");const s=a.data(),o=String(s.productId||"");if(!o)throw new Error("La orden del vendedor no tiene productId");if(!nF(s.masterAllocations||s.allocations||s.allocationsByBatch).length){const u=String(s.orderId||"");if(!u)throw new Error("La orden del vendedor no tiene orderId");return await gse({orderId:u,productId:o,packagesToReturn:r}),await xse({orderId:u,productId:o,packagesToReturn:r}),{restoredPackages:r,mode:"legacy"}}let c=0;return await Ii(Fe,async u=>{const d=await u.get(n);if(!d.exists())throw new Error("No existe la orden del vendedor");const f=d.data(),A=String(f.productId||"");if(!A)throw new Error("Doc vendedor sin productId");let h=nF(f.masterAllocations||f.allocations||f.allocationsByBatch);if(!h.length)throw new Error("No hay masterAllocations guardadas en este doc (no se puede restaurar blindado).");const m=[];let p=r;for(let E=h.length-1;E>=0&&p>0;E--){const F=h[E],k=Math.max(1,va(F.unitsPerPackage||1)),P=M2(F.units,k);if(P<=0)continue;const D=Math.min(P,p),X=D*k;m.push({batchId:F.batchId,masterOrderId:F.masterOrderId,units:X,unitsPerPackage:k}),p-=D}const g=r-p;if(g<=0)return;c=g;const v=m.map(E=>Yt(Fe,"inventory_candies",E.batchId)),y={};for(const E of m){const F=M2(E.units,E.unitsPerPackage);F>0&&(y[E.masterOrderId]=(y[E.masterOrderId]||0)+F)}const w=Object.keys(y).map(E=>Yt(Fe,"candy_main_orders",E)),[j,I]=await Promise.all([Promise.all(v.map(E=>u.get(E))),Promise.all(w.map(E=>u.get(E)))]);for(let E=0;E<m.length;E++){const F=m[E],k=j[E];if(!k.exists())continue;const P=k.data(),D=Math.max(1,va(F.unitsPerPackage||P.unitsPerPackage||1)),X=va(F.units),ge=va(P.remaining??0)+X,fe=Math.floor(ge/D);u.update(v[E],{remaining:ge,remainingPackages:fe,packages:fe,updatedAt:dr.now()})}for(let E=0;E<w.length;E++){const F=I[E];if(!F.exists())continue;const k=w[E].id,P=va(y[k]||0);if(P<=0)continue;const D=F.data(),X=Array.isArray(D.items)?D.items:[];let pe=!1;const ge=X.map(fe=>String((fe==null?void 0:fe.id)||"")!==String(A)?fe:(pe=!0,{...fe,remainingPackages:va(fe.remainingPackages)+P}));pe&&u.update(w[E],{items:ge,updatedAt:dr.now()})}const _=new Map;for(const E of m){const F=`${E.batchId}__${E.masterOrderId}__${E.unitsPerPackage}`;_.set(F,(_.get(F)||0)+va(E.units))}const S=[];for(const E of h){const F=Math.max(1,va(E.unitsPerPackage||1)),k=`${E.batchId}__${E.masterOrderId}__${F}`,P=va(_.get(k)||0);if(P<=0){S.push(E);continue}const X=va(E.units)-P;X>0&&S.push({...E,units:X,unitsPerPackage:F}),_.delete(k)}u.update(n,{masterAllocations:S,updatedAt:dr.now()})}),{restoredPackages:c,mode:"blind"}}async function q$(t){if(!t)throw new Error("vendorInventoryId requerido");const e=Yt(Fe,"inventory_candies_sellers",t),r=await Bs(e);if(!r.exists())throw new Error("No existe la orden del vendedor");const n=r.data(),a=String(n.productId||""),s=va(n.packages||n.remainingPackages||0),o=nF(n.masterAllocations||n.allocations||n.allocationsByBatch);if(!o.length){const c=String(n.orderId||"");if(!c)throw new Error("La orden del vendedor no tiene orderId");if(!a)throw new Error("La orden del vendedor no tiene productId");return s<=0?(await Ii(Fe,async u=>{u.delete(e)}),{restoredPackages:0,mode:"legacy"}):(await gse({orderId:c,productId:a,packagesToReturn:s}),await xse({orderId:c,productId:a,packagesToReturn:s}),await Ii(Fe,async u=>{u.delete(e)}),{restoredPackages:s,mode:"legacy"})}let l=0;return await Ii(Fe,async c=>{const u={};for(const g of o){const v=Math.max(1,va(g.unitsPerPackage||1)),y=va(g.units),b=M2(y,v);b>0&&(u[g.masterOrderId]=(u[g.masterOrderId]||0)+b)}const d=o.map(g=>Yt(Fe,"inventory_candies",g.batchId)),A=Object.keys(u).map(g=>Yt(Fe,"candy_main_orders",g)),[h,m]=await Promise.all([Promise.all(d.map(g=>c.get(g))),Promise.all(A.map(g=>c.get(g)))]);let p=0;for(let g=0;g<o.length;g++){const v=o[g],y=h[g];if(!y.exists())continue;const b=y.data(),w=Math.max(1,va(v.unitsPerPackage||b.unitsPerPackage||1)),j=va(v.units),_=va(b.remaining??0)+j,S=Math.floor(_/w);c.update(d[g],{remaining:_,remainingPackages:S,packages:S,updatedAt:dr.now()});const E=M2(j,w);E>0&&(p+=E)}for(let g=0;g<A.length;g++){const v=m[g];if(!v.exists())continue;const y=A[g].id,b=va(u[y]||0);if(b<=0)continue;const w=v.data(),j=Array.isArray(w.items)?w.items:[];let I=!1;const _=j.map(S=>String((S==null?void 0:S.id)||"")!==String(a)?S:(I=!0,{...S,remainingPackages:va(S.remainingPackages)+b}));I&&c.update(A[g],{items:_,updatedAt:dr.now()})}c.delete(e),l=p}),{restoredPackages:l,mode:"blind"}}const H5=t=>`C$ ${(Number(t)||0).toFixed(2)}`,vse=(t,e)=>`${t}__${e}`,vQe=t=>t?typeof t=="string"?t:t!=null&&t.seconds?new Date(t.seconds*1e3).toISOString().slice(0,10):t!=null&&t.toDate?t.toDate().toISOString().slice(0,10):"":"",yQe=t=>{const e=t.sellerId||"",r=vQe(t.date);return e&&r?vse(e,r):t.orderId?t.orderId:t.id},z$=(t,e=!1)=>{if(!t)return null;const r=new Date(t);return Number.isNaN(r.getTime())?null:(e?r.setHours(23,59,59,999):r.setHours(0,0,0,0),r)},bQe=t=>{var e,r;if((e=t.createdAt)!=null&&e.toDate)return t.createdAt.toDate();if((r=t.createdAt)!=null&&r.seconds)return new Date(t.createdAt.seconds*1e3);if(t.date){const n=new Date(t.date);if(!Number.isNaN(n.getTime()))return n}return null},W$=t=>{const e=String(t||"").trim().toUpperCase();if(e.includes("ISLA"))return"ISLA";if(e.includes("JORGE"))return"SAN_JORGE";if(e.includes("RIVAS"))return"RIVAS"},aF=t=>{const e=Number(t||0);return!isFinite(e)||e<0?0:e},X$=(t,e)=>{const r=aF(e),n=Number(t||0)*(r/100),a=Number(t||0)-n;return{vendorMarginPercent:r,uVendor:n,uInvestor:a}},Y$=(t,e)=>e?e==="RIVAS"?t.unitPriceRivas||0:e==="SAN_JORGE"?t.unitPriceSanJorge||0:t.unitPriceIsla||0:t.unitPriceIsla||0,J$=(t,e)=>e?e==="RIVAS"?t.grossProfitPerPackRivas||0:e==="SAN_JORGE"?t.grossProfitPerPackSanJorge||0:t.grossProfitPerPackIsla||0:t.grossProfitPerPackIsla||0,Z$=(t,e)=>e?e==="RIVAS"?t.uApproxPerPackRivas||0:e==="SAN_JORGE"?t.uApproxPerPackSanJorge||0:t.uApproxPerPackIsla||0:t.uApproxPerPackIsla||0;function wQe({open:t,onClose:e,orders:r,rows:n,setRows:a,isAdmin:s,currentUserEmail:o,currentUserName:l,sellerCandyId:c,sellers:u,products:d,transferAgg:f,setTransferAgg:A,setTransferRowDeltas:h}){const[m,p]=x.useState(!1),[g,v]=x.useState([]),[y,b]=x.useState(""),[w,j]=x.useState(""),[I,_]=x.useState(""),[S,E]=x.useState(""),[F,k]=x.useState("0"),[P,D]=x.useState(""),[X,pe]=x.useState(!1),[ge,fe]=x.useState(""),[xe,ae]=x.useState(!1),[Se,Te]=x.useState(""),[O,G]=x.useState(()=>new Date().toISOString().slice(0,10)),[z,L]=x.useState(""),[Z,ee]=x.useState(()=>{const Ne=new Date;return new Date(Ne.getFullYear(),Ne.getMonth(),1).toISOString().slice(0,10)}),[R,H]=x.useState(()=>new Date().toISOString().slice(0,10)),ne=x.useMemo(()=>{const Ne={};return u.forEach(Ve=>{Ne[Ve.id]=Ve}),Ne},[u]),ve=x.useMemo(()=>{const Ne={};return d.forEach(Ve=>{Ne[Ve.id]=Ve}),Ne},[d]),U=Se&&ne[Se]||null,He=x.useMemo(()=>r.map(Ne=>Ne.orderKey),[r]),se=x.useMemo(()=>{const Ne={};return r.forEach(Ve=>Ne[Ve.orderKey]=Ve),Ne},[r]),re=n,Pe=x.useMemo(()=>{const Ne={};return re.forEach(Ve=>{const he=yQe(Ve),le=new Set;he&&le.add(he),Ve.orderId&&le.add(String(Ve.orderId)),le.add(Ve.id),le.forEach(Be=>{Ne[Be]||(Ne[Be]=[]),Ne[Be].push(Ve)})}),Ne},[re]),ue=x.useMemo(()=>y?Pe[y]||[]:[],[Pe,y]),we=x.useMemo(()=>ue.filter(Ne=>{const Ve=Ne.remainingPackages??Ne.remaining??Ne.packages??0;return Number(Ve||0)>0}),[ue]),Me=x.useMemo(()=>{const Ne=z.trim().toLowerCase();return Ne?we.filter(Ve=>`${Ve.category||""} ${Ve.productName||""}`.toLowerCase().trim().includes(Ne)):we},[we,z]),ze=x.useMemo(()=>w&&re.find(Ne=>Ne.id===w)||null,[re,w]),yt=x.useMemo(()=>{if(ze!=null&&ze.sellerId)return ze.sellerId;const Ne=se[y];return(Ne==null?void 0:Ne.sellerId)||""},[ze,se,y]),It=x.useMemo(()=>I?Pe[I]||[]:[],[Pe,I]),Ke=x.useMemo(()=>ze?It.filter(Ne=>Ne.productId===ze.productId):[],[It,ze]),wt=async()=>{try{p(!0);let Ne=[];if(!s&&c){const Ve=er(_t(Fe,"inventory_transfers_candies"),cr("fromSellerId","==",c),dn("createdAt","desc")),he=er(_t(Fe,"inventory_transfers_candies"),cr("toSellerId","==",c),dn("createdAt","desc")),[le,Be]=await Promise.all([Qt(Ve),Qt(he)]),je=new Set,Ae=Qe=>{Qe.forEach(Ct=>{if(je.has(Ct.id))return;je.add(Ct.id);const pt=Ct.data();Ne.push({id:Ct.id,...pt})})};Ae(le),Ae(Be),Ne.sort((Qe,Ct)=>{var te,ie;const pt=((te=Qe.createdAt)==null?void 0:te.seconds)||0;return(((ie=Ct.createdAt)==null?void 0:ie.seconds)||0)-pt})}else{const Ve=er(_t(Fe,"inventory_transfers_candies"),dn("createdAt","desc"));(await Qt(Ve)).forEach(le=>{const Be=le.data();Ne.push({id:le.id,...Be})})}v(Ne)}catch{fe(" Error cargando traslados.")}finally{p(!1)}};x.useEffect(()=>{t&&wt()},[t]);const At=x.useMemo(()=>{const Ne=z$(Z),Ve=z$(R,!0);return g.filter(he=>{const le=bQe(he);return le?!(Ne&&le<Ne||Ve&&le>Ve):!0})},[g,Z,R]);x.useEffect(()=>{L("")},[y]),x.useEffect(()=>{if(xe){if(!Se){const Ne=se[y];Ne!=null&&Ne.sellerId&&Te(Ne.sellerId)}O||G(new Date().toISOString().slice(0,10))}},[xe,Se,O,se,y]);const bt=()=>{b(""),j(""),_(""),E(""),k("0"),D(""),ae(!1),Te(""),G(new Date().toISOString().slice(0,10))},ke=async()=>{if(!s){fe("No tienes permiso para hacer traslados.");return}fe("");const Ne=Number(F||0);if(!(Ne>0)){fe("La cantidad de paquetes debe ser mayor a 0.");return}if(!P.trim()){fe("Debes escribir el motivo de la movida.");return}if(!y||!w){fe("Selecciona el pedido origen y el producto.");return}const Ve=xe;if(!Ve&&!I){fe("Selecciona el pedido destino.");return}if(Ve){if(!Se){fe("Selecciona el vendedor de la nueva orden.");return}if(!O){fe("Selecciona la fecha de la nueva orden.");return}}const he=!Ve&&I&&se[I]||null;if(!Ve&&!he){fe("Selecciona un pedido destino vlido.");return}const le=he?ne[he.sellerId]||{id:he.sellerId||"",name:he.sellerName||"",email:he.sellerEmail||"",branch:he.branch,branchLabel:he.branchLabel,commissionPercent:he.vendorMarginPercent??he.commissionPercent??0}:null,Be=n.find(de=>de.id===w)||null,je=!Ve&&S&&n.find(de=>de.id===S)||null;if(!Be){fe("No se encontr la fila origen/destino.");return}if(!Ve&&je&&w===S){fe("Origen y destino no pueden ser el mismo.");return}if(!Ve&&je&&Be.productId!==je.productId){fe("El producto destino no coincide con el producto origen.");return}if(Number(Be.remainingPackages||0)<Ne){fe("El origen no tiene suficientes paquetes disponibles.");return}const Ae=Ve?U:null;if(Ve&&!Ae){fe("Selecciona un vendedor destino vlido.");return}const Qe=ve[Be.productId]||null,Ct=Ve?W$((Ae==null?void 0:Ae.branch)||(Ae==null?void 0:Ae.branchLabel)):void 0,pt=!Ve&&!S&&!!he,me=Ve||pt;let te=null,ie=null,$e="";if(Ve&&Ae){const de=aF(Ae.commissionPercent??0),Ce=Ct,nt=Number((Qe==null?void 0:Qe.unitsPerPackage)??Be.unitsPerPackage??0),vt=nt>0?nt*Ne:0;Qe?Y$(Qe,Ce):Number(Be.unitPriceRivas||Be.unitPriceIsla||0);const xt=(Qe?J$(Qe,Ce):Number(Be.grossProfit||0)/Math.max(1,Be.packages||1))*Ne,Xe=Qe?Number(Qe.logisticAllocatedPerPack||0)*Ne:Number(Be.logisticAllocated||0),st=(Qe?Z$(Qe,Ce):Number(Be.uAproximada||0)/Math.max(1,Be.packages||1))*Ne,K=X$(xt,de),Ie=Number(xt||0)-Number(Xe||0)-Number(K.uVendor||0),Ze=((Qe==null?void 0:Qe.unitPriceRivas)||Be.unitPriceRivas||0)*Ne,at=((Qe==null?void 0:Qe.unitPriceSanJorge)||Be.unitPriceSanJorge||0)*Ne,it=((Qe==null?void 0:Qe.unitPriceIsla)||Be.unitPriceIsla||0)*Ne;$e=vse(Ae.id,O),te={sellerId:Ae.id,sellerName:Ae.name,sellerEmail:Ae.email||"",branch:Ce||"",branchLabel:Ae.branchLabel||"",productId:Be.productId,productName:Be.productName,category:Be.category,orderId:$e,date:O,packages:Ne,unitsPerPackage:nt,totalUnits:vt,remainingPackages:Ne,remainingUnits:vt,totalRivas:Ze,totalSanJorge:at,totalIsla:it,unitPriceRivas:(Qe==null?void 0:Qe.unitPriceRivas)||Be.unitPriceRivas||0,unitPriceSanJorge:(Qe==null?void 0:Qe.unitPriceSanJorge)||Be.unitPriceSanJorge||0,unitPriceIsla:(Qe==null?void 0:Qe.unitPriceIsla)||Be.unitPriceIsla||0,grossProfit:xt,logisticAllocated:Xe,vendorMarginPercent:K.vendorMarginPercent,uVendor:K.uVendor,uInvestor:K.uInvestor,uAproximada:st,uNeta:Ie,providerPrice:Be.providerPrice,transferDelta:0}}if(pt&&he){const de=aF((le==null?void 0:le.commissionPercent)??he.vendorMarginPercent??0),Ce=W$((le==null?void 0:le.branch)||(le==null?void 0:le.branchLabel)||he.branch||he.branchLabel),nt=Number((Qe==null?void 0:Qe.unitsPerPackage)??Be.unitsPerPackage??0),vt=nt>0?nt*Ne:0;Qe?Y$(Qe,Ce):Number(Be.unitPriceRivas||Be.unitPriceIsla||0);const xt=(Qe?J$(Qe,Ce):Number(Be.grossProfit||0)/Math.max(1,Be.packages||1))*Ne,Xe=Qe?Number(Qe.logisticAllocatedPerPack||0)*Ne:Number(Be.logisticAllocated||0),st=(Qe?Z$(Qe,Ce):Number(Be.uAproximada||0)/Math.max(1,Be.packages||1))*Ne,K=X$(xt,de),Ie=Number(xt||0)-Number(Xe||0)-Number(K.uVendor||0),Ze=((Qe==null?void 0:Qe.unitPriceRivas)||Be.unitPriceRivas||0)*Ne,at=((Qe==null?void 0:Qe.unitPriceSanJorge)||Be.unitPriceSanJorge||0)*Ne,it=((Qe==null?void 0:Qe.unitPriceIsla)||Be.unitPriceIsla||0)*Ne;ie={sellerId:he.sellerId,sellerName:(le==null?void 0:le.name)||he.sellerName||"",sellerEmail:(le==null?void 0:le.email)||he.sellerEmail||"",branch:Ce||he.branch||"",branchLabel:(le==null?void 0:le.branchLabel)||he.branchLabel||"",productId:Be.productId,productName:Be.productName,category:Be.category,orderId:he.orderKey||I,date:he.date||new Date().toISOString().slice(0,10),packages:Ne,unitsPerPackage:nt,totalUnits:vt,remainingPackages:Ne,remainingUnits:vt,totalRivas:Ze,totalSanJorge:at,totalIsla:it,unitPriceRivas:(Qe==null?void 0:Qe.unitPriceRivas)||Be.unitPriceRivas||0,unitPriceSanJorge:(Qe==null?void 0:Qe.unitPriceSanJorge)||Be.unitPriceSanJorge||0,unitPriceIsla:(Qe==null?void 0:Qe.unitPriceIsla)||Be.unitPriceIsla||0,grossProfit:xt,logisticAllocated:Xe,vendorMarginPercent:K.vendorMarginPercent,uVendor:K.uVendor,uInvestor:K.uInvestor,uAproximada:st,uNeta:Ie,providerPrice:Be.providerPrice,transferDelta:0}}try{pe(!0);const de=Yt(Fe,"inventory_candies_sellers",Be.id),Ce=Ve||pt?Yt(_t(Fe,"inventory_candies_sellers")):Yt(Fe,"inventory_candies_sellers",je.id),nt=dr.now(),vt=new Date().toISOString().slice(0,10);let ht=null;await Ii(Fe,async xt=>{const Xe=await xt.get(de);if(!Xe.exists())throw new Error("Orden origen no existe.");const be=Xe.data(),st=Number(be.remainingPackages||0);if(st<Ne)throw new Error("Origen no tiene suficientes paquetes.");let K=null;if(!Ve&&!pt){const M=await xt.get(Ce);if(!M.exists())throw new Error("Orden destino no existe.");K=M.data()}const Ie=Number(be.unitsPerPackage||Be.unitsPerPackage||0),Ze=Ie>0?Ne*Ie:0,at=Number(be.transferDelta||0);xt.update(de,{packages:Math.max(0,Number(be.packages||0)-Ne),remainingPackages:st-Ne,...Ie>0?{remainingUnits:Number(be.remainingUnits||0)-Ze}:{},updatedAt:nt,transferDelta:at-Ne});let it=null;if(Ve){const M={...te,createdAt:nt,updatedAt:nt,remainingPackages:Ne,remainingUnits:Number((te==null?void 0:te.unitsPerPackage)||0)>0?Ne*Number((te==null?void 0:te.unitsPerPackage)||0):te==null?void 0:te.remainingUnits,transferDelta:0};xt.set(Ce,M),it=M,ht={id:Ce.id,...M}}else if(pt&&ie){const M={...ie,createdAt:nt,updatedAt:nt,remainingPackages:Ne,remainingUnits:Number(ie.unitsPerPackage||0)>0?Ne*Number(ie.unitsPerPackage||0):ie.remainingUnits,transferDelta:0};xt.set(Ce,M),it=M,ht={id:Ce.id,...M}}else{const M=K,V=Number(M.unitsPerPackage||Be.unitsPerPackage||0),q=V>0?Ne*V:0,Y=Number(M.transferDelta||0);xt.update(Ce,{packages:Math.max(0,Number(M.packages||0)+Ne),remainingPackages:Number(M.remainingPackages||0)+Ne,...V>0?{remainingUnits:Number(M.remainingUnits||0)+q}:{},updatedAt:nt,transferDelta:Y+Ne}),it={...M,remainingPackages:Number(M.remainingPackages||0)+Ne,remainingUnits:V>0?Number(M.remainingUnits||0)+q:M.remainingUnits,sellerId:M.sellerId,sellerName:M.sellerName,orderId:M.orderId||(je==null?void 0:je.id)||"",transferDelta:Y+Ne}}const T=Yt(_t(Fe,"inventory_transfers_candies"));xt.set(T,{createdAt:nt,date:vt,createdByEmail:(o||"").trim(),createdByName:String(l||"").trim(),productId:String(be.productId||""),productName:String(be.productName||""),packagesMoved:Ne,providerPrice:Number(be.providerPrice||0),unitPriceRivas:Number(be.unitPriceRivas||0),unitPriceIsla:Number(be.unitPriceIsla||0),fromSellerId:String(be.sellerId||""),fromSellerName:String(be.sellerName||""),fromOrderKey:String(be.orderId||Be.id||""),fromOrderLabel:String(be.orderId||Be.id||""),toSellerId:Ve?(Ae==null?void 0:Ae.id)||"":String((it==null?void 0:it.sellerId)||""),toSellerName:Ve?(Ae==null?void 0:Ae.name)||"":String((it==null?void 0:it.sellerName)||""),toOrderKey:Ve?$e:String((it==null?void 0:it.orderId)||I||""),toOrderLabel:Ve?$e:String((it==null?void 0:it.orderId)||I||""),fromVendorRowId:Be.id,toVendorRowId:Ve||pt?Ce.id:je.id,comment:P.trim(),destRowWasNew:me})}),a(xt=>{const Xe=xt.reduce((be,st)=>{if(st.id===Be.id){const K=Number(st.unitsPerPackage||0),Ie=K>0?Ne*K:0;return be.push({...st,packages:Math.max(0,Number(st.packages||0)-Ne),remainingPackages:Number(st.remainingPackages||0)-Ne,remainingUnits:K>0?Number(st.remainingUnits||0)-Ie:st.remainingUnits,transferDelta:Number(st.transferDelta||0)-Ne}),be}if(!Ve&&je&&st.id===je.id){const K=Number(st.unitsPerPackage||0),Ie=K>0?Ne*K:0;return be.push({...st,packages:Math.max(0,Number(st.packages||0)+Ne),remainingPackages:Number(st.remainingPackages||0)+Ne,remainingUnits:K>0?Number(st.remainingUnits||0)+Ie:st.remainingUnits,transferDelta:Number(st.transferDelta||0)+Ne}),be}return be.push(st),be},[]);return ht?[...Xe,ht]:Xe}),await wt(),A(xt=>{const Xe={...xt},be=y,st=Ve?$e:I;return be&&(Xe[be]=Xe[be]||{out:0,in:0},Xe[be].out+=Ne),st&&(Xe[st]=Xe[st]||{out:0,in:0},Xe[st].in+=Ne),Xe}),h(xt=>{const Xe={...xt};if(Be.id&&(Xe[Be.id]=(Xe[Be.id]||0)-Ne),!me){const be=pt||Ve?ht==null?void 0:ht.id:je==null?void 0:je.id;be&&(Xe[be]=(Xe[be]||0)+Ne)}return Xe}),bt(),fe(" Traslado realizado.")}catch(de){fe((de==null?void 0:de.message)||" Error realizando el traslado.")}finally{pe(!1)}};return t?i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[55]",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-7xl max-h-[90vh] overflow-y-auto text-sm relative",children:[X&&i.jsx("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-50",children:i.jsx("div",{className:"bg-white border rounded-lg px-4 py-3 shadow text-sm font-semibold",children:"Guardando traslado..."})}),i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Traslado de paquetes"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{e(),bt()},type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"border rounded p-3 bg-gray-50 mb-4",children:[i.jsx("div",{className:"text-sm font-semibold mb-2",children:"Crear traslado (requiere motivo)"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pedido origen"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:y,onChange:Ne=>{b(Ne.target.value),j(""),_(""),E(""),k("0")},disabled:!s,children:[i.jsx("option",{value:"",children:"Selecciona"}),He.map(Ne=>{const Ve=se[Ne];return i.jsxs("option",{value:Ne,children:["Vendedor: ",(Ve==null?void 0:Ve.sellerName)||"","  Existencias:"," ",(Ve==null?void 0:Ve.totalRemainingPackages)||"0"," Paquetes - Fecha Orden:"," ",(Ve==null?void 0:Ve.date)||""]},Ne)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (desde el pedido origen)"}),i.jsx("input",{type:"text",className:"mt-1 mb-2 w-full border p-2 rounded text-sm",placeholder:"Buscar producto...",value:z,onChange:Ne=>L(Ne.target.value),disabled:!s||!y}),i.jsxs("select",{className:"w-full border p-2 rounded",value:w,onChange:Ne=>{j(Ne.target.value),_(""),E(""),k("0")},disabled:!s||!y,children:[i.jsx("option",{value:"",children:"Selecciona"}),Me.map(Ne=>i.jsxs("option",{value:Ne.id,children:[Ne.productName,"  Existencias:"," ",Number(Ne.remainingPackages??Ne.packages??0)," Paquetes - Precio Costo: $",Ne.providerPrice]},Ne.id))]})]}),!xe&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pedido destino"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:I,onChange:Ne=>{_(Ne.target.value),E("")},disabled:!s||!w,children:[i.jsx("option",{value:"",children:"Selecciona"}),He.filter(Ne=>Ne!==y).map(Ne=>{const Ve=se[Ne];return i.jsxs("option",{value:Ne,children:["Vendedor: ",(Ve==null?void 0:Ve.sellerName)||"","  Existencias:"," ",(Ve==null?void 0:Ve.totalRemainingPackages)||"0"," - Fecha Orden:"," ",(Ve==null?void 0:Ve.date)||""]},Ne)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto destino (mismo producto)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:S,onChange:Ne=>E(Ne.target.value),disabled:!s||!I||!ze,children:[i.jsx("option",{value:"",children:"Selecciona"}),Ke.map(Ne=>i.jsxs("option",{value:Ne.id,children:["Tipo: ",Ne.category," - ",Ne.productName,"  Existencias:"," ",Number(Ne.remainingPackages??Ne.packages??0),"Paquetes - Precio Costo: $",Ne.providerPrice]},Ne.id))]}),I&&ze&&Ke.length===0&&i.jsx("div",{className:"text-xs text-red-600 mt-1",children:" El pedido destino no tiene este producto. Si dejas este campo vaco se crear automticamente al moverlo."}),I&&i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este campo es opcional; salo solo si el pedido ya tiene el producto y quieres sumar a esa fila."})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:xe,onChange:Ne=>{const Ve=Ne.target.checked;ae(Ve),Ve&&(_(""),E(""))},disabled:!s}),i.jsx("span",{className:"text-sm font-semibold",children:"Crear nueva orden destino (independiente)"})]}),xe&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor destino (nueva orden)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:Se,onChange:Ne=>Te(Ne.target.value),disabled:!s,children:[i.jsx("option",{value:"",children:"Selecciona"}),u.map(Ne=>i.jsxs("option",{value:Ne.id,disabled:Ne.id===yt,children:[Ne.name,Ne.id===yt?" (origen)":""]},Ne.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de la nueva orden"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:O,onChange:Ne=>G(Ne.target.value),disabled:!s}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Esta orden ser independiente. Asegrate de usar una fecha que no tenga otro pedido activo para el mismo vendedor."})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad paquetes a mover"}),i.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:F,onChange:Ne=>k(Ne.target.value),disabled:!s||!w||!xe&&!I})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Motivo de movida (obligatorio)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:P,onChange:Ne=>D(Ne.target.value),disabled:!s,placeholder:"Ej: Se cambi de ruta por reorganizacin",maxLength:250})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",onClick:bt,disabled:!s||X,children:"Limpiar"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-60",onClick:ke,disabled:!s||X||!w||!xe&&!I||Number(F||0)<=0||!P.trim(),children:"Hacer traslado"})]}),ge&&i.jsx("div",{className:"text-sm text-red-600 mt-2",children:ge})]}),i.jsxs("div",{className:"bg-white rounded border overflow-x-auto",children:[i.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between p-2",children:[i.jsx("div",{className:"text-lg font-semibold",children:"Historial de traslados"}),i.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:Z,onChange:Ne=>ee(Ne.target.value)}),i.jsx("span",{className:"text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:R,onChange:Ne=>H(Ne.target.value)}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:wt,disabled:m,type:"button",children:m?"Cargando...":"Recargar"})]})]}),i.jsxs("table",{className:"min-w-[1400px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha y hora"}),i.jsx("th",{className:"p-2 border",children:"Usuario"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Cantidad paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio Rivas"}),i.jsx("th",{className:"p-2 border",children:"Precio Isla"}),i.jsx("th",{className:"p-2 border",children:"Movido a vendedor"}),i.jsx("th",{className:"p-2 border",children:"Movido a orden"}),i.jsx("th",{className:"p-2 border",children:"Motivo de movida"})]})}),i.jsx("tbody",{children:m?i.jsx("tr",{children:i.jsx("td",{colSpan:10,className:"p-4 text-center",children:"Cargando"})}):At.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:10,className:"p-4 text-center",children:"Sin traslados"})}):At.map(Ne=>{var Be,je;const Ve=((je=(Be=Ne.createdAt)==null?void 0:Be.toDate)==null?void 0:je.call(Be))||(Ne.createdAt?new Date(Ne.createdAt.seconds*1e3):null),he=Ve?`${Ve.toISOString().slice(0,10)} ${Ve.toISOString().slice(11,19)}`:Ne.date||"",le=(Ne.createdByName||"").trim()||(Ne.createdByEmail||"").trim()||"";return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:he}),i.jsx("td",{className:"p-2 border",children:le}),i.jsx("td",{className:"p-2 border text-left",children:Ne.productName||""}),i.jsx("td",{className:"p-2 border",children:Number(Ne.packagesMoved||0)}),i.jsx("td",{className:"p-2 border",children:H5(Ne.providerPrice||0)}),i.jsx("td",{className:"p-2 border",children:H5(Ne.unitPriceRivas||0)}),i.jsx("td",{className:"p-2 border",children:H5(Ne.unitPriceIsla||0)}),i.jsx("td",{className:"p-2 border",children:Ne.toSellerName||""}),i.jsx("td",{className:"p-2 border",children:Ne.toOrderLabel||Ne.toOrderKey||""}),i.jsx("td",{className:"p-2 border text-left",children:Ne.comment||""})]},Ne.id)})})]})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Nota: el traslado mueve EXISTENCIA (remainingPackages/remainingUnits) del pedido origen al destino."})]})}):null}const Vs=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function eG(t){const e=String(t||"").trim().toUpperCase();if(e.includes("ISLA"))return"ISLA";if(e.includes("JORGE"))return"SAN_JORGE";if(e.includes("RIVAS"))return"RIVAS"}const Oi=t=>Math.max(0,Math.floor(Number(t||0))),tG=t=>{const e=String(t??"");return/[,"\n]/.test(e)?`"${e.replace(/"/g,'""')}"`:e},NQe=t=>{const e=[];let r=[],n="",a=!1;for(let s=0;s<t.length;s++){const o=t[s];if(a){o==='"'?t[s+1]==='"'?(n+='"',s++):a=!1:n+=o;continue}if(o==='"'){a=!0;continue}if(o===","){r.push(n),n="";continue}if(o===`
`){r.push(n),n="",r.some(l=>String(l??"").trim()!=="")&&e.push(r),r=[];continue}o!=="\r"&&(n+=o)}return r.push(n),r.some(s=>String(s??"").trim()!=="")&&e.push(r),e},ep=t=>{const e=Number(t||0);return!isFinite(e)||e<0?0:e},Dd=(t,e)=>{const r=ep(e),n=Number(t||0)*(r/100),a=Number(t||0)-n;return{vendorMarginPercent:r,uVendor:n,uInvestor:a}};function CQe({role:t="",sellerCandyId:e="",currentUserEmail:r,roles:n}){const{refreshKey:a,refresh:s}=gc(),o=n&&n.length?n:t,l=!o||sn(o,"admin"),c=sn(o,"vendedor_dulces"),u=(r||"").trim().toLowerCase(),d=!l&&c,[f,A]=x.useState(!0),[h,m]=x.useState(""),[p,g]=x.useState([]),[v,y]=x.useState([]),[b,w]=x.useState({}),[j,I]=x.useState([]),_=x.useRef({});x.useEffect(()=>{const Je={};j.forEach(Ot=>{Je[Ot.id]=Ot}),_.current=Je},[j]);const[S,E]=x.useState(!1),[F,k]=x.useState(null),[P,D]=x.useState(""),[X,pe]=x.useState(""),[ge,fe]=x.useState(""),[xe,ae]=x.useState("0"),[Se,Te]=x.useState([]),[O,G]=x.useState(""),[z,L]=x.useState(""),[Z,ee]=x.useState(!1),[R,H]=x.useState(!1),[ne,ve]=x.useState(!1),U=20,[He,se]=x.useState(1),re=20,[Pe,ue]=x.useState(1),[we,Me]=x.useState({}),[ze,yt]=x.useState(!1),[It,Ke]=x.useState({}),[wt,At]=x.useState({}),[bt,ke]=x.useState(!1),Ne=x.useMemo(()=>p.find(Je=>Je.id===P)||null,[P,p]);Ne==null||Ne.branch,x.useEffect(()=>{!S||!P||!Se.length||Te(Je=>Je.map(Ot=>{const Kt=v.find(Jt=>Jt.id===Ot.productId)||null,ar=p.find(Jt=>Jt.id===P)||null,Ar=ar==null?void 0:ar.branch,ft=Oi(Ot.packages),lr=Kt?pt(Kt,Ar):Number(Ot.pricePerPackage||0),tt=(Kt?me(Kt,Ar):0)*ft,Nt=Kt?Kt.logisticAllocatedPerPack*ft:Number(Ot.logisticAllocated||0),gt=(Kt?te(Kt,Ar):0)*ft,Mt=ie(P),Rt=Dd(tt,Mt);return{...Ot,pricePerPackage:lr,totalExpected:lr*ft,grossProfit:tt,logisticAllocated:Nt,vendorMarginPercent:Rt.vendorMarginPercent,uAproximada:gt,uVendor:Rt.uVendor,uInvestor:Rt.uInvestor,totalRivas:((Kt==null?void 0:Kt.unitPriceRivas)||Ot.unitPriceRivas||0)*ft,totalSanJorge:((Kt==null?void 0:Kt.unitPriceSanJorge)||Ot.unitPriceSanJorge||0)*ft,totalIsla:((Kt==null?void 0:Kt.unitPriceIsla)||Ot.unitPriceIsla||0)*ft,unitPriceRivas:(Kt==null?void 0:Kt.unitPriceRivas)||Ot.unitPriceRivas||0,unitPriceSanJorge:(Kt==null?void 0:Kt.unitPriceSanJorge)||Ot.unitPriceSanJorge||0,unitPriceIsla:(Kt==null?void 0:Kt.unitPriceIsla)||Ot.unitPriceIsla||0}}))},[S,P,Se.length,v,p]);const Ve=x.useMemo(()=>!c||!u?null:p.find(Je=>(Je.email||"").trim().toLowerCase()===u)||null,[c,u,p]);x.useMemo(()=>new Set(Se.map(Je=>Je.productId)),[Se]);const he=x.useMemo(()=>v.filter(Je=>(b[Je.id]??0)>1).sort((Je,Ot)=>`${Je.category} ${Je.name}`.localeCompare(`${Ot.category} ${Ot.name}`)),[v,b]),le=x.useMemo(()=>{const Je=O.trim().toLowerCase();return Je?he.filter(Ot=>`${Ot.category??""} ${Ot.name??""}`.toLowerCase().includes(Je)):he},[he,O]),Be=x.useMemo(()=>v.find(Je=>Je.id===ge)||null,[ge,v]),je=x.useMemo(()=>c&&Ve?j.filter(Je=>Je.sellerId===Ve.id):j,[j,c,Ve]),Ae=async()=>{try{const Je=_t(Fe,"inventory_transfers_candies"),Ot=(tt,Nt,Et,gt)=>{Nt&&(tt[Nt]=tt[Nt]||{out:0,in:0},tt[Nt][Et]+=gt)},Kt=(tt,Nt,Et)=>{const gt=String(Nt||"");gt&&(tt[gt]=(tt[gt]||0)+Et)},ar={},Ar={},ft=_.current,lr=tt=>{var Jt,Lt;if(tt.destRowWasNew!=null)return!!tt.destRowWasNew;const Nt=String(tt.toVendorRowId||"");if(!Nt)return!1;const Et=ft[Nt];if(!Et)return!1;const gt=Number(((Jt=Et.createdAt)==null?void 0:Jt.seconds)??0),ut=Number(((Lt=tt.createdAt)==null?void 0:Lt.seconds)??0),Mt=gt>0&&ut>0&&Math.abs(gt-ut)<=1,Rt=Math.max(0,Number(Et.packages||0))===Math.max(0,Number(tt.packagesMoved||0));return Mt&&Rt},Le=tt=>{const Nt=tt.data(),Et=Number(Nt.packagesMoved||0);Et>0&&(Ot(ar,String(Nt.fromOrderKey||""),"out",Et),Ot(ar,String(Nt.toOrderKey||""),"in",Et),Kt(Ar,Nt.fromVendorRowId,-Et),lr(Nt)||Kt(Ar,Nt.toVendorRowId,Et))};if(!c)(await Qt(Je)).forEach(Le);else{const tt=er(Je,cr("fromSellerId","==",e)),Nt=er(Je,cr("toSellerId","==",e)),[Et,gt]=await Promise.all([Qt(tt),Qt(Nt)]),ut=new Set,Mt=Rt=>{Rt.forEach(Jt=>{ut.has(Jt.id)||(ut.add(Jt.id),Le(Jt))})};Mt(Et.docs),Mt(gt.docs)}Ke(ar),At(Ar)}catch(Je){console.error(Je),Ke({}),At({})}};x.useEffect(()=>{(async()=>{A(!0),m("");try{const Je=await Qt(er(_t(Fe,"sellers_candies"),dn("name","asc"))),Ot=[];Je.forEach(gt=>{const ut=gt.data(),Mt=ut.branch||ut.branchLabel||ut.route||ut.sucursal||ut.location||"";Ot.push({id:gt.id,name:ut.name||"",email:ut.email||"",commissionPercent:Number(ut.commissionPercent||0),branch:eG(Mt),branchLabel:Mt})}),g(Ot);const Kt=await Qt(er(_t(Fe,"candy_main_orders"),dn("createdAt","desc"))),ar={},Ar={},ft=(gt,ut)=>`${gt}#${String(ut).padStart(10,"0")}`;Kt.forEach(gt=>{var Lt;const ut=gt.data(),Mt=Number(((Lt=ut.createdAt)==null?void 0:Lt.seconds)??0),Rt=String(ut.date||""),Jt=Array.isArray(ut.items)?ut.items:[];for(const Wt of Jt){const Tr=String(Wt.id||Wt.productId||"");if(!Tr)continue;const Ur=Oi(Wt.remainingPackages??Wt.remainingPacks??0);Ur>0&&(ar[Tr]=(ar[Tr]||0)+Ur);const on=Math.max(1,Oi(Wt.packages??0)),Nn=Number(Wt.unitPriceRivas||0),la=Number(Wt.unitPriceSanJorge||0),Kn=Number(Wt.unitPriceIsla||0),jn=Number(Wt.gainRivas??Wt.grossProfitRivas??Wt.grossProfit??0),Un=Number(Wt.gainSanJorge??Wt.grossProfitSanJorge??Wt.grossProfit??0),ti=Number(Wt.gainIsla??Wt.grossProfitIsla??Wt.grossProfit??0),Fs=Number(Wt.logisticAllocated??Wt.prorrateo??Wt.prorrateoLogistico??Wt.gastos??0),$r=Number(Wt.uAproximada??Wt.uApprox??Wt.netProfit??Wt.vendorProfit??Wt.gainVendor??0)/on,Cd=Fs/on,xc={id:Tr,name:String(Wt.name||Wt.productName||""),category:String(Wt.category||""),unitsPerPackage:Oi(Wt.unitsPerPackage??0),unitPriceRivas:Nn,unitPriceSanJorge:la,unitPriceIsla:Kn,grossProfitPerPackRivas:jn/on,grossProfitPerPackSanJorge:Un/on,grossProfitPerPackIsla:ti/on,uApproxPerPackRivas:$r,uApproxPerPackSanJorge:$r,uApproxPerPackIsla:$r,logisticAllocatedPerPack:Cd,key:ft(Rt,Mt)},Gl=Ar[Tr];(!Gl||xc.key>Gl.key)&&(Ar[Tr]=xc)}});const lr=await Qt(c?er(_t(Fe,"inventory_candies_sellers"),cr("sellerId","==",e),dn("createdAt","desc")):er(_t(Fe,"inventory_candies_sellers"),dn("createdAt","desc"))),Le={};Object.keys(ar).forEach(gt=>{const ut=Oi(ar[gt]);Le[gt]=Math.max(0,ut)}),w(Le);const tt=Object.keys(Ar).map(gt=>{const ut=Ar[gt];return{id:ut.id,name:ut.name,category:ut.category,unitsPerPackage:ut.unitsPerPackage,unitPriceRivas:ut.unitPriceRivas,unitPriceSanJorge:ut.unitPriceSanJorge,unitPriceIsla:ut.unitPriceIsla,grossProfitPerPackRivas:ut.grossProfitPerPackRivas,grossProfitPerPackSanJorge:ut.grossProfitPerPackSanJorge,grossProfitPerPackIsla:ut.grossProfitPerPackIsla,uApproxPerPackRivas:ut.uApproxPerPackRivas,uApproxPerPackSanJorge:ut.uApproxPerPackSanJorge,uApproxPerPackIsla:ut.uApproxPerPackIsla,logisticAllocatedPerPack:ut.logisticAllocatedPerPack,existingPacks:Le[ut.id]??0}}).sort((gt,ut)=>`${gt.category} ${gt.name}`.localeCompare(`${ut.category} ${ut.name}`));y(tt);const Nt=[];lr.forEach(gt=>{const ut=gt.data(),Mt=Object.prototype.hasOwnProperty.call(ut,"transferDelta"),Rt=Ot.find(Nn=>Nn.id===ut.sellerId)||null,Jt=ep(ut.vendorMarginPercent??ut.vendorMargin??ut.commissionPercent??(Rt==null?void 0:Rt.commissionPercent)??0),Lt=Number(ut.uAproximada??ut.uApprox??ut.netProfit??ut.uAprox??ut.uApproxTotal??0),Wt=ut.uVendor??ut.vendorProfit??ut.gainVendor??0,Tr=ut.uVendor!=null,Ur=Dd(Number(ut.grossProfit??ut.gainVendor??0),Jt),on=Tr?{uAproximada:Number(Lt||0),vendorMarginPercent:Jt,uVendor:Number(Wt||0),uInvestor:Number(Lt||0)-Number(Wt||0)}:{uAproximada:Number(Lt||0),vendorMarginPercent:Ur.vendorMarginPercent,uVendor:Ur.uVendor,uInvestor:Ur.uInvestor};Nt.push({id:gt.id,sellerId:ut.sellerId,sellerName:ut.sellerName||"",productId:ut.productId,productName:ut.productName||"",category:ut.category||"",orderId:ut.orderId||null,packages:Number(ut.packages||0),unitsPerPackage:Number(ut.unitsPerPackage||0),totalUnits:Number(ut.totalUnits||0),remainingPackages:Number(ut.remainingPackages||0),remainingUnits:Number(ut.remainingUnits||0),totalRivas:Number(ut.totalRivas||0),totalSanJorge:Number(ut.totalSanJorge||0),totalIsla:Number(ut.totalIsla||0),unitPriceRivas:Number(ut.unitPriceRivas||0),unitPriceSanJorge:Number(ut.unitPriceSanJorge||0),unitPriceIsla:Number(ut.unitPriceIsla||0),grossProfit:Number(ut.grossProfit??ut.gainVendor??0),logisticAllocated:Number(ut.logisticAllocated??ut.gastos??ut.gasto??0),vendorMarginPercent:on.vendorMarginPercent,uAproximada:on.uAproximada,uVendor:on.uVendor,uInvestor:on.uInvestor,vendorProfit:Number(ut.vendorProfit??on.uVendor??0),transferDelta:Mt&&typeof ut.transferDelta=="number"?Number(ut.transferDelta||0):void 0,subtotal:Number(ut.subtotal||0),providerPrice:Number(ut.providerPrice||0),date:ut.date||"",createdAt:ut.createdAt||dr.now()})});const Et={};Nt.forEach(gt=>{Et[gt.id]=gt}),_.current=Et,I(Nt),await Ae()}catch(Je){console.error(Je),m(" Error cargando datos de vendedores / pedidos.")}finally{A(!1)}})()},[a,t,e]);const Qe=(Je,Ot)=>`${Je}__${Ot}`,Ct=Je=>Je.orderId||Qe(Je.sellerId,Je.date),pt=(Je,Ot)=>Ot?Ot==="RIVAS"?Je.unitPriceRivas||0:Ot==="SAN_JORGE"?Je.unitPriceSanJorge||0:Je.unitPriceIsla||0:Je.unitPriceIsla||Je.unitPriceRivas||Je.unitPriceSanJorge||0,me=(Je,Ot)=>Ot?Ot==="RIVAS"?Je.grossProfitPerPackRivas||0:Ot==="SAN_JORGE"?Je.grossProfitPerPackSanJorge||0:Je.grossProfitPerPackIsla||0:Je.grossProfitPerPackIsla||Je.grossProfitPerPackRivas||Je.grossProfitPerPackSanJorge||0,te=(Je,Ot)=>Ot?Ot==="RIVAS"?Je.uApproxPerPackRivas||0:Ot==="SAN_JORGE"?Je.uApproxPerPackSanJorge||0:Je.uApproxPerPackIsla||0:Je.uApproxPerPackIsla||Je.uApproxPerPackRivas||Je.uApproxPerPackSanJorge||0,ie=Je=>{const Ot=p.find(Kt=>Kt.id===Je)||null;return ep((Ot==null?void 0:Ot.commissionPercent)??0)},$e=Je=>{const Ot=wt[Je.id];return typeof Ot=="number"&&Number.isFinite(Ot)?Ot:typeof Je.transferDelta=="number"?Number(Je.transferDelta||0):0},de=Je=>{const Ot=Math.max(0,Number(Je.packages||0)),Kt=$e(Je);return Math.max(0,Ot+Kt)},Ce=x.useMemo(()=>{const Je=new Map;for(const Kt of je){const ar=Ct(Kt),Ar=Je.get(ar)||{orderKey:ar,sellerId:Kt.sellerId,sellerName:Kt.sellerName,date:Kt.date,totalPackages:0,totalActivePackages:0,totalRemainingPackages:0,totalExpected:0,totalExpectedActive:0,grossProfit:0,grossProfitActive:0,vendorProfit:0,vendorProfitActive:0,gastos:0,gastosActive:0,transferredOut:0,transferredIn:0},ft=Math.max(0,Number(Kt.packages||0)),lr=Math.max(0,Number(Kt.remainingPackages||0)),Le=de(Kt),tt=ft>0?Le/ft:1;Ar.totalPackages+=ft,Ar.totalRemainingPackages+=lr,Ar.totalActivePackages+=Le;const Nt=p.find(Kn=>Kn.id===Kt.sellerId)||null,Et=Nt==null?void 0:Nt.branch,gt=v.find(Kn=>Kn.id===String(Kt.productId))||null,ut=gt?pt(gt,Et):Number(Et==="RIVAS"?Kt.unitPriceRivas||0:Et==="SAN_JORGE"?Kt.unitPriceSanJorge||0:Kt.unitPriceIsla||0),Mt=ut*ft,Rt=ut*Le;Ar.totalExpected+=Number(Mt||0),Ar.totalExpectedActive+=Number(Rt||0);const Jt=gt?me(gt,Et):ft>0?Number(Kt.grossProfit||0)/ft:0,Lt=Jt*ft,Wt=Jt*Le;Ar.grossProfit+=Number(Lt||0),Ar.grossProfitActive+=Number(Wt||0);const Tr=typeof(gt==null?void 0:gt.logisticAllocatedPerPack)=="number"?Number(gt.logisticAllocatedPerPack||0):(()=>{const Kn=Number(Kt.logisticAllocated??Kt.gastos??Kt.gasto??0),jn=ft>0?ft:Le||1;return jn>0?Kn/jn:0})(),Ur=Tr*ft,on=Tr*Le;Ar.gastos=(Ar.gastos||0)+Number(Ur||0),Ar.gastosActive=(Ar.gastosActive||0)+Number(on||0);const Nn=ie(Kt.sellerId),la=Dd(Lt,Nn);Ar.vendorProfit+=Number(la.uVendor||0),Ar.vendorProfitActive+=Number(la.uVendor||0)*tt,Je.set(ar,Ar)}const Ot=[];for(const Kt of Je.values()){const ar=It[Kt.orderKey]||{out:0,in:0};Kt.transferredOut=ar.out||0,Kt.transferredIn=ar.in||0,Number.isFinite(Kt.totalExpectedActive)||(Kt.totalExpectedActive=Kt.totalExpected),Number.isFinite(Kt.grossProfitActive)||(Kt.grossProfitActive=Kt.grossProfit),Number.isFinite(Kt.vendorProfitActive)||(Kt.vendorProfitActive=Kt.vendorProfit),Number.isFinite(Kt.gastosActive||0)||(Kt.gastosActive=Kt.gastos),Ot.push(Kt)}return Ot.sort((Kt,ar)=>(ar.date||"").localeCompare(Kt.date||"")),Ot},[je,p,It,v,wt]),nt=x.useMemo(()=>Math.max(1,Math.ceil(Ce.length/U)),[Ce.length]);x.useEffect(()=>{He>nt&&se(nt)},[nt]);const vt=x.useMemo(()=>{const Je=(He-1)*U;return Ce.slice(Je,Je+U)},[Ce,He]),ht=()=>se(Je=>Math.max(1,Je-1)),xt=()=>se(Je=>Math.min(nt,Je+1)),Xe=x.useMemo(()=>{const Je=z.trim().toLowerCase();return Je?Se.filter(Ot=>{const Kt=String(Ot.productName||"").toLowerCase(),ar=String(Ot.category||"").toLowerCase();return Kt.includes(Je)||ar.includes(Je)}):Se},[Se,z]),be=x.useMemo(()=>Math.max(1,Math.ceil(Xe.length/re)),[Xe.length]);x.useEffect(()=>{Pe>be&&ue(be)},[be]);const st=x.useMemo(()=>{const Je=(Pe-1)*re;return Xe.slice(Je,Je+re)},[Xe,Pe]),K=x.useMemo(()=>{const Je=new Map;for(const Ot of st){const Kt=(Ot.category||"Sin categora").trim()||"Sin categora",ar=Je.get(Kt)||[];ar.push(Ot),Je.set(Kt,ar)}return Array.from(Je.entries())},[st]),Ie=Je=>{Me(Ot=>({...Ot,[Je]:!Ot[Je]}))},Ze=()=>ue(Je=>Math.max(1,Je-1)),at=()=>ue(Je=>Math.min(be,Je+1)),it=Je=>{const Ot=Math.max(0,Number(Je.packages||0)),Kt=Number(Je.transferDelta||0);return Math.max(0,Ot+Kt)},T=Je=>{const Ot=Math.max(0,Number(Je.packages||0)),Kt=it(Je);return Ot===0?Kt>0?1:0:Kt/Ot},M=(Je,Ot)=>Number(Ot||0)*T(Je),V=Je=>Number(Je.logisticAllocated??Je.logisticAllocated??Je.gastos??Je.gasto??0),q=Je=>{const Ot=M(Je,Number(Je.totalExpected||0)),Kt=M(Je,Number(Je.grossProfit||0)),ar=M(Je,V(Je)),Ar=M(Je,Number(Je.uVendor||0)),ft=Kt-ar-Ar;return{totalExpected:Ot,grossProfit:Kt,gastos:ar,uVendor:Ar,uNeta:ft}},Y=x.useMemo(()=>Se.reduce((Je,Ot)=>{const Kt=Math.max(0,Number(Ot.packages||0)),ar=it(Ot),Ar=q(Ot);return Je.totalPackages+=Kt,Je.totalActivePackages+=ar,Je.totalExpected+=Ar.totalExpected,Je.grossProfit+=Ar.grossProfit,Je.gastosTotal+=Ar.gastos,Je.uVendor+=Ar.uVendor,Je},{totalPackages:0,totalActivePackages:0,totalExpected:0,grossProfit:0,gastosTotal:0,uVendor:0}),[Se]),oe=x.useMemo(()=>Y.grossProfit-Y.gastosTotal-Y.uVendor,[Y.grossProfit,Y.gastosTotal,Y.uVendor]),De=()=>{k(null),D(""),pe(""),fe(""),ae("0"),Te([]),G(""),ue(1)},We=()=>{m(""),De(),c&&Ve&&D(Ve.id);const Je=new Date,Ot=Je.getFullYear(),Kt=String(Je.getMonth()+1).padStart(2,"0"),ar=String(Je.getDate()).padStart(2,"0");pe(`${Ot}-${Kt}-${ar}`),E(!0)},dt=()=>{E(!1)},Oe=Je=>{m(""),De(),k(Je);const[Ot,Kt]=Je.split("__");D(Ot||""),pe(Kt||"");const ar=je.filter(Le=>Ct(Le)===Je),Ar=p.find(Le=>Le.id===Ot)||null,ft=Ar==null?void 0:Ar.branch,lr=ar.map(Le=>{const tt=v.find(Nn=>Nn.id===String(Le.productId))||null,Nt=Number(Le.unitPriceRivas||(tt==null?void 0:tt.unitPriceRivas)||0),Et=Number(Le.unitPriceSanJorge||(tt==null?void 0:tt.unitPriceSanJorge)||0),gt=Number(Le.unitPriceIsla||(tt==null?void 0:tt.unitPriceIsla)||0),ut=Number(Le.packages||0),Mt=ft==="RIVAS"?Nt:ft==="SAN_JORGE"?Et:gt,Rt=Number(Le.totalRivas||0),Jt=Number(Le.totalSanJorge||0),Lt=Number(Le.totalIsla||0),Wt=ft==="RIVAS"?Rt:ft==="SAN_JORGE"?Jt:Lt,Tr=ep(Le.vendorMarginPercent??ie(Ot)),Ur=Dd(Number(Le.grossProfit||0),Tr),on=Number(Le.logisticAllocated??Le.gastos??0)||(tt?tt.logisticAllocatedPerPack*ut:0);return{id:Le.id,productId:String(Le.productId||""),productName:Le.productName||(tt==null?void 0:tt.name)||"",category:Le.category||(tt==null?void 0:tt.category)||"",unitsPerPackage:Number(Le.unitsPerPackage||(tt==null?void 0:tt.unitsPerPackage)||0),packages:ut,totalExpected:Wt,pricePerPackage:Mt,grossProfit:Number(Le.grossProfit||0),logisticAllocated:on,vendorMarginPercent:Ur.vendorMarginPercent,uAproximada:Number(Le.uAproximada||0),uVendor:Number(Le.uVendor??Ur.uVendor??0),uInvestor:Number(Le.uInvestor??Ur.uInvestor??0),totalRivas:Rt,totalSanJorge:Jt,totalIsla:Lt,unitPriceRivas:Nt,unitPriceSanJorge:Et,unitPriceIsla:gt,providerPrice:Number(Le.providerPrice||0),remainingPackages:Number(Le.remainingPackages||0),transferDelta:$e(Le)}});Te(lr),E(!0)},et=()=>{if(m(""),!P)return m(" Seleccion un vendedor.");if(!X)return m(" Seleccion una fecha.");if(!ge)return m(" Seleccion un producto.");const Je=Oi(xe);if(Je<=0)return m(" Paquetes debe ser > 0.");const Ot=v.find(Rt=>Rt.id===ge);if(!Ot)return m(" Producto no encontrado.");if(Se.some(Rt=>Rt.productId===Ot.id))return m(" Ese producto ya est agregado al pedido.");const Kt=p.find(Rt=>Rt.id===P)||null,ar=Kt==null?void 0:Kt.branch,Ar=pt(Ot,ar),ft=me(Ot,ar),Le=te(Ot,ar)*Je,tt=Ar*Je,Nt=ft*Je,Et=Ot.logisticAllocatedPerPack*Je,gt=ie(P),ut=Dd(Nt,gt),Mt={id:`tmp_${Date.now()}_${Math.random().toString(16).slice(2)}`,productId:Ot.id,productName:Ot.name,category:Ot.category,unitsPerPackage:Ot.unitsPerPackage,packages:Je,totalExpected:tt,pricePerPackage:Ar,grossProfit:Nt,logisticAllocated:Et,vendorMarginPercent:ut.vendorMarginPercent,uAproximada:Le,uVendor:ut.uVendor,uInvestor:ut.uInvestor,totalRivas:(Ot.unitPriceRivas||0)*Je,totalSanJorge:(Ot.unitPriceSanJorge||0)*Je,totalIsla:(Ot.unitPriceIsla||0)*Je,unitPriceRivas:Ot.unitPriceRivas||0,unitPriceSanJorge:Ot.unitPriceSanJorge||0,unitPriceIsla:Ot.unitPriceIsla||0,remainingPackages:Je,transferDelta:0};Te(Rt=>[Mt,...Rt]),fe(""),ae("0"),ue(1)},mt=Je=>{Te(Ot=>Ot.filter(Kt=>Kt.id!==Je))},Tt=(Je,Ot)=>{const Kt=Math.max(0,Oi(Ot));Te(ar=>ar.map(Ar=>{if(Ar.id!==Je)return Ar;const ft=v.find(Wt=>Wt.id===Ar.productId),lr=p.find(Wt=>Wt.id===P)||null,Le=lr==null?void 0:lr.branch,tt=ft?pt(ft,Le):Ar.pricePerPackage||0,Et=(ft?me(ft,Le):0)*Kt,gt=ft?ft.logisticAllocatedPerPack*Kt:Ar.logisticAllocated||0,Mt=(ft?te(ft,Le):0)*Kt,Rt=Ar.vendorMarginPercent!=null?Ar.vendorMarginPercent:ie(P),Jt=Dd(Et,Rt),Lt=String(Ar.id||"").startsWith("tmp_")||Number(Ar.remainingPackages||0)===Number(Ar.packages||0);return{...Ar,packages:Kt,pricePerPackage:tt,totalExpected:tt*Kt,grossProfit:Et,logisticAllocated:gt,vendorMarginPercent:Jt.vendorMarginPercent,uAproximada:Mt,uVendor:Jt.uVendor,uInvestor:Jt.uInvestor,totalRivas:((ft==null?void 0:ft.unitPriceRivas)||Ar.unitPriceRivas||0)*Kt,totalSanJorge:((ft==null?void 0:ft.unitPriceSanJorge)||Ar.unitPriceSanJorge||0)*Kt,totalIsla:((ft==null?void 0:ft.unitPriceIsla)||Ar.unitPriceIsla||0)*Kt,remainingPackages:Lt?Kt:Ar.remainingPackages}}))},Pt=(Je,Ot)=>{const Kt=ep(Ot);Te(ar=>ar.map(Ar=>{if(Ar.id!==Je)return Ar;const ft=v.find(Mt=>Mt.id===Ar.productId),lr=p.find(Mt=>Mt.id===P)||null,Le=lr==null?void 0:lr.branch,tt=Oi(Ar.packages),Et=(ft?te(ft,Le):0)*tt,gt=Number(Ar.grossProfit||0),ut=Dd(gt,Kt);return{...Ar,vendorMarginPercent:ut.vendorMarginPercent,uAproximada:Et,uVendor:ut.uVendor,uInvestor:ut.uInvestor}}))},Ft=async()=>{if(l&&!R)try{H(!0),m("");const Je=j;if(!Je.length){m(" No hay documentos para actualizar.");return}const Ot=Le=>v.find(tt=>tt.id===Le)||null,Kt=Le=>{const tt=p.find(Nt=>Nt.id===Le)||null;return tt==null?void 0:tt.branch},ar=(Le,tt)=>Math.abs(Number(Le||0)-Number(tt||0))>.01;let Ar=Jd(Fe),ft=0,lr=0;for(const Le of Je){const tt=Kt(Le.sellerId)||"ISLA",Nt=Math.max(1,Number(Le.unitsPerPackage||0)||1),Et=Number(Le.totalUnits||0),gt=Number(Le.remainingUnits||0),Mt=Math.max(0,Et-gt)/Nt,Rt=Number(Le.remainingPackages||0),Jt=Math.max(0,Rt+Mt),Lt=Ot(String(Le.productId||"")),Wt=Lt&&Jt>0?me(Lt,tt)*Jt:Number(Le.grossProfit||0),Tr=Lt&&Jt>0?Lt.logisticAllocatedPerPack*Jt:Number(Le.logisticAllocated||0),Ur=Lt?te(Lt,tt):0,on=Jt>0?Ur*Jt:0,Nn=Le.vendorMarginPercent!=null?ep(Le.vendorMarginPercent):ie(Le.sellerId),la=Dd(Wt,Nn),Kn=la.uVendor,jn=la.uInvestor,Un=Wt-Tr-Kn;if(!(ar(Le.packages,Jt)||Le.uVendor==null||Le.uNeta==null||Le.uAproximada==null||Le.uInvestor==null||Le.logisticAllocated==null||ar(Le.uVendor,Kn)||ar(Le.uNeta,Un)||ar(Le.uAproximada,on)||ar(Le.uInvestor,jn)||ar(Le.logisticAllocated,Tr)))continue;const Fs=Yt(Fe,"inventory_candies_sellers",Le.id);Ar.update(Fs,{packages:Jt,vendorMarginPercent:Nn,grossProfit:Wt,logisticAllocated:Tr,uAproximada:on,uVendor:Kn,uInvestor:jn,uNeta:Un,vendorProfit:Kn,updatedAt:dr.now()}),ft+=1,lr+=1,ft>=400&&(await Ar.commit(),Ar=Jd(Fe),ft=0)}ft>0&&await Ar.commit(),m(` Actualizados ${lr} documentos.`),s()}catch(Je){console.error(Je),m(" Error actualizando documentos.")}finally{H(!1)}},Xt=(Je,Ot,Kt="text/plain;charset=utf-8")=>{const ar=new Blob([Ot],{type:Kt}),Ar=URL.createObjectURL(ar),ft=document.createElement("a");ft.href=Ar,ft.download=Je,document.body.appendChild(ft),ft.click(),ft.remove(),URL.revokeObjectURL(Ar)},mr=()=>{if(!l){m(" Solo admin puede exportar CSV.");return}const Je=["Vendedor","Sucursal","Fecha","Producto ID","Producto","Categora","Paquetes","Paquetes restantes","Precio paquete","Precio proveedor","Total esperado","U. Bruta","U. Vendedor","U. Neta","P. Rivas","P. San Jorge","P. Isla","Total Rivas","Total San Jorge","Total Isla","Unidades x paquete","vendorMarginPercent","uVendor"],Ot=p.find(ft=>ft.id===P)||null,Kt=(Ot==null?void 0:Ot.branch)||eG(Ot==null?void 0:Ot.branchLabel)||"",ar=[Je.join(","),...Se.map(ft=>{const{totalExpected:lr,grossProfit:Le,uVendor:tt,uNeta:Nt}=q(ft);return[(Ot==null?void 0:Ot.name)||"",String(Kt),X||"",ft.productId,ft.productName,ft.category,String(Number(ft.packages||0)),String(Number(ft.remainingPackages||0)),String(Number(ft.pricePerPackage||0).toFixed(2)),String(Number(ft.providerPrice||0).toFixed(2)),String(Number(lr||0).toFixed(2)),String(Number(Le||0).toFixed(2)),String(Number(tt||0).toFixed(2)),String(Number(Nt||0).toFixed(2)),String(Number(ft.unitPriceRivas||0).toFixed(2)),String(Number(ft.unitPriceSanJorge||0).toFixed(2)),String(Number(ft.unitPriceIsla||0).toFixed(2)),String(Number(ft.totalRivas||0).toFixed(2)),String(Number(ft.totalSanJorge||0).toFixed(2)),String(Number(ft.totalIsla||0).toFixed(2)),String(Number(ft.unitsPerPackage||0)),String(Number(ft.vendorMarginPercent||0).toFixed(2)),String(Number(ft.uVendor||0).toFixed(2))].map(tG).join(",")})].join(`
`),Ar=`vendor_order_items_${((Ot==null?void 0:Ot.name)||"vendedor").replace(/\s+/g,"_")}_${X||"sin_fecha"}.csv`;Xt(Ar,ar,"text/csv;charset=utf-8")},Yr=()=>{const Je=["productId","productName","category","Existentes","Paquetes","vendorMarginPercent","uNeta"],Ot=v.map(ar=>({id:ar.id,name:ar.name,category:ar.category,existentes:Number(ar.existingPacks||0)})).filter(ar=>ar.existentes>0).sort((ar,Ar)=>`${ar.category} ${ar.name}`.localeCompare(`${Ar.category} ${Ar.name}`)),Kt=[Je.join(","),...Ot.map(ar=>[ar.id,ar.name,ar.category,String(ar.existentes),"","",""].map(tG).join(","))].join(`
`);Xt("plantilla_productos_orden_maestra.csv",Kt,"text/csv;charset=utf-8")},Br=async Je=>{try{m("");const Ot=await Je.text(),Kt=NQe(Ot);if(!Kt.length)return m(" Archivo vaco.");const ar=Kt[0].map(gt=>String(gt||"").trim().toLowerCase()),Ar=ar.findIndex(gt=>gt==="productid"||gt==="producto id"||gt==="id"),ft=ar.findIndex(gt=>gt==="paquetes"||gt==="packages"),lr=ar.findIndex(gt=>gt==="vendormarginpercent"||gt==="vendor_margin_percent"||gt==="marginvendorpercent"||gt==="margen"||gt==="margen vendedor"||gt==="margen_del_vendedor");if(Ar<0||ft<0)return m(" Plantilla invlida: debe tener columnas productId y Paquetes.");if(!P)return m(" Seleccion un vendedor antes de importar.");if(!X)return m(" Seleccion una fecha antes de importar.");const Le=p.find(gt=>gt.id===P)||null,tt=Le==null?void 0:Le.branch,Nt=ie(P),Et=[];for(let gt=1;gt<Kt.length;gt++){const ut=Kt[gt]||[],Mt=String(ut[Ar]||"").trim();if(!Mt)continue;const Rt=Oi(ut[ft]);if(Rt<=0)continue;const Jt=v.find($l=>$l.id===Mt);if(!Jt)continue;const Lt=lr>=0?ep(ut[lr]):0,Wt=lr>=0&&String(ut[lr]??"").trim()!==""?Lt:Nt,Tr=pt(Jt,tt),Ur=me(Jt,tt),on=Tr*Rt,Nn=Ur*Rt,la=Jt.logisticAllocatedPerPack*Rt,jn=te(Jt,tt)*Rt,Un=Dd(Nn,Wt),ti=Se.find($l=>$l.productId===Mt);if(ti){const $l=lr>=0&&String(ut[lr]??"").trim()!==""?Wt:ti.vendorMarginPercent,$r=Dd(Nn,$l);Te(Cd=>Cd.map(xc=>xc.id===ti.id?{...xc,packages:Rt,pricePerPackage:Tr,totalExpected:on,grossProfit:Nn,logisticAllocated:la,vendorMarginPercent:$r.vendorMarginPercent,uAproximada:jn,uVendor:$r.uVendor,uInvestor:$r.uInvestor,totalRivas:(Jt.unitPriceRivas||0)*Rt,totalSanJorge:(Jt.unitPriceSanJorge||0)*Rt,totalIsla:(Jt.unitPriceIsla||0)*Rt}:xc));continue}const Fs={id:`tmp_${Date.now()}_${Math.random().toString(16).slice(2)}`,productId:Jt.id,productName:Jt.name,category:Jt.category,unitsPerPackage:Jt.unitsPerPackage,packages:Rt,pricePerPackage:Tr,totalExpected:on,grossProfit:Nn,logisticAllocated:la,vendorMarginPercent:Un.vendorMarginPercent,uAproximada:jn,uVendor:Un.uVendor,uInvestor:Un.uInvestor,totalRivas:(Jt.unitPriceRivas||0)*Rt,totalSanJorge:(Jt.unitPriceSanJorge||0)*Rt,totalIsla:(Jt.unitPriceIsla||0)*Rt,unitPriceRivas:Jt.unitPriceRivas||0,unitPriceSanJorge:Jt.unitPriceSanJorge||0,unitPriceIsla:Jt.unitPriceIsla||0,remainingPackages:Rt};Et.push(Fs)}if(!Et.length)return m(" No se encontraron filas con Paquetes > 0.");Te(gt=>[...Et,...gt]),ue(1),m(` Importados ${Et.length} productos desde plantilla.`)}catch(Ot){console.error(Ot),m(" Error importando archivo.")}},Fr=async()=>{try{if(m(""),d)return m(" Solo lectura.");if(!P)return m(" Seleccion un vendedor.");if(!X)return m(" Seleccion una fecha.");if(!Se.length)return m(" Agreg al menos 1 producto.");const Je=p.find(tt=>tt.id===P)||null;if(!Je)return m(" Vendedor invlido.");const Ot=Je.branch,Kt=F?je.filter(tt=>Ct(tt)===F):[],ar=new Map;Kt.forEach(tt=>ar.set(String(tt.productId),tt));for(const tt of Se){const Nt=Oi(tt.packages),Et=F?ar.get(tt.productId):null,gt=Et?Oi(Et.packages):0,ut=Nt-gt;if(ut>0){const Mt=b[tt.productId]??0;if(ut>Mt)return m(` "${tt.productName}" excede existencias de orden maestra. Existentes: ${Mt} (faltan ${ut})`)}}ee(!0);const Ar=dr.now(),ft=Qe(P,X),lr=ie(P);if(F){const tt=new Set(Se.map(gt=>String(gt.id||""))),Nt=Kt.filter(gt=>!tt.has(String(gt.id||""))),Et=[];for(const gt of Nt)await q$(gt.id),Et.push(gt.id);Et.length&&I(gt=>gt.filter(ut=>!Et.includes(ut.id)));for(const gt of Se){const ut=ar.get(gt.productId);if(!ut)continue;const Mt=Oi(gt.packages),Rt=Oi(ut.packages),Jt=Mt-Rt;if(Jt<0){const Lt=Math.abs(Jt),Wt=Oi(ut.remainingPackages);if(Lt>Wt)return m(` No pods bajar "${gt.productName}" en ${Lt} porque solo quedan ${Wt} paquetes restantes.`);await xQe({vendorInventoryId:ut.id,packagesToReturn:Lt})}}}const Le=new Map;for(const tt of Se){const Nt=Oi(tt.packages),Et=F?ar.get(tt.productId):null,gt=Et?Oi(Et.packages):0,ut=Nt-gt;if(ut>0){const{allocations:Mt}=await gQe({productId:tt.productId,packagesToAllocate:ut});Le.set(tt.productId,Mt||[])}}await Ii(Fe,async tt=>{for(const Nt of Se){const Et=Oi(Nt.packages),gt=Oi(Nt.unitsPerPackage),ut=Et*gt,Mt=F?ar.get(Nt.productId):null,Rt=Mt?Oi(Mt.packages):0,Jt=Mt?Oi(Mt.remainingPackages):0,Lt=Et-Rt,Wt=Mt?Math.max(0,Jt+Lt):Et,Tr=Wt*gt,Ur=v.find(Ki=>Ki.id===Nt.productId),on=Ur?pt(Ur,Ot):Number(Nt.pricePerPackage||0),la=(Ur?me(Ur,Ot):0)*Et,Kn=Ur?Ur.logisticAllocatedPerPack*Et:Nt.logisticAllocated||0,Un=(Ur?te(Ur,Ot):0)*Et,ti=Nt.vendorMarginPercent!=null?Nt.vendorMarginPercent:lr,Fs=Dd(la,ti),$l=Number(la||0)-Number(Kn||0)-Number(Fs.uVendor||0),$r=((Ur==null?void 0:Ur.unitPriceRivas)||Nt.unitPriceRivas||0)*Et,Cd=((Ur==null?void 0:Ur.unitPriceSanJorge)||Nt.unitPriceSanJorge||0)*Et,xc=((Ur==null?void 0:Ur.unitPriceIsla)||Nt.unitPriceIsla||0)*Et,Gl={sellerId:Je.id,sellerName:Je.name,sellerEmail:Je.email||"",branch:Je.branch||"",branchLabel:Je.branchLabel||"",productId:Nt.productId,productName:Nt.productName,category:Nt.category,orderId:ft,date:X,createdAt:Ar,packages:Et,unitsPerPackage:gt,totalUnits:ut,remainingPackages:Wt,remainingUnits:Tr,totalRivas:$r,totalSanJorge:Cd,totalIsla:xc,unitPriceRivas:(Ur==null?void 0:Ur.unitPriceRivas)||Nt.unitPriceRivas||0,unitPriceSanJorge:(Ur==null?void 0:Ur.unitPriceSanJorge)||Nt.unitPriceSanJorge||0,unitPriceIsla:(Ur==null?void 0:Ur.unitPriceIsla)||Nt.unitPriceIsla||0,grossProfit:la,logisticAllocated:Kn,vendorMarginPercent:Fs.vendorMarginPercent,uVendor:Fs.uVendor,uNeta:$l,uAproximada:Un,uInvestor:Fs.uInvestor,vendorProfit:Fs.uVendor,transferDelta:Mt?Number(Mt.transferDelta||0):0},Os=Le.get(Nt.productId)||[];if(F)if(String(Nt.id||"").startsWith("tmp_")){const Ki=Yt(_t(Fe,"inventory_candies_sellers"));Gl.masterAllocations=Os,tt.set(Ki,Gl)}else{const Ki=Yt(Fe,"inventory_candies_sellers",Nt.id);Os.length>0&&(Gl.masterAllocations=dee(...Os)),tt.set(Ki,Gl,{merge:!0})}else{const Ki=Yt(_t(Fe,"inventory_candies_sellers"));Gl.masterAllocations=Os,tt.set(Ki,Gl)}}}),m(" Pedido guardado."),E(!1),De(),s()}catch(Je){console.error(Je),m(" Error guardando el pedido.")}finally{ee(!1)}},vn=async Je=>{try{if(m(""),!l)return m(" Solo admin.");ee(!0);const Ot=je.filter(Kt=>Ct(Kt)===Je);for(const Kt of Ot)await q$(Kt.id);m(" Pedido eliminado."),s()}catch(Ot){console.error(Ot),m(" Error eliminando pedido.")}finally{ee(!1)}},Ln=ko.useRef(null),yn=()=>{var Je;if(d)return m(" Solo lectura.");if(!P)return m(" Seleccion un vendedor.");if(!X)return m(" Seleccion una fecha.");(Je=Ln.current)==null||Je.click()},In=async Je=>{var Kt;const Ot=(Kt=Je.target.files)==null?void 0:Kt[0];Je.target.value="",Ot&&await Br(Ot)},Ua=!l;return i.jsxs("div",{className:"p-3 md:p-6",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-2 md:gap-3 mb-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h2",{className:"text-lg md:text-2xl font-semibold",children:"rdenes de Vendedor (Dulces)"}),i.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Pedidos agrupados por vendedor + fecha. U. Bruta viene de la orden maestra. U. Neta = U. Bruta - Gastos - U. Vendedor."})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx(pc,{onClick:s}),l&&i.jsx("button",{onClick:()=>ke(!0),className:"px-3 py-2 rounded bg-amber-600 text-white text-sm hover:bg-amber-700",children:"Traslados"}),!d&&i.jsx("button",{onClick:We,className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",children:"+ Nuevo pedido"})]})]}),h&&!S&&i.jsx("div",{className:"mb-3 p-2 rounded border text-sm bg-white",children:h}),f?i.jsx("div",{className:"p-4 text-sm text-gray-600",children:"Cargando"}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"hidden md:block bg-white border rounded",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-700",children:["Total pedidos: ",i.jsx("b",{children:Ce.length})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[l&&i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:()=>{if(!S){m(" Abr un pedido para exportar productos asociados.");return}mr()},children:"Exportar asociados"}),l&&i.jsx(i.Fragment,{children:i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:Ft,disabled:R,children:R?"Actualizando campos...":"Actualizar campos calculados"})})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-2 border-b",children:"Fecha"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Vendedor"}),i.jsx("th",{className:"text-right p-2 border-b",children:"P. Asociados"}),i.jsx("th",{className:"text-right p-2 border-b",children:"P. Restantes"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"Total esperado"}),i.jsx("th",{className:"text-right p-2 border-b",children:"U. Bruta"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Gastos"}),i.jsx("th",{className:"text-right p-2 border-b",children:"U. Vendedor"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Trasl. Salida"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Trasl. Entrada"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Acciones"})]})}),i.jsxs("tbody",{children:[vt.map(Je=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"p-2 border-b",children:Je.date}),i.jsx("td",{className:"p-2 border-b",children:Je.sellerName}),i.jsx("td",{className:"p-2 border-b text-right",children:Je.totalPackages}),i.jsx("td",{className:"p-2 border-b text-right",children:Je.totalRemainingPackages}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:Vs(Je.totalExpectedActive??Je.totalExpected)}),i.jsx("td",{className:"p-2 border-b text-right",children:Vs(Je.grossProfitActive??Je.grossProfit)}),i.jsx("td",{className:"p-2 border-b text-right",children:Vs((Je.gastosActive??Je.gastos)||0)}),i.jsx("td",{className:"p-2 border-b text-right",children:Vs(Je.vendorProfitActive??Je.vendorProfit)}),i.jsx("td",{className:"p-2 border-b text-right",children:Je.transferredOut}),i.jsx("td",{className:"p-2 border-b text-right",children:Je.transferredIn}),i.jsx("td",{className:"p-2 border-b",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1.5 rounded bg-gray-900 text-white text-xs hover:bg-black",onClick:()=>Oe(Je.orderKey),children:"Ver / Editar"}),l&&i.jsx("button",{className:"px-3 py-1.5 rounded bg-red-600 text-white text-xs hover:bg-red-700",onClick:()=>{confirm("Eliminar este pedido completo?")&&vn(Je.orderKey)},children:"Eliminar"})]})})]},Je.orderKey)),!vt.length&&i.jsx("tr",{children:i.jsx("td",{className:"p-3 text-sm text-gray-600",colSpan:l?11:10,children:"No hay pedidos."})})]})]})}),i.jsxs("div",{className:"p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Pgina ",He," / ",nt]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:ht,disabled:He<=1,children:""}),i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:xt,disabled:He>=nt,children:""})]})]})]}),i.jsxs("div",{className:"md:hidden space-y-2",children:[i.jsxs("div",{className:"bg-white border rounded p-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-700",children:["Total pedidos: ",i.jsx("b",{children:Ce.length})]}),i.jsxs("div",{className:"text-xs text-gray-600",children:[He,"/",nt]})]}),vt.map(Je=>i.jsxs("div",{className:"bg-white border rounded",role:"button",tabIndex:0,onClick:()=>Oe(Je.orderKey),onKeyDown:Ot=>{(Ot.key==="Enter"||Ot.key===" ")&&(Ot.preventDefault(),Oe(Je.orderKey))},children:[i.jsxs("div",{className:"p-2 flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-semibold",children:Je.sellerName}),i.jsx("div",{className:"text-xs text-gray-600",children:Je.date})]}),l&&i.jsx("button",{className:"px-3 py-2 rounded border text-sm text-red-600",onClick:Ot=>{Ot.stopPropagation(),confirm("Eliminar este pedido completo?")&&vn(Je.orderKey)},children:"Eliminar"})]}),i.jsx("div",{className:"px-2 pb-2",children:i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"P. Asociados"}),i.jsx("div",{className:"font-semibold",children:Je.totalPackages})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"P. Restantes"}),i.jsx("div",{className:"font-semibold",children:Je.totalRemainingPackages})]}),l&&i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"Total esperado"}),i.jsx("div",{className:"font-semibold",children:Vs(Je.totalExpectedActive??Je.totalExpected)})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"U. Vendedor"}),i.jsx("div",{className:"font-semibold",children:Vs(Je.vendorProfitActive??Je.vendorProfit)})]})]})})]},Je.orderKey)),!vt.length&&i.jsx("div",{className:"p-3 text-sm text-gray-600 bg-white border rounded",children:"No hay pedidos."}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm",onClick:ht,disabled:He<=1,children:""}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm",onClick:xt,disabled:He>=nt,children:""})]})]})]}),S&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3 md:p-6",children:i.jsxs("div",{className:"bg-white w-full max-w-5xl max-h-[90vh] overflow-y-auto rounded shadow relative",children:[Z&&i.jsx("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-50",children:i.jsx("div",{className:"text-sm font-semibold",children:"Guardando"})}),i.jsxs("div",{className:"p-3 md:p-5 border-b flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-lg font-semibold",children:F?"Editar pedido":"Nuevo pedido"}),i.jsx("div",{className:"text-xs text-gray-600",children:"U. Bruta viene de Orden Maestra. U. Vendedor e Inversionista se calculan aqu. U. Neta = U. Bruta - Gastos - U. Vendedor."})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:dt,children:"Cerrar"}),!d&&i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",onClick:Fr,children:"Guardar"})]})]}),i.jsxs("div",{className:"p-3 md:p-5 space-y-3",children:[i.jsxs("button",{type:"button",className:"md:hidden w-full px-3 py-2 rounded border text-sm flex items-center justify-between",onClick:()=>ve(Je=>!Je),children:[i.jsx("span",{children:"Filtros y KPIs"}),i.jsx("span",{children:ne?"":"+"})]}),i.jsxs("div",{className:`${ne?"block":"hidden"} md:block space-y-3`,children:[i.jsxs("div",{className:"grid md:grid-cols-3 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Vendedor"}),i.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:P,onChange:Je=>D(Je.target.value),disabled:Ua,children:[i.jsx("option",{value:"",children:"-- Seleccionar --"}),p.map(Je=>i.jsxs("option",{value:Je.id,children:[Je.name," ",Je.branch?`(${Je.branch})`:""]},Je.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded p-2 text-sm",value:X,onChange:Je=>pe(Je.target.value)})]}),i.jsxs("div",{className:"flex items-end gap-2",children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:Yr,children:"Plantilla"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:yn,children:"Importar CSV"}),i.jsx("input",{ref:Ln,type:"file",accept:".csv,text/csv",className:"hidden",onChange:In})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-2",children:[i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"P. asociados"}),i.jsx("div",{className:"text-lg font-semibold",children:Y.totalPackages})]}),l&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total esperado"}),i.jsx("div",{className:"text-lg font-semibold",children:Vs(Y.totalExpected)})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"U. Bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:Vs(Y.grossProfit)})]})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"U. Vendedor"}),i.jsx("div",{className:"text-lg font-semibold",children:Vs(Y.uVendor)})]}),l&&i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"U. Neta"}),i.jsx("div",{className:"text-lg font-semibold",children:Vs(oe)})]})]})]}),i.jsxs("div",{className:"border rounded p-3 space-y-2",children:[i.jsxs("button",{type:"button",className:"md:hidden w-full px-3 py-2 rounded border text-sm flex items-center justify-between",onClick:()=>yt(Je=>!Je),children:[i.jsx("span",{children:"Agregar producto"}),i.jsx("span",{children:ze?"":"+"})]}),i.jsxs("div",{className:`${ze?"block":"hidden"} md:block space-y-2`,children:[i.jsx("div",{className:"text-sm font-semibold hidden md:block",children:"Agregar producto"}),i.jsxs("div",{className:"grid md:grid-cols-4 gap-2",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Buscar"}),i.jsx("input",{className:"w-full border rounded p-2 text-sm",value:O,onChange:Je=>G(Je.target.value),placeholder:"Buscar por categora o nombre"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Producto"}),i.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:ge,onChange:Je=>fe(Je.target.value),children:[i.jsx("option",{value:"",children:"-- Seleccionar --"}),le.map(Je=>i.jsxs("option",{value:Je.id,children:[Je.category," - ",Je.name," (exist:"," ",b[Je.id]??0,")"]},Je.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("input",{className:"w-full border rounded p-2 text-sm",value:xe,onChange:Je=>ae(Je.target.value),inputMode:"numeric"})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{className:"w-full px-3 py-2 rounded bg-gray-900 text-white text-sm hover:bg-black",onClick:et,disabled:!Be,children:"Agregar"})})]})]})]}),i.jsxs("div",{className:"border rounded",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm font-semibold",children:["Productos asociados (",Se.length,")"]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"border rounded px-2 py-1 text-sm",placeholder:"Buscar producto",value:z,onChange:Je=>{L(Je.target.value),ue(1)}}),l&&i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:mr,disabled:!Se.length,children:"Exportar CSV"})]})]}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1400px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-2 border-b",children:"Categora"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Producto"}),i.jsxs("th",{className:"text-right p-2 border-b",children:["P. Asociados"," "]}),i.jsx("th",{className:"text-right p-2 border-b",children:"P. Restantes"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"Precio prov."}),i.jsx("th",{className:"text-right p-2 border-b",children:"Precio/paq"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Total esperado"}),l&&i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"text-right p-2 border-b",children:"U. Bruta"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Gastos"}),i.jsx("th",{className:"text-right p-2 border-b",children:"U. Neta"})]}),i.jsx("th",{className:"text-right p-2 border-b",children:"U. Vendedor"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Margen (%)"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Acciones"})]})}),i.jsxs("tbody",{children:[st.map(Je=>{const{totalExpected:Ot,grossProfit:Kt,gastos:ar,uVendor:Ar,uNeta:ft}=q(Je);return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"p-2 border-b",children:Je.category}),i.jsx("td",{className:"p-2 border-b",children:Je.productName}),i.jsx("td",{className:"p-2 border-b text-right",children:d?i.jsx("span",{children:Je.packages}):i.jsx("input",{className:"w-20 border rounded p-1 text-right",value:String(Je.packages),onChange:lr=>Tt(Je.id,lr.target.value),inputMode:"numeric"})}),i.jsx("td",{className:"p-2 border-b text-right",children:Je.remainingPackages}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:Vs(Je.providerPrice||0)}),i.jsx("td",{className:"p-2 border-b text-right",children:Vs(Je.pricePerPackage)}),i.jsx("td",{className:"p-2 border-b text-right",children:Vs(Ot)}),l&&i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"p-2 border-b text-right",children:Vs(Kt)}),i.jsx("td",{className:"p-2 border-b text-right",children:Vs(ar)}),i.jsx("td",{className:"p-2 border-b text-right",children:Vs(ft)})]}),i.jsx("td",{className:"p-2 border-b text-right",children:Vs(Ar)}),i.jsx("td",{className:"p-2 border-b text-right",children:d?i.jsxs("span",{children:[Number(Je.vendorMarginPercent??ie(P)).toFixed(2),"%"]}):i.jsx("input",{type:"number",step:"0.01",min:0,className:"w-20 border rounded p-1 text-right",value:String(Je.vendorMarginPercent??ie(P)),onChange:lr=>Pt(Je.id,lr.target.value),inputMode:"decimal"})}),i.jsx("td",{className:"p-2 border-b",children:!d&&i.jsx("button",{className:"px-3 py-1.5 rounded bg-red-600 text-white text-xs hover:bg-red-700",onClick:()=>mt(Je.id),children:"Quitar"})})]},Je.id)}),!st.length&&i.jsx("tr",{children:i.jsx("td",{className:"p-3 text-sm text-gray-600",colSpan:l?13:9,children:"No hay productos asociados."})})]})]})}),i.jsxs("div",{className:"md:hidden p-3 space-y-2",children:[K.map(([Je,Ot])=>{const Kt=!!we[Je];return i.jsxs("div",{className:"border rounded",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-2 flex items-center justify-between text-sm",onClick:()=>Ie(Je),children:[i.jsx("span",{className:"font-semibold",children:Je}),i.jsxs("span",{className:"text-xs text-gray-600",children:[Ot.length," ",Ot.length===1?"producto":"productos"]})]}),Kt&&i.jsx("div",{className:"px-3 pb-3 space-y-2",children:Ot.map(ar=>{const{totalExpected:Ar,grossProfit:ft,gastos:lr,uVendor:Le,uNeta:tt}=q(ar);return i.jsxs("div",{className:"border rounded p-2 text-xs space-y-2",children:[i.jsx("div",{className:"font-semibold text-sm",children:ar.productName}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes"}),d?i.jsx("div",{className:"font-semibold",children:ar.packages}):i.jsx("input",{className:"w-full border rounded p-1 text-right",value:String(ar.packages),onChange:Nt=>Tt(ar.id,Nt.target.value),inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Restantes"}),i.jsx("div",{className:"font-semibold",children:ar.remainingPackages})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Precio/paq"}),i.jsx("div",{className:"font-semibold",children:Vs(ar.pricePerPackage)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Total esperado"}),i.jsx("div",{className:"font-semibold",children:Vs(Ar)})]}),l&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta"}),i.jsx("div",{className:"font-semibold",children:Vs(ft)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Gastos"}),i.jsx("div",{className:"font-semibold",children:Vs(lr)})]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"U. Vendedor"}),i.jsx("div",{className:"font-semibold",children:Vs(Le)})]}),l&&i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"U. Neta"}),i.jsx("div",{className:"font-semibold",children:Vs(tt)})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"text-gray-600",children:"Margen (%)"}),d?i.jsxs("div",{className:"font-semibold",children:[Number(ar.vendorMarginPercent??ie(P)).toFixed(2),"%"]}):i.jsx("input",{type:"number",step:"0.01",min:0,className:"w-full border rounded p-1 text-right",value:String(ar.vendorMarginPercent??ie(P)),onChange:Nt=>Pt(ar.id,Nt.target.value),inputMode:"decimal"})]}),!d&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white text-xs",onClick:()=>mt(ar.id),children:"Quitar"})]})]},ar.id)})})]},Je)}),!st.length&&i.jsx("div",{className:"p-3 text-sm text-gray-600 text-center",children:"No hay productos asociados."})]}),i.jsxs("div",{className:"p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Pgina items ",Pe," / ",be]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:Ze,disabled:Pe<=1,children:""}),i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:at,disabled:Pe>=be,children:""})]})]})]}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-center md:justify-between",children:[i.jsx("div",{className:"text-xs text-gray-600",children:F?i.jsxs(i.Fragment,{children:["Editando: ",i.jsx("b",{children:F})]}):i.jsx(i.Fragment,{children:"Nuevo pedido (an no guardado)"})}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:dt,children:"Cancelar"}),!d&&i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",onClick:Fr,children:"Guardar pedido"})]})]}),h&&i.jsx("div",{className:"text-sm text-gray-700",children:h})]})]})}),i.jsx(wQe,{open:bt,onClose:()=>ke(!1),orders:Ce,rows:j,setRows:I,isAdmin:l,currentUserEmail:r||"",currentUserName:"",sellerCandyId:e,sellers:p,products:v,transferAgg:It,setTransferAgg:Ke,setTransferRowDeltas:At})]})}const Vn=t=>Math.max(0,Math.floor(Number(t)||0)),Bb=t=>Math.round(t||0);function yse(t){const e=Math.max(1,Vn(t.unitsPerPackage||1)),r=Vn(t.totalUnits||0),n=Vn(t.quantity||0),a=Vn(t.packages||0);return r>0?r:n>0?n:a>0?a*e:0}function _Qe(t){const e=Number(t.remaining);return Number.isFinite(e)&&e>0?Math.floor(e):yse(t)}function rG(t){const e=Number(t.remainingPackages);if(Number.isFinite(e))return Math.max(0,Math.floor(e));const r=Math.max(1,Vn(t.unitsPerPackage||1)),n=_Qe(t);return Math.max(0,Math.floor(n/r))}function EQe(t){const e=Math.max(1,Vn(t.unitsPerPackage||1)),r=yse(t);return Math.max(0,Math.floor(r/e))}function Tb(t){return String(t??"").trim().toLowerCase().replace(/\s+/g," ")}function Cf(t){const e=String(t??"").trim();if(!e)return 0;const r=e.replace(/,/g,"."),n=Number(r);return Number.isFinite(n)?n:0}function vh(t,e){const r={};Object.keys(t||{}).forEach(n=>r[Tb(n)]=t[n]);for(const n of e){const a=r[Tb(n)];if(a!=null&&String(a).trim()!=="")return a}}function $m(t,e,r){const n=t*e,a=Math.min(Math.max(r.marginR,0),99.9)/100,s=Math.min(Math.max(r.marginSJ,0),99.9)/100,o=Math.min(Math.max(r.marginIsla,0),99.9)/100,l=e>0&&a<1?n/(1-a):n,c=e>0&&s<1?n/(1-s):n,u=e>0&&o<1?n/(1-o):n,d=l-n,f=c-n,A=u-n,h=e>0?Bb(l/e):0,m=e>0?Bb(c/e):0,p=e>0?Bb(u/e):0;return{subtotal:n,totalRivas:l,totalSanJorge:c,totalIsla:u,gainRivas:d,gainSanJorge:f,gainIsla:A,unitPriceRivas:h,unitPriceSanJorge:m,unitPriceIsla:p}}function SQe(t){return Number(t.gainRivas||0)}function IQe(t){return Number(t.gainIsla||0)}function $5(t,e,r){const n=SQe(t),a=IQe(t),s=Number(t.subtotal||0),o=e>0&&r>0?e*s/r:0;return{...t,grossProfit:n,grossProfitIsla:a,logisticAllocated:o}}function jQe(){const{refreshKey:t,refresh:e}=gc(),[r,n]=x.useState(""),[a,s]=x.useState(!0),[o,l]=x.useState(!1),[c,u]=x.useState(!1),[d,f]=x.useState([]),[A,h]=x.useState(!1),[m,p]=x.useState([]),[g,v]=x.useState({}),[y,b]=x.useState(!1),[w,j]=x.useState(null),[I,_]=x.useState(""),[S,E]=x.useState(""),[F,k]=x.useState("20"),[P,D]=x.useState("15"),[X,pe]=x.useState("30"),[ge,fe]=x.useState("0"),[xe,ae]=x.useState([]),[Se,Te]=x.useState(""),[O,G]=x.useState(""),[z,L]=x.useState(""),[Z,ee]=x.useState("1"),[R,H]=x.useState("0"),[ne,ve]=x.useState("DATOS"),[U,He]=x.useState(""),[se,re]=x.useState(1),Pe=15,ue=x.useMemo(()=>Math.max(1,Math.ceil(m.length/Pe)),[m.length]);x.useEffect(()=>re(1),[m.length]);const we=x.useMemo(()=>{const K=(se-1)*Pe;return m.slice(K,K+Pe)},[m,se]),Me=x.useMemo(()=>{const K=new Set;for(const Ie of d){const Ze=String(Ie.category||"").trim();Ze&&K.add(Ze)}return Array.from(K).sort((Ie,Ze)=>Ie.localeCompare(Ze,"es"))},[d]);x.useEffect(()=>{!Se&&Me.length>0&&Te(Me[0])},[Me]);const ze=async()=>{h(!0);try{const K=await Qt(er(_t(Fe,"products_candies"),dn("createdAt","desc"))),Ie=[];K.forEach(Ze=>{const at=Ze.data();Ie.push({id:Ze.id,name:String(at.name??"").trim(),category:String(at.category??"").trim()||"Caramelo",providerPrice:Number(at.providerPrice??0),unitsPerPackage:Number(at.unitsPerPackage??1)})}),f(Ie)}catch(K){console.error(K),n(" Error cargando catlogo de dulces.")}finally{h(!1)}};x.useEffect(()=>{ze()},[t]);const yt=x.useMemo(()=>(Se.trim().length>0?d.filter(Ie=>Ie.category===Se):d).sort((Ie,Ze)=>Ie.name.localeCompare(Ze.name,"es")),[d,Se]);x.useEffect(()=>{if(!O){L(""),ee("1");return}const K=d.find(Ie=>Ie.id===O);K&&(L(String(K.providerPrice??0)),ee(String(K.unitsPerPackage??1)))},[O,d]);const It=()=>{j(null),_(""),E(""),ae([]),Te(Me[0]||""),G(""),L(""),H("0"),ee("1"),k("20"),D("15"),pe("30"),fe("0"),ve("DATOS"),He("")},Ke=()=>{if(n(""),!O){n("Selecciona un producto del catlogo.");return}const K=d.find(Y=>Y.id===O);if(!K){n("Producto de catlogo no encontrado (refresca).");return}const Ie=Number(K.providerPrice||0),Ze=Vn(R||0),at=Vn(K.unitsPerPackage||0);if(Ie<0){n("El precio proveedor no puede ser negativo.");return}if(Ze<=0){n("Los paquetes deben ser mayor que 0.");return}if(at<=0){n("Las unidades por paquete deben ser mayor que 0.");return}const it=Number(F||0),T=Number(P||0),M=Number(X||0),V=$m(Ie,Ze,{marginR:it,marginSJ:T,marginIsla:M});if(xe.find(Y=>Y.id===K.id))ae(Y=>Y.map(oe=>{if(oe.id!==K.id)return oe;const De=Vn(oe.packages||0)+Ze,We=$m(Ie,De,{marginR:Number(oe.marginRivas??it),marginSJ:Number(oe.marginSanJorge??T),marginIsla:Number(oe.marginIsla??M)}),Oe=Vn(oe.remainingPackages??oe.packages)+Ze;return{...oe,providerPrice:Ie,unitsPerPackage:at,packages:De,remainingPackages:Oe,...We}}));else{const Y={id:K.id,name:K.name,category:K.category,providerPrice:Ie,packages:Ze,unitsPerPackage:at,marginRivas:it,marginSanJorge:T,marginIsla:M,subtotal:V.subtotal,totalRivas:V.totalRivas,totalSanJorge:V.totalSanJorge,totalIsla:V.totalIsla,gainRivas:V.gainRivas,gainSanJorge:V.gainSanJorge,gainIsla:V.gainIsla,unitPriceRivas:V.unitPriceRivas,unitPriceSanJorge:V.unitPriceSanJorge,unitPriceIsla:V.unitPriceIsla,remainingPackages:Ze};ae(oe=>[...oe,Y])}G(""),H("0"),ve("ITEMS")},wt=K=>{ae(Ie=>Ie.filter(Ze=>Ze.id!==K))},At=(K,Ie,Ze)=>{ae(at=>at.map(it=>{if(it.id!==K)return it;let T={...it};if(Ie==="packages"&&(T.packages=Vn(Ze||0)),Ie==="unitsPerPackage"&&(T.unitsPerPackage=Vn(Ze||0)),Ie==="marginRivas"&&(T.marginRivas=Number(Ze||0)),Ie==="marginIsla"&&(T.marginIsla=Number(Ze||0)),Ie==="marginSanJorge"&&(T.marginSanJorge=Number(Ze||0)),Ie==="packages"||Ie==="marginRivas"||Ie==="marginIsla"||Ie==="marginSanJorge"){const M=$m(T.providerPrice,T.packages,{marginR:Number(T.marginRivas||0),marginSJ:Number(T.marginSanJorge||0),marginIsla:Number(T.marginIsla||0)});T={...T,...M}}return(T.remainingPackages===void 0||T.remainingPackages===null)&&(T.remainingPackages=T.packages),T}))},bt=x.useMemo(()=>{const K=xe.reduce((T,M)=>T+Vn(M.packages),0),Ie=xe.reduce((T,M)=>T+Number(M.subtotal||0),0),Ze=xe.reduce((T,M)=>T+Number(M.totalRivas||0),0),at=xe.reduce((T,M)=>T+Number(M.totalSanJorge||0),0),it=xe.reduce((T,M)=>T+Number(M.totalIsla||0),0);return{totalPackages:K,subtotal:Ie,totalRivas:Ze,totalSanJorge:at,totalIsla:it}},[xe]),ke=x.useMemo(()=>{const K=Math.max(0,Cf(ge||0)),Ie=Number(bt.subtotal||0),Ze=xe.map(M=>$5(M,K,Ie)),at=Ze.reduce((M,V)=>M+Number(V.grossProfit||0),0),it=Ze.reduce((M,V)=>M+Number(V.grossProfitIsla||0),0),T=Ze.reduce((M,V)=>M+Number(V.logisticAllocated||0),0);return{items:Ze,logisticsTotal:K,grossTotal:at,grossIslaTotal:it,logisticAllocatedTotal:T}},[xe,ge,bt.subtotal]),Ne=x.useMemo(()=>{const K=String(U||"").trim().toLowerCase();return K?ke.items.filter(Ie=>{const Ze=String(Ie.name||"").toLowerCase(),at=String(Ie.category||"").toLowerCase();return Ze.includes(K)||at.includes(K)}):ke.items},[ke.items,U]),[Ve,he]=x.useState(1),le=15,Be=x.useMemo(()=>Math.max(1,Math.ceil(Ne.length/le)),[Ne.length]);x.useEffect(()=>he(1),[Ne.length]);const je=x.useMemo(()=>{const K=(Ve-1)*le;return Ne.slice(K,K+le)},[Ne,Ve]),[Ae,Qe]=x.useState({});x.useEffect(()=>Qe({}),[Ne.length]);const[Ct,pt]=x.useState({});x.useEffect(()=>{const K={};for(const Ie of m)Ie&&Ie.id&&(K[Ie.id]=!1);pt(K)},[m]);const me=x.useMemo(()=>({totalPackages:bt.totalPackages,subtotalCosto:bt.subtotal,esperadoRivas:bt.totalRivas,esperadoIsla:bt.totalIsla,gastosLogisticos:ke.logisticsTotal,utilidadBrutaRivas:ke.grossTotal,utilidadBrutaIsla:ke.grossIslaTotal}),[bt,ke]),te=()=>{if(n(""),!d.length){n(" No hay catlogo cargado para generar plantilla.");return}const K=Number(F||0),Ie=Number(X||0),Ze=d.slice().sort((q,Y)=>q.name.localeCompare(Y.name,"es")).map(q=>({Producto:q.name,Paquetes:"","Margen rivas":K,"Margen Isla":Ie,"P. unidad Rivas":"","P. unidad Isla":""})),at=[{Campo:"Gastos logisticos",Valor:Cf(ge||0)}],it=$s.book_new(),T=$s.json_to_sheet(Ze),M=$s.json_to_sheet(at);$s.book_append_sheet(it,T,"Productos"),$s.book_append_sheet(it,M,"Config");const V=S&&String(S).trim()||new Date().toISOString().slice(0,10);rF(it,`plantilla_orden_maestra_${V}.xlsx`)},ie=()=>{if(n(""),!ke.items.length){n(" No hay items para exportar.");return}const K=ke.items.slice().sort((T,M)=>T.name.localeCompare(M.name,"es")).map(T=>({Categora:T.category,Producto:T.name,Paquetes:Vn(T.packages),"Paquetes restantes":Vn(T.remainingPackages??T.packages),"Und x Paquete":Vn(T.unitsPerPackage),"Precio proveedor":Number(T.providerPrice||0),Facturado:Number(T.subtotal||0),"Esperado Rivas":Number(T.totalRivas||0),"Esperado Isla":Number(T.totalIsla||0),"MV Rivas":Number(T.marginRivas||0),"MV Isla":Number(T.marginIsla||0),"Utilidad Bruta":Number(T.grossProfit||0),"Utilidad Bruta Isla":Number(T.grossProfitIsla||0),"Prorrateo logistico":Number(T.logisticAllocated||0),"Precio Rivas":Number(T.unitPriceRivas||0),"Precio Isla":Number(T.unitPriceIsla||0)})),Ie=[{KPI:"Paquetes totales",Valor:me.totalPackages},{KPI:"Subtotal costo",Valor:me.subtotalCosto},{KPI:"Esperado Rivas",Valor:me.esperadoRivas},{KPI:"Esperado Isla",Valor:me.esperadoIsla},{KPI:"Gastos logsticos",Valor:me.gastosLogisticos},{KPI:"Utilidad Bruta Rivas",Valor:me.utilidadBrutaRivas},{KPI:"Utilidad Bruta Isla",Valor:me.utilidadBrutaIsla}],Ze=$s.book_new();$s.book_append_sheet(Ze,$s.json_to_sheet(K),"Productos"),$s.book_append_sheet(Ze,$s.json_to_sheet(Ie),"Resumen");const at=S&&String(S).trim()||new Date().toISOString().slice(0,10),it=I&&String(I).trim()||`Orden_${at}`;rF(Ze,`orden_maestra_${it.replace(/[^\w\-]+/g,"_")}_${at}.xlsx`)},$e=x.useRef(null),[de,Ce]=x.useState(!1),nt=()=>{var K;if(!d.length){n(" Catlogo no cargado todava. Esper y prob de nuevo.");return}(K=$e.current)==null||K.click()},vt=async K=>{var Ze;const Ie=(Ze=K.target.files)==null?void 0:Ze[0];if(Ie){K.target.value="",Ce(!0),n("");try{const at=await Ie.arrayBuffer(),it=O2(at,{type:"array"}),T=it.SheetNames||[],M=it.Sheets.Productos||it.Sheets.Plantilla||it.Sheets[T[0]];if(!M){n(" No se encontr hoja de Productos/Plantilla.");return}const V=$s.sheet_to_json(M,{defval:""});if(!V.length){n(" El Excel viene vaco.");return}let q=0;const Y=it.Sheets.Config;if(Y){const Oe=$s.sheet_to_json(Y,{defval:""}),et=new Map;for(const mt of Oe){const Tt=Tb(vh(mt,["Campo","Key","Nombre"])??""),Pt=vh(mt,["Valor","Value"]);Tt&&et.set(Tt,Pt)}et.has("gastos logisticos")&&(q=Math.max(0,Cf(et.get("gastos logisticos"))))}else for(const Oe of V){const et=vh(Oe,["Gastos","Gasto","Gastos logisticos","Logistica"]),mt=Cf(et);if(mt>0){q=mt;break}}fe(String(q||0));const oe=new Map;for(const Oe of d)oe.set(Tb(Oe.name),Oe);const De=[],We=new Map;for(let Oe=0;Oe<V.length;Oe++){const et=V[Oe],mt=vh(et,["Producto","Product","Nombre","Name"]),Tt=vh(et,["Paquetes","Packages"]),Pt=vh(et,["Margen rivas","Margen Rivas","MV Rivas"]),Ft=vh(et,["Margen Isla","Margen isla","MV Isla"]),Xt=vh(et,["P. unidad Rivas","P unidad Rivas","Precio Rivas"]),mr=vh(et,["P. unidad Isla","P unidad Isla","Precio Isla"]),Yr=Tb(mt);if(!Yr)continue;const Br=oe.get(Yr);if(!Br){De.push(`Fila ${Oe+2}: Producto no existe en catlogo: "${String(mt).trim()}".`);continue}const Fr=Math.floor(Cf(Tt));if(Fr<=0){De.push(`Fila ${Oe+2}: "Paquetes" invlido para "${Br.name}".`);continue}const vn=String(Pt??"").trim()!==""?Cf(Pt):Number(F||0),Ln=String(Ft??"").trim()!==""?Cf(Ft):Number(X||0),yn=Math.floor(Cf(Xt)),In=Math.floor(Cf(mr)),Ua=We.get(Br.id);Ua?We.set(Br.id,{packages:Ua.packages+Fr,mR:vn,mI:Ln,puR:yn>0?yn:Ua.puR,puI:In>0?In:Ua.puI}):We.set(Br.id,{packages:Fr,mR:vn,mI:Ln,puR:yn>0?yn:void 0,puI:In>0?In:void 0})}const dt=[];We.forEach((Oe,et)=>{const mt=d.find(In=>In.id===et);if(!mt)return;const Tt=Number(mt.providerPrice||0),Pt=Math.max(1,Vn(mt.unitsPerPackage||1)),Ft=Math.max(1,Vn(Oe.packages)),Xt=Tt*Ft,mr=Number(Oe.puR||0),Yr=Number(Oe.puI||0),Br=mr>0||Yr>0;let Fr=Oe.mR,vn=Oe.mI;const Ln=Number(P||0);let yn;if(Br){const In=$m(Tt,Ft,{marginR:Fr,marginSJ:Ln,marginIsla:vn}),Ua=mr>0?mr*Ft:In.totalRivas,Je=Yr>0?Yr*Ft:In.totalIsla,Ot=Kt=>{if(!Number.isFinite(Kt)||Kt<=0)return 0;const ar=(1-Xt/Kt)*100;return Math.min(Math.max(ar,0),99.9)};mr>0&&(Fr=Ot(Ua)),Yr>0&&(vn=Ot(Je)),yn={subtotal:Xt,totalRivas:Ua,totalSanJorge:In.totalSanJorge,totalIsla:Je,gainRivas:Ua-Xt,gainSanJorge:In.gainSanJorge,gainIsla:Je-Xt,unitPriceRivas:Ft>0?Bb(Ua/Ft):0,unitPriceSanJorge:In.unitPriceSanJorge,unitPriceIsla:Ft>0?Bb(Je/Ft):0}}else yn=$m(Tt,Ft,{marginR:Fr,marginSJ:Ln,marginIsla:vn});dt.push({id:mt.id,name:mt.name,category:mt.category,providerPrice:Tt,packages:Ft,unitsPerPackage:Pt,marginRivas:Fr,marginSanJorge:Ln,marginIsla:vn,subtotal:yn.subtotal,totalRivas:yn.totalRivas,totalSanJorge:yn.totalSanJorge,totalIsla:yn.totalIsla,gainRivas:yn.gainRivas,gainSanJorge:yn.gainSanJorge,gainIsla:yn.gainIsla,unitPriceRivas:yn.unitPriceRivas,unitPriceSanJorge:yn.unitPriceSanJorge,unitPriceIsla:yn.unitPriceIsla,remainingPackages:Ft})}),ae(Oe=>{const et=new Map;Oe.forEach(mt=>et.set(mt.id,mt));for(const mt of dt){const Tt=et.get(mt.id);if(!Tt)et.set(mt.id,mt);else{const Pt=Vn(Tt.packages)+Vn(mt.packages),Ft=$m(Tt.providerPrice,Pt,{marginR:mt.marginRivas,marginSJ:Number(Tt.marginSanJorge||0),marginIsla:mt.marginIsla});et.set(mt.id,{...Tt,packages:Pt,marginRivas:mt.marginRivas,marginIsla:mt.marginIsla,remainingPackages:Vn(Tt.remainingPackages??Tt.packages)+Vn(mt.packages),...Ft})}}return Array.from(et.values()).sort((mt,Tt)=>mt.name.localeCompare(Tt.name,"es"))}),ve("ITEMS"),De.length?(n(` Importado con detalles. Errores: ${De.length}.`),console.warn("Errores import:",De)):n(` Importacin lista: ${dt.length} productos agregados.`)}catch(at){console.error(at),n(" Error importando Excel. Revis hojas: Productos + Config (o Plantilla).")}finally{Ce(!1)}}};x.useEffect(()=>{(async()=>{s(!0);try{const K=er(_t(Fe,"candy_main_orders"),dn("createdAt","desc")),Ie=await Qt(K),Ze=[];Ie.forEach(T=>{const M=T.data();Ze.push({id:T.id,name:M.name??"",date:M.date??"",totalPackages:Number(M.totalPackages??0),subtotal:Number(M.subtotal??0),totalRivas:Number(M.totalRivas??0),totalSanJorge:Number(M.totalSanJorge??0),totalIsla:Number(M.totalIsla??0),marginRivas:Number(M.marginRivas??20),marginSanJorge:Number(M.marginSanJorge??15),marginIsla:Number(M.marginIsla??30),logisticsCost:Number(M.logisticsCost??0),createdAt:M.createdAt??dr.now()})}),p(Ze);const at=await Qt(_t(Fe,"inventory_candies")),it={};at.forEach(T=>{const M=T.data(),V=M.orderId;if(!V)return;const q=EQe(M),Y=rG(M);it[V]||(it[V]={orderId:V,totalPackages:0,remainingPackages:0}),it[V].totalPackages+=q,it[V].remainingPackages+=Y}),v(it)}catch(K){console.error(K),n(" Error cargando pedidos generales.")}finally{s(!1)}})()},[t]);const ht=K=>{var Ie;return K.date?K.date:(Ie=K.createdAt)!=null&&Ie.toDate?K.createdAt.toDate().toISOString().slice(0,10):""},xt=async K=>{if(K.preventDefault(),n(""),l(!0),!xe.length){n("Agrega al menos un producto a la orden.");return}try{const Ie=new Date().toISOString().slice(0,10),Ze=S||Ie,at=Number(F||0),it=Number(P||0),T=Number(X||0),M=Math.max(0,Cf(ge||0));for(const Oe of xe){if(!String(Oe.name||"").trim()){n("Hay un producto sin nombre en el pedido.");return}if(Number(Oe.providerPrice||0)<0){n(`El precio proveedor no puede ser negativo (producto: ${Oe.name}).`);return}if(Vn(Oe.packages)<=0){n(`Los paquetes deben ser mayor que 0 (producto: ${Oe.name}).`);return}if(Vn(Oe.unitsPerPackage)<=0){n(`Las unidades por paquete deben ser mayor que 0 (producto: ${Oe.name}).`);return}}const V=Number(bt.subtotal||0),q=xe.map(Oe=>$5(Oe,M,V)),Y={totalPackages:bt.totalPackages,subtotal:bt.subtotal,totalRivas:bt.totalRivas,totalSanJorge:bt.totalSanJorge,totalIsla:bt.totalIsla},oe={name:I||`Pedido ${Ze}`,date:Ze,totalPackages:Y.totalPackages,subtotal:Y.subtotal,totalRivas:Y.totalRivas,totalSanJorge:Y.totalSanJorge,totalIsla:Y.totalIsla,marginRivas:at,marginSanJorge:it,marginIsla:T,logisticsCost:M,uBrutaGlobal:ke.grossTotal,items:q};if(w){await pn(Yt(Fe,"candy_main_orders",w),{...oe});for(const mt of q){const Tt=await Qt(er(_t(Fe,"inventory_candies"),cr("orderId","==",w),cr("productId","==",mt.id))),Pt=Math.max(1,Vn(mt.unitsPerPackage||1)),Ft=Vn(mt.packages)*Pt;if(Tt.empty)await On(_t(Fe,"inventory_candies"),{productId:mt.id,productName:mt.name,category:mt.category,measurement:"unidad",quantity:Ft,remaining:Ft,packages:Vn(mt.packages),remainingPackages:Vn(mt.packages),unitsPerPackage:Pt,totalUnits:Ft,providerPrice:mt.providerPrice,subtotal:mt.subtotal,totalRivas:mt.totalRivas,totalSanJorge:mt.totalSanJorge,totalIsla:mt.totalIsla,gainRivas:mt.gainRivas,gainSanJorge:mt.gainSanJorge,gainIsla:mt.gainIsla,unitPriceRivas:mt.unitPriceRivas,unitPriceSanJorge:mt.unitPriceSanJorge,unitPriceIsla:mt.unitPriceIsla,date:Ze,createdAt:dr.now(),status:"PENDIENTE",orderId:w});else for(const Xt of Tt.docs){const mr=Xt.data(),Yr=Vn(mr.totalUnits??0),Br=Vn(mr.remaining??Yr),Fr=Ft-Yr,vn=Math.max(0,Br+Fr),Ln=Math.max(0,Math.floor(vn/Pt));await pn(Yt(Fe,"inventory_candies",Xt.id),{productName:mt.name,category:mt.category,unitsPerPackage:Pt,totalUnits:Ft,quantity:Ft,remaining:vn,packages:Vn(mt.packages),remainingPackages:Ln,providerPrice:mt.providerPrice,subtotal:mt.subtotal,totalRivas:mt.totalRivas,totalSanJorge:mt.totalSanJorge,totalIsla:mt.totalIsla,gainRivas:mt.gainRivas,gainSanJorge:mt.gainSanJorge,gainIsla:mt.gainIsla,unitPriceRivas:mt.unitPriceRivas,unitPriceSanJorge:mt.unitPriceSanJorge,unitPriceIsla:mt.unitPriceIsla,date:Ze})}}const Oe=await Qt(er(_t(Fe,"inventory_candies"),cr("orderId","==",w))),et=new Set(q.map(mt=>mt.id));for(const mt of Oe.docs){const Tt=mt.data(),Pt=String(Tt.productId||"");Pt&&!et.has(Pt)&&await Fn(Yt(Fe,"inventory_candies",mt.id))}p(mt=>mt.map(Tt=>Tt.id===w?{...Tt,name:oe.name,date:oe.date,totalPackages:oe.totalPackages,subtotal:oe.subtotal,totalRivas:oe.totalRivas,totalSanJorge:oe.totalSanJorge,totalIsla:oe.totalIsla,marginRivas:oe.marginRivas,marginSanJorge:oe.marginSanJorge,marginIsla:oe.marginIsla,logisticsCost:oe.logisticsCost}:Tt)),n(" Orden maestra actualizada (pedido + inventario)."),It(),b(!1),e();return}const We=(await On(_t(Fe,"candy_main_orders"),{...oe,createdAt:dr.now()})).id,dt=Jd(Fe);for(const Oe of q){const et=Math.max(1,Vn(Oe.unitsPerPackage||1)),mt=Vn(Oe.packages)*et,Tt=Yt(_t(Fe,"inventory_candies"));dt.set(Tt,{productId:Oe.id,productName:Oe.name,category:Oe.category,measurement:"unidad",quantity:mt,remaining:mt,packages:Vn(Oe.packages),remainingPackages:Vn(Oe.packages),unitsPerPackage:et,totalUnits:mt,providerPrice:Oe.providerPrice,subtotal:Oe.subtotal,totalRivas:Oe.totalRivas,totalSanJorge:Oe.totalSanJorge,totalIsla:Oe.totalIsla,gainRivas:Oe.gainRivas,gainSanJorge:Oe.gainSanJorge,gainIsla:Oe.gainIsla,unitPriceRivas:Oe.unitPriceRivas,unitPriceSanJorge:Oe.unitPriceSanJorge,unitPriceIsla:Oe.unitPriceIsla,date:Ze,createdAt:dr.now(),status:"PENDIENTE",orderId:We})}await dt.commit(),n(" Orden maestra creada y registrada en inventario."),It(),b(!1),e()}catch(Ie){console.error(Ie),n(" Error al guardar orden maestra.")}finally{l(!1)}},Xe=async K=>{try{s(!0),n(""),j(K.id),_(K.name),E(K.date),k(String(K.marginRivas??20)),D(String(K.marginSanJorge??15)),pe(String(K.marginIsla??30));const Ie=Number(K.logisticsCost??0);fe(String(Ie||0)),ve("DATOS");const Ze=Yt(Fe,"candy_main_orders",K.id),at=await Bs(Ze);if(!at.exists()){n(" No se encontr la orden.");return}const it=at.data(),T=Array.isArray(it.items)?it.items:[],M=await Qt(er(_t(Fe,"inventory_candies"),cr("orderId","==",K.id))),V={};M.forEach(Y=>{const oe=Y.data(),De=String(oe.productId||"");if(!De)return;const We=rG(oe);V[De]=(V[De]||0)+We});const q=T.map(Y=>{const oe=d.find(Tt=>Tt.id===Y.id),De=Number((oe==null?void 0:oe.providerPrice)??Y.providerPrice??0),We=Math.max(1,Vn((oe==null?void 0:oe.unitsPerPackage)??Y.unitsPerPackage??1)),dt=Number(Y.marginRivas??0),Oe=Number(Y.marginSanJorge??Number(P||0)),et=Number(Y.marginIsla??0),mt=$m(De,Vn(Y.packages||0),{marginR:dt,marginSJ:Oe,marginIsla:et});return{...Y,name:String((oe==null?void 0:oe.name)??Y.name??"").trim(),category:String((oe==null?void 0:oe.category)??Y.category??"Caramelo").trim(),providerPrice:De,unitsPerPackage:We,remainingPackages:V[Y.id]??Y.remainingPackages??Y.packages??0,...mt}});ae(q),b(!0)}catch(Ie){console.error(Ie),n(" Error al abrir orden maestra.")}finally{s(!1)}},be=async K=>{if(confirm(`Eliminar la orden "${K.name}" y todo su inventario asociado?`)){n("");try{const Ze=await Qt(er(_t(Fe,"inventory_candies"),cr("orderId","==",K.id)));for(const at of Ze.docs)await Fn(Yt(Fe,"inventory_candies",at.id));await Fn(Yt(Fe,"candy_main_orders",K.id)),p(at=>at.filter(it=>it.id!==K.id)),n(" Orden maestra eliminada."),e()}catch(Ze){console.error(Ze),n(" Error al eliminar orden maestra.")}}},st=async()=>{if(!c)try{u(!0),n("");const K=await Qt(_t(Fe,"candy_main_orders"));let Ie=Jd(Fe),Ze=0,at=0;const it=(T,M)=>Math.abs(Number(T||0)-Number(M||0))>.01;K.forEach(T=>{const M=T.data(),V=Array.isArray(M.items)?M.items:[];if(!V.length)return;const q=V.reduce((Oe,et)=>Oe+Number(et.subtotal||0),0);let Y=Number(M.logisticsCost??M.gastosLogisticos??M.gastos??0);if(Number.isFinite(Y)||(Y=0),!Y){const Oe=V.reduce((et,mt)=>et+Number(mt.logisticAllocated??0),0);Y=Number(Oe||0)}const oe=V.map(Oe=>$5(Oe,Y,q)),De=oe.reduce((Oe,et)=>Oe+Number(et.grossProfit||0),0);if(!(it(M.logisticsCost,Y)||it(M.uBrutaGlobal,De)||oe.some((Oe,et)=>{const mt=V[et]||{};return it(mt.logisticAllocated,Oe.logisticAllocated)||it(mt.grossProfit,Oe.grossProfit)||it(mt.grossProfitIsla,Oe.grossProfitIsla)})))return;const dt=Yt(Fe,"candy_main_orders",T.id);Ie.update(dt,{logisticsCost:Y,uBrutaGlobal:De,items:oe,updatedAt:dr.now()}),Ze+=1,at+=1,Ze>=400&&(Ie.commit(),Ie=Jd(Fe),Ze=0)}),Ze>0&&await Ie.commit(),n(` Ordenes maestras actualizadas: ${at}`),e()}catch(K){console.error(K),n(" Error actualizando prorrateo de rdenes maestras.")}finally{u(!1)}};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"mb-3",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Ordenes Maestras"})}),i.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[i.jsx("div",{}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(pc,{onClick:e,loading:a||A}),i.jsx("button",{className:"inline-flex items-center gap-2 bg-gray-200 text-gray-800 px-2 md:px-3 py-2 rounded-2xl hover:bg-gray-300 disabled:opacity-60",onClick:st,disabled:c,children:c?"Actualizando prorrateo...":"Actualizar prorrateo"}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-indigo-600 text-white px-2 md:px-3 py-2 rounded-2xl hover:bg-indigo-700 w-full md:w-auto max-w-[220px] justify-center",onClick:()=>{It(),b(!0)},children:[i.jsx("span",{className:"items-center gap-4 inline-block bg-indigo-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nueva Orden"]})]})]}),r&&i.jsx("p",{className:"mt-2 text-sm",children:r})]}),y&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"relative bg-white p-4 md:p-6 rounded shadow-lg w-full max-w-6xl max-h-[90vh] overflow-y-auto text-sm",children:[o&&i.jsx("div",{className:"absolute inset-0 bg-white/70 z-50 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white border rounded-xl px-4 py-3 shadow flex items-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-5 w-5 text-gray-700",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-semibold",children:"Guardando orden"})]})}),i.jsxs("div",{className:"sticky top-0 bg-white z-20 pb-3 border-b",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("h3",{className:"text-lg md:text-xl font-bold",children:w?"Editar Orden Maestra":"Nueva Orden Maestra"}),i.jsx("div",{className:"ml-auto flex gap-2",children:i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",disabled:o,onClick:()=>{It(),b(!1)},children:"Cerrar"})})]}),i.jsx("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-1 gap-2",children:i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold",children:"Gastos logsticos (orden)"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:ge,onChange:K=>fe(K.target.value),placeholder:"0",min:0})]})}),i.jsx("div",{className:"md:hidden mt-3",children:i.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[i.jsx("button",{type:"button",onClick:()=>ve("DATOS"),className:`px-2 py-2 rounded text-xs font-semibold border ${ne==="DATOS"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:"Datos"}),i.jsx("button",{type:"button",onClick:()=>ve("AGREGAR"),className:`px-2 py-2 rounded text-xs font-semibold border ${ne==="AGREGAR"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:"Agregar"}),i.jsxs("button",{type:"button",onClick:()=>ve("ITEMS"),className:`px-2 py-2 rounded text-xs font-semibold border ${ne==="ITEMS"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:["Items (",xe.length,")"]}),i.jsx("button",{type:"button",onClick:()=>ve("TOTALES"),className:`px-2 py-2 rounded text-xs font-semibold border ${ne==="TOTALES"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:"Totales"})]})})]}),i.jsxs("form",{onSubmit:xt,className:"space-y-4 pt-4",children:[i.jsx("input",{ref:$e,type:"file",accept:".xlsx,.xls,.csv",className:"hidden",onChange:vt}),i.jsx("div",{className:`${ne==="DATOS"?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre de Orden"}),i.jsx("input",{className:"w-full border p-2 rounded",value:I,onChange:K=>_(K.target.value),placeholder:"Ej: Pedido enero 19"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del pedido"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:S,onChange:K=>E(K.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia Rivas"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:F,onChange:K=>k(K.target.value)})]}),i.jsx("input",{type:"hidden",value:P,readOnly:!0}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia Isla Ometepe"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:X,onChange:K=>pe(K.target.value)})]})]})}),i.jsx("div",{className:`${ne==="AGREGAR"?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora (dinmica)"}),i.jsx("select",{className:"w-full border p-2 rounded",value:Se,onChange:K=>{Te(K.target.value),G("")},disabled:A,children:Me.length===0?i.jsx("option",{value:"",children:A?"Cargando...":"No hay categoras en catlogo"}):Me.map(K=>i.jsx("option",{value:K,children:K},K))})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (catlogo)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:O,onChange:K=>G(K.target.value),children:[i.jsx("option",{value:"",children:A?"Cargando catlogo...":"Selecciona producto"}),yt.map(K=>i.jsx("option",{value:K.id,children:K.name},K.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio proveedor (paq)"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded bg-gray-100",value:z,readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Paquetes"}),i.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:R,onChange:K=>H(K.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Unidades por paquete"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded bg-gray-100",value:Z,readOnly:!0})]})]}),i.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-end gap-2 mt-3",children:i.jsx("button",{type:"button",onClick:Ke,className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Agregar producto"})})]})}),i.jsxs("div",{className:"hidden md:flex items-center justify-end gap-2",children:[i.jsx("button",{type:"button",onClick:te,className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",title:"Descarga plantilla (Productos + Config)",children:"Descargar plantilla"}),i.jsx("button",{type:"button",onClick:nt,disabled:de,className:"px-3 py-2 rounded bg-emerald-600 text-white hover:bg-emerald-700 disabled:opacity-60",title:"Importa desde Excel (Productos + Config)",children:de?"Importando...":"Importar Excel"}),i.jsx("button",{type:"button",onClick:ie,className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",title:"Exporta la orden actual (Productos + Resumen)",children:"Exportar Excel"})]}),i.jsx("div",{className:`${ne==="ITEMS"?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"mt-2",children:[i.jsxs("div",{className:"mb-2 flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Items:"," ",i.jsx("span",{className:"font-semibold",children:xe.length}),U.trim()?i.jsxs(i.Fragment,{children:[" "," Mostrando"," ",i.jsx("span",{className:"font-semibold",children:Ne.length})]}):null]}),i.jsx("input",{value:U,onChange:K=>He(K.target.value),placeholder:"Buscar producto o categora",className:"w-full md:w-80 border rounded px-3 py-2 text-sm"})]}),i.jsxs("div",{className:"hidden md:block",children:[i.jsx("div",{className:"overflow-x-auto border rounded pb-5",children:i.jsxs("table",{className:"min-w-[1400px] w-full text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-2",children:"Categora"}),i.jsx("th",{className:"text-left p-2",children:"Producto"}),i.jsx("th",{className:"text-right p-2",children:"Paquetes"}),i.jsx("th",{className:"text-right p-2",children:"Restantes"}),i.jsx("th",{className:"text-right p-2",children:"Und x Paq"}),i.jsx("th",{className:"text-right p-2",children:"Precio prov"}),i.jsx("th",{className:"text-right p-2",children:"Facturado"}),i.jsx("th",{className:"text-right p-2",children:"Esperado Rivas"}),i.jsx("th",{className:"text-right p-2",children:"Esperado Isla"}),i.jsx("th",{className:"text-right p-2",children:"MV Rivas"}),i.jsx("th",{className:"text-right p-2",children:"MV Isla"}),i.jsx("th",{className:"text-right p-2",children:"U. Bruta Rivas"}),i.jsx("th",{className:"text-right p-2",children:"U. Bruta Isla"}),i.jsx("th",{className:"text-right p-2",children:"Prorrateo"}),i.jsx("th",{className:"text-right p-2",children:"Precio Rivas"}),i.jsx("th",{className:"text-right p-2",children:"Precio Isla"}),i.jsx("th",{className:"text-center p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[je.map(K=>i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"p-2",children:K.category}),i.jsx("td",{className:"p-2 font-semibold",children:K.name}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:K.packages,onChange:Ie=>At(K.id,"packages",Ie.target.value)})}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("span",{className:"inline-block min-w-[60px] text-right",children:Vn(K.remainingPackages??K.packages)})}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:K.unitsPerPackage,onChange:Ie=>At(K.id,"unitsPerPackage",Ie.target.value)})}),i.jsx("td",{className:"p-2 text-right",children:Number(K.providerPrice||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(K.subtotal||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(K.totalRivas||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(K.totalIsla||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",className:"w-16 border rounded p-1 text-right",value:Number(K.marginRivas??0),onChange:Ie=>At(K.id,"marginRivas",Ie.target.value)})}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",className:"w-16 border rounded p-1 text-right",value:Number(K.marginIsla??0),onChange:Ie=>At(K.id,"marginIsla",Ie.target.value)})}),i.jsx("td",{className:"p-2 text-right",children:Number(K.grossProfit||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(K.grossProfitIsla||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(K.logisticAllocated||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(K.unitPriceRivas||0)}),i.jsx("td",{className:"p-2 text-right",children:Number(K.unitPriceIsla||0)}),i.jsx("td",{className:"p-2 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>wt(K.id),children:"Quitar"})})]},K.id)),Ne.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center text-gray-500",children:"No hay productos en la orden."})})]})]})}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando"," ",Math.min((Ve-1)*le+1,Ne.length),"-",Math.min(Ve*le,Ne.length)," ","de ",Ne.length]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",disabled:Ve<=1,onClick:()=>he(K=>Math.max(1,K-1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Anterior"}),i.jsxs("div",{className:"px-3 py-1 border rounded text-sm",children:[Ve," / ",Be]}),i.jsx("button",{type:"button",disabled:Ve>=Be,onClick:()=>he(K=>Math.min(Be,K+1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Siguiente"})]})]})]}),i.jsx("div",{className:"md:hidden space-y-3",children:Ne.length===0?i.jsx("div",{className:"p-4 border rounded bg-gray-50 text-gray-600",children:"No hay productos en esta orden."}):Ne.map(K=>i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm",children:[i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"font-semibold text-base leading-tight truncate",children:K.name}),i.jsx("div",{className:"text-xs text-gray-500 truncate",children:K.category})]}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>wt(K.id),children:"Quitar"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:K.packages,onChange:Ie=>At(K.id,"packages",Ie.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Paquetes restantes"}),i.jsx("input",{className:"w-full border p-2 rounded text-right bg-gray-100",value:K.remainingPackages??K.packages,readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Und x Paquete"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:K.unitsPerPackage,onChange:Ie=>At(K.id,"unitsPerPackage",Ie.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Precio proveedor"}),i.jsx("input",{className:"w-full border p-2 rounded text-right bg-gray-100",value:Number(K.providerPrice||0).toFixed(2),readOnly:!0})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"MV Rivas (%)"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:K.marginRivas??0,onChange:Ie=>At(K.id,"marginRivas",Ie.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"MV Isla (%)"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:K.marginIsla??0,onChange:Ie=>At(K.id,"marginIsla",Ie.target.value)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Facturado"}),i.jsx("div",{className:"font-semibold",children:Number(K.subtotal||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Esperado Rivas"}),i.jsx("div",{className:"font-semibold",children:Number(K.totalRivas||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Esperado Isla"}),i.jsx("div",{className:"font-semibold",children:Number(K.totalIsla||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prorrateo logstico"}),i.jsx("div",{className:"font-semibold",children:Number(K.logisticAllocated||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta Rivas"}),i.jsx("div",{className:"font-semibold",children:Number(K.grossProfit||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta Isla"}),i.jsx("div",{className:"font-semibold",children:Number(K.grossProfitIsla||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Precio Rivas (paq)"}),i.jsx("div",{className:"font-semibold",children:K.unitPriceRivas})]}),i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Precio Isla (paq)"}),i.jsx("div",{className:"font-semibold",children:K.unitPriceIsla})]})]})]},K.id))})]})}),i.jsxs("div",{className:`${ne==="TOTALES"?"block":"hidden"} md:block`,children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mt-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes totales"}),i.jsx("div",{className:"text-lg font-semibold",children:me.totalPackages})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal costo (facturado)"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(me.subtotalCosto||0).toFixed(2)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Esperado (Rivas / Isla)"}),i.jsxs("div",{className:"text-sm font-semibold",children:["Rivas: ",Number(me.esperadoRivas||0).toFixed(2),i.jsx("br",{}),"Isla: ",Number(me.esperadoIsla||0).toFixed(2)]})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos logsticos"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(me.gastosLogisticos||0).toFixed(2)})]})]}),i.jsxs("div",{className:"mt-3",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-emerald-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta Rivas"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(me.utilidadBrutaRivas||0).toFixed(2)})]}),i.jsxs("div",{className:"p-3 border rounded bg-emerald-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta Isla"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(me.utilidadBrutaIsla||0).toFixed(2)})]})]}),i.jsx("div",{className:"mt-3 border rounded p-3 bg-white",children:i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:ie,disabled:!ke.items.length,title:"Exporta la orden actual (productos + resumen)",children:"Exportar orden a Excel"})})})]})]}),i.jsxs("div",{className:"sticky bottom-0 bg-white pt-3 mt-4 border-t",children:[i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx("button",{type:"button",onClick:It,className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",children:"Limpiar orden"}),i.jsx("button",{type:"button",onClick:()=>{It(),b(!1)},className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",children:"Cerrar"}),i.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",disabled:o||xe.length===0,children:o?"Guardando...":"Guardar orden"})]}),i.jsx("div",{className:"md:hidden mt-2",children:i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 text-sm",onClick:()=>{ve(ne==="DATOS"&&!w?"AGREGAR":ne==="DATOS"||ne==="AGREGAR"?"ITEMS":ne==="ITEMS"?"TOTALES":"DATOS")},children:"Siguiente"})})]})]})]})}),i.jsxs("div",{className:"mt-4",children:[i.jsx("div",{className:"md:hidden space-y-3",children:a?i.jsx("div",{className:"p-4 border rounded bg-white text-center",children:"Cargando"}):m.length===0?i.jsx("div",{className:"p-4 border rounded bg-white text-center",children:"Sin ordenes maestras."}):m.map(K=>{const Ie=g[K.id],Ze=ht(K),at=K.totalPackages>0?(K.subtotal/K.totalPackages).toFixed(2):"0.00",it=Number(K.logisticsCost||0),T=Number(K.totalRivas||0)-Number(K.subtotal||0);return i.jsxs("div",{className:"border rounded-xl p-3 bg-white shadow-sm",children:[i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"text-xs text-gray-500",children:Ze}),i.jsx("div",{className:"font-semibold text-base leading-tight",children:K.name})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-xs",onClick:()=>Xe(K),children:"Ver"}),i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white text-xs",onClick:()=>be(K),children:"Borrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("div",{className:"font-semibold",children:K.totalPackages})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Restantes"}),i.jsx("div",{className:"font-semibold",children:Ie?Ie.remainingPackages:0})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"P. Proveedor"}),i.jsx("div",{className:"font-semibold",children:at})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal"}),i.jsx("div",{className:"font-semibold",children:Number(K.subtotal||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Esperado Rivas"}),i.jsx("div",{className:"font-semibold",children:Number(K.totalRivas||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Esperado Isla"}),i.jsx("div",{className:"font-semibold",children:Number(K.totalIsla||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Gastos log."}),i.jsx("div",{className:"font-semibold",children:it.toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta (est)"}),i.jsx("div",{className:"font-semibold",children:T.toFixed(2)})]})]})]},K.id)})}),i.jsxs("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full overflow-x-auto",children:[i.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Proveedor"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Esperado Rivas"}),i.jsx("th",{className:"p-2 border",children:"Esperado Isla"}),i.jsx("th",{className:"p-2 border",children:"Gastos log."}),i.jsx("th",{className:"p-2 border",children:"U. Bruta (est)"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):m.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin ordenes maestras."})}):we.map(K=>{const Ie=g[K.id],Ze=ht(K),at=K.totalPackages>0?(K.subtotal/K.totalPackages).toFixed(2):"0.00",it=Number(K.logisticsCost||0),T=Number(K.totalRivas||0)-Number(K.subtotal||0);return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:Ze}),i.jsx("td",{className:"p-2 border text-left",children:K.name}),i.jsx("td",{className:"p-2 border",children:K.totalPackages}),i.jsx("td",{className:"p-2 border",children:Ie?Ie.remainingPackages:0}),i.jsx("td",{className:"p-2 border",children:at}),i.jsx("td",{className:"p-2 border",children:Number(K.subtotal||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Number(K.totalRivas||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Number(K.totalIsla||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:it.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:T.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>Xe(K),children:"Ver / Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>be(K),children:"Borrar"})]})})]},K.id)})})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",Math.min((se-1)*Pe+1,m.length),"-",Math.min(se*Pe,m.length)," de ",m.length]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",disabled:se<=1,onClick:()=>re(K=>Math.max(1,K-1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Anterior"}),i.jsxs("div",{className:"px-3 py-1 border rounded text-sm",children:[se," / ",ue]}),i.jsx("button",{type:"button",disabled:se>=ue,onClick:()=>re(K=>Math.min(ue,K+1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Siguiente"})]})]})]})]})]})}const o0=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function G5(t){const e=Number(t.packages||0),r=Number(t.providerPrice||0),n=Number(t.unitsPerPackage||0),a=r*e,s=e>0&&n>0?e*n:1,o=Number(t.marginRivas||0),l=Number(t.marginSanJorge||0),c=Number(t.marginIsla||0),u=a*(1+o/100),d=a*(1+l/100),f=a*(1+c/100),A=u-a,h=d-a,m=f-a,p=u/s,g=d/s,v=f/s;return{...t,subtotal:Number(a.toFixed(2)),totalRivas:Number(u.toFixed(2)),totalSanJorge:Number(d.toFixed(2)),totalIsla:Number(f.toFixed(2)),gainRivas:Number(A.toFixed(2)),gainSanJorge:Number(h.toFixed(2)),gainIsla:Number(m.toFixed(2)),unitPriceRivas:Number(p.toFixed(2)),unitPriceSanJorge:Number(g.toFixed(2)),unitPriceIsla:Number(v.toFixed(2))}}function nG(t){return t.reduce((e,r)=>(e.totalPackages+=Number(r.packages||0),e.subtotal+=Number(r.subtotal||0),e.totalRivas+=Number(r.totalRivas||0),e.totalSanJorge+=Number(r.totalSanJorge||0),e.totalIsla+=Number(r.totalIsla||0),e),{totalPackages:0,subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0})}function Ec(t,e=0){const r=Number(t);return Number.isFinite(r)?r:e}function K5(t){const{margin:e,gain:r,subtotal:n,orderMargin:a}=t;if(e!=null&&Number.isFinite(Number(e)))return Number(e);const s=Number(n||0),o=Number(r);return Number.isFinite(o)&&s>0?o/s*100:Number(a||0)}function PQe(){var L,Z,ee;const[t,e]=x.useState([]),[r,n]=x.useState({}),[a,s]=x.useState(!0),[o,l]=x.useState(""),[c,u]=x.useState(Nr(yd(new Date),"yyyy-MM-dd")),[d,f]=x.useState(Nr(vd(new Date),"yyyy-MM-dd")),[A,h]=x.useState(!1),[m,p]=x.useState(!1),[g,v]=x.useState(null),[y,b]=x.useState([]),[w,j]=x.useState(0),[I,_]=x.useState(0),[S,E]=x.useState(0),[F,k]=x.useState(""),[P,D]=x.useState(""),[X,pe]=x.useState(0),[ge,fe]=x.useState(0),[xe,ae]=x.useState(1);x.useEffect(()=>{(async()=>{try{s(!0),l("");const R=er(_t(Fe,"candy_main_orders"),dn("createdAt","desc")),H=await Qt(R),ne=[];H.forEach(He=>{const se=He.data();ne.push({id:He.id,name:se.name??"",date:se.date??"",totalPackages:Number(se.totalPackages??0),subtotal:Number(se.subtotal??0),totalRivas:Number(se.totalRivas??0),totalSanJorge:Number(se.totalSanJorge??0),totalIsla:Number(se.totalIsla??0),marginRivas:Number(se.marginRivas??0),marginSanJorge:Number(se.marginSanJorge??0),marginIsla:Number(se.marginIsla??0),createdAt:se.createdAt??dr.now()})}),e(ne);const ve=await Qt(er(_t(Fe,"inventory_candies"))),U={};ve.forEach(He=>{const se=He.data(),re=se.orderId;if(!re)return;const Pe=Number(se.unitsPerPackage||1)||1,ue=Number(se.totalUnits??(se.packages||0)*Pe),we=Math.round(ue/Pe),Me=Number(se.remaining??se.totalUnits??ue),ze=Number(se.remainingPackages??NaN),yt=Number.isFinite(ze)?Math.round(ze):Math.round(Me/Pe);U[re]||(U[re]={orderId:re,totalPackages:0,remainingPackages:0}),U[re].totalPackages+=we,U[re].remainingPackages+=yt}),n(U)}catch(R){console.error(R),l(" Error cargando inventario de pedidos.")}finally{s(!1)}})()},[]);const Se=x.useMemo(()=>t.filter(R=>{var ne;const H=R.date||((ne=R.createdAt)!=null&&ne.toDate?R.createdAt.toDate().toISOString().slice(0,10):"");return!(!H||c&&H<c||d&&H>d)}),[t,c,d]),Te=x.useMemo(()=>{let R=0,H=0,ne=0,ve=0,U=0,He=0;for(const se of Se){R+=se.totalPackages,H+=se.subtotal,ne+=se.totalRivas,ve+=se.totalSanJorge,U+=se.totalIsla;const re=r[se.id];re&&(He+=re.remainingPackages)}return{totalPaquetes:R,totalSubtotal:H,totalRivas:ne,totalSJ:ve,totalIsla:U,totalPaquetesRestantes:He,totalPedidos:Se.length}},[Se,r]),O=async(R,H,ne)=>{if(!g)return;const ve=Number(ne||0),U=y.map(re=>re.id!==R?re:G5({...re,[H]:ve}));b(U);const He=U.find(re=>re.id===R);if(!He)return;const se=nG(U);try{await pn(Yt(Fe,"products_candies",R),{marginRivas:He.marginRivas,marginSanJorge:He.marginSanJorge,marginIsla:He.marginIsla,subtotal:He.subtotal,totalRivas:He.totalRivas,totalSanJorge:He.totalSanJorge,totalIsla:He.totalIsla,unitPriceRivas:He.unitPriceRivas,unitPriceSanJorge:He.unitPriceSanJorge,unitPriceIsla:He.unitPriceIsla,gainRivas:He.gainRivas,gainSanJorge:He.gainSanJorge,gainIsla:He.gainIsla}),await pn(Yt(Fe,"candy_main_orders",g.id),{totalPackages:se.totalPackages,subtotal:Number(se.subtotal.toFixed(2)),totalRivas:Number(se.totalRivas.toFixed(2)),totalSanJorge:Number(se.totalSanJorge.toFixed(2)),totalIsla:Number(se.totalIsla.toFixed(2))}),v(re=>re&&{...re,totalPackages:se.totalPackages,subtotal:Number(se.subtotal.toFixed(2)),totalRivas:Number(se.totalRivas.toFixed(2)),totalSanJorge:Number(se.totalSanJorge.toFixed(2)),totalIsla:Number(se.totalIsla.toFixed(2))}),l(" Mrgenes del producto actualizados.")}catch(re){console.error(re),l(" Error actualizando mrgenes del producto.")}},G=async()=>{if(g)try{l("");const R=Number.isFinite(w)&&w!==0?w:g.marginRivas||0,H=Number.isFinite(I)&&I!==0?I:g.marginSanJorge||0,ne=Number.isFinite(S)&&S!==0?S:g.marginIsla||0,ve=G5({id:"tmp",name:F.trim(),category:P.trim(),providerPrice:Number(X||0),packages:Number(ge||0),unitsPerPackage:Number(xe||1),marginRivas:Number(R||0),marginSanJorge:Number(H||0),marginIsla:Number(ne||0),subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0,gainRivas:0,gainSanJorge:0,gainIsla:0,unitPriceRivas:0,unitPriceSanJorge:0,unitPriceIsla:0,remainingPackages:Number(ge||0)}),U=await On(_t(Fe,"products_candies"),{orderId:g.id,inventoryDate:g.date||"",name:ve.name,category:ve.category,providerPrice:ve.providerPrice,packages:ve.packages,unitsPerPackage:ve.unitsPerPackage,marginRivas:ve.marginRivas,marginSanJorge:ve.marginSanJorge,marginIsla:ve.marginIsla,gainRivas:ve.gainRivas,gainSanJorge:ve.gainSanJorge,gainIsla:ve.gainIsla,subtotal:ve.subtotal,totalRivas:ve.totalRivas,totalSanJorge:ve.totalSanJorge,totalIsla:ve.totalIsla,unitPriceRivas:ve.unitPriceRivas,unitPriceSanJorge:ve.unitPriceSanJorge,unitPriceIsla:ve.unitPriceIsla,createdAt:dr.now()}),se=[{...ve,id:U.id},...y];b(se);const re=nG(se);await pn(Yt(Fe,"candy_main_orders",g.id),{totalPackages:re.totalPackages,subtotal:Number(re.subtotal.toFixed(2)),totalRivas:Number(re.totalRivas.toFixed(2)),totalSanJorge:Number(re.totalSanJorge.toFixed(2)),totalIsla:Number(re.totalIsla.toFixed(2))}),v(Pe=>Pe&&{...Pe,totalPackages:re.totalPackages,subtotal:Number(re.subtotal.toFixed(2)),totalRivas:Number(re.totalRivas.toFixed(2)),totalSanJorge:Number(re.totalSanJorge.toFixed(2)),totalIsla:Number(re.totalIsla.toFixed(2))}),j(0),_(0),E(0),k(""),D(""),pe(0),fe(0),ae(1),l(" Producto agregado con mrgenes por sucursal.")}catch(R){console.error(R),l(" Error agregando producto al pedido.")}},z=async R=>{try{v(R),b([]),h(!0),p(!0),l("");const H=await Qt(er(_t(Fe,"inventory_candies"),cr("orderId","==",R.id))),ne={};H.forEach(He=>{const se=He.data(),re=se.productId;if(!re)return;const Pe=Number(se.unitsPerPackage||1)||1,ue=Number(se.remaining??se.totalUnits??0),we=Number(se.remainingPackages??NaN),Me=Number.isFinite(we)?Math.round(we):Math.round(ue/Pe);ne[re]=(ne[re]||0)+Me});const ve=await Qt(er(_t(Fe,"products_candies"),cr("orderId","==",R.id))),U=[];ve.forEach(He=>{const se=He.data(),re=Ec(se.providerPrice,0),Pe=Ec(se.packages,0),ue=se.subtotal??re*Pe,we=K5({margin:se.marginRivas,gain:se.gainRivas,subtotal:ue,orderMargin:R.marginRivas||0}),Me=K5({margin:se.marginSanJorge,gain:se.gainSanJorge,subtotal:ue,orderMargin:R.marginSanJorge||0}),ze=K5({margin:se.marginIsla,gain:se.gainIsla,subtotal:ue,orderMargin:R.marginIsla||0}),yt=G5({id:He.id,name:se.name??"",category:se.category??"",providerPrice:re,packages:Pe,unitsPerPackage:Ec(se.unitsPerPackage,1),marginRivas:Number(we||0),marginSanJorge:Number(Me||0),marginIsla:Number(ze||0),subtotal:Ec(se.subtotal,0),totalRivas:Ec(se.totalRivas,0),totalSanJorge:Ec(se.totalSanJorge,0),totalIsla:Ec(se.totalIsla,0),gainRivas:Ec(se.gainRivas,0),gainSanJorge:Ec(se.gainSanJorge,0),gainIsla:Ec(se.gainIsla,0),unitPriceRivas:Ec(se.unitPriceRivas,0),unitPriceSanJorge:Ec(se.unitPriceSanJorge,0),unitPriceIsla:Ec(se.unitPriceIsla,0),remainingPackages:ne[He.id]??Ec(se.packages,0)});U.push(yt)}),b(U)}catch(H){console.error(H),l(" Error cargando productos del pedido.")}finally{p(!1)}};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario Ordenes Maestras"})}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:R=>u(R.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:R=>f(R.target.value)})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{u(""),f("")},children:"Quitar filtro"}),i.jsxs("div",{className:"ml-auto text-xs md:text-sm text-gray-600",children:["Cantidad de pedidos:"," ",i.jsx("span",{className:"font-semibold",children:Te.totalPedidos})]})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-sm md:text-base",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes totales:"})," ",Te.totalPaquetes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes restantes:"})," ",Te.totalPaquetesRestantes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Subtotal total:"})," ",o0(Te.totalSubtotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Rivas (todo):"})," ",o0(Te.totalRivas)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total San Jorge (todo):"})," ",o0(Te.totalSJ)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Isla (todo):"})," ",o0(Te.totalIsla)]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-2",children:i.jsxs("table",{className:"min-w-[900px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. prom. Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. prom. San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. prom. Isla"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):Se.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin pedidos generales en este rango."})}):Se.map(R=>{var se;const H=R.totalPackages>0?Math.round(R.totalRivas/R.totalPackages):0,ne=R.totalPackages>0?Math.round(R.totalSanJorge/R.totalPackages):0,ve=R.totalPackages>0?Math.round(R.totalIsla/R.totalPackages):0,U=R.date||((se=R.createdAt)!=null&&se.toDate?R.createdAt.toDate().toISOString().slice(0,10):""),He=r[R.id];return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:U}),i.jsx("td",{className:"p-2 border",children:R.name}),i.jsx("td",{className:"p-2 border",children:R.totalPackages}),i.jsx("td",{className:"p-2 border",children:He?He.remainingPackages:0}),i.jsx("td",{className:"p-2 border",children:R.subtotal.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:R.totalRivas.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:R.totalSanJorge.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:R.totalIsla.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:H}),i.jsx("td",{className:"p-2 border",children:ne}),i.jsx("td",{className:"p-2 border",children:ve}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>z(R),children:"Ver pedido"})})]},R.id)})})]})}),A&&g&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-5xl max-h-[90vh] overflow-y-auto text-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsxs("h3",{className:"text-xl font-bold",children:["Detalle: ",g.name]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:()=>{h(!1),v(null),b([]),l("")},children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4 text-xs md:text-sm",children:[i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Fecha del pedido"}),i.jsx("div",{className:"font-semibold",children:g.date||((L=g.createdAt)!=null&&L.toDate?g.createdAt.toDate().toISOString().slice(0,10):"")})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes totales"}),i.jsx("div",{className:"font-semibold",children:((Z=r[g.id])==null?void 0:Z.totalPackages)??g.totalPackages})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes restantes"}),i.jsx("div",{className:"font-semibold",children:((ee=r[g.id])==null?void 0:ee.remainingPackages)??0})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Subtotal (proveedor)"}),i.jsx("div",{className:"font-semibold",children:o0(g.subtotal)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total Rivas"}),i.jsx("div",{className:"font-semibold",children:o0(g.totalRivas)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total San Jorge"}),i.jsx("div",{className:"font-semibold",children:o0(g.totalSanJorge)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total Isla"}),i.jsx("div",{className:"font-semibold",children:o0(g.totalIsla)})]})]}),i.jsxs("div",{className:"bg-white border rounded p-3 mb-4",children:[i.jsx("div",{className:"font-semibold mb-2",children:"Agregar producto"}),i.jsxs("div",{className:"flex flex-wrap gap-2 items-end text-xs",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen Rivas"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:w,onChange:R=>j(Number(R.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen SJ"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:I,onChange:R=>_(Number(R.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen Isla"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:S,onChange:R=>E(Number(R.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Producto"}),i.jsx("input",{className:"border rounded px-2 py-1 w-56",value:F,onChange:R=>k(R.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Categora"}),i.jsx("input",{className:"border rounded px-2 py-1 w-40",value:P,onChange:R=>D(R.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"P. proveedor (paq)"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-32 text-right",value:X,onChange:R=>pe(Number(R.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Paquetes"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",value:ge,onChange:R=>fe(Number(R.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Und x Paq"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",value:xe,onChange:R=>ae(Number(R.target.value||1))})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:G,children:"Agregar producto"})]})]}),i.jsx("h4",{className:"font-semibold mb-2",children:"Productos del pedido"}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Und x Paq"}),i.jsx("th",{className:"p-2 border",children:"P. proveedor (paq)"}),i.jsx("th",{className:"p-2 border",children:"Margen Rivas (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen San Jorge (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen Isla (%)"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. unidad San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Isla"})]})}),i.jsx("tbody",{children:m?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"p-4 text-center",children:"Cargando productos"})}):y.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"p-4 text-center",children:"Este pedido no tiene productos registrados."})}):y.map(R=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:R.name}),i.jsx("td",{className:"p-2 border",children:R.category}),i.jsx("td",{className:"p-2 border",children:R.packages}),i.jsx("td",{className:"p-2 border",children:R.remainingPackages??R.packages}),i.jsx("td",{className:"p-2 border",children:R.unitsPerPackage}),i.jsx("td",{className:"p-2 border",children:R.providerPrice.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:R.marginRivas??0,onChange:H=>O(R.id,"marginRivas",H.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:R.marginSanJorge??0,onChange:H=>O(R.id,"marginSanJorge",H.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:R.marginIsla??0,onChange:H=>O(R.id,"marginIsla",H.target.value)})}),i.jsx("td",{className:"p-2 border",children:R.subtotal.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:R.totalRivas.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:R.totalSanJorge.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:R.totalIsla.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:R.unitPriceRivas}),i.jsx("td",{className:"p-2 border",children:R.unitPriceSanJorge}),i.jsx("td",{className:"p-2 border",children:R.unitPriceIsla})]},R.id))})]})}),o&&i.jsx("p",{className:"mt-3 text-sm",children:o})]})}),o&&!A&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const Wa=t=>Math.round((Number(t)||0)*100)/100,fx=t=>Math.round((Number(t)||0)*1e3)/1e3,qo=t=>Number(t??0).toFixed(2),Gm=t=>Number(t??0).toFixed(3),BQe=(t,e)=>{var h;const r=t.date??((h=t.timestamp)!=null&&h.toDate?Nr(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=t.userEmail??"",a=t.vendorName||t.vendor||n||t.vendorId||"(sin vendedor)",s=t.type||"CONTADO",o=t.vendorId,l=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,c=Number(t.vendorCommissionAmount??0)||0,u=t.processedDate??t.closureDate??"";if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((m,p)=>{const g=Number((m==null?void 0:m.packages)??(m==null?void 0:m.qty)??(m==null?void 0:m.quantity)??0),v=Number((m==null?void 0:m.lineFinal)??0)||Math.max(0,Number((m==null?void 0:m.unitPricePackage)||(m==null?void 0:m.unitPrice)||0)*g-Number((m==null?void 0:m.discount)||0));let y=0;return c>0&&l>0&&Number(v||0)>0&&(y=Wa(c*Number(v||0)/l)),{id:`${e}#${p}`,productName:String((m==null?void 0:m.productName)??"(sin nombre)"),quantity:g,amount:Wa(v),amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:a,sellerEmail:n,clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:Array.isArray(m==null?void 0:m.allocations)?m.allocations:t.allocations,avgUnitCost:Number((m==null?void 0:m.avgUnitCost)??t.avgUnitCost??0),cogsAmount:Number((m==null?void 0:m.cogsAmount)??0),type:s,vendorId:o,vendorCommissionAmount:y,processedDate:u||""}});const d=Number(t.packagesTotal??t.quantity??0),f=Number(t.amount??t.amountCharged??t.total??0)||0;let A=0;return A=Wa(Number(t.vendorCommissionAmount??0)||0),[{id:e,productName:t.productName??"(sin nombre)",quantity:d,amount:f,amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:a,sellerEmail:n,clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:t.allocations,avgUnitCost:t.avgUnitCost,cogsAmount:t.cogsAmount,type:s,vendorId:o,vendorCommissionAmount:A,processedDate:u||""}]};function TQe({role:t,currentUserEmail:e,sellerCandyId:r,roles:n}){const[a,s]=x.useState([]),[o,l]=x.useState(null),[c,u]=x.useState(!0),[d,f]=x.useState(""),[A,h]=x.useState("ALL"),m=Nr(new Date,"yyyy-MM-dd"),[p,g]=x.useState(m),[v,y]=x.useState(m),[b,w]=x.useState("ALL"),[j,I]=x.useState(null),[_,S]=x.useState(0),[E,F]=x.useState(0),[k,P]=x.useState(""),[D,X]=x.useState(0),[pe,ge]=x.useState("0"),fe=x.useRef(null),xe=n&&n.length?n:t,ae=!xe||sn(xe,"admin"),Se=sn(xe,"vendedor_dulces"),Te=(e||"").trim().toLowerCase(),[O,G]=x.useState([]);x.useEffect(()=>{if(!p||!v)return;u(!0);const le=er(_t(Fe,"sales_candies"),cr("date",">=",p),cr("date","<=",v),dn("date","asc")),Be=cd(le,je=>{const Ae=[];je.forEach(Qe=>{const Ct=BQe(Qe.data(),Qe.id);Ae.push(...Ct)}),s(Ae),u(!1)},je=>{console.error("Error cargando ventas por periodo:",je),s([]),u(!1)});return()=>Be()},[p,v]),x.useEffect(()=>{(async()=>{const Be=er(_t(Fe,"daily_closures_candies"),cr("date","==",m)),je=await Qt(Be);if(je.empty)l(null);else{const Ae=je.docs[0];l({id:Ae.id,...Ae.data()})}})()},[m]),x.useEffect(()=>{(async()=>{try{const Be=await Qt(_t(Fe,"sellers_candies")),je=[];Be.forEach(Ae=>{const Qe=Ae.data();je.push({id:Ae.id,name:Qe.name||"",commissionPercent:Number(Qe.commissionPercent||0)})}),G(je)}catch(Be){console.error("Error cargando sellers_candies",Be)}})()},[]);const z=le=>Wa(Number(le.vendorCommissionAmount??0)||0),L=ko.useMemo(()=>{let le=[...a];return A==="FLOTANTE"&&(le=le.filter(Be=>Be.status==="FLOTANTE")),A==="PROCESADA"&&(le=le.filter(Be=>Be.status==="PROCESADA")),ae&&b!=="ALL"&&(le=le.filter(Be=>(Be.vendorId||"")===b)),Se&&(r?le=le.filter(Be=>(Be.vendorId||"")===r):Te?le=le.filter(Be=>(Be.sellerEmail||"").toLowerCase()===Te):le=[]),le},[A,a,ae,b,Se,r,Te]),Z=ko.useMemo(()=>L.filter(le=>le.status==="FLOTANTE").length,[L]),ee=ko.useMemo(()=>L.filter(le=>le.status==="PROCESADA").length,[L]),R=ko.useMemo(()=>L.filter(le=>le.type==="CREDITO").length,[L]),H=ko.useMemo(()=>L.filter(le=>le.type!=="CREDITO").length,[L]),ne=fx(L.reduce((le,Be)=>le+(Be.quantity||0),0)),ve=Wa(L.reduce((le,Be)=>le+Number(Be.cogsAmount??0),0)),U=Wa(L.reduce((le,Be)=>le+(Be.amount||0),0)),He=Wa(U-ve);let se=0,re=0,Pe=0,ue=0,we=0,Me=0,ze=0;L.forEach(le=>{const Be=Number(le.amount||0),je=Number(le.amountReceived||0),Ae=z(le);we+=Ae,le.type==="CREDITO"?(se+=le.quantity||0,Pe+=Be-je,ze+=Ae):(re+=le.quantity||0,ue+=Be,Me+=Ae)}),Pe=Wa(Pe),ue=Wa(ue),we=Wa(we),Me=Wa(Me),ze=Wa(ze);const yt=ko.useMemo(()=>{const le={};for(const Be of L){const je=(Be.vendorId||"").trim();if(!je||Be.type==="CREDITO")continue;const Ae=z(Be);if(!le[je]){const Qe=O.find(Ct=>Ct.id===je);le[je]={vendorId:je,name:(Qe==null?void 0:Qe.name)||Be.userEmail||"(sin vendedor)",total:0}}le[je].total=Wa(le[je].total+Ae)}return Object.values(le).filter(Be=>Be.total>0).sort((Be,je)=>je.total-Be.total)},[L,O]),It=ko.useMemo(()=>{const le={};for(const Be of L){const je=(Be.vendorId||"").trim();if(!je||Be.type!=="CREDITO")continue;const Ae=z(Be);if(!le[je]){const Qe=O.find(Ct=>Ct.id===je);le[je]={vendorId:je,name:(Qe==null?void 0:Qe.name)||Be.userEmail||"(sin vendedor)",total:0}}le[je].total=Wa(le[je].total+Ae)}return Object.values(le).filter(Be=>Be.total>0).sort((Be,je)=>je.total-Be.total)},[L,O]),Ke={};L.forEach(le=>{const Be=le.productName||"(sin nombre)";Ke[Be]||(Ke[Be]={totalQuantity:0,totalAmount:0,totalCommission:0}),Ke[Be].totalQuantity=fx(Ke[Be].totalQuantity+(le.quantity||0)),Ke[Be].totalAmount=Wa(Ke[Be].totalAmount+(le.amount||0)),Ke[Be].totalCommission=Wa(Ke[Be].totalCommission+z(le))});const wt=Object.entries(Ke).map(([le,Be])=>({productName:le,totalQuantity:Be.totalQuantity,totalAmount:Be.totalAmount,totalCommission:Be.totalCommission})),At=async()=>{if(ae)try{const le=L.filter(te=>te.status==="FLOTANTE");if(le.length===0){f("No hay ventas flotantes para procesar en este perodo.");return}const Be={totalCharged:Wa(le.reduce((te,ie)=>te+(ie.amount||0),0)),totalSuggested:Wa(le.reduce((te,ie)=>te+(ie.amountSuggested||0),0)),totalUnits:fx(le.reduce((te,ie)=>te+(ie.quantity||0),0)),totalCOGS:Wa(le.reduce((te,ie)=>te+Number(ie.cogsAmount??0),0))},je=Wa(Be.totalCharged-Be.totalSuggested),Ae=Wa(Be.totalCharged-Be.totalCOGS),Qe=le.reduce((te,ie)=>{const $e=Number(ie.quantity||0),de=Number(ie.amount||0),Ce=Number(ie.vendorCommissionAmount||0);return ie.type==="CREDITO"?(te.packsCredit+=$e,te.amountCredit+=de,te.comCredit+=Ce):(te.packsCash+=$e,te.amountCash+=de,te.comCash+=Ce),te},{packsCash:0,packsCredit:0,amountCash:0,amountCredit:0,comCash:0,comCredit:0}),Ct={totalPacksCash:fx(Qe.packsCash),totalPacksCredit:fx(Qe.packsCredit),totalAmountCash:Wa(Qe.amountCash),totalAmountCredit:Wa(Qe.amountCredit),totalCommissionCash:Wa(Qe.comCash),totalCommissionCredit:Wa(Qe.comCredit)},pt=await On(_t(Fe,"daily_closures_candies"),{date:m,createdAt:dr.now(),periodStart:p,periodEnd:v,totalCharged:Be.totalCharged,totalSuggested:Be.totalSuggested,totalDifference:je,totalUnits:Be.totalUnits,totalCOGS:Be.totalCOGS,grossProfit:Ae,...Ct,products:le.map(te=>({productName:te.productName,quantity:te.quantity,amount:te.amount})),sales:le.map(te=>({id:te.id,productName:te.productName,quantity:te.quantity,amount:te.amount,amountSuggested:te.amountSuggested,userEmail:te.userEmail,clientName:te.clientName,amountReceived:te.amountReceived,change:te.change,status:te.status,cogsAmount:te.cogsAmount??0,avgUnitCost:te.avgUnitCost??null,allocations:te.allocations??[],date:te.date,type:te.type??"CONTADO",vendorId:te.vendorId??"",vendorCommissionAmount:Number(te.vendorCommissionAmount??0)||0,processedDate:m})),productSummary:Object.entries(le.reduce((te,ie)=>{const $e=ie.productName||"(sin nombre)";return te[$e]||(te[$e]={totalQuantity:0,totalAmount:0}),te[$e].totalQuantity=fx(te[$e].totalQuantity+(ie.quantity||0)),te[$e].totalAmount=Wa(te[$e].totalAmount+(ie.amount||0)),te},{})).map(([te,ie])=>({productName:te,totalQuantity:ie.totalQuantity,totalAmount:ie.totalAmount}))}),me=Jd(Fe);le.forEach(te=>{me.update(Yt(Fe,"sales_candies",te.id.split("#")[0]),{status:"PROCESADA",closureId:pt.id,closureDate:m,processedDate:m,processedAt:dr.now()})}),await me.commit(),f(` Cierre guardado. Ventas procesadas: ${le.length}. (Proceso: ${m})`)}catch(le){console.error(le),f(" Error al guardar el cierre de dulces.")}},bt=async le=>{if(ae&&window.confirm("Revertir esta venta? Esta accin no se puede deshacer."))try{await pn(Yt(Fe,"sales_candies",le.split("#")[0]),{status:"FLOTANTE",closureId:null,closureDate:null,processedDate:null,processedAt:null}),f(" Venta revertida a FLOTANTE.")}catch(Be){console.error(Be),f(" No se pudo revertir la venta.")}},ke=le=>{ae&&(I(le),S(le.quantity),F(le.amount),P(le.clientName),X(le.amountReceived),ge(le.change))},Ne=async()=>{if(!(!j||!ae))try{await pn(Yt(Fe,"sales_candies",j.id.split("#")[0]),{packagesTotal:_,amount:E,amountCharged:E,clientName:k,amountReceived:D,change:pe}),I(null),f(" Venta de dulces actualizada.")}catch(le){console.error(le),f(" No se pudo actualizar la venta de dulces.")}},Ve=async le=>{if(ae&&window.confirm("Eliminar esta venta? Se restaurar el stock (paquetes) en los lotes asignados."))try{const{restored:Be}=await W9e(le.split("#")[0]);f(` Venta eliminada. Stock restaurado (unidades internas): ${Number(Be).toFixed(2)}.`)}catch(Be){console.error(Be),f(" No se pudo eliminar la venta de dulces.")}},he=async()=>{if(fe.current){fe.current.classList.add("force-pdf-colors"),fe.current.classList.add("pdf-print-mode");try{const Be=(await Cg(fe.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),je=new Rr;je.addImage(Be,"PNG",10,10,190,0),je.save(`cierre_dulces_${p}_a_${v}_proc_${m}.pdf`)}finally{fe.current.classList.remove("pdf-print-mode"),fe.current.classList.remove("force-pdf-colors")}}};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("style",{children:`
        .pdf-print-mode .pdf-desktop { display: block !important; }
        .pdf-print-mode .pdf-mobile  { display: none !important; }
      `}),i.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Cierre de Ventas de Dulces - Proceso: ",m]}),i.jsxs("div",{className:"flex flex-col md:flex-row md:items-end gap-3 mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Desde:"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:p,onChange:le=>g(le.target.value)})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Hasta:"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:v,onChange:le=>y(le.target.value)})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Filtrar:"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:le=>h(le.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Venta Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Venta Procesada"})]})]}),ae&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Vendedor:"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:b,onChange:le=>w(le.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),O.map(le=>i.jsx("option",{value:le.id,children:le.name||le.id},le.id))]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas flotantes"}),i.jsx("div",{className:"text-2xl font-bold",children:Z}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas procesadas"}),i.jsx("div",{className:"text-2xl font-bold",children:ee}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:R}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsx("div",{className:"text-2xl font-bold",children:H}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash (perodo)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",qo(Me)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito (perodo)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",qo(ze)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin CASH del perodo)"}),yt.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:yt.map(le=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:le.name}),i.jsxs("strong",{className:"ml-2",children:["C$",qo(le.total)]})]},le.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin CRDITO del perodo)"}),It.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:It.map(le=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:le.name}),i.jsxs("strong",{className:"ml-2",children:["C$",qo(le.total)]})]},le.vendorId))})]})]}),c?i.jsx("p",{children:"Cargando ventas..."}):i.jsxs("div",{ref:fe,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Fecha proceso"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[L.map(le=>{const Be=z(le),je=(le.processedDate||"").trim();return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${le.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:le.status})}),i.jsx("td",{className:"border p-1",children:le.productName}),i.jsx("td",{className:"border p-1",children:le.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:Gm(le.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",qo(le.amount)]}),i.jsx("td",{className:"border p-1",children:Be>0?`C$${qo(Be)}`:""}),i.jsx("td",{className:"border p-1",children:le.date}),i.jsx("td",{className:"border p-1",children:je||""}),i.jsx("td",{className:"border p-1",children:le.userEmail}),i.jsx("td",{className:"border p-1",children:le.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2 justify-center",children:ae?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>ke(le),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>Ve(le.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):le.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:ae?i.jsx("button",{onClick:()=>bt(le.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},le.id)}),L.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:10,className:"p-3 text-center text-gray-500",children:"Sin ventas para mostrar."})})]})]})}),i.jsxs("div",{className:"pdf-mobile md:hidden space-y-3 mb-4",children:[L.map(le=>{const Be=z(le),je=(le.processedDate||"").trim();return i.jsxs("details",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("summary",{className:"px-4 py-3 flex justify-between items-center cursor-pointer",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:le.productName}),i.jsxs("div",{className:"text-xs text-gray-500",children:[le.type==="CREDITO"?"Crdito":"Cash","  ",le.date]})]}),i.jsxs("div",{className:"text-right shrink-0 ml-3",children:[i.jsxs("div",{className:"font-bold",children:["C$",qo(le.amount)]}),i.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${le.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:le.status})]})]}),i.jsxs("div",{className:"px-4 pb-4 pt-2 text-sm space-y-2",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes"}),i.jsx("strong",{children:Gm(le.quantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("strong",{children:Be>0?`C$${qo(Be)}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha proceso"}),i.jsx("strong",{children:je||""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("strong",{className:"text-right break-all",children:le.userEmail})]}),i.jsx("div",{className:"pt-2",children:le.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2",children:ae?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>ke(le),className:"flex-1 text-xs bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>Ve(le.id),className:"flex-1 text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):le.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2",children:ae?i.jsx("button",{onClick:()=>bt(le.id),className:"w-full text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:"No options"})})]})]},le.id)}),L.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin ventas para mostrar."})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-2 text-sm mb-4",children:[i.jsxs("div",{children:["Total paquetes crdito: ",i.jsx("strong",{children:Gm(se)})]}),i.jsxs("div",{children:["Total paquetes cash: ",i.jsx("strong",{children:Gm(re)})]}),i.jsxs("div",{children:["Total pendiente crdito:"," ",i.jsxs("strong",{children:["C$",qo(Pe)]})]}),i.jsxs("div",{children:["Total cobrado cash: ",i.jsxs("strong",{children:["C$",qo(ue)]})]}),i.jsxs("div",{children:["Total comisin: ",i.jsxs("strong",{children:["C$",qo(we)]})]})]}),(ve>0||He!==U)&&i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm mb-6",children:[i.jsxs("div",{children:["Costo total (COGS): ",i.jsxs("strong",{children:["C$",qo(ve)]})]}),i.jsxs("div",{children:["Ganancia antes de gasto:"," ",i.jsxs("strong",{children:["C$",qo(He)]})]}),i.jsxs("div",{children:["Total paquetes (visibles):"," ",i.jsx("strong",{children:Gm(ne)})]})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Consolidado por producto"}),i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-2 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes"}),i.jsx("th",{className:"border p-2",children:"Total dinero"}),i.jsx("th",{className:"border p-2",children:"Comisin"})]})}),i.jsxs("tbody",{children:[wt.map(le=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:le.productName}),i.jsx("td",{className:"border p-1",children:Gm(le.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",qo(le.totalAmount)]}),i.jsx("td",{className:"border p-1",children:le.totalCommission>0?`C$${qo(le.totalCommission)}`:""})]},le.productName)),wt.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin datos para consolidar."})})]})]})}),i.jsxs("div",{className:"pdf-mobile md:hidden space-y-2",children:[wt.map(le=>i.jsxs("div",{className:"border rounded-xl bg-white shadow-sm p-3",children:[i.jsx("div",{className:"font-semibold",children:le.productName}),i.jsxs("div",{className:"mt-2 text-sm space-y-1",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Total paquetes"}),i.jsx("strong",{children:Gm(le.totalQuantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Total dinero"}),i.jsxs("strong",{children:["C$",qo(le.totalAmount)]})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("strong",{children:le.totalCommission>0?`C$${qo(le.totalCommission)}`:""})]})]})]},le.productName)),wt.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin datos para consolidar."})]})]}),i.jsxs("div",{className:"flex gap-2 mt-4",children:[ae&&i.jsx("button",{onClick:At,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Cerrar ventas del perodo"}),i.jsx("button",{onClick:he,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Descargar PDF"})]}),d&&i.jsx("p",{className:"mt-2 text-sm",children:d}),j&&ae&&i.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-4 space-y-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:"Editar venta de dulces"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[j.productName,"  ",j.userEmail]}),i.jsx("label",{className:"text-sm",children:"Paquetes"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:_,onChange:le=>S(parseFloat(le.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Monto cobrado"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:E,onChange:le=>F(parseFloat(le.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Cliente"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:k,onChange:le=>P(le.target.value)}),i.jsx("label",{className:"text-sm",children:"Paga con"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:D,onChange:le=>X(parseFloat(le.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Vuelto"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:pe,onChange:le=>ge(le.target.value)}),i.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[i.jsx("button",{onClick:()=>I(null),className:"px-3 py-1 border rounded",children:"Cancelar"}),i.jsx("button",{onClick:Ne,className:"px-3 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",children:"Guardar cambios"})]})]})})]})}const yh=t=>`C$ ${(Number(t)||0).toFixed(2)}`,ru=t=>Math.round((Number(t)||0)*100)/100;function kQe(t){if(!t)return"";switch(t){case"RIVAS":return"Rivas";case"SAN_JORGE":return"San Jorge";case"ISLA":return"Isla de Ometepe";default:return""}}function FQe(t){return t.toISOString().slice(0,10)}function OQe(){const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-01`}function DQe(){const t=new Date,e=new Date(t.getFullYear(),t.getMonth()+1,1),r=new Date(e.getTime()-24*60*60*1e3);return FQe(r)}function RQe(){const[t,e]=x.useState(OQe()),[r,n]=x.useState(DQe()),[a,s]=x.useState(!1),[o,l]=x.useState(""),[c,u]=x.useState({}),[d,f]=x.useState({}),[A,h]=x.useState([]),[m,p]=x.useState([]),[g,v]=x.useState({}),[y,b]=x.useState(!1),[w,j]=x.useState(null),[I,_]=x.useState(null),S=x.useMemo(()=>w&&A.find(ge=>ge.vendorId===w)||null,[w,A]),E=x.useMemo(()=>{var ge;return!w||!I?[]:((ge=g[w])==null?void 0:ge[I])||[]},[w,I,g]),F=x.useMemo(()=>ru(A.reduce((ge,fe)=>ge+(fe.totalSoldMoney||0),0)),[A]),k=x.useMemo(()=>ru(A.reduce((ge,fe)=>ge+(fe.totalCreditMoney||0),0)),[A]);x.useEffect(()=>{(async()=>{try{const ge=await Qt(_t(Fe,"sellers_candies")),fe={};ge.forEach(Se=>{const Te=Se.data(),O=Te.branch||"Rivas";let G="RIVAS";O==="San Jorge"?G="SAN_JORGE":O==="Isla Ometepe"&&(G="ISLA"),fe[Se.id]={id:Se.id,name:Te.name??"(sin nombre)",branch:G,branchLabel:O,commissionPercent:Number(Te.commissionPercent??0)}});const xe=await Qt(_t(Fe,"products_candies")),ae={};xe.forEach(Se=>{const Te=Se.data();ae[Se.id]={id:Se.id,name:Te.name??"(sin nombre)"}}),u(fe),f(ae)}catch(ge){console.error(ge),l(" Error cargando catlogos de vendedores/productos.")}})()},[]);const P=async()=>{if(!t||!r){l("Selecciona rango de fechas vlido.");return}if(!Object.keys(c).length){l("Cargando vendedores, intenta de nuevo en unos segundos.");return}s(!0),l("");try{const ge={},fe={},xe=er(_t(Fe,"inventory_candies_sellers"),cr("date",">=",t),cr("date","<=",r)),ae=await Qt(xe),Se={},Te={},O={},G={};ae.forEach(ue=>{var $e,de;const we=ue.data(),Me=we.sellerId||"";if(!Me)return;const ze=we.productId||"",yt=we.productName||(($e=d[ze])==null?void 0:$e.name)||"(sin nombre)",It=Math.max(1,Math.floor(Number(we.unitsPerPackage||1))),Ke=Number(we.totalUnits??0),wt=Number(we.packages??0),At=Number(we.remainingUnits??we.remaining??0),bt=Number(we.remainingPackages??0),ke=wt>0?wt:Ke>0?Math.floor(Ke/It):0,Ne=bt>0?bt:At>0?Math.floor(At/It):0;Se[Me]=(Se[Me]||0)+ke,Te[Me]=(Te[Me]||0)+Ne;const Ve=we.orderId||we.vendorOrderId||we.orderNumber||we.order||ue.id;O[Me]||(O[Me]=new Set),O[Me].add(Ve);const he=((de=c[Me])==null?void 0:de.name)||we.sellerName||"(sin vendedor)",le=String(we.date||""),Be=Number(we.totalVendor??0),je=Number(we.gainVendor??0),Ae=wt>0?wt:Ke>0?Math.floor(Ke/It):0,Qe=Ae>0?Be/Ae:0,Ct=Ae>0?je/Ae:0,pt=ru(ke*Qe),me=ru(ke*Ct),te=ru(Ne*Qe),ie=ru(Ne*Ct);G[Me]||(G[Me]={ordered:[],remaining:[]}),ke>0&&G[Me].ordered.push({date:le,vendorName:he,productName:yt,packages:ke,totalMoney:pt,vendorCommission:me}),Ne>0&&G[Me].remaining.push({date:le,vendorName:he,productName:yt,packages:Ne,totalMoney:te,vendorCommission:ie})});const z={};Object.keys(O).forEach(ue=>{z[ue]=O[ue].size});const L=er(_t(Fe,"sales_candies"),cr("date",">=",t),cr("date","<=",r)),Z=await Qt(L),ee={},R={},H={},ne={},ve={},U={};Z.forEach(ue=>{const we=ue.data(),Me=we.date||"",ze=we.vendorId||we.sellerId||"";if(!ze)return;const yt=c[ze],It=we.vendorName||(yt==null?void 0:yt.name)||"(sin vendedor)",Ke=Number(we.vendorCommissionPercent??(yt==null?void 0:yt.commissionPercent)??0)||0,wt=Array.isArray(we.items)?we.items:[];if(!wt.length)return;const At=String(we.type||"").toUpperCase()==="CREDITO";ve[ze]||(ve[ze]={sold:[],credit:[]}),wt.forEach(bt=>{var pt;const ke=bt.productName||((pt=d[bt.productId||""])==null?void 0:pt.name)||"(sin nombre)",Ne=bt.packages??bt.qty??bt.quantity??0,Ve=Number(Ne||0);if(Ve<=0)return;const he=Number(bt.unitPricePackage??bt.unitPrice??0)||0,le=Math.max(0,Number(bt.discount||0)),Be=Ve*he,je=ru(Math.max(0,Be-le));if(je<=0)return;console.log("DBG",{isCredit:At,vendorId:ze,commissionPercent:Ke,lineFinal:je,storedItemCommission:Number(bt.vendorCommissionAmount??0)});let Ae=0;const Qe=Number(bt.vendorCommissionAmount??0);Qe?Ae=ru(Qe):Ke>0&&(Ae=ru(je*Ke/100)),At?(R[ze]=(R[ze]||0)+Ve,ne[ze]=(ne[ze]||0)+je):(ee[ze]=(ee[ze]||0)+Ve,H[ze]=(H[ze]||0)+je),At?fe[ze]=(fe[ze]||0)+Ae:ge[ze]=(ge[ze]||0)+Ae,At?ve[ze].credit.push({date:Me,vendorName:It,productName:ke,packages:Ve,totalMoney:je,vendorCommission:0}):ve[ze].sold.push({date:Me,vendorName:It,productName:ke,packages:Ve,totalMoney:je,vendorCommission:Ae});const Ct=ke;U[Ct]||(U[Ct]={productName:ke,packages:0,totalMoney:0}),U[Ct].packages+=Ve,U[Ct].totalMoney+=je})});const He=new Set([...Object.keys(Se),...Object.keys(Te),...Object.keys(ee),...Object.keys(R)]),se=[],re={};He.forEach(ue=>{var Ne,Ve,he,le;const we=c[ue],Me=(we==null?void 0:we.name)||"(sin vendedor)",ze=we?we.branchLabel||kQe(we.branch):"",yt=Se[ue]||0,It=Te[ue]||0,Ke=ee[ue]||0,wt=R[ue]||0,At=ru(H[ue]||0),bt=ru(ne[ue]||0),ke=z[ue]||0;se.push({vendorId:ue,vendorName:Me,branchLabel:ze,orderedPackages:yt,remainingPackages:It,soldPackages:Ke,creditPackages:wt,totalSoldMoney:At,totalCreditMoney:bt,ordersCreated:ke,commissionCash:ru(ge[ue]||0),commissionCredit:0}),re[ue]={ordered:(((Ne=G[ue])==null?void 0:Ne.ordered)||[]).sort((Be,je)=>Be.date.localeCompare(je.date)),remaining:(((Ve=G[ue])==null?void 0:Ve.remaining)||[]).sort((Be,je)=>Be.date.localeCompare(je.date)),sold:(((he=ve[ue])==null?void 0:he.sold)||[]).sort((Be,je)=>Be.date.localeCompare(je.date)),credit:(((le=ve[ue])==null?void 0:le.credit)||[]).sort((Be,je)=>Be.date.localeCompare(je.date))}}),se.sort((ue,we)=>ue.vendorName.localeCompare(we.vendorName,"es")),h(se),v(re);const Pe=Object.values(U).map(ue=>({productName:ue.productName,packages:ue.packages,totalMoney:ru(ue.totalMoney)})).sort((ue,we)=>we.packages-ue.packages).slice(0,10);p(Pe),se.length||l("Sin datos para el rango seleccionado.")}catch(ge){console.error(ge),l(" Error cargando consolidado de vendedores.")}finally{s(!1)}};x.useEffect(()=>{Object.keys(c).length&&P()},[c]);const D=(ge,fe)=>{j(ge),_(fe),b(!0)},X=()=>{b(!1),j(null),_(null)},pe=()=>{if(!A.length){l("No hay datos para exportar.");return}const ge=["Vendedor","Sucursal","Paquetes ordenados","Paquetes restantes","Paquetes vendidos","Paquetes fiados","Total vendidos (C$)","Comisin Cash (C$)","Total fiado (C$)","Comisin Crdito (C$)","rdenes creadas"],fe=A.map(O=>[O.vendorName,O.branchLabel,O.orderedPackages.toString(),O.remainingPackages.toString(),O.soldPackages.toString(),O.creditPackages.toString(),O.totalSoldMoney.toFixed(2),O.commissionCash.toFixed(2),O.totalCreditMoney.toFixed(2),O.commissionCredit.toFixed(2),O.ordersCreated.toString()]),xe=[ge,...fe].map(O=>O.map(G=>`"${String(G).replace(/"/g,'""')}"`).join(",")).join(`
`),ae=new Blob([xe],{type:"text/csv;charset=utf-8;"}),Se=URL.createObjectURL(ae),Te=document.createElement("a");Te.href=Se,Te.download=`consolidado_vendedores_dulces_${t}_a_${r}.csv`,Te.click(),URL.revokeObjectURL(Se)};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Consolidado por Vendedor - Dulces"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:t,onChange:ge=>e(ge.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:r,onChange:ge=>n(ge.target.value)})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{type:"button",onClick:P,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",disabled:a,children:a?"Cargando...":"Aplicar filtros"})}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{type:"button",onClick:pe,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 w-full",children:"Exportar CSV"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 text-sm",children:[i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:yh(F)})]}),i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas Credito"}),i.jsx("div",{className:"text-xl font-semibold",children:yh(k)})]}),i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Vendedores con Inventario"}),i.jsx("div",{className:"text-xl font-semibold",children:A.length})]})]}),i.jsx("div",{className:"overflow-x-auto mb-6",children:i.jsxs("table",{className:"min-w-full border text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes ordenados"}),i.jsx("th",{className:"border p-2",children:"Paquetes restantes"}),i.jsx("th",{className:"border p-2",children:"Paquetes vendidos"}),i.jsx("th",{className:"border p-2",children:"Paquetes fiados"}),i.jsx("th",{className:"border p-2",children:"Total vendidos (C$)"}),i.jsx("th",{className:"border p-2",children:"Comisin Cash (C$)"}),i.jsx("th",{className:"border p-2",children:"Total fiado (C$)"}),i.jsx("th",{className:"border p-2",children:"Comisin Crdito (C$)"}),i.jsx("th",{className:"border p-2",children:"rdenes creadas"})]})}),i.jsxs("tbody",{children:[A.map(ge=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ge.vendorName}),i.jsx("td",{className:"border p-1",children:ge.branchLabel}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>D(ge.vendorId,"ordered"),children:ge.orderedPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>D(ge.vendorId,"remaining"),children:ge.remainingPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>D(ge.vendorId,"sold"),children:ge.soldPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>D(ge.vendorId,"credit"),children:ge.creditPackages})}),i.jsx("td",{className:"border p-1",children:yh(ge.totalSoldMoney)}),i.jsx("td",{className:"border p-1",children:yh(ge.commissionCash)}),i.jsx("td",{className:"border p-1",children:yh(ge.totalCreditMoney)}),i.jsx("td",{className:"border p-1",children:yh(ge.commissionCredit)}),i.jsx("td",{className:"border p-1",children:ge.ordersCreated})]},ge.vendorId)),A.length===0&&!a&&i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-3 text-center text-gray-500",children:"Sin datos para mostrar."})})]})]})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"font-semibold mb-2 text-sm",children:"Top 10 productos ms vendidos (paquetes)"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-xs shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"#"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Paquetes vendidos"}),i.jsx("th",{className:"border p-2",children:"Total dinero (C$)"})]})}),i.jsxs("tbody",{children:[m.map((ge,fe)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:fe+1}),i.jsx("td",{className:"border p-1",children:ge.productName}),i.jsx("td",{className:"border p-1",children:ge.packages}),i.jsx("td",{className:"border p-1",children:yh(ge.totalMoney)})]},ge.productName)),m.length===0&&!a&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin productos para mostrar."})})]})]})})]}),o&&i.jsx("p",{className:"mt-2 text-sm text-gray-700",children:o}),y&&I&&w&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-[95%] max-w-4xl max-h-[90vh] flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"font-semibold text-lg",children:["Detalle"," ",I==="ordered"?"Paquetes ordenados":I==="remaining"?"Paquetes restantes":I==="sold"?"Paquetes vendidos":"Paquetes fiados"]}),i.jsxs("p",{className:"text-xs text-gray-500",children:[S==null?void 0:S.vendorName,"  ",S==null?void 0:S.branchLabel]})]}),i.jsx("button",{onClick:X,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 text-sm",children:"Cerrar"})]}),i.jsx("div",{className:"flex-1 overflow-auto p-4",children:i.jsxs("table",{className:"min-w-full border text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Total dinero (C$)"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Comisin vendedor (C$)"})]})}),i.jsxs("tbody",{children:[E.map((ge,fe)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ge.date}),i.jsx("td",{className:"border p-1",children:ge.productName}),i.jsx("td",{className:"border p-1",children:ge.packages}),i.jsx("td",{className:"border p-1",children:yh(ge.totalMoney)}),i.jsx("td",{className:"border p-1",children:ge.vendorName}),i.jsx("td",{className:"border p-1",children:yh(ge.vendorCommission)})]},fe)),E.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-3 text-center text-gray-500",children:"Sin registros para mostrar."})})]})]})})]})})]})}const El=t=>`C$${Number(t||0).toFixed(2)}`,t_=t=>Number(t||0).toFixed(3),q5=()=>{const t=new Date;return Nr(new Date(t.getFullYear(),t.getMonth(),1),"yyyy-MM-dd")},r_=()=>Nr(new Date,"yyyy-MM-dd");function MQe({transactions:t=[],onClose:e,onCreated:r}){const n=Array.isArray(t)?t:[],[a,s]=x.useState([]),o=x.useMemo(()=>{const me={};return a.forEach(te=>{te.email&&(me[te.email.trim().toLowerCase()]=te)}),me},[a]);x.useEffect(()=>{(async()=>{try{const me=er(_t(Fe,"sellers_candies"),dn("name","asc")),te=await Qt(me),ie=[];te.forEach($e=>{const de=$e.data();ie.push({id:$e.id,name:de.name||"",email:de.email||"",commissionPercent:Number(de.commissionPercent||0)})}),s(ie)}catch(me){console.error(me)}})()},[]);const[l,c]=x.useState(q5()),[u,d]=x.useState(r_()),[f,A]=x.useState(""),[h,m]=x.useState(""),p=x.useMemo(()=>{const me=new Map;return n.forEach(te=>{const ie=te.productId||te.productName;me.set(ie,{key:ie,name:te.productName})}),Array.from(me.values()).sort((te,ie)=>te.name.localeCompare(ie.name))},[n]),g=x.useMemo(()=>{const me=new Map;return n.forEach(te=>{const ie=(te.sellerEmail||"").trim().toLowerCase();if(!ie)return;const $e=o[ie],de=($e==null?void 0:$e.name)||te.vendorName||ie;me.set(ie,{email:ie,label:de})}),Array.from(me.values()).sort((te,ie)=>te.label.localeCompare(ie.label))},[n,o]),v=x.useMemo(()=>n.filter(me=>!(l&&me.date<l||u&&me.date>u||f&&(me.productId||me.productName)!==f||h&&(me.sellerEmail||"").trim().toLowerCase()!==h)),[n,l,u,f,h]),[y,b]=x.useState(r_()),[w,j]=x.useState(()=>`FAC-CANDY-${Date.now().toString().slice(-6)}`),[I,_]=x.useState(""),[S,E]=x.useState("0"),[F,k]=x.useState(()=>v.map(me=>me.id));x.useEffect(()=>{k(me=>me.filter(te=>v.some(ie=>ie.id===te)))},[v]);const[P,D]=x.useState([]),[X,pe]=x.useState([]),[ge,fe]=x.useState(!1),[xe,ae]=x.useState(q5()),[Se,Te]=x.useState(r_());x.useEffect(()=>{(async()=>{try{fe(!0);const me=er(_t(Fe,"expensesCandies"),dn("date","desc")),te=await Qt(me),ie=[];te.forEach($e=>{const de=$e.data();ie.push({id:$e.id,date:de.date,description:de.description,amount:Number(de.amount||0)})}),D(ie)}catch(me){console.error(me)}finally{fe(!1)}})()},[]);const O=x.useMemo(()=>P.filter(me=>!(!me.date||xe&&me.date<xe||Se&&me.date>Se)),[P,xe,Se]),[G,z]=x.useState([]),[L,Z]=x.useState(!1),[ee,R]=x.useState(""),[H,ne]=x.useState("DEBITO"),[ve,U]=x.useState(""),He=()=>{const me=Number(ve);!ee.trim()||!isFinite(me)||me<=0||(z(te=>[...te,{id:`${Date.now()}_${te.length+1}`,description:ee.trim(),type:H,amount:Number(me.toFixed(2))}]),R(""),U(""))},[se,re]=x.useState(null),[Pe,ue]=x.useState(""),[we,Me]=x.useState("DEBITO"),[ze,yt]=x.useState(""),It=me=>{re(me.id),ue(me.description),Me(me.type),yt(me.amount.toFixed(2))},Ke=()=>{re(null),ue(""),Me("DEBITO"),yt("")},wt=()=>{if(!se)return;const me=Number(ze);!isFinite(me)||me<=0||(z(te=>te.map(ie=>ie.id===se?{...ie,description:Pe.trim(),type:we,amount:Number(me.toFixed(2))}:ie)),Ke())},At=me=>{z(te=>te.filter(ie=>ie.id!==me)),se===me&&Ke()},bt=(me,te)=>{k(ie=>te?[...new Set([...ie,me])]:ie.filter($e=>$e!==me))},ke=me=>{k(me?v.map(te=>te.id):[])},Ne=(me,te)=>{pe(ie=>te?[...new Set([...ie,me])]:ie.filter($e=>$e!==me))},Ve=x.useMemo(()=>v.filter(me=>F.includes(me.id)),[v,F]),he=x.useMemo(()=>G.filter(me=>me.type==="DEBITO").reduce((me,te)=>me+te.amount,0),[G]),le=x.useMemo(()=>G.filter(me=>me.type==="CREDITO").reduce((me,te)=>me+te.amount,0),[G]),Be=x.useMemo(()=>{let me=0,te=0,ie=0,$e=0;for(const xt of Ve){const Xe=Number(xt.packages||0),be=Number(xt.cogsAmount||0),st=Number(xt.amount||0);me+=Xe,te+=be,ie+=st;const K=(xt.sellerEmail||"").trim().toLowerCase(),Ie=o[K],Ze=Number((Ie==null?void 0:Ie.commissionPercent)||0),at=st*Ze/100;$e+=at}const de=O.filter(xt=>X.includes(xt.id)).reduce((xt,Xe)=>xt+Number(Xe.amount||0),0),Ce=ie-te,nt=ie-de-he+le-$e,vt=Number(S||0),ht=ie*vt/100;return{totalPackages:Number(t_(me)),totalProvider:Number(te.toFixed(2)),totalSale:Number(ie.toFixed(2)),totalGastos:Number(de.toFixed(2)),debits:Number(he.toFixed(2)),credits:Number(le.toFixed(2)),grossProfit:Number(Ce.toFixed(2)),finalAmount:Number(nt.toFixed(2)),totalCommissionVendors:Number($e.toFixed(2)),branchProfit:Number(ht.toFixed(2)),branchFactor:vt}},[Ve,O,X,he,le,o,S]),[je,Ae]=x.useState(!1),[Qe,Ct]=x.useState(""),pt=async()=>{if(Ct(""),Ve.length===0){Ct("Selecciona al menos 1 transaccin procesada.");return}try{Ae(!0);const me={number:w.trim(),date:y,description:I.trim(),status:"PENDIENTE",createdAt:dr.now(),totalPackages:Be.totalPackages,totalProvider:Be.totalProvider,totalSale:Be.totalSale,totalExpenses:Be.totalGastos,totalDebits:Be.debits,totalCredits:Be.credits,grossProfit:Be.grossProfit,totalCommissionVendors:Be.totalCommissionVendors,branchFactorPercent:Be.branchFactor,branchProfit:Be.branchProfit,finalAmount:Be.finalAmount,transactions:Ve.map(te=>{const ie=Number(te.packages||0)||1,$e=Number(te.cogsAmount||0),de=Number(te.amount||0),Ce=$e/ie,nt=de/ie,vt=(te.sellerEmail||"").trim().toLowerCase(),ht=o[vt],xt=Number((ht==null?void 0:ht.commissionPercent)||0),Xe=de*xt/100;return{id:te.id,date:te.date,productId:te.productId||null,productName:te.productName,vendorName:te.vendorName,sellerEmail:te.sellerEmail||null,packages:Number(t_(te.packages)),providerPricePack:Number(Ce.toFixed(4)),salePricePack:Number(nt.toFixed(4)),totalProvider:Number($e.toFixed(2)),totalSale:Number(de.toFixed(2)),commissionPercent:xt,commissionAmount:Number(Xe.toFixed(2))}}),expenses:O.filter(te=>X.includes(te.id)).map(te=>({id:te.id,date:te.date||null,description:te.description||"",amount:Number(Number(te.amount||0).toFixed(2))})),adjustments:G.map(te=>({id:te.id,description:te.description,type:te.type,amount:Number(te.amount.toFixed(2))}))};await On(_t(Fe,"invoicesCandies"),me),Ct(" Factura de dulces creada."),r()}catch(me){console.error(me),Ct(` Error al crear factura: ${(me==null?void 0:me.message)||"desconocido"}`)}finally{Ae(!1)}};return i.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:[i.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-xl shadow-xl p-4 md:p-6 max-h-[90vh] overflow-auto relative",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Crear factura CandyShop"}),i.jsx("button",{onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:y,onChange:me=>b(me.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Nmero"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:w,onChange:me=>j(me.target.value),placeholder:"FAC-CANDY-001"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Factor sucursal (%)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:S,onChange:me=>E(me.target.value),placeholder:"Ej: 30"}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Se aplica sobre el total de ventas para calcular la ganancia de sucursal."})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Descripcin"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:I,onChange:me=>_(me.target.value),placeholder:"Comentarios de la factura"})]})]}),i.jsx("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:i.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Desde (transaccin)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:l,onChange:me=>c(me.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Hasta (transaccin)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:me=>d(me.target.value)})]}),i.jsxs("div",{className:"min-w-[180px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:f,onChange:me=>A(me.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),p.map(me=>i.jsx("option",{value:me.key,children:me.name},me.key))]})]}),i.jsxs("div",{className:"min-w-[180px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:h,onChange:me=>m(me.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),g.map(me=>i.jsx("option",{value:me.email,children:me.label},me.email))]})]}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{c(q5()),d(r_()),A(""),m("")},children:"Quitar filtro"})]})}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Transacciones procesadas"}),i.jsxs("label",{className:"text-sm flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:v.length>0&&F.length===v.length,onChange:me=>ke(me.target.checked)}),"Seleccionar todas (sobre el filtro)"]})]}),v.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay transacciones procesadas en el filtro actual."}):i.jsx("div",{className:"border rounded max-h-80 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total proveedor"}),i.jsx("th",{className:"p-2 border",children:"Total venta"}),i.jsx("th",{className:"p-2 border",children:"Comisin venta"})]})}),i.jsx("tbody",{children:v.map(me=>{const te=F.includes(me.id),ie=Number(me.packages||0)||1,$e=Number(me.cogsAmount||0),de=Number(me.amount||0),Ce=$e/ie,nt=de/ie,vt=(me.sellerEmail||"").trim().toLowerCase(),ht=o[vt],xt=Number((ht==null?void 0:ht.commissionPercent)||0),Xe=de*xt/100;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:te,onChange:be=>bt(me.id,be.target.checked)})}),i.jsx("td",{className:"p-2 border",children:me.date}),i.jsx("td",{className:"p-2 border",children:(ht==null?void 0:ht.name)||me.vendorName}),i.jsx("td",{className:"p-2 border",children:me.productName}),i.jsx("td",{className:"p-2 border",children:t_(me.packages)}),i.jsx("td",{className:"p-2 border",children:El(Ce)}),i.jsx("td",{className:"p-2 border",children:El(nt)}),i.jsx("td",{className:"p-2 border",children:El($e)}),i.jsx("td",{className:"p-2 border",children:El(de)}),i.jsx("td",{className:"p-2 border",children:xt>0?`${El(Xe)} (${xt.toFixed(2)}%)`:""})]},me.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Gastos a incluir (opcional)"}),ge&&i.jsx("span",{className:"text-xs text-gray-500",children:"Cargando"}),i.jsxs("div",{className:"ml-auto flex items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:xe,onChange:me=>ae(me.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:Se,onChange:me=>Te(me.target.value)})]})]})]}),O.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay gastos en el rango seleccionado."}):i.jsx("div",{className:"border rounded max-h-48 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:O.map(me=>{const te=X.includes(me.id);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:te,onChange:ie=>Ne(me.id,ie.target.checked)})}),i.jsx("td",{className:"p-2 border",children:me.date||""}),i.jsx("td",{className:"p-2 border",children:me.description||""}),i.jsx("td",{className:"p-2 border",children:El(Number(me.amount||0))})]},me.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Notas Crdito/Dbito (Cargos extras)"}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>Z(!0),children:"Crear Cargo"})]}),G.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cargos agregados."}):i.jsx("div",{className:"border rounded max-h-40 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:G.map(me=>{const te=se===me.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:te?i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[70px]",value:Pe,onChange:ie=>ue(ie.target.value)}):i.jsx("span",{title:me.description,children:me.description.length>60?`${me.description.slice(0,60)}`:me.description})}),i.jsx("td",{className:"p-2 border",children:te?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:we,onChange:ie=>Me(ie.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${me.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:me.type})}),i.jsx("td",{className:"p-2 border",children:te?i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1 text-right",value:ze,onChange:ie=>yt(ie.target.value)}):El(me.amount)}),i.jsx("td",{className:"p-2 border",children:te?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:wt,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:Ke,children:"Cancelar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>At(me.id),children:"Eliminar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 text-xs",onClick:()=>It(me),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>At(me.id),children:"Eliminar"})]})})]},me.id)})})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-4 justify-between",children:[i.jsx("div",{className:"space-y-1",children:i.jsxs("div",{children:["Total paquetes: ",i.jsx("strong",{children:t_(Be.totalPackages)})]})}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Total proveedor (costo):"," ",i.jsx("strong",{children:El(Be.totalProvider)})]}),i.jsxs("div",{children:["Total venta: ",i.jsx("strong",{children:El(Be.totalSale)})]}),i.jsxs("div",{children:["Ganancia bruta (venta  costo):"," ",i.jsx("strong",{children:El(Be.grossProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:El(Be.totalGastos)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:El(Be.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:El(Be.credits)})]}),i.jsxs("div",{children:["Comisin total vendedores:"," ",i.jsx("strong",{children:El(Be.totalCommissionVendors)})]}),i.jsxs("div",{children:["Ganancia sucursal (ventas  factor):"," ",i.jsx("strong",{children:El(Be.branchProfit)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded text-center font-semibold text-lg",children:["Monto final (ventas  gastos  dbitos + crditos  comisin vendedores):"," ",i.jsx("span",{className:"text-blue-700",children:El(Be.finalAmount)})]})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{disabled:je,onClick:pt,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",children:je?"Creando":"Crear factura"}),i.jsx("button",{onClick:e,className:"px-4 py-2 border rounded",children:"Cancelar"}),Qe&&i.jsx("span",{className:"text-sm ml-2",children:Qe})]}),je&&i.jsxs("div",{className:"absolute inset-0 z-[11000] bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Creando factura"})]})]}),L&&i.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg_WHITE w-full max-w-lg rounded-xl shadow-xl p-4",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx("h4",{className:"font-semibold",children:"Nuevo cargo"}),i.jsx("button",{className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",onClick:()=>Z(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[90px]",value:ee,onChange:me=>R(me.target.value),placeholder:"Detalle del cargo"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Tipo de cargo"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:H,onChange:me=>ne(me.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:ve,onChange:me=>U(me.target.value),placeholder:"0.00"})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:He,children:"Agregar"})})]})]})})]})}const Ia=t=>`C$ ${Number(t??0).toFixed(2)}`,n_=t=>Number(t??0).toFixed(3);function z5(t){const e=t.transactions||[];let r=Number(t.totalPackages??0),n=Number(t.totalProvider??0),a=Number(t.totalSale??0),s=Number(t.totalCommissionVendors??0);if(e.length>0&&(a===0||r===0)){r=0,n=0,a=0,s=0;for(const v of e){const y=Number(v.packages??0);r+=y,n+=Number(v.totalProvider??y*(v.providerPricePack??0)),a+=Number(v.totalSale??y*(v.salePricePack??0));const b=v.commissionAmount??Number(v.totalSale??0)*Number(v.commissionPercent??0)/100;s+=Number(b||0)}}const o=t.expenses||[],l=t.adjustments||[],c=t.totalExpenses!==void 0?Number(t.totalExpenses):o.reduce((v,y)=>v+Number(y.amount||0),0),u=l.filter(v=>v.type==="DEBITO").reduce((v,y)=>v+Number(y.amount||0),0),d=l.filter(v=>v.type==="CREDITO").reduce((v,y)=>v+Number(y.amount||0),0),f=t.totalDebits!==void 0?Number(t.totalDebits):u,A=t.totalCredits!==void 0?Number(t.totalCredits):d,h=a-n,m=Number(t.branchFactorPercent??0),p=t.branchProfit!==void 0?Number(t.branchProfit):Number((h*m/100).toFixed(2)),g=t.finalAmount!==void 0?Number(t.finalAmount):a-s-c-f+A;return{totalPackages:r,totalProvider:n,totalSale:a,commissionTotal:s,expenses:c,debits:f,credits:A,grossProfit:h,branchProfit:p,finalAmount:g}}function aG(t){const e=t.transactions||[];if(e.length===0)return"";const r=Array.from(new Set(e.map(n=>n.vendorName||"Sin nombre")));return r.length===1?r[0]:"Varios"}function LQe(){const[t,e]=x.useState([]),[r,n]=x.useState(!0),[a,s]=x.useState(null),o=x.useRef(null),[l,c]=x.useState(!1),u=async()=>{n(!0);const h=er(_t(Fe,"invoicesCandies"),dn("date","desc")),m=await Qt(h),p=[];m.forEach(g=>{const v=g.data();p.push({id:g.id,date:v.date,number:v.number,description:v.description,status:v.status||"PENDIENTE",totalPackages:v.totalPackages||0,totalProvider:v.totalProvider||0,totalSale:v.totalSale||0,totalExpenses:v.totalExpenses||0,totalDebits:v.totalDebits||0,totalCredits:v.totalCredits||0,totalCommissionVendors:v.totalCommissionVendors||0,finalAmount:v.finalAmount||0,branchFactorPercent:v.branchFactorPercent||0,branchProfit:v.branchProfit||0,transactions:(v.transactions||[]).map(y=>({id:y.id,date:y.date,vendorId:y.vendorId||null,vendorName:y.vendorName||"Sin nombre",sellerEmail:y.sellerEmail||null,productId:y.productId,productName:y.productName||"Sin nombre",packages:Number(y.packages||0),providerPricePack:Number(y.providerPricePack||0),salePricePack:Number(y.salePricePack||0),totalProvider:Number(y.totalProvider||0),totalSale:Number(y.totalSale||0),commissionPercent:Number(y.commissionPercent||0),commissionAmount:Number(y.commissionAmount||0)})),expenses:(v.expenses||[]).map(y=>({id:y.id,description:y.description||"",date:y.date||null,amount:Number(y.amount||0)})),adjustments:(v.adjustments||[]).map(y=>({id:y.id,description:y.description||"",type:y.type||"DEBITO",amount:Number(y.amount||0)}))})}),e(p),n(!1)};x.useEffect(()=>{u()},[]);const d=async h=>{const m=h.status==="PAGADA"?"PENDIENTE":"PAGADA";await pn(Yt(Fe,"invoicesCandies",h.id),{status:m}),e(p=>p.map(g=>g.id===h.id?{...g,status:m}:g)),(a==null?void 0:a.id)===h.id&&s({...h,status:m})},f=async h=>{if(window.confirm(`Eliminar factura del ${h.date}?`))try{await Fn(Yt(Fe,"invoicesCandies",h.id)),e(m=>m.filter(p=>p.id!==h.id)),(a==null?void 0:a.id)===h.id&&s(null)}catch(m){console.error(m),alert("No se pudo eliminar la factura.")}},A=async()=>{if(!o.current||!a)return;const h=o.current,m=await Cg(h,{backgroundColor:"#ffffff",onclone:b=>{const w=b.body;w.style.background="#ffffff",w.querySelectorAll("*").forEach(j=>{const I=b.defaultView.getComputedStyle(j);I.boxShadow&&I.boxShadow!=="none"&&(j.style.boxShadow="none")})},scale:2}),p=m.toDataURL("image/png"),g=new Rr("p","mm","a4"),v=g.internal.pageSize.getWidth(),y=m.height*v/m.width;g.addImage(p,"PNG",0,0,v,y),g.save(`factura_candy_${a.number||a.date}.pdf`)};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded shadow",children:[i.jsxs("div",{className:"flex items-center mb-4 gap-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Facturacin CandyShop"}),i.jsx("button",{className:"ml-auto bg-blue-600 text-white px-4 py-2 rounded-2xl hover:bg-blue-700 text-sm",onClick:()=>c(!0),children:"Crear factura Candy"})]}),l&&i.jsx(MQe,{onClose:()=>c(!1),onCreated:()=>{c(!1),u()}}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"N factura"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Sub total (sin gastos/ajustes)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Gastos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Dbitos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Crditos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Estado"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):t.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin facturas"})}):t.map(h=>{const m=z5(h),p=aG(h);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.number||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:p}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ia(m.commissionTotal)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:n_(m.totalPackages)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ia(m.totalSale)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ia(m.expenses)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ia(m.debits)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ia(m.credits)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ia(m.finalAmount)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h.status==="PAGADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:h.status})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",onClick:()=>s(h),children:"Ver"}),i.jsx("button",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",onClick:()=>d(h),children:h.status==="PAGADA"?"Marcar PENDIENTE":"Marcar PAGADA"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>f(h),children:"Eliminar"})]})})]},h.id)})})]})}),a&&i.jsxs("div",{ref:o,className:"bg-white p-4 rounded shadow-2xl",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsxs("h3",{className:"text-lg font-semibold",children:["Detalle ",a.date," ",a.number?` ${a.number}`:""]}),i.jsx("button",{className:"ml-auto px-3 py-1 border rounded",onClick:()=>s(null),children:"Cerrar"}),i.jsx("button",{onClick:A,className:"bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Imprimir PDF"})]}),(()=>{const h=z5(a),m=aG(a);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Estado:"})," ",a.status]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Vendedor:"})," ",m]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes:"})," ",n_(h.totalPackages)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total proveedor:"})," ",Ia(h.totalProvider)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Sub total ventas:"})," ",Ia(h.totalSale)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia bruta:"})," ",Ia(h.grossProfit)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Comisin vendedores:"})," ",Ia(h.commissionTotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Gastos:"})," ",Ia(h.expenses)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Dbitos:"})," ",Ia(h.debits)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Crditos:"})," ",Ia(h.credits)]})]})]})})(),i.jsx("h4",{className:"font-semibold mb-1",children:"Transacciones"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total venta"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin venta"})]})}),i.jsx("tbody",{children:(a.transactions||[]).length>0?(a.transactions||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.productName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:n_(h.packages)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ia(h.providerPricePack)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ia(h.salePricePack)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ia(h.totalProvider)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ia(h.totalSale)}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:[Ia(h.commissionAmount||0),h.commissionPercent?` (${h.commissionPercent.toFixed(2)}%)`:""]})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin transacciones"})})})]})}),i.jsx("h4",{className:"font-semibold mb-1",children:"Gastos"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descripcin"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"})]})}),i.jsx("tbody",{children:(a.expenses||[]).length>0?(a.expenses||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.description||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ia(h.amount)})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin gastos"})})})]})}),i.jsx("h4",{className:"font-semibold mb-1",children:"Cargos extras (Notas crdito/dbito)"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descripcin"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo de cargo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"})]})}),i.jsx("tbody",{children:(a.adjustments||[]).length>0?(a.adjustments||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.description}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:h.type})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ia(h.amount)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:a.date})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin cargos extras"})})})]})}),(()=>{const h=z5(a);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-2 justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:["Total paquetes: ",i.jsx("strong",{children:n_(h.totalPackages)})]}),i.jsxs("div",{children:["Total proveedor: ",i.jsx("strong",{children:Ia(h.totalProvider)})]})]}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Sub total ventas: ",i.jsx("strong",{children:Ia(h.totalSale)})]}),i.jsxs("div",{children:["Ganancia bruta: ",i.jsx("strong",{children:Ia(h.grossProfit)})]}),i.jsxs("div",{children:["Ganancia sucursal: ",i.jsx("strong",{children:Ia(h.branchProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Comisin vendedores:"," ",i.jsx("strong",{children:Ia(h.commissionTotal)})]}),i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:Ia(h.expenses)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:Ia(h.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:Ia(h.credits)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-4 text-center",children:[i.jsx("span",{className:"block text-lg font-semibold text-gray-800",children:"Total (sub total  comisin  gastos  dbitos + crditos):"}),i.jsx("span",{className:"block text-2xl font-bold text-blue-700 mt-1",children:Ia(h.finalAmount)})]})})]})})()]})]})}const ws=t=>Math.round((Number(t)||0)*100)/100,l0=t=>Math.round((Number(t)||0)*1e3)/1e3,Ji=t=>Number(t??0).toFixed(2),bh=t=>Number(t??0).toFixed(3),UQe=(t,e)=>{var A;const r=t.date??((A=t.timestamp)!=null&&A.toDate?Nr(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=t.userEmail??"",a=t.vendorName||t.vendor||n||t.vendorId||"(sin vendedor)",s=t.type||"CONTADO",o=t.vendorId,l=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,c=Number(t.vendorCommissionAmount??0)||0;if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((h,m)=>{const p=Number((h==null?void 0:h.packages)??(h==null?void 0:h.qty)??(h==null?void 0:h.quantity)??0),g=Number((h==null?void 0:h.lineFinal)??0)||Math.max(0,Number((h==null?void 0:h.unitPricePackage)||(h==null?void 0:h.unitPrice)||0)*p-Number((h==null?void 0:h.discount)||0));let v=0;return c>0&&l>0&&Number(g||0)>0&&(v=ws(c*Number(g||0)/l)),{id:`${e}#${m}`,productName:String((h==null?void 0:h.productName)??"(sin nombre)"),quantity:p,amount:ws(g),date:r,type:s,vendorId:o,userEmail:a,vendorCommissionAmount:v}});const u=Number(t.packagesTotal??t.quantity??0),d=Number(t.amount??t.amountCharged??t.total??0)||0,f=ws(Number(t.vendorCommissionAmount??0)||0);return[{id:e,productName:String((t==null?void 0:t.productName)??"(sin nombre)"),quantity:u,amount:ws(d),date:r,type:s,vendorId:o,userEmail:a,vendorCommissionAmount:f}]};function QQe({role:t,roles:e,currentUserEmail:r,sellerCandyId:n}){const a=e&&e.length?e:t,s=!a||sn(a,"admin"),o="daily_closures_candies",l="sales_candies",c="sellers_candies",[u,d]=x.useState(Nr(Eee(new Date),"yyyy-MM-dd")),[f,A]=x.useState(Nr(new Date,"yyyy-MM-dd")),[h,m]=x.useState(!0),[p,g]=x.useState([]),[v,y]=x.useState(null),[b,w]=x.useState(""),[j,I]=x.useState([]),[_,S]=x.useState("ALL"),[E,F]=x.useState({}),k=x.useRef(null);if(!s)return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Liquidaciones"}),i.jsx("p",{className:"text-sm text-red-600",children:"Acceso denegado: solo admin."})]});const P=async()=>{try{const ee=await Qt(_t(Fe,c)),R=[];ee.forEach(H=>{const ne=H.data();R.push({id:H.id,name:ne.name||"",commissionPercent:Number(ne.commissionPercent||0)})}),I(R)}catch(ee){console.error("Error cargando sellers_candies",ee)}},D=async()=>{const ee=performance.now();try{m(!0);const R=er(_t(Fe,o),cr("date",">=",u),cr("date","<=",f)),H=await Qt(R),ne=performance.now();console.log(" getDocs ms:",(ne-ee).toFixed(1),"docs:",H.size);const ve=[];H.forEach(re=>ve.push({id:re.id,...re.data()}));const U=performance.now();console.log(" parse+set ms:",(U-ne).toFixed(1),"rows:",ve.length),ve.sort((re,Pe)=>re.date<Pe.date?1:re.date>Pe.date?-1:0),g(ve),y(null);const He=new Set;ve.forEach(re=>{(re.sales||[]).forEach(Pe=>{const ue=String((Pe==null?void 0:Pe.id)??"").split("#")[0].trim();ue&&He.add(ue)})});const se=Array.from(He).filter(re=>!E[re]);if(se.length>0){const re={};for(const Pe of se)try{const ue=await Bs(Yt(Fe,l,Pe));if(ue.exists()){const we=ue.data();re[Pe]=UQe(we,Pe)}else re[Pe]=[]}catch(ue){console.error("Error leyendo sale",Pe,ue),re[Pe]=[]}F(Pe=>({...Pe,...re}))}}catch(R){console.error(R),w(" Error cargando liquidaciones.")}finally{m(!1)}};x.useEffect(()=>{P()},[]),x.useEffect(()=>{D()},[]);const X=async ee=>{ee.preventDefault(),await D()},pe=x.useMemo(()=>{const ee={};return j.forEach(R=>ee[R.id]=R.name||R.id),ee},[j]),ge=ee=>{const R=[];return(ee.sales||[]).forEach(H=>{const ne=String((H==null?void 0:H.id)??"").trim();if(!ne)return;const ve=ne.split("#")[0],He=(E[ve]||[]).find(se=>se.id===ne);He?R.push(He):R.push({id:ne,productName:String((H==null?void 0:H.productName)??"(sin nombre)"),quantity:Number((H==null?void 0:H.quantity)??0),amount:ws(Number((H==null?void 0:H.amount)??0)),date:String((H==null?void 0:H.date)??""),type:"CONTADO",vendorId:"",userEmail:String((H==null?void 0:H.userEmail)??"(sin vendedor)"),vendorCommissionAmount:0})}),R},fe=ee=>_==="ALL"?ee:ee.filter(R=>(R.vendorId||"")===_),xe=x.useMemo(()=>p.map(ee=>{const R=fe(ge(ee));let H=0,ne=0,ve=0,U=0,He=0,se=0;for(const re of R){const Pe=Number(re.quantity||0),ue=Number(re.amount||0),we=Number(re.vendorCommissionAmount||0);re.type==="CREDITO"?(ne+=Pe,U+=ue,se+=we):(H+=Pe,ve+=ue,He+=we)}return{...ee,_sales:R,_packsCash:l0(H),_packsCredit:l0(ne),_amountCash:ws(ve),_amountCredit:ws(U),_comCash:ws(He),_comCredit:ws(se)}}),[p,E,_]),ae=x.useMemo(()=>{let ee=0,R=0,H=0,ne=0,ve=0,U=0;for(const He of xe)ee+=Number(He._packsCash||0),R+=Number(He._packsCredit||0),H+=Number(He._amountCash||0),ne+=Number(He._amountCredit||0),ve+=Number(He._comCash||0),U+=Number(He._comCredit||0);return{packsCash:l0(ee),packsCredit:l0(R),totalSales:ws(H+ne),amountCash:ws(H),amountCredit:ws(ne),comCash:ws(ve),comCredit:ws(U)}},[xe]),Se=x.useMemo(()=>{const ee={},R={};for(const H of xe){const ne=H._sales||[];for(const ve of ne){const U=(ve.vendorId||"").trim();if(!U)continue;const He=pe[U]||ve.userEmail||U,se=ws(Number(ve.vendorCommissionAmount||0));ve.type==="CREDITO"?(R[U]||(R[U]={vendorId:U,name:He,total:0}),R[U].total=ws(R[U].total+se)):(ee[U]||(ee[U]={vendorId:U,name:He,total:0}),ee[U].total=ws(ee[U].total+se))}}return{cashRows:Object.values(ee).filter(H=>H.total>0).sort((H,ne)=>ne.total-H.total),creditRows:Object.values(R).filter(H=>H.total>0).sort((H,ne)=>ne.total-H.total)}},[xe,pe]),Te=x.useMemo(()=>j.map(ee=>({id:ee.id,label:ee.name||ee.id})).sort((ee,R)=>ee.label.localeCompare(R.label)),[j]),O=x.useMemo(()=>v&&xe.find(ee=>ee.id===v.id)||null,[v,xe]),G=x.useMemo(()=>O?O._sales||[]:[],[O]),z=x.useMemo(()=>{let ee=0,R=0,H=0,ne=0;for(const ve of G)ve.type==="CREDITO"?(R+=Number(ve.quantity||0),ne+=Number(ve.amount||0)):(ee+=Number(ve.quantity||0),H+=Number(ve.amount||0));return{packsCash:l0(ee),packsCredit:l0(R),amountCash:ws(H),amountCredit:ws(ne)}},[G]),L=x.useMemo(()=>{const ee={};for(const R of G){const H=R.productName||"(sin nombre)";ee[H]||(ee[H]={productName:H,packsCash:0,packsCredit:0,amountCash:0,amountCredit:0,comCash:0,comCredit:0});const ne=Number(R.quantity||0),ve=Number(R.amount||0),U=Number(R.vendorCommissionAmount||0);R.type==="CREDITO"?(ee[H].packsCredit=l0(ee[H].packsCredit+ne),ee[H].amountCredit=ws(ee[H].amountCredit+ve),ee[H].comCredit=ws(ee[H].comCredit+U)):(ee[H].packsCash=l0(ee[H].packsCash+ne),ee[H].amountCash=ws(ee[H].amountCash+ve),ee[H].comCash=ws(ee[H].comCash+U))}return Object.values(ee)},[G]),Z=async()=>{if(!k.current||!O)return;const ee=k.current;ee.classList.add("force-pdf-colors");try{const H=(await Cg(ee,{backgroundColor:"#ffffff"})).toDataURL("image/png"),ne=new Rr;ne.addImage(H,"PNG",10,10,190,0),ne.save(`liquidacion_${O.date}.pdf`)}finally{ee.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Liquidaciones"}),i.jsxs("form",{onSubmit:X,className:"flex flex-wrap items-end gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:ee=>d(ee.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:f,onChange:ee=>A(ee.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 min-w-[240px]",value:_,onChange:ee=>S(ee.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),Te.map(ee=>i.jsx("option",{value:ee.id,children:ee.label},ee.id))]})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Aplicar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-3 mb-6",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"text-2xl font-bold",children:bh(ae.packsCash)})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:bh(ae.packsCredit)})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas totales"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Ji(ae.totalSales)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Ji(ae.amountCash)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Ji(ae.amountCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Ji(ae.comCash)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",Ji(ae.comCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin cash)"}),Se.cashRows.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:Se.cashRows.map(ee=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:ee.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Ji(ee.total)]})]},ee.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin crdito)"}),Se.creditRows.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:Se.creditRows.map(ee=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:ee.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Ji(ee.total)]})]},ee.vendorId))})]})]}),h?i.jsx("p",{children:"Cargando..."}):xe.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cierres en el rango seleccionado."}):i.jsxs("table",{className:"min-w-full text-sm mb-6 shadow-lg p-4 bg-white border-gray-100",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total paquetes Cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Total Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Total Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"}),i.jsx("th",{className:"border p-2",children:"Opciones"})]})}),i.jsx("tbody",{children:xe.map(ee=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ee.date}),i.jsx("td",{className:"border p-1",children:bh(ee._packsCash)}),i.jsx("td",{className:"border p-1",children:bh(ee._packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",Ji(ee._amountCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",Ji(ee._amountCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",Ji(ee._comCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",Ji(ee._comCredit)]}),i.jsx("td",{className:"border p-1",children:i.jsx("div",{className:"flex items-center gap-2 justify-center",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>y(ee),children:"Ver detalle"})})})]},ee.id))})]}),O&&i.jsxs("div",{className:"mt-6 rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2 ",children:[i.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle ",O.date]}),i.jsx("button",{onClick:()=>y(null),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"}),i.jsx("button",{onClick:Z,className:"ml-auto bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Descargar PDF"})]}),i.jsxs("div",{ref:k,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:[i.jsxs("div",{children:["Total Ventas cash:"," ",i.jsxs("strong",{children:["C$",Ji(z.amountCash)]})]}),i.jsxs("div",{children:["Total Ventas crdito:"," ",i.jsxs("strong",{children:["C$",Ji(z.amountCredit)]})]}),i.jsxs("div",{children:["Total paquetes cash:"," ",i.jsx("strong",{children:bh(z.packsCash)})]}),i.jsxs("div",{children:["Total paquetes crdito:"," ",i.jsx("strong",{children:bh(z.packsCredit)})]})]}),i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),G.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin ventas en este cierre."}):i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"})]})}),i.jsx("tbody",{children:G.map((ee,R)=>{const H=ee.vendorId&&pe[ee.vendorId]?pe[ee.vendorId]:ee.userEmail,ne=ws(Number(ee.vendorCommissionAmount||0));return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:H}),i.jsx("td",{className:"border p-1",children:ee.productName}),i.jsx("td",{className:"border p-1",children:ee.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:bh(ee.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",Ji(ee.amount)]}),i.jsx("td",{className:"border p-1",children:ne>0?`C$${Ji(ne)}`:""}),i.jsx("td",{className:"border p-1",children:ee.date||""})]},R)})})]}),i.jsx("h3",{className:"font-semibold",children:"Consolidado por producto"}),L.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin datos para consolidar."}):i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"})]})}),i.jsx("tbody",{children:L.map((ee,R)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ee.productName}),i.jsx("td",{className:"border p-1",children:bh(ee.packsCash)}),i.jsx("td",{className:"border p-1",children:bh(ee.packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",Ji(ee.amountCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",Ji(ee.amountCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",Ji(ee.comCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",Ji(ee.comCredit)]})]},R))})]})]})]}),b&&i.jsx("p",{className:"mt-3 text-sm",children:b})]})}const Ir=t=>Math.round((Number(t)||0)*100)/100,zo=t=>Math.round((Number(t)||0)*1e3)/1e3,wr=t=>Number(t??0).toFixed(2),Hs=t=>Number(t??0).toFixed(3),qS=t=>{const e=String(t||"").toUpperCase().trim();return e==="RIVAS"?"RIVAS":e==="SAN_JORGE"||e==="SANJORGE"||e==="SJ"?"SAN_JORGE":e==="ISLA"||e==="OMETEPE"?"ISLA":""},yr=t=>{const e=Number(t);return Number.isFinite(e)?e:0},VQe=t=>Math.max(0,Math.min(1,t));function sG({title:t,series:e,valuePrefix:r="C$"}){const u=e.map(b=>Number(b.value||0)),d=u.length?Math.min(...u):0,f=u.length?Math.max(...u):0,A=f-d||1,h=840,m=204,p=e.map((b,w)=>{const j=44+(e.length<=1?h/2:w/(e.length-1)*h),I=18+(1-(Number(b.value||0)-d)/A)*m;return{x:j,y:I,...b}}),g=p.map((b,w)=>`${w===0?"M":"L"} ${b.x.toFixed(2)} ${b.y.toFixed(2)}`).join(" "),v=p[p.length-1],y=v?v.value:0;return i.jsxs("div",{className:"border rounded-2xl p-3 shadow-sm bg-white",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[i.jsx("div",{className:"font-semibold text-sm sm:text-base",children:t}),i.jsxs("div",{className:"text-xs text-gray-600 whitespace-nowrap",children:["ltimo: ",i.jsx("strong",{children:r+wr(y)})]})]}),i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("svg",{viewBox:"0 0 900 260",className:"min-w-[720px] w-full h-auto",role:"img","aria-label":t,children:[[0,1,2,3].map(b=>{const w=18+b/3*m;return i.jsx("line",{x1:44,y1:w,x2:884,y2:w,stroke:"#e5e7eb",strokeWidth:"1"},b)}),i.jsxs("text",{x:8,y:28,fontSize:"12",fill:"#6b7280",children:[r,wr(f)]}),i.jsxs("text",{x:8,y:18+m,fontSize:"12",fill:"#6b7280",children:[r,wr(d)]}),i.jsx("path",{d:g,fill:"none",stroke:"#111827",strokeWidth:"2.5"}),p.map((b,w)=>i.jsx("circle",{cx:b.x,cy:b.y,r:"3.5",fill:"#111827"},w)),e.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("text",{x:44,y:246,fontSize:"12",fill:"#6b7280",textAnchor:"start",children:e[0].label}),i.jsx("text",{x:884,y:246,fontSize:"12",fill:"#6b7280",textAnchor:"end",children:e[e.length-1].label})]})]})})]})}function HQe({title:t,items:e}){const r=e.reduce((f,A)=>f+Number(A.value||0),0),n=240,a=86,s=120,o=120,l=r>0?r:1;let c=0;const u=["#111827","#374151","#6b7280","#9ca3af"],d=e.map((f,A)=>{const h=Math.max(0,Number(f.value||0)),m=c/l,p=h/l;c+=h;const g=m+p,v=m*Math.PI*2-Math.PI/2,y=g*Math.PI*2-Math.PI/2,b=s+a*Math.cos(v),w=o+a*Math.sin(v),j=s+a*Math.cos(y),I=o+a*Math.sin(y),_=p>.5?1:0;return{d:[`M ${s} ${o}`,`L ${b.toFixed(2)} ${w.toFixed(2)}`,`A ${a} ${a} 0 ${_} 1 ${j.toFixed(2)} ${I.toFixed(2)}`,"Z"].join(" "),fill:u[A%u.length],...f,frac:p}});return i.jsxs("div",{className:"border rounded-2xl p-3 shadow-sm bg-white",children:[i.jsx("div",{className:"font-semibold text-sm sm:text-base mb-2",children:t}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-center",children:[i.jsx("div",{className:"w-full md:w-auto overflow-x-auto",children:i.jsxs("svg",{viewBox:`0 0 ${n} ${n}`,className:"min-w-[240px] w-[260px] h-auto",role:"img","aria-label":t,children:[d.map((f,A)=>i.jsx("path",{d:f.d,fill:f.fill},A)),i.jsx("circle",{cx:s,cy:o,r:"48",fill:"#ffffff"}),i.jsx("text",{x:s,y:o-4,textAnchor:"middle",fontSize:"12",fill:"#6b7280",children:"Total"}),i.jsxs("text",{x:s,y:o+16,textAnchor:"middle",fontSize:"14",fill:"#111827",fontWeight:"700",children:["C$",wr(r)]})]})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:e.map((f,A)=>{const h=Number(f.value||0),m=VQe(h/(r||1))*100;return i.jsxs("div",{className:"border rounded-xl p-2 bg-gray-50",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"text-sm font-semibold truncate",children:f.label}),i.jsxs("div",{className:"text-sm font-bold whitespace-nowrap",children:["C$",wr(h)]})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[m.toFixed(1),"%"]}),i.jsx("div",{className:"h-2 bg-white border rounded-full mt-2 overflow-hidden",children:i.jsx("div",{className:"h-full",style:{width:`${m}%`,background:u[A%u.length]}})})]},f.label)})}),i.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"*Distribucin basada en ventas del perodo con los filtros actuales."})]})]})]})}const $Qe=(t,e)=>{var g;const r=t.date??((g=t.timestamp)!=null&&g.toDate?Nr(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=String(t.processedDate??t.closureDate??"").trim(),a=t.status??"FLOTANTE",s=t.type||"CONTADO",o=String(t.vendorId??"").trim(),l=String(t.vendorName??"").trim()||String(t.userEmail??"").trim()||o||"(sin vendedor)",c=String(t.customerId??"").trim(),u=String(t.customerName??"").trim()||String(t.clientName??"").trim()||"",d=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,f=Number(t.vendorCommissionAmount??0)||0,A=qS(t.branch??t.vendorBranch);if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((v,y)=>{const b=Number((v==null?void 0:v.packages)??0)||0,w=Number((v==null?void 0:v.total)??0)||Math.max(0,Number((v==null?void 0:v.unitPricePackage)||0)*b-Number((v==null?void 0:v.discount)||0)),j=qS(v==null?void 0:v.branch)||A;let I=0;return f>0&&d>0&&w>0&&(I=Ir(f*w/d)),{id:`${e}#${y}`,docId:e,productId:String((v==null?void 0:v.productId)??""),productName:String((v==null?void 0:v.productName)??"(sin nombre)"),date:r,processedDate:n,status:a,type:s,vendorId:o,vendorName:l,customerId:c,customerName:u,branch:j||"",packages:b,amount:Ir(w),commission:Ir(I)}});const h=Number(t.packagesTotal??0)||0,m=Number(t.total??t.amount??t.amountCharged??0)||0,p=Ir(Number(t.vendorCommissionAmount??0)||0);return[{id:`${e}#0`,docId:e,productId:"",productName:"(sin nombre)",date:r,processedDate:n,status:a,type:s,vendorId:o,vendorName:l,customerId:c,customerName:u,branch:A||"",packages:h,amount:Ir(m),commission:Ir(p)}]};function GQe({role:t,roles:e}){var it;const r=e&&e.length?e:t,n=!r||sn(r,"admin"),a=Nr(new Date,"yyyy-MM-dd"),[s,o]=x.useState(a),[l,c]=x.useState(a),[u,d]=x.useState("TODAS"),[f,A]=x.useState("AMBAS"),[h,m]=x.useState("ALL"),[p,g]=x.useState("ALL"),[v,y]=x.useState(""),[b,w]=x.useState(""),[j,I]=x.useState(""),[_,S]=x.useState(""),[E,F]=x.useState("DIA"),[k,P]=x.useState(!0),[D,X]=x.useState(""),[pe,ge]=x.useState([]),[fe,xe]=x.useState([]),[ae,Se]=x.useState([]),[Te,O]=x.useState({}),[G,z]=x.useState([]),[L,Z]=x.useState([]),[ee,R]=x.useState([]),[H,ne]=x.useState([]),[ve,U]=x.useState([]),[He,se]=x.useState([]),[re,Pe]=x.useState(""),[ue,we]=x.useState(""),[Me,ze]=x.useState(null),yt=x.useRef(null),[It,Ke]=x.useState([]),[wt,At]=x.useState("DETALLE"),bt=x.useMemo(()=>{const T={};return L.forEach(M=>T[M.id]=String(M.name||"").trim()),T},[L]),ke=x.useMemo(()=>{const T={};return fe.forEach(M=>T[M.id]=M),T},[fe]),Ne=T=>{const M=T.customerId?bt[T.customerId]:"";return(T.customerName||M||"").trim()||(T.customerId?bt[T.customerId]||T.customerId:"")||""};x.useEffect(()=>{if(!n)return;(async()=>{try{const M=await Qt(_t(Fe,"inventory_candies")),V=[];M.forEach(q=>V.push({id:q.id,...q.data()})),Ke(V)}catch(M){console.error("inventory_candies all error:",M),Ke([])}})()},[n]),x.useEffect(()=>{(async()=>{try{const M=await Qt(_t(Fe,"sellers_candies")),V=[];M.forEach(Y=>{const oe=Y.data();V.push({id:Y.id,name:String(oe.name||"").trim(),commissionPercent:Number(oe.commissionPercent||0),branch:oe.branch||""})});const q=new Map;V.forEach(Y=>q.set(Y.id,Y)),xe(Array.from(q.values()).sort((Y,oe)=>Y.name.localeCompare(oe.name)))}catch(M){console.error(M)}})()},[]),x.useEffect(()=>{if(!n||!s||!l)return;P(!0),X("");const T=er(_t(Fe,"sales_candies"),cr("date",">=",s),cr("date","<=",l),dn("date","asc")),M=cd(T,V=>{const q=[];V.forEach(Y=>q.push(...$Qe(Y.data(),Y.id))),ge(q),P(!1)},V=>{console.error("sales_candies periodo error:",V),ge([]),P(!1),X(" Error cargando ventas del perodo (revis ndices si aplica).")});return()=>M()},[n,s,l]),x.useEffect(()=>{if(!n)return;(async()=>{try{const M=er(_t(Fe,"candy_main_orders"),cr("date",">=",s),cr("date","<=",l)),V=await Qt(M),q=[];V.forEach(Y=>q.push({id:Y.id,...Y.data()})),Se(q)}catch(M){console.error("candy_main_orders error:",M),Se([])}})()},[n,s,l]),x.useEffect(()=>{if(!n)return;(async()=>{try{const M=await Qt(er(_t(Fe,"candy_main_orders"),dn("createdAt","desc"))),V={},q=(Y,oe)=>`${Y}#${String(oe).padStart(10,"0")}`;M.forEach(Y=>{var et;const oe=Y.data(),De=Number(((et=oe.createdAt)==null?void 0:et.seconds)??0),We=String(oe.date||""),dt=q(We,De),Oe=Array.isArray(oe.items)?oe.items:[];for(const mt of Oe){const Tt=String(mt.id||mt.productId||"");if(!Tt)continue;const Pt={unitPriceRivas:Number(mt.unitPriceRivas||0),unitPriceSanJorge:Number(mt.unitPriceSanJorge||0),unitPriceIsla:Number(mt.unitPriceIsla||0),key:dt},Ft=V[Tt];(!Ft||Pt.key>Ft.key)&&(V[Tt]=Pt)}}),O(V)}catch(M){console.error("candy_main_orders catalog error:",M),O({})}})()},[n]),x.useEffect(()=>{if(!n)return;const T=er(_t(Fe,"inventory_candies_sellers"),cr("date",">=",s),cr("date","<=",l)),M=cd(T,V=>{const q=[];V.forEach(Y=>q.push({id:Y.id,...Y.data()})),z(q)},V=>{console.error("inventory_candies_sellers error:",V),z([])});return()=>M()},[n,s,l]),x.useEffect(()=>{if(!n)return;(async()=>{try{const M=er(_t(Fe,"expenses_candies"),cr("date",">=",s),cr("date","<=",l),dn("date","asc")),V=await Qt(M),q=[];V.forEach(Y=>q.push({id:Y.id,...Y.data()})),ne(q)}catch(M){console.warn("expenses_candies sin ndice, usando fallback:",M);try{const V=await Qt(_t(Fe,"expenses_candies")),q=[];V.forEach(Y=>q.push({id:Y.id,...Y.data()})),ne(q.filter(Y=>String(Y.date||"")>=s&&String(Y.date||"")<=l))}catch(V){console.error(V),ne([])}}})()},[n,s,l]),x.useEffect(()=>{if(!n)return;(async()=>{try{const M=await Qt(_t(Fe,"inventory_candies")),V=[];M.forEach(q=>V.push({id:q.id,...q.data()})),U(V)}catch(M){console.error("inventory_candies global error:",M),U([])}})()},[n]),x.useEffect(()=>{if(!n)return;(async()=>{try{const M=await Qt(_t(Fe,"inventory_candies_sellers")),V=[];M.forEach(q=>V.push({id:q.id,...q.data()})),se(V)}catch(M){console.error("inventory_candies_sellers global error:",M),se([])}})()},[n]),x.useEffect(()=>{if(!n)return;const T=er(_t(Fe,"customers_candies")),M=cd(T,V=>{const q=[];V.forEach(Y=>{var oe,De,We;return q.push({id:Y.id,name:String(((oe=Y.data())==null?void 0:oe.name)||"").trim(),initialDebt:Number(((De=Y.data())==null?void 0:De.initialDebt)||0),initialDebtDate:String(((We=Y.data())==null?void 0:We.initialDebtDate)||"").trim()})}),Z(q)},V=>{console.error("customers_candies snapshot error:",V),Z([])});return()=>M()},[n]),x.useEffect(()=>{if(!n)return;(async()=>{try{const M=er(_t(Fe,"ar_movements"),cr("date","<=",l),dn("date","asc")),V=await Qt(M),q=[];V.forEach(Y=>q.push({id:Y.id,...Y.data()})),R(q)}catch(M){console.warn("ar_movements sin ndice, usando fallback:",M);try{const V=await Qt(_t(Fe,"ar_movements")),q=[];V.forEach(Y=>q.push({id:Y.id,...Y.data()})),R(q.filter(Y=>String(Y.date||"")<=l))}catch(V){console.error(V),R([])}}})()},[n,l]);const Ve=x.useMemo(()=>{let T=[...pe];if(u!=="TODAS"&&(T=T.filter(q=>q.status===u)),f==="CASH"&&(T=T.filter(q=>q.type==="CONTADO")),f==="CREDITO"&&(T=T.filter(q=>q.type==="CREDITO")),h!=="ALL"&&(T=T.filter(q=>(q.vendorId||"")===h)),p!=="ALL"&&(T=T.filter(q=>q.branch===p)),v.trim()){const q=v.trim().toLowerCase();T=T.filter(Y=>(Y.productName||"").toLowerCase().includes(q))}if(b.trim()){const q=b.trim().toLowerCase();T=T.filter(Y=>(Ne(Y)||"").toLowerCase().includes(q))}const M=j.trim()?Number(j):null,V=_.trim()?Number(_):null;return M!==null&&!Number.isNaN(M)&&(T=T.filter(q=>(q.amount||0)>=M)),V!==null&&!Number.isNaN(V)&&(T=T.filter(q=>(q.amount||0)<=V)),T},[pe,u,f,h,p,v,b,j,_,bt]),he=x.useMemo(()=>{let T=0,M=0,V=0,q=0,Y=0,oe=0;for(const We of Ve){const dt=yr(We.packages),Oe=yr(We.amount),et=yr(We.commission);We.type==="CREDITO"?(M+=dt,q+=Oe,oe+=et):(T+=dt,V+=Oe,Y+=et)}const De=Ir(V+q);return{packsCash:zo(T),packsCredit:zo(M),salesCash:Ir(V),salesCredit:Ir(q),salesTotal:De,commCash:Ir(Y),commCredit:Ir(oe),commTotal:Ir(Y+oe)}},[Ve]),le=x.useMemo(()=>{let T=0,M=0,V=0,q=0,Y=0,oe=0;for(const De of ae){const We=Array.isArray(De.items)?De.items:[];for(const dt of We)T+=yr(dt.totalRivas),M+=yr(dt.totalSanJorge),V+=yr(dt.totalIsla),q+=yr(dt.gainRivas),Y+=yr(dt.gainSanJorge),oe+=yr(dt.gainIsla)}return{expectedRivas:Ir(T),expectedSanJorge:Ir(M),expectedIsla:Ir(V),grossRivas:Ir(q),grossSanJorge:Ir(Y),grossIsla:Ir(oe),grossTotal:Ir(q+Y+oe),expectedTotal:Ir(T+M+V)}},[ae]),Be=x.useMemo(()=>{const T={RIVAS:{sales:0,packages:0},SAN_JORGE:{sales:0,packages:0},ISLA:{sales:0,packages:0}};for(const M of Ve){const V=M.branch;V&&(T[V].sales+=yr(M.amount),T[V].packages+=yr(M.packages))}return{RIVAS:{sales:Ir(T.RIVAS.sales),packages:zo(T.RIVAS.packages)},SAN_JORGE:{sales:Ir(T.SAN_JORGE.sales),packages:zo(T.SAN_JORGE.packages)},ISLA:{sales:Ir(T.ISLA.sales),packages:zo(T.ISLA.packages)}}},[Ve]),je=x.useMemo(()=>({RIVAS:Ir(Be.RIVAS.sales-le.expectedRivas),SAN_JORGE:Ir(Be.SAN_JORGE.sales-le.expectedSanJorge),ISLA:Ir(Be.ISLA.sales-le.expectedIsla)}),[Be,le]),Ae=x.useMemo(()=>{const T={},M={};for(const Y of Ve){const oe=(Y.vendorId||"").trim();if(!oe)continue;const De=fe.find(Oe=>Oe.id===oe),We=(De==null?void 0:De.name)||Y.vendorName||"(sin vendedor)",dt=yr(Y.commission);Y.type==="CREDITO"?(M[oe]||(M[oe]={vendorId:oe,name:We,total:0}),M[oe].total=Ir(M[oe].total+dt)):(T[oe]||(T[oe]={vendorId:oe,name:We,total:0}),T[oe].total=Ir(T[oe].total+dt))}const V=Object.values(T).sort((Y,oe)=>oe.total-Y.total),q=Object.values(M).sort((Y,oe)=>oe.total-Y.total);return{cashArr:V,creditArr:q}},[Ve,fe]),Qe=x.useMemo(()=>{const T=(Pt,Ft)=>Pt.reduce((Xt,mr)=>Xt+Number((mr==null?void 0:mr[Ft])??0),0),M=Pt=>{const Ft=Number(Pt);return Number.isFinite(Ft)?Math.floor(Ft):0},V=Pt=>{const Ft=Number((Pt==null?void 0:Pt.totalPackages)??0);if(Ft>0)return Ft;const Xt=Array.isArray(Pt==null?void 0:Pt.items)?Pt.items:[];return T(Xt,"packages")};let q=0,Y=0;for(const Pt of ae){const Ft=Array.isArray(Pt.items)?Pt.items:[];if(Ft.length)for(const Xt of Ft)q+=Number((Xt==null?void 0:Xt.subtotal)??0);else q+=Number(Pt.subtotal??0);Y+=V(Pt)}let oe=0,De=0,We=0;const dt=Pt=>{const Ft=Number(Pt==null?void 0:Pt.remainingPackages);if(Number.isFinite(Ft)&&Ft>0)return Math.floor(Ft);const Xt=Math.max(1,M((Pt==null?void 0:Pt.unitsPerPackage)??1)),mr=M((Pt==null?void 0:Pt.remainingUnits)??(Pt==null?void 0:Pt.remaining)??0);return mr>0?Math.max(0,Math.floor(mr/Xt)):0};for(const Pt of G)oe+=Number(Pt.subtotal??0),De+=Number(Pt.packages??0),We+=dt(Pt);const Oe=new Set(ae.filter(Pt=>String(Pt.date||"")>=s&&String(Pt.date||"")<=l).map(Pt=>Pt.id));let et=0;for(const Pt of It){const Ft=String(Pt.orderId||"").trim();Ft&&Oe.has(Ft)&&(et+=Number(Pt.remainingPackages??0))}const mt=ve.reduce((Pt,Ft)=>Pt+yr(Ft.remainingPackages),0),Tt=He.reduce((Pt,Ft)=>Pt+yr(Ft.remainingPackages),0);return{providerTotalMaster:Ir(q),providerTotalVendor:Ir(oe),orderedPacksMaster:zo(Y),remainingPacksMaster:zo(et),orderedPacksVendor:zo(De),remainingPacksVendor:zo(We),globalRemainingMaster:zo(mt),globalRemainingVendor:zo(Tt)}},[ae,G,It,s,l,ve,He]),Ct=x.useMemo(()=>{const T={};let M=0;for(const V of H){const q=String(V.date||"").trim();if(!q)continue;const Y=Math.max(0,yr(V.amount));M+=Y,T[q]=Ir((T[q]||0)+Y)}return{total:Ir(M),byDay:T}},[H]),pt=x.useMemo(()=>{let T=0;for(const M of ae){const V=Array.isArray(M.items)?M.items:[];if(V.length)for(const q of V)T+=yr(q==null?void 0:q.subtotal);else T+=yr(M.subtotal)}return Ir(T)},[ae]),me=x.useMemo(()=>{var dt;const T=Oe=>{const et=Math.max(1,Math.floor(yr(Oe.unitsPerPackage||1))),mt=yr(Oe.totalUnits)>0?yr(Oe.totalUnits):yr(Oe.packages)*et;let Tt=0;yr(Oe.remainingUnits)>0?Tt=yr(Oe.remainingUnits):yr(Oe.remainingPackages)>0?Tt=yr(Oe.remainingPackages)*et:Tt=0;const Pt=Math.max(0,mt-Tt);return{orderedUnits:mt,remainingUnits:Tt,soldUnits:Pt,upp:et}},M=Oe=>{const et=ke[Oe];return qS(et==null?void 0:et.branch)||"ISLA"},V=(Oe,et)=>{var mt,Tt,Pt;return et==="ISLA"?yr(((mt=Te[String(Oe.productId||"")])==null?void 0:mt.unitPriceIsla)??Oe.unitPriceIsla):et==="RIVAS"?yr(((Tt=Te[String(Oe.productId||"")])==null?void 0:Tt.unitPriceRivas)??Oe.unitPriceRivas):et==="SAN_JORGE"?yr(((Pt=Te[String(Oe.productId||"")])==null?void 0:Pt.unitPriceSanJorge)??Oe.unitPriceSanJorge):0},q=(Oe,et)=>{const mt=Math.max(0,Math.floor(yr(Oe.packages))),Tt=V(Oe,et),Pt=Ir(Tt*mt);if(Pt>0)return Pt;const Ft=yr(Oe.totalVendor)||(et==="ISLA"?yr(Oe.totalIsla):et==="RIVAS"?yr(Oe.totalRivas):et==="SAN_JORGE"?yr(Oe.totalSanJorge):0);if(Ft>0)return Ft;const Xt=yr(Oe.unitPriceVendor);if(Xt>0){const{orderedUnits:mr}=T(Oe);return Xt*mr}return 0},Y=(Oe,et)=>{const mt=V(Oe,et),{orderedUnits:Tt,upp:Pt}=T(Oe);if(mt>0&&Pt>0)return mt/Pt;const Ft=yr(Oe.unitPriceVendor);if(Ft>0)return Ft;const Xt=q(Oe,et);return Xt>0&&Tt>0?Xt/Tt:0},oe=new Map;for(const Oe of G){const et=String(Oe.orderId||"").trim(),mt=et||`DOC:${Oe.id}`,Tt=String(Oe.sellerId||"").trim(),Pt=String(Oe.sellerName||"").trim()||Tt&&((dt=ke[Tt])==null?void 0:dt.name)||""||"(sin vendedor)",Ft=String(Oe.date||"").trim(),Xt=Tt?M(Tt):"",{orderedUnits:mr,remainingUnits:Yr,soldUnits:Br}=T(Oe),Fr=q(Oe,Xt),vn=Y(Oe,Xt),Ln=vn>0?vn*Br:mr>0?Fr*Br/mr:0,yn=Ir(Fr-Ln);oe.has(mt)||oe.set(mt,{orderKey:mt,orderId:et||mt,date:Ft,sellerId:Tt,sellerName:Pt,branch:Xt,totalOrden:0,vendido:0,restante:0,comision:0,totalEsperado:0,lines:[]});const In=oe.get(mt);In.lines.push({...Oe,orderedUnits:mr,soldUnits:Br,remainingUnits:Yr,lineTotal:Ir(Fr),lineSoldValue:Ir(Ln),lineRemainingValue:Ir(yn)}),In.totalOrden+=Fr,In.vendido+=Ln,In.restante+=yn,In.comision+=yr(Oe.uVendor??Oe.vendorProfit??Oe.gainVendor)}for(const Oe of oe.values())Oe.comision=Ir(Oe.comision),Oe.totalEsperado=Ir(Oe.totalOrden-Oe.comision),Oe.totalOrden=Ir(Oe.totalOrden),Oe.vendido=Ir(Oe.vendido),Oe.restante=Ir(Oe.restante);const De=Array.from(oe.values()).sort((Oe,et)=>Oe.date&&et.date?Oe.date<et.date?1:-1:et.totalOrden-Oe.totalOrden),We=De.reduce((Oe,et)=>(Oe.totalOrden+=yr(et.totalOrden),Oe.vendido+=yr(et.vendido),Oe.restante+=yr(et.restante),Oe.comision+=yr(et.comision),Oe.totalEsperado+=yr(et.totalEsperado),Oe),{totalOrden:0,vendido:0,restante:0,comision:0,totalEsperado:0});return{global:{totalOrden:Ir(We.totalOrden),vendido:Ir(We.vendido),restante:Ir(We.restante),comision:Ir(We.comision),totalEsperado:Ir(We.totalEsperado)},orders:De}},[G,ke,Te]),te=x.useMemo(()=>{var q,Y,oe;let T=0,M=0;for(const De of G){const We=String(De.sellerId||"").trim(),dt=We?ke[We]:void 0,Oe=qS(dt==null?void 0:dt.branch)||"ISLA",et=Math.max(0,Math.floor(yr(De.packages)));if(!et)continue;const mt=yr(Oe==="ISLA"?((q=Te[String(De.productId||"")])==null?void 0:q.unitPriceIsla)??De.unitPriceIsla:Oe==="RIVAS"?((Y=Te[String(De.productId||"")])==null?void 0:Y.unitPriceRivas)??De.unitPriceRivas:((oe=Te[String(De.productId||"")])==null?void 0:oe.unitPriceSanJorge)??De.unitPriceSanJorge);let Tt=Ir(mt*et);Tt||(Tt=yr(Oe==="ISLA"?De.totalIsla:Oe==="RIVAS"?De.totalRivas:De.totalSanJorge)),Tt&&(T+=Tt,M+=Tt)}const V=Ir(yr(le.expectedIsla)-M);return{dispersedTotal:Ir(T),dispersedIsla:Ir(M),totalExistenteIsla:V}},[G,ke,le.expectedIsla,Te]),ie=x.useMemo(()=>({net:Ir(G.reduce((M,V)=>{const q=V.uNeta,Y=yr(q);if(Y!==0||q===0)return M+Y;const oe=yr(V.grossProfit),De=yr(V.logisticAllocated??V.gastos??V.gasto),We=yr(V.uVendor??V.vendorProfit);return M+(oe-De-We)},0))}),[G]),$e=x.useMemo(()=>{let T=0,M=0,V=0;for(const q of Ve){if(q.type!=="CREDITO")continue;const Y=yr(q.amount),oe=yr(q.commission);T+=Y,M+=Y-oe}for(const q of ee){const Y=String(q.date||"").trim();if(!Y||Y<s||Y>l)continue;const oe=yr(q.amount);(q.type||(oe<0?"ABONO":"CARGO"))==="ABONO"&&(V+=Math.abs(oe))}return{cxc:Ir(T),recaudado:Ir(V),utilidadBruta:Ir(M)}},[Ve,ee,s,l]),de=x.useMemo(()=>{if(!ue)return null;const T=me.orders.find(q=>q.orderKey===ue);if(!T)return null;const M={};for(const q of T.lines){const Y=String(q.productName||"(sin nombre)");M[Y]||(M[Y]={productName:Y,asociados:0,vendidos:0,restantes:0});const oe=Math.max(0,Math.floor(yr(q.packages))),De=Math.max(1,Math.floor(yr(q.unitsPerPackage||1))),We=Math.max(0,Math.floor(yr(q.remainingPackages)||(yr(q.remainingUnits)>0?yr(q.remainingUnits)/De:0))),dt=Math.max(0,oe-We);M[Y].asociados+=oe,M[Y].vendidos+=dt,M[Y].restantes+=We}const V=Object.values(M).map(q=>({...q,asociados:Math.floor(q.asociados),vendidos:Math.floor(q.vendidos),restantes:Math.floor(q.restantes)})).sort((q,Y)=>Y.asociados-q.asociados);return{...T,products:V}},[ue,me.orders]),Ce=x.useMemo(()=>{const T=ve.reduce((V,q)=>V+yr(q.remainingPackages),0),M=He.reduce((V,q)=>V+yr(q.remainingPackages),0);return{masterRemainingPackages:zo(T),vendorRemainingPackages:zo(M)}},[ve,He]),nt=x.useMemo(()=>{const T=new Map,M=q=>E==="DIA"?{key:q.date,label:q.date}:E==="VENDEDOR"?{key:q.vendorId||"",label:q.vendorName||""}:E==="PRODUCTO"?{key:q.productName||"",label:q.productName||""}:{key:q.branch||"",label:q.branch||""};for(const q of Ve){const{key:Y,label:oe}=M(q);T.has(Y)||T.set(Y,{key:Y,label:oe,packsCash:0,packsCredit:0,salesCash:0,salesCredit:0,commCash:0,commCredit:0,rows:[]});const De=T.get(Y);De.rows.push(q),q.type==="CREDITO"?(De.packsCredit+=yr(q.packages),De.salesCredit+=yr(q.amount),De.commCredit+=yr(q.commission)):(De.packsCash+=yr(q.packages),De.salesCash+=yr(q.amount),De.commCash+=yr(q.commission))}const V=Array.from(T.values()).map(q=>({...q,packsCash:zo(q.packsCash),packsCredit:zo(q.packsCredit),salesCash:Ir(q.salesCash),salesCredit:Ir(q.salesCredit),commCash:Ir(q.commCash),commCredit:Ir(q.commCredit)}));return E==="DIA"?V.sort((q,Y)=>q.key<Y.key?1:-1):V.sort((q,Y)=>Y.salesCash+Y.salesCredit-(q.salesCash+q.salesCredit)),V},[Ve,E]),vt=x.useMemo(()=>{if(!re)return[];const T=nt.find(M=>M.key===re);return(T==null?void 0:T.rows)||[]},[re,nt]),ht=x.useMemo(()=>{const T={};for(const M of vt){const V=M.productName||"(sin nombre)";T[V]||(T[V]={productName:V,packsCash:0,packsCredit:0,salesCash:0,salesCredit:0,commCash:0,commCredit:0}),M.type==="CREDITO"?(T[V].packsCredit+=yr(M.packages),T[V].salesCredit+=yr(M.amount),T[V].commCredit+=yr(M.commission)):(T[V].packsCash+=yr(M.packages),T[V].salesCash+=yr(M.amount),T[V].commCash+=yr(M.commission))}return Object.values(T).map(M=>({...M,packsCash:zo(M.packsCash),packsCredit:zo(M.packsCredit),salesCash:Ir(M.salesCash),salesCredit:Ir(M.salesCredit),commCash:Ir(M.commCash),commCredit:Ir(M.commCredit)})).sort((M,V)=>V.salesCash+V.salesCredit-(M.salesCash+M.salesCredit))},[vt]),xt=x.useMemo(()=>{const T={},M=oe=>(bt[oe]||"").trim()||oe;for(const oe of L){const De=String(oe.id||"").trim();De&&(T[De]={customerId:De,name:M(De),balance:0,lastPayment:"",lastPaymentAmount:0,initialDebt:yr(oe.initialDebt),initialDebtDate:String(oe.initialDebtDate||"").trim(),movements:[]})}for(const oe of ee){const De=String(oe.customerId||"").trim();if(!De)continue;const We=String(oe.date||"");We&&We>l||(T[De]||(T[De]={customerId:De,name:M(De),balance:0,lastPayment:"",lastPaymentAmount:0,initialDebt:0,initialDebtDate:"",movements:[]}),T[De].movements.push(oe))}const V=(oe,De,We)=>{const dt=Number(oe||0);if(!dt)return 0;const Oe=String(De||"").trim();return Oe&&We.some(mt=>{var mr;const Tt=Number(mt.amount||0);if(!(Tt>0))return!1;const Pt=Math.abs(Tt-dt)<.01,Ft=String(mt.date||"").trim()===Oe,Xt=!!((mr=mt.ref)!=null&&mr.saleId);return Pt&&Ft&&Xt})?0:dt},q=Object.values(T).map(oe=>{const De=oe.movements.reduce((et,mt)=>et+yr(mt.amount),0),We=V(oe.initialDebt,oe.initialDebtDate,oe.movements);let dt="",Oe=0;for(const et of oe.movements){const mt=et.type||(yr(et.amount)<0?"ABONO":"CARGO"),Tt=String(et.date||"");if(mt==="ABONO"){const Pt=Math.abs(yr(et.amount));(!dt||Tt>dt)&&(dt=Tt,Oe=Pt)}}return{customerId:oe.customerId,name:oe.name,balance:Ir(We+De),lastPayment:dt,lastPaymentAmount:Ir(Oe)}}).filter(oe=>oe.balance>0).sort((oe,De)=>De.balance-oe.balance),Y=Ir(q.reduce((oe,De)=>oe+De.balance,0));return{count:q.length,totalPending:Y,list:q.slice(0,20)}},[ee,bt,L,l]),Xe=x.useMemo(()=>{if(!Me)return[];const T=ee.filter(V=>(V.customerId||"").trim()===Me.customerId).filter(V=>!V.date||String(V.date)<=l).map(V=>({id:V.id,date:String(V.date||""),type:String(V.type||""),amount:Ir(yr(V.amount))})).sort((V,q)=>V.date<q.date?-1:V.date>q.date?1:0);let M=0;return T.map(V=>{const q=V.type==="ABONO"?-V.amount:V.amount;return M=Ir(M+q),{...V,running:M}})},[Me,ee,l]),be=x.useMemo(()=>Me?pe.filter(T=>(T.customerId||"").trim()===Me.customerId).filter(T=>!T.date||String(T.date)<=l).sort((T,M)=>T.date<M.date?-1:T.date>M.date?1:0):[],[Me,pe,l]),st=x.useMemo(()=>{const T=Ir(he.salesTotal),M=Ir(he.commTotal),V=Ir(Ct.total),q=Ir(T-M-V),Y=new Set;for(const et of Ve)et.date&&Y.add(et.date);const oe=Math.max(1,Y.size),De=Ir(T/oe),We=Ir(M/oe),dt=Ir(V/oe),Oe=Ir(q/oe);return{ingreso:T,comision:M,gastos:V,gananciaNeta:q,daysCount:oe,ingresoDia:De,comisionDia:We,gastosDia:dt,netaDia:Oe}},[he,Ct.total,Ve]),K=x.useMemo(()=>{const T={};for(const Y of Ve){const oe=Y.date;oe&&(T[oe]||(T[oe]={date:oe,ingreso:0,comision:0}),T[oe].ingreso+=yr(Y.amount),T[oe].comision+=yr(Y.commission))}const M=Object.keys(T).sort((Y,oe)=>Y<oe?-1:1),V=M.map(Y=>({label:Y.slice(5),value:Ir(T[Y].ingreso)})),q=M.map(Y=>{var Oe,et;const oe=yr((Oe=T[Y])==null?void 0:Oe.ingreso),De=yr((et=T[Y])==null?void 0:et.comision),We=yr(Ct.byDay[Y]||0),dt=oe-De-We;return{label:Y.slice(5),value:Ir(dt)}});return{seriesIngreso:V,seriesNeta:q,datesCount:M.length}},[Ve,Ct.byDay]),Ie=x.useMemo(()=>[{label:"Rivas",value:yr(Be.RIVAS.sales)},{label:"San Jorge",value:yr(Be.SAN_JORGE.sales)},{label:"Isla",value:yr(Be.ISLA.sales)}].map(T=>({...T,value:Ir(T.value)})),[Be]),Ze=async()=>{if(yt.current){yt.current.classList.add("force-pdf-colors");try{const M=(await Cg(yt.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),V=new Rr;V.addImage(M,"PNG",10,10,190,0),V.save(`data_center_dulces_${s}_a_${l}.pdf`)}finally{yt.current.classList.remove("force-pdf-colors")}}},at=()=>{const M=[["date","processedDate","status","type","vendorId","vendorName","branch","productName","packages","amount","commission","customerId","customerName"].join(","),...Ve.map(oe=>[oe.date,oe.processedDate||"",oe.status,oe.type,oe.vendorId,`"${String(oe.vendorName||"").replace(/"/g,'""')}"`,oe.branch||"",`"${String(oe.productName||"").replace(/"/g,'""')}"`,Hs(oe.packages),wr(oe.amount),wr(oe.commission),oe.customerId||"",`"${String(Ne(oe)||"").replace(/"/g,'""')}"`].join(","))],V=new Blob([M.join(`
`)],{type:"text/csv;charset=utf-8;"}),q=URL.createObjectURL(V),Y=document.createElement("a");Y.href=q,Y.download=`data_center_dulces_${s}_a_${l}.csv`,Y.click(),URL.revokeObjectURL(q)};return n?i.jsxs("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 md:px-0",children:[i.jsxs("div",{className:"bg-white p-3 sm:p-4 md:p-6 rounded-2xl shadow-2xl",children:[i.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between mb-4",children:[i.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold",children:"Data Center - Dulces"}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:items-center sm:justify-end",children:[i.jsx("button",{onClick:Ze,className:`\r
                inline-flex items-center justify-center gap-2\r
                w-full sm:w-auto\r
                px-3 py-2 text-sm font-semibold\r
                rounded-lg md:rounded-md\r
                bg-green-600 text-white hover:bg-green-700 transition-colors\r
              `,children:"Exportar PDF"}),i.jsx("button",{onClick:at,className:`\r
                inline-flex items-center justify-center gap-2\r
                w-full sm:w-auto\r
                px-3 py-2 text-sm font-semibold\r
                rounded-lg md:rounded-md\r
                bg-gray-800 text-white hover:bg-black transition-colors\r
              `,children:"Exportar CSV"})]})]}),i.jsx("div",{className:"rounded-2xl border border-gray-100 p-3 sm:p-4 mb-3 shadow-sm bg-white",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded-lg px-3 py-2 w-full text-sm",value:s,onChange:T=>o(T.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded-lg px-3 py-2 w-full text-sm",value:l,onChange:T=>c(T.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Estado"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:u,onChange:T=>d(T.target.value),children:[i.jsx("option",{value:"TODAS",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Procesada"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Tipo"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:f,onChange:T=>A(T.target.value),children:[i.jsx("option",{value:"AMBAS",children:"Ambas"}),i.jsx("option",{value:"CASH",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Vendedor"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:h,onChange:T=>m(T.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),fe.map(T=>i.jsx("option",{value:T.id,children:T.name||T.id},T.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Sucursal"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:p,onChange:T=>g(T.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"RIVAS",children:"Rivas"}),i.jsx("option",{value:"SAN_JORGE",children:"San Jorge"}),i.jsx("option",{value:"ISLA",children:"Isla"})]})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Producto (opcional)"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:v,onChange:T=>y(T.target.value),placeholder:"Ej: Conitos"})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Cliente (opcional)"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:b,onChange:T=>w(T.target.value),placeholder:"Ej: Javier"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Monto min"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:j,onChange:T=>I(T.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Monto max"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:_,onChange:T=>S(T.target.value),placeholder:"999999"})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Agrupar por"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:E,onChange:T=>{Pe(""),F(T.target.value)},children:[i.jsx("option",{value:"DIA",children:"Da"}),i.jsx("option",{value:"VENDEDOR",children:"Vendedor"}),i.jsx("option",{value:"PRODUCTO",children:"Producto"}),i.jsx("option",{value:"SUCURSAL",children:"Sucursal"})]})]})]})}),i.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between mb-4",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>{we(""),At("MACRO")},className:["px-3 py-2 rounded-full text-sm font-semibold border transition-colors",wt==="MACRO"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-800 border-gray-200 hover:bg-gray-50"].join(" "),children:"Data Macro"}),i.jsx("button",{onClick:()=>{we(""),At("DETALLE")},className:["px-3 py-2 rounded-full text-sm font-semibold border transition-colors",wt==="DETALLE"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-800 border-gray-200 hover:bg-gray-50"].join(" "),children:"Data Detalle"})]}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Gastos del perodo (expenses_candies):"," ",i.jsxs("strong",{children:["C$",wr(Ct.total)]})]})]}),i.jsxs("div",{ref:yt,children:[wt==="MACRO"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ingreso (ventas)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",wr(st.ingreso)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin vendedor (ventas)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["-C$",wr(st.comision)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",wr(he.commCash),"  Crdito: C$",wr(he.commCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos (expenses_candies)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["-C$",wr(st.gastos)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se calcula automtico por fechas"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia neta (real)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",wr(st.gananciaNeta)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Ingreso  Comisin  Gastos"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Promedio neto por da"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",wr(st.netaDia)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Das con ventas: ",i.jsx("strong",{children:st.daysCount})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 mb-3",children:[i.jsx(sG,{title:"Ventas por da (Ingreso)",series:K.seriesIngreso,valuePrefix:"C$"}),i.jsx(sG,{title:"Ganancia neta por da (real)",series:K.seriesNeta,valuePrefix:"C$"})]}),i.jsx("div",{className:"mb-6",children:i.jsx(HQe,{title:"Distribucin de ventas por sucursal",items:Ie})})]}),wt==="DETALLE"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:Hs(he.packsCash)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:Hs(he.packsCredit)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas totales"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",wr(he.salesTotal)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",wr(he.salesCash),"  Crdito: C$",wr(he.salesCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",wr(he.commTotal)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",wr(he.commCash),"  Crdito: C$",wr(he.commCredit)]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta Aprox. (rdenes maestras)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",wr(le.grossIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total esperado (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold mt-2",children:["C$",wr(le.expectedIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Actual ventas (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold mt-2",children:["C$",wr(Be.ISLA.sales)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Diferencia vs esperado (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold mt-2",children:["C$",wr(je.ISLA)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado (precio proveedor)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",wr(pt)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Sumatoria rdenes maestras (perodo)"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad neta (rdenes vendedor)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",wr(ie.net)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"U bruta  Gastos  U vendedor"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados (maestras)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:Hs(Qe.orderedPacksMaster)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Restantes (perodo):"," ",i.jsx("strong",{children:Hs(Qe.remainingPacksMaster)})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Existencia global (todas):"," ",i.jsx("strong",{children:Hs(Ce.masterRemainingPackages)})]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados (rdenes vendedor)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:Hs(Qe.orderedPacksVendor)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Restantes (perodo):"," ",i.jsx("strong",{children:Hs(Qe.remainingPacksVendor)})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Existencia global (todas):"," ",i.jsx("strong",{children:Hs(Ce.vendorRemainingPackages)})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado a precio proveedor (rdenes vendedor)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",wr(Qe.providerTotalVendor)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Productos dispersados (precio venta)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",wr(te.dispersedTotal)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Sumatoria rdenes de vendedores (perodo)"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Dispersado Isla (precio venta)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",wr(te.dispersedIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Usado para Total existente"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total existente en productos (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",wr(te.totalExistenteIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Esperado Isla  Dispersado Isla"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"CxC (ventas crdito)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",wr($e.cxc)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",wr(he.commCredit)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Recaudacin (abonos)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",wr($e.recaudado)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"abonos en ar_movements"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad bruta crdito (ventas  comisin)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",wr($e.utilidadBruta)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Paquetes vendidos al crdito"})]})]}),i.jsxs("div",{className:"border rounded-2xl p-3 sm:p-4 mb-4 shadow-sm bg-white border-gray-100",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[i.jsx("h3",{className:"font-semibold text-sm sm:text-base",children:"rdenes de vendedores (Global)"}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Basado en ",i.jsx("strong",{children:"precio de venta"})," (por sucursal del vendedor)"]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-2 text-sm",children:[i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total orden:"," ",i.jsxs("strong",{children:["C$",wr(me.global.totalOrden)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Vendido:"," ",i.jsxs("strong",{children:["C$",wr(me.global.vendido)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Restante:"," ",i.jsxs("strong",{children:["C$",wr(me.global.restante)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Comisin:"," ",i.jsxs("strong",{children:["C$",wr(me.global.comision)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total esperado:"," ",i.jsxs("strong",{children:["C$",wr(me.global.totalEsperado)]})]})]})]}),i.jsxs("div",{className:"border rounded-2xl p-3 sm:p-4 mb-6 shadow-sm bg-white border-gray-100",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2 mb-3",children:[i.jsx("h3",{className:"font-semibold text-sm sm:text-base",children:"rdenes de vendedores (Detalle por orden)"}),i.jsx("div",{className:"text-xs text-gray-500",children:"Click/Tap en una orden para ver productos asociados/vendidos/restantes"})]}),me.orders.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:""}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"md:hidden space-y-2",children:me.orders.map(T=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:T.orderId}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1 truncate",children:[T.sellerName," ",T.branch?` ${T.branch}`:""," ",T.date?` ${T.date}`:""]})]}),i.jsx("button",{className:"px-3 py-2 rounded-lg bg-gray-800 text-white text-sm font-semibold",onClick:()=>we(T.orderKey),children:"Ver"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total"}),i.jsxs("div",{className:"font-bold",children:["C$",wr(T.totalOrden)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendido"}),i.jsxs("div",{className:"font-bold",children:["C$",wr(T.vendido)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Restante"}),i.jsxs("div",{className:"font-bold",children:["C$",wr(T.restante)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),i.jsxs("div",{className:"font-bold",children:["C$",wr(T.comision)]})]})]})]},T.orderKey))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total orden"}),i.jsx("th",{className:"border p-2",children:"Vendido"}),i.jsx("th",{className:"border p-2",children:"Restante"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Total esperado"}),i.jsx("th",{className:"border p-2",children:"Accin"})]})}),i.jsx("tbody",{children:me.orders.map(T=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:T.sellerName}),i.jsx("td",{className:"border p-2",children:T.branch||""}),i.jsx("td",{className:"border p-2",children:T.date||""}),i.jsxs("td",{className:"border p-2",children:["C$",wr(T.totalOrden)]}),i.jsxs("td",{className:"border p-2",children:["C$",wr(T.vendido)]}),i.jsxs("td",{className:"border p-2",children:["C$",wr(T.restante)]}),i.jsxs("td",{className:"border p-2",children:["C$",wr(T.comision)]}),i.jsxs("td",{className:"border p-2",children:["C$",wr(T.totalEsperado)]}),i.jsx("td",{className:"border p-2",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-3 py-2 rounded-lg hover:bg-black",onClick:()=>we(T.orderKey),children:"Ver detalle"})})]},T.orderKey))})]})}),de&&i.jsxs("div",{className:"mt-4 rounded-2xl border-2 border-gray-100 p-3 sm:p-4 shadow-lg bg-white",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-3",children:[i.jsxs("h4",{className:"text-base sm:text-xl font-semibold truncate",children:["Detalle orden vendedor  ",de.orderId]}),i.jsx("button",{onClick:()=>we(""),className:"w-full sm:w-auto text-sm px-3 py-2 border rounded-lg hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-2 text-sm mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total orden:"," ",i.jsxs("strong",{children:["C$",wr(de.totalOrden)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Vendido:"," ",i.jsxs("strong",{children:["C$",wr(de.vendido)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Restante:"," ",i.jsxs("strong",{children:["C$",wr(de.restante)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Comisin:"," ",i.jsxs("strong",{children:["C$",wr(de.comision)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total esperado:"," ",i.jsxs("strong",{children:["C$",wr(de.totalEsperado)]})]})]}),i.jsx("h5",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Productos asociados (Nombre - Asociados - Vendidos - Restantes)"}),i.jsx("div",{className:"md:hidden space-y-2",children:de.products.map(T=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsx("div",{className:"font-semibold",children:T.productName}),i.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Asociados"}),i.jsx("div",{className:"font-bold",children:T.asociados})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendidos"}),i.jsx("div",{className:"font-bold",children:T.vendidos})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Restantes"}),i.jsx("div",{className:"font-bold",children:T.restantes})]})]})]},T.productName))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:"Nombre producto"}),i.jsx("th",{className:"border p-2",children:"Asociados"}),i.jsx("th",{className:"border p-2",children:"Vendidos"}),i.jsx("th",{className:"border p-2",children:"Restantes"})]})}),i.jsxs("tbody",{children:[de.products.map(T=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:T.productName}),i.jsx("td",{className:"border p-2",children:T.asociados}),i.jsx("td",{className:"border p-2",children:T.vendidos}),i.jsx("td",{className:"border p-2",children:T.restantes})]},T.productName)),de.products.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center text-gray-500",children:"Sin productos."})})]})]})})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Existencia global (maestras)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:Hs(Ce.masterRemainingPackages)}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"remainingPackages (todas)"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Existencia global (vendedores)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:Hs(Ce.vendorRemainingPackages)}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"remainingPackages (todas)"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin cash)"}),Ae.cashArr.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-auto pr-1",children:Ae.cashArr.map(T=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:T.name}),i.jsxs("strong",{className:"ml-2",children:["C$",wr(T.total)]})]},T.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin crdito)"}),Ae.creditArr.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-auto pr-1",children:Ae.creditArr.map(T=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:T.name}),i.jsxs("strong",{className:"ml-2",children:["C$",wr(T.total)]})]},T.vendorId))})]})]}),i.jsxs("div",{className:"border rounded-2xl p-3 sm:p-4 mb-6 shadow-sm bg-white border-gray-100",children:[i.jsxs("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:["Saldos pendientes (hasta ",l,")"]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 text-sm mb-3",children:[i.jsxs("div",{children:["Clientes con saldo: ",i.jsx("strong",{children:xt.count})]}),i.jsxs("div",{children:["Saldo total pendiente:"," ",i.jsxs("strong",{children:["C$",wr(xt.totalPending)]})]}),i.jsx("div",{className:"text-gray-500",children:"*Muestra top 20 por monto"})]}),xt.list.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:""}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"md:hidden space-y-2",children:xt.list.map(T=>i.jsxs("div",{className:"border rounded-xl p-3",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:T.name}),i.jsxs("div",{className:"text-sm font-bold whitespace-nowrap",children:["C$",wr(T.balance)]})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["ltimo abono: ",i.jsxs("b",{children:["C$",wr(T.lastPaymentAmount)]})]}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Fecha ult. abono:"," ",i.jsx("span",{className:"font-medium",children:T.lastPayment||""})]}),i.jsx("div",{className:"mt-2",children:i.jsx("button",{type:"button",onClick:()=>ze(T),className:"px-3 py-1 rounded bg-indigo-600 text-white text-xs hover:bg-indigo-700",children:"Ver"})})]},T.customerId))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Saldo pendiente"}),i.jsx("th",{className:"border p-2",children:"ltimo abono"}),i.jsx("th",{className:"border p-2",children:"Fecha ult. abono"}),i.jsx("th",{className:"border p-2",children:"Ver"})]})}),i.jsx("tbody",{children:xt.list.map(T=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:T.name}),i.jsxs("td",{className:"border p-2",children:["C$",wr(T.balance)]}),i.jsxs("td",{className:"border p-2",children:["C$",wr(T.lastPaymentAmount)]}),i.jsx("td",{className:"border p-2",children:T.lastPayment||""}),i.jsx("td",{className:"border p-2",children:i.jsx("button",{type:"button",onClick:()=>ze(T),className:"px-3 py-1 rounded bg-indigo-600 text-white text-xs hover:bg-indigo-700",children:"Ver"})})]},T.customerId))})]})})]})]}),i.jsxs("div",{className:"mb-3 flex flex-col sm:flex-row sm:items-center gap-2",children:[i.jsxs("h3",{className:"font-semibold text-sm sm:text-base",children:["Tabla principal (Agrupar por: ",E,")"]}),i.jsx("span",{className:"text-xs text-gray-500 sm:ml-auto",children:"Tap/Click en Ver detalle para drill-down"})]}),k?i.jsx("p",{className:"text-sm",children:"Cargando..."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"md:hidden space-y-2 mb-6",children:nt.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-center text-gray-500",children:"Sin datos con los filtros seleccionados."}):nt.map(T=>i.jsxs("div",{className:"border rounded-2xl p-3 shadow-sm bg-white",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:T.label}),i.jsx("button",{className:"px-3 py-2 rounded-lg bg-gray-800 text-white text-sm font-semibold",onClick:()=>Pe(T.key),children:"Ver detalle"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"font-bold",children:Hs(T.packsCash)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"font-bold",children:Hs(T.packsCredit)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsxs("div",{className:"font-bold",children:["C$",wr(T.salesCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",wr(T.salesCredit)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash"}),i.jsxs("div",{className:"font-bold",children:["C$",wr(T.commCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",wr(T.commCredit)]})]})]})]},T.key))}),i.jsx("div",{className:"hidden md:block overflow-x-auto mb-6 shadow-2xl rounded-xl border",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:E==="DIA"?"Da":E==="VENDEDOR"?"Vendedor":E==="PRODUCTO"?"Producto":"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"}),i.jsx("th",{className:"border p-2",children:"Opciones"})]})}),i.jsxs("tbody",{children:[nt.map(T=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:T.label}),i.jsx("td",{className:"border p-2",children:Hs(T.packsCash)}),i.jsx("td",{className:"border p-2",children:Hs(T.packsCredit)}),i.jsxs("td",{className:"border p-2",children:["C$",wr(T.salesCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",wr(T.salesCredit)]}),i.jsxs("td",{className:"border p-2",children:["C$",wr(T.commCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",wr(T.commCredit)]}),i.jsx("td",{className:"border p-2",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-3 py-2 rounded-lg hover:bg-black",onClick:()=>Pe(T.key),children:"Ver detalle"})})]},T.key)),nt.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Sin datos con los filtros seleccionados."})})]})]})})]}),re&&i.jsxs("div",{className:"rounded-2xl shadow-lg p-3 sm:p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-3",children:[i.jsxs("h2",{className:"text-base sm:text-xl font-semibold truncate",children:["Detalle "," ",((it=nt.find(T=>T.key===re))==null?void 0:it.label)||re]}),i.jsx("button",{onClick:()=>Pe(""),className:"w-full sm:w-auto text-sm px-3 py-2 border rounded-lg hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 text-sm mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total Ventas cash:"," ",i.jsxs("strong",{children:["C$",wr(vt.filter(T=>T.type==="CONTADO").reduce((T,M)=>T+yr(M.amount),0))]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total Ventas crdito:"," ",i.jsxs("strong",{children:["C$",wr(vt.filter(T=>T.type==="CREDITO").reduce((T,M)=>T+yr(M.amount),0))]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total paquetes cash:"," ",i.jsx("strong",{children:Hs(vt.filter(T=>T.type==="CONTADO").reduce((T,M)=>T+yr(M.packages),0))})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total paquetes crdito:"," ",i.jsx("strong",{children:Hs(vt.filter(T=>T.type==="CREDITO").reduce((T,M)=>T+yr(M.packages),0))})]})]}),i.jsx("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Ventas incluidas"}),i.jsx("div",{className:"md:hidden space-y-2 mb-4",children:vt.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-center text-gray-500",children:"Sin detalle."}):vt.map(T=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:T.productName}),i.jsxs("div",{className:"text-sm font-bold whitespace-nowrap",children:["C$",wr(T.amount)]})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Vendedor:"," ",i.jsx("span",{className:"font-medium",children:T.vendorName})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Tipo"}),i.jsx("div",{className:"font-bold",children:T.type==="CREDITO"?"Crdito":"Cash"})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Sucursal"}),i.jsx("div",{className:"font-bold",children:T.branch||""})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("div",{className:"font-bold",children:Hs(T.packages)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),i.jsxs("div",{className:"font-bold",children:["C$",wr(T.commission)]})]})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Fecha: ",T.date]})]},T.id))}),i.jsx("div",{className:"hidden md:block overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"})]})}),i.jsxs("tbody",{children:[vt.map(T=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2",children:T.vendorName}),i.jsx("td",{className:"border p-2",children:T.productName}),i.jsx("td",{className:"border p-2",children:T.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-2",children:T.branch||""}),i.jsx("td",{className:"border p-2",children:Hs(T.packages)}),i.jsxs("td",{className:"border p-2",children:["C$",wr(T.amount)]}),i.jsxs("td",{className:"border p-2",children:["C$",wr(T.commission)]}),i.jsx("td",{className:"border p-2",children:T.date})]},T.id)),vt.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Sin detalle."})})]})]})}),i.jsx("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Consolidado por producto"}),i.jsx("div",{className:"md:hidden space-y-2",children:ht.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-center text-gray-500",children:"Sin consolidado."}):ht.map(T=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsx("div",{className:"font-semibold",children:T.productName}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paq cash"}),i.jsx("div",{className:"font-bold",children:Hs(T.packsCash)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paq crdito"}),i.jsx("div",{className:"font-bold",children:Hs(T.packsCredit)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsxs("div",{className:"font-bold",children:["C$",wr(T.salesCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",wr(T.salesCredit)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Com cash"}),i.jsxs("div",{className:"font-bold",children:["C$",wr(T.commCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Com crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",wr(T.commCredit)]})]})]})]},T.productName))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"})]})}),i.jsxs("tbody",{children:[ht.map(T=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:T.productName}),i.jsx("td",{className:"border p-2",children:Hs(T.packsCash)}),i.jsx("td",{className:"border p-2",children:Hs(T.packsCredit)}),i.jsxs("td",{className:"border p-2",children:["C$",wr(T.salesCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",wr(T.salesCredit)]}),i.jsxs("td",{className:"border p-2",children:["C$",wr(T.commCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",wr(T.commCredit)]})]},T.productName)),ht.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"p-4 text-center text-gray-500",children:"Sin consolidado."})})]})]})})]})]})]}),D&&i.jsx("p",{className:"mt-3 text-sm",children:D})]}),Me&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-lg",children:Me.name}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Saldo pendiente: ",i.jsxs("b",{children:["C$",wr(Me.balance)]})]})]}),i.jsx("button",{type:"button",onClick:()=>ze(null),className:"text-sm text-gray-500 hover:text-gray-700",children:""})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Saldo"})]})}),i.jsx("tbody",{children:Xe.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"border p-2 text-center text-gray-500",children:"Sin movimientos."})}):Xe.map(T=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:T.date||""}),i.jsx("td",{className:"border p-1",children:T.type||""}),i.jsxs("td",{className:"border p-1",children:["C$",wr(T.amount)]}),i.jsxs("td",{className:"border p-1",children:["C$",wr(T.running)]})]},T.id))})]})}),i.jsx("div",{className:"mt-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Monto"})]})}),i.jsx("tbody",{children:be.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"border p-2 text-center text-gray-500",children:"Sin ventas asociadas."})}):be.map(T=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:T.date||""}),i.jsx("td",{className:"border p-1",children:T.productName||""}),i.jsx("td",{className:"border p-1",children:T.vendorName||""}),i.jsx("td",{className:"border p-1",children:T.type||""}),i.jsxs("td",{className:"border p-1",children:["C$",wr(T.amount)]})]},T.id))})]})})]})})]}):i.jsxs("div",{className:"max-w-5xl mx-auto p-3 sm:p-4 md:p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-lg md:text-xl font-bold",children:"Data Center - Dulces"}),i.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"No autorizado."})]})}function bse(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(r=bse(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function La(){for(var t,e,r=0,n="",a=arguments.length;r<a;r++)(t=arguments[r])&&(e=bse(t))&&(n&&(n+=" "),n+=e);return n}var KQe=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function ER(t){if(typeof t!="string")return!1;var e=KQe;return e.includes(t)}var qQe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],zQe=new Set(qQe);function wse(t){return typeof t!="string"?!1:zQe.has(t)}function Nse(t){return typeof t=="string"&&t.startsWith("data-")}function qf(t){if(typeof t!="object"||t===null)return{};var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(wse(r)||Nse(r))&&(e[r]=t[r]);return e}function L2(t){if(t==null)return null;if(x.isValidElement(t)&&typeof t.props=="object"&&t.props!==null){var e=t.props;return qf(e)}return typeof t=="object"&&!Array.isArray(t)?qf(t):null}function pd(t){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(wse(r)||Nse(r)||ER(r))&&(e[r]=t[r]);return e}var WQe=["children","width","height","viewBox","className","style","title","desc"];function sF(){return sF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},sF.apply(null,arguments)}function XQe(t,e){if(t==null)return{};var r,n,a=YQe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function YQe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var SR=x.forwardRef((t,e)=>{var{children:r,width:n,height:a,viewBox:s,className:o,style:l,title:c,desc:u}=t,d=XQe(t,WQe),f=s||{width:n,height:a,x:0,y:0},A=La("recharts-surface",o);return x.createElement("svg",sF({},pd(d),{className:A,width:n,height:a,style:l,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:e}),x.createElement("title",null,c),x.createElement("desc",null,u),r)}),JQe=["children","className"];function iF(){return iF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},iF.apply(null,arguments)}function ZQe(t,e){if(t==null)return{};var r,n,a=eVe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function eVe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var fc=x.forwardRef((t,e)=>{var{children:r,className:n}=t,a=ZQe(t,JQe),s=La("recharts-layer",n);return x.createElement("g",iF({className:s},pd(a),{ref:e}),r)}),Cse=x.createContext(null),tVe=()=>x.useContext(Cse);function rs(t){return function(){return t}}const _se=Math.cos,zS=Math.sin,Af=Math.sqrt,WS=Math.PI,oP=2*WS,oF=Math.PI,lF=2*oF,tp=1e-6,rVe=lF-tp;function Ese(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function nVe(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Ese;const r=10**e;return function(n){this._+=n[0];for(let a=1,s=n.length;a<s;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class aVe{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Ese:nVe(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,a){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(e,r,n,a,s,o){this._append`C${+e},${+r},${+n},${+a},${this._x1=+s},${this._y1=+o}`}arcTo(e,r,n,a,s){if(e=+e,r=+r,n=+n,a=+a,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,l=this._y1,c=n-e,u=a-r,d=o-e,f=l-r,A=d*d+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(A>tp)if(!(Math.abs(f*c-u*d)>tp)||!s)this._append`L${this._x1=e},${this._y1=r}`;else{let h=n-o,m=a-l,p=c*c+u*u,g=h*h+m*m,v=Math.sqrt(p),y=Math.sqrt(A),b=s*Math.tan((oF-Math.acos((p+A-g)/(2*v*y)))/2),w=b/y,j=b/v;Math.abs(w-1)>tp&&this._append`L${e+w*d},${r+w*f}`,this._append`A${s},${s},0,0,${+(f*h>d*m)},${this._x1=e+j*c},${this._y1=r+j*u}`}}arc(e,r,n,a,s,o){if(e=+e,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),u=e+l,d=r+c,f=1^o,A=o?a-s:s-a;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>tp||Math.abs(this._y1-d)>tp)&&this._append`L${u},${d}`,n&&(A<0&&(A=A%lF+lF),A>rVe?this._append`A${n},${n},0,1,${f},${e-l},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:A>tp&&this._append`A${n},${n},0,${+(A>=oF)},${f},${this._x1=e+n*Math.cos(s)},${this._y1=r+n*Math.sin(s)}`)}rect(e,r,n,a){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function IR(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new aVe(e)}function jR(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Sse(t){this._context=t}Sse.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function lP(t){return new Sse(t)}function Ise(t){return t[0]}function jse(t){return t[1]}function Pse(t,e){var r=rs(!0),n=null,a=lP,s=null,o=IR(l);t=typeof t=="function"?t:t===void 0?Ise:rs(t),e=typeof e=="function"?e:e===void 0?jse:rs(e);function l(c){var u,d=(c=jR(c)).length,f,A=!1,h;for(n==null&&(s=a(h=o())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===A&&((A=!A)?s.lineStart():s.lineEnd()),A&&s.point(+t(f,u,c),+e(f,u,c));if(h)return s=null,h+""||null}return l.x=function(c){return arguments.length?(t=typeof c=="function"?c:rs(+c),l):t},l.y=function(c){return arguments.length?(e=typeof c=="function"?c:rs(+c),l):e},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:rs(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(s=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=s=null:s=a(n=c),l):n},l}function a_(t,e,r){var n=null,a=rs(!0),s=null,o=lP,l=null,c=IR(u);t=typeof t=="function"?t:t===void 0?Ise:rs(+t),e=typeof e=="function"?e:rs(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?jse:rs(+r);function u(f){var A,h,m,p=(f=jR(f)).length,g,v=!1,y,b=new Array(p),w=new Array(p);for(s==null&&(l=o(y=c())),A=0;A<=p;++A){if(!(A<p&&a(g=f[A],A,f))===v)if(v=!v)h=A,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),m=A-1;m>=h;--m)l.point(b[m],w[m]);l.lineEnd(),l.areaEnd()}v&&(b[A]=+t(g,A,f),w[A]=+e(g,A,f),l.point(n?+n(g,A,f):b[A],r?+r(g,A,f):w[A]))}if(y)return l=null,y+""||null}function d(){return Pse().defined(a).curve(o).context(s)}return u.x=function(f){return arguments.length?(t=typeof f=="function"?f:rs(+f),n=null,u):t},u.x0=function(f){return arguments.length?(t=typeof f=="function"?f:rs(+f),u):t},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:rs(+f),u):n},u.y=function(f){return arguments.length?(e=typeof f=="function"?f:rs(+f),r=null,u):e},u.y0=function(f){return arguments.length?(e=typeof f=="function"?f:rs(+f),u):e},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:rs(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(t).y(e)},u.lineY1=function(){return d().x(t).y(r)},u.lineX1=function(){return d().x(n).y(e)},u.defined=function(f){return arguments.length?(a=typeof f=="function"?f:rs(!!f),u):a},u.curve=function(f){return arguments.length?(o=f,s!=null&&(l=o(s)),u):o},u.context=function(f){return arguments.length?(f==null?s=l=null:l=o(s=f),u):s},u}class Bse{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function sVe(t){return new Bse(t,!0)}function iVe(t){return new Bse(t,!1)}const PR={draw(t,e){const r=Af(e/WS);t.moveTo(r,0),t.arc(0,0,r,0,oP)}},oVe={draw(t,e){const r=Af(e/5)/2;t.moveTo(-3*r,-r),t.lineTo(-r,-r),t.lineTo(-r,-3*r),t.lineTo(r,-3*r),t.lineTo(r,-r),t.lineTo(3*r,-r),t.lineTo(3*r,r),t.lineTo(r,r),t.lineTo(r,3*r),t.lineTo(-r,3*r),t.lineTo(-r,r),t.lineTo(-3*r,r),t.closePath()}},Tse=Af(1/3),lVe=Tse*2,cVe={draw(t,e){const r=Af(e/lVe),n=r*Tse;t.moveTo(0,-r),t.lineTo(n,0),t.lineTo(0,r),t.lineTo(-n,0),t.closePath()}},uVe={draw(t,e){const r=Af(e),n=-r/2;t.rect(n,n,r,r)}},dVe=.8908130915292852,kse=zS(WS/10)/zS(7*WS/10),fVe=zS(oP/10)*kse,hVe=-_se(oP/10)*kse,AVe={draw(t,e){const r=Af(e*dVe),n=fVe*r,a=hVe*r;t.moveTo(0,-r),t.lineTo(n,a);for(let s=1;s<5;++s){const o=oP*s/5,l=_se(o),c=zS(o);t.lineTo(c*r,-l*r),t.lineTo(l*n-c*a,c*n+l*a)}t.closePath()}},W5=Af(3),mVe={draw(t,e){const r=-Af(e/(W5*3));t.moveTo(0,r*2),t.lineTo(-W5*r,-r),t.lineTo(W5*r,-r),t.closePath()}},Uu=-.5,Qu=Af(3)/2,cF=1/Af(12),pVe=(cF/2+1)*3,gVe={draw(t,e){const r=Af(e/pVe),n=r/2,a=r*cF,s=n,o=r*cF+r,l=-s,c=o;t.moveTo(n,a),t.lineTo(s,o),t.lineTo(l,c),t.lineTo(Uu*n-Qu*a,Qu*n+Uu*a),t.lineTo(Uu*s-Qu*o,Qu*s+Uu*o),t.lineTo(Uu*l-Qu*c,Qu*l+Uu*c),t.lineTo(Uu*n+Qu*a,Uu*a-Qu*n),t.lineTo(Uu*s+Qu*o,Uu*o-Qu*s),t.lineTo(Uu*l+Qu*c,Uu*c-Qu*l),t.closePath()}};function xVe(t,e){let r=null,n=IR(a);t=typeof t=="function"?t:rs(t||PR),e=typeof e=="function"?e:rs(e===void 0?64:+e);function a(){let s;if(r||(r=s=n()),t.apply(this,arguments).draw(r,+e.apply(this,arguments)),s)return r=null,s+""||null}return a.type=function(s){return arguments.length?(t=typeof s=="function"?s:rs(s),a):t},a.size=function(s){return arguments.length?(e=typeof s=="function"?s:rs(+s),a):e},a.context=function(s){return arguments.length?(r=s??null,a):r},a}function XS(){}function YS(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function Fse(t){this._context=t}Fse.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:YS(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:YS(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function vVe(t){return new Fse(t)}function Ose(t){this._context=t}Ose.prototype={areaStart:XS,areaEnd:XS,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:YS(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function yVe(t){return new Ose(t)}function Dse(t){this._context=t}Dse.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:YS(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function bVe(t){return new Dse(t)}function Rse(t){this._context=t}Rse.prototype={areaStart:XS,areaEnd:XS,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function wVe(t){return new Rse(t)}function iG(t){return t<0?-1:1}function oG(t,e,r){var n=t._x1-t._x0,a=e-t._x1,s=(t._y1-t._y0)/(n||a<0&&-0),o=(r-t._y1)/(a||n<0&&-0),l=(s*a+o*n)/(n+a);return(iG(s)+iG(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(l))||0}function lG(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function X5(t,e,r){var n=t._x0,a=t._y0,s=t._x1,o=t._y1,l=(s-n)/3;t._context.bezierCurveTo(n+l,a+l*e,s-l,o-l*r,s,o)}function JS(t){this._context=t}JS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:X5(this,this._t0,lG(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,X5(this,lG(this,r=oG(this,t,e)),r);break;default:X5(this,this._t0,r=oG(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function Mse(t){this._context=new Lse(t)}(Mse.prototype=Object.create(JS.prototype)).point=function(t,e){JS.prototype.point.call(this,e,t)};function Lse(t){this._context=t}Lse.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,a,s){this._context.bezierCurveTo(e,t,n,r,s,a)}};function NVe(t){return new JS(t)}function CVe(t){return new Mse(t)}function Use(t){this._context=t}Use.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=cG(t),a=cG(e),s=0,o=1;o<r;++s,++o)this._context.bezierCurveTo(n[0][s],a[0][s],n[1][s],a[1][s],t[o],e[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function cG(t){var e,r=t.length-1,n,a=new Array(r),s=new Array(r),o=new Array(r);for(a[0]=0,s[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)a[e]=1,s[e]=4,o[e]=4*t[e]+2*t[e+1];for(a[r-1]=2,s[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=a[e]/s[e-1],s[e]-=n,o[e]-=n*o[e-1];for(a[r-1]=o[r-1]/s[r-1],e=r-2;e>=0;--e)a[e]=(o[e]-a[e+1])/s[e];for(s[r-1]=(t[r]+a[r-1])/2,e=0;e<r-1;++e)s[e]=2*t[e+1]-a[e+1];return[a,s]}function _Ve(t){return new Use(t)}function cP(t,e){this._context=t,this._t=e}cP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function EVe(t){return new cP(t,.5)}function SVe(t){return new cP(t,0)}function IVe(t){return new cP(t,1)}function lg(t,e){if((o=t.length)>1)for(var r=1,n,a,s=t[e[0]],o,l=s.length;r<o;++r)for(a=s,s=t[e[r]],n=0;n<l;++n)s[n][1]+=s[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function uF(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function jVe(t,e){return t[e]}function PVe(t){const e=[];return e.key=t,e}function BVe(){var t=rs([]),e=uF,r=lg,n=jVe;function a(s){var o=Array.from(t.apply(this,arguments),PVe),l,c=o.length,u=-1,d;for(const f of s)for(l=0,++u;l<c;++l)(o[l][u]=[0,+n(f,o[l].key,u,s)]).data=f;for(l=0,d=jR(e(o));l<c;++l)o[d[l]].index=l;return r(o,d),o}return a.keys=function(s){return arguments.length?(t=typeof s=="function"?s:rs(Array.from(s)),a):t},a.value=function(s){return arguments.length?(n=typeof s=="function"?s:rs(+s),a):n},a.order=function(s){return arguments.length?(e=s==null?uF:typeof s=="function"?s:rs(Array.from(s)),a):e},a.offset=function(s){return arguments.length?(r=s??lg,a):r},a}function TVe(t,e){if((n=t.length)>0){for(var r,n,a=0,s=t[0].length,o;a<s;++a){for(o=r=0;r<n;++r)o+=t[r][a][1]||0;if(o)for(r=0;r<n;++r)t[r][a][1]/=o}lg(t,e)}}function kVe(t,e){if((a=t.length)>0){for(var r=0,n=t[e[0]],a,s=n.length;r<s;++r){for(var o=0,l=0;o<a;++o)l+=t[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}lg(t,e)}}function FVe(t,e){if(!(!((o=t.length)>0)||!((s=(a=t[e[0]]).length)>0))){for(var r=0,n=1,a,s,o;n<s;++n){for(var l=0,c=0,u=0;l<o;++l){for(var d=t[e[l]],f=d[n][1]||0,A=d[n-1][1]||0,h=(f-A)/2,m=0;m<l;++m){var p=t[e[m]],g=p[n][1]||0,v=p[n-1][1]||0;h+=g-v}c+=f,u+=h*f}a[n-1][1]+=a[n-1][0]=r,c&&(r-=u/c)}a[n-1][1]+=a[n-1][0]=r,lg(t,e)}}var uP={},Qse={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==="__proto__"}t.isUnsafeProperty=e})(Qse);var BR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}t.isDeepKey=e})(BR);var dP={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}t.toKey=e})(dP);var fP={},Vse={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(e).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}t.toString=e})(Vse);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Vse,r=dP;function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=e.toString(a);const s=[],o=a.length;if(o===0)return s;let l=0,c="",u="",d=!1;for(a.charCodeAt(0)===46&&(s.push(""),l++);l<o;){const f=a[l];u?f==="\\"&&l+1<o?(l++,c+=a[l]):f===u?u="":c+=f:d?f==='"'||f==="'"?u=f:f==="]"?(d=!1,s.push(c),c=""):c+=f:f==="["?(d=!0,c&&(s.push(c),c="")):f==="."?c&&(s.push(c),c=""):c+=f,l++}return c&&s.push(c),s}t.toPath=n})(fP);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Qse,r=BR,n=dP,a=fP;function s(l,c,u){if(l==null)return u;switch(typeof c){case"string":{if(e.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?r.isDeepKey(c)?s(l,a.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const d=l[c];return d===void 0?u:d}default:{if(Array.isArray(c))return o(l,c,u);if(Object.is(c==null?void 0:c.valueOf(),-0)?c="-0":c=String(c),e.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?u:d}}}function o(l,c,u){if(c.length===0)return u;let d=l;for(let f=0;f<c.length;f++){if(d==null||e.isUnsafeProperty(c[f]))return u;d=d[c[f]]}return d===void 0?u:d}t.get=s})(uP);var OVe=uP.get;const cg=mA(OVe);var DVe=4;function R0(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DVe,r=10**e,n=Math.round(t*r)/r;return Object.is(n,-0)?0:n}function oi(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t.reduce((a,s,o)=>{var l=r[o-1];return typeof l=="string"?a+l+s:l!==void 0?a+R0(l)+s:a+s},"")}var dl=t=>t===0?0:t>0?1:-1,zf=t=>typeof t=="number"&&t!=+t,lA=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,rn=t=>(typeof t=="number"||t instanceof Number)&&!zf(t),Wf=t=>rn(t)||typeof t=="string",RVe=0,U2=t=>{var e=++RVe;return"".concat(t||"").concat(e)},Ll=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!rn(e)&&typeof e!="string")return n;var s;if(lA(e)){if(r==null)return n;var o=e.indexOf("%");s=r*parseFloat(e.slice(0,o))/100}else s=+e;return zf(s)&&(s=n),a&&r!=null&&s>r&&(s=r),s},Hse=t=>{if(!Array.isArray(t))return!1;for(var e=t.length,r={},n=0;n<e;n++)if(!r[String(t[n])])r[String(t[n])]=!0;else return!0;return!1};function so(t,e,r){return rn(t)&&rn(e)?R0(t+r*(e-t)):e}function MVe(t,e,r){if(!(!t||!t.length))return t.find(n=>n&&(typeof e=="function"?e(n):cg(n,e))===r)}var Qo=t=>t===null||typeof t>"u",Mw=t=>Qo(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1));function LVe(t){return t!=null}function Lw(){}var UVe=["type","size","sizeType"];function dF(){return dF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},dF.apply(null,arguments)}function uG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function dG(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?uG(Object(r),!0).forEach(function(n){QVe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):uG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function QVe(t,e,r){return(e=VVe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VVe(t){var e=HVe(t,"string");return typeof e=="symbol"?e:e+""}function HVe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $Ve(t,e){if(t==null)return{};var r,n,a=GVe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function GVe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var $se={symbolCircle:PR,symbolCross:oVe,symbolDiamond:cVe,symbolSquare:uVe,symbolStar:AVe,symbolTriangle:mVe,symbolWye:gVe},KVe=Math.PI/180,qVe=t=>{var e="symbol".concat(Mw(t));return $se[e]||PR},zVe=(t,e,r)=>{if(e==="area")return t;switch(r){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var n=18*KVe;return 1.25*t*t*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},WVe=(t,e)=>{$se["symbol".concat(Mw(t))]=e},TR=t=>{var{type:e="circle",size:r=64,sizeType:n="area"}=t,a=$Ve(t,UVe),s=dG(dG({},a),{},{type:e,size:r,sizeType:n}),o="circle";typeof e=="string"&&(o=e);var l=()=>{var A=qVe(o),h=xVe().type(A).size(zVe(r,n,o)),m=h();if(m!==null)return m},{className:c,cx:u,cy:d}=s,f=pd(s);return rn(u)&&rn(d)&&rn(r)?x.createElement("path",dF({},f,{className:La("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(d,")"),d:l()})):null};TR.registerSymbol=WVe;var Gse=t=>"radius"in t&&"startAngle"in t&&"endAngle"in t,XVe=(t,e)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(x.isValidElement(t)&&(r=t.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{ER(a)&&(n[a]=s=>r[a](r,s))}),n},YVe=(t,e,r)=>n=>(t(e,r,n),null),Uw=(t,e,r)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var n=null;return Object.keys(t).forEach(a=>{var s=t[a];ER(a)&&typeof s=="function"&&(n||(n={}),n[a]=YVe(s,e,r))}),n};function fG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function JVe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?fG(Object(r),!0).forEach(function(n){ZVe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ZVe(t,e,r){return(e=eHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eHe(t){var e=tHe(t,"string");return typeof e=="symbol"?e:e+""}function tHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Al(t,e){var r=JVe({},t),n=e,a=Object.keys(e),s=a.reduce((o,l)=>(o[l]===void 0&&n[l]!==void 0&&(o[l]=n[l]),o),r);return s}function ZS(){return ZS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ZS.apply(null,arguments)}function hG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function rHe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?hG(Object(r),!0).forEach(function(n){nHe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function nHe(t,e,r){return(e=aHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aHe(t){var e=sHe(t,"string");return typeof e=="symbol"?e:e+""}function sHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var zu=32,iHe={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function oHe(t){var{data:e,iconType:r,inactiveColor:n}=t,a=zu/2,s=zu/6,o=zu/3,l=e.inactive?n:e.color,c=r??e.type;if(c==="none")return null;if(c==="plainline"){var u;return x.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:(u=e.payload)===null||u===void 0?void 0:u.strokeDasharray,x1:0,y1:a,x2:zu,y2:a,className:"recharts-legend-icon"})}if(c==="line")return x.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(a,"h").concat(o,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*o,",").concat(a,`
            H`).concat(zu,"M").concat(2*o,",").concat(a,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(o,",").concat(a),className:"recharts-legend-icon"});if(c==="rect")return x.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(zu/8,"h").concat(zu,"v").concat(zu*3/4,"h").concat(-zu,"z"),className:"recharts-legend-icon"});if(x.isValidElement(e.legendIcon)){var d=rHe({},e);return delete d.legendIcon,x.cloneElement(e.legendIcon,d)}return x.createElement(TR,{fill:l,cx:a,cy:a,size:zu,sizeType:"diameter",type:c})}function lHe(t){var{payload:e,iconSize:r,layout:n,formatter:a,inactiveColor:s,iconType:o}=t,l={x:0,y:0,width:zu,height:zu},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return e.map((d,f)=>{var A=d.formatter||a,h=La({"recharts-legend-item":!0,["legend-item-".concat(f)]:!0,inactive:d.inactive});if(d.type==="none")return null;var m=d.inactive?s:d.color,p=A?A(d.value,d,f):d.value;return x.createElement("li",ZS({className:h,style:c,key:"legend-item-".concat(f)},Uw(t,d,f)),x.createElement(SR,{width:r,height:r,viewBox:l,style:u,"aria-label":"".concat(p," legend icon")},x.createElement(oHe,{data:d,iconType:o,inactiveColor:s})),x.createElement("span",{className:"recharts-legend-item-text",style:{color:m}},p))})}var cHe=t=>{var e=Al(t,iHe),{payload:r,layout:n,align:a}=e;if(!r||!r.length)return null;var s={padding:0,margin:0,textAlign:n==="horizontal"?a:"left"};return x.createElement("ul",{className:"recharts-default-legend",style:s},x.createElement(lHe,ZS({},e,{payload:r})))},Kse={},qse={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){const a=new Map;for(let s=0;s<r.length;s++){const o=r[s],l=n(o);a.has(l)||a.set(l,o)}return Array.from(a.values())}t.uniqBy=e})(qse);var kR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r}t.identity=e})(kR);var zse={},hP={},Wse={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Number.isSafeInteger(r)&&r>=0}t.isLength=e})(Wse);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Wse;function r(n){return n!=null&&typeof n!="function"&&e.isLength(n.length)}t.isArrayLike=r})(hP);var Xse={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="object"&&r!==null}t.isObjectLike=e})(Xse);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=hP,r=Xse;function n(a){return r.isObjectLike(a)&&e.isArrayLike(a)}t.isArrayLikeObject=n})(zse);var Yse={},Jse={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=uP;function r(n){return function(a){return e.get(a,n)}}t.property=r})(Jse);var Zse={},FR={},eie={},OR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r!==null&&(typeof r=="object"||typeof r=="function")}t.isObject=e})(OR);var DR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null||typeof r!="object"&&typeof r!="function"}t.isPrimitive=e})(DR);var RR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}t.eq=e})(RR);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=OR,r=DR,n=RR;function a(d,f,A){return typeof A!="function"?a(d,f,()=>{}):s(d,f,function h(m,p,g,v,y,b){const w=A(m,p,g,v,y,b);return w!==void 0?!!w:s(m,p,h,b)},new Map)}function s(d,f,A,h){if(f===d)return!0;switch(typeof f){case"object":return o(d,f,A,h);case"function":return Object.keys(f).length>0?s(d,{...f},A,h):n.eq(d,f);default:return e.isObject(d)?typeof f=="string"?f==="":!0:n.eq(d,f)}}function o(d,f,A,h){if(f==null)return!0;if(Array.isArray(f))return c(d,f,A,h);if(f instanceof Map)return l(d,f,A,h);if(f instanceof Set)return u(d,f,A,h);const m=Object.keys(f);if(d==null||r.isPrimitive(d))return m.length===0;if(m.length===0)return!0;if(h!=null&&h.has(f))return h.get(f)===d;h==null||h.set(f,d);try{for(let p=0;p<m.length;p++){const g=m[p];if(!r.isPrimitive(d)&&!(g in d)||f[g]===void 0&&d[g]!==void 0||f[g]===null&&d[g]!==null||!A(d[g],f[g],g,d,f,h))return!1}return!0}finally{h==null||h.delete(f)}}function l(d,f,A,h){if(f.size===0)return!0;if(!(d instanceof Map))return!1;for(const[m,p]of f.entries()){const g=d.get(m);if(A(g,p,m,d,f,h)===!1)return!1}return!0}function c(d,f,A,h){if(f.length===0)return!0;if(!Array.isArray(d))return!1;const m=new Set;for(let p=0;p<f.length;p++){const g=f[p];let v=!1;for(let y=0;y<d.length;y++){if(m.has(y))continue;const b=d[y];let w=!1;if(A(b,g,p,d,f,h)&&(w=!0),w){m.add(y),v=!0;break}}if(!v)return!1}return!0}function u(d,f,A,h){return f.size===0?!0:d instanceof Set?c([...d],[...f],A,h):!1}t.isMatchWith=a,t.isSetMatch=u})(eie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=eie;function r(n,a){return e.isMatchWith(n,a,()=>{})}t.isMatch=r})(FR);var tie={},MR={},rie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}t.getSymbols=e})(rie);var LR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}t.getTag=e})(LR);var UR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",s="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",f="[object Function]",A="[object ArrayBuffer]",h="[object Object]",m="[object Error]",p="[object DataView]",g="[object Uint8Array]",v="[object Uint8ClampedArray]",y="[object Uint16Array]",b="[object Uint32Array]",w="[object BigUint64Array]",j="[object Int8Array]",I="[object Int16Array]",_="[object Int32Array]",S="[object BigInt64Array]",E="[object Float32Array]",F="[object Float64Array]";t.argumentsTag=s,t.arrayBufferTag=A,t.arrayTag=d,t.bigInt64ArrayTag=S,t.bigUint64ArrayTag=w,t.booleanTag=a,t.dataViewTag=p,t.dateTag=l,t.errorTag=m,t.float32ArrayTag=E,t.float64ArrayTag=F,t.functionTag=f,t.int16ArrayTag=I,t.int32ArrayTag=_,t.int8ArrayTag=j,t.mapTag=c,t.numberTag=n,t.objectTag=h,t.regexpTag=e,t.setTag=u,t.stringTag=r,t.symbolTag=o,t.uint16ArrayTag=y,t.uint32ArrayTag=b,t.uint8ArrayTag=g,t.uint8ClampedArrayTag=v})(UR);var nie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}t.isTypedArray=e})(nie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=rie,r=LR,n=UR,a=DR,s=nie;function o(d,f){return l(d,void 0,d,new Map,f)}function l(d,f,A,h=new Map,m=void 0){const p=m==null?void 0:m(d,f,A,h);if(p!==void 0)return p;if(a.isPrimitive(d))return d;if(h.has(d))return h.get(d);if(Array.isArray(d)){const g=new Array(d.length);h.set(d,g);for(let v=0;v<d.length;v++)g[v]=l(d[v],v,A,h,m);return Object.hasOwn(d,"index")&&(g.index=d.index),Object.hasOwn(d,"input")&&(g.input=d.input),g}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const g=new RegExp(d.source,d.flags);return g.lastIndex=d.lastIndex,g}if(d instanceof Map){const g=new Map;h.set(d,g);for(const[v,y]of d)g.set(v,l(y,v,A,h,m));return g}if(d instanceof Set){const g=new Set;h.set(d,g);for(const v of d)g.add(l(v,void 0,A,h,m));return g}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(s.isTypedArray(d)){const g=new(Object.getPrototypeOf(d)).constructor(d.length);h.set(d,g);for(let v=0;v<d.length;v++)g[v]=l(d[v],v,A,h,m);return g}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const g=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return h.set(d,g),c(g,d,A,h,m),g}if(typeof File<"u"&&d instanceof File){const g=new File([d],d.name,{type:d.type});return h.set(d,g),c(g,d,A,h,m),g}if(typeof Blob<"u"&&d instanceof Blob){const g=new Blob([d],{type:d.type});return h.set(d,g),c(g,d,A,h,m),g}if(d instanceof Error){const g=new d.constructor;return h.set(d,g),g.message=d.message,g.name=d.name,g.stack=d.stack,g.cause=d.cause,c(g,d,A,h,m),g}if(d instanceof Boolean){const g=new Boolean(d.valueOf());return h.set(d,g),c(g,d,A,h,m),g}if(d instanceof Number){const g=new Number(d.valueOf());return h.set(d,g),c(g,d,A,h,m),g}if(d instanceof String){const g=new String(d.valueOf());return h.set(d,g),c(g,d,A,h,m),g}if(typeof d=="object"&&u(d)){const g=Object.create(Object.getPrototypeOf(d));return h.set(d,g),c(g,d,A,h,m),g}return d}function c(d,f,A=d,h,m){const p=[...Object.keys(f),...e.getSymbols(f)];for(let g=0;g<p.length;g++){const v=p[g],y=Object.getOwnPropertyDescriptor(d,v);(y==null||y.writable)&&(d[v]=l(f[v],v,A,h,m))}}function u(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=o,t.cloneDeepWithImpl=l,t.copyProperties=c})(MR);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=MR;function r(n){return e.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}t.cloneDeep=r})(tie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=FR,r=tie;function n(a){return a=r.cloneDeep(a),s=>e.isMatch(s,a)}t.matches=n})(Zse);var aie={},sie={},iie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=MR,r=UR;function n(a,s){return e.cloneDeepWith(a,(o,l,c,u)=>{const d=s==null?void 0:s(o,l,c,u);if(d!==void 0)return d;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const f=new a.constructor(a==null?void 0:a.valueOf());return e.copyProperties(f,a),f}case r.argumentsTag:{const f={};return e.copyProperties(f,a),f.length=a.length,f[Symbol.iterator]=a[Symbol.iterator],f}default:return}})}t.cloneDeepWith=n})(iie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=iie;function r(n){return e.cloneDeepWith(n)}t.cloneDeep=r})(sie);var oie={},QR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return e.test(n)}}t.isIndex=r})(QR);var lie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=LR;function r(n){return n!==null&&typeof n=="object"&&e.getTag(n)==="[object Arguments]"}t.isArguments=r})(lie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=BR,r=QR,n=lie,a=fP;function s(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&e.isDeepKey(l)&&(o==null?void 0:o[l])==null?c=a.toPath(l):c=[l],c.length===0)return!1;let u=o;for(let d=0;d<c.length;d++){const f=c[d];if((u==null||!Object.hasOwn(u,f))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(f)&&f<u.length))return!1;u=u[f]}return!0}t.has=s})(oie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=FR,r=dP,n=sie,a=uP,s=oie;function o(l,c){switch(typeof l){case"object":{Object.is(l==null?void 0:l.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=n.cloneDeep(c),function(u){const d=a.get(u,l);return d===void 0?s.has(u,l):c===void 0?d===void 0:e.isMatch(d,c)}}t.matchesProperty=o})(aie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=kR,r=Jse,n=Zse,a=aie;function s(o){if(o==null)return e.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?a.matchesProperty(o[0],o[1]):n.matches(o);case"string":case"symbol":case"number":return r.property(o)}}t.iteratee=s})(Yse);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=qse,r=kR,n=zse,a=Yse;function s(o,l=r.identity){return n.isArrayLikeObject(o)?e.uniqBy(Array.from(o),a.iteratee(l)):[]}t.uniqBy=s})(Kse);var uHe=Kse.uniqBy;const AG=mA(uHe);function cie(t,e,r){return e===!0?AG(t,r):typeof e=="function"?AG(t,e):t}var uie={exports:{}},die={},fie={exports:{}},hie={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dv=x;function dHe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var fHe=typeof Object.is=="function"?Object.is:dHe,hHe=Dv.useState,AHe=Dv.useEffect,mHe=Dv.useLayoutEffect,pHe=Dv.useDebugValue;function gHe(t,e){var r=e(),n=hHe({inst:{value:r,getSnapshot:e}}),a=n[0].inst,s=n[1];return mHe(function(){a.value=r,a.getSnapshot=e,Y5(a)&&s({inst:a})},[t,r,e]),AHe(function(){return Y5(a)&&s({inst:a}),t(function(){Y5(a)&&s({inst:a})})},[t]),pHe(r),r}function Y5(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!fHe(t,r)}catch{return!0}}function xHe(t,e){return e()}var vHe=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?xHe:gHe;hie.useSyncExternalStore=Dv.useSyncExternalStore!==void 0?Dv.useSyncExternalStore:vHe;fie.exports=hie;var yHe=fie.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AP=x,bHe=yHe;function wHe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var NHe=typeof Object.is=="function"?Object.is:wHe,CHe=bHe.useSyncExternalStore,_He=AP.useRef,EHe=AP.useEffect,SHe=AP.useMemo,IHe=AP.useDebugValue;die.useSyncExternalStoreWithSelector=function(t,e,r,n,a){var s=_He(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=SHe(function(){function c(h){if(!u){if(u=!0,d=h,h=n(h),a!==void 0&&o.hasValue){var m=o.value;if(a(m,h))return f=m}return f=h}if(m=f,NHe(d,h))return m;var p=n(h);return a!==void 0&&a(m,p)?(d=h,m):(d=h,f=p)}var u=!1,d,f,A=r===void 0?null:r;return[function(){return c(e())},A===null?void 0:function(){return c(A())}]},[e,r,n,a]);var l=CHe(t,s[0],s[1]);return EHe(function(){o.hasValue=!0,o.value=l},[l]),IHe(l),l};uie.exports=die;var jHe=uie.exports,VR=x.createContext(null),PHe=t=>t,os=()=>{var t=x.useContext(VR);return t?t.store.dispatch:PHe},uE=()=>{},BHe=()=>uE,THe=(t,e)=>t===e;function Jr(t){var e=x.useContext(VR);return jHe.useSyncExternalStoreWithSelector(e?e.subscription.addNestedSub:BHe,e?e.store.getState:uE,e?e.store.getState:uE,e?t:uE,THe)}function kHe(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function FHe(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function OHe(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var mG=t=>Array.isArray(t)?t:[t];function DHe(t){const e=Array.isArray(t[0])?t[0]:t;return OHe(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function RHe(t,e){const r=[],{length:n}=t;for(let a=0;a<n;a++)r.push(t[a].apply(null,e));return r}var MHe=class{constructor(t){this.value=t}deref(){return this.value}},LHe=typeof WeakRef<"u"?WeakRef:MHe,UHe=0,pG=1;function s_(){return{s:UHe,v:void 0,o:null,p:null}}function Aie(t,e={}){let r=s_();const{resultEqualityCheck:n}=e;let a,s=0;function o(){var f;let l=r;const{length:c}=arguments;for(let A=0,h=c;A<h;A++){const m=arguments[A];if(typeof m=="function"||typeof m=="object"&&m!==null){let p=l.o;p===null&&(l.o=p=new WeakMap);const g=p.get(m);g===void 0?(l=s_(),p.set(m,l)):l=g}else{let p=l.p;p===null&&(l.p=p=new Map);const g=p.get(m);g===void 0?(l=s_(),p.set(m,l)):l=g}}const u=l;let d;if(l.s===pG)d=l.v;else if(d=t.apply(null,arguments),s++,n){const A=((f=a==null?void 0:a.deref)==null?void 0:f.call(a))??a;A!=null&&n(A,d)&&(d=A,s!==0&&s--),a=typeof d=="object"&&d!==null||typeof d=="function"?new LHe(d):d}return u.s=pG,u.v=d,d}return o.clearCache=()=>{r=s_(),o.resetResultsCount()},o.resultsCount=()=>s,o.resetResultsCount=()=>{s=0},o}function QHe(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...a)=>{let s=0,o=0,l,c={},u=a.pop();typeof u=="object"&&(c=u,u=a.pop()),kHe(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:f,memoizeOptions:A=[],argsMemoize:h=Aie,argsMemoizeOptions:m=[]}=d,p=mG(A),g=mG(m),v=DHe(a),y=f(function(){return s++,u.apply(null,arguments)},...p),b=h(function(){o++;const j=RHe(v,arguments);return l=y.apply(null,j),l},...g);return Object.assign(b,{resultFunc:u,memoizedResultFunc:y,dependencies:v,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:f,argsMemoize:h})};return Object.assign(n,{withTypes:()=>n}),n}var qt=QHe(Aie),VHe=Object.assign((t,e=qt)=>{FHe(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(s=>t[s]);return e(n,(...s)=>s.reduce((o,l,c)=>(o[r[c]]=l,o),{}))},{withTypes:()=>VHe}),mie={},pie={},gie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,s)=>{if(n!==a){const o=e(n),l=e(a);if(o===l&&o===0){if(n<a)return s==="desc"?1:-1;if(n>a)return s==="desc"?-1:1}return s==="desc"?l-o:o-l}return 0};t.compareValues=r})(gie);var xie={},HR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="symbol"||r instanceof Symbol}t.isSymbol=e})(HR);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=HR,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(s,o){return Array.isArray(s)?!1:typeof s=="number"||typeof s=="boolean"||s==null||e.isSymbol(s)?!0:typeof s=="string"&&(n.test(s)||!r.test(s))||o!=null&&Object.hasOwn(o,s)}t.isKey=a})(xie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=gie,r=xie,n=fP;function a(s,o,l,c){if(s==null)return[];l=c?void 0:l,Array.isArray(s)||(s=Object.values(s)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(h=>String(h));const u=(h,m)=>{let p=h;for(let g=0;g<m.length&&p!=null;++g)p=p[m[g]];return p},d=(h,m)=>m==null||h==null?m:typeof h=="object"&&"key"in h?Object.hasOwn(m,h.key)?m[h.key]:u(m,h.path):typeof h=="function"?h(m):Array.isArray(h)?u(m,h):typeof m=="object"?m[h]:m,f=o.map(h=>(Array.isArray(h)&&h.length===1&&(h=h[0]),h==null||typeof h=="function"||Array.isArray(h)||r.isKey(h)?h:{key:h,path:n.toPath(h)}));return s.map(h=>({original:h,criteria:f.map(m=>d(m,h))})).slice().sort((h,m)=>{for(let p=0;p<f.length;p++){const g=e.compareValues(h.criteria[p],m.criteria[p],l[p]);if(g!==0)return g}return 0}).map(h=>h.original)}t.orderBy=a})(pie);var vie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=1){const a=[],s=Math.floor(n),o=(l,c)=>{for(let u=0;u<l.length;u++){const d=l[u];Array.isArray(d)&&c<s?o(d,c+1):a.push(d)}};return o(r,0),a}t.flatten=e})(vie);var $R={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=QR,r=hP,n=OR,a=RR;function s(o,l,c){return n.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&e.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?a.eq(c[l],o):!1}t.isIterateeCall=s})($R);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=pie,r=vie,n=$R;function a(s,...o){const l=o.length;return l>1&&n.isIterateeCall(s,o[0],o[1])?o=[]:l>2&&n.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),e.orderBy(s,r.flatten(o),["asc"])}t.sortBy=a})(mie);var HHe=mie.sortBy;const mP=mA(HHe);var yie=t=>t.legend.settings,$He=t=>t.legend.size,GHe=t=>t.legend.payload,KHe=qt([GHe,yie],(t,e)=>{var{itemSorter:r}=e,n=t.flat(1);return r?mP(n,r):n});function qHe(){return Jr(KHe)}var i_=1;function bie(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[e,r]=x.useState({height:0,left:0,top:0,width:0}),n=x.useCallback(a=>{if(a!=null){var s=a.getBoundingClientRect(),o={height:s.height,left:s.left,top:s.top,width:s.width};(Math.abs(o.height-e.height)>i_||Math.abs(o.left-e.left)>i_||Math.abs(o.top-e.top)>i_||Math.abs(o.width-e.width)>i_)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[e.width,e.height,e.top,e.left,...t]);return[e,n]}function el(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var zHe=typeof Symbol=="function"&&Symbol.observable||"@@observable",gG=zHe,J5=()=>Math.random().toString(36).substring(7).split("").join("."),WHe={INIT:`@@redux/INIT${J5()}`,REPLACE:`@@redux/REPLACE${J5()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${J5()}`},eI=WHe;function GR(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function wie(t,e,r){if(typeof t!="function")throw new Error(el(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(el(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(el(1));return r(wie)(t,e)}let n=t,a=e,s=new Map,o=s,l=0,c=!1;function u(){o===s&&(o=new Map,s.forEach((g,v)=>{o.set(v,g)}))}function d(){if(c)throw new Error(el(3));return a}function f(g){if(typeof g!="function")throw new Error(el(4));if(c)throw new Error(el(5));let v=!0;u();const y=l++;return o.set(y,g),function(){if(v){if(c)throw new Error(el(6));v=!1,u(),o.delete(y),s=null}}}function A(g){if(!GR(g))throw new Error(el(7));if(typeof g.type>"u")throw new Error(el(8));if(typeof g.type!="string")throw new Error(el(17));if(c)throw new Error(el(9));try{c=!0,a=n(a,g)}finally{c=!1}return(s=o).forEach(y=>{y()}),g}function h(g){if(typeof g!="function")throw new Error(el(10));n=g,A({type:eI.REPLACE})}function m(){const g=f;return{subscribe(v){if(typeof v!="object"||v===null)throw new Error(el(11));function y(){const w=v;w.next&&w.next(d())}return y(),{unsubscribe:g(y)}},[gG](){return this}}}return A({type:eI.INIT}),{dispatch:A,subscribe:f,getState:d,replaceReducer:h,[gG]:m}}function XHe(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:eI.INIT})>"u")throw new Error(el(12));if(typeof r(void 0,{type:eI.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(el(13))})}function Nie(t){const e=Object.keys(t),r={};for(let s=0;s<e.length;s++){const o=e[s];typeof t[o]=="function"&&(r[o]=t[o])}const n=Object.keys(r);let a;try{XHe(r)}catch(s){a=s}return function(o={},l){if(a)throw a;let c=!1;const u={};for(let d=0;d<n.length;d++){const f=n[d],A=r[f],h=o[f],m=A(h,l);if(typeof m>"u")throw l&&l.type,new Error(el(14));u[f]=m,c=c||m!==h}return c=c||n.length!==Object.keys(o).length,c?u:o}}function tI(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function YHe(...t){return e=>(r,n)=>{const a=e(r,n);let s=()=>{throw new Error(el(15))};const o={getState:a.getState,dispatch:(c,...u)=>s(c,...u)},l=t.map(c=>c(o));return s=tI(...l)(a.dispatch),{...a,dispatch:s}}}function Cie(t){return GR(t)&&"type"in t&&typeof t.type=="string"}var _ie=Symbol.for("immer-nothing"),xG=Symbol.for("immer-draftable"),hc=Symbol.for("immer-state");function $d(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Au=Object,Rv=Au.getPrototypeOf,rI="constructor",pP="prototype",fF="configurable",nI="enumerable",dE="writable",Q2="value",cA=t=>!!t&&!!t[hc];function lf(t){var e;return t?Eie(t)||xP(t)||!!t[xG]||!!((e=t[rI])!=null&&e[xG])||vP(t)||yP(t):!1}var JHe=Au[pP][rI].toString(),vG=new WeakMap;function Eie(t){if(!t||!KR(t))return!1;const e=Rv(t);if(e===null||e===Au[pP])return!0;const r=Au.hasOwnProperty.call(e,rI)&&e[rI];if(r===Object)return!0;if(!Sx(r))return!1;let n=vG.get(r);return n===void 0&&(n=Function.toString.call(r),vG.set(r,n)),n===JHe}function gP(t,e,r=!0){Qw(t)===0?(r?Reflect.ownKeys(t):Au.keys(t)).forEach(a=>{e(a,t[a],t)}):t.forEach((n,a)=>e(a,n,t))}function Qw(t){const e=t[hc];return e?e.type_:xP(t)?1:vP(t)?2:yP(t)?3:0}var yG=(t,e,r=Qw(t))=>r===2?t.has(e):Au[pP].hasOwnProperty.call(t,e),hF=(t,e,r=Qw(t))=>r===2?t.get(e):t[e],aI=(t,e,r,n=Qw(t))=>{n===2?t.set(e,r):n===3?t.add(r):t[e]=r};function ZHe(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}var xP=Array.isArray,vP=t=>t instanceof Map,yP=t=>t instanceof Set,KR=t=>typeof t=="object",Sx=t=>typeof t=="function",Z5=t=>typeof t=="boolean";function e$e(t){const e=+t;return Number.isInteger(e)&&String(e)===t}var Sh=t=>t.copy_||t.base_,qR=t=>t.modified_?t.copy_:t.base_;function AF(t,e){if(vP(t))return new Map(t);if(yP(t))return new Set(t);if(xP(t))return Array[pP].slice.call(t);const r=Eie(t);if(e===!0||e==="class_only"&&!r){const n=Au.getOwnPropertyDescriptors(t);delete n[hc];let a=Reflect.ownKeys(n);for(let s=0;s<a.length;s++){const o=a[s],l=n[o];l[dE]===!1&&(l[dE]=!0,l[fF]=!0),(l.get||l.set)&&(n[o]={[fF]:!0,[dE]:!0,[nI]:l[nI],[Q2]:t[o]})}return Au.create(Rv(t),n)}else{const n=Rv(t);if(n!==null&&r)return{...t};const a=Au.create(n);return Au.assign(a,t)}}function zR(t,e=!1){return bP(t)||cA(t)||!lf(t)||(Qw(t)>1&&Au.defineProperties(t,{set:o_,add:o_,clear:o_,delete:o_}),Au.freeze(t),e&&gP(t,(r,n)=>{zR(n,!0)},!1)),t}function t$e(){$d(2)}var o_={[Q2]:t$e};function bP(t){return t===null||!KR(t)?!0:Au.isFrozen(t)}var sI="MapSet",mF="Patches",bG="ArrayMethods",Sie={};function ug(t){const e=Sie[t];return e||$d(0,t),e}var wG=t=>!!Sie[t],V2,Iie=()=>V2,r$e=(t,e)=>({drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:wG(sI)?ug(sI):void 0,arrayMethodsPlugin_:wG(bG)?ug(bG):void 0});function NG(t,e){e&&(t.patchPlugin_=ug(mF),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function pF(t){gF(t),t.drafts_.forEach(n$e),t.drafts_=null}function gF(t){t===V2&&(V2=t.parent_)}var CG=t=>V2=r$e(V2,t);function n$e(t){const e=t[hc];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function _G(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];if(t!==void 0&&t!==r){r[hc].modified_&&(pF(e),$d(4)),lf(t)&&(t=EG(e,t));const{patchPlugin_:a}=e;a&&a.generateReplacementPatches_(r[hc].base_,t,e)}else t=EG(e,r);return a$e(e,t,!0),pF(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==_ie?t:void 0}function EG(t,e){if(bP(e))return e;const r=e[hc];if(!r)return iI(e,t.handledSet_,t);if(!wP(r,t))return e;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(t);Bie(r,t)}return r.copy_}function a$e(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&zR(e,r)}function jie(t){t.finalized_=!0,t.scope_.unfinalizedDrafts_--}var wP=(t,e)=>t.scope_===e,s$e=[];function Pie(t,e,r,n){const a=Sh(t),s=t.type_;if(n!==void 0&&hF(a,n,s)===e){aI(a,n,r,s);return}if(!t.draftLocations_){const l=t.draftLocations_=new Map;gP(a,(c,u)=>{if(cA(u)){const d=l.get(u)||[];d.push(c),l.set(u,d)}})}const o=t.draftLocations_.get(e)??s$e;for(const l of o)aI(a,l,r,s)}function i$e(t,e,r){t.callbacks_.push(function(a){var l;const s=e;if(!s||!wP(s,a))return;(l=a.mapSetPlugin_)==null||l.fixSetContents(s);const o=qR(s);Pie(t,s.draft_??s,o,r),Bie(s,a)})}function Bie(t,e){var n;if(t.modified_&&!t.finalized_&&(t.type_===3||t.type_===1&&t.allIndicesReassigned_||(((n=t.assigned_)==null?void 0:n.size)??0)>0)){const{patchPlugin_:a}=e;if(a){const s=a.getPath(t);s&&a.generatePatches_(t,s,e)}jie(t)}}function o$e(t,e,r){const{scope_:n}=t;if(cA(r)){const a=r[hc];wP(a,n)&&a.callbacks_.push(function(){fE(t);const o=qR(a);Pie(t,r,o,e)})}else lf(r)&&t.callbacks_.push(function(){const s=Sh(t);t.type_===3?s.has(r)&&iI(r,n.handledSet_,n):hF(s,e,t.type_)===r&&n.drafts_.length>1&&(t.assigned_.get(e)??!1)===!0&&t.copy_&&iI(hF(t.copy_,e,t.type_),n.handledSet_,n)})}function iI(t,e,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||cA(t)||e.has(t)||!lf(t)||bP(t)||(e.add(t),gP(t,(n,a)=>{if(cA(a)){const s=a[hc];if(wP(s,r)){const o=qR(s);aI(t,n,o,t.type_),jie(s)}}else lf(a)&&iI(a,e,r)})),t}function l$e(t,e){const r=xP(t),n={type_:r?1:0,scope_:e?e.scope_:Iie(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let a=n,s=oI;r&&(a=[n],s=H2);const{revoke:o,proxy:l}=Proxy.revocable(a,s);return n.draft_=l,n.revoke_=o,[l,n]}var oI={get(t,e){if(e===hc)return t;let r=t.scope_.arrayMethodsPlugin_;const n=t.type_===1&&typeof e=="string";if(n&&r!=null&&r.isArrayOperationMethod(e))return r.createMethodInterceptor(t,e);const a=Sh(t);if(!yG(a,e,t.type_))return c$e(t,a,e);const s=a[e];if(t.finalized_||!lf(s)||n&&t.operationMethod&&(r!=null&&r.isMutatingArrayMethod(t.operationMethod))&&e$e(e))return s;if(s===eB(t.base_,e)){fE(t);const o=t.type_===1?+e:e,l=vF(t.scope_,s,t,o);return t.copy_[o]=l}return s},has(t,e){return e in Sh(t)},ownKeys(t){return Reflect.ownKeys(Sh(t))},set(t,e,r){const n=Tie(Sh(t),e);if(n!=null&&n.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const a=eB(Sh(t),e),s=a==null?void 0:a[hc];if(s&&s.base_===r)return t.copy_[e]=r,t.assigned_.set(e,!1),!0;if(ZHe(r,a)&&(r!==void 0||yG(t.base_,e,t.type_)))return!0;fE(t),xF(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_.set(e,!0),o$e(t,e,r)),!0},deleteProperty(t,e){return fE(t),eB(t.base_,e)!==void 0||e in t.base_?(t.assigned_.set(e,!1),xF(t)):t.assigned_.delete(e),t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Sh(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{[dE]:!0,[fF]:t.type_!==1||e!=="length",[nI]:n[nI],[Q2]:r[e]}},defineProperty(){$d(11)},getPrototypeOf(t){return Rv(t.base_)},setPrototypeOf(){$d(12)}},H2={};for(let t in oI){let e=oI[t];H2[t]=function(){const r=arguments;return r[0]=r[0][0],e.apply(this,r)}}H2.deleteProperty=function(t,e){return H2.set.call(this,t,e,void 0)};H2.set=function(t,e,r){return oI.set.call(this,t[0],e,r,t[0])};function eB(t,e){const r=t[hc];return(r?Sh(r):t)[e]}function c$e(t,e,r){var a;const n=Tie(e,r);return n?Q2 in n?n[Q2]:(a=n.get)==null?void 0:a.call(t.draft_):void 0}function Tie(t,e){if(!(e in t))return;let r=Rv(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=Rv(r)}}function xF(t){t.modified_||(t.modified_=!0,t.parent_&&xF(t.parent_))}function fE(t){t.copy_||(t.assigned_=new Map,t.copy_=AF(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var u$e=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,a)=>{if(Sx(r)&&!Sx(n)){const o=n;n=r;const l=this;return function(u=o,...d){return l.produce(u,f=>n.call(this,f,...d))}}Sx(n)||$d(6),a!==void 0&&!Sx(a)&&$d(7);let s;if(lf(r)){const o=CG(this),l=vF(o,r,void 0);let c=!0;try{s=n(l),c=!1}finally{c?pF(o):gF(o)}return NG(o,a),_G(s,o)}else if(!r||!KR(r)){if(s=n(r),s===void 0&&(s=r),s===_ie&&(s=void 0),this.autoFreeze_&&zR(s,!0),a){const o=[],l=[];ug(mF).generateReplacementPatches_(r,s,{patches_:o,inversePatches_:l}),a(o,l)}return s}else $d(1,r)},this.produceWithPatches=(r,n)=>{if(Sx(r))return(l,...c)=>this.produceWithPatches(l,u=>r(u,...c));let a,s;return[this.produce(r,n,(l,c)=>{a=l,s=c}),a,s]},Z5(e==null?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),Z5(e==null?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),Z5(e==null?void 0:e.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){lf(e)||$d(8),cA(e)&&(e=rf(e));const r=CG(this),n=vF(r,e,void 0);return n[hc].isManual_=!0,gF(r),n}finishDraft(e,r){const n=e&&e[hc];(!n||!n.isManual_)&&$d(9);const{scope_:a}=n;return NG(a,r),_G(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,r){let n;for(n=r.length-1;n>=0;n--){const s=r[n];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}n>-1&&(r=r.slice(n+1));const a=ug(mF).applyPatches_;return cA(e)?a(e,r):this.produce(e,s=>a(s,r))}};function vF(t,e,r,n){const[a,s]=vP(e)?ug(sI).proxyMap_(e,r):yP(e)?ug(sI).proxySet_(e,r):l$e(e,r);return((r==null?void 0:r.scope_)??Iie()).drafts_.push(a),s.callbacks_=(r==null?void 0:r.callbacks_)??[],s.key_=n,r&&n!==void 0?i$e(r,s,n):s.callbacks_.push(function(c){var d;(d=c.mapSetPlugin_)==null||d.fixSetContents(s);const{patchPlugin_:u}=c;s.modified_&&u&&u.generatePatches_(s,[],c)}),a}function rf(t){return cA(t)||$d(10,t),kie(t)}function kie(t){if(!lf(t)||bP(t))return t;const e=t[hc];let r,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=AF(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else r=AF(t,!0);return gP(r,(a,s)=>{aI(r,a,kie(s))},n),e&&(e.finalized_=!1),r}var d$e=new u$e,Fie=d$e.produce;function Oie(t){return({dispatch:r,getState:n})=>a=>s=>typeof s=="function"?s(r,n,t):a(s)}var f$e=Oie(),h$e=Oie,A$e=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?tI:tI.apply(null,arguments)};function gd(t,e){function r(...n){if(e){let a=e(...n);if(!a)throw new Error(gu(0));return{type:t,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>Cie(n)&&n.type===t,r}var Die=class qy extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,qy.prototype)}static get[Symbol.species](){return qy}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new qy(...e[0].concat(this)):new qy(...e.concat(this))}};function SG(t){return lf(t)?Fie(t,()=>{}):t}function l_(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function m$e(t){return typeof t=="boolean"}var p$e=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:s=!0}=e??{};let o=new Die;return r&&(m$e(r)?o.push(f$e):o.push(h$e(r.extraArgument))),o},Rie="RTK_autoBatch",Ns=()=>t=>({payload:t,meta:{[Rie]:!0}}),IG=t=>e=>{setTimeout(e,t)},Mie=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let a=!0,s=!1,o=!1;const l=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:IG(10):t.type==="callback"?t.queueNotification:IG(t.timeout),u=()=>{o=!1,s&&(s=!1,l.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const f=()=>a&&d(),A=n.subscribe(f);return l.add(d),()=>{A(),l.delete(d)}},dispatch(d){var f;try{return a=!((f=d==null?void 0:d.meta)!=null&&f[Rie]),s=!a,s&&(o||(o=!0,c(u))),n.dispatch(d)}finally{a=!0}}})},g$e=t=>function(r){const{autoBatch:n=!0}=r??{};let a=new Die(t);return n&&a.push(Mie(typeof n=="object"?n:void 0)),a};function x$e(t){const e=p$e(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:s=void 0,enhancers:o=void 0}=t||{};let l;if(typeof r=="function")l=r;else if(GR(r))l=Nie(r);else throw new Error(gu(1));let c;typeof n=="function"?c=n(e):c=e();let u=tI;a&&(u=A$e({trace:!1,...typeof a=="object"&&a}));const d=YHe(...c),f=g$e(d);let A=typeof o=="function"?o(f):f();const h=u(...A);return wie(l,s,h)}function Lie(t){const e={},r=[];let n;const a={addCase(s,o){const l=typeof s=="string"?s:s.type;if(!l)throw new Error(gu(28));if(l in e)throw new Error(gu(29));return e[l]=o,a},addAsyncThunk(s,o){return o.pending&&(e[s.pending.type]=o.pending),o.rejected&&(e[s.rejected.type]=o.rejected),o.fulfilled&&(e[s.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:s.settled,reducer:o.settled}),a},addMatcher(s,o){return r.push({matcher:s,reducer:o}),a},addDefaultCase(s){return n=s,a}};return t(a),[e,r,n]}function v$e(t){return typeof t=="function"}function y$e(t,e){let[r,n,a]=Lie(e),s;if(v$e(t))s=()=>SG(t());else{const l=SG(t);s=()=>l}function o(l=s(),c){let u=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[a]),u.reduce((d,f)=>{if(f)if(cA(d)){const h=f(d,c);return h===void 0?d:h}else{if(lf(d))return Fie(d,A=>f(A,c));{const A=f(d,c);if(A===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return A}}return d},l)}return o.getInitialState=s,o}var b$e="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",w$e=(t=21)=>{let e="",r=t;for(;r--;)e+=b$e[Math.random()*64|0];return e},N$e=Symbol.for("rtk-slice-createasyncthunk");function C$e(t,e){return`${t}/${e}`}function _$e({creators:t}={}){var r;const e=(r=t==null?void 0:t.asyncThunk)==null?void 0:r[N$e];return function(a){const{name:s,reducerPath:o=s}=a;if(!s)throw new Error(gu(11));const l=(typeof a.reducers=="function"?a.reducers(S$e()):a.reducers)||{},c=Object.keys(l),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(w,j){const I=typeof w=="string"?w:w.type;if(!I)throw new Error(gu(12));if(I in u.sliceCaseReducersByType)throw new Error(gu(13));return u.sliceCaseReducersByType[I]=j,d},addMatcher(w,j){return u.sliceMatchers.push({matcher:w,reducer:j}),d},exposeAction(w,j){return u.actionCreators[w]=j,d},exposeCaseReducer(w,j){return u.sliceCaseReducersByName[w]=j,d}};c.forEach(w=>{const j=l[w],I={reducerName:w,type:C$e(s,w),createNotation:typeof a.reducers=="function"};j$e(j)?B$e(I,j,d,e):I$e(I,j,d)});function f(){const[w={},j=[],I=void 0]=typeof a.extraReducers=="function"?Lie(a.extraReducers):[a.extraReducers],_={...w,...u.sliceCaseReducersByType};return y$e(a.initialState,S=>{for(let E in _)S.addCase(E,_[E]);for(let E of u.sliceMatchers)S.addMatcher(E.matcher,E.reducer);for(let E of j)S.addMatcher(E.matcher,E.reducer);I&&S.addDefaultCase(I)})}const A=w=>w,h=new Map,m=new WeakMap;let p;function g(w,j){return p||(p=f()),p(w,j)}function v(){return p||(p=f()),p.getInitialState()}function y(w,j=!1){function I(S){let E=S[w];return typeof E>"u"&&j&&(E=l_(m,I,v)),E}function _(S=A){const E=l_(h,j,()=>new WeakMap);return l_(E,S,()=>{const F={};for(const[k,P]of Object.entries(a.selectors??{}))F[k]=E$e(P,S,()=>l_(m,S,v),j);return F})}return{reducerPath:w,getSelectors:_,get selectors(){return _(I)},selectSlice:I}}const b={name:s,reducer:g,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:v,...y(o),injectInto(w,{reducerPath:j,...I}={}){const _=j??o;return w.inject({reducerPath:_,reducer:g},I),{...b,...y(_,!0)}}};return b}}function E$e(t,e,r,n){function a(s,...o){let l=e(s);return typeof l>"u"&&n&&(l=r()),t(l,...o)}return a.unwrapped=t,a}var Vc=_$e();function S$e(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function I$e({type:t,reducerName:e,createNotation:r},n,a){let s,o;if("reducer"in n){if(r&&!P$e(n))throw new Error(gu(17));s=n.reducer,o=n.prepare}else s=n;a.addCase(t,s).exposeCaseReducer(e,s).exposeAction(e,o?gd(t,o):gd(t))}function j$e(t){return t._reducerDefinitionType==="asyncThunk"}function P$e(t){return t._reducerDefinitionType==="reducerWithPrepare"}function B$e({type:t,reducerName:e},r,n,a){if(!a)throw new Error(gu(18));const{payloadCreator:s,fulfilled:o,pending:l,rejected:c,settled:u,options:d}=r,f=a(t,s,d);n.exposeAction(e,f),o&&n.addCase(f.fulfilled,o),l&&n.addCase(f.pending,l),c&&n.addCase(f.rejected,c),u&&n.addMatcher(f.settled,u),n.exposeCaseReducer(e,{fulfilled:o||c_,pending:l||c_,rejected:c||c_,settled:u||c_})}function c_(){}var T$e="task",Uie="listener",Qie="completed",WR="cancelled",k$e=`task-${WR}`,F$e=`task-${Qie}`,yF=`${Uie}-${WR}`,O$e=`${Uie}-${Qie}`,NP=class{constructor(t){pr(this,"name","TaskAbortError");pr(this,"message");this.code=t,this.message=`${T$e} ${WR} (reason: ${t})`}},XR=(t,e)=>{if(typeof t!="function")throw new TypeError(gu(32))},lI=()=>{},Vie=(t,e=lI)=>(t.catch(e),t),Hie=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),Op=t=>{if(t.aborted)throw new NP(t.reason)};function $ie(t,e){let r=lI;return new Promise((n,a)=>{const s=()=>a(new NP(t.reason));if(t.aborted){s();return}r=Hie(t,s),e.finally(()=>r()).then(n,a)}).finally(()=>{r=lI})}var D$e=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof NP?"cancelled":"rejected",error:r}}finally{e==null||e()}},cI=t=>e=>Vie($ie(t,e).then(r=>(Op(t),r))),Gie=t=>{const e=cI(t);return r=>e(new Promise(n=>setTimeout(n,r)))},{assign:fv}=Object,jG={},CP="listenerMiddleware",R$e=(t,e)=>{const r=n=>Hie(t,()=>n.abort(t.reason));return(n,a)=>{XR(n);const s=new AbortController;r(s);const o=D$e(async()=>{Op(t),Op(s.signal);const l=await n({pause:cI(s.signal),delay:Gie(s.signal),signal:s.signal});return Op(s.signal),l},()=>s.abort(F$e));return a!=null&&a.autoJoin&&e.push(o.catch(lI)),{result:cI(t)(o),cancel(){s.abort(k$e)}}}},M$e=(t,e)=>{const r=async(n,a)=>{Op(e);let s=()=>{};const l=[new Promise((c,u)=>{let d=t({predicate:n,effect:(f,A)=>{A.unsubscribe(),c([f,A.getState(),A.getOriginalState()])}});s=()=>{d(),u()}})];a!=null&&l.push(new Promise(c=>setTimeout(c,a,null)));try{const c=await $ie(e,Promise.race(l));return Op(e),c}finally{s()}};return(n,a)=>Vie(r(n,a))},Kie=t=>{let{type:e,actionCreator:r,matcher:n,predicate:a,effect:s}=t;if(e)a=gd(e).match;else if(r)e=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(gu(21));return XR(s),{predicate:a,type:e,effect:s}},qie=fv(t=>{const{type:e,predicate:r,effect:n}=Kie(t);return{id:w$e(),effect:n,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(gu(22))}}},{withTypes:()=>qie}),PG=(t,e)=>{const{type:r,effect:n,predicate:a}=Kie(e);return Array.from(t.values()).find(s=>(typeof r=="string"?s.type===r:s.predicate===a)&&s.effect===n)},bF=t=>{t.pending.forEach(e=>{e.abort(yF)})},L$e=(t,e)=>()=>{for(const r of e.keys())bF(r);t.clear()},BG=(t,e,r)=>{try{t(e,r)}catch(n){setTimeout(()=>{throw n},0)}},zie=fv(gd(`${CP}/add`),{withTypes:()=>zie}),U$e=gd(`${CP}/removeAll`),Wie=fv(gd(`${CP}/remove`),{withTypes:()=>Wie}),Q$e=(...t)=>{console.error(`${CP}/error`,...t)},Vw=(t={})=>{const e=new Map,r=new Map,n=h=>{const m=r.get(h)??0;r.set(h,m+1)},a=h=>{const m=r.get(h)??1;m===1?r.delete(h):r.set(h,m-1)},{extra:s,onError:o=Q$e}=t;XR(o);const l=h=>(h.unsubscribe=()=>e.delete(h.id),e.set(h.id,h),m=>{h.unsubscribe(),m!=null&&m.cancelActive&&bF(h)}),c=h=>{const m=PG(e,h)??qie(h);return l(m)};fv(c,{withTypes:()=>c});const u=h=>{const m=PG(e,h);return m&&(m.unsubscribe(),h.cancelActive&&bF(m)),!!m};fv(u,{withTypes:()=>u});const d=async(h,m,p,g)=>{const v=new AbortController,y=M$e(c,v.signal),b=[];try{h.pending.add(v),n(h),await Promise.resolve(h.effect(m,fv({},p,{getOriginalState:g,condition:(w,j)=>y(w,j).then(Boolean),take:y,delay:Gie(v.signal),pause:cI(v.signal),extra:s,signal:v.signal,fork:R$e(v.signal,b),unsubscribe:h.unsubscribe,subscribe:()=>{e.set(h.id,h)},cancelActiveListeners:()=>{h.pending.forEach((w,j,I)=>{w!==v&&(w.abort(yF),I.delete(w))})},cancel:()=>{v.abort(yF),h.pending.delete(v)},throwIfCancelled:()=>{Op(v.signal)}})))}catch(w){w instanceof NP||BG(o,w,{raisedBy:"effect"})}finally{await Promise.all(b),v.abort(O$e),a(h),h.pending.delete(v)}},f=L$e(e,r);return{middleware:h=>m=>p=>{if(!Cie(p))return m(p);if(zie.match(p))return c(p.payload);if(U$e.match(p)){f();return}if(Wie.match(p))return u(p.payload);let g=h.getState();const v=()=>{if(g===jG)throw new Error(gu(23));return g};let y;try{if(y=m(p),e.size>0){const b=h.getState(),w=Array.from(e.values());for(const j of w){let I=!1;try{I=j.predicate(p,b,g)}catch(_){I=!1,BG(o,_,{raisedBy:"predicate"})}I&&d(j,p,h,v)}}}finally{g=jG}return y},startListening:c,stopListening:u,clearListeners:f}};function gu(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var V$e={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},Xie=Vc({name:"chartLayout",initialState:V$e,reducers:{setLayout(t,e){t.layoutType=e.payload},setChartSize(t,e){t.width=e.payload.width,t.height=e.payload.height},setMargin(t,e){var r,n,a,s;t.margin.top=(r=e.payload.top)!==null&&r!==void 0?r:0,t.margin.right=(n=e.payload.right)!==null&&n!==void 0?n:0,t.margin.bottom=(a=e.payload.bottom)!==null&&a!==void 0?a:0,t.margin.left=(s=e.payload.left)!==null&&s!==void 0?s:0},setScale(t,e){t.scale=e.payload}}}),{setMargin:H$e,setLayout:$$e,setChartSize:G$e,setScale:K$e}=Xie.actions,q$e=Xie.reducer;function Yie(t,e,r){return Array.isArray(t)&&t&&e+r!==0?t.slice(e,r+1):t}function Zs(t){return Number.isFinite(t)}function gm(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function TG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function qx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?TG(Object(r),!0).forEach(function(n){z$e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):TG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function z$e(t,e,r){return(e=W$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function W$e(t){var e=X$e(t,"string");return typeof e=="symbol"?e:e+""}function X$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ps(t,e,r){return Qo(t)||Qo(e)?r:Wf(e)?cg(t,e,r):typeof e=="function"?e(t):r}var Y$e=(t,e,r)=>{if(e&&r){var{width:n,height:a}=r,{align:s,verticalAlign:o,layout:l}=e;if((l==="vertical"||l==="horizontal"&&o==="middle")&&s!=="center"&&rn(t[s]))return qx(qx({},t),{},{[s]:t[s]+(n||0)});if((l==="horizontal"||l==="vertical"&&s==="center")&&o!=="middle"&&rn(t[o]))return qx(qx({},t),{},{[o]:t[o]+(a||0)})}return t},kg=(t,e)=>t==="horizontal"&&e==="xAxis"||t==="vertical"&&e==="yAxis"||t==="centric"&&e==="angleAxis"||t==="radial"&&e==="radiusAxis",kG=1e-4,J$e=t=>{var e=t.domain();if(!(!e||e.length<=2)){var r=e.length,n=t.range(),a=Math.min(n[0],n[1])-kG,s=Math.max(n[0],n[1])+kG,o=t(e[0]),l=t(e[r-1]);(o<a||o>s||l<a||l>s)&&t.domain([e[0],e[r-1]])}},Z$e=(t,e)=>{if(!e||e.length!==2||!rn(e[0])||!rn(e[1]))return t;var r=Math.min(e[0],e[1]),n=Math.max(e[0],e[1]),a=[t[0],t[1]];return(!rn(t[0])||t[0]<r)&&(a[0]=r),(!rn(t[1])||t[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},eGe=t=>{var e,r=t.length;if(!(r<=0)){var n=(e=t[0])===null||e===void 0?void 0:e.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var s=0,o=0,l=0;l<r;++l){var c=t[l],u=c==null?void 0:c[a];if(u!=null){var d=u[1],f=u[0],A=zf(d)?f:d;A>=0?(u[0]=s,u[1]=s+A,s=d):(u[0]=o,u[1]=o+A,o=d)}}}},tGe=t=>{var e,r=t.length;if(!(r<=0)){var n=(e=t[0])===null||e===void 0?void 0:e.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var s=0,o=0;o<r;++o){var l=t[o],c=l==null?void 0:l[a];if(c!=null){var u=zf(c[1])?c[0]:c[1];u>=0?(c[0]=s,c[1]=s+u,s=c[1]):(c[0]=0,c[1]=0)}}}},rGe={sign:eGe,expand:TVe,none:lg,silhouette:kVe,wiggle:FVe,positive:tGe},nGe=(t,e,r)=>{var n,a=(n=rGe[r])!==null&&n!==void 0?n:lg,s=BVe().keys(e).value((l,c)=>Number(ps(l,c,0))).order(uF).offset(a),o=s(t);return o.forEach((l,c)=>{l.forEach((u,d)=>{var f=ps(t[d],e[c],0);Array.isArray(f)&&f.length===2&&rn(f[0])&&rn(f[1])&&(u[0]=f[0],u[1]=f[1])})}),o};function aGe(t){return t==null?void 0:String(t)}var FG=t=>{var{axis:e,ticks:r,offset:n,bandSize:a,entry:s,index:o}=t;if(e.type==="category")return r[o]?r[o].coordinate+n:null;var l=ps(s,e.dataKey,e.scale.domain()[o]);return Qo(l)?null:e.scale(l)-a/2+n},sGe=t=>{var{numericAxis:e}=t,r=e.scale.domain();if(e.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},iGe=t=>{var e=t.flat(2).filter(rn);return[Math.min(...e),Math.max(...e)]},oGe=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],lGe=(t,e,r)=>{if(t!=null)return oGe(Object.keys(t).reduce((n,a)=>{var s=t[a];if(!s)return n;var{stackedData:o}=s,l=o.reduce((c,u)=>{var d=Yie(u,e,r),f=iGe(d);return!Zs(f[0])||!Zs(f[1])?c:[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},OG=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,DG=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,uI=(t,e,r)=>{if(t&&t.scale&&t.scale.bandwidth){var n=t.scale.bandwidth();if(!r||n>0)return n}if(t&&e&&e.length>=2){for(var a=mP(e,d=>d.coordinate),s=1/0,o=1,l=a.length;o<l;o++){var c=a[o],u=a[o-1];s=Math.min(((c==null?void 0:c.coordinate)||0)-((u==null?void 0:u.coordinate)||0),s)}return s===1/0?0:s}return r?void 0:0};function RG(t){var{tooltipEntrySettings:e,dataKey:r,payload:n,value:a,name:s}=t;return qx(qx({},e),{},{dataKey:r,payload:n,value:a,name:s})}function _P(t,e){if(t)return String(t);if(typeof e=="string")return e}var cGe=(t,e)=>{if(e==="horizontal")return t.chartX;if(e==="vertical")return t.chartY},uGe=(t,e)=>e==="centric"?t.angle:t.radius,_A=t=>t.layout.width,EA=t=>t.layout.height,dGe=t=>t.layout.scale,Jie=t=>t.layout.margin,EP=qt(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),SP=qt(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),Zie="data-recharts-item-index",eoe="data-recharts-item-id",Hw=60;function MG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function u_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?MG(Object(r),!0).forEach(function(n){fGe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):MG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function fGe(t,e,r){return(e=hGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hGe(t){var e=AGe(t,"string");return typeof e=="symbol"?e:e+""}function AGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mGe=t=>t.brush.height;function pGe(t){var e=SP(t);return e.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Hw;return r+a}return r},0)}function gGe(t){var e=SP(t);return e.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Hw;return r+a}return r},0)}function xGe(t){var e=EP(t);return e.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function vGe(t){var e=EP(t);return e.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var go=qt([_A,EA,Jie,mGe,pGe,gGe,xGe,vGe,yie,$He],(t,e,r,n,a,s,o,l,c,u)=>{var d={left:(r.left||0)+a,right:(r.right||0)+s},f={top:(r.top||0)+o,bottom:(r.bottom||0)+l},A=u_(u_({},f),d),h=A.bottom;A.bottom+=n,A=Y$e(A,c,u);var m=t-A.left-A.right,p=e-A.top-A.bottom;return u_(u_({brushBottom:h},A),{},{width:Math.max(m,0),height:Math.max(p,0)})}),yGe=qt(go,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),YR=qt(_A,EA,(t,e)=>({x:0,y:0,width:t,height:e})),bGe=x.createContext(null),_u=()=>x.useContext(bGe)!=null,IP=t=>t.brush,jP=qt([IP,go,Jie],(t,e,r)=>({height:t.height,x:rn(t.x)?t.x:e.left,y:rn(t.y)?t.y:e.top+e.height+e.brushBottom-((r==null?void 0:r.bottom)||0),width:rn(t.width)?t.width:e.width})),toe={},roe={},noe={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n,{signal:a,edges:s}={}){let o,l=null;const c=s!=null&&s.includes("leading"),u=s==null||s.includes("trailing"),d=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},f=()=>{u&&d(),p()};let A=null;const h=()=>{A!=null&&clearTimeout(A),A=setTimeout(()=>{A=null,f()},n)},m=()=>{A!==null&&(clearTimeout(A),A=null)},p=()=>{m(),o=void 0,l=null},g=()=>{d()},v=function(...y){if(a!=null&&a.aborted)return;o=this,l=y;const b=A==null;h(),c&&b&&d()};return v.schedule=h,v.cancel=p,v.flush=g,a==null||a.addEventListener("abort",p,{once:!0}),v}t.debounce=e})(noe);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=noe;function r(n,a=0,s={}){typeof s!="object"&&(s={});const{leading:o=!1,trailing:l=!0,maxWait:c}=s,u=Array(2);o&&(u[0]="leading"),l&&(u[1]="trailing");let d,f=null;const A=e.debounce(function(...p){d=n.apply(this,p),f=null},a,{edges:u}),h=function(...p){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(d=n.apply(this,p),f=Date.now(),A.cancel(),A.schedule(),d):(A.apply(this,p),d)},m=()=>(A.flush(),d);return h.cancel=A.cancel,h.flush=m,h}t.debounce=r})(roe);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=roe;function r(n,a=0,s={}){const{leading:o=!0,trailing:l=!0}=s;return e.debounce(n,a,{leading:o,maxWait:a,trailing:l})}t.throttle=r})(toe);var wGe=toe.throttle;const NGe=mA(wGe);var LG=function(e,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!e))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(r.replace(/%s/g,()=>a[o++]))}},aoe=(t,e,r)=>{var{width:n="100%",height:a="100%",aspect:s,maxHeight:o}=r,l=lA(n)?t:Number(n),c=lA(a)?e:Number(a);return s&&s>0&&(l?c=l/s:c&&(l=c*s),o&&c!=null&&c>o&&(c=o)),{calculatedWidth:l,calculatedHeight:c}},CGe={width:0,height:0,overflow:"visible"},_Ge={width:0,overflowX:"visible"},EGe={height:0,overflowY:"visible"},SGe={},IGe=t=>{var{width:e,height:r}=t,n=lA(e),a=lA(r);return n&&a?CGe:n?_Ge:a?EGe:SGe};function jGe(t){var{width:e,height:r,aspect:n}=t,a=e,s=r;return a===void 0&&s===void 0?(a="100%",s="100%"):a===void 0?a=n&&n>0?void 0:"100%":s===void 0&&(s=n&&n>0?void 0:"100%"),{width:a,height:s}}function wF(){return wF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},wF.apply(null,arguments)}function UG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function QG(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?UG(Object(r),!0).forEach(function(n){PGe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):UG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function PGe(t,e,r){return(e=BGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function BGe(t){var e=TGe(t,"string");return typeof e=="symbol"?e:e+""}function TGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var soe=x.createContext({width:-1,height:-1});function kGe(t){return gm(t.width)&&gm(t.height)}function ioe(t){var{children:e,width:r,height:n}=t,a=x.useMemo(()=>({width:r,height:n}),[r,n]);return kGe(a)?x.createElement(soe.Provider,{value:a},e):null}var JR=()=>x.useContext(soe),FGe=x.forwardRef((t,e)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a,height:s,minWidth:o=0,minHeight:l,maxHeight:c,children:u,debounce:d=0,id:f,className:A,onResize:h,style:m={}}=t,p=x.useRef(null),g=x.useRef();g.current=h,x.useImperativeHandle(e,()=>p.current);var[v,y]=x.useState({containerWidth:n.width,containerHeight:n.height}),b=x.useCallback((S,E)=>{y(F=>{var k=Math.round(S),P=Math.round(E);return F.containerWidth===k&&F.containerHeight===P?F:{containerWidth:k,containerHeight:P}})},[]);x.useEffect(()=>{if(p.current==null||typeof ResizeObserver>"u")return Lw;var S=P=>{var D,{width:X,height:pe}=P[0].contentRect;b(X,pe),(D=g.current)===null||D===void 0||D.call(g,X,pe)};d>0&&(S=NGe(S,d,{trailing:!0,leading:!1}));var E=new ResizeObserver(S),{width:F,height:k}=p.current.getBoundingClientRect();return b(F,k),E.observe(p.current),()=>{E.disconnect()}},[b,d]);var{containerWidth:w,containerHeight:j}=v;LG(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:I,calculatedHeight:_}=aoe(w,j,{width:a,height:s,aspect:r,maxHeight:c});return LG(I!=null&&I>0||_!=null&&_>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,I,_,a,s,o,l,r),x.createElement("div",{id:f?"".concat(f):void 0,className:La("recharts-responsive-container",A),style:QG(QG({},m),{},{width:a,height:s,minWidth:o,minHeight:l,maxHeight:c}),ref:p},x.createElement("div",{style:IGe({width:a,height:s})},x.createElement(ioe,{width:I,height:_},u)))}),VG=x.forwardRef((t,e)=>{var r=JR();if(gm(r.width)&&gm(r.height))return t.children;var{width:n,height:a}=jGe({width:t.width,height:t.height,aspect:t.aspect}),{calculatedWidth:s,calculatedHeight:o}=aoe(void 0,void 0,{width:n,height:a,aspect:t.aspect,maxHeight:t.maxHeight});return rn(s)&&rn(o)?x.createElement(ioe,{width:s,height:o},t.children):x.createElement(FGe,wF({},t,{width:n,height:a,ref:e}))});function ooe(t){if(t)return{x:t.x,y:t.y,upperWidth:"upperWidth"in t?t.upperWidth:t.width,lowerWidth:"lowerWidth"in t?t.lowerWidth:t.width,width:t.width,height:t.height}}var PP=()=>{var t,e=_u(),r=Jr(yGe),n=Jr(jP),a=(t=Jr(IP))===null||t===void 0?void 0:t.padding;return!e||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},OGe={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},DGe=()=>{var t;return(t=Jr(go))!==null&&t!==void 0?t:OGe},loe=()=>Jr(_A),coe=()=>Jr(EA),RGe=()=>Jr(t=>t.layout.margin),Aa=t=>t.layout.layoutType,$w=()=>Jr(Aa),MGe=()=>{var t=$w();return t!==void 0},BP=t=>{var e=os(),r=_u(),{width:n,height:a}=t,s=JR(),o=n,l=a;return s&&(o=s.width>0?s.width:n,l=s.height>0?s.height:a),x.useEffect(()=>{!r&&gm(o)&&gm(l)&&e(G$e({width:o,height:l}))},[e,r,o,l]),null},uoe=Symbol.for("immer-nothing"),HG=Symbol.for("immer-draftable"),wu=Symbol.for("immer-state");function Gd(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var $2=Object.getPrototypeOf;function Mv(t){return!!t&&!!t[wu]}function dg(t){var e;return t?doe(t)||Array.isArray(t)||!!t[HG]||!!((e=t.constructor)!=null&&e[HG])||Gw(t)||kP(t):!1}var LGe=Object.prototype.constructor.toString(),$G=new WeakMap;function doe(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);if(e===null||e===Object.prototype)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=$G.get(r);return n===void 0&&(n=Function.toString.call(r),$G.set(r,n)),n===LGe}function dI(t,e,r=!0){TP(t)===0?(r?Reflect.ownKeys(t):Object.keys(t)).forEach(a=>{e(a,t[a],t)}):t.forEach((n,a)=>e(a,n,t))}function TP(t){const e=t[wu];return e?e.type_:Array.isArray(t)?1:Gw(t)?2:kP(t)?3:0}function NF(t,e){return TP(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function foe(t,e,r){const n=TP(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function UGe(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Gw(t){return t instanceof Map}function kP(t){return t instanceof Set}function rp(t){return t.copy_||t.base_}function CF(t,e){if(Gw(t))return new Map(t);if(kP(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=doe(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[wu];let a=Reflect.ownKeys(n);for(let s=0;s<a.length;s++){const o=a[s],l=n[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:t[o]})}return Object.create($2(t),n)}else{const n=$2(t);if(n!==null&&r)return{...t};const a=Object.create(n);return Object.assign(a,t)}}function ZR(t,e=!1){return FP(t)||Mv(t)||!dg(t)||(TP(t)>1&&Object.defineProperties(t,{set:d_,add:d_,clear:d_,delete:d_}),Object.freeze(t),e&&Object.values(t).forEach(r=>ZR(r,!0))),t}function QGe(){Gd(2)}var d_={value:QGe};function FP(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var VGe={};function fg(t){const e=VGe[t];return e||Gd(0,t),e}var G2;function hoe(){return G2}function HGe(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function GG(t,e){e&&(fg("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function _F(t){EF(t),t.drafts_.forEach($Ge),t.drafts_=null}function EF(t){t===G2&&(G2=t.parent_)}function KG(t){return G2=HGe(G2,t)}function $Ge(t){const e=t[wu];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function qG(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[wu].modified_&&(_F(e),Gd(4)),dg(t)&&(t=fI(e,t),e.parent_||hI(e,t)),e.patches_&&fg("Patches").generateReplacementPatches_(r[wu].base_,t,e.patches_,e.inversePatches_)):t=fI(e,r,[]),_F(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==uoe?t:void 0}function fI(t,e,r){if(FP(e))return e;const n=t.immer_.shouldUseStrictIteration(),a=e[wu];if(!a)return dI(e,(s,o)=>zG(t,a,e,s,o,r),n),e;if(a.scope_!==t)return e;if(!a.modified_)return hI(t,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const s=a.copy_;let o=s,l=!1;a.type_===3&&(o=new Set(s),s.clear(),l=!0),dI(o,(c,u)=>zG(t,a,s,c,u,r,l),n),hI(t,s,!1),r&&t.patches_&&fg("Patches").generatePatches_(a,r,t.patches_,t.inversePatches_)}return a.copy_}function zG(t,e,r,n,a,s,o){if(a==null||typeof a!="object"&&!o)return;const l=FP(a);if(!(l&&!o)){if(Mv(a)){const c=s&&e&&e.type_!==3&&!NF(e.assigned_,n)?s.concat(n):void 0,u=fI(t,a,c);if(foe(r,n,u),Mv(u))t.canAutoFreeze_=!1;else return}else o&&r.add(a);if(dg(a)&&!l){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||e&&e.base_&&e.base_[n]===a&&l)return;fI(t,a),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&(Gw(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&hI(t,a)}}}function hI(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&ZR(e,r)}function GGe(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:hoe(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,s=e8;r&&(a=[n],s=K2);const{revoke:o,proxy:l}=Proxy.revocable(a,s);return n.draft_=l,n.revoke_=o,l}var e8={get(t,e){if(e===wu)return t;const r=rp(t);if(!NF(r,e))return KGe(t,r,e);const n=r[e];return t.finalized_||!dg(n)?n:n===tB(t.base_,e)?(rB(t),t.copy_[e]=IF(n,t)):n},has(t,e){return e in rp(t)},ownKeys(t){return Reflect.ownKeys(rp(t))},set(t,e,r){const n=Aoe(rp(t),e);if(n!=null&&n.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const a=tB(rp(t),e),s=a==null?void 0:a[wu];if(s&&s.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(UGe(r,a)&&(r!==void 0||NF(t.base_,e)))return!0;rB(t),SF(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return tB(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,rB(t),SF(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=rp(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){Gd(11)},getPrototypeOf(t){return $2(t.base_)},setPrototypeOf(){Gd(12)}},K2={};dI(e8,(t,e)=>{K2[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});K2.deleteProperty=function(t,e){return K2.set.call(this,t,e,void 0)};K2.set=function(t,e,r){return e8.set.call(this,t[0],e,r,t[0])};function tB(t,e){const r=t[wu];return(r?rp(r):t)[e]}function KGe(t,e,r){var a;const n=Aoe(e,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(t.draft_):void 0}function Aoe(t,e){if(!(e in t))return;let r=$2(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=$2(r)}}function SF(t){t.modified_||(t.modified_=!0,t.parent_&&SF(t.parent_))}function rB(t){t.copy_||(t.copy_=CF(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var qGe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const s=r;r=e;const o=this;return function(c=s,...u){return o.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&Gd(6),n!==void 0&&typeof n!="function"&&Gd(7);let a;if(dg(e)){const s=KG(this),o=IF(e,void 0);let l=!0;try{a=r(o),l=!1}finally{l?_F(s):EF(s)}return GG(s,n),qG(a,s)}else if(!e||typeof e!="object"){if(a=r(e),a===void 0&&(a=e),a===uoe&&(a=void 0),this.autoFreeze_&&ZR(a,!0),n){const s=[],o=[];fg("Patches").generateReplacementPatches_(e,a,s,o),n(s,o)}return a}else Gd(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,c=>e(c,...l));let n,a;return[this.produce(e,r,(o,l)=>{n=o,a=l}),n,a]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof(t==null?void 0:t.useStrictIteration)=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){dg(t)||Gd(8),Mv(t)&&(t=zGe(t));const e=KG(this),r=IF(t,void 0);return r[wu].isManual_=!0,EF(e),r}finishDraft(t,e){const r=t&&t[wu];(!r||!r.isManual_)&&Gd(9);const{scope_:n}=r;return GG(n,e),qG(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const a=e[r];if(a.path.length===0&&a.op==="replace"){t=a.value;break}}r>-1&&(e=e.slice(r+1));const n=fg("Patches").applyPatches_;return Mv(t)?n(t,e):this.produce(t,a=>n(a,e))}};function IF(t,e){const r=Gw(t)?fg("MapSet").proxyMap_(t,e):kP(t)?fg("MapSet").proxySet_(t,e):GGe(t,e);return(e?e.scope_:hoe()).drafts_.push(r),r}function zGe(t){return Mv(t)||Gd(10,t),moe(t)}function moe(t){if(!dg(t)||FP(t))return t;const e=t[wu];let r,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=CF(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else r=CF(t,!0);return dI(r,(a,s)=>{foe(r,a,moe(s))},n),e&&(e.finalized_=!1),r}var WGe=new qGe;WGe.produce;var XGe={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},poe=Vc({name:"legend",initialState:XGe,reducers:{setLegendSize(t,e){t.size.width=e.payload.width,t.size.height=e.payload.height},setLegendSettings(t,e){t.settings.align=e.payload.align,t.settings.layout=e.payload.layout,t.settings.verticalAlign=e.payload.verticalAlign,t.settings.itemSorter=e.payload.itemSorter},addLegendPayload:{reducer(t,e){t.payload.push(e.payload)},prepare:Ns()},replaceLegendPayload:{reducer(t,e){var{prev:r,next:n}=e.payload,a=rf(t).payload.indexOf(r);a>-1&&(t.payload[a]=n)},prepare:Ns()},removeLegendPayload:{reducer(t,e){var r=rf(t).payload.indexOf(e.payload);r>-1&&t.payload.splice(r,1)},prepare:Ns()}}}),{setLegendSize:WG,setLegendSettings:YGe,addLegendPayload:goe,replaceLegendPayload:xoe,removeLegendPayload:voe}=poe.actions,JGe=poe.reducer,ZGe=["contextPayload"];function jF(){return jF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},jF.apply(null,arguments)}function XG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Lv(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?XG(Object(r),!0).forEach(function(n){eKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):XG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function eKe(t,e,r){return(e=tKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tKe(t){var e=rKe(t,"string");return typeof e=="symbol"?e:e+""}function rKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nKe(t,e){if(t==null)return{};var r,n,a=aKe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function aKe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function sKe(t){return t.value}function iKe(t){var{contextPayload:e}=t,r=nKe(t,ZGe),n=cie(e,t.payloadUniqBy,sKe),a=Lv(Lv({},r),{},{payload:n});return x.isValidElement(t.content)?x.cloneElement(t.content,a):typeof t.content=="function"?x.createElement(t.content,a):x.createElement(cHe,a)}function oKe(t,e,r,n,a,s){var{layout:o,align:l,verticalAlign:c}=e,u,d;return(!t||(t.left===void 0||t.left===null)&&(t.right===void 0||t.right===null))&&(l==="center"&&o==="vertical"?u={left:((n||0)-s.width)/2}:u=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!t||(t.top===void 0||t.top===null)&&(t.bottom===void 0||t.bottom===null))&&(c==="middle"?d={top:((a||0)-s.height)/2}:d=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),Lv(Lv({},u),d)}function lKe(t){var e=os();return x.useEffect(()=>{e(YGe(t))},[e,t]),null}function cKe(t){var e=os();return x.useEffect(()=>(e(WG(t)),()=>{e(WG({width:0,height:0}))}),[e,t]),null}function uKe(t,e,r,n){return t==="vertical"&&rn(e)?{height:e}:t==="horizontal"?{width:r||n}:null}var dKe={align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function PF(t){var e=Al(t,dKe),r=qHe(),n=tVe(),a=RGe(),{width:s,height:o,wrapperStyle:l,portal:c}=e,[u,d]=bie([r]),f=loe(),A=coe();if(f==null||A==null)return null;var h=f-((a==null?void 0:a.left)||0)-((a==null?void 0:a.right)||0),m=uKe(e.layout,o,s,h),p=c?l:Lv(Lv({position:"absolute",width:(m==null?void 0:m.width)||s||"auto",height:(m==null?void 0:m.height)||o||"auto"},oKe(l,e,a,f,A,u)),l),g=c??n;if(g==null||r==null)return null;var v=x.createElement("div",{className:"recharts-legend-wrapper",style:p,ref:d},x.createElement(lKe,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),!c&&x.createElement(cKe,{width:u.width,height:u.height}),x.createElement(iKe,jF({},e,m,{margin:a,chartWidth:f,chartHeight:A,contextPayload:r})));return pu.createPortal(v,g)}PF.displayName="Legend";function BF(){return BF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},BF.apply(null,arguments)}function YG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function nB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?YG(Object(r),!0).forEach(function(n){fKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):YG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function fKe(t,e,r){return(e=hKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hKe(t){var e=AKe(t,"string");return typeof e=="symbol"?e:e+""}function AKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mKe(t){return Array.isArray(t)&&Wf(t[0])&&Wf(t[1])?t.join(" ~ "):t}var pKe=t=>{var{separator:e=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:s,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:f,accessibilityLayer:A=!1}=t,h=()=>{if(s&&s.length){var j={padding:0,margin:0},I=(l?mP(s,l):s).map((_,S)=>{if(_.type==="none")return null;var E=_.formatter||o||mKe,{value:F,name:k}=_,P=F,D=k;if(E){var X=E(F,k,_,S,s);if(Array.isArray(X))[P,D]=X;else if(X!=null)P=X;else return null}var pe=nB({display:"block",paddingTop:4,paddingBottom:4,color:_.color||"#000"},n);return x.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(S),style:pe},Wf(D)?x.createElement("span",{className:"recharts-tooltip-item-name"},D):null,Wf(D)?x.createElement("span",{className:"recharts-tooltip-item-separator"},e):null,x.createElement("span",{className:"recharts-tooltip-item-value"},P),x.createElement("span",{className:"recharts-tooltip-item-unit"},_.unit||""))});return x.createElement("ul",{className:"recharts-tooltip-item-list",style:j},I)}return null},m=nB({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),p=nB({margin:0},a),g=!Qo(d),v=g?d:"",y=La("recharts-default-tooltip",c),b=La("recharts-tooltip-label",u);g&&f&&s!==void 0&&s!==null&&(v=f(d,s));var w=A?{role:"status","aria-live":"assertive"}:{};return x.createElement("div",BF({className:y,style:m},w),x.createElement("p",{className:b,style:p},x.isValidElement(v)?v:"".concat(v)),h())},my="recharts-tooltip-wrapper",gKe={visibility:"hidden"};function xKe(t){var{coordinate:e,translateX:r,translateY:n}=t;return La(my,{["".concat(my,"-right")]:rn(r)&&e&&rn(e.x)&&r>=e.x,["".concat(my,"-left")]:rn(r)&&e&&rn(e.x)&&r<e.x,["".concat(my,"-bottom")]:rn(n)&&e&&rn(e.y)&&n>=e.y,["".concat(my,"-top")]:rn(n)&&e&&rn(e.y)&&n<e.y})}function JG(t){var{allowEscapeViewBox:e,coordinate:r,key:n,offsetTopLeft:a,position:s,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:u}=t;if(s&&rn(s[n]))return s[n];var d=r[n]-l-(a>0?a:0),f=r[n]+a;if(e[n])return o[n]?d:f;var A=c[n];if(A==null)return 0;if(o[n]){var h=d,m=A;return h<m?Math.max(f,A):Math.max(d,A)}if(u==null)return 0;var p=f+l,g=A+u;return p>g?Math.max(d,A):Math.max(f,A)}function vKe(t){var{translateX:e,translateY:r,useTranslate3d:n}=t;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function yKe(t){var{allowEscapeViewBox:e,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:s,tooltipBox:o,useTranslate3d:l,viewBox:c}=t,u,d,f;return o.height>0&&o.width>0&&r?(d=JG({allowEscapeViewBox:e,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:s,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),f=JG({allowEscapeViewBox:e,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:s,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),u=vKe({translateX:d,translateY:f,useTranslate3d:l})):u=gKe,{cssProperties:u,cssClasses:xKe({translateX:d,translateY:f,coordinate:r})}}function ZG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function f_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ZG(Object(r),!0).forEach(function(n){TF(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ZG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function TF(t,e,r){return(e=bKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bKe(t){var e=wKe(t,"string");return typeof e=="symbol"?e:e+""}function wKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NKe extends x.PureComponent{constructor(){super(...arguments),TF(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),TF(this,"handleKeyDown",e=>{if(e.key==="Escape"){var r,n,a,s;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,r;this.state.dismissed&&(((e=this.props.coordinate)===null||e===void 0?void 0:e.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:e,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:s,coordinate:o,hasPayload:l,isAnimationActive:c,offset:u,position:d,reverseDirection:f,useTranslate3d:A,viewBox:h,wrapperStyle:m,lastBoundingBox:p,innerRef:g,hasPortalFromProps:v}=this.props,{cssClasses:y,cssProperties:b}=yKe({allowEscapeViewBox:r,coordinate:o,offsetTopLeft:u,position:d,reverseDirection:f,tooltipBox:{height:p.height,width:p.width},useTranslate3d:A,viewBox:h}),w=v?{}:f_(f_({transition:c&&e?"transform ".concat(n,"ms ").concat(a):void 0},b),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&l?"visible":"hidden",position:"absolute",top:0,left:0}),j=f_(f_({},w),{},{visibility:!this.state.dismissed&&e&&l?"visible":"hidden"},m);return x.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:y,style:j,ref:g},s)}}var yoe=()=>{var t;return(t=Jr(e=>e.rootProps.accessibilityLayer))!==null&&t!==void 0?t:!0};function kF(){return kF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},kF.apply(null,arguments)}function eK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function tK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?eK(Object(r),!0).forEach(function(n){CKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):eK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function CKe(t,e,r){return(e=_Ke(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _Ke(t){var e=EKe(t,"string");return typeof e=="symbol"?e:e+""}function EKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var rK={curveBasisClosed:yVe,curveBasisOpen:bVe,curveBasis:vVe,curveBumpX:sVe,curveBumpY:iVe,curveLinearClosed:wVe,curveLinear:lP,curveMonotoneX:NVe,curveMonotoneY:CVe,curveNatural:_Ve,curveStep:EVe,curveStepAfter:IVe,curveStepBefore:SVe},AI=t=>Zs(t.x)&&Zs(t.y),nK=t=>t.base!=null&&AI(t.base)&&AI(t),py=t=>t.x,gy=t=>t.y,SKe=(t,e)=>{if(typeof t=="function")return t;var r="curve".concat(Mw(t));return(r==="curveMonotone"||r==="curveBump")&&e?rK["".concat(r).concat(e==="vertical"?"Y":"X")]:rK[r]||lP},IKe=t=>{var{type:e="linear",points:r=[],baseLine:n,layout:a,connectNulls:s=!1}=t,o=SKe(e,a),l=s?r.filter(AI):r,c;if(Array.isArray(n)){var u=r.map((h,m)=>tK(tK({},h),{},{base:n[m]}));a==="vertical"?c=a_().y(gy).x1(py).x0(h=>h.base.x):c=a_().x(py).y1(gy).y0(h=>h.base.y);var d=c.defined(nK).curve(o),f=s?u.filter(nK):u;return d(f)}a==="vertical"&&rn(n)?c=a_().y(gy).x1(py).x0(n):rn(n)?c=a_().x(py).y1(gy).y0(n):c=Pse().x(py).y(gy);var A=c.defined(AI).curve(o);return A(l)},t8=t=>{var{className:e,points:r,path:n,pathRef:a}=t,s=$w();if((!r||!r.length)&&!n)return null;var o={type:t.type,points:t.points,baseLine:t.baseLine,layout:t.layout||s,connectNulls:t.connectNulls},l=r&&r.length?IKe(o):n;return x.createElement("path",kF({},qf(t),XVe(t),{className:La("recharts-curve",e),d:l===null?void 0:l,ref:a}))},jKe=["x","y","top","left","width","height","className"];function FF(){return FF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},FF.apply(null,arguments)}function aK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function PKe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?aK(Object(r),!0).forEach(function(n){BKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):aK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function BKe(t,e,r){return(e=TKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TKe(t){var e=kKe(t,"string");return typeof e=="symbol"?e:e+""}function kKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FKe(t,e){if(t==null)return{};var r,n,a=OKe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function OKe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var DKe=(t,e,r,n,a,s)=>"M".concat(t,",").concat(a,"v").concat(n,"M").concat(s,",").concat(e,"h").concat(r),RKe=t=>{var{x:e=0,y:r=0,top:n=0,left:a=0,width:s=0,height:o=0,className:l}=t,c=FKe(t,jKe),u=PKe({x:e,y:r,top:n,left:a,width:s,height:o},c);return!rn(e)||!rn(r)||!rn(s)||!rn(o)||!rn(n)||!rn(a)?null:x.createElement("path",FF({},pd(u),{className:La("recharts-cross",l),d:DKe(e,r,s,o,n,a)}))};function MKe(t,e,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-a:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-a,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function sK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function iK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sK(Object(r),!0).forEach(function(n){LKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function LKe(t,e,r){return(e=UKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UKe(t){var e=QKe(t,"string");return typeof e=="symbol"?e:e+""}function QKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var VKe=t=>t.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())),boe=(t,e,r)=>t.map(n=>"".concat(VKe(n)," ").concat(e,"ms ").concat(r)).join(","),HKe=(t,e)=>[Object.keys(t),Object.keys(e)].reduce((r,n)=>r.filter(a=>n.includes(a))),q2=(t,e)=>Object.keys(e).reduce((r,n)=>iK(iK({},r),{},{[n]:t(n,e[n])}),{});function oK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function io(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?oK(Object(r),!0).forEach(function(n){$Ke(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):oK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $Ke(t,e,r){return(e=GKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GKe(t){var e=KKe(t,"string");return typeof e=="symbol"?e:e+""}function KKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mI=(t,e,r)=>t+(e-t)*r,OF=t=>{var{from:e,to:r}=t;return e!==r},woe=(t,e,r)=>{var n=q2((a,s)=>{if(OF(s)){var[o,l]=t(s.from,s.to,s.velocity);return io(io({},s),{},{from:o,velocity:l})}return s},e);return r<1?q2((a,s)=>OF(s)&&n[a]!=null?io(io({},s),{},{velocity:mI(s.velocity,n[a].velocity,r),from:mI(s.from,n[a].from,r)}):s,e):woe(t,n,r-1)};function qKe(t,e,r,n,a,s){var o,l=n.reduce((A,h)=>io(io({},A),{},{[h]:{from:t[h],velocity:0,to:e[h]}}),{}),c=()=>q2((A,h)=>h.from,l),u=()=>!Object.values(l).filter(OF).length,d=null,f=A=>{o||(o=A);var h=A-o,m=h/r.dt;l=woe(r,l,m),a(io(io(io({},t),e),c())),o=A,u()||(d=s.setTimeout(f))};return()=>(d=s.setTimeout(f),()=>{var A;(A=d)===null||A===void 0||A()})}function zKe(t,e,r,n,a,s,o){var l=null,c=a.reduce((f,A)=>{var h=t[A],m=e[A];return h==null||m==null?f:io(io({},f),{},{[A]:[h,m]})},{}),u,d=f=>{u||(u=f);var A=(f-u)/n,h=q2((p,g)=>mI(...g,r(A)),c);if(s(io(io(io({},t),e),h)),A<1)l=o.setTimeout(d);else{var m=q2((p,g)=>mI(...g,r(1)),c);s(io(io(io({},t),e),m))}};return()=>(l=o.setTimeout(d),()=>{var f;(f=l)===null||f===void 0||f()})}const WKe=(t,e,r,n,a,s)=>{var o=HKe(t,e);return r==null?()=>(a(io(io({},t),e)),()=>{}):r.isStepper===!0?qKe(t,e,r,o,a,s):zKe(t,e,r,n,o,a,s)};var pI=1e-4,Noe=(t,e)=>[0,3*t,3*e-6*t,3*t-3*e+1],Coe=(t,e)=>t.map((r,n)=>r*e**n).reduce((r,n)=>r+n),lK=(t,e)=>r=>{var n=Noe(t,e);return Coe(n,r)},XKe=(t,e)=>r=>{var n=Noe(t,e),a=[...n.map((s,o)=>s*o).slice(1),0];return Coe(a,r)},YKe=t=>{var e,r=t.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(e=r[1])===null||e===void 0||(e=e.split(")")[0])===null||e===void 0?void 0:e.split(",");if(n==null||n.length!==4)return null;var a=n.map(s=>parseFloat(s));return[a[0],a[1],a[2],a[3]]},JKe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var a=YKe(r[0]);if(a)return a}}return r.length===4?r:[0,0,1,1]},ZKe=(t,e,r,n)=>{var a=lK(t,r),s=lK(e,n),o=XKe(t,r),l=u=>u>1?1:u<0?0:u,c=u=>{for(var d=u>1?1:u,f=d,A=0;A<8;++A){var h=a(f)-d,m=o(f);if(Math.abs(h-d)<pI||m<pI)return s(f);f=l(f-h/m)}return s(f)};return c.isStepper=!1,c},cK=function(){return ZKe(...JKe(...arguments))},eqe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=e,s=(o,l,c)=>{var u=-(o-l)*r,d=c*n,f=c+(u-d)*a/1e3,A=c*a/1e3+o;return Math.abs(A-l)<pI&&Math.abs(f)<pI?[l,0]:[A,f]};return s.isStepper=!0,s.dt=a,s},tqe=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return cK(t);case"spring":return eqe();default:if(t.split("(")[0]==="cubic-bezier")return cK(t)}return typeof t=="function"?t:null};function rqe(t){var e,r=()=>null,n=!1,a=null,s=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...u]=l;if(typeof c=="number"){a=t.setTimeout(s.bind(null,u),c);return}s(c),a=t.setTimeout(s.bind(null,u));return}typeof o=="string"&&(e=o,r(e)),typeof o=="object"&&(e=o,r(e)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,a&&(a(),a=null),s(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>t}}class nqe{setTimeout(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,s=o=>{o-n>=r?e(o):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(s))};return a=requestAnimationFrame(s),()=>{a!=null&&cancelAnimationFrame(a)}}}function aqe(){return rqe(new nqe)}var sqe=x.createContext(aqe);function iqe(t,e){var r=x.useContext(sqe);return x.useMemo(()=>e??r(t),[t,e,r])}var oqe=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),OP={isSsr:oqe()},lqe={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},uK={t:0},aB={t:1};function DP(t){var e=Al(t,lqe),{isActive:r,canBegin:n,duration:a,easing:s,begin:o,onAnimationEnd:l,onAnimationStart:c,children:u}=e,d=r==="auto"?!OP.isSsr:r,f=iqe(e.animationId,e.animationManager),[A,h]=x.useState(d?uK:aB),m=x.useRef(null);return x.useEffect(()=>{d||h(aB)},[d]),x.useEffect(()=>{if(!d||!n)return Lw;var p=WKe(uK,aB,tqe(s),a,h,f.getTimeoutController()),g=()=>{m.current=p()};return f.start([c,o,g,a,l]),()=>{f.stop(),m.current&&m.current(),l()}},[d,n,a,s,o,c,l,f]),u(A.t)}function RP(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=x.useRef(U2(e)),n=x.useRef(t);return n.current!==t&&(r.current=U2(e),n.current=t),r.current}var cqe=["radius"],uqe=["radius"],dK,fK,hK,AK,mK,pK,gK,xK,vK,yK;function bK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function wK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bK(Object(r),!0).forEach(function(n){dqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function dqe(t,e,r){return(e=fqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fqe(t){var e=hqe(t,"string");return typeof e=="symbol"?e:e+""}function hqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gI(){return gI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},gI.apply(null,arguments)}function NK(t,e){if(t==null)return{};var r,n,a=Aqe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Aqe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function _f(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var CK=(t,e,r,n,a)=>{var s=R0(r),o=R0(n),l=Math.min(Math.abs(s)/2,Math.abs(o)/2),c=o>=0?1:-1,u=s>=0?1:-1,d=o>=0&&s>=0||o<0&&s<0?1:0,f;if(l>0&&a instanceof Array){for(var A=[0,0,0,0],h=0,m=4;h<m;h++)A[h]=a[h]>l?l:a[h];f=oi(dK||(dK=_f(["M",",",""])),t,e+c*A[0]),A[0]>0&&(f+=oi(fK||(fK=_f(["A ",",",",0,0,",",",",",""])),A[0],A[0],d,t+u*A[0],e)),f+=oi(hK||(hK=_f(["L ",",",""])),t+r-u*A[1],e),A[1]>0&&(f+=oi(AK||(AK=_f(["A ",",",",0,0,",`,
        `,",",""])),A[1],A[1],d,t+r,e+c*A[1])),f+=oi(mK||(mK=_f(["L ",",",""])),t+r,e+n-c*A[2]),A[2]>0&&(f+=oi(pK||(pK=_f(["A ",",",",0,0,",`,
        `,",",""])),A[2],A[2],d,t+r-u*A[2],e+n)),f+=oi(gK||(gK=_f(["L ",",",""])),t+u*A[3],e+n),A[3]>0&&(f+=oi(xK||(xK=_f(["A ",",",",0,0,",`,
        `,",",""])),A[3],A[3],d,t,e+n-c*A[3])),f+="Z"}else if(l>0&&a===+a&&a>0){var p=Math.min(l,a);f=oi(vK||(vK=_f(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),t,e+c*p,p,p,d,t+u*p,e,t+r-u*p,e,p,p,d,t+r,e+c*p,t+r,e+n-c*p,p,p,d,t+r-u*p,e+n,t+u*p,e+n,p,p,d,t,e+n-c*p)}else f=oi(yK||(yK=_f(["M ",","," h "," v "," h "," Z"])),t,e,r,n,-r);return f},_K={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},_oe=t=>{var e=Al(t,_K),r=x.useRef(null),[n,a]=x.useState(-1);x.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var fe=r.current.getTotalLength();fe&&a(fe)}catch{}},[]);var{x:s,y:o,width:l,height:c,radius:u,className:d}=e,{animationEasing:f,animationDuration:A,animationBegin:h,isAnimationActive:m,isUpdateAnimationActive:p}=e,g=x.useRef(l),v=x.useRef(c),y=x.useRef(s),b=x.useRef(o),w=x.useMemo(()=>({x:s,y:o,width:l,height:c,radius:u}),[s,o,l,c,u]),j=RP(w,"rectangle-");if(s!==+s||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var I=La("recharts-rectangle",d);if(!p){var _=pd(e),{radius:S}=_,E=NK(_,cqe);return x.createElement("path",gI({},E,{x:R0(s),y:R0(o),width:R0(l),height:R0(c),radius:typeof u=="number"?u:void 0,className:I,d:CK(s,o,l,c,u)}))}var F=g.current,k=v.current,P=y.current,D=b.current,X="0px ".concat(n===-1?1:n,"px"),pe="".concat(n,"px 0px"),ge=boe(["strokeDasharray"],A,typeof f=="string"?f:_K.animationEasing);return x.createElement(DP,{animationId:j,key:j,canBegin:n>0,duration:A,easing:f,isActive:p,begin:h},fe=>{var xe=so(F,l,fe),ae=so(k,c,fe),Se=so(P,s,fe),Te=so(D,o,fe);r.current&&(g.current=xe,v.current=ae,y.current=Se,b.current=Te);var O;m?fe>0?O={transition:ge,strokeDasharray:pe}:O={strokeDasharray:X}:O={strokeDasharray:pe};var G=pd(e),{radius:z}=G,L=NK(G,uqe);return x.createElement("path",gI({},L,{radius:typeof u=="number"?u:void 0,className:I,d:CK(Se,Te,xe,ae,u),ref:r,style:wK(wK({},O),e.style)}))})};function EK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function SK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?EK(Object(r),!0).forEach(function(n){mqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):EK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mqe(t,e,r){return(e=pqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pqe(t){var e=gqe(t,"string");return typeof e=="symbol"?e:e+""}function gqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xI=Math.PI/180,xqe=t=>t*180/Math.PI,Hi=(t,e,r,n)=>({x:t+Math.cos(-xI*n)*r,y:e+Math.sin(-xI*n)*r}),Eoe=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},vqe=(t,e)=>{var{x:r,y:n}=t,{x:a,y:s}=e;return Math.sqrt((r-a)**2+(n-s)**2)},yqe=(t,e)=>{var{x:r,y:n}=t,{cx:a,cy:s}=e,o=vqe({x:r,y:n},{x:a,y:s});if(o<=0)return{radius:o,angle:0};var l=(r-a)/o,c=Math.acos(l);return n>s&&(c=2*Math.PI-c),{radius:o,angle:xqe(c),angleInRadian:c}},bqe=t=>{var{startAngle:e,endAngle:r}=t,n=Math.floor(e/360),a=Math.floor(r/360),s=Math.min(n,a);return{startAngle:e-s*360,endAngle:r-s*360}},wqe=(t,e)=>{var{startAngle:r,endAngle:n}=e,a=Math.floor(r/360),s=Math.floor(n/360),o=Math.min(a,s);return t+o*360},Nqe=(t,e)=>{var{chartX:r,chartY:n}=t,{radius:a,angle:s}=yqe({x:r,y:n},e),{innerRadius:o,outerRadius:l}=e;if(a<o||a>l||a===0)return null;var{startAngle:c,endAngle:u}=bqe(e),d=s,f;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;f=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;f=d>=u&&d<=c}return f?SK(SK({},e),{},{radius:a,angle:wqe(d,e)}):null};function Soe(t){var{cx:e,cy:r,radius:n,startAngle:a,endAngle:s}=t,o=Hi(e,r,n,a),l=Hi(e,r,n,s);return{points:[o,l],cx:e,cy:r,radius:n,startAngle:a,endAngle:s}}var IK,jK,PK,BK,TK,kK,FK;function DF(){return DF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},DF.apply(null,arguments)}function xp(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var Cqe=(t,e)=>{var r=dl(e-t),n=Math.min(Math.abs(e-t),359.999);return r*n},h_=t=>{var{cx:e,cy:r,radius:n,angle:a,sign:s,isExternal:o,cornerRadius:l,cornerIsExternal:c}=t,u=l*(o?1:-1)+n,d=Math.asin(l/u)/xI,f=c?a:a+s*d,A=Hi(e,r,u,f),h=Hi(e,r,n,f),m=c?a-s*d:a,p=Hi(e,r,u*Math.cos(d*xI),m);return{center:A,circleTangency:h,lineTangency:p,theta:d}},Ioe=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:a,startAngle:s,endAngle:o}=t,l=Cqe(s,o),c=s+l,u=Hi(e,r,a,s),d=Hi(e,r,a,c),f=oi(IK||(IK=xp(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),u.x,u.y,a,a,+(Math.abs(l)>180),+(s>c),d.x,d.y);if(n>0){var A=Hi(e,r,n,s),h=Hi(e,r,n,c);f+=oi(jK||(jK=xp(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),h.x,h.y,n,n,+(Math.abs(l)>180),+(s<=c),A.x,A.y)}else f+=oi(PK||(PK=xp(["L ",","," Z"])),e,r);return f},_qe=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:a,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u}=t,d=dl(u-c),{circleTangency:f,lineTangency:A,theta:h}=h_({cx:e,cy:r,radius:a,angle:c,sign:d,cornerRadius:s,cornerIsExternal:l}),{circleTangency:m,lineTangency:p,theta:g}=h_({cx:e,cy:r,radius:a,angle:u,sign:-d,cornerRadius:s,cornerIsExternal:l}),v=l?Math.abs(c-u):Math.abs(c-u)-h-g;if(v<0)return o?oi(BK||(BK=xp(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),A.x,A.y,s,s,s*2,s,s,-s*2):Ioe({cx:e,cy:r,innerRadius:n,outerRadius:a,startAngle:c,endAngle:u});var y=oi(TK||(TK=xp(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),A.x,A.y,s,s,+(d<0),f.x,f.y,a,a,+(v>180),+(d<0),m.x,m.y,s,s,+(d<0),p.x,p.y);if(n>0){var{circleTangency:b,lineTangency:w,theta:j}=h_({cx:e,cy:r,radius:n,angle:c,sign:d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),{circleTangency:I,lineTangency:_,theta:S}=h_({cx:e,cy:r,radius:n,angle:u,sign:-d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),E=l?Math.abs(c-u):Math.abs(c-u)-j-S;if(E<0&&s===0)return"".concat(y,"L").concat(e,",").concat(r,"Z");y+=oi(kK||(kK=xp(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),_.x,_.y,s,s,+(d<0),I.x,I.y,n,n,+(E>180),+(d>0),b.x,b.y,s,s,+(d<0),w.x,w.y)}else y+=oi(FK||(FK=xp(["L",",","Z"])),e,r);return y},Eqe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},joe=t=>{var e=Al(t,Eqe),{cx:r,cy:n,innerRadius:a,outerRadius:s,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d,className:f}=e;if(s<a||u===d)return null;var A=La("recharts-sector",f),h=s-a,m=Ll(o,h,0,!0),p;return m>0&&Math.abs(u-d)<360?p=_qe({cx:r,cy:n,innerRadius:a,outerRadius:s,cornerRadius:Math.min(m,h/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d}):p=Ioe({cx:r,cy:n,innerRadius:a,outerRadius:s,startAngle:u,endAngle:d}),x.createElement("path",DF({},pd(e),{className:A,d:p}))};function Sqe(t,e,r){if(t==="horizontal")return[{x:e.x,y:r.top},{x:e.x,y:r.top+r.height}];if(t==="vertical")return[{x:r.left,y:e.y},{x:r.left+r.width,y:e.y}];if(Gse(e)){if(t==="centric"){var{cx:n,cy:a,innerRadius:s,outerRadius:o,angle:l}=e,c=Hi(n,a,s,l),u=Hi(n,a,o,l);return[{x:c.x,y:c.y},{x:u.x,y:u.y}]}return Soe(e)}}var Poe={},Boe={},Toe={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=HR;function r(n){return e.isSymbol(n)?NaN:Number(n)}t.toNumber=r})(Toe);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Toe;function r(n){return n?(n=e.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}t.toFinite=r})(Boe);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=$R,r=Boe;function n(a,s,o){o&&typeof o!="number"&&e.isIterateeCall(a,s,o)&&(s=o=void 0),a=r.toFinite(a),s===void 0?(s=a,a=0):s=r.toFinite(s),o=o===void 0?a<s?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((s-a)/(o||1)),0),c=new Array(l);for(let u=0;u<l;u++)c[u]=a,a+=o;return c}t.range=n})(Poe);var Iqe=Poe.range;const koe=mA(Iqe);function tm(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function jqe(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function r8(t){let e,r,n;t.length!==2?(e=tm,r=(l,c)=>tm(t(l),c),n=(l,c)=>t(l)-c):(e=t===tm||t===jqe?t:Pqe,r=t,n=t);function a(l,c,u=0,d=l.length){if(u<d){if(e(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<0?u=f+1:d=f}while(u<d)}return u}function s(l,c,u=0,d=l.length){if(u<d){if(e(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function o(l,c,u=0,d=l.length){const f=a(l,c,u,d-1);return f>u&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:a,center:o,right:s}}function Pqe(){return 0}function Foe(t){return t===null?NaN:+t}function*Bqe(t,e){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const Tqe=r8(tm),Kw=Tqe.right;r8(Foe).center;class OK extends Map{constructor(e,r=Oqe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,a]of e)this.set(n,a)}get(e){return super.get(DK(this,e))}has(e){return super.has(DK(this,e))}set(e,r){return super.set(kqe(this,e),r)}delete(e){return super.delete(Fqe(this,e))}}function DK({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function kqe({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function Fqe({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function Oqe(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Dqe(t=tm){if(t===tm)return Ooe;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function Ooe(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const Rqe=Math.sqrt(50),Mqe=Math.sqrt(10),Lqe=Math.sqrt(2);function vI(t,e,r){const n=(e-t)/Math.max(0,r),a=Math.floor(Math.log10(n)),s=n/Math.pow(10,a),o=s>=Rqe?10:s>=Mqe?5:s>=Lqe?2:1;let l,c,u;return a<0?(u=Math.pow(10,-a)/o,l=Math.round(t*u),c=Math.round(e*u),l/u<t&&++l,c/u>e&&--c,u=-u):(u=Math.pow(10,a)*o,l=Math.round(t/u),c=Math.round(e/u),l*u<t&&++l,c*u>e&&--c),c<l&&.5<=r&&r<2?vI(t,e,r*2):[l,c,u]}function RF(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[a,s,o]=n?vI(e,t,r):vI(t,e,r);if(!(s>=a))return[];const l=s-a+1,c=new Array(l);if(n)if(o<0)for(let u=0;u<l;++u)c[u]=(s-u)/-o;else for(let u=0;u<l;++u)c[u]=(s-u)*o;else if(o<0)for(let u=0;u<l;++u)c[u]=(a+u)/-o;else for(let u=0;u<l;++u)c[u]=(a+u)*o;return c}function MF(t,e,r){return e=+e,t=+t,r=+r,vI(t,e,r)[2]}function LF(t,e,r){e=+e,t=+t,r=+r;const n=e<t,a=n?MF(e,t,r):MF(t,e,r);return(n?-1:1)*(a<0?1/-a:a)}function RK(t,e){let r;for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function MK(t,e){let r;for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function Doe(t,e,r=0,n=1/0,a){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(a=a===void 0?Ooe:Dqe(a);n>r;){if(n-r>600){const c=n-r+1,u=e-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),A=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),h=Math.max(r,Math.floor(e-u*f/c+A)),m=Math.min(n,Math.floor(e+(c-u)*f/c+A));Doe(t,e,h,m,a)}const s=t[e];let o=r,l=n;for(xy(t,r,e),a(t[n],s)>0&&xy(t,r,n);o<l;){for(xy(t,o,l),++o,--l;a(t[o],s)<0;)++o;for(;a(t[l],s)>0;)--l}a(t[r],s)===0?xy(t,r,l):(++l,xy(t,l,n)),l<=e&&(r=l+1),e<=l&&(n=l-1)}return t}function xy(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function Uqe(t,e,r){if(t=Float64Array.from(Bqe(t)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return MK(t);if(e>=1)return RK(t);var n,a=(n-1)*e,s=Math.floor(a),o=RK(Doe(t,s).subarray(0,s+1)),l=MK(t.subarray(s+1));return o+(l-o)*(a-s)}}function Qqe(t,e,r=Foe){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,a=(n-1)*e,s=Math.floor(a),o=+r(t[s],s,t),l=+r(t[s+1],s+1,t);return o+(l-o)*(a-s)}}function Vqe(t,e,r){t=+t,e=+e,r=(a=arguments.length)<2?(e=t,t=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((e-t)/r))|0,s=new Array(a);++n<a;)s[n]=t+n*r;return s}function wd(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function SA(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const UF=Symbol("implicit");function n8(){var t=new OK,e=[],r=[],n=UF;function a(s){let o=t.get(s);if(o===void 0){if(n!==UF)return n;t.set(s,o=e.push(s)-1)}return r[o%r.length]}return a.domain=function(s){if(!arguments.length)return e.slice();e=[],t=new OK;for(const o of s)t.has(o)||t.set(o,e.push(o)-1);return a},a.range=function(s){return arguments.length?(r=Array.from(s),a):r.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return n8(e,r).unknown(n)},wd.apply(a,arguments),a}function a8(){var t=n8().unknown(void 0),e=t.domain,r=t.range,n=0,a=1,s,o,l=!1,c=0,u=0,d=.5;delete t.unknown;function f(){var A=e().length,h=a<n,m=h?a:n,p=h?n:a;s=(p-m)/Math.max(1,A-c+u*2),l&&(s=Math.floor(s)),m+=(p-m-s*(A-c))*d,o=s*(1-c),l&&(m=Math.round(m),o=Math.round(o));var g=Vqe(A).map(function(v){return m+s*v});return r(h?g.reverse():g)}return t.domain=function(A){return arguments.length?(e(A),f()):e()},t.range=function(A){return arguments.length?([n,a]=A,n=+n,a=+a,f()):[n,a]},t.rangeRound=function(A){return[n,a]=A,n=+n,a=+a,l=!0,f()},t.bandwidth=function(){return o},t.step=function(){return s},t.round=function(A){return arguments.length?(l=!!A,f()):l},t.padding=function(A){return arguments.length?(c=Math.min(1,u=+A),f()):c},t.paddingInner=function(A){return arguments.length?(c=Math.min(1,A),f()):c},t.paddingOuter=function(A){return arguments.length?(u=+A,f()):u},t.align=function(A){return arguments.length?(d=Math.max(0,Math.min(1,A)),f()):d},t.copy=function(){return a8(e(),[n,a]).round(l).paddingInner(c).paddingOuter(u).align(d)},wd.apply(f(),arguments)}function Roe(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return Roe(e())},t}function Hqe(){return Roe(a8.apply(null,arguments).paddingInner(1))}function s8(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function Moe(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function qw(){}var z2=.7,yI=1/z2,hv="\\s*([+-]?\\d+)\\s*",W2="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",$f="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",$qe=/^#([0-9a-f]{3,8})$/,Gqe=new RegExp(`^rgb\\(${hv},${hv},${hv}\\)$`),Kqe=new RegExp(`^rgb\\(${$f},${$f},${$f}\\)$`),qqe=new RegExp(`^rgba\\(${hv},${hv},${hv},${W2}\\)$`),zqe=new RegExp(`^rgba\\(${$f},${$f},${$f},${W2}\\)$`),Wqe=new RegExp(`^hsl\\(${W2},${$f},${$f}\\)$`),Xqe=new RegExp(`^hsla\\(${W2},${$f},${$f},${W2}\\)$`),LK={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};s8(qw,X2,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:UK,formatHex:UK,formatHex8:Yqe,formatHsl:Jqe,formatRgb:QK,toString:QK});function UK(){return this.rgb().formatHex()}function Yqe(){return this.rgb().formatHex8()}function Jqe(){return Loe(this).formatHsl()}function QK(){return this.rgb().formatRgb()}function X2(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=$qe.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?VK(e):r===3?new Fc(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?A_(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?A_(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Gqe.exec(t))?new Fc(e[1],e[2],e[3],1):(e=Kqe.exec(t))?new Fc(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=qqe.exec(t))?A_(e[1],e[2],e[3],e[4]):(e=zqe.exec(t))?A_(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Wqe.exec(t))?GK(e[1],e[2]/100,e[3]/100,1):(e=Xqe.exec(t))?GK(e[1],e[2]/100,e[3]/100,e[4]):LK.hasOwnProperty(t)?VK(LK[t]):t==="transparent"?new Fc(NaN,NaN,NaN,0):null}function VK(t){return new Fc(t>>16&255,t>>8&255,t&255,1)}function A_(t,e,r,n){return n<=0&&(t=e=r=NaN),new Fc(t,e,r,n)}function Zqe(t){return t instanceof qw||(t=X2(t)),t?(t=t.rgb(),new Fc(t.r,t.g,t.b,t.opacity)):new Fc}function QF(t,e,r,n){return arguments.length===1?Zqe(t):new Fc(t,e,r,n??1)}function Fc(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}s8(Fc,QF,Moe(qw,{brighter(t){return t=t==null?yI:Math.pow(yI,t),new Fc(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?z2:Math.pow(z2,t),new Fc(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Fc(Dp(this.r),Dp(this.g),Dp(this.b),bI(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:HK,formatHex:HK,formatHex8:eze,formatRgb:$K,toString:$K}));function HK(){return`#${vp(this.r)}${vp(this.g)}${vp(this.b)}`}function eze(){return`#${vp(this.r)}${vp(this.g)}${vp(this.b)}${vp((isNaN(this.opacity)?1:this.opacity)*255)}`}function $K(){const t=bI(this.opacity);return`${t===1?"rgb(":"rgba("}${Dp(this.r)}, ${Dp(this.g)}, ${Dp(this.b)}${t===1?")":`, ${t})`}`}function bI(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Dp(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function vp(t){return t=Dp(t),(t<16?"0":"")+t.toString(16)}function GK(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Kd(t,e,r,n)}function Loe(t){if(t instanceof Kd)return new Kd(t.h,t.s,t.l,t.opacity);if(t instanceof qw||(t=X2(t)),!t)return new Kd;if(t instanceof Kd)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,a=Math.min(e,r,n),s=Math.max(e,r,n),o=NaN,l=s-a,c=(s+a)/2;return l?(e===s?o=(r-n)/l+(r<n)*6:r===s?o=(n-e)/l+2:o=(e-r)/l+4,l/=c<.5?s+a:2-s-a,o*=60):l=c>0&&c<1?0:o,new Kd(o,l,c,t.opacity)}function tze(t,e,r,n){return arguments.length===1?Loe(t):new Kd(t,e,r,n??1)}function Kd(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}s8(Kd,tze,Moe(qw,{brighter(t){return t=t==null?yI:Math.pow(yI,t),new Kd(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?z2:Math.pow(z2,t),new Kd(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,a=2*r-n;return new Fc(sB(t>=240?t-240:t+120,a,n),sB(t,a,n),sB(t<120?t+240:t-120,a,n),this.opacity)},clamp(){return new Kd(KK(this.h),m_(this.s),m_(this.l),bI(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=bI(this.opacity);return`${t===1?"hsl(":"hsla("}${KK(this.h)}, ${m_(this.s)*100}%, ${m_(this.l)*100}%${t===1?")":`, ${t})`}`}}));function KK(t){return t=(t||0)%360,t<0?t+360:t}function m_(t){return Math.max(0,Math.min(1,t||0))}function sB(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const i8=t=>()=>t;function rze(t,e){return function(r){return t+r*e}}function nze(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function aze(t){return(t=+t)==1?Uoe:function(e,r){return r-e?nze(e,r,t):i8(isNaN(e)?r:e)}}function Uoe(t,e){var r=e-t;return r?rze(t,r):i8(isNaN(t)?e:t)}const qK=function t(e){var r=aze(e);function n(a,s){var o=r((a=QF(a)).r,(s=QF(s)).r),l=r(a.g,s.g),c=r(a.b,s.b),u=Uoe(a.opacity,s.opacity);return function(d){return a.r=o(d),a.g=l(d),a.b=c(d),a.opacity=u(d),a+""}}return n.gamma=t,n}(1);function sze(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),a;return function(s){for(a=0;a<r;++a)n[a]=t[a]*(1-s)+e[a]*s;return n}}function ize(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function oze(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,a=new Array(n),s=new Array(r),o;for(o=0;o<n;++o)a[o]=p1(t[o],e[o]);for(;o<r;++o)s[o]=e[o];return function(l){for(o=0;o<n;++o)s[o]=a[o](l);return s}}function lze(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function wI(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function cze(t,e){var r={},n={},a;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in t?r[a]=p1(t[a],e[a]):n[a]=e[a];return function(s){for(a in r)n[a]=r[a](s);return n}}var VF=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,iB=new RegExp(VF.source,"g");function uze(t){return function(){return t}}function dze(t){return function(e){return t(e)+""}}function fze(t,e){var r=VF.lastIndex=iB.lastIndex=0,n,a,s,o=-1,l=[],c=[];for(t=t+"",e=e+"";(n=VF.exec(t))&&(a=iB.exec(e));)(s=a.index)>r&&(s=e.slice(r,s),l[o]?l[o]+=s:l[++o]=s),(n=n[0])===(a=a[0])?l[o]?l[o]+=a:l[++o]=a:(l[++o]=null,c.push({i:o,x:wI(n,a)})),r=iB.lastIndex;return r<e.length&&(s=e.slice(r),l[o]?l[o]+=s:l[++o]=s),l.length<2?c[0]?dze(c[0].x):uze(e):(e=c.length,function(u){for(var d=0,f;d<e;++d)l[(f=c[d]).i]=f.x(u);return l.join("")})}function p1(t,e){var r=typeof e,n;return e==null||r==="boolean"?i8(e):(r==="number"?wI:r==="string"?(n=X2(e))?(e=n,qK):fze:e instanceof X2?qK:e instanceof Date?lze:ize(e)?sze:Array.isArray(e)?oze:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?cze:wI)(t,e)}function o8(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function hze(t,e){e===void 0&&(e=t,t=p1);for(var r=0,n=e.length-1,a=e[0],s=new Array(n<0?0:n);r<n;)s[r]=t(a,a=e[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return s[l](o-l)}}function Aze(t){return function(){return t}}function NI(t){return+t}var zK=[0,1];function lc(t){return t}function HF(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:Aze(isNaN(e)?NaN:.5)}function mze(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function pze(t,e,r){var n=t[0],a=t[1],s=e[0],o=e[1];return a<n?(n=HF(a,n),s=r(o,s)):(n=HF(n,a),s=r(s,o)),function(l){return s(n(l))}}function gze(t,e,r){var n=Math.min(t.length,e.length)-1,a=new Array(n),s=new Array(n),o=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<n;)a[o]=HF(t[o],t[o+1]),s[o]=r(e[o],e[o+1]);return function(l){var c=Kw(t,l,1,n)-1;return s[c](a[c](l))}}function zw(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function MP(){var t=zK,e=zK,r=p1,n,a,s,o=lc,l,c,u;function d(){var A=Math.min(t.length,e.length);return o!==lc&&(o=mze(t[0],t[A-1])),l=A>2?gze:pze,c=u=null,f}function f(A){return A==null||isNaN(A=+A)?s:(c||(c=l(t.map(n),e,r)))(n(o(A)))}return f.invert=function(A){return o(a((u||(u=l(e,t.map(n),wI)))(A)))},f.domain=function(A){return arguments.length?(t=Array.from(A,NI),d()):t.slice()},f.range=function(A){return arguments.length?(e=Array.from(A),d()):e.slice()},f.rangeRound=function(A){return e=Array.from(A),r=o8,d()},f.clamp=function(A){return arguments.length?(o=A?!0:lc,d()):o!==lc},f.interpolate=function(A){return arguments.length?(r=A,d()):r},f.unknown=function(A){return arguments.length?(s=A,f):s},function(A,h){return n=A,a=h,d()}}function l8(){return MP()(lc,lc)}function xze(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function CI(t,e){if(!isFinite(t)||t===0)return null;var r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"),n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function Uv(t){return t=CI(Math.abs(t)),t?t[1]:NaN}function vze(t,e){return function(r,n){for(var a=r.length,s=[],o=0,l=t[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),s.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=t[o=(o+1)%t.length];return s.reverse().join(e)}}function yze(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var bze=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Y2(t){if(!(e=bze.exec(t)))throw new Error("invalid format: "+t);var e;return new c8({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Y2.prototype=c8.prototype;function c8(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}c8.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function wze(t){e:for(var e=t.length,r=1,n=-1,a;r<e;++r)switch(t[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(a+1):t}var _I;function Nze(t,e){var r=CI(t,e);if(!r)return _I=void 0,t.toPrecision(e);var n=r[0],a=r[1],s=a-(_I=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return s===o?n:s>o?n+new Array(s-o+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+CI(t,Math.max(0,e+s-1))[0]}function WK(t,e){var r=CI(t,e);if(!r)return t+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const XK={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:xze,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>WK(t*100,e),r:WK,s:Nze,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function YK(t){return t}var JK=Array.prototype.map,ZK=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Cze(t){var e=t.grouping===void 0||t.thousands===void 0?YK:vze(JK.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",a=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?YK:yze(JK.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",l=t.minus===void 0?"":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function u(f,A){f=Y2(f);var h=f.fill,m=f.align,p=f.sign,g=f.symbol,v=f.zero,y=f.width,b=f.comma,w=f.precision,j=f.trim,I=f.type;I==="n"?(b=!0,I="g"):XK[I]||(w===void 0&&(w=12),j=!0,I="g"),(v||h==="0"&&m==="=")&&(v=!0,h="0",m="=");var _=(A&&A.prefix!==void 0?A.prefix:"")+(g==="$"?r:g==="#"&&/[boxX]/.test(I)?"0"+I.toLowerCase():""),S=(g==="$"?n:/[%p]/.test(I)?o:"")+(A&&A.suffix!==void 0?A.suffix:""),E=XK[I],F=/[defgprs%]/.test(I);w=w===void 0?6:/[gprs]/.test(I)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function k(P){var D=_,X=S,pe,ge,fe;if(I==="c")X=E(P)+X,P="";else{P=+P;var xe=P<0||1/P<0;if(P=isNaN(P)?c:E(Math.abs(P),w),j&&(P=wze(P)),xe&&+P==0&&p!=="+"&&(xe=!1),D=(xe?p==="("?p:l:p==="-"||p==="("?"":p)+D,X=(I==="s"&&!isNaN(P)&&_I!==void 0?ZK[8+_I/3]:"")+X+(xe&&p==="("?")":""),F){for(pe=-1,ge=P.length;++pe<ge;)if(fe=P.charCodeAt(pe),48>fe||fe>57){X=(fe===46?a+P.slice(pe+1):P.slice(pe))+X,P=P.slice(0,pe);break}}}b&&!v&&(P=e(P,1/0));var ae=D.length+P.length+X.length,Se=ae<y?new Array(y-ae+1).join(h):"";switch(b&&v&&(P=e(Se+P,Se.length?y-X.length:1/0),Se=""),m){case"<":P=D+P+X+Se;break;case"=":P=D+Se+P+X;break;case"^":P=Se.slice(0,ae=Se.length>>1)+D+P+X+Se.slice(ae);break;default:P=Se+D+P+X;break}return s(P)}return k.toString=function(){return f+""},k}function d(f,A){var h=Math.max(-8,Math.min(8,Math.floor(Uv(A)/3)))*3,m=Math.pow(10,-h),p=u((f=Y2(f),f.type="f",f),{suffix:ZK[8+h/3]});return function(g){return p(m*g)}}return{format:u,formatPrefix:d}}var p_,u8,Qoe;_ze({thousands:",",grouping:[3],currency:["$",""]});function _ze(t){return p_=Cze(t),u8=p_.format,Qoe=p_.formatPrefix,p_}function Eze(t){return Math.max(0,-Uv(Math.abs(t)))}function Sze(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Uv(e)/3)))*3-Uv(Math.abs(t)))}function Ize(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Uv(e)-Uv(t))+1}function Voe(t,e,r,n){var a=LF(t,e,r),s;switch(n=Y2(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(s=Sze(a,o))&&(n.precision=s),Qoe(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=Ize(a,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=Eze(a))&&(n.precision=s-(n.type==="%")*2);break}}return u8(n)}function jm(t){var e=t.domain;return t.ticks=function(r){var n=e();return RF(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var a=e();return Voe(a[0],a[a.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),a=0,s=n.length-1,o=n[a],l=n[s],c,u,d=10;for(l<o&&(u=o,o=l,l=u,u=a,a=s,s=u);d-- >0;){if(u=MF(o,l,r),u===c)return n[a]=o,n[s]=l,e(n);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return t},t}function Hoe(){var t=l8();return t.copy=function(){return zw(t,Hoe())},wd.apply(t,arguments),jm(t)}function $oe(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,NI),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return $oe(t).unknown(e)},t=arguments.length?Array.from(t,NI):[0,1],jm(r)}function Goe(t,e){t=t.slice();var r=0,n=t.length-1,a=t[r],s=t[n],o;return s<a&&(o=r,r=n,n=o,o=a,a=s,s=o),t[r]=e.floor(a),t[n]=e.ceil(s),t}function eq(t){return Math.log(t)}function tq(t){return Math.exp(t)}function jze(t){return-Math.log(-t)}function Pze(t){return-Math.exp(-t)}function Bze(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Tze(t){return t===10?Bze:t===Math.E?Math.exp:e=>Math.pow(t,e)}function kze(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function rq(t){return(e,r)=>-t(-e,r)}function d8(t){const e=t(eq,tq),r=e.domain;let n=10,a,s;function o(){return a=kze(n),s=Tze(n),r()[0]<0?(a=rq(a),s=rq(s),t(jze,Pze)):t(eq,tq),e}return e.base=function(l){return arguments.length?(n=+l,o()):n},e.domain=function(l){return arguments.length?(r(l),o()):r()},e.ticks=l=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let A=a(u),h=a(d),m,p;const g=l==null?10:+l;let v=[];if(!(n%1)&&h-A<g){if(A=Math.floor(A),h=Math.ceil(h),u>0){for(;A<=h;++A)for(m=1;m<n;++m)if(p=A<0?m/s(-A):m*s(A),!(p<u)){if(p>d)break;v.push(p)}}else for(;A<=h;++A)for(m=n-1;m>=1;--m)if(p=A>0?m/s(-A):m*s(A),!(p<u)){if(p>d)break;v.push(p)}v.length*2<g&&(v=RF(u,d,g))}else v=RF(A,h,Math.min(h-A,g)).map(s);return f?v.reverse():v},e.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=Y2(c)).precision==null&&(c.trim=!0),c=u8(c)),l===1/0)return c;const u=Math.max(1,n*l/e.ticks().length);return d=>{let f=d/s(Math.round(a(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},e.nice=()=>r(Goe(r(),{floor:l=>s(Math.floor(a(l))),ceil:l=>s(Math.ceil(a(l)))})),e}function Koe(){const t=d8(MP()).domain([1,10]);return t.copy=()=>zw(t,Koe()).base(t.base()),wd.apply(t,arguments),t}function nq(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function aq(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function f8(t){var e=1,r=t(nq(e),aq(e));return r.constant=function(n){return arguments.length?t(nq(e=+n),aq(e)):e},jm(r)}function qoe(){var t=f8(MP());return t.copy=function(){return zw(t,qoe()).constant(t.constant())},wd.apply(t,arguments)}function sq(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Fze(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Oze(t){return t<0?-t*t:t*t}function h8(t){var e=t(lc,lc),r=1;function n(){return r===1?t(lc,lc):r===.5?t(Fze,Oze):t(sq(r),sq(1/r))}return e.exponent=function(a){return arguments.length?(r=+a,n()):r},jm(e)}function A8(){var t=h8(MP());return t.copy=function(){return zw(t,A8()).exponent(t.exponent())},wd.apply(t,arguments),t}function Dze(){return A8.apply(null,arguments).exponent(.5)}function iq(t){return Math.sign(t)*t*t}function Rze(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function zoe(){var t=l8(),e=[0,1],r=!1,n;function a(s){var o=Rze(t(s));return isNaN(o)?n:r?Math.round(o):o}return a.invert=function(s){return t.invert(iq(s))},a.domain=function(s){return arguments.length?(t.domain(s),a):t.domain()},a.range=function(s){return arguments.length?(t.range((e=Array.from(s,NI)).map(iq)),a):e.slice()},a.rangeRound=function(s){return a.range(s).round(!0)},a.round=function(s){return arguments.length?(r=!!s,a):r},a.clamp=function(s){return arguments.length?(t.clamp(s),a):t.clamp()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return zoe(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},wd.apply(a,arguments),jm(a)}function Woe(){var t=[],e=[],r=[],n;function a(){var o=0,l=Math.max(1,e.length);for(r=new Array(l-1);++o<l;)r[o-1]=Qqe(t,o/l);return s}function s(o){return o==null||isNaN(o=+o)?n:e[Kw(r,o)]}return s.invertExtent=function(o){var l=e.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:t[0],l<r.length?r[l]:t[t.length-1]]},s.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let l of o)l!=null&&!isNaN(l=+l)&&t.push(l);return t.sort(tm),a()},s.range=function(o){return arguments.length?(e=Array.from(o),a()):e.slice()},s.unknown=function(o){return arguments.length?(n=o,s):n},s.quantiles=function(){return r.slice()},s.copy=function(){return Woe().domain(t).range(e).unknown(n)},wd.apply(s,arguments)}function Xoe(){var t=0,e=1,r=1,n=[.5],a=[0,1],s;function o(c){return c!=null&&c<=c?a[Kw(n,c,0,r)]:s}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*e-(c-r)*t)/(r+1);return o}return o.domain=function(c){return arguments.length?([t,e]=c,t=+t,e=+e,l()):[t,e]},o.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},o.invertExtent=function(c){var u=a.indexOf(c);return u<0?[NaN,NaN]:u<1?[t,n[0]]:u>=r?[n[r-1],e]:[n[u-1],n[u]]},o.unknown=function(c){return arguments.length&&(s=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return Xoe().domain([t,e]).range(a).unknown(s)},wd.apply(jm(o),arguments)}function Yoe(){var t=[.5],e=[0,1],r,n=1;function a(s){return s!=null&&s<=s?e[Kw(t,s,0,n)]:r}return a.domain=function(s){return arguments.length?(t=Array.from(s),n=Math.min(t.length,e.length-1),a):t.slice()},a.range=function(s){return arguments.length?(e=Array.from(s),n=Math.min(t.length,e.length-1),a):e.slice()},a.invertExtent=function(s){var o=e.indexOf(s);return[t[o-1],t[o]]},a.unknown=function(s){return arguments.length?(r=s,a):r},a.copy=function(){return Yoe().domain(t).range(e).unknown(r)},wd.apply(a,arguments)}const oB=new Date,lB=new Date;function xo(t,e,r,n){function a(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return a.floor=s=>(t(s=new Date(+s)),s),a.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),a.round=s=>{const o=a(s),l=a.ceil(s);return s-o<l-s?o:l},a.offset=(s,o)=>(e(s=new Date(+s),o==null?1:Math.floor(o)),s),a.range=(s,o,l)=>{const c=[];if(s=a.ceil(s),l=l==null?1:Math.floor(l),!(s<o)||!(l>0))return c;let u;do c.push(u=new Date(+s)),e(s,l),t(s);while(u<s&&s<o);return c},a.filter=s=>xo(o=>{if(o>=o)for(;t(o),!s(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;e(o,-1),!s(o););else for(;--l>=0;)for(;e(o,1),!s(o););}),r&&(a.count=(s,o)=>(oB.setTime(+s),lB.setTime(+o),t(oB),t(lB),Math.floor(r(oB,lB))),a.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?a.filter(n?o=>n(o)%s===0:o=>a.count(0,o)%s===0):a)),a}const EI=xo(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);EI.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?xo(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):EI);EI.range;const Mh=1e3,id=Mh*60,Lh=id*60,uA=Lh*24,m8=uA*7,oq=uA*30,cB=uA*365,yp=xo(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Mh)},(t,e)=>(e-t)/Mh,t=>t.getUTCSeconds());yp.range;const p8=xo(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Mh)},(t,e)=>{t.setTime(+t+e*id)},(t,e)=>(e-t)/id,t=>t.getMinutes());p8.range;const g8=xo(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*id)},(t,e)=>(e-t)/id,t=>t.getUTCMinutes());g8.range;const x8=xo(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Mh-t.getMinutes()*id)},(t,e)=>{t.setTime(+t+e*Lh)},(t,e)=>(e-t)/Lh,t=>t.getHours());x8.range;const v8=xo(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Lh)},(t,e)=>(e-t)/Lh,t=>t.getUTCHours());v8.range;const Ww=xo(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*id)/uA,t=>t.getDate()-1);Ww.range;const LP=xo(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/uA,t=>t.getUTCDate()-1);LP.range;const Joe=xo(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/uA,t=>Math.floor(t/uA));Joe.range;function Fg(t){return xo(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*id)/m8)}const UP=Fg(0),SI=Fg(1),Mze=Fg(2),Lze=Fg(3),Qv=Fg(4),Uze=Fg(5),Qze=Fg(6);UP.range;SI.range;Mze.range;Lze.range;Qv.range;Uze.range;Qze.range;function Og(t){return xo(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/m8)}const QP=Og(0),II=Og(1),Vze=Og(2),Hze=Og(3),Vv=Og(4),$ze=Og(5),Gze=Og(6);QP.range;II.range;Vze.range;Hze.range;Vv.range;$ze.range;Gze.range;const y8=xo(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());y8.range;const b8=xo(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());b8.range;const dA=xo(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());dA.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:xo(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});dA.range;const fA=xo(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());fA.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:xo(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});fA.range;function Zoe(t,e,r,n,a,s){const o=[[yp,1,Mh],[yp,5,5*Mh],[yp,15,15*Mh],[yp,30,30*Mh],[s,1,id],[s,5,5*id],[s,15,15*id],[s,30,30*id],[a,1,Lh],[a,3,3*Lh],[a,6,6*Lh],[a,12,12*Lh],[n,1,uA],[n,2,2*uA],[r,1,m8],[e,1,oq],[e,3,3*oq],[t,1,cB]];function l(u,d,f){const A=d<u;A&&([u,d]=[d,u]);const h=f&&typeof f.range=="function"?f:c(u,d,f),m=h?h.range(u,+d+1):[];return A?m.reverse():m}function c(u,d,f){const A=Math.abs(d-u)/f,h=r8(([,,g])=>g).right(o,A);if(h===o.length)return t.every(LF(u/cB,d/cB,f));if(h===0)return EI.every(Math.max(LF(u,d,f),1));const[m,p]=o[A/o[h-1][2]<o[h][2]/A?h-1:h];return m.every(p)}return[l,c]}const[Kze,qze]=Zoe(fA,b8,QP,Joe,v8,g8),[zze,Wze]=Zoe(dA,y8,UP,Ww,x8,p8);function uB(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function dB(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function vy(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function Xze(t){var e=t.dateTime,r=t.date,n=t.time,a=t.periods,s=t.days,o=t.shortDays,l=t.months,c=t.shortMonths,u=yy(a),d=by(a),f=yy(s),A=by(s),h=yy(o),m=by(o),p=yy(l),g=by(l),v=yy(c),y=by(c),b={a:fe,A:xe,b:ae,B:Se,c:null,d:hq,e:hq,f:vWe,g:jWe,G:BWe,H:pWe,I:gWe,j:xWe,L:ele,m:yWe,M:bWe,p:Te,q:O,Q:pq,s:gq,S:wWe,u:NWe,U:CWe,V:_We,w:EWe,W:SWe,x:null,X:null,y:IWe,Y:PWe,Z:TWe,"%":mq},w={a:G,A:z,b:L,B:Z,c:null,d:Aq,e:Aq,f:DWe,g:KWe,G:zWe,H:kWe,I:FWe,j:OWe,L:rle,m:RWe,M:MWe,p:ee,q:R,Q:pq,s:gq,S:LWe,u:UWe,U:QWe,V:VWe,w:HWe,W:$We,x:null,X:null,y:GWe,Y:qWe,Z:WWe,"%":mq},j={a:F,A:k,b:P,B:D,c:X,d:dq,e:dq,f:fWe,g:uq,G:cq,H:fq,I:fq,j:lWe,L:dWe,m:oWe,M:cWe,p:E,q:iWe,Q:AWe,s:mWe,S:uWe,u:tWe,U:rWe,V:nWe,w:eWe,W:aWe,x:pe,X:ge,y:uq,Y:cq,Z:sWe,"%":hWe};b.x=I(r,b),b.X=I(n,b),b.c=I(e,b),w.x=I(r,w),w.X=I(n,w),w.c=I(e,w);function I(H,ne){return function(ve){var U=[],He=-1,se=0,re=H.length,Pe,ue,we;for(ve instanceof Date||(ve=new Date(+ve));++He<re;)H.charCodeAt(He)===37&&(U.push(H.slice(se,He)),(ue=lq[Pe=H.charAt(++He)])!=null?Pe=H.charAt(++He):ue=Pe==="e"?" ":"0",(we=ne[Pe])&&(Pe=we(ve,ue)),U.push(Pe),se=He+1);return U.push(H.slice(se,He)),U.join("")}}function _(H,ne){return function(ve){var U=vy(1900,void 0,1),He=S(U,H,ve+="",0),se,re;if(He!=ve.length)return null;if("Q"in U)return new Date(U.Q);if("s"in U)return new Date(U.s*1e3+("L"in U?U.L:0));if(ne&&!("Z"in U)&&(U.Z=0),"p"in U&&(U.H=U.H%12+U.p*12),U.m===void 0&&(U.m="q"in U?U.q:0),"V"in U){if(U.V<1||U.V>53)return null;"w"in U||(U.w=1),"Z"in U?(se=dB(vy(U.y,0,1)),re=se.getUTCDay(),se=re>4||re===0?II.ceil(se):II(se),se=LP.offset(se,(U.V-1)*7),U.y=se.getUTCFullYear(),U.m=se.getUTCMonth(),U.d=se.getUTCDate()+(U.w+6)%7):(se=uB(vy(U.y,0,1)),re=se.getDay(),se=re>4||re===0?SI.ceil(se):SI(se),se=Ww.offset(se,(U.V-1)*7),U.y=se.getFullYear(),U.m=se.getMonth(),U.d=se.getDate()+(U.w+6)%7)}else("W"in U||"U"in U)&&("w"in U||(U.w="u"in U?U.u%7:"W"in U?1:0),re="Z"in U?dB(vy(U.y,0,1)).getUTCDay():uB(vy(U.y,0,1)).getDay(),U.m=0,U.d="W"in U?(U.w+6)%7+U.W*7-(re+5)%7:U.w+U.U*7-(re+6)%7);return"Z"in U?(U.H+=U.Z/100|0,U.M+=U.Z%100,dB(U)):uB(U)}}function S(H,ne,ve,U){for(var He=0,se=ne.length,re=ve.length,Pe,ue;He<se;){if(U>=re)return-1;if(Pe=ne.charCodeAt(He++),Pe===37){if(Pe=ne.charAt(He++),ue=j[Pe in lq?ne.charAt(He++):Pe],!ue||(U=ue(H,ve,U))<0)return-1}else if(Pe!=ve.charCodeAt(U++))return-1}return U}function E(H,ne,ve){var U=u.exec(ne.slice(ve));return U?(H.p=d.get(U[0].toLowerCase()),ve+U[0].length):-1}function F(H,ne,ve){var U=h.exec(ne.slice(ve));return U?(H.w=m.get(U[0].toLowerCase()),ve+U[0].length):-1}function k(H,ne,ve){var U=f.exec(ne.slice(ve));return U?(H.w=A.get(U[0].toLowerCase()),ve+U[0].length):-1}function P(H,ne,ve){var U=v.exec(ne.slice(ve));return U?(H.m=y.get(U[0].toLowerCase()),ve+U[0].length):-1}function D(H,ne,ve){var U=p.exec(ne.slice(ve));return U?(H.m=g.get(U[0].toLowerCase()),ve+U[0].length):-1}function X(H,ne,ve){return S(H,e,ne,ve)}function pe(H,ne,ve){return S(H,r,ne,ve)}function ge(H,ne,ve){return S(H,n,ne,ve)}function fe(H){return o[H.getDay()]}function xe(H){return s[H.getDay()]}function ae(H){return c[H.getMonth()]}function Se(H){return l[H.getMonth()]}function Te(H){return a[+(H.getHours()>=12)]}function O(H){return 1+~~(H.getMonth()/3)}function G(H){return o[H.getUTCDay()]}function z(H){return s[H.getUTCDay()]}function L(H){return c[H.getUTCMonth()]}function Z(H){return l[H.getUTCMonth()]}function ee(H){return a[+(H.getUTCHours()>=12)]}function R(H){return 1+~~(H.getUTCMonth()/3)}return{format:function(H){var ne=I(H+="",b);return ne.toString=function(){return H},ne},parse:function(H){var ne=_(H+="",!1);return ne.toString=function(){return H},ne},utcFormat:function(H){var ne=I(H+="",w);return ne.toString=function(){return H},ne},utcParse:function(H){var ne=_(H+="",!0);return ne.toString=function(){return H},ne}}}var lq={"-":"",_:" ",0:"0"},Vo=/^\s*\d+/,Yze=/^%/,Jze=/[\\^$*+?|[\]().{}]/g;function ha(t,e,r){var n=t<0?"-":"",a=(n?-t:t)+"",s=a.length;return n+(s<r?new Array(r-s+1).join(e)+a:a)}function Zze(t){return t.replace(Jze,"\\$&")}function yy(t){return new RegExp("^(?:"+t.map(Zze).join("|")+")","i")}function by(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function eWe(t,e,r){var n=Vo.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function tWe(t,e,r){var n=Vo.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function rWe(t,e,r){var n=Vo.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function nWe(t,e,r){var n=Vo.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function aWe(t,e,r){var n=Vo.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function cq(t,e,r){var n=Vo.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function uq(t,e,r){var n=Vo.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function sWe(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function iWe(t,e,r){var n=Vo.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function oWe(t,e,r){var n=Vo.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function dq(t,e,r){var n=Vo.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function lWe(t,e,r){var n=Vo.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function fq(t,e,r){var n=Vo.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function cWe(t,e,r){var n=Vo.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function uWe(t,e,r){var n=Vo.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function dWe(t,e,r){var n=Vo.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function fWe(t,e,r){var n=Vo.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function hWe(t,e,r){var n=Yze.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function AWe(t,e,r){var n=Vo.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function mWe(t,e,r){var n=Vo.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function hq(t,e){return ha(t.getDate(),e,2)}function pWe(t,e){return ha(t.getHours(),e,2)}function gWe(t,e){return ha(t.getHours()%12||12,e,2)}function xWe(t,e){return ha(1+Ww.count(dA(t),t),e,3)}function ele(t,e){return ha(t.getMilliseconds(),e,3)}function vWe(t,e){return ele(t,e)+"000"}function yWe(t,e){return ha(t.getMonth()+1,e,2)}function bWe(t,e){return ha(t.getMinutes(),e,2)}function wWe(t,e){return ha(t.getSeconds(),e,2)}function NWe(t){var e=t.getDay();return e===0?7:e}function CWe(t,e){return ha(UP.count(dA(t)-1,t),e,2)}function tle(t){var e=t.getDay();return e>=4||e===0?Qv(t):Qv.ceil(t)}function _We(t,e){return t=tle(t),ha(Qv.count(dA(t),t)+(dA(t).getDay()===4),e,2)}function EWe(t){return t.getDay()}function SWe(t,e){return ha(SI.count(dA(t)-1,t),e,2)}function IWe(t,e){return ha(t.getFullYear()%100,e,2)}function jWe(t,e){return t=tle(t),ha(t.getFullYear()%100,e,2)}function PWe(t,e){return ha(t.getFullYear()%1e4,e,4)}function BWe(t,e){var r=t.getDay();return t=r>=4||r===0?Qv(t):Qv.ceil(t),ha(t.getFullYear()%1e4,e,4)}function TWe(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+ha(e/60|0,"0",2)+ha(e%60,"0",2)}function Aq(t,e){return ha(t.getUTCDate(),e,2)}function kWe(t,e){return ha(t.getUTCHours(),e,2)}function FWe(t,e){return ha(t.getUTCHours()%12||12,e,2)}function OWe(t,e){return ha(1+LP.count(fA(t),t),e,3)}function rle(t,e){return ha(t.getUTCMilliseconds(),e,3)}function DWe(t,e){return rle(t,e)+"000"}function RWe(t,e){return ha(t.getUTCMonth()+1,e,2)}function MWe(t,e){return ha(t.getUTCMinutes(),e,2)}function LWe(t,e){return ha(t.getUTCSeconds(),e,2)}function UWe(t){var e=t.getUTCDay();return e===0?7:e}function QWe(t,e){return ha(QP.count(fA(t)-1,t),e,2)}function nle(t){var e=t.getUTCDay();return e>=4||e===0?Vv(t):Vv.ceil(t)}function VWe(t,e){return t=nle(t),ha(Vv.count(fA(t),t)+(fA(t).getUTCDay()===4),e,2)}function HWe(t){return t.getUTCDay()}function $We(t,e){return ha(II.count(fA(t)-1,t),e,2)}function GWe(t,e){return ha(t.getUTCFullYear()%100,e,2)}function KWe(t,e){return t=nle(t),ha(t.getUTCFullYear()%100,e,2)}function qWe(t,e){return ha(t.getUTCFullYear()%1e4,e,4)}function zWe(t,e){var r=t.getUTCDay();return t=r>=4||r===0?Vv(t):Vv.ceil(t),ha(t.getUTCFullYear()%1e4,e,4)}function WWe(){return"+0000"}function mq(){return"%"}function pq(t){return+t}function gq(t){return Math.floor(+t/1e3)}var hx,ale,sle;XWe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function XWe(t){return hx=Xze(t),ale=hx.format,hx.parse,sle=hx.utcFormat,hx.utcParse,hx}function YWe(t){return new Date(t)}function JWe(t){return t instanceof Date?+t:+new Date(+t)}function w8(t,e,r,n,a,s,o,l,c,u){var d=l8(),f=d.invert,A=d.domain,h=u(".%L"),m=u(":%S"),p=u("%I:%M"),g=u("%I %p"),v=u("%a %d"),y=u("%b %d"),b=u("%B"),w=u("%Y");function j(I){return(c(I)<I?h:l(I)<I?m:o(I)<I?p:s(I)<I?g:n(I)<I?a(I)<I?v:y:r(I)<I?b:w)(I)}return d.invert=function(I){return new Date(f(I))},d.domain=function(I){return arguments.length?A(Array.from(I,JWe)):A().map(YWe)},d.ticks=function(I){var _=A();return t(_[0],_[_.length-1],I??10)},d.tickFormat=function(I,_){return _==null?j:u(_)},d.nice=function(I){var _=A();return(!I||typeof I.range!="function")&&(I=e(_[0],_[_.length-1],I??10)),I?A(Goe(_,I)):d},d.copy=function(){return zw(d,w8(t,e,r,n,a,s,o,l,c,u))},d}function ZWe(){return wd.apply(w8(zze,Wze,dA,y8,UP,Ww,x8,p8,yp,ale).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function eXe(){return wd.apply(w8(Kze,qze,fA,b8,QP,LP,v8,g8,yp,sle).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function VP(){var t=0,e=1,r,n,a,s,o=lc,l=!1,c;function u(f){return f==null||isNaN(f=+f)?c:o(a===0?.5:(f=(s(f)-r)*a,l?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([t,e]=f,r=s(t=+t),n=s(e=+e),a=r===n?0:1/(n-r),u):[t,e]},u.clamp=function(f){return arguments.length?(l=!!f,u):l},u.interpolator=function(f){return arguments.length?(o=f,u):o};function d(f){return function(A){var h,m;return arguments.length?([h,m]=A,o=f(h,m),u):[o(0),o(1)]}}return u.range=d(p1),u.rangeRound=d(o8),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return s=f,r=f(t),n=f(e),a=r===n?0:1/(n-r),u}}function Pm(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function ile(){var t=jm(VP()(lc));return t.copy=function(){return Pm(t,ile())},SA.apply(t,arguments)}function ole(){var t=d8(VP()).domain([1,10]);return t.copy=function(){return Pm(t,ole()).base(t.base())},SA.apply(t,arguments)}function lle(){var t=f8(VP());return t.copy=function(){return Pm(t,lle()).constant(t.constant())},SA.apply(t,arguments)}function N8(){var t=h8(VP());return t.copy=function(){return Pm(t,N8()).exponent(t.exponent())},SA.apply(t,arguments)}function tXe(){return N8.apply(null,arguments).exponent(.5)}function cle(){var t=[],e=lc;function r(n){if(n!=null&&!isNaN(n=+n))return e((Kw(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let a of n)a!=null&&!isNaN(a=+a)&&t.push(a);return t.sort(tm),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,a)=>e(a/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,s)=>Uqe(t,s/n))},r.copy=function(){return cle(e).domain(t)},SA.apply(r,arguments)}function HP(){var t=0,e=.5,r=1,n=1,a,s,o,l,c,u=lc,d,f=!1,A;function h(p){return isNaN(p=+p)?A:(p=.5+((p=+d(p))-s)*(n*p<n*s?l:c),u(f?Math.max(0,Math.min(1,p)):p))}h.domain=function(p){return arguments.length?([t,e,r]=p,a=d(t=+t),s=d(e=+e),o=d(r=+r),l=a===s?0:.5/(s-a),c=s===o?0:.5/(o-s),n=s<a?-1:1,h):[t,e,r]},h.clamp=function(p){return arguments.length?(f=!!p,h):f},h.interpolator=function(p){return arguments.length?(u=p,h):u};function m(p){return function(g){var v,y,b;return arguments.length?([v,y,b]=g,u=hze(p,[v,y,b]),h):[u(0),u(.5),u(1)]}}return h.range=m(p1),h.rangeRound=m(o8),h.unknown=function(p){return arguments.length?(A=p,h):A},function(p){return d=p,a=p(t),s=p(e),o=p(r),l=a===s?0:.5/(s-a),c=s===o?0:.5/(o-s),n=s<a?-1:1,h}}function ule(){var t=jm(HP()(lc));return t.copy=function(){return Pm(t,ule())},SA.apply(t,arguments)}function dle(){var t=d8(HP()).domain([.1,1,10]);return t.copy=function(){return Pm(t,dle()).base(t.base())},SA.apply(t,arguments)}function fle(){var t=f8(HP());return t.copy=function(){return Pm(t,fle()).constant(t.constant())},SA.apply(t,arguments)}function C8(){var t=h8(HP());return t.copy=function(){return Pm(t,C8()).exponent(t.exponent())},SA.apply(t,arguments)}function rXe(){return C8.apply(null,arguments).exponent(.5)}const zy=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:a8,scaleDiverging:ule,scaleDivergingLog:dle,scaleDivergingPow:C8,scaleDivergingSqrt:rXe,scaleDivergingSymlog:fle,scaleIdentity:$oe,scaleImplicit:UF,scaleLinear:Hoe,scaleLog:Koe,scaleOrdinal:n8,scalePoint:Hqe,scalePow:A8,scaleQuantile:Woe,scaleQuantize:Xoe,scaleRadial:zoe,scaleSequential:ile,scaleSequentialLog:ole,scaleSequentialPow:N8,scaleSequentialQuantile:cle,scaleSequentialSqrt:tXe,scaleSequentialSymlog:lle,scaleSqrt:Dze,scaleSymlog:qoe,scaleThreshold:Yoe,scaleTime:ZWe,scaleUtc:eXe,tickFormat:Voe},Symbol.toStringTag,{value:"Module"}));var IA=t=>t.chartData,$P=qt([IA],t=>{var e=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:e,dataStartIndex:0}}),hle=(t,e,r,n)=>n?$P(t):IA(t),nXe=(t,e,r)=>r?$P(t):IA(t);function xm(t){if(Array.isArray(t)&&t.length===2){var[e,r]=t;if(Zs(e)&&Zs(r))return!0}return!1}function xq(t,e,r){return r?t:[Math.min(t[0],e[0]),Math.max(t[1],e[1])]}function Ale(t,e){if(e&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[r,n]=t,a,s;if(Zs(r))a=r;else if(typeof r=="function")return;if(Zs(n))s=n;else if(typeof n=="function")return;var o=[a,s];if(xm(o))return o}}function aXe(t,e,r){if(!(!r&&e==null)){if(typeof t=="function"&&e!=null)try{var n=t(e,r);if(xm(n))return xq(n,e,r)}catch{}if(Array.isArray(t)&&t.length===2){var[a,s]=t,o,l;if(a==="auto")e!=null&&(o=Math.min(...e));else if(rn(a))o=a;else if(typeof a=="function")try{e!=null&&(o=a(e==null?void 0:e[0]))}catch{}else if(typeof a=="string"&&OG.test(a)){var c=OG.exec(a);if(c==null||c[1]==null||e==null)o=void 0;else{var u=+c[1];o=e[0]-u}}else o=e==null?void 0:e[0];if(s==="auto")e!=null&&(l=Math.max(...e));else if(rn(s))l=s;else if(typeof s=="function")try{e!=null&&(l=s(e==null?void 0:e[1]))}catch{}else if(typeof s=="string"&&DG.test(s)){var d=DG.exec(s);if(d==null||d[1]==null||e==null)l=void 0;else{var f=+d[1];l=e[1]+f}}else l=e==null?void 0:e[1];var A=[o,l];if(xm(A))return e==null?A:xq(A,e,r)}}}var g1=1e9,sXe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},E8,js=!0,xd="[DecimalError] ",Rp=xd+"Invalid argument: ",_8=xd+"Exponent out of range: ",x1=Math.floor,np=Math.pow,iXe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,uu,Bo=1e7,fs=7,mle=9007199254740991,jI=x1(mle/fs),Lr={};Lr.absoluteValue=Lr.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};Lr.comparedTo=Lr.cmp=function(t){var e,r,n,a,s=this;if(t=new s.constructor(t),s.s!==t.s)return s.s||-t.s;if(s.e!==t.e)return s.e>t.e^s.s<0?1:-1;for(n=s.d.length,a=t.d.length,e=0,r=n<a?n:a;e<r;++e)if(s.d[e]!==t.d[e])return s.d[e]>t.d[e]^s.s<0?1:-1;return n===a?0:n>a^s.s<0?1:-1};Lr.decimalPlaces=Lr.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*fs;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};Lr.dividedBy=Lr.div=function(t){return Xh(this,new this.constructor(t))};Lr.dividedToIntegerBy=Lr.idiv=function(t){var e=this,r=e.constructor;return Ja(Xh(e,new r(t),0,1),r.precision)};Lr.equals=Lr.eq=function(t){return!this.cmp(t)};Lr.exponent=function(){return $i(this)};Lr.greaterThan=Lr.gt=function(t){return this.cmp(t)>0};Lr.greaterThanOrEqualTo=Lr.gte=function(t){return this.cmp(t)>=0};Lr.isInteger=Lr.isint=function(){return this.e>this.d.length-2};Lr.isNegative=Lr.isneg=function(){return this.s<0};Lr.isPositive=Lr.ispos=function(){return this.s>0};Lr.isZero=function(){return this.s===0};Lr.lessThan=Lr.lt=function(t){return this.cmp(t)<0};Lr.lessThanOrEqualTo=Lr.lte=function(t){return this.cmp(t)<1};Lr.logarithm=Lr.log=function(t){var e,r=this,n=r.constructor,a=n.precision,s=a+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(uu))throw Error(xd+"NaN");if(r.s<1)throw Error(xd+(r.s?"NaN":"-Infinity"));return r.eq(uu)?new n(0):(js=!1,e=Xh(J2(r,s),J2(t,s),s),js=!0,Ja(e,a))};Lr.minus=Lr.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?xle(e,t):ple(e,(t.s=-t.s,t))};Lr.modulo=Lr.mod=function(t){var e,r=this,n=r.constructor,a=n.precision;if(t=new n(t),!t.s)throw Error(xd+"NaN");return r.s?(js=!1,e=Xh(r,t,0,1).times(t),js=!0,r.minus(e)):Ja(new n(r),a)};Lr.naturalExponential=Lr.exp=function(){return gle(this)};Lr.naturalLogarithm=Lr.ln=function(){return J2(this)};Lr.negated=Lr.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};Lr.plus=Lr.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?ple(e,t):xle(e,(t.s=-t.s,t))};Lr.precision=Lr.sd=function(t){var e,r,n,a=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Rp+t);if(e=$i(a)+1,n=a.d.length-1,r=n*fs+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};Lr.squareRoot=Lr.sqrt=function(){var t,e,r,n,a,s,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(xd+"NaN")}for(t=$i(l),js=!1,a=Math.sqrt(+l),a==0||a==1/0?(e=Lf(l.d),(e.length+t)%2==0&&(e+="0"),a=Math.sqrt(e),t=x1((t+1)/2)-(t<0||t%2),a==1/0?e="5e"+t:(e=a.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new c(e)):n=new c(a.toString()),r=c.precision,a=o=r+3;;)if(s=n,n=s.plus(Xh(l,s,o+2)).times(.5),Lf(s.d).slice(0,o)===(e=Lf(n.d)).slice(0,o)){if(e=e.slice(o-3,o+1),a==o&&e=="4999"){if(Ja(s,r+1,0),s.times(s).eq(l)){n=s;break}}else if(e!="9999")break;o+=4}return js=!0,Ja(n,r)};Lr.times=Lr.mul=function(t){var e,r,n,a,s,o,l,c,u,d=this,f=d.constructor,A=d.d,h=(t=new f(t)).d;if(!d.s||!t.s)return new f(0);for(t.s*=d.s,r=d.e+t.e,c=A.length,u=h.length,c<u&&(s=A,A=h,h=s,o=c,c=u,u=o),s=[],o=c+u,n=o;n--;)s.push(0);for(n=u;--n>=0;){for(e=0,a=c+n;a>n;)l=s[a]+h[n]*A[a-n-1]+e,s[a--]=l%Bo|0,e=l/Bo|0;s[a]=(s[a]+e)%Bo|0}for(;!s[--o];)s.pop();return e?++r:s.shift(),t.d=s,t.e=r,js?Ja(t,f.precision):t};Lr.toDecimalPlaces=Lr.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:(Xf(t,0,g1),e===void 0?e=n.rounding:Xf(e,0,8),Ja(r,t+$i(r)+1,e))};Lr.toExponential=function(t,e){var r,n=this,a=n.constructor;return t===void 0?r=hg(n,!0):(Xf(t,0,g1),e===void 0?e=a.rounding:Xf(e,0,8),n=Ja(new a(n),t+1,e),r=hg(n,!0,t+1)),r};Lr.toFixed=function(t,e){var r,n,a=this,s=a.constructor;return t===void 0?hg(a):(Xf(t,0,g1),e===void 0?e=s.rounding:Xf(e,0,8),n=Ja(new s(a),t+$i(a)+1,e),r=hg(n.abs(),!1,t+$i(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};Lr.toInteger=Lr.toint=function(){var t=this,e=t.constructor;return Ja(new e(t),$i(t)+1,e.rounding)};Lr.toNumber=function(){return+this};Lr.toPower=Lr.pow=function(t){var e,r,n,a,s,o,l=this,c=l.constructor,u=12,d=+(t=new c(t));if(!t.s)return new c(uu);if(l=new c(l),!l.s){if(t.s<1)throw Error(xd+"Infinity");return l}if(l.eq(uu))return l;if(n=c.precision,t.eq(uu))return Ja(l,n);if(e=t.e,r=t.d.length-1,o=e>=r,s=l.s,o){if((r=d<0?-d:d)<=mle){for(a=new c(uu),e=Math.ceil(n/fs+4),js=!1;r%2&&(a=a.times(l),yq(a.d,e)),r=x1(r/2),r!==0;)l=l.times(l),yq(l.d,e);return js=!0,t.s<0?new c(uu).div(a):Ja(a,n)}}else if(s<0)throw Error(xd+"NaN");return s=s<0&&t.d[Math.max(e,r)]&1?-1:1,l.s=1,js=!1,a=t.times(J2(l,n+u)),js=!0,a=gle(a),a.s=s,a};Lr.toPrecision=function(t,e){var r,n,a=this,s=a.constructor;return t===void 0?(r=$i(a),n=hg(a,r<=s.toExpNeg||r>=s.toExpPos)):(Xf(t,1,g1),e===void 0?e=s.rounding:Xf(e,0,8),a=Ja(new s(a),t,e),r=$i(a),n=hg(a,t<=r||r<=s.toExpNeg,t)),n};Lr.toSignificantDigits=Lr.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):(Xf(t,1,g1),e===void 0?e=n.rounding:Xf(e,0,8)),Ja(new n(r),t,e)};Lr.toString=Lr.valueOf=Lr.val=Lr.toJSON=Lr[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=$i(t),r=t.constructor;return hg(t,e<=r.toExpNeg||e>=r.toExpPos)};function ple(t,e){var r,n,a,s,o,l,c,u,d=t.constructor,f=d.precision;if(!t.s||!e.s)return e.s||(e=new d(t)),js?Ja(e,f):e;if(c=t.d,u=e.d,o=t.e,a=e.e,c=c.slice(),s=o-a,s){for(s<0?(n=c,s=-s,l=u.length):(n=u,a=o,l=c.length),o=Math.ceil(f/fs),l=o>l?o+1:l+1,s>l&&(s=l,n.length=1),n.reverse();s--;)n.push(0);n.reverse()}for(l=c.length,s=u.length,l-s<0&&(s=l,n=u,u=c,c=n),r=0;s;)r=(c[--s]=c[s]+u[s]+r)/Bo|0,c[s]%=Bo;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return e.d=c,e.e=a,js?Ja(e,f):e}function Xf(t,e,r){if(t!==~~t||t<e||t>r)throw Error(Rp+t)}function Lf(t){var e,r,n,a=t.length-1,s="",o=t[0];if(a>0){for(s+=o,e=1;e<a;e++)n=t[e]+"",r=fs-n.length,r&&(s+=p0(r)),s+=n;o=t[e],n=o+"",r=fs-n.length,r&&(s+=p0(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var Xh=function(){function t(n,a){var s,o=0,l=n.length;for(n=n.slice();l--;)s=n[l]*a+o,n[l]=s%Bo|0,o=s/Bo|0;return o&&n.unshift(o),n}function e(n,a,s,o){var l,c;if(s!=o)c=s>o?1:-1;else for(l=c=0;l<s;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,s){for(var o=0;s--;)n[s]-=o,o=n[s]<a[s]?1:0,n[s]=o*Bo+n[s]-a[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,s,o){var l,c,u,d,f,A,h,m,p,g,v,y,b,w,j,I,_,S,E=n.constructor,F=n.s==a.s?1:-1,k=n.d,P=a.d;if(!n.s)return new E(n);if(!a.s)throw Error(xd+"Division by zero");for(c=n.e-a.e,_=P.length,j=k.length,h=new E(F),m=h.d=[],u=0;P[u]==(k[u]||0);)++u;if(P[u]>(k[u]||0)&&--c,s==null?y=s=E.precision:o?y=s+($i(n)-$i(a))+1:y=s,y<0)return new E(0);if(y=y/fs+2|0,u=0,_==1)for(d=0,P=P[0],y++;(u<j||d)&&y--;u++)b=d*Bo+(k[u]||0),m[u]=b/P|0,d=b%P|0;else{for(d=Bo/(P[0]+1)|0,d>1&&(P=t(P,d),k=t(k,d),_=P.length,j=k.length),w=_,p=k.slice(0,_),g=p.length;g<_;)p[g++]=0;S=P.slice(),S.unshift(0),I=P[0],P[1]>=Bo/2&&++I;do d=0,l=e(P,p,_,g),l<0?(v=p[0],_!=g&&(v=v*Bo+(p[1]||0)),d=v/I|0,d>1?(d>=Bo&&(d=Bo-1),f=t(P,d),A=f.length,g=p.length,l=e(f,p,A,g),l==1&&(d--,r(f,_<A?S:P,A))):(d==0&&(l=d=1),f=P.slice()),A=f.length,A<g&&f.unshift(0),r(p,f,g),l==-1&&(g=p.length,l=e(P,p,_,g),l<1&&(d++,r(p,_<g?S:P,g))),g=p.length):l===0&&(d++,p=[0]),m[u++]=d,l&&p[0]?p[g++]=k[w]||0:(p=[k[w]],g=1);while((w++<j||p[0]!==void 0)&&y--)}return m[0]||m.shift(),h.e=c,Ja(h,o?s+$i(h)+1:s)}}();function gle(t,e){var r,n,a,s,o,l,c=0,u=0,d=t.constructor,f=d.precision;if($i(t)>16)throw Error(_8+$i(t));if(!t.s)return new d(uu);for(js=!1,l=f,o=new d(.03125);t.abs().gte(.1);)t=t.times(o),u+=5;for(n=Math.log(np(2,u))/Math.LN10*2+5|0,l+=n,r=a=s=new d(uu),d.precision=l;;){if(a=Ja(a.times(t),l),r=r.times(++c),o=s.plus(Xh(a,r,l)),Lf(o.d).slice(0,l)===Lf(s.d).slice(0,l)){for(;u--;)s=Ja(s.times(s),l);return d.precision=f,e==null?(js=!0,Ja(s,f)):s}s=o}}function $i(t){for(var e=t.e*fs,r=t.d[0];r>=10;r/=10)e++;return e}function fB(t,e,r){if(e>t.LN10.sd())throw js=!0,r&&(t.precision=r),Error(xd+"LN10 precision limit exceeded");return Ja(new t(t.LN10),e)}function p0(t){for(var e="";t--;)e+="0";return e}function J2(t,e){var r,n,a,s,o,l,c,u,d,f=1,A=10,h=t,m=h.d,p=h.constructor,g=p.precision;if(h.s<1)throw Error(xd+(h.s?"NaN":"-Infinity"));if(h.eq(uu))return new p(0);if(e==null?(js=!1,u=g):u=e,h.eq(10))return e==null&&(js=!0),fB(p,u);if(u+=A,p.precision=u,r=Lf(m),n=r.charAt(0),s=$i(h),Math.abs(s)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)h=h.times(t),r=Lf(h.d),n=r.charAt(0),f++;s=$i(h),n>1?(h=new p("0."+r),s++):h=new p(n+"."+r.slice(1))}else return c=fB(p,u+2,g).times(s+""),h=J2(new p(n+"."+r.slice(1)),u-A).plus(c),p.precision=g,e==null?(js=!0,Ja(h,g)):h;for(l=o=h=Xh(h.minus(uu),h.plus(uu),u),d=Ja(h.times(h),u),a=3;;){if(o=Ja(o.times(d),u),c=l.plus(Xh(o,new p(a),u)),Lf(c.d).slice(0,u)===Lf(l.d).slice(0,u))return l=l.times(2),s!==0&&(l=l.plus(fB(p,u+2,g).times(s+""))),l=Xh(l,new p(f),u),p.precision=g,e==null?(js=!0,Ja(l,g)):l;l=c,a+=2}}function vq(t,e){var r,n,a;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(a=e.length;e.charCodeAt(a-1)===48;)--a;if(e=e.slice(n,a),e){if(a-=n,r=r-n-1,t.e=x1(r/fs),t.d=[],n=(r+1)%fs,r<0&&(n+=fs),n<a){for(n&&t.d.push(+e.slice(0,n)),a-=fs;n<a;)t.d.push(+e.slice(n,n+=fs));e=e.slice(n),n=fs-e.length}else n-=a;for(;n--;)e+="0";if(t.d.push(+e),js&&(t.e>jI||t.e<-jI))throw Error(_8+r)}else t.s=0,t.e=0,t.d=[0];return t}function Ja(t,e,r){var n,a,s,o,l,c,u,d,f=t.d;for(o=1,s=f[0];s>=10;s/=10)o++;if(n=e-o,n<0)n+=fs,a=e,u=f[d=0];else{if(d=Math.ceil((n+1)/fs),s=f.length,d>=s)return t;for(u=s=f[d],o=1;s>=10;s/=10)o++;n%=fs,a=n-fs+o}if(r!==void 0&&(s=np(10,o-a-1),l=u/s%10|0,c=e<0||f[d+1]!==void 0||u%s,c=r<4?(l||c)&&(r==0||r==(t.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?u/np(10,o-a):0:f[d-1])%10&1||r==(t.s<0?8:7))),e<1||!f[0])return c?(s=$i(t),f.length=1,e=e-s-1,f[0]=np(10,(fs-e%fs)%fs),t.e=x1(-e/fs)||0):(f.length=1,f[0]=t.e=t.s=0),t;if(n==0?(f.length=d,s=1,d--):(f.length=d+1,s=np(10,fs-n),f[d]=a>0?(u/np(10,o-a)%np(10,a)|0)*s:0),c)for(;;)if(d==0){(f[0]+=s)==Bo&&(f[0]=1,++t.e);break}else{if(f[d]+=s,f[d]!=Bo)break;f[d--]=0,s=1}for(n=f.length;f[--n]===0;)f.pop();if(js&&(t.e>jI||t.e<-jI))throw Error(_8+$i(t));return t}function xle(t,e){var r,n,a,s,o,l,c,u,d,f,A=t.constructor,h=A.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new A(t),js?Ja(e,h):e;if(c=t.d,f=e.d,n=e.e,u=t.e,c=c.slice(),o=u-n,o){for(d=o<0,d?(r=c,o=-o,l=f.length):(r=f,n=u,l=c.length),a=Math.max(Math.ceil(h/fs),l)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=f.length,d=a<l,d&&(l=a),a=0;a<l;a++)if(c[a]!=f[a]){d=c[a]<f[a];break}o=0}for(d&&(r=c,c=f,f=r,e.s=-e.s),l=c.length,a=f.length-l;a>0;--a)c[l++]=0;for(a=f.length;a>o;){if(c[--a]<f[a]){for(s=a;s&&c[--s]===0;)c[s]=Bo-1;--c[s],c[a]+=Bo}c[a]-=f[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(e.d=c,e.e=n,js?Ja(e,h):e):new A(0)}function hg(t,e,r){var n,a=$i(t),s=Lf(t.d),o=s.length;return e?(r&&(n=r-o)>0?s=s.charAt(0)+"."+s.slice(1)+p0(n):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(a<0?"e":"e+")+a):a<0?(s="0."+p0(-a-1)+s,r&&(n=r-o)>0&&(s+=p0(n))):a>=o?(s+=p0(a+1-o),r&&(n=r-a-1)>0&&(s=s+"."+p0(n))):((n=a+1)<o&&(s=s.slice(0,n)+"."+s.slice(n)),r&&(n=r-o)>0&&(a+1===o&&(s+="."),s+=p0(n))),t.s<0?"-"+s:s}function yq(t,e){if(t.length>e)return t.length=e,!0}function vle(t){var e,r,n;function a(s){var o=this;if(!(o instanceof a))return new a(s);if(o.constructor=a,s instanceof a){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(Rp+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return vq(o,s.toString())}else if(typeof s!="string")throw Error(Rp+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,iXe.test(s))vq(o,s);else throw Error(Rp+s)}if(a.prototype=Lr,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=vle,a.config=a.set=oXe,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return a.config(t),a}function oXe(t){if(!t||typeof t!="object")throw Error(xd+"Object expected");var e,r,n,a=["precision",1,g1,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<a.length;e+=3)if((n=t[r=a[e]])!==void 0)if(x1(n)===n&&n>=a[e+1]&&n<=a[e+2])this[r]=n;else throw Error(Rp+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Rp+r+": "+n);return this}var E8=vle(sXe);uu=new E8(1);const Fa=E8;var lXe=t=>t,yle={},ble=t=>t===yle,bq=t=>function e(){return arguments.length===0||arguments.length===1&&ble(arguments.length<=0?void 0:arguments[0])?e:t(...arguments)},wle=(t,e)=>t===1?e:bq(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var s=n.filter(o=>o!==yle).length;return s>=t?e(...n):wle(t-s,bq(function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var u=n.map(d=>ble(d)?l.shift():d);return e(...u,...l)}))}),cXe=t=>wle(t.length,t),$F=(t,e)=>{for(var r=[],n=t;n<e;++n)r[n-t]=n;return r},uXe=cXe((t,e)=>Array.isArray(e)?e.map(t):Object.keys(e).map(r=>e[r]).map(t)),dXe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return lXe;var a=r.reverse(),s=a[0],o=a.slice(1);return function(){return o.reduce((l,c)=>c(l),s(...arguments))}};function Nle(t){var e;return t===0?e=1:e=Math.floor(new Fa(t).abs().log(10).toNumber())+1,e}function Cle(t,e,r){for(var n=new Fa(t),a=0,s=[];n.lt(e)&&a<1e5;)s.push(n.toNumber()),n=n.add(r),a++;return s}var _le=t=>{var[e,r]=t,[n,a]=[e,r];return e>r&&([n,a]=[r,e]),[n,a]},Ele=(t,e,r)=>{if(t.lte(0))return new Fa(0);var n=Nle(t.toNumber()),a=new Fa(10).pow(n),s=t.div(a),o=n!==1?.05:.1,l=new Fa(Math.ceil(s.div(o).toNumber())).add(r).mul(o),c=l.mul(a);return e?new Fa(c.toNumber()):new Fa(Math.ceil(c.toNumber()))},fXe=(t,e,r)=>{var n=new Fa(1),a=new Fa(t);if(!a.isint()&&r){var s=Math.abs(t);s<1?(n=new Fa(10).pow(Nle(t)-1),a=new Fa(Math.floor(a.div(n).toNumber())).mul(n)):s>1&&(a=new Fa(Math.floor(t)))}else t===0?a=new Fa(Math.floor((e-1)/2)):r||(a=new Fa(Math.floor(t)));var o=Math.floor((e-1)/2),l=dXe(uXe(c=>a.add(new Fa(c-o).mul(n)).toNumber()),$F);return l(0,e)},Sle=function(e,r,n,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-e)/(n-1)))return{step:new Fa(0),tickMin:new Fa(0),tickMax:new Fa(0)};var o=Ele(new Fa(r).sub(e).div(n-1),a,s),l;e<=0&&r>=0?l=new Fa(0):(l=new Fa(e).add(r).div(2),l=l.sub(new Fa(l).mod(o)));var c=Math.ceil(l.sub(e).div(o).toNumber()),u=Math.ceil(new Fa(r).sub(l).div(o).toNumber()),d=c+u+1;return d>n?Sle(e,r,n,a,s+1):(d<n&&(u=r>0?u+(n-d):u,c=r>0?c:c+(n-d)),{step:o,tickMin:l.sub(new Fa(c).mul(o)),tickMax:l.add(new Fa(u).mul(o))})},hXe=function(e){var[r,n]=e,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),[l,c]=_le([r,n]);if(l===-1/0||c===1/0){var u=c===1/0?[l,...$F(0,a-1).map(()=>1/0)]:[...$F(0,a-1).map(()=>-1/0),c];return r>n?u.reverse():u}if(l===c)return fXe(l,a,s);var{step:d,tickMin:f,tickMax:A}=Sle(l,c,o,s,0),h=Cle(f,A.add(new Fa(.1).mul(d)),d);return r>n?h.reverse():h},AXe=function(e,r){var[n,a]=e,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,l]=_le([n,a]);if(o===-1/0||l===1/0)return[n,a];if(o===l)return[o];var c=Math.max(r,2),u=Ele(new Fa(l).sub(o).div(c-1),s,0),d=[...Cle(new Fa(o),new Fa(l),u),l];return s===!1&&(d=d.map(f=>Math.round(f))),n>a?d.reverse():d},Ile=t=>t.rootProps.maxBarSize,mXe=t=>t.rootProps.barGap,jle=t=>t.rootProps.barCategoryGap,pXe=t=>t.rootProps.barSize,Xw=t=>t.rootProps.stackOffset,Ple=t=>t.rootProps.reverseStackOrder,S8=t=>t.options.chartName,I8=t=>t.rootProps.syncId,Ble=t=>t.rootProps.syncMethod,j8=t=>t.options.eventEmitter,Rl={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Ih={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},su={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},GP=(t,e)=>{if(!(!t||!e))return t!=null&&t.reversed?[e[1],e[0]]:e},gXe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Ih.angleAxisId,includeHidden:!1,name:void 0,reversed:Ih.reversed,scale:Ih.scale,tick:Ih.tick,tickCount:void 0,ticks:void 0,type:Ih.type,unit:void 0},xXe={allowDataOverflow:su.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:su.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:su.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:su.scale,tick:su.tick,tickCount:su.tickCount,ticks:void 0,type:su.type,unit:void 0},vXe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Ih.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ih.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ih.scale,tick:Ih.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},yXe={allowDataOverflow:su.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:su.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:su.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:su.scale,tick:su.tick,tickCount:su.tickCount,ticks:void 0,type:"category",unit:void 0},P8=(t,e)=>t.polarAxis.angleAxis[e]!=null?t.polarAxis.angleAxis[e]:t.layout.layoutType==="radial"?vXe:gXe,B8=(t,e)=>t.polarAxis.radiusAxis[e]!=null?t.polarAxis.radiusAxis[e]:t.layout.layoutType==="radial"?yXe:xXe,KP=t=>t.polarOptions,T8=qt([_A,EA,go],Eoe),Tle=qt([KP,T8],(t,e)=>{if(t!=null)return Ll(t.innerRadius,e,0)}),kle=qt([KP,T8],(t,e)=>{if(t!=null)return Ll(t.outerRadius,e,e*.8)}),bXe=t=>{if(t==null)return[0,0];var{startAngle:e,endAngle:r}=t;return[e,r]},Fle=qt([KP],bXe);qt([P8,Fle],GP);var Ole=qt([T8,Tle,kle],(t,e,r)=>{if(!(t==null||e==null||r==null))return[e,r]});qt([B8,Ole],GP);var Dle=qt([Aa,KP,Tle,kle,_A,EA],(t,e,r,n,a,s)=>{if(!(t!=="centric"&&t!=="radial"||e==null||r==null||n==null)){var{cx:o,cy:l,startAngle:c,endAngle:u}=e;return{cx:Ll(o,a,a/2),cy:Ll(l,s,s/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),ks=(t,e)=>e,Yw=(t,e,r)=>r;function k8(t){return t==null?void 0:t.id}function Rle(t,e,r){var{chartData:n=[]}=e,{allowDuplicatedCategory:a,dataKey:s}=r,o=new Map;return t.forEach(l=>{var c,u=(c=l.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var d=k8(l);u.forEach((f,A)=>{var h=s==null||a?A:String(ps(f,s,null)),m=ps(f,l.dataKey,0),p;o.has(h)?p=o.get(h):p={},Object.assign(p,{[d]:m}),o.set(h,p)})}}),Array.from(o.values())}function qP(t){return"stackId"in t&&t.stackId!=null&&t.dataKey!=null}var zP=(t,e)=>t===e?!0:t==null||e==null?!1:t[0]===e[0]&&t[1]===e[1];function WP(t,e){return Array.isArray(t)&&Array.isArray(e)&&t.length===0&&e.length===0?!0:t===e}function wXe(t,e){if(t.length===e.length){for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}return!1}var vo=t=>{var e=Aa(t);return e==="horizontal"?"xAxis":e==="vertical"?"yAxis":e==="centric"?"angleAxis":"radiusAxis"},v1=t=>t.tooltip.settings.axisId;function wq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function PI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?wq(Object(r),!0).forEach(function(n){NXe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):wq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function NXe(t,e,r){return(e=CXe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CXe(t){var e=_Xe(t,"string");return typeof e=="symbol"?e:e+""}function _Xe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var GF=[0,"auto"],Eo={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},Mle=(t,e)=>t.cartesianAxis.xAxis[e],jA=(t,e)=>{var r=Mle(t,e);return r??Eo},So={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:GF,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Hw},Lle=(t,e)=>t.cartesianAxis.yAxis[e],PA=(t,e)=>{var r=Lle(t,e);return r??So},EXe={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},F8=(t,e)=>{var r=t.cartesianAxis.zAxis[e];return r??EXe},ei=(t,e,r)=>{switch(e){case"xAxis":return jA(t,r);case"yAxis":return PA(t,r);case"zAxis":return F8(t,r);case"angleAxis":return P8(t,r);case"radiusAxis":return B8(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},SXe=(t,e,r)=>{switch(e){case"xAxis":return jA(t,r);case"yAxis":return PA(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},Jw=(t,e,r)=>{switch(e){case"xAxis":return jA(t,r);case"yAxis":return PA(t,r);case"angleAxis":return P8(t,r);case"radiusAxis":return B8(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},Ule=t=>t.graphicalItems.cartesianItems.some(e=>e.type==="bar")||t.graphicalItems.polarItems.some(e=>e.type==="radialBar");function O8(t,e){return r=>{switch(t){case"xAxis":return"xAxisId"in r&&r.xAxisId===e;case"yAxis":return"yAxisId"in r&&r.yAxisId===e;case"zAxis":return"zAxisId"in r&&r.zAxisId===e;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===e;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===e;default:return!1}}}var D8=t=>t.graphicalItems.cartesianItems,IXe=qt([ks,Yw],O8),R8=(t,e,r)=>t.filter(r).filter(n=>(e==null?void 0:e.includeHidden)===!0?!0:!n.hide),Zw=qt([D8,ei,IXe],R8,{memoizeOptions:{resultEqualityCheck:WP}}),Qle=qt([Zw],t=>t.filter(e=>e.type==="area"||e.type==="bar").filter(qP)),Vle=t=>t.filter(e=>!("stackId"in e)||e.stackId===void 0),jXe=qt([Zw],Vle),M8=t=>t.map(e=>e.data).filter(Boolean).flat(1),PXe=qt([Zw],M8,{memoizeOptions:{resultEqualityCheck:WP}}),L8=(t,e)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=e;return t.length>0?t:r.slice(n,a+1)},U8=qt([PXe,hle],L8),Q8=(t,e,r)=>(e==null?void 0:e.dataKey)!=null?t.map(n=>({value:ps(n,e.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>t.map(a=>({value:ps(a,n)}))):t.map(n=>({value:n})),XP=qt([U8,ei,Zw],Q8);function Hle(t,e){switch(t){case"xAxis":return e.direction==="x";case"yAxis":return e.direction==="y";default:return!1}}function hE(t){if(Wf(t)||t instanceof Date){var e=Number(t);if(Zs(e))return e}}function Nq(t){if(Array.isArray(t)){var e=[hE(t[0]),hE(t[1])];return xm(e)?e:void 0}var r=hE(t);if(r!=null)return[r,r]}function hA(t){return t.map(hE).filter(LVe)}function BXe(t,e,r){return!r||typeof e!="number"||zf(e)?[]:r.length?hA(r.flatMap(n=>{var a=ps(t,n.dataKey),s,o;if(Array.isArray(a)?[s,o]=a:s=o=a,!(!Zs(s)||!Zs(o)))return[e-s,e+o]})):[]}var yo=t=>{var e=vo(t),r=v1(t);return Jw(t,e,r)},eN=qt([yo],t=>t==null?void 0:t.dataKey),TXe=qt([Qle,hle,yo],Rle),$le=(t,e,r,n)=>{var a={},s=e.reduce((o,l)=>{if(l.stackId==null)return o;var c=o[l.stackId];return c==null&&(c=[]),c.push(l),o[l.stackId]=c,o},a);return Object.fromEntries(Object.entries(s).map(o=>{var[l,c]=o,u=n?[...c].reverse():c,d=u.map(k8);return[l,{stackedData:nGe(t,d,r),graphicalItems:u}]}))},KF=qt([TXe,Qle,Xw,Ple],$le),Gle=(t,e,r,n)=>{var{dataStartIndex:a,dataEndIndex:s}=e;if(n==null&&r!=="zAxis"){var o=lGe(t,a,s);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},kXe=qt([ei],t=>t.allowDataOverflow),V8=t=>{var e;if(t==null||!("domain"in t))return GF;if(t.domain!=null)return t.domain;if("ticks"in t&&t.ticks!=null){if(t.type==="number"){var r=hA(t.ticks);return[Math.min(...r),Math.max(...r)]}if(t.type==="category")return t.ticks.map(String)}return(e=t==null?void 0:t.domain)!==null&&e!==void 0?e:GF},H8=qt([ei],V8),$8=qt([H8,kXe],Ale),FXe=qt([KF,IA,ks,$8],Gle,{memoizeOptions:{resultEqualityCheck:zP}}),YP=t=>t.errorBars,OXe=(t,e,r)=>t.flatMap(n=>e[n.id]).filter(Boolean).filter(n=>Hle(r,n)),BI=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var s=a.flat(),o=Math.min(...s),l=Math.max(...s);return[o,l]}},G8=(t,e,r,n,a)=>{var s,o;if(r.length>0&&t.forEach(l=>{r.forEach(c=>{var u,d,f=(u=n[c.id])===null||u===void 0?void 0:u.filter(v=>Hle(a,v)),A=ps(l,(d=e.dataKey)!==null&&d!==void 0?d:c.dataKey),h=BXe(l,A,f);if(h.length>=2){var m=Math.min(...h),p=Math.max(...h);(s==null||m<s)&&(s=m),(o==null||p>o)&&(o=p)}var g=Nq(A);g!=null&&(s=s==null?g[0]:Math.min(s,g[0]),o=o==null?g[1]:Math.max(o,g[1]))})}),(e==null?void 0:e.dataKey)!=null&&t.forEach(l=>{var c=Nq(ps(l,e.dataKey));c!=null&&(s=s==null?c[0]:Math.min(s,c[0]),o=o==null?c[1]:Math.max(o,c[1]))}),Zs(s)&&Zs(o))return[s,o]},DXe=qt([U8,ei,jXe,YP,ks],G8,{memoizeOptions:{resultEqualityCheck:zP}});function RXe(t){var{value:e}=t;if(Wf(e)||e instanceof Date)return e}var MXe=(t,e,r)=>{var n=t.map(RXe).filter(a=>a!=null);return r&&(e.dataKey==null||e.allowDuplicatedCategory&&Hse(n))?koe(0,t.length):e.allowDuplicatedCategory?n:Array.from(new Set(n))},Kle=t=>t.referenceElements.dots,y1=(t,e,r)=>t.filter(n=>n.ifOverflow==="extendDomain").filter(n=>e==="xAxis"?n.xAxisId===r:n.yAxisId===r),LXe=qt([Kle,ks,Yw],y1),qle=t=>t.referenceElements.areas,UXe=qt([qle,ks,Yw],y1),zle=t=>t.referenceElements.lines,QXe=qt([zle,ks,Yw],y1),Wle=(t,e)=>{if(t!=null){var r=hA(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},VXe=qt(LXe,ks,Wle),Xle=(t,e)=>{if(t!=null){var r=hA(t.flatMap(n=>[e==="xAxis"?n.x1:n.y1,e==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},HXe=qt([UXe,ks],Xle);function $Xe(t){var e;if(t.x!=null)return hA([t.x]);var r=(e=t.segment)===null||e===void 0?void 0:e.map(n=>n.x);return r==null||r.length===0?[]:hA(r)}function GXe(t){var e;if(t.y!=null)return hA([t.y]);var r=(e=t.segment)===null||e===void 0?void 0:e.map(n=>n.y);return r==null||r.length===0?[]:hA(r)}var Yle=(t,e)=>{if(t!=null){var r=t.flatMap(n=>e==="xAxis"?$Xe(n):GXe(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},KXe=qt([QXe,ks],Yle),qXe=qt(VXe,KXe,HXe,(t,e,r)=>BI(t,r,e)),K8=(t,e,r,n,a,s,o,l)=>{if(r!=null)return r;var c=o==="vertical"&&l==="xAxis"||o==="horizontal"&&l==="yAxis",u=c?BI(n,s,a):BI(s,a);return aXe(e,u,t.allowDataOverflow)},zXe=qt([ei,H8,$8,FXe,DXe,qXe,Aa,ks],K8,{memoizeOptions:{resultEqualityCheck:zP}}),WXe=[0,1],q8=(t,e,r,n,a,s,o)=>{if(!((t==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:c}=t,u=kg(e,s);if(u&&l==null){var d;return koe(0,(d=r==null?void 0:r.length)!==null&&d!==void 0?d:0)}return c==="category"?MXe(n,t,u):a==="expand"?WXe:o}},z8=qt([ei,Aa,U8,XP,Xw,ks,zXe],q8),Jle=(t,e,r,n,a)=>{if(t!=null){var{scale:s,type:o}=t;if(s==="auto")return e==="radial"&&a==="radiusAxis"?"band":e==="radial"&&a==="angleAxis"?"linear":o==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":o==="category"?"band":"linear";if(typeof s=="string"){var l="scale".concat(Mw(s));return l in zy?l:"point"}}},b1=qt([ei,Aa,Ule,S8,ks],Jle);function XXe(t){if(t!=null){if(t in zy)return zy[t]();var e="scale".concat(Mw(t));if(e in zy)return zy[e]()}}function W8(t,e,r,n){if(!(r==null||n==null)){if(typeof t.scale=="function")return t.scale.copy().domain(r).range(n);var a=XXe(e);if(a!=null){var s=a.domain(r).range(n);return J$e(s),s}}}var X8=(t,e,r)=>{var n=V8(e);if(!(r!=="auto"&&r!=="linear")){if(e!=null&&e.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&xm(t))return hXe(t,e.tickCount,e.allowDecimals);if(e!=null&&e.tickCount&&e.type==="number"&&xm(t))return AXe(t,e.tickCount,e.allowDecimals)}},Y8=qt([z8,Jw,b1],X8),J8=(t,e,r,n)=>{if(n!=="angleAxis"&&(t==null?void 0:t.type)==="number"&&xm(e)&&Array.isArray(r)&&r.length>0){var a=e[0],s=r[0],o=e[1],l=r[r.length-1];return[Math.min(a,s),Math.max(o,l)]}return e},YXe=qt([ei,z8,Y8,ks],J8),JXe=qt(XP,ei,(t,e)=>{if(!(!e||e.type!=="number")){var r=1/0,n=Array.from(hA(t.map(f=>f.value))).sort((f,A)=>f-A),a=n[0],s=n[n.length-1];if(a==null||s==null)return 1/0;var o=s-a;if(o===0)return 1/0;for(var l=0;l<n.length-1;l++){var c=n[l],u=n[l+1];if(!(c==null||u==null)){var d=u-c;r=Math.min(r,d)}}return r/o}}),Zle=qt(JXe,Aa,jle,go,(t,e,r,n,a)=>a,(t,e,r,n,a)=>{if(!Zs(t))return 0;var s=e==="vertical"?n.height:n.width;if(a==="gap")return t*s/2;if(a==="no-gap"){var o=Ll(r,t*s),l=t*s/2;return l-o-(l-o)/s*o}return 0}),ZXe=(t,e,r)=>{var n=jA(t,e);return n==null||typeof n.padding!="string"?0:Zle(t,"xAxis",e,r,n.padding)},eYe=(t,e,r)=>{var n=PA(t,e);return n==null||typeof n.padding!="string"?0:Zle(t,"yAxis",e,r,n.padding)},tYe=qt(jA,ZXe,(t,e)=>{var r,n;if(t==null)return{left:0,right:0};var{padding:a}=t;return typeof a=="string"?{left:e,right:e}:{left:((r=a.left)!==null&&r!==void 0?r:0)+e,right:((n=a.right)!==null&&n!==void 0?n:0)+e}}),rYe=qt(PA,eYe,(t,e)=>{var r,n;if(t==null)return{top:0,bottom:0};var{padding:a}=t;return typeof a=="string"?{top:e,bottom:e}:{top:((r=a.top)!==null&&r!==void 0?r:0)+e,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+e}}),nYe=qt([go,tYe,jP,IP,(t,e,r)=>r],(t,e,r,n,a)=>{var{padding:s}=n;return a?[s.left,r.width-s.right]:[t.left+e.left,t.left+t.width-e.right]}),aYe=qt([go,Aa,rYe,jP,IP,(t,e,r)=>r],(t,e,r,n,a,s)=>{var{padding:o}=a;return s?[n.height-o.bottom,o.top]:e==="horizontal"?[t.top+t.height-r.bottom,t.top+r.top]:[t.top+r.top,t.top+t.height-r.bottom]}),tN=(t,e,r,n)=>{var a;switch(e){case"xAxis":return nYe(t,r,n);case"yAxis":return aYe(t,r,n);case"zAxis":return(a=F8(t,r))===null||a===void 0?void 0:a.range;case"angleAxis":return Fle(t);case"radiusAxis":return Ole(t,r);default:return}},ece=qt([ei,tN],GP),JP=qt([ei,b1,YXe,ece],W8);qt([Zw,YP,ks],OXe);function tce(t,e){return t.id<e.id?-1:t.id>e.id?1:0}var ZP=(t,e)=>e,e4=(t,e,r)=>r,sYe=qt(EP,ZP,e4,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(tce)),iYe=qt(SP,ZP,e4,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(tce)),rce=(t,e)=>({width:t.width,height:e.height}),oYe=(t,e)=>{var r=typeof e.width=="number"?e.width:Hw;return{width:r,height:t.height}},nce=qt(go,jA,rce),lYe=(t,e,r)=>{switch(e){case"top":return t.top;case"bottom":return r-t.bottom;default:return 0}},cYe=(t,e,r)=>{switch(e){case"left":return t.left;case"right":return r-t.right;default:return 0}},uYe=qt(EA,go,sYe,ZP,e4,(t,e,r,n,a)=>{var s={},o;return r.forEach(l=>{var c=rce(e,l);o==null&&(o=lYe(e,n,t));var u=n==="top"&&!a||n==="bottom"&&a;s[l.id]=o-Number(u)*c.height,o+=(u?-1:1)*c.height}),s}),dYe=qt(_A,go,iYe,ZP,e4,(t,e,r,n,a)=>{var s={},o;return r.forEach(l=>{var c=oYe(e,l);o==null&&(o=cYe(e,n,t));var u=n==="left"&&!a||n==="right"&&a;s[l.id]=o-Number(u)*c.width,o+=(u?-1:1)*c.width}),s}),fYe=(t,e)=>{var r=jA(t,e);if(r!=null)return uYe(t,r.orientation,r.mirror)},hYe=qt([go,jA,fYe,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var a=r==null?void 0:r[n];return a==null?{x:t.left,y:0}:{x:t.left,y:a}}}),AYe=(t,e)=>{var r=PA(t,e);if(r!=null)return dYe(t,r.orientation,r.mirror)},mYe=qt([go,PA,AYe,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var a=r==null?void 0:r[n];return a==null?{x:0,y:t.top}:{x:a,y:t.top}}}),ace=qt(go,PA,(t,e)=>{var r=typeof e.width=="number"?e.width:Hw;return{width:r,height:t.height}}),Cq=(t,e,r)=>{switch(e){case"xAxis":return nce(t,r).width;case"yAxis":return ace(t,r).height;default:return}},sce=(t,e,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:s,dataKey:o}=r,l=kg(t,n),c=e.map(u=>u.value);if(o&&l&&s==="category"&&a&&Hse(c))return c}},Z8=qt([Aa,XP,ei,ks],sce),ice=(t,e,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:s}=r,o=kg(t,n);if(o&&(a==="number"||s!=="auto"))return e.map(l=>l.value)}},eM=qt([Aa,XP,Jw,ks],ice);qt([Aa,SXe,b1,JP,Z8,eM,tN,Y8,ks],(t,e,r,n,a,s,o,l,c)=>{if(e!=null){var u=kg(t,c);return{angle:e.angle,interval:e.interval,minTickGap:e.minTickGap,orientation:e.orientation,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit,axisType:c,categoricalDomain:s,duplicateDomain:a,isCategorical:u,niceTicks:l,range:o,realScaleType:r,scale:n}}});var pYe=(t,e,r,n,a,s,o,l,c)=>{if(!(e==null||n==null)){var u=kg(t,c),{type:d,ticks:f,tickCount:A}=e,h=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,m=d==="category"&&n.bandwidth?n.bandwidth()/h:0;m=c==="angleAxis"&&s!=null&&s.length>=2?dl(s[0]-s[1])*2*m:m;var p=f||a;if(p){var g=p.map((v,y)=>{var b=o?o.indexOf(v):v;return{index:y,coordinate:n(b)+m,value:v,offset:m}});return g.filter(v=>Zs(v.coordinate))}return u&&l?l.map((v,y)=>({coordinate:n(v)+m,value:v,index:y,offset:m})).filter(v=>Zs(v.coordinate)):n.ticks?n.ticks(A).map(v=>({coordinate:n(v)+m,value:v,offset:m})):n.domain().map((v,y)=>({coordinate:n(v)+m,value:o?o[v]:v,index:y,offset:m}))}},oce=qt([Aa,Jw,b1,JP,Y8,tN,Z8,eM,ks],pYe),gYe=(t,e,r,n,a,s,o)=>{if(!(e==null||r==null||n==null||n[0]===n[1])){var l=kg(t,o),{tickCount:c}=e,u=0;return u=o==="angleAxis"&&(n==null?void 0:n.length)>=2?dl(n[0]-n[1])*2*u:u,l&&s?s.map((d,f)=>({coordinate:r(d)+u,value:d,index:f,offset:u})):r.ticks?r.ticks(c).map(d=>({coordinate:r(d)+u,value:d,offset:u})):r.domain().map((d,f)=>({coordinate:r(d)+u,value:a?a[d]:d,index:f,offset:u}))}},Hv=qt([Aa,Jw,JP,tN,Z8,eM,ks],gYe),$v=qt(ei,JP,(t,e)=>{if(!(t==null||e==null))return PI(PI({},t),{},{scale:e})}),xYe=qt([ei,b1,z8,ece],W8);qt((t,e,r)=>F8(t,r),xYe,(t,e)=>{if(!(t==null||e==null))return PI(PI({},t),{},{scale:e})});var vYe=qt([Aa,EP,SP],(t,e,r)=>{switch(t){case"horizontal":return e.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),lce=t=>t.options.defaultTooltipEventType,cce=t=>t.options.validateTooltipEventTypes;function uce(t,e,r){if(t==null)return e;var n=t?"axis":"item";return r==null?e:r.includes(n)?n:e}function tM(t,e){var r=lce(t),n=cce(t);return uce(e,r,n)}function yYe(t){return Jr(e=>tM(e,t))}var dce=(t,e)=>{var r,n=Number(e);if(!(zf(n)||e==null))return n>=0?t==null||(r=t[n])===null||r===void 0?void 0:r.value:void 0},bYe=t=>t.tooltip.settings,S0={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},wYe={itemInteraction:{click:S0,hover:S0},axisInteraction:{click:S0,hover:S0},keyboardInteraction:S0,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},fce=Vc({name:"tooltip",initialState:wYe,reducers:{addTooltipEntrySettings:{reducer(t,e){t.tooltipItemPayloads.push(e.payload)},prepare:Ns()},replaceTooltipEntrySettings:{reducer(t,e){var{prev:r,next:n}=e.payload,a=rf(t).tooltipItemPayloads.indexOf(r);a>-1&&(t.tooltipItemPayloads[a]=n)},prepare:Ns()},removeTooltipEntrySettings:{reducer(t,e){var r=rf(t).tooltipItemPayloads.indexOf(e.payload);r>-1&&t.tooltipItemPayloads.splice(r,1)},prepare:Ns()},setTooltipSettingsState(t,e){t.settings=e.payload},setActiveMouseOverItemIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=e.payload.activeIndex,t.itemInteraction.hover.dataKey=e.payload.activeDataKey,t.itemInteraction.hover.graphicalItemId=e.payload.activeGraphicalItemId,t.itemInteraction.hover.coordinate=e.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,e){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=e.payload.activeIndex,t.itemInteraction.click.dataKey=e.payload.activeDataKey,t.itemInteraction.click.graphicalItemId=e.payload.activeGraphicalItemId,t.itemInteraction.click.coordinate=e.payload.activeCoordinate},setMouseOverAxisIndex(t,e){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=e.payload.activeIndex,t.axisInteraction.hover.dataKey=e.payload.activeDataKey,t.axisInteraction.hover.coordinate=e.payload.activeCoordinate},setMouseClickAxisIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=e.payload.activeIndex,t.axisInteraction.click.dataKey=e.payload.activeDataKey,t.axisInteraction.click.coordinate=e.payload.activeCoordinate},setSyncInteraction(t,e){t.syncInteraction=e.payload},setKeyboardInteraction(t,e){t.keyboardInteraction.active=e.payload.active,t.keyboardInteraction.index=e.payload.activeIndex,t.keyboardInteraction.coordinate=e.payload.activeCoordinate}}}),{addTooltipEntrySettings:NYe,replaceTooltipEntrySettings:CYe,removeTooltipEntrySettings:_Ye,setTooltipSettingsState:EYe,setActiveMouseOverItemIndex:hce,mouseLeaveItem:SYe,mouseLeaveChart:Ace,setActiveClickItemIndex:IYe,setMouseOverAxisIndex:mce,setMouseClickAxisIndex:jYe,setSyncInteraction:qF,setKeyboardInteraction:zF}=fce.actions,PYe=fce.reducer;function _q(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function g_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_q(Object(r),!0).forEach(function(n){BYe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_q(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function BYe(t,e,r){return(e=TYe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TYe(t){var e=kYe(t,"string");return typeof e=="symbol"?e:e+""}function kYe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FYe(t,e,r){return e==="axis"?r==="click"?t.axisInteraction.click:t.axisInteraction.hover:r==="click"?t.itemInteraction.click:t.itemInteraction.hover}function OYe(t){return t.index!=null}var pce=(t,e,r,n)=>{if(e==null)return S0;var a=FYe(t,e,r);if(a==null)return S0;if(a.active)return a;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var s=t.settings.active===!0;if(OYe(a)){if(s)return g_(g_({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return g_(g_({},S0),{},{coordinate:a.coordinate})};function DYe(t){if(typeof t=="number")return Number.isFinite(t)?t:void 0;if(t instanceof Date){var e=t.valueOf();return Number.isFinite(e)?e:void 0}var r=Number(t);return Number.isFinite(r)?r:void 0}function RYe(t,e){var r=DYe(t),n=e[0],a=e[1];if(r===void 0)return!1;var s=Math.min(n,a),o=Math.max(n,a);return r>=s&&r<=o}function MYe(t,e,r){if(r==null||e==null)return!0;var n=ps(t,e);return n==null||!xm(r)?!0:RYe(n,r)}var rM=(t,e,r,n)=>{var a=t==null?void 0:t.index;if(a==null)return null;var s=Number(a);if(!Zs(s))return a;var o=0,l=1/0;e.length>0&&(l=e.length-1);var c=Math.max(o,Math.min(s,l)),u=e[c];return u==null||MYe(u,r,n)?String(c):null},gce=(t,e,r,n,a,s,o,l)=>{if(!(s==null||l==null)){var c=o[0],u=c==null?void 0:l(c.positions,s);if(u!=null)return u;var d=a==null?void 0:a[Number(s)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+e)/2};default:return{x:(n.left+t)/2,y:d.coordinate}}}},xce=(t,e,r,n)=>{if(e==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var a;if(r==="hover"?a=t.itemInteraction.hover.graphicalItemId:a=t.itemInteraction.click.graphicalItemId,a==null&&n!=null){var s=t.tooltipItemPayloads[0];return s!=null?[s]:[]}return t.tooltipItemPayloads.filter(o=>{var l;return((l=o.settings)===null||l===void 0?void 0:l.graphicalItemId)===a})},rN=t=>t.options.tooltipPayloadSearcher,w1=t=>t.tooltip;function Eq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Sq(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Eq(Object(r),!0).forEach(function(n){LYe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Eq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function LYe(t,e,r){return(e=UYe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UYe(t){var e=QYe(t,"string");return typeof e=="symbol"?e:e+""}function QYe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VYe(t,e){return t??e}var vce=(t,e,r,n,a,s,o)=>{if(!(e==null||s==null)){var{chartData:l,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,f=[];return t.reduce((A,h)=>{var m,{dataDefinedOnItem:p,settings:g}=h,v=VYe(p,l),y=Array.isArray(v)?Yie(v,u,d):v,b=(m=g==null?void 0:g.dataKey)!==null&&m!==void 0?m:n,w=g==null?void 0:g.nameKey,j;if(n&&Array.isArray(y)&&!Array.isArray(y[0])&&o==="axis"?j=MVe(y,n,a):j=s(y,e,c,w),Array.isArray(j))j.forEach(_=>{var S=Sq(Sq({},g),{},{name:_.name,unit:_.unit,color:void 0,fill:void 0});A.push(RG({tooltipEntrySettings:S,dataKey:_.dataKey,payload:_.payload,value:ps(_.payload,_.dataKey),name:_.name}))});else{var I;A.push(RG({tooltipEntrySettings:g,dataKey:b,payload:j,value:ps(j,b),name:(I=ps(j,w))!==null&&I!==void 0?I:g==null?void 0:g.name}))}return A},f)}},nM=qt([yo,Aa,Ule,S8,vo],Jle),HYe=qt([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,e)=>[...t,...e]),$Ye=qt([vo,v1],O8),N1=qt([HYe,yo,$Ye],R8,{memoizeOptions:{resultEqualityCheck:WP}}),GYe=qt([N1],t=>t.filter(qP)),KYe=qt([N1],M8,{memoizeOptions:{resultEqualityCheck:WP}}),C1=qt([KYe,IA],L8),qYe=qt([GYe,IA,yo],Rle),aM=qt([C1,yo,N1],Q8),yce=qt([yo],V8),zYe=qt([yo],t=>t.allowDataOverflow),bce=qt([yce,zYe],Ale),WYe=qt([N1],t=>t.filter(qP)),XYe=qt([qYe,WYe,Xw,Ple],$le),YYe=qt([XYe,IA,vo,bce],Gle),JYe=qt([N1],Vle),ZYe=qt([C1,yo,JYe,YP,vo],G8,{memoizeOptions:{resultEqualityCheck:zP}}),eJe=qt([Kle,vo,v1],y1),tJe=qt([eJe,vo],Wle),rJe=qt([qle,vo,v1],y1),nJe=qt([rJe,vo],Xle),aJe=qt([zle,vo,v1],y1),sJe=qt([aJe,vo],Yle),iJe=qt([tJe,sJe,nJe],BI),oJe=qt([yo,yce,bce,YYe,ZYe,iJe,Aa,vo],K8),nN=qt([yo,Aa,C1,aM,Xw,vo,oJe],q8),lJe=qt([nN,yo,nM],X8),cJe=qt([yo,nN,lJe,vo],J8),wce=t=>{var e=vo(t),r=v1(t),n=!1;return tN(t,e,r,n)},Nce=qt([yo,wce],GP),Cce=qt([yo,nM,cJe,Nce],W8),uJe=qt([Aa,aM,yo,vo],sce),dJe=qt([Aa,aM,yo,vo],ice),fJe=(t,e,r,n,a,s,o,l)=>{if(e){var{type:c}=e,u=kg(t,l);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/d:0;return f=l==="angleAxis"&&a!=null&&(a==null?void 0:a.length)>=2?dl(a[0]-a[1])*2*f:f,u&&o?o.map((A,h)=>({coordinate:n(A)+f,value:A,index:h,offset:f})):n.domain().map((A,h)=>({coordinate:n(A)+f,value:s?s[A]:A,index:h,offset:f}))}}},BA=qt([Aa,yo,nM,Cce,wce,uJe,dJe,vo],fJe),sM=qt([lce,cce,bYe],(t,e,r)=>uce(r.shared,t,e)),_ce=t=>t.tooltip.settings.trigger,iM=t=>t.tooltip.settings.defaultIndex,aN=qt([w1,sM,_ce,iM],pce),Ag=qt([aN,C1,eN,nN],rM),Ece=qt([BA,Ag],dce),oM=qt([aN],t=>{if(t)return t.dataKey}),hJe=qt([aN],t=>{if(t)return t.graphicalItemId}),Sce=qt([w1,sM,_ce,iM],xce),AJe=qt([_A,EA,Aa,go,BA,iM,Sce,rN],gce),mJe=qt([aN,AJe],(t,e)=>t!=null&&t.coordinate?t.coordinate:e),pJe=qt([aN],t=>{var e;return(e=t==null?void 0:t.active)!==null&&e!==void 0?e:!1}),gJe=qt([Sce,Ag,IA,eN,Ece,rN,sM],vce);qt([gJe],t=>{if(t!=null){var e=t.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(e))}});function Iq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function jq(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Iq(Object(r),!0).forEach(function(n){xJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Iq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function xJe(t,e,r){return(e=vJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vJe(t){var e=yJe(t,"string");return typeof e=="symbol"?e:e+""}function yJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var bJe=()=>Jr(yo),wJe=()=>{var t=bJe(),e=Jr(BA),r=Jr(Cce);return uI(!t||!r?void 0:jq(jq({},t),{},{scale:r}),e)};function Pq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ax(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Pq(Object(r),!0).forEach(function(n){NJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Pq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function NJe(t,e,r){return(e=CJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CJe(t){var e=_Je(t,"string");return typeof e=="symbol"?e:e+""}function _Je(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var EJe=(t,e,r,n)=>{var a=e.find(s=>s&&s.index===r);if(a){if(t==="horizontal")return{x:a.coordinate,y:n.chartY};if(t==="vertical")return{x:n.chartX,y:a.coordinate}}return{x:0,y:0}},SJe=(t,e,r,n)=>{var a=e.find(u=>u&&u.index===r);if(a){if(t==="centric"){var s=a.coordinate,{radius:o}=n;return Ax(Ax(Ax({},n),Hi(n.cx,n.cy,o,s)),{},{angle:s,radius:o})}var l=a.coordinate,{angle:c}=n;return Ax(Ax(Ax({},n),Hi(n.cx,n.cy,l,c)),{},{angle:c,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function IJe(t,e){var{chartX:r,chartY:n}=t;return r>=e.left&&r<=e.left+e.width&&n>=e.top&&n<=e.top+e.height}var Ice=(t,e,r,n,a)=>{var s,o=(s=e==null?void 0:e.length)!==null&&s!==void 0?s:0;if(o<=1||t==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var l=0;l<o;l++){var c,u,d,f,A,h=l>0?(c=r[l-1])===null||c===void 0?void 0:c.coordinate:(u=r[o-1])===null||u===void 0?void 0:u.coordinate,m=(d=r[l])===null||d===void 0?void 0:d.coordinate,p=l>=o-1?(f=r[0])===null||f===void 0?void 0:f.coordinate:(A=r[l+1])===null||A===void 0?void 0:A.coordinate,g=void 0;if(!(h==null||m==null||p==null))if(dl(m-h)!==dl(p-m)){var v=[];if(dl(p-m)===dl(a[1]-a[0])){g=p;var y=m+a[1]-a[0];v[0]=Math.min(y,(y+h)/2),v[1]=Math.max(y,(y+h)/2)}else{g=h;var b=p+a[1]-a[0];v[0]=Math.min(m,(b+m)/2),v[1]=Math.max(m,(b+m)/2)}var w=[Math.min(m,(g+m)/2),Math.max(m,(g+m)/2)];if(t>w[0]&&t<=w[1]||t>=v[0]&&t<=v[1]){var j;return(j=r[l])===null||j===void 0?void 0:j.index}}else{var I=Math.min(h,p),_=Math.max(h,p);if(t>(I+m)/2&&t<=(_+m)/2){var S;return(S=r[l])===null||S===void 0?void 0:S.index}}}else if(e)for(var E=0;E<o;E++){var F=e[E];if(F!=null){var k=e[E+1],P=e[E-1];if(E===0&&k!=null&&t<=(F.coordinate+k.coordinate)/2||E===o-1&&P!=null&&t>(F.coordinate+P.coordinate)/2||E>0&&E<o-1&&P!=null&&k!=null&&t>(F.coordinate+P.coordinate)/2&&t<=(F.coordinate+k.coordinate)/2)return F.index}}return-1},jJe=()=>Jr(S8),lM=(t,e)=>e,jce=(t,e,r)=>r,cM=(t,e,r,n)=>n,PJe=qt(BA,t=>mP(t,e=>e.coordinate)),uM=qt([w1,lM,jce,cM],pce),dM=qt([uM,C1,eN,nN],rM),BJe=(t,e,r)=>{if(e!=null){var n=w1(t);return e==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},Pce=qt([w1,lM,jce,cM],xce),TI=qt([_A,EA,Aa,go,BA,cM,Pce,rN],gce),TJe=qt([uM,TI],(t,e)=>{var r;return(r=t.coordinate)!==null&&r!==void 0?r:e}),Bce=qt([BA,dM],dce),kJe=qt([Pce,dM,IA,eN,Bce,rN,lM],vce),FJe=qt([uM,dM],(t,e)=>({isActive:t.active&&e!=null,activeIndex:e})),OJe=(t,e,r,n,a,s,o)=>{if(!(!t||!r||!n||!a)&&IJe(t,o)){var l=cGe(t,e),c=Ice(l,s,a,r,n),u=EJe(e,a,c,t);return{activeIndex:String(c),activeCoordinate:u}}},DJe=(t,e,r,n,a,s,o)=>{if(!(!t||!n||!a||!s||!r)){var l=Nqe(t,r);if(l){var c=uGe(l,e),u=Ice(c,o,s,n,a),d=SJe(e,s,u,l);return{activeIndex:String(u),activeCoordinate:d}}}},RJe=(t,e,r,n,a,s,o,l)=>{if(!(!t||!e||!n||!a||!s))return e==="horizontal"||e==="vertical"?OJe(t,e,n,a,s,o,l):DJe(t,e,r,n,a,s,o)},MJe=qt(t=>t.zIndex.zIndexMap,(t,e)=>e,(t,e,r)=>r,(t,e,r)=>{if(e!=null){var n=t[e];if(n!=null)return r?n.panoramaElement:n.element}}),LJe=qt(t=>t.zIndex.zIndexMap,t=>{var e=Object.keys(t).map(n=>parseInt(n,10)).concat(Object.values(Rl)),r=Array.from(new Set(e));return r.sort((n,a)=>n-a)},{memoizeOptions:{resultEqualityCheck:wXe}});function Bq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Tq(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Bq(Object(r),!0).forEach(function(n){UJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Bq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function UJe(t,e,r){return(e=QJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QJe(t){var e=VJe(t,"string");return typeof e=="symbol"?e:e+""}function VJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var HJe={},$Je={zIndexMap:Object.values(Rl).reduce((t,e)=>Tq(Tq({},t),{},{[e]:{element:void 0,panoramaElement:void 0,consumers:0}}),HJe)},GJe=new Set(Object.values(Rl));function KJe(t){return GJe.has(t)}var Tce=Vc({name:"zIndex",initialState:$Je,reducers:{registerZIndexPortal:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]?t.zIndexMap[r].consumers+=1:t.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:Ns()},unregisterZIndexPortal:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]&&(t.zIndexMap[r].consumers-=1,t.zIndexMap[r].consumers<=0&&!KJe(r)&&delete t.zIndexMap[r])},prepare:Ns()},registerZIndexPortalElement:{reducer:(t,e)=>{var{zIndex:r,element:n,isPanorama:a}=e.payload;t.zIndexMap[r]?a?t.zIndexMap[r].panoramaElement=n:t.zIndexMap[r].element=n:t.zIndexMap[r]={consumers:0,element:a?void 0:n,panoramaElement:a?n:void 0}},prepare:Ns()},unregisterZIndexPortalElement:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]&&(e.payload.isPanorama?t.zIndexMap[r].panoramaElement=void 0:t.zIndexMap[r].element=void 0)},prepare:Ns()}}}),{registerZIndexPortal:qJe,unregisterZIndexPortal:zJe,registerZIndexPortalElement:WJe,unregisterZIndexPortalElement:XJe}=Tce.actions,YJe=Tce.reducer;function nh(t){var{zIndex:e,children:r}=t,n=MGe(),a=n&&e!==void 0&&e!==0,s=_u(),o=os();x.useLayoutEffect(()=>a?(o(qJe({zIndex:e})),()=>{o(zJe({zIndex:e}))}):Lw,[o,e,a]);var l=Jr(c=>MJe(c,e,s));return a?l?pu.createPortal(r,l):null:r}function WF(){return WF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},WF.apply(null,arguments)}function kq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function x_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kq(Object(r),!0).forEach(function(n){JJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function JJe(t,e,r){return(e=ZJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZJe(t){var e=eZe(t,"string");return typeof e=="symbol"?e:e+""}function eZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tZe(t){var{cursor:e,cursorComp:r,cursorProps:n}=t;return x.isValidElement(e)?x.cloneElement(e,n):x.createElement(r,n)}function rZe(t){var e,{coordinate:r,payload:n,index:a,offset:s,tooltipAxisBandSize:o,layout:l,cursor:c,tooltipEventType:u,chartName:d}=t,f=r,A=n,h=a;if(!c||!f||d!=="ScatterChart"&&u!=="axis")return null;var m,p,g;if(d==="ScatterChart")m=f,p=RKe,g=Rl.cursorLine;else if(d==="BarChart")m=MKe(l,f,s,o),p=_oe,g=Rl.cursorRectangle;else if(l==="radial"&&Gse(f)){var{cx:v,cy:y,radius:b,startAngle:w,endAngle:j}=Soe(f);m={cx:v,cy:y,startAngle:w,endAngle:j,innerRadius:b,outerRadius:b},p=joe,g=Rl.cursorLine}else m={points:Sqe(l,f,s)},p=t8,g=Rl.cursorLine;var I=typeof c=="object"&&"className"in c?c.className:void 0,_=x_(x_(x_(x_({stroke:"#ccc",pointerEvents:"none"},s),m),L2(c)),{},{payload:A,payloadIndex:h,className:La("recharts-tooltip-cursor",I)});return x.createElement(nh,{zIndex:(e=t.zIndex)!==null&&e!==void 0?e:g},x.createElement(tZe,{cursor:c,cursorComp:p,cursorProps:_}))}function nZe(t){var e=wJe(),r=DGe(),n=$w(),a=jJe();return e==null||r==null||n==null||a==null?null:x.createElement(rZe,WF({},t,{offset:r,layout:n,tooltipAxisBandSize:e,chartName:a}))}var kce=x.createContext(null),aZe=()=>x.useContext(kce),Fce={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function s(c,u,d,f,A){if(typeof d!="function")throw new TypeError("The listener must be a function");var h=new a(d,f||c,A),m=r?r+u:u;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],h]:c._events[m].push(h):(c._events[m]=h,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)e.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var A=0,h=f.length,m=new Array(h);A<h;A++)m[A]=f[A].fn;return m},l.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,d,f,A,h,m){var p=r?r+u:u;if(!this._events[p])return!1;var g=this._events[p],v=arguments.length,y,b;if(g.fn){switch(g.once&&this.removeListener(u,g.fn,void 0,!0),v){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,d),!0;case 3:return g.fn.call(g.context,d,f),!0;case 4:return g.fn.call(g.context,d,f,A),!0;case 5:return g.fn.call(g.context,d,f,A,h),!0;case 6:return g.fn.call(g.context,d,f,A,h,m),!0}for(b=1,y=new Array(v-1);b<v;b++)y[b-1]=arguments[b];g.fn.apply(g.context,y)}else{var w=g.length,j;for(b=0;b<w;b++)switch(g[b].once&&this.removeListener(u,g[b].fn,void 0,!0),v){case 1:g[b].fn.call(g[b].context);break;case 2:g[b].fn.call(g[b].context,d);break;case 3:g[b].fn.call(g[b].context,d,f);break;case 4:g[b].fn.call(g[b].context,d,f,A);break;default:if(!y)for(j=1,y=new Array(v-1);j<v;j++)y[j-1]=arguments[j];g[b].fn.apply(g[b].context,y)}}return!0},l.prototype.on=function(u,d,f){return s(this,u,d,f,!1)},l.prototype.once=function(u,d,f){return s(this,u,d,f,!0)},l.prototype.removeListener=function(u,d,f,A){var h=r?r+u:u;if(!this._events[h])return this;if(!d)return o(this,h),this;var m=this._events[h];if(m.fn)m.fn===d&&(!A||m.once)&&(!f||m.context===f)&&o(this,h);else{for(var p=0,g=[],v=m.length;p<v;p++)(m[p].fn!==d||A&&!m[p].once||f&&m[p].context!==f)&&g.push(m[p]);g.length?this._events[h]=g.length===1?g[0]:g:o(this,h)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,t.exports=l})(Fce);var sZe=Fce.exports;const iZe=mA(sZe);var Z2=new iZe,XF="recharts.syncEvent.tooltip",Fq="recharts.syncEvent.brush";function Oce(t,e){if(e){var r=Number.parseInt(e,10);if(!zf(r))return t==null?void 0:t[r]}}var oZe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},Dce=Vc({name:"options",initialState:oZe,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),lZe=Dce.reducer,{createEventEmitter:cZe}=Dce.actions;function uZe(t){return t.tooltip.syncInteraction}var dZe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},Rce=Vc({name:"chartData",initialState:dZe,reducers:{setChartData(t,e){if(t.chartData=e.payload,e.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}e.payload.length>0&&t.dataEndIndex!==e.payload.length-1&&(t.dataEndIndex=e.payload.length-1)},setComputedData(t,e){t.computedData=e.payload},setDataStartEndIndexes(t,e){var{startIndex:r,endIndex:n}=e.payload;r!=null&&(t.dataStartIndex=r),n!=null&&(t.dataEndIndex=n)}}}),{setChartData:Oq,setDataStartEndIndexes:fZe,setComputedData:vit}=Rce.actions,hZe=Rce.reducer,AZe=["x","y"];function Dq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function mx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Dq(Object(r),!0).forEach(function(n){mZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Dq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mZe(t,e,r){return(e=pZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pZe(t){var e=gZe(t,"string");return typeof e=="symbol"?e:e+""}function gZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xZe(t,e){if(t==null)return{};var r,n,a=vZe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function vZe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function yZe(){var t=Jr(I8),e=Jr(j8),r=os(),n=Jr(Ble),a=Jr(BA),s=$w(),o=PP(),l=Jr(c=>c.rootProps.className);x.useEffect(()=>{if(t==null)return Lw;var c=(u,d,f)=>{if(e!==f&&t===u){if(n==="index"){var A;if(o&&d!==null&&d!==void 0&&(A=d.payload)!==null&&A!==void 0&&A.coordinate&&d.payload.sourceViewBox){var h=d.payload.coordinate,{x:m,y:p}=h,g=xZe(h,AZe),{x:v,y,width:b,height:w}=d.payload.sourceViewBox,j=mx(mx({},g),{},{x:o.x+(b?(m-v)/b:0)*o.width,y:o.y+(w?(p-y)/w:0)*o.height});r(mx(mx({},d),{},{payload:mx(mx({},d.payload),{},{coordinate:j})}))}else r(d);return}if(a!=null){var I;if(typeof n=="function"){var _={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},S=n(a,_);I=a[S]}else n==="value"&&(I=a.find(ge=>String(ge.value)===d.payload.label));var{coordinate:E}=d.payload;if(I==null||d.payload.active===!1||E==null||o==null){r(qF({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:F,y:k}=E,P=Math.min(F,o.x+o.width),D=Math.min(k,o.y+o.height),X={x:s==="horizontal"?I.coordinate:P,y:s==="horizontal"?D:I.coordinate},pe=qF({active:d.payload.active,coordinate:X,dataKey:d.payload.dataKey,index:String(I.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox,graphicalItemId:d.payload.graphicalItemId});r(pe)}}};return Z2.on(XF,c),()=>{Z2.off(XF,c)}},[l,r,e,t,n,a,s,o])}function bZe(){var t=Jr(I8),e=Jr(j8),r=os();x.useEffect(()=>{if(t==null)return Lw;var n=(a,s,o)=>{e!==o&&t===a&&r(fZe(s))};return Z2.on(Fq,n),()=>{Z2.off(Fq,n)}},[r,e,t])}function wZe(){var t=os();x.useEffect(()=>{t(cZe())},[t]),yZe(),bZe()}function NZe(t,e,r,n,a,s){var o=Jr(h=>BJe(h,t,e)),l=Jr(j8),c=Jr(I8),u=Jr(Ble),d=Jr(uZe),f=d==null?void 0:d.active,A=PP();x.useEffect(()=>{if(!f&&c!=null&&l!=null){var h=qF({active:s,coordinate:r,dataKey:o,index:a,label:typeof n=="number"?String(n):n,sourceViewBox:A,graphicalItemId:void 0});Z2.emit(XF,c,h,l)}},[f,r,o,a,n,l,c,u,s,A])}function Rq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Mq(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Rq(Object(r),!0).forEach(function(n){CZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Rq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function CZe(t,e,r){return(e=_Ze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _Ze(t){var e=EZe(t,"string");return typeof e=="symbol"?e:e+""}function EZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function SZe(t){return t.dataKey}function IZe(t,e){return x.isValidElement(t)?x.cloneElement(t,e):typeof t=="function"?x.createElement(t,e):x.createElement(pKe,e)}var Lq=[],jZe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Uq(t){var e,r,n=Al(t,jZe),{active:a,allowEscapeViewBox:s,animationDuration:o,animationEasing:l,content:c,filterNull:u,isAnimationActive:d,offset:f,payloadUniqBy:A,position:h,reverseDirection:m,useTranslate3d:p,wrapperStyle:g,cursor:v,shared:y,trigger:b,defaultIndex:w,portal:j,axisId:I}=n,_=os(),S=typeof w=="number"?String(w):w;x.useEffect(()=>{_(EYe({shared:y,trigger:b,axisId:I,active:a,defaultIndex:S}))},[_,y,b,I,a,S]);var E=PP(),F=yoe(),k=yYe(y),{activeIndex:P,isActive:D}=(e=Jr(ee=>FJe(ee,k,b,S)))!==null&&e!==void 0?e:{},X=Jr(ee=>kJe(ee,k,b,S)),pe=Jr(ee=>Bce(ee,k,b,S)),ge=Jr(ee=>TJe(ee,k,b,S)),fe=X,xe=aZe(),ae=(r=a??D)!==null&&r!==void 0?r:!1,[Se,Te]=bie([fe,ae]),O=k==="axis"?pe:void 0;NZe(k,b,ge,O,P,ae);var G=j??xe;if(G==null||E==null||k==null)return null;var z=fe??Lq;ae||(z=Lq),u&&z.length&&(z=cie(z.filter(ee=>ee.value!=null&&(ee.hide!==!0||n.includeHidden)),A,SZe));var L=z.length>0,Z=x.createElement(NKe,{allowEscapeViewBox:s,animationDuration:o,animationEasing:l,isAnimationActive:d,active:ae,coordinate:ge,hasPayload:L,offset:f,position:h,reverseDirection:m,useTranslate3d:p,viewBox:E,wrapperStyle:g,lastBoundingBox:Se,innerRef:Te,hasPortalFromProps:!!j},IZe(c,Mq(Mq({},n),{},{payload:z,label:O,active:ae,activeIndex:P,coordinate:ge,accessibilityLayer:F})));return x.createElement(x.Fragment,null,pu.createPortal(Z,G),ae&&x.createElement(nZe,{cursor:v,tooltipEventType:k,coordinate:ge,payload:z,index:P}))}var sN=t=>null;sN.displayName="Cell";function PZe(t,e,r){return(e=BZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function BZe(t){var e=TZe(t,"string");return typeof e=="symbol"?e:e+""}function TZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kZe{constructor(e){PZe(this,"cache",new Map),this.maxSize=e}get(e){var r=this.cache.get(e);return r!==void 0&&(this.cache.delete(e),this.cache.set(e,r)),r}set(e,r){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(e,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function Qq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function FZe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Qq(Object(r),!0).forEach(function(n){OZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Qq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function OZe(t,e,r){return(e=DZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DZe(t){var e=RZe(t,"string");return typeof e=="symbol"?e:e+""}function RZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var MZe={cacheSize:2e3,enableCache:!0},Mce=FZe({},MZe),Vq=new kZe(Mce.cacheSize),LZe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Hq="recharts_measurement_span";function UZe(t,e){var r=e.fontSize||"",n=e.fontFamily||"",a=e.fontWeight||"",s=e.fontStyle||"",o=e.letterSpacing||"",l=e.textTransform||"";return"".concat(t,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(s,"|").concat(o,"|").concat(l)}var $q=(t,e)=>{try{var r=document.getElementById(Hq);r||(r=document.createElement("span"),r.setAttribute("id",Hq),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,LZe,e),r.textContent="".concat(t);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},kb=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||OP.isSsr)return{width:0,height:0};if(!Mce.enableCache)return $q(e,r);var n=UZe(e,r),a=Vq.get(n);if(a)return a;var s=$q(e,r);return Vq.set(n,s),s},Lce;function QZe(t,e,r){return(e=VZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VZe(t){var e=HZe(t,"string");return typeof e=="symbol"?e:e+""}function HZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Gq=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Kq=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,$Ze=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,GZe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,KZe={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},qZe=["cm","mm","pt","pc","in","Q","px"];function zZe(t){return qZe.includes(t)}var zx="NaN";function WZe(t,e){return t*KZe[e]}class rl{static parse(e){var r,[,n,a]=(r=GZe.exec(e))!==null&&r!==void 0?r:[];return n==null?rl.NaN:new rl(parseFloat(n),a??"")}constructor(e,r){this.num=e,this.unit=r,this.num=e,this.unit=r,zf(e)&&(this.unit=""),r!==""&&!$Ze.test(r)&&(this.num=NaN,this.unit=""),zZe(r)&&(this.num=WZe(e,r),this.unit="px")}add(e){return this.unit!==e.unit?new rl(NaN,""):new rl(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new rl(NaN,""):new rl(this.num-e.num,this.unit)}multiply(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new rl(NaN,""):new rl(this.num*e.num,this.unit||e.unit)}divide(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new rl(NaN,""):new rl(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return zf(this.num)}}Lce=rl;QZe(rl,"NaN",new Lce(NaN,""));function Uce(t){if(t==null||t.includes(zx))return zx;for(var e=t;e.includes("*")||e.includes("/");){var r,[,n,a,s]=(r=Gq.exec(e))!==null&&r!==void 0?r:[],o=rl.parse(n??""),l=rl.parse(s??""),c=a==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return zx;e=e.replace(Gq,c.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var u,[,d,f,A]=(u=Kq.exec(e))!==null&&u!==void 0?u:[],h=rl.parse(d??""),m=rl.parse(A??""),p=f==="+"?h.add(m):h.subtract(m);if(p.isNaN())return zx;e=e.replace(Kq,p.toString())}return e}var qq=/\(([^()]*)\)/;function XZe(t){for(var e=t,r;(r=qq.exec(e))!=null;){var[,n]=r;e=e.replace(qq,Uce(n))}return e}function YZe(t){var e=t.replace(/\s+/g,"");return e=XZe(e),e=Uce(e),e}function JZe(t){try{return YZe(t)}catch{return zx}}function hB(t){var e=JZe(t.slice(5,-1));return e===zx?"":e}var ZZe=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],eet=["dx","dy","angle","className","breakAll"];function YF(){return YF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},YF.apply(null,arguments)}function zq(t,e){if(t==null)return{};var r,n,a=tet(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function tet(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Qce=/[ \f\n\r\t\v\u2028\u2029]+/,Vce=t=>{var{children:e,breakAll:r,style:n}=t;try{var a=[];Qo(e)||(r?a=e.toString().split(""):a=e.toString().split(Qce));var s=a.map(l=>({word:l,width:kb(l,n).width})),o=r?0:kb("",n).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}};function ret(t){return t==="start"||t==="middle"||t==="end"||t==="inherit"}var Hce=(t,e,r,n)=>t.reduce((a,s)=>{var{word:o,width:l}=s,c=a[a.length-1];if(c&&l!=null&&(e==null||n||c.width+l+r<Number(e)))c.words.push(o),c.width+=l+r;else{var u={words:[o],width:l};a.push(u)}return a},[]),$ce=t=>t.reduce((e,r)=>e.width>r.width?e:r),net="",Wq=(t,e,r,n,a,s,o,l)=>{var c=t.slice(0,e),u=Vce({breakAll:r,style:n,children:c+net});if(!u)return[!1,[]];var d=Hce(u.wordsWithComputedWidth,s,o,l),f=d.length>a||$ce(d).width>Number(s);return[f,d]},aet=(t,e,r,n,a)=>{var{maxLines:s,children:o,style:l,breakAll:c}=t,u=rn(s),d=String(o),f=Hce(e,n,r,a);if(!u||a)return f;var A=f.length>s||$ce(f).width>Number(n);if(!A)return f;for(var h=0,m=d.length-1,p=0,g;h<=m&&p<=d.length-1;){var v=Math.floor((h+m)/2),y=v-1,[b,w]=Wq(d,y,c,l,s,n,r,a),[j]=Wq(d,v,c,l,s,n,r,a);if(!b&&!j&&(h=v+1),b&&j&&(m=v-1),!b&&j){g=w;break}p++}return g||f},Xq=t=>{var e=Qo(t)?[]:t.toString().split(Qce);return[{words:e,width:void 0}]},set=t=>{var{width:e,scaleToFit:r,children:n,style:a,breakAll:s,maxLines:o}=t;if((e||r)&&!OP.isSsr){var l,c,u=Vce({breakAll:s,children:n,style:a});if(u){var{wordsWithComputedWidth:d,spaceWidth:f}=u;l=d,c=f}else return Xq(n);return aet({breakAll:s,children:n,maxLines:o,style:a},l,c,e,!!r)}return Xq(n)},Gce="#808080",iet={angle:0,breakAll:!1,capHeight:"0.71em",fill:Gce,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},t4=x.forwardRef((t,e)=>{var r=Al(t,iet),{x:n,y:a,lineHeight:s,capHeight:o,fill:l,scaleToFit:c,textAnchor:u,verticalAnchor:d}=r,f=zq(r,ZZe),A=x.useMemo(()=>set({breakAll:f.breakAll,children:f.children,maxLines:f.maxLines,scaleToFit:c,style:f.style,width:f.width}),[f.breakAll,f.children,f.maxLines,c,f.style,f.width]),{dx:h,dy:m,angle:p,className:g,breakAll:v}=f,y=zq(f,eet);if(!Wf(n)||!Wf(a)||A.length===0)return null;var b=Number(n)+(rn(h)?h:0),w=Number(a)+(rn(m)?m:0);if(!Zs(b)||!Zs(w))return null;var j;switch(d){case"start":j=hB("calc(".concat(o,")"));break;case"middle":j=hB("calc(".concat((A.length-1)/2," * -").concat(s," + (").concat(o," / 2))"));break;default:j=hB("calc(".concat(A.length-1," * -").concat(s,")"));break}var I=[];if(c){var _=A[0].width,{width:S}=f;I.push("scale(".concat(rn(S)&&rn(_)?S/_:1,")"))}return p&&I.push("rotate(".concat(p,", ").concat(b,", ").concat(w,")")),I.length&&(y.transform=I.join(" ")),x.createElement("text",YF({},pd(y),{ref:e,x:b,y:w,className:La("recharts-text",g),textAnchor:u,fill:l.includes("url")?Gce:l}),A.map((E,F)=>{var k=E.words.join(v?"":" ");return x.createElement("tspan",{x:b,dy:F===0?j:s,key:"".concat(k,"-").concat(F)},k)}))});t4.displayName="Text";var oet=["labelRef"],cet=["content"];function Yq(t,e){if(t==null)return{};var r,n,a=uet(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function uet(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Jq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function bi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Jq(Object(r),!0).forEach(function(n){det(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Jq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function det(t,e,r){return(e=fet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fet(t){var e=het(t,"string");return typeof e=="symbol"?e:e+""}function het(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jh(){return jh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},jh.apply(null,arguments)}var Kce=x.createContext(null),Aet=t=>{var{x:e,y:r,upperWidth:n,lowerWidth:a,width:s,height:o,children:l}=t,c=x.useMemo(()=>({x:e,y:r,upperWidth:n,lowerWidth:a,width:s,height:o}),[e,r,n,a,s,o]);return x.createElement(Kce.Provider,{value:c},l)},qce=()=>{var t=x.useContext(Kce),e=PP();return t||ooe(e)},met=x.createContext(null),pet=()=>{var t=x.useContext(met),e=Jr(Dle);return t||e},get=t=>{var{value:e,formatter:r}=t,n=Qo(t.children)?e:t.children;return typeof r=="function"?r(n):n},fM=t=>t!=null&&typeof t=="function",xet=(t,e)=>{var r=dl(e-t),n=Math.min(Math.abs(e-t),360);return r*n},vet=(t,e,r,n,a)=>{var{offset:s,className:o}=t,{cx:l,cy:c,innerRadius:u,outerRadius:d,startAngle:f,endAngle:A,clockWise:h}=a,m=(u+d)/2,p=xet(f,A),g=p>=0?1:-1,v,y;switch(e){case"insideStart":v=f+g*s,y=h;break;case"insideEnd":v=A-g*s,y=!h;break;case"end":v=A+g*s,y=h;break;default:throw new Error("Unsupported position ".concat(e))}y=p<=0?y:!y;var b=Hi(l,c,m,v),w=Hi(l,c,m,v+(y?1:-1)*359),j="M".concat(b.x,",").concat(b.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(y?0:1,`,
    `).concat(w.x,",").concat(w.y),I=Qo(t.id)?U2("recharts-radial-line-"):t.id;return x.createElement("text",jh({},n,{dominantBaseline:"central",className:La("recharts-radial-bar-label",o)}),x.createElement("defs",null,x.createElement("path",{id:I,d:j})),x.createElement("textPath",{xlinkHref:"#".concat(I)},r))},yet=(t,e,r)=>{var{cx:n,cy:a,innerRadius:s,outerRadius:o,startAngle:l,endAngle:c}=t,u=(l+c)/2;if(r==="outside"){var{x:d,y:f}=Hi(n,a,o+e,u);return{x:d,y:f,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var A=(s+o)/2,{x:h,y:m}=Hi(n,a,A,u);return{x:h,y:m,textAnchor:"middle",verticalAnchor:"middle"}},JF=t=>"cx"in t&&rn(t.cx),bet=(t,e)=>{var{parentViewBox:r,offset:n,position:a}=t,s;r!=null&&!JF(r)&&(s=r);var{x:o,y:l,upperWidth:c,lowerWidth:u,height:d}=e,f=o,A=o+(c-u)/2,h=(f+A)/2,m=(c+u)/2,p=f+c/2,g=d>=0?1:-1,v=g*n,y=g>0?"end":"start",b=g>0?"start":"end",w=c>=0?1:-1,j=w*n,I=w>0?"end":"start",_=w>0?"start":"end";if(a==="top"){var S={x:f+c/2,y:l-v,textAnchor:"middle",verticalAnchor:y};return bi(bi({},S),s?{height:Math.max(l-s.y,0),width:c}:{})}if(a==="bottom"){var E={x:A+u/2,y:l+d+v,textAnchor:"middle",verticalAnchor:b};return bi(bi({},E),s?{height:Math.max(s.y+s.height-(l+d),0),width:u}:{})}if(a==="left"){var F={x:h-j,y:l+d/2,textAnchor:I,verticalAnchor:"middle"};return bi(bi({},F),s?{width:Math.max(F.x-s.x,0),height:d}:{})}if(a==="right"){var k={x:h+m+j,y:l+d/2,textAnchor:_,verticalAnchor:"middle"};return bi(bi({},k),s?{width:Math.max(s.x+s.width-k.x,0),height:d}:{})}var P=s?{width:m,height:d}:{};return a==="insideLeft"?bi({x:h+j,y:l+d/2,textAnchor:_,verticalAnchor:"middle"},P):a==="insideRight"?bi({x:h+m-j,y:l+d/2,textAnchor:I,verticalAnchor:"middle"},P):a==="insideTop"?bi({x:f+c/2,y:l+v,textAnchor:"middle",verticalAnchor:b},P):a==="insideBottom"?bi({x:A+u/2,y:l+d-v,textAnchor:"middle",verticalAnchor:y},P):a==="insideTopLeft"?bi({x:f+j,y:l+v,textAnchor:_,verticalAnchor:b},P):a==="insideTopRight"?bi({x:f+c-j,y:l+v,textAnchor:I,verticalAnchor:b},P):a==="insideBottomLeft"?bi({x:A+j,y:l+d-v,textAnchor:_,verticalAnchor:y},P):a==="insideBottomRight"?bi({x:A+u-j,y:l+d-v,textAnchor:I,verticalAnchor:y},P):a&&typeof a=="object"&&(rn(a.x)||lA(a.x))&&(rn(a.y)||lA(a.y))?bi({x:o+Ll(a.x,m),y:l+Ll(a.y,d),textAnchor:"end",verticalAnchor:"end"},P):bi({x:p,y:l+d/2,textAnchor:"middle",verticalAnchor:"middle"},P)},wet={angle:0,offset:5,zIndex:Rl.label,position:"middle",textBreakAll:!1};function g0(t){var e=Al(t,wet),{viewBox:r,position:n,value:a,children:s,content:o,className:l="",textBreakAll:c,labelRef:u}=e,d=pet(),f=qce(),A=n==="center"?f:d??f,h,m,p;if(r==null?h=A:JF(r)?h=r:h=ooe(r),!h||Qo(a)&&Qo(s)&&!x.isValidElement(o)&&typeof o!="function")return null;var g=bi(bi({},e),{},{viewBox:h});if(x.isValidElement(o)){var{labelRef:v}=g,y=Yq(g,oet);return x.cloneElement(o,y)}if(typeof o=="function"){var{content:b}=g,w=Yq(g,cet);if(m=x.createElement(o,w),x.isValidElement(m))return m}else m=get(e);var j=pd(e);if(JF(h)){if(n==="insideStart"||n==="insideEnd"||n==="end")return vet(e,n,m,j,h);p=yet(h,e.offset,e.position)}else p=bet(e,h);return x.createElement(nh,{zIndex:e.zIndex},x.createElement(t4,jh({ref:u,className:La("recharts-label",l)},j,p,{textAnchor:ret(j.textAnchor)?j.textAnchor:p.textAnchor,breakAll:c}),m))}g0.displayName="Label";var Net=(t,e,r)=>{if(!t)return null;var n={viewBox:e,labelRef:r};return t===!0?x.createElement(g0,jh({key:"label-implicit"},n)):Wf(t)?x.createElement(g0,jh({key:"label-implicit",value:t},n)):x.isValidElement(t)?t.type===g0?x.cloneElement(t,bi({key:"label-implicit"},n)):x.createElement(g0,jh({key:"label-implicit",content:t},n)):fM(t)?x.createElement(g0,jh({key:"label-implicit",content:t},n)):t&&typeof t=="object"?x.createElement(g0,jh({},t,{key:"label-implicit"},n)):null};function Cet(t){var{label:e,labelRef:r}=t,n=qce();return Net(e,n,r)||null}var zce={},Wce={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r[r.length-1]}t.last=e})(Wce);var Xce={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Array.isArray(r)?r:Array.from(r)}t.toArray=e})(Xce);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Wce,r=Xce,n=hP;function a(s){if(n.isArrayLike(s))return e.last(r.toArray(s))}t.last=a})(zce);var _et=zce.last;const Eet=mA(_et);var Iet=["valueAccessor"],jet=["dataKey","clockWise","id","textBreakAll","zIndex"];function kI(){return kI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},kI.apply(null,arguments)}function Zq(t,e){if(t==null)return{};var r,n,a=Pet(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Pet(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Bet=t=>Array.isArray(t.value)?Eet(t.value):t.value,Yce=x.createContext(void 0),Tet=Yce.Provider,Jce=x.createContext(void 0),ket=Jce.Provider;function Fet(){return x.useContext(Yce)}function Oet(){return x.useContext(Jce)}function AE(t){var{valueAccessor:e=Bet}=t,r=Zq(t,Iet),{dataKey:n,clockWise:a,id:s,textBreakAll:o,zIndex:l}=r,c=Zq(r,jet),u=Fet(),d=Oet(),f=u||d;return!f||!f.length?null:x.createElement(nh,{zIndex:l??Rl.label},x.createElement(fc,{className:"recharts-label-list"},f.map((A,h)=>{var m,p=Qo(n)?e(A,h):ps(A&&A.payload,n),g=Qo(s)?{}:{id:"".concat(s,"-").concat(h)};return x.createElement(g0,kI({key:"label-".concat(h)},pd(A),c,g,{fill:(m=r.fill)!==null&&m!==void 0?m:A.fill,parentViewBox:A.parentViewBox,value:p,textBreakAll:o,viewBox:A.viewBox,index:h,zIndex:0}))})))}AE.displayName="LabelList";function Zce(t){var{label:e}=t;return e?e===!0?x.createElement(AE,{key:"labelList-implicit"}):x.isValidElement(e)||fM(e)?x.createElement(AE,{key:"labelList-implicit",content:e}):typeof e=="object"?x.createElement(AE,kI({key:"labelList-implicit"},e,{type:String(e.type)})):null:null}var eue=t=>t.graphicalItems.polarItems,Det=qt([ks,Yw],O8),r4=qt([eue,ei,Det],R8),Ret=qt([r4],M8),n4=qt([Ret,$P],L8),Met=qt([n4,ei,r4],Q8);qt([n4,ei,r4],(t,e,r)=>r.length>0?t.flatMap(n=>r.flatMap(a=>{var s,o=ps(n,(s=e.dataKey)!==null&&s!==void 0?s:a.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):(e==null?void 0:e.dataKey)!=null?t.map(n=>({value:ps(n,e.dataKey),errorDomain:[]})):t.map(n=>({value:n,errorDomain:[]})));var ez=()=>{},Let=qt([n4,ei,r4,YP,ks],G8),Uet=qt([ei,H8,$8,ez,Let,ez,Aa,ks],K8),tue=qt([ei,Aa,n4,Met,Xw,ks,Uet],q8),Qet=qt([tue,ei,b1],X8);qt([ei,tue,Qet,ks],J8);var Vet={radiusAxis:{},angleAxis:{}},rue=Vc({name:"polarAxis",initialState:Vet,reducers:{addRadiusAxis(t,e){t.radiusAxis[e.payload.id]=e.payload},removeRadiusAxis(t,e){delete t.radiusAxis[e.payload.id]},addAngleAxis(t,e){t.angleAxis[e.payload.id]=e.payload},removeAngleAxis(t,e){delete t.angleAxis[e.payload.id]}}}),{addRadiusAxis:yit,removeRadiusAxis:bit,addAngleAxis:wit,removeAngleAxis:Nit}=rue.actions,Het=rue.reducer;function tz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function rz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tz(Object(r),!0).forEach(function(n){$et(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $et(t,e,r){return(e=Get(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Get(t){var e=Ket(t,"string");return typeof e=="symbol"?e:e+""}function Ket(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var qet=(t,e)=>e,hM=qt([eue,qet],(t,e)=>t.filter(r=>r.type==="pie").find(r=>r.id===e)),zet=[],AM=(t,e,r)=>(r==null?void 0:r.length)===0?zet:r,nue=qt([$P,hM,AM],(t,e,r)=>{var{chartData:n}=t;if(e!=null){var a;if((e==null?void 0:e.data)!=null&&e.data.length>0?a=e.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(s=>rz(rz({},e.presentationProps),s.props))),a!=null)return a}}),Wet=qt([nue,hM,AM],(t,e,r)=>{if(!(t==null||e==null))return t.map((n,a)=>{var s,o=ps(n,e.nameKey,e.name),l;return r!=null&&(s=r[a])!==null&&s!==void 0&&(s=s.props)!==null&&s!==void 0&&s.fill?l=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=e.fill,{value:_P(o,e.dataKey),color:l,payload:n,type:e.legendType}})}),Xet=qt([nue,hM,AM,go],(t,e,r,n)=>{if(!(e==null||t==null))return Jtt({offset:n,pieSettings:e,displayedData:t,cells:r})}),aue={exports:{}},Za={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mM=Symbol.for("react.transitional.element"),pM=Symbol.for("react.portal"),a4=Symbol.for("react.fragment"),s4=Symbol.for("react.strict_mode"),i4=Symbol.for("react.profiler"),o4=Symbol.for("react.consumer"),l4=Symbol.for("react.context"),c4=Symbol.for("react.forward_ref"),u4=Symbol.for("react.suspense"),d4=Symbol.for("react.suspense_list"),f4=Symbol.for("react.memo"),h4=Symbol.for("react.lazy"),Yet=Symbol.for("react.view_transition"),Jet=Symbol.for("react.client.reference");function Nd(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case mM:switch(t=t.type,t){case a4:case i4:case s4:case u4:case d4:case Yet:return t;default:switch(t=t&&t.$$typeof,t){case l4:case c4:case h4:case f4:return t;case o4:return t;default:return e}}case pM:return e}}}Za.ContextConsumer=o4;Za.ContextProvider=l4;Za.Element=mM;Za.ForwardRef=c4;Za.Fragment=a4;Za.Lazy=h4;Za.Memo=f4;Za.Portal=pM;Za.Profiler=i4;Za.StrictMode=s4;Za.Suspense=u4;Za.SuspenseList=d4;Za.isContextConsumer=function(t){return Nd(t)===o4};Za.isContextProvider=function(t){return Nd(t)===l4};Za.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===mM};Za.isForwardRef=function(t){return Nd(t)===c4};Za.isFragment=function(t){return Nd(t)===a4};Za.isLazy=function(t){return Nd(t)===h4};Za.isMemo=function(t){return Nd(t)===f4};Za.isPortal=function(t){return Nd(t)===pM};Za.isProfiler=function(t){return Nd(t)===i4};Za.isStrictMode=function(t){return Nd(t)===s4};Za.isSuspense=function(t){return Nd(t)===u4};Za.isSuspenseList=function(t){return Nd(t)===d4};Za.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===a4||t===i4||t===s4||t===u4||t===d4||typeof t=="object"&&t!==null&&(t.$$typeof===h4||t.$$typeof===f4||t.$$typeof===l4||t.$$typeof===o4||t.$$typeof===c4||t.$$typeof===Jet||t.getModuleId!==void 0)};Za.typeOf=Nd;aue.exports=Za;var Zet=aue.exports,nz=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",az=null,AB=null,sue=t=>{if(t===az&&Array.isArray(AB))return AB;var e=[];return x.Children.forEach(t,r=>{Qo(r)||(Zet.isFragment(r)?e=e.concat(sue(r.props.children)):e.push(r))}),AB=e,az=t,e};function gM(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(a=>nz(a)):n=[nz(e)],sue(t).forEach(a=>{var s=cg(a,"type.displayName")||cg(a,"type.name");s&&n.indexOf(s)!==-1&&r.push(a)}),r}var iue={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){var a;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const s=r[Symbol.toStringTag];return s==null||!((a=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&a.writable)?!1:r.toString()===`[object ${s}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}t.isPlainObject=e})(iue);var ett=iue.isPlainObject;const ttt=mA(ett);var sz,iz,oz,lz,cz;function uz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function dz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?uz(Object(r),!0).forEach(function(n){rtt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):uz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function rtt(t,e,r){return(e=ntt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ntt(t){var e=att(t,"string");return typeof e=="symbol"?e:e+""}function att(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FI(){return FI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},FI.apply(null,arguments)}function wy(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var fz=(t,e,r,n,a)=>{var s=r-n,o;return o=oi(sz||(sz=wy(["M ",",",""])),t,e),o+=oi(iz||(iz=wy(["L ",",",""])),t+r,e),o+=oi(oz||(oz=wy(["L ",",",""])),t+r-s/2,e+a),o+=oi(lz||(lz=wy(["L ",",",""])),t+r-s/2-n,e+a),o+=oi(cz||(cz=wy(["L ",","," Z"])),t,e),o},stt={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},itt=t=>{var e=Al(t,stt),{x:r,y:n,upperWidth:a,lowerWidth:s,height:o,className:l}=e,{animationEasing:c,animationDuration:u,animationBegin:d,isUpdateAnimationActive:f}=e,A=x.useRef(null),[h,m]=x.useState(-1),p=x.useRef(a),g=x.useRef(s),v=x.useRef(o),y=x.useRef(r),b=x.useRef(n),w=RP(t,"trapezoid-");if(x.useEffect(()=>{if(A.current&&A.current.getTotalLength)try{var X=A.current.getTotalLength();X&&m(X)}catch{}},[]),r!==+r||n!==+n||a!==+a||s!==+s||o!==+o||a===0&&s===0||o===0)return null;var j=La("recharts-trapezoid",l);if(!f)return x.createElement("g",null,x.createElement("path",FI({},pd(e),{className:j,d:fz(r,n,a,s,o)})));var I=p.current,_=g.current,S=v.current,E=y.current,F=b.current,k="0px ".concat(h===-1?1:h,"px"),P="".concat(h,"px 0px"),D=boe(["strokeDasharray"],u,c);return x.createElement(DP,{animationId:w,key:w,canBegin:h>0,duration:u,easing:c,isActive:f,begin:d},X=>{var pe=so(I,a,X),ge=so(_,s,X),fe=so(S,o,X),xe=so(E,r,X),ae=so(F,n,X);A.current&&(p.current=pe,g.current=ge,v.current=fe,y.current=xe,b.current=ae);var Se=X>0?{transition:D,strokeDasharray:P}:{strokeDasharray:k};return x.createElement("path",FI({},pd(e),{className:j,d:fz(xe,ae,pe,ge,fe),ref:A,style:dz(dz({},Se),e.style)}))})},ott=["option","shapeType","activeClassName"];function ltt(t,e){if(t==null)return{};var r,n,a=ctt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function ctt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function hz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function OI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?hz(Object(r),!0).forEach(function(n){utt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function utt(t,e,r){return(e=dtt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dtt(t){var e=ftt(t,"string");return typeof e=="symbol"?e:e+""}function ftt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function htt(t,e){return OI(OI({},e),t)}function Att(t,e){return t==="symbols"}function Az(t){var{shapeType:e,elementProps:r}=t;switch(e){case"rectangle":return x.createElement(_oe,r);case"trapezoid":return x.createElement(itt,r);case"sector":return x.createElement(joe,r);case"symbols":if(Att(e))return x.createElement(TR,r);break;case"curve":return x.createElement(t8,r);default:return null}}function mtt(t){return x.isValidElement(t)?t.props:t}function oue(t){var{option:e,shapeType:r,activeClassName:n="recharts-active-shape"}=t,a=ltt(t,ott),s;if(x.isValidElement(e))s=x.cloneElement(e,OI(OI({},a),mtt(e)));else if(typeof e=="function")s=e(a,a.index);else if(ttt(e)&&typeof e!="boolean"){var o=htt(e,a);s=x.createElement(Az,{shapeType:r,elementProps:o})}else{var l=a;s=x.createElement(Az,{shapeType:r,elementProps:l})}return a.isActive?x.createElement(fc,{className:n},s):s}var xM=(t,e,r)=>{var n=os();return(a,s)=>o=>{t==null||t(a,s,o),n(hce({activeIndex:String(s),activeDataKey:e,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}},vM=t=>{var e=os();return(r,n)=>a=>{t==null||t(r,n,a),e(SYe())}},yM=(t,e,r)=>{var n=os();return(a,s)=>o=>{t==null||t(a,s,o),n(IYe({activeIndex:String(s),activeDataKey:e,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}};function lue(t){var{tooltipEntrySettings:e}=t,r=os(),n=_u(),a=x.useRef(null);return x.useLayoutEffect(()=>{n||(a.current===null?r(NYe(e)):a.current!==e&&r(CYe({prev:a.current,next:e})),a.current=e)},[e,r,n]),x.useLayoutEffect(()=>()=>{a.current&&(r(_Ye(a.current)),a.current=null)},[r]),null}function ptt(t){var{legendPayload:e}=t,r=os(),n=_u(),a=x.useRef(null);return x.useLayoutEffect(()=>{n||(a.current===null?r(goe(e)):a.current!==e&&r(xoe({prev:a.current,next:e})),a.current=e)},[r,n,e]),x.useLayoutEffect(()=>()=>{a.current&&(r(voe(a.current)),a.current=null)},[r]),null}function gtt(t){var{legendPayload:e}=t,r=os(),n=Jr(Aa),a=x.useRef(null);return x.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(a.current===null?r(goe(e)):a.current!==e&&r(xoe({prev:a.current,next:e})),a.current=e)},[r,n,e]),x.useLayoutEffect(()=>()=>{a.current&&(r(voe(a.current)),a.current=null)},[r]),null}var mB,xtt=()=>{var[t]=x.useState(()=>U2("uid-"));return t},vtt=(mB=Kde.useId)!==null&&mB!==void 0?mB:xtt;function ytt(t,e){var r=vtt();return e||(t?"".concat(t,"-").concat(r):r)}var btt=x.createContext(void 0),cue=t=>{var{id:e,type:r,children:n}=t,a=ytt("recharts-".concat(r),e);return x.createElement(btt.Provider,{value:a},n(a))},wtt={cartesianItems:[],polarItems:[]},uue=Vc({name:"graphicalItems",initialState:wtt,reducers:{addCartesianGraphicalItem:{reducer(t,e){t.cartesianItems.push(e.payload)},prepare:Ns()},replaceCartesianGraphicalItem:{reducer(t,e){var{prev:r,next:n}=e.payload,a=rf(t).cartesianItems.indexOf(r);a>-1&&(t.cartesianItems[a]=n)},prepare:Ns()},removeCartesianGraphicalItem:{reducer(t,e){var r=rf(t).cartesianItems.indexOf(e.payload);r>-1&&t.cartesianItems.splice(r,1)},prepare:Ns()},addPolarGraphicalItem:{reducer(t,e){t.polarItems.push(e.payload)},prepare:Ns()},removePolarGraphicalItem:{reducer(t,e){var r=rf(t).polarItems.indexOf(e.payload);r>-1&&t.polarItems.splice(r,1)},prepare:Ns()}}}),{addCartesianGraphicalItem:Ntt,replaceCartesianGraphicalItem:Ctt,removeCartesianGraphicalItem:_tt,addPolarGraphicalItem:Ett,removePolarGraphicalItem:Stt}=uue.actions,Itt=uue.reducer,jtt=t=>{var e=os(),r=x.useRef(null);return x.useLayoutEffect(()=>{r.current===null?e(Ntt(t)):r.current!==t&&e(Ctt({prev:r.current,next:t})),r.current=t},[e,t]),x.useLayoutEffect(()=>()=>{r.current&&(e(_tt(r.current)),r.current=null)},[e]),null},Ptt=x.memo(jtt);function Btt(t){var e=os();return x.useLayoutEffect(()=>(e(Ett(t)),()=>{e(Stt(t))}),[e,t]),null}var Ttt=["key"],ktt=["onMouseEnter","onClick","onMouseLeave"],Ftt=["id"],Ott=["id"];function mz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ui(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?mz(Object(r),!0).forEach(function(n){Dtt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):mz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Dtt(t,e,r){return(e=Rtt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rtt(t){var e=Mtt(t,"string");return typeof e=="symbol"?e:e+""}function Mtt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vm(){return vm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},vm.apply(null,arguments)}function A4(t,e){if(t==null)return{};var r,n,a=Ltt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Ltt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Utt(t){var e=x.useMemo(()=>gM(t.children,sN),[t.children]),r=Jr(n=>Wet(n,t.id,e));return r==null?null:x.createElement(gtt,{legendPayload:r})}var Qtt=x.memo(t=>{var{dataKey:e,nameKey:r,sectors:n,stroke:a,strokeWidth:s,fill:o,name:l,hide:c,tooltipType:u,id:d}=t,f={dataDefinedOnItem:n.map(A=>A.tooltipPayload),positions:n.map(A=>A.tooltipPosition),settings:{stroke:a,strokeWidth:s,fill:o,dataKey:e,nameKey:r,name:_P(l,e),hide:c,type:u,color:o,unit:"",graphicalItemId:d}};return x.createElement(lue,{tooltipEntrySettings:f})}),Vtt=(t,e)=>t>e?"start":t<e?"end":"middle",Htt=(t,e,r)=>Ll(typeof e=="function"?e(t):e,r,r*.8),$tt=(t,e,r)=>{var{top:n,left:a,width:s,height:o}=e,l=Eoe(s,o),c=a+Ll(t.cx,s,s/2),u=n+Ll(t.cy,o,o/2),d=Ll(t.innerRadius,l,0),f=Htt(r,t.outerRadius,l),A=t.maxRadius||Math.sqrt(s*s+o*o)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:f,maxRadius:A}},Gtt=(t,e)=>{var r=dl(e-t),n=Math.min(Math.abs(e-t),360);return r*n};function Ktt(t){return t&&typeof t=="object"&&"className"in t&&typeof t.className=="string"?t.className:""}var qtt=(t,e)=>{if(x.isValidElement(t))return x.cloneElement(t,e);if(typeof t=="function")return t(e);var r=La("recharts-pie-label-line",typeof t!="boolean"?t.className:""),{key:n}=e,a=A4(e,Ttt);return x.createElement(t8,vm({},a,{type:"linear",className:r}))},ztt=(t,e,r)=>{if(x.isValidElement(t))return x.cloneElement(t,e);var n=r;if(typeof t=="function"&&(n=t(e),x.isValidElement(n)))return n;var a=La("recharts-pie-label-text",Ktt(t));return x.createElement(t4,vm({},e,{alignmentBaseline:"middle",className:a}),n)};function Wtt(t){var{sectors:e,props:r,showLabels:n}=t,{label:a,labelLine:s,dataKey:o}=r;if(!n||!a||!e)return null;var l=qf(r),c=L2(a),u=L2(s),d=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,f=e.map((A,h)=>{var m=(A.startAngle+A.endAngle)/2,p=Hi(A.cx,A.cy,A.outerRadius+d,m),g=ui(ui(ui(ui({},l),A),{},{stroke:"none"},c),{},{index:h,textAnchor:Vtt(p.x,A.cx)},p),v=ui(ui(ui(ui({},l),A),{},{fill:"none",stroke:A.fill},u),{},{index:h,points:[Hi(A.cx,A.cy,A.outerRadius,m),p],key:"line"});return x.createElement(nh,{zIndex:Rl.label,key:"label-".concat(A.startAngle,"-").concat(A.endAngle,"-").concat(A.midAngle,"-").concat(h)},x.createElement(fc,null,s&&qtt(s,v),ztt(a,g,ps(A,o))))});return x.createElement(fc,{className:"recharts-pie-labels"},f)}function Xtt(t){var{sectors:e,props:r,showLabels:n}=t,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?x.createElement(Zce,{label:a}):x.createElement(Wtt,{sectors:e,props:r,showLabels:n})}function Ytt(t){var{sectors:e,activeShape:r,inactiveShape:n,allOtherPieProps:a,shape:s,id:o}=t,l=Jr(Ag),c=Jr(oM),u=Jr(hJe),{onMouseEnter:d,onClick:f,onMouseLeave:A}=a,h=A4(a,ktt),m=xM(d,a.dataKey,o),p=vM(A),g=yM(f,a.dataKey,o);return e==null||e.length===0?null:x.createElement(x.Fragment,null,e.map((v,y)=>{if((v==null?void 0:v.startAngle)===0&&(v==null?void 0:v.endAngle)===0&&e.length!==1)return null;var b=u==null||u===o,w=String(y)===l&&(c==null||a.dataKey===c)&&b,j=l?n:null,I=r&&w?r:j,_=ui(ui({},v),{},{stroke:v.stroke,tabIndex:-1,[Zie]:y,[eoe]:o});return x.createElement(fc,vm({key:"sector-".concat(v==null?void 0:v.startAngle,"-").concat(v==null?void 0:v.endAngle,"-").concat(v.midAngle,"-").concat(y),tabIndex:-1,className:"recharts-pie-sector"},Uw(h,v,y),{onMouseEnter:m(v,y),onMouseLeave:p(v,y),onClick:g(v,y)}),x.createElement(oue,vm({option:s??I,index:y,shapeType:"sector",isActive:w},_)))}))}function Jtt(t){var e,{pieSettings:r,displayedData:n,cells:a,offset:s}=t,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:u,nameKey:d,tooltipType:f}=r,A=Math.abs(r.minAngle),h=Gtt(l,c),m=Math.abs(h),p=n.length<=1?0:(e=r.paddingAngle)!==null&&e!==void 0?e:0,g=n.filter(I=>ps(I,u,0)!==0).length,v=(m>=360?g:g-1)*p,y=m-g*A-v,b=n.reduce((I,_)=>{var S=ps(_,u,0);return I+(rn(S)?S:0)},0),w;if(b>0){var j;w=n.map((I,_)=>{var S=ps(I,u,0),E=ps(I,d,_),F=$tt(r,s,I),k=(rn(S)?S:0)/b,P,D=ui(ui({},I),a&&a[_]&&a[_].props);_?P=j.endAngle+dl(h)*p*(S!==0?1:0):P=l;var X=P+dl(h)*((S!==0?A:0)+k*y),pe=(P+X)/2,ge=(F.innerRadius+F.outerRadius)/2,fe=[{name:E,value:S,payload:D,dataKey:u,type:f,graphicalItemId:r.id}],xe=Hi(F.cx,F.cy,ge,pe);return j=ui(ui(ui(ui({},r.presentationProps),{},{percent:k,cornerRadius:typeof o=="string"?parseFloat(o):o,name:E,tooltipPayload:fe,midAngle:pe,middleRadius:ge,tooltipPosition:xe},D),F),{},{value:S,dataKey:u,startAngle:P,endAngle:X,payload:D,paddingAngle:dl(h)*p}),j})}return w}function Ztt(t){var{showLabels:e,sectors:r,children:n}=t,a=x.useMemo(()=>!e||!r?[]:r.map(s=>({value:s.value,payload:s.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:s.cx,cy:s.cy,innerRadius:s.innerRadius,outerRadius:s.outerRadius,startAngle:s.startAngle,endAngle:s.endAngle,clockWise:!1},fill:s.fill})),[r,e]);return x.createElement(ket,{value:e?a:void 0},n)}function ert(t){var{props:e,previousSectorsRef:r,id:n}=t,{sectors:a,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,activeShape:u,inactiveShape:d,onAnimationStart:f,onAnimationEnd:A}=e,h=RP(e,"recharts-pie-"),m=r.current,[p,g]=x.useState(!1),v=x.useCallback(()=>{typeof A=="function"&&A(),g(!1)},[A]),y=x.useCallback(()=>{typeof f=="function"&&f(),g(!0)},[f]);return x.createElement(Ztt,{showLabels:!p,sectors:a},x.createElement(DP,{animationId:h,begin:o,duration:l,isActive:s,easing:c,onAnimationStart:y,onAnimationEnd:v,key:h},b=>{var w=[],j=a&&a[0],I=j==null?void 0:j.startAngle;return a==null||a.forEach((_,S)=>{var E=m&&m[S],F=S>0?cg(_,"paddingAngle",0):0;if(E){var k=so(E.endAngle-E.startAngle,_.endAngle-_.startAngle,b),P=ui(ui({},_),{},{startAngle:I+F,endAngle:I+k+F});w.push(P),I=P.endAngle}else{var{endAngle:D,startAngle:X}=_,pe=so(0,D-X,b),ge=ui(ui({},_),{},{startAngle:I+F,endAngle:I+pe+F});w.push(ge),I=ge.endAngle}}),r.current=w,x.createElement(fc,null,x.createElement(Ytt,{sectors:w,activeShape:u,inactiveShape:d,allOtherPieProps:e,shape:e.shape,id:n}))}),x.createElement(Xtt,{showLabels:!p,sectors:a,props:e}),e.children)}var trt={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:Rl.area};function rrt(t){var{id:e}=t,r=A4(t,Ftt),{hide:n,className:a,rootTabIndex:s}=t,o=x.useMemo(()=>gM(t.children,sN),[t.children]),l=Jr(d=>Xet(d,e,o)),c=x.useRef(null),u=La("recharts-pie",a);return n||l==null?(c.current=null,x.createElement(fc,{tabIndex:s,className:u})):x.createElement(nh,{zIndex:t.zIndex},x.createElement(Qtt,{dataKey:t.dataKey,nameKey:t.nameKey,sectors:l,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,tooltipType:t.tooltipType,id:e}),x.createElement(fc,{tabIndex:s,className:u},x.createElement(ert,{props:ui(ui({},r),{},{sectors:l}),previousSectorsRef:c,id:e})))}function due(t){var e=Al(t,trt),{id:r}=e,n=A4(e,Ott),a=qf(n);return x.createElement(cue,{id:r,type:"pie"},s=>x.createElement(x.Fragment,null,x.createElement(Btt,{type:"pie",id:s,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:e.maxRadius}),x.createElement(Utt,vm({},n,{id:s})),x.createElement(rrt,vm({},n,{id:s}))))}due.displayName="Pie";function pz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function gz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pz(Object(r),!0).forEach(function(n){nrt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function nrt(t,e,r){return(e=art(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function art(t){var e=srt(t,"string");return typeof e=="symbol"?e:e+""}function srt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var fue=0,irt={xAxis:{},yAxis:{},zAxis:{}},hue=Vc({name:"cartesianAxis",initialState:irt,reducers:{addXAxis:{reducer(t,e){t.xAxis[e.payload.id]=e.payload},prepare:Ns()},replaceXAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.xAxis[r.id],t.xAxis[n.id]=n)},prepare:Ns()},removeXAxis:{reducer(t,e){delete t.xAxis[e.payload.id]},prepare:Ns()},addYAxis:{reducer(t,e){t.yAxis[e.payload.id]=e.payload},prepare:Ns()},replaceYAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.yAxis[r.id],t.yAxis[n.id]=n)},prepare:Ns()},removeYAxis:{reducer(t,e){delete t.yAxis[e.payload.id]},prepare:Ns()},addZAxis:{reducer(t,e){t.zAxis[e.payload.id]=e.payload},prepare:Ns()},replaceZAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.zAxis[r.id],t.zAxis[n.id]=n)},prepare:Ns()},removeZAxis:{reducer(t,e){delete t.zAxis[e.payload.id]},prepare:Ns()},updateYAxisWidth(t,e){var{id:r,width:n}=e.payload,a=t.yAxis[r];if(a){var s=a.widthHistory||[];if(s.length===3&&s[0]===s[2]&&n===s[1]&&n!==a.width&&Math.abs(n-s[0])<=1)return;var o=[...s,n].slice(-3);t.yAxis[r]=gz(gz({},t.yAxis[r]),{},{width:n,widthHistory:o})}}}}),{addXAxis:ort,replaceXAxis:lrt,removeXAxis:crt,addYAxis:urt,replaceYAxis:drt,removeYAxis:frt,addZAxis:Cit,replaceZAxis:_it,removeZAxis:Eit,updateYAxisWidth:hrt}=hue.actions,Art=hue.reducer,mrt=qt([go],t=>({top:t.top,bottom:t.bottom,left:t.left,right:t.right})),prt=qt([mrt,_A,EA],(t,e,r)=>{if(!(!t||e==null||r==null))return{x:t.left,y:t.top,width:Math.max(0,e-t.left-t.right),height:Math.max(0,r-t.top-t.bottom)}}),Aue=()=>Jr(prt),xz=(t,e,r)=>{var n=r??t;if(!Qo(n))return Ll(n,e,0)},grt=(t,e,r)=>{var n={},a=t.filter(qP),s=t.filter(u=>u.stackId==null),o=a.reduce((u,d)=>(u[d.stackId]||(u[d.stackId]=[]),u[d.stackId].push(d),u),n),l=Object.entries(o).map(u=>{var[d,f]=u,A=f.map(m=>m.dataKey),h=xz(e,r,f[0].barSize);return{stackId:d,dataKeys:A,barSize:h}}),c=s.map(u=>{var d=[u.dataKey].filter(A=>A!=null),f=xz(e,r,u.barSize);return{stackId:void 0,dataKeys:d,barSize:f}});return[...l,...c]};function vz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function v_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vz(Object(r),!0).forEach(function(n){xrt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function xrt(t,e,r){return(e=vrt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vrt(t){var e=yrt(t,"string");return typeof e=="symbol"?e:e+""}function yrt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function brt(t,e,r,n,a){var s=n.length;if(!(s<1)){var o=Ll(t,r,0,!0),l,c=[];if(Zs(n[0].barSize)){var u=!1,d=r/s,f=n.reduce((v,y)=>v+(y.barSize||0),0);f+=(s-1)*o,f>=r&&(f-=(s-1)*o,o=0),f>=r&&d>0&&(u=!0,d*=.9,f=s*d);var A=(r-f)/2>>0,h={offset:A-o,size:0};l=n.reduce((v,y)=>{var b,w={stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:h.offset+h.size+o,size:u?d:(b=y.barSize)!==null&&b!==void 0?b:0}},j=[...v,w];return h=j[j.length-1].position,j},c)}else{var m=Ll(e,r,0,!0);r-2*m-(s-1)*o<=0&&(o=0);var p=(r-2*m-(s-1)*o)/s;p>1&&(p>>=0);var g=Zs(a)?Math.min(p,a):p;l=n.reduce((v,y,b)=>[...v,{stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:m+(p+o)*b+(p-g)/2,size:g}}],c)}return l}}var wrt=(t,e,r,n,a,s,o)=>{var l=Qo(o)?e:o,c=brt(r,n,a!==s?a:s,t,l);return a!==s&&c!=null&&(c=c.map(u=>v_(v_({},u),{},{position:v_(v_({},u.position),{},{offset:u.position.offset-a/2})}))),c},Nrt=(t,e)=>{var r=k8(e);if(!(!t||r==null||e==null)){var{stackId:n}=e;if(n!=null){var a=t[n];if(a){var{stackedData:s}=a;if(s)return s.find(o=>o.key===r)}}}};function Crt(t,e){return t&&typeof t=="object"&&"zIndex"in t&&typeof t.zIndex=="number"&&Zs(t.zIndex)?t.zIndex:e}var mue=t=>{var{chartData:e}=t,r=os(),n=_u();return x.useEffect(()=>n?()=>{}:(r(Oq(e)),()=>{r(Oq(void 0))}),[e,r,n]),null},yz={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},pue=Vc({name:"brush",initialState:yz,reducers:{setBrushSettings(t,e){return e.payload==null?yz:e.payload}}}),{setBrushSettings:Sit}=pue.actions,_rt=pue.reducer;function Ert(t,e,r){return(e=Srt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Srt(t){var e=Irt(t,"string");return typeof e=="symbol"?e:e+""}function Irt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bM{static create(e){return new bM(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e!==void 0){if(n)switch(n){case"start":return this.scale(e);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+a}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(e)+s}default:return this.scale(e)}if(r){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+o}return this.scale(e)}}isInRange(e){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?e>=n&&e<=a:e>=a&&e<=n}}Ert(bM,"EPS",1e-4);function jrt(t){return(t%180+180)%180}var Prt=function(e){var{width:r,height:n}=e,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=jrt(a),o=s*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},Brt={dots:[],areas:[],lines:[]},gue=Vc({name:"referenceElements",initialState:Brt,reducers:{addDot:(t,e)=>{t.dots.push(e.payload)},removeDot:(t,e)=>{var r=rf(t).dots.findIndex(n=>n===e.payload);r!==-1&&t.dots.splice(r,1)},addArea:(t,e)=>{t.areas.push(e.payload)},removeArea:(t,e)=>{var r=rf(t).areas.findIndex(n=>n===e.payload);r!==-1&&t.areas.splice(r,1)},addLine:(t,e)=>{t.lines.push(e.payload)},removeLine:(t,e)=>{var r=rf(t).lines.findIndex(n=>n===e.payload);r!==-1&&t.lines.splice(r,1)}}}),{addDot:Iit,removeDot:jit,addArea:Pit,removeArea:Bit,addLine:Tit,removeLine:kit}=gue.actions,Trt=gue.reducer,krt=x.createContext(void 0),Frt=t=>{var{children:e}=t,[r]=x.useState("".concat(U2("recharts"),"-clip")),n=Aue();if(n==null)return null;var{x:a,y:s,width:o,height:l}=n;return x.createElement(krt.Provider,{value:r},x.createElement("defs",null,x.createElement("clipPath",{id:r},x.createElement("rect",{x:a,y:s,height:l,width:o}))),e)};function xue(t,e){if(e<1)return[];if(e===1)return t;for(var r=[],n=0;n<t.length;n+=e){var a=t[n];a!==void 0&&r.push(a)}return r}function Ort(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return Prt(n,r)}function Drt(t,e,r){var n=r==="width",{x:a,y:s,width:o,height:l}=t;return e===1?{start:n?a:s,end:n?a+o:s+l}:{start:n?a+o:s+l,end:n?a:s}}function ew(t,e,r,n,a){if(t*e<t*n||t*e>t*a)return!1;var s=r();return t*(e-t*s/2-n)>=0&&t*(e+t*s/2-a)<=0}function Rrt(t,e){return xue(t,e+1)}function Mrt(t,e,r,n,a){for(var s=(n||[]).slice(),{start:o,end:l}=e,c=0,u=1,d=o,f=function(){var m=n==null?void 0:n[c];if(m===void 0)return{v:xue(n,u)};var p=c,g,v=()=>(g===void 0&&(g=r(m,p)),g),y=m.coordinate,b=c===0||ew(t,y,v,d,l);b||(c=0,d=o,u+=1),b&&(d=y+t*(v()/2+a),c+=u)},A;u<=s.length;)if(A=f(),A)return A.v;return[]}function Lrt(t,e,r,n,a){var s=(n||[]).slice(),o=s.length;if(o===0)return[];for(var{start:l,end:c}=e,u=1;u<=o;u++){for(var d=(o-1)%u,f=l,A=!0,h=function(){var y=n[m],b=m,w,j=()=>(w===void 0&&(w=r(y,b)),w),I=y.coordinate,_=m===d||ew(t,I,j,f,c);if(!_)return A=!1,1;_&&(f=I+t*(j()/2+a))},m=d;m<o&&!h();m+=u);if(A){for(var p=[],g=d;g<o;g+=u)p.push(n[g]);return p}}return[]}function bz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Pl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bz(Object(r),!0).forEach(function(n){Urt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Urt(t,e,r){return(e=Qrt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qrt(t){var e=Vrt(t,"string");return typeof e=="symbol"?e:e+""}function Vrt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hrt(t,e,r,n,a){for(var s=(n||[]).slice(),o=s.length,{start:l}=e,{end:c}=e,u=function(A){var h=s[A],m,p=()=>(m===void 0&&(m=r(h,A)),m);if(A===o-1){var g=t*(h.coordinate+t*p()/2-c);s[A]=h=Pl(Pl({},h),{},{tickCoord:g>0?h.coordinate-g*t:h.coordinate})}else s[A]=h=Pl(Pl({},h),{},{tickCoord:h.coordinate});if(h.tickCoord!=null){var v=ew(t,h.tickCoord,p,l,c);v&&(c=h.tickCoord-t*(p()/2+a),s[A]=Pl(Pl({},h),{},{isShow:!0}))}},d=o-1;d>=0;d--)u(d);return s}function $rt(t,e,r,n,a,s){var o=(n||[]).slice(),l=o.length,{start:c,end:u}=e;if(s){var d=n[l-1],f=r(d,l-1),A=t*(d.coordinate+t*f/2-u);if(o[l-1]=d=Pl(Pl({},d),{},{tickCoord:A>0?d.coordinate-A*t:d.coordinate}),d.tickCoord!=null){var h=ew(t,d.tickCoord,()=>f,c,u);h&&(u=d.tickCoord-t*(f/2+a),o[l-1]=Pl(Pl({},d),{},{isShow:!0}))}}for(var m=s?l-1:l,p=function(y){var b=o[y],w,j=()=>(w===void 0&&(w=r(b,y)),w);if(y===0){var I=t*(b.coordinate-t*j()/2-c);o[y]=b=Pl(Pl({},b),{},{tickCoord:I<0?b.coordinate-I*t:b.coordinate})}else o[y]=b=Pl(Pl({},b),{},{tickCoord:b.coordinate});if(b.tickCoord!=null){var _=ew(t,b.tickCoord,j,c,u);_&&(c=b.tickCoord+t*(j()/2+a),o[y]=Pl(Pl({},b),{},{isShow:!0}))}},g=0;g<m;g++)p(g);return o}function Grt(t,e,r){var{tick:n,ticks:a,viewBox:s,minTickGap:o,orientation:l,interval:c,tickFormatter:u,unit:d,angle:f}=t;if(!a||!a.length||!n)return[];if(rn(c)||OP.isSsr){var A;return(A=Rrt(a,rn(c)?c:0))!==null&&A!==void 0?A:[]}var h=[],m=l==="top"||l==="bottom"?"width":"height",p=d&&m==="width"?kb(d,{fontSize:e,letterSpacing:r}):{width:0,height:0},g=(b,w)=>{var j=typeof u=="function"?u(b.value,w):b.value;return m==="width"?Ort(kb(j,{fontSize:e,letterSpacing:r}),p,f):kb(j,{fontSize:e,letterSpacing:r})[m]},v=a.length>=2?dl(a[1].coordinate-a[0].coordinate):1,y=Drt(s,v,m);return c==="equidistantPreserveStart"?Mrt(v,y,g,a,o):c==="equidistantPreserveEnd"?Lrt(v,y,g,a,o):(c==="preserveStart"||c==="preserveStartEnd"?h=$rt(v,y,g,a,o,c==="preserveStartEnd"):h=Hrt(v,y,g,a,o),h.filter(b=>b.isShow))}var Krt=t=>{var{ticks:e,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:s=0}=t,o=0;if(e){Array.from(e).forEach(d=>{if(d){var f=d.getBoundingClientRect();f.width>o&&(o=f.width)}});var l=r?r.getBoundingClientRect().width:0,c=a+s,u=o+c+l+(r?n:0);return Math.round(u)}return 0},qrt=["axisLine","width","height","className","hide","ticks","axisType"];function zrt(t,e){if(t==null)return{};var r,n,a=Wrt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Wrt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function mg(){return mg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},mg.apply(null,arguments)}function wz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Li(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?wz(Object(r),!0).forEach(function(n){Xrt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):wz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Xrt(t,e,r){return(e=Yrt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yrt(t){var e=Jrt(t,"string");return typeof e=="symbol"?e:e+""}function Jrt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Mp={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:Rl.axis};function Zrt(t){var{x:e,y:r,width:n,height:a,orientation:s,mirror:o,axisLine:l,otherSvgProps:c}=t;if(!l)return null;var u=Li(Li(Li({},c),qf(l)),{},{fill:"none"});if(s==="top"||s==="bottom"){var d=+(s==="top"&&!o||s==="bottom"&&o);u=Li(Li({},u),{},{x1:e,y1:r+d*a,x2:e+n,y2:r+d*a})}else{var f=+(s==="left"&&!o||s==="right"&&o);u=Li(Li({},u),{},{x1:e+f*n,y1:r,x2:e+f*n,y2:r+a})}return x.createElement("line",mg({},u,{className:La("recharts-cartesian-axis-line",cg(l,"className"))}))}function ent(t,e,r,n,a,s,o,l,c){var u,d,f,A,h,m,p=l?-1:1,g=t.tickSize||o,v=rn(t.tickCoord)?t.tickCoord:t.coordinate;switch(s){case"top":u=d=t.coordinate,A=r+ +!l*a,f=A-p*g,m=f-p*c,h=v;break;case"left":f=A=t.coordinate,d=e+ +!l*n,u=d-p*g,h=u-p*c,m=v;break;case"right":f=A=t.coordinate,d=e+ +l*n,u=d+p*g,h=u+p*c,m=v;break;default:u=d=t.coordinate,A=r+ +l*a,f=A+p*g,m=f+p*c,h=v;break}return{line:{x1:u,y1:f,x2:d,y2:A},tick:{x:h,y:m}}}function tnt(t,e){switch(t){case"left":return e?"start":"end";case"right":return e?"end":"start";default:return"middle"}}function rnt(t,e){switch(t){case"left":case"right":return"middle";case"top":return e?"start":"end";default:return e?"end":"start"}}function nnt(t){var{option:e,tickProps:r,value:n}=t,a,s=La(r.className,"recharts-cartesian-axis-tick-value");if(x.isValidElement(e))a=x.cloneElement(e,Li(Li({},r),{},{className:s}));else if(typeof e=="function")a=e(Li(Li({},r),{},{className:s}));else{var o="recharts-cartesian-axis-tick-value";typeof e!="boolean"&&(o=La(o,e==null?void 0:e.className)),a=x.createElement(t4,mg({},r,{className:o}),n)}return a}var ant=x.forwardRef((t,e)=>{var{ticks:r=[],tick:n,tickLine:a,stroke:s,tickFormatter:o,unit:l,padding:c,tickTextProps:u,orientation:d,mirror:f,x:A,y:h,width:m,height:p,tickSize:g,tickMargin:v,fontSize:y,letterSpacing:b,getTicksConfig:w,events:j,axisType:I}=t,_=Grt(Li(Li({},w),{},{ticks:r}),y,b),S=tnt(d,f),E=rnt(d,f),F=qf(w),k=L2(n),P={};typeof a=="object"&&(P=a);var D=Li(Li({},F),{},{fill:"none"},P),X=_.map(fe=>Li({entry:fe},ent(fe,A,h,m,p,d,g,f,v))),pe=X.map(fe=>{var{entry:xe,line:ae}=fe;return x.createElement(fc,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(xe.value,"-").concat(xe.coordinate,"-").concat(xe.tickCoord)},a&&x.createElement("line",mg({},D,ae,{className:La("recharts-cartesian-axis-tick-line",cg(a,"className"))})))}),ge=X.map((fe,xe)=>{var{entry:ae,tick:Se}=fe,Te=Li(Li(Li(Li({textAnchor:S,verticalAnchor:E},F),{},{stroke:"none",fill:s},k),Se),{},{index:xe,payload:ae,visibleTicksCount:_.length,tickFormatter:o,padding:c},u);return x.createElement(fc,mg({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(ae.value,"-").concat(ae.coordinate,"-").concat(ae.tickCoord)},Uw(j,ae,xe)),n&&x.createElement(nnt,{option:n,tickProps:Te,value:"".concat(typeof o=="function"?o(ae.value,xe):ae.value).concat(l||"")}))});return x.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(I,"-ticks")},ge.length>0&&x.createElement(nh,{zIndex:Rl.label},x.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(I,"-tick-labels"),ref:e},ge)),pe.length>0&&x.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(I,"-tick-lines")},pe))}),snt=x.forwardRef((t,e)=>{var{axisLine:r,width:n,height:a,className:s,hide:o,ticks:l,axisType:c}=t,u=zrt(t,qrt),[d,f]=x.useState(""),[A,h]=x.useState(""),m=x.useRef(null);x.useImperativeHandle(e,()=>({getCalculatedWidth:()=>{var g;return Krt({ticks:m.current,label:(g=t.labelRef)===null||g===void 0?void 0:g.current,labelGapWithTick:5,tickSize:t.tickSize,tickMargin:t.tickMargin})}}));var p=x.useCallback(g=>{if(g){var v=g.getElementsByClassName("recharts-cartesian-axis-tick-value");m.current=v;var y=v[0];if(y){var b=window.getComputedStyle(y),w=b.fontSize,j=b.letterSpacing;(w!==d||j!==A)&&(f(w),h(j))}}},[d,A]);return o||n!=null&&n<=0||a!=null&&a<=0?null:x.createElement(nh,{zIndex:t.zIndex},x.createElement(fc,{className:La("recharts-cartesian-axis",s)},x.createElement(Zrt,{x:t.x,y:t.y,width:n,height:a,orientation:t.orientation,mirror:t.mirror,axisLine:r,otherSvgProps:qf(t)}),x.createElement(ant,{ref:p,axisType:c,events:u,fontSize:d,getTicksConfig:t,height:t.height,letterSpacing:A,mirror:t.mirror,orientation:t.orientation,padding:t.padding,stroke:t.stroke,tick:t.tick,tickFormatter:t.tickFormatter,tickLine:t.tickLine,tickMargin:t.tickMargin,tickSize:t.tickSize,tickTextProps:t.tickTextProps,ticks:l,unit:t.unit,width:t.width,x:t.x,y:t.y}),x.createElement(Aet,{x:t.x,y:t.y,width:t.width,height:t.height,lowerWidth:t.width,upperWidth:t.width},x.createElement(Cet,{label:t.label,labelRef:t.labelRef}),t.children)))}),wM=x.forwardRef((t,e)=>{var r=Al(t,Mp);return x.createElement(snt,mg({},r,{ref:e}))});wM.displayName="CartesianAxis";var int={},vue=Vc({name:"errorBars",initialState:int,reducers:{addErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]||(t[r]=[]),t[r].push(n)},replaceErrorBar:(t,e)=>{var{itemId:r,prev:n,next:a}=e.payload;t[r]&&(t[r]=t[r].map(s=>s.dataKey===n.dataKey&&s.direction===n.direction?a:s))},removeErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]&&(t[r]=t[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:Fit,replaceErrorBar:Oit,removeErrorBar:Dit}=vue.actions,ont=vue.reducer,lnt=["children"];function cnt(t,e){if(t==null)return{};var r,n,a=unt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function unt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var dnt={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},fnt=x.createContext(dnt);function hnt(t){var{children:e}=t,r=cnt(t,lnt);return x.createElement(fnt.Provider,{value:r},e)}function yue(t,e){var r,n,a=Jr(u=>jA(u,t)),s=Jr(u=>PA(u,e)),o=(r=a==null?void 0:a.allowDataOverflow)!==null&&r!==void 0?r:Eo.allowDataOverflow,l=(n=s==null?void 0:s.allowDataOverflow)!==null&&n!==void 0?n:So.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function Ant(t){var{xAxisId:e,yAxisId:r,clipPathId:n}=t,a=Aue(),{needClipX:s,needClipY:o,needClip:l}=yue(e,r);if(!l||!a)return null;var{x:c,y:u,width:d,height:f}=a;return x.createElement("clipPath",{id:"clipPath-".concat(n)},x.createElement("rect",{x:s?c:c-d/2,y:o?u:u-f/2,width:s?d:d*2,height:o?f:f*2}))}var mnt={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iN=x;function pnt(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var gnt=typeof Object.is=="function"?Object.is:pnt,xnt=iN.useSyncExternalStore,vnt=iN.useRef,ynt=iN.useEffect,bnt=iN.useMemo,wnt=iN.useDebugValue;mnt.useSyncExternalStoreWithSelector=function(t,e,r,n,a){var s=vnt(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=bnt(function(){function c(h){if(!u){if(u=!0,d=h,h=n(h),a!==void 0&&o.hasValue){var m=o.value;if(a(m,h))return f=m}return f=h}if(m=f,gnt(d,h))return m;var p=n(h);return a!==void 0&&a(m,p)?(d=h,m):(d=h,f=p)}var u=!1,d,f,A=r===void 0?null:r;return[function(){return c(e())},A===null?void 0:function(){return c(A())}]},[e,r,n,a]);var l=xnt(t,s[0],s[1]);return ynt(function(){o.hasValue=!0,o.value=l},[l]),wnt(l),l};function Nnt(t){t()}function Cnt(){let t=null,e=null;return{clear(){t=null,e=null},notify(){Nnt(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=e={callback:r,next:null,prev:e};return a.prev?a.prev.next=a:t=a,function(){!n||t===null||(n=!1,a.next?a.next.prev=a.prev:e=a.prev,a.prev?a.prev.next=a.next:t=a.next)}}}}var Nz={notify(){},get:()=>[]};function _nt(t,e){let r,n=Nz,a=0,s=!1;function o(p){d();const g=n.subscribe(p);let v=!1;return()=>{v||(v=!0,g(),f())}}function l(){n.notify()}function c(){m.onStateChange&&m.onStateChange()}function u(){return s}function d(){a++,r||(r=t.subscribe(c),n=Cnt())}function f(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=Nz)}function A(){s||(s=!0,d())}function h(){s&&(s=!1,f())}const m={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:A,tryUnsubscribe:h,getListeners:()=>n};return m}var Ent=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Snt=Ent(),Int=()=>typeof navigator<"u"&&navigator.product==="ReactNative",jnt=Int(),Pnt=()=>Snt||jnt?x.useLayoutEffect:x.useEffect,Bnt=Pnt();function Cz(t,e){return t===e?t!==0||e!==0||1/t===1/e:t!==t&&e!==e}function Tnt(t,e){if(Cz(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(e,r[a])||!Cz(t[r[a]],e[r[a]]))return!1;return!0}var pB=Symbol.for("react-redux-context"),gB=typeof globalThis<"u"?globalThis:{};function knt(){if(!x.createContext)return{};const t=gB[pB]??(gB[pB]=new Map);let e=t.get(x.createContext);return e||(e=x.createContext(null),t.set(x.createContext,e)),e}var Fnt=knt();function Ont(t){const{children:e,context:r,serverState:n,store:a}=t,s=x.useMemo(()=>{const c=_nt(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0}},[a,n]),o=x.useMemo(()=>a.getState(),[a]);Bnt(()=>{const{subscription:c}=s;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[s,o]);const l=r||Fnt;return x.createElement(l.Provider,{value:s},e)}var Dnt=Ont,Rnt=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function Mnt(t,e){return t==null&&e==null?!0:typeof t=="number"&&typeof e=="number"?t===e||t!==t&&e!==e:t===e}function NM(t,e){var r=new Set([...Object.keys(t),...Object.keys(e)]);for(var n of r)if(Rnt.has(n)){if(t[n]==null&&e[n]==null)continue;if(!Tnt(t[n],e[n]))return!1}else if(!Mnt(t[n],e[n]))return!1;return!0}function Dg(t,e){var r,n;return(r=(n=t.graphicalItems.cartesianItems.find(a=>a.id===e))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:fue}function Rg(t,e){var r,n;return(r=(n=t.graphicalItems.cartesianItems.find(a=>a.id===e))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:fue}var Lnt="Invariant failed";function Unt(t,e){throw new Error(Lnt)}function ZF(){return ZF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ZF.apply(null,arguments)}function DI(t){return x.createElement(oue,ZF({shapeType:"rectangle",activeClassName:"recharts-active-bar"},t))}var Qnt=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(rn(e))return e;var s=rn(n)||Qo(n);return s?e(n,a):(s||Unt(),r)}},Vnt=(t,e,r)=>r,Hnt=(t,e)=>e,oN=qt([D8,Hnt],(t,e)=>t.filter(r=>r.type==="bar").find(r=>r.id===e)),$nt=qt([oN],t=>t==null?void 0:t.maxBarSize),Gnt=(t,e,r,n)=>n,Knt=qt([Aa,D8,Dg,Rg,Vnt],(t,e,r,n,a)=>e.filter(s=>t==="horizontal"?s.xAxisId===r:s.yAxisId===n).filter(s=>s.isPanorama===a).filter(s=>s.hide===!1).filter(s=>s.type==="bar")),qnt=(t,e,r)=>{var n=Aa(t),a=Dg(t,e),s=Rg(t,e);if(!(a==null||s==null))return n==="horizontal"?KF(t,"yAxis",s,r):KF(t,"xAxis",a,r)},znt=(t,e)=>{var r=Aa(t),n=Dg(t,e),a=Rg(t,e);if(!(n==null||a==null))return r==="horizontal"?Cq(t,"xAxis",n):Cq(t,"yAxis",a)},Wnt=qt([Knt,pXe,znt],grt),Xnt=(t,e,r)=>{var n,a,s=oN(t,e);if(s!=null){var o=Dg(t,e),l=Rg(t,e);if(!(o==null||l==null)){var c=Aa(t),u=Ile(t),{maxBarSize:d}=s,f=Qo(d)?u:d,A,h;return c==="horizontal"?(A=$v(t,"xAxis",o,r),h=Hv(t,"xAxis",o,r)):(A=$v(t,"yAxis",l,r),h=Hv(t,"yAxis",l,r)),(n=(a=uI(A,h,!0))!==null&&a!==void 0?a:f)!==null&&n!==void 0?n:0}}},bue=(t,e,r)=>{var n=Aa(t),a=Dg(t,e),s=Rg(t,e);if(!(a==null||s==null)){var o,l;return n==="horizontal"?(o=$v(t,"xAxis",a,r),l=Hv(t,"xAxis",a,r)):(o=$v(t,"yAxis",s,r),l=Hv(t,"yAxis",s,r)),uI(o,l)}},Ynt=qt([Wnt,Ile,mXe,jle,Xnt,bue,$nt],wrt),Jnt=(t,e,r)=>{var n=Dg(t,e);if(n!=null)return $v(t,"xAxis",n,r)},Znt=(t,e,r)=>{var n=Rg(t,e);if(n!=null)return $v(t,"yAxis",n,r)},eat=(t,e,r)=>{var n=Dg(t,e);if(n!=null)return Hv(t,"xAxis",n,r)},tat=(t,e,r)=>{var n=Rg(t,e);if(n!=null)return Hv(t,"yAxis",n,r)},rat=qt([Ynt,oN],(t,e)=>{if(!(t==null||e==null)){var r=t.find(n=>n.stackId===e.stackId&&e.dataKey!=null&&n.dataKeys.includes(e.dataKey));if(r!=null)return r.position}}),nat=qt([qnt,oN],Nrt),aat=qt([go,YR,Jnt,Znt,eat,tat,rat,Aa,nXe,bue,nat,oN,Gnt],(t,e,r,n,a,s,o,l,c,u,d,f,A)=>{var{chartData:h,dataStartIndex:m,dataEndIndex:p}=c;if(!(f==null||o==null||e==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||a==null||s==null||u==null)){var{data:g}=f,v;if(g!=null&&g.length>0?v=g:v=h==null?void 0:h.slice(m,p+1),v!=null)return kat({layout:l,barSettings:f,pos:o,parentViewBox:e,bandSize:u,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:s,stackedData:d,displayedData:v,offset:t,cells:A,dataStartIndex:m})}}),sat=["index"];function eO(){return eO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},eO.apply(null,arguments)}function iat(t,e){if(t==null)return{};var r,n,a=oat(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function oat(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var wue=x.createContext(void 0),lat=t=>{var e=x.useContext(wue);if(e!=null)return e.stackId;if(t!=null)return aGe(t)},cat=(t,e)=>"recharts-bar-stack-clip-path-".concat(t,"-").concat(e),uat=t=>{var e=x.useContext(wue);if(e!=null){var{stackId:r}=e;return"url(#".concat(cat(r,t),")")}},dat=t=>{var{index:e}=t,r=iat(t,sat),n=uat(e);return x.createElement(fc,eO({className:"recharts-bar-stack-layer",clipPath:n},r))},fat=["onMouseEnter","onMouseLeave","onClick"],hat=["value","background","tooltipPosition"],Aat=["id"],mat=["onMouseEnter","onClick","onMouseLeave"];function AA(){return AA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},AA.apply(null,arguments)}function _z(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ic(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_z(Object(r),!0).forEach(function(n){pat(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_z(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function pat(t,e,r){return(e=gat(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gat(t){var e=xat(t,"string");return typeof e=="symbol"?e:e+""}function xat(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function RI(t,e){if(t==null)return{};var r,n,a=vat(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function vat(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var yat=t=>{var{dataKey:e,name:r,fill:n,legendType:a,hide:s}=t;return[{inactive:s,dataKey:e,type:a,color:n,value:_P(r,e),payload:t}]},bat=x.memo(t=>{var{dataKey:e,stroke:r,strokeWidth:n,fill:a,name:s,hide:o,unit:l,tooltipType:c,id:u}=t,d={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:e,nameKey:void 0,name:_P(s,e),hide:o,type:c,color:a,unit:l,graphicalItemId:u}};return x.createElement(lue,{tooltipEntrySettings:d})});function wat(t){var e=Jr(Ag),{data:r,dataKey:n,background:a,allOtherBarProps:s}=t,{onMouseEnter:o,onMouseLeave:l,onClick:c}=s,u=RI(s,fat),d=xM(o,n,s.id),f=vM(l),A=yM(c,n,s.id);if(!a||r==null)return null;var h=L2(a);return x.createElement(nh,{zIndex:Crt(a,Rl.barBackground)},r.map((m,p)=>{var{value:g,background:v,tooltipPosition:y}=m,b=RI(m,hat);if(!v)return null;var w=d(m,p),j=f(m,p),I=A(m,p),_=ic(ic(ic(ic(ic({option:a,isActive:String(p)===e},b),{},{fill:"#eee"},v),h),Uw(u,m,p)),{},{onMouseEnter:w,onMouseLeave:j,onClick:I,dataKey:n,index:p,className:"recharts-bar-background-rectangle"});return x.createElement(DI,AA({key:"background-bar-".concat(p)},_))}))}function Nat(t){var{showLabels:e,children:r,rects:n}=t,a=n==null?void 0:n.map(s=>{var o={x:s.x,y:s.y,width:s.width,lowerWidth:s.width,upperWidth:s.width,height:s.height};return ic(ic({},o),{},{value:s.value,payload:s.payload,parentViewBox:s.parentViewBox,viewBox:o,fill:s.fill})});return x.createElement(Tet,{value:e?a:void 0},r)}function Cat(t){var{shape:e,activeBar:r,baseProps:n,entry:a,index:s,dataKey:o}=t,l=Jr(Ag),c=Jr(oM),u=r&&String(s)===l&&(c==null||o===c),d=u?r:e;return u?x.createElement(nh,{zIndex:Rl.activeBar},x.createElement(DI,AA({},n,{name:String(n.name)},a,{isActive:u,option:d,index:s,dataKey:o}))):x.createElement(DI,AA({},n,{name:String(n.name)},a,{isActive:u,option:d,index:s,dataKey:o}))}function _at(t){var{shape:e,baseProps:r,entry:n,index:a,dataKey:s}=t;return x.createElement(DI,AA({},r,{name:String(r.name)},n,{isActive:!1,option:e,index:a,dataKey:s}))}function Eat(t){var e,{data:r,props:n}=t,a=(e=qf(n))!==null&&e!==void 0?e:{},{id:s}=a,o=RI(a,Aat),{shape:l,dataKey:c,activeBar:u}=n,{onMouseEnter:d,onClick:f,onMouseLeave:A}=n,h=RI(n,mat),m=xM(d,c,s),p=vM(A),g=yM(f,c,s);return r?x.createElement(x.Fragment,null,r.map((v,y)=>x.createElement(dat,AA({index:y,key:"rectangle-".concat(v==null?void 0:v.x,"-").concat(v==null?void 0:v.y,"-").concat(v==null?void 0:v.value,"-").concat(y),className:"recharts-bar-rectangle"},Uw(h,v,y),{onMouseEnter:m(v,y),onMouseLeave:p(v,y),onClick:g(v,y)}),u?x.createElement(Cat,{shape:l,activeBar:u,baseProps:o,entry:v,index:y,dataKey:c}):x.createElement(_at,{shape:l,baseProps:o,entry:v,index:y,dataKey:c})))):null}function Sat(t){var{props:e,previousRectanglesRef:r}=t,{data:n,layout:a,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=e,f=r.current,A=RP(e,"recharts-bar-"),[h,m]=x.useState(!1),p=!h,g=x.useCallback(()=>{typeof u=="function"&&u(),m(!1)},[u]),v=x.useCallback(()=>{typeof d=="function"&&d(),m(!0)},[d]);return x.createElement(Nat,{showLabels:p,rects:n},x.createElement(DP,{animationId:A,begin:o,duration:l,isActive:s,easing:c,onAnimationEnd:g,onAnimationStart:v,key:A},y=>{var b=y===1?n:n==null?void 0:n.map((w,j)=>{var I=f&&f[j];if(I)return ic(ic({},w),{},{x:so(I.x,w.x,y),y:so(I.y,w.y,y),width:so(I.width,w.width,y),height:so(I.height,w.height,y)});if(a==="horizontal"){var _=so(0,w.height,y),S=so(w.stackedBarStart,w.y,y);return ic(ic({},w),{},{y:S,height:_})}var E=so(0,w.width,y),F=so(w.stackedBarStart,w.x,y);return ic(ic({},w),{},{width:E,x:F})});return y>0&&(r.current=b??null),b==null?null:x.createElement(fc,null,x.createElement(Eat,{props:e,data:b}))}),x.createElement(Zce,{label:e.label}),e.children)}function Iat(t){var e=x.useRef(null);return x.createElement(Sat,{previousRectanglesRef:e,props:t})}var Nue=0,jat=(t,e)=>{var r=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:r,errorVal:ps(t,e)}};class Pat extends x.PureComponent{render(){var{hide:e,data:r,dataKey:n,className:a,xAxisId:s,yAxisId:o,needClip:l,background:c,id:u}=this.props;if(e||r==null)return null;var d=La("recharts-bar",a),f=u;return x.createElement(fc,{className:d,id:u},l&&x.createElement("defs",null,x.createElement(Ant,{clipPathId:f,xAxisId:s,yAxisId:o})),x.createElement(fc,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(f,")"):void 0},x.createElement(wat,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),x.createElement(Iat,this.props)))}}var Bat={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:Nue,xAxisId:0,yAxisId:0,zIndex:Rl.bar};function Tat(t){var{xAxisId:e,yAxisId:r,hide:n,legendType:a,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d}=t,{needClip:f}=yue(e,r),A=$w(),h=_u(),m=gM(t.children,sN),p=Jr(y=>aat(y,t.id,h,m));if(A!=="vertical"&&A!=="horizontal")return null;var g,v=p==null?void 0:p[0];return v==null||v.height==null||v.width==null?g=0:g=A==="vertical"?v.height/2:v.width/2,x.createElement(hnt,{xAxisId:e,yAxisId:r,data:p,dataPointFormatter:jat,errorBarOffset:g},x.createElement(Pat,AA({},t,{layout:A,needClip:f,data:p,xAxisId:e,yAxisId:r,hide:n,legendType:a,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d})))}function kat(t){var{layout:e,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:s,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:u,stackedData:d,displayedData:f,offset:A,cells:h,parentViewBox:m,dataStartIndex:p}=t,g=e==="horizontal"?l:o,v=d?g.scale.domain():null,y=sGe({numericAxis:g}),b=g.scale(y);return f.map((w,j)=>{var I,_,S,E,F,k;if(d){var P=d[j+p];if(P==null)return null;I=Z$e(P,v)}else I=ps(w,r),Array.isArray(I)||(I=[y,I]);var D=Qnt(n,Nue)(I[1],j);if(e==="horizontal"){var X,[pe,ge]=[l.scale(I[0]),l.scale(I[1])];_=FG({axis:o,ticks:c,bandSize:s,offset:a.offset,entry:w,index:j}),S=(X=ge??pe)!==null&&X!==void 0?X:void 0,E=a.size;var fe=pe-ge;if(F=zf(fe)?0:fe,k={x:_,y:A.top,width:E,height:A.height},Math.abs(D)>0&&Math.abs(F)<Math.abs(D)){var xe=dl(F||D)*(Math.abs(D)-Math.abs(F));S-=xe,F+=xe}}else{var[ae,Se]=[o.scale(I[0]),o.scale(I[1])];if(_=ae,S=FG({axis:l,ticks:u,bandSize:s,offset:a.offset,entry:w,index:j}),E=Se-ae,F=a.size,k={x:A.left,y:S,width:A.width,height:F},Math.abs(D)>0&&Math.abs(E)<Math.abs(D)){var Te=dl(E||D)*(Math.abs(D)-Math.abs(E));E+=Te}}if(_==null||S==null||E==null||F==null)return null;var O=ic(ic({},w),{},{stackedBarStart:b,x:_,y:S,width:E,height:F,value:d?I:I[1],payload:w,background:k,tooltipPosition:{x:_+E/2,y:S+F/2},parentViewBox:m},h&&h[j]&&h[j].props);return O}).filter(Boolean)}function Fat(t){var e=Al(t,Bat),r=lat(e.stackId),n=_u();return x.createElement(cue,{id:e.id,type:"bar"},a=>x.createElement(x.Fragment,null,x.createElement(ptt,{legendPayload:yat(e)}),x.createElement(bat,{dataKey:e.dataKey,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,unit:e.unit,tooltipType:e.tooltipType,id:a}),x.createElement(Ptt,{type:"bar",id:a,data:void 0,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,stackId:r,hide:e.hide,barSize:e.barSize,minPointSize:e.minPointSize,maxBarSize:e.maxBarSize,isPanorama:n}),x.createElement(nh,{zIndex:e.zIndex},x.createElement(Tat,AA({},e,{id:a})))))}var tO=x.memo(Fat,NM);tO.displayName="Bar";var Oat=["domain","range"],Dat=["domain","range"];function Ez(t,e){if(t==null)return{};var r,n,a=Rat(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Rat(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Sz(t,e){return t===e?!0:Array.isArray(t)&&t.length===2&&Array.isArray(e)&&e.length===2?t[0]===e[0]&&t[1]===e[1]:!1}function Cue(t,e){if(t===e)return!0;var{domain:r,range:n}=t,a=Ez(t,Oat),{domain:s,range:o}=e,l=Ez(e,Dat);return!Sz(r,s)||!Sz(n,o)?!1:NM(a,l)}var Mat=["dangerouslySetInnerHTML","ticks","scale"],Lat=["id","scale"];function rO(){return rO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},rO.apply(null,arguments)}function Iz(t,e){if(t==null)return{};var r,n,a=Uat(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Uat(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Qat(t){var e=os(),r=x.useRef(null);return x.useLayoutEffect(()=>{r.current===null?e(ort(t)):r.current!==t&&e(lrt({prev:r.current,next:t})),r.current=t},[t,e]),x.useLayoutEffect(()=>()=>{r.current&&(e(crt(r.current)),r.current=null)},[e]),null}var Vat=t=>{var{xAxisId:e,className:r}=t,n=Jr(YR),a=_u(),s="xAxis",o=Jr(v=>oce(v,s,e,a)),l=Jr(v=>nce(v,e)),c=Jr(v=>hYe(v,e)),u=Jr(v=>Mle(v,e));if(l==null||c==null||u==null)return null;var{dangerouslySetInnerHTML:d,ticks:f,scale:A}=t,h=Iz(t,Mat),{id:m,scale:p}=u,g=Iz(u,Lat);return x.createElement(wM,rO({},h,g,{x:c.x,y:c.y,width:l.width,height:l.height,className:La("recharts-".concat(s," ").concat(s),r),viewBox:n,ticks:o,axisType:s}))},Hat={allowDataOverflow:Eo.allowDataOverflow,allowDecimals:Eo.allowDecimals,allowDuplicatedCategory:Eo.allowDuplicatedCategory,angle:Eo.angle,axisLine:Mp.axisLine,height:Eo.height,hide:!1,includeHidden:Eo.includeHidden,interval:Eo.interval,minTickGap:Eo.minTickGap,mirror:Eo.mirror,orientation:Eo.orientation,padding:Eo.padding,reversed:Eo.reversed,scale:Eo.scale,tick:Eo.tick,tickCount:Eo.tickCount,tickLine:Mp.tickLine,tickSize:Mp.tickSize,type:Eo.type,xAxisId:0},$at=t=>{var e=Al(t,Hat);return x.createElement(x.Fragment,null,x.createElement(Qat,{allowDataOverflow:e.allowDataOverflow,allowDecimals:e.allowDecimals,allowDuplicatedCategory:e.allowDuplicatedCategory,angle:e.angle,dataKey:e.dataKey,domain:e.domain,height:e.height,hide:e.hide,id:e.xAxisId,includeHidden:e.includeHidden,interval:e.interval,minTickGap:e.minTickGap,mirror:e.mirror,name:e.name,orientation:e.orientation,padding:e.padding,reversed:e.reversed,scale:e.scale,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit}),x.createElement(Vat,e))},_ue=x.memo($at,Cue);_ue.displayName="XAxis";var Gat=["dangerouslySetInnerHTML","ticks","scale"],Kat=["id","scale"];function nO(){return nO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},nO.apply(null,arguments)}function jz(t,e){if(t==null)return{};var r,n,a=qat(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function qat(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function zat(t){var e=os(),r=x.useRef(null);return x.useLayoutEffect(()=>{r.current===null?e(urt(t)):r.current!==t&&e(drt({prev:r.current,next:t})),r.current=t},[t,e]),x.useLayoutEffect(()=>()=>{r.current&&(e(frt(r.current)),r.current=null)},[e]),null}var Wat=t=>{var{yAxisId:e,className:r,width:n,label:a}=t,s=x.useRef(null),o=x.useRef(null),l=Jr(YR),c=_u(),u=os(),d="yAxis",f=Jr(I=>ace(I,e)),A=Jr(I=>mYe(I,e)),h=Jr(I=>oce(I,d,e,c)),m=Jr(I=>Lle(I,e));if(x.useLayoutEffect(()=>{if(!(n!=="auto"||!f||fM(a)||x.isValidElement(a)||m==null)){var I=s.current;if(I){var _=I.getCalculatedWidth();Math.round(f.width)!==Math.round(_)&&u(hrt({id:e,width:_}))}}},[h,f,u,a,e,n,m]),f==null||A==null||m==null)return null;var{dangerouslySetInnerHTML:p,ticks:g,scale:v}=t,y=jz(t,Gat),{id:b,scale:w}=m,j=jz(m,Kat);return x.createElement(wM,nO({},y,j,{ref:s,labelRef:o,x:A.x,y:A.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:f.width,height:f.height,className:La("recharts-".concat(d," ").concat(d),r),viewBox:l,ticks:h,axisType:d}))},Xat={allowDataOverflow:So.allowDataOverflow,allowDecimals:So.allowDecimals,allowDuplicatedCategory:So.allowDuplicatedCategory,angle:So.angle,axisLine:Mp.axisLine,hide:!1,includeHidden:So.includeHidden,interval:So.interval,minTickGap:So.minTickGap,mirror:So.mirror,orientation:So.orientation,padding:So.padding,reversed:So.reversed,scale:So.scale,tick:So.tick,tickCount:So.tickCount,tickLine:Mp.tickLine,tickSize:Mp.tickSize,type:So.type,width:So.width,yAxisId:0},Yat=t=>{var e=Al(t,Xat);return x.createElement(x.Fragment,null,x.createElement(zat,{interval:e.interval,id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:e.includeHidden,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:e.angle,minTickGap:e.minTickGap,tick:e.tick,tickFormatter:e.tickFormatter}),x.createElement(Wat,e))},Eue=x.memo(Yat,Cue);Eue.displayName="YAxis";var Jat=(t,e)=>e,CM=qt([Jat,Aa,Dle,vo,Nce,BA,PJe,go],RJe),_M=t=>{var e=t.currentTarget.getBoundingClientRect(),r=e.width/t.currentTarget.offsetWidth,n=e.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-e.left)/r),chartY:Math.round((t.clientY-e.top)/n)}},Sue=gd("mouseClick"),Iue=Vw();Iue.startListening({actionCreator:Sue,effect:(t,e)=>{var r=t.payload,n=CM(e.getState(),_M(r));(n==null?void 0:n.activeIndex)!=null&&e.dispatch(jYe({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var aO=gd("mouseMove"),jue=Vw(),y_=null;jue.startListening({actionCreator:aO,effect:(t,e)=>{var r=t.payload;y_!==null&&cancelAnimationFrame(y_);var n=_M(r);y_=requestAnimationFrame(()=>{var a=e.getState(),s=tM(a,a.tooltip.settings.shared);if(s==="axis"){var o=CM(a,n);(o==null?void 0:o.activeIndex)!=null?e.dispatch(mce({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):e.dispatch(Ace())}y_=null})}});function Zat(t,e){return e instanceof HTMLElement?"HTMLElement <".concat(e.tagName,' class="').concat(e.className,'">'):e===window?"global.window":t==="children"&&typeof e=="object"&&e!==null?"<<CHILDREN>>":e}var Pz={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},Pue=Vc({name:"rootProps",initialState:Pz,reducers:{updateOptions:(t,e)=>{var r;t.accessibilityLayer=e.payload.accessibilityLayer,t.barCategoryGap=e.payload.barCategoryGap,t.barGap=(r=e.payload.barGap)!==null&&r!==void 0?r:Pz.barGap,t.barSize=e.payload.barSize,t.maxBarSize=e.payload.maxBarSize,t.stackOffset=e.payload.stackOffset,t.syncId=e.payload.syncId,t.syncMethod=e.payload.syncMethod,t.className=e.payload.className,t.baseValue=e.payload.baseValue,t.reverseStackOrder=e.payload.reverseStackOrder}}}),est=Pue.reducer,{updateOptions:tst}=Pue.actions,Bue=Vc({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,e)=>e.payload}}),{updatePolarOptions:rst}=Bue.actions,nst=Bue.reducer,Tue=gd("keyDown"),kue=gd("focus"),EM=Vw();EM.startListening({actionCreator:Tue,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,s=t.payload;if(!(s!=="ArrowRight"&&s!=="ArrowLeft"&&s!=="Enter")){var o=rM(a,C1(r),eN(r),nN(r)),l=o==null?-1:Number(o);if(!(!Number.isFinite(l)||l<0)){var c=BA(r);if(s==="Enter"){var u=TI(r,"axis","hover",String(a.index));e.dispatch(zF({active:!a.active,activeIndex:a.index,activeCoordinate:u}));return}var d=vYe(r),f=d==="left-to-right"?1:-1,A=s==="ArrowRight"?1:-1,h=l+A*f;if(!(c==null||h>=c.length||h<0)){var m=TI(r,"axis","hover",String(h));e.dispatch(zF({active:!0,activeIndex:h.toString(),activeCoordinate:m}))}}}}}});EM.startListening({actionCreator:kue,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var s="0",o=TI(r,"axis","hover",String(s));e.dispatch(zF({active:!0,activeIndex:s,activeCoordinate:o}))}}}});var Ku=gd("externalEvent"),Fue=Vw(),xB=new Map;Fue.startListening({actionCreator:Ku,effect:(t,e)=>{var{handler:r,reactEvent:n}=t.payload;if(r!=null){n.persist();var a=n.type,s=xB.get(a);s!==void 0&&cancelAnimationFrame(s);var o=requestAnimationFrame(()=>{try{var l=e.getState(),c={activeCoordinate:mJe(l),activeDataKey:oM(l),activeIndex:Ag(l),activeLabel:Ece(l),activeTooltipIndex:Ag(l),isTooltipActive:pJe(l)};r(c,n)}finally{xB.delete(a)}});xB.set(a,o)}}});var ast=qt([w1],t=>t.tooltipItemPayloads),sst=qt([ast,rN,(t,e)=>e,(t,e,r)=>r],(t,e,r,n)=>{var a=t.find(l=>l.settings.graphicalItemId===n);if(a!=null){var{positions:s}=a;if(s!=null){var o=e(s,r);return o}}}),Oue=gd("touchMove"),Due=Vw();Due.startListening({actionCreator:Oue,effect:(t,e)=>{var r=t.payload;if(!(r.touches==null||r.touches.length===0)){var n=e.getState(),a=tM(n,n.tooltip.settings.shared);if(a==="axis"){var s=r.touches[0];if(s==null)return;var o=CM(n,_M({clientX:s.clientX,clientY:s.clientY,currentTarget:r.currentTarget}));(o==null?void 0:o.activeIndex)!=null&&e.dispatch(mce({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(a==="item"){var l,c=r.touches[0];if(document.elementFromPoint==null||c==null)return;var u=document.elementFromPoint(c.clientX,c.clientY);if(!u||!u.getAttribute)return;var d=u.getAttribute(Zie),f=(l=u.getAttribute(eoe))!==null&&l!==void 0?l:void 0,A=N1(n).find(p=>p.id===f);if(d==null||A==null||f==null)return;var{dataKey:h}=A,m=sst(n,d,f);e.dispatch(hce({activeDataKey:h,activeIndex:d,activeCoordinate:m,activeGraphicalItemId:f}))}}}});var ist=Nie({brush:_rt,cartesianAxis:Art,chartData:hZe,errorBars:ont,graphicalItems:Itt,layout:q$e,legend:JGe,options:lZe,polarAxis:Het,polarOptions:nst,referenceElements:Trt,rootProps:est,tooltip:PYe,zIndex:YJe}),ost=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return x$e({reducer:ist,preloadedState:e,middleware:n=>{var a;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((a="es6")!==null&&a!==void 0?a:"")}).concat([Iue.middleware,jue.middleware,EM.middleware,Fue.middleware,Due.middleware])},enhancers:n=>{var a=n;return typeof n=="function"&&(a=n()),a.concat(Mie({type:"raf"}))},devTools:{serialize:{replacer:Zat},name:"recharts-".concat(r)}})};function Rue(t){var{preloadedState:e,children:r,reduxStoreName:n}=t,a=_u(),s=x.useRef(null);if(a)return r;s.current==null&&(s.current=ost(e,n));var o=VR;return x.createElement(Dnt,{context:o,store:s.current},r)}function lst(t){var{layout:e,margin:r}=t,n=os(),a=_u();return x.useEffect(()=>{a||(n($$e(e)),n(H$e(r)))},[n,a,e,r]),null}var Mue=x.memo(lst,NM);function Lue(t){var e=os();return x.useEffect(()=>{e(tst(t))},[e,t]),null}function Bz(t){var{zIndex:e,isPanorama:r}=t,n=x.useRef(null),a=os();return x.useLayoutEffect(()=>(n.current&&a(WJe({zIndex:e,element:n.current,isPanorama:r})),()=>{a(XJe({zIndex:e,isPanorama:r}))}),[a,e,r]),x.createElement("g",{tabIndex:-1,ref:n})}function Tz(t){var{children:e,isPanorama:r}=t,n=Jr(LJe);if(!n||n.length===0)return e;var a=n.filter(o=>o<0),s=n.filter(o=>o>0);return x.createElement(x.Fragment,null,a.map(o=>x.createElement(Bz,{key:o,zIndex:o,isPanorama:r})),e,s.map(o=>x.createElement(Bz,{key:o,zIndex:o,isPanorama:r})))}var cst=["children"];function ust(t,e){if(t==null)return{};var r,n,a=dst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function dst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function MI(){return MI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},MI.apply(null,arguments)}var fst={width:"100%",height:"100%",display:"block"},hst=x.forwardRef((t,e)=>{var r=loe(),n=coe(),a=yoe();if(!gm(r)||!gm(n))return null;var{children:s,otherAttributes:o,title:l,desc:c}=t,u,d;return o!=null&&(typeof o.tabIndex=="number"?u=o.tabIndex:u=a?0:void 0,typeof o.role=="string"?d=o.role:d=a?"application":void 0),x.createElement(SR,MI({},o,{title:l,desc:c,role:d,tabIndex:u,width:r,height:n,style:fst,ref:e}),s)}),Ast=t=>{var{children:e}=t,r=Jr(jP);if(!r)return null;var{width:n,height:a,y:s,x:o}=r;return x.createElement(SR,{width:n,height:a,x:o,y:s},e)},kz=x.forwardRef((t,e)=>{var{children:r}=t,n=ust(t,cst),a=_u();return a?x.createElement(Ast,null,x.createElement(Tz,{isPanorama:!0},r)):x.createElement(hst,MI({ref:e},n),x.createElement(Tz,{isPanorama:!1},r))});function mst(){var t=os(),[e,r]=x.useState(null),n=Jr(dGe);return x.useEffect(()=>{if(e!=null){var a=e.getBoundingClientRect(),s=a.width/e.offsetWidth;Zs(s)&&s!==n&&t(K$e(s))}},[e,t,n]),r}function Fz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function pst(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Fz(Object(r),!0).forEach(function(n){gst(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Fz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function gst(t,e,r){return(e=xst(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xst(t){var e=vst(t,"string");return typeof e=="symbol"?e:e+""}function vst(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pg(){return pg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},pg.apply(null,arguments)}var yst=()=>(wZe(),null);function LI(t){if(typeof t=="number")return t;if(typeof t=="string"){var e=parseFloat(t);if(!Number.isNaN(e))return e}return 0}var bst=x.forwardRef((t,e)=>{var r,n,a=x.useRef(null),[s,o]=x.useState({containerWidth:LI((r=t.style)===null||r===void 0?void 0:r.width),containerHeight:LI((n=t.style)===null||n===void 0?void 0:n.height)}),l=x.useCallback((u,d)=>{o(f=>{var A=Math.round(u),h=Math.round(d);return f.containerWidth===A&&f.containerHeight===h?f:{containerWidth:A,containerHeight:h}})},[]),c=x.useCallback(u=>{if(typeof e=="function"&&e(u),u!=null&&typeof ResizeObserver<"u"){var{width:d,height:f}=u.getBoundingClientRect();l(d,f);var A=m=>{var{width:p,height:g}=m[0].contentRect;l(p,g)},h=new ResizeObserver(A);h.observe(u),a.current=h}},[e,l]);return x.useEffect(()=>()=>{var u=a.current;u!=null&&u.disconnect()},[l]),x.createElement(x.Fragment,null,x.createElement(BP,{width:s.containerWidth,height:s.containerHeight}),x.createElement("div",pg({ref:c},t)))}),wst=x.forwardRef((t,e)=>{var{width:r,height:n}=t,[a,s]=x.useState({containerWidth:LI(r),containerHeight:LI(n)}),o=x.useCallback((c,u)=>{s(d=>{var f=Math.round(c),A=Math.round(u);return d.containerWidth===f&&d.containerHeight===A?d:{containerWidth:f,containerHeight:A}})},[]),l=x.useCallback(c=>{if(typeof e=="function"&&e(c),c!=null){var{width:u,height:d}=c.getBoundingClientRect();o(u,d)}},[e,o]);return x.createElement(x.Fragment,null,x.createElement(BP,{width:a.containerWidth,height:a.containerHeight}),x.createElement("div",pg({ref:l},t)))}),Nst=x.forwardRef((t,e)=>{var{width:r,height:n}=t;return x.createElement(x.Fragment,null,x.createElement(BP,{width:r,height:n}),x.createElement("div",pg({ref:e},t)))}),Cst=x.forwardRef((t,e)=>{var{width:r,height:n}=t;return lA(r)||lA(n)?x.createElement(wst,pg({},t,{ref:e})):x.createElement(Nst,pg({},t,{ref:e}))});function _st(t){return t===!0?bst:Cst}var Est=x.forwardRef((t,e)=>{var{children:r,className:n,height:a,onClick:s,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:f,onMouseUp:A,onTouchEnd:h,onTouchMove:m,onTouchStart:p,style:g,width:v,responsive:y,dispatchTouchEvents:b=!0}=t,w=x.useRef(null),j=os(),[I,_]=x.useState(null),[S,E]=x.useState(null),F=mst(),k=JR(),P=(k==null?void 0:k.width)>0?k.width:v,D=(k==null?void 0:k.height)>0?k.height:a,X=x.useCallback(H=>{F(H),typeof e=="function"&&e(H),_(H),E(H),H!=null&&(w.current=H)},[F,e,_,E]),pe=x.useCallback(H=>{j(Sue(H)),j(Ku({handler:s,reactEvent:H}))},[j,s]),ge=x.useCallback(H=>{j(aO(H)),j(Ku({handler:u,reactEvent:H}))},[j,u]),fe=x.useCallback(H=>{j(Ace()),j(Ku({handler:d,reactEvent:H}))},[j,d]),xe=x.useCallback(H=>{j(aO(H)),j(Ku({handler:f,reactEvent:H}))},[j,f]),ae=x.useCallback(()=>{j(kue())},[j]),Se=x.useCallback(H=>{j(Tue(H.key))},[j]),Te=x.useCallback(H=>{j(Ku({handler:o,reactEvent:H}))},[j,o]),O=x.useCallback(H=>{j(Ku({handler:l,reactEvent:H}))},[j,l]),G=x.useCallback(H=>{j(Ku({handler:c,reactEvent:H}))},[j,c]),z=x.useCallback(H=>{j(Ku({handler:A,reactEvent:H}))},[j,A]),L=x.useCallback(H=>{j(Ku({handler:p,reactEvent:H}))},[j,p]),Z=x.useCallback(H=>{b&&j(Oue(H)),j(Ku({handler:m,reactEvent:H}))},[j,b,m]),ee=x.useCallback(H=>{j(Ku({handler:h,reactEvent:H}))},[j,h]),R=_st(y);return x.createElement(kce.Provider,{value:I},x.createElement(Cse.Provider,{value:S},x.createElement(R,{width:P??(g==null?void 0:g.width),height:D??(g==null?void 0:g.height),className:La("recharts-wrapper",n),style:pst({position:"relative",cursor:"default",width:P,height:D},g),onClick:pe,onContextMenu:Te,onDoubleClick:O,onFocus:ae,onKeyDown:Se,onMouseDown:G,onMouseEnter:ge,onMouseLeave:fe,onMouseMove:xe,onMouseUp:z,onTouchEnd:ee,onTouchMove:Z,onTouchStart:L,ref:X},x.createElement(yst,null),r)))}),Sst=["width","height","responsive","children","className","style","compact","title","desc"];function Ist(t,e){if(t==null)return{};var r,n,a=jst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function jst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Uue=x.forwardRef((t,e)=>{var{width:r,height:n,responsive:a,children:s,className:o,style:l,compact:c,title:u,desc:d}=t,f=Ist(t,Sst),A=qf(f);return c?x.createElement(x.Fragment,null,x.createElement(BP,{width:r,height:n}),x.createElement(kz,{otherAttributes:A,title:u,desc:d},s)):x.createElement(Est,{className:o,style:l,width:r,height:n,responsive:a??!1,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},x.createElement(kz,{otherAttributes:A,title:u,desc:d,ref:e},x.createElement(Frt,null,s)))});function sO(){return sO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},sO.apply(null,arguments)}var Pst={top:5,right:5,bottom:5,left:5},Bst={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:Pst,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},Tst=x.forwardRef(function(e,r){var n,a=Al(e.categoricalChartProps,Bst),{chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,categoricalChartProps:u}=e,d={chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0};return x.createElement(Rue,{preloadedState:{options:d},reduxStoreName:(n=u.id)!==null&&n!==void 0?n:s},x.createElement(mue,{chartData:u.data}),x.createElement(Mue,{layout:a.layout,margin:a.margin}),x.createElement(Lue,{baseValue:a.baseValue,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),x.createElement(Uue,sO({},a,{ref:r})))}),kst=["axis","item"],Fst=x.forwardRef((t,e)=>x.createElement(Tst,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:kst,tooltipPayloadSearcher:Oce,categoricalChartProps:t,ref:e}));function Ost(t){var e=os();return x.useEffect(()=>{e(rst(t))},[e,t]),null}var Dst=["layout"];function iO(){return iO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},iO.apply(null,arguments)}function Rst(t,e){if(t==null)return{};var r,n,a=Mst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Mst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Lst={top:5,right:5,bottom:5,left:5},Que={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Lst,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Ust=x.forwardRef(function(e,r){var n,a=Al(e.categoricalChartProps,Que),{layout:s}=a,o=Rst(a,Dst),{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d}=e,f={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,eventEmitter:void 0};return x.createElement(Rue,{preloadedState:{options:f},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:l},x.createElement(mue,{chartData:a.data}),x.createElement(Mue,{layout:s,margin:a.margin}),x.createElement(Lue,{baseValue:void 0,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),x.createElement(Ost,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),x.createElement(Uue,iO({},o,{ref:r})))});function Oz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Dz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Oz(Object(r),!0).forEach(function(n){Qst(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Oz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Qst(t,e,r){return(e=Vst(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vst(t){var e=Hst(t,"string");return typeof e=="symbol"?e:e+""}function Hst(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $st=["item"],Gst=Dz(Dz({},Que),{},{layout:"centric",startAngle:0,endAngle:360}),Kst=x.forwardRef((t,e)=>{var r=Al(t,Gst);return x.createElement(Ust,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:$st,tooltipPayloadSearcher:Oce,categoricalChartProps:r,ref:e})});const qst="sellers_candies",b_="cash_deliveries_candies";function ga(t){const e=typeof t=="number"?t:parseFloat(String(t??"").replace(/,/g,""));return Number.isFinite(e)?e:0}function vi(t){return Number.isFinite(t)?t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"}function w_(t,e){return t*e/100}function N_(t,e,r){return t-e-r}function Rz(t){return t?Nr(t.toDate(),"yyyy-MM-dd"):""}function C_(t){if(!t)return dr.fromDate(new Date);const[e,r,n]=t.split("-").map(s=>parseInt(s,10)),a=new Date(e,(r||1)-1,n||1,0,0,0,0);return dr.fromDate(a)}function zst(){const t=new Date,[e,r]=x.useState(Nr(yd(t),"yyyy-MM-dd")),[n,a]=x.useState(Nr(vd(t),"yyyy-MM-dd")),[s,o]=x.useState([]),l=x.useMemo(()=>{const R=new Map;return s.forEach(H=>R.set(H.id,H)),R},[s]),[c,u]=x.useState([]),[d,f]=x.useState(!0),[A,h]=x.useState(()=>Nr(new Date,"yyyy-MM-dd")),[m,p]=x.useState(""),[g,v]=x.useState(""),[y,b]=x.useState("0"),[w,j]=x.useState(""),[I,_]=x.useState(null),[S,E]=x.useState({}),F=x.useRef(null);x.useEffect(()=>{const R=er(_t(Fe,qst),dn("name","asc")),H=cd(R,ne=>{const ve=ne.docs.map(U=>{const He=U.data();return{id:U.id,name:String((He==null?void 0:He.name)??""),branch:He!=null&&He.branch?String(He.branch):"",commissionPercent:ga((He==null?void 0:He.commissionPercent)??0)}});o(ve)},()=>o([]));return()=>H()},[]),x.useEffect(()=>{f(!0);const R=C_(e),H=new Date(C_(n).toDate().getTime());H.setDate(H.getDate()+1);const ne=dr.fromDate(H),ve=er(_t(Fe,b_),cr("date",">=",R),cr("date","<",ne),dn("date","desc")),U=cd(ve,He=>{const se=He.docs.map(re=>{const Pe=re.data();return{id:re.id,date:Pe==null?void 0:Pe.date,sellerId:String((Pe==null?void 0:Pe.sellerId)??""),sellerName:String((Pe==null?void 0:Pe.sellerName)??""),amountDelivered:ga(Pe==null?void 0:Pe.amountDelivered),commissionPercent:ga(Pe==null?void 0:Pe.commissionPercent),commissionPaid:ga(Pe==null?void 0:Pe.commissionPaid),extraExpenses:ga(Pe==null?void 0:Pe.extraExpenses),totalFinal:ga(Pe==null?void 0:Pe.totalFinal),comment:String((Pe==null?void 0:Pe.comment)??""),createdAt:Pe==null?void 0:Pe.createdAt,updatedAt:Pe==null?void 0:Pe.updatedAt}});u(se),f(!1)},He=>{console.error("Firestore deliveries query error:",He),u([]),f(!1),alert("Firestore query fall. Revis consola (probable ndice).")});return()=>U()},[e,n]);const k=x.useMemo(()=>m?l.get(m):void 0,[m,l]),P=ga((k==null?void 0:k.commissionPercent)??0),D=ga(g),X=ga(y),pe=w_(D,P),ge=N_(D,pe,X),fe=x.useMemo(()=>{var H;const R=new Map;for(const ne of c){const ve=ne.sellerId||ne.sellerName||"UNKNOWN",U=R.get(ve)??{sellerId:ne.sellerId,sellerName:ne.sellerName||((H=l.get(ne.sellerId))==null?void 0:H.name)||"Sin nombre",delivered:0,commission:0,totalFinal:0};U.delivered+=ga(ne.amountDelivered),U.commission+=ga(ne.commissionPaid),U.totalFinal+=ga(ne.totalFinal),R.set(ve,U)}return Array.from(R.values()).sort((ne,ve)=>ne.sellerName.localeCompare(ve.sellerName))},[c,l]),xe=x.useMemo(()=>{let R=0,H=0,ne=0,ve=0;for(const U of c)R+=ga(U.amountDelivered),H+=ga(U.commissionPaid),ne+=ga(U.extraExpenses),ve+=ga(U.totalFinal);return{delivered:R,commission:H,expenses:ne,totalFinal:ve}},[c]),ae=x.useMemo(()=>fe.map(R=>({name:R.sellerName,Entregado:Number(R.delivered.toFixed(2)),Comision:Number(R.commission.toFixed(2))})),[fe]),Se=x.useMemo(()=>[{name:"Total Entregado (Bruto)",value:Number(xe.delivered.toFixed(2))},{name:"Total Comisin",value:Number(xe.commission.toFixed(2))},{name:"Total Gastos",value:Number(xe.expenses.toFixed(2))}].filter(R=>R.value>0),[xe]),Te=["#3B82F6","#F59E0B","#EF4444"];async function O(){if(!m)return alert("Seleccion un vendedor.");if(D<=0)return alert("Ingres un Monto entregado vlido (> 0).");const R=l.get(m),H=(R==null?void 0:R.name)??"Sin nombre",ne=ga((R==null?void 0:R.commissionPercent)??0),ve=w_(D,ne),U=N_(D,ve,X);await On(_t(Fe,b_),{date:C_(A),sellerId:m,sellerName:H,amountDelivered:D,commissionPercent:ne,commissionPaid:ve,extraExpenses:X,totalFinal:U,comment:w??"",createdAt:dr.now()}),v(""),b("0"),j("")}function G(R){_(R.id),E({...R,dateInput:Rz(R.date)})}function z(){_(null),E({})}async function L(R){const H=S,ne=String(H.sellerId??""),ve=l.get(ne),U=String(H.sellerName??(ve==null?void 0:ve.name)??"Sin nombre"),He=ga(H.amountDelivered),se=ga(H.extraExpenses),re=ga(H.commissionPercent??(ve==null?void 0:ve.commissionPercent)??0),Pe=w_(He,re),ue=N_(He,Pe,se),we=C_(String(H.dateInput??Rz(H.date)));await pn(Yt(Fe,b_,R),{date:we,sellerId:ne,sellerName:U,amountDelivered:He,commissionPercent:re,commissionPaid:Pe,extraExpenses:se,totalFinal:ue,comment:String(H.comment??""),updatedAt:dr.now()}),z()}async function Z(R){confirm("Eliminar este registro?")&&await Fn(Yt(Fe,b_,R))}async function ee(){if(!F.current)return;const R=await Cg(F.current,{scale:2,useCORS:!0,backgroundColor:"#ffffff",scrollX:0,scrollY:-window.scrollY}),H=R.toDataURL("image/png"),ne=new Rr("p","mm","a4"),ve=ne.internal.pageSize.getWidth(),U=ne.internal.pageSize.getHeight(),He=ve,se=R.height*He/R.width;let re=se,Pe=0;for(ne.addImage(H,"PNG",0,Pe,He,se),re-=U;re>0;)ne.addPage(),Pe=-(se-re),ne.addImage(H,"PNG",0,Pe,He,se),re-=U;ne.save(`Entregas_Dulces_${e}_a_${n}.pdf`)}return i.jsxs("div",{className:"p-3 md:p-6 max-w-7xl mx-auto space-y-3 md:space-y-4",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg md:text-2xl font-black text-gray-900",children:"Control Contable - Entregas de Vendedores (Dulces)"}),i.jsxs("p",{className:"text-xs md:text-sm text-gray-600",children:["Periodo: ",i.jsx("span",{className:"font-bold",children:e})," "," ",i.jsx("span",{className:"font-bold",children:n})]})]}),i.jsx("button",{onClick:ee,className:"h-10 px-4 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800 active:scale-[0.99] transition",children:"Exportar a PDF"})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Filtros de periodo"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",value:e,onChange:R=>r(R.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",value:n,onChange:R=>a(R.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]})]})]}),i.jsxs("div",{ref:F,className:"space-y-3 md:space-y-4",children:[i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"KPIs Consolidados"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"KPI Entradas (Neto)"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",vi(xe.totalFinal)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Entregado - Comisin - Gastos"})]}),i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"KPI Comisiones"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",vi(xe.commission)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Suma de comisin pagada"})]}),i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"KPI Gastos extras"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",vi(xe.expenses)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Suma de gastos registrados"})]}),i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"Total entregado (Bruto)"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",vi(xe.delivered)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Sin restar nada"})]})]}),i.jsx("div",{className:"font-black text-sm text-gray-900 mt-4 mb-2",children:"KPI Vendedores (sumatoria del periodo)"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-[520px] w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-50 text-gray-700",children:[i.jsx("th",{className:"text-left p-2 font-black",children:"Vendedor"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Entregado"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Comisin"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Total final"})]})}),i.jsx("tbody",{children:fe.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-2 text-gray-500",colSpan:4,children:"Sin datos en el periodo seleccionado."})}):fe.map(R=>i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"p-2",children:R.sellerName}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",vi(R.delivered)]}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",vi(R.commission)]}),i.jsxs("td",{className:"p-2 text-right font-extrabold",children:["$ ",vi(R.totalFinal)]})]},R.sellerId||R.sellerName))})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Entregas y Comisin por vendedor (Barras)"}),i.jsx("div",{className:"w-full h-[320px]",children:i.jsx(VG,{children:i.jsxs(Fst,{data:ae,children:[i.jsx(_ue,{dataKey:"name",interval:0,angle:-12,height:70}),i.jsx(Eue,{}),i.jsx(Uq,{}),i.jsx(PF,{}),i.jsx(tO,{dataKey:"Entregado"}),i.jsx(tO,{dataKey:"Comision"})]})})})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Distribucin (Pastel)"}),i.jsx("div",{className:"w-full h-[320px]",children:i.jsx(VG,{children:i.jsxs(Kst,{children:[i.jsx(due,{data:Se,dataKey:"value",nameKey:"name",outerRadius:110,label:!0,children:Se.map((R,H)=>i.jsx(sN,{fill:Te[H%Te.length]},H))}),i.jsx(Uq,{}),i.jsx(PF,{})]})})})]})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Agregar movimiento"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Fecha"}),i.jsx("input",{type:"date",value:A,onChange:R=>h(R.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Vendedor"}),i.jsxs("select",{value:m,onChange:R=>p(R.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10 bg-white",children:[i.jsx("option",{value:"",children:"Seleccionar..."}),s.map(R=>i.jsxs("option",{value:R.id,children:[R.name," ",R.branch?`(${R.branch})`:""]},R.id))]})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Monto entregado"}),i.jsx("input",{type:"number",inputMode:"decimal",value:g,onChange:R=>v(R.target.value),placeholder:"0.00",className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comisin configurada"}),i.jsx("input",{value:`${P}%`,readOnly:!0,className:"w-full h-10 rounded-xl border border-gray-200 px-3 bg-gray-50 text-gray-800"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comisin pagada"}),i.jsx("input",{value:`$ ${vi(pe)}`,readOnly:!0,className:"w-full h-10 rounded-xl border border-gray-200 px-3 bg-gray-50 text-gray-800"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Gastos extras"}),i.jsx("input",{type:"number",inputMode:"decimal",value:y,onChange:R=>b(R.target.value),placeholder:"0.00",className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Total final"}),i.jsx("input",{value:`$ ${vi(ge)}`,readOnly:!0,className:"w-full h-10 rounded-xl border border-gray-200 px-3 bg-gray-50 text-gray-900 font-extrabold"})]}),i.jsxs("label",{className:"space-y-1 md:col-span-2",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comentario"}),i.jsx("input",{value:w,onChange:R=>j(R.target.value),placeholder:"Opcional...",className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]})]}),i.jsx("div",{className:"mt-3",children:i.jsx("button",{onClick:O,className:"w-full md:w-auto h-10 px-4 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800 active:scale-[0.99] transition",children:"Guardar movimiento"})})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Registro detallado"}),d?i.jsx("div",{className:"text-sm text-gray-500",children:"Cargando..."}):c.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"No hay registros en el periodo."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-50 text-gray-700",children:[i.jsx("th",{className:"text-left p-2 font-black",children:"Fecha"}),i.jsx("th",{className:"text-left p-2 font-black",children:"Vendedor"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Monto entregado"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Comisin %"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Comisin pagada"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Gastos"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Total final"}),i.jsx("th",{className:"text-left p-2 font-black",children:"Comentario"}),i.jsx("th",{className:"text-left p-2 font-black",children:"Acciones"})]})}),i.jsx("tbody",{children:c.map(R=>{if(!(I===R.id))return i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"p-2",children:Nr(R.date.toDate(),"yyyy-MM-dd")}),i.jsx("td",{className:"p-2 font-semibold",children:R.sellerName}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",vi(R.amountDelivered)]}),i.jsxs("td",{className:"p-2 text-right",children:[vi(R.commissionPercent),"%"]}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",vi(R.commissionPaid)]}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",vi(R.extraExpenses)]}),i.jsxs("td",{className:"p-2 text-right font-extrabold",children:["$ ",vi(R.totalFinal)]}),i.jsx("td",{className:"p-2",children:R.comment}),i.jsx("td",{className:"p-2",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>G(R),className:"h-8 px-3 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Editar"}),i.jsx("button",{onClick:()=>Z(R.id),className:"h-8 px-3 rounded-xl border border-gray-200 font-extrabold text-red-700 hover:bg-red-50",children:"Eliminar"})]})})]},R.id);const ne=ga(S.amountDelivered??R.amountDelivered),ve=ga(S.commissionPercent??R.commissionPercent),U=ga(S.extraExpenses??R.extraExpenses),He=w_(ne,ve),se=N_(ne,He,U);return i.jsxs("tr",{className:"border-t bg-yellow-50/40",children:[i.jsx("td",{className:"p-2",children:i.jsx("input",{type:"date",value:String(S.dateInput??""),onChange:re=>E(Pe=>({...Pe,dateInput:re.target.value})),className:"h-9 px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsx("td",{className:"p-2",children:i.jsxs("select",{value:String(S.sellerId??R.sellerId),onChange:re=>{const Pe=re.target.value,ue=l.get(Pe);E(we=>({...we,sellerId:Pe,sellerName:(ue==null?void 0:ue.name)??"",commissionPercent:ga((ue==null?void 0:ue.commissionPercent)??0)}))},className:"h-9 px-3 rounded-xl border border-gray-200 bg-white outline-none",children:[i.jsx("option",{value:"",children:"Seleccionar..."}),s.map(re=>i.jsxs("option",{value:re.id,children:[re.name," ",re.branch?`(${re.branch})`:""]},re.id))]})}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",value:String(ne),onChange:re=>E(Pe=>({...Pe,amountDelivered:ga(re.target.value)})),className:"h-9 w-32 text-right px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",value:String(ve),onChange:re=>E(Pe=>({...Pe,commissionPercent:ga(re.target.value)})),className:"h-9 w-24 text-right px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsxs("td",{className:"p-2 text-right font-semibold",children:["$ ",vi(He)]}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",value:String(U),onChange:re=>E(Pe=>({...Pe,extraExpenses:ga(re.target.value)})),className:"h-9 w-32 text-right px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsxs("td",{className:"p-2 text-right font-extrabold",children:["$ ",vi(se)]}),i.jsx("td",{className:"p-2",children:i.jsx("input",{type:"text",value:String(S.comment??R.comment),onChange:re=>E(Pe=>({...Pe,comment:re.target.value})),className:"h-9 w-full px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsx("td",{className:"p-2",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>L(R.id),className:"h-8 px-3 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800",children:"Guardar"}),i.jsx("button",{onClick:z,className:"h-8 px-3 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Cancelar"})]})})]},R.id)})})]})}),i.jsxs("div",{className:"md:hidden space-y-3",children:[c.map(R=>i.jsxs("div",{className:"rounded-2xl border border-gray-100 p-3 bg-white",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-black text-gray-900",children:R.sellerName}),i.jsx("div",{className:"text-xs font-extrabold bg-gray-100 rounded-full px-3 py-1",children:Nr(R.date.toDate(),"yyyy-MM-dd")})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Monto entregado"}),i.jsxs("div",{className:"font-extrabold",children:["$ ",vi(R.amountDelivered)]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Comisin %"}),i.jsxs("div",{className:"font-semibold",children:[vi(R.commissionPercent),"%"]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Comisin pagada"}),i.jsxs("div",{className:"font-semibold",children:["$ ",vi(R.commissionPaid)]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Gastos"}),i.jsxs("div",{className:"font-semibold",children:["$ ",vi(R.extraExpenses)]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Total final"}),i.jsxs("div",{className:"text-base font-black",children:["$ ",vi(R.totalFinal)]})]}),R.comment?i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Comentario"}),i.jsx("div",{className:"text-sm text-gray-800",children:R.comment})]}):null]}),i.jsxs("div",{className:"mt-3 flex gap-2",children:[i.jsx("button",{onClick:()=>G(R),className:"flex-1 h-10 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Editar"}),i.jsx("button",{onClick:()=>Z(R.id),className:"flex-1 h-10 rounded-xl border border-gray-200 font-extrabold text-red-700 hover:bg-red-50",children:"Eliminar"})]})]},R.id)),I?i.jsxs("div",{className:"rounded-2xl border border-yellow-200 bg-yellow-50 p-3",children:[i.jsx("div",{className:"font-black text-gray-900 mb-3",children:"Editando registro"}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Fecha"}),i.jsx("input",{type:"date",value:String(S.dateInput??""),onChange:R=>E(H=>({...H,dateInput:R.target.value})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Vendedor"}),i.jsxs("select",{value:String(S.sellerId??""),onChange:R=>{const H=R.target.value,ne=l.get(H);E(ve=>({...ve,sellerId:H,sellerName:(ne==null?void 0:ne.name)??"",commissionPercent:ga((ne==null?void 0:ne.commissionPercent)??0)}))},className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white",children:[i.jsx("option",{value:"",children:"Seleccionar..."}),s.map(R=>i.jsxs("option",{value:R.id,children:[R.name," ",R.branch?`(${R.branch})`:""]},R.id))]})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Monto entregado"}),i.jsx("input",{type:"number",value:String(S.amountDelivered??""),onChange:R=>E(H=>({...H,amountDelivered:ga(R.target.value)})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Gastos extras"}),i.jsx("input",{type:"number",value:String(S.extraExpenses??""),onChange:R=>E(H=>({...H,extraExpenses:ga(R.target.value)})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comisin %"}),i.jsx("input",{type:"number",value:String(S.commissionPercent??""),onChange:R=>E(H=>({...H,commissionPercent:ga(R.target.value)})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comentario"}),i.jsx("input",{type:"text",value:String(S.comment??""),onChange:R=>E(H=>({...H,comment:R.target.value})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>L(I),className:"flex-1 h-10 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800",children:"Guardar"}),i.jsx("button",{onClick:z,className:"flex-1 h-10 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Cancelar"})]})]})]}):null]})]})]})]})]})}const Km=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Wst(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function Mz(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function Xst(t){const e=String(t||"").trim();if(!e)return 0;const r=Date.parse(e);return Number.isFinite(r)?r:0}function Yst({open:t,onClose:e,onDetected:r}){const n=x.useRef(null),a=x.useRef(null),[s,o]=x.useState(""),l=x.useRef("");return x.useEffect(()=>{if(!t)return;let c=!1;const u=new b2,d=()=>{var A,h,m;try{(A=a.current)==null||A.stop()}catch{}a.current=null;try{const p=(h=n.current)==null?void 0:h.srcObject;(m=p==null?void 0:p.getTracks)==null||m.call(p).forEach(g=>g.stop())}catch{}try{n.current&&(n.current.srcObject=null)}catch{}};return(async()=>{o("");try{if(!n.current)return;try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1})).getTracks().forEach(m=>m.stop())}catch{}const A=await u.decodeFromConstraints({video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1},n.current,h=>{if(!c&&h){const m=String(h.getText()||"").trim().replace(/\s+/g,"");if(!m||m===l.current)return;l.current=m,d(),r(m),e()}});a.current=A}catch(A){const h=String((A==null?void 0:A.message)||""),m=String((A==null?void 0:A.name)||"");h.toLowerCase().includes("permission")||m==="NotAllowedError"?o("Permiso de cmara denegado."):m==="NotFoundError"||h.toLowerCase().includes("notfound")?o("No se encontr cmara en este dispositivo."):h.toLowerCase().includes("secure")||h.toLowerCase().includes("https")?o("La cmara requiere HTTPS (sitio seguro)."):o(h||"No se pudo iniciar el escner.")}})(),()=>{c=!0,d()}},[t,e,r]),t?i.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 p-3 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-lg border overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[i.jsx("div",{className:"font-bold",children:"Escanear cdigo"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:e,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"relative w-full aspect-[3/4] bg-black rounded-xl overflow-hidden",children:[i.jsx("video",{ref:n,className:"w-full h-full object-cover",muted:!0,playsInline:!0,autoPlay:!0}),i.jsx("div",{className:"absolute inset-0 pointer-events-none",children:i.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[85%] h-40 border-2 border-white/70 rounded-xl"})})]}),s&&i.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded p-2",children:s}),i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Apunt al cdigo de barras y mantenelo estable."})]})]})}):null}function Jst(){const{refreshKey:t,refresh:e}=gc(),[r,n]=x.useState(!0),[a,s]=x.useState(""),[o,l]=x.useState([]),[c,u]=x.useState(""),[d,f]=x.useState(""),[A,h]=x.useState(""),[m,p]=x.useState(""),[g,v]=x.useState("ANY"),[y,b]=x.useState(!1),[w,j]=x.useState({});x.useEffect(()=>{(async()=>{n(!0),s("");try{const he=await Qt(er(_t(Fe,"candy_main_orders"))),le=new Map;he.forEach(je=>{var te,ie,$e;const Ae=je.data(),Qe=Xst(Ae.date),Ct=((ie=(te=Ae==null?void 0:Ae.createdAt)==null?void 0:te.toMillis)==null?void 0:ie.call(te))||(($e=Ae==null?void 0:Ae.createdAt)!=null&&$e.seconds?Ae.createdAt.seconds*1e3:0)||0,pt=Math.max(Qe,Ct),me=Array.isArray(Ae.items)?Ae.items:[];for(const de of me){const Ce=String((de==null?void 0:de.id)||(de==null?void 0:de.productId)||"").trim();if(!Ce)continue;const nt=String((de==null?void 0:de.name)||(de==null?void 0:de.productName)||"").trim(),vt=String((de==null?void 0:de.category)||"").trim(),ht=Number((de==null?void 0:de.unitPriceIsla)||0),xt=Number((de==null?void 0:de.unitPriceRivas)||0),Xe=Number((de==null?void 0:de.unitsPerPackage)||(de==null?void 0:de.unitsPerPack)||1),be=le.get(Ce);(!be||pt>=be._sortKey)&&le.set(Ce,{productId:Ce,category:vt,productName:nt,priceIsla:ht,priceRivas:xt,unitsPerPackage:Xe,_sortKey:pt})}});const Be=Array.from(le.values()).sort((je,Ae)=>je.productName.localeCompare(Ae.productName,"es"));l(Be)}catch(he){console.error(he),s(" Error cargando precios desde rdenes maestras."),l([])}finally{n(!1)}})()},[t]),x.useEffect(()=>{const he=_t(Fe,"products_candies"),le=er(he),Be=cd(le,je=>{const Ae={},Qe={},Ct={},pt={};je.forEach(me=>{const te=me.data();Ae[me.id]=Number((te==null?void 0:te.providerPrice)||(te==null?void 0:te.providerPricePerUnit)||0),Ct[me.id]=Number((te==null?void 0:te.unitsPerPackage)||(te==null?void 0:te.unitsPerPack)||1)||1;const ie=String((te==null?void 0:te.barcode)||"").trim();ie&&(Qe[me.id]=ie);const $e=String((te==null?void 0:te.packaging)||(te==null?void 0:te.empaque)||"").trim();$e&&(pt[me.id]=$e)});try{const me=S.current||{};let te=!1;for(const Ce of Object.keys(Qe))if((Qe[Ce]||"")!==(me[Ce]||"")){te=!0;break}const ie=F.current||{};let $e=!1;for(const Ce of Object.keys(Ct))if((Ct[Ce]||0)!==(ie[Ce]||0)){$e=!0;break}X(Ae),ge(Ct);const de={...Qe,...me};_(de),S.current=de,F.current={...Ct},Se(pt),l(Ce=>Ce.map(nt=>({...nt,unitsPerPackage:Ct[nt.productId]??nt.unitsPerPackage}))),!E.current&&te&&(s(" Cdigo actualizado."),setTimeout(()=>s(""),3e3)),!E.current&&$e&&(s(" Unidades x paquete actualizadas."),setTimeout(()=>s(""),3e3)),E.current=!1}catch{X(Ae),ge(Ct),_(te=>({...Qe,...te})),F.current={...Ct},Se(pt),l(te=>te.map(ie=>({...ie,unitsPerPackage:Ct[ie.productId]??ie.unitsPerPackage})))}},je=>console.error(je));return()=>Be()},[]);const[I,_]=x.useState({}),S=x.useRef({}),E=x.useRef(!0),F=x.useRef({}),k=x.useRef({}),P=x.useRef(!0),[D,X]=x.useState({}),[pe,ge]=x.useState({}),[fe,xe]=x.useState({}),[ae,Se]=x.useState({}),[Te,O]=x.useState("");x.useEffect(()=>{const he=_t(Fe,"inventory_candies"),le=er(he),Be=cd(le,je=>{try{const Ae={};je.forEach(Ct=>{var de,Ce,nt;const pt=Ct.data(),me=String(pt.productId||"").trim();if(!me)return;const te=Number(pt.unitsPerPackage||pt.unitsPerPack||0)||0,ie=((Ce=(de=pt==null?void 0:pt.createdAt)==null?void 0:de.toMillis)==null?void 0:Ce.call(de))||((nt=pt==null?void 0:pt.createdAt)!=null&&nt.seconds?pt.createdAt.seconds*1e3:0)||0,$e=Ae[me];(!$e||ie>=$e.ts)&&(Ae[me]={val:te||0,ts:ie})});const Qe={};for(const Ct of Object.keys(Ae))Qe[Ct]=Ae[Ct].val||0;xe(Qe);try{const Ct=k.current||{};let pt=!1;for(const me of Object.keys(Qe))if((Qe[me]||0)!==(Ct[me]||0)){pt=!0;break}k.current={...Qe},!P.current&&pt&&(s(" Inventario: unidades por paquete actualizadas."),setTimeout(()=>s(""),3e3)),P.current=!1}catch{}l(Ct=>Ct.map(pt=>({...pt,unitsPerPackage:Qe[pt.productId]??pe[pt.productId]??pt.unitsPerPackage})))}catch(Ae){console.error("inventory_candies snapshot error:",Ae)}},je=>console.error(je));return()=>Be()},[pe]),x.useEffect(()=>{l(he=>he.map(le=>({...le,unitsPerPackage:fe[le.productId]??pe[le.productId]??le.unitsPerPackage})))},[pe,fe]);const G=x.useMemo(()=>{const he=Wst(c),le=String(d||"").trim(),Be=String(Te||"").trim().toLowerCase(),je=A.trim()===""?null:Mz(A,NaN),Ae=m.trim()===""?null:Mz(m,NaN);return o.filter(Qe=>{const Ct=String(ae[Qe.productId]||"").trim().toLowerCase();if(Be)return Ct===Be;if(he&&!`${Qe.category} ${Qe.productName}`.toLowerCase().includes(he))return!1;if(le){const ie=String(Qe.productId||""),$e=String(I[Qe.productId]||"");if(!ie.includes(le)&&!$e.includes(le))return!1}const pt=g==="ISLA"?[Qe.priceIsla]:g==="RIVAS"?[Qe.priceRivas]:[Qe.priceIsla,Qe.priceRivas],me=je==null||!Number.isFinite(je)?!0:pt.some(ie=>ie>=je),te=Ae==null||!Number.isFinite(Ae)?!0:pt.some(ie=>ie<=Ae);return me&&te})},[o,c,A,m,g,I,Te,ae]),z=x.useMemo(()=>{const he=new Map;for(const le of G){const Be=(le.category||"Sin categora").trim()||"Sin categora",je=he.get(Be)||[];je.push(le),he.set(Be,je)}return Array.from(he.entries()).sort(([le],[Be])=>le.localeCompare(Be,"es"))},[G]),L=he=>{j(le=>({...le,[he]:!le[he]}))},Z=()=>{u(""),h(""),p(""),v("ANY"),O("")},[ee,R]=x.useState(!1),[H,ne]=x.useState("search"),[ve,U]=x.useState(null),[He,se]=x.useState(0),[re,Pe]=x.useState(0),[ue,we]=x.useState(null),[Me,ze]=x.useState(""),[yt,It]=x.useState(""),Ke=x.useMemo(()=>c.trim()!==""||A.trim()!==""||m.trim()!==""||g!=="ANY"||Te.trim()!=="",[c,A,m,g,Te]),[wt,At]=x.useState(!1);x.useEffect(()=>{var Be;const he=window.matchMedia("(max-width: 900px)"),le=()=>At(he.matches);return le(),(Be=he.addEventListener)==null||Be.call(he,"change",le),()=>{var je;return(je=he.removeEventListener)==null?void 0:je.call(he,"change",le)}},[]);const[bt,ke]=x.useState(!1);x.useEffect(()=>{const he=ij(Zd,async le=>{if(!le)return ke(!1);try{const Be=await Bs(Yt(Fe,"users",le.uid)),je=Be.exists()?Be.data():null,Ae=je?Array.isArray(je.roles)?je.roles:je.role?[je.role]:[]:[];ke(sn(Ae,"admin"))}catch(Be){console.error(Be),ke(!1)}});return()=>he()},[]);const Ne=async he=>{var le;if(H==="search"){f(he);const Be=Object.keys(I).find(Qe=>(I[Qe]||"")===he),je=(le=o.find(Qe=>String(Qe.productId||"").includes(he)))==null?void 0:le.productId,Ae=Be||je||null;Ae&&(we(Ae),b(!1)),R(!1);return}if(H==="edit"&&ve)try{const Be=_t(Fe,"products_candies"),je=Yt(Be,ve);await pn(je,{barcode:he}),_(Ae=>({...Ae,[ve]:he})),ze(he),R(!1),ne("search"),s(" Producto guardado.")}catch(Be){console.error(Be),s(" Error guardando el cdigo.")}},Ve=async he=>{l(le=>le.map(Be=>Be.productId===he?{...Be,priceIsla:Number(He||0),priceRivas:Number(re||0)}:Be));try{const le=String(yt||"").trim();await pn(Yt(_t(Fe,"products_candies"),he),{packaging:le||""}),Se(Be=>({...Be,[he]:le||""}))}catch(le){console.error("Error updating packaging:",le),s(" Error guardando empaque.")}U(null),s(wt?" Producto guardado.":"")};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Precio Ventas"}),i.jsx("div",{className:"flex gap-2",children:i.jsx(pc,{onClick:e,loading:r})})]}),i.jsxs("div",{className:"md:hidden mb-3",children:[i.jsxs("button",{type:"button",onClick:()=>b(he=>!he),className:`w-full px-3 py-3 rounded-xl border shadow-sm flex items-center justify-between ${Ke?"bg-yellow-50 border-yellow-200":"bg-white"}`,children:[i.jsxs("div",{className:"text-left",children:[i.jsx("div",{className:"font-semibold",children:"Filtros"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[Ke?"Activos":"Ninguno","  ","Mostrando ",i.jsx("b",{children:G.length})]})]}),i.jsx("div",{className:"text-sm font-semibold",children:y?"Cerrar":"Abrir"})]}),y&&i.jsx("div",{className:"mt-2 bg-white border rounded-xl shadow-sm p-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:c,onChange:he=>u(he.target.value),placeholder:"Ej: Conitos, Gomitas"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:Te,onChange:he=>O(he.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Buscar por EAN"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",value:d,onChange:he=>f(he.target.value),placeholder:"Cdigo EAN"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{ne("search"),R(!0)},children:"Escanear"})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{Z(),f("")},children:"Limpiar filtros"}),i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",onClick:()=>b(!1),children:"Aplicar"})]})]})})]}),i.jsxs("div",{className:"hidden md:block bg-white p-3 rounded shadow border mb-3 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-6 gap-3 items-end",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Filtrar por producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:c,onChange:he=>u(he.target.value),placeholder:"Ej: Conitos, Gomitas"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Te,onChange:he=>O(he.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio mn"}),i.jsx("input",{className:"w-full border rounded px-2 py-1 text-right",inputMode:"decimal",value:A,onChange:he=>h(he.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio mx"}),i.jsx("input",{className:"w-full border rounded px-2 py-1 text-right",inputMode:"decimal",value:m,onChange:he=>p(he.target.value),placeholder:"0"})]}),i.jsx("div",{className:"text-right",children:i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:Z,children:"Limpiar"})})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Fuente: ",i.jsx("b",{children:"candy_main_orders.items[]"}),"  Muestra el"," ",i.jsx("b",{children:"ltimo precio"})," registrado por producto."]}),i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Mostrando:"})," ",i.jsx("b",{children:G.length})]})]})]}),i.jsxs("div",{className:"md:hidden",children:[r?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Cargando"}):G.length===0?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Sin resultados."}):i.jsx("div",{className:"space-y-2",children:z.map(([he,le])=>{const Be=!!w[he];return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>L(he),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[13px] font-semibold truncate",children:he}),i.jsxs("div",{className:"text-[10px] text-gray-600 truncate",children:[le.length," ",le.length===1?"producto":"productos"]})]}),i.jsx("div",{className:"text-sm font-semibold",children:Be?"":"+"})]}),Be&&i.jsx("div",{className:"px-3 pb-3 border-t space-y-2",children:le.map(je=>{const Ae=ue===je.productId,Qe=ve===je.productId,Ct=D[je.productId]||0,pt=je.priceIsla-Ct,me=pt*.25;return i.jsxs("div",{className:"bg-white border rounded-xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>we(te=>te===je.productId?null:je.productId),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[13px] font-semibold truncate",children:je.productName}),i.jsx("div",{className:"text-[10px] text-gray-600 truncate",children:je.category})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"P. Paquete"}),i.jsx("div",{className:"text-sm font-semibold tabular-nums",children:Km(je.priceIsla)})]})]}),Ae&&i.jsx("div",{className:"px-3 pb-3 border-t",children:i.jsxs("div",{className:"pt-3 space-y-2 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Categora"}),i.jsx("div",{className:"text-sm",children:je.category}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Unidades x paquete"}),i.jsx("div",{className:"text-sm",children:String(je.unitsPerPackage||1)})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Precio Unidad"}),i.jsx("div",{className:"text-sm tabular-nums",children:Km(je.priceIsla/(je.unitsPerPackage||1))})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Precio Paquete"}),Qe?i.jsx("input",{className:"w-full border rounded px-2 py-2 text-right",inputMode:"decimal",value:String(He),onChange:te=>se(Number(te.target.value||0))}):i.jsx("div",{className:"text-sm font-semibold tabular-nums",children:Km(je.priceIsla)})]})]}),i.jsxs("div",{children:[bt&&i.jsxs("div",{children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Utilidad Bruta"}),i.jsx("div",{className:"text-sm tabular-nums",children:Km(pt)})]}),i.jsxs("div",{className:"mt-1",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Comisin"}),i.jsx("div",{className:"text-sm tabular-nums",children:Km(me)})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Cdigo EAN"}),Qe?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",value:Me,readOnly:!0}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white",onClick:()=>{ne("edit"),R(!0)},type:"button",children:"Escanear"})]}):i.jsx("div",{children:I[je.productId]||""})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Tipo Empaque"}),Qe?i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:yt,onChange:te=>It(te.target.value),children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):i.jsx("div",{className:"text-sm",children:ae[je.productId]||""})]})]})]}),i.jsx("div",{className:"flex gap-2",children:Qe?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white",onClick:()=>{Ve(je.productId),we(null)},type:"button",children:"Guardar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{ne("edit"),R(!0)},type:"button",children:"Escanear"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200",onClick:()=>U(null),type:"button",children:"Cancelar"})]}):bt&&i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-3 py-2 rounded bg-yellow-400",onClick:()=>{U(je.productId),se(je.priceIsla||0),Pe(je.priceRivas||0),ze(I[je.productId]||""),It(ae[je.productId]||"")},type:"button",children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white",onClick:()=>l(te=>te.filter(ie=>ie.productId!==je.productId)),type:"button",children:"Borrar"})]})})]})})]},je.productId)})})]},he)})}),a&&i.jsx("p",{className:"mt-2 text-sm",children:a})]}),i.jsx(Yst,{open:ee,onClose:()=>R(!1),onDetected:Ne}),i.jsx("div",{className:"hidden md:block bg-white rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[900px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-left",children:"Empaque"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio Isla"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio Rivas"}),i.jsx("th",{className:"p-2 border text-right",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Cargando"})}):G.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Sin resultados."})}):G.map(he=>i.jsxs("tr",{children:[i.jsx("td",{className:"p-2 border",children:he.category}),i.jsx("td",{className:"p-2 border",children:he.productName}),i.jsx("td",{className:"p-2 border",children:ve===he.productId?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:yt,onChange:le=>It(le.target.value),children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):ae[he.productId]||""}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:ve===he.productId?i.jsx("input",{className:"w-24 border rounded px-2 py-1 text-right",inputMode:"decimal",value:String(He),onChange:le=>se(Number(le.target.value||0))}):Km(he.priceIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:ve===he.productId?i.jsx("input",{className:"w-24 border rounded px-2 py-1 text-right",inputMode:"decimal",value:String(re),onChange:le=>Pe(Number(le.target.value||0))}):Km(he.priceRivas)}),i.jsx("td",{className:"p-2 border text-right",children:ve===he.productId?i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white text-sm",onClick:()=>Ve(he.productId),type:"button",children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 text-sm",onClick:()=>U(null),type:"button",children:"Cancelar"})]}):bt&&i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 text-sm",onClick:()=>{U(he.productId),se(he.priceIsla||0),Pe(he.priceRivas||0),ze(I[he.productId]||"")},type:"button",children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white text-sm",onClick:()=>{U(he.productId),ne("edit"),R(!0)},type:"button",children:"Escanear"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white text-sm",onClick:()=>l(le=>le.filter(Be=>Be.productId!==he.productId)),type:"button",children:"Borrar"})]})})]},he.productId))})]})}),a&&i.jsx("p",{className:"hidden md:block mt-2 text-sm",children:a})]})}const __=["Cuaderno","Block","Lapicero","Lpiz","Tajador","Borrador","Corrector","Cartucheras"],Lz=["Lider","Scribe","Smarty","Pointer","Paper Mate","Otro"],vB=["Hombre","Mujer","Variado","NA"],Zst=["Universitario Cocido","5 Materia","2 Materia","Doble Raya","Rayado","Cuadriculado","Subrayado","Sublineado","Liso"],Sl=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function to(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function rc(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function mE(t,e=1){const r=Math.floor(rc(t,e));return r>0?r:e}function Vue(t){return!Number.isFinite(t)||t<=0?0:t}function yB(t){const e=String(t??"").trim();return e||""}function Rd(t,e){const r=Object.keys(t||{}),n=new Map;r.forEach(a=>n.set(to(a),a));for(const a of e){const s=n.get(to(a));if(s!=null)return t[s]}}function eit(t){return Object.values(t||{}).every(r=>to(r)==="")}function px(t){const e=Math.max(0,rc(t.providerPrice,0)),r=Math.max(1,mE(t.quantity,1)),n=Vue(rc(t.margin,0)),a=Math.max(0,rc(t.salePrice,0)),s=n>0?e/n:e,o=a>0?a:s,l=o>0?e/o:n,c=e*r,u=(o-e)*r,d=o*r;return{providerPrice:e,quantity:r,margin:l,salePrice:o,facturado:c,gain:u,totalEsperado:d}}function tit(){const{refreshKey:t,refresh:e}=gc(),[r,n]=x.useState(!0),[a,s]=x.useState(""),[o,l]=x.useState([]),[c,u]=x.useState(!1),[d,f]=x.useState(""),[A,h]=x.useState(""),[m,p]=x.useState(""),[g,v]=x.useState(""),[y,b]=x.useState(!1),[w,j]=x.useState(null),[I,_]=x.useState(!1),[S,E]=x.useState(null),[F,k]=x.useState(__[0]),[P,D]=x.useState(Lz[0]),[X,pe]=x.useState(""),[ge,fe]=x.useState(0),[xe,ae]=x.useState(1),[Se,Te]=x.useState(.7),[O,G]=x.useState(0),[z,L]=x.useState("NA"),[Z,ee]=x.useState(""),[R,H]=x.useState(""),[ne,ve]=x.useState(!1),[U,He]=x.useState(""),[se,re]=x.useState([]),[Pe,ue]=x.useState([]),[we,Me]=x.useState(!1);x.useEffect(()=>{(async()=>{n(!0),s("");try{const me=await Qt(er(_t(Fe,"products_stationery"))),te=[];me.forEach(ie=>{const $e=ie.data();te.push({id:ie.id,category:$e.category||"",brand:$e.brand||"",name:$e.name||"",providerPrice:Number($e.providerPrice||0),quantity:Number($e.quantity||1),facturado:Number($e.facturado||0),margin:Number($e.margin||0),salePrice:Number($e.salePrice||0),gain:Number($e.gain||0),gender:$e.gender||"NA",typeProduct:$e.typeProduct||"",code:$e.code??"",createdAt:$e.createdAt,updatedAt:$e.updatedAt,totalEsperado:Number($e.totalEsperado||Number($e.salePrice||0)*Number($e.quantity||1))})}),l(te)}catch(me){console.error(me),s(" Error cargando productos (papelera).")}finally{n(!1)}})()},[t]);const ze=x.useMemo(()=>{const me=to(d),te=to(A),ie=m.trim()===""?null:rc(m,NaN),$e=g.trim()===""?null:rc(g,NaN);return o.filter(de=>!(me&&!`${de.category} ${de.name}`.toLowerCase().includes(me)||te&&!String(de.code||"").toLowerCase().includes(te)||ie!=null&&Number.isFinite(ie)&&de.salePrice<ie||$e!=null&&Number.isFinite($e)&&de.salePrice>$e))},[o,d,A,m,g]),yt=x.useMemo(()=>d.trim()!==""||A.trim()!==""||m.trim()!==""||g.trim()!=="",[d,A,m,g]),It=x.useMemo(()=>{const me=o.length,te=o.reduce((de,Ce)=>de+(Ce.facturado||0),0),ie=o.reduce((de,Ce)=>de+Number(Ce.totalEsperado||Number(Ce.salePrice||0)*Number(Ce.quantity||1)),0),$e=o.reduce((de,Ce)=>de+(Ce.gain||0),0);return{count:me,sumFact:te,sumEsperado:ie,sumGain:$e}},[o]),Ke=()=>{k(__[0]),pe(""),fe(0),ae(1),Te(.7),G(0),L("NA"),ee(""),H(""),j(null)},wt=()=>{Ke(),b(!0)},At=me=>{j(me),k(me.category||__[0]),D(me.brand||Lz[0]),pe(me.name||""),fe(Number(me.providerPrice||0)),ae(Number(me.quantity||1)),Te(Number(me.margin||.7)),G(Number(me.salePrice||0)),L(me.gender||"NA"),ee(me.typeProduct||""),H(String(me.code||"")),b(!0)},bt=async()=>{s("");const me=String(F||"").trim(),te=String(P||"").trim(),ie=String(X||"").trim(),{providerPrice:$e,quantity:de,margin:Ce,salePrice:nt,facturado:vt,totalEsperado:ht,gain:xt}=px({providerPrice:ge,quantity:xe,margin:Se,salePrice:O});if(!me)return s(" Categora requerida.");if(!ie)return s(" Producto requerido.");if($e<=0)return s(" Precio proveedor debe ser > 0.");if(de<=0)return s(" Cantidad debe ser > 0.");if(nt<=0)return s(" Precio venta invlido.");if(Ce<=0)return s(" Margen invlido.");const Xe={category:me,brand:te,name:ie,providerPrice:$e,quantity:de,facturado:vt,margin:Ce,salePrice:nt,gain:xt,gender:z||"NA",typeProduct:String(Z||"").trim(),code:yB(R)||null,updatedAt:dr.now(),totalEsperado:ht};try{n(!0),w?(await pn(Yt(Fe,"products_stationery",w.id),Xe),s(" Producto actualizado.")):(await On(_t(Fe,"products_stationery"),{...Xe,createdAt:dr.now()}),s(" Producto creado.")),b(!1),j(null),Ke(),e()}catch(be){console.error(be),s(" Error guardando producto.")}finally{n(!1)}},ke=async()=>{var me;try{const te=new b2,ie=await b2.listVideoInputDevices(),$e=(me=ie[ie.length-1])==null?void 0:me.deviceId;if(!$e)return null;const de=document.createElement("div");de.className="fixed inset-0 z-[9999] bg-black/70 flex items-center justify-center p-3";const Ce=document.createElement("div");Ce.className="bg-white w-full max-w-md rounded-xl overflow-hidden shadow-xl";const nt=document.createElement("div");nt.className="p-3 flex items-center justify-between border-b",nt.innerHTML="<div style='font-weight:700'>Escanear cdigo</div>";const vt=document.createElement("button");vt.textContent="Cerrar",vt.className="px-3 py-1 rounded bg-gray-200";const ht=document.createElement("div");ht.className="p-3";const xt=document.createElement("video");return xt.style.width="100%",xt.style.borderRadius="12px",ht.appendChild(xt),nt.appendChild(vt),Ce.appendChild(nt),Ce.appendChild(ht),de.appendChild(Ce),document.body.appendChild(de),await new Promise(async Xe=>{const be=()=>{de.remove(),Xe(null)};vt.onclick=be;const st=await te.decodeFromVideoDevice($e,xt,K=>{if(K){const Ie=K.getText();try{st.stop()}catch{}de.remove(),Xe(Ie)}})})}catch(te){return console.error(te),null}},Ne=async()=>{const me=await ke();me&&H(me)},Ve=async()=>{const me=await ke();if(!me)return;const te=o.find(ie=>String(ie.code||"")===String(me));te?(E(te),_(!0),s("")):(E(null),_(!0),s(""))},he=(me,te)=>{const ie=me.map(Ce=>({Id:Ce.id,Categoria:Ce.category,brand:Ce.brand,Producto:Ce.name,PrecioProveedor:Ce.providerPrice,Cantidad:Ce.quantity,Facturado:Ce.facturado,TotalEsperado:Ce.totalEsperado||Ce.salePrice*Ce.quantity,Margen:Ce.margin,PrecioVenta:Ce.salePrice,Ganancia:Ce.gain,Genero:Ce.gender,TipoProducto:Ce.typeProduct,Codigo:Ce.code||""})),$e=$s.json_to_sheet(ie),de=$s.book_new();$s.book_append_sheet(de,$e,"Productos"),rF(de,te)},le=()=>{const me=[{Id:"",Categoria:"Cuaderno",brand:"Lider",Producto:"Cuaderno Norma 100 hojas",PrecioProveedor:120,Cantidad:12,Margen:.7,PrecioVenta:"",Genero:"NA",TipoProducto:"Universitario Cocido",Codigo:"1234567890123"}],te=$s.json_to_sheet(me),ie=$s.book_new();$s.book_append_sheet(ie,te,"Productos");const $e=iP(ie,{type:"array",bookType:"xlsx"}),de=new Blob([$e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Ce=URL.createObjectURL(de),nt=document.createElement("a");nt.href=Ce,nt.download="template_products_stationery.xlsx",document.body.appendChild(nt),nt.click(),nt.remove(),URL.revokeObjectURL(Ce)},Be=me=>{const te=[],ie=[];me.forEach((de,Ce)=>{if(!de||typeof de!="object"||eit(de))return;const nt=Ce+2,vt=String(Rd(de,["Id","ID","docId","DocId"])??"").trim(),ht=String(Rd(de,["Categoria","Categora","Category","category"])??"").trim(),xt=String(Rd(de,["Brand","Marca","brand","marca"])??"").trim(),Xe=String(Rd(de,["Producto","Product","Nombre","Name","name"])??"").trim(),be=Rd(de,["PrecioProveedor","Precio Prov","Precio Prov.","ProviderPrice","Costo","providerPrice"]),st=Rd(de,["Cantidad","Qty","quantity","cantidad"]),K=Rd(de,["Margen","Margin","margen","margin"]),Ie=Rd(de,["PrecioVenta","Precio Venta","SalePrice","salePrice"]),Ze=String(Rd(de,["Genero","Gnero","Gender","gender"])??"NA").trim(),at=String(Rd(de,["TipoProducto","Tipo","TypeProduct","typeProduct","Tipo producto"])??"").trim(),it=Rd(de,["Codigo","Cdigo","Code","Barcode","code"]),T=yB(it),M=Math.max(0,rc(be,0)),V=Math.max(1,mE(st,1)),q=Vue(rc(K,0)),Y=Math.max(0,rc(Ie,0));ht||ie.push(`Fila ${nt}: falta Categoria.`),Xe||ie.push(`Fila ${nt}: falta Producto.`),M<=0&&ie.push(`Fila ${nt}: PrecioProveedor debe ser > 0.`),V<=0&&ie.push(`Fila ${nt}: Cantidad debe ser > 0.`),q<=0&&Y<=0&&ie.push(`Fila ${nt}: Margen debe ser > 0 (o enviar PrecioVenta).`);const De=vB.includes(Ze||"NA")?Ze:"NA";ht&&Xe&&M>0&&V>0&&(q>0||Y>0)&&te.push({id:vt||void 0,category:ht,brand:xt,name:Xe,providerPrice:M,quantity:V,margin:q>0?q:.7,salePrice:Y>0?Y:void 0,gender:De,typeProduct:at,code:T||"",_raw:de})});const $e=new Map;for(const de of te){const Ce=de.id?`id::${de.id}`:`${to(de.category)}::${to(de.name)}`;$e.set(Ce,de)}return{rows:Array.from($e.values()),errors:ie}},je=async me=>{if(s(""),ue([]),re([]),He((me==null?void 0:me.name)||""),!me)return;const te=me.name.toLowerCase(),ie=te.endsWith(".xlsx")||te.endsWith(".xls"),$e=te.endsWith(".csv");if(!ie&&!$e){ue(["Solo se permiten archivos .xlsx, .xls o .csv"]);return}try{Me(!0);const de=new FileReader,Ce=await new Promise((st,K)=>{de.onerror=()=>K(new Error("No se pudo leer el archivo.")),de.onload=()=>st(de.result),de.readAsArrayBuffer(me)}),nt=O2(new Uint8Array(Ce),{type:"array"}),vt=nt.SheetNames[0],ht=nt.Sheets[vt],xt=$s.sheet_to_json(ht,{defval:""}),{rows:Xe,errors:be}=Be(xt);re(Xe),ue(be),Xe.length===0&&be.length===0&&ue(["No se encontraron filas vlidas para importar."])}catch(de){console.error(de),ue(["Error leyendo el archivo. Revis que no est corrupto."])}finally{Me(!1)}},Ae=(me,te)=>{re(ie=>{const $e=[...ie],de=$e[me];return de?($e[me]={...de,...te},$e):ie})},Qe=x.useMemo(()=>{const me=new Set(o.map(de=>de.id)),te=new Set(o.map(de=>`${to(de.category)}::${to(de.name)}`));let ie=0,$e=0;for(const de of se){if(de.id&&me.has(de.id)){ie+=1;continue}const Ce=`${to(de.category)}::${to(de.name)}`;te.has(Ce)?ie+=1:$e+=1}return{total:se.length,willCreate:$e,willUpdate:ie}},[se,o]),Ct=async()=>{if(s(""),Pe.length>0){s(" Correg los errores antes de importar.");return}if(se.length===0){s(" No hay filas para importar.");return}try{Me(!0);const me={},te={};o.forEach(Ce=>{me[Ce.id]=Ce,te[`${to(Ce.category)}::${to(Ce.name)}`]=Ce});const ie=Jd(Fe);let $e=0,de=0;for(const Ce of se){const nt=String(Ce.category||"").trim(),vt=String(Ce.name||"").trim(),{providerPrice:ht,quantity:xt,margin:Xe,salePrice:be,facturado:st,totalEsperado:K,gain:Ie}=px({providerPrice:Ce.providerPrice,quantity:Ce.quantity,margin:Ce.margin,salePrice:Ce.salePrice});if(!nt||!vt||ht<=0||xt<=0||be<=0||Xe<=0)continue;const Ze={category:nt,name:vt,providerPrice:ht,quantity:xt,facturado:st,totalEsperado:K,margin:Xe,salePrice:be,gain:Ie,gender:Ce.gender||"NA",typeProduct:String(Ce.typeProduct||"").trim(),code:yB(Ce.code)||null,updatedAt:dr.now()};let at;if(Ce.id&&me[Ce.id])at=me[Ce.id];else{const it=`${to(nt)}::${to(vt)}`;at=te[it]}if(at)ie.update(Yt(Fe,"products_stationery",at.id),Ze),de+=1;else{const it=Yt(_t(Fe,"products_stationery"));ie.set(it,{...Ze,createdAt:dr.now()}),$e+=1}}await ie.commit(),s(` Importacin lista. Creados: ${$e}, Actualizados: ${de}`),ve(!1),re([]),ue([]),He(""),e()}catch(me){console.error(me),s(" Error importando productos a Firestore.")}finally{Me(!1)}},pt=()=>{f(""),h(""),p(""),v("")};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Papelera"}),i.jsxs("div",{className:"flex gap-2 flex-wrap justify-end",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-900 text-white hover:bg-black",onClick:Ve,type:"button",children:"Escanear"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:wt,type:"button",children:"+ Nuevo"}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",onClick:()=>{ve(!0),re([]),ue([]),He("")},type:"button",children:"Importar (.xlsx)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>he(o,"products_stationery_todo.xlsx"),type:"button",children:"Exportar (todo)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>he(ze,"products_stationery_filtrado.xlsx"),type:"button",children:"Exportar (filtrado)"}),i.jsx(pc,{onClick:e,loading:r||we})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[i.jsx(E_,{label:"Productos",value:It.count}),i.jsx(E_,{label:"Facturado",value:Sl(It.sumFact)}),i.jsx(E_,{label:"Esperado",value:Sl(It.sumEsperado)}),i.jsx(E_,{label:"Ganancia",value:Sl(It.sumGain)})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{className:`w-full md:w-auto px-3 py-2 rounded border bg-white hover:bg-gray-50 ${yt?"border-yellow-300 bg-yellow-50":""}`,type:"button",onClick:()=>u(me=>!me),children:[c?"Cerrar filtros":"Abrir filtros"," ",yt?"(activos)":""]}),c&&i.jsxs("div",{className:"mt-2 bg-white border rounded-xl shadow-sm p-3 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 items-end",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:d,onChange:me=>f(me.target.value),placeholder:"Ej: Cuaderno Norma"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cdigo"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:A,onChange:me=>h(me.target.value),placeholder:"Barcode"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio venta mn"}),i.jsx("input",{className:"w-full border rounded px-2 py-2 text-right",inputMode:"decimal",value:m,onChange:me=>p(me.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio venta mx"}),i.jsx("input",{className:"w-full border rounded px-2 py-2 text-right",inputMode:"decimal",value:g,onChange:me=>v(me.target.value),placeholder:"0"})]}),i.jsxs("div",{className:"md:col-span-4 flex gap-2 justify-end",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:pt,children:"Limpiar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",type:"button",onClick:()=>u(!1),children:"Aplicar"})]})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-gray-600",children:[i.jsxs("div",{children:["Mostrando: ",i.jsx("b",{children:ze.length})]}),i.jsxs("div",{children:["Coleccin: ",i.jsx("b",{children:"products_stationery"})]})]})]})]}),i.jsx("div",{className:"md:hidden space-y-2",children:r?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Cargando"}):ze.length===0?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Sin resultados."}):ze.map(me=>i.jsxs("div",{className:"bg-white border rounded-xl p-3 shadow-sm",children:[i.jsx("div",{className:"text-xs text-gray-600",children:me.category}),i.jsx("div",{className:"text-base font-bold leading-tight",children:me.name}),i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Venta"}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:Sl(me.salePrice)})]}),i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Ganancia"}),i.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["Esperado:"," ",i.jsx("b",{children:Sl(me.totalEsperado||me.salePrice*me.quantity)})]}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:Sl(me.gain)})]})]}),i.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["Cdigo: ",i.jsx("b",{children:me.code||""})]}),i.jsx("div",{className:"mt-2 flex gap-2",children:i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-yellow-400 hover:bg-yellow-500",type:"button",onClick:()=>At(me),children:"Editar"})})]},me.id))}),i.jsx("div",{className:"hidden md:block bg-white border rounded overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Facturado"}),i.jsx("th",{className:"p-2 border text-right",children:"Esperado"}),i.jsx("th",{className:"p-2 border text-right",children:"Margen"}),i.jsx("th",{className:"p-2 border text-right",children:"Venta"}),i.jsx("th",{className:"p-2 border text-right",children:"Ganancia"}),i.jsx("th",{className:"p-2 border text-left",children:"Gnero"}),i.jsx("th",{className:"p-2 border text-left",children:"Tipo"}),i.jsx("th",{className:"p-2 border text-left",children:"Cdigo"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:12,children:"Cargando"})}):ze.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:12,children:"Sin resultados."})}):ze.map(me=>i.jsxs("tr",{className:"align-top",children:[i.jsx("td",{className:"p-2 border",children:me.category}),i.jsx("td",{className:"p-2 border",children:me.name}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Sl(me.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:me.quantity}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Sl(me.facturado)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Sl(me.totalEsperado||me.salePrice*me.quantity)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Number(me.margin||0).toFixed(2)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Sl(me.salePrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Sl(me.gain)}),i.jsx("td",{className:"p-2 border",children:me.gender}),i.jsx("td",{className:"p-2 border",children:me.typeProduct}),i.jsx("td",{className:"p-2 border",children:me.code||""}),i.jsx("td",{className:"p-2 border text-center",children:i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 hover:bg-yellow-500",type:"button",onClick:()=>At(me),children:"Editar"})})]},me.id))})]})}),a&&i.jsx("p",{className:"mt-2 text-sm",children:a}),y&&i.jsxs(Uz,{onClose:()=>b(!1),title:w?"Editar producto":"Nuevo producto",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Categora"}),i.jsx("select",{className:"w-full border rounded px-2 py-2",value:F,onChange:me=>k(me.target.value),children:__.map(me=>i.jsx("option",{value:me,children:me},me))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:X,onChange:me=>pe(me.target.value),placeholder:"Ej: Cuaderno Norma..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio proveedor"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-2 text-right",value:Number.isNaN(ge)?"":ge,onChange:me=>fe(Math.max(0,rc(me.target.value,0)))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cantidad"}),i.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-2 text-right",value:xe,onChange:me=>ae(mE(me.target.value,1))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Facturado (auto)"}),i.jsx("div",{className:"w-full border rounded px-2 py-2 text-right bg-gray-50 tabular-nums",children:Sl(px({providerPrice:ge,quantity:xe,margin:Se,salePrice:O}).facturado)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Margen"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-2 text-right",value:Number.isNaN(Se)?"":Se,onChange:me=>Te(Math.max(0,rc(me.target.value,0)))}),i.jsx("div",{className:"text-[11px] text-gray-600 mt-1",children:"Ej: 0.70 / 0.80"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio venta (editable)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-2 text-right",value:Number.isNaN(px({providerPrice:ge,quantity:xe,margin:Se,salePrice:O}).salePrice)?"":px({providerPrice:ge,quantity:xe,margin:Se,salePrice:O}).salePrice,onChange:me=>{G(Math.max(0,rc(me.target.value,0)))}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Ganancia (auto)"}),i.jsx("div",{className:"w-full border rounded px-2 py-2 text-right bg-gray-50 tabular-nums",children:Sl(px({providerPrice:ge,quantity:xe,margin:Se,salePrice:O}).gain)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Gnero"}),i.jsx("select",{className:"w-full border rounded px-2 py-2",value:z,onChange:me=>L(me.target.value),children:vB.map(me=>i.jsx("option",{value:me,children:me},me))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo producto"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:Z,onChange:me=>ee(me.target.value),children:[i.jsx("option",{value:"",children:""}),Zst.map(me=>i.jsx("option",{value:me,children:me},me))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Cdigo"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",value:R,onChange:me=>H(me.target.value),placeholder:"Escane o peg el cdigo"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:Ne,children:"Escanear"})]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:()=>{b(!1),j(null)},children:"Cancelar"}),i.jsx("button",{className:"px-4 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",type:"button",onClick:bt,disabled:r,children:"Guardar"})]})]}),I&&i.jsx(Uz,{onClose:()=>_(!1),title:"Resultado de escaneo",children:S?i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"text-xs text-gray-600",children:S.category}),i.jsx("div",{className:"text-lg font-bold",children:S.name}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Precio venta"}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:Sl(S.salePrice)})]}),i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Ganancia"}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:Sl(S.gain)})]})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"rounded-lg border p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Proveedor"}),i.jsx("div",{className:"font-semibold tabular-nums",children:Sl(S.providerPrice)})]}),i.jsxs("div",{className:"rounded-lg border p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Cantidad"}),i.jsx("div",{className:"font-semibold tabular-nums",children:S.quantity})]}),i.jsxs("div",{className:"rounded-lg border p-2 col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Cdigo"}),i.jsx("div",{className:"font-semibold tabular-nums",children:S.code||""})]})]}),i.jsx("div",{className:"mt-4 flex justify-end",children:i.jsx("button",{className:"px-4 py-2 rounded bg-yellow-400 hover:bg-yellow-500",type:"button",onClick:()=>{_(!1),At(S)},children:"Editar"})})]}):i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"font-semibold",children:"No encontrado"}),i.jsxs("div",{className:"text-gray-600 mt-1",children:["Ese cdigo no existe en ",i.jsx("b",{children:"products_stationery"}),"."]})]})}),ne&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-6xl max-h-[90vh] overflow-y-auto rounded shadow-lg p-5 text-sm",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Importar papelera (.xlsx / .csv)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ve(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:[i.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-end md:justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"1) Sub tu archivo"}),i.jsx("div",{className:"text-xs text-gray-600",children:"Columnas esperadas: Id (opcional), Categoria, Producto, PrecioProveedor, Cantidad, Margen (o PrecioVenta), Genero, TipoProducto, Codigo."})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:le,type:"button",children:"Descargar template .xlsx"})]}),i.jsxs("div",{className:"mt-3 flex flex-col md:flex-row gap-3 md:items-center",children:[i.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:me=>{var te;return je(((te=me.target.files)==null?void 0:te[0])||null)}}),U&&i.jsxs("span",{className:"text-xs text-gray-600",children:["Archivo: ",i.jsx("b",{children:U})]}),we&&i.jsx("span",{className:"text-xs",children:"Procesando"})]})]}),Pe.length>0&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3 mb-3",children:[i.jsx("div",{className:"font-semibold text-red-700 mb-2",children:"Errores encontrados"}),i.jsx("ul",{className:"list-disc pl-5 text-red-700 text-xs space-y-1",children:Pe.slice(0,60).map((me,te)=>i.jsx("li",{children:me},te))})]}),i.jsxs("div",{className:"bg-white border rounded p-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"2) Previsualizacin (editable)"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Se importarn ",Qe.total," filas (Crear:"," ",Qe.willCreate," / Actualizar:"," ",Qe.willUpdate,")"]})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50",onClick:Ct,disabled:we||se.length===0||Pe.length>0,type:"button",children:"Importar a Firestore"})]}),i.jsxs("div",{className:"overflow-x-auto border rounded",children:[i.jsxs("table",{className:"min-w-[1500px] w-full text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Id (opcional)"}),i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Margen"}),i.jsx("th",{className:"p-2 border text-right",children:"PrecioVenta"}),i.jsx("th",{className:"p-2 border text-left",children:"Gnero"}),i.jsx("th",{className:"p-2 border text-left",children:"Tipo"}),i.jsx("th",{className:"p-2 border text-left",children:"Cdigo"}),i.jsx("th",{className:"p-2 border text-center",children:"Accin"})]})}),i.jsx("tbody",{children:se.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center text-gray-500",children:"Sub un archivo para ver la previsualizacin."})}):se.slice(0,300).map((me,te)=>{const ie=me.id?o.some(Ce=>Ce.id===me.id):!1,$e=o.some(Ce=>`${to(Ce.category)}::${to(Ce.name)}`==`${to(me.category)}::${to(me.name)}`),de=ie||$e;return i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:me.id||"",onChange:Ce=>Ae(te,{id:Ce.target.value.trim()||void 0}),placeholder:"docId (update exacto)"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-44 border rounded px-2 py-1",value:me.category,onChange:Ce=>Ae(te,{category:Ce.target.value})})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-72 border rounded px-2 py-1",value:me.name,onChange:Ce=>Ae(te,{name:Ce.target.value})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",className:"w-28 border rounded px-2 py-1 text-right",value:me.providerPrice,onChange:Ce=>Ae(te,{providerPrice:Math.max(0,rc(Ce.target.value,0))})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:me.quantity,onChange:Ce=>Ae(te,{quantity:mE(Ce.target.value,1)})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",className:"w-24 border rounded px-2 py-1 text-right",value:me.margin,onChange:Ce=>Ae(te,{margin:Math.max(0,rc(Ce.target.value,0))})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",className:"w-28 border rounded px-2 py-1 text-right",value:me.salePrice??"",onChange:Ce=>Ae(te,{salePrice:Math.max(0,rc(Ce.target.value,0))||void 0}),placeholder:"Opcional"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("select",{className:"w-28 border rounded px-2 py-1",value:me.gender,onChange:Ce=>Ae(te,{gender:Ce.target.value}),children:vB.map(Ce=>i.jsx("option",{value:Ce,children:Ce},Ce))})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:me.typeProduct,onChange:Ce=>Ae(te,{typeProduct:Ce.target.value})})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:me.code||"",onChange:Ce=>Ae(te,{code:Ce.target.value})})}),i.jsx("td",{className:"p-2 border text-center",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] ${de?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:de?"ACTUALIZA":"CREA"})})]},`${me.id||""}-${te}`)})})]}),se.length>300&&i.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:["Mostrando 300 de ",se.length," filas (importa todas)."]})]})]})]})})]})}function E_({label:t,value:e}){return i.jsxs("div",{className:"bg-white border rounded p-3 shadow-sm",children:[i.jsx("div",{className:"text-xs text-gray-500",children:t}),i.jsx("div",{className:"text-lg font-extrabold",children:e})]})}function Uz({title:t,children:e,onClose:r}){return i.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-3xl p-4 relative",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:t}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:r,type:"button",children:"Cerrar"})]}),e]})})}const Vu=t=>`C$ ${(Number(t)||0).toFixed(2)}`,c0=t=>Number(t||0).toFixed(3),bB=(t,e)=>{var a,s,o,l;const r=t._raw||{},n=t.customerName||r.customerName||((a=r.customer)==null?void 0:a.name)||r.clientName||((s=r.client)==null?void 0:s.name)||"";return t.type==="CONTADO"&&n?n:(t.customerId?e[t.customerId]:"")||t.customerName||r.customerName||((o=r.customer)==null?void 0:o.name)||r.clientName||((l=r.client)==null?void 0:l.name)||"Nombre cliente"},Qz=t=>{const e=t._raw||{},r=$ue(e)||t.date,n=Wx(r);return isFinite(n)?n:NaN},wB=t=>String((t==null?void 0:t.status)||"").toUpperCase()==="PROCESADA"||t!=null&&t.closureId||t!=null&&t.closureDate||t!=null&&t.processedDate?"PROCESADA":"FLOTANTE",rit=t=>String(t??"").toLowerCase().trim(),Vz=t=>["lb","lbs","libra","libras"].includes(rit(t)),Hz=t=>Number((t==null?void 0:t.qty)??(t==null?void 0:t.quantity)??0)||0,nit=t=>t?Array.isArray(t.items)&&t.items.length>0?t.items.reduce((e,r)=>Vz((r==null?void 0:r.measurement)??(t==null?void 0:t.measurement))?e+Hz(r):e,0):Vz(t==null?void 0:t.measurement)?Hz(t):0:0;function Hue(t){if(!t)return"";if(t!=null&&t.toDate)return Nr(t.toDate(),"yyyy-MM-dd");const e=String(t).trim();if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const r=["dd/MM/yyyy","d/M/yyyy","MM/dd/yyyy","M/d/yyyy","yyyy/MM/dd","yyyy-M-d","yyyy/M/d","yyyy-MM-dd'T'HH:mm:ss","yyyy-MM-dd'T'HH:mm:ss.SSSX"];for(const a of r){const s=cS(e,a,new Date);if(A6(s))return Nr(s,"yyyy-MM-dd")}const n=new Date(e);return isNaN(n.getTime())?"":Nr(n,"yyyy-MM-dd")}function Wx(t){const e=Hue(t);if(!e)return NaN;const r=cS(e,"yyyy-MM-dd",new Date);return A6(r)?r.getTime():NaN}function $ue(t){var n,a;const e=Hue(t==null?void 0:t.date),r=(n=t==null?void 0:t.createdAt)!=null&&n.toDate?t.createdAt.toDate():null;if(e&&r){const s=Wx(e),o=r.getTime();if(Math.abs(o-s)/(1e3*60*60*24)>30)return Nr(r,"yyyy-MM-dd")}return e||((a=t==null?void 0:t.timestamp)!=null&&a.toDate?Nr(t.timestamp.toDate(),"yyyy-MM-dd"):r?Nr(r,"yyyy-MM-dd"):"")}function ait(t,e){var s,o,l,c;const r=$ue(t);if(!r)return null;let n=0,a=0;return Array.isArray(t.items)&&t.items.length>0?(n=t.items.reduce((u,d)=>u+(Number(d.qty??d.quantity??d.lbs??0)||0),0),a=Number(t.amount??t.total??0)||0):(n=Number(t.quantity??t.lbs??t.weight??0)||0,a=Number(t.amount??t.total??0)||0),{id:e,date:r,type:t.type||"CONTADO",total:a,quantity:n,customerId:t.customerId||((s=t.customer)==null?void 0:s.id)||((o=t.customer)==null?void 0:o.customerId)||t.clientId||void 0,customerName:t.customerName||((l=t.customer)==null?void 0:l.name)||t.clientName||((c=t.client)==null?void 0:c.name)||void 0,_raw:t}}async function sit(t){const e=er(_t(Fe,"ar_movements"),cr("ref.saleId","==",t)),r=await Qt(e);await Promise.all(r.docs.map(n=>Fn(Yt(Fe,"ar_movements",n.id))))}function iit({role:t="",sellerCandyId:e="",roles:r}){const n=r&&r.length?r:t,a=sn(n,"vendedor_pollo"),s=sn(n,"admin");if(!(sn(n,"admin")||sn(n,"vendedor_pollo")||sn(n,"supervisor_pollo")||sn(n,"contador")))return i.jsx("div",{className:"p-6 max-w-4xl mx-auto text-center text-red-600",children:"Acceso restringido  Solo administradores, vendedores y supervisores de pollo."});const o=s?8:7,[l,c]=x.useState(!1),[u,d]=x.useState(!1),[f,A]=x.useState(null),[h,m]=x.useState([]),p=async Ke=>{c(!0),d(!0),A(Ke),m([]);try{const wt=await Bs(Yt(Fe,"salesV2",Ke)),At=wt.exists()?wt.data():null;if(!At){m([]);return}let bt=[];if(Array.isArray(At.items)&&At.items.length>0)bt=At.items;else if(At.items&&typeof At.items=="object")try{bt=Object.values(At.items)}catch{bt=[]}else At.item?bt=[At.item]:Array.isArray(At.products)&&At.products.length>0?bt=At.products:Array.isArray(At.lines)&&At.lines.length>0?bt=At.lines:Array.isArray(At.detalles)&&At.detalles.length>0?bt=At.detalles:(At.productName||At.product)&&(bt=[{productName:At.productName||At.product||"",qty:At.qty??At.quantity??At.lbs??0,unitPrice:At.unitPrice??At.price??0,discount:At.discount??0,total:At.total??At.amount??0}]);const ke=je=>{if(je==null)return NaN;if(typeof je=="number")return je;let Ae=String(je).trim();if(!Ae)return NaN;if(Ae=Ae.replace(/[^0-9.,-]/g,""),!Ae)return NaN;Ae.indexOf(".")>-1&&Ae.indexOf(",")>-1?Ae=Ae.replace(/,/g,""):Ae.indexOf(",")>-1&&Ae.indexOf(".")===-1&&(Ae=Ae.replace(/,/g,"."));const Qe=Number(Ae);return isNaN(Qe)?NaN:Qe},Ne=new Set;for(const je of bt)if(Array.isArray(je==null?void 0:je.allocations))for(const Ae of je.allocations){const Qe=String((Ae==null?void 0:Ae.batchId)||"").trim();Qe&&Ne.add(Qe)}else if(je!=null&&je.allocations&&typeof je.allocations=="object")try{for(const Ae of Object.values(je.allocations)){const Qe=String((Ae==null?void 0:Ae.batchId)||"").trim();Qe&&Ne.add(Qe)}}catch{}if(Array.isArray(At==null?void 0:At.allocations))for(const je of At.allocations){const Ae=String((je==null?void 0:je.batchId)||"").trim();Ae&&Ne.add(Ae)}const Ve={};Ne.size>0&&await Promise.all(Array.from(Ne).map(async je=>{try{const Ae=await Bs(Yt(Fe,"inventory_batches",je));if(Ae.exists()){const Qe=Ae.data();Ve[je]=Number(Qe.salePrice??Qe.sale_price??Qe.price??0)}}catch{}}));const he=new Set;for(const je of bt){const Ae=String(je.productId||je.productId||"").trim();Ae&&he.add(Ae)}const le={};he.size>0&&await Promise.all(Array.from(he).map(async je=>{try{const Ae=await Bs(Yt(Fe,"products",je));if(Ae.exists()){const Qe=Ae.data();le[je]=Number(Qe.salePrice??Qe.price??0)}}catch{}}));const Be=bt.map(je=>{const Ae=String(je.productName||je.product||je.name||"(sin nombre)"),Qe=Number(je.qty??je.quantity??je.lbs??je.weight??0)||0,Ct=ke(je.total??je.lineFinal??je.amount??je.monto??je.line_total)||0;let pt=0;const me=[je.unitPrice,je.unitPricePackage,je.salePrice,je.sale_price,je.price,je.unit_price,je.pricePerUnit,je.price_per_unit];for(const $e of me){const de=ke($e);if(!isNaN(de)&&de!==0){pt=de;break}}if(!pt){const $e=(At==null?void 0:At.salePrice)??(At==null?void 0:At.sale_price)??(At==null?void 0:At.unitPrice)??(At==null?void 0:At.unit_price)??(At==null?void 0:At.price)??(At==null?void 0:At.pricePerUnit),de=ke($e);!isNaN(de)&&de!==0&&(pt=de)}if(!pt){const $e=Array.isArray(je.allocations)?je.allocations[0]:je.allocations&&typeof je.allocations=="object"?Object.values(je.allocations)[0]:null,de=$e?String($e.batchId||"").trim():"";de&&Ve[de]&&(pt=Ve[de]||0)}!pt&&je.productId&&(pt=le[String(je.productId)]||0),(!pt||pt===0)&&Ct>0&&Qe>0&&(pt=Ct/Qe);const te=ke(je.discount??je.desc??0)||0;let ie=Ct;return(!ie||ie===0)&&(ie=Number(pt*Qe||0)),ie=Number(ie)||0,{productName:Ae,qty:Qe,unitPrice:pt,discount:te,total:ie}});m(Be)}catch(wt){console.error(wt)}finally{d(!1)}},[g,v]=x.useState(Nr(new Date,"yyyy-MM-01")),[y,b]=x.useState(Nr(new Date,"yyyy-MM-dd")),[w,j]=x.useState([]),[I,_]=x.useState([]),[S,E]=x.useState([]),[F,k]=x.useState(!0),[P,D]=x.useState(""),{refreshKey:X,refresh:pe}=gc(),[ge,fe]=x.useState(""),[xe,ae]=x.useState(""),[Se,Te]=x.useState("ALL"),[O,G]=x.useState(""),[z,L]=x.useState(null),Z=15,[ee,R]=x.useState(1),H=x.useMemo(()=>{const Ke={};return w.forEach(wt=>Ke[wt.id]=wt.name),Ke},[w]);x.useEffect(()=>{Se!=="ALL"&&!S.includes(Se)&&Te("ALL")},[S,Se]),x.useEffect(()=>{(async()=>{k(!0),D("");try{const Ke=[];if(a&&e){const Ae=er(_t(Fe,"customers_pollo"),cr("vendorId","==",e),dn("createdAt","desc"));(await Qt(Ae)).forEach(Ct=>Ke.push({id:Ct.id,name:Ct.data().name||""}))}else(await Qt(er(_t(Fe,"customers_pollo"),dn("createdAt","desc")))).forEach(Qe=>Ke.push({id:Qe.id,name:Qe.data().name||""}));j(Ke);const wt={};Ke.forEach(Ae=>{wt[Ae.id]=Ae.name});const[At,bt,ke]=await Promise.all([Qt(er(_t(Fe,"salesV2"),dn("timestamp","desc"))),Qt(er(_t(Fe,"daily_closures"),dn("createdAt","desc"))),Qt(er(_t(Fe,"ar_movements_pollo"),cr("date",">=",g),cr("date","<=",y)))]),Ne=new Map;ke.forEach(Ae=>{var me;const Qe=Ae.data(),Ct=String(((me=Qe==null?void 0:Qe.ref)==null?void 0:me.saleId)||"").trim(),pt=String((Qe==null?void 0:Qe.customerId)||"").trim();Ct&&pt&&Ne.set(Ct,pt)});const Ve=new Map;bt.forEach(Ae=>{const Qe=Ae.data(),Ct=Array.isArray(Qe==null?void 0:Qe.salesV2)?Qe.salesV2:[];for(const pt of Ct){const me=String((pt==null?void 0:pt.id)||"").trim();if(!me)continue;const te=me.split("#")[0];(String((pt==null?void 0:pt.status)||"").toUpperCase()==="PROCESADA"||pt!=null&&pt.closureDate||pt!=null&&pt.processedDate)&&Ve.set(te,{closureDate:pt==null?void 0:pt.closureDate,processedDate:pt==null?void 0:pt.processedDate})}});const he=[];At.forEach(Ae=>{const Qe=Ae.data(),Ct=Ve.get(Ae.id),pt=Ne.get(Ae.id);!Qe.customerId&&pt&&(Qe.customerId=pt),!Qe.customerName&&pt&&(Qe.customerName=wt[pt]||""),Ct&&(Qe.status="PROCESADA",!Qe.closureDate&&Ct.closureDate&&(Qe.closureDate=Ct.closureDate),!Qe.processedDate&&Ct.processedDate&&(Qe.processedDate=Ct.processedDate));const me=ait(Qe,Ae.id);me&&he.push(me)});const le=he.sort((Ae,Qe)=>Qe.date.localeCompare(Ae.date));_(le);const Be=Wx(g),je=Wx(y);E(Array.from(new Set(le.filter(Ae=>{const Qe=Qz(Ae);return!(!isFinite(Qe)||isFinite(Be)&&Qe<Be||isFinite(je)&&Qe>je)}).map(Ae=>{var Qe,Ct,pt,me;return((Qe=Ae._raw)==null?void 0:Qe.productName)||((me=(pt=(Ct=Ae._raw)==null?void 0:Ct.items)==null?void 0:pt[0])==null?void 0:me.productName)||"(sin producto)"}))).sort()),R(1)}catch(Ke){console.error(Ke),D(" Error cargando transacciones.")}finally{k(!1)}})()},[g,y,X]);const ne=x.useMemo(()=>{const Ke=Wx(g),wt=Wx(y);return I.filter(At=>{const bt=Qz(At);return!(!isFinite(bt)||isFinite(Ke)&&bt<Ke||isFinite(wt)&&bt>wt)})},[I,g,y]),ve=x.useMemo(()=>ne.filter(Ke=>{var wt,At,bt,ke;if(ge&&Ke.customerId!==ge||xe&&Ke.type!==xe)return!1;if(Se&&Se!=="ALL"){const Ne=((wt=Ke._raw)==null?void 0:wt.productName)||((ke=(bt=(At=Ke._raw)==null?void 0:At.items)==null?void 0:bt[0])==null?void 0:ke.productName)||"";if(!Ne||Ne!==Se)return!1}return!(O&&wB(Ke._raw)!==O)}),[ne,ge,xe,Se,O]),U=x.useMemo(()=>{let Ke=0,wt=0,At=0,bt=0;for(const Ve of ve){const he=nit(Ve._raw);Ve.type==="CONTADO"?(Ke+=he,At+=Ve.total):(wt+=he,bt+=Ve.total)}const ke=Ke+wt,Ne=At+bt;return{packsCash:Ke,packsCredito:wt,packsTotal:ke,montoCash:At,montoCredito:bt,montoTotal:Ne}},[ve]),He=x.useMemo(()=>{let Ke=0,wt=0;for(const bt of ve)bt.type==="CONTADO"?Ke+=bt.quantity:wt+=bt.quantity;const At=Ke+wt;return{unidadesCash:Ke,unidadesCredito:wt,unidadesTotal:At}},[ve]),se=Math.max(1,Math.ceil(ve.length/Z)),re=x.useMemo(()=>{const Ke=(ee-1)*Z;return ve.slice(Ke,Ke+Z)},[ve,ee]);x.useMemo(()=>f&&I.find(Ke=>Ke.id===f)||null,[f,I]);const Pe=async Ke=>{if(s&&(L(null),!!window.confirm("Eliminar esta venta? Se restaurar el inventario asociado.")))try{k(!0),await wre(Ke.id),await sit(Ke.id),_(wt=>wt.filter(At=>At.id!==Ke.id)),D(" Venta eliminada")}catch(wt){console.error(wt),D(" No se pudo eliminar la venta.")}finally{k(!1)}},ue=()=>{const Ke=`Ventas del dia  ${g} a ${y}`,wt=Ne=>(Ne||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),At=ve.map(Ne=>{var he,le,Be,je;const Ve=bB(Ne,H);return(he=Ne._raw)!=null&&he.productName||(je=(Be=(le=Ne._raw)==null?void 0:le.items)==null?void 0:Be[0])!=null&&je.productName,`<tr>
          <td>${Ne.date}</td>
          <td>${wt(Ve)}</td>
          <td>${Ne.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${Ne.quantity}</td>
          <td style="text-align:right">${Vu(Ne.total)}</td>
        </tr>`}).join(""),bt=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${wt(Ke)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${wt(Ke)}</h1>
      <div class="kpis">

      
        <div><b>Unidades Cash:</b> ${c0(He.unidadesCash)}</div>
        <div><b>Unidades Crdito:</b> ${c0(He.unidadesCredito)}</div>
        <div><b>Total Unidades:</b> ${c0(He.unidadesTotal)}</div>
      </div>

      <div class="kpis">
        <div><b>Libras Cash:</b> ${U.packsCash}</div>
        <div><b>Libras Crdito:</b> ${U.packsCredito}</div>
        <div><b>Ventas Cash:</b> ${Vu(U.montoCash)}</div>
        <div><b>Ventas Crdito:</b> ${Vu(U.montoCredito)}</div>
      </div>

      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Libras</th><th>Ventas</th>
      </tr></thead><tbody>
      ${At||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,ke=window.open("","_blank");ke&&(ke.document.open(),ke.document.write(bt),ke.document.close())},we=()=>R(1),Me=()=>R(Ke=>Math.max(1,Ke-1)),ze=()=>R(Ke=>Math.min(se,Ke+1)),yt=()=>R(se),It=()=>{const Ke=[];if(se<=7)for(let At=1;At<=se;At++)Ke.push(At);else{const At=Math.max(1,ee-2),bt=Math.min(se,ee+2);Ke.push(1),At>2&&Ke.push(-1);for(let ke=At;ke<=bt;ke++)ke!==1&&ke!==se&&Ke.push(ke);bt<se-1&&Ke.push(-2),Ke.push(se)}return i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:we,disabled:ee===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Me,disabled:ee===1,children:" Anterior"}),Ke.map((At,bt)=>typeof At=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${At===ee?"bg-blue-600 text-white":""}`,onClick:()=>R(At),children:At},bt):i.jsx("span",{className:"px-2",children:""},bt)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:ze,disabled:ee===se,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:yt,disabled:ee===se,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",ee," de ",se,"  ",ve.length," transaccin(es)"]})]})};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas del dia"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-7 gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:g,onChange:Ke=>{v(Ke.target.value),R(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:y,onChange:Ke=>{b(Ke.target.value),R(1)}})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:ge,onChange:Ke=>{fe(Ke.target.value),R(1)},children:[i.jsx("option",{value:"",children:"Todos"}),w.map(Ke=>i.jsx("option",{value:Ke.id,children:Ke.name},Ke.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:xe,onChange:Ke=>{ae(Ke.target.value),R(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:Se,onChange:Ke=>{Te(Ke.target.value),R(1)},children:[i.jsx("option",{value:"ALL",children:"Todos"}),S.map(Ke=>i.jsx("option",{value:Ke,children:Ke},Ke))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Estado"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:O,onChange:Ke=>{G(Ke.target.value),R(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"FLOTANTE",children:"FLOTANTE"}),i.jsx("option",{value:"PROCESADA",children:"PROCESADA"})]})]}),i.jsx("button",{className:"sm:col-span-2 lg:col-span-1 px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 w-full",onClick:ue,children:"Exportar PDF"}),i.jsx("div",{className:"sm:col-span-2 lg:col-span-1 flex",children:i.jsx(pc,{onClick:pe,loading:F,className:"w-full justify-center"})})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:c0(U.packsCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:c0(U.packsCredito)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Vu(U.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:Vu(U.montoCredito)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Total"}),i.jsx("div",{className:"text-xl font-semibold",children:Vu(U.montoTotal)})]})]}),i.jsxs("div",{className:"block md:hidden space-y-3",children:[F?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Cargando"}):re.length===0?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Sin transacciones en el rango."}):re.map(Ke=>{var ke,Ne,Ve,he;const wt=bB(Ke,H),At=((ke=Ke._raw)==null?void 0:ke.productName)||((he=(Ve=(Ne=Ke._raw)==null?void 0:Ne.items)==null?void 0:Ve[0])==null?void 0:he.productName)||"(sin producto)",bt=wB(Ke._raw);return i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:wt}),i.jsx("div",{className:"text-xs text-gray-600 shrink-0",children:Ke.date})]}),i.jsxs("div",{className:"mt-1 flex items-center gap-2 flex-wrap text-xs",children:[i.jsx("span",{className:`px-2 py-1 rounded-full border ${bt==="PROCESADA"?"bg-blue-50 border-blue-200 text-blue-700":"bg-gray-50 border-gray-200 text-gray-700"}`,children:bt}),i.jsx("span",{className:`px-2 py-1 rounded-full border ${Ke.type==="CREDITO"?"bg-yellow-50 border-yellow-200 text-yellow-700":"bg-green-50 border-green-200 text-green-700"}`,children:Ke.type==="CREDITO"?"Crdito":"Cash"}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Libras:"})," ",i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:le=>{le.preventDefault(),p(Ke.id)},title:"Ver detalle",children:c0(Ke.quantity)})]}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Monto:"})," ",Vu(Ke.total)]})]})]}),i.jsx("div",{className:"text-gray-500 mt-1",children:i.jsx("span",{className:"inline-block transition-transform group-open:rotate-180",children:""})})]}),i.jsx("div",{className:"px-3 pb-3 pt-0 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2 border-t pt-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("span",{className:"font-medium text-right",children:wt})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Producto"}),i.jsx("span",{className:"font-medium text-right",children:At})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha"}),i.jsx("span",{className:"font-medium",children:Ke.date})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Estado"}),i.jsx("span",{className:"font-medium",children:bt})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("span",{className:"font-medium",children:Ke.type==="CREDITO"?"Crdito":"Cash"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Libras"}),i.jsx("span",{className:"font-medium",children:i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:()=>p(Ke.id),title:"Ver detalle",children:c0(Ke.quantity)})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Monto"}),i.jsx("span",{className:"font-semibold",children:Vu(Ke.total)})]}),i.jsx("div",{className:"flex items-center justify-between",children:s&&i.jsxs("div",{className:"pt-2 flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border hover:bg-gray-50",onClick:()=>L(le=>le===Ke.id?null:Ke.id),children:" Acciones"}),z===Ke.id&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>Pe(Ke),children:"Eliminar"})]})})]})})]})},Ke.id)}),i.jsx("div",{className:"bg-white p-3 rounded shadow border",children:It()})]}),i.jsxs("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Libras"}),i.jsx("th",{className:"p-2 border",children:"Ventas"}),s&&i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:F?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Cargando"})}):re.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Sin transacciones en el rango."})}):re.map(Ke=>{var ke,Ne,Ve,he;const wt=bB(Ke,H),At=((ke=Ke._raw)==null?void 0:ke.productName)||((he=(Ve=(Ne=Ke._raw)==null?void 0:Ne.items)==null?void 0:Ve[0])==null?void 0:he.productName)||"(sin producto)",bt=wB(Ke._raw);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ke.date}),i.jsx("td",{className:"p-2 border",children:bt}),i.jsx("td",{className:"p-2 border",children:wt}),i.jsx("td",{className:"p-2 border",children:At}),i.jsx("td",{className:"p-2 border",children:Ke.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver detalle de productos de esta venta",onClick:()=>p(Ke.id),children:c0(Ke.quantity)})}),i.jsx("td",{className:"p-2 border",children:Vu(Ke.total)}),s&&i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>L(le=>le===Ke.id?null:Ke.id),title:"Acciones",children:""}),z===Ke.id&&i.jsx("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>Pe(Ke),children:"Eliminar"})})]})]},Ke.id)})})]}),It()]}),P&&i.jsx("p",{className:"mt-2 text-sm",children:P}),l&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{children:i.jsxs("h3",{className:"text-lg font-bold",children:["Productos vendidos"," ",f?` #${f}`:""]})}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>c(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Libras"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:u?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):h.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):h.map((Ke,wt)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:Ke.productName}),i.jsx("td",{className:"p-2 border text-right",children:Ke.qty}),i.jsx("td",{className:"p-2 border text-right",children:Vu(Ke.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Vu(Ke.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Vu(Ke.total)})]},wt))})]})})]})})]})}function oit(){const[t,e]=x.useState(!1);return x.useEffect(()=>{var a;const r=window.matchMedia("(max-width: 900px)"),n=()=>e(r.matches);return n(),(a=r.addEventListener)==null||a.call(r,"change",n),()=>{var s;return(s=r.removeEventListener)==null?void 0:s.call(r,"change",n)}},[]),t}function lit(){const[t,e]=x.useState(null),[r,n]=x.useState(""),[a,s]=x.useState([]),[o,l]=x.useState(""),[c,u]=x.useState(!0),d=oit(),f=x.useMemo(()=>d?i.jsx(Lye,{role:r,roles:a}):i.jsx(Mye,{role:r,roles:a}),[d,r,a]),A=(t==null?void 0:t.email)||"";if(x.useEffect(()=>{const m=ij(Zd,async p=>{if(u(!0),p){e(p);try{const g=Yt(Fe,"users",p.uid),v=await Bs(g);if(v.exists()){const y=v.data(),b=Array.isArray(y.roles)?y.roles:y.role?[y.role]:[],w=y.sellerCandyId||"";s(b),n(b[0]||""),l(w||"")}else n(""),s([]),l("")}catch{n(""),l("")}}else e(null),n(""),l("");u(!1)});return()=>m()},[]),c)return i.jsx("div",{className:"p-6 text-center",children:"Cargando..."});const h=()=>{const m=a&&a.length?a:r;return sn(m,"admin")?i.jsx(wh,{to:"financialDashboard",replace:!0}):sn(m,"vendedor_pollo")?i.jsx(wh,{to:"salesV2",replace:!0}):sn(m,"supervisor_pollo")?i.jsx(wh,{to:"batches",replace:!0}):sn(m,"contador")?i.jsx(wh,{to:"batches",replace:!0}):sn(m,"vendedor_ropa")?i.jsx(wh,{to:"salesClothes",replace:!0}):sn(m,"vendedor_dulces")?i.jsx(wh,{to:"salesCandies",replace:!0}):i.jsx(wh,{to:"/",replace:!0})};return i.jsx(g0e,{children:i.jsxs(zAe,{children:[i.jsx(wn,{path:"/",element:i.jsx(Fye,{})}),i.jsxs(wn,{path:"/admin",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_pollo","vendedor_ropa","vendedor_dulces","supervisor_pollo","contador"],children:f}),children:[i.jsx(wn,{index:!0,element:i.jsx(h,{})}),i.jsx(wn,{path:"bills",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(dPe,{role:r,roles:a})})}),i.jsx(wn,{path:"salesV2",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(OV,{user:t})})}),i.jsx(wn,{path:"financialDashboard",element:i.jsx(Tn,{allowedRoles:["admin","contador","supervisor_pollo"],children:i.jsx(c4e,{})})}),i.jsx(wn,{path:"expenses",element:i.jsx(Tn,{allowedRoles:["admin"],children:i.jsx(u4e,{})})}),i.jsx(wn,{path:"transactionsPollo",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(iit,{role:r,roles:a})})}),i.jsx(wn,{path:"batches",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(NPe,{role:r,roles:a})})}),i.jsx(wn,{path:"paidBatches",element:i.jsx(Tn,{allowedRoles:["admin"],children:i.jsx(g4e,{})})}),i.jsx(wn,{path:"fix",element:i.jsx(Tn,{allowedRoles:["admin"],children:i.jsx(h4e,{})})}),i.jsx(wn,{path:"transactionclose",element:i.jsx(Tn,{allowedRoles:["admin"],children:i.jsx(CPe,{})})}),i.jsx(wn,{path:"billhistoric",element:i.jsx(Tn,{allowedRoles:["admin"],children:i.jsx(fPe,{})})}),i.jsx(wn,{path:"users",element:i.jsx(Tn,{allowedRoles:["admin"],children:i.jsx(hPe,{})})}),i.jsx(wn,{path:"products",element:i.jsx(Tn,{allowedRoles:["admin"],children:i.jsx(APe,{})})}),i.jsx(wn,{path:"customersPollo",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(z4e,{role:r,roles:a,currentUserEmail:A,sellerPolloId:o})})}),i.jsx(wn,{path:"datacenter",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(GQe,{})})}),i.jsx(wn,{path:"productsCandies",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx($9e,{})})}),i.jsx(wn,{path:"mainordersCandies",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(jQe,{})})}),i.jsx(wn,{path:"productsPricesCandies",element:i.jsx(Tn,{roles:a,allowedRoles:["admin","vendedor_dulces"],children:i.jsx(Jst,{})})}),i.jsx(wn,{path:"inventoryMainOrderCandies",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(PQe,{})})}),i.jsx(wn,{path:"inventoryCandies",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(Y9e,{})})}),i.jsx(wn,{path:"billingsCandies",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(LQe,{})})}),i.jsx(wn,{path:"cashDeliveries",element:i.jsx(Tn,{allowedRoles:["admin"],children:i.jsx(zst,{})})}),i.jsx(wn,{path:"customersCandies",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(J9e,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(wn,{path:"salesCandies",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(aQe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(wn,{path:"expensesCandies",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(sQe,{})})}),i.jsx(wn,{path:"dashboardCandies",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(AQe,{})})}),i.jsx(wn,{path:"transactionCandies",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(cQe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(wn,{path:"vendorsCandies",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(mQe,{})})}),i.jsx(wn,{path:"productsVendorsCandies",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(CQe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(wn,{path:"cierreVentasCandies",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(TQe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(wn,{path:"reporteCierresCandies",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(QQe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(wn,{path:"consolidatedVendors",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(RQe,{})})}),i.jsx(wn,{path:"salesClothes",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(R4e,{})})}),i.jsx(wn,{path:"notebooksInventory",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(tit,{})})}),i.jsx(wn,{path:"TransactionsReportClothes",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(q4e,{})})}),i.jsx(wn,{path:"financialDashboardClothes",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(U4e,{})})}),i.jsx(wn,{path:"ExpensesClothes",element:i.jsx(Tn,{allowedRoles:["admin"],children:i.jsx(Q4e,{})})}),i.jsx(wn,{path:"inventoryClothesBatches",element:i.jsx(Tn,{allowedRoles:["admin"],children:i.jsx(b4e,{})})}),i.jsx(wn,{path:"productsClothes",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(T4e,{})})}),i.jsx(wn,{path:"CustomersClothes",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(F4e,{})})})]}),i.jsx(wn,{path:"/salesV2",element:i.jsx(Tn,{allowedRoles:["admin","vendedor_pollo","contador"],children:i.jsx(OV,{user:t})})}),i.jsx(wn,{path:"*",element:i.jsx(wh,{to:"/"})})]})})}kye.then(t=>{console.info("Auth persistence mode:",t)}).catch(()=>{}).finally(()=>{NB.createRoot(document.getElementById("root")).render(i.jsx(ko.StrictMode,{children:i.jsx(lit,{})}))});export{Oa as _,uit as c,mA as g};
